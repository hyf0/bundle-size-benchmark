var __create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__commonJS=(e,t)=>function(){return t||(0,e[__getOwnPropNames(e)[0]])((t={exports:{}}).exports,t),t.exports},__export=(e,t)=>{for(var i in t)__defProp(e,i,{get:t[i],enumerable:!0})},__copyProps=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(var o=__getOwnPropNames(t),a=0,c=o.length,u;a<c;a++)u=o[a],!__hasOwnProp.call(e,u)&&u!==i&&__defProp(e,u,{get:(h=>t[h]).bind(null,u),enumerable:!(r=__getOwnPropDesc(t,u))||r.enumerable});return e},__toESM=(e,t,i)=>(i=e!=null?__create(__getProtoOf(e)):{},__copyProps(t||!e||!e.__esModule?__defProp(i,"default",{value:e,enumerable:!0}):i,e));/*!
* @kurkle/color v0.3.4
* https://github.com/kurkle/color#readme
* (c) 2024 Jukka Kurkela
* Released under the MIT License
*/function round$2(e){return e+.5|0}const lim=(e,t,i)=>Math.max(Math.min(e,i),t);function p2b(e){return lim(round$2(e*2.55),0,255)}function n2b(e){return lim(round$2(e*255),0,255)}function b2n(e){return lim(round$2(e/2.55)/100,0,1)}function n2p(e){return lim(round$2(e*100),0,100)}const map$1={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},hex$1=[..."0123456789ABCDEF"],h1=e=>hex$1[e&15],h2=e=>hex$1[(e&240)>>4]+hex$1[e&15],eq$2=e=>(e&240)>>4===(e&15),isShort=e=>eq$2(e.r)&&eq$2(e.g)&&eq$2(e.b)&&eq$2(e.a);function hexParse(e){var t=e.length,i;return e[0]==="#"&&(t===4||t===5?i={r:255&map$1[e[1]]*17,g:255&map$1[e[2]]*17,b:255&map$1[e[3]]*17,a:t===5?map$1[e[4]]*17:255}:(t===7||t===9)&&(i={r:map$1[e[1]]<<4|map$1[e[2]],g:map$1[e[3]]<<4|map$1[e[4]],b:map$1[e[5]]<<4|map$1[e[6]],a:t===9?map$1[e[7]]<<4|map$1[e[8]]:255})),i}const alpha=(e,t)=>e<255?t(e):"";function hexString(e){var t=isShort(e)?h1:h2;return e?"#"+t(e.r)+t(e.g)+t(e.b)+alpha(e.a,t):void 0}const HUE_RE=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function hsl2rgbn(e,t,i){const r=t*Math.min(i,1-i),o=(a,c=(a+e/30)%12)=>i-r*Math.max(Math.min(c-3,9-c,1),-1);return[o(0),o(8),o(4)]}function hsv2rgbn(e,t,i){const r=(o,a=(o+e/60)%6)=>i-i*t*Math.max(Math.min(a,4-a,1),0);return[r(5),r(3),r(1)]}function hwb2rgbn(e,t,i){const r=hsl2rgbn(e,1,.5);let o;for(t+i>1&&(o=1/(t+i),t*=o,i*=o),o=0;o<3;o++)r[o]*=1-t-i,r[o]+=t;return r}function hueValue(e,t,i,r,o){return e===o?(t-i)/r+(t<i?6:0):t===o?(i-e)/r+2:(e-t)/r+4}function rgb2hsl(e){const i=e.r/255,r=e.g/255,o=e.b/255,a=Math.max(i,r,o),c=Math.min(i,r,o),u=(a+c)/2;let h,d,f;return a!==c&&(f=a-c,d=u>.5?f/(2-a-c):f/(a+c),h=hueValue(i,r,o,f,a),h=h*60+.5),[h|0,d||0,u]}function calln(e,t,i,r){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,i,r)).map(n2b)}function hsl2rgb$1(e,t,i){return calln(hsl2rgbn,e,t,i)}function hwb2rgb(e,t,i){return calln(hwb2rgbn,e,t,i)}function hsv2rgb(e,t,i){return calln(hsv2rgbn,e,t,i)}function hue(e){return(e%360+360)%360}function hueParse(e){const t=HUE_RE.exec(e);let i=255,r;if(!t)return;t[5]!==r&&(i=t[6]?p2b(+t[5]):n2b(+t[5]));const o=hue(+t[2]),a=+t[3]/100,c=+t[4]/100;return t[1]==="hwb"?r=hwb2rgb(o,a,c):t[1]==="hsv"?r=hsv2rgb(o,a,c):r=hsl2rgb$1(o,a,c),{r:r[0],g:r[1],b:r[2],a:i}}function rotate(e,t){var i=rgb2hsl(e);i[0]=hue(i[0]+t),i=hsl2rgb$1(i),e.r=i[0],e.g=i[1],e.b=i[2]}function hslString(e){if(!e)return;const t=rgb2hsl(e),i=t[0],r=n2p(t[1]),o=n2p(t[2]);return e.a<255?`hsla(${i}, ${r}%, ${o}%, ${b2n(e.a)})`:`hsl(${i}, ${r}%, ${o}%)`}const map$2={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},names$1={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function unpack(){const e={},t=Object.keys(names$1),i=Object.keys(map$2);let r,o,a,c,u;for(r=0;r<t.length;r++){for(c=u=t[r],o=0;o<i.length;o++)a=i[o],u=u.replace(a,map$2[a]);a=parseInt(names$1[c],16),e[u]=[a>>16&255,a>>8&255,a&255]}return e}let names$2;function nameParse(e){names$2||(names$2=unpack(),names$2.transparent=[0,0,0,0]);const t=names$2[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const RGB_RE=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function rgbParse(e){const t=RGB_RE.exec(e);let i=255,r,o,a;if(t){if(t[7]!==r){const c=+t[7];i=t[8]?p2b(c):lim(c*255,0,255)}return r=+t[1],o=+t[3],a=+t[5],r=255&(t[2]?p2b(r):lim(r,0,255)),o=255&(t[4]?p2b(o):lim(o,0,255)),a=255&(t[6]?p2b(a):lim(a,0,255)),{r,g:o,b:a,a:i}}}function rgbString(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${b2n(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const to=e=>e<=.0031308?e*12.92:Math.pow(e,.4166666666666667)*1.055-.055,from=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function interpolate$1(e,t,i){const r=from(b2n(e.r)),o=from(b2n(e.g)),a=from(b2n(e.b));return{r:n2b(to(r+i*(from(b2n(t.r))-r))),g:n2b(to(o+i*(from(b2n(t.g))-o))),b:n2b(to(a+i*(from(b2n(t.b))-a))),a:e.a+i*(t.a-e.a)}}function modHSL(e,t,i){if(e){let r=rgb2hsl(e);r[t]=Math.max(0,Math.min(r[t]+r[t]*i,t===0?360:1)),r=hsl2rgb$1(r),e.r=r[0],e.g=r[1],e.b=r[2]}}function clone$9(e,t){return e&&Object.assign(t||{},e)}function fromObject(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=n2b(e[3]))):(t=clone$9(e,{r:0,g:0,b:0,a:1}),t.a=n2b(t.a)),t}function functionParse(e){return e.charAt(0)==="r"?rgbParse(e):hueParse(e)}var Color$1=class sr{constructor(t){if(t instanceof sr)return t;const i=typeof t;let r;i==="object"?r=fromObject(t):i==="string"&&(r=hexParse(t)||nameParse(t)||functionParse(t)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var t=clone$9(this._rgb);return t&&(t.a=b2n(t.a)),t}set rgb(t){this._rgb=fromObject(t)}rgbString(){return this._valid?rgbString(this._rgb):void 0}hexString(){return this._valid?hexString(this._rgb):void 0}hslString(){return this._valid?hslString(this._rgb):void 0}mix(t,i){if(t){const r=this.rgb,o=t.rgb;let a;const c=i===a?.5:i,u=2*c-1,h=r.a-o.a,d=((u*h===-1?u:(u+h)/(1+u*h))+1)/2;a=1-d,r.r=255&d*r.r+a*o.r+.5,r.g=255&d*r.g+a*o.g+.5,r.b=255&d*r.b+a*o.b+.5,r.a=c*r.a+(1-c)*o.a,this.rgb=r}return this}interpolate(t,i){return t&&(this._rgb=interpolate$1(this._rgb,t._rgb,i)),this}clone(){return new sr(this.rgb)}alpha(t){return this._rgb.a=n2b(t),this}clearer(t){const i=this._rgb;return i.a*=1-t,this}greyscale(){const t=this._rgb,i=round$2(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=i,this}opaquer(t){const i=this._rgb;return i.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return modHSL(this._rgb,2,t),this}darken(t){return modHSL(this._rgb,2,-t),this}saturate(t){return modHSL(this._rgb,1,t),this}desaturate(t){return modHSL(this._rgb,1,-t),this}rotate(t){return rotate(this._rgb,t),this}};const uid$3=(()=>{let e=0;return()=>e++})();function isNullOrUndef(e){return e==null}function isArray$4(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function isObject$14(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function isNumberFinite(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function finiteOrDefault(e,t){return isNumberFinite(e)?e:t}function valueOrDefault(e,t){return typeof e>"u"?t:e}const toDimension=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function callback(e,t,i){if(e&&typeof e.call=="function")return e.apply(i,t)}function each(e,t,i,r){let o,a,c;if(isArray$4(e))if(a=e.length,r)for(o=a-1;o>=0;o--)t.call(i,e[o],o);else for(o=0;o<a;o++)t.call(i,e[o],o);else if(isObject$14(e))for(c=Object.keys(e),a=c.length,o=0;o<a;o++)t.call(i,e[c[o]],c[o])}function _elementsEqual(e,t){let i,r,o,a;if(!e||!t||e.length!==t.length)return!1;for(i=0,r=e.length;i<r;++i)if(o=e[i],a=t[i],o.datasetIndex!==a.datasetIndex||o.index!==a.index)return!1;return!0}function clone$8(e){if(isArray$4(e))return e.map(clone$8);if(isObject$14(e)){const t=Object.create(null),i=Object.keys(e),r=i.length;let o=0;for(;o<r;++o)t[i[o]]=clone$8(e[i[o]]);return t}return e}function isValidKey(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function _merger(e,t,i,r){if(!isValidKey(e))return;const o=t[e],a=i[e];isObject$14(o)&&isObject$14(a)?merge$2(o,a,r):t[e]=clone$8(a)}function merge$2(e,t,i){const r=isArray$4(t)?t:[t],o=r.length;if(!isObject$14(e))return e;i=i||{};const a=i.merger||_merger;let c;for(let u=0;u<o;++u){if(c=r[u],!isObject$14(c))continue;const h=Object.keys(c);for(let d=0,f=h.length;d<f;++d)a(h[d],e,c,i)}return e}function mergeIf(e,t){return merge$2(e,t,{merger:_mergerIf})}function _mergerIf(e,t,i){if(!isValidKey(e))return;const r=t[e],o=i[e];isObject$14(r)&&isObject$14(o)?mergeIf(r,o):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=clone$8(o))}const keyResolvers={"":e=>e,x:e=>e.x,y:e=>e.y};function _splitKey(e){const t=e.split("."),i=[];let r="";for(const o of t)r+=o,r.endsWith("\\")?r=r.slice(0,-1)+".":(i.push(r),r="");return i}function _getKeyResolver(e){const t=_splitKey(e);return i=>{for(const r of t){if(r==="")break;i=i&&i[r]}return i}}function resolveObjectKey(e,t){return(keyResolvers[t]||(keyResolvers[t]=_getKeyResolver(t)))(e)}function _capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}const defined=e=>typeof e<"u",isFunction$3=e=>typeof e=="function",setsEqual=(e,t)=>{if(e.size!==t.size)return!1;for(const i of e)if(!t.has(i))return!1;return!0};function _isClickEvent(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const PI=Math.PI,TAU=2*PI,PITAU=TAU+PI,INFINITY$2=Number.POSITIVE_INFINITY,RAD_PER_DEG=PI/180,HALF_PI=PI/2,QUARTER_PI=PI/4,TWO_THIRDS_PI=PI*2/3,log10=Math.log10,sign=Math.sign;function almostEquals(e,t,i){return Math.abs(e-t)<i}function niceNum(e){const t=Math.round(e);e=almostEquals(e,t,e/1e3)?t:e;const i=Math.pow(10,Math.floor(log10(e))),r=e/i;return(r<=1?1:r<=2?2:r<=5?5:10)*i}function _factorize(e){const t=[],i=Math.sqrt(e);let r;for(r=1;r<i;r++)e%r===0&&(t.push(r),t.push(e/r));return i===(i|0)&&t.push(i),t.sort((o,a)=>o-a).pop(),t}function isNumber$1(e){return!isNaN(parseFloat(e))&&isFinite(e)}function almostWhole(e,t){const i=Math.round(e);return i-t<=e&&i+t>=e}function _setMinAndMaxByKey(e,t,i){let r,o,a;for(r=0,o=e.length;r<o;r++)a=e[r][i],isNaN(a)||(t.min=Math.min(t.min,a),t.max=Math.max(t.max,a))}function toRadians(e){return e*(PI/180)}function toDegrees(e){return e*(180/PI)}function _decimalPlaces(e){if(!isNumberFinite(e))return;let t=1,i=0;for(;Math.round(e*t)/t!==e;)t*=10,i++;return i}function getAngleFromPoint(e,t){const i=t.x-e.x,r=t.y-e.y,o=Math.sqrt(i*i+r*r);let a=Math.atan2(r,i);return a<-.5*PI&&(a+=TAU),{angle:a,distance:o}}function _normalizeAngle(e){return(e%TAU+TAU)%TAU}function _angleBetween(e,t,i,r){const o=_normalizeAngle(e),a=_normalizeAngle(t),c=_normalizeAngle(i),u=_normalizeAngle(a-o),h=_normalizeAngle(c-o),d=_normalizeAngle(o-a),f=_normalizeAngle(o-c);return o===a||o===c||r&&a===c||u>h&&d<f}function _limitValue(e,t,i){return Math.max(t,Math.min(i,e))}function _int16Range(e){return _limitValue(e,-32768,32767)}function _lookup(e,t,i){i=i||(c=>e[c]<t);let r=e.length-1,o=0,a;for(;r-o>1;)a=o+r>>1,i(a)?o=a:r=a;return{lo:o,hi:r}}const _lookupByKey=(e,t,i,r)=>_lookup(e,i,r?o=>{const a=e[o][t];return a<i||a===i&&e[o+1][t]===i}:o=>e[o][t]<i),_rlookupByKey=(e,t,i)=>_lookup(e,i,r=>e[r][t]>=i);function _filterBetween(e,t,i){let r=0,o=e.length;for(;r<o&&e[r]<t;)r++;for(;o>r&&e[o-1]>i;)o--;return r>0||o<e.length?e.slice(r,o):e}const arrayEvents=["push","pop","shift","splice","unshift"];function listenArrayEvents(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),arrayEvents.forEach(i=>{const r="_onData"+_capitalize(i),o=e[i];Object.defineProperty(e,i,{configurable:!0,enumerable:!1,value(...a){const c=o.apply(this,a);return e._chartjs.listeners.forEach(u=>{typeof u[r]=="function"&&u[r](...a)}),c}})})}function unlistenArrayEvents(e,t){const i=e._chartjs;if(!i)return;const r=i.listeners,o=r.indexOf(t);o!==-1&&r.splice(o,1),!(r.length>0)&&(arrayEvents.forEach(a=>{delete e[a]}),delete e._chartjs)}function _arrayUnique(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const requestAnimFrame=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function throttled(e,t){let i=[],r=!1;return function(...o){i=o,r||(r=!0,requestAnimFrame.call(window,()=>{r=!1,e.apply(t,i)}))}}function debounce$4(e,t){let i;return function(...r){return t?(clearTimeout(i),i=setTimeout(e,t,r)):e.apply(this,r),t}}const _toLeftRightCenter=e=>e==="start"?"left":e==="end"?"right":"center",_alignStartEnd=(e,t,i)=>e==="start"?t:e==="end"?i:(t+i)/2,atEdge=e=>e===0||e===1,elasticIn=(e,t,i)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*TAU/i)),elasticOut=(e,t,i)=>Math.pow(2,-10*e)*Math.sin((e-t)*TAU/i)+1,effects={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*HALF_PI)+1,easeOutSine:e=>Math.sin(e*HALF_PI),easeInOutSine:e=>-.5*(Math.cos(PI*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>atEdge(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>atEdge(e)?e:elasticIn(e,.075,.3),easeOutElastic:e=>atEdge(e)?e:elasticOut(e,.075,.3),easeInOutElastic(e){return atEdge(e)?e:e<.5?.5*elasticIn(e*2,.1125,.45):.5+.5*elasticOut(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-effects.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?effects.easeInBounce(e*2)*.5:effects.easeOutBounce(e*2-1)*.5+.5};function isPatternOrGradient(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function color$1(e){return isPatternOrGradient(e)?e:new Color$1(e)}function getHoverColor(e){return isPatternOrGradient(e)?e:new Color$1(e).saturate(.5).darken(.1).hexString()}const numbers=["x","y","borderWidth","radius","tension"],colors=["color","borderColor","backgroundColor"];function applyAnimationsDefaults(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:colors},numbers:{type:"number",properties:numbers}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function applyLayoutsDefaults(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const intlCache=new Map;function getNumberFormat(e,t){t=t||{};const i=e+JSON.stringify(t);let r=intlCache.get(i);return r||(r=new Intl.NumberFormat(e,t),intlCache.set(i,r)),r}function formatNumber(e,t,i){return getNumberFormat(t,i).format(e)}const formatters={values(e){return isArray$4(e)?e:""+e},numeric(e,t,i){if(e===0)return"0";const r=this.chart.options.locale;let o,a=e;if(i.length>1){const d=Math.max(Math.abs(i[0].value),Math.abs(i[i.length-1].value));(d<1e-4||d>1e15)&&(o="scientific"),a=calculateDelta(e,i)}const c=log10(Math.abs(a)),u=isNaN(c)?1:Math.max(Math.min(-1*Math.floor(c),20),0),h={notation:o,minimumFractionDigits:u,maximumFractionDigits:u};return Object.assign(h,this.options.ticks.format),formatNumber(e,r,h)},logarithmic(e,t,i){if(e===0)return"0";const r=i[t].significand||e/Math.pow(10,Math.floor(log10(e)));return[1,2,3,5,10,15].includes(r)||t>.8*i.length?formatters.numeric.call(this,e,t,i):""}};function calculateDelta(e,t){let i=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(i)>=1&&e!==Math.floor(e)&&(i=e-Math.floor(e)),i}var Ticks={formatters};function applyScaleDefaults(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,i)=>i.lineWidth,tickColor:(t,i)=>i.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Ticks.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const overrides=Object.create(null),descriptors=Object.create(null);function getScope$1(e,t){if(!t)return e;const i=t.split(".");for(let r=0,o=i.length;r<o;++r){const a=i[r];e=e[a]||(e[a]=Object.create(null))}return e}function set$5(e,t,i){return typeof t=="string"?merge$2(getScope$1(e,t),i):merge$2(getScope$1(e,""),t)}var Defaults=class{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,r)=>getHoverColor(r.backgroundColor),this.hoverBorderColor=(i,r)=>getHoverColor(r.borderColor),this.hoverColor=(i,r)=>getHoverColor(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return set$5(this,e,t)}get(e){return getScope$1(this,e)}describe(e,t){return set$5(descriptors,e,t)}override(e,t){return set$5(overrides,e,t)}route(e,t,i,r){const o=getScope$1(this,e),a=getScope$1(this,i),c="_"+t;Object.defineProperties(o,{[c]:{value:o[t],writable:!0},[t]:{enumerable:!0,get(){const u=this[c],h=a[r];return isObject$14(u)?Object.assign({},h,u):valueOrDefault(u,h)},set(u){this[c]=u}}})}apply(e){e.forEach(t=>t(this))}},defaults$2=new Defaults({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[applyAnimationsDefaults,applyLayoutsDefaults,applyScaleDefaults]);function toFontString(e){return!e||isNullOrUndef(e.size)||isNullOrUndef(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function _measureText(e,t,i,r,o){let a=t[o];return a||(a=t[o]=e.measureText(o).width,i.push(o)),a>r&&(r=a),r}function _longestText(e,t,i,r){r=r||{};let o=r.data=r.data||{},a=r.garbageCollect=r.garbageCollect||[];r.font!==t&&(o=r.data={},a=r.garbageCollect=[],r.font=t),e.save(),e.font=t;let c=0;const u=i.length;let h,d,f,m,g;for(h=0;h<u;h++)if(m=i[h],m!=null&&!isArray$4(m))c=_measureText(e,o,a,c,m);else if(isArray$4(m))for(d=0,f=m.length;d<f;d++)g=m[d],g!=null&&!isArray$4(g)&&(c=_measureText(e,o,a,c,g));e.restore();const v=a.length/2;if(v>i.length){for(h=0;h<v;h++)delete o[a[h]];a.splice(0,v)}return c}function _alignPixel(e,t,i){const r=e.currentDevicePixelRatio,o=i!==0?Math.max(i/2,.5):0;return Math.round((t-o)*r)/r+o}function clearCanvas(e,t){!t&&!e||(t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function _isPointInArea(e,t,i){return i=i||.5,!t||e&&e.x>t.left-i&&e.x<t.right+i&&e.y>t.top-i&&e.y<t.bottom+i}function clipArea(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function unclipArea(e){e.restore()}function setRenderOpts(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),isNullOrUndef(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function decorateText(e,t,i,r,o){if(o.strikethrough||o.underline){const a=e.measureText(r),c=t-a.actualBoundingBoxLeft,u=t+a.actualBoundingBoxRight,h=i-a.actualBoundingBoxAscent,d=i+a.actualBoundingBoxDescent,f=o.strikethrough?(h+d)/2:d;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=o.decorationWidth||2,e.moveTo(c,f),e.lineTo(u,f),e.stroke()}}function drawBackdrop(e,t){const i=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=i}function renderText(e,t,i,r,o,a={}){const c=isArray$4(t)?t:[t],u=a.strokeWidth>0&&a.strokeColor!=="";let h,d;for(e.save(),e.font=o.string,setRenderOpts(e,a),h=0;h<c.length;++h)d=c[h],a.backdrop&&drawBackdrop(e,a.backdrop),u&&(a.strokeColor&&(e.strokeStyle=a.strokeColor),isNullOrUndef(a.strokeWidth)||(e.lineWidth=a.strokeWidth),e.strokeText(d,i,r,a.maxWidth)),e.fillText(d,i,r,a.maxWidth),decorateText(e,i,r,d,a),r+=Number(o.lineHeight);e.restore()}function addRoundedRectPath(e,t){const{x:i,y:r,w:o,h:a,radius:c}=t;e.arc(i+c.topLeft,r+c.topLeft,c.topLeft,1.5*PI,PI,!0),e.lineTo(i,r+a-c.bottomLeft),e.arc(i+c.bottomLeft,r+a-c.bottomLeft,c.bottomLeft,PI,HALF_PI,!0),e.lineTo(i+o-c.bottomRight,r+a),e.arc(i+o-c.bottomRight,r+a-c.bottomRight,c.bottomRight,HALF_PI,0,!0),e.lineTo(i+o,r+c.topRight),e.arc(i+o-c.topRight,r+c.topRight,c.topRight,0,-HALF_PI,!0),e.lineTo(i+c.topLeft,r)}const LINE_HEIGHT=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,FONT_STYLE=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function toLineHeight(e,t){const i=(""+e).match(LINE_HEIGHT);if(!i||i[1]==="normal")return t*1.2;switch(e=+i[2],i[3]){case"px":return e;case"%":e/=100;break}return t*e}const numberOrZero=e=>+e||0;function _readValueToProps(e,t){const i={},r=isObject$14(t),o=r?Object.keys(t):t,a=isObject$14(e)?r?c=>valueOrDefault(e[c],e[t[c]]):c=>e[c]:()=>e;for(const c of o)i[c]=numberOrZero(a(c));return i}function toTRBL(e){return _readValueToProps(e,{top:"y",right:"x",bottom:"y",left:"x"})}function toTRBLCorners(e){return _readValueToProps(e,["topLeft","topRight","bottomLeft","bottomRight"])}function toPadding(e){const t=toTRBL(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function toFont(e,t){e=e||{},t=t||defaults$2.font;let i=valueOrDefault(e.size,t.size);typeof i=="string"&&(i=parseInt(i,10));let r=valueOrDefault(e.style,t.style);r&&!(""+r).match(FONT_STYLE)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const o={family:valueOrDefault(e.family,t.family),lineHeight:toLineHeight(valueOrDefault(e.lineHeight,t.lineHeight),i),size:i,style:r,weight:valueOrDefault(e.weight,t.weight),string:""};return o.string=toFontString(o),o}function resolve(e,t,i,r){let o=!0,a,c,u;for(a=0,c=e.length;a<c;++a)if(u=e[a],u!==void 0&&(t!==void 0&&typeof u=="function"&&(u=u(t),o=!1),i!==void 0&&isArray$4(u)&&(u=u[i%u.length],o=!1),u!==void 0))return r&&!o&&(r.cacheable=!1),u}function _addGrace(e,t,i){const{min:r,max:o}=e,a=toDimension(t,(o-r)/2),c=(u,h)=>i&&u===0?0:u+h;return{min:c(r,-Math.abs(a)),max:c(o,a)}}function createContext$1(e,t){return Object.assign(Object.create(e),t)}function _createResolver(e,t=[""],i,r,o=()=>e[0]){const a=i||e;typeof r>"u"&&(r=_resolve("_fallback",e));const c={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:a,_fallback:r,_getTarget:o,override:u=>_createResolver([u,...e],t,a,r)};return new Proxy(c,{deleteProperty(u,h){return delete u[h],delete u._keys,delete e[0][h],!0},get(u,h){return _cached(u,h,()=>_resolveWithPrefixes(h,t,e,u))},getOwnPropertyDescriptor(u,h){return Reflect.getOwnPropertyDescriptor(u._scopes[0],h)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(u,h){return getKeysFromAllScopes(u).includes(h)},ownKeys(u){return getKeysFromAllScopes(u)},set(u,h,d){const f=u._storage||(u._storage=o());return u[h]=f[h]=d,delete u._keys,!0}})}function _attachContext(e,t,i,r){const o={_cacheable:!1,_proxy:e,_context:t,_subProxy:i,_stack:new Set,_descriptors:_descriptors(e,r),setContext:a=>_attachContext(e,a,i,r),override:a=>_attachContext(e.override(a),t,i,r)};return new Proxy(o,{deleteProperty(a,c){return delete a[c],delete e[c],!0},get(a,c,u){return _cached(a,c,()=>_resolveWithContext(a,c,u))},getOwnPropertyDescriptor(a,c){return a._descriptors.allKeys?Reflect.has(e,c)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,c)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(a,c){return Reflect.has(e,c)},ownKeys(){return Reflect.ownKeys(e)},set(a,c,u){return e[c]=u,delete a[c],!0}})}function _descriptors(e,t={scriptable:!0,indexable:!0}){const{_scriptable:i=t.scriptable,_indexable:r=t.indexable,_allKeys:o=t.allKeys}=e;return{allKeys:o,scriptable:i,indexable:r,isScriptable:isFunction$3(i)?i:()=>i,isIndexable:isFunction$3(r)?r:()=>r}}const readKey=(e,t)=>e?e+_capitalize(t):t,needsSubResolver=(e,t)=>isObject$14(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function _cached(e,t,i){if(Object.prototype.hasOwnProperty.call(e,t)||t==="constructor")return e[t];const r=i();return e[t]=r,r}function _resolveWithContext(e,t,i){const{_proxy:r,_context:o,_subProxy:a,_descriptors:c}=e;let u=r[t];return isFunction$3(u)&&c.isScriptable(t)&&(u=_resolveScriptable(t,u,e,i)),isArray$4(u)&&u.length&&(u=_resolveArray(t,u,e,c.isIndexable)),needsSubResolver(t,u)&&(u=_attachContext(u,o,a&&a[t],c)),u}function _resolveScriptable(e,t,i,r){const{_proxy:o,_context:a,_subProxy:c,_stack:u}=i;if(u.has(e))throw new Error("Recursion detected: "+Array.from(u).join("->")+"->"+e);u.add(e);let h=t(a,c||r);return u.delete(e),needsSubResolver(e,h)&&(h=createSubResolver(o._scopes,o,e,h)),h}function _resolveArray(e,t,i,r){const{_proxy:o,_context:a,_subProxy:c,_descriptors:u}=i;if(typeof a.index<"u"&&r(e))return t[a.index%t.length];if(isObject$14(t[0])){const h=t,d=o._scopes.filter(f=>f!==h);t=[];for(const f of h){const m=createSubResolver(d,o,e,f);t.push(_attachContext(m,a,c&&c[e],u))}}return t}function resolveFallback(e,t,i){return isFunction$3(e)?e(t,i):e}const getScope=(e,t)=>e===!0?t:typeof e=="string"?resolveObjectKey(t,e):void 0;function addScopes(e,t,i,r,o){for(const a of t){const c=getScope(i,a);if(c){e.add(c);const u=resolveFallback(c._fallback,i,o);if(typeof u<"u"&&u!==i&&u!==r)return u}else if(c===!1&&typeof r<"u"&&i!==r)return null}return!1}function createSubResolver(e,t,i,r){const o=t._rootScopes,a=resolveFallback(t._fallback,i,r),c=[...e,...o],u=new Set;u.add(r);let h=addScopesFromKey(u,c,i,a||i,r);return h===null||typeof a<"u"&&a!==i&&(h=addScopesFromKey(u,c,a,h,r),h===null)?!1:_createResolver(Array.from(u),[""],o,a,()=>subGetTarget(t,i,r))}function addScopesFromKey(e,t,i,r,o){for(;i;)i=addScopes(e,t,i,r,o);return i}function subGetTarget(e,t,i){const r=e._getTarget();t in r||(r[t]={});const o=r[t];return isArray$4(o)&&isObject$14(i)?i:o||{}}function _resolveWithPrefixes(e,t,i,r){let o;for(const a of t)if(o=_resolve(readKey(a,e),i),typeof o<"u")return needsSubResolver(e,o)?createSubResolver(i,r,e,o):o}function _resolve(e,t){for(const i of t){if(!i)continue;const r=i[e];if(typeof r<"u")return r}}function getKeysFromAllScopes(e){let t=e._keys;return t||(t=e._keys=resolveKeysFromAllScopes(e._scopes)),t}function resolveKeysFromAllScopes(e){const t=new Set;for(const i of e)for(const r of Object.keys(i).filter(o=>!o.startsWith("_")))t.add(r);return Array.from(t)}const EPSILON=Number.EPSILON||1e-14;function _isDomSupported(){return typeof window<"u"&&typeof document<"u"}function _getParentNode(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function parseMaxStyle(e,t,i){let r;return typeof e=="string"?(r=parseInt(e,10),e.indexOf("%")!==-1&&(r=r/100*t.parentNode[i])):r=e,r}const getComputedStyle$4=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function getStyle$1(e,t){return getComputedStyle$4(e).getPropertyValue(t)}const positions=["top","right","bottom","left"];function getPositionedStyle(e,t,i){const r={};i=i?"-"+i:"";for(let o=0;o<4;o++){const a=positions[o];r[a]=parseFloat(e[t+"-"+a+i])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const useOffsetPos=(e,t,i)=>(e>0||t>0)&&(!i||!i.shadowRoot);function getCanvasPosition(e,t){const i=e.touches,r=i&&i.length?i[0]:e,{offsetX:o,offsetY:a}=r;let c=!1,u,h;if(useOffsetPos(o,a,e.target))u=o,h=a;else{const d=t.getBoundingClientRect();u=r.clientX-d.left,h=r.clientY-d.top,c=!0}return{x:u,y:h,box:c}}function getRelativePosition(e,t){if("native"in e)return e;const{canvas:i,currentDevicePixelRatio:r}=t,o=getComputedStyle$4(i),a=o.boxSizing==="border-box",c=getPositionedStyle(o,"padding"),u=getPositionedStyle(o,"border","width"),{x:h,y:d,box:f}=getCanvasPosition(e,i),m=c.left+(f&&u.left),g=c.top+(f&&u.top);let{width:v,height:_}=t;return a&&(v-=c.width+u.width,_-=c.height+u.height),{x:Math.round((h-m)/v*i.width/r),y:Math.round((d-g)/_*i.height/r)}}function getContainerSize(e,t,i){let r,o;if(t===void 0||i===void 0){const a=e&&_getParentNode(e);if(!a)t=e.clientWidth,i=e.clientHeight;else{const c=a.getBoundingClientRect(),u=getComputedStyle$4(a),h=getPositionedStyle(u,"border","width"),d=getPositionedStyle(u,"padding");t=c.width-d.width-h.width,i=c.height-d.height-h.height,r=parseMaxStyle(u.maxWidth,a,"clientWidth"),o=parseMaxStyle(u.maxHeight,a,"clientHeight")}}return{width:t,height:i,maxWidth:r||INFINITY$2,maxHeight:o||INFINITY$2}}const round1=e=>Math.round(e*10)/10;function getMaximumSize(e,t,i,r){const o=getComputedStyle$4(e),a=getPositionedStyle(o,"margin"),c=parseMaxStyle(o.maxWidth,e,"clientWidth")||INFINITY$2,u=parseMaxStyle(o.maxHeight,e,"clientHeight")||INFINITY$2,h=getContainerSize(e,t,i);let{width:d,height:f}=h;if(o.boxSizing==="content-box"){const g=getPositionedStyle(o,"border","width"),v=getPositionedStyle(o,"padding");d-=v.width+g.width,f-=v.height+g.height}return d=Math.max(0,d-a.width),f=Math.max(0,r?d/r:f-a.height),d=round1(Math.min(d,c,h.maxWidth)),f=round1(Math.min(f,u,h.maxHeight)),d&&!f&&(f=round1(d/2)),(t!==void 0||i!==void 0)&&r&&h.height&&f>h.height&&(f=h.height,d=round1(Math.floor(f*r))),{width:d,height:f}}function retinaScale(e,t,i){const r=t||1,o=Math.floor(e.height*r),a=Math.floor(e.width*r);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const c=e.canvas;return c.style&&(i||!c.style.height&&!c.style.width)&&(c.style.height=`${e.height}px`,c.style.width=`${e.width}px`),e.currentDevicePixelRatio!==r||c.height!==o||c.width!==a?(e.currentDevicePixelRatio=r,c.height=o,c.width=a,e.ctx.setTransform(r,0,0,r,0,0),!0):!1}const supportsEventListenerOptions=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};_isDomSupported()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e}();function readUsedSize(e,t){const i=getStyle$1(e,t),r=i&&i.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}var Animator=class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,i,r){const o=t.listeners[r],a=t.duration;o.forEach(c=>c({chart:e,initial:t.initial,numSteps:a,currentStep:Math.min(i-t.start,a)}))}_refresh(){this._request||(this._running=!0,this._request=requestAnimFrame.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((i,r)=>{if(!i.running||!i.items.length)return;const o=i.items;let a=o.length-1,c=!1,u;for(;a>=0;--a)u=o[a],u._active?(u._total>i.duration&&(i.duration=u._total),u.tick(e),c=!0):(o[a]=o[o.length-1],o.pop());c&&(r.draw(),this._notify(r,i,e,"progress")),o.length||(i.running=!1,this._notify(r,i,e,"complete"),i.initial=!1),t+=o.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let i=t.get(e);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,i)),i}listen(e,t,i){this._getAnims(e).listeners[t].push(i)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((i,r)=>Math.max(i,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const i=t.items;let r=i.length-1;for(;r>=0;--r)i[r].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}},animator=new Animator;const transparent="transparent",interpolators={boolean(e,t,i){return i>.5?t:e},color(e,t,i){const r=color$1(e||transparent),o=r.valid&&color$1(t||transparent);return o&&o.valid?o.mix(r,i).hexString():t},number(e,t,i){return e+(t-e)*i}};var Animation=class{constructor(e,t,i,r){const o=t[i];r=resolve([e.to,r,o,e.from]);const a=resolve([e.from,o,r]);this._active=!0,this._fn=e.fn||interpolators[e.type||typeof a],this._easing=effects[e.easing]||effects.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=i,this._from=a,this._to=r,this._promises=void 0}active(){return this._active}update(e,t,i){if(this._active){this._notify(!1);const r=this._target[this._prop],o=i-this._start,a=this._duration-o;this._start=i,this._duration=Math.floor(Math.max(a,e.duration)),this._total+=o,this._loop=!!e.loop,this._to=resolve([e.to,t,r,e.from]),this._from=resolve([e.from,r,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,i=this._duration,r=this._prop,o=this._from,a=this._loop,c=this._to;let u;if(this._active=o!==c&&(a||t<i),!this._active){this._target[r]=c,this._notify(!0);return}if(t<0){this._target[r]=o;return}u=t/i%2,u=a&&u>1?2-u:u,u=this._easing(Math.min(1,Math.max(0,u))),this._target[r]=this._fn(o,c,u)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,i)=>{e.push({res:t,rej:i})})}_notify(e){const t=e?"res":"rej",i=this._promises||[];for(let r=0;r<i.length;r++)i[r][t]()}},Animations=class{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!isObject$14(e))return;const t=Object.keys(defaults$2.animation),i=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const o=e[r];if(!isObject$14(o))return;const a={};for(const c of t)a[c]=o[c];(isArray$4(o.properties)&&o.properties||[r]).forEach(c=>{(c===r||!i.has(c))&&i.set(c,a)})})}_animateOptions(e,t){const i=t.options,r=resolveTargetOptions(e,i);if(!r)return[];const o=this._createAnimations(r,i);return i.$shared&&awaitAll(e.options.$animations,i).then(()=>{e.options=i},()=>{}),o}_createAnimations(e,t){const i=this._properties,r=[],o=e.$animations||(e.$animations={}),a=Object.keys(t),c=Date.now();let u;for(u=a.length-1;u>=0;--u){const h=a[u];if(h.charAt(0)==="$")continue;if(h==="options"){r.push(...this._animateOptions(e,t));continue}const d=t[h];let f=o[h];const m=i.get(h);if(f)if(m&&f.active()){f.update(m,d,c);continue}else f.cancel();if(!m||!m.duration){e[h]=d;continue}o[h]=f=new Animation(m,e,h,d),r.push(f)}return r}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const i=this._createAnimations(e,t);if(i.length)return animator.add(this._chart,i),!0}};function awaitAll(e,t){const i=[],r=Object.keys(t);for(let o=0;o<r.length;o++){const a=e[r[o]];a&&a.active()&&i.push(a.wait())}return Promise.all(i)}function resolveTargetOptions(e,t){if(!t)return;let i=e.options;if(!i){e.options=t;return}return i.$shared&&(e.options=i=Object.assign({},i,{$shared:!1,$animations:{}})),i}function scaleClip(e,t){const i=e&&e.options||{},r=i.reverse,o=i.min===void 0?t:0,a=i.max===void 0?t:0;return{start:r?a:o,end:r?o:a}}function defaultClip(e,t,i){if(i===!1)return!1;const r=scaleClip(e,i),o=scaleClip(t,i);return{top:o.end,right:r.end,bottom:o.start,left:r.start}}function toClip(e){let t,i,r,o;return isObject$14(e)?(t=e.top,i=e.right,r=e.bottom,o=e.left):t=i=r=o=e,{top:t,right:i,bottom:r,left:o,disabled:e===!1}}function getSortedDatasetIndices(e,t){const i=[],r=e._getSortedDatasetMetas(t);let o,a;for(o=0,a=r.length;o<a;++o)i.push(r[o].index);return i}function applyStack(e,t,i,r={}){const o=e.keys,a=r.mode==="single";let c,u,h,d;if(t===null)return;let f=!1;for(c=0,u=o.length;c<u;++c){if(h=+o[c],h===i){if(f=!0,r.all)continue;break}d=e.values[h],isNumberFinite(d)&&(a||t===0||sign(t)===sign(d))&&(t+=d)}return!f&&!r.all?0:t}function convertObjectDataToArray(e,t){const{iScale:i,vScale:r}=t,o=i.axis==="x"?"x":"y",a=r.axis==="x"?"x":"y",c=Object.keys(e),u=new Array(c.length);let h,d,f;for(h=0,d=c.length;h<d;++h)f=c[h],u[h]={[o]:f,[a]:e[f]};return u}function isStacked(e,t){const i=e&&e.options.stacked;return i||i===void 0&&t.stack!==void 0}function getStackKey(e,t,i){return`${e.id}.${t.id}.${i.stack||i.type}`}function getUserBounds(e){const{min:t,max:i,minDefined:r,maxDefined:o}=e.getUserBounds();return{min:r?t:Number.NEGATIVE_INFINITY,max:o?i:Number.POSITIVE_INFINITY}}function getOrCreateStack(e,t,i){const r=e[t]||(e[t]={});return r[i]||(r[i]={})}function getLastIndexInStack(e,t,i,r){for(const o of t.getMatchingVisibleMetas(r).reverse()){const a=e[o.index];if(i&&a>0||!i&&a<0)return o.index}return null}function updateStacks(e,t){const{chart:i,_cachedMeta:r}=e,o=i._stacks||(i._stacks={}),{iScale:a,vScale:c,index:u}=r,h=a.axis,d=c.axis,f=getStackKey(a,c,r),m=t.length;let g;for(let v=0;v<m;++v){const _=t[v],{[h]:b,[d]:S}=_,T=_._stacks||(_._stacks={});g=T[d]=getOrCreateStack(o,f,b),g[u]=S,g._top=getLastIndexInStack(g,c,!0,r.type),g._bottom=getLastIndexInStack(g,c,!1,r.type);const A=g._visualValues||(g._visualValues={});A[u]=S}}function getFirstScaleId(e,t){const i=e.scales;return Object.keys(i).filter(r=>i[r].axis===t).shift()}function createDatasetContext(e,t){return createContext$1(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function createDataContext(e,t,i){return createContext$1(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:i,index:t,mode:"default",type:"data"})}function clearStacks(e,t){const i=e.controller.index,r=e.vScale&&e.vScale.axis;if(r){t=t||e._parsed;for(const o of t){const a=o._stacks;if(!a||a[r]===void 0||a[r][i]===void 0)return;delete a[r][i],a[r]._visualValues!==void 0&&a[r]._visualValues[i]!==void 0&&delete a[r]._visualValues[i]}}}const isDirectUpdateMode=e=>e==="reset"||e==="none",cloneIfNotShared=(e,t)=>t?e:Object.assign({},e),createStack=(e,t,i)=>e&&!t.hidden&&t._stacked&&{keys:getSortedDatasetIndices(i,!0),values:null};var DatasetController=class{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=isStacked(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&clearStacks(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,i=this.getDataset(),r=(f,m,g,v)=>f==="x"?m:f==="r"?v:g,o=t.xAxisID=valueOrDefault(i.xAxisID,getFirstScaleId(e,"x")),a=t.yAxisID=valueOrDefault(i.yAxisID,getFirstScaleId(e,"y")),c=t.rAxisID=valueOrDefault(i.rAxisID,getFirstScaleId(e,"r")),u=t.indexAxis,h=t.iAxisID=r(u,o,a,c),d=t.vAxisID=r(u,a,o,c);t.xScale=this.getScaleForId(o),t.yScale=this.getScaleForId(a),t.rScale=this.getScaleForId(c),t.iScale=this.getScaleForId(h),t.vScale=this.getScaleForId(d)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&unlistenArrayEvents(this._data,this),e._stacked&&clearStacks(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),i=this._data;if(isObject$14(t)){const r=this._cachedMeta;this._data=convertObjectDataToArray(t,r)}else if(i!==t){if(i){unlistenArrayEvents(i,this);const r=this._cachedMeta;clearStacks(r),r._parsed=[]}t&&Object.isExtensible(t)&&listenArrayEvents(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,i=this.getDataset();let r=!1;this._dataCheck();const o=t._stacked;t._stacked=isStacked(t.vScale,t),t.stack!==i.stack&&(r=!0,clearStacks(t),t.stack=i.stack),this._resyncElements(e),(r||o!==t._stacked)&&(updateStacks(this,t._parsed),t._stacked=isStacked(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),i=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:i,_data:r}=this,{iScale:o,_stacked:a}=i,c=o.axis;let u=e===0&&t===r.length?!0:i._sorted,h=e>0&&i._parsed[e-1],d,f,m;if(this._parsing===!1)i._parsed=r,i._sorted=!0,m=r;else{isArray$4(r[e])?m=this.parseArrayData(i,r,e,t):isObject$14(r[e])?m=this.parseObjectData(i,r,e,t):m=this.parsePrimitiveData(i,r,e,t);const g=()=>f[c]===null||h&&f[c]<h[c];for(d=0;d<t;++d)i._parsed[d+e]=f=m[d],u&&(g()&&(u=!1),h=f);i._sorted=u}a&&updateStacks(this,m)}parsePrimitiveData(e,t,i,r){const{iScale:o,vScale:a}=e,c=o.axis,u=a.axis,h=o.getLabels(),d=o===a,f=new Array(r);let m,g,v;for(m=0,g=r;m<g;++m)v=m+i,f[m]={[c]:d||o.parse(h[v],v),[u]:a.parse(t[v],v)};return f}parseArrayData(e,t,i,r){const{xScale:o,yScale:a}=e,c=new Array(r);let u,h,d,f;for(u=0,h=r;u<h;++u)d=u+i,f=t[d],c[u]={x:o.parse(f[0],d),y:a.parse(f[1],d)};return c}parseObjectData(e,t,i,r){const{xScale:o,yScale:a}=e,{xAxisKey:c="x",yAxisKey:u="y"}=this._parsing,h=new Array(r);let d,f,m,g;for(d=0,f=r;d<f;++d)m=d+i,g=t[m],h[d]={x:o.parse(resolveObjectKey(g,c),m),y:a.parse(resolveObjectKey(g,u),m)};return h}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,i){const r=this.chart,o=this._cachedMeta,a=t[e.axis],c={keys:getSortedDatasetIndices(r,!0),values:t._stacks[e.axis]._visualValues};return applyStack(c,a,o.index,{mode:i})}updateRangeFromParsed(e,t,i,r){const o=i[t.axis];let a=o===null?NaN:o;const c=r&&i._stacks[t.axis];r&&c&&(r.values=c,a=applyStack(r,o,this._cachedMeta.index)),e.min=Math.min(e.min,a),e.max=Math.max(e.max,a)}getMinMax(e,t){const i=this._cachedMeta,r=i._parsed,o=i._sorted&&e===i.iScale,a=r.length,c=this._getOtherScale(e),u=createStack(t,i,this.chart),h={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:d,max:f}=getUserBounds(c);let m,g;function v(){g=r[m];const _=g[c.axis];return!isNumberFinite(g[e.axis])||d>_||f<_}for(m=0;m<a&&!(!v()&&(this.updateRangeFromParsed(h,e,g,u),o));++m);if(o){for(m=a-1;m>=0;--m)if(!v()){this.updateRangeFromParsed(h,e,g,u);break}}return h}getAllParsedValues(e){const t=this._cachedMeta._parsed,i=[];let r,o,a;for(r=0,o=t.length;r<o;++r)a=t[r][e.axis],isNumberFinite(a)&&i.push(a);return i}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,i=t.iScale,r=t.vScale,o=this.getParsed(e);return{label:i?""+i.getLabelForValue(o[i.axis]):"",value:r?""+r.getLabelForValue(o[r.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=toClip(valueOrDefault(this.options.clip,defaultClip(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,i=this._cachedMeta,r=i.data||[],o=t.chartArea,a=[],c=this._drawStart||0,u=this._drawCount||r.length-c,h=this.options.drawActiveElementsOnTop;let d;for(i.dataset&&i.dataset.draw(e,o,c,u),d=c;d<c+u;++d){const f=r[d];f.hidden||(f.active&&h?a.push(f):f.draw(e,o))}for(d=0;d<a.length;++d)a[d].draw(e,o)}getStyle(e,t){const i=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(e||0,i)}getContext(e,t,i){const r=this.getDataset();let o;if(e>=0&&e<this._cachedMeta.data.length){const a=this._cachedMeta.data[e];o=a.$context||(a.$context=createDataContext(this.getContext(),e,a)),o.parsed=this.getParsed(e),o.raw=r.data[e],o.index=o.dataIndex=e}else o=this.$context||(this.$context=createDatasetContext(this.chart.getContext(),this.index)),o.dataset=r,o.index=o.datasetIndex=this.index;return o.active=!!t,o.mode=i,o}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",i){const r=t==="active",o=this._cachedDataOpts,a=e+"-"+t,c=o[a],u=this.enableOptionSharing&&defined(i);if(c)return cloneIfNotShared(c,u);const h=this.chart.config,d=h.datasetElementScopeKeys(this._type,e),f=r?[`${e}Hover`,"hover",e,""]:[e,""],m=h.getOptionScopes(this.getDataset(),d),g=Object.keys(defaults$2.elements[e]),v=()=>this.getContext(i,r,t),_=h.resolveNamedOptions(m,g,v,f);return _.$shared&&(_.$shared=u,o[a]=Object.freeze(cloneIfNotShared(_,u))),_}_resolveAnimations(e,t,i){const r=this.chart,o=this._cachedDataOpts,a=`animation-${t}`,c=o[a];if(c)return c;let u;if(r.options.animation!==!1){const d=this.chart.config,f=d.datasetAnimationScopeKeys(this._type,t),m=d.getOptionScopes(this.getDataset(),f);u=d.createResolver(m,this.getContext(e,i,t))}const h=new Animations(r,u&&u.animations);return u&&u._cacheable&&(o[a]=Object.freeze(h)),h}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||isDirectUpdateMode(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const i=this.resolveDataElementOptions(e,t),r=this._sharedOptions,o=this.getSharedOptions(i),a=this.includeOptions(t,o)||o!==r;return this.updateSharedOptions(o,t,i),{sharedOptions:o,includeOptions:a}}updateElement(e,t,i,r){isDirectUpdateMode(r)?Object.assign(e,i):this._resolveAnimations(t,r).update(e,i)}updateSharedOptions(e,t,i){e&&!isDirectUpdateMode(t)&&this._resolveAnimations(void 0,t).update(e,i)}_setStyle(e,t,i,r){e.active=r;const o=this.getStyle(t,r);this._resolveAnimations(t,i,r).update(e,{options:!r&&this.getSharedOptions(o)||o})}removeHoverStyle(e,t,i){this._setStyle(e,i,"active",!1)}setHoverStyle(e,t,i){this._setStyle(e,i,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,i=this._cachedMeta.data;for(const[c,u,h]of this._syncList)this[c](u,h);this._syncList=[];const r=i.length,o=t.length,a=Math.min(o,r);a&&this.parse(0,a),o>r?this._insertElements(r,o-r,e):o<r&&this._removeElements(o,r-o)}_insertElements(e,t,i=!0){const r=this._cachedMeta,o=r.data,a=e+t;let c;const u=h=>{for(h.length+=t,c=h.length-1;c>=a;c--)h[c]=h[c-t]};for(u(o),c=e;c<a;++c)o[c]=new this.dataElementType;this._parsing&&u(r._parsed),this.parse(e,t),i&&this.updateElements(o,e,t,"reset")}updateElements(e,t,i,r){}_removeElements(e,t){const i=this._cachedMeta;if(this._parsing){const r=i._parsed.splice(e,t);i._stacked&&clearStacks(i,r)}i.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,i,r]=e;this[t](i,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const i=arguments.length-2;i&&this._sync(["_insertElements",e,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}};function abstract(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}var DateAdapterBase=class Xr{static override(t){Object.assign(Xr.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return abstract()}parse(){return abstract()}format(){return abstract()}add(){return abstract()}diff(){return abstract()}startOf(){return abstract()}endOf(){return abstract()}},adapters={_date:DateAdapterBase};function binarySearch(e,t,i,r){const{controller:o,data:a,_sorted:c}=e,u=o._cachedMeta.iScale;if(u&&t===u.axis&&t!=="r"&&c&&a.length){const h=u._reversePixels?_rlookupByKey:_lookupByKey;if(r){if(o._sharedOptions){const d=a[0],f=typeof d.getRange=="function"&&d.getRange(t);if(f){const m=h(a,t,i-f),g=h(a,t,i+f);return{lo:m.lo,hi:g.hi}}}}else return h(a,t,i)}return{lo:0,hi:a.length-1}}function evaluateInteractionItems(e,t,i,r,o){const a=e.getSortedVisibleDatasetMetas(),c=i[t];for(let u=0,h=a.length;u<h;++u){const{index:d,data:f}=a[u],{lo:m,hi:g}=binarySearch(a[u],t,c,o);for(let v=m;v<=g;++v){const _=f[v];_.skip||r(_,d,v)}}}function getDistanceMetricForAxis(e){const t=e.indexOf("x")!==-1,i=e.indexOf("y")!==-1;return function(r,o){const a=t?Math.abs(r.x-o.x):0,c=i?Math.abs(r.y-o.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(c,2))}}function getIntersectItems(e,t,i,r,o){const a=[];return!o&&!e.isPointInArea(t)||evaluateInteractionItems(e,i,t,function(u,h,d){!o&&!_isPointInArea(u,e.chartArea,0)||u.inRange(t.x,t.y,r)&&a.push({element:u,datasetIndex:h,index:d})},!0),a}function getNearestRadialItems(e,t,i,r){let o=[];function a(c,u,h){const{startAngle:d,endAngle:f}=c.getProps(["startAngle","endAngle"],r),{angle:m}=getAngleFromPoint(c,{x:t.x,y:t.y});_angleBetween(m,d,f)&&o.push({element:c,datasetIndex:u,index:h})}return evaluateInteractionItems(e,i,t,a),o}function getNearestCartesianItems(e,t,i,r,o,a){let c=[];const u=getDistanceMetricForAxis(i);let h=Number.POSITIVE_INFINITY;function d(f,m,g){const v=f.inRange(t.x,t.y,o);if(r&&!v)return;const _=f.getCenterPoint(o);if(!(!!a||e.isPointInArea(_))&&!v)return;const S=u(t,_);S<h?(c=[{element:f,datasetIndex:m,index:g}],h=S):S===h&&c.push({element:f,datasetIndex:m,index:g})}return evaluateInteractionItems(e,i,t,d),c}function getNearestItems(e,t,i,r,o,a){return!a&&!e.isPointInArea(t)?[]:i==="r"&&!r?getNearestRadialItems(e,t,i,o):getNearestCartesianItems(e,t,i,r,o,a)}function getAxisItems(e,t,i,r,o){const a=[],c=i==="x"?"inXRange":"inYRange";let u=!1;return evaluateInteractionItems(e,i,t,(h,d,f)=>{h[c]&&h[c](t[i],o)&&(a.push({element:h,datasetIndex:d,index:f}),u=u||h.inRange(t.x,t.y,o))}),r&&!u?[]:a}var Interaction={evaluateInteractionItems,modes:{index(e,t,i,r){const o=getRelativePosition(t,e),a=i.axis||"x",c=i.includeInvisible||!1,u=i.intersect?getIntersectItems(e,o,a,r,c):getNearestItems(e,o,a,!1,r,c),h=[];return u.length?(e.getSortedVisibleDatasetMetas().forEach(d=>{const f=u[0].index,m=d.data[f];m&&!m.skip&&h.push({element:m,datasetIndex:d.index,index:f})}),h):[]},dataset(e,t,i,r){const o=getRelativePosition(t,e),a=i.axis||"xy",c=i.includeInvisible||!1;let u=i.intersect?getIntersectItems(e,o,a,r,c):getNearestItems(e,o,a,!1,r,c);if(u.length>0){const h=u[0].datasetIndex,d=e.getDatasetMeta(h).data;u=[];for(let f=0;f<d.length;++f)u.push({element:d[f],datasetIndex:h,index:f})}return u},point(e,t,i,r){const o=getRelativePosition(t,e),a=i.axis||"xy",c=i.includeInvisible||!1;return getIntersectItems(e,o,a,r,c)},nearest(e,t,i,r){const o=getRelativePosition(t,e),a=i.axis||"xy",c=i.includeInvisible||!1;return getNearestItems(e,o,a,i.intersect,r,c)},x(e,t,i,r){const o=getRelativePosition(t,e);return getAxisItems(e,o,"x",i.intersect,r)},y(e,t,i,r){const o=getRelativePosition(t,e);return getAxisItems(e,o,"y",i.intersect,r)}}};const STATIC_POSITIONS=["left","top","right","bottom"];function filterByPosition(e,t){return e.filter(i=>i.pos===t)}function filterDynamicPositionByAxis(e,t){return e.filter(i=>STATIC_POSITIONS.indexOf(i.pos)===-1&&i.box.axis===t)}function sortByWeight(e,t){return e.sort((i,r)=>{const o=t?r:i,a=t?i:r;return o.weight===a.weight?o.index-a.index:o.weight-a.weight})}function wrapBoxes(e){const t=[];let i,r,o,a,c,u;for(i=0,r=(e||[]).length;i<r;++i)o=e[i],{position:a,options:{stack:c,stackWeight:u=1}}=o,t.push({index:i,box:o,pos:a,horizontal:o.isHorizontal(),weight:o.weight,stack:c&&a+c,stackWeight:u});return t}function buildStacks(e){const t={};for(const i of e){const{stack:r,pos:o,stackWeight:a}=i;if(!r||!STATIC_POSITIONS.includes(o))continue;const c=t[r]||(t[r]={count:0,placed:0,weight:0,size:0});c.count++,c.weight+=a}return t}function setLayoutDims(e,t){const i=buildStacks(e),{vBoxMaxWidth:r,hBoxMaxHeight:o}=t;let a,c,u;for(a=0,c=e.length;a<c;++a){u=e[a];const{fullSize:h}=u.box,d=i[u.stack],f=d&&u.stackWeight/d.weight;u.horizontal?(u.width=f?f*r:h&&t.availableWidth,u.height=o):(u.width=r,u.height=f?f*o:h&&t.availableHeight)}return i}function buildLayoutBoxes(e){const t=wrapBoxes(e),i=sortByWeight(t.filter(d=>d.box.fullSize),!0),r=sortByWeight(filterByPosition(t,"left"),!0),o=sortByWeight(filterByPosition(t,"right")),a=sortByWeight(filterByPosition(t,"top"),!0),c=sortByWeight(filterByPosition(t,"bottom")),u=filterDynamicPositionByAxis(t,"x"),h=filterDynamicPositionByAxis(t,"y");return{fullSize:i,leftAndTop:r.concat(a),rightAndBottom:o.concat(h).concat(c).concat(u),chartArea:filterByPosition(t,"chartArea"),vertical:r.concat(o).concat(h),horizontal:a.concat(c).concat(u)}}function getCombinedMax(e,t,i,r){return Math.max(e[i],t[i])+Math.max(e[r],t[r])}function updateMaxPadding(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function updateDims(e,t,i,r){const{pos:o,box:a}=i,c=e.maxPadding;if(!isObject$14(o)){i.size&&(e[o]-=i.size);const m=r[i.stack]||{size:0,count:1};m.size=Math.max(m.size,i.horizontal?a.height:a.width),i.size=m.size/m.count,e[o]+=i.size}a.getPadding&&updateMaxPadding(c,a.getPadding());const u=Math.max(0,t.outerWidth-getCombinedMax(c,e,"left","right")),h=Math.max(0,t.outerHeight-getCombinedMax(c,e,"top","bottom")),d=u!==e.w,f=h!==e.h;return e.w=u,e.h=h,i.horizontal?{same:d,other:f}:{same:f,other:d}}function handleMaxPadding(e){const t=e.maxPadding;function i(r){const o=Math.max(t[r]-e[r],0);return e[r]+=o,o}e.y+=i("top"),e.x+=i("left"),i("right"),i("bottom")}function getMargins(e,t){const i=t.maxPadding;function r(o){const a={left:0,top:0,right:0,bottom:0};return o.forEach(c=>{a[c]=Math.max(t[c],i[c])}),a}return r(e?["left","right"]:["top","bottom"])}function fitBoxes(e,t,i,r){const o=[];let a,c,u,h,d,f;for(a=0,c=e.length,d=0;a<c;++a){u=e[a],h=u.box,h.update(u.width||t.w,u.height||t.h,getMargins(u.horizontal,t));const{same:m,other:g}=updateDims(t,i,u,r);d|=m&&o.length,f=f||g,h.fullSize||o.push(u)}return d&&fitBoxes(o,t,i,r)||f}function setBoxDims(e,t,i,r,o){e.top=i,e.left=t,e.right=t+r,e.bottom=i+o,e.width=r,e.height=o}function placeBoxes(e,t,i,r){const o=i.padding;let{x:a,y:c}=t;for(const u of e){const h=u.box,d=r[u.stack]||{count:1,placed:0,weight:1},f=u.stackWeight/d.weight||1;if(u.horizontal){const m=t.w*f,g=d.size||h.height;defined(d.start)&&(c=d.start),h.fullSize?setBoxDims(h,o.left,c,i.outerWidth-o.right-o.left,g):setBoxDims(h,t.left+d.placed,c,m,g),d.start=c,d.placed+=m,c=h.bottom}else{const m=t.h*f,g=d.size||h.width;defined(d.start)&&(a=d.start),h.fullSize?setBoxDims(h,a,o.top,g,i.outerHeight-o.bottom-o.top):setBoxDims(h,a,t.top+d.placed,g,m),d.start=a,d.placed+=m,a=h.right}}t.x=a,t.y=c}var layouts={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(i){t.draw(i)}}]},e.boxes.push(t)},removeBox(e,t){const i=e.boxes?e.boxes.indexOf(t):-1;i!==-1&&e.boxes.splice(i,1)},configure(e,t,i){t.fullSize=i.fullSize,t.position=i.position,t.weight=i.weight},update(e,t,i,r){if(!e)return;const o=toPadding(e.options.layout.padding),a=Math.max(t-o.width,0),c=Math.max(i-o.height,0),u=buildLayoutBoxes(e.boxes),h=u.vertical,d=u.horizontal;each(e.boxes,b=>{typeof b.beforeLayout=="function"&&b.beforeLayout()});const f=h.reduce((b,S)=>S.box.options&&S.box.options.display===!1?b:b+1,0)||1,m=Object.freeze({outerWidth:t,outerHeight:i,padding:o,availableWidth:a,availableHeight:c,vBoxMaxWidth:a/2/f,hBoxMaxHeight:c/2}),g=Object.assign({},o);updateMaxPadding(g,toPadding(r));const v=Object.assign({maxPadding:g,w:a,h:c,x:o.left,y:o.top},o),_=setLayoutDims(h.concat(d),m);fitBoxes(u.fullSize,v,m,_),fitBoxes(h,v,m,_),fitBoxes(d,v,m,_)&&fitBoxes(h,v,m,_),handleMaxPadding(v),placeBoxes(u.leftAndTop,v,m,_),v.x+=v.w,v.y+=v.h,placeBoxes(u.rightAndBottom,v,m,_),e.chartArea={left:v.left,top:v.top,right:v.left+v.w,bottom:v.top+v.h,height:v.h,width:v.w},each(u.chartArea,b=>{const S=b.box;Object.assign(S,e.chartArea),S.update(v.w,v.h,{left:0,top:0,right:0,bottom:0})})}},BasePlatform=class{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,i){}removeEventListener(e,t,i){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,i,r){return t=Math.max(0,t||e.width),i=i||e.height,{width:t,height:Math.max(0,r?Math.floor(t/r):i)}}isAttached(e){return!0}updateConfig(e){}},BasicPlatform=class extends BasePlatform{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}};const EXPANDO_KEY="$chartjs",EVENT_TYPES={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},isNullOrEmpty=e=>e===null||e==="";function initCanvas(e,t){const i=e.style,r=e.getAttribute("height"),o=e.getAttribute("width");if(e[EXPANDO_KEY]={initial:{height:r,width:o,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",i.boxSizing=i.boxSizing||"border-box",isNullOrEmpty(o)){const a=readUsedSize(e,"width");a!==void 0&&(e.width=a)}if(isNullOrEmpty(r))if(e.style.height==="")e.height=e.width/(t||2);else{const a=readUsedSize(e,"height");a!==void 0&&(e.height=a)}return e}const eventListenerOptions=supportsEventListenerOptions?{passive:!0}:!1;function addListener(e,t,i){e&&e.addEventListener(t,i,eventListenerOptions)}function removeListener(e,t,i){e&&e.canvas&&e.canvas.removeEventListener(t,i,eventListenerOptions)}function fromNativeEvent(e,t){const i=EVENT_TYPES[e.type]||e.type,{x:r,y:o}=getRelativePosition(e,t);return{type:i,chart:t,native:e,x:r!==void 0?r:null,y:o!==void 0?o:null}}function nodeListContains(e,t){for(const i of e)if(i===t||i.contains(t))return!0}function createAttachObserver(e,t,i){const r=e.canvas,o=new MutationObserver(a=>{let c=!1;for(const u of a)c=c||nodeListContains(u.addedNodes,r),c=c&&!nodeListContains(u.removedNodes,r);c&&i()});return o.observe(document,{childList:!0,subtree:!0}),o}function createDetachObserver(e,t,i){const r=e.canvas,o=new MutationObserver(a=>{let c=!1;for(const u of a)c=c||nodeListContains(u.removedNodes,r),c=c&&!nodeListContains(u.addedNodes,r);c&&i()});return o.observe(document,{childList:!0,subtree:!0}),o}const drpListeningCharts=new Map;let oldDevicePixelRatio=0;function onWindowResize(){const e=window.devicePixelRatio;e!==oldDevicePixelRatio&&(oldDevicePixelRatio=e,drpListeningCharts.forEach((t,i)=>{i.currentDevicePixelRatio!==e&&t()}))}function listenDevicePixelRatioChanges(e,t){drpListeningCharts.size||window.addEventListener("resize",onWindowResize),drpListeningCharts.set(e,t)}function unlistenDevicePixelRatioChanges(e){drpListeningCharts.delete(e),drpListeningCharts.size||window.removeEventListener("resize",onWindowResize)}function createResizeObserver(e,t,i){const r=e.canvas,o=r&&_getParentNode(r);if(!o)return;const a=throttled((u,h)=>{const d=o.clientWidth;i(u,h),d<o.clientWidth&&i()},window),c=new ResizeObserver(u=>{const h=u[0],d=h.contentRect.width,f=h.contentRect.height;d===0&&f===0||a(d,f)});return c.observe(o),listenDevicePixelRatioChanges(e,a),c}function releaseObserver(e,t,i){i&&i.disconnect(),t==="resize"&&unlistenDevicePixelRatioChanges(e)}function createProxyAndListen(e,t,i){const r=e.canvas,o=throttled(a=>{e.ctx!==null&&i(fromNativeEvent(a,e))},e);return addListener(r,t,o),o}var DomPlatform=class extends BasePlatform{acquireContext(e,t){const i=e&&e.getContext&&e.getContext("2d");return i&&i.canvas===e?(initCanvas(e,t),i):null}releaseContext(e){const t=e.canvas;if(!t[EXPANDO_KEY])return!1;const i=t[EXPANDO_KEY].initial;["height","width"].forEach(o=>{const a=i[o];isNullOrUndef(a)?t.removeAttribute(o):t.setAttribute(o,a)});const r=i.style||{};return Object.keys(r).forEach(o=>{t.style[o]=r[o]}),t.width=t.width,delete t[EXPANDO_KEY],!0}addEventListener(e,t,i){this.removeEventListener(e,t);const r=e.$proxies||(e.$proxies={}),a={attach:createAttachObserver,detach:createDetachObserver,resize:createResizeObserver}[t]||createProxyAndListen;r[t]=a(e,t,i)}removeEventListener(e,t){const i=e.$proxies||(e.$proxies={}),r=i[t];if(!r)return;({attach:releaseObserver,detach:releaseObserver,resize:releaseObserver}[t]||removeListener)(e,t,r),i[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,i,r){return getMaximumSize(e,t,i,r)}isAttached(e){const t=e&&_getParentNode(e);return!!(t&&t.isConnected)}};function _detectPlatform(e){return!_isDomSupported()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?BasicPlatform:DomPlatform}var Element$3=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}hasValue(){return isNumber$1(this.x)&&isNumber$1(this.y)}getProps(e,t){const i=this.$animations;if(!t||!i)return this;const r={};return e.forEach(o=>{r[o]=i[o]&&i[o].active()?i[o]._to:this[o]}),r}};function autoSkip(e,t){const i=e.options.ticks,r=determineMaxTicks(e),o=Math.min(i.maxTicksLimit||r,r),a=i.major.enabled?getMajorIndices(t):[],c=a.length,u=a[0],h=a[c-1],d=[];if(c>o)return skipMajors(t,d,a,c/o),d;const f=calculateSpacing(a,t,o);if(c>0){let m,g;const v=c>1?Math.round((h-u)/(c-1)):null;for(skip(t,d,f,isNullOrUndef(v)?0:u-v,u),m=0,g=c-1;m<g;m++)skip(t,d,f,a[m],a[m+1]);return skip(t,d,f,h,isNullOrUndef(v)?t.length:h+v),d}return skip(t,d,f),d}function determineMaxTicks(e){const t=e.options.offset,i=e._tickSize(),r=e._length/i+(t?0:1),o=e._maxLength/i;return Math.floor(Math.min(r,o))}function calculateSpacing(e,t,i){const r=getEvenSpacing(e),o=t.length/i;if(!r)return Math.max(o,1);const a=_factorize(r);for(let c=0,u=a.length-1;c<u;c++){const h=a[c];if(h>o)return h}return Math.max(o,1)}function getMajorIndices(e){const t=[];let i,r;for(i=0,r=e.length;i<r;i++)e[i].major&&t.push(i);return t}function skipMajors(e,t,i,r){let o=0,a=i[0],c;for(r=Math.ceil(r),c=0;c<e.length;c++)c===a&&(t.push(e[c]),o++,a=i[o*r])}function skip(e,t,i,r,o){const a=valueOrDefault(r,0),c=Math.min(valueOrDefault(o,e.length),e.length);let u=0,h,d,f;for(i=Math.ceil(i),o&&(h=o-r,i=h/Math.floor(h/i)),f=a;f<0;)u++,f=Math.round(a+u*i);for(d=Math.max(a,0);d<c;d++)d===f&&(t.push(e[d]),u++,f=Math.round(a+u*i))}function getEvenSpacing(e){const t=e.length;let i,r;if(t<2)return!1;for(r=e[0],i=1;i<t;++i)if(e[i]-e[i-1]!==r)return!1;return r}const reverseAlign=e=>e==="left"?"right":e==="right"?"left":e,offsetFromEdge=(e,t,i)=>t==="top"||t==="left"?e[t]+i:e[t]-i,getTicksLimit=(e,t)=>Math.min(t||e,e);function sample(e,t){const i=[],r=e.length/t,o=e.length;let a=0;for(;a<o;a+=r)i.push(e[Math.floor(a)]);return i}function getPixelForGridLine(e,t,i){const r=e.ticks.length,o=Math.min(t,r-1),a=e._startPixel,c=e._endPixel,u=1e-6;let h=e.getPixelForTick(o),d;if(!(i&&(r===1?d=Math.max(h-a,c-h):t===0?d=(e.getPixelForTick(1)-h)/2:d=(h-e.getPixelForTick(o-1))/2,h+=o<t?d:-d,h<a-u||h>c+u)))return h}function garbageCollect(e,t){each(e,i=>{const r=i.gc,o=r.length/2;let a;if(o>t){for(a=0;a<o;++a)delete i.data[r[a]];r.splice(0,o)}})}function getTickMarkLength(e){return e.drawTicks?e.tickLength:0}function getTitleHeight(e,t){if(!e.display)return 0;const i=toFont(e.font,t),r=toPadding(e.padding);return(isArray$4(e.text)?e.text.length:1)*i.lineHeight+r.height}function createScaleContext(e,t){return createContext$1(e,{scale:t,type:"scale"})}function createTickContext(e,t,i){return createContext$1(e,{tick:i,index:t,type:"tick"})}function titleAlign(e,t,i){let r=_toLeftRightCenter(e);return(i&&t!=="right"||!i&&t==="right")&&(r=reverseAlign(r)),r}function titleArgs(e,t,i,r){const{top:o,left:a,bottom:c,right:u,chart:h}=e,{chartArea:d,scales:f}=h;let m=0,g,v,_;const b=c-o,S=u-a;if(e.isHorizontal()){if(v=_alignStartEnd(r,a,u),isObject$14(i)){const T=Object.keys(i)[0],A=i[T];_=f[T].getPixelForValue(A)+b-t}else i==="center"?_=(d.bottom+d.top)/2+b-t:_=offsetFromEdge(e,i,t);g=u-a}else{if(isObject$14(i)){const T=Object.keys(i)[0],A=i[T];v=f[T].getPixelForValue(A)-S+t}else i==="center"?v=(d.left+d.right)/2-S+t:v=offsetFromEdge(e,i,t);_=_alignStartEnd(r,c,o),m=i==="left"?-HALF_PI:HALF_PI}return{titleX:v,titleY:_,maxWidth:g,rotation:m}}var Scale=class Jr extends Element$3{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,i){return t}getUserBounds(){let{_userMin:t,_userMax:i,_suggestedMin:r,_suggestedMax:o}=this;return t=finiteOrDefault(t,Number.POSITIVE_INFINITY),i=finiteOrDefault(i,Number.NEGATIVE_INFINITY),r=finiteOrDefault(r,Number.POSITIVE_INFINITY),o=finiteOrDefault(o,Number.NEGATIVE_INFINITY),{min:finiteOrDefault(t,r),max:finiteOrDefault(i,o),minDefined:isNumberFinite(t),maxDefined:isNumberFinite(i)}}getMinMax(t){let{min:i,max:r,minDefined:o,maxDefined:a}=this.getUserBounds(),c;if(o&&a)return{min:i,max:r};const u=this.getMatchingVisibleMetas();for(let h=0,d=u.length;h<d;++h)c=u[h].controller.getMinMax(this,t),o||(i=Math.min(i,c.min)),a||(r=Math.max(r,c.max));return i=a&&i>r?r:i,r=o&&i>r?i:r,{min:finiteOrDefault(i,finiteOrDefault(r,i)),max:finiteOrDefault(r,finiteOrDefault(i,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){callback(this.options.beforeUpdate,[this])}update(t,i,r){const{beginAtZero:o,grace:a,ticks:c}=this.options,u=c.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=i,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=_addGrace(this,a,o),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const h=u<this.ticks.length;this._convertTicksToLabels(h?sample(this.ticks,u):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),c.display&&(c.autoSkip||c.source==="auto")&&(this.ticks=autoSkip(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),h&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,i,r;this.isHorizontal()?(i=this.left,r=this.right):(i=this.top,r=this.bottom,t=!t),this._startPixel=i,this._endPixel=r,this._reversePixels=t,this._length=r-i,this._alignToPixels=this.options.alignToPixels}afterUpdate(){callback(this.options.afterUpdate,[this])}beforeSetDimensions(){callback(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){callback(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),callback(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){callback(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const i=this.options.ticks;let r,o,a;for(r=0,o=t.length;r<o;r++)a=t[r],a.label=callback(i.callback,[a.value,r,t],this)}afterTickToLabelConversion(){callback(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){callback(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,i=t.ticks,r=getTicksLimit(this.ticks.length,t.ticks.maxTicksLimit),o=i.minRotation||0,a=i.maxRotation;let c=o,u,h,d;if(!this._isVisible()||!i.display||o>=a||r<=1||!this.isHorizontal()){this.labelRotation=o;return}const f=this._getLabelSizes(),m=f.widest.width,g=f.highest.height,v=_limitValue(this.chart.width-m,0,this.maxWidth);u=t.offset?this.maxWidth/r:v/(r-1),m+6>u&&(u=v/(r-(t.offset?.5:1)),h=this.maxHeight-getTickMarkLength(t.grid)-i.padding-getTitleHeight(t.title,this.chart.options.font),d=Math.sqrt(m*m+g*g),c=toDegrees(Math.min(Math.asin(_limitValue((f.highest.height+6)/u,-1,1)),Math.asin(_limitValue(h/d,-1,1))-Math.asin(_limitValue(g/d,-1,1)))),c=Math.max(o,Math.min(a,c))),this.labelRotation=c}afterCalculateLabelRotation(){callback(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){callback(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:i,options:{ticks:r,title:o,grid:a}}=this,c=this._isVisible(),u=this.isHorizontal();if(c){const h=getTitleHeight(o,i.options.font);if(u?(t.width=this.maxWidth,t.height=getTickMarkLength(a)+h):(t.height=this.maxHeight,t.width=getTickMarkLength(a)+h),r.display&&this.ticks.length){const{first:d,last:f,widest:m,highest:g}=this._getLabelSizes(),v=r.padding*2,_=toRadians(this.labelRotation),b=Math.cos(_),S=Math.sin(_);if(u){const T=r.mirror?0:S*m.width+b*g.height;t.height=Math.min(this.maxHeight,t.height+T+v)}else{const T=r.mirror?0:b*m.width+S*g.height;t.width=Math.min(this.maxWidth,t.width+T+v)}this._calculatePadding(d,f,S,b)}}this._handleMargins(),u?(this.width=this._length=i.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=i.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,i,r,o){const{ticks:{align:a,padding:c},position:u}=this.options,h=this.labelRotation!==0,d=u!=="top"&&this.axis==="x";if(this.isHorizontal()){const f=this.getPixelForTick(0)-this.left,m=this.right-this.getPixelForTick(this.ticks.length-1);let g=0,v=0;h?d?(g=o*t.width,v=r*i.height):(g=r*t.height,v=o*i.width):a==="start"?v=i.width:a==="end"?g=t.width:a!=="inner"&&(g=t.width/2,v=i.width/2),this.paddingLeft=Math.max((g-f+c)*this.width/(this.width-f),0),this.paddingRight=Math.max((v-m+c)*this.width/(this.width-m),0)}else{let f=i.height/2,m=t.height/2;a==="start"?(f=0,m=t.height):a==="end"&&(f=i.height,m=0),this.paddingTop=f+c,this.paddingBottom=m+c}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){callback(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:i}=this.options;return i==="top"||i==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let i,r;for(i=0,r=t.length;i<r;i++)isNullOrUndef(t[i].label)&&(t.splice(i,1),r--,i--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const i=this.options.ticks.sampleSize;let r=this.ticks;i<r.length&&(r=sample(r,i)),this._labelSizes=t=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,i,r){const{ctx:o,_longestTextCache:a}=this,c=[],u=[],h=Math.floor(i/getTicksLimit(i,r));let d=0,f=0,m,g,v,_,b,S,T,A,I,R,O;for(m=0;m<i;m+=h){if(_=t[m].label,b=this._resolveTickFontOptions(m),o.font=S=b.string,T=a[S]=a[S]||{data:{},gc:[]},A=b.lineHeight,I=R=0,!isNullOrUndef(_)&&!isArray$4(_))I=_measureText(o,T.data,T.gc,I,_),R=A;else if(isArray$4(_))for(g=0,v=_.length;g<v;++g)O=_[g],!isNullOrUndef(O)&&!isArray$4(O)&&(I=_measureText(o,T.data,T.gc,I,O),R+=A);c.push(I),u.push(R),d=Math.max(I,d),f=Math.max(R,f)}garbageCollect(a,i);const P=c.indexOf(d),L=u.indexOf(f),V=U=>({width:c[U]||0,height:u[U]||0});return{first:V(0),last:V(i-1),widest:V(P),highest:V(L),widths:c,heights:u}}getLabelForValue(t){return t}getPixelForValue(t,i){return NaN}getValueForPixel(t){}getPixelForTick(t){const i=this.ticks;return t<0||t>i.length-1?null:this.getPixelForValue(i[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const i=this._startPixel+t*this._length;return _int16Range(this._alignToPixels?_alignPixel(this.chart,i,0):i)}getDecimalForPixel(t){const i=(t-this._startPixel)/this._length;return this._reversePixels?1-i:i}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:i}=this;return t<0&&i<0?i:t>0&&i>0?t:0}getContext(t){const i=this.ticks||[];if(t>=0&&t<i.length){const r=i[t];return r.$context||(r.$context=createTickContext(this.getContext(),t,r))}return this.$context||(this.$context=createScaleContext(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,i=toRadians(this.labelRotation),r=Math.abs(Math.cos(i)),o=Math.abs(Math.sin(i)),a=this._getLabelSizes(),c=t.autoSkipPadding||0,u=a?a.widest.width+c:0,h=a?a.highest.height+c:0;return this.isHorizontal()?h*r>u*o?u/r:h/o:h*o<u*r?h/r:u/o}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const i=this.axis,r=this.chart,o=this.options,{grid:a,position:c,border:u}=o,h=a.offset,d=this.isHorizontal(),m=this.ticks.length+(h?1:0),g=getTickMarkLength(a),v=[],_=u.setContext(this.getContext()),b=_.display?_.width:0,S=b/2,T=function(pe){return _alignPixel(r,pe,b)};let A,I,R,O,P,L,V,U,$,Z,ie,ue;if(c==="top")A=T(this.bottom),L=this.bottom-g,U=A-S,Z=T(t.top)+S,ue=t.bottom;else if(c==="bottom")A=T(this.top),Z=t.top,ue=T(t.bottom)-S,L=A+S,U=this.top+g;else if(c==="left")A=T(this.right),P=this.right-g,V=A-S,$=T(t.left)+S,ie=t.right;else if(c==="right")A=T(this.left),$=t.left,ie=T(t.right)-S,P=A+S,V=this.left+g;else if(i==="x"){if(c==="center")A=T((t.top+t.bottom)/2+.5);else if(isObject$14(c)){const pe=Object.keys(c)[0],me=c[pe];A=T(this.chart.scales[pe].getPixelForValue(me))}Z=t.top,ue=t.bottom,L=A+S,U=L+g}else if(i==="y"){if(c==="center")A=T((t.left+t.right)/2);else if(isObject$14(c)){const pe=Object.keys(c)[0],me=c[pe];A=T(this.chart.scales[pe].getPixelForValue(me))}P=A-S,V=P-g,$=t.left,ie=t.right}const _e=valueOrDefault(o.ticks.maxTicksLimit,m),Ee=Math.max(1,Math.ceil(m/_e));for(I=0;I<m;I+=Ee){const pe=this.getContext(I),me=a.setContext(pe),Se=u.setContext(pe),Le=me.lineWidth,xe=me.color,E=Se.dash||[],k=Se.dashOffset,D=me.tickWidth,q=me.tickColor,B=me.tickBorderDash||[],se=me.tickBorderDashOffset;R=getPixelForGridLine(this,I,h),R!==void 0&&(O=_alignPixel(r,R,Le),d?P=V=$=ie=O:L=U=Z=ue=O,v.push({tx1:P,ty1:L,tx2:V,ty2:U,x1:$,y1:Z,x2:ie,y2:ue,width:Le,color:xe,borderDash:E,borderDashOffset:k,tickWidth:D,tickColor:q,tickBorderDash:B,tickBorderDashOffset:se}))}return this._ticksLength=m,this._borderValue=A,v}_computeLabelItems(t){const i=this.axis,r=this.options,{position:o,ticks:a}=r,c=this.isHorizontal(),u=this.ticks,{align:h,crossAlign:d,padding:f,mirror:m}=a,g=getTickMarkLength(r.grid),v=g+f,_=m?-f:v,b=-toRadians(this.labelRotation),S=[];let T,A,I,R,O,P,L,V,U,$,Z,ie,ue="middle";if(o==="top")P=this.bottom-_,L=this._getXAxisLabelAlignment();else if(o==="bottom")P=this.top+_,L=this._getXAxisLabelAlignment();else if(o==="left"){const Ee=this._getYAxisLabelAlignment(g);L=Ee.textAlign,O=Ee.x}else if(o==="right"){const Ee=this._getYAxisLabelAlignment(g);L=Ee.textAlign,O=Ee.x}else if(i==="x"){if(o==="center")P=(t.top+t.bottom)/2+v;else if(isObject$14(o)){const Ee=Object.keys(o)[0],pe=o[Ee];P=this.chart.scales[Ee].getPixelForValue(pe)+v}L=this._getXAxisLabelAlignment()}else if(i==="y"){if(o==="center")O=(t.left+t.right)/2-v;else if(isObject$14(o)){const Ee=Object.keys(o)[0],pe=o[Ee];O=this.chart.scales[Ee].getPixelForValue(pe)}L=this._getYAxisLabelAlignment(g).textAlign}i==="y"&&(h==="start"?ue="top":h==="end"&&(ue="bottom"));const _e=this._getLabelSizes();for(T=0,A=u.length;T<A;++T){I=u[T],R=I.label;const Ee=a.setContext(this.getContext(T));V=this.getPixelForTick(T)+a.labelOffset,U=this._resolveTickFontOptions(T),$=U.lineHeight,Z=isArray$4(R)?R.length:1;const pe=Z/2,me=Ee.color,Se=Ee.textStrokeColor,Le=Ee.textStrokeWidth;let xe=L;c?(O=V,L==="inner"&&(T===A-1?xe=this.options.reverse?"left":"right":T===0?xe=this.options.reverse?"right":"left":xe="center"),o==="top"?d==="near"||b!==0?ie=-Z*$+$/2:d==="center"?ie=-_e.highest.height/2-pe*$+$:ie=-_e.highest.height+$/2:d==="near"||b!==0?ie=$/2:d==="center"?ie=_e.highest.height/2-pe*$:ie=_e.highest.height-Z*$,m&&(ie*=-1),b!==0&&!Ee.showLabelBackdrop&&(O+=$/2*Math.sin(b))):(P=V,ie=(1-Z)*$/2);let E;if(Ee.showLabelBackdrop){const k=toPadding(Ee.backdropPadding),D=_e.heights[T],q=_e.widths[T];let B=ie-k.top,se=0-k.left;switch(ue){case"middle":B-=D/2;break;case"bottom":B-=D;break}switch(L){case"center":se-=q/2;break;case"right":se-=q;break;case"inner":T===A-1?se-=q:T>0&&(se-=q/2);break}E={left:se,top:B,width:q+k.width,height:D+k.height,color:Ee.backdropColor}}S.push({label:R,font:U,textOffset:ie,options:{rotation:b,color:me,strokeColor:Se,strokeWidth:Le,textAlign:xe,textBaseline:ue,translation:[O,P],backdrop:E}})}return S}_getXAxisLabelAlignment(){const{position:t,ticks:i}=this.options;if(-toRadians(this.labelRotation))return t==="top"?"left":"right";let o="center";return i.align==="start"?o="left":i.align==="end"?o="right":i.align==="inner"&&(o="inner"),o}_getYAxisLabelAlignment(t){const{position:i,ticks:{crossAlign:r,mirror:o,padding:a}}=this.options,c=this._getLabelSizes(),u=t+a,h=c.widest.width;let d,f;return i==="left"?o?(f=this.right+a,r==="near"?d="left":r==="center"?(d="center",f+=h/2):(d="right",f+=h)):(f=this.right-u,r==="near"?d="right":r==="center"?(d="center",f-=h/2):(d="left",f=this.left)):i==="right"?o?(f=this.left+a,r==="near"?d="right":r==="center"?(d="center",f-=h/2):(d="left",f-=h)):(f=this.left+u,r==="near"?d="left":r==="center"?(d="center",f+=h/2):(d="right",f=this.right)):d="right",{textAlign:d,x:f}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,i=this.options.position;if(i==="left"||i==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(i==="top"||i==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:i},left:r,top:o,width:a,height:c}=this;i&&(t.save(),t.fillStyle=i,t.fillRect(r,o,a,c),t.restore())}getLineWidthForValue(t){const i=this.options.grid;if(!this._isVisible()||!i.display)return 0;const o=this.ticks.findIndex(a=>a.value===t);return o>=0?i.setContext(this.getContext(o)).lineWidth:0}drawGrid(t){const i=this.options.grid,r=this.ctx,o=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let a,c;const u=(h,d,f)=>{!f.width||!f.color||(r.save(),r.lineWidth=f.width,r.strokeStyle=f.color,r.setLineDash(f.borderDash||[]),r.lineDashOffset=f.borderDashOffset,r.beginPath(),r.moveTo(h.x,h.y),r.lineTo(d.x,d.y),r.stroke(),r.restore())};if(i.display)for(a=0,c=o.length;a<c;++a){const h=o[a];i.drawOnChartArea&&u({x:h.x1,y:h.y1},{x:h.x2,y:h.y2},h),i.drawTicks&&u({x:h.tx1,y:h.ty1},{x:h.tx2,y:h.ty2},{color:h.tickColor,width:h.tickWidth,borderDash:h.tickBorderDash,borderDashOffset:h.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:i,options:{border:r,grid:o}}=this,a=r.setContext(this.getContext()),c=r.display?a.width:0;if(!c)return;const u=o.setContext(this.getContext(0)).lineWidth,h=this._borderValue;let d,f,m,g;this.isHorizontal()?(d=_alignPixel(t,this.left,c)-c/2,f=_alignPixel(t,this.right,u)+u/2,m=g=h):(m=_alignPixel(t,this.top,c)-c/2,g=_alignPixel(t,this.bottom,u)+u/2,d=f=h),i.save(),i.lineWidth=a.width,i.strokeStyle=a.color,i.beginPath(),i.moveTo(d,m),i.lineTo(f,g),i.stroke(),i.restore()}drawLabels(t){if(!this.options.ticks.display)return;const r=this.ctx,o=this._computeLabelArea();o&&clipArea(r,o);const a=this.getLabelItems(t);for(const c of a){const u=c.options,h=c.font,d=c.label,f=c.textOffset;renderText(r,d,0,f,h,u)}o&&unclipArea(r)}drawTitle(){const{ctx:t,options:{position:i,title:r,reverse:o}}=this;if(!r.display)return;const a=toFont(r.font),c=toPadding(r.padding),u=r.align;let h=a.lineHeight/2;i==="bottom"||i==="center"||isObject$14(i)?(h+=c.bottom,isArray$4(r.text)&&(h+=a.lineHeight*(r.text.length-1))):h+=c.top;const{titleX:d,titleY:f,maxWidth:m,rotation:g}=titleArgs(this,h,i,u);renderText(t,r.text,0,0,a,{color:r.color,maxWidth:m,rotation:g,textAlign:titleAlign(u,i,o),textBaseline:"middle",translation:[d,f]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,i=t.ticks&&t.ticks.z||0,r=valueOrDefault(t.grid&&t.grid.z,-1),o=valueOrDefault(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Jr.prototype.draw?[{z:i,draw:a=>{this.draw(a)}}]:[{z:r,draw:a=>{this.drawBackground(),this.drawGrid(a),this.drawTitle()}},{z:o,draw:()=>{this.drawBorder()}},{z:i,draw:a=>{this.drawLabels(a)}}]}getMatchingVisibleMetas(t){const i=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",o=[];let a,c;for(a=0,c=i.length;a<c;++a){const u=i[a];u[r]===this.id&&(!t||u.type===t)&&o.push(u)}return o}_resolveTickFontOptions(t){const i=this.options.ticks.setContext(this.getContext(t));return toFont(i.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}},TypedRegistry=class{constructor(e,t,i){this.type=e,this.scope=t,this.override=i,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let i;isIChartComponent(t)&&(i=this.register(t));const r=this.items,o=e.id,a=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+e);return o in r||(r[o]=e,registerDefaults(e,a,i),this.override&&defaults$2.override(e.id,e.overrides)),a}get(e){return this.items[e]}unregister(e){const t=this.items,i=e.id,r=this.scope;i in t&&delete t[i],r&&i in defaults$2[r]&&(delete defaults$2[r][i],this.override&&delete overrides[i])}};function registerDefaults(e,t,i){const r=merge$2(Object.create(null),[i?defaults$2.get(i):{},defaults$2.get(t),e.defaults]);defaults$2.set(t,r),e.defaultRoutes&&routeDefaults(t,e.defaultRoutes),e.descriptors&&defaults$2.describe(t,e.descriptors)}function routeDefaults(e,t){Object.keys(t).forEach(i=>{const r=i.split("."),o=r.pop(),a=[e].concat(r).join("."),c=t[i].split("."),u=c.pop(),h=c.join(".");defaults$2.route(a,o,h,u)})}function isIChartComponent(e){return"id"in e&&"defaults"in e}var Registry=class{constructor(){this.controllers=new TypedRegistry(DatasetController,"datasets",!0),this.elements=new TypedRegistry(Element$3,"elements"),this.plugins=new TypedRegistry(Object,"plugins"),this.scales=new TypedRegistry(Scale,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,i){[...t].forEach(r=>{const o=i||this._getRegistryForType(r);i||o.isForType(r)||o===this.plugins&&r.id?this._exec(e,o,r):each(r,a=>{const c=i||this._getRegistryForType(a);this._exec(e,c,a)})})}_exec(e,t,i){const r=_capitalize(e);callback(i["before"+r],[],i),t[e](i),callback(i["after"+r],[],i)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const i=this._typedRegistries[t];if(i.isForType(e))return i}return this.plugins}_get(e,t,i){const r=t.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+i+".");return r}},registry=new Registry,PluginService=class{constructor(){this._init=[]}notify(e,t,i,r){t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const o=r?this._descriptors(e).filter(r):this._descriptors(e),a=this._notify(o,e,t,i);return t==="afterDestroy"&&(this._notify(o,e,"stop"),this._notify(this._init,e,"uninstall")),a}_notify(e,t,i,r){r=r||{};for(const o of e){const a=o.plugin,c=a[i],u=[t,r,o.options];if(callback(c,u,a)===!1&&r.cancelable)return!1}return!0}invalidate(){isNullOrUndef(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const i=e&&e.config,r=valueOrDefault(i.options&&i.options.plugins,{}),o=allPlugins(i);return r===!1&&!t?[]:createDescriptors(e,o,r,t)}_notifyStateChanges(e){const t=this._oldCache||[],i=this._cache,r=(o,a)=>o.filter(c=>!a.some(u=>c.plugin.id===u.plugin.id));this._notify(r(t,i),e,"stop"),this._notify(r(i,t),e,"start")}};function allPlugins(e){const t={},i=[],r=Object.keys(registry.plugins.items);for(let a=0;a<r.length;a++)i.push(registry.getPlugin(r[a]));const o=e.plugins||[];for(let a=0;a<o.length;a++){const c=o[a];i.indexOf(c)===-1&&(i.push(c),t[c.id]=!0)}return{plugins:i,localIds:t}}function getOpts(e,t){return!t&&e===!1?null:e===!0?{}:e}function createDescriptors(e,{plugins:t,localIds:i},r,o){const a=[],c=e.getContext();for(const u of t){const h=u.id,d=getOpts(r[h],o);d!==null&&a.push({plugin:u,options:pluginOpts(e.config,{plugin:u,local:i[h]},d,c)})}return a}function pluginOpts(e,{plugin:t,local:i},r,o){const a=e.pluginScopeKeys(t),c=e.getOptionScopes(r,a);return i&&t.defaults&&c.push(t.defaults),e.createResolver(c,o,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function getIndexAxis(e,t){const i=defaults$2.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||i.indexAxis||"x"}function getAxisFromDefaultScaleID(e,t){let i=e;return e==="_index_"?i=t:e==="_value_"&&(i=t==="x"?"y":"x"),i}function getDefaultScaleIDFromAxis(e,t){return e===t?"_index_":"_value_"}function idMatchesAxis(e){if(e==="x"||e==="y"||e==="r")return e}function axisFromPosition(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function determineAxis(e,...t){if(idMatchesAxis(e))return e;for(const i of t){const r=i.axis||axisFromPosition(i.position)||e.length>1&&idMatchesAxis(e[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function getAxisFromDataset(e,t,i){if(i[t+"AxisID"]===e)return{axis:t}}function retrieveAxisFromDatasets(e,t){if(t.data&&t.data.datasets){const i=t.data.datasets.filter(r=>r.xAxisID===e||r.yAxisID===e);if(i.length)return getAxisFromDataset(e,"x",i[0])||getAxisFromDataset(e,"y",i[0])}return{}}function mergeScaleConfig(e,t){const i=overrides[e.type]||{scales:{}},r=t.scales||{},o=getIndexAxis(e.type,t),a=Object.create(null);return Object.keys(r).forEach(c=>{const u=r[c];if(!isObject$14(u))return console.error(`Invalid scale configuration for scale: ${c}`);if(u._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${c}`);const h=determineAxis(c,u,retrieveAxisFromDatasets(c,e),defaults$2.scales[u.type]),d=getDefaultScaleIDFromAxis(h,o),f=i.scales||{};a[c]=mergeIf(Object.create(null),[{axis:h},u,f[h],f[d]])}),e.data.datasets.forEach(c=>{const u=c.type||e.type,h=c.indexAxis||getIndexAxis(u,t),f=(overrides[u]||{}).scales||{};Object.keys(f).forEach(m=>{const g=getAxisFromDefaultScaleID(m,h),v=c[g+"AxisID"]||g;a[v]=a[v]||Object.create(null),mergeIf(a[v],[{axis:g},r[v],f[m]])})}),Object.keys(a).forEach(c=>{const u=a[c];mergeIf(u,[defaults$2.scales[u.type],defaults$2.scale])}),a}function initOptions(e){const t=e.options||(e.options={});t.plugins=valueOrDefault(t.plugins,{}),t.scales=mergeScaleConfig(e,t)}function initData(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function initConfig(e){return e=e||{},e.data=initData(e.data),initOptions(e),e}const keyCache=new Map,keysCached=new Set;function cachedKeys(e,t){let i=keyCache.get(e);return i||(i=t(),keyCache.set(e,i),keysCached.add(i)),i}const addIfFound=(e,t,i)=>{const r=resolveObjectKey(t,i);r!==void 0&&e.add(r)};var Config$1=class{constructor(e){this._config=initConfig(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=initData(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),initOptions(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return cachedKeys(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return cachedKeys(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return cachedKeys(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,i=this.type;return cachedKeys(`${i}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const i=this._scopeCache;let r=i.get(e);return(!r||t)&&(r=new Map,i.set(e,r)),r}getOptionScopes(e,t,i){const{options:r,type:o}=this,a=this._cachedScopes(e,i),c=a.get(t);if(c)return c;const u=new Set;t.forEach(d=>{e&&(u.add(e),d.forEach(f=>addIfFound(u,e,f))),d.forEach(f=>addIfFound(u,r,f)),d.forEach(f=>addIfFound(u,overrides[o]||{},f)),d.forEach(f=>addIfFound(u,defaults$2,f)),d.forEach(f=>addIfFound(u,descriptors,f))});const h=Array.from(u);return h.length===0&&h.push(Object.create(null)),keysCached.has(t)&&a.set(t,h),h}chartOptionScopes(){const{options:e,type:t}=this;return[e,overrides[t]||{},defaults$2.datasets[t]||{},{type:t},defaults$2,descriptors]}resolveNamedOptions(e,t,i,r=[""]){const o={$shared:!0},{resolver:a,subPrefixes:c}=getResolver(this._resolverCache,e,r);let u=a;if(needContext(a,t)){o.$shared=!1,i=isFunction$3(i)?i():i;const h=this.createResolver(e,i,c);u=_attachContext(a,i,h)}for(const h of t)o[h]=u[h];return o}createResolver(e,t,i=[""],r){const{resolver:o}=getResolver(this._resolverCache,e,i);return isObject$14(t)?_attachContext(o,t,void 0,r):o}};function getResolver(e,t,i){let r=e.get(t);r||(r=new Map,e.set(t,r));const o=i.join();let a=r.get(o);return a||(a={resolver:_createResolver(t,i),subPrefixes:i.filter(u=>!u.toLowerCase().includes("hover"))},r.set(o,a)),a}const hasFunction=e=>isObject$14(e)&&Object.getOwnPropertyNames(e).some(t=>isFunction$3(e[t]));function needContext(e,t){const{isScriptable:i,isIndexable:r}=_descriptors(e);for(const o of t){const a=i(o),c=r(o),u=(c||a)&&e[o];if(a&&(isFunction$3(u)||hasFunction(u))||c&&isArray$4(u))return!0}return!1}var version$2="4.4.7";const KNOWN_POSITIONS=["top","bottom","left","right","chartArea"];function positionIsHorizontal(e,t){return e==="top"||e==="bottom"||KNOWN_POSITIONS.indexOf(e)===-1&&t==="x"}function compare2Level(e,t){return function(i,r){return i[e]===r[e]?i[t]-r[t]:i[e]-r[e]}}function onAnimationsComplete(e){const t=e.chart,i=t.options.animation;t.notifyPlugins("afterRender"),callback(i&&i.onComplete,[e],t)}function onAnimationProgress(e){const t=e.chart,i=t.options.animation;callback(i&&i.onProgress,[e],t)}function getCanvas(e){return _isDomSupported()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const instances$1={},getChart=e=>{const t=getCanvas(e);return Object.values(instances$1).filter(i=>i.canvas===t).pop()};function moveNumericKeys(e,t,i){const r=Object.keys(e);for(const o of r){const a=+o;if(a>=t){const c=e[o];delete e[o],(i>0||a>t)&&(e[a+i]=c)}}}function determineLastEvent(e,t,i,r){return!i||e.type==="mouseout"?null:r?t:e}function getSizeForArea(e,t,i){return e.options.clip?e[i]:t[i]}function getDatasetArea(e,t){const{xScale:i,yScale:r}=e;return i&&r?{left:getSizeForArea(i,t,"left"),right:getSizeForArea(i,t,"right"),top:getSizeForArea(r,t,"top"),bottom:getSizeForArea(r,t,"bottom")}:t}var Chart=class{static defaults=defaults$2;static instances=instances$1;static overrides=overrides;static registry=registry;static version=version$2;static getChart=getChart;static register(...e){registry.add(...e),invalidatePlugins()}static unregister(...e){registry.remove(...e),invalidatePlugins()}constructor(e,t){const i=this.config=new Config$1(t),r=getCanvas(e),o=getChart(r);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");const a=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||_detectPlatform(r)),this.platform.updateConfig(i);const c=this.platform.acquireContext(r,a.aspectRatio),u=c&&c.canvas,h=u&&u.height,d=u&&u.width;if(this.id=uid$3(),this.ctx=c,this.canvas=u,this.width=d,this.height=h,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new PluginService,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=debounce$4(f=>this.update(f),a.resizeDelay||0),this._dataChanges=[],instances$1[this.id]=this,!c||!u){console.error("Failed to create chart: can't acquire context from the given item");return}animator.listen(this,"complete",onAnimationsComplete),animator.listen(this,"progress",onAnimationProgress),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:i,height:r,_aspectRatio:o}=this;return isNullOrUndef(e)?t&&o?o:r?i/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return registry}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():retinaScale(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return clearCanvas(this.canvas,this.ctx),this}stop(){return animator.stop(this),this}resize(e,t){animator.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const i=this.options,r=this.canvas,o=i.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(r,e,t,o),c=i.devicePixelRatio||this.platform.getDevicePixelRatio(),u=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,retinaScale(this,c,!0)&&(this.notifyPlugins("resize",{size:a}),callback(i.onResize,[this,a],this),this.attached&&this._doResize(u)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};each(t,(i,r)=>{i.id=r})}buildOrUpdateScales(){const e=this.options,t=e.scales,i=this.scales,r=Object.keys(i).reduce((a,c)=>(a[c]=!1,a),{});let o=[];t&&(o=o.concat(Object.keys(t).map(a=>{const c=t[a],u=determineAxis(a,c),h=u==="r",d=u==="x";return{options:c,dposition:h?"chartArea":d?"bottom":"left",dtype:h?"radialLinear":d?"category":"linear"}}))),each(o,a=>{const c=a.options,u=c.id,h=determineAxis(u,c),d=valueOrDefault(c.type,a.dtype);(c.position===void 0||positionIsHorizontal(c.position,h)!==positionIsHorizontal(a.dposition))&&(c.position=a.dposition),r[u]=!0;let f=null;if(u in i&&i[u].type===d)f=i[u];else{const m=registry.getScale(d);f=new m({id:u,type:d,ctx:this.ctx,chart:this}),i[f.id]=f}f.init(c,e)}),each(r,(a,c)=>{a||delete i[c]}),each(i,a=>{layouts.configure(this,a,a.options),layouts.addBox(this,a)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,i=e.length;if(e.sort((r,o)=>r.index-o.index),i>t){for(let r=t;r<i;++r)this._destroyDatasetMeta(r);e.splice(t,i-t)}this._sortedMetasets=e.slice(0).sort(compare2Level("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((i,r)=>{t.filter(o=>o===i._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let i,r;for(this._removeUnreferencedMetasets(),i=0,r=t.length;i<r;i++){const o=t[i];let a=this.getDatasetMeta(i);const c=o.type||this.config.type;if(a.type&&a.type!==c&&(this._destroyDatasetMeta(i),a=this.getDatasetMeta(i)),a.type=c,a.indexAxis=o.indexAxis||getIndexAxis(c,this.options),a.order=o.order||0,a.index=i,a.label=""+o.label,a.visible=this.isDatasetVisible(i),a.controller)a.controller.updateIndex(i),a.controller.linkScales();else{const u=registry.getController(c),{datasetElementType:h,dataElementType:d}=defaults$2.datasets[c];Object.assign(u,{dataElementType:registry.getElement(d),datasetElementType:h&&registry.getElement(h)}),a.controller=new u(this,i),e.push(a.controller)}}return this._updateMetasets(),e}_resetElements(){each(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const i=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let h=0,d=this.data.datasets.length;h<d;h++){const{controller:f}=this.getDatasetMeta(h),m=!r&&o.indexOf(f)===-1;f.buildOrUpdateElements(m),a=Math.max(+f.getMaxOverflow(),a)}a=this._minPadding=i.layout.autoPadding?a:0,this._updateLayout(a),r||each(o,h=>{h.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(compare2Level("z","_idx"));const{_active:c,_lastEvent:u}=this;u?this._eventHandler(u,!0):c.length&&this._updateHoverStyles(c,c,!0),this.render()}_updateScales(){each(this.scales,e=>{layouts.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),i=new Set(e.events);(!setsEqual(t,i)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:i,start:r,count:o}of t){const a=i==="_removeElements"?-o:o;moveNumericKeys(e,r,a)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,i=o=>new Set(e.filter(a=>a[0]===o).map((a,c)=>c+","+a.splice(1).join(","))),r=i(0);for(let o=1;o<t;o++)if(!setsEqual(r,i(o)))return;return Array.from(r).map(o=>o.split(",")).map(o=>({method:o[1],start:+o[2],count:+o[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;layouts.update(this,this.width,this.height,e);const t=this.chartArea,i=t.width<=0||t.height<=0;this._layers=[],each(this.boxes,r=>{i&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,o)=>{r._idx=o}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,i=this.data.datasets.length;t<i;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,i=this.data.datasets.length;t<i;++t)this._updateDataset(t,isFunction$3(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const i=this.getDatasetMeta(e),r={meta:i,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(i.controller._update(t),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(animator.has(this)?this.attached&&!animator.running(this)&&animator.start(this):(this.draw(),onAnimationsComplete({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:i,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(i,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,i=[];let r,o;for(r=0,o=t.length;r<o;++r){const a=t[r];(!e||a.visible)&&i.push(a)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,i=e._clip,r=!i.disabled,o=getDatasetArea(e,this.chartArea),a={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",a)!==!1&&(r&&clipArea(t,{left:i.left===!1?0:o.left-i.left,right:i.right===!1?this.width:o.right+i.right,top:i.top===!1?0:o.top-i.top,bottom:i.bottom===!1?this.height:o.bottom+i.bottom}),e.controller.draw(),r&&unclipArea(t),a.cancelable=!1,this.notifyPlugins("afterDatasetDraw",a))}isPointInArea(e){return _isPointInArea(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,i,r){const o=Interaction.modes[t];return typeof o=="function"?o(this,e,i,r):[]}getDatasetMeta(e){const t=this.data.datasets[e],i=this._metasets;let r=i.filter(o=>o&&o._dataset===t).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},i.push(r)),r}getContext(){return this.$context||(this.$context=createContext$1(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const i=this.getDatasetMeta(e);return typeof i.hidden=="boolean"?!i.hidden:!t.hidden}setDatasetVisibility(e,t){const i=this.getDatasetMeta(e);i.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,i){const r=i?"show":"hide",o=this.getDatasetMeta(e),a=o.controller._resolveAnimations(void 0,r);defined(t)?(o.data[t].hidden=!i,this.update()):(this.setDatasetVisibility(e,i),a.update(o,{visible:i}),this.update(c=>c.datasetIndex===e?r:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),animator.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),clearCanvas(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete instances$1[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,i=(o,a)=>{t.addEventListener(this,o,a),e[o]=a},r=(o,a,c)=>{o.offsetX=a,o.offsetY=c,this._eventHandler(o)};each(this.options.events,o=>i(o,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,i=(u,h)=>{t.addEventListener(this,u,h),e[u]=h},r=(u,h)=>{e[u]&&(t.removeEventListener(this,u,h),delete e[u])},o=(u,h)=>{this.canvas&&this.resize(u,h)};let a;const c=()=>{r("attach",c),this.attached=!0,this.resize(),i("resize",o),i("detach",a)};a=()=>{this.attached=!1,r("resize",o),this._stop(),this._resize(0,0),i("attach",c)},t.isAttached(this.canvas)?c():a()}unbindEvents(){each(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},each(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,i){const r=i?"set":"remove";let o,a,c,u;for(t==="dataset"&&(o=this.getDatasetMeta(e[0].datasetIndex),o.controller["_"+r+"DatasetHoverStyle"]()),c=0,u=e.length;c<u;++c){a=e[c];const h=a&&this.getDatasetMeta(a.datasetIndex).controller;h&&h[r+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],i=e.map(({datasetIndex:o,index:a})=>{const c=this.getDatasetMeta(o);if(!c)throw new Error("No dataset found at index "+o);return{datasetIndex:o,element:c.data[a],index:a}});!_elementsEqual(i,t)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,t))}notifyPlugins(e,t,i){return this._plugins.notify(this,e,t,i)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,i){const r=this.options.hover,o=(u,h)=>u.filter(d=>!h.some(f=>d.datasetIndex===f.datasetIndex&&d.index===f.index)),a=o(t,e),c=i?e:o(e,t);a.length&&this.updateHoverStyle(a,r.mode,!1),c.length&&r.mode&&this.updateHoverStyle(c,r.mode,!0)}_eventHandler(e,t){const i={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},r=a=>(a.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",i,r)===!1)return;const o=this._handleEvent(e,t,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,r),(o||i.changed)&&this.render(),this}_handleEvent(e,t,i){const{_active:r=[],options:o}=this,a=t,c=this._getActiveElements(e,r,i,a),u=_isClickEvent(e),h=determineLastEvent(e,this._lastEvent,i,u);i&&(this._lastEvent=null,callback(o.onHover,[e,c,this],this),u&&callback(o.onClick,[e,c,this],this));const d=!_elementsEqual(c,r);return(d||t)&&(this._active=c,this._updateHoverStyles(c,r,t)),this._lastEvent=h,d}_getActiveElements(e,t,i,r){if(e.type==="mouseout")return[];if(!i)return t;const o=this.options.hover;return this.getElementsAtEventForMode(e,o.mode,o,r)}};function invalidatePlugins(){return each(Chart.instances,e=>e._plugins.invalidate())}function generateTicks$1(e,t){const i=[],{bounds:o,step:a,min:c,max:u,precision:h,count:d,maxTicks:f,maxDigits:m,includeBounds:g}=e,v=a||1,_=f-1,{min:b,max:S}=t,T=!isNullOrUndef(c),A=!isNullOrUndef(u),I=!isNullOrUndef(d),R=(S-b)/(m+1);let O=niceNum((S-b)/_/v)*v,P,L,V,U;if(O<1e-14&&!T&&!A)return[{value:b},{value:S}];U=Math.ceil(S/O)-Math.floor(b/O),U>_&&(O=niceNum(U*O/_/v)*v),isNullOrUndef(h)||(P=Math.pow(10,h),O=Math.ceil(O*P)/P),o==="ticks"?(L=Math.floor(b/O)*O,V=Math.ceil(S/O)*O):(L=b,V=S),T&&A&&a&&almostWhole((u-c)/a,O/1e3)?(U=Math.round(Math.min((u-c)/O,f)),O=(u-c)/U,L=c,V=u):I?(L=T?c:L,V=A?u:V,U=d-1,O=(V-L)/U):(U=(V-L)/O,almostEquals(U,Math.round(U),O/1e3)?U=Math.round(U):U=Math.ceil(U));const $=Math.max(_decimalPlaces(O),_decimalPlaces(L));P=Math.pow(10,isNullOrUndef(h)?$:h),L=Math.round(L*P)/P,V=Math.round(V*P)/P;let Z=0;for(T&&(g&&L!==c?(i.push({value:c}),L<c&&Z++,almostEquals(Math.round((L+Z*O)*P)/P,c,relativeLabelSize(c,R,e))&&Z++):L<c&&Z++);Z<U;++Z){const ie=Math.round((L+Z*O)*P)/P;if(A&&ie>u)break;i.push({value:ie})}return A&&g&&V!==u?i.length&&almostEquals(i[i.length-1].value,u,relativeLabelSize(u,R,e))?i[i.length-1].value=u:i.push({value:u}):(!A||V===u)&&i.push({value:V}),i}function relativeLabelSize(e,t,{horizontal:i,minRotation:r}){const o=toRadians(r),a=(i?Math.sin(o):Math.cos(o))||.001,c=.75*t*(""+e).length;return Math.min(t/a,c)}var LinearScaleBase=class extends Scale{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return isNullOrUndef(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:i}=this.getUserBounds();let{min:r,max:o}=this;const a=u=>r=t?r:u,c=u=>o=i?o:u;if(e){const u=sign(r),h=sign(o);u<0&&h<0?c(0):u>0&&h>0&&a(0)}if(r===o){let u=o===0?1:Math.abs(o*.05);c(o+u),e||a(r-u)}this.min=r,this.max=o}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:i}=e,r;return i?(r=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),t=t||11),t&&(r=Math.min(t,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let i=this.getTickLimit();i=Math.max(2,i);const r={maxTicks:i,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},o=this._range||this,a=generateTicks$1(r,o);return e.bounds==="ticks"&&_setMinAndMaxByKey(a,this,"value"),e.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){const e=this.ticks;let t=this.min,i=this.max;if(super.configure(),this.options.offset&&e.length){const r=(i-t)/Math.max(e.length-1,1)/2;t-=r,i+=r}this._startValue=t,this._endValue=i,this._valueRange=i-t}getLabelForValue(e){return formatNumber(e,this.chart.options.locale,this.options.ticks.format)}},LinearScale=class extends LinearScaleBase{static id="linear";static defaults={ticks:{callback:Ticks.formatters.numeric}};determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=isNumberFinite(e)?e:0,this.max=isNumberFinite(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,i=toRadians(this.options.ticks.minRotation),r=(e?Math.sin(i):Math.cos(i))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,o.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}};const log10Floor=e=>Math.floor(log10(e)),changeExponent=(e,t)=>Math.pow(10,log10Floor(e)+t);function isMajor(e){return e/Math.pow(10,log10Floor(e))===1}function steps(e,t,i){const r=Math.pow(10,i),o=Math.floor(e/r);return Math.ceil(t/r)-o}function startExp(e,t){const i=t-e;let r=log10Floor(i);for(;steps(e,t,r)>10;)r++;for(;steps(e,t,r)<10;)r--;return Math.min(r,log10Floor(e))}function generateTicks(e,{min:t,max:i}){t=finiteOrDefault(e.min,t);const r=[],o=log10Floor(t);let a=startExp(t,i),c=a<0?Math.pow(10,Math.abs(a)):1;const u=Math.pow(10,a),h=o>a?Math.pow(10,o):0,d=Math.round((t-h)*c)/c,f=Math.floor((t-h)/u/10)*u*10;let m=Math.floor((d-f)/Math.pow(10,a)),g=finiteOrDefault(e.min,Math.round((h+f+m*Math.pow(10,a))*c)/c);for(;g<i;)r.push({value:g,major:isMajor(g),significand:m}),m>=10?m=m<15?15:20:m++,m>=20&&(a++,m=2,c=a>=0?1:c),g=Math.round((h+f+m*Math.pow(10,a))*c)/c;const v=finiteOrDefault(e.max,g);return r.push({value:v,major:isMajor(v),significand:m}),r}var LogarithmicScale=class extends Scale{static id="logarithmic";static defaults={ticks:{callback:Ticks.formatters.logarithmic,major:{enabled:!0}}};constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const i=LinearScaleBase.prototype.parse.apply(this,[e,t]);if(i===0){this._zero=!0;return}return isNumberFinite(i)&&i>0?i:null}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=isNumberFinite(e)?Math.max(0,e):null,this.max=isNumberFinite(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!isNumberFinite(this._userMin)&&(this.min=e===changeExponent(this.min,0)?changeExponent(this.min,-1):changeExponent(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let i=this.min,r=this.max;const o=c=>i=e?i:c,a=c=>r=t?r:c;i===r&&(i<=0?(o(1),a(10)):(o(changeExponent(i,-1)),a(changeExponent(r,1)))),i<=0&&o(changeExponent(r,-1)),r<=0&&a(changeExponent(i,1)),this.min=i,this.max=r}buildTicks(){const e=this.options,t={min:this._userMin,max:this._userMax},i=generateTicks(t,this);return e.bounds==="ticks"&&_setMinAndMaxByKey(i,this,"value"),e.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(e){return e===void 0?"0":formatNumber(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=log10(e),this._valueRange=log10(this.max)-log10(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(log10(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}};function getTickBackdropHeight(e){const t=e.ticks;if(t.display&&e.display){const i=toPadding(t.backdropPadding);return valueOrDefault(t.font&&t.font.size,defaults$2.font.size)+i.height}return 0}function measureLabelSize(e,t,i){return i=isArray$4(i)?i:[i],{w:_longestText(e,t.string,i),h:i.length*t.lineHeight}}function determineLimits(e,t,i,r,o){return e===r||e===o?{start:t-i/2,end:t+i/2}:e<r||e>o?{start:t-i,end:t}:{start:t,end:t+i}}function fitWithPointLabels(e){const t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},i=Object.assign({},t),r=[],o=[],a=e._pointLabels.length,c=e.options.pointLabels,u=c.centerPointLabels?PI/a:0;for(let h=0;h<a;h++){const d=c.setContext(e.getPointLabelContext(h));o[h]=d.padding;const f=e.getPointPosition(h,e.drawingArea+o[h],u),m=toFont(d.font),g=measureLabelSize(e.ctx,m,e._pointLabels[h]);r[h]=g;const v=_normalizeAngle(e.getIndexAngle(h)+u),_=Math.round(toDegrees(v)),b=determineLimits(_,f.x,g.w,0,180),S=determineLimits(_,f.y,g.h,90,270);updateLimits(i,t,v,b,S)}e.setCenterPoint(t.l-i.l,i.r-t.r,t.t-i.t,i.b-t.b),e._pointLabelItems=buildPointLabelItems(e,r,o)}function updateLimits(e,t,i,r,o){const a=Math.abs(Math.sin(i)),c=Math.abs(Math.cos(i));let u=0,h=0;r.start<t.l?(u=(t.l-r.start)/a,e.l=Math.min(e.l,t.l-u)):r.end>t.r&&(u=(r.end-t.r)/a,e.r=Math.max(e.r,t.r+u)),o.start<t.t?(h=(t.t-o.start)/c,e.t=Math.min(e.t,t.t-h)):o.end>t.b&&(h=(o.end-t.b)/c,e.b=Math.max(e.b,t.b+h))}function createPointLabelItem(e,t,i){const r=e.drawingArea,{extra:o,additionalAngle:a,padding:c,size:u}=i,h=e.getPointPosition(t,r+o+c,a),d=Math.round(toDegrees(_normalizeAngle(h.angle+HALF_PI))),f=yForAngle(h.y,u.h,d),m=getTextAlignForAngle(d),g=leftForTextAlign(h.x,u.w,m);return{visible:!0,x:h.x,y:f,textAlign:m,left:g,top:f,right:g+u.w,bottom:f+u.h}}function isNotOverlapped(e,t){if(!t)return!0;const{left:i,top:r,right:o,bottom:a}=e;return!(_isPointInArea({x:i,y:r},t)||_isPointInArea({x:i,y:a},t)||_isPointInArea({x:o,y:r},t)||_isPointInArea({x:o,y:a},t))}function buildPointLabelItems(e,t,i){const r=[],o=e._pointLabels.length,a=e.options,{centerPointLabels:c,display:u}=a.pointLabels,h={extra:getTickBackdropHeight(a)/2,additionalAngle:c?PI/o:0};let d;for(let f=0;f<o;f++){h.padding=i[f],h.size=t[f];const m=createPointLabelItem(e,f,h);r.push(m),u==="auto"&&(m.visible=isNotOverlapped(m,d),m.visible&&(d=m))}return r}function getTextAlignForAngle(e){return e===0||e===180?"center":e<180?"left":"right"}function leftForTextAlign(e,t,i){return i==="right"?e-=t:i==="center"&&(e-=t/2),e}function yForAngle(e,t,i){return i===90||i===270?e-=t/2:(i>270||i<90)&&(e-=t),e}function drawPointLabelBox(e,t,i){const{left:r,top:o,right:a,bottom:c}=i,{backdropColor:u}=t;if(!isNullOrUndef(u)){const h=toTRBLCorners(t.borderRadius),d=toPadding(t.backdropPadding);e.fillStyle=u;const f=r-d.left,m=o-d.top,g=a-r+d.width,v=c-o+d.height;Object.values(h).some(_=>_!==0)?(e.beginPath(),addRoundedRectPath(e,{x:f,y:m,w:g,h:v,radius:h}),e.fill()):e.fillRect(f,m,g,v)}}function drawPointLabels(e,t){const{ctx:i,options:{pointLabels:r}}=e;for(let o=t-1;o>=0;o--){const a=e._pointLabelItems[o];if(!a.visible)continue;const c=r.setContext(e.getPointLabelContext(o));drawPointLabelBox(i,c,a);const u=toFont(c.font),{x:h,y:d,textAlign:f}=a;renderText(i,e._pointLabels[o],h,d+u.lineHeight/2,u,{color:c.color,textAlign:f,textBaseline:"middle"})}}function pathRadiusLine(e,t,i,r){const{ctx:o}=e;if(i)o.arc(e.xCenter,e.yCenter,t,0,TAU);else{let a=e.getPointPosition(0,t);o.moveTo(a.x,a.y);for(let c=1;c<r;c++)a=e.getPointPosition(c,t),o.lineTo(a.x,a.y)}}function drawRadiusLine(e,t,i,r,o){const a=e.ctx,c=t.circular,{color:u,lineWidth:h}=t;!c&&!r||!u||!h||i<0||(a.save(),a.strokeStyle=u,a.lineWidth=h,a.setLineDash(o.dash||[]),a.lineDashOffset=o.dashOffset,a.beginPath(),pathRadiusLine(e,i,c,r),a.closePath(),a.stroke(),a.restore())}function createPointLabelContext(e,t,i){return createContext$1(e,{label:i,index:t,type:"pointLabel"})}var RadialLinearScale=class extends LinearScaleBase{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Ticks.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=toPadding(getTickBackdropHeight(this.options)/2),t=this.width=this.maxWidth-e.width,i=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+i/2+e.top),this.drawingArea=Math.floor(Math.min(t,i)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=isNumberFinite(e)&&!isNaN(e)?e:0,this.max=isNumberFinite(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/getTickBackdropHeight(this.options))}generateTickLabels(e){LinearScaleBase.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((t,i)=>{const r=callback(this.options.pointLabels.callback,[t,i],this);return r||r===0?r:""}).filter((t,i)=>this.chart.getDataVisibility(i))}fit(){const e=this.options;e.display&&e.pointLabels.display?fitWithPointLabels(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,i,r){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((i-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,i,r))}getIndexAngle(e){const t=TAU/(this._pointLabels.length||1),i=this.options.startAngle||0;return _normalizeAngle(e*t+toRadians(i))}getDistanceFromCenterForValue(e){if(isNullOrUndef(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(isNullOrUndef(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const i=t[e];return createPointLabelContext(this.getContext(),e,i)}}getPointPosition(e,t,i=0){const r=this.getIndexAngle(e)-HALF_PI+i;return{x:Math.cos(r)*t+this.xCenter,y:Math.sin(r)*t+this.yCenter,angle:r}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:i,right:r,bottom:o}=this._pointLabelItems[e];return{left:t,top:i,right:r,bottom:o}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const i=this.ctx;i.save(),i.beginPath(),pathRadiusLine(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),i.closePath(),i.fillStyle=e,i.fill(),i.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:i,grid:r,border:o}=t,a=this._pointLabels.length;let c,u,h;if(t.pointLabels.display&&drawPointLabels(this,a),r.display&&this.ticks.forEach((d,f)=>{if(f!==0||f===0&&this.min<0){u=this.getDistanceFromCenterForValue(d.value);const m=this.getContext(f),g=r.setContext(m),v=o.setContext(m);drawRadiusLine(this,g,u,a,v)}}),i.display){for(e.save(),c=a-1;c>=0;c--){const d=i.setContext(this.getPointLabelContext(c)),{color:f,lineWidth:m}=d;!m||!f||(e.lineWidth=m,e.strokeStyle=f,e.setLineDash(d.borderDash),e.lineDashOffset=d.borderDashOffset,u=this.getDistanceFromCenterForValue(t.reverse?this.min:this.max),h=this.getPointPosition(c,u),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(h.x,h.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,i=t.ticks;if(!i.display)return;const r=this.getIndexAngle(0);let o,a;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(r),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((c,u)=>{if(u===0&&this.min>=0&&!t.reverse)return;const h=i.setContext(this.getContext(u)),d=toFont(h.font);if(o=this.getDistanceFromCenterForValue(this.ticks[u].value),h.showLabelBackdrop){e.font=d.string,a=e.measureText(c.label).width,e.fillStyle=h.backdropColor;const f=toPadding(h.backdropPadding);e.fillRect(-a/2-f.left,-o-d.size/2-f.top,a+f.width,d.size+f.height)}renderText(e,c.label,0,-o,d,{color:h.color,strokeColor:h.textStrokeColor,strokeWidth:h.textStrokeWidth})}),e.restore()}drawTitle(){}};const INTERVALS={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},UNITS=Object.keys(INTERVALS);function sorter(e,t){return e-t}function parse$5(e,t){if(isNullOrUndef(t))return null;const i=e._adapter,{parser:r,round:o,isoWeekday:a}=e._parseOpts;let c=t;return typeof r=="function"&&(c=r(c)),isNumberFinite(c)||(c=typeof r=="string"?i.parse(c,r):i.parse(c)),c===null?null:(o&&(c=o==="week"&&(isNumber$1(a)||a===!0)?i.startOf(c,"isoWeek",a):i.startOf(c,o)),+c)}function determineUnitForAutoTicks(e,t,i,r){const o=UNITS.length;for(let a=UNITS.indexOf(e);a<o-1;++a){const c=INTERVALS[UNITS[a]],u=c.steps?c.steps:Number.MAX_SAFE_INTEGER;if(c.common&&Math.ceil((i-t)/(u*c.size))<=r)return UNITS[a]}return UNITS[o-1]}function determineUnitForFormatting(e,t,i,r,o){for(let a=UNITS.length-1;a>=UNITS.indexOf(i);a--){const c=UNITS[a];if(INTERVALS[c].common&&e._adapter.diff(o,r,c)>=t-1)return c}return UNITS[i?UNITS.indexOf(i):0]}function determineMajorUnit(e){for(let t=UNITS.indexOf(e)+1,i=UNITS.length;t<i;++t)if(INTERVALS[UNITS[t]].common)return UNITS[t]}function addTick(e,t,i){if(!i)e[t]=!0;else if(i.length){const{lo:r,hi:o}=_lookup(i,t),a=i[r]>=t?i[r]:i[o];e[a]=!0}}function setMajorTicks(e,t,i,r){const o=e._adapter,a=+o.startOf(t[0].value,r),c=t[t.length-1].value;let u,h;for(u=a;u<=c;u=+o.add(u,1,r))h=i[u],h>=0&&(t[h].major=!0);return t}function ticksFromTimestamps(e,t,i){const r=[],o={},a=t.length;let c,u;for(c=0;c<a;++c)u=t[c],o[u]=c,r.push({value:u,major:!1});return a===0||!i?r:setMajorTicks(e,r,o,i)}var TimeScale=class extends Scale{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const i=e.time||(e.time={}),r=this._adapter=new adapters._date(e.adapters.date);r.init(t),mergeIf(i.displayFormats,r.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:parse$5(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,i=e.time.unit||"day";let{min:r,max:o,minDefined:a,maxDefined:c}=this.getUserBounds();function u(h){!a&&!isNaN(h.min)&&(r=Math.min(r,h.min)),!c&&!isNaN(h.max)&&(o=Math.max(o,h.max))}(!a||!c)&&(u(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&u(this.getMinMax(!1))),r=isNumberFinite(r)&&!isNaN(r)?r:+t.startOf(Date.now(),i),o=isNumberFinite(o)&&!isNaN(o)?o:+t.endOf(Date.now(),i)+1,this.min=Math.min(r,o-1),this.max=Math.max(r+1,o)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],i=e[e.length-1]),{min:t,max:i}}buildTicks(){const e=this.options,t=e.time,i=e.ticks,r=i.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const o=this.min,a=this.max,c=_filterBetween(r,o,a);return this._unit=t.unit||(i.autoSkip?determineUnitForAutoTicks(t.minUnit,this.min,this.max,this._getLabelCapacity(o)):determineUnitForFormatting(this,c.length,t.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:determineMajorUnit(this._unit),this.initOffsets(r),e.reverse&&c.reverse(),ticksFromTimestamps(this,c,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,i=0,r,o;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?t=1-r:t=(this.getDecimalForValue(e[1])-r)/2,o=this.getDecimalForValue(e[e.length-1]),e.length===1?i=o:i=(o-this.getDecimalForValue(e[e.length-2]))/2);const a=e.length<3?.5:.25;t=_limitValue(t,0,a),i=_limitValue(i,0,a),this._offsets={start:t,end:i,factor:1/(t+1+i)}}_generate(){const e=this._adapter,t=this.min,i=this.max,r=this.options,o=r.time,a=o.unit||determineUnitForAutoTicks(o.minUnit,t,i,this._getLabelCapacity(t)),c=valueOrDefault(r.ticks.stepSize,1),u=a==="week"?o.isoWeekday:!1,h=isNumber$1(u)||u===!0,d={};let f=t,m,g;if(h&&(f=+e.startOf(f,"isoWeek",u)),f=+e.startOf(f,h?"day":a),e.diff(i,t,a)>1e5*c)throw new Error(t+" and "+i+" are too far apart with stepSize of "+c+" "+a);const v=r.ticks.source==="data"&&this.getDataTimestamps();for(m=f,g=0;m<i;m=+e.add(m,c,a),g++)addTick(d,m,v);return(m===i||r.bounds==="ticks"||g===1)&&addTick(d,m,v),Object.keys(d).sort(sorter).map(_=>+_)}getLabelForValue(e){const t=this._adapter,i=this.options.time;return i.tooltipFormat?t.format(e,i.tooltipFormat):t.format(e,i.displayFormats.datetime)}format(e,t){const r=this.options.time.displayFormats,o=this._unit,a=t||r[o];return this._adapter.format(e,a)}_tickFormatFunction(e,t,i,r){const o=this.options,a=o.ticks.callback;if(a)return callback(a,[e,t,i],this);const c=o.time.displayFormats,u=this._unit,h=this._majorUnit,d=u&&c[u],f=h&&c[h],m=i[t],g=h&&f&&m&&m.major;return this._adapter.format(e,r||(g?f:d))}generateTickLabels(e){let t,i,r;for(t=0,i=e.length;t<i;++t)r=e[t],r.label=this._tickFormatFunction(r.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,i=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+i)*t.factor)}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+i*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,i=this.ctx.measureText(e).width,r=toRadians(this.isHorizontal()?t.maxRotation:t.minRotation),o=Math.cos(r),a=Math.sin(r),c=this._resolveTickFontOptions(0).size;return{w:i*o+c*a,h:i*a+c*o}}_getLabelCapacity(e){const t=this.options.time,i=t.displayFormats,r=i[t.unit]||i.millisecond,o=this._tickFormatFunction(e,0,ticksFromTimestamps(this,[e],this._majorUnit),r),a=this._getLabelSize(o),c=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return c>0?c:1}getDataTimestamps(){let e=this._cache.data||[],t,i;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(t=0,i=r.length;t<i;++t)e=e.concat(r[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,i;if(e.length)return e;const r=this.getLabels();for(t=0,i=r.length;t<i;++t)e.push(parse$5(this,r[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return _arrayUnique(e.sort(sorter))}};function interpolate(e,t,i){let r=0,o=e.length-1,a,c,u,h;i?(t>=e[r].pos&&t<=e[o].pos&&({lo:r,hi:o}=_lookupByKey(e,"pos",t)),{pos:a,time:u}=e[r],{pos:c,time:h}=e[o]):(t>=e[r].time&&t<=e[o].time&&({lo:r,hi:o}=_lookupByKey(e,"time",t)),{time:a,pos:u}=e[r],{time:c,pos:h}=e[o]);const d=c-a;return d?u+(h-u)*(t-a)/d:u}var TimeSeriesScale=class extends TimeScale{static id="timeseries";static defaults=TimeScale.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=interpolate(t,this.min),this._tableRange=interpolate(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:i}=this,r=[],o=[];let a,c,u,h,d;for(a=0,c=e.length;a<c;++a)h=e[a],h>=t&&h<=i&&r.push(h);if(r.length<2)return[{time:t,pos:0},{time:i,pos:1}];for(a=0,c=r.length;a<c;++a)d=r[a+1],u=r[a-1],h=r[a],Math.round((d+u)/2)!==h&&o.push({time:h,pos:a/(c-1)});return o}_generate(){const e=this.min,t=this.max;let i=super.getDataTimestamps();return(!i.includes(e)||!i.length)&&i.splice(0,0,e),(!i.includes(t)||i.length===1)&&i.push(t),i.sort((r,o)=>r-o)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),i=this.getLabelTimestamps();return t.length&&i.length?e=this.normalize(t.concat(i)):e=t.length?t:i,e=this._cache.all=e,e}getDecimalForValue(e){return(interpolate(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return interpolate(this._table,i*this._tableRange+this._minPos,!0)}};function ascending$1(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function descending(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function bisector(e){let t,i,r;e.length!==2?(t=ascending$1,i=(u,h)=>ascending$1(e(u),h),r=(u,h)=>e(u)-h):(t=e===ascending$1||e===descending?e:zero$1,i=e,r=e);function o(u,h,d=0,f=u.length){if(d<f){if(t(h,h)!==0)return f;do{const m=d+f>>>1;i(u[m],h)<0?d=m+1:f=m}while(d<f)}return d}function a(u,h,d=0,f=u.length){if(d<f){if(t(h,h)!==0)return f;do{const m=d+f>>>1;i(u[m],h)<=0?d=m+1:f=m}while(d<f)}return d}function c(u,h,d=0,f=u.length){const m=o(u,h,d,f-1);return m>d&&r(u[m-1],h)>-r(u[m],h)?m-1:m}return{left:o,center:c,right:a}}function zero$1(){return 0}function number$3(e){return e===null?NaN:+e}const ascendingBisect=bisector(ascending$1),bisectRight=ascendingBisect.right,bisectLeft=ascendingBisect.left,bisectCenter=bisector(number$3).center;var bisect_default=bisectRight;const e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2);function tickSpec(e,t,i){const r=(t-e)/Math.max(0,i),o=Math.floor(Math.log10(r)),a=r/Math.pow(10,o),c=a>=e10?10:a>=e5?5:a>=e2?2:1;let u,h,d;return o<0?(d=Math.pow(10,-o)/c,u=Math.round(e*d),h=Math.round(t*d),u/d<e&&++u,h/d>t&&--h,d=-d):(d=Math.pow(10,o)*c,u=Math.round(e/d),h=Math.round(t/d),u*d<e&&++u,h*d>t&&--h),h<u&&.5<=i&&i<2?tickSpec(e,t,i*2):[u,h,d]}function ticks(e,t,i){if(t=+t,e=+e,i=+i,!(i>0))return[];if(e===t)return[e];const r=t<e,[o,a,c]=r?tickSpec(t,e,i):tickSpec(e,t,i);if(!(a>=o))return[];const u=a-o+1,h=new Array(u);if(r)if(c<0)for(let d=0;d<u;++d)h[d]=(a-d)/-c;else for(let d=0;d<u;++d)h[d]=(a-d)*c;else if(c<0)for(let d=0;d<u;++d)h[d]=(o+d)/-c;else for(let d=0;d<u;++d)h[d]=(o+d)*c;return h}function tickIncrement(e,t,i){return t=+t,e=+e,i=+i,tickSpec(e,t,i)[2]}function tickStep(e,t,i){t=+t,e=+e,i=+i;const r=t<e,o=r?tickIncrement(t,e,i):tickIncrement(e,t,i);return(r?-1:1)*(o<0?1/-o:o)}function identity_default$2(e){return e}var top$2=1,right$2=2,bottom$2=3,left$2=4,epsilon=1e-6;function translateX(e){return"translate("+e+",0)"}function translateY(e){return"translate(0,"+e+")"}function number$2(e){return t=>+e(t)}function center(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),i=>+e(i)+t}function entering(){return!this.__axis}function axis(e,t){var i=[],r=null,o=null,a=6,c=6,u=3,h=typeof window<"u"&&window.devicePixelRatio>1?0:.5,d=e===top$2||e===left$2?-1:1,f=e===left$2||e===right$2?"x":"y",m=e===top$2||e===bottom$2?translateX:translateY;function g(v){var _=r??(t.ticks?t.ticks.apply(t,i):t.domain()),b=o??(t.tickFormat?t.tickFormat.apply(t,i):identity_default$2),S=Math.max(a,0)+u,T=t.range(),A=+T[0]+h,I=+T[T.length-1]+h,R=(t.bandwidth?center:number$2)(t.copy(),h),O=v.selection?v.selection():v,P=O.selectAll(".domain").data([null]),L=O.selectAll(".tick").data(_,t).order(),V=L.exit(),U=L.enter().append("g").attr("class","tick"),$=L.select("line"),Z=L.select("text");P=P.merge(P.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),L=L.merge(U),$=$.merge(U.append("line").attr("stroke","currentColor").attr(f+"2",d*a)),Z=Z.merge(U.append("text").attr("fill","currentColor").attr(f,d*S).attr("dy",e===top$2?"0em":e===bottom$2?"0.71em":"0.32em")),v!==O&&(P=P.transition(v),L=L.transition(v),$=$.transition(v),Z=Z.transition(v),V=V.transition(v).attr("opacity",epsilon).attr("transform",function(ie){return isFinite(ie=R(ie))?m(ie+h):this.getAttribute("transform")}),U.attr("opacity",epsilon).attr("transform",function(ie){var ue=this.parentNode.__axis;return m((ue&&isFinite(ue=ue(ie))?ue:R(ie))+h)})),V.remove(),P.attr("d",e===left$2||e===right$2?c?"M"+d*c+","+A+"H"+h+"V"+I+"H"+d*c:"M"+h+","+A+"V"+I:c?"M"+A+","+d*c+"V"+h+"H"+I+"V"+d*c:"M"+A+","+h+"H"+I),L.attr("opacity",1).attr("transform",function(ie){return m(R(ie)+h)}),$.attr(f+"2",d*a),Z.attr(f,d*S).text(b),O.filter(entering).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===right$2?"start":e===left$2?"end":"middle"),O.each(function(){this.__axis=R})}return g.scale=function(v){return arguments.length?(t=v,g):t},g.ticks=function(){return i=Array.from(arguments),g},g.tickArguments=function(v){return arguments.length?(i=v==null?[]:Array.from(v),g):i.slice()},g.tickValues=function(v){return arguments.length?(r=v==null?null:Array.from(v),g):r&&r.slice()},g.tickFormat=function(v){return arguments.length?(o=v,g):o},g.tickSize=function(v){return arguments.length?(a=c=+v,g):a},g.tickSizeInner=function(v){return arguments.length?(a=+v,g):a},g.tickSizeOuter=function(v){return arguments.length?(c=+v,g):c},g.tickPadding=function(v){return arguments.length?(u=+v,g):u},g.offset=function(v){return arguments.length?(h=+v,g):h},g}function axisBottom(e){return axis(bottom$2,e)}function axisLeft(e){return axis(left$2,e)}var noop$1={value:()=>{}};function dispatch(){for(var e=0,t=arguments.length,i={},r;e<t;++e){if(!(r=arguments[e]+"")||r in i||/[\s.]/.test(r))throw new Error("illegal type: "+r);i[r]=[]}return new Dispatch$1(i)}function Dispatch$1(e){this._=e}function parseTypenames$1(e,t){return e.trim().split(/^|\s+/).map(function(i){var r="",o=i.indexOf(".");if(o>=0&&(r=i.slice(o+1),i=i.slice(0,o)),i&&!t.hasOwnProperty(i))throw new Error("unknown type: "+i);return{type:i,name:r}})}Dispatch$1.prototype=dispatch.prototype={constructor:Dispatch$1,on:function(e,t){var i=this._,r=parseTypenames$1(e+"",i),o,a=-1,c=r.length;if(arguments.length<2){for(;++a<c;)if((o=(e=r[a]).type)&&(o=get$3(i[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<c;)if(o=(e=r[a]).type)i[o]=set$4(i[o],e.name,t);else if(t==null)for(o in i)i[o]=set$4(i[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var i in t)e[i]=t[i].slice();return new Dispatch$1(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var i=new Array(o),r=0,o,a;r<o;++r)i[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],r=0,o=a.length;r<o;++r)a[r].value.apply(t,i)},apply:function(e,t,i){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,a=r.length;o<a;++o)r[o].value.apply(t,i)}};function get$3(e,t){for(var i=0,r=e.length,o;i<r;++i)if((o=e[i]).name===t)return o.value}function set$4(e,t,i){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=noop$1,e=e.slice(0,r).concat(e.slice(r+1));break}return i!=null&&e.push({name:t,value:i}),e}var dispatch_default$1=dispatch,xhtml="http://www.w3.org/1999/xhtml",namespaces_default={svg:"http://www.w3.org/2000/svg",xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace_default(e){var t=e+="",i=t.indexOf(":");return i>=0&&(t=e.slice(0,i))!=="xmlns"&&(e=e.slice(i+1)),namespaces_default.hasOwnProperty(t)?{space:namespaces_default[t],local:e}:e}function creatorInherit(e){return function(){var t=this.ownerDocument,i=this.namespaceURI;return i===xhtml&&t.documentElement.namespaceURI===xhtml?t.createElement(e):t.createElementNS(i,e)}}function creatorFixed(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function creator_default(e){var t=namespace_default(e);return(t.local?creatorFixed:creatorInherit)(t)}function none(){}function selector_default(e){return e==null?none:function(){return this.querySelector(e)}}function select_default$2(e){typeof e!="function"&&(e=selector_default(e));for(var t=this._groups,i=t.length,r=new Array(i),o=0;o<i;++o)for(var a=t[o],c=a.length,u=r[o]=new Array(c),h,d,f=0;f<c;++f)(h=a[f])&&(d=e.call(h,h.__data__,f,a))&&("__data__"in h&&(d.__data__=h.__data__),u[f]=d);return new Selection$5(r,this._parents)}function array(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function empty$1(){return[]}function selectorAll_default(e){return e==null?empty$1:function(){return this.querySelectorAll(e)}}function arrayAll(e){return function(){return array(e.apply(this,arguments))}}function selectAll_default$1(e){typeof e=="function"?e=arrayAll(e):e=selectorAll_default(e);for(var t=this._groups,i=t.length,r=[],o=[],a=0;a<i;++a)for(var c=t[a],u=c.length,h,d=0;d<u;++d)(h=c[d])&&(r.push(e.call(h,h.__data__,d,c)),o.push(h));return new Selection$5(r,o)}function matcher_default(e){return function(){return this.matches(e)}}function childMatcher(e){return function(t){return t.matches(e)}}var find=Array.prototype.find;function childFind(e){return function(){return find.call(this.children,e)}}function childFirst(){return this.firstElementChild}function selectChild_default(e){return this.select(e==null?childFirst:childFind(typeof e=="function"?e:childMatcher(e)))}var filter=Array.prototype.filter;function children(){return Array.from(this.children)}function childrenFilter(e){return function(){return filter.call(this.children,e)}}function selectChildren_default(e){return this.selectAll(e==null?children:childrenFilter(typeof e=="function"?e:childMatcher(e)))}function filter_default$1(e){typeof e!="function"&&(e=matcher_default(e));for(var t=this._groups,i=t.length,r=new Array(i),o=0;o<i;++o)for(var a=t[o],c=a.length,u=r[o]=[],h,d=0;d<c;++d)(h=a[d])&&e.call(h,h.__data__,d,a)&&u.push(h);return new Selection$5(r,this._parents)}function sparse_default(e){return new Array(e.length)}function enter_default(){return new Selection$5(this._enter||this._groups.map(sparse_default),this._parents)}function EnterNode(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}EnterNode.prototype={constructor:EnterNode,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function constant_default$2(e){return function(){return e}}function bindIndex(e,t,i,r,o,a){for(var c=0,u,h=t.length,d=a.length;c<d;++c)(u=t[c])?(u.__data__=a[c],r[c]=u):i[c]=new EnterNode(e,a[c]);for(;c<h;++c)(u=t[c])&&(o[c]=u)}function bindKey(e,t,i,r,o,a,c){var u,h,d=new Map,f=t.length,m=a.length,g=new Array(f),v;for(u=0;u<f;++u)(h=t[u])&&(g[u]=v=c.call(h,h.__data__,u,t)+"",d.has(v)?o[u]=h:d.set(v,h));for(u=0;u<m;++u)v=c.call(e,a[u],u,a)+"",(h=d.get(v))?(r[u]=h,h.__data__=a[u],d.delete(v)):i[u]=new EnterNode(e,a[u]);for(u=0;u<f;++u)(h=t[u])&&d.get(g[u])===h&&(o[u]=h)}function datum(e){return e.__data__}function data_default(e,t){if(!arguments.length)return Array.from(this,datum);var i=t?bindKey:bindIndex,r=this._parents,o=this._groups;typeof e!="function"&&(e=constant_default$2(e));for(var a=o.length,c=new Array(a),u=new Array(a),h=new Array(a),d=0;d<a;++d){var f=r[d],m=o[d],g=m.length,v=arraylike(e.call(f,f&&f.__data__,d,r)),_=v.length,b=u[d]=new Array(_),S=c[d]=new Array(_),T=h[d]=new Array(g);i(f,m,b,S,T,v,t);for(var A=0,I=0,R,O;A<_;++A)if(R=b[A]){for(A>=I&&(I=A+1);!(O=S[I])&&++I<_;);R._next=O||null}}return c=new Selection$5(c,r),c._enter=u,c._exit=h,c}function arraylike(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function exit_default(){return new Selection$5(this._exit||this._groups.map(sparse_default),this._parents)}function join_default(e,t,i){var r=this.enter(),o=this,a=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),i==null?a.remove():i(a),r&&o?r.merge(o).order():o}function merge_default$2(e){for(var t=e.selection?e.selection():e,i=this._groups,r=t._groups,o=i.length,a=r.length,c=Math.min(o,a),u=new Array(o),h=0;h<c;++h)for(var d=i[h],f=r[h],m=d.length,g=u[h]=new Array(m),v,_=0;_<m;++_)(v=d[_]||f[_])&&(g[_]=v);for(;h<o;++h)u[h]=i[h];return new Selection$5(u,this._parents)}function order_default(){for(var e=this._groups,t=-1,i=e.length;++t<i;)for(var r=e[t],o=r.length-1,a=r[o],c;--o>=0;)(c=r[o])&&(a&&c.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(c,a),a=c);return this}function sort_default(e){e||(e=ascending);function t(m,g){return m&&g?e(m.__data__,g.__data__):!m-!g}for(var i=this._groups,r=i.length,o=new Array(r),a=0;a<r;++a){for(var c=i[a],u=c.length,h=o[a]=new Array(u),d,f=0;f<u;++f)(d=c[f])&&(h[f]=d);h.sort(t)}return new Selection$5(o,this._parents).order()}function ascending(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function call_default(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function nodes_default(){return Array.from(this)}function node_default(){for(var e=this._groups,t=0,i=e.length;t<i;++t)for(var r=e[t],o=0,a=r.length;o<a;++o){var c=r[o];if(c)return c}return null}function size_default(){let e=0;for(const t of this)++e;return e}function empty_default(){return!this.node()}function each_default(e){for(var t=this._groups,i=0,r=t.length;i<r;++i)for(var o=t[i],a=0,c=o.length,u;a<c;++a)(u=o[a])&&e.call(u,u.__data__,a,o);return this}function attrRemove$1(e){return function(){this.removeAttribute(e)}}function attrRemoveNS$1(e){return function(){this.removeAttributeNS(e.space,e.local)}}function attrConstant$1(e,t){return function(){this.setAttribute(e,t)}}function attrConstantNS$1(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function attrFunction$1(e,t){return function(){var i=t.apply(this,arguments);i==null?this.removeAttribute(e):this.setAttribute(e,i)}}function attrFunctionNS$1(e,t){return function(){var i=t.apply(this,arguments);i==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,i)}}function attr_default$1(e,t){var i=namespace_default(e);if(arguments.length<2){var r=this.node();return i.local?r.getAttributeNS(i.space,i.local):r.getAttribute(i)}return this.each((t==null?i.local?attrRemoveNS$1:attrRemove$1:typeof t=="function"?i.local?attrFunctionNS$1:attrFunction$1:i.local?attrConstantNS$1:attrConstant$1)(i,t))}function window_default(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function styleRemove$1(e){return function(){this.style.removeProperty(e)}}function styleConstant$1(e,t,i){return function(){this.style.setProperty(e,t,i)}}function styleFunction$1(e,t,i){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,i)}}function style_default$1(e,t,i){return arguments.length>1?this.each((t==null?styleRemove$1:typeof t=="function"?styleFunction$1:styleConstant$1)(e,t,i??"")):styleValue(this.node(),e)}function styleValue(e,t){return e.style.getPropertyValue(t)||window_default(e).getComputedStyle(e,null).getPropertyValue(t)}function propertyRemove(e){return function(){delete this[e]}}function propertyConstant(e,t){return function(){this[e]=t}}function propertyFunction(e,t){return function(){var i=t.apply(this,arguments);i==null?delete this[e]:this[e]=i}}function property_default$1(e,t){return arguments.length>1?this.each((t==null?propertyRemove:typeof t=="function"?propertyFunction:propertyConstant)(e,t)):this.node()[e]}function classArray(e){return e.trim().split(/^|\s+/)}function classList(e){return e.classList||new ClassList(e)}function ClassList(e){this._node=e,this._names=classArray(e.getAttribute("class")||"")}ClassList.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function classedAdd(e,t){for(var i=classList(e),r=-1,o=t.length;++r<o;)i.add(t[r])}function classedRemove(e,t){for(var i=classList(e),r=-1,o=t.length;++r<o;)i.remove(t[r])}function classedTrue(e){return function(){classedAdd(this,e)}}function classedFalse(e){return function(){classedRemove(this,e)}}function classedFunction(e,t){return function(){(t.apply(this,arguments)?classedAdd:classedRemove)(this,e)}}function classed_default(e,t){var i=classArray(e+"");if(arguments.length<2){for(var r=classList(this.node()),o=-1,a=i.length;++o<a;)if(!r.contains(i[o]))return!1;return!0}return this.each((typeof t=="function"?classedFunction:t?classedTrue:classedFalse)(i,t))}function textRemove(){this.textContent=""}function textConstant$1(e){return function(){this.textContent=e}}function textFunction$1(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function text_default$1(e){return arguments.length?this.each(e==null?textRemove:(typeof e=="function"?textFunction$1:textConstant$1)(e)):this.node().textContent}function htmlRemove(){this.innerHTML=""}function htmlConstant(e){return function(){this.innerHTML=e}}function htmlFunction(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function html_default(e){return arguments.length?this.each(e==null?htmlRemove:(typeof e=="function"?htmlFunction:htmlConstant)(e)):this.node().innerHTML}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function raise_default(){return this.each(raise)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function lower_default(){return this.each(lower)}function append_default(e){var t=typeof e=="function"?e:creator_default(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function constantNull(){return null}function insert_default(e,t){var i=typeof e=="function"?e:creator_default(e),r=t==null?constantNull:typeof t=="function"?t:selector_default(t);return this.select(function(){return this.insertBefore(i.apply(this,arguments),r.apply(this,arguments)||null)})}function remove$6(){var e=this.parentNode;e&&e.removeChild(this)}function remove_default$1(){return this.each(remove$6)}function selection_cloneShallow(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function selection_cloneDeep(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function clone_default$1(e){return this.select(e?selection_cloneDeep:selection_cloneShallow)}function datum_default(e){return arguments.length?this.property("__data__",e):this.node().__data__}function contextListener(e){return function(t){e.call(this,t,this.__data__)}}function parseTypenames(e){return e.trim().split(/^|\s+/).map(function(t){var i="",r=t.indexOf(".");return r>=0&&(i=t.slice(r+1),t=t.slice(0,r)),{type:t,name:i}})}function onRemove(e){return function(){var t=this.__on;if(t){for(var i=0,r=-1,o=t.length,a;i<o;++i)a=t[i],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++r]=a;++r?t.length=r:delete this.__on}}}function onAdd(e,t,i){return function(){var r=this.__on,o,a=contextListener(t);if(r){for(var c=0,u=r.length;c<u;++c)if((o=r[c]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=a,o.options=i),o.value=t;return}}this.addEventListener(e.type,a,i),o={type:e.type,name:e.name,value:t,listener:a,options:i},r?r.push(o):this.__on=[o]}}function on_default$1(e,t,i){var r=parseTypenames(e+""),o,a=r.length,c;if(arguments.length<2){var u=this.node().__on;if(u){for(var h=0,d=u.length,f;h<d;++h)for(o=0,f=u[h];o<a;++o)if((c=r[o]).type===f.type&&c.name===f.name)return f.value}return}for(u=t?onAdd:onRemove,o=0;o<a;++o)this.each(u(r[o],t,i));return this}function dispatchEvent(e,t,i){var r=window_default(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,i):(o=r.document.createEvent("Event"),i?(o.initEvent(t,i.bubbles,i.cancelable),o.detail=i.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function dispatchConstant(e,t){return function(){return dispatchEvent(this,e,t)}}function dispatchFunction(e,t){return function(){return dispatchEvent(this,e,t.apply(this,arguments))}}function dispatch_default(e,t){return this.each((typeof t=="function"?dispatchFunction:dispatchConstant)(e,t))}function*iterator_default(){for(var e=this._groups,t=0,i=e.length;t<i;++t)for(var r=e[t],o=0,a=r.length,c;o<a;++o)(c=r[o])&&(yield c)}var root$2=[null];function Selection$5(e,t){this._groups=e,this._parents=t}function selection(){return new Selection$5([[document.documentElement]],root$2)}function selection_selection(){return this}Selection$5.prototype=selection.prototype={constructor:Selection$5,select:select_default$2,selectAll:selectAll_default$1,selectChild:selectChild_default,selectChildren:selectChildren_default,filter:filter_default$1,data:data_default,enter:enter_default,exit:exit_default,join:join_default,merge:merge_default$2,selection:selection_selection,order:order_default,sort:sort_default,call:call_default,nodes:nodes_default,node:node_default,size:size_default,empty:empty_default,each:each_default,attr:attr_default$1,style:style_default$1,property:property_default$1,classed:classed_default,text:text_default$1,html:html_default,raise:raise_default,lower:lower_default,append:append_default,insert:insert_default,remove:remove_default$1,clone:clone_default$1,datum:datum_default,on:on_default$1,dispatch:dispatch_default,[Symbol.iterator]:iterator_default};var selection_default$4=selection;function select_default$1(e){return typeof e=="string"?new Selection$5([[document.querySelector(e)]],[document.documentElement]):new Selection$5([[e]],root$2)}function create_default(e){return select_default$1(creator_default(e).call(document.documentElement))}function define_default(e,t,i){e.prototype=t.prototype=i,i.constructor=e}function extend$3(e,t){var i=Object.create(e.prototype);for(var r in t)i[r]=t[r];return i}function Color(){}var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define_default(Color,color,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:color_formatHex8,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb});function color_formatHex(){return this.rgb().formatHex()}function color_formatHex8(){return this.rgb().formatHex8()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color(e){var t,i;return e=(e+"").trim().toLowerCase(),(t=reHex.exec(e))?(i=t[1].length,t=parseInt(t[1],16),i===6?rgbn(t):i===3?new Rgb(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):i===8?rgba(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):i===4?rgba(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=reRgbInteger.exec(e))?new Rgb(t[1],t[2],t[3],1):(t=reRgbPercent.exec(e))?new Rgb(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=reRgbaInteger.exec(e))?rgba(t[1],t[2],t[3],t[4]):(t=reRgbaPercent.exec(e))?rgba(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=reHslPercent.exec(e))?hsla(t[1],t[2]/100,t[3]/100,1):(t=reHslaPercent.exec(e))?hsla(t[1],t[2]/100,t[3]/100,t[4]):named.hasOwnProperty(e)?rgbn(named[e]):e==="transparent"?new Rgb(NaN,NaN,NaN,0):null}function rgbn(e){return new Rgb(e>>16&255,e>>8&255,e&255,1)}function rgba(e,t,i,r){return r<=0&&(e=t=i=NaN),new Rgb(e,t,i,r)}function rgbConvert(e){return e instanceof Color||(e=color(e)),e?(e=e.rgb(),new Rgb(e.r,e.g,e.b,e.opacity)):new Rgb}function rgb(e,t,i,r){return arguments.length===1?rgbConvert(e):new Rgb(e,t,i,r??1)}function Rgb(e,t,i,r){this.r=+e,this.g=+t,this.b=+i,this.opacity=+r}define_default(Rgb,rgb,extend$3(Color,{brighter(e){return e=e==null?brighter:Math.pow(brighter,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?darker:Math.pow(darker,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:rgb_formatHex8,formatRgb:rgb_formatRgb,toString:rgb_formatRgb}));function rgb_formatHex(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}`}function rgb_formatHex8(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity)?1:this.opacity)*255)}`}function rgb_formatRgb(){const e=clampa(this.opacity);return`${e===1?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${e===1?")":`, ${e})`}`}function clampa(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function clampi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function hex(e){return e=clampi(e),(e<16?"0":"")+e.toString(16)}function hsla(e,t,i,r){return r<=0?e=t=i=NaN:i<=0||i>=1?e=t=NaN:t<=0&&(e=NaN),new Hsl(e,t,i,r)}function hslConvert(e){if(e instanceof Hsl)return new Hsl(e.h,e.s,e.l,e.opacity);if(e instanceof Color||(e=color(e)),!e)return new Hsl;if(e instanceof Hsl)return e;e=e.rgb();var t=e.r/255,i=e.g/255,r=e.b/255,o=Math.min(t,i,r),a=Math.max(t,i,r),c=NaN,u=a-o,h=(a+o)/2;return u?(t===a?c=(i-r)/u+(i<r)*6:i===a?c=(r-t)/u+2:c=(t-i)/u+4,u/=h<.5?a+o:2-a-o,c*=60):u=h>0&&h<1?0:c,new Hsl(c,u,h,e.opacity)}function hsl(e,t,i,r){return arguments.length===1?hslConvert(e):new Hsl(e,t,i,r??1)}function Hsl(e,t,i,r){this.h=+e,this.s=+t,this.l=+i,this.opacity=+r}define_default(Hsl,hsl,extend$3(Color,{brighter(e){return e=e==null?brighter:Math.pow(brighter,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?darker:Math.pow(darker,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,i=this.l,r=i+(i<.5?i:1-i)*t,o=2*i-r;return new Rgb(hsl2rgb(e>=240?e-240:e+120,o,r),hsl2rgb(e,o,r),hsl2rgb(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=clampa(this.opacity);return`${e===1?"hsl(":"hsla("}${clamph(this.h)}, ${clampt(this.s)*100}%, ${clampt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function clamph(e){return e=(e||0)%360,e<0?e+360:e}function clampt(e){return Math.max(0,Math.min(1,e||0))}function hsl2rgb(e,t,i){return(e<60?t+(i-t)*e/60:e<180?i:e<240?t+(i-t)*(240-e)/60:t)*255}function basis(e,t,i,r,o){var a=e*e,c=a*e;return((1-3*e+3*a-c)*t+(4-6*a+3*c)*i+(1+3*e+3*a-3*c)*r+c*o)/6}function basis_default(e){var t=e.length-1;return function(i){var r=i<=0?i=0:i>=1?(i=1,t-1):Math.floor(i*t),o=e[r],a=e[r+1],c=r>0?e[r-1]:2*o-a,u=r<t-1?e[r+2]:2*a-o;return basis((i-r/t)*t,c,o,a,u)}}function basisClosed_default(e){var t=e.length;return function(i){var r=Math.floor(((i%=1)<0?++i:i)*t),o=e[(r+t-1)%t],a=e[r%t],c=e[(r+1)%t],u=e[(r+2)%t];return basis((i-r/t)*t,o,a,c,u)}}var constant_default$1=e=>()=>e;function linear$1(e,t){return function(i){return e+i*t}}function exponential(e,t,i){return e=Math.pow(e,i),t=Math.pow(t,i)-e,i=1/i,function(r){return Math.pow(e+r*t,i)}}function gamma(e){return(e=+e)==1?nogamma:function(t,i){return i-t?exponential(t,i,e):constant_default$1(isNaN(t)?i:t)}}function nogamma(e,t){var i=t-e;return i?linear$1(e,i):constant_default$1(isNaN(e)?t:e)}var rgb_default=function e(t){var i=gamma(t);function r(o,a){var c=i((o=rgb(o)).r,(a=rgb(a)).r),u=i(o.g,a.g),h=i(o.b,a.b),d=nogamma(o.opacity,a.opacity);return function(f){return o.r=c(f),o.g=u(f),o.b=h(f),o.opacity=d(f),o+""}}return r.gamma=e,r}(1);function rgbSpline(e){return function(t){var i=t.length,r=new Array(i),o=new Array(i),a=new Array(i),c,u;for(c=0;c<i;++c)u=rgb(t[c]),r[c]=u.r||0,o[c]=u.g||0,a[c]=u.b||0;return r=e(r),o=e(o),a=e(a),u.opacity=1,function(h){return u.r=r(h),u.g=o(h),u.b=a(h),u+""}}}var rgbBasis=rgbSpline(basis_default),rgbBasisClosed=rgbSpline(basisClosed_default);function numberArray_default(e,t){t||(t=[]);var i=e?Math.min(t.length,e.length):0,r=t.slice(),o;return function(a){for(o=0;o<i;++o)r[o]=e[o]*(1-a)+t[o]*a;return r}}function isNumberArray(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function genericArray(e,t){var i=t?t.length:0,r=e?Math.min(i,e.length):0,o=new Array(r),a=new Array(i),c;for(c=0;c<r;++c)o[c]=value_default(e[c],t[c]);for(;c<i;++c)a[c]=t[c];return function(u){for(c=0;c<r;++c)a[c]=o[c](u);return a}}function date_default(e,t){var i=new Date;return e=+e,t=+t,function(r){return i.setTime(e*(1-r)+t*r),i}}function number_default(e,t){return e=+e,t=+t,function(i){return e*(1-i)+t*i}}function object_default(e,t){var i={},r={},o;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(o in t)o in e?i[o]=value_default(e[o],t[o]):r[o]=t[o];return function(a){for(o in i)r[o]=i[o](a);return r}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero(e){return function(){return e}}function one(e){return function(t){return e(t)+""}}function string_default(e,t){var i=reA.lastIndex=reB.lastIndex=0,r,o,a,c=-1,u=[],h=[];for(e=e+"",t=t+"";(r=reA.exec(e))&&(o=reB.exec(t));)(a=o.index)>i&&(a=t.slice(i,a),u[c]?u[c]+=a:u[++c]=a),(r=r[0])===(o=o[0])?u[c]?u[c]+=o:u[++c]=o:(u[++c]=null,h.push({i:c,x:number_default(r,o)})),i=reB.lastIndex;return i<t.length&&(a=t.slice(i),u[c]?u[c]+=a:u[++c]=a),u.length<2?h[0]?one(h[0].x):zero(t):(t=h.length,function(d){for(var f=0,m;f<t;++f)u[(m=h[f]).i]=m.x(d);return u.join("")})}function value_default(e,t){var i=typeof t,r;return t==null||i==="boolean"?constant_default$1(t):(i==="number"?number_default:i==="string"?(r=color(t))?(t=r,rgb_default):string_default:t instanceof color?rgb_default:t instanceof Date?date_default:isNumberArray(t)?numberArray_default:Array.isArray(t)?genericArray:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?object_default:number_default)(e,t)}function round_default(e,t){return e=+e,t=+t,function(i){return Math.round(e*(1-i)+t*i)}}var degrees=180/Math.PI,identity$3={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function decompose_default(e,t,i,r,o,a){var c,u,h;return(c=Math.sqrt(e*e+t*t))&&(e/=c,t/=c),(h=e*i+t*r)&&(i-=e*h,r-=t*h),(u=Math.sqrt(i*i+r*r))&&(i/=u,r/=u,h/=u),e*r<t*i&&(e=-e,t=-t,h=-h,c=-c),{translateX:o,translateY:a,rotate:Math.atan2(t,e)*degrees,skewX:Math.atan(h)*degrees,scaleX:c,scaleY:u}}var svgNode;function parseCss(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?identity$3:decompose_default(t.a,t.b,t.c,t.d,t.e,t.f)}function parseSvg(e){return e==null||(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",e),!(e=svgNode.transform.baseVal.consolidate()))?identity$3:(e=e.matrix,decompose_default(e.a,e.b,e.c,e.d,e.e,e.f))}function interpolateTransform(e,t,i,r){function o(d){return d.length?d.pop()+" ":""}function a(d,f,m,g,v,_){if(d!==m||f!==g){var b=v.push("translate(",null,t,null,i);_.push({i:b-4,x:number_default(d,m)},{i:b-2,x:number_default(f,g)})}else(m||g)&&v.push("translate("+m+t+g+i)}function c(d,f,m,g){d!==f?(d-f>180?f+=360:f-d>180&&(d+=360),g.push({i:m.push(o(m)+"rotate(",null,r)-2,x:number_default(d,f)})):f&&m.push(o(m)+"rotate("+f+r)}function u(d,f,m,g){d!==f?g.push({i:m.push(o(m)+"skewX(",null,r)-2,x:number_default(d,f)}):f&&m.push(o(m)+"skewX("+f+r)}function h(d,f,m,g,v,_){if(d!==m||f!==g){var b=v.push(o(v)+"scale(",null,",",null,")");_.push({i:b-4,x:number_default(d,m)},{i:b-2,x:number_default(f,g)})}else(m!==1||g!==1)&&v.push(o(v)+"scale("+m+","+g+")")}return function(d,f){var m=[],g=[];return d=e(d),f=e(f),a(d.translateX,d.translateY,f.translateX,f.translateY,m,g),c(d.rotate,f.rotate,m,g),u(d.skewX,f.skewX,m,g),h(d.scaleX,d.scaleY,f.scaleX,f.scaleY,m,g),d=f=null,function(v){for(var _=-1,b=g.length,S;++_<b;)m[(S=g[_]).i]=S.x(v);return m.join("")}}}var interpolateTransformCss=interpolateTransform(parseCss,"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(parseSvg,", ",")",")"),frame=0,timeout=0,interval=0,pokeDelay=1e3,taskHead,taskTail,clockLast=0,clockNow=0,clockSkew=0,clock=typeof performance=="object"&&performance.now?performance:Date,setFrame=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function now$2(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}Timer.prototype=timer.prototype={constructor:Timer,restart:function(e,t,i){if(typeof e!="function")throw new TypeError("callback is not a function");i=(i==null?now$2():+i)+(t==null?0:+t),!this._next&&taskTail!==this&&(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=e,this._time=i,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};function timer(e,t,i){var r=new Timer;return r.restart(e,t,i),r}function timerFlush(){now$2(),++frame;for(var e=taskHead,t;e;)(t=clockNow-e._time)>=0&&e._call.call(void 0,t),e=e._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var e=clock.now(),t=e-clockLast;t>pokeDelay&&(clockSkew-=t,clockLast=e)}function nap(){for(var e,t=taskHead,i,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(i=t._next,t._next=null,t=e?e._next=i:taskHead=i);taskTail=e,sleep(r)}function sleep(e){if(!frame){timeout&&(timeout=clearTimeout(timeout));var t=e-clockNow;t>24?(e<1/0&&(timeout=setTimeout(wake,e-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake))}}function timeout_default(e,t,i){var r=new Timer;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,i),r}var emptyOn=dispatch_default$1("start","end","cancel","interrupt"),emptyTween=[],CREATED=0,SCHEDULED=1,STARTING=2,STARTED=3,RUNNING=4,ENDING=5,ENDED=6;function schedule_default(e,t,i,r,o,a){var c=e.__transition;if(!c)e.__transition={};else if(i in c)return;create$1(e,i,{name:t,index:r,group:o,on:emptyOn,tween:emptyTween,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:CREATED})}function init(e,t){var i=get$2(e,t);if(i.state>CREATED)throw new Error("too late; already scheduled");return i}function set$3(e,t){var i=get$2(e,t);if(i.state>STARTED)throw new Error("too late; already running");return i}function get$2(e,t){var i=e.__transition;if(!i||!(i=i[t]))throw new Error("transition not found");return i}function create$1(e,t,i){var r=e.__transition,o;r[t]=i,i.timer=timer(a,0,i.time);function a(d){i.state=SCHEDULED,i.timer.restart(c,i.delay,i.time),i.delay<=d&&c(d-i.delay)}function c(d){var f,m,g,v;if(i.state!==SCHEDULED)return h();for(f in r)if(v=r[f],v.name===i.name){if(v.state===STARTED)return timeout_default(c);v.state===RUNNING?(v.state=ENDED,v.timer.stop(),v.on.call("interrupt",e,e.__data__,v.index,v.group),delete r[f]):+f<t&&(v.state=ENDED,v.timer.stop(),v.on.call("cancel",e,e.__data__,v.index,v.group),delete r[f])}if(timeout_default(function(){i.state===STARTED&&(i.state=RUNNING,i.timer.restart(u,i.delay,i.time),u(d))}),i.state=STARTING,i.on.call("start",e,e.__data__,i.index,i.group),i.state===STARTING){for(i.state=STARTED,o=new Array(g=i.tween.length),f=0,m=-1;f<g;++f)(v=i.tween[f].value.call(e,e.__data__,i.index,i.group))&&(o[++m]=v);o.length=m+1}}function u(d){for(var f=d<i.duration?i.ease.call(null,d/i.duration):(i.timer.restart(h),i.state=ENDING,1),m=-1,g=o.length;++m<g;)o[m].call(e,f);i.state===ENDING&&(i.on.call("end",e,e.__data__,i.index,i.group),h())}function h(){i.state=ENDED,i.timer.stop(),delete r[t];for(var d in r)return;delete e.__transition}}function interrupt_default(e,t){var i=e.__transition,r,o,a=!0,c;if(i){t=t==null?null:t+"";for(c in i){if((r=i[c]).name!==t){a=!1;continue}o=r.state>STARTING&&r.state<ENDING,r.state=ENDED,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete i[c]}a&&delete e.__transition}}function interrupt_default$1(e){return this.each(function(){interrupt_default(this,e)})}function tweenRemove(e,t){var i,r;return function(){var o=set$3(this,e),a=o.tween;if(a!==i){r=i=a;for(var c=0,u=r.length;c<u;++c)if(r[c].name===t){r=r.slice(),r.splice(c,1);break}}o.tween=r}}function tweenFunction(e,t,i){var r,o;if(typeof i!="function")throw new Error;return function(){var a=set$3(this,e),c=a.tween;if(c!==r){o=(r=c).slice();for(var u={name:t,value:i},h=0,d=o.length;h<d;++h)if(o[h].name===t){o[h]=u;break}h===d&&o.push(u)}a.tween=o}}function tween_default(e,t){var i=this._id;if(e+="",arguments.length<2){for(var r=get$2(this.node(),i).tween,o=0,a=r.length,c;o<a;++o)if((c=r[o]).name===e)return c.value;return null}return this.each((t==null?tweenRemove:tweenFunction)(i,e,t))}function tweenValue(e,t,i){var r=e._id;return e.each(function(){var o=set$3(this,r);(o.value||(o.value={}))[t]=i.apply(this,arguments)}),function(o){return get$2(o,r).value[t]}}function interpolate_default(e,t){var i;return(typeof t=="number"?number_default:t instanceof color?rgb_default:(i=color(t))?(t=i,rgb_default):string_default)(e,t)}function attrRemove(e){return function(){this.removeAttribute(e)}}function attrRemoveNS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function attrConstant(e,t,i){var r,o=i+"",a;return function(){var c=this.getAttribute(e);return c===o?null:c===r?a:a=t(r=c,i)}}function attrConstantNS(e,t,i){var r,o=i+"",a;return function(){var c=this.getAttributeNS(e.space,e.local);return c===o?null:c===r?a:a=t(r=c,i)}}function attrFunction(e,t,i){var r,o,a;return function(){var c,u=i(this),h;return u==null?void this.removeAttribute(e):(c=this.getAttribute(e),h=u+"",c===h?null:c===r&&h===o?a:(o=h,a=t(r=c,u)))}}function attrFunctionNS(e,t,i){var r,o,a;return function(){var c,u=i(this),h;return u==null?void this.removeAttributeNS(e.space,e.local):(c=this.getAttributeNS(e.space,e.local),h=u+"",c===h?null:c===r&&h===o?a:(o=h,a=t(r=c,u)))}}function attr_default(e,t){var i=namespace_default(e),r=i==="transform"?interpolateTransformSvg:interpolate_default;return this.attrTween(e,typeof t=="function"?(i.local?attrFunctionNS:attrFunction)(i,r,tweenValue(this,"attr."+e,t)):t==null?(i.local?attrRemoveNS:attrRemove)(i):(i.local?attrConstantNS:attrConstant)(i,r,t))}function attrInterpolate(e,t){return function(i){this.setAttribute(e,t.call(this,i))}}function attrInterpolateNS(e,t){return function(i){this.setAttributeNS(e.space,e.local,t.call(this,i))}}function attrTweenNS(e,t){var i,r;function o(){var a=t.apply(this,arguments);return a!==r&&(i=(r=a)&&attrInterpolateNS(e,a)),i}return o._value=t,o}function attrTween(e,t){var i,r;function o(){var a=t.apply(this,arguments);return a!==r&&(i=(r=a)&&attrInterpolate(e,a)),i}return o._value=t,o}function attrTween_default(e,t){var i="attr."+e;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(t==null)return this.tween(i,null);if(typeof t!="function")throw new Error;var r=namespace_default(e);return this.tween(i,(r.local?attrTweenNS:attrTween)(r,t))}function delayFunction(e,t){return function(){init(this,e).delay=+t.apply(this,arguments)}}function delayConstant(e,t){return t=+t,function(){init(this,e).delay=t}}function delay_default(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?delayFunction:delayConstant)(t,e)):get$2(this.node(),t).delay}function durationFunction(e,t){return function(){set$3(this,e).duration=+t.apply(this,arguments)}}function durationConstant(e,t){return t=+t,function(){set$3(this,e).duration=t}}function duration_default(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?durationFunction:durationConstant)(t,e)):get$2(this.node(),t).duration}function easeConstant(e,t){if(typeof t!="function")throw new Error;return function(){set$3(this,e).ease=t}}function ease_default(e){var t=this._id;return arguments.length?this.each(easeConstant(t,e)):get$2(this.node(),t).ease}function easeVarying(e,t){return function(){var i=t.apply(this,arguments);if(typeof i!="function")throw new Error;set$3(this,e).ease=i}}function easeVarying_default(e){if(typeof e!="function")throw new Error;return this.each(easeVarying(this._id,e))}function filter_default(e){typeof e!="function"&&(e=matcher_default(e));for(var t=this._groups,i=t.length,r=new Array(i),o=0;o<i;++o)for(var a=t[o],c=a.length,u=r[o]=[],h,d=0;d<c;++d)(h=a[d])&&e.call(h,h.__data__,d,a)&&u.push(h);return new Transition(r,this._parents,this._name,this._id)}function merge_default$1(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,i=e._groups,r=t.length,o=i.length,a=Math.min(r,o),c=new Array(r),u=0;u<a;++u)for(var h=t[u],d=i[u],f=h.length,m=c[u]=new Array(f),g,v=0;v<f;++v)(g=h[v]||d[v])&&(m[v]=g);for(;u<r;++u)c[u]=t[u];return new Transition(c,this._parents,this._name,this._id)}function start$1(e){return(e+"").trim().split(/^|\s+/).every(function(t){var i=t.indexOf(".");return i>=0&&(t=t.slice(0,i)),!t||t==="start"})}function onFunction(e,t,i){var r,o,a=start$1(t)?init:set$3;return function(){var c=a(this,e),u=c.on;u!==r&&(o=(r=u).copy()).on(t,i),c.on=o}}function on_default(e,t){var i=this._id;return arguments.length<2?get$2(this.node(),i).on.on(e):this.each(onFunction(i,e,t))}function removeFunction(e){return function(){var t=this.parentNode;for(var i in this.__transition)if(+i!==e)return;t&&t.removeChild(this)}}function remove_default(){return this.on("end.remove",removeFunction(this._id))}function select_default(e){var t=this._name,i=this._id;typeof e!="function"&&(e=selector_default(e));for(var r=this._groups,o=r.length,a=new Array(o),c=0;c<o;++c)for(var u=r[c],h=u.length,d=a[c]=new Array(h),f,m,g=0;g<h;++g)(f=u[g])&&(m=e.call(f,f.__data__,g,u))&&("__data__"in f&&(m.__data__=f.__data__),d[g]=m,schedule_default(d[g],t,i,g,d,get$2(f,i)));return new Transition(a,this._parents,t,i)}function selectAll_default(e){var t=this._name,i=this._id;typeof e!="function"&&(e=selectorAll_default(e));for(var r=this._groups,o=r.length,a=[],c=[],u=0;u<o;++u)for(var h=r[u],d=h.length,f,m=0;m<d;++m)if(f=h[m]){for(var g=e.call(f,f.__data__,m,h),v,_=get$2(f,i),b=0,S=g.length;b<S;++b)(v=g[b])&&schedule_default(v,t,i,b,g,_);a.push(g),c.push(f)}return new Transition(a,c,t,i)}var Selection$4=selection_default$4.prototype.constructor;function selection_default$3(){return new Selection$4(this._groups,this._parents)}function styleNull(e,t){var i,r,o;return function(){var a=styleValue(this,e),c=(this.style.removeProperty(e),styleValue(this,e));return a===c?null:a===i&&c===r?o:o=t(i=a,r=c)}}function styleRemove(e){return function(){this.style.removeProperty(e)}}function styleConstant(e,t,i){var r,o=i+"",a;return function(){var c=styleValue(this,e);return c===o?null:c===r?a:a=t(r=c,i)}}function styleFunction(e,t,i){var r,o,a;return function(){var c=styleValue(this,e),u=i(this),h=u+"";return u==null&&(h=u=(this.style.removeProperty(e),styleValue(this,e))),c===h?null:c===r&&h===o?a:(o=h,a=t(r=c,u))}}function styleMaybeRemove(e,t){var i,r,o,a="style."+t,c="end."+a,u;return function(){var h=set$3(this,e),d=h.on,f=h.value[a]==null?u||(u=styleRemove(t)):void 0;(d!==i||o!==f)&&(r=(i=d).copy()).on(c,o=f),h.on=r}}function style_default(e,t,i){var r=(e+="")=="transform"?interpolateTransformCss:interpolate_default;return t==null?this.styleTween(e,styleNull(e,r)).on("end.style."+e,styleRemove(e)):typeof t=="function"?this.styleTween(e,styleFunction(e,r,tweenValue(this,"style."+e,t))).each(styleMaybeRemove(this._id,e)):this.styleTween(e,styleConstant(e,r,t),i).on("end.style."+e,null)}function styleInterpolate(e,t,i){return function(r){this.style.setProperty(e,t.call(this,r),i)}}function styleTween(e,t,i){var r,o;function a(){var c=t.apply(this,arguments);return c!==o&&(r=(o=c)&&styleInterpolate(e,c,i)),r}return a._value=t,a}function styleTween_default(e,t,i){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,styleTween(e,t,i??""))}function textConstant(e){return function(){this.textContent=e}}function textFunction(e){return function(){var t=e(this);this.textContent=t??""}}function text_default(e){return this.tween("text",typeof e=="function"?textFunction(tweenValue(this,"text",e)):textConstant(e==null?"":e+""))}function textInterpolate(e){return function(t){this.textContent=e.call(this,t)}}function textTween(e){var t,i;function r(){var o=e.apply(this,arguments);return o!==i&&(t=(i=o)&&textInterpolate(o)),t}return r._value=e,r}function textTween_default(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,textTween(e))}function transition_default$1(){for(var e=this._name,t=this._id,i=newId(),r=this._groups,o=r.length,a=0;a<o;++a)for(var c=r[a],u=c.length,h,d=0;d<u;++d)if(h=c[d]){var f=get$2(h,t);schedule_default(h,e,i,d,c,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new Transition(r,this._parents,e,i)}function end_default(){var e,t,i=this,r=i._id,o=i.size();return new Promise(function(a,c){var u={value:c},h={value:function(){--o===0&&a()}};i.each(function(){var d=set$3(this,r),f=d.on;f!==e&&(t=(e=f).copy(),t._.cancel.push(u),t._.interrupt.push(u),t._.end.push(h)),d.on=t}),o===0&&a()})}var id$1=0;function Transition(e,t,i,r){this._groups=e,this._parents=t,this._name=i,this._id=r}function transition(e){return selection_default$4().transition(e)}function newId(){return++id$1}var selection_prototype=selection_default$4.prototype;Transition.prototype=transition.prototype={constructor:Transition,select:select_default,selectAll:selectAll_default,selectChild:selection_prototype.selectChild,selectChildren:selection_prototype.selectChildren,filter:filter_default,merge:merge_default$1,selection:selection_default$3,transition:transition_default$1,call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:on_default,attr:attr_default,attrTween:attrTween_default,style:style_default,styleTween:styleTween_default,text:text_default,textTween:textTween_default,remove:remove_default,tween:tween_default,delay:delay_default,duration:duration_default,ease:ease_default,easeVarying:easeVarying_default,end:end_default,[Symbol.iterator]:selection_prototype[Symbol.iterator]};function cubicInOut(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var defaultTiming={time:null,delay:0,duration:250,ease:cubicInOut};function inherit$2(e,t){for(var i;!(i=e.__transition)||!(i=i[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return i}function transition_default(e){var t,i;e instanceof Transition?(t=e._id,e=e._name):(t=newId(),(i=defaultTiming).time=now$2(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,a=0;a<o;++a)for(var c=r[a],u=c.length,h,d=0;d<u;++d)(h=c[d])&&schedule_default(h,e,t,d,c,i||inherit$2(h,t));return new Transition(r,this._parents,e,t)}selection_default$4.prototype.interrupt=interrupt_default$1,selection_default$4.prototype.transition=transition_default;const{abs,max:max$4,min:min$3}=Math;function number1(e){return[+e[0],+e[1]]}function number2(e){return[number1(e[0]),number1(e[1])]}var X={name:"x",handles:["w","e"].map(type),input:function(e,t){return e==null?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},Y={name:"y",handles:["n","s"].map(type),input:function(e,t){return e==null?null:[[t[0][0],+e[0]],[t[1][0],+e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},XY={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(type),input:function(e){return e==null?null:number2(e)},output:function(e){return e}};function type(e){return{type:e}}function formatDecimal_default(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function formatDecimalParts(e,t){if((i=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var i,r=e.slice(0,i);return[r.length>1?r[0]+r.slice(2):r,+e.slice(i+1)]}function exponent_default(e){return e=formatDecimalParts(Math.abs(e)),e?e[1]:NaN}function formatGroup_default(e,t){return function(i,r){for(var o=i.length,a=[],c=0,u=e[0],h=0;o>0&&u>0&&(h+u+1>r&&(u=Math.max(1,r-h)),a.push(i.substring(o-=u,o+u)),!((h+=u+1)>r));)u=e[c=(c+1)%e.length];return a.reverse().join(t)}}function formatNumerals_default(e){return function(t){return t.replace(/[0-9]/g,function(i){return e[+i]})}}var re=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function formatSpecifier(e){if(!(t=re.exec(e)))throw new Error("invalid format: "+e);var t;return new FormatSpecifier({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}formatSpecifier.prototype=FormatSpecifier.prototype;function FormatSpecifier(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function formatTrim_default(e){e:for(var t=e.length,i=1,r=-1,o;i<t;++i)switch(e[i]){case".":r=o=i;break;case"0":r===0&&(r=i),o=i;break;default:if(!+e[i])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(o+1):e}var prefixExponent;function formatPrefixAuto_default(e,t){var i=formatDecimalParts(e,t);if(!i)return e+"";var r=i[0],o=i[1],a=o-(prefixExponent=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,c=r.length;return a===c?r:a>c?r+new Array(a-c+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+formatDecimalParts(e,Math.max(0,t+a-1))[0]}function formatRounded_default(e,t){var i=formatDecimalParts(e,t);if(!i)return e+"";var r=i[0],o=i[1];return o<0?"0."+new Array(-o).join("0")+r:r.length>o+1?r.slice(0,o+1)+"."+r.slice(o+1):r+new Array(o-r.length+2).join("0")}var formatTypes_default={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:formatDecimal_default,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>formatRounded_default(e*100,t),r:formatRounded_default,s:formatPrefixAuto_default,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function identity_default$1(e){return e}var map=Array.prototype.map,prefixes=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function locale_default(e){var t=e.grouping===void 0||e.thousands===void 0?identity_default$1:formatGroup_default(map.call(e.grouping,Number),e.thousands+""),i=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",o=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?identity_default$1:formatNumerals_default(map.call(e.numerals,String)),c=e.percent===void 0?"%":e.percent+"",u=e.minus===void 0?"\u2212":e.minus+"",h=e.nan===void 0?"NaN":e.nan+"";function d(m){m=formatSpecifier(m);var g=m.fill,v=m.align,_=m.sign,b=m.symbol,S=m.zero,T=m.width,A=m.comma,I=m.precision,R=m.trim,O=m.type;O==="n"?(A=!0,O="g"):formatTypes_default[O]||(I===void 0&&(I=12),R=!0,O="g"),(S||g==="0"&&v==="=")&&(S=!0,g="0",v="=");var P=b==="$"?i:b==="#"&&/[boxX]/.test(O)?"0"+O.toLowerCase():"",L=b==="$"?r:/[%p]/.test(O)?c:"",V=formatTypes_default[O],U=/[defgprs%]/.test(O);I=I===void 0?6:/[gprs]/.test(O)?Math.max(1,Math.min(21,I)):Math.max(0,Math.min(20,I));function $(Z){var ie=P,ue=L,_e,Ee,pe;if(O==="c")ue=V(Z)+ue,Z="";else{Z=+Z;var me=Z<0||1/Z<0;if(Z=isNaN(Z)?h:V(Math.abs(Z),I),R&&(Z=formatTrim_default(Z)),me&&+Z==0&&_!=="+"&&(me=!1),ie=(me?_==="("?_:u:_==="-"||_==="("?"":_)+ie,ue=(O==="s"?prefixes[8+prefixExponent/3]:"")+ue+(me&&_==="("?")":""),U){for(_e=-1,Ee=Z.length;++_e<Ee;)if(pe=Z.charCodeAt(_e),48>pe||pe>57){ue=(pe===46?o+Z.slice(_e+1):Z.slice(_e))+ue,Z=Z.slice(0,_e);break}}}A&&!S&&(Z=t(Z,1/0));var Se=ie.length+Z.length+ue.length,Le=Se<T?new Array(T-Se+1).join(g):"";switch(A&&S&&(Z=t(Le+Z,Le.length?T-ue.length:1/0),Le=""),v){case"<":Z=ie+Z+ue+Le;break;case"=":Z=ie+Le+Z+ue;break;case"^":Z=Le.slice(0,Se=Le.length>>1)+ie+Z+ue+Le.slice(Se);break;default:Z=Le+ie+Z+ue;break}return a(Z)}return $.toString=function(){return m+""},$}function f(m,g){var v=d((m=formatSpecifier(m),m.type="f",m)),_=Math.max(-8,Math.min(8,Math.floor(exponent_default(g)/3)))*3,b=Math.pow(10,-_),S=prefixes[8+_/3];return function(T){return v(b*T)+S}}return{format:d,formatPrefix:f}}var locale$1,format$1,formatPrefix;defaultLocale$2({thousands:",",grouping:[3],currency:["$",""]});function defaultLocale$2(e){return locale$1=locale_default(e),format$1=locale$1.format,formatPrefix=locale$1.formatPrefix,locale$1}function precisionFixed_default(e){return Math.max(0,-exponent_default(Math.abs(e)))}function precisionPrefix_default(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(exponent_default(t)/3)))*3-exponent_default(Math.abs(e)))}function precisionRound_default(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,exponent_default(t)-exponent_default(e))+1}function initRange(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function constants(e){return function(){return e}}function number$1(e){return+e}var unit=[0,1];function identity$2(e){return e}function normalize$6(e,t){return(t-=e=+e)?function(i){return(i-e)/t}:constants(isNaN(t)?NaN:.5)}function clamper(e,t){var i;return e>t&&(i=e,e=t,t=i),function(r){return Math.max(e,Math.min(t,r))}}function bimap(e,t,i){var r=e[0],o=e[1],a=t[0],c=t[1];return o<r?(r=normalize$6(o,r),a=i(c,a)):(r=normalize$6(r,o),a=i(a,c)),function(u){return a(r(u))}}function polymap(e,t,i){var r=Math.min(e.length,t.length)-1,o=new Array(r),a=new Array(r),c=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++c<r;)o[c]=normalize$6(e[c],e[c+1]),a[c]=i(t[c],t[c+1]);return function(u){var h=bisect_default(e,u,1,r)-1;return a[h](o[h](u))}}function copy(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function transformer(){var e=unit,t=unit,i=value_default,r,o,a,c=identity$2,u,h,d;function f(){var g=Math.min(e.length,t.length);return c!==identity$2&&(c=clamper(e[0],e[g-1])),u=g>2?polymap:bimap,h=d=null,m}function m(g){return g==null||isNaN(g=+g)?a:(h||(h=u(e.map(r),t,i)))(r(c(g)))}return m.invert=function(g){return c(o((d||(d=u(t,e.map(r),number_default)))(g)))},m.domain=function(g){return arguments.length?(e=Array.from(g,number$1),f()):e.slice()},m.range=function(g){return arguments.length?(t=Array.from(g),f()):t.slice()},m.rangeRound=function(g){return t=Array.from(g),i=round_default,f()},m.clamp=function(g){return arguments.length?(c=g?!0:identity$2,f()):c!==identity$2},m.interpolate=function(g){return arguments.length?(i=g,f()):i},m.unknown=function(g){return arguments.length?(a=g,m):a},function(g,v){return r=g,o=v,f()}}function continuous(){return transformer()(identity$2,identity$2)}function tickFormat(e,t,i,r){var o=tickStep(e,t,i),a;switch(r=formatSpecifier(r??",f"),r.type){case"s":{var c=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(a=precisionPrefix_default(o,c))&&(r.precision=a),formatPrefix(r,c)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=precisionRound_default(o,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=precisionFixed_default(o))&&(r.precision=a-(r.type==="%")*2);break}}return format$1(r)}function linearish(e){var t=e.domain;return e.ticks=function(i){var r=t();return ticks(r[0],r[r.length-1],i??10)},e.tickFormat=function(i,r){var o=t();return tickFormat(o[0],o[o.length-1],i??10,r)},e.nice=function(i){i==null&&(i=10);var r=t(),o=0,a=r.length-1,c=r[o],u=r[a],h,d,f=10;for(u<c&&(d=c,c=u,u=d,d=o,o=a,a=d);f-- >0;){if(d=tickIncrement(c,u,i),d===h)return r[o]=c,r[a]=u,t(r);if(d>0)c=Math.floor(c/d)*d,u=Math.ceil(u/d)*d;else if(d<0)c=Math.ceil(c*d)/d,u=Math.floor(u*d)/d;else break;h=d}return e},e}function linear(){var e=continuous();return e.copy=function(){return copy(e,linear())},initRange.apply(e,arguments),linearish(e)}function nice(e,t){e=e.slice();var i=0,r=e.length-1,o=e[i],a=e[r],c;return a<o&&(c=i,i=r,r=c,c=o,o=a,a=c),e[i]=t.floor(o),e[r]=t.ceil(a),e}const t0=new Date,t1=new Date;function timeInterval(e,t,i,r){function o(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return o.floor=a=>(e(a=new Date(+a)),a),o.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),o.round=a=>{const c=o(a),u=o.ceil(a);return a-c<u-a?c:u},o.offset=(a,c)=>(t(a=new Date(+a),c==null?1:Math.floor(c)),a),o.range=(a,c,u)=>{const h=[];if(a=o.ceil(a),u=u==null?1:Math.floor(u),!(a<c)||!(u>0))return h;let d;do h.push(d=new Date(+a)),t(a,u),e(a);while(d<a&&a<c);return h},o.filter=a=>timeInterval(c=>{if(c>=c)for(;e(c),!a(c);)c.setTime(c-1)},(c,u)=>{if(c>=c)if(u<0)for(;++u<=0;)for(;t(c,-1),!a(c););else for(;--u>=0;)for(;t(c,1),!a(c););}),i&&(o.count=(a,c)=>(t0.setTime(+a),t1.setTime(+c),e(t0),e(t1),Math.floor(i(t0,t1))),o.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?o.filter(r?c=>r(c)%a===0:c=>o.count(0,c)%a===0):o)),o}const millisecond=timeInterval(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);millisecond.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?timeInterval(t=>{t.setTime(Math.floor(t/e)*e)},(t,i)=>{t.setTime(+t+i*e)},(t,i)=>(i-t)/e):millisecond);const milliseconds=millisecond.range,durationSecond=1e3,durationMinute=durationSecond*60,durationHour=durationMinute*60,durationDay=durationHour*24,durationWeek=durationDay*7,durationMonth=durationDay*30,durationYear=durationDay*365,second=timeInterval(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*durationSecond)},(e,t)=>(t-e)/durationSecond,e=>e.getUTCSeconds()),seconds=second.range,timeMinute=timeInterval(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*durationSecond)},(e,t)=>{e.setTime(+e+t*durationMinute)},(e,t)=>(t-e)/durationMinute,e=>e.getMinutes()),timeMinutes=timeMinute.range,utcMinute=timeInterval(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*durationMinute)},(e,t)=>(t-e)/durationMinute,e=>e.getUTCMinutes()),utcMinutes=utcMinute.range,timeHour=timeInterval(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*durationSecond-e.getMinutes()*durationMinute)},(e,t)=>{e.setTime(+e+t*durationHour)},(e,t)=>(t-e)/durationHour,e=>e.getHours()),timeHours=timeHour.range,utcHour=timeInterval(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*durationHour)},(e,t)=>(t-e)/durationHour,e=>e.getUTCHours()),utcHours=utcHour.range,timeDay=timeInterval(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*durationMinute)/durationDay,e=>e.getDate()-1),timeDays=timeDay.range,utcDay=timeInterval(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/durationDay,e=>e.getUTCDate()-1),utcDays=utcDay.range,unixDay=timeInterval(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/durationDay,e=>Math.floor(e/durationDay)),unixDays=unixDay.range;function timeWeekday(e){return timeInterval(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,i)=>{t.setDate(t.getDate()+i*7)},(t,i)=>(i-t-(i.getTimezoneOffset()-t.getTimezoneOffset())*durationMinute)/durationWeek)}const timeSunday=timeWeekday(0),timeMonday=timeWeekday(1),timeTuesday=timeWeekday(2),timeWednesday=timeWeekday(3),timeThursday=timeWeekday(4),timeFriday=timeWeekday(5),timeSaturday=timeWeekday(6),timeSundays=timeSunday.range,timeMondays=timeMonday.range,timeTuesdays=timeTuesday.range,timeWednesdays=timeWednesday.range,timeThursdays=timeThursday.range,timeFridays=timeFriday.range,timeSaturdays=timeSaturday.range;function utcWeekday(e){return timeInterval(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,i)=>{t.setUTCDate(t.getUTCDate()+i*7)},(t,i)=>(i-t)/durationWeek)}const utcSunday=utcWeekday(0),utcMonday=utcWeekday(1),utcTuesday=utcWeekday(2),utcWednesday=utcWeekday(3),utcThursday=utcWeekday(4),utcFriday=utcWeekday(5),utcSaturday=utcWeekday(6),utcSundays=utcSunday.range,utcMondays=utcMonday.range,utcTuesdays=utcTuesday.range,utcWednesdays=utcWednesday.range,utcThursdays=utcThursday.range,utcFridays=utcFriday.range,utcSaturdays=utcSaturday.range,timeMonth=timeInterval(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth()),timeMonths=timeMonth.range,utcMonth=timeInterval(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth()),utcMonths=utcMonth.range,timeYear=timeInterval(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());timeYear.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:timeInterval(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,i)=>{t.setFullYear(t.getFullYear()+i*e)});const timeYears=timeYear.range,utcYear=timeInterval(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());utcYear.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:timeInterval(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,i)=>{t.setUTCFullYear(t.getUTCFullYear()+i*e)});const utcYears=utcYear.range;function ticker(e,t,i,r,o,a){const c=[[second,1,durationSecond],[second,5,5*durationSecond],[second,15,15*durationSecond],[second,30,30*durationSecond],[a,1,durationMinute],[a,5,5*durationMinute],[a,15,15*durationMinute],[a,30,30*durationMinute],[o,1,durationHour],[o,3,3*durationHour],[o,6,6*durationHour],[o,12,12*durationHour],[r,1,durationDay],[r,2,2*durationDay],[i,1,durationWeek],[t,1,durationMonth],[t,3,3*durationMonth],[e,1,durationYear]];function u(d,f,m){const g=f<d;g&&([d,f]=[f,d]);const v=m&&typeof m.range=="function"?m:h(d,f,m),_=v?v.range(d,+f+1):[];return g?_.reverse():_}function h(d,f,m){const g=Math.abs(f-d)/m,v=bisector(([,,S])=>S).right(c,g);if(v===c.length)return e.every(tickStep(d/durationYear,f/durationYear,m));if(v===0)return millisecond.every(Math.max(tickStep(d,f,m),1));const[_,b]=c[g/c[v-1][2]<c[v][2]/g?v-1:v];return _.every(b)}return[u,h]}const[utcTicks,utcTickInterval]=ticker(utcYear,utcMonth,utcSunday,unixDay,utcHour,utcMinute),[timeTicks,timeTickInterval]=ticker(timeYear,timeMonth,timeSunday,timeDay,timeHour,timeMinute);function localDate(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function utcDate(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function newDate(e,t,i){return{y:e,m:t,d:i,H:0,M:0,S:0,L:0}}function formatLocale(e){var t=e.dateTime,i=e.date,r=e.time,o=e.periods,a=e.days,c=e.shortDays,u=e.months,h=e.shortMonths,d=formatRe(o),f=formatLookup(o),m=formatRe(a),g=formatLookup(a),v=formatRe(c),_=formatLookup(c),b=formatRe(u),S=formatLookup(u),T=formatRe(h),A=formatLookup(h),I={a:me,A:Se,b:Le,B:xe,c:null,d:formatDayOfMonth,e:formatDayOfMonth,f:formatMicroseconds,g:formatYearISO,G:formatFullYearISO,H:formatHour24,I:formatHour12,j:formatDayOfYear,L:formatMilliseconds,m:formatMonthNumber,M:formatMinutes,p:E,q:k,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatSeconds,u:formatWeekdayNumberMonday,U:formatWeekNumberSunday,V:formatWeekNumberISO,w:formatWeekdayNumberSunday,W:formatWeekNumberMonday,x:null,X:null,y:formatYear,Y:formatFullYear,Z:formatZone,"%":formatLiteralPercent},R={a:D,A:q,b:B,B:se,c:null,d:formatUTCDayOfMonth,e:formatUTCDayOfMonth,f:formatUTCMicroseconds,g:formatUTCYearISO,G:formatUTCFullYearISO,H:formatUTCHour24,I:formatUTCHour12,j:formatUTCDayOfYear,L:formatUTCMilliseconds,m:formatUTCMonthNumber,M:formatUTCMinutes,p:ye,q:we,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatUTCSeconds,u:formatUTCWeekdayNumberMonday,U:formatUTCWeekNumberSunday,V:formatUTCWeekNumberISO,w:formatUTCWeekdayNumberSunday,W:formatUTCWeekNumberMonday,x:null,X:null,y:formatUTCYear,Y:formatUTCFullYear,Z:formatUTCZone,"%":formatLiteralPercent},O={a:$,A:Z,b:ie,B:ue,c:_e,d:parseDayOfMonth,e:parseDayOfMonth,f:parseMicroseconds,g:parseYear,G:parseFullYear,H:parseHour24,I:parseHour24,j:parseDayOfYear,L:parseMilliseconds,m:parseMonthNumber,M:parseMinutes,p:U,q:parseQuarter,Q:parseUnixTimestamp,s:parseUnixTimestampSeconds,S:parseSeconds,u:parseWeekdayNumberMonday,U:parseWeekNumberSunday,V:parseWeekNumberISO,w:parseWeekdayNumberSunday,W:parseWeekNumberMonday,x:Ee,X:pe,y:parseYear,Y:parseFullYear,Z:parseZone,"%":parseLiteralPercent};I.x=P(i,I),I.X=P(r,I),I.c=P(t,I),R.x=P(i,R),R.X=P(r,R),R.c=P(t,R);function P(de,be){return function(fe){var he=[],Ne=-1,le=0,Ve=de.length,Be,je,We;for(fe instanceof Date||(fe=new Date(+fe));++Ne<Ve;)de.charCodeAt(Ne)===37&&(he.push(de.slice(le,Ne)),(je=pads[Be=de.charAt(++Ne)])!=null?Be=de.charAt(++Ne):je=Be==="e"?" ":"0",(We=be[Be])&&(Be=We(fe,je)),he.push(Be),le=Ne+1);return he.push(de.slice(le,Ne)),he.join("")}}function L(de,be){return function(fe){var he=newDate(1900,void 0,1),Ne=V(he,de,fe+="",0),le,Ve;if(Ne!=fe.length)return null;if("Q"in he)return new Date(he.Q);if("s"in he)return new Date(he.s*1e3+("L"in he?he.L:0));if(be&&!("Z"in he)&&(he.Z=0),"p"in he&&(he.H=he.H%12+he.p*12),he.m===void 0&&(he.m="q"in he?he.q:0),"V"in he){if(he.V<1||he.V>53)return null;"w"in he||(he.w=1),"Z"in he?(le=utcDate(newDate(he.y,0,1)),Ve=le.getUTCDay(),le=Ve>4||Ve===0?utcMonday.ceil(le):utcMonday(le),le=utcDay.offset(le,(he.V-1)*7),he.y=le.getUTCFullYear(),he.m=le.getUTCMonth(),he.d=le.getUTCDate()+(he.w+6)%7):(le=localDate(newDate(he.y,0,1)),Ve=le.getDay(),le=Ve>4||Ve===0?timeMonday.ceil(le):timeMonday(le),le=timeDay.offset(le,(he.V-1)*7),he.y=le.getFullYear(),he.m=le.getMonth(),he.d=le.getDate()+(he.w+6)%7)}else("W"in he||"U"in he)&&("w"in he||(he.w="u"in he?he.u%7:"W"in he?1:0),Ve="Z"in he?utcDate(newDate(he.y,0,1)).getUTCDay():localDate(newDate(he.y,0,1)).getDay(),he.m=0,he.d="W"in he?(he.w+6)%7+he.W*7-(Ve+5)%7:he.w+he.U*7-(Ve+6)%7);return"Z"in he?(he.H+=he.Z/100|0,he.M+=he.Z%100,utcDate(he)):localDate(he)}}function V(de,be,fe,he){for(var Ne=0,le=be.length,Ve=fe.length,Be,je;Ne<le;){if(he>=Ve)return-1;if(Be=be.charCodeAt(Ne++),Be===37){if(Be=be.charAt(Ne++),je=O[Be in pads?be.charAt(Ne++):Be],!je||(he=je(de,fe,he))<0)return-1}else if(Be!=fe.charCodeAt(he++))return-1}return he}function U(de,be,fe){var he=d.exec(be.slice(fe));return he?(de.p=f.get(he[0].toLowerCase()),fe+he[0].length):-1}function $(de,be,fe){var he=v.exec(be.slice(fe));return he?(de.w=_.get(he[0].toLowerCase()),fe+he[0].length):-1}function Z(de,be,fe){var he=m.exec(be.slice(fe));return he?(de.w=g.get(he[0].toLowerCase()),fe+he[0].length):-1}function ie(de,be,fe){var he=T.exec(be.slice(fe));return he?(de.m=A.get(he[0].toLowerCase()),fe+he[0].length):-1}function ue(de,be,fe){var he=b.exec(be.slice(fe));return he?(de.m=S.get(he[0].toLowerCase()),fe+he[0].length):-1}function _e(de,be,fe){return V(de,t,be,fe)}function Ee(de,be,fe){return V(de,i,be,fe)}function pe(de,be,fe){return V(de,r,be,fe)}function me(de){return c[de.getDay()]}function Se(de){return a[de.getDay()]}function Le(de){return h[de.getMonth()]}function xe(de){return u[de.getMonth()]}function E(de){return o[+(de.getHours()>=12)]}function k(de){return 1+~~(de.getMonth()/3)}function D(de){return c[de.getUTCDay()]}function q(de){return a[de.getUTCDay()]}function B(de){return h[de.getUTCMonth()]}function se(de){return u[de.getUTCMonth()]}function ye(de){return o[+(de.getUTCHours()>=12)]}function we(de){return 1+~~(de.getUTCMonth()/3)}return{format:function(de){var be=P(de+="",I);return be.toString=function(){return de},be},parse:function(de){var be=L(de+="",!1);return be.toString=function(){return de},be},utcFormat:function(de){var be=P(de+="",R);return be.toString=function(){return de},be},utcParse:function(de){var be=L(de+="",!0);return be.toString=function(){return de},be}}}var pads={"-":"",_:" ",0:"0"},numberRe=/^\s*\d+/,percentRe=/^%/,requoteRe=/[\\^$*+?|[\]().{}]/g;function pad(e,t,i){var r=e<0?"-":"",o=(r?-e:e)+"",a=o.length;return r+(a<i?new Array(i-a+1).join(t)+o:o)}function requote(e){return e.replace(requoteRe,"\\$&")}function formatRe(e){return new RegExp("^(?:"+e.map(requote).join("|")+")","i")}function formatLookup(e){return new Map(e.map((t,i)=>[t.toLowerCase(),i]))}function parseWeekdayNumberSunday(e,t,i){var r=numberRe.exec(t.slice(i,i+1));return r?(e.w=+r[0],i+r[0].length):-1}function parseWeekdayNumberMonday(e,t,i){var r=numberRe.exec(t.slice(i,i+1));return r?(e.u=+r[0],i+r[0].length):-1}function parseWeekNumberSunday(e,t,i){var r=numberRe.exec(t.slice(i,i+2));return r?(e.U=+r[0],i+r[0].length):-1}function parseWeekNumberISO(e,t,i){var r=numberRe.exec(t.slice(i,i+2));return r?(e.V=+r[0],i+r[0].length):-1}function parseWeekNumberMonday(e,t,i){var r=numberRe.exec(t.slice(i,i+2));return r?(e.W=+r[0],i+r[0].length):-1}function parseFullYear(e,t,i){var r=numberRe.exec(t.slice(i,i+4));return r?(e.y=+r[0],i+r[0].length):-1}function parseYear(e,t,i){var r=numberRe.exec(t.slice(i,i+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),i+r[0].length):-1}function parseZone(e,t,i){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(i,i+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),i+r[0].length):-1}function parseQuarter(e,t,i){var r=numberRe.exec(t.slice(i,i+1));return r?(e.q=r[0]*3-3,i+r[0].length):-1}function parseMonthNumber(e,t,i){var r=numberRe.exec(t.slice(i,i+2));return r?(e.m=r[0]-1,i+r[0].length):-1}function parseDayOfMonth(e,t,i){var r=numberRe.exec(t.slice(i,i+2));return r?(e.d=+r[0],i+r[0].length):-1}function parseDayOfYear(e,t,i){var r=numberRe.exec(t.slice(i,i+3));return r?(e.m=0,e.d=+r[0],i+r[0].length):-1}function parseHour24(e,t,i){var r=numberRe.exec(t.slice(i,i+2));return r?(e.H=+r[0],i+r[0].length):-1}function parseMinutes(e,t,i){var r=numberRe.exec(t.slice(i,i+2));return r?(e.M=+r[0],i+r[0].length):-1}function parseSeconds(e,t,i){var r=numberRe.exec(t.slice(i,i+2));return r?(e.S=+r[0],i+r[0].length):-1}function parseMilliseconds(e,t,i){var r=numberRe.exec(t.slice(i,i+3));return r?(e.L=+r[0],i+r[0].length):-1}function parseMicroseconds(e,t,i){var r=numberRe.exec(t.slice(i,i+6));return r?(e.L=Math.floor(r[0]/1e3),i+r[0].length):-1}function parseLiteralPercent(e,t,i){var r=percentRe.exec(t.slice(i,i+1));return r?i+r[0].length:-1}function parseUnixTimestamp(e,t,i){var r=numberRe.exec(t.slice(i));return r?(e.Q=+r[0],i+r[0].length):-1}function parseUnixTimestampSeconds(e,t,i){var r=numberRe.exec(t.slice(i));return r?(e.s=+r[0],i+r[0].length):-1}function formatDayOfMonth(e,t){return pad(e.getDate(),t,2)}function formatHour24(e,t){return pad(e.getHours(),t,2)}function formatHour12(e,t){return pad(e.getHours()%12||12,t,2)}function formatDayOfYear(e,t){return pad(1+timeDay.count(timeYear(e),e),t,3)}function formatMilliseconds(e,t){return pad(e.getMilliseconds(),t,3)}function formatMicroseconds(e,t){return formatMilliseconds(e,t)+"000"}function formatMonthNumber(e,t){return pad(e.getMonth()+1,t,2)}function formatMinutes(e,t){return pad(e.getMinutes(),t,2)}function formatSeconds(e,t){return pad(e.getSeconds(),t,2)}function formatWeekdayNumberMonday(e){var t=e.getDay();return t===0?7:t}function formatWeekNumberSunday(e,t){return pad(timeSunday.count(timeYear(e)-1,e),t,2)}function dISO(e){var t=e.getDay();return t>=4||t===0?timeThursday(e):timeThursday.ceil(e)}function formatWeekNumberISO(e,t){return e=dISO(e),pad(timeThursday.count(timeYear(e),e)+(timeYear(e).getDay()===4),t,2)}function formatWeekdayNumberSunday(e){return e.getDay()}function formatWeekNumberMonday(e,t){return pad(timeMonday.count(timeYear(e)-1,e),t,2)}function formatYear(e,t){return pad(e.getFullYear()%100,t,2)}function formatYearISO(e,t){return e=dISO(e),pad(e.getFullYear()%100,t,2)}function formatFullYear(e,t){return pad(e.getFullYear()%1e4,t,4)}function formatFullYearISO(e,t){var i=e.getDay();return e=i>=4||i===0?timeThursday(e):timeThursday.ceil(e),pad(e.getFullYear()%1e4,t,4)}function formatZone(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+pad(t/60|0,"0",2)+pad(t%60,"0",2)}function formatUTCDayOfMonth(e,t){return pad(e.getUTCDate(),t,2)}function formatUTCHour24(e,t){return pad(e.getUTCHours(),t,2)}function formatUTCHour12(e,t){return pad(e.getUTCHours()%12||12,t,2)}function formatUTCDayOfYear(e,t){return pad(1+utcDay.count(utcYear(e),e),t,3)}function formatUTCMilliseconds(e,t){return pad(e.getUTCMilliseconds(),t,3)}function formatUTCMicroseconds(e,t){return formatUTCMilliseconds(e,t)+"000"}function formatUTCMonthNumber(e,t){return pad(e.getUTCMonth()+1,t,2)}function formatUTCMinutes(e,t){return pad(e.getUTCMinutes(),t,2)}function formatUTCSeconds(e,t){return pad(e.getUTCSeconds(),t,2)}function formatUTCWeekdayNumberMonday(e){var t=e.getUTCDay();return t===0?7:t}function formatUTCWeekNumberSunday(e,t){return pad(utcSunday.count(utcYear(e)-1,e),t,2)}function UTCdISO(e){var t=e.getUTCDay();return t>=4||t===0?utcThursday(e):utcThursday.ceil(e)}function formatUTCWeekNumberISO(e,t){return e=UTCdISO(e),pad(utcThursday.count(utcYear(e),e)+(utcYear(e).getUTCDay()===4),t,2)}function formatUTCWeekdayNumberSunday(e){return e.getUTCDay()}function formatUTCWeekNumberMonday(e,t){return pad(utcMonday.count(utcYear(e)-1,e),t,2)}function formatUTCYear(e,t){return pad(e.getUTCFullYear()%100,t,2)}function formatUTCYearISO(e,t){return e=UTCdISO(e),pad(e.getUTCFullYear()%100,t,2)}function formatUTCFullYear(e,t){return pad(e.getUTCFullYear()%1e4,t,4)}function formatUTCFullYearISO(e,t){var i=e.getUTCDay();return e=i>=4||i===0?utcThursday(e):utcThursday.ceil(e),pad(e.getUTCFullYear()%1e4,t,4)}function formatUTCZone(){return"+0000"}function formatLiteralPercent(){return"%"}function formatUnixTimestamp(e){return+e}function formatUnixTimestampSeconds(e){return Math.floor(+e/1e3)}var locale,timeFormat,timeParse,utcFormat,utcParse;defaultLocale$1({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function defaultLocale$1(e){return locale=formatLocale(e),timeFormat=locale.format,timeParse=locale.parse,utcFormat=locale.utcFormat,utcParse=locale.utcParse,locale}function date(e){return new Date(e)}function number(e){return e instanceof Date?+e:+new Date(+e)}function calendar(e,t,i,r,o,a,c,u,h,d){var f=continuous(),m=f.invert,g=f.domain,v=d(".%L"),_=d(":%S"),b=d("%I:%M"),S=d("%I %p"),T=d("%a %d"),A=d("%b %d"),I=d("%B"),R=d("%Y");function O(P){return(h(P)<P?v:u(P)<P?_:c(P)<P?b:a(P)<P?S:r(P)<P?o(P)<P?T:A:i(P)<P?I:R)(P)}return f.invert=function(P){return new Date(m(P))},f.domain=function(P){return arguments.length?g(Array.from(P,number)):g().map(date)},f.ticks=function(P){var L=g();return e(L[0],L[L.length-1],P??10)},f.tickFormat=function(P,L){return L==null?O:d(L)},f.nice=function(P){var L=g();return(!P||typeof P.range!="function")&&(P=t(L[0],L[L.length-1],P??10)),P?g(nice(L,P)):f},f.copy=function(){return copy(f,calendar(e,t,i,r,o,a,c,u,h,d))},f}function utcTime(){return initRange.apply(calendar(utcTicks,utcTickInterval,utcYear,utcMonth,utcSunday,utcDay,utcHour,utcMinute,second,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Transform(e,t,i){this.k=e,this.x=t,this.y=i}Transform.prototype={constructor:Transform,scale:function(e){return e===1?this:new Transform(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Transform(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var identity$1=new Transform(1,0,0);transform$3.prototype=Transform.prototype;function transform$3(e){for(;!e.__zoom;)if(!(e=e.parentNode))return identity$1;return e.__zoom}var require_global_this=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/global-this.js"(e,t){var i=function(r){return r&&r.Math===Math&&r};t.exports=i(typeof globalThis=="object"&&globalThis)||i(typeof window=="object"&&window)||i(typeof self=="object"&&self)||i(typeof global=="object"&&global)||i(typeof e=="object"&&e)||function(){return this}()||Function("return this")()}}),require_fails=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/fails.js"(e,t){t.exports=function(i){try{return!!i()}catch{return!0}}}}),require_descriptors=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/descriptors.js"(e,t){var i=require_fails();t.exports=!i(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})}}),require_function_bind_native=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/function-bind-native.js"(e,t){var i=require_fails();t.exports=!i(function(){var r=function(){}.bind();return typeof r!="function"||r.hasOwnProperty("prototype")})}}),require_function_call=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/function-call.js"(e,t){var i=require_function_bind_native(),r=Function.prototype.call;t.exports=i?r.bind(r):function(){return r.apply(r,arguments)}}}),require_object_property_is_enumerable=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-property-is-enumerable.js"(e){var t={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,r=i&&!t.call({1:2},1);e.f=r?function(a){var c=i(this,a);return!!c&&c.enumerable}:t}}),require_create_property_descriptor=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/create-property-descriptor.js"(e,t){t.exports=function(i,r){return{enumerable:!(i&1),configurable:!(i&2),writable:!(i&4),value:r}}}}),require_function_uncurry_this=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/function-uncurry-this.js"(e,t){var i=require_function_bind_native(),r=Function.prototype,o=r.call,a=i&&r.bind.bind(o,o);t.exports=i?a:function(c){return function(){return o.apply(c,arguments)}}}}),require_classof_raw=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/classof-raw.js"(e,t){var i=require_function_uncurry_this(),r=i({}.toString),o=i("".slice);t.exports=function(a){return o(r(a),8,-1)}}}),require_indexed_object=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/indexed-object.js"(e,t){var i=require_function_uncurry_this(),r=require_fails(),o=require_classof_raw(),a=Object,c=i("".split);t.exports=r(function(){return!a("z").propertyIsEnumerable(0)})?function(u){return o(u)==="String"?c(u,""):a(u)}:a}}),require_is_null_or_undefined=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/is-null-or-undefined.js"(e,t){t.exports=function(i){return i==null}}}),require_require_object_coercible=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/require-object-coercible.js"(e,t){var i=require_is_null_or_undefined(),r=TypeError;t.exports=function(o){if(i(o))throw new r("Can't call method on "+o);return o}}}),require_to_indexed_object=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/to-indexed-object.js"(e,t){var i=require_indexed_object(),r=require_require_object_coercible();t.exports=function(o){return i(r(o))}}}),require_is_callable=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/is-callable.js"(e,t){var i=typeof document=="object"&&document.all;t.exports=typeof i>"u"&&i!==void 0?function(r){return typeof r=="function"||r===i}:function(r){return typeof r=="function"}}}),require_is_object=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/is-object.js"(e,t){var i=require_is_callable();t.exports=function(r){return typeof r=="object"?r!==null:i(r)}}}),require_get_built_in=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/get-built-in.js"(e,t){var i=require_global_this(),r=require_is_callable(),o=function(a){return r(a)?a:void 0};t.exports=function(a,c){return arguments.length<2?o(i[a]):i[a]&&i[a][c]}}}),require_object_is_prototype_of=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-is-prototype-of.js"(e,t){var i=require_function_uncurry_this();t.exports=i({}.isPrototypeOf)}}),require_environment_user_agent=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/environment-user-agent.js"(e,t){var i=require_global_this(),r=i.navigator,o=r&&r.userAgent;t.exports=o?String(o):""}}),require_environment_v8_version=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/environment-v8-version.js"(e,t){var i=require_global_this(),r=require_environment_user_agent(),o=i.process,a=i.Deno,c=o&&o.versions||a&&a.version,u=c&&c.v8,h,d;u&&(h=u.split("."),d=h[0]>0&&h[0]<4?1:+(h[0]+h[1])),!d&&r&&(h=r.match(/Edge\/(\d+)/),(!h||h[1]>=74)&&(h=r.match(/Chrome\/(\d+)/),h&&(d=+h[1]))),t.exports=d}}),require_symbol_constructor_detection=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/symbol-constructor-detection.js"(e,t){var i=require_environment_v8_version(),r=require_fails(),o=require_global_this(),a=o.String;t.exports=!!Object.getOwnPropertySymbols&&!r(function(){var c=Symbol("symbol detection");return!a(c)||!(Object(c)instanceof Symbol)||!Symbol.sham&&i&&i<41})}}),require_use_symbol_as_uid=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/use-symbol-as-uid.js"(e,t){var i=require_symbol_constructor_detection();t.exports=i&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}}),require_is_symbol=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/is-symbol.js"(e,t){var i=require_get_built_in(),r=require_is_callable(),o=require_object_is_prototype_of(),a=require_use_symbol_as_uid(),c=Object;t.exports=a?function(u){return typeof u=="symbol"}:function(u){var h=i("Symbol");return r(h)&&o(h.prototype,c(u))}}}),require_try_to_string=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/try-to-string.js"(e,t){var i=String;t.exports=function(r){try{return i(r)}catch{return"Object"}}}}),require_a_callable=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/a-callable.js"(e,t){var i=require_is_callable(),r=require_try_to_string(),o=TypeError;t.exports=function(a){if(i(a))return a;throw new o(r(a)+" is not a function")}}}),require_get_method=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/get-method.js"(e,t){var i=require_a_callable(),r=require_is_null_or_undefined();t.exports=function(o,a){var c=o[a];return r(c)?void 0:i(c)}}}),require_ordinary_to_primitive=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/ordinary-to-primitive.js"(e,t){var i=require_function_call(),r=require_is_callable(),o=require_is_object(),a=TypeError;t.exports=function(c,u){var h,d;if(u==="string"&&r(h=c.toString)&&!o(d=i(h,c))||r(h=c.valueOf)&&!o(d=i(h,c))||u!=="string"&&r(h=c.toString)&&!o(d=i(h,c)))return d;throw new a("Can't convert object to primitive value")}}}),require_is_pure=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/is-pure.js"(e,t){t.exports=!1}}),require_define_global_property=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/define-global-property.js"(e,t){var i=require_global_this(),r=Object.defineProperty;t.exports=function(o,a){try{r(i,o,{value:a,configurable:!0,writable:!0})}catch{i[o]=a}return a}}}),require_shared_store=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/shared-store.js"(e,t){var i=require_is_pure(),r=require_global_this(),o=require_define_global_property(),a="__core-js_shared__",c=t.exports=r[a]||o(a,{});(c.versions||(c.versions=[])).push({version:"3.39.0",mode:i?"pure":"global",copyright:"\xA9 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"})}}),require_shared=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/shared.js"(e,t){var i=require_shared_store();t.exports=function(r,o){return i[r]||(i[r]=o||{})}}}),require_to_object=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/to-object.js"(e,t){var i=require_require_object_coercible(),r=Object;t.exports=function(o){return r(i(o))}}}),require_has_own_property=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/has-own-property.js"(e,t){var i=require_function_uncurry_this(),r=require_to_object(),o=i({}.hasOwnProperty);t.exports=Object.hasOwn||function(c,u){return o(r(c),u)}}}),require_uid=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/uid.js"(e,t){var i=require_function_uncurry_this(),r=0,o=Math.random(),a=i(1 .toString);t.exports=function(c){return"Symbol("+(c===void 0?"":c)+")_"+a(++r+o,36)}}}),require_well_known_symbol=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/well-known-symbol.js"(e,t){var i=require_global_this(),r=require_shared(),o=require_has_own_property(),a=require_uid(),c=require_symbol_constructor_detection(),u=require_use_symbol_as_uid(),h=i.Symbol,d=r("wks"),f=u?h.for||h:h&&h.withoutSetter||a;t.exports=function(m){return o(d,m)||(d[m]=c&&o(h,m)?h[m]:f("Symbol."+m)),d[m]}}}),require_to_primitive=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/to-primitive.js"(e,t){var i=require_function_call(),r=require_is_object(),o=require_is_symbol(),a=require_get_method(),c=require_ordinary_to_primitive(),u=require_well_known_symbol(),h=TypeError,d=u("toPrimitive");t.exports=function(f,m){if(!r(f)||o(f))return f;var g=a(f,d),v;if(g){if(m===void 0&&(m="default"),v=i(g,f,m),!r(v)||o(v))return v;throw new h("Can't convert object to primitive value")}return m===void 0&&(m="number"),c(f,m)}}}),require_to_property_key=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/to-property-key.js"(e,t){var i=require_to_primitive(),r=require_is_symbol();t.exports=function(o){var a=i(o,"string");return r(a)?a:a+""}}}),require_document_create_element=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/document-create-element.js"(e,t){var i=require_global_this(),r=require_is_object(),o=i.document,a=r(o)&&r(o.createElement);t.exports=function(c){return a?o.createElement(c):{}}}}),require_ie8_dom_define=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/ie8-dom-define.js"(e,t){var i=require_descriptors(),r=require_fails(),o=require_document_create_element();t.exports=!i&&!r(function(){return Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a!==7})}}),require_object_get_own_property_descriptor=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-get-own-property-descriptor.js"(e){var t=require_descriptors(),i=require_function_call(),r=require_object_property_is_enumerable(),o=require_create_property_descriptor(),a=require_to_indexed_object(),c=require_to_property_key(),u=require_has_own_property(),h=require_ie8_dom_define(),d=Object.getOwnPropertyDescriptor;e.f=t?d:function(m,g){if(m=a(m),g=c(g),h)try{return d(m,g)}catch{}if(u(m,g))return o(!i(r.f,m,g),m[g])}}}),require_v8_prototype_define_bug=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/v8-prototype-define-bug.js"(e,t){var i=require_descriptors(),r=require_fails();t.exports=i&&r(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})}}),require_an_object=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/an-object.js"(e,t){var i=require_is_object(),r=String,o=TypeError;t.exports=function(a){if(i(a))return a;throw new o(r(a)+" is not an object")}}}),require_object_define_property=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-define-property.js"(e){var t=require_descriptors(),i=require_ie8_dom_define(),r=require_v8_prototype_define_bug(),o=require_an_object(),a=require_to_property_key(),c=TypeError,u=Object.defineProperty,h=Object.getOwnPropertyDescriptor,d="enumerable",f="configurable",m="writable";e.f=t?r?function(v,_,b){if(o(v),_=a(_),o(b),typeof v=="function"&&_==="prototype"&&"value"in b&&m in b&&!b[m]){var S=h(v,_);S&&S[m]&&(v[_]=b.value,b={configurable:f in b?b[f]:S[f],enumerable:d in b?b[d]:S[d],writable:!1})}return u(v,_,b)}:u:function(v,_,b){if(o(v),_=a(_),o(b),i)try{return u(v,_,b)}catch{}if("get"in b||"set"in b)throw new c("Accessors not supported");return"value"in b&&(v[_]=b.value),v}}}),require_create_non_enumerable_property=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/create-non-enumerable-property.js"(e,t){var i=require_descriptors(),r=require_object_define_property(),o=require_create_property_descriptor();t.exports=i?function(a,c,u){return r.f(a,c,o(1,u))}:function(a,c,u){return a[c]=u,a}}}),require_function_name=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/function-name.js"(e,t){var i=require_descriptors(),r=require_has_own_property(),o=Function.prototype,a=i&&Object.getOwnPropertyDescriptor,c=r(o,"name"),u=c&&function(){}.name==="something",h=c&&(!i||i&&a(o,"name").configurable);t.exports={EXISTS:c,PROPER:u,CONFIGURABLE:h}}}),require_inspect_source=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/inspect-source.js"(e,t){var i=require_function_uncurry_this(),r=require_is_callable(),o=require_shared_store(),a=i(Function.toString);r(o.inspectSource)||(o.inspectSource=function(c){return a(c)}),t.exports=o.inspectSource}}),require_weak_map_basic_detection=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/weak-map-basic-detection.js"(e,t){var i=require_global_this(),r=require_is_callable(),o=i.WeakMap;t.exports=r(o)&&/native code/.test(String(o))}}),require_shared_key=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/shared-key.js"(e,t){var i=require_shared(),r=require_uid(),o=i("keys");t.exports=function(a){return o[a]||(o[a]=r(a))}}}),require_hidden_keys=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/hidden-keys.js"(e,t){t.exports={}}}),require_internal_state=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/internal-state.js"(e,t){var i=require_weak_map_basic_detection(),r=require_global_this(),o=require_is_object(),a=require_create_non_enumerable_property(),c=require_has_own_property(),u=require_shared_store(),h=require_shared_key(),d=require_hidden_keys(),f="Object already initialized",m=r.TypeError,g=r.WeakMap,v,_,b,S=function(R){return b(R)?_(R):v(R,{})},T=function(R){return function(O){var P;if(!o(O)||(P=_(O)).type!==R)throw new m("Incompatible receiver, "+R+" required");return P}};if(i||u.state){var A=u.state||(u.state=new g);A.get=A.get,A.has=A.has,A.set=A.set,v=function(R,O){if(A.has(R))throw new m(f);return O.facade=R,A.set(R,O),O},_=function(R){return A.get(R)||{}},b=function(R){return A.has(R)}}else{var I=h("state");d[I]=!0,v=function(R,O){if(c(R,I))throw new m(f);return O.facade=R,a(R,I,O),O},_=function(R){return c(R,I)?R[I]:{}},b=function(R){return c(R,I)}}t.exports={set:v,get:_,has:b,enforce:S,getterFor:T}}}),require_make_built_in=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/make-built-in.js"(e,t){var i=require_function_uncurry_this(),r=require_fails(),o=require_is_callable(),a=require_has_own_property(),c=require_descriptors(),u=require_function_name().CONFIGURABLE,h=require_inspect_source(),d=require_internal_state(),f=d.enforce,m=d.get,g=String,v=Object.defineProperty,_=i("".slice),b=i("".replace),S=i([].join),T=c&&!r(function(){return v(function(){},"length",{value:8}).length!==8}),A=String(String).split("String"),I=t.exports=function(R,O,P){_(g(O),0,7)==="Symbol("&&(O="["+b(g(O),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),P&&P.getter&&(O="get "+O),P&&P.setter&&(O="set "+O),(!a(R,"name")||u&&R.name!==O)&&(c?v(R,"name",{value:O,configurable:!0}):R.name=O),T&&P&&a(P,"arity")&&R.length!==P.arity&&v(R,"length",{value:P.arity});try{P&&a(P,"constructor")&&P.constructor?c&&v(R,"prototype",{writable:!1}):R.prototype&&(R.prototype=void 0)}catch{}var L=f(R);return a(L,"source")||(L.source=S(A,typeof O=="string"?O:"")),R};Function.prototype.toString=I(function(){return o(this)&&m(this).source||h(this)},"toString")}}),require_define_built_in=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/define-built-in.js"(e,t){var i=require_is_callable(),r=require_object_define_property(),o=require_make_built_in(),a=require_define_global_property();t.exports=function(c,u,h,d){d||(d={});var f=d.enumerable,m=d.name!==void 0?d.name:u;if(i(h)&&o(h,m,d),d.global)f?c[u]=h:a(u,h);else{try{d.unsafe?c[u]&&(f=!0):delete c[u]}catch{}f?c[u]=h:r.f(c,u,{value:h,enumerable:!1,configurable:!d.nonConfigurable,writable:!d.nonWritable})}return c}}}),require_math_trunc=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/math-trunc.js"(e,t){var i=Math.ceil,r=Math.floor;t.exports=Math.trunc||function(a){var c=+a;return(c>0?r:i)(c)}}}),require_to_integer_or_infinity=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/to-integer-or-infinity.js"(e,t){var i=require_math_trunc();t.exports=function(r){var o=+r;return o!==o||o===0?0:i(o)}}}),require_to_absolute_index=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/to-absolute-index.js"(e,t){var i=require_to_integer_or_infinity(),r=Math.max,o=Math.min;t.exports=function(a,c){var u=i(a);return u<0?r(u+c,0):o(u,c)}}}),require_to_length=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/to-length.js"(e,t){var i=require_to_integer_or_infinity(),r=Math.min;t.exports=function(o){var a=i(o);return a>0?r(a,9007199254740991):0}}}),require_length_of_array_like=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/length-of-array-like.js"(e,t){var i=require_to_length();t.exports=function(r){return i(r.length)}}}),require_array_includes=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/array-includes.js"(e,t){var i=require_to_indexed_object(),r=require_to_absolute_index(),o=require_length_of_array_like(),a=function(c){return function(u,h,d){var f=i(u),m=o(f);if(m===0)return!c&&-1;var g=r(d,m),v;if(c&&h!==h){for(;m>g;)if(v=f[g++],v!==v)return!0}else for(;m>g;g++)if((c||g in f)&&f[g]===h)return c||g||0;return!c&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}}}),require_object_keys_internal=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-keys-internal.js"(e,t){var i=require_function_uncurry_this(),r=require_has_own_property(),o=require_to_indexed_object(),a=require_array_includes().indexOf,c=require_hidden_keys(),u=i([].push);t.exports=function(h,d){var f=o(h),m=0,g=[],v;for(v in f)!r(c,v)&&r(f,v)&&u(g,v);for(;d.length>m;)r(f,v=d[m++])&&(~a(g,v)||u(g,v));return g}}}),require_enum_bug_keys=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/enum-bug-keys.js"(e,t){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]}}),require_object_get_own_property_names=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-get-own-property-names.js"(e){var t=require_object_keys_internal(),i=require_enum_bug_keys(),r=i.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(a){return t(a,r)}}}),require_object_get_own_property_symbols=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-get-own-property-symbols.js"(e){e.f=Object.getOwnPropertySymbols}}),require_own_keys=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/own-keys.js"(e,t){var i=require_get_built_in(),r=require_function_uncurry_this(),o=require_object_get_own_property_names(),a=require_object_get_own_property_symbols(),c=require_an_object(),u=r([].concat);t.exports=i("Reflect","ownKeys")||function(d){var f=o.f(c(d)),m=a.f;return m?u(f,m(d)):f}}}),require_copy_constructor_properties=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/copy-constructor-properties.js"(e,t){var i=require_has_own_property(),r=require_own_keys(),o=require_object_get_own_property_descriptor(),a=require_object_define_property();t.exports=function(c,u,h){for(var d=r(u),f=a.f,m=o.f,g=0;g<d.length;g++){var v=d[g];!i(c,v)&&!(h&&i(h,v))&&f(c,v,m(u,v))}}}}),require_is_forced=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/is-forced.js"(e,t){var i=require_fails(),r=require_is_callable(),o=/#|\.prototype\./,a=function(f,m){var g=u[c(f)];return g===d?!0:g===h?!1:r(m)?i(m):!!m},c=a.normalize=function(f){return String(f).replace(o,".").toLowerCase()},u=a.data={},h=a.NATIVE="N",d=a.POLYFILL="P";t.exports=a}}),require_export=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/export.js"(e,t){var i=require_global_this(),r=require_object_get_own_property_descriptor().f,o=require_create_non_enumerable_property(),a=require_define_built_in(),c=require_define_global_property(),u=require_copy_constructor_properties(),h=require_is_forced();t.exports=function(d,f){var m=d.target,g=d.global,v=d.stat,_,b,S,T,A,I;if(g?b=i:v?b=i[m]||c(m,{}):b=i[m]&&i[m].prototype,b)for(S in f){if(A=f[S],d.dontCallGetSet?(I=r(b,S),T=I&&I.value):T=b[S],_=h(g?S:m+(v?".":"#")+S,d.forced),!_&&T!==void 0){if(typeof A==typeof T)continue;u(A,T)}(d.sham||T&&T.sham)&&o(A,"sham",!0),a(b,S,A,d)}}}}),require_function_apply=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/function-apply.js"(e,t){var i=require_function_bind_native(),r=Function.prototype,o=r.apply,a=r.call;t.exports=typeof Reflect=="object"&&Reflect.apply||(i?a.bind(o):function(){return a.apply(o,arguments)})}}),require_function_uncurry_this_accessor=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/function-uncurry-this-accessor.js"(e,t){var i=require_function_uncurry_this(),r=require_a_callable();t.exports=function(o,a,c){try{return i(r(Object.getOwnPropertyDescriptor(o,a)[c]))}catch{}}}}),require_is_possible_prototype=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/is-possible-prototype.js"(e,t){var i=require_is_object();t.exports=function(r){return i(r)||r===null}}}),require_a_possible_prototype=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/a-possible-prototype.js"(e,t){var i=require_is_possible_prototype(),r=String,o=TypeError;t.exports=function(a){if(i(a))return a;throw new o("Can't set "+r(a)+" as a prototype")}}}),require_object_set_prototype_of=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-set-prototype-of.js"(e,t){var i=require_function_uncurry_this_accessor(),r=require_is_object(),o=require_require_object_coercible(),a=require_a_possible_prototype();t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var c=!1,u={},h;try{h=i(Object.prototype,"__proto__","set"),h(u,[]),c=u instanceof Array}catch{}return function(f,m){return o(f),a(m),r(f)&&(c?h(f,m):f.__proto__=m),f}}():void 0)}}),require_proxy_accessor=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/proxy-accessor.js"(e,t){var i=require_object_define_property().f;t.exports=function(r,o,a){a in r||i(r,a,{configurable:!0,get:function(){return o[a]},set:function(c){o[a]=c}})}}}),require_inherit_if_required=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/inherit-if-required.js"(e,t){var i=require_is_callable(),r=require_is_object(),o=require_object_set_prototype_of();t.exports=function(a,c,u){var h,d;return o&&i(h=c.constructor)&&h!==u&&r(d=h.prototype)&&d!==u.prototype&&o(a,d),a}}}),require_to_string_tag_support=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/to-string-tag-support.js"(e,t){var i=require_well_known_symbol(),r=i("toStringTag"),o={};o[r]="z",t.exports=String(o)==="[object z]"}}),require_classof=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/classof.js"(e,t){var i=require_to_string_tag_support(),r=require_is_callable(),o=require_classof_raw(),a=require_well_known_symbol(),c=a("toStringTag"),u=Object,h=o(function(){return arguments}())==="Arguments",d=function(f,m){try{return f[m]}catch{}};t.exports=i?o:function(f){var m,g,v;return f===void 0?"Undefined":f===null?"Null":typeof(g=d(m=u(f),c))=="string"?g:h?o(m):(v=o(m))==="Object"&&r(m.callee)?"Arguments":v}}}),require_to_string=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/to-string.js"(e,t){var i=require_classof(),r=String;t.exports=function(o){if(i(o)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return r(o)}}}),require_normalize_string_argument=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/normalize-string-argument.js"(e,t){var i=require_to_string();t.exports=function(r,o){return r===void 0?arguments.length<2?"":o:i(r)}}}),require_install_error_cause=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/install-error-cause.js"(e,t){var i=require_is_object(),r=require_create_non_enumerable_property();t.exports=function(o,a){i(a)&&"cause"in a&&r(o,"cause",a.cause)}}}),require_error_stack_clear=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/error-stack-clear.js"(e,t){var i=require_function_uncurry_this(),r=Error,o=i("".replace),a=function(h){return String(new r(h).stack)}("zxcasd"),c=/\n\s*at [^:]*:[^\n]*/,u=c.test(a);t.exports=function(h,d){if(u&&typeof h=="string"&&!r.prepareStackTrace)for(;d--;)h=o(h,c,"");return h}}}),require_error_stack_installable=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/error-stack-installable.js"(e,t){var i=require_fails(),r=require_create_property_descriptor();t.exports=!i(function(){var o=new Error("a");return"stack"in o?(Object.defineProperty(o,"stack",r(1,7)),o.stack!==7):!0})}}),require_error_stack_install=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/error-stack-install.js"(e,t){var i=require_create_non_enumerable_property(),r=require_error_stack_clear(),o=require_error_stack_installable(),a=Error.captureStackTrace;t.exports=function(c,u,h,d){o&&(a?a(c,u):i(c,"stack",r(h,d)))}}}),require_wrap_error_constructor_with_cause=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/wrap-error-constructor-with-cause.js"(e,t){var i=require_get_built_in(),r=require_has_own_property(),o=require_create_non_enumerable_property(),a=require_object_is_prototype_of(),c=require_object_set_prototype_of(),u=require_copy_constructor_properties(),h=require_proxy_accessor(),d=require_inherit_if_required(),f=require_normalize_string_argument(),m=require_install_error_cause(),g=require_error_stack_install(),v=require_descriptors(),_=require_is_pure();t.exports=function(b,S,T,A){var I="stackTraceLimit",R=A?2:1,O=b.split("."),P=O[O.length-1],L=i.apply(null,O);if(L){var V=L.prototype;if(!_&&r(V,"cause")&&delete V.cause,!T)return L;var U=i("Error"),$=S(function(Z,ie){var ue=f(A?ie:Z,void 0),_e=A?new L(Z):new L;return ue!==void 0&&o(_e,"message",ue),g(_e,$,_e.stack,2),this&&a(V,this)&&d(_e,this,$),arguments.length>R&&m(_e,arguments[R]),_e});if($.prototype=V,P!=="Error"?c?c($,U):u($,U,{name:!0}):v&&I in L&&(h($,L,I),h($,L,"prepareStackTrace")),u($,L),!_)try{V.name!==P&&o(V,"name",P),V.constructor=$}catch{}return $}}}}),require_es_error_cause=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.error.cause.js"(){var e=require_export(),t=require_global_this(),i=require_function_apply(),r=require_wrap_error_constructor_with_cause(),o="WebAssembly",a=t[o],c=new Error("e",{cause:7}).cause!==7,u=function(d,f){var m={};m[d]=r(d,f,c),e({global:!0,constructor:!0,arity:1,forced:c},m)},h=function(d,f){if(a&&a[d]){var m={};m[d]=r(o+"."+d,f,c),e({target:o,stat:!0,constructor:!0,arity:1,forced:c},m)}};u("Error",function(d){return function(m){return i(d,this,arguments)}}),u("EvalError",function(d){return function(m){return i(d,this,arguments)}}),u("RangeError",function(d){return function(m){return i(d,this,arguments)}}),u("ReferenceError",function(d){return function(m){return i(d,this,arguments)}}),u("SyntaxError",function(d){return function(m){return i(d,this,arguments)}}),u("TypeError",function(d){return function(m){return i(d,this,arguments)}}),u("URIError",function(d){return function(m){return i(d,this,arguments)}}),h("CompileError",function(d){return function(m){return i(d,this,arguments)}}),h("LinkError",function(d){return function(m){return i(d,this,arguments)}}),h("RuntimeError",function(d){return function(m){return i(d,this,arguments)}})}}),require_is_array=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/is-array.js"(e,t){var i=require_classof_raw();t.exports=Array.isArray||function(o){return i(o)==="Array"}}}),require_array_set_length=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/array-set-length.js"(e,t){var i=require_descriptors(),r=require_is_array(),o=TypeError,a=Object.getOwnPropertyDescriptor,c=i&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(u){return u instanceof TypeError}}();t.exports=c?function(u,h){if(r(u)&&!a(u,"length").writable)throw new o("Cannot set read only .length");return u.length=h}:function(u,h){return u.length=h}}}),require_does_not_exceed_safe_integer=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/does-not-exceed-safe-integer.js"(e,t){var i=TypeError,r=9007199254740991;t.exports=function(o){if(o>r)throw i("Maximum allowed index exceeded");return o}}}),require_es_array_push=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.array.push.js"(){var e=require_export(),t=require_to_object(),i=require_length_of_array_like(),r=require_array_set_length(),o=require_does_not_exceed_safe_integer(),a=require_fails(),c=a(function(){return[].push.call({length:4294967296},1)!==4294967297}),u=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(d){return d instanceof TypeError}},h=c||!u();e({target:"Array",proto:!0,arity:1,forced:h},{push:function(f){var m=t(this),g=i(m),v=arguments.length;o(g+v);for(var _=0;_<v;_++)m[g]=arguments[_],g++;return r(m,g),g}})}}),require_set_helpers=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-helpers.js"(e,t){var i=require_function_uncurry_this(),r=Set.prototype;t.exports={Set,add:i(r.add),has:i(r.has),remove:i(r.delete),proto:r}}}),require_a_set=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/a-set.js"(e,t){var i=require_set_helpers().has;t.exports=function(r){return i(r),r}}}),require_iterate_simple=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/iterate-simple.js"(e,t){var i=require_function_call();t.exports=function(r,o,a){for(var c=a?r:r.iterator,u=r.next,h,d;!(h=i(u,c)).done;)if(d=o(h.value),d!==void 0)return d}}}),require_set_iterate=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-iterate.js"(e,t){var i=require_function_uncurry_this(),r=require_iterate_simple(),o=require_set_helpers(),a=o.Set,c=o.proto,u=i(c.forEach),h=i(c.keys),d=h(new a).next;t.exports=function(f,m,g){return g?r({iterator:h(f),next:d},m):u(f,m)}}}),require_set_clone=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-clone.js"(e,t){var i=require_set_helpers(),r=require_set_iterate(),o=i.Set,a=i.add;t.exports=function(c){var u=new o;return r(c,function(h){a(u,h)}),u}}}),require_set_size=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-size.js"(e,t){var i=require_function_uncurry_this_accessor(),r=require_set_helpers();t.exports=i(r.proto,"size","get")||function(o){return o.size}}}),require_get_iterator_direct=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/get-iterator-direct.js"(e,t){t.exports=function(i){return{iterator:i,next:i.next,done:!1}}}}),require_get_set_record=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/get-set-record.js"(e,t){var i=require_a_callable(),r=require_an_object(),o=require_function_call(),a=require_to_integer_or_infinity(),c=require_get_iterator_direct(),u="Invalid size",h=RangeError,d=TypeError,f=Math.max,m=function(g,v){this.set=g,this.size=f(v,0),this.has=i(g.has),this.keys=i(g.keys)};m.prototype={getIterator:function(){return c(r(o(this.keys,this.set)))},includes:function(g){return o(this.has,this.set,g)}},t.exports=function(g){r(g);var v=+g.size;if(v!==v)throw new d(u);var _=a(v);if(_<0)throw new h(u);return new m(g,_)}}}),require_set_difference=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-difference.js"(e,t){var i=require_a_set(),r=require_set_helpers(),o=require_set_clone(),a=require_set_size(),c=require_get_set_record(),u=require_set_iterate(),h=require_iterate_simple(),d=r.has,f=r.remove;t.exports=function(g){var v=i(this),_=c(g),b=o(v);return a(v)<=_.size?u(v,function(S){_.includes(S)&&f(b,S)}):h(_.getIterator(),function(S){d(v,S)&&f(b,S)}),b}}}),require_set_method_accept_set_like=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-method-accept-set-like.js"(e,t){var i=require_get_built_in(),r=function(o){return{size:o,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}};t.exports=function(o){var a=i("Set");try{new a()[o](r(0));try{return new a()[o](r(-1)),!1}catch{return!0}}catch{return!1}}}}),require_es_set_difference_v2=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.set.difference.v2.js"(){var e=require_export(),t=require_set_difference(),i=require_set_method_accept_set_like();e({target:"Set",proto:!0,real:!0,forced:!i("difference")},{difference:t})}}),require_set_intersection=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-intersection.js"(e,t){var i=require_a_set(),r=require_set_helpers(),o=require_set_size(),a=require_get_set_record(),c=require_set_iterate(),u=require_iterate_simple(),h=r.Set,d=r.add,f=r.has;t.exports=function(g){var v=i(this),_=a(g),b=new h;return o(v)>_.size?u(_.getIterator(),function(S){f(v,S)&&d(b,S)}):c(v,function(S){_.includes(S)&&d(b,S)}),b}}}),require_es_set_intersection_v2=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.set.intersection.v2.js"(){var e=require_export(),t=require_fails(),i=require_set_intersection(),r=require_set_method_accept_set_like(),o=!r("intersection")||t(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});e({target:"Set",proto:!0,real:!0,forced:o},{intersection:i})}}),require_iterator_close=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/iterator-close.js"(e,t){var i=require_function_call(),r=require_an_object(),o=require_get_method();t.exports=function(a,c,u){var h,d;r(a);try{if(h=o(a,"return"),!h){if(c==="throw")throw u;return u}h=i(h,a)}catch(f){d=!0,h=f}if(c==="throw")throw u;if(d)throw h;return r(h),u}}}),require_set_is_disjoint_from=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-is-disjoint-from.js"(e,t){var i=require_a_set(),r=require_set_helpers().has,o=require_set_size(),a=require_get_set_record(),c=require_set_iterate(),u=require_iterate_simple(),h=require_iterator_close();t.exports=function(f){var m=i(this),g=a(f);if(o(m)<=g.size)return c(m,function(_){if(g.includes(_))return!1},!0)!==!1;var v=g.getIterator();return u(v,function(_){if(r(m,_))return h(v,"normal",!1)})!==!1}}}),require_es_set_is_disjoint_from_v2=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.set.is-disjoint-from.v2.js"(){var e=require_export(),t=require_set_is_disjoint_from(),i=require_set_method_accept_set_like();e({target:"Set",proto:!0,real:!0,forced:!i("isDisjointFrom")},{isDisjointFrom:t})}}),require_set_is_subset_of=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-is-subset-of.js"(e,t){var i=require_a_set(),r=require_set_size(),o=require_set_iterate(),a=require_get_set_record();t.exports=function(u){var h=i(this),d=a(u);return r(h)>d.size?!1:o(h,function(f){if(!d.includes(f))return!1},!0)!==!1}}}),require_es_set_is_subset_of_v2=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.set.is-subset-of.v2.js"(){var e=require_export(),t=require_set_is_subset_of(),i=require_set_method_accept_set_like();e({target:"Set",proto:!0,real:!0,forced:!i("isSubsetOf")},{isSubsetOf:t})}}),require_set_is_superset_of=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-is-superset-of.js"(e,t){var i=require_a_set(),r=require_set_helpers().has,o=require_set_size(),a=require_get_set_record(),c=require_iterate_simple(),u=require_iterator_close();t.exports=function(d){var f=i(this),m=a(d);if(o(f)<m.size)return!1;var g=m.getIterator();return c(g,function(v){if(!r(f,v))return u(g,"normal",!1)})!==!1}}}),require_es_set_is_superset_of_v2=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.set.is-superset-of.v2.js"(){var e=require_export(),t=require_set_is_superset_of(),i=require_set_method_accept_set_like();e({target:"Set",proto:!0,real:!0,forced:!i("isSupersetOf")},{isSupersetOf:t})}}),require_set_symmetric_difference=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-symmetric-difference.js"(e,t){var i=require_a_set(),r=require_set_helpers(),o=require_set_clone(),a=require_get_set_record(),c=require_iterate_simple(),u=r.add,h=r.has,d=r.remove;t.exports=function(m){var g=i(this),v=a(m).getIterator(),_=o(g);return c(v,function(b){h(g,b)?d(_,b):u(_,b)}),_}}}),require_es_set_symmetric_difference_v2=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.set.symmetric-difference.v2.js"(){var e=require_export(),t=require_set_symmetric_difference(),i=require_set_method_accept_set_like();e({target:"Set",proto:!0,real:!0,forced:!i("symmetricDifference")},{symmetricDifference:t})}}),require_set_union=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-union.js"(e,t){var i=require_a_set(),r=require_set_helpers().add,o=require_set_clone(),a=require_get_set_record(),c=require_iterate_simple();t.exports=function(h){var d=i(this),f=a(h).getIterator(),m=o(d);return c(f,function(g){r(m,g)}),m}}}),require_es_set_union_v2=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.set.union.v2.js"(){var e=require_export(),t=require_set_union(),i=require_set_method_accept_set_like();e({target:"Set",proto:!0,real:!0,forced:!i("union")},{union:t})}}),require_function_uncurry_this_clause=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/function-uncurry-this-clause.js"(e,t){var i=require_classof_raw(),r=require_function_uncurry_this();t.exports=function(o){if(i(o)==="Function")return r(o)}}}),require_function_bind_context=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/function-bind-context.js"(e,t){var i=require_function_uncurry_this_clause(),r=require_a_callable(),o=require_function_bind_native(),a=i(i.bind);t.exports=function(c,u){return r(c),u===void 0?c:o?a(c,u):function(){return c.apply(u,arguments)}}}}),require_html=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/html.js"(e,t){var i=require_get_built_in();t.exports=i("document","documentElement")}}),require_array_slice=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/array-slice.js"(e,t){var i=require_function_uncurry_this();t.exports=i([].slice)}}),require_validate_arguments_length=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/validate-arguments-length.js"(e,t){var i=TypeError;t.exports=function(r,o){if(r<o)throw new i("Not enough arguments");return r}}}),require_environment_is_ios=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/environment-is-ios.js"(e,t){var i=require_environment_user_agent();t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(i)}}),require_environment=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/environment.js"(e,t){var i=require_global_this(),r=require_environment_user_agent(),o=require_classof_raw(),a=function(c){return r.slice(0,c.length)===c};t.exports=function(){return a("Bun/")?"BUN":a("Cloudflare-Workers")?"CLOUDFLARE":a("Deno/")?"DENO":a("Node.js/")?"NODE":i.Bun&&typeof Bun.version=="string"?"BUN":i.Deno&&typeof Deno.version=="object"?"DENO":o(i.process)==="process"?"NODE":i.window&&i.document?"BROWSER":"REST"}()}}),require_environment_is_node=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/environment-is-node.js"(e,t){var i=require_environment();t.exports=i==="NODE"}}),require_task=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/task.js"(e,t){var i=require_global_this(),r=require_function_apply(),o=require_function_bind_context(),a=require_is_callable(),c=require_has_own_property(),u=require_fails(),h=require_html(),d=require_array_slice(),f=require_document_create_element(),m=require_validate_arguments_length(),g=require_environment_is_ios(),v=require_environment_is_node(),_=i.setImmediate,b=i.clearImmediate,S=i.process,T=i.Dispatch,A=i.Function,I=i.MessageChannel,R=i.String,O=0,P={},L="onreadystatechange",V,U,$,Z;u(function(){V=i.location});var ie=function(pe){if(c(P,pe)){var me=P[pe];delete P[pe],me()}},ue=function(pe){return function(){ie(pe)}},_e=function(pe){ie(pe.data)},Ee=function(pe){i.postMessage(R(pe),V.protocol+"//"+V.host)};(!_||!b)&&(_=function(me){m(arguments.length,1);var Se=a(me)?me:A(me),Le=d(arguments,1);return P[++O]=function(){r(Se,void 0,Le)},U(O),O},b=function(me){delete P[me]},v?U=function(pe){S.nextTick(ue(pe))}:T&&T.now?U=function(pe){T.now(ue(pe))}:I&&!g?($=new I,Z=$.port2,$.port1.onmessage=_e,U=o(Z.postMessage,Z)):i.addEventListener&&a(i.postMessage)&&!i.importScripts&&V&&V.protocol!=="file:"&&!u(Ee)?(U=Ee,i.addEventListener("message",_e,!1)):L in f("script")?U=function(pe){h.appendChild(f("script"))[L]=function(){h.removeChild(this),ie(pe)}}:U=function(pe){setTimeout(ue(pe),0)}),t.exports={set:_,clear:b}}}),require_web_clear_immediate=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/web.clear-immediate.js"(){var e=require_export(),t=require_global_this(),i=require_task().clear;e({global:!0,bind:!0,enumerable:!0,forced:t.clearImmediate!==i},{clearImmediate:i})}}),require_schedulers_fix=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/schedulers-fix.js"(e,t){var i=require_global_this(),r=require_function_apply(),o=require_is_callable(),a=require_environment(),c=require_environment_user_agent(),u=require_array_slice(),h=require_validate_arguments_length(),d=i.Function,f=/MSIE .\./.test(c)||a==="BUN"&&function(){var m=i.Bun.version.split(".");return m.length<3||m[0]==="0"&&(m[1]<3||m[1]==="3"&&m[2]==="0")}();t.exports=function(m,g){var v=g?2:1;return f?function(_,b){var S=h(arguments.length,1)>v,T=o(_)?_:d(_),A=S?u(arguments,v):[],I=S?function(){r(T,this,A)}:T;return g?m(I,b):m(I)}:m}}}),require_web_set_immediate=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/web.set-immediate.js"(){var e=require_export(),t=require_global_this(),i=require_task().set,r=require_schedulers_fix(),o=t.setImmediate?r(i,!1):i;e({global:!0,bind:!0,enumerable:!0,forced:t.setImmediate!==o},{setImmediate:o})}}),require_web_immediate=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/web.immediate.js"(){require_web_clear_immediate(),require_web_set_immediate()}}),require_purify=__commonJS({"node_modules/.pnpm/dompurify@2.5.8/node_modules/dompurify/dist/purify.js"(e,t){/*! @license DOMPurify 2.5.8 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.8/LICENSE */(function(i,r){typeof e=="object"&&typeof t<"u"?t.exports=r():typeof define=="function"&&define.amd?define(r):(i=typeof globalThis<"u"?globalThis:i||self,i.DOMPurify=r())})(e,function(){"use strict";function i(W){"@babel/helpers - typeof";return i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(j){return typeof j}:function(j){return j&&typeof Symbol=="function"&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j},i(W)}function r(W,j){return r=Object.setPrototypeOf||function(ve,Re){return ve.__proto__=Re,ve},r(W,j)}function o(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function a(W,j,K){return o()?a=Reflect.construct:a=function(Re,Ie,ae){var Te=[null];Te.push.apply(Te,Ie);var Me=Function.bind.apply(Re,Te),Pe=new Me;return ae&&r(Pe,ae.prototype),Pe},a.apply(null,arguments)}function c(W){return u(W)||h(W)||d(W)||m()}function u(W){if(Array.isArray(W))return f(W)}function h(W){if(typeof Symbol<"u"&&W[Symbol.iterator]!=null||W["@@iterator"]!=null)return Array.from(W)}function d(W,j){if(W){if(typeof W=="string")return f(W,j);var K=Object.prototype.toString.call(W).slice(8,-1);if(K==="Object"&&W.constructor&&(K=W.constructor.name),K==="Map"||K==="Set")return Array.from(W);if(K==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(K))return f(W,j)}}function f(W,j){(j==null||j>W.length)&&(j=W.length);for(var K=0,ve=new Array(j);K<j;K++)ve[K]=W[K];return ve}function m(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g=Object.hasOwnProperty,v=Object.setPrototypeOf,_=Object.isFrozen,b=Object.getPrototypeOf,S=Object.getOwnPropertyDescriptor,T=Object.freeze,A=Object.seal,I=Object.create,R=typeof Reflect<"u"&&Reflect,O=R.apply,P=R.construct;O||(O=function(j,K,ve){return j.apply(K,ve)}),T||(T=function(j){return j}),A||(A=function(j){return j}),P||(P=function(j,K){return a(j,c(K))});var L=Se(Array.prototype.forEach),V=Se(Array.prototype.pop),U=Se(Array.prototype.push),$=Se(String.prototype.toLowerCase),Z=Se(String.prototype.toString),ie=Se(String.prototype.match),ue=Se(String.prototype.replace),_e=Se(String.prototype.indexOf),Ee=Se(String.prototype.trim),pe=Se(RegExp.prototype.test),me=Le(TypeError);function Se(W){return function(j){for(var K=arguments.length,ve=new Array(K>1?K-1:0),Re=1;Re<K;Re++)ve[Re-1]=arguments[Re];return O(W,j,ve)}}function Le(W){return function(){for(var j=arguments.length,K=new Array(j),ve=0;ve<j;ve++)K[ve]=arguments[ve];return P(W,K)}}function xe(W,j,K){var ve;K=(ve=K)!==null&&ve!==void 0?ve:$,v&&v(W,null);for(var Re=j.length;Re--;){var Ie=j[Re];if(typeof Ie=="string"){var ae=K(Ie);ae!==Ie&&(_(j)||(j[Re]=ae),Ie=ae)}W[Ie]=!0}return W}function E(W){var j=I(null),K;for(K in W)O(g,W,[K])===!0&&(j[K]=W[K]);return j}function k(W,j){for(;W!==null;){var K=S(W,j);if(K){if(K.get)return Se(K.get);if(typeof K.value=="function")return Se(K.value)}W=b(W)}function ve(Re){return console.warn("fallback value for",Re),null}return ve}var D=T(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),q=T(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),B=T(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),se=T(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ye=T(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),we=T(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),de=T(["#text"]),be=T(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),fe=T(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),he=T(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ne=T(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),le=A(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ve=A(/<%[\w\W]*|[\w\W]*%>/gm),Be=A(/\${[\w\W]*}/gm),je=A(/^data-[\-\w.\u00B7-\uFFFF]+$/),We=A(/^aria-[\-\w]+$/),$e=A(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),H=A(/^(?:\w+script|data):/i),F=A(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),G=A(/^html$/i),oe=A(/^[a-z][.\w]*(-[.\w]+)+$/i),Q=function(){return typeof window>"u"?null:window},ce=function(j,K){if(i(j)!=="object"||typeof j.createPolicy!="function")return null;var ve=null,Re="data-tt-policy-suffix";K.currentScript&&K.currentScript.hasAttribute(Re)&&(ve=K.currentScript.getAttribute(Re));var Ie="dompurify"+(ve?"#"+ve:"");try{return j.createPolicy(Ie,{createHTML:function(Te){return Te},createScriptURL:function(Te){return Te}})}catch{return console.warn("TrustedTypes policy "+Ie+" could not be created."),null}};function ee(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Q(),j=function(ne){return ee(ne)};if(j.version="2.5.8",j.removed=[],!W||!W.document||W.document.nodeType!==9)return j.isSupported=!1,j;var K=W.document,ve=W.document,Re=W.DocumentFragment,Ie=W.HTMLTemplateElement,ae=W.Node,Te=W.Element,Me=W.NodeFilter,Pe=W.NamedNodeMap,De=Pe===void 0?W.NamedNodeMap||W.MozNamedAttrMap:Pe,ze=W.HTMLFormElement,ut=W.DOMParser,ht=W.trustedTypes,yt=Te.prototype,nt=k(yt,"cloneNode"),St=k(yt,"nextSibling"),Oe=k(yt,"childNodes"),Qe=k(yt,"parentNode");if(typeof Ie=="function"){var Xe=ve.createElement("template");Xe.content&&Xe.content.ownerDocument&&(ve=Xe.content.ownerDocument)}var et=ce(ht,K),dt=et?et.createHTML(""):"",Ye=ve,dn=Ye.implementation,Je=Ye.createNodeIterator,fn=Ye.createDocumentFragment,Hi=Ye.getElementsByTagName,Sn=K.importNode,vt={};try{vt=E(ve).documentMode?ve.documentMode:{}}catch{}var mt={};j.isSupported=typeof Qe=="function"&&dn&&dn.createHTMLDocument!==void 0&&vt!==9;var Rt=le,lt=Ve,Tt=Be,It=je,$t=We,Fi=H,ri=F,mn=oe,En=$e,gt=null,Wt=xe({},[].concat(c(D),c(q),c(B),c(ye),c(de))),it=null,Ln=xe({},[].concat(c(be),c(fe),c(he),c(Ne))),ct=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),gn=null,Hn=null,rt=!0,pn=!0,si=!1,Fn=!0,jt=!1,Vn=!0,Ut=!1,Bn=!1,$n=!1,en=!1,Tn=!1,vn=!1,Wn=!0,oi=!1,Vi="user-content-",jn=!0,tn=!1,nn={},Pt=null,wn=xe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Un=null,rn=xe({},["audio","video","img","source","image","track"]),Ot=null,ai=xe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),xn="http://www.w3.org/1998/Math/MathML",Rn="http://www.w3.org/2000/svg",Nt="http://www.w3.org/1999/xhtml",sn=Nt,zn=!1,Yn=null,Bi=xe({},[xn,Rn,Nt],Z),Dt,$i=["application/xhtml+xml","text/html"],li="text/html",pt,on=null,Wi=ve.createElement("form"),ci=function(ne){return ne instanceof RegExp||ne instanceof Function},Gn=function(ne){on&&on===ne||((!ne||i(ne)!=="object")&&(ne={}),ne=E(ne),Dt=$i.indexOf(ne.PARSER_MEDIA_TYPE)===-1?Dt=li:Dt=ne.PARSER_MEDIA_TYPE,pt=Dt==="application/xhtml+xml"?Z:$,gt="ALLOWED_TAGS"in ne?xe({},ne.ALLOWED_TAGS,pt):Wt,it="ALLOWED_ATTR"in ne?xe({},ne.ALLOWED_ATTR,pt):Ln,Yn="ALLOWED_NAMESPACES"in ne?xe({},ne.ALLOWED_NAMESPACES,Z):Bi,Ot="ADD_URI_SAFE_ATTR"in ne?xe(E(ai),ne.ADD_URI_SAFE_ATTR,pt):ai,Un="ADD_DATA_URI_TAGS"in ne?xe(E(rn),ne.ADD_DATA_URI_TAGS,pt):rn,Pt="FORBID_CONTENTS"in ne?xe({},ne.FORBID_CONTENTS,pt):wn,gn="FORBID_TAGS"in ne?xe({},ne.FORBID_TAGS,pt):{},Hn="FORBID_ATTR"in ne?xe({},ne.FORBID_ATTR,pt):{},nn="USE_PROFILES"in ne?ne.USE_PROFILES:!1,rt=ne.ALLOW_ARIA_ATTR!==!1,pn=ne.ALLOW_DATA_ATTR!==!1,si=ne.ALLOW_UNKNOWN_PROTOCOLS||!1,Fn=ne.ALLOW_SELF_CLOSE_IN_ATTR!==!1,jt=ne.SAFE_FOR_TEMPLATES||!1,Vn=ne.SAFE_FOR_XML!==!1,Ut=ne.WHOLE_DOCUMENT||!1,en=ne.RETURN_DOM||!1,Tn=ne.RETURN_DOM_FRAGMENT||!1,vn=ne.RETURN_TRUSTED_TYPE||!1,$n=ne.FORCE_BODY||!1,Wn=ne.SANITIZE_DOM!==!1,oi=ne.SANITIZE_NAMED_PROPS||!1,jn=ne.KEEP_CONTENT!==!1,tn=ne.IN_PLACE||!1,En=ne.ALLOWED_URI_REGEXP||En,sn=ne.NAMESPACE||Nt,ct=ne.CUSTOM_ELEMENT_HANDLING||{},ne.CUSTOM_ELEMENT_HANDLING&&ci(ne.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ct.tagNameCheck=ne.CUSTOM_ELEMENT_HANDLING.tagNameCheck),ne.CUSTOM_ELEMENT_HANDLING&&ci(ne.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ct.attributeNameCheck=ne.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),ne.CUSTOM_ELEMENT_HANDLING&&typeof ne.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ct.allowCustomizedBuiltInElements=ne.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),jt&&(pn=!1),Tn&&(en=!0),nn&&(gt=xe({},c(de)),it=[],nn.html===!0&&(xe(gt,D),xe(it,be)),nn.svg===!0&&(xe(gt,q),xe(it,fe),xe(it,Ne)),nn.svgFilters===!0&&(xe(gt,B),xe(it,fe),xe(it,Ne)),nn.mathMl===!0&&(xe(gt,ye),xe(it,he),xe(it,Ne))),ne.ADD_TAGS&&(gt===Wt&&(gt=E(gt)),xe(gt,ne.ADD_TAGS,pt)),ne.ADD_ATTR&&(it===Ln&&(it=E(it)),xe(it,ne.ADD_ATTR,pt)),ne.ADD_URI_SAFE_ATTR&&xe(Ot,ne.ADD_URI_SAFE_ATTR,pt),ne.FORBID_CONTENTS&&(Pt===wn&&(Pt=E(Pt)),xe(Pt,ne.FORBID_CONTENTS,pt)),jn&&(gt["#text"]=!0),Ut&&xe(gt,["html","head","body"]),gt.table&&(xe(gt,["tbody"]),delete gn.tbody),T&&T(ne),on=ne)},ui=xe({},["mi","mo","mn","ms","mtext"]),hi=xe({},["annotation-xml"]),ji=xe({},["title","style","font","a","script"]),Mn=xe({},q);xe(Mn,B),xe(Mn,se);var qn=xe({},ye);xe(qn,we);var Ui=function(ne){var Ce=Qe(ne);(!Ce||!Ce.tagName)&&(Ce={namespaceURI:sn,tagName:"template"});var Ae=$(ne.tagName),Ge=$(Ce.tagName);return Yn[ne.namespaceURI]?ne.namespaceURI===Rn?Ce.namespaceURI===Nt?Ae==="svg":Ce.namespaceURI===xn?Ae==="svg"&&(Ge==="annotation-xml"||ui[Ge]):!!Mn[Ae]:ne.namespaceURI===xn?Ce.namespaceURI===Nt?Ae==="math":Ce.namespaceURI===Rn?Ae==="math"&&hi[Ge]:!!qn[Ae]:ne.namespaceURI===Nt?Ce.namespaceURI===Rn&&!hi[Ge]||Ce.namespaceURI===xn&&!ui[Ge]?!1:!qn[Ae]&&(ji[Ae]||!Mn[Ae]):!!(Dt==="application/xhtml+xml"&&Yn[ne.namespaceURI]):!1},Mt=function(ne){U(j.removed,{element:ne});try{ne.parentNode.removeChild(ne)}catch{try{ne.outerHTML=dt}catch{ne.remove()}}},kn=function(ne,Ce){try{U(j.removed,{attribute:Ce.getAttributeNode(ne),from:Ce})}catch{U(j.removed,{attribute:null,from:Ce})}if(Ce.removeAttribute(ne),ne==="is"&&!it[ne])if(en||Tn)try{Mt(Ce)}catch{}else try{Ce.setAttribute(ne,"")}catch{}},di=function(ne){var Ce,Ae;if($n)ne="<remove></remove>"+ne;else{var Ge=ie(ne,/^[\r\n\t ]+/);Ae=Ge&&Ge[0]}Dt==="application/xhtml+xml"&&sn===Nt&&(ne='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+ne+"</body></html>");var Et=et?et.createHTML(ne):ne;if(sn===Nt)try{Ce=new ut().parseFromString(Et,Dt)}catch{}if(!Ce||!Ce.documentElement){Ce=dn.createDocument(sn,"template",null);try{Ce.documentElement.innerHTML=zn?dt:Et}catch{}}var wt=Ce.body||Ce.documentElement;return ne&&Ae&&wt.insertBefore(ve.createTextNode(Ae),wt.childNodes[0]||null),sn===Nt?Hi.call(Ce,Ut?"html":"body")[0]:Ut?Ce.documentElement:wt},fi=function(ne){return Je.call(ne.ownerDocument||ne,ne,Me.SHOW_ELEMENT|Me.SHOW_COMMENT|Me.SHOW_TEXT|Me.SHOW_PROCESSING_INSTRUCTION|Me.SHOW_CDATA_SECTION,null,!1)},_n=function(ne){return ne instanceof ze&&(typeof ne.nodeName!="string"||typeof ne.textContent!="string"||typeof ne.removeChild!="function"||!(ne.attributes instanceof De)||typeof ne.removeAttribute!="function"||typeof ne.setAttribute!="function"||typeof ne.namespaceURI!="string"||typeof ne.insertBefore!="function"||typeof ne.hasChildNodes!="function")},zt=function(ne){return i(ae)==="object"?ne instanceof ae:ne&&i(ne)==="object"&&typeof ne.nodeType=="number"&&typeof ne.nodeName=="string"},Lt=function(ne,Ce,Ae){mt[ne]&&L(mt[ne],function(Ge){Ge.call(j,Ce,Ae,on)})},Kn=function(ne){var Ce;if(Lt("beforeSanitizeElements",ne,null),_n(ne)||pe(/[\u0080-\uFFFF]/,ne.nodeName))return Mt(ne),!0;var Ae=pt(ne.nodeName);if(Lt("uponSanitizeElement",ne,{tagName:Ae,allowedTags:gt}),ne.hasChildNodes()&&!zt(ne.firstElementChild)&&(!zt(ne.content)||!zt(ne.content.firstElementChild))&&pe(/<[/\w]/g,ne.innerHTML)&&pe(/<[/\w]/g,ne.textContent)||Ae==="select"&&pe(/<template/i,ne.innerHTML)||ne.nodeType===7||Vn&&ne.nodeType===8&&pe(/<[/\w]/g,ne.data))return Mt(ne),!0;if(!gt[Ae]||gn[Ae]){if(!gn[Ae]&&mi(Ae)&&(ct.tagNameCheck instanceof RegExp&&pe(ct.tagNameCheck,Ae)||ct.tagNameCheck instanceof Function&&ct.tagNameCheck(Ae)))return!1;if(jn&&!Pt[Ae]){var Ge=Qe(ne)||ne.parentNode,Et=Oe(ne)||ne.childNodes;if(Et&&Ge)for(var wt=Et.length,_t=wt-1;_t>=0;--_t){var Yt=nt(Et[_t],!0);Yt.__removalCount=(ne.__removalCount||0)+1,Ge.insertBefore(Yt,St(ne))}}return Mt(ne),!0}return ne instanceof Te&&!Ui(ne)||(Ae==="noscript"||Ae==="noembed"||Ae==="noframes")&&pe(/<\/no(script|embed|frames)/i,ne.innerHTML)?(Mt(ne),!0):(jt&&ne.nodeType===3&&(Ce=ne.textContent,Ce=ue(Ce,Rt," "),Ce=ue(Ce,lt," "),Ce=ue(Ce,Tt," "),ne.textContent!==Ce&&(U(j.removed,{element:ne.cloneNode()}),ne.textContent=Ce)),Lt("afterSanitizeElements",ne,null),!1)},Zn=function(ne,Ce,Ae){if(Wn&&(Ce==="id"||Ce==="name")&&(Ae in ve||Ae in Wi))return!1;if(!(pn&&!Hn[Ce]&&pe(It,Ce))){if(!(rt&&pe($t,Ce))){if(!it[Ce]||Hn[Ce]){if(!(mi(ne)&&(ct.tagNameCheck instanceof RegExp&&pe(ct.tagNameCheck,ne)||ct.tagNameCheck instanceof Function&&ct.tagNameCheck(ne))&&(ct.attributeNameCheck instanceof RegExp&&pe(ct.attributeNameCheck,Ce)||ct.attributeNameCheck instanceof Function&&ct.attributeNameCheck(Ce))||Ce==="is"&&ct.allowCustomizedBuiltInElements&&(ct.tagNameCheck instanceof RegExp&&pe(ct.tagNameCheck,Ae)||ct.tagNameCheck instanceof Function&&ct.tagNameCheck(Ae))))return!1}else if(!Ot[Ce]){if(!pe(En,ue(Ae,ri,""))){if(!((Ce==="src"||Ce==="xlink:href"||Ce==="href")&&ne!=="script"&&_e(Ae,"data:")===0&&Un[ne])){if(!(si&&!pe(Fi,ue(Ae,ri,"")))){if(Ae)return!1}}}}}}return!0},mi=function(ne){return ne!=="annotation-xml"&&ie(ne,mn)},gi=function(ne){var Ce,Ae,Ge,Et;Lt("beforeSanitizeAttributes",ne,null);var wt=ne.attributes;if(!(!wt||_n(ne))){var _t={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:it};for(Et=wt.length;Et--;){Ce=wt[Et];var Yt=Ce,st=Yt.name,At=Yt.namespaceURI;if(Ae=st==="value"?Ce.value:Ee(Ce.value),Ge=pt(st),_t.attrName=Ge,_t.attrValue=Ae,_t.keepAttr=!0,_t.forceKeepAttr=void 0,Lt("uponSanitizeAttribute",ne,_t),Ae=_t.attrValue,!_t.forceKeepAttr&&(kn(st,ne),!!_t.keepAttr)){if(!Fn&&pe(/\/>/i,Ae)){kn(st,ne);continue}jt&&(Ae=ue(Ae,Rt," "),Ae=ue(Ae,lt," "),Ae=ue(Ae,Tt," "));var On=pt(ne.nodeName);if(Zn(On,Ge,Ae)){if(oi&&(Ge==="id"||Ge==="name")&&(kn(st,ne),Ae=Vi+Ae),Vn&&pe(/((--!?|])>)|<\/(style|title)/i,Ae)){kn(st,ne);continue}if(et&&i(ht)==="object"&&typeof ht.getAttributeType=="function"&&!At)switch(ht.getAttributeType(On,Ge)){case"TrustedHTML":{Ae=et.createHTML(Ae);break}case"TrustedScriptURL":{Ae=et.createScriptURL(Ae);break}}try{At?ne.setAttributeNS(At,st,Ae):ne.setAttribute(st,Ae),_n(ne)?Mt(ne):V(j.removed)}catch{}}}}Lt("afterSanitizeAttributes",ne,null)}},zi=function Fe(ne){var Ce,Ae=fi(ne);for(Lt("beforeSanitizeShadowDOM",ne,null);Ce=Ae.nextNode();)Lt("uponSanitizeShadowNode",Ce,null),Kn(Ce),gi(Ce),Ce.content instanceof Re&&Fe(Ce.content);Lt("afterSanitizeShadowDOM",ne,null)};return j.sanitize=function(Fe){var ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ce,Ae,Ge,Et,wt;if(zn=!Fe,zn&&(Fe="<!-->"),typeof Fe!="string"&&!zt(Fe))if(typeof Fe.toString=="function"){if(Fe=Fe.toString(),typeof Fe!="string")throw me("dirty is not a string, aborting")}else throw me("toString is not a function");if(!j.isSupported){if(i(W.toStaticHTML)==="object"||typeof W.toStaticHTML=="function"){if(typeof Fe=="string")return W.toStaticHTML(Fe);if(zt(Fe))return W.toStaticHTML(Fe.outerHTML)}return Fe}if(Bn||Gn(ne),j.removed=[],typeof Fe=="string"&&(tn=!1),tn){if(Fe.nodeName){var _t=pt(Fe.nodeName);if(!gt[_t]||gn[_t])throw me("root node is forbidden and cannot be sanitized in-place")}}else if(Fe instanceof ae)Ce=di("<!---->"),Ae=Ce.ownerDocument.importNode(Fe,!0),Ae.nodeType===1&&Ae.nodeName==="BODY"||Ae.nodeName==="HTML"?Ce=Ae:Ce.appendChild(Ae);else{if(!en&&!jt&&!Ut&&Fe.indexOf("<")===-1)return et&&vn?et.createHTML(Fe):Fe;if(Ce=di(Fe),!Ce)return en?null:vn?dt:""}Ce&&$n&&Mt(Ce.firstChild);for(var Yt=fi(tn?Fe:Ce);Ge=Yt.nextNode();)Ge.nodeType===3&&Ge===Et||(Kn(Ge),gi(Ge),Ge.content instanceof Re&&zi(Ge.content),Et=Ge);if(Et=null,tn)return Fe;if(en){if(Tn)for(wt=fn.call(Ce.ownerDocument);Ce.firstChild;)wt.appendChild(Ce.firstChild);else wt=Ce;return(it.shadowroot||it.shadowrootmod)&&(wt=Sn.call(K,wt,!0)),wt}var st=Ut?Ce.outerHTML:Ce.innerHTML;return Ut&&gt["!doctype"]&&Ce.ownerDocument&&Ce.ownerDocument.doctype&&Ce.ownerDocument.doctype.name&&pe(G,Ce.ownerDocument.doctype.name)&&(st="<!DOCTYPE "+Ce.ownerDocument.doctype.name+`>
`+st),jt&&(st=ue(st,Rt," "),st=ue(st,lt," "),st=ue(st,Tt," ")),et&&vn?et.createHTML(st):st},j.setConfig=function(Fe){Gn(Fe),Bn=!0},j.clearConfig=function(){on=null,Bn=!1},j.isValidAttribute=function(Fe,ne,Ce){on||Gn({});var Ae=pt(Fe),Ge=pt(ne);return Zn(Ae,Ge,Ce)},j.addHook=function(Fe,ne){typeof ne=="function"&&(mt[Fe]=mt[Fe]||[],U(mt[Fe],ne))},j.removeHook=function(Fe){if(mt[Fe])return V(mt[Fe])},j.removeHooks=function(Fe){mt[Fe]&&(mt[Fe]=[])},j.removeAllHooks=function(){mt={}},j}var te=ee();return te})}}),require_moment=__commonJS({"node_modules/.pnpm/moment@2.30.1/node_modules/moment/moment.js"(e,t){(function(i,r){typeof e=="object"&&typeof t<"u"?t.exports=r():typeof define=="function"&&define.amd?define(r):i.moment=r()})(e,function(){"use strict";var i;function r(){return i.apply(null,arguments)}function o(p){i=p}function a(p){return p instanceof Array||Object.prototype.toString.call(p)==="[object Array]"}function c(p){return p!=null&&Object.prototype.toString.call(p)==="[object Object]"}function u(p,w){return Object.prototype.hasOwnProperty.call(p,w)}function h(p){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(p).length===0;var w;for(w in p)if(u(p,w))return!1;return!0}function d(p){return p===void 0}function f(p){return typeof p=="number"||Object.prototype.toString.call(p)==="[object Number]"}function m(p){return p instanceof Date||Object.prototype.toString.call(p)==="[object Date]"}function g(p,w){var C=[],M,N=p.length;for(M=0;M<N;++M)C.push(w(p[M],M));return C}function v(p,w){for(var C in w)u(w,C)&&(p[C]=w[C]);return u(w,"toString")&&(p.toString=w.toString),u(w,"valueOf")&&(p.valueOf=w.valueOf),p}function _(p,w,C,M){return Mr(p,w,C,M,!0).utc()}function b(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function S(p){return p._pf==null&&(p._pf=b()),p._pf}var T;Array.prototype.some?T=Array.prototype.some:T=function(p){var w=Object(this),C=w.length>>>0,M;for(M=0;M<C;M++)if(M in w&&p.call(this,w[M],M,w))return!0;return!1};function A(p){var w=null,C=!1,M=p._d&&!isNaN(p._d.getTime());if(M&&(w=S(p),C=T.call(w.parsedDateParts,function(N){return N!=null}),M=w.overflow<0&&!w.empty&&!w.invalidEra&&!w.invalidMonth&&!w.invalidWeekday&&!w.weekdayMismatch&&!w.nullInput&&!w.invalidFormat&&!w.userInvalidated&&(!w.meridiem||w.meridiem&&C),p._strict&&(M=M&&w.charsLeftOver===0&&w.unusedTokens.length===0&&w.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(p))p._isValid=M;else return M;return p._isValid}function I(p){var w=_(NaN);return p!=null?v(S(w),p):S(w).userInvalidated=!0,w}var R=r.momentProperties=[],O=!1;function P(p,w){var C,M,N,J=R.length;if(d(w._isAMomentObject)||(p._isAMomentObject=w._isAMomentObject),d(w._i)||(p._i=w._i),d(w._f)||(p._f=w._f),d(w._l)||(p._l=w._l),d(w._strict)||(p._strict=w._strict),d(w._tzm)||(p._tzm=w._tzm),d(w._isUTC)||(p._isUTC=w._isUTC),d(w._offset)||(p._offset=w._offset),d(w._pf)||(p._pf=S(w)),d(w._locale)||(p._locale=w._locale),J>0)for(C=0;C<J;C++)M=R[C],N=w[M],d(N)||(p[M]=N);return p}function L(p){P(this,p),this._d=new Date(p._d!=null?p._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),O===!1&&(O=!0,r.updateOffset(this),O=!1)}function V(p){return p instanceof L||p!=null&&p._isAMomentObject!=null}function U(p){r.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+p)}function $(p,w){var C=!0;return v(function(){if(r.deprecationHandler!=null&&r.deprecationHandler(null,p),C){var M=[],N,J,ge,He=arguments.length;for(J=0;J<He;J++){if(N="",typeof arguments[J]=="object"){N+=`
[`+J+"] ";for(ge in arguments[0])u(arguments[0],ge)&&(N+=ge+": "+arguments[0][ge]+", ");N=N.slice(0,-2)}else N=arguments[J];M.push(N)}U(p+`
Arguments: `+Array.prototype.slice.call(M).join("")+`
`+new Error().stack),C=!1}return w.apply(this,arguments)},w)}var Z={};function ie(p,w){r.deprecationHandler!=null&&r.deprecationHandler(p,w),Z[p]||(U(w),Z[p]=!0)}r.suppressDeprecationWarnings=!1,r.deprecationHandler=null;function ue(p){return typeof Function<"u"&&p instanceof Function||Object.prototype.toString.call(p)==="[object Function]"}function _e(p){var w,C;for(C in p)u(p,C)&&(w=p[C],ue(w)?this[C]=w:this["_"+C]=w);this._config=p,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Ee(p,w){var C=v({},p),M;for(M in w)u(w,M)&&(c(p[M])&&c(w[M])?(C[M]={},v(C[M],p[M]),v(C[M],w[M])):w[M]!=null?C[M]=w[M]:delete C[M]);for(M in p)u(p,M)&&!u(w,M)&&c(p[M])&&(C[M]=v({},C[M]));return C}function pe(p){p!=null&&this.set(p)}var me;Object.keys?me=Object.keys:me=function(p){var w,C=[];for(w in p)u(p,w)&&C.push(w);return C};var Se={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Le(p,w,C){var M=this._calendar[p]||this._calendar.sameElse;return ue(M)?M.call(w,C):M}function xe(p,w,C){var M=""+Math.abs(p),N=w-M.length,J=p>=0;return(J?C?"+":"":"-")+Math.pow(10,Math.max(0,N)).toString().substr(1)+M}var E=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,k=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,D={},q={};function B(p,w,C,M){var N=M;typeof M=="string"&&(N=function(){return this[M]()}),p&&(q[p]=N),w&&(q[w[0]]=function(){return xe(N.apply(this,arguments),w[1],w[2])}),C&&(q[C]=function(){return this.localeData().ordinal(N.apply(this,arguments),p)})}function se(p){return p.match(/\[[\s\S]/)?p.replace(/^\[|\]$/g,""):p.replace(/\\/g,"")}function ye(p){var w=p.match(E),C,M;for(C=0,M=w.length;C<M;C++)q[w[C]]?w[C]=q[w[C]]:w[C]=se(w[C]);return function(N){var J="",ge;for(ge=0;ge<M;ge++)J+=ue(w[ge])?w[ge].call(N,p):w[ge];return J}}function we(p,w){return p.isValid()?(w=de(w,p.localeData()),D[w]=D[w]||ye(w),D[w](p)):p.localeData().invalidDate()}function de(p,w){var C=5;function M(N){return w.longDateFormat(N)||N}for(k.lastIndex=0;C>=0&&k.test(p);)p=p.replace(k,M),k.lastIndex=0,C-=1;return p}var be={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function fe(p){var w=this._longDateFormat[p],C=this._longDateFormat[p.toUpperCase()];return w||!C?w:(this._longDateFormat[p]=C.match(E).map(function(M){return M==="MMMM"||M==="MM"||M==="DD"||M==="dddd"?M.slice(1):M}).join(""),this._longDateFormat[p])}var he="Invalid date";function Ne(){return this._invalidDate}var le="%d",Ve=/\d{1,2}/;function Be(p){return this._ordinal.replace("%d",p)}var je={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function We(p,w,C,M){var N=this._relativeTime[C];return ue(N)?N(p,w,C,M):N.replace(/%d/i,p)}function $e(p,w){var C=this._relativeTime[p>0?"future":"past"];return ue(C)?C(w):C.replace(/%s/i,w)}var H={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function F(p){return typeof p=="string"?H[p]||H[p.toLowerCase()]:void 0}function G(p){var w={},C,M;for(M in p)u(p,M)&&(C=F(M),C&&(w[C]=p[M]));return w}var oe={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function Q(p){var w=[],C;for(C in p)u(p,C)&&w.push({unit:C,priority:oe[C]});return w.sort(function(M,N){return M.priority-N.priority}),w}var ce=/\d/,ee=/\d\d/,te=/\d{3}/,W=/\d{4}/,j=/[+-]?\d{6}/,K=/\d\d?/,ve=/\d\d\d\d?/,Re=/\d\d\d\d\d\d?/,Ie=/\d{1,3}/,ae=/\d{1,4}/,Te=/[+-]?\d{1,6}/,Me=/\d+/,Pe=/[+-]?\d+/,De=/Z|[+-]\d\d:?\d\d/gi,ze=/Z|[+-]\d\d(?::?\d\d)?/gi,ut=/[+-]?\d+(\.\d{1,3})?/,ht=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,yt=/^[1-9]\d?/,nt=/^([1-9]\d|\d)/,St;St={};function Oe(p,w,C){St[p]=ue(w)?w:function(M,N){return M&&C?C:w}}function Qe(p,w){return u(St,p)?St[p](w._strict,w._locale):new RegExp(Xe(p))}function Xe(p){return et(p.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(w,C,M,N,J){return C||M||N||J}))}function et(p){return p.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function dt(p){return p<0?Math.ceil(p)||0:Math.floor(p)}function Ye(p){var w=+p,C=0;return w!==0&&isFinite(w)&&(C=dt(w)),C}var dn={};function Je(p,w){var C,M=w,N;for(typeof p=="string"&&(p=[p]),f(w)&&(M=function(J,ge){ge[w]=Ye(J)}),N=p.length,C=0;C<N;C++)dn[p[C]]=M}function fn(p,w){Je(p,function(C,M,N,J){N._w=N._w||{},w(C,N._w,N,J)})}function Hi(p,w,C){w!=null&&u(dn,p)&&dn[p](w,C._a,C,p)}function Sn(p){return p%4===0&&p%100!==0||p%400===0}var vt=0,mt=1,Rt=2,lt=3,Tt=4,It=5,$t=6,Fi=7,ri=8;B("Y",0,0,function(){var p=this.year();return p<=9999?xe(p,4):"+"+p}),B(0,["YY",2],0,function(){return this.year()%100}),B(0,["YYYY",4],0,"year"),B(0,["YYYYY",5],0,"year"),B(0,["YYYYYY",6,!0],0,"year"),Oe("Y",Pe),Oe("YY",K,ee),Oe("YYYY",ae,W),Oe("YYYYY",Te,j),Oe("YYYYYY",Te,j),Je(["YYYYY","YYYYYY"],vt),Je("YYYY",function(p,w){w[vt]=p.length===2?r.parseTwoDigitYear(p):Ye(p)}),Je("YY",function(p,w){w[vt]=r.parseTwoDigitYear(p)}),Je("Y",function(p,w){w[vt]=parseInt(p,10)});function mn(p){return Sn(p)?366:365}r.parseTwoDigitYear=function(p){return Ye(p)+(Ye(p)>68?1900:2e3)};var En=Wt("FullYear",!0);function gt(){return Sn(this.year())}function Wt(p,w){return function(C){return C!=null?(Ln(this,p,C),r.updateOffset(this,w),this):it(this,p)}}function it(p,w){if(!p.isValid())return NaN;var C=p._d,M=p._isUTC;switch(w){case"Milliseconds":return M?C.getUTCMilliseconds():C.getMilliseconds();case"Seconds":return M?C.getUTCSeconds():C.getSeconds();case"Minutes":return M?C.getUTCMinutes():C.getMinutes();case"Hours":return M?C.getUTCHours():C.getHours();case"Date":return M?C.getUTCDate():C.getDate();case"Day":return M?C.getUTCDay():C.getDay();case"Month":return M?C.getUTCMonth():C.getMonth();case"FullYear":return M?C.getUTCFullYear():C.getFullYear();default:return NaN}}function Ln(p,w,C){var M,N,J,ge,He;if(!(!p.isValid()||isNaN(C))){switch(M=p._d,N=p._isUTC,w){case"Milliseconds":return void(N?M.setUTCMilliseconds(C):M.setMilliseconds(C));case"Seconds":return void(N?M.setUTCSeconds(C):M.setSeconds(C));case"Minutes":return void(N?M.setUTCMinutes(C):M.setMinutes(C));case"Hours":return void(N?M.setUTCHours(C):M.setHours(C));case"Date":return void(N?M.setUTCDate(C):M.setDate(C));case"FullYear":break;default:return}J=C,ge=p.month(),He=p.date(),He=He===29&&ge===1&&!Sn(J)?28:He,N?M.setUTCFullYear(J,ge,He):M.setFullYear(J,ge,He)}}function ct(p){return p=F(p),ue(this[p])?this[p]():this}function gn(p,w){if(typeof p=="object"){p=G(p);var C=Q(p),M,N=C.length;for(M=0;M<N;M++)this[C[M].unit](p[C[M].unit])}else if(p=F(p),ue(this[p]))return this[p](w);return this}function Hn(p,w){return(p%w+w)%w}var rt;Array.prototype.indexOf?rt=Array.prototype.indexOf:rt=function(p){var w;for(w=0;w<this.length;++w)if(this[w]===p)return w;return-1};function pn(p,w){if(isNaN(p)||isNaN(w))return NaN;var C=Hn(w,12);return p+=(w-C)/12,C===1?Sn(p)?29:28:31-C%7%2}B("M",["MM",2],"Mo",function(){return this.month()+1}),B("MMM",0,0,function(p){return this.localeData().monthsShort(this,p)}),B("MMMM",0,0,function(p){return this.localeData().months(this,p)}),Oe("M",K,yt),Oe("MM",K,ee),Oe("MMM",function(p,w){return w.monthsShortRegex(p)}),Oe("MMMM",function(p,w){return w.monthsRegex(p)}),Je(["M","MM"],function(p,w){w[mt]=Ye(p)-1}),Je(["MMM","MMMM"],function(p,w,C,M){var N=C._locale.monthsParse(p,M,C._strict);N!=null?w[mt]=N:S(C).invalidMonth=p});var si="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Fn="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),jt=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Vn=ht,Ut=ht;function Bn(p,w){return p?a(this._months)?this._months[p.month()]:this._months[(this._months.isFormat||jt).test(w)?"format":"standalone"][p.month()]:a(this._months)?this._months:this._months.standalone}function $n(p,w){return p?a(this._monthsShort)?this._monthsShort[p.month()]:this._monthsShort[jt.test(w)?"format":"standalone"][p.month()]:a(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function en(p,w,C){var M,N,J,ge=p.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],M=0;M<12;++M)J=_([2e3,M]),this._shortMonthsParse[M]=this.monthsShort(J,"").toLocaleLowerCase(),this._longMonthsParse[M]=this.months(J,"").toLocaleLowerCase();return C?w==="MMM"?(N=rt.call(this._shortMonthsParse,ge),N!==-1?N:null):(N=rt.call(this._longMonthsParse,ge),N!==-1?N:null):w==="MMM"?(N=rt.call(this._shortMonthsParse,ge),N!==-1?N:(N=rt.call(this._longMonthsParse,ge),N!==-1?N:null)):(N=rt.call(this._longMonthsParse,ge),N!==-1?N:(N=rt.call(this._shortMonthsParse,ge),N!==-1?N:null))}function Tn(p,w,C){var M,N,J;if(this._monthsParseExact)return en.call(this,p,w,C);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),M=0;M<12;M++){if(N=_([2e3,M]),C&&!this._longMonthsParse[M]&&(this._longMonthsParse[M]=new RegExp("^"+this.months(N,"").replace(".","")+"$","i"),this._shortMonthsParse[M]=new RegExp("^"+this.monthsShort(N,"").replace(".","")+"$","i")),!C&&!this._monthsParse[M]&&(J="^"+this.months(N,"")+"|^"+this.monthsShort(N,""),this._monthsParse[M]=new RegExp(J.replace(".",""),"i")),C&&w==="MMMM"&&this._longMonthsParse[M].test(p))return M;if(C&&w==="MMM"&&this._shortMonthsParse[M].test(p))return M;if(!C&&this._monthsParse[M].test(p))return M}}function vn(p,w){if(!p.isValid())return p;if(typeof w=="string"){if(/^\d+$/.test(w))w=Ye(w);else if(w=p.localeData().monthsParse(w),!f(w))return p}var C=w,M=p.date();return M=M<29?M:Math.min(M,pn(p.year(),C)),p._isUTC?p._d.setUTCMonth(C,M):p._d.setMonth(C,M),p}function Wn(p){return p!=null?(vn(this,p),r.updateOffset(this,!0),this):it(this,"Month")}function oi(){return pn(this.year(),this.month())}function Vi(p){return this._monthsParseExact?(u(this,"_monthsRegex")||tn.call(this),p?this._monthsShortStrictRegex:this._monthsShortRegex):(u(this,"_monthsShortRegex")||(this._monthsShortRegex=Vn),this._monthsShortStrictRegex&&p?this._monthsShortStrictRegex:this._monthsShortRegex)}function jn(p){return this._monthsParseExact?(u(this,"_monthsRegex")||tn.call(this),p?this._monthsStrictRegex:this._monthsRegex):(u(this,"_monthsRegex")||(this._monthsRegex=Ut),this._monthsStrictRegex&&p?this._monthsStrictRegex:this._monthsRegex)}function tn(){function p(Ue,qe){return qe.length-Ue.length}var w=[],C=[],M=[],N,J,ge,He;for(N=0;N<12;N++)J=_([2e3,N]),ge=et(this.monthsShort(J,"")),He=et(this.months(J,"")),w.push(ge),C.push(He),M.push(He),M.push(ge);w.sort(p),C.sort(p),M.sort(p),this._monthsRegex=new RegExp("^("+M.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+C.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+w.join("|")+")","i")}function nn(p,w,C,M,N,J,ge){var He;return p<100&&p>=0?(He=new Date(p+400,w,C,M,N,J,ge),isFinite(He.getFullYear())&&He.setFullYear(p)):He=new Date(p,w,C,M,N,J,ge),He}function Pt(p){var w,C;return p<100&&p>=0?(C=Array.prototype.slice.call(arguments),C[0]=p+400,w=new Date(Date.UTC.apply(null,C)),isFinite(w.getUTCFullYear())&&w.setUTCFullYear(p)):w=new Date(Date.UTC.apply(null,arguments)),w}function wn(p,w,C){var M=7+w-C,N=(7+Pt(p,0,M).getUTCDay()-w)%7;return-N+M-1}function Un(p,w,C,M,N){var J=(7+C-M)%7,ge=wn(p,M,N),He=1+7*(w-1)+J+ge,Ue,qe;return He<=0?(Ue=p-1,qe=mn(Ue)+He):He>mn(p)?(Ue=p+1,qe=He-mn(p)):(Ue=p,qe=He),{year:Ue,dayOfYear:qe}}function rn(p,w,C){var M=wn(p.year(),w,C),N=Math.floor((p.dayOfYear()-M-1)/7)+1,J,ge;return N<1?(ge=p.year()-1,J=N+Ot(ge,w,C)):N>Ot(p.year(),w,C)?(J=N-Ot(p.year(),w,C),ge=p.year()+1):(ge=p.year(),J=N),{week:J,year:ge}}function Ot(p,w,C){var M=wn(p,w,C),N=wn(p+1,w,C);return(mn(p)-M+N)/7}B("w",["ww",2],"wo","week"),B("W",["WW",2],"Wo","isoWeek"),Oe("w",K,yt),Oe("ww",K,ee),Oe("W",K,yt),Oe("WW",K,ee),fn(["w","ww","W","WW"],function(p,w,C,M){w[M.substr(0,1)]=Ye(p)});function ai(p){return rn(p,this._week.dow,this._week.doy).week}var xn={dow:0,doy:6};function Rn(){return this._week.dow}function Nt(){return this._week.doy}function sn(p){var w=this.localeData().week(this);return p==null?w:this.add((p-w)*7,"d")}function zn(p){var w=rn(this,1,4).week;return p==null?w:this.add((p-w)*7,"d")}B("d",0,"do","day"),B("dd",0,0,function(p){return this.localeData().weekdaysMin(this,p)}),B("ddd",0,0,function(p){return this.localeData().weekdaysShort(this,p)}),B("dddd",0,0,function(p){return this.localeData().weekdays(this,p)}),B("e",0,0,"weekday"),B("E",0,0,"isoWeekday"),Oe("d",K),Oe("e",K),Oe("E",K),Oe("dd",function(p,w){return w.weekdaysMinRegex(p)}),Oe("ddd",function(p,w){return w.weekdaysShortRegex(p)}),Oe("dddd",function(p,w){return w.weekdaysRegex(p)}),fn(["dd","ddd","dddd"],function(p,w,C,M){var N=C._locale.weekdaysParse(p,M,C._strict);N!=null?w.d=N:S(C).invalidWeekday=p}),fn(["d","e","E"],function(p,w,C,M){w[M]=Ye(p)});function Yn(p,w){return typeof p!="string"?p:isNaN(p)?(p=w.weekdaysParse(p),typeof p=="number"?p:null):parseInt(p,10)}function Bi(p,w){return typeof p=="string"?w.weekdaysParse(p)%7||7:isNaN(p)?null:p}function Dt(p,w){return p.slice(w,7).concat(p.slice(0,w))}var $i="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),li="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),pt="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),on=ht,Wi=ht,ci=ht;function Gn(p,w){var C=a(this._weekdays)?this._weekdays:this._weekdays[p&&p!==!0&&this._weekdays.isFormat.test(w)?"format":"standalone"];return p===!0?Dt(C,this._week.dow):p?C[p.day()]:C}function ui(p){return p===!0?Dt(this._weekdaysShort,this._week.dow):p?this._weekdaysShort[p.day()]:this._weekdaysShort}function hi(p){return p===!0?Dt(this._weekdaysMin,this._week.dow):p?this._weekdaysMin[p.day()]:this._weekdaysMin}function ji(p,w,C){var M,N,J,ge=p.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],M=0;M<7;++M)J=_([2e3,1]).day(M),this._minWeekdaysParse[M]=this.weekdaysMin(J,"").toLocaleLowerCase(),this._shortWeekdaysParse[M]=this.weekdaysShort(J,"").toLocaleLowerCase(),this._weekdaysParse[M]=this.weekdays(J,"").toLocaleLowerCase();return C?w==="dddd"?(N=rt.call(this._weekdaysParse,ge),N!==-1?N:null):w==="ddd"?(N=rt.call(this._shortWeekdaysParse,ge),N!==-1?N:null):(N=rt.call(this._minWeekdaysParse,ge),N!==-1?N:null):w==="dddd"?(N=rt.call(this._weekdaysParse,ge),N!==-1||(N=rt.call(this._shortWeekdaysParse,ge),N!==-1)?N:(N=rt.call(this._minWeekdaysParse,ge),N!==-1?N:null)):w==="ddd"?(N=rt.call(this._shortWeekdaysParse,ge),N!==-1||(N=rt.call(this._weekdaysParse,ge),N!==-1)?N:(N=rt.call(this._minWeekdaysParse,ge),N!==-1?N:null)):(N=rt.call(this._minWeekdaysParse,ge),N!==-1||(N=rt.call(this._weekdaysParse,ge),N!==-1)?N:(N=rt.call(this._shortWeekdaysParse,ge),N!==-1?N:null))}function Mn(p,w,C){var M,N,J;if(this._weekdaysParseExact)return ji.call(this,p,w,C);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),M=0;M<7;M++){if(N=_([2e3,1]).day(M),C&&!this._fullWeekdaysParse[M]&&(this._fullWeekdaysParse[M]=new RegExp("^"+this.weekdays(N,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[M]=new RegExp("^"+this.weekdaysShort(N,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[M]=new RegExp("^"+this.weekdaysMin(N,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[M]||(J="^"+this.weekdays(N,"")+"|^"+this.weekdaysShort(N,"")+"|^"+this.weekdaysMin(N,""),this._weekdaysParse[M]=new RegExp(J.replace(".",""),"i")),C&&w==="dddd"&&this._fullWeekdaysParse[M].test(p))return M;if(C&&w==="ddd"&&this._shortWeekdaysParse[M].test(p))return M;if(C&&w==="dd"&&this._minWeekdaysParse[M].test(p))return M;if(!C&&this._weekdaysParse[M].test(p))return M}}function qn(p){if(!this.isValid())return p!=null?this:NaN;var w=it(this,"Day");return p!=null?(p=Yn(p,this.localeData()),this.add(p-w,"d")):w}function Ui(p){if(!this.isValid())return p!=null?this:NaN;var w=(this.day()+7-this.localeData()._week.dow)%7;return p==null?w:this.add(p-w,"d")}function Mt(p){if(!this.isValid())return p!=null?this:NaN;if(p!=null){var w=Bi(p,this.localeData());return this.day(this.day()%7?w:w-7)}else return this.day()||7}function kn(p){return this._weekdaysParseExact?(u(this,"_weekdaysRegex")||_n.call(this),p?this._weekdaysStrictRegex:this._weekdaysRegex):(u(this,"_weekdaysRegex")||(this._weekdaysRegex=on),this._weekdaysStrictRegex&&p?this._weekdaysStrictRegex:this._weekdaysRegex)}function di(p){return this._weekdaysParseExact?(u(this,"_weekdaysRegex")||_n.call(this),p?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(u(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Wi),this._weekdaysShortStrictRegex&&p?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function fi(p){return this._weekdaysParseExact?(u(this,"_weekdaysRegex")||_n.call(this),p?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(u(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=ci),this._weekdaysMinStrictRegex&&p?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function _n(){function p(xt,Xt){return Xt.length-xt.length}var w=[],C=[],M=[],N=[],J,ge,He,Ue,qe;for(J=0;J<7;J++)ge=_([2e3,1]).day(J),He=et(this.weekdaysMin(ge,"")),Ue=et(this.weekdaysShort(ge,"")),qe=et(this.weekdays(ge,"")),w.push(He),C.push(Ue),M.push(qe),N.push(He),N.push(Ue),N.push(qe);w.sort(p),C.sort(p),M.sort(p),N.sort(p),this._weekdaysRegex=new RegExp("^("+N.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+M.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+C.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+w.join("|")+")","i")}function zt(){return this.hours()%12||12}function Lt(){return this.hours()||24}B("H",["HH",2],0,"hour"),B("h",["hh",2],0,zt),B("k",["kk",2],0,Lt),B("hmm",0,0,function(){return""+zt.apply(this)+xe(this.minutes(),2)}),B("hmmss",0,0,function(){return""+zt.apply(this)+xe(this.minutes(),2)+xe(this.seconds(),2)}),B("Hmm",0,0,function(){return""+this.hours()+xe(this.minutes(),2)}),B("Hmmss",0,0,function(){return""+this.hours()+xe(this.minutes(),2)+xe(this.seconds(),2)});function Kn(p,w){B(p,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),w)})}Kn("a",!0),Kn("A",!1);function Zn(p,w){return w._meridiemParse}Oe("a",Zn),Oe("A",Zn),Oe("H",K,nt),Oe("h",K,yt),Oe("k",K,yt),Oe("HH",K,ee),Oe("hh",K,ee),Oe("kk",K,ee),Oe("hmm",ve),Oe("hmmss",Re),Oe("Hmm",ve),Oe("Hmmss",Re),Je(["H","HH"],lt),Je(["k","kk"],function(p,w,C){var M=Ye(p);w[lt]=M===24?0:M}),Je(["a","A"],function(p,w,C){C._isPm=C._locale.isPM(p),C._meridiem=p}),Je(["h","hh"],function(p,w,C){w[lt]=Ye(p),S(C).bigHour=!0}),Je("hmm",function(p,w,C){var M=p.length-2;w[lt]=Ye(p.substr(0,M)),w[Tt]=Ye(p.substr(M)),S(C).bigHour=!0}),Je("hmmss",function(p,w,C){var M=p.length-4,N=p.length-2;w[lt]=Ye(p.substr(0,M)),w[Tt]=Ye(p.substr(M,2)),w[It]=Ye(p.substr(N)),S(C).bigHour=!0}),Je("Hmm",function(p,w,C){var M=p.length-2;w[lt]=Ye(p.substr(0,M)),w[Tt]=Ye(p.substr(M))}),Je("Hmmss",function(p,w,C){var M=p.length-4,N=p.length-2;w[lt]=Ye(p.substr(0,M)),w[Tt]=Ye(p.substr(M,2)),w[It]=Ye(p.substr(N))});function mi(p){return(p+"").toLowerCase().charAt(0)==="p"}var gi=/[ap]\.?m?\.?/i,zi=Wt("Hours",!0);function Fe(p,w,C){return p>11?C?"pm":"PM":C?"am":"AM"}var ne={calendar:Se,longDateFormat:be,invalidDate:he,ordinal:le,dayOfMonthOrdinalParse:Ve,relativeTime:je,months:si,monthsShort:Fn,week:xn,weekdays:$i,weekdaysMin:pt,weekdaysShort:li,meridiemParse:gi},Ce={},Ae={},Ge;function Et(p,w){var C,M=Math.min(p.length,w.length);for(C=0;C<M;C+=1)if(p[C]!==w[C])return C;return M}function wt(p){return p&&p.toLowerCase().replace("_","-")}function _t(p){for(var w=0,C,M,N,J;w<p.length;){for(J=wt(p[w]).split("-"),C=J.length,M=wt(p[w+1]),M=M?M.split("-"):null;C>0;){if(N=st(J.slice(0,C).join("-")),N)return N;if(M&&M.length>=C&&Et(J,M)>=C-1)break;C--}w++}return Ge}function Yt(p){return!!(p&&p.match("^[^/\\\\]*$"))}function st(p){var w=null,C;if(Ce[p]===void 0&&typeof t<"u"&&t&&t.exports&&Yt(p))try{w=Ge._abbr,C=require,C("./locale/"+p),At(w)}catch{Ce[p]=null}return Ce[p]}function At(p,w){var C;return p&&(d(w)?C=Gt(p):C=On(p,w),C?Ge=C:typeof console<"u"&&console.warn&&console.warn("Locale "+p+" not found. Did you forget to load it?")),Ge._abbr}function On(p,w){if(w!==null){var C,M=ne;if(w.abbr=p,Ce[p]!=null)ie("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),M=Ce[p]._config;else if(w.parentLocale!=null)if(Ce[w.parentLocale]!=null)M=Ce[w.parentLocale]._config;else if(C=st(w.parentLocale),C!=null)M=C._config;else return Ae[w.parentLocale]||(Ae[w.parentLocale]=[]),Ae[w.parentLocale].push({name:p,config:w}),null;return Ce[p]=new pe(Ee(M,w)),Ae[p]&&Ae[p].forEach(function(N){On(N.name,N.config)}),At(p),Ce[p]}else return delete Ce[p],null}function Er(p,w){if(w!=null){var C,M,N=ne;Ce[p]!=null&&Ce[p].parentLocale!=null?Ce[p].set(Ee(Ce[p]._config,w)):(M=st(p),M!=null&&(N=M._config),w=Ee(N,w),M==null&&(w.abbr=p),C=new pe(w),C.parentLocale=Ce[p],Ce[p]=C),At(p)}else Ce[p]!=null&&(Ce[p].parentLocale!=null?(Ce[p]=Ce[p].parentLocale,p===At()&&At(p)):Ce[p]!=null&&delete Ce[p]);return Ce[p]}function Gt(p){var w;if(p&&p._locale&&p._locale._abbr&&(p=p._locale._abbr),!p)return Ge;if(!a(p)){if(w=st(p),w)return w;p=[p]}return _t(p)}function Is(){return me(Ce)}function Yi(p){var w,C=p._a;return C&&S(p).overflow===-2&&(w=C[mt]<0||C[mt]>11?mt:C[Rt]<1||C[Rt]>pn(C[vt],C[mt])?Rt:C[lt]<0||C[lt]>24||C[lt]===24&&(C[Tt]!==0||C[It]!==0||C[$t]!==0)?lt:C[Tt]<0||C[Tt]>59?Tt:C[It]<0||C[It]>59?It:C[$t]<0||C[$t]>999?$t:-1,S(p)._overflowDayOfYear&&(w<vt||w>Rt)&&(w=Rt),S(p)._overflowWeeks&&w===-1&&(w=Fi),S(p)._overflowWeekday&&w===-1&&(w=ri),S(p).overflow=w),p}var Ns=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ds=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ls=/Z|[+-]\d\d(?::?\d\d)?/,pi=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Gi=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Hs=/^\/?Date\((-?\d+)/i,Fs=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Vs={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Tr(p){var w,C,M=p._i,N=Ns.exec(M)||Ds.exec(M),J,ge,He,Ue,qe=pi.length,xt=Gi.length;if(N){for(S(p).iso=!0,w=0,C=qe;w<C;w++)if(pi[w][1].exec(N[1])){ge=pi[w][0],J=pi[w][2]!==!1;break}if(ge==null){p._isValid=!1;return}if(N[3]){for(w=0,C=xt;w<C;w++)if(Gi[w][1].exec(N[3])){He=(N[2]||" ")+Gi[w][0];break}if(He==null){p._isValid=!1;return}}if(!J&&He!=null){p._isValid=!1;return}if(N[4])if(Ls.exec(N[4]))Ue="Z";else{p._isValid=!1;return}p._f=ge+(He||"")+(Ue||""),Ki(p)}else p._isValid=!1}function Bs(p,w,C,M,N,J){var ge=[$s(p),Fn.indexOf(w),parseInt(C,10),parseInt(M,10),parseInt(N,10)];return J&&ge.push(parseInt(J,10)),ge}function $s(p){var w=parseInt(p,10);return w<=49?2e3+w:w<=999?1900+w:w}function Ws(p){return p.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function js(p,w,C){if(p){var M=li.indexOf(p),N=new Date(w[0],w[1],w[2]).getDay();if(M!==N)return S(C).weekdayMismatch=!0,C._isValid=!1,!1}return!0}function Us(p,w,C){if(p)return Vs[p];if(w)return 0;var M=parseInt(C,10),N=M%100,J=(M-N)/100;return J*60+N}function xr(p){var w=Fs.exec(Ws(p._i)),C;if(w){if(C=Bs(w[4],w[3],w[2],w[5],w[6],w[7]),!js(w[1],C,p))return;p._a=C,p._tzm=Us(w[8],w[9],w[10]),p._d=Pt.apply(null,p._a),p._d.setUTCMinutes(p._d.getUTCMinutes()-p._tzm),S(p).rfc2822=!0}else p._isValid=!1}function zs(p){var w=Hs.exec(p._i);if(w!==null){p._d=new Date(+w[1]);return}if(Tr(p),p._isValid===!1)delete p._isValid;else return;if(xr(p),p._isValid===!1)delete p._isValid;else return;p._strict?p._isValid=!1:r.createFromInputFallback(p)}r.createFromInputFallback=$("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(p){p._d=new Date(p._i+(p._useUTC?" UTC":""))});function Pn(p,w,C){return p??w??C}function Ys(p){var w=new Date(r.now());return p._useUTC?[w.getUTCFullYear(),w.getUTCMonth(),w.getUTCDate()]:[w.getFullYear(),w.getMonth(),w.getDate()]}function qi(p){var w,C,M=[],N,J,ge;if(!p._d){for(N=Ys(p),p._w&&p._a[Rt]==null&&p._a[mt]==null&&Gs(p),p._dayOfYear!=null&&(ge=Pn(p._a[vt],N[vt]),(p._dayOfYear>mn(ge)||p._dayOfYear===0)&&(S(p)._overflowDayOfYear=!0),C=Pt(ge,0,p._dayOfYear),p._a[mt]=C.getUTCMonth(),p._a[Rt]=C.getUTCDate()),w=0;w<3&&p._a[w]==null;++w)p._a[w]=M[w]=N[w];for(;w<7;w++)p._a[w]=M[w]=p._a[w]==null?w===2?1:0:p._a[w];p._a[lt]===24&&p._a[Tt]===0&&p._a[It]===0&&p._a[$t]===0&&(p._nextDay=!0,p._a[lt]=0),p._d=(p._useUTC?Pt:nn).apply(null,M),J=p._useUTC?p._d.getUTCDay():p._d.getDay(),p._tzm!=null&&p._d.setUTCMinutes(p._d.getUTCMinutes()-p._tzm),p._nextDay&&(p._a[lt]=24),p._w&&typeof p._w.d<"u"&&p._w.d!==J&&(S(p).weekdayMismatch=!0)}}function Gs(p){var w,C,M,N,J,ge,He,Ue,qe;w=p._w,w.GG!=null||w.W!=null||w.E!=null?(J=1,ge=4,C=Pn(w.GG,p._a[vt],rn(tt(),1,4).year),M=Pn(w.W,1),N=Pn(w.E,1),(N<1||N>7)&&(Ue=!0)):(J=p._locale._week.dow,ge=p._locale._week.doy,qe=rn(tt(),J,ge),C=Pn(w.gg,p._a[vt],qe.year),M=Pn(w.w,qe.week),w.d!=null?(N=w.d,(N<0||N>6)&&(Ue=!0)):w.e!=null?(N=w.e+J,(w.e<0||w.e>6)&&(Ue=!0)):N=J),M<1||M>Ot(C,J,ge)?S(p)._overflowWeeks=!0:Ue!=null?S(p)._overflowWeekday=!0:(He=Un(C,M,N,J,ge),p._a[vt]=He.year,p._dayOfYear=He.dayOfYear)}r.ISO_8601=function(){},r.RFC_2822=function(){};function Ki(p){if(p._f===r.ISO_8601){Tr(p);return}if(p._f===r.RFC_2822){xr(p);return}p._a=[],S(p).empty=!0;var w=""+p._i,C,M,N,J,ge,He=w.length,Ue=0,qe,xt;for(N=de(p._f,p._locale).match(E)||[],xt=N.length,C=0;C<xt;C++)J=N[C],M=(w.match(Qe(J,p))||[])[0],M&&(ge=w.substr(0,w.indexOf(M)),ge.length>0&&S(p).unusedInput.push(ge),w=w.slice(w.indexOf(M)+M.length),Ue+=M.length),q[J]?(M?S(p).empty=!1:S(p).unusedTokens.push(J),Hi(J,M,p)):p._strict&&!M&&S(p).unusedTokens.push(J);S(p).charsLeftOver=He-Ue,w.length>0&&S(p).unusedInput.push(w),p._a[lt]<=12&&S(p).bigHour===!0&&p._a[lt]>0&&(S(p).bigHour=void 0),S(p).parsedDateParts=p._a.slice(0),S(p).meridiem=p._meridiem,p._a[lt]=qs(p._locale,p._a[lt],p._meridiem),qe=S(p).era,qe!==null&&(p._a[vt]=p._locale.erasConvertYear(qe,p._a[vt])),qi(p),Yi(p)}function qs(p,w,C){var M;return C==null?w:p.meridiemHour!=null?p.meridiemHour(w,C):(p.isPM!=null&&(M=p.isPM(C),M&&w<12&&(w+=12),!M&&w===12&&(w=0)),w)}function Ks(p){var w,C,M,N,J,ge,He=!1,Ue=p._f.length;if(Ue===0){S(p).invalidFormat=!0,p._d=new Date(NaN);return}for(N=0;N<Ue;N++)J=0,ge=!1,w=P({},p),p._useUTC!=null&&(w._useUTC=p._useUTC),w._f=p._f[N],Ki(w),A(w)&&(ge=!0),J+=S(w).charsLeftOver,J+=S(w).unusedTokens.length*10,S(w).score=J,He?J<M&&(M=J,C=w):(M==null||J<M||ge)&&(M=J,C=w,ge&&(He=!0));v(p,C||w)}function Zs(p){if(!p._d){var w=G(p._i),C=w.day===void 0?w.date:w.day;p._a=g([w.year,w.month,C,w.hour,w.minute,w.second,w.millisecond],function(M){return M&&parseInt(M,10)}),qi(p)}}function Xs(p){var w=new L(Yi(Rr(p)));return w._nextDay&&(w.add(1,"d"),w._nextDay=void 0),w}function Rr(p){var w=p._i,C=p._f;return p._locale=p._locale||Gt(p._l),w===null||C===void 0&&w===""?I({nullInput:!0}):(typeof w=="string"&&(p._i=w=p._locale.preparse(w)),V(w)?new L(Yi(w)):(m(w)?p._d=w:a(C)?Ks(p):C?Ki(p):Js(p),A(p)||(p._d=null),p))}function Js(p){var w=p._i;d(w)?p._d=new Date(r.now()):m(w)?p._d=new Date(w.valueOf()):typeof w=="string"?zs(p):a(w)?(p._a=g(w.slice(0),function(C){return parseInt(C,10)}),qi(p)):c(w)?Zs(p):f(w)?p._d=new Date(w):r.createFromInputFallback(p)}function Mr(p,w,C,M,N){var J={};return(w===!0||w===!1)&&(M=w,w=void 0),(C===!0||C===!1)&&(M=C,C=void 0),(c(p)&&h(p)||a(p)&&p.length===0)&&(p=void 0),J._isAMomentObject=!0,J._useUTC=J._isUTC=N,J._l=C,J._i=p,J._f=w,J._strict=M,Xs(J)}function tt(p,w,C,M){return Mr(p,w,C,M,!1)}var Qs=$("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var p=tt.apply(null,arguments);return this.isValid()&&p.isValid()?p<this?this:p:I()}),eo=$("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var p=tt.apply(null,arguments);return this.isValid()&&p.isValid()?p>this?this:p:I()});function kr(p,w){var C,M;if(w.length===1&&a(w[0])&&(w=w[0]),!w.length)return tt();for(C=w[0],M=1;M<w.length;++M)(!w[M].isValid()||w[M][p](C))&&(C=w[M]);return C}function no(){var p=[].slice.call(arguments,0);return kr("isBefore",p)}function io(){var p=[].slice.call(arguments,0);return kr("isAfter",p)}var ro=function(){return Date.now?Date.now():+new Date},Xn=["year","quarter","month","week","day","hour","minute","second","millisecond"];function so(p){var w,C=!1,M,N=Xn.length;for(w in p)if(u(p,w)&&!(rt.call(Xn,w)!==-1&&(p[w]==null||!isNaN(p[w]))))return!1;for(M=0;M<N;++M)if(p[Xn[M]]){if(C)return!1;parseFloat(p[Xn[M]])!==Ye(p[Xn[M]])&&(C=!0)}return!0}function oo(){return this._isValid}function ao(){return Ht(NaN)}function vi(p){var w=G(p),C=w.year||0,M=w.quarter||0,N=w.month||0,J=w.week||w.isoWeek||0,ge=w.day||0,He=w.hour||0,Ue=w.minute||0,qe=w.second||0,xt=w.millisecond||0;this._isValid=so(w),this._milliseconds=+xt+qe*1e3+Ue*6e4+He*1e3*60*60,this._days=+ge+J*7,this._months=+N+M*3+C*12,this._data={},this._locale=Gt(),this._bubble()}function wi(p){return p instanceof vi}function Zi(p){return p<0?Math.round(-1*p)*-1:Math.round(p)}function lo(p,w,C){var M=Math.min(p.length,w.length),N=Math.abs(p.length-w.length),J=0,ge;for(ge=0;ge<M;ge++)(C&&p[ge]!==w[ge]||!C&&Ye(p[ge])!==Ye(w[ge]))&&J++;return J+N}function Or(p,w){B(p,0,0,function(){var C=this.utcOffset(),M="+";return C<0&&(C=-C,M="-"),M+xe(~~(C/60),2)+w+xe(~~C%60,2)})}Or("Z",":"),Or("ZZ",""),Oe("Z",ze),Oe("ZZ",ze),Je(["Z","ZZ"],function(p,w,C){C._useUTC=!0,C._tzm=Xi(ze,p)});var co=/([\+\-]|\d\d)/gi;function Xi(p,w){var C=(w||"").match(p),M,N,J;return C===null?null:(M=C[C.length-1]||[],N=(M+"").match(co)||["-",0,0],J=+(N[1]*60)+Ye(N[2]),J===0?0:N[0]==="+"?J:-J)}function Ji(p,w){var C,M;return w._isUTC?(C=w.clone(),M=(V(p)||m(p)?p.valueOf():tt(p).valueOf())-C.valueOf(),C._d.setTime(C._d.valueOf()+M),r.updateOffset(C,!1),C):tt(p).local()}function Qi(p){return-Math.round(p._d.getTimezoneOffset())}r.updateOffset=function(){};function uo(p,w,C){var M=this._offset||0,N;if(!this.isValid())return p!=null?this:NaN;if(p!=null){if(typeof p=="string"){if(p=Xi(ze,p),p===null)return this}else Math.abs(p)<16&&!C&&(p=p*60);return!this._isUTC&&w&&(N=Qi(this)),this._offset=p,this._isUTC=!0,N!=null&&this.add(N,"m"),M!==p&&(!w||this._changeInProgress?Nr(this,Ht(p-M,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,r.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?M:Qi(this)}function ho(p,w){return p!=null?(typeof p!="string"&&(p=-p),this.utcOffset(p,w),this):-this.utcOffset()}function fo(p){return this.utcOffset(0,p)}function mo(p){return this._isUTC&&(this.utcOffset(0,p),this._isUTC=!1,p&&this.subtract(Qi(this),"m")),this}function go(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var p=Xi(De,this._i);p!=null?this.utcOffset(p):this.utcOffset(0,!0)}return this}function po(p){return this.isValid()?(p=p?tt(p).utcOffset():0,(this.utcOffset()-p)%60===0):!1}function vo(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function wo(){if(!d(this._isDSTShifted))return this._isDSTShifted;var p={},w;return P(p,this),p=Rr(p),p._a?(w=p._isUTC?_(p._a):tt(p._a),this._isDSTShifted=this.isValid()&&lo(p._a,w.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function _o(){return this.isValid()?!this._isUTC:!1}function yo(){return this.isValid()?this._isUTC:!1}function Pr(){return this.isValid()?this._isUTC&&this._offset===0:!1}var bo=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Co=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ht(p,w){var C=p,M=null,N,J,ge;return wi(p)?C={ms:p._milliseconds,d:p._days,M:p._months}:f(p)||!isNaN(+p)?(C={},w?C[w]=+p:C.milliseconds=+p):(M=bo.exec(p))?(N=M[1]==="-"?-1:1,C={y:0,d:Ye(M[Rt])*N,h:Ye(M[lt])*N,m:Ye(M[Tt])*N,s:Ye(M[It])*N,ms:Ye(Zi(M[$t]*1e3))*N}):(M=Co.exec(p))?(N=M[1]==="-"?-1:1,C={y:yn(M[2],N),M:yn(M[3],N),w:yn(M[4],N),d:yn(M[5],N),h:yn(M[6],N),m:yn(M[7],N),s:yn(M[8],N)}):C==null?C={}:typeof C=="object"&&("from"in C||"to"in C)&&(ge=So(tt(C.from),tt(C.to)),C={},C.ms=ge.milliseconds,C.M=ge.months),J=new vi(C),wi(p)&&u(p,"_locale")&&(J._locale=p._locale),wi(p)&&u(p,"_isValid")&&(J._isValid=p._isValid),J}Ht.fn=vi.prototype,Ht.invalid=ao;function yn(p,w){var C=p&&parseFloat(p.replace(",","."));return(isNaN(C)?0:C)*w}function Ar(p,w){var C={};return C.months=w.month()-p.month()+(w.year()-p.year())*12,p.clone().add(C.months,"M").isAfter(w)&&--C.months,C.milliseconds=+w-+p.clone().add(C.months,"M"),C}function So(p,w){var C;return p.isValid()&&w.isValid()?(w=Ji(w,p),p.isBefore(w)?C=Ar(p,w):(C=Ar(w,p),C.milliseconds=-C.milliseconds,C.months=-C.months),C):{milliseconds:0,months:0}}function Ir(p,w){return function(C,M){var N,J;return M!==null&&!isNaN(+M)&&(ie(w,"moment()."+w+"(period, number) is deprecated. Please use moment()."+w+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),J=C,C=M,M=J),N=Ht(C,M),Nr(this,N,p),this}}function Nr(p,w,C,M){var N=w._milliseconds,J=Zi(w._days),ge=Zi(w._months);p.isValid()&&(M=M??!0,ge&&vn(p,it(p,"Month")+ge*C),J&&Ln(p,"Date",it(p,"Date")+J*C),N&&p._d.setTime(p._d.valueOf()+N*C),M&&r.updateOffset(p,J||ge))}var Eo=Ir(1,"add"),To=Ir(-1,"subtract");function Dr(p){return typeof p=="string"||p instanceof String}function xo(p){return V(p)||m(p)||Dr(p)||f(p)||Mo(p)||Ro(p)||p===null||p===void 0}function Ro(p){var w=c(p)&&!h(p),C=!1,M=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],N,J,ge=M.length;for(N=0;N<ge;N+=1)J=M[N],C=C||u(p,J);return w&&C}function Mo(p){var w=a(p),C=!1;return w&&(C=p.filter(function(M){return!f(M)&&Dr(p)}).length===0),w&&C}function ko(p){var w=c(p)&&!h(p),C=!1,M=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],N,J;for(N=0;N<M.length;N+=1)J=M[N],C=C||u(p,J);return w&&C}function Oo(p,w){var C=p.diff(w,"days",!0);return C<-6?"sameElse":C<-1?"lastWeek":C<0?"lastDay":C<1?"sameDay":C<2?"nextDay":C<7?"nextWeek":"sameElse"}function Po(p,w){arguments.length===1&&(arguments[0]?xo(arguments[0])?(p=arguments[0],w=void 0):ko(arguments[0])&&(w=arguments[0],p=void 0):(p=void 0,w=void 0));var C=p||tt(),M=Ji(C,this).startOf("day"),N=r.calendarFormat(this,M)||"sameElse",J=w&&(ue(w[N])?w[N].call(this,C):w[N]);return this.format(J||this.localeData().calendar(N,this,tt(C)))}function Ao(){return new L(this)}function Io(p,w){var C=V(p)?p:tt(p);return this.isValid()&&C.isValid()?(w=F(w)||"millisecond",w==="millisecond"?this.valueOf()>C.valueOf():C.valueOf()<this.clone().startOf(w).valueOf()):!1}function No(p,w){var C=V(p)?p:tt(p);return this.isValid()&&C.isValid()?(w=F(w)||"millisecond",w==="millisecond"?this.valueOf()<C.valueOf():this.clone().endOf(w).valueOf()<C.valueOf()):!1}function Do(p,w,C,M){var N=V(p)?p:tt(p),J=V(w)?w:tt(w);return this.isValid()&&N.isValid()&&J.isValid()?(M=M||"()",(M[0]==="("?this.isAfter(N,C):!this.isBefore(N,C))&&(M[1]===")"?this.isBefore(J,C):!this.isAfter(J,C))):!1}function Lo(p,w){var C=V(p)?p:tt(p),M;return this.isValid()&&C.isValid()?(w=F(w)||"millisecond",w==="millisecond"?this.valueOf()===C.valueOf():(M=C.valueOf(),this.clone().startOf(w).valueOf()<=M&&M<=this.clone().endOf(w).valueOf())):!1}function Ho(p,w){return this.isSame(p,w)||this.isAfter(p,w)}function Fo(p,w){return this.isSame(p,w)||this.isBefore(p,w)}function Vo(p,w,C){var M,N,J;if(!this.isValid())return NaN;if(M=Ji(p,this),!M.isValid())return NaN;switch(N=(M.utcOffset()-this.utcOffset())*6e4,w=F(w),w){case"year":J=_i(this,M)/12;break;case"month":J=_i(this,M);break;case"quarter":J=_i(this,M)/3;break;case"second":J=(this-M)/1e3;break;case"minute":J=(this-M)/6e4;break;case"hour":J=(this-M)/36e5;break;case"day":J=(this-M-N)/864e5;break;case"week":J=(this-M-N)/6048e5;break;default:J=this-M}return C?J:dt(J)}function _i(p,w){if(p.date()<w.date())return-_i(w,p);var C=(w.year()-p.year())*12+(w.month()-p.month()),M=p.clone().add(C,"months"),N,J;return w-M<0?(N=p.clone().add(C-1,"months"),J=(w-M)/(M-N)):(N=p.clone().add(C+1,"months"),J=(w-M)/(N-M)),-(C+J)||0}r.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",r.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Bo(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function $o(p){if(!this.isValid())return null;var w=p!==!0,C=w?this.clone().utc():this;return C.year()<0||C.year()>9999?we(C,w?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):ue(Date.prototype.toISOString)?w?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",we(C,"Z")):we(C,w?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Wo(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var p="moment",w="",C,M,N,J;return this.isLocal()||(p=this.utcOffset()===0?"moment.utc":"moment.parseZone",w="Z"),C="["+p+'("]',M=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",N="-MM-DD[T]HH:mm:ss.SSS",J=w+'[")]',this.format(C+M+N+J)}function jo(p){p||(p=this.isUtc()?r.defaultFormatUtc:r.defaultFormat);var w=we(this,p);return this.localeData().postformat(w)}function Uo(p,w){return this.isValid()&&(V(p)&&p.isValid()||tt(p).isValid())?Ht({to:this,from:p}).locale(this.locale()).humanize(!w):this.localeData().invalidDate()}function zo(p){return this.from(tt(),p)}function Yo(p,w){return this.isValid()&&(V(p)&&p.isValid()||tt(p).isValid())?Ht({from:this,to:p}).locale(this.locale()).humanize(!w):this.localeData().invalidDate()}function Go(p){return this.to(tt(),p)}function Lr(p){var w;return p===void 0?this._locale._abbr:(w=Gt(p),w!=null&&(this._locale=w),this)}var Hr=$("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(p){return p===void 0?this.localeData():this.locale(p)});function Fr(){return this._locale}var yi=1e3,An=60*yi,bi=60*An,Vr=3506328*bi;function In(p,w){return(p%w+w)%w}function Br(p,w,C){return p<100&&p>=0?new Date(p+400,w,C)-Vr:new Date(p,w,C).valueOf()}function $r(p,w,C){return p<100&&p>=0?Date.UTC(p+400,w,C)-Vr:Date.UTC(p,w,C)}function qo(p){var w,C;if(p=F(p),p===void 0||p==="millisecond"||!this.isValid())return this;switch(C=this._isUTC?$r:Br,p){case"year":w=C(this.year(),0,1);break;case"quarter":w=C(this.year(),this.month()-this.month()%3,1);break;case"month":w=C(this.year(),this.month(),1);break;case"week":w=C(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":w=C(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":w=C(this.year(),this.month(),this.date());break;case"hour":w=this._d.valueOf(),w-=In(w+(this._isUTC?0:this.utcOffset()*An),bi);break;case"minute":w=this._d.valueOf(),w-=In(w,An);break;case"second":w=this._d.valueOf(),w-=In(w,yi);break}return this._d.setTime(w),r.updateOffset(this,!0),this}function Ko(p){var w,C;if(p=F(p),p===void 0||p==="millisecond"||!this.isValid())return this;switch(C=this._isUTC?$r:Br,p){case"year":w=C(this.year()+1,0,1)-1;break;case"quarter":w=C(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":w=C(this.year(),this.month()+1,1)-1;break;case"week":w=C(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":w=C(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":w=C(this.year(),this.month(),this.date()+1)-1;break;case"hour":w=this._d.valueOf(),w+=bi-In(w+(this._isUTC?0:this.utcOffset()*An),bi)-1;break;case"minute":w=this._d.valueOf(),w+=An-In(w,An)-1;break;case"second":w=this._d.valueOf(),w+=yi-In(w,yi)-1;break}return this._d.setTime(w),r.updateOffset(this,!0),this}function Zo(){return this._d.valueOf()-(this._offset||0)*6e4}function Xo(){return Math.floor(this.valueOf()/1e3)}function Jo(){return new Date(this.valueOf())}function Qo(){var p=this;return[p.year(),p.month(),p.date(),p.hour(),p.minute(),p.second(),p.millisecond()]}function ea(){var p=this;return{years:p.year(),months:p.month(),date:p.date(),hours:p.hours(),minutes:p.minutes(),seconds:p.seconds(),milliseconds:p.milliseconds()}}function ta(){return this.isValid()?this.toISOString():null}function na(){return A(this)}function ia(){return v({},S(this))}function ra(){return S(this).overflow}function sa(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}B("N",0,0,"eraAbbr"),B("NN",0,0,"eraAbbr"),B("NNN",0,0,"eraAbbr"),B("NNNN",0,0,"eraName"),B("NNNNN",0,0,"eraNarrow"),B("y",["y",1],"yo","eraYear"),B("y",["yy",2],0,"eraYear"),B("y",["yyy",3],0,"eraYear"),B("y",["yyyy",4],0,"eraYear"),Oe("N",er),Oe("NN",er),Oe("NNN",er),Oe("NNNN",pa),Oe("NNNNN",va),Je(["N","NN","NNN","NNNN","NNNNN"],function(p,w,C,M){var N=C._locale.erasParse(p,M,C._strict);N?S(C).era=N:S(C).invalidEra=p}),Oe("y",Me),Oe("yy",Me),Oe("yyy",Me),Oe("yyyy",Me),Oe("yo",wa),Je(["y","yy","yyy","yyyy"],vt),Je(["yo"],function(p,w,C,M){var N;C._locale._eraYearOrdinalRegex&&(N=p.match(C._locale._eraYearOrdinalRegex)),C._locale.eraYearOrdinalParse?w[vt]=C._locale.eraYearOrdinalParse(p,N):w[vt]=parseInt(p,10)});function oa(p,w){var C,M,N,J=this._eras||Gt("en")._eras;for(C=0,M=J.length;C<M;++C){switch(typeof J[C].since){case"string":N=r(J[C].since).startOf("day"),J[C].since=N.valueOf();break}switch(typeof J[C].until){case"undefined":J[C].until=1/0;break;case"string":N=r(J[C].until).startOf("day").valueOf(),J[C].until=N.valueOf();break}}return J}function aa(p,w,C){var M,N,J=this.eras(),ge,He,Ue;for(p=p.toUpperCase(),M=0,N=J.length;M<N;++M)if(ge=J[M].name.toUpperCase(),He=J[M].abbr.toUpperCase(),Ue=J[M].narrow.toUpperCase(),C)switch(w){case"N":case"NN":case"NNN":if(He===p)return J[M];break;case"NNNN":if(ge===p)return J[M];break;case"NNNNN":if(Ue===p)return J[M];break}else if([ge,He,Ue].indexOf(p)>=0)return J[M]}function la(p,w){var C=p.since<=p.until?1:-1;return w===void 0?r(p.since).year():r(p.since).year()+(w-p.offset)*C}function ca(){var p,w,C,M=this.localeData().eras();for(p=0,w=M.length;p<w;++p)if(C=this.clone().startOf("day").valueOf(),M[p].since<=C&&C<=M[p].until||M[p].until<=C&&C<=M[p].since)return M[p].name;return""}function ua(){var p,w,C,M=this.localeData().eras();for(p=0,w=M.length;p<w;++p)if(C=this.clone().startOf("day").valueOf(),M[p].since<=C&&C<=M[p].until||M[p].until<=C&&C<=M[p].since)return M[p].narrow;return""}function ha(){var p,w,C,M=this.localeData().eras();for(p=0,w=M.length;p<w;++p)if(C=this.clone().startOf("day").valueOf(),M[p].since<=C&&C<=M[p].until||M[p].until<=C&&C<=M[p].since)return M[p].abbr;return""}function da(){var p,w,C,M,N=this.localeData().eras();for(p=0,w=N.length;p<w;++p)if(C=N[p].since<=N[p].until?1:-1,M=this.clone().startOf("day").valueOf(),N[p].since<=M&&M<=N[p].until||N[p].until<=M&&M<=N[p].since)return(this.year()-r(N[p].since).year())*C+N[p].offset;return this.year()}function fa(p){return u(this,"_erasNameRegex")||tr.call(this),p?this._erasNameRegex:this._erasRegex}function ma(p){return u(this,"_erasAbbrRegex")||tr.call(this),p?this._erasAbbrRegex:this._erasRegex}function ga(p){return u(this,"_erasNarrowRegex")||tr.call(this),p?this._erasNarrowRegex:this._erasRegex}function er(p,w){return w.erasAbbrRegex(p)}function pa(p,w){return w.erasNameRegex(p)}function va(p,w){return w.erasNarrowRegex(p)}function wa(p,w){return w._eraYearOrdinalRegex||Me}function tr(){var p=[],w=[],C=[],M=[],N,J,ge,He,Ue,qe=this.eras();for(N=0,J=qe.length;N<J;++N)ge=et(qe[N].name),He=et(qe[N].abbr),Ue=et(qe[N].narrow),w.push(ge),p.push(He),C.push(Ue),M.push(ge),M.push(He),M.push(Ue);this._erasRegex=new RegExp("^("+M.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+w.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+p.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+C.join("|")+")","i")}B(0,["gg",2],0,function(){return this.weekYear()%100}),B(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Ci(p,w){B(0,[p,p.length],0,w)}Ci("gggg","weekYear"),Ci("ggggg","weekYear"),Ci("GGGG","isoWeekYear"),Ci("GGGGG","isoWeekYear"),Oe("G",Pe),Oe("g",Pe),Oe("GG",K,ee),Oe("gg",K,ee),Oe("GGGG",ae,W),Oe("gggg",ae,W),Oe("GGGGG",Te,j),Oe("ggggg",Te,j),fn(["gggg","ggggg","GGGG","GGGGG"],function(p,w,C,M){w[M.substr(0,2)]=Ye(p)}),fn(["gg","GG"],function(p,w,C,M){w[M]=r.parseTwoDigitYear(p)});function _a(p){return Wr.call(this,p,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function ya(p){return Wr.call(this,p,this.isoWeek(),this.isoWeekday(),1,4)}function ba(){return Ot(this.year(),1,4)}function Ca(){return Ot(this.isoWeekYear(),1,4)}function Sa(){var p=this.localeData()._week;return Ot(this.year(),p.dow,p.doy)}function Ea(){var p=this.localeData()._week;return Ot(this.weekYear(),p.dow,p.doy)}function Wr(p,w,C,M,N){var J;return p==null?rn(this,M,N).year:(J=Ot(p,M,N),w>J&&(w=J),Ta.call(this,p,w,C,M,N))}function Ta(p,w,C,M,N){var J=Un(p,w,C,M,N),ge=Pt(J.year,0,J.dayOfYear);return this.year(ge.getUTCFullYear()),this.month(ge.getUTCMonth()),this.date(ge.getUTCDate()),this}B("Q",0,"Qo","quarter"),Oe("Q",ce),Je("Q",function(p,w){w[mt]=(Ye(p)-1)*3});function xa(p){return p==null?Math.ceil((this.month()+1)/3):this.month((p-1)*3+this.month()%3)}B("D",["DD",2],"Do","date"),Oe("D",K,yt),Oe("DD",K,ee),Oe("Do",function(p,w){return p?w._dayOfMonthOrdinalParse||w._ordinalParse:w._dayOfMonthOrdinalParseLenient}),Je(["D","DD"],Rt),Je("Do",function(p,w){w[Rt]=Ye(p.match(K)[0])});var jr=Wt("Date",!0);B("DDD",["DDDD",3],"DDDo","dayOfYear"),Oe("DDD",Ie),Oe("DDDD",te),Je(["DDD","DDDD"],function(p,w,C){C._dayOfYear=Ye(p)});function Ra(p){var w=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return p==null?w:this.add(p-w,"d")}B("m",["mm",2],0,"minute"),Oe("m",K,nt),Oe("mm",K,ee),Je(["m","mm"],Tt);var Ma=Wt("Minutes",!1);B("s",["ss",2],0,"second"),Oe("s",K,nt),Oe("ss",K,ee),Je(["s","ss"],It);var ka=Wt("Seconds",!1);B("S",0,0,function(){return~~(this.millisecond()/100)}),B(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),B(0,["SSS",3],0,"millisecond"),B(0,["SSSS",4],0,function(){return this.millisecond()*10}),B(0,["SSSSS",5],0,function(){return this.millisecond()*100}),B(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),B(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),B(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),B(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),Oe("S",Ie,ce),Oe("SS",Ie,ee),Oe("SSS",Ie,te);var an,Ur;for(an="SSSS";an.length<=9;an+="S")Oe(an,Me);function Oa(p,w){w[$t]=Ye(("0."+p)*1e3)}for(an="S";an.length<=9;an+="S")Je(an,Oa);Ur=Wt("Milliseconds",!1),B("z",0,0,"zoneAbbr"),B("zz",0,0,"zoneName");function Pa(){return this._isUTC?"UTC":""}function Aa(){return this._isUTC?"Coordinated Universal Time":""}var ke=L.prototype;ke.add=Eo,ke.calendar=Po,ke.clone=Ao,ke.diff=Vo,ke.endOf=Ko,ke.format=jo,ke.from=Uo,ke.fromNow=zo,ke.to=Yo,ke.toNow=Go,ke.get=ct,ke.invalidAt=ra,ke.isAfter=Io,ke.isBefore=No,ke.isBetween=Do,ke.isSame=Lo,ke.isSameOrAfter=Ho,ke.isSameOrBefore=Fo,ke.isValid=na,ke.lang=Hr,ke.locale=Lr,ke.localeData=Fr,ke.max=eo,ke.min=Qs,ke.parsingFlags=ia,ke.set=gn,ke.startOf=qo,ke.subtract=To,ke.toArray=Qo,ke.toObject=ea,ke.toDate=Jo,ke.toISOString=$o,ke.inspect=Wo,typeof Symbol<"u"&&Symbol.for!=null&&(ke[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),ke.toJSON=ta,ke.toString=Bo,ke.unix=Xo,ke.valueOf=Zo,ke.creationData=sa,ke.eraName=ca,ke.eraNarrow=ua,ke.eraAbbr=ha,ke.eraYear=da,ke.year=En,ke.isLeapYear=gt,ke.weekYear=_a,ke.isoWeekYear=ya,ke.quarter=ke.quarters=xa,ke.month=Wn,ke.daysInMonth=oi,ke.week=ke.weeks=sn,ke.isoWeek=ke.isoWeeks=zn,ke.weeksInYear=Sa,ke.weeksInWeekYear=Ea,ke.isoWeeksInYear=ba,ke.isoWeeksInISOWeekYear=Ca,ke.date=jr,ke.day=ke.days=qn,ke.weekday=Ui,ke.isoWeekday=Mt,ke.dayOfYear=Ra,ke.hour=ke.hours=zi,ke.minute=ke.minutes=Ma,ke.second=ke.seconds=ka,ke.millisecond=ke.milliseconds=Ur,ke.utcOffset=uo,ke.utc=fo,ke.local=mo,ke.parseZone=go,ke.hasAlignedHourOffset=po,ke.isDST=vo,ke.isLocal=_o,ke.isUtcOffset=yo,ke.isUtc=Pr,ke.isUTC=Pr,ke.zoneAbbr=Pa,ke.zoneName=Aa,ke.dates=$("dates accessor is deprecated. Use date instead.",jr),ke.months=$("months accessor is deprecated. Use month instead",Wn),ke.years=$("years accessor is deprecated. Use year instead",En),ke.zone=$("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",ho),ke.isDSTShifted=$("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",wo);function Ia(p){return tt(p*1e3)}function Na(){return tt.apply(null,arguments).parseZone()}function zr(p){return p}var Ze=pe.prototype;Ze.calendar=Le,Ze.longDateFormat=fe,Ze.invalidDate=Ne,Ze.ordinal=Be,Ze.preparse=zr,Ze.postformat=zr,Ze.relativeTime=We,Ze.pastFuture=$e,Ze.set=_e,Ze.eras=oa,Ze.erasParse=aa,Ze.erasConvertYear=la,Ze.erasAbbrRegex=ma,Ze.erasNameRegex=fa,Ze.erasNarrowRegex=ga,Ze.months=Bn,Ze.monthsShort=$n,Ze.monthsParse=Tn,Ze.monthsRegex=jn,Ze.monthsShortRegex=Vi,Ze.week=ai,Ze.firstDayOfYear=Nt,Ze.firstDayOfWeek=Rn,Ze.weekdays=Gn,Ze.weekdaysMin=hi,Ze.weekdaysShort=ui,Ze.weekdaysParse=Mn,Ze.weekdaysRegex=kn,Ze.weekdaysShortRegex=di,Ze.weekdaysMinRegex=fi,Ze.isPM=mi,Ze.meridiem=Fe;function Si(p,w,C,M){var N=Gt(),J=_().set(M,w);return N[C](J,p)}function Yr(p,w,C){if(f(p)&&(w=p,p=void 0),p=p||"",w!=null)return Si(p,w,C,"month");var M,N=[];for(M=0;M<12;M++)N[M]=Si(p,M,C,"month");return N}function nr(p,w,C,M){typeof p=="boolean"?(f(w)&&(C=w,w=void 0),w=w||""):(w=p,C=w,p=!1,f(w)&&(C=w,w=void 0),w=w||"");var N=Gt(),J=p?N._week.dow:0,ge,He=[];if(C!=null)return Si(w,(C+J)%7,M,"day");for(ge=0;ge<7;ge++)He[ge]=Si(w,(ge+J)%7,M,"day");return He}function Da(p,w){return Yr(p,w,"months")}function La(p,w){return Yr(p,w,"monthsShort")}function Ha(p,w,C){return nr(p,w,C,"weekdays")}function Fa(p,w,C){return nr(p,w,C,"weekdaysShort")}function Va(p,w,C){return nr(p,w,C,"weekdaysMin")}At("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(p){var w=p%10,C=Ye(p%100/10)===1?"th":w===1?"st":w===2?"nd":w===3?"rd":"th";return p+C}}),r.lang=$("moment.lang is deprecated. Use moment.locale instead.",At),r.langData=$("moment.langData is deprecated. Use moment.localeData instead.",Gt);var qt=Math.abs;function Ba(){var p=this._data;return this._milliseconds=qt(this._milliseconds),this._days=qt(this._days),this._months=qt(this._months),p.milliseconds=qt(p.milliseconds),p.seconds=qt(p.seconds),p.minutes=qt(p.minutes),p.hours=qt(p.hours),p.months=qt(p.months),p.years=qt(p.years),this}function Gr(p,w,C,M){var N=Ht(w,C);return p._milliseconds+=M*N._milliseconds,p._days+=M*N._days,p._months+=M*N._months,p._bubble()}function $a(p,w){return Gr(this,p,w,1)}function Wa(p,w){return Gr(this,p,w,-1)}function qr(p){return p<0?Math.floor(p):Math.ceil(p)}function ja(){var p=this._milliseconds,w=this._days,C=this._months,M=this._data,N,J,ge,He,Ue;return p>=0&&w>=0&&C>=0||p<=0&&w<=0&&C<=0||(p+=qr(ir(C)+w)*864e5,w=0,C=0),M.milliseconds=p%1e3,N=dt(p/1e3),M.seconds=N%60,J=dt(N/60),M.minutes=J%60,ge=dt(J/60),M.hours=ge%24,w+=dt(ge/24),Ue=dt(Kr(w)),C+=Ue,w-=qr(ir(Ue)),He=dt(C/12),C%=12,M.days=w,M.months=C,M.years=He,this}function Kr(p){return p*4800/146097}function ir(p){return p*146097/4800}function Ua(p){if(!this.isValid())return NaN;var w,C,M=this._milliseconds;if(p=F(p),p==="month"||p==="quarter"||p==="year")switch(w=this._days+M/864e5,C=this._months+Kr(w),p){case"month":return C;case"quarter":return C/3;case"year":return C/12}else switch(w=this._days+Math.round(ir(this._months)),p){case"week":return w/7+M/6048e5;case"day":return w+M/864e5;case"hour":return w*24+M/36e5;case"minute":return w*1440+M/6e4;case"second":return w*86400+M/1e3;case"millisecond":return Math.floor(w*864e5)+M;default:throw new Error("Unknown unit "+p)}}function Kt(p){return function(){return this.as(p)}}var Zr=Kt("ms"),za=Kt("s"),Ya=Kt("m"),Ga=Kt("h"),qa=Kt("d"),Ka=Kt("w"),Za=Kt("M"),Xa=Kt("Q"),Ja=Kt("y"),Qa=Zr;function el(){return Ht(this)}function tl(p){return p=F(p),this.isValid()?this[p+"s"]():NaN}function bn(p){return function(){return this.isValid()?this._data[p]:NaN}}var nl=bn("milliseconds"),il=bn("seconds"),rl=bn("minutes"),sl=bn("hours"),ol=bn("days"),al=bn("months"),ll=bn("years");function cl(){return dt(this.days()/7)}var Zt=Math.round,Nn={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function ul(p,w,C,M,N){return N.relativeTime(w||1,!!C,p,M)}function hl(p,w,C,M){var N=Ht(p).abs(),J=Zt(N.as("s")),ge=Zt(N.as("m")),He=Zt(N.as("h")),Ue=Zt(N.as("d")),qe=Zt(N.as("M")),xt=Zt(N.as("w")),Xt=Zt(N.as("y")),ln=J<=C.ss&&["s",J]||J<C.s&&["ss",J]||ge<=1&&["m"]||ge<C.m&&["mm",ge]||He<=1&&["h"]||He<C.h&&["hh",He]||Ue<=1&&["d"]||Ue<C.d&&["dd",Ue];return C.w!=null&&(ln=ln||xt<=1&&["w"]||xt<C.w&&["ww",xt]),ln=ln||qe<=1&&["M"]||qe<C.M&&["MM",qe]||Xt<=1&&["y"]||["yy",Xt],ln[2]=w,ln[3]=+p>0,ln[4]=M,ul.apply(null,ln)}function dl(p){return p===void 0?Zt:typeof p=="function"?(Zt=p,!0):!1}function fl(p,w){return Nn[p]===void 0?!1:w===void 0?Nn[p]:(Nn[p]=w,p==="s"&&(Nn.ss=w-1),!0)}function ml(p,w){if(!this.isValid())return this.localeData().invalidDate();var C=!1,M=Nn,N,J;return typeof p=="object"&&(w=p,p=!1),typeof p=="boolean"&&(C=p),typeof w=="object"&&(M=Object.assign({},Nn,w),w.s!=null&&w.ss==null&&(M.ss=w.s-1)),N=this.localeData(),J=hl(this,!C,M,N),C&&(J=N.pastFuture(+this,J)),N.postformat(J)}var rr=Math.abs;function Dn(p){return(p>0)-(p<0)||+p}function Ei(){if(!this.isValid())return this.localeData().invalidDate();var p=rr(this._milliseconds)/1e3,w=rr(this._days),C=rr(this._months),M,N,J,ge,He=this.asSeconds(),Ue,qe,xt,Xt;return He?(M=dt(p/60),N=dt(M/60),p%=60,M%=60,J=dt(C/12),C%=12,ge=p?p.toFixed(3).replace(/\.?0+$/,""):"",Ue=He<0?"-":"",qe=Dn(this._months)!==Dn(He)?"-":"",xt=Dn(this._days)!==Dn(He)?"-":"",Xt=Dn(this._milliseconds)!==Dn(He)?"-":"",Ue+"P"+(J?qe+J+"Y":"")+(C?qe+C+"M":"")+(w?xt+w+"D":"")+(N||M||p?"T":"")+(N?Xt+N+"H":"")+(M?Xt+M+"M":"")+(p?Xt+ge+"S":"")):"P0D"}var Ke=vi.prototype;Ke.isValid=oo,Ke.abs=Ba,Ke.add=$a,Ke.subtract=Wa,Ke.as=Ua,Ke.asMilliseconds=Zr,Ke.asSeconds=za,Ke.asMinutes=Ya,Ke.asHours=Ga,Ke.asDays=qa,Ke.asWeeks=Ka,Ke.asMonths=Za,Ke.asQuarters=Xa,Ke.asYears=Ja,Ke.valueOf=Qa,Ke._bubble=ja,Ke.clone=el,Ke.get=tl,Ke.milliseconds=nl,Ke.seconds=il,Ke.minutes=rl,Ke.hours=sl,Ke.days=ol,Ke.weeks=cl,Ke.months=al,Ke.years=ll,Ke.humanize=ml,Ke.toISOString=Ei,Ke.toString=Ei,Ke.toJSON=Ei,Ke.locale=Lr,Ke.localeData=Fr,Ke.toIsoString=$("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Ei),Ke.lang=Hr,B("X",0,0,"unix"),B("x",0,0,"valueOf"),Oe("x",Pe),Oe("X",ut),Je("X",function(p,w,C){C._d=new Date(parseFloat(p)*1e3)}),Je("x",function(p,w,C){C._d=new Date(Ye(p))});//! moment.js
return r.version="2.30.1",o(tt),r.fn=ke,r.min=no,r.max=io,r.now=ro,r.utc=_,r.unix=Ia,r.months=Da,r.isDate=m,r.locale=At,r.invalid=I,r.duration=Ht,r.isMoment=V,r.weekdays=Ha,r.parseZone=Na,r.localeData=Gt,r.isDuration=wi,r.monthsShort=La,r.weekdaysMin=Va,r.defineLocale=On,r.updateLocale=Er,r.locales=Is,r.weekdaysShort=Fa,r.normalizeUnits=F,r.relativeTimeRounding=dl,r.relativeTimeThreshold=fl,r.calendarFormat=Oo,r.prototype=ke,r.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},r})}}),array_exports={};__export(array_exports,{arrayAvg:()=>arrayAvg,arrayEach:()=>arrayEach$1,arrayFilter:()=>arrayFilter$1,arrayFlatten:()=>arrayFlatten,arrayMap:()=>arrayMap$1,arrayMax:()=>arrayMax,arrayMin:()=>arrayMin,arrayReduce:()=>arrayReduce,arraySum:()=>arraySum,arrayUnique:()=>arrayUnique,extendArray:()=>extendArray,getDifferenceOfArrays:()=>getDifferenceOfArrays,getIntersectionOfArrays:()=>getIntersectionOfArrays,getUnionOfArrays:()=>getUnionOfArrays,pivot:()=>pivot,stringToArray:()=>stringToArray,to2dArray:()=>to2dArray});var import_es_array_push$110=__toESM(require_es_array_push(),1),import_es_set_difference_v2$26=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$26=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$26=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$26=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$26=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$26=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$26=__toESM(require_es_set_union_v2(),1);function to2dArray(e){const t=e.length;let i=0;for(;i<t;)e[i]=[e[i]],i+=1}function extendArray(e,t){const i=t.length;let r=0;for(;r<i;)e.push(t[r]),r+=1}function pivot(e){const t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;const i=e.length,r=e[0].length;for(let o=0;o<i;o++)for(let a=0;a<r;a++)t[a]||(t[a]=[]),t[a][o]=e[o][a];return t}function arrayReduce(e,t,i,r){let o=-1,a=e,c=i;Array.isArray(e)||(a=Array.from(e));const u=a.length;for(r&&u&&(o+=1,c=a[o]),o+=1;o<u;)c=t(c,a[o],o,a),o+=1;return c}function arrayFilter$1(e,t){let i=0,r=e;Array.isArray(e)||(r=Array.from(e));const o=r.length,a=[];let c=-1;for(;i<o;){const u=r[i];t(u,i,r)&&(c+=1,a[c]=u),i+=1}return a}function arrayMap$1(e,t){let i=0,r=e;Array.isArray(e)||(r=Array.from(e));const o=r.length,a=[];let c=-1;for(;i<o;){const u=r[i];c+=1,a[c]=t(u,i,r),i+=1}return a}function arrayEach$1(e,t){let i=0,r=e;Array.isArray(e)||(r=Array.from(e));const o=r.length;for(;i<o&&t(r[i],i,r)!==!1;)i+=1;return e}function arraySum(e){return arrayReduce(e,(t,i)=>t+i,0)}function arrayMax(e){return arrayReduce(e,(t,i)=>t>i?t:i,Array.isArray(e)?e[0]:void 0)}function arrayMin(e){return arrayReduce(e,(t,i)=>t<i?t:i,Array.isArray(e)?e[0]:void 0)}function arrayAvg(e){return e.length?arraySum(e)/e.length:0}function arrayFlatten(e){return arrayReduce(e,(t,i)=>t.concat(Array.isArray(i)?arrayFlatten(i):i),[])}function arrayUnique(e){const t=[];return arrayEach$1(e,i=>{t.indexOf(i)===-1&&t.push(i)}),t}function getDifferenceOfArrays(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const[r,...o]=[...t];let a=r;return arrayEach$1(o,c=>{a=a.filter(u=>!c.includes(u))}),a}function getIntersectionOfArrays(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const[r,...o]=[...t];let a=r;return arrayEach$1(o,c=>{a=a.filter(u=>c.includes(u))}),a}function getUnionOfArrays(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const[r,...o]=[...t],a=new Set(r);return arrayEach$1(o,c=>{arrayEach$1(c,u=>{a.has(u)||a.add(u)})}),Array.from(a)}function stringToArray(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}function toSingleLine(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return arrayReduce(e,(a,c,u)=>{const h=c.replace(/\r?\n\s*/g,""),d=i[u]?i[u]:"";return a+h+d},"").trim()}var mixed_exports={};__export(mixed_exports,{_injectProductInfo:()=>_injectProductInfo,isDefined:()=>isDefined,isEmpty:()=>isEmpty,isRegExp:()=>isRegExp$1,isUndefined:()=>isUndefined$1,stringify:()=>stringify$3});var import_moment$10=__toESM(require_moment(),1);function stringify$3(e){let t;switch(typeof e){case"string":case"number":t=`${e}`;break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function isDefined(e){return typeof e<"u"}function isUndefined$1(e){return typeof e>"u"}function isEmpty(e){return e===null||e===""||isUndefined$1(e)}function isRegExp$1(e){return Object.prototype.toString.call(e)==="[object RegExp]"}const _m="length",_hd=e=>parseInt(e,16),_pi=e=>parseInt(e,10),_ss=(e,t,i)=>e.substr(t,i),_cp=e=>e.codePointAt(0)-65,_norm=e=>`${e}`.replace(/\-/g,""),_extractTime=e=>_hd(_ss(_norm(e),_hd("12"),_cp("F")))/(_hd(_ss(_norm(e),_cp("B"),~~![][_m]))||9),_ignored=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let _notified=!1;const consoleMessages={invalid:()=>toSingleLine`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:e=>{let{keyValidityDate:t,hotVersion:i}=e;return toSingleLine`
    The license key for Handsontable expired on ${t}, and is not valid for the installed\x20
    version ${i}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${t}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>toSingleLine`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},domMessages={invalid:()=>toSingleLine`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:e=>{let{keyValidityDate:t,hotVersion:i}=e;return toSingleLine`
    The license key for Handsontable expired on ${t}, and is not valid for the installed\x20
    version ${i}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${t}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>toSingleLine`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function _injectProductInfo(e,t){const i=!isEmpty(e),r=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",o="14.6.1";let a,c="invalid",u="invalid";e=_norm(e||"");const h=_checkKeySchema(e);if(i||r||h)if(h){const d=(0,import_moment$10.default)("17/10/2024","DD/MM/YYYY"),f=Math.floor(d.toDate().getTime()/864e5),m=_extractTime(e);a=(0,import_moment$10.default)((m+1)*864e5,"x").format("MMMM DD, YYYY"),f>m?(c="expired",u="expired"):(c="valid",u="valid")}else r?(c="non_commercial",u="valid"):(c="invalid",u="invalid");else c="missing",u="missing";if(_ignored()&&(c="valid",u="valid"),!_notified&&c!=="valid"&&(consoleMessages[c]({keyValidityDate:a,hotVersion:o})&&console[c==="non_commercial"?"info":"warn"](consoleMessages[c]({keyValidityDate:a,hotVersion:o})),_notified=!0),u!=="valid"&&t.parentNode&&domMessages[u]({keyValidityDate:a,hotVersion:o})){const f=document.createElement("div");f.className="hot-display-license-info",f.innerHTML=domMessages[u]({keyValidityDate:a,hotVersion:o}),t.parentNode.insertBefore(f,t.nextSibling)}}function _checkKeySchema(e){let t=[][_m],i=t;if(e[_m]!==_cp("Z"))return!1;for(let r="",o="B<H4P+".split(""),a=_cp(o.shift());a;a=_cp(o.shift()||"A"))--a<""[_m]?i=i|(_pi(`${_pi(_hd(r)+(_hd(_ss(e,Math.abs(a),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=_ss(e,a,a?o[_m]===1?9:8:6);return i===t}var string_exports={};__export(string_exports,{equalsIgnoreCase:()=>equalsIgnoreCase,isPercentValue:()=>isPercentValue,randomString:()=>randomString,sanitize:()=>sanitize,stripTags:()=>stripTags,substitute:()=>substitute,toUpperCaseFirst:()=>toUpperCaseFirst});var import_es_array_push$109=__toESM(require_es_array_push(),1),import_purify=__toESM(require_purify(),1);function toUpperCaseFirst(e){return e[0].toUpperCase()+e.substr(1)}function equalsIgnoreCase(){const e=[];for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];let o=i.length;for(;o;){o-=1;const a=stringify$3(i[o]).toLowerCase();e.indexOf(a)===-1&&e.push(a)}return e.length===1}function randomString(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function isPercentValue(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function substitute(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${e}`.replace(/(?:\\)?\[([^[\]]+)]/g,(i,r)=>i.charAt(0)==="\\"?i.substr(1,i.length-1):t[r]===void 0?"":t[r])}function stripTags(e){return sanitize(`${e}`,{ALLOWED_TAGS:[]})}function sanitize(e,t){return import_purify.default.sanitize(e,t)}const A11Y_TABINDEX=e=>["tabindex",e],A11Y_TREEGRID=()=>["role","treegrid"],A11Y_PRESENTATION=()=>["role","presentation"],A11Y_GRIDCELL=()=>["role","gridcell"],A11Y_ROWHEADER=()=>["role","rowheader"],A11Y_ROWGROUP=()=>["role","rowgroup"],A11Y_COLUMNHEADER=()=>["role","columnheader"],A11Y_ROW=()=>["role","row"],A11Y_MENU=()=>["role","menu"],A11Y_MENU_ITEM=()=>["role","menuitem"],A11Y_MENU_ITEM_CHECKBOX=()=>["role","menuitemcheckbox"],A11Y_COMBOBOX=()=>["role","combobox"],A11Y_LISTBOX=()=>["role","listbox"],A11Y_OPTION=()=>["role","option"],A11Y_CHECKBOX=()=>["role","checkbox"],A11Y_SCOPE_COL=()=>["scope","col"],A11Y_SCOPE_ROW=()=>["scope","row"],A11Y_TEXT=()=>["type","text"],A11Y_LABEL=e=>["aria-label",e],A11Y_HIDDEN=()=>["aria-hidden","true"],A11Y_DISABLED=()=>["aria-disabled","true"],A11Y_MULTISELECTABLE=()=>["aria-multiselectable","true"],A11Y_HASPOPUP=e=>["aria-haspopup",e],A11Y_ROWCOUNT=e=>["aria-rowcount",e],A11Y_COLCOUNT=e=>["aria-colcount",e],A11Y_ROWINDEX=e=>["aria-rowindex",e],A11Y_COLINDEX=e=>["aria-colindex",e],A11Y_EXPANDED=e=>["aria-expanded",e],A11Y_SORT=e=>["aria-sort",e],A11Y_READONLY=()=>["aria-readonly","true"],A11Y_INVALID=()=>["aria-invalid","true"],A11Y_CHECKED=e=>["aria-checked",e],A11Y_SELECTED=()=>["aria-selected","true"],A11Y_AUTOCOMPLETE=()=>["aria-autocomplete","list"],A11Y_CONTROLS=e=>["aria-controls",e],A11Y_ACTIVEDESCENDANT=e=>["aria-activedescendant",e],A11Y_LIVE=e=>["aria-live",e],A11Y_RELEVANT=e=>["aria-relevant",e],A11Y_SETSIZE=e=>["aria-setsize",e],A11Y_POSINSET=e=>["aria-posinset",e];var element_exports={};__export(element_exports,{HTML_CHARACTERS:()=>HTML_CHARACTERS,addClass:()=>addClass$1,addEvent:()=>addEvent$1,clearTextSelection:()=>clearTextSelection,closest:()=>closest,closestDown:()=>closestDown,empty:()=>empty,fastInnerHTML:()=>fastInnerHTML,fastInnerText:()=>fastInnerText,getCaretPosition:()=>getCaretPosition,getComputedStyle:()=>getComputedStyle$3,getCssTransform:()=>getCssTransform,getFrameElement:()=>getFrameElement,getMaximumScrollLeft:()=>getMaximumScrollLeft,getMaximumScrollTop:()=>getMaximumScrollTop,getParent:()=>getParent,getParentWindow:()=>getParentWindow,getScrollLeft:()=>getScrollLeft,getScrollTop:()=>getScrollTop,getScrollableElement:()=>getScrollableElement,getScrollbarWidth:()=>getScrollbarWidth,getSelectionEndPosition:()=>getSelectionEndPosition,getSelectionText:()=>getSelectionText,getStyle:()=>getStyle,getTrimmingContainer:()=>getTrimmingContainer,getWindowScrollLeft:()=>getWindowScrollLeft,getWindowScrollTop:()=>getWindowScrollTop,hasAccessToParentWindow:()=>hasAccessToParentWindow,hasClass:()=>hasClass$1,hasHorizontalScrollbar:()=>hasHorizontalScrollbar,hasVerticalScrollbar:()=>hasVerticalScrollbar,index:()=>index,innerHeight:()=>innerHeight,innerWidth:()=>innerWidth,isChildOf:()=>isChildOf,isDetached:()=>isDetached,isInput:()=>isInput,isOutsideInput:()=>isOutsideInput,isThisHotChild:()=>isThisHotChild,isVisible:()=>isVisible$1,makeElementContentEditableAndSelectItsContent:()=>makeElementContentEditableAndSelectItsContent,matchesCSSRules:()=>matchesCSSRules,observeVisibilityChangeOnce:()=>observeVisibilityChangeOnce,offset:()=>offset$2,outerHeight:()=>outerHeight,outerWidth:()=>outerWidth,overlayContainsElement:()=>overlayContainsElement,removeAttribute:()=>removeAttribute,removeClass:()=>removeClass$1,removeContentEditableFromElementAndDeselect:()=>removeContentEditableFromElementAndDeselect,removeEvent:()=>removeEvent$1,removeTextNodes:()=>removeTextNodes,resetCssTransform:()=>resetCssTransform,runWithSelectedContendEditableElement:()=>runWithSelectedContendEditableElement,selectElementIfAllowed:()=>selectElementIfAllowed,setAttribute:()=>setAttribute,setCaretPosition:()=>setCaretPosition,setOverlayPosition:()=>setOverlayPosition});var import_es_error_cause$176=__toESM(require_es_error_cause(),1),import_es_array_push$108=__toESM(require_es_array_push(),1);function getParent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=-1,r=null,o=e;for(;o!==null;){if(i===t){r=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(i+=1,o=o.parentNode)}return r}function isThisHotChild(e,t){const i=e.closest(".handsontable");return!!i&&(i.parentNode===t||i===t)}function getFrameElement(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function getParentWindow(e){return getFrameElement(e)&&e.parent}function hasAccessToParentWindow(e){return!!Object.getPrototypeOf(e.parent)}function closest(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:o}=Node;let a=e;for(;a!=null&&a!==i;){const{nodeType:c,nodeName:u}=a;if(c===r&&(t.includes(u)||t.includes(a)))return a;const{host:h}=a;h&&c===o?a=h:a=a.parentNode}return null}function closestDown(e,t,i){const r=[];let o=e;for(;o&&(o=closest(o,t,i),!(!o||i&&!i.contains(o)));)r.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;const a=r.length;return a?r[a-1]:null}function isChildOf(e,t){let i=e.parentNode,r=[];for(typeof t=="string"?e.defaultView?r=Array.prototype.slice.call(e.querySelectorAll(t),0):r=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):r.push(t);i!==null;){if(r.indexOf(i)>-1)return!0;i=i.parentNode}return!1}function index(e){let t=0,i=e;if(i.previousSibling)for(;i=i.previousSibling;)t+=1;return t}function overlayContainsElement(e,t,i){const r=i.parentElement.querySelector(`.ht_clone_${e}`);return r?r.contains(t):null}function filterEmptyClassNames(e){return!e||!e.length?[]:e.filter(t=>!!t)}function filterRegexes(e,t){if(!e||!e.length)return t?{regexFree:[],regexes:[]}:[];const i=[],r=[];return r.push(...e.filter(o=>{const a=o instanceof RegExp;return a&&t&&i.push(o),!a})),t?{regexFree:r,regexes:i}:r}function hasClass$1(e,t){return e.classList===void 0||typeof t!="string"||t===""?!1:e.classList.contains(t)}function addClass$1(e,t){typeof t=="string"&&(t=t.split(" ")),t=filterEmptyClassNames(t),t.length>0&&e.classList.add(...t)}function removeClass$1(e,t){typeof t=="string"?t=t.split(" "):t instanceof RegExp&&(t=[t]);let{regexFree:i,regexes:r}=filterRegexes(t,!0);i=filterEmptyClassNames(i),i.length>0&&e.classList.remove(...i),r.forEach(o=>{e.classList.forEach(a=>{o.test(a)&&e.classList.remove(a)})})}function setAttribute(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;Array.isArray(t)||(t=[[t,i]]),t.forEach(r=>{Array.isArray(r)&&r[0]!==""&&e.setAttribute(...r)})}function removeAttribute(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof t=="string"?t=t.split(" "):t instanceof RegExp&&(t=[t]);const{regexFree:i,regexes:r}=filterRegexes(t,!0);i.forEach(o=>{o!==""&&e.removeAttribute(o)}),r.forEach(o=>{e.getAttributeNames().forEach(a=>{o.test(a)&&e.removeAttribute(a)})})}function removeTextNodes(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1){const t=e.childNodes;for(let i=t.length-1;i>=0;i--)removeTextNodes(t[i])}}function empty(e){let t;for(;t=e.lastChild;)e.removeChild(t)}const HTML_CHARACTERS=/(<(.*)>|&(.*);)/;function fastInnerHTML(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;HTML_CHARACTERS.test(t)?e.innerHTML=i?sanitize(t):t:fastInnerText(e,t)}function fastInnerText(e,t){const i=e.firstChild;i&&i.nodeType===3&&i.nextSibling===null?i.textContent=t:(empty(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function isVisible$1(e){const t=e.ownerDocument.documentElement;let i=e;for(;i!==t;){if(i===null)return!1;if(i.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(i.host){if(i.host.impl)return isVisible$1(i.host.impl);if(i.host)return isVisible$1(i.host);throw new Error("Lost in Web Components world")}else return!1;else if(getComputedStyle$3(i).display==="none")return!1;i=i.parentNode}return!0}function offset$2(e){const t=e.ownerDocument,i=t.defaultView,r=t.documentElement;let o=e,a,c,u;for(a=o.offsetLeft,c=o.offsetTop,u=o;(o=o.offsetParent)&&!(o===t.body||!("offsetLeft"in o));)a+=o.offsetLeft,c+=o.offsetTop,u=o;return u&&u.style.position==="fixed"&&(a+=i.pageXOffset||r.scrollLeft,c+=i.pageYOffset||r.scrollTop),{left:a,top:c}}function getWindowScrollTop(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function getWindowScrollLeft(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function getScrollTop(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?getWindowScrollTop(t):e.scrollTop}function getScrollLeft(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?getWindowScrollLeft(t):e.scrollLeft}function getScrollableElement(e){let t=e.ownerDocument,i=t?t.defaultView:void 0;t||(t=e.document?e.document:e,i=t.defaultView);const r=["auto","scroll"];let o=e.parentNode;for(;o&&o.style&&t.body!==o;){let{overflow:a,overflowX:c,overflowY:u}=o.style;if([a,c,u].includes("scroll"))return o;if({overflow:a,overflowX:c,overflowY:u}=i.getComputedStyle(o),r.includes(a)||r.includes(c)||r.includes(u)||o.clientHeight<=o.scrollHeight+1&&(r.includes(u)||r.includes(a))||o.clientWidth<=o.scrollWidth+1&&(r.includes(c)||r.includes(a)))return o;o=o.parentNode}return i}function getMaximumScrollTop(e){return e.scrollHeight-e.clientHeight}function getMaximumScrollLeft(e){return e.scrollWidth-e.clientWidth}function getTrimmingContainer(e){const t=e.ownerDocument,i=t.defaultView;let r=e.parentNode;for(;r&&r.style&&t.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const o=getComputedStyle$3(r,i),a=["scroll","hidden","auto"],c=o.getPropertyValue("overflow"),u=o.getPropertyValue("overflow-y"),h=o.getPropertyValue("overflow-x");if(a.includes(c)||a.includes(u)||a.includes(h))return r;r=r.parentNode}return i}function getStyle(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===i)return t==="width"?`${i.innerWidth}px`:t==="height"?`${i.innerHeight}px`:void 0}else return;const r=e.style[t];if(r!==""&&r!==void 0)return r;const o=getComputedStyle$3(e,i);if(o[t]!==""&&o[t]!==void 0)return o[t]}function matchesCSSRules(e,t){const{selectorText:i}=t;let r=!1;return t.type===CSSRule.STYLE_RULE&&i&&(e.msMatchesSelector?r=e.msMatchesSelector(i):e.matches&&(r=e.matches(i))),r}function getComputedStyle$3(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function outerWidth(e){return e.offsetWidth}function outerHeight(e){return e.offsetHeight}function innerHeight(e){return e.clientHeight||e.innerHeight}function innerWidth(e){return e.clientWidth||e.innerWidth}function addEvent$1(e,t,i){e.addEventListener(t,i,!1)}function removeEvent$1(e,t,i){e.removeEventListener(t,i,!1)}function getCaretPosition(e){return e.selectionStart?e.selectionStart:0}function getSelectionEndPosition(e){return e.selectionEnd?e.selectionEnd:0}function getSelectionText(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const t=e.document;let i="";return e.getSelection?i=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(i=t.selection.createRange().text),i}function clearTextSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;e.getSelection&&(e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges())}function setCaretPosition(e,t,i){if(i===void 0&&(i=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,i)}catch{const o=e.parentNode,a=o.style.display;o.style.display="block",e.setSelectionRange(t,i),o.style.display=a}}}let cachedScrollbarWidth;function walkontableCalculateScrollbarWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const t=e.createElement("div");t.style.height="200px",t.style.width="100%";const i=e.createElement("div");i.style.boxSizing="content-box",i.style.height="150px",i.style.left="0px",i.style.overflow="hidden",i.style.position="absolute",i.style.top="0px",i.style.width="200px",i.style.visibility="hidden",i.appendChild(t),(e.body||e.documentElement).appendChild(i);const r=t.offsetWidth;i.style.overflow="scroll";let o=t.offsetWidth;return r===o&&(o=i.clientWidth),(e.body||e.documentElement).removeChild(i),r-o}function getScrollbarWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return cachedScrollbarWidth===void 0&&(cachedScrollbarWidth=walkontableCalculateScrollbarWidth(e)),cachedScrollbarWidth}function hasVerticalScrollbar(e){return e.offsetWidth!==e.clientWidth}function hasHorizontalScrollbar(e){return e.offsetHeight!==e.clientHeight}function setOverlayPosition(e,t,i){e.style.transform=`translate3d(${t},${i},0)`}function getCssTransform(e){let t;return e.style.transform&&(t=e.style.transform)!==""?["transform",t]:-1}function resetCssTransform(e){e.style.transform&&e.style.transform!==""&&(e.style.transform="")}function isInput(e){return e&&(["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)>-1||e.contentEditable==="true")}function isOutsideInput(e){return isInput(e)&&e.hasAttribute("data-hot-input")===!1}function selectElementIfAllowed(e){const t=e.ownerDocument.activeElement;isOutsideInput(t)||e.select()}function isDetached(e){return!e.parentNode}function observeVisibilityChangeOnce(e,t){new IntersectionObserver((r,o)=>{r.forEach(a=>{a.isIntersecting&&e.offsetParent!==null&&(t(),o.unobserve(e))})},{root:e.ownerDocument.body}).observe(e)}function makeElementContentEditableAndSelectItsContent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=e.ownerDocument,o=r.createRange(),a=r.defaultView.getSelection();setAttribute(e,"contenteditable",!0),i&&setAttribute(e,...A11Y_HIDDEN()),t&&addClass$1(e,"invisibleSelection"),o.selectNodeContents(e),a.removeAllRanges(),a.addRange(o)}function removeContentEditableFromElementAndDeselect(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=e.ownerDocument.defaultView.getSelection();e.hasAttribute("aria-hidden")&&e.removeAttribute("aria-hidden"),i.removeAllRanges(),t&&removeClass$1(e,"invisibleSelection"),e.removeAttribute("contenteditable")}function runWithSelectedContendEditableElement(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;makeElementContentEditableAndSelectItsContent(e,i),t(),removeContentEditableFromElementAndDeselect(e,i)}var function_exports={};__export(function_exports,{curry:()=>curry,curryRight:()=>curryRight,debounce:()=>debounce$3,fastCall:()=>fastCall,isFunction:()=>isFunction$2,partial:()=>partial,pipe:()=>pipe,throttle:()=>throttle$1,throttleAfterHits:()=>throttleAfterHits});function isFunction$2(e){return typeof e=="function"}function throttle$1(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,i=0;const r={lastCallThrottled:!0};let o=null;function a(){for(var c=arguments.length,u=new Array(c),h=0;h<c;h++)u[h]=arguments[h];const d=Date.now();let f=!1;r.lastCallThrottled=!0,i||(i=d,f=!0);const m=t-(d-i);return f?(r.lastCallThrottled=!1,e.apply(this,u)):(o&&clearTimeout(o),o=setTimeout(()=>{r.lastCallThrottled=!1,e.apply(this,u),i=0,o=void 0},m)),r}return a}function throttleAfterHits(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=throttle$1(e,t);let o=i;function a(){o=i}function c(){for(var u=arguments.length,h=new Array(u),d=0;d<u;d++)h[d]=arguments[d];return o?(o-=1,e.apply(this,h)):r.apply(this,h)}return c.clearHits=a,c}function debounce$3(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,i=null,r;function o(){for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return i&&clearTimeout(i),i=setTimeout(()=>{r=e.apply(this,c)},t),r}return o}function pipe(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const[r,...o]=t;return function(){for(var c=arguments.length,u=new Array(c),h=0;h<c;h++)u[h]=arguments[h];return arrayReduce(o,(d,f)=>f(d),r.apply(this,u))}}function partial(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return function(){for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return e.apply(this,i.concat(c))}}function curry(e){const t=e.length;function i(r){return function(){for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];const h=r.concat(c);let d;return h.length>=t?d=e.apply(this,h):d=i(h),d}}return i([])}function curryRight(e){const t=e.length;function i(r){return function(){for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];const h=r.concat(c.reverse());let d;return h.length>=t?d=e.apply(this,h):d=i(h),d}}return i([])}function fastCall(e,t,i,r,o,a,c,u){return isDefined(u)?e.call(t,i,r,o,a,c,u):isDefined(c)?e.call(t,i,r,o,a,c):isDefined(a)?e.call(t,i,r,o,a):isDefined(o)?e.call(t,i,r,o):isDefined(r)?e.call(t,i,r):isDefined(i)?e.call(t,i):e.call(t)}var require_get_json_replacer_function=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/get-json-replacer-function.js"(e,t){var i=require_function_uncurry_this(),r=require_is_array(),o=require_is_callable(),a=require_classof_raw(),c=require_to_string(),u=i([].push);t.exports=function(h){if(o(h))return h;if(r(h)){for(var d=h.length,f=[],m=0;m<d;m++){var g=h[m];typeof g=="string"?u(f,g):(typeof g=="number"||a(g)==="Number"||a(g)==="String")&&u(f,c(g))}var v=f.length,_=!0;return function(b,S){if(_)return _=!1,S;if(r(this))return S;for(var T=0;T<v;T++)if(f[T]===b)return S}}}}}),require_es_json_stringify=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.json.stringify.js"(){var e=require_export(),t=require_get_built_in(),i=require_function_apply(),r=require_function_call(),o=require_function_uncurry_this(),a=require_fails(),c=require_is_callable(),u=require_is_symbol(),h=require_array_slice(),d=require_get_json_replacer_function(),f=require_symbol_constructor_detection(),m=String,g=t("JSON","stringify"),v=o(/./.exec),_=o("".charAt),b=o("".charCodeAt),S=o("".replace),T=o(1 .toString),A=/[\uD800-\uDFFF]/g,I=/^[\uD800-\uDBFF]$/,R=/^[\uDC00-\uDFFF]$/,O=!f||a(function(){var U=t("Symbol")("stringify detection");return g([U])!=="[null]"||g({a:U})!=="{}"||g(Object(U))!=="{}"}),P=a(function(){return g("\\udf06\\ud834")!=='"\\udf06\\ud834"'||g("\\udead")!=='"\\udead"'}),L=function(U,$){var Z=h(arguments),ie=d($);if(!(!c(ie)&&(U===void 0||u(U))))return Z[1]=function(ue,_e){if(c(ie)&&(_e=r(ie,this,m(ue),_e)),!u(_e))return _e},i(g,null,Z)},V=function(U,$,Z){var ie=_(Z,$-1),ue=_(Z,$+1);return v(I,U)&&!v(R,ue)||v(R,U)&&!v(I,ie)?"\\u"+T(b(U,0),16):U};g&&e({target:"JSON",stat:!0,arity:3,forced:O||P},{stringify:function($,Z,ie){var ue=h(arguments),_e=i(O?L:g,null,ue);return P&&typeof _e=="string"?S(_e,A,V):_e}})}}),object_exports={};__export(object_exports,{clone:()=>clone$4,createObjectPropListener:()=>createObjectPropListener,deepClone:()=>deepClone,deepExtend:()=>deepExtend,deepObjectSize:()=>deepObjectSize,defineGetter:()=>defineGetter,duckSchema:()=>duckSchema,extend:()=>extend$2,getProperty:()=>getProperty,hasOwnProperty:()=>hasOwnProperty$15,inherit:()=>inherit$1,isObject:()=>isObject$4,isObjectEqual:()=>isObjectEqual,mixin:()=>mixin,objectEach:()=>objectEach,setProperty:()=>setProperty});var import_es_error_cause$175=__toESM(require_es_error_cause(),1),import_es_array_push$107=__toESM(require_es_array_push(),1),import_es_json_stringify$2=__toESM(require_es_json_stringify(),1);function duckSchema(e){let t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},objectEach(e,(i,r)=>{r!=="__children"&&(i&&typeof i=="object"&&!Array.isArray(i)?t[r]=duckSchema(i):Array.isArray(i)?i.length&&typeof i[0]=="object"&&!Array.isArray(i[0])?t[r]=[duckSchema(i[0])]:t[r]=[]:t[r]=null)})),t}function inherit$1(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function extend$2(e,t,i){const r=Array.isArray(i);return objectEach(t,(o,a)=>{(r===!1||i.includes(a))&&(e[a]=o)}),e}function deepExtend(e,t){objectEach(t,(i,r)=>{t[r]&&typeof t[r]=="object"?(e[r]||(Array.isArray(t[r])?e[r]=[]:Object.prototype.toString.call(t[r])==="[object Date]"?e[r]=t[r]:e[r]={}),deepExtend(e[r],t[r])):e[r]=t[r]})}function deepClone(e){return typeof e=="object"?JSON.parse(JSON.stringify(e)):e}function clone$4(e){const t={};return objectEach(e,(i,r)=>{t[r]=i}),t}function mixin(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return arrayEach$1(i,o=>{e.MIXINS.push(o.MIXIN_NAME),objectEach(o,(a,c)=>{if(e.prototype[c]!==void 0)throw new Error(`Mixin conflict. Property '${c}' already exist and cannot be overwritten.`);if(typeof a=="function")e.prototype[c]=a;else{const u=function(f,m){const g=`_${f}`,v=_=>{let b=_;return(Array.isArray(b)||isObject$4(b))&&(b=deepClone(b)),b};return function(){return this[g]===void 0&&(this[g]=v(m)),this[g]}},h=function(f){const m=`_${f}`;return function(g){this[m]=g}};Object.defineProperty(e.prototype,c,{get:u(c,a),set:h(c),configurable:!0})}})}),e}function isObjectEqual(e,t){return JSON.stringify(e)===JSON.stringify(t)}function isObject$4(e){return Object.prototype.toString.call(e)==="[object Object]"}function defineGetter(e,t,i,r){r.value=i,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(e,t,r)}function objectEach(e,t){for(const i in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,i))&&t(e[i],i,e)===!1)break;return e}function getProperty(e,t){const i=t.split(".");let r=e;return objectEach(i,o=>{if(r=r[o],r===void 0)return r=void 0,!1}),r}function setProperty(e,t,i){const r=t.split(".");let o=e;r.forEach((a,c)=>{c!==r.length-1?(hasOwnProperty$15(o,a)||(o[a]={}),o=o[a]):o[a]=i})}function deepObjectSize(e){if(!isObject$4(e))return 0;const t=function(i){let r=0;return isObject$4(i)?objectEach(i,(o,a)=>{a!=="__children"&&(r+=t(o))}):r+=1,r};return t(e)}function createObjectPropListener(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const i=`_${t}`,r={_touched:!1,[i]:e,isTouched(){return this._touched}};return Object.defineProperty(r,t,{get(){return this[i]},set(o){this._touched=!0,this[i]=o},enumerable:!0,configurable:!0}),r}function hasOwnProperty$15(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var feature_exports={};__export(feature_exports,{cancelAnimationFrame:()=>cancelAnimationFrame$1,getComparisonFunction:()=>getComparisonFunction,isCSR:()=>isCSR,isTouchSupported:()=>isTouchSupported,requestAnimationFrame:()=>requestAnimationFrame$1});function requestAnimationFrame$1(e){return window.requestAnimationFrame(e)}function cancelAnimationFrame$1(e){window.cancelAnimationFrame(e)}function isTouchSupported(){return"ontouchstart"in window}function isCSR(){return typeof window<"u"}let comparisonFunction;function getComparisonFunction(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return comparisonFunction||(typeof Intl=="object"?comparisonFunction=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?comparisonFunction=(i,r)=>`${i}`.localeCompare(r):comparisonFunction=(i,r)=>i===r?0:i>r?-1:1,comparisonFunction)}var browser_exports={};__export(browser_exports,{isChrome:()=>isChrome,isChromeWebKit:()=>isChromeWebKit,isEdge:()=>isEdge,isEdgeWebKit:()=>isEdgeWebKit,isFirefox:()=>isFirefox,isFirefoxWebKit:()=>isFirefoxWebKit,isIOS:()=>isIOS,isIpadOS:()=>isIpadOS,isLinuxOS:()=>isLinuxOS,isMacOS:()=>isMacOS,isMobileBrowser:()=>isMobileBrowser,isSafari:()=>isSafari$1,isWindowsOS:()=>isWindowsOS,setBrowserMeta:()=>setBrowserMeta,setPlatformMeta:()=>setPlatformMeta});const tester=e=>{const t={value:!1};return t.test=(i,r)=>{t.value=e(i,r)},t},browsers={chrome:tester((e,t)=>/Chrome/.test(e)&&/Google/.test(t)),chromeWebKit:tester(e=>/CriOS/.test(e)),edge:tester(e=>/Edge/.test(e)),edgeWebKit:tester(e=>/EdgiOS/.test(e)),firefox:tester(e=>/Firefox/.test(e)),firefoxWebKit:tester(e=>/FxiOS/.test(e)),mobile:tester(e=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)),safari:tester((e,t)=>/Safari/.test(e)&&/Apple Computer/.test(t))},platforms={mac:tester(e=>/^Mac/.test(e)),win:tester(e=>/^Win/.test(e)),linux:tester(e=>/^Linux/.test(e)),ios:tester(e=>/iPhone|iPad|iPod/i.test(e))};function setBrowserMeta(){let{userAgent:e=navigator.userAgent,vendor:t=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};objectEach(browsers,i=>{let{test:r}=i;return void r(e,t)})}function setPlatformMeta(){let{platform:e=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};objectEach(platforms,t=>{let{test:i}=t;return void i(e)})}isCSR()&&(setBrowserMeta(),setPlatformMeta());function isChrome(){return browsers.chrome.value}function isChromeWebKit(){return browsers.chromeWebKit.value}function isFirefox(){return browsers.firefox.value}function isFirefoxWebKit(){return browsers.firefoxWebKit.value}function isSafari$1(){return browsers.safari.value}function isEdge(){return browsers.edge.value}function isEdgeWebKit(){return browsers.edgeWebKit.value}function isMobileBrowser(){return browsers.mobile.value}function isIOS(){return platforms.ios.value}function isIpadOS(){let{maxTouchPoints:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return e>2&&platforms.mac.value}function isWindowsOS(){return platforms.win.value}function isMacOS(){return platforms.mac.value}function isLinuxOS(){return platforms.linux.value}var unicode_exports={};__export(unicode_exports,{KEY_CODES:()=>KEY_CODES,isCtrlKey:()=>isCtrlKey,isCtrlMetaKey:()=>isCtrlMetaKey,isFunctionKey:()=>isFunctionKey,isKey:()=>isKey$1,isPrintableChar:()=>isPrintableChar});var import_es_array_push$106=__toESM(require_es_array_push(),1);const KEY_CODES={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:isFirefox()?182:174,AUDIO_MUTE:isFirefox()?181:173,AUDIO_UP:isFirefox()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},FUNCTION_KEYS=[KEY_CODES.ALT,KEY_CODES.ARROW_DOWN,KEY_CODES.ARROW_LEFT,KEY_CODES.ARROW_RIGHT,KEY_CODES.ARROW_UP,KEY_CODES.AUDIO_DOWN,KEY_CODES.AUDIO_MUTE,KEY_CODES.AUDIO_UP,KEY_CODES.BACKSPACE,KEY_CODES.CAPS_LOCK,KEY_CODES.DELETE,KEY_CODES.END,KEY_CODES.ENTER,KEY_CODES.ESCAPE,KEY_CODES.F1,KEY_CODES.F2,KEY_CODES.F3,KEY_CODES.F4,KEY_CODES.F5,KEY_CODES.F6,KEY_CODES.F7,KEY_CODES.F8,KEY_CODES.F9,KEY_CODES.F10,KEY_CODES.F11,KEY_CODES.F12,KEY_CODES.F13,KEY_CODES.F14,KEY_CODES.F15,KEY_CODES.F16,KEY_CODES.F17,KEY_CODES.F18,KEY_CODES.F19,KEY_CODES.HOME,KEY_CODES.INSERT,KEY_CODES.MEDIA_NEXT,KEY_CODES.MEDIA_PLAY_PAUSE,KEY_CODES.MEDIA_PREV,KEY_CODES.MEDIA_STOP,KEY_CODES.NULL,KEY_CODES.NUM_LOCK,KEY_CODES.PAGE_DOWN,KEY_CODES.PAGE_UP,KEY_CODES.PAUSE,KEY_CODES.SCROLL_LOCK,KEY_CODES.SHIFT,KEY_CODES.TAB];function isPrintableChar(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function isFunctionKey(e){return FUNCTION_KEYS.includes(e)}function isCtrlKey(e){const t=[];return isMacOS()?t.push(KEY_CODES.COMMAND_LEFT,KEY_CODES.COMMAND_RIGHT,KEY_CODES.COMMAND_FIREFOX):t.push(KEY_CODES.CONTROL),t.includes(e)}function isCtrlMetaKey(e){return[KEY_CODES.CONTROL,KEY_CODES.COMMAND_LEFT,KEY_CODES.COMMAND_RIGHT,KEY_CODES.COMMAND_FIREFOX].includes(e)}function isKey$1(e,t){const i=t.split("|");let r=!1;return arrayEach$1(i,o=>{if(e===KEY_CODES[o])return r=!0,!1}),r}var event_exports={};__export(event_exports,{isImmediatePropagationStopped:()=>isImmediatePropagationStopped,isLeftClick:()=>isLeftClick,isRightClick:()=>isRightClick,isTouchEvent:()=>isTouchEvent,offsetRelativeTo:()=>offsetRelativeTo,stopImmediatePropagation:()=>stopImmediatePropagation});function stopImmediatePropagation(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function isImmediatePropagationStopped(e){return e.isImmediatePropagationEnabled===!1}function isRightClick(e){return e.button===2}function isLeftClick(e){return e.button===0}function isTouchEvent(e){return e instanceof TouchEvent}function offsetRelativeTo(e,t){const i={x:e.offsetX,y:e.offsetY};let r=e.target;if(!(t instanceof HTMLElement)||r!==t&&r.contains(t))return i;for(;r!==t;)i.x+=r.offsetLeft,i.y+=r.offsetTop,r=r.offsetParent;return i}var require_object_keys=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-keys.js"(e,t){var i=require_object_keys_internal(),r=require_enum_bug_keys();t.exports=Object.keys||function(a){return i(a,r)}}}),require_object_define_properties=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-define-properties.js"(e){var t=require_descriptors(),i=require_v8_prototype_define_bug(),r=require_object_define_property(),o=require_an_object(),a=require_to_indexed_object(),c=require_object_keys();e.f=t&&!i?Object.defineProperties:function(h,d){o(h);for(var f=a(d),m=c(d),g=m.length,v=0,_;g>v;)r.f(h,_=m[v++],f[_]);return h}}}),require_object_create=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-create.js"(e,t){var i=require_an_object(),r=require_object_define_properties(),o=require_enum_bug_keys(),a=require_hidden_keys(),c=require_html(),u=require_document_create_element(),h=require_shared_key(),d=">",f="<",m="prototype",g="script",v=h("IE_PROTO"),_=function(){},b=function(R){return f+g+d+R+f+"/"+g+d},S=function(R){R.write(b("")),R.close();var O=R.parentWindow.Object;return R=null,O},T=function(){var R=u("iframe"),O="java"+g+":",P;return R.style.display="none",c.appendChild(R),R.src=String(O),P=R.contentWindow.document,P.open(),P.write(b("document.F=Object")),P.close(),P.F},A,I=function(){try{A=new ActiveXObject("htmlfile")}catch{}I=typeof document<"u"?document.domain&&A?S(A):T():S(A);for(var R=o.length;R--;)delete I[m][o[R]];return I()};a[v]=!0,t.exports=Object.create||function(O,P){var L;return O!==null?(_[m]=i(O),L=new _,_[m]=null,L[v]=O):L=I(),P===void 0?L:r.f(L,P)}}}),require_add_to_unscopables=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/add-to-unscopables.js"(e,t){var i=require_well_known_symbol(),r=require_object_create(),o=require_object_define_property().f,a=i("unscopables"),c=Array.prototype;c[a]===void 0&&o(c,a,{configurable:!0,value:r(null)}),t.exports=function(u){c[a][u]=!0}}}),require_es_array_unscopables_flat_map=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.array.unscopables.flat-map.js"(){var e=require_add_to_unscopables();e("flatMap")}});function warn(){isDefined(console)&&console.warn(...arguments)}function error(){isDefined(console)&&console.error(...arguments)}var import_es_error_cause$174=__toESM(require_es_error_cause(),1),import_es_array_push$105=__toESM(require_es_array_push(),1),import_es_array_unscopables_flat_map$1=__toESM(require_es_array_unscopables_flat_map(),1);function _defineProperty$119(e,t,i){return(t=_toPropertyKey$120(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$120(e){var t=_toPrimitive$120(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$120(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}const REGISTERED_HOOKS=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],REMOVED_MESSAGE=toSingleLine`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,REMOVED_HOOKS=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),DEPRECATED_HOOKS=new Map([[]]),callbackOrder=new WeakMap;var Hooks=class{static getSingleton(){return getGlobalSingleton()}constructor(){_defineProperty$119(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return arrayEach$1(REGISTERED_HOOKS,t=>{e[t]=[],this.initOrderMap(e,t)}),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;if(Array.isArray(t))arrayEach$1(t,o=>this.add(e,o,i));else{REMOVED_HOOKS.has(e)&&warn(substitute(REMOVED_MESSAGE,{hookName:e,removedInVersion:REMOVED_HOOKS.get(e)})),DEPRECATED_HOOKS.has(e)&&warn(DEPRECATED_HOOKS.get(e));const o=this.getBucket(i);if(typeof o[e]>"u"&&(this.register(e),o[e]=[],this.initOrderMap(o,e)),t.skip=!1,o[e].indexOf(t)===-1){let a=!1;t.initialHook&&arrayEach$1(o[e],(c,u)=>{if(c.initialHook)return o[e][u]=t,a=!0,!1}),a||o[e].push(t)}this.setCallbackOrderIndex(o,e,t,r),this.orderBucketByOrderIndex(o,e)}return this}once(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;Array.isArray(t)?arrayEach$1(t,o=>this.once(e,o,i)):(t.runOnce=!0,this.add(e,t,i,r))}remove(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const r=this.getBucket(i);return typeof r[e]<"u"&&r[e].indexOf(t)>=0?(t.skip=!0,!0):!1}has(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const i=this.getBucket(t);return!!(i[e]!==void 0&&i[e].length)}run(e,t,i,r,o,a,c,u){{const h=this.globalBucket[t],d=h?h.length:0;let f=0;if(d)for(;f<d;){if(!h[f]||h[f].skip){f+=1;continue}const m=fastCall(h[f],e,i,r,o,a,c,u);m!==void 0&&(i=m),h[f]&&h[f].runOnce&&this.remove(t,h[f]),f+=1}}{const h=this.getBucket(e)[t],d=h?h.length:0;let f=0;if(d)for(;f<d;){if(!h[f]||h[f].skip){f+=1;continue}const m=fastCall(h[f],e,i,r,o,a,c,u);m!==void 0&&(i=m),h[f]&&h[f].runOnce&&this.remove(t,h[f],e),f+=1}}return i}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;objectEach(this.getBucket(e),(t,i,r)=>r[i].length=0)}register(e){this.isRegistered(e)||REGISTERED_HOOKS.push(e)}deregister(e){this.isRegistered(e)&&REGISTERED_HOOKS.splice(REGISTERED_HOOKS.indexOf(e),1)}isDeprecated(e){return DEPRECATED_HOOKS.has(e)||REMOVED_HOOKS.has(e)}isRegistered(e){return REGISTERED_HOOKS.indexOf(e)>=0}getRegistered(){return REGISTERED_HOOKS}setCallbackOrderIndex(e,t,i,r){const o=Number.isInteger(r)?r:0,a=this.getCallbackOrderMap(e,t);a.set(o,[...a.get(o)||[],i])}orderBucketByOrderIndex(e,t){const i=this.getCallbackOrderMap(e,t);i===void 0||i.size===0||i.size===1&&i.has(0)||(e[t]=[...i].sort((r,o)=>r[0]-o[0]).flatMap(r=>{let[,o]=r;return o}))}initOrderMap(e,t){callbackOrder.has(e)||callbackOrder.set(e,[]),callbackOrder.get(e)[t]=new Map}getCallbackOrderMap(e,t){return callbackOrder.get(e)[t]}};const globalSingleton=new Hooks;function getGlobalSingleton(){return globalSingleton}var pluginHooks_default=Hooks;const collection=new Map;function staticRegister(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";collection.has(e)||collection.set(e,new Map);const t=collection.get(e);function i(u,h){t.set(u,h)}function r(u){return t.get(u)}function o(u){return t.has(u)}function a(){return[...t.keys()]}function c(){return[...t.values()]}return{register:i,getItem:r,hasItem:o,getNames:a,getValues:c}}var import_es_error_cause$173=__toESM(require_es_error_cause(),1);const registeredEditorClasses=new WeakMap,{register:register$4,getItem:getItem$3,hasItem:hasItem$3,getNames:getNames$3,getValues:getValues$3}=staticRegister("editors");function RegisteredEditor(e){const t={},i=e;this.getConstructor=function(){return e},this.getInstance=function(r){return r.guid in t||(t[r.guid]=new i(r)),t[r.guid]},pluginHooks_default.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function _getEditorInstance(e,t){let i;if(typeof e=="function")registeredEditorClasses.get(e)||_register$3(null,e),i=registeredEditorClasses.get(e);else if(typeof e=="string")i=getItem$3(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!i)throw Error(`No editor registered under name "${e}"`);return i.getInstance(t)}function _getItem$3(e){if(typeof e=="function")return e;if(!hasItem$3(e))throw Error(`No registered editor found under "${e}" name`);return getItem$3(e).getConstructor()}function _register$3(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);const i=new RegisteredEditor(t);typeof e=="string"&&register$4(e,i),registeredEditorClasses.set(t,i)}var import_es_error_cause$172=__toESM(require_es_error_cause(),1),import_es_array_push$104=__toESM(require_es_array_push(),1);function _defineProperty$118(e,t,i){return(t=_toPropertyKey$119(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$119(e){var t=_toPrimitive$119(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$119(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}let listenersCounter=0;var EventManager=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;_defineProperty$118(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(a){i.call(this,extendEvent(a))}return this.context.eventListeners.push({element:e,event:t,callback:i,callbackProxy:o,options:r,eventManager:this}),e.addEventListener(t,o,r),listenersCounter+=1,()=>{this.removeEventListener(e,t,i)}}removeEventListener(e,t,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,a;for(;o;)if(o-=1,a=this.context.eventListeners[o],a.event===t&&a.element===e){if(i&&i!==a.callback||r&&a.eventManager!==this)continue;this.context.eventListeners.splice(o,1),a.element.removeEventListener(a.event,a.callbackProxy,a.options),listenersCounter-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const i=this.context.eventListeners[t];e&&i.eventManager!==this||(this.context.eventListeners.splice(t,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options),listenersCounter-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let i=e.document,r=e;i||(i=e.ownerDocument?e.ownerDocument:e,r=i.defaultView);const o={bubbles:!0,cancelable:t!=="mousemove",view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let a;i.createEvent?(a=i.createEvent("MouseEvents"),a.initMouseEvent(t,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget||i.body.parentNode)):a=i.createEventObject(),e.dispatchEvent?e.dispatchEvent(a):e.fireEvent(`on${t}`,a)}};function extendEvent(e){const t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),stopImmediatePropagation(this)},e}var eventManager_default=EventManager;function getListenersCounter(){return listenersCounter}var import_es_error_cause$171=__toESM(require_es_error_cause(),1);function _classPrivateMethodInitSpec$48(e,t){_checkPrivateRedeclaration$70(e,t),t.add(e)}function _checkPrivateRedeclaration$70(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$117(e,t,i){return(t=_toPropertyKey$118(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$118(e){var t=_toPrimitive$118(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$118(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand$70(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _EditorManager_brand=new WeakSet,EditorManager=class{constructor(e,t,i){_classPrivateMethodInitSpec$48(this,_EditorManager_brand),_defineProperty$117(this,"hot",void 0),_defineProperty$117(this,"tableMeta",void 0),_defineProperty$117(this,"selection",void 0),_defineProperty$117(this,"eventManager",void 0),_defineProperty$117(this,"destroyed",!1),_defineProperty$117(this,"activeEditor",void 0),_defineProperty$117(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=i,this.eventManager=new eventManager_default(e),this.hot.addHook("afterDocumentKeyDown",r=>_assertClassBrand$70(_EditorManager_brand,this,_onAfterDocumentKeyDown$1).call(this,r)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",r=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",r)}),this.hot.view._wt.update("onCellDblClick",(r,o,a)=>_assertClassBrand$70(_EditorManager_brand,this,_onCellDblClick).call(this,r,o,a))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,h=>{h&&this.prepareEditor()});return}const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!t||t.isHeader())return;const{row:i,col:r}=t,o=this.hot.runHooks("modifyGetCellCoords",i,r);let a=i,c=r;if(Array.isArray(o)&&([a,c]=o),this.cellProperties=this.hot.getCellMeta(a,c),!this.isCellEditable()){this.clearActiveEditor();return}const u=this.hot.getCell(i,r,!0);if(u){const h=this.hot.getCellEditor(this.cellProperties),d=this.hot.colToProp(c),f=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(a),c);this.activeEditor=_getEditorInstance(h,this.hot),this.activeEditor.prepare(i,r,d,u,f,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const r=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",r.highlight.row,r.highlight.col,e,t,i);if(t instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&r.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}closeEditor(e,t,i){this.activeEditor?this.activeEditor.finishEditing(e,t,i):i&&i(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const t=this.hot.getCellEditor(this.cellProperties),{row:i,col:r}=e.highlight,{rowIndexMapper:o,columnIndexMapper:a}=this.hot,c=o.isHidden(this.hot.toPhysicalRow(i))||a.isHidden(this.hot.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!t||c)}moveSelectionAfterEnter(e){const t={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(t.row=-t.row,t.col=-t.col),this.hot.selection.isMultiple()?this.selection.transformFocus(t.row,t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}};function _onAfterDocumentKeyDown$1(e){const t=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!t||t.highlight.isHeader()||isImmediatePropagationStopped(e))return;const{keyCode:i}=e,r=(e.ctrlKey||e.metaKey)&&!e.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!isFunctionKey(i)&&!isCtrlMetaKey(i)&&!r&&!this.isEditorOpened()&&this.openEditor("",e)}function _onCellDblClick(e,t){t.isCell()&&this.openEditor(null,e,!0)}const instances=new WeakMap;EditorManager.getInstance=function(e,t,i){let r=instances.get(e);return r||(r=new EditorManager(e,t,i),instances.set(e,r)),r};var editorManager_default=EditorManager,import_es_error_cause$170=__toESM(require_es_error_cause(),1);function _classPrivateMethodInitSpec$47(e,t){_checkPrivateRedeclaration$69(e,t),t.add(e)}function _classPrivateFieldInitSpec$51(e,t,i){_checkPrivateRedeclaration$69(e,t),t.set(e,i)}function _checkPrivateRedeclaration$69(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$51(e,t){return e.get(_assertClassBrand$69(e,t))}function _classPrivateFieldSet$47(e,t,i){return e.set(_assertClassBrand$69(e,t),i),i}function _assertClassBrand$69(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const FOCUS_MODES=Object.freeze({CELL:"cell",MIXED:"mixed"});var _hot=new WeakMap,_focusMode=new WeakMap,_refocusDelay=new WeakMap,_refocusElementGetter=new WeakMap,_debouncedSelect=new WeakMap,_FocusManager_brand=new WeakSet,FocusManager=class{constructor(e){var t=this;_classPrivateMethodInitSpec$47(this,_FocusManager_brand),_classPrivateFieldInitSpec$51(this,_hot,void 0),_classPrivateFieldInitSpec$51(this,_focusMode,void 0),_classPrivateFieldInitSpec$51(this,_refocusDelay,1),_classPrivateFieldInitSpec$51(this,_refocusElementGetter,null),_classPrivateFieldInitSpec$51(this,_debouncedSelect,new Map);const i=e.getSettings();_classPrivateFieldSet$47(_hot,this,e),_classPrivateFieldSet$47(_focusMode,this,i.imeFastEdit?FOCUS_MODES.MIXED:FOCUS_MODES.CELL),_classPrivateFieldGet$51(_hot,this).addHook("afterUpdateSettings",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return _assertClassBrand$69(_FocusManager_brand,t,_onUpdateSettings).call(t,...o)}),_classPrivateFieldGet$51(_hot,this).addHook("afterSelection",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return _assertClassBrand$69(_FocusManager_brand,t,_focusCell).call(t,...o)}),_classPrivateFieldGet$51(_hot,this).addHook("afterSelectionFocusSet",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return _assertClassBrand$69(_FocusManager_brand,t,_focusCell).call(t,...o)}),_classPrivateFieldGet$51(_hot,this).addHook("afterSelectionEnd",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return _assertClassBrand$69(_FocusManager_brand,t,_focusEditorElement).call(t,...o)})}getFocusMode(){return _classPrivateFieldGet$51(_focusMode,this)}setFocusMode(e){Object.values(FOCUS_MODES).includes(e)?_classPrivateFieldSet$47(_focusMode,this,e):warn(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return _classPrivateFieldGet$51(_refocusDelay,this)}setRefocusDelay(e){_classPrivateFieldSet$47(_refocusDelay,this,e)}setRefocusElementGetter(e){_classPrivateFieldSet$47(_refocusElementGetter,this,e)}getRefocusElement(){if(typeof _classPrivateFieldGet$51(_refocusElementGetter,this)=="function")return _classPrivateFieldGet$51(_refocusElementGetter,this).call(this);var e;return(e=_classPrivateFieldGet$51(_hot,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const t=i=>{var r,o;const a=(r=_classPrivateFieldGet$51(_hot,this).getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;if(!a)return;let c=_classPrivateFieldGet$51(_hot,this).runHooks("modifyFocusedElement",a.row,a.col,i);c instanceof HTMLElement||(c=i),c&&!((o=_classPrivateFieldGet$51(_hot,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&c.focus({preventScroll:!0})};e?t(e):_assertClassBrand$69(_FocusManager_brand,this,_getSelectedCell).call(this,i=>t(i))}refocusToEditorTextarea(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_classPrivateFieldGet$51(_refocusDelay,this);const i=this.getRefocusElement();_classPrivateFieldGet$51(_hot,this).getSettings().imeFastEdit&&!((e=_classPrivateFieldGet$51(_hot,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&i&&(_classPrivateFieldGet$51(_debouncedSelect,this).has(t)||_classPrivateFieldGet$51(_debouncedSelect,this).set(t,debounce$3(()=>{i.select()},t)),_classPrivateFieldGet$51(_debouncedSelect,this).get(t)())}};function _getSelectedCell(e){var t;const i=(t=_classPrivateFieldGet$51(_hot,this).getSelectedRangeLast())===null||t===void 0?void 0:t.highlight;if(!i||!_classPrivateFieldGet$51(_hot,this).selection.isCellVisible(i)){e(null);return}const r=_classPrivateFieldGet$51(_hot,this).getCell(i.row,i.col,!0);r===null?_classPrivateFieldGet$51(_hot,this).addHookOnce("afterScroll",()=>{e(_classPrivateFieldGet$51(_hot,this).getCell(i.row,i.col,!0))}):e(r)}function _focusCell(){_assertClassBrand$69(_FocusManager_brand,this,_getSelectedCell).call(this,e=>{const{activeElement:t}=_classPrivateFieldGet$51(_hot,this).rootDocument;t&&isOutsideInput(t)&&t.blur(),this.focusOnHighlightedCell(e)})}function _focusEditorElement(){_assertClassBrand$69(_FocusManager_brand,this,_getSelectedCell).call(this,e=>{this.getFocusMode()===FOCUS_MODES.MIXED&&e.nodeName==="TD"&&this.refocusToEditorTextarea()})}function _onUpdateSettings(e){typeof e.imeFastEdit=="boolean"&&this.setFocusMode(e.imeFastEdit?FOCUS_MODES.MIXED:FOCUS_MODES.CELL)}var require_is_regexp=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/is-regexp.js"(e,t){var i=require_is_object(),r=require_classof_raw(),o=require_well_known_symbol(),a=o("match");t.exports=function(c){var u;return i(c)&&((u=c[a])!==void 0?!!u:r(c)==="RegExp")}}}),require_regexp_flags=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/regexp-flags.js"(e,t){var i=require_an_object();t.exports=function(){var r=i(this),o="";return r.hasIndices&&(o+="d"),r.global&&(o+="g"),r.ignoreCase&&(o+="i"),r.multiline&&(o+="m"),r.dotAll&&(o+="s"),r.unicode&&(o+="u"),r.unicodeSets&&(o+="v"),r.sticky&&(o+="y"),o}}}),require_regexp_get_flags=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/regexp-get-flags.js"(e,t){var i=require_function_call(),r=require_has_own_property(),o=require_object_is_prototype_of(),a=require_regexp_flags(),c=RegExp.prototype;t.exports=function(u){var h=u.flags;return h===void 0&&!("flags"in c)&&!r(u,"flags")&&o(c,u)?i(a,u):h}}}),require_get_substitution=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/get-substitution.js"(e,t){var i=require_function_uncurry_this(),r=require_to_object(),o=Math.floor,a=i("".charAt),c=i("".replace),u=i("".slice),h=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,d=/\$([$&'`]|\d{1,2})/g;t.exports=function(f,m,g,v,_,b){var S=g+f.length,T=v.length,A=d;return _!==void 0&&(_=r(_),A=h),c(b,A,function(I,R){var O;switch(a(R,0)){case"$":return"$";case"&":return f;case"`":return u(m,0,g);case"'":return u(m,S);case"<":O=_[u(R,1,-1)];break;default:var P=+R;if(P===0)return I;if(P>T){var L=o(P/10);return L===0?I:L<=T?v[L-1]===void 0?a(R,1):v[L-1]+a(R,1):I}O=v[P-1]}return O===void 0?"":O})}}}),require_es_string_replace_all=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.string.replace-all.js"(){var e=require_export(),t=require_function_call(),i=require_function_uncurry_this(),r=require_require_object_coercible(),o=require_is_callable(),a=require_is_null_or_undefined(),c=require_is_regexp(),u=require_to_string(),h=require_get_method(),d=require_regexp_get_flags(),f=require_get_substitution(),m=require_well_known_symbol(),g=require_is_pure(),v=m("replace"),_=TypeError,b=i("".indexOf),S=i("".replace),T=i("".slice),A=Math.max;e({target:"String",proto:!0},{replaceAll:function(R,O){var P=r(this),L,V,U,$,Z,ie,ue,_e,Ee,pe,me=0,Se="";if(!a(R)){if(L=c(R),L&&(V=u(r(d(R))),!~b(V,"g")))throw new _("`.replaceAll` does not allow non-global regexes");if(U=h(R,v),U)return t(U,R,P,O);if(g&&L)return S(u(P),R,O)}for($=u(P),Z=u(R),ie=o(O),ie||(O=u(O)),ue=Z.length,_e=A(1,ue),Ee=b($,Z);Ee!==-1;)pe=ie?u(O(Z,Ee,$)):f(Z,$,Ee,[],void 0,O),Se+=T($,me,Ee)+pe,me=Ee+ue,Ee=Ee+_e>$.length?-1:b($,Z,Ee+_e);return me<$.length&&(Se+=T($,me)),Se}})}}),parseTable_exports={};__export(parseTable_exports,{_dataToHTML:()=>_dataToHTML,htmlToGridSettings:()=>htmlToGridSettings,instanceToHTML:()=>instanceToHTML});var import_es_array_push$103=__toESM(require_es_array_push(),1),import_es_string_replace_all=__toESM(require_es_string_replace_all(),1);const ESCAPED_HTML_CHARS={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},regEscapedChars=new RegExp(Object.keys(ESCAPED_HTML_CHARS).map(e=>`(${e})`).join("|"),"gi");function isHTMLTable(e){return(e&&e.nodeName||"")==="TABLE"}function instanceToHTML(e){const t=e.hasColHeaders(),i=e.hasRowHeaders(),r=[t?-1:0,i?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData(...r),a=o.length,c=a>0?o[0].length:0,u=["<table>","</table>"],h=t?["<thead>","</thead>"]:[],d=["<tbody>","</tbody>"],f=i?1:0,m=t?1:0;for(let g=0;g<a;g+=1){const v=t&&g===0,_=[];for(let S=0;S<c;S+=1){const T=!v&&i&&S===0;let A="";if(v)A=`<th>${e.getColHeader(S-f)}</th>`;else if(T)A=`<th>${e.getRowHeader(g-m)}</th>`;else{const I=o[g][S],{hidden:R,rowspan:O,colspan:P}=e.getCellMeta(g-m,S-f);if(!R){const L=[];if(O&&L.push(`rowspan="${O}"`),P&&L.push(`colspan="${P}"`),isEmpty(I))A=`<td ${L.join(" ")}></td>`;else{const V=I.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");A=`<td ${L.join(" ")}>${V}</td>`}}}_.push(A)}const b=["<tr>",..._,"</tr>"].join("");v?h.splice(1,0,b):d.splice(-1,0,b)}return u.splice(1,0,h.join(""),d.join("")),u.join("")}function _dataToHTML(e){const t=e.length,i=["<table>"];for(let r=0;r<t;r+=1){const o=e[r],a=o.length,c=[];r===0&&i.push("<tbody>");for(let u=0;u<a;u+=1){const h=o[u],d=isEmpty(h)?"":h.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,f=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(f.length-1)} </span>`).replace(/\t/gi,"&#9;");c.push(`<td>${d}</td>`)}i.push("<tr>",...c,"</tr>"),r+1===t&&i.push("</tbody>")}return i.push("</table>"),i.join("")}function htmlToGridSettings(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const i={},r=t.createDocumentFragment(),o=t.createElement("div");r.appendChild(o);let a=e;if(typeof a=="string"){const I=a.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,R=>{const O=R.match(/<td\b[^>]*?>/g)[0],P=/<p.*?>/g,L=R.substring(O.length,R.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(P,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/gm,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/gm,"");return`${O}${L}</td>`});o.insertAdjacentHTML("afterbegin",`${I}`),a=o.querySelector("table")}if(!a||!isHTMLTable(a))return;const c=o.querySelector('meta[name$="enerator"]'),u=a.querySelector("tbody th")!==null,h=a.querySelector("tr"),d=h?Array.from(h.cells).reduce((I,R)=>I+R.colSpan,0)-(u?1:0):0,f=a.tFoot&&Array.from(a.tFoot.rows)||[],m=[];let g=!1,v=0,_=0;if(a.tHead){const I=Array.from(a.tHead.rows).filter(R=>{const O=R.querySelector("td")!==null;return O&&m.push(R),!O});v=I.length,g=v>0,v>1?i.nestedHeaders=Array.from(I).reduce((R,O)=>{const P=Array.from(O.cells).reduce((L,V,U)=>{if(u&&U===0)return L;const{colSpan:$,innerHTML:Z}=V,ie=$>1?{label:Z,colspan:$}:Z;return L.push(ie),L},[]);return R.push(P),R},[]):g&&(i.colHeaders=Array.from(I[0].children).reduce((R,O,P)=>(u&&P===0||R.push(O.innerHTML),R),[]))}m.length&&(i.fixedRowsTop=m.length),f.length&&(i.fixedRowsBottom=f.length);const b=[...m,...Array.from(a.tBodies).reduce((I,R)=>(I.push(...Array.from(R.rows)),I),[]),...f];_=b.length;const S=new Array(_);for(let I=0;I<_;I++)S[I]=new Array(d);const T=[],A=[];for(let I=0;I<_;I++){const R=b[I],O=Array.from(R.cells),P=O.length;for(let L=0;L<P;L++){const V=O[L],{nodeName:U,innerHTML:$,rowSpan:Z,colSpan:ie}=V,ue=S[I].findIndex(_e=>_e===void 0);if(U==="TD"){if(Z>1||ie>1){for(let me=I;me<I+Z;me++)if(me<_)for(let Se=ue;Se<ue+ie;Se++)S[me][Se]=null;const Ee=V.getAttribute("style");Ee&&Ee.includes("mso-ignore:colspan")||T.push({col:ue,row:I,rowspan:Z,colspan:ie})}let _e="";c&&/excel/gi.test(c.content)?_e=$.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):_e=$.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[I][ue]=_e.replace(regEscapedChars,Ee=>ESCAPED_HTML_CHARS[Ee])}else A.push($)}}return T.length&&(i.mergeCells=T),A.length&&(i.rowHeaders=A),S.length&&(i.data=S),i}var number_exports={};__export(number_exports,{clamp:()=>clamp$1,isNumeric:()=>isNumeric,isNumericLike:()=>isNumericLike,rangeEach:()=>rangeEach,rangeEachReverse:()=>rangeEachReverse,valueAccordingPercent:()=>valueAccordingPercent});var import_es_set_difference_v2$25=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$25=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$25=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$25=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$25=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$25=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$25=__toESM(require_es_set_union_v2(),1);function isNumeric(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=typeof e;if(i==="number")return!isNaN(e)&&isFinite(e);if(i==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);const r=Array.from(new Set([".",...t])).map(o=>`\\${o}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(e.trim())}else if(i==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function isNumericLike(e){return isNumeric(e,[","])}function rangeEach(e,t,i){let r=-1;for(typeof t=="function"?(i=t,t=e):r=e-1;++r<=t&&i(r)!==!1;);}function rangeEachReverse(e,t,i){let r=e+1;for(typeof t=="function"&&(i=t,t=0);--r>=t&&i(r)!==!1;);}function valueAccordingPercent(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}function clamp$1(e,t,i){return Math.min(e,t)===e?t:Math.max(e,i)===e?i:e}var import_es_error_cause$169=__toESM(require_es_error_cause(),1);const ASC="asc",DESC="desc",ORDER_MAP=new Map([[ASC,[-1,1]],[DESC,[1,-1]]]),DEFAULT_ERROR_PRIORITY_EXISTS=e=>`The priority '${e}' is already declared in a map.`,DEFAULT_ERROR_PRIORITY_NAN=e=>`The priority '${e}' is not a number.`;function createPriorityMap(){let{errorPriorityExists:e,errorPriorityNaN:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const i=new Map;e=isFunction$2(e)?e:DEFAULT_ERROR_PRIORITY_EXISTS,t=isFunction$2(t)?t:DEFAULT_ERROR_PRIORITY_NAN;function r(a,c){if(!isNumeric(a))throw new Error(t(a));if(i.has(a))throw new Error(e(a));i.set(a,c)}function o(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ASC;const[c,u]=ORDER_MAP.get(a)||ORDER_MAP.get(ASC);return[...i].sort((h,d)=>h[0]<d[0]?c:u).map(h=>h[1])}return{addItem:r,getItems:o}}var import_es_error_cause$168=__toESM(require_es_error_cause(),1);const DEFAULT_ERROR_ID_EXISTS=e=>`The id '${e}' is already declared in a map.`;function createUniqueMap(){let{errorIdExists:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=new Map;e=isFunction$2(e)?e:DEFAULT_ERROR_ID_EXISTS;function i(d,f){if(h(d))throw new Error(e(d));t.set(d,f)}function r(d){return t.delete(d)}function o(){t.clear()}function a(d){const[f]=u().find(m=>{let[g,v]=m;return d===v?g:!1})||[null];return f}function c(d){return t.get(d)}function u(){return[...t]}function h(d){return t.has(d)}return{addItem:i,clear:o,getId:a,getItem:c,getItems:u,hasItem:h,removeItem:r}}var import_es_error_cause$167=__toESM(require_es_error_cause(),1),import_es_set_difference_v2$24=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$24=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$24=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$24=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$24=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$24=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$24=__toESM(require_es_set_union_v2(),1);const DEFAULT_ERROR_ITEM_EXISTS=e=>`'${e}' value is already declared in a unique set.`;function createUniqueSet(){let{errorItemExists:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=new Set;e=isFunction$2(e)?e:DEFAULT_ERROR_ITEM_EXISTS;function i(a){if(t.has(a))throw new Error(e(a));t.add(a)}function r(){return[...t]}function o(){t.clear()}return{addItem:i,clear:o,getItems:r}}var import_es_error_cause$166=__toESM(require_es_error_cause(),1);const ERROR_PLUGIN_REGISTERED=e=>`There is already registered "${e}" plugin.`,ERROR_PRIORITY_REGISTERED=e=>`There is already registered plugin on priority "${e}".`,ERROR_PRIORITY_NAN=e=>`The priority "${e}" is not a number.`,priorityPluginsQueue=createPriorityMap({errorPriorityExists:ERROR_PRIORITY_REGISTERED,errorPriorityNaN:ERROR_PRIORITY_NAN}),uniquePluginsQueue=createUniqueSet({errorItemExists:ERROR_PLUGIN_REGISTERED}),uniquePluginsList=createUniqueMap({errorIdExists:ERROR_PLUGIN_REGISTERED});function getPluginsNames(){return[...priorityPluginsQueue.getItems(),...uniquePluginsQueue.getItems()]}function getPlugin(e){const t=toUpperCaseFirst(e);return uniquePluginsList.getItem(t)}function hasPlugin(e){return!!getPlugin(e)}function registerPlugin(e,t,i){[e,t,i]=unifyPluginArguments(e,t,i),getPlugin(e)===void 0&&_registerPlugin(e,t,i)}function _registerPlugin(e,t,i){const r=toUpperCaseFirst(e);if(uniquePluginsList.hasItem(r))throw new Error(ERROR_PLUGIN_REGISTERED(r));i===void 0?uniquePluginsQueue.addItem(r):priorityPluginsQueue.addItem(i,r),uniquePluginsList.addItem(r,t)}function unifyPluginArguments(e,t,i){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,i=t.PLUGIN_PRIORITY),[e,t,i]}var import_es_error_cause$165=__toESM(require_es_error_cause(),1);const{register:register$3,getItem:getItem$2,hasItem:hasItem$2,getNames:getNames$2,getValues:getValues$2}=staticRegister("renderers");function _getItem$2(e){if(typeof e=="function")return e;if(!hasItem$2(e))throw Error(`No registered renderer found under "${e}" name`);return getItem$2(e)}function _register$2(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),register$3(e,t)}var import_es_error_cause$164=__toESM(require_es_error_cause(),1);const{register:register$2,getItem:getItem$1,hasItem:hasItem$1,getNames:getNames$1,getValues:getValues$1}=staticRegister("validators");function _getItem$1(e){if(typeof e=="function")return e;if(!hasItem$1(e))throw Error(`No registered validator found under "${e}" name`);return getItem$1(e)}function _register$1(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),register$2(e,t)}var require_es_array_at=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.array.at.js"(){var e=require_export(),t=require_to_object(),i=require_length_of_array_like(),r=require_to_integer_or_infinity(),o=require_add_to_unscopables();e({target:"Array",proto:!0},{at:function(c){var u=t(this),h=i(u),d=r(c),f=d>=0?d:h+d;return f<0||f>=h?void 0:u[f]}}),o("at")}}),require_es_string_at_alternative=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.string.at-alternative.js"(){var e=require_export(),t=require_function_uncurry_this(),i=require_require_object_coercible(),r=require_to_integer_or_infinity(),o=require_to_string(),a=require_fails(),c=t("".charAt),u=a(function(){return"\u{20BB7}".at(-2)!=="\\ud842"});e({target:"String",proto:!0,forced:u},{at:function(d){var f=o(i(this)),m=f.length,g=r(d),v=g>=0?g:m+g;return v<0||v>=m?void 0:c(f,v)}})}}),import_es_error_cause$163=__toESM(require_es_error_cause(),1),import_es_array_at$3=__toESM(require_es_array_at(),1),import_es_string_at_alternative$3=__toESM(require_es_string_at_alternative(),1);function _defineProperty$116(e,t,i){return(t=_toPropertyKey$117(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$117(e){var t=_toPrimitive$117(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$117(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FullyVisibleColumnsCalculationType=class{constructor(){_defineProperty$116(this,"count",0),_defineProperty$116(this,"startColumn",null),_defineProperty$116(this,"endColumn",null),_defineProperty$116(this,"startPosition",null),_defineProperty$116(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:o,columnWidth:a}=t,c=r>0?o+1:o;i>=r&&i+a<=r+c&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var t;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:o,zeroBasedScrollOffset:a,totalColumns:c,needReverse:u,startPositions:h,columnWidth:d}=e;if(this.endColumn===c-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const v=h[this.endColumn]+d-h[this.startColumn-1];if(v<=r&&(this.startColumn-=1),v>=r)break}this.startPosition=(t=h[this.startColumn])!==null&&t!==void 0?t:null;const f=a>0?r+1:r,m=i+r-f,g=this.startColumn===null?0:e.getColumnWidth(this.startColumn);m<-1*o||i>h.at(-1)||-1*i-r>-1*g?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,c<this.endColumn&&(this.endColumn=c-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},import_es_error_cause$162=__toESM(require_es_error_cause(),1),import_es_array_at$2=__toESM(require_es_array_at(),1),import_es_string_at_alternative$2=__toESM(require_es_string_at_alternative(),1);function _defineProperty$115(e,t,i){return(t=_toPropertyKey$116(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$116(e){var t=_toPrimitive$116(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$116(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FullyVisibleRowsCalculationType=class{constructor(){_defineProperty$115(this,"count",0),_defineProperty$115(this,"startRow",null),_defineProperty$115(this,"endRow",null),_defineProperty$115(this,"startPosition",null),_defineProperty$115(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:o,rowHeight:a}=t;i>=r&&i+a<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var t;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:o,totalRows:a,needReverse:c,startPositions:u,rowHeight:h}=e;if(this.endRow===a-1&&c)for(this.startRow=this.endRow;this.startRow>0;){const m=u[this.endRow]+h-u[this.startRow-1];if(m<=r-o&&(this.startRow-=1),m>=r-o)break}this.startPosition=(t=u[this.startRow])!==null&&t!==void 0?t:null;const d=i+r-o,f=this.startRow===null?0:e.getRowHeight(this.startRow);d<f||i>u.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}},import_es_error_cause$161=__toESM(require_es_error_cause(),1),import_es_array_at$1=__toESM(require_es_array_at(),1),import_es_string_at_alternative$1=__toESM(require_es_string_at_alternative(),1);function _defineProperty$114(e,t,i){return(t=_toPropertyKey$115(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$115(e){var t=_toPrimitive$115(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$115(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PartiallyVisibleColumnsCalculationType=class{constructor(){_defineProperty$114(this,"count",0),_defineProperty$114(this,"startColumn",null),_defineProperty$114(this,"endColumn",null),_defineProperty$114(this,"startPosition",null),_defineProperty$114(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:o}=t;i<=r&&(this.startColumn=e);const a=r>0?o+1:o;i>=r&&i<=r+a&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var t;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:o,zeroBasedScrollOffset:a,totalColumns:c,needReverse:u,startPositions:h,columnWidth:d}=e;if(this.endColumn===c-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=h[this.endColumn]+d-h[this.startColumn-1];if(this.startColumn-=1,g>r)break}this.startPosition=(t=h[this.startColumn])!==null&&t!==void 0?t:null;const f=a>0?r+1:r;i+r-f<-1*o||i>h.at(-1)+d||-1*i-r>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,c<this.endColumn&&(this.endColumn=c-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},import_es_error_cause$160=__toESM(require_es_error_cause(),1),import_es_array_at=__toESM(require_es_array_at(),1),import_es_string_at_alternative=__toESM(require_es_string_at_alternative(),1);function _defineProperty$113(e,t,i){return(t=_toPropertyKey$114(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$114(e){var t=_toPrimitive$114(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$114(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PartiallyVisibleRowsCalculationType=class{constructor(){_defineProperty$113(this,"count",0),_defineProperty$113(this,"startRow",null),_defineProperty$113(this,"endRow",null),_defineProperty$113(this,"startPosition",null),_defineProperty$113(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:o}=t;i<=r&&(this.startRow=e),i>=r&&i<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var t;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:o,totalRows:a,needReverse:c,startPositions:u,rowHeight:h}=e;if(this.endRow===a-1&&c)for(this.startRow=this.endRow;this.startRow>0;){const f=u[this.endRow]+h-u[this.startRow-1];if(this.startRow-=1,f>=r-o)break}this.startPosition=(t=u[this.startRow])!==null&&t!==void 0?t:null,i+r-o<0||i>u.at(-1)+h?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}},import_es_error_cause$159=__toESM(require_es_error_cause(),1);function _defineProperty$112(e,t,i){return(t=_toPropertyKey$113(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$113(e){var t=_toPrimitive$113(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$113(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RenderedAllColumnsCalculationType=class{constructor(){_defineProperty$112(this,"count",0),_defineProperty$112(this,"startColumn",0),_defineProperty$112(this,"endColumn",0),_defineProperty$112(this,"startPosition",0),_defineProperty$112(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:t}=e;this.count=t,this.endColumn=this.count-1}process(){}finalize(){}},import_es_error_cause$158=__toESM(require_es_error_cause(),1);function _defineProperty$111(e,t,i){return(t=_toPropertyKey$112(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$112(e){var t=_toPrimitive$112(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$112(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RenderedAllRowsCalculationType=class{constructor(){_defineProperty$111(this,"count",0),_defineProperty$111(this,"startRow",0),_defineProperty$111(this,"endRow",0),_defineProperty$111(this,"startPosition",0),_defineProperty$111(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:t}=e;this.count=t,this.endRow=this.count-1}process(){}finalize(){}},RenderedColumnsCalculationType=class extends PartiallyVisibleColumnsCalculationType{finalize(e){var t;super.finalize(e);const{overrideFn:i,totalColumns:r,startPositions:o}=e;this.startColumn!==null&&typeof i=="function"&&i(this),this.startColumn<0&&(this.startColumn=0),this.startPosition=(t=o[this.startColumn])!==null&&t!==void 0?t:null,r<this.endColumn&&(this.endColumn=r-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},RenderedRowsCalculationType=class extends PartiallyVisibleRowsCalculationType{finalize(e){var t;super.finalize(e);const{overrideFn:i,totalRows:r,startPositions:o}=e;this.startRow!==null&&typeof i=="function"&&i(this),this.startRow<0&&(this.startRow=0),this.startPosition=(t=o[this.startRow])!==null&&t!==void 0?t:null,r<this.endRow&&(this.endRow=r-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}},import_es_error_cause$157=__toESM(require_es_error_cause(),1);function _defineProperty$110(e,t,i){return(t=_toPropertyKey$111(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$111(e){var t=_toPrimitive$111(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$111(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ViewportBaseCalculator=class{constructor(e){_defineProperty$110(this,"calculationTypes",[]),_defineProperty$110(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(t=>{let[i,r]=t;this.calculationResults.set(i,r),r.initialize(e)})}_process(e,t){this.calculationTypes.forEach(i=>{let[,r]=i;return r.process(e,t)})}_finalize(e){this.calculationTypes.forEach(t=>{let[,i]=t;return i.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}},import_es_error_cause$156=__toESM(require_es_error_cause(),1),import_es_array_push$102=__toESM(require_es_array_push(),1);function _defineProperty$109(e,t,i){return(t=_toPropertyKey$110(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$110(e){var t=_toPrimitive$110(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$110(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}const DEFAULT_WIDTH=50;var ViewportColumnsCalculator=class extends ViewportBaseCalculator{constructor(e){let{calculationTypes:t,viewportWidth:i,scrollOffset:r,totalColumns:o,columnWidthFn:a,overrideFn:c,inlineStartOffset:u}=e;super(t),_defineProperty$109(this,"viewportWidth",0),_defineProperty$109(this,"scrollOffset",0),_defineProperty$109(this,"zeroBasedScrollOffset",0),_defineProperty$109(this,"totalColumns",0),_defineProperty$109(this,"columnWidthFn",null),_defineProperty$109(this,"columnWidth",0),_defineProperty$109(this,"overrideFn",null),_defineProperty$109(this,"inlineStartOffset",0),_defineProperty$109(this,"totalCalculatedWidth",0),_defineProperty$109(this,"startPositions",[]),_defineProperty$109(this,"needReverse",!0),this.viewportWidth=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalColumns=o,this.columnWidthFn=a,this.overrideFn=c,this.inlineStartOffset=u,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const t=this.columnWidthFn(e);return isNaN(t)?DEFAULT_WIDTH:t}},import_es_error_cause$155=__toESM(require_es_error_cause(),1),import_es_array_push$101=__toESM(require_es_array_push(),1);function _defineProperty$108(e,t,i){return(t=_toPropertyKey$109(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$109(e){var t=_toPrimitive$109(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$109(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}const DEFAULT_HEIGHT=23;var ViewportRowsCalculator=class extends ViewportBaseCalculator{constructor(e){let{calculationTypes:t,viewportHeight:i,scrollOffset:r,totalRows:o,rowHeightFn:a,overrideFn:c,horizontalScrollbarHeight:u}=e;super(t),_defineProperty$108(this,"viewportHeight",0),_defineProperty$108(this,"scrollOffset",0),_defineProperty$108(this,"zeroBasedScrollOffset",0),_defineProperty$108(this,"totalRows",0),_defineProperty$108(this,"rowHeightFn",null),_defineProperty$108(this,"rowHeight",0),_defineProperty$108(this,"overrideFn",null),_defineProperty$108(this,"horizontalScrollbarHeight",0),_defineProperty$108(this,"innerViewportHeight",0),_defineProperty$108(this,"totalCalculatedHeight",0),_defineProperty$108(this,"startPositions",[]),_defineProperty$108(this,"needReverse",!0),this.viewportHeight=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=c,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const t=this.rowHeightFn(e);return isNaN(t)?DEFAULT_HEIGHT:t}},import_es_error_cause$154=__toESM(require_es_error_cause(),1);function _classPrivateFieldInitSpec$50(e,t,i){_checkPrivateRedeclaration$68(e,t),t.set(e,i)}function _checkPrivateRedeclaration$68(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$107(e,t,i){return(t=_toPropertyKey$108(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$108(e){var t=_toPrimitive$108(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$108(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet$50(e,t){return e.get(_assertClassBrand$68(e,t))}function _classPrivateFieldSet$46(e,t,i){return e.set(_assertClassBrand$68(e,t),i),i}function _assertClassBrand$68(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _isRtl$2=new WeakMap,CellCoords=class or{constructor(t,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;_defineProperty$107(this,"row",null),_defineProperty$107(this,"col",null),_classPrivateFieldInitSpec$50(this,_isRtl$2,!1),_classPrivateFieldSet$46(_isRtl$2,this,r),typeof t<"u"&&typeof i<"u"&&(this.row=t,this.col=i)}isValid(t){const{countRows:i,countCols:r,countRowHeaders:o,countColHeaders:a}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...t};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-a||this.col<-o||this.row>=i||this.col>=r)}isEqual(t){return t===this?!0:this.row===t.row&&this.col===t.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return _classPrivateFieldGet$50(_isRtl$2,this)}isSouthEastOf(t){return this.row>=t.row&&(_classPrivateFieldGet$50(_isRtl$2,this)?this.col<=t.col:this.col>=t.col)}isNorthWestOf(t){return this.row<=t.row&&(_classPrivateFieldGet$50(_isRtl$2,this)?this.col>=t.col:this.col<=t.col)}isSouthWestOf(t){return this.row>=t.row&&(_classPrivateFieldGet$50(_isRtl$2,this)?this.col>=t.col:this.col<=t.col)}isNorthEastOf(t){return this.row<=t.row&&(_classPrivateFieldGet$50(_isRtl$2,this)?this.col<=t.col:this.col>=t.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(t){return Number.isInteger(t?.row)&&(this.row=t.row),Number.isInteger(t?.col)&&(this.col=t.col),t instanceof or&&_classPrivateFieldSet$46(_isRtl$2,this,t.isRtl()),this}clone(){return new or(this.row,this.col,_classPrivateFieldGet$50(_isRtl$2,this))}toObject(){return{row:this.row,col:this.col}}},coords_default=CellCoords,import_es_error_cause$153=__toESM(require_es_error_cause(),1),import_es_array_push$100=__toESM(require_es_array_push(),1);function _classPrivateFieldInitSpec$49(e,t,i){_checkPrivateRedeclaration$67(e,t),t.set(e,i)}function _checkPrivateRedeclaration$67(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$106(e,t,i){return(t=_toPropertyKey$107(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$107(e){var t=_toPrimitive$107(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$107(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet$49(e,t){return e.get(_assertClassBrand$67(e,t))}function _classPrivateFieldSet$45(e,t,i){return e.set(_assertClassBrand$67(e,t),i),i}function _assertClassBrand$67(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _isRtl$1=new WeakMap,CellRange=class Qr{constructor(t){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;_defineProperty$106(this,"highlight",null),_defineProperty$106(this,"from",null),_defineProperty$106(this,"to",null),_classPrivateFieldInitSpec$49(this,_isRtl$1,!1),this.highlight=t.clone(),this.from=i.clone(),this.to=r.clone(),_classPrivateFieldSet$45(_isRtl$1,this,o)}setHighlight(t){return this.highlight=t.clone(),this}setFrom(t){return this.from=t.clone(),this}setTo(t){return this.to=t.clone(),this}isValid(t){return this.from.isValid(t)&&this.to.isValid(t)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const t=Math.max(this.from.row,0),i=Math.max(this.to.row,0);return Math.max(t,i)-Math.min(t,i)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const t=Math.max(this.from.col,0),i=Math.max(this.to.col,0);return Math.max(t,i)-Math.min(t,i)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(t){const{row:i,col:r}=t,o=this.getOuterTopStartCorner(),a=this.getOuterBottomEndCorner();return o.row<=i&&a.row>=i&&o.col<=r&&a.col>=r}includesRange(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}isEqual(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}overlaps(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}isNorthWestOf(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}isOverlappingHorizontally(t){return this.getOuterTopEndCorner().col>=t.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=t.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=t.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=t.getOuterTopStartCorner().col}isOverlappingVertically(t){return this.getOuterBottomStartCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=t.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=t.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=t.getOuterTopRightCorner().row}expand(t){const i=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return t.row<i.row||t.col<i.col||t.row>r.row||t.col>r.col?(this.from=this._createCellCoords(Math.min(i.row,t.row),Math.min(i.col,t.col)),this.to=this._createCellCoords(Math.max(r.row,t.row),Math.max(r.col,t.col)),!0):!1}expandByRange(t){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(t)||!this.overlaps(t))return!1;const r=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),a=this.getDirection(),c=t.getOuterTopStartCorner(),u=t.getOuterBottomEndCorner(),h=Math.min(r.row,c.row),d=Math.min(r.col,c.col),f=Math.max(o.row,u.row),m=Math.max(o.col,u.col),g=this._createCellCoords(h,d),v=this._createCellCoords(f,m);return this.from=g,this.to=v,this.setDirection(a),i&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(t){switch(t){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break;default:break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break;default:break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break;default:break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return _classPrivateFieldGet$49(_isRtl$1,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return _classPrivateFieldGet$49(_isRtl$1,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return _classPrivateFieldGet$49(_isRtl$1,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return _classPrivateFieldGet$49(_isRtl$1,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return _classPrivateFieldGet$49(_isRtl$1,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return _classPrivateFieldGet$49(_isRtl$1,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return _classPrivateFieldGet$49(_isRtl$1,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return _classPrivateFieldGet$49(_isRtl$1,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(t){return t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(t){if(!(t instanceof coords_default))return!1;if(t.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(t.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(t.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(t.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(t){if(!this.includesRange(t))return[];const i={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(t.from.row,t.to.row),bottom:Math.max(t.from.row,t.to.row),left:Math.min(t.from.col,t.to.col),right:Math.max(t.from.col,t.to.col)},o=[];return i.top===r.top&&o.push("top"),i.right===r.right&&o.push(_classPrivateFieldGet$49(_isRtl$1,this)?"left":"right"),i.bottom===r.bottom&&o.push("bottom"),i.left===r.left&&o.push(_classPrivateFieldGet$49(_isRtl$1,this)?"right":"left"),o}getInner(){const t=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),r=[];for(let o=t.row;o<=i.row;o++)for(let a=t.col;a<=i.col;a++)!(this.from.row===o&&this.from.col===a)&&!(this.to.row===o&&this.to.col===a)&&r.push(this._createCellCoords(o,a));return r}getAll(){const t=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),r=[];for(let o=t.row;o<=i.row;o++)for(let a=t.col;a<=i.col;a++)t.row===o&&t.col===a?r.push(t):i.row===o&&i.col===a?r.push(i):r.push(this._createCellCoords(o,a));return r}forAll(t){const i=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let o=i.row;o<=r.row;o++)for(let a=i.col;a<=r.col;a++)if(t(o,a)===!1)return}clone(){return new Qr(this.highlight,this.from,this.to,_classPrivateFieldGet$49(_isRtl$1,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(t,i){return new coords_default(t,i,_classPrivateFieldGet$49(_isRtl$1,this))}},range_default$1=CellRange,import_es_error_cause$152=__toESM(require_es_error_cause(),1);function _classPrivateFieldInitSpec$48(e,t,i){_checkPrivateRedeclaration$66(e,t),t.set(e,i)}function _checkPrivateRedeclaration$66(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$48(e,t){return e.get(_assertClassBrand$66(e,t))}function _classPrivateFieldSet$44(e,t,i){return e.set(_assertClassBrand$66(e,t),i),i}function _assertClassBrand$66(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _wtSettings=new WeakMap,_domBindings=new WeakMap,_wtTable=new WeakMap,_selectionManager=new WeakMap,_parent=new WeakMap,_eventManager=new WeakMap,_facadeGetter=new WeakMap,_selectedCellBeforeTouchEnd=new WeakMap,_dblClickTimeout=new WeakMap,_dblClickOrigin=new WeakMap,Event$1=class{constructor(e,t,i,r,o,a){let c=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;_classPrivateFieldInitSpec$48(this,_wtSettings,void 0),_classPrivateFieldInitSpec$48(this,_domBindings,void 0),_classPrivateFieldInitSpec$48(this,_wtTable,void 0),_classPrivateFieldInitSpec$48(this,_selectionManager,void 0),_classPrivateFieldInitSpec$48(this,_parent,void 0),_classPrivateFieldInitSpec$48(this,_eventManager,void 0),_classPrivateFieldInitSpec$48(this,_facadeGetter,void 0),_classPrivateFieldInitSpec$48(this,_selectedCellBeforeTouchEnd,void 0),_classPrivateFieldInitSpec$48(this,_dblClickTimeout,[null,null]),_classPrivateFieldInitSpec$48(this,_dblClickOrigin,[null,null]),_classPrivateFieldSet$44(_wtSettings,this,i),_classPrivateFieldSet$44(_domBindings,this,t),_classPrivateFieldSet$44(_wtTable,this,o),_classPrivateFieldSet$44(_selectionManager,this,a),_classPrivateFieldSet$44(_parent,this,c),_classPrivateFieldSet$44(_eventManager,this,r),_classPrivateFieldSet$44(_facadeGetter,this,e),this.registerEvents()}registerEvents(){_classPrivateFieldGet$48(_eventManager,this).addEventListener(_classPrivateFieldGet$48(_wtTable,this).holder,"contextmenu",i=>this.onContextMenu(i)),_classPrivateFieldGet$48(_eventManager,this).addEventListener(_classPrivateFieldGet$48(_wtTable,this).TABLE,"mouseover",i=>this.onMouseOver(i)),_classPrivateFieldGet$48(_eventManager,this).addEventListener(_classPrivateFieldGet$48(_wtTable,this).TABLE,"mouseout",i=>this.onMouseOut(i));const e=()=>{_classPrivateFieldGet$48(_eventManager,this).addEventListener(_classPrivateFieldGet$48(_wtTable,this).holder,"touchstart",i=>this.onTouchStart(i)),_classPrivateFieldGet$48(_eventManager,this).addEventListener(_classPrivateFieldGet$48(_wtTable,this).holder,"touchend",i=>this.onTouchEnd(i)),this.momentumScrolling||(this.momentumScrolling={}),_classPrivateFieldGet$48(_eventManager,this).addEventListener(_classPrivateFieldGet$48(_wtTable,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||_classPrivateFieldGet$48(_wtSettings,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,_classPrivateFieldGet$48(_wtSettings,this).getSetting("onAfterMomentumScroll"))},200)})},t=()=>{_classPrivateFieldGet$48(_eventManager,this).addEventListener(_classPrivateFieldGet$48(_wtTable,this).holder,"mouseup",i=>this.onMouseUp(i)),_classPrivateFieldGet$48(_eventManager,this).addEventListener(_classPrivateFieldGet$48(_wtTable,this).holder,"mousedown",i=>this.onMouseDown(i))};isMobileBrowser()?e():(isTouchSupported()&&e(),t())}selectedCellWasTouched(e){const i=this.parentCell(e).coords;if(_classPrivateFieldGet$48(_selectedCellBeforeTouchEnd,this)&&i){const[r,o]=[i.row,_classPrivateFieldGet$48(_selectedCellBeforeTouchEnd,this).from.row],[a,c]=[i.col,_classPrivateFieldGet$48(_selectedCellBeforeTouchEnd,this).from.col];return r===o&&a===c}return!1}parentCell(e){const t={},i=_classPrivateFieldGet$48(_wtTable,this).TABLE,r=closestDown(e,["TD","TH"],i);return r?(t.coords=_classPrivateFieldGet$48(_wtTable,this).getCoords(r),t.TD=r):hasClass$1(e,"wtBorder")&&hasClass$1(e,"current")?(t.coords=_classPrivateFieldGet$48(_selectionManager,this).getFocusSelection().cellRange.highlight,t.TD=_classPrivateFieldGet$48(_wtTable,this).getCell(t.coords)):hasClass$1(e,"wtBorder")&&hasClass$1(e,"area")&&_classPrivateFieldGet$48(_selectionManager,this).getAreaSelection().cellRange&&(t.coords=_classPrivateFieldGet$48(_selectionManager,this).getAreaSelection().cellRange.to,t.TD=_classPrivateFieldGet$48(_wtTable,this).getCell(t.coords)),t}onMouseDown(e){const t=_classPrivateFieldGet$48(_domBindings,this).rootDocument.activeElement,i=partial(getParent,e.target),r=e.target;if(!["TD","TH"].includes(t.nodeName)&&(r===t||i(0)===t||i(1)===t))return;const o=this.parentCell(r);hasClass$1(r,"corner")?_classPrivateFieldGet$48(_wtSettings,this).getSetting("onCellCornerMouseDown",e,r):o.TD&&_classPrivateFieldGet$48(_wtSettings,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(_classPrivateFieldGet$48(_dblClickOrigin,this)[0]=o.TD,clearTimeout(_classPrivateFieldGet$48(_dblClickTimeout,this)[0]),_classPrivateFieldGet$48(_dblClickTimeout,this)[0]=setTimeout(()=>{_classPrivateFieldGet$48(_dblClickOrigin,this)[0]=null},1e3))}onContextMenu(e){if(_classPrivateFieldGet$48(_wtSettings,this).has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!_classPrivateFieldGet$48(_wtSettings,this).has("onCellMouseOver"))return;const t=_classPrivateFieldGet$48(_wtTable,this).TABLE,i=closestDown(e.target,["TD","TH"],t),r=_classPrivateFieldGet$48(_parent,this)||this;i&&i!==r.lastMouseOver&&isChildOf(i,t)&&(r.lastMouseOver=i,this.callListener("onCellMouseOver",e,_classPrivateFieldGet$48(_wtTable,this).getCoords(i),i))}onMouseOut(e){if(!_classPrivateFieldGet$48(_wtSettings,this).has("onCellMouseOut"))return;const t=_classPrivateFieldGet$48(_wtTable,this).TABLE,i=closestDown(e.target,["TD","TH"],t),r=closestDown(e.relatedTarget,["TD","TH"],t),o=_classPrivateFieldGet$48(_parent,this)||this;i&&i!==r&&isChildOf(i,t)&&(this.callListener("onCellMouseOut",e,_classPrivateFieldGet$48(_wtTable,this).getCoords(i),i),r===null&&(o.lastMouseOver=null))}onMouseUp(e){const t=this.parentCell(e.target);t.TD&&_classPrivateFieldGet$48(_wtSettings,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),!(e.button!==0&&!this.touchApplied)&&(t.TD===_classPrivateFieldGet$48(_dblClickOrigin,this)[0]&&t.TD===_classPrivateFieldGet$48(_dblClickOrigin,this)[1]?(hasClass$1(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),_classPrivateFieldGet$48(_dblClickOrigin,this)[0]=null,_classPrivateFieldGet$48(_dblClickOrigin,this)[1]=null):t.TD===_classPrivateFieldGet$48(_dblClickOrigin,this)[0]&&(_classPrivateFieldGet$48(_dblClickOrigin,this)[1]=t.TD,clearTimeout(_classPrivateFieldGet$48(_dblClickTimeout,this)[1]),_classPrivateFieldGet$48(_dblClickTimeout,this)[1]=setTimeout(()=>{_classPrivateFieldGet$48(_dblClickOrigin,this)[1]=null},500)))}onTouchStart(e){_classPrivateFieldSet$44(_selectedCellBeforeTouchEnd,this,_classPrivateFieldGet$48(_selectionManager,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const i=e.target,r=(t=this.parentCell(i))===null||t===void 0?void 0:t.coords,o=isDefined(r)&&r.row>=0&&r.col>=0;if(e.cancelable&&o&&_classPrivateFieldGet$48(_wtSettings,this).getSetting("isDataViewInstance")){const c=["A","BUTTON","INPUT"];isIOS()&&(isChromeWebKit()||isFirefoxWebKit())&&this.selectedCellWasTouched(i)&&!c.includes(i.tagName)?e.preventDefault():this.selectedCellWasTouched(i)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,i,r){const o=_classPrivateFieldGet$48(_wtSettings,this).getSettingPure(e);o&&o(t,i,r,_classPrivateFieldGet$48(_facadeGetter,this).call(this))}destroy(){clearTimeout(_classPrivateFieldGet$48(_dblClickTimeout,this)[0]),clearTimeout(_classPrivateFieldGet$48(_dblClickTimeout,this)[1]),_classPrivateFieldGet$48(_eventManager,this).destroy()}},event_default=Event$1,import_es_error_cause$151=__toESM(require_es_error_cause(),1);function _defineProperty$105(e,t,i){return(t=_toPropertyKey$106(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$106(e){var t=_toPrimitive$106(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$106(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ColumnFilter=class{constructor(e,t,i){_defineProperty$105(this,"offset",void 0),_defineProperty$105(this,"total",void 0),_defineProperty$105(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}},column_default=ColumnFilter,import_es_error_cause$150=__toESM(require_es_error_cause(),1);function _defineProperty$104(e,t,i){return(t=_toPropertyKey$105(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$105(e){var t=_toPrimitive$105(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$105(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RowFilter=class{constructor(e,t,i){_defineProperty$104(this,"offset",void 0),_defineProperty$104(this,"total",void 0),_defineProperty$104(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}},row_default=RowFilter;const WORKING_SPACE_ALL=0,WORKING_SPACE_TOP=1,WORKING_SPACE_BOTTOM=2;var import_es_error_cause$149=__toESM(require_es_error_cause(),1);function _defineProperty$103(e,t,i){return(t=_toPropertyKey$104(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$104(e){var t=_toPrimitive$104(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$104(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ViewSize=class{constructor(){_defineProperty$103(this,"currentSize",0),_defineProperty$103(this,"nextSize",0),_defineProperty$103(this,"currentOffset",0),_defineProperty$103(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}},import_es_error_cause$148=__toESM(require_es_error_cause(),1);function _defineProperty$102(e,t,i){return(t=_toPropertyKey$103(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$103(e){var t=_toPrimitive$103(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$103(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ViewSizeSet=class{constructor(){_defineProperty$102(this,"size",new ViewSize),_defineProperty$102(this,"workingSpace",WORKING_SPACE_ALL),_defineProperty$102(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof ViewSize}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=WORKING_SPACE_TOP,e.workingSpace=WORKING_SPACE_BOTTOM,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=WORKING_SPACE_BOTTOM,e.workingSpace=WORKING_SPACE_TOP,this.sharedSize=e.getViewSize()}},import_es_error_cause$147=__toESM(require_es_error_cause(),1),import_es_array_push$99=__toESM(require_es_array_push(),1);function _defineProperty$101(e,t,i){return(t=_toPropertyKey$102(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$102(e){var t=_toPrimitive$102(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$102(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OrderView=class{constructor(e,t,i){_defineProperty$101(this,"rootNode",void 0),_defineProperty$101(this,"nodesPool",void 0),_defineProperty$101(this,"sizeSet",new ViewSizeSet),_defineProperty$101(this,"childNodeType",void 0),_defineProperty$101(this,"visualIndex",0),_defineProperty$101(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=t,this.childNodeType=i.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:t}=this;let i=0;if(this.isSharedViewSet()){let r=e.firstElementChild;for(;r;){if(r.tagName===this.childNodeType)i+=1;else if(t.isPlaceOn(WORKING_SPACE_TOP))break;r=r.nextElementSibling}}else i=e.childElementCount;return i}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:t}=this,i=this.isSharedViewSet(),{nextSize:r}=t.getViewSize();let o=this.getRenderedChildCount();for(;o<r;){const c=this.nodesPool();!i||i&&t.isPlaceOn(WORKING_SPACE_BOTTOM)?e.appendChild(c):e.insertBefore(c,e.firstChild),o+=1}const a=i&&t.isPlaceOn(WORKING_SPACE_TOP);for(;o>r;)e.removeChild(a?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:t}=this;let i=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(WORKING_SPACE_BOTTOM)&&(i+=t.sharedSize.nextSize);let r=e.childNodes[i];if(r.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,r),r=o}this.collectedNodes.push(r),this.visualIndex+=1}end(){}},SharedOrderView=class extends OrderView{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}},import_es_error_cause$146=__toESM(require_es_error_cause(),1);function _defineProperty$100(e,t,i){return(t=_toPropertyKey$101(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$101(e){var t=_toPrimitive$101(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$101(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NodesPool=class{constructor(e){_defineProperty$100(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}},import_es_error_cause$145=__toESM(require_es_error_cause(),1);function _defineProperty$99(e,t,i){return(t=_toPropertyKey$100(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$100(e){var t=_toPrimitive$100(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$100(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BaseRenderer=class{constructor(e,t){_defineProperty$99(this,"nodesPool",null),_defineProperty$99(this,"nodeType",void 0),_defineProperty$99(this,"rootNode",void 0),_defineProperty$99(this,"table",null),_defineProperty$99(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new NodesPool(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}},import_es_error_cause$144=__toESM(require_es_error_cause(),1);function _defineProperty$98(e,t,i){return(t=_toPropertyKey$99(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$99(e){var t=_toPrimitive$99(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$99(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RowHeadersRenderer=class extends BaseRenderer{constructor(){super("TH"),_defineProperty$98(this,"orderViews",new WeakMap),_defineProperty$98(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new SharedOrderView(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:i,rows:r,cells:o}=this.table;for(let a=0;a<e;a++){const c=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=c;const h=this.obtainOrderView(u),d=o.obtainOrderView(u);h.appendView(d).setSize(i).setOffset(this.table.renderedColumnToSource(0)).start();for(let f=0;f<i;f++){h.render();const m=h.getCurrentNode();m.className="",m.removeAttribute("style"),removeAttribute(m,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&setAttribute(m,[A11Y_ROWHEADER(),A11Y_SCOPE_ROW(),A11Y_COLINDEX(f+1),A11Y_TABINDEX(-1)]),t[f](c,m,f)}h.end()}}},ColumnHeadersRenderer=class extends BaseRenderer{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let i=this.rootNode.firstChild;if(e){const{columnsToRender:r}=this.table,o=r+t;for(let c=0,u=e;c<u;c++){for(i=this.rootNode.childNodes[c],i||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<o;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)i.removeChild(i.lastChild),this.renderedNodes-=1}const a=this.rootNode.childNodes.length;if(a>e)for(let c=e;c<a;c++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&empty(i)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&setAttribute(this.rootNode,[A11Y_ROWGROUP()]);for(let t=0;t<e;t+=1){const{columnHeaderFunctions:i,columnsToRender:r,rowHeadersCount:o}=this.table,a=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&setAttribute(a,[A11Y_ROW(),A11Y_ROWINDEX(t+1)]);for(let c=-1*o;c<r;c+=1){const u=this.table.renderedColumnToSource(c),h=a.childNodes[c+o];h.className="",h.removeAttribute("style"),removeAttribute(h,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&setAttribute(h,[A11Y_COLINDEX(c+1+this.table.rowHeadersCount),A11Y_TABINDEX(-1),A11Y_COLUMNHEADER(),...c>=0?[A11Y_SCOPE_COL()]:[A11Y_ROW()]]),i[t](u,h,t)}}}};let performanceWarningAppeared$1=!1;var ColGroupRenderer=class extends BaseRenderer{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,i=e+t;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;!performanceWarningAppeared$1&&e>1e3&&(performanceWarningAppeared$1=!0,warn(toSingleLine`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let r=0;r<t;r++){const o=this.table.renderedColumnToSource(r),a=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[r].style.width=`${a}px`}for(let r=0;r<e;r++){const o=this.table.renderedColumnToSource(r),a=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[r+t].style.width=`${a}px`}const i=this.rootNode.firstChild;i&&addClass$1(i,"rowHeader")}},import_es_error_cause$143=__toESM(require_es_error_cause(),1);function _defineProperty$97(e,t,i){return(t=_toPropertyKey$98(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$98(e){var t=_toPrimitive$98(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$98(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}const ROW_CLASSNAMES={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let performanceWarningAppeared=!1;var RowsRenderer=class extends BaseRenderer{constructor(e){super("TR",e),_defineProperty$97(this,"orderView",void 0),this.orderView=new OrderView(e,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!performanceWarningAppeared&&e>1e3&&(performanceWarningAppeared=!0,warn(toSingleLine`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&setAttribute(this.rootNode,[A11Y_ROWGROUP()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let r=0;r<e;r++){this.orderView.render();const o=this.orderView.getCurrentNode(),a=this.table.renderedRowToSource(r);if(this.table.isAriaEnabled()){var t,i;setAttribute(o,[A11Y_ROW(),A11Y_ROWINDEX(a+((t=(i=this.table.rowUtils)===null||i===void 0||(i=i.dataAccessObject)===null||i===void 0?void 0:i.columnHeaders.length)!==null&&t!==void 0?t:0)+1)])}removeClass$1(o,[ROW_CLASSNAMES.rowEven,ROW_CLASSNAMES.rowOdd]),(a+1)%2===0?addClass$1(o,ROW_CLASSNAMES.rowEven):addClass$1(o,ROW_CLASSNAMES.rowOdd)}this.orderView.end()}},import_es_error_cause$142=__toESM(require_es_error_cause(),1);function _defineProperty$96(e,t,i){return(t=_toPropertyKey$97(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$97(e){var t=_toPrimitive$97(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$97(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CellsRenderer=class extends BaseRenderer{constructor(){super("TD"),_defineProperty$96(this,"orderViews",new WeakMap),_defineProperty$96(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new SharedOrderView(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:i,rowHeaders:r}=this.table;for(let c=0;c<e;c++){const u=this.table.renderedRowToSource(c),h=i.getRenderedNode(c);this.sourceRowIndex=u;const d=this.obtainOrderView(h),f=r.obtainOrderView(h);d.prependView(f).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let m=0;m<t;m++){d.render();const g=d.getCurrentNode(),v=this.table.renderedColumnToSource(m);if(hasClass$1(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),removeAttribute(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(u,v,g),this.table.isAriaEnabled()){var o,a;setAttribute(g,[...g.hasAttribute("role")?[]:[A11Y_GRIDCELL()],A11Y_TABINDEX(-1),A11Y_COLINDEX(v+((o=(a=this.table.rowUtils)===null||a===void 0||(a=a.dataAccessObject)===null||a===void 0?void 0:a.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}d.end()}}},import_es_error_cause$141=__toESM(require_es_error_cause(),1);function _defineProperty$95(e,t,i){return(t=_toPropertyKey$96(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$96(e){var t=_toPrimitive$96(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$96(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TableRenderer=class{constructor(e){let{cellRenderer:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};_defineProperty$95(this,"rootNode",void 0),_defineProperty$95(this,"rootDocument",void 0),_defineProperty$95(this,"rowHeaders",null),_defineProperty$95(this,"columnHeaders",null),_defineProperty$95(this,"colGroup",null),_defineProperty$95(this,"rows",null),_defineProperty$95(this,"cells",null),_defineProperty$95(this,"rowFilter",null),_defineProperty$95(this,"columnFilter",null),_defineProperty$95(this,"rowUtils",null),_defineProperty$95(this,"columnUtils",null),_defineProperty$95(this,"rowsToRender",0),_defineProperty$95(this,"columnsToRender",0),_defineProperty$95(this,"rowHeaderFunctions",[]),_defineProperty$95(this,"rowHeadersCount",0),_defineProperty$95(this,"columnHeaderFunctions",[]),_defineProperty$95(this,"columnHeadersCount",0),_defineProperty$95(this,"cellRenderer",void 0),_defineProperty$95(this,"activeOverlayName",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:i,rows:r,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),t.setTable(this),i.setTable(this),r.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=i,this.rows=r,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let i=0;i<e;i++){const r=t.getRenderedNode(i);if(r.firstChild){const o=this.renderedRowToSource(i),a=this.rowUtils.getHeightByOverlayName(o,this.activeOverlayName);a?r.firstChild.style.height=`${a-1}px`:r.firstChild.style.height=""}}}},Renderer$2=class{constructor(){let{TABLE:e,THEAD:t,COLGROUP:i,TBODY:r,rowUtils:o,columnUtils:a,cellRenderer:c}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new TableRenderer(e,{cellRenderer:c}),this.renderer.setRenderers({rowHeaders:new RowHeadersRenderer,columnHeaders:new ColumnHeadersRenderer(t),colGroup:new ColGroupRenderer(i),rows:new RowsRenderer(r),cells:new CellsRenderer}),this.renderer.setAxisUtils(o,a)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}},import_es_error_cause$140=__toESM(require_es_error_cause(),1);function _classPrivateFieldInitSpec$47(e,t,i){_checkPrivateRedeclaration$65(e,t),t.set(e,i)}function _checkPrivateRedeclaration$65(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$94(e,t,i){return(t=_toPropertyKey$95(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$95(e){var t=_toPrimitive$95(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$95(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet$47(e,t){return e.get(_assertClassBrand$65(e,t))}function _classPrivateFieldSet$43(e,t,i){return e.set(_assertClassBrand$65(e,t),i),i}function _assertClassBrand$65(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _totalTargetWidth=new WeakMap,_totalColumns=new WeakMap,_stretchingColumnWidthFn=new WeakMap,_columnWidthFn=new WeakMap,_stretchMode=new WeakMap,ColumnStretching=class{constructor(e){let{totalColumns:t,stretchMode:i,stretchingColumnWidthFn:r,columnWidthFn:o}=e;_defineProperty$94(this,"stretchAllRatio",0),_defineProperty$94(this,"stretchLastWidth",0),_defineProperty$94(this,"stretchAllColumnsWidth",[]),_classPrivateFieldInitSpec$47(this,_totalTargetWidth,0),_defineProperty$94(this,"needVerifyLastColumnWidth",!0),_classPrivateFieldInitSpec$47(this,_totalColumns,()=>0),_classPrivateFieldInitSpec$47(this,_stretchingColumnWidthFn,a=>a),_classPrivateFieldInitSpec$47(this,_columnWidthFn,a=>a),_classPrivateFieldInitSpec$47(this,_stretchMode,()=>"none"),_classPrivateFieldSet$43(_totalColumns,this,t),_classPrivateFieldSet$43(_stretchMode,this,i),_classPrivateFieldSet$43(_stretchingColumnWidthFn,this,r??_classPrivateFieldGet$47(_stretchingColumnWidthFn,this)),_classPrivateFieldSet$43(_columnWidthFn,this,o??_classPrivateFieldGet$47(_columnWidthFn,this))}refreshStretching(e){if(_classPrivateFieldGet$47(_stretchMode,this).call(this)==="none")return;this.stretchAllRatio=0,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0,this.stretchLastWidth=0,_classPrivateFieldSet$43(_totalTargetWidth,this,e);let t=0;for(let r=0;r<_classPrivateFieldGet$47(_totalColumns,this).call(this);r++){const o=this._getColumnWidth(r),a=_classPrivateFieldGet$47(_stretchingColumnWidthFn,this).call(this,void 0,r);typeof a=="number"?e-=a:t+=o}const i=e-t;if(_classPrivateFieldGet$47(_stretchMode,this).call(this)==="all"&&i>0)this.stretchAllRatio=e/t,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(_classPrivateFieldGet$47(_stretchMode,this).call(this)==="last"&&e!==1/0){const r=this._getColumnWidth(_classPrivateFieldGet$47(_totalColumns,this).call(this)-1),o=i+r;this.stretchLastWidth=o>=0?o:r}}getStretchedColumnWidth(e,t){let i=null;return _classPrivateFieldGet$47(_stretchMode,this).call(this)==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(e,t):_classPrivateFieldGet$47(_stretchMode,this).call(this)==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(e)),i}_getStretchedAllColumnWidth(e,t){let i=0;if(!this.stretchAllColumnsWidth[e]){const r=Math.round(t*this.stretchAllRatio),o=_classPrivateFieldGet$47(_stretchingColumnWidthFn,this).call(this,r,e);o===void 0?this.stretchAllColumnsWidth[e]=r:this.stretchAllColumnsWidth[e]=isNaN(o)?this._getColumnWidth(e):o}if(this.stretchAllColumnsWidth.length===_classPrivateFieldGet$47(_totalColumns,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let r=0;r<this.stretchAllColumnsWidth.length;r++)i+=this.stretchAllColumnsWidth[r];i!==_classPrivateFieldGet$47(_totalTargetWidth,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=_classPrivateFieldGet$47(_totalTargetWidth,this)-i)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===_classPrivateFieldGet$47(_totalColumns,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let t=_classPrivateFieldGet$47(_columnWidthFn,this).call(this,e);return isNaN(t)&&(t=DEFAULT_WIDTH),t}},import_es_error_cause$139=__toESM(require_es_error_cause(),1);function _defineProperty$93(e,t,i){return(t=_toPropertyKey$94(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$94(e){var t=_toPrimitive$94(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$94(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ColumnUtils=class{constructor(e,t){_defineProperty$93(this,"dataAccessObject",void 0),_defineProperty$93(this,"wtSettings",void 0),_defineProperty$93(this,"headerWidths",new Map),_defineProperty$93(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=t,this.stretching=new ColumnStretching({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(i,r)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",i,r),columnWidthFn:i=>this.dataAccessObject.wtTable.getColumnWidth(i)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let t=this.getWidth(e);const i=this.stretching.getStretchedColumnWidth(e,t);return i&&(t=i),t}getHeaderHeight(e){let t=this.wtSettings.getSetting("defaultRowHeight");const i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return i!==void 0&&(t=t?Math.max(t,i):i),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){const{wtTable:e,wtViewport:t,cloneSource:i}=this.dataAccessObject,r=i?i.wtTable.holder:e.holder,o=r.offsetHeight<r.scrollHeight?getScrollbarWidth():0;this.stretching.refreshStretching(t.getViewportWidth()-o)}calculateWidths(){const{wtSettings:e}=this;let t=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),t=e.getSetting("onModifyRowHeaderWidth",t),t!=null){const i=e.getSetting("rowHeaders").length,r=e.getSetting("defaultColumnWidth");for(let o=0;o<i;o++){let a=Array.isArray(t)?t[o]:t;a=a??r,this.headerWidths.set(o,a)}}}},import_es_error_cause$138=__toESM(require_es_error_cause(),1);function _defineProperty$92(e,t,i){return(t=_toPropertyKey$93(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$93(e){var t=_toPrimitive$93(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$93(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RowUtils=class{constructor(e,t){_defineProperty$92(this,"dataAccessObject",void 0),_defineProperty$92(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(t=t===void 0?i:Math.max(t,i)),t}getHeightByOverlayName(e,t){let i=this.wtSettings.getSetting("rowHeightByOverlayName",e,t);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(i=i===void 0?r:Math.max(i,r)),i}},import_es_error_cause$137=__toESM(require_es_error_cause(),1),import_es_array_push$98=__toESM(require_es_array_push(),1);function _defineProperty$91(e,t,i){return(t=_toPropertyKey$92(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$92(e){var t=_toPrimitive$92(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$92(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Table=class{constructor(e,t,i,r,o){_defineProperty$91(this,"wtSettings",null),_defineProperty$91(this,"domBindings",void 0),_defineProperty$91(this,"TBODY",null),_defineProperty$91(this,"THEAD",null),_defineProperty$91(this,"COLGROUP",null),_defineProperty$91(this,"hasTableHeight",!0),_defineProperty$91(this,"hasTableWidth",!0),_defineProperty$91(this,"isTableVisible",!1),_defineProperty$91(this,"tableOffset",0),_defineProperty$91(this,"holderOffset",0),this.domBindings=i,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=r,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,removeTextNodes(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const a=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(a)),this.rowUtils=new RowUtils(this.dataAccessObject,this.wtSettings),this.columnUtils=new ColumnUtils(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Renderer$2({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let i;return(!t||t.nodeType!==Node.ELEMENT_NODE||!hasClass$1(t,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",t&&t.insertBefore(i,e),i.appendChild(e)),i.style.position="relative",this.wtSettings.getSetting("ariaTags")&&setAttribute(i,[A11Y_PRESENTATION()]),i}createHider(e){const t=e.parentNode;let i;return(!t||t.nodeType!==Node.ELEMENT_NODE||!hasClass$1(t,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",t&&t.insertBefore(i,e),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&setAttribute(i,[A11Y_PRESENTATION()]),i}createHolder(e){const t=e.parentNode;let i;return(!t||t.nodeType!==Node.ELEMENT_NODE||!hasClass$1(t,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",t&&t.insertBefore(i,e),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&setAttribute(i.parentNode,[A11Y_PRESENTATION()])),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&setAttribute(i,[A11Y_PRESENTATION()]),i}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,{wtOverlays:i,wtViewport:r}=this.dataAccessObject,o=t.getSetting("totalRows"),a=t.getSetting("totalColumns"),c=t.getSetting("rowHeaders"),u=c.length,h=t.getSetting("columnHeaders"),d=h.length;let f=e;if(this.isMaster&&(i.beforeDraw(),this.holderOffset=offset$2(this.holder),f=r.createCalculators(f),u&&!t.getSetting("fixedColumnsStart"))){const g=i.inlineStartOverlay.getScrollPosition(),v=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,v!==this.correctHeaderWidth&&(f=!1)}if(f)this.isMaster&&i.refresh(!0);else{this.isMaster?this.tableOffset=offset$2(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const g=o>0?this.getFirstRenderedRow():0,v=a>0?this.getFirstRenderedColumn():0;this.rowFilter=new row_default(g,o,d),this.columnFilter=new column_default(v,a,u);let _=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const b={};this.wtSettings.getSetting("beforeDraw",!0,b),_=b.skipRender!==!0}if(_){this.tableRenderer.setHeaderContentRenderers(c,h),(this.is(CLONE_BOTTOM)||this.is(CLONE_BOTTOM_INLINE_START_CORNER))&&this.tableRenderer.setHeaderContentRenderers(c,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let b;if(this.isMaster&&(b=this.dataAccessObject.workspaceWidth,r.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(CLONE_BOTTOM))&&this.markOversizedRows(),this.isMaster){this.wtSettings.getSetting("externalRowCalculator")||r.createVisibleCalculators(),i.refresh(!1),i.applyToDOM();const S=outerWidth(this.hider),T=outerWidth(this.TABLE);S!==0&&T!==S&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),b!==r.getWorkspaceWidth()&&(r.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(CLONE_BOTTOM)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let m=!1;return this.isMaster&&(m=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(m=i.bottomOverlay.resetFixedPosition()||m),m=i.inlineStartOverlay.resetFixedPosition()||m,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),m?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(f),this.isMaster&&i.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let i=this.wtSettings.getSetting("columnHeaders").length;const r=this.wtSettings.getSetting("defaultRowHeight");let o,a,c;const u=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;i;)i-=1,o=this.getColumnHeaderHeight(i),a=this.getColumnHeader(t,i),a&&(c=innerHeight(a),(!o&&r<c||o<c)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=c),Array.isArray(u)?u[i]!==null&&u[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u[i]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(u[i]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u[i]||u))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=e.getSetting("columnHeaders");for(let o=0,a=r.length;o<a;o++)if(i[o]){if(!t[o]||t[o].childNodes.length===0)return;t[o].childNodes[0].style.height=`${i[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(CLONE_BOTTOM))&&!e.getSetting("externalRowCalculator")){const i=this.getRenderedRowsCount();for(let r=0;r<i;r++){const o=this.rowFilter.renderedToSource(r);t.oversizedRows&&t.oversizedRows[o]&&(t.oversizedRows[o]=void 0)}}}getCell(e){let t=e.row,i=e.col;const r=this.wtSettings.getSetting("onModifyGetCellCoords",t,i);if(r&&Array.isArray(r)&&([t,i]=r),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;const o=this.getRow(t);if(!o&&t>=0)throw new Error("TR was expected to be rendered but is not");const a=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!a&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return a}getRow(e){let t=null,i=null;if(e<0){var r;t=(r=this.rowFilter)===null||r===void 0?void 0:r.sourceRowToVisibleColHeadedRow(e),i=this.THEAD}else{var o;t=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),i=this.TBODY}return t!==void 0&&i!==void 0?i.childNodes.length<t+1?!1:i.childNodes[t]:!1}getColumnHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.THEAD.childNodes[t];return i?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(r=>{const o=r.childNodes[i];o&&t.push(o)}),t}getRowHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.wtSettings.getSetting("rowHeaders").length;if(t>=i)return;const r=this.rowFilter.sourceToRendered(e),o=r<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):r,c=(r<0?this.THEAD:this.TBODY).childNodes[o];return c?.childNodes[t]}getRowHeaders(e){const t=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<i;r++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],a=o?.childNodes[r];a&&t.push(a)}return t}getCoords(e){let t=e;if(t.nodeName!=="TD"&&t.nodeName!=="TH"&&(t=closest(t,["TD","TH"])),t===null)return null;const i=t.parentNode,r=i.parentNode;let o=index(i),a=t.cellIndex;return overlayContainsElement(CLONE_TOP_INLINE_START_CORNER,t,this.wtRootElement)||overlayContainsElement(CLONE_TOP,t,this.wtRootElement)?r.nodeName==="THEAD"&&(o-=r.childNodes.length):overlayContainsElement(CLONE_BOTTOM_INLINE_START_CORNER,t,this.wtRootElement)||overlayContainsElement(CLONE_BOTTOM,t,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-r.childNodes.length+o:r===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),overlayContainsElement(CLONE_TOP_INLINE_START_CORNER,t,this.wtRootElement)||overlayContainsElement(CLONE_INLINE_START,t,this.wtRootElement)||overlayContainsElement(CLONE_BOTTOM_INLINE_START_CORNER,t,this.wtRootElement)?a=this.columnFilter.offsettedTH(a):a=this.columnFilter.visibleRowHeadedColumnToSourceColumn(a),this.wot.createCellCoords(o,a)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=e*this.wtSettings.getSetting("defaultRowHeight"),i=innerHeight(this.TBODY)-1;let r,o,a,c,u;if(!(t===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,a=this.rowFilter.renderedToSource(e),r=this.getRowHeight(a),c=this.getTrForRow(a),u=c.querySelector("th"),u?o=innerHeight(u):o=innerHeight(c)-1,(!r&&this.wtSettings.getSetting("defaultRowHeight")<o||r<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[a]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=i}isRowHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=i}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return outerWidth(this.TABLE)}getHeight(){return outerHeight(this.TABLE)}getTotalWidth(){const e=outerWidth(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=outerHeight(this.hider);return e!==0?e:this.getHeight()}isVisible(){return isVisible$1(this.TABLE)}_modifyRowHeaderWidth(e){let t=isFunction$2(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return typeof e!="number"&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}},table_default=Table;const MIXIN_NAME$6="stickyRowsBottom",stickyRowsBottom={getFirstRenderedRow(){const e=this.wtSettings.getSetting("totalRows"),t=this.wtSettings.getSetting("fixedRowsBottom"),i=e-t;return e===0||t===0?-1:i<0?0:i},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};defineGetter(stickyRowsBottom,"MIXIN_NAME",MIXIN_NAME$6,{writable:!1,enumerable:!1});var stickyRowsBottom_default=stickyRowsBottom;const MIXIN_NAME$5="stickyColumnsStart",stickyColumnsStart={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const e=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),e)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};defineGetter(stickyColumnsStart,"MIXIN_NAME",MIXIN_NAME$5,{writable:!1,enumerable:!1});var stickyColumnsStart_default=stickyColumnsStart,BottomInlineStartCornerOverlayTable=class extends table_default{constructor(e,t,i,r){super(e,t,i,r,CLONE_BOTTOM_INLINE_START_CORNER)}};mixin(BottomInlineStartCornerOverlayTable,stickyRowsBottom_default),mixin(BottomInlineStartCornerOverlayTable,stickyColumnsStart_default);var bottomInlineStartCorner_default=BottomInlineStartCornerOverlayTable;const CLONE_TOP="top",CLONE_BOTTOM="bottom",CLONE_INLINE_START="inline_start",CLONE_TOP_INLINE_START_CORNER="top_inline_start_corner",CLONE_BOTTOM_INLINE_START_CORNER="bottom_inline_start_corner",CLONE_TYPES=[CLONE_TOP,CLONE_BOTTOM,CLONE_INLINE_START,CLONE_TOP_INLINE_START_CORNER,CLONE_BOTTOM_INLINE_START_CORNER],CLONE_CLASS_NAMES=new Map([[CLONE_TOP,`ht_clone_${CLONE_TOP}`],[CLONE_BOTTOM,`ht_clone_${CLONE_BOTTOM}`],[CLONE_INLINE_START,`ht_clone_${CLONE_INLINE_START} ht_clone_left`],[CLONE_TOP_INLINE_START_CORNER,`ht_clone_${CLONE_TOP_INLINE_START_CORNER} ht_clone_top_left_corner`],[CLONE_BOTTOM_INLINE_START_CORNER,`ht_clone_${CLONE_BOTTOM_INLINE_START_CORNER} ht_clone_bottom_left_corner`]]);var import_es_error_cause$136=__toESM(require_es_error_cause(),1);function _classPrivateMethodInitSpec$46(e,t){_checkPrivateRedeclaration$64(e,t),t.add(e)}function _checkPrivateRedeclaration$64(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$90(e,t,i){return(t=_toPropertyKey$91(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$91(e){var t=_toPrimitive$91(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$91(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand$64(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _Scroll_brand=new WeakSet,Scroll=class{constructor(e){_classPrivateMethodInitSpec$46(this,_Scroll_brand),_defineProperty$90(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,t,i,r,o){const a=this.scrollViewportHorizontally(e.col,i,o),c=this.scrollViewportVertically(e.row,t,r);return a||c}scrollViewportHorizontally(e,t,i){const{drawn:r,totalColumns:o}=this.dataAccessObject;if(!r||!Number.isInteger(e)||e<0||e>o)return!1;const a=t===void 0&&i===void 0,{fixedColumnsStart:c,inlineStartOverlay:u}=this.dataAccessObject;if(a&&e<c||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),!Number.isInteger(e)||e<0||e>o))return!1;const h=this.getFirstVisibleColumn(),d=this.getLastVisibleColumn();let f=!1;return(a&&(e<h||e>d)||!a)&&(f=u.scrollTo(e,a?e>=this.getLastPartiallyVisibleColumn():t)),f}scrollViewportVertically(e,t,i){const{drawn:r,totalRows:o}=this.dataAccessObject;if(!r||!Number.isInteger(e)||e<0||e>o)return!1;const a=t===void 0&&i===void 0,{fixedRowsBottom:c,fixedRowsTop:u,topOverlay:h}=this.dataAccessObject;if(a&&(e<u||e>o-c-1)||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),!Number.isInteger(e)||e<0||e>o))return!1;const d=this.getFirstVisibleRow(),f=this.getLastVisibleRow();let m=!1;return(a&&(e<d||e>f)||!a)&&(m=h.scrollTo(e,a?e>=this.getLastPartiallyVisibleRow():i)),m}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return _assertClassBrand$64(_Scroll_brand,this,_getLastRowIndex).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return _assertClassBrand$64(_Scroll_brand,this,_getLastRowIndex).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return _assertClassBrand$64(_Scroll_brand,this,_getLastColumnIndex).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return _assertClassBrand$64(_Scroll_brand,this,_getLastColumnIndex).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}};function _getLastColumnIndex(e){const{wtSettings:t,inlineStartOverlay:i,wtTable:r,wtViewport:o,totalColumns:a,rootWindow:c}=this.dataAccessObject;if(i.mainTableScrollableElement===c){const u=t.getSetting("rtlMode");let h=null;if(u){const f=r.TABLE.getBoundingClientRect(),g=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;h=Math.abs(f.right-g)}else h=offset$2(r.wtRootElement).left;const d=Math.abs(getScrollLeft(c,c));if(h>d){const f=innerWidth(c);let m=o.getRowHeaderWidth();for(let g=1;g<=a;g++)if(m+=i.sumCellSizes(g-1,g),h+m-d>=f){e=g-2;break}}}return e}function _getLastRowIndex(e){const{topOverlay:t,wtTable:i,wtViewport:r,totalRows:o,rootWindow:a}=this.dataAccessObject;if(t.mainTableScrollableElement===a){const c=offset$2(i.wtRootElement),u=getScrollTop(a,a);if(c.top>u){const h=innerHeight(a);let d=r.getColumnHeaderHeight();for(let f=1;f<=o;f++)if(d+=t.sumCellSizes(f-1,f),c.top+d-u>=h){e=f-2;break}}}return e}var scroll_default=Scroll,import_es_error_cause$135=__toESM(require_es_error_cause(),1),import_es_array_push$97=__toESM(require_es_array_push(),1);function _defineProperty$89(e,t,i){return(t=_toPropertyKey$90(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$90(e){var t=_toPrimitive$90(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$90(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CoreAbstract=class{get eventManager(){return new eventManager_default(this)}constructor(e,t){_defineProperty$89(this,"wtTable",void 0),_defineProperty$89(this,"wtScroll",void 0),_defineProperty$89(this,"wtViewport",void 0),_defineProperty$89(this,"wtOverlays",void 0),_defineProperty$89(this,"selectionManager",void 0),_defineProperty$89(this,"wtEvent",void 0),_defineProperty$89(this,"guid",`wt_${randomString()}`),_defineProperty$89(this,"drawInterrupted",!1),_defineProperty$89(this,"drawn",!1),_defineProperty$89(this,"domBindings",void 0),_defineProperty$89(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new scroll_default(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;t<i;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,i){fastInnerText(i,e[t])}])}}createCellCoords(e,t){return new coords_default(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,i){return new range_default$1(e,t,i,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const i=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),a=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<a)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<a&&e.row>=i-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<a)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<i&&e.row>=i-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,i,r,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,t,i,r,o)}scrollViewportHorizontally(e,t,i){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,t,i)}scrollViewportVertically(e,t,i){return e<0?!1:this.wtScroll.scrollViewportVertically(e,t,i)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}},import_es_error_cause$134=__toESM(require_es_error_cause(),1);function _defineProperty$88(e,t,i){return(t=_toPropertyKey$89(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$89(e){var t=_toPrimitive$89(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$89(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Clone=class extends CoreAbstract{constructor(e,t,i){super(e,t),_defineProperty$88(this,"cloneSource",void 0),_defineProperty$88(this,"cloneOverlay",void 0);const r=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new event_default(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}},import_es_error_cause$133=__toESM(require_es_error_cause(),1);function _defineProperty$87(e,t,i){return(t=_toPropertyKey$88(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$88(e){var t=_toPrimitive$88(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$88(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Overlay=class{constructor(e,t,i,r,o){_defineProperty$87(this,"wtSettings",null),defineGetter(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=t,this.wtSettings=r;const{TABLE:a,hider:c,spreader:u,holder:h,wtRootElement:d}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=a,this.hider=c,this.spreader=u,this.holder=h,this.wtRootElement=d,this.trimmingContainer=getTrimmingContainer(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=getTrimmingContainer(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=getScrollableElement(e.TABLE)}getRelativeCellPosition(e,t,i){if(this.clone.wtTable.holder.contains(e)===!1){warn(`The provided element is not a child of the ${this.type} overlay`);return}const r=this.mainTableScrollableElement===this.domBindings.rootWindow,o=i<this.wtSettings.getSetting("fixedColumnsStart"),a=t<this.wtSettings.getSetting("fixedRowsTop"),c=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,h={start:this.getRelativeStartPosition(u),top:u.offsetTop},d={start:this.getRelativeStartPosition(e),top:e.offsetTop};let f=null;return r?f=this.getRelativeCellPositionWithinWindow(a,o,d,h):f=this.getRelativeCellPositionWithinHolder(a,c,o,d,h),f}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,i,r){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let a=0,c=0;if(!t)a=r.start;else{let u=o.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(o.left+o.width+getScrollbarWidth())),a=u<=0?-1*u:0}return e?c=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:c=r.top,{start:i.start+a,top:i.top+c}}getRelativeCellPositionWithinHolder(e,t,i,r,o){const a={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let c=0,u=0;if(i||(c=a.horizontal-o.start),t){const h=this.wot.wtTable.wtRootElement.getBoundingClientRect();u=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+h.top}else e||(u=a.vertical-o.top);return{start:r.start-c,top:r.top-u}}makeClone(){if(CLONE_TYPES.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:t}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,o=i.createElement("div"),a=i.createElement("table"),c=e.wtRootElement.parentNode;o.className=`${CLONE_CLASS_NAMES.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,t.getSetting("ariaTags")&&setAttribute(o,[A11Y_PRESENTATION()]),a.className=e.TABLE.className,e.TABLE.getAttribute("role")&&a.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(a),c.appendChild(o);const h=this.wtSettings.getSetting("preventOverflow");return h===!0||h==="horizontal"&&this.type===CLONE_TOP||h==="vertical"&&this.type===CLONE_INLINE_START?this.mainTableScrollableElement=r:r.getComputedStyle(c).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=getScrollableElement(e.TABLE),new Clone(a,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.needFullRender&&this.clone.draw(e)}reset(){const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,i=e.style,r=t.style,o=e.parentNode.style;[i,r,o].forEach(a=>{a.width="",a.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}},BottomInlineStartCornerOverlay=class extends Overlay{constructor(e,t,i,r,o,a){super(e,t,CLONE_BOTTOM_INLINE_START_CORNER,i,r),this.bottomOverlay=o,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new bottomInlineStartCorner_default(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),a=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${o}px`,t.style.bottom=`${a}px`}else resetCssTransform(t),this.repositionOverlay();let i=outerHeight(this.clone.wtTable.TABLE);const r=outerWidth(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),t.style.height=`${i}px`,t.style.width=`${r}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let o=0;t.hasVerticalScroll()||(o+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(o+=getScrollbarWidth(i)),r.style.bottom=`${o}px`}};const MIXIN_NAME$4="calculatedColumns",calculatedColumns={getFirstRenderedColumn(){const e=this.dataAccessObject.startColumnRendered;return e===null?-1:e},getFirstVisibleColumn(){const e=this.dataAccessObject.startColumnVisible;return e===null?-1:e},getFirstPartiallyVisibleColumn(){const e=this.dataAccessObject.startColumnPartiallyVisible;return e===null?-1:e},getLastRenderedColumn(){const e=this.dataAccessObject.endColumnRendered;return e===null?-1:e},getLastVisibleColumn(){const e=this.dataAccessObject.endColumnVisible;return e===null?-1:e},getLastPartiallyVisibleColumn(){const e=this.dataAccessObject.endColumnPartiallyVisible;return e===null?-1:e},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};defineGetter(calculatedColumns,"MIXIN_NAME",MIXIN_NAME$4,{writable:!1,enumerable:!1});var calculatedColumns_default=calculatedColumns,BottomOverlayTable=class extends table_default{constructor(e,t,i,r){super(e,t,i,r,CLONE_BOTTOM)}};mixin(BottomOverlayTable,stickyRowsBottom_default),mixin(BottomOverlayTable,calculatedColumns_default);var bottom_default=BottomOverlayTable,import_es_error_cause$132=__toESM(require_es_error_cause(),1);function _defineProperty$86(e,t,i){return(t=_toPropertyKey$87(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$87(e){var t=_toPrimitive$87(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$87(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BottomOverlay=class extends Overlay{constructor(e,t,i,r){super(e,t,CLONE_BOTTOM,i,r),_defineProperty$86(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new bottom_default(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let i=0;const r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!r||r!=="vertical")?(i=this.getOverlayOffset(),t.style.bottom=`${i}px`):(i=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let o=0;t.hasVerticalScroll()||(o+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(o+=getScrollbarWidth(i)),r.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let i=!1;return this.mainTableScrollableElement===t?(t.scrollTo(getWindowScrollLeft(t),e),i=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:i,wtSettings:r}=this.wot,o=r.getSetting("defaultRowHeight");let a=e,c=0;for(;a<t;){const u=i.getRowHeight(a);c+=u===void 0?o:u,a+=1}return c}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,o=getScrollbarWidth(i),c=this.clone.wtTable.holder.parentNode.style,u=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||u==="horizontal"){let d=t.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(d-=o),d=Math.min(d,e.wtRootElement.scrollWidth),c.width=`${d}px`}else c.width="";this.clone.wtTable.holder.style.width=c.width;let h=outerHeight(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(h=0),c.height=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let i=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let a=0;t&&o.offsetHeight!==o.clientHeight&&(a=getScrollbarWidth(this.domBindings.rootDocument)),t?(i+=this.sumCellSizes(0,e+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),i+=a,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return getScrollTop(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),a=r-o,c=this.domBindings.rootDocument.documentElement.clientHeight;i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-c+r,0),i>a&&(i=0)}return i}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==t,r=this.wtSettings.getSetting("columnHeaders");let o=!1;if((i||t===0)&&r.length>0){const a=this.wot.wtTable.holder.parentNode,c=hasClass$1(a,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(addClass$1(a,"innerBorderBottom"),o=!c):(removeClass$1(a,"innerBorderBottom"),o=c)}return o}};const MIXIN_NAME$3="calculatedRows",calculatedRows={getFirstRenderedRow(){const e=this.dataAccessObject.startRowRendered;return e===null?-1:e},getFirstVisibleRow(){const e=this.dataAccessObject.startRowVisible;return e===null?-1:e},getFirstPartiallyVisibleRow(){const e=this.dataAccessObject.startRowPartiallyVisible;return e===null?-1:e},getLastRenderedRow(){const e=this.dataAccessObject.endRowRendered;return e===null?-1:e},getLastVisibleRow(){const e=this.dataAccessObject.endRowVisible;return e===null?-1:e},getLastPartiallyVisibleRow(){const e=this.dataAccessObject.endRowPartiallyVisible;return e===null?-1:e},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};defineGetter(calculatedRows,"MIXIN_NAME",MIXIN_NAME$3,{writable:!1,enumerable:!1});var calculatedRows_default=calculatedRows,InlineStartOverlayTable=class extends table_default{constructor(e,t,i,r){super(e,t,i,r,CLONE_INLINE_START)}};mixin(InlineStartOverlayTable,calculatedRows_default),mixin(InlineStartOverlayTable,stickyColumnsStart_default);var inlineStart_default=InlineStartOverlayTable,import_es_array_push$96=__toESM(require_es_array_push(),1);const MIXIN_NAME$2="localHooks",localHooks={_localHooks:Object.create(null),addLocalHook(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks(e,t,i,r,o,a,c){if(this._localHooks[e]){const u=this._localHooks[e].length;for(let h=0;h<u;h++)fastCall(this._localHooks[e][h],this,t,i,r,o,a,c)}},clearLocalHooks(){return this._localHooks={},this}};defineGetter(localHooks,"MIXIN_NAME",MIXIN_NAME$2,{writable:!1,enumerable:!1});var localHooks_default=localHooks,Selection$3=class{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}};mixin(Selection$3,localHooks_default);var selection_default$2=Selection$3;const ACTIVE_HEADER_TYPE="active-header",HEADER_TYPE="header",AREA_TYPE="area",FOCUS_TYPE="focus",FILL_TYPE="fill",ROW_TYPE="row",COLUMN_TYPE="column",CUSTOM_SELECTION_TYPE="custom-selection",CORNER_DEFAULT_STYLE=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var require_es_array_unscopables_flat=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.array.unscopables.flat.js"(){var e=require_add_to_unscopables();e("flat")}}),import_es_error_cause$131=__toESM(require_es_error_cause(),1),import_es_set_difference_v2$23=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$23=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$23=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$23=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$23=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$23=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$23=__toESM(require_es_set_union_v2(),1);function _classPrivateMethodInitSpec$45(e,t){_checkPrivateRedeclaration$63(e,t),t.add(e)}function _classPrivateFieldInitSpec$46(e,t,i){_checkPrivateRedeclaration$63(e,t),t.set(e,i)}function _checkPrivateRedeclaration$63(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$46(e,t){return e.get(_assertClassBrand$63(e,t))}function _classPrivateFieldSet$42(e,t,i){return e.set(_assertClassBrand$63(e,t),i),i}function _assertClassBrand$63(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _selection=new WeakMap,_activeOverlaysWot$1=new WeakMap,_SelectionScanner_brand=new WeakSet,SelectionScanner=class{constructor(){_classPrivateMethodInitSpec$45(this,_SelectionScanner_brand),_classPrivateFieldInitSpec$46(this,_selection,void 0),_classPrivateFieldInitSpec$46(this,_activeOverlaysWot$1,void 0)}setActiveOverlay(e){return _classPrivateFieldSet$42(_activeOverlaysWot$1,this,e),this}setActiveSelection(e){return _classPrivateFieldSet$42(_selection,this,e),this}scan(){const e=_classPrivateFieldGet$46(_selection,this).settings.selectionType,t=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(i=>t.add(i)),this.scanRowsInHeadersRange(i=>t.add(i))):e==="area"?this.scanCellsRange(i=>t.add(i)):e==="focus"?(this.scanColumnsInHeadersRange(i=>t.add(i)),this.scanRowsInHeadersRange(i=>t.add(i)),this.scanCellsRange(i=>t.add(i))):e==="fill"?this.scanCellsRange(i=>t.add(i)):e==="header"?(this.scanColumnsInHeadersRange(i=>t.add(i)),this.scanRowsInHeadersRange(i=>t.add(i))):e==="row"?(this.scanRowsInHeadersRange(i=>t.add(i)),this.scanRowsInCellsRange(i=>t.add(i))):e==="column"&&(this.scanColumnsInHeadersRange(i=>t.add(i)),this.scanColumnsInCellsRange(i=>t.add(i))),t}scanColumnsInHeadersRange(e){const[t,i,r,o]=_classPrivateFieldGet$46(_selection,this).getCorners(),{wtTable:a}=_classPrivateFieldGet$46(_activeOverlaysWot$1,this),c=a.getRenderedColumnsCount(),u=a.getColumnHeadersCount();let h=0;for(let d=-a.getRowHeadersCount();d<c;d++){const f=a.columnFilter.renderedToSource(d);if(!(f<i||f>o)){for(let m=-u;m<0;m++){if(m<t||m>r)continue;const g=m+u;let v=a.getColumnHeader(f,g);const _=_classPrivateFieldGet$46(_activeOverlaysWot$1,this).getSetting("onBeforeHighlightingColumnHeader",f,g,{selectionType:_classPrivateFieldGet$46(_selection,this).settings.selectionType,columnCursor:h,selectionWidth:o-i+1});_!==null&&(_!==f&&(v=a.getColumnHeader(_,g)),e(v))}h+=1}}}scanRowsInHeadersRange(e){const[t,i,r,o]=_classPrivateFieldGet$46(_selection,this).getCorners(),{wtTable:a}=_classPrivateFieldGet$46(_activeOverlaysWot$1,this),c=a.getRenderedRowsCount(),u=a.getRowHeadersCount();let h=0;for(let d=-a.getColumnHeadersCount();d<c;d++){const f=a.rowFilter.renderedToSource(d);if(!(f<t||f>r)){for(let m=-u;m<0;m++){if(m<i||m>o)continue;const g=m+u;let v=a.getRowHeader(f,g);const _=_classPrivateFieldGet$46(_activeOverlaysWot$1,this).getSetting("onBeforeHighlightingRowHeader",f,g,{selectionType:_classPrivateFieldGet$46(_selection,this).settings.selectionType,rowCursor:h,selectionHeight:r-t+1});_!==null&&(_!==f&&(v=a.getRowHeader(_,g)),e(v))}h+=1}}}scanCellsRange(e){const[t,i,r,o]=_classPrivateFieldGet$46(_selection,this).getCorners(),{wtTable:a}=_classPrivateFieldGet$46(_activeOverlaysWot$1,this);_assertClassBrand$63(_SelectionScanner_brand,this,_scanCellsRange).call(this,(c,u)=>{if(c>=t&&c<=r&&u>=i&&u<=o){const h=a.getCell(_classPrivateFieldGet$46(_activeOverlaysWot$1,this).createCellCoords(c,u)),d=_classPrivateFieldGet$46(_activeOverlaysWot$1,this).getSetting("onAfterDrawSelection",c,u,_classPrivateFieldGet$46(_selection,this).settings.layerLevel);typeof d=="string"&&addClass$1(h,d),e(h)}})}scanRowsInCellsRange(e){const[t,,i]=_classPrivateFieldGet$46(_selection,this).getCorners(),{wtTable:r}=_classPrivateFieldGet$46(_activeOverlaysWot$1,this);_assertClassBrand$63(_SelectionScanner_brand,this,_scanCellsRange).call(this,(o,a)=>{if(o>=t&&o<=i){const c=r.getCell(_classPrivateFieldGet$46(_activeOverlaysWot$1,this).createCellCoords(o,a));e(c)}})}scanColumnsInCellsRange(e){const[,t,,i]=_classPrivateFieldGet$46(_selection,this).getCorners(),{wtTable:r}=_classPrivateFieldGet$46(_activeOverlaysWot$1,this);_assertClassBrand$63(_SelectionScanner_brand,this,_scanCellsRange).call(this,(o,a)=>{if(a>=t&&a<=i){const c=r.getCell(_classPrivateFieldGet$46(_activeOverlaysWot$1,this).createCellCoords(o,a));e(c)}})}};function _scanCellsRange(e){const{wtTable:t}=_classPrivateFieldGet$46(_activeOverlaysWot$1,this),i=t.getRenderedRowsCount(),r=t.getRenderedColumnsCount();for(let o=0;o<i;o+=1){const a=t.rowFilter.renderedToSource(o);for(let c=0;c<r;c+=1)e(a,t.columnFilter.renderedToSource(c))}}var Border=class{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=CORNER_DEFAULT_STYLE,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,i=this.main.childNodes.length;t<i;t++){const r=this.main.childNodes[t];this.eventManager.addEventListener(r,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),stopImmediatePropagation(e);const i=this,r=this.wot.rootDocument.body,o=t.getBoundingClientRect();t.style.display="none";function a(u){if(u.clientY<Math.floor(o.top)||u.clientY>Math.ceil(o.top+o.height)||u.clientX<Math.floor(o.left)||u.clientX>Math.ceil(o.left+o.width))return!0}function c(u){a(u)&&(i.eventManager.removeEventListener(r,"mousemove",c),t.style.display="block")}this.eventManager.addEventListener(r,"mousemove",c)}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const i=["top","start","bottom","end","corner"];let r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let c=0;c<5;c++){const u=i[c],h=t.createElement("div");h.className=`wtBorder ${this.settings.className||""}`,this.settings[u]&&this.settings[u].hide&&(h.className+=" hidden"),r=h.style,r.backgroundColor=this.settings[u]&&this.settings[u].color?this.settings[u].color:e.border.color,r.height=this.settings[u]&&this.settings[u].width?`${this.settings[u].width}px`:`${e.border.width}px`,r.width=this.settings[u]&&this.settings[u].width?`${this.settings[u].width}px`:`${e.border.width}px`,this.main.appendChild(h)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),isMobileBrowser()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let a=o.bordersHolder;a||(a=t.createElement("div"),a.className="htBorders",o.bordersHolder=a,o.spreader.appendChild(a)),a.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const t=10,i=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const r={position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${parseInt(i/1.5,10)}px`};objectEach(r,(a,c)=>{this.selectionHandles.styles.bottomHitArea[c]=a,this.selectionHandles.styles.topHitArea[c]=a});const o={position:"absolute",height:`${t}px`,width:`${t}px`,"border-radius":`${parseInt(t/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};objectEach(o,(a,c)=>{this.selectionHandles.styles.bottom[c]=a,this.selectionHandles.styles.top[c]=a}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const i=this.wot.selectionManager.getAreaSelection();return!!(i.cellRange&&(e!==i.cellRange.to.row||t!==i.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,t,i,r,o,a){const u=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:h,topHitArea:d,bottom:f,bottomHitArea:m}=this.selectionHandles.styles,g=parseInt(h.borderWidth,10),v=parseInt(h.width,10),_=parseInt(d.width,10),b=this.wot.wtTable.getWidth(),S=this.wot.wtTable.getHeight();h.top=`${parseInt(i-v-1,10)}px`,h[u]=`${parseInt(r-v-1,10)}px`,d.top=`${parseInt(i-_/4*3,10)}px`,d[u]=`${parseInt(r-_/4*3,10)}px`;const T=Math.min(parseInt(r+o,10),b-v-g*2),A=Math.min(parseInt(r+o-_/4,10),b-_-g*2);f[u]=`${T}px`,m[u]=`${A}px`;const I=Math.min(parseInt(i+a,10),S-v-g*2),R=Math.min(parseInt(i+a-_/4,10),S-_-g*2);f.top=`${I}px`,m.top=`${R}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(h.display="block",d.display="block",this.isPartRange(e,t)?(f.display="none",m.display="none"):(f.display="block",m.display="block")):(h.display="none",f.display="none",d.display="none",m.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(h.zIndex="9999",d.zIndex="9999"):(h.zIndex="",d.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:t,rootDocument:i,rootWindow:r}=this.wot;let o,a,c,u,h,d;const f=t.getRenderedRowsCount();for(let me=0;me<f;me+=1){const Se=t.rowFilter.renderedToSource(me);if(Se>=e[0]&&Se<=e[2]){o=Se,h=e[0];break}}for(let me=f-1;me>=0;me-=1){const Se=t.rowFilter.renderedToSource(me);if(Se>=e[0]&&Se<=e[2]){a=Se;break}}const m=t.getRenderedColumnsCount();for(let me=0;me<m;me+=1){const Se=t.columnFilter.renderedToSource(me);if(Se>=e[1]&&Se<=e[3]){c=Se,d=e[1];break}}for(let me=m-1;me>=0;me-=1){const Se=t.columnFilter.renderedToSource(me);if(Se>=e[1]&&Se<=e[3]){u=Se;break}}if(o===void 0||c===void 0){this.disappear();return}let g=t.getCell(this.wot.createCellCoords(o,c));const v=o!==a||c!==u,_=v?t.getCell(this.wot.createCellCoords(a,u)):g,b=offset$2(g),S=v?offset$2(_):b,T=offset$2(t.TABLE),A=outerWidth(t.TABLE),I=b.top,R=b.left,O=this.wot.wtSettings.getSetting("rtlMode");let P=0,L=0;if(O){const me=outerWidth(g),Se=r.innerWidth-T.left-A;L=R+me-S.left,P=r.innerWidth-R-me-Se-1}else L=S.left+outerWidth(_)-R,P=R-T.left-1;if(this.isEntireColumnSelected(o,a)){const me=this.getDimensionsFromHeader("columns",c,u,h,T);let Se=null;me&&([Se,P,L]=me),Se&&(g=Se)}let V=I-T.top-1,U=S.top+outerHeight(_)-I;if(this.isEntireRowSelected(c,u)){const me=this.getDimensionsFromHeader("rows",o,a,d,T);let Se=null;me&&([Se,V,U]=me),Se&&(g=Se)}const $=getComputedStyle$3(g,r);parseInt($.borderTopWidth,10)>0&&(V+=1,U=U>0?U-1:0),parseInt($[O?"borderRightWidth":"borderLeftWidth"],10)>0&&(P+=1,L=L>0?L-1:0);const Z=O?"right":"left";this.topStyle.top=`${V}px`,this.topStyle[Z]=`${P}px`,this.topStyle.width=`${L}px`,this.topStyle.display="block",this.startStyle.top=`${V}px`,this.startStyle[Z]=`${P}px`,this.startStyle.height=`${U}px`,this.startStyle.display="block";const ie=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${V+U-ie}px`,this.bottomStyle[Z]=`${P}px`,this.bottomStyle.width=`${L}px`,this.bottomStyle.display="block",this.endStyle.top=`${V}px`,this.endStyle[Z]=`${P+L-ie}px`,this.endStyle.height=`${U+1}px`,this.endStyle.display="block";let ue=this.settings.border.cornerVisible;ue=typeof ue=="function"?ue(this.settings.layerLevel):ue;const _e=this.wot.getSetting("onModifyGetCellCoords",a,u);let[Ee,pe]=[a,u];if(_e&&Array.isArray(_e)&&([,,Ee,pe]=_e),isMobileBrowser()||!ue||this.isPartRange(Ee,pe))this.cornerStyle.display="none";else{this.cornerStyle.top=`${V+U+this.cornerCenterPointOffset-1}px`,this.cornerStyle[Z]=`${P+L+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let me=getTrimmingContainer(t.TABLE);const Se=me===r;Se&&(me=i.documentElement);const Le=parseInt(this.cornerDefaultStyle.width,10)/2,xe=parseInt(this.cornerDefaultStyle.height,10)/2;if(u===this.wot.getSetting("totalColumns")-1){const E=Se?_.getBoundingClientRect().left:_.offsetLeft;let k=!1,D=0;O?(D=E-parseInt(this.cornerDefaultStyle.width,10)/2,k=D<0):(D=E+outerWidth(_)+parseInt(this.cornerDefaultStyle.width,10)/2,k=D>=innerWidth(me)),k&&(this.cornerStyle[Z]=`${Math.floor(P+L+this.cornerCenterPointOffset-Le)}px`,this.cornerStyle[O?"borderLeftWidth":"borderRightWidth"]=0)}a===this.wot.getSetting("totalRows")-1&&(Se?_.getBoundingClientRect().top:_.offsetTop)+outerHeight(_)+parseInt(this.cornerDefaultStyle.height,10)/2>=innerHeight(me)&&(this.cornerStyle.top=`${Math.floor(V+U+this.cornerCenterPointOffset-xe)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}isMobileBrowser()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(a,u,V,P,L,U)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,i,r,o){const{wtTable:a}=this.wot,c=a.wtRootElement.parentNode;let u=null,h=null,d=null,f=null,m=null,g=null,v=null,_=null;switch(e){case"rows":u=function(){return a.getRowHeader(...arguments)},h=function(){return outerHeight(...arguments)},d="ht__selection--rows",g="top";break;case"columns":u=function(){return a.getColumnHeader(...arguments)},h=function(){return outerWidth(...arguments)},d="ht__selection--columns",g="left";break;default:}if(c.classList.contains(d)){const b=this.wot.getSetting("columnHeaders").length;if(v=u(t,b-r),_=u(i,b-r),!v||!_)return!1;const S=offset$2(v),T=offset$2(_);return v&&_&&(f=S[g]-o[g]-1,m=T[g]+h(_)-S[g]),[v,f,m]}return!1}changeBorderStyle(e,t){const i=this[e].style,r=t[e];!r||r.hide?addClass$1(this[e],"hidden"):(hasClass$1(this[e],"hidden")&&removeClass$1(this[e],"hidden"),i.backgroundColor=r.color,(e==="top"||e==="bottom")&&(i.height=`${r.width}px`),(e==="start"||e==="end")&&(i.width=`${r.width}px`))}changeBorderToDefaultStyle(e){const t={width:1,color:"#000"},i=this[e].style;i.backgroundColor=t.color,i.width=`${t.width}px`,i.height=`${t.width}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?addClass$1(this[e],"hidden"):removeClass$1(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",isMobileBrowser()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}},border_default=Border,import_es_error_cause$130=__toESM(require_es_error_cause(),1),import_es_array_push$95=__toESM(require_es_array_push(),1),import_es_array_unscopables_flat$1=__toESM(require_es_array_unscopables_flat(),1),import_es_set_difference_v2$22=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$22=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$22=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$22=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$22=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$22=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$22=__toESM(require_es_set_union_v2(),1);function _classPrivateMethodInitSpec$44(e,t){_checkPrivateRedeclaration$62(e,t),t.add(e)}function _classPrivateFieldInitSpec$45(e,t,i){_checkPrivateRedeclaration$62(e,t),t.set(e,i)}function _checkPrivateRedeclaration$62(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$45(e,t){return e.get(_assertClassBrand$62(e,t))}function _classPrivateFieldSet$41(e,t,i){return e.set(_assertClassBrand$62(e,t),i),i}function _assertClassBrand$62(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _activeOverlaysWot=new WeakMap,_selections=new WeakMap,_scanner=new WeakMap,_appliedClasses=new WeakMap,_destroyListeners=new WeakMap,_selectionBorders=new WeakMap,_SelectionManager_brand=new WeakSet,SelectionManager=class{constructor(e){_classPrivateMethodInitSpec$44(this,_SelectionManager_brand),_classPrivateFieldInitSpec$45(this,_activeOverlaysWot,void 0),_classPrivateFieldInitSpec$45(this,_selections,void 0),_classPrivateFieldInitSpec$45(this,_scanner,new SelectionScanner),_classPrivateFieldInitSpec$45(this,_appliedClasses,new WeakMap),_classPrivateFieldInitSpec$45(this,_destroyListeners,new WeakSet),_classPrivateFieldInitSpec$45(this,_selectionBorders,new Map),_classPrivateFieldSet$41(_selections,this,e)}setActiveOverlay(e){return _classPrivateFieldSet$41(_activeOverlaysWot,this,e),_classPrivateFieldGet$45(_scanner,this).setActiveOverlay(_classPrivateFieldGet$45(_activeOverlaysWot,this)),_classPrivateFieldGet$45(_appliedClasses,this).has(_classPrivateFieldGet$45(_activeOverlaysWot,this))||_classPrivateFieldGet$45(_appliedClasses,this).set(_classPrivateFieldGet$45(_activeOverlaysWot,this),new Set),this}getFocusSelection(){return _classPrivateFieldGet$45(_selections,this)!==null?_classPrivateFieldGet$45(_selections,this).getFocus():null}getAreaSelection(){return _classPrivateFieldGet$45(_selections,this)!==null?_classPrivateFieldGet$45(_selections,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(_classPrivateFieldGet$45(_selectionBorders,this).has(e)){const i=_classPrivateFieldGet$45(_selectionBorders,this).get(e);if(i.has(_classPrivateFieldGet$45(_activeOverlaysWot,this)))return i.get(_classPrivateFieldGet$45(_activeOverlaysWot,this));const r=new border_default(_classPrivateFieldGet$45(_activeOverlaysWot,this),e.settings);return i.set(_classPrivateFieldGet$45(_activeOverlaysWot,this),r),r}const t=new border_default(_classPrivateFieldGet$45(_activeOverlaysWot,this),e.settings);return _classPrivateFieldGet$45(_selectionBorders,this).set(e,new Map([[_classPrivateFieldGet$45(_activeOverlaysWot,this),t]])),t}getBorderInstances(e){var t,i;return Array.from((t=(i=_classPrivateFieldGet$45(_selectionBorders,this).get(e))===null||i===void 0?void 0:i.values())!==null&&t!==void 0?t:[])}destroyBorders(e){_classPrivateFieldGet$45(_selectionBorders,this).get(e).forEach(t=>t.destroy()),_classPrivateFieldGet$45(_selectionBorders,this).delete(e)}render(e){if(_classPrivateFieldGet$45(_selections,this)===null)return;e&&_assertClassBrand$62(_SelectionManager_brand,this,_resetCells).call(this);const t=Array.from(_classPrivateFieldGet$45(_selections,this)),i=new Map,r=new Map;for(let o=0;o<t.length;o++){const a=t[o],{className:c,headerAttributes:u,createLayers:h,selectionType:d}=a.settings;_classPrivateFieldGet$45(_destroyListeners,this).has(a)||(_classPrivateFieldGet$45(_destroyListeners,this).add(a),a.addLocalHook("destroy",()=>this.destroyBorders(a)));const f=this.getBorderInstance(a);if(a.isEmpty()){f?.disappear();continue}c&&_classPrivateFieldGet$45(_scanner,this).setActiveSelection(a).scan().forEach(v=>{if(i.has(v)){const _=i.get(v);_.has(c)&&h===!0?_.set(c,_.get(c)+1):_.set(c,1)}else i.set(v,new Map([[c,1]]));u&&(r.has(v)||r.set(v,[]),v.nodeName==="TH"&&r.get(v).push(...u))});const m=a.getCorners();_classPrivateFieldGet$45(_activeOverlaysWot,this).getSetting("onBeforeDrawBorders",m,d),f?.appear(m)}i.forEach((o,a)=>{var c;const u=Array.from(o).map(h=>{let[d,f]=h;return f===1?d:[d,...Array.from({length:f-1},(m,g)=>`${d}-${g+1}`)]}).flat();u.forEach(h=>_classPrivateFieldGet$45(_appliedClasses,this).get(_classPrivateFieldGet$45(_activeOverlaysWot,this)).add(h)),addClass$1(a,u),a.nodeName==="TD"&&Array.isArray((c=_classPrivateFieldGet$45(_selections,this).options)===null||c===void 0?void 0:c.cellAttributes)&&setAttribute(a,_classPrivateFieldGet$45(_selections,this).options.cellAttributes)}),Array.from(r.keys()).forEach(o=>{setAttribute(o,[...r.get(o)])})}};function _resetCells(){const e=_classPrivateFieldGet$45(_appliedClasses,this).get(_classPrivateFieldGet$45(_activeOverlaysWot,this)),t=_classPrivateFieldGet$45(_activeOverlaysWot,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(t))for(let i=0;i<t.length;i++)e.add(t[i]);e.forEach(i=>{var r,o;const a=_classPrivateFieldGet$45(_activeOverlaysWot,this).wtTable.TABLE.querySelectorAll(`.${i}`);let c=[];Array.isArray((r=_classPrivateFieldGet$45(_selections,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(c=_classPrivateFieldGet$45(_selections,this).options.cellAttributes.map(u=>u[0])),Array.isArray((o=_classPrivateFieldGet$45(_selections,this).options)===null||o===void 0?void 0:o.headerAttributes)&&(c=[...c,..._classPrivateFieldGet$45(_selections,this).options.headerAttributes.map(u=>u[0])]);for(let u=0,h=a.length;u<h;u++)removeClass$1(a[u],i),removeAttribute(a[u],c)}),e.clear()}var import_es_error_cause$129=__toESM(require_es_error_cause(),1),InlineStartOverlay=class extends Overlay{constructor(e,t,i,r){super(e,t,CLONE_INLINE_START,i,r)}createTable(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new inlineStart_default(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,i=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===t&&(!r||r!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),setOverlayPosition(i,`${o}px`,"0px")):(o=this.getScrollPosition(),resetCssTransform(i));const a=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),a}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let i=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,getWindowScrollTop(t)),i=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const i=this.wtSettings.getSetting("defaultColumnWidth");let r=e,o=0;for(;r<t;)o+=this.wot.wtTable.getStretchedColumnWidth(r)||i,r+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:i}=this.domBindings,r=getScrollbarWidth(t),a=this.clone.wtTable.holder.parentNode.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||c==="vertical"){let h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=r),h=Math.min(h,e.wtRootElement.scrollHeight),a.height=`${h}px`}else a.height="";this.clone.wtTable.holder.style.height=a.height;const u=outerWidth(this.clone.wtTable.TABLE);a.width=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(CORNER_DEFAULT_STYLE.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[t]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){const{wtSettings:i}=this,r=i.getSetting("rowHeaders"),o=i.getSetting("fixedColumnsStart"),c=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,u=o===0&&r.length>0&&!hasClass$1(c.parentNode,"innerBorderInlineStart")?1:0;let h=this.getTableParentOffset(),d=0;if(t){const f=this.wot.wtTable.getColumnWidth(e),m=this.wot.wtViewport.getViewportWidth();f>m&&(t=!1)}return t&&c.offsetWidth!==c.clientWidth&&(d=getScrollbarWidth(this.domBindings.rootDocument)),t?(h+=this.sumCellSizes(0,e+1),h-=this.wot.wtViewport.getViewportWidth(),h+=u):h+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),h+=d,getMaximumScrollLeft(this.mainTableScrollableElement)===h-u&&u>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(u),this.setScrollPosition(h)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let t=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(getScrollLeft(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!t||t!=="horizontal")){this.isRtl()?i=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const r=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),a=r-o;i>a&&(i=0)}return i}adjustHeaderBordersPosition(e){const{wtSettings:t}=this,i=this.wot.wtTable.holder.parentNode,r=t.getSetting("rowHeaders"),o=t.getSetting("fixedColumnsStart"),a=t.getSetting("totalRows"),c=t.getSetting("preventOverflow")==="vertical";a?removeClass$1(i,"emptyRows"):addClass$1(i,"emptyRows");let u=!1;if(!c){if(o&&!r.length)addClass$1(i,"innerBorderLeft innerBorderInlineStart");else if(!o&&r.length){const h=hasClass$1(i,"innerBorderInlineStart");e?(addClass$1(i,"innerBorderLeft innerBorderInlineStart"),u=!h):(removeClass$1(i,"innerBorderLeft innerBorderInlineStart"),u=h)}}return u}};const MIXIN_NAME$1="stickyRowsTop",stickyRowsTop={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),e)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};defineGetter(stickyRowsTop,"MIXIN_NAME",MIXIN_NAME$1,{writable:!1,enumerable:!1});var stickyRowsTop_default=stickyRowsTop,TopInlineStartCornerOverlayTable=class extends table_default{constructor(e,t,i,r){super(e,t,i,r,CLONE_TOP_INLINE_START_CORNER)}};mixin(TopInlineStartCornerOverlayTable,stickyRowsTop_default),mixin(TopInlineStartCornerOverlayTable,stickyColumnsStart_default);var topInlineStartCorner_default=TopInlineStartCornerOverlayTable,import_es_error_cause$128=__toESM(require_es_error_cause(),1);function _defineProperty$85(e,t,i){return(t=_toPropertyKey$86(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$86(e){var t=_toPrimitive$86(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$86(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TopInlineStartCornerOverlay=class extends Overlay{constructor(e,t,i,r,o,a){super(e,t,CLONE_TOP_INLINE_START_CORNER,i,r),_defineProperty$85(this,"topOverlay",void 0),_defineProperty$85(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new topInlineStartCorner_default(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const r=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();setOverlayPosition(e,`${r}px`,`${o}px`)}else resetCssTransform(e);let t=outerHeight(this.clone.wtTable.TABLE);const i=outerWidth(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${i}px`,!1}},TopOverlayTable=class extends table_default{constructor(e,t,i,r){super(e,t,i,r,CLONE_TOP)}};mixin(TopOverlayTable,stickyRowsTop_default),mixin(TopOverlayTable,calculatedColumns_default);var top_default=TopOverlayTable,import_es_error_cause$127=__toESM(require_es_error_cause(),1);function _defineProperty$84(e,t,i){return(t=_toPropertyKey$85(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$85(e){var t=_toPrimitive$85(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$85(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TopOverlay=class extends Overlay{constructor(e,t,i,r){super(e,t,CLONE_TOP,i,r),_defineProperty$84(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new top_default(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow");let r=0,o=!1;if(this.trimmingContainer===t&&(!i||i!=="vertical")){const{wtTable:c}=this.wot,u=c.hider.getBoundingClientRect(),h=Math.ceil(u.bottom),d=e.offsetHeight;o=h===d,r=this.getOverlayOffset(),setOverlayPosition(e,"0px",`${r}px`)}else r=this.getScrollPosition(),resetCssTransform(e);const a=this.adjustHeaderBordersPosition(r,o);return this.adjustElementsSize(),a}setScrollPosition(e){const t=this.domBindings.rootWindow;let i=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(getWindowScrollLeft(t),e),i=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const i=this.wtSettings.getSetting("defaultRowHeight");let r=e,o=0;for(;r<t;){const a=this.wot.wtTable.getRowHeight(r);o+=a===void 0?i:a,r+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:i}=this.domBindings,r=getScrollbarWidth(t),a=this.clone.wtTable.holder.parentNode.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||c==="horizontal"){let h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=r),h=Math.min(h,e.wtRootElement.scrollWidth),a.width=`${h}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=outerHeight(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(CORNER_DEFAULT_STYLE.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:i,wtSettings:r}=this,a=(i.cloneSource?i.cloneSource:i).wtTable.holder,c=r.getSetting("columnHeaders"),h=r.getSetting("fixedRowsTop")===0&&c.length>0&&!hasClass$1(a.parentNode,"innerBorderTop")?1:0;let d=this.getTableParentOffset(),f=0;if(t){const m=this.wot.wtTable.getRowHeight(e),g=this.wot.wtViewport.getViewportHeight();m>g&&(t=!1)}if(t&&a.offsetHeight!==a.clientHeight&&(f=getScrollbarWidth(this.domBindings.rootDocument)),t){const m=r.getSetting("fixedRowsBottom"),g=r.getSetting("totalRows");d+=this.sumCellSizes(0,e+1),d-=i.wtViewport.getViewportHeight()-this.sumCellSizes(g-m,g),d+=1,d+=h}else d+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);return d+=f,getMaximumScrollTop(this.mainTableScrollableElement)===d-h&&h>0&&this.wot.wtOverlays.expandHiderVerticallyBy(h),this.setScrollPosition(d)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return getScrollTop(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),a=r-o;i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),i>a&&(i=0)}return i}adjustHeaderBordersPosition(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:i}=this,r=this.wot.wtTable.holder.parentNode,o=i.getSetting("totalColumns"),a=i.getSetting("preventOverflow")==="horizontal";o?removeClass$1(r,"emptyColumns"):addClass$1(r,"emptyColumns");let c=!1;if(!t&&!a){const u=i.getSetting("fixedRowsTop"),h=this.cachedFixedRowsTop!==u,d=i.getSetting("columnHeaders");if((h||u===0)&&d.length>0){const f=hasClass$1(r,"innerBorderTop");this.cachedFixedRowsTop=i.getSetting("fixedRowsTop"),e||i.getSetting("totalRows")===0?(addClass$1(r,"innerBorderTop"),c=!f):(removeClass$1(r,"innerBorderTop"),c=f)}}return c}},import_es_error_cause$126=__toESM(require_es_error_cause(),1),import_es_array_push$94=__toESM(require_es_array_push(),1);function _classPrivateFieldInitSpec$44(e,t,i){_checkPrivateRedeclaration$61(e,t),t.set(e,i)}function _checkPrivateRedeclaration$61(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$83(e,t,i){return(t=_toPropertyKey$84(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$84(e){var t=_toPrimitive$84(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$84(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldSet$40(e,t,i){return e.set(_assertClassBrand$61(e,t),i),i}function _classPrivateFieldGet$44(e,t){return e.get(_assertClassBrand$61(e,t))}function _assertClassBrand$61(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _overlays=new WeakMap,_hasRenderingStateChanged=new WeakMap,_containerDomResizeCount=new WeakMap,_containerDomResizeCountTimeout=new WeakMap,Overlays=class{constructor(e,t,i,r,o,a){_defineProperty$83(this,"wot",null),_classPrivateFieldInitSpec$44(this,_overlays,[]),_defineProperty$83(this,"topOverlay",null),_defineProperty$83(this,"bottomOverlay",null),_defineProperty$83(this,"inlineStartOverlay",null),_defineProperty$83(this,"topInlineStartCornerOverlay",null),_defineProperty$83(this,"bottomInlineStartCornerOverlay",null),_defineProperty$83(this,"browserLineHeight",void 0),_defineProperty$83(this,"wtSettings",null),_classPrivateFieldInitSpec$44(this,_hasRenderingStateChanged,!1),_classPrivateFieldInitSpec$44(this,_containerDomResizeCount,0),_classPrivateFieldInitSpec$44(this,_containerDomResizeCountTimeout,null),_defineProperty$83(this,"resizeObserver",new ResizeObserver(d=>{requestAnimationFrame$1(()=>{!Array.isArray(d)||!d.length||(_classPrivateFieldSet$40(_containerDomResizeCount,this,_classPrivateFieldGet$44(_containerDomResizeCount,this)+1),_classPrivateFieldGet$44(_containerDomResizeCount,this)===100&&(warn("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),_classPrivateFieldGet$44(_containerDomResizeCountTimeout,this)!==null&&clearTimeout(_classPrivateFieldGet$44(_containerDomResizeCountTimeout,this)),_classPrivateFieldSet$40(_containerDomResizeCountTimeout,this,setTimeout(()=>{_classPrivateFieldSet$40(_containerDomResizeCount,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=r,this.domBindings=i,this.facadeGetter=t,this.wtTable=a;const{rootDocument:c,rootWindow:u}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=getScrollbarWidth(c);const h=u.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=h?a.holder:getScrollableElement(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=u.scrollX,this.lastScrollY=u.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=[..._classPrivateFieldGet$44(_overlays,this)];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,i=e.getComputedStyle(t.body),r=parseInt(i.lineHeight,10),o=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=r||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new TopOverlay(...e),this.bottomOverlay=new BottomOverlay(...e),this.inlineStartOverlay=new InlineStartOverlay(...e),this.topInlineStartCornerOverlay=new TopInlineStartCornerOverlay(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new BottomInlineStartCornerOverlay(...e,this.bottomOverlay,this.inlineStartOverlay),_classPrivateFieldSet$40(_overlays,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){_classPrivateFieldSet$40(_hasRenderingStateChanged,this,_classPrivateFieldGet$44(_overlays,this).reduce((e,t)=>t.hasRenderingStateChanged()||e,!1)),_classPrivateFieldGet$44(_overlays,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),_classPrivateFieldGet$44(_overlays,this).forEach(e=>{const t=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),t&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:i}=this.topOverlay,{mainTableScrollableElement:r}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",f=>this.onKeyDown(f)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(i,"scroll",f=>this.onTableScroll(f),{passive:!0}),i!==r&&this.eventManager.addEventListener(r,"scroll",f=>this.onTableScroll(f),{passive:!0});const o=t.devicePixelRatio&&t.devicePixelRatio>1,a=this.scrollableElement===t,c=this.wtSettings.getSetting("preventWheel"),u={passive:a};(c||o||!isChrome())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",f=>this.onCloneWheel(f,c),u),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(f=>{if(f&&f.needFullRender){const{holder:m}=f.clone.wtTable;this.eventManager.addEventListener(m,"wheel",g=>this.onCloneWheel(g,c),u)}});let d;this.eventManager.addEventListener(t,"resize",()=>{clearTimeout(d),d=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize"),_classPrivateFieldSet$40(_containerDomResizeCount,this,0)},200)}),a||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const t=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(r!==t&&o!==t&&!e.target.contains(r)||i!==t&&o!==t&&!e.target.contains(i))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:i}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,a=e.target,c=o!==i&&a!==i&&!a.contains(o),u=r!==i&&a!==i&&!a.contains(r);if(this.keyPressed&&(c||u)||this.scrollableElement===i)return;const h=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==i&&h)&&e.preventDefault()}onKeyDown(e){this.keyPressed=isKey$1(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,i=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(i+=i*this.browserLineHeight,t+=t*this.browserLineHeight);const r=this.scrollVertically(t),o=this.scrollHorizontally(i);return r||o}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,[r,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==r||this.lastScrollX!==e.scrollX,this.verticalScrolling=i.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=r;const a=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;a&&(a.scrollLeft=r)}this.verticalScrolling&&(i.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){if(!_classPrivateFieldGet$44(_hasRenderingStateChanged,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:i}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i),_classPrivateFieldSet$40(_hasRenderingStateChanged,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=getScrollableElement(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,i=e.clientHeight,r=t!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=i),r}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:t}=this,{rootWindow:i}=this.domBindings,r=this.scrollableElement===i,o=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),c=e.getRowHeaderWidth(),h=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,a)+1,d=c+this.inlineStartOverlay.sumCellSizes(0,o),m=t.hider.style,g=()=>r?!1:this.scrollableElement.scrollTop>Math.max(0,h-t.holder.clientHeight),v=()=>r?!1:this.scrollableElement.scrollLeft>Math.max(0,d-t.holder.clientWidth),_=g()?1:0,b=v()?1:0;if(m.width=`${d+b}px`,m.height=`${h+_}px`,this.scrollbarSize>0){const{scrollHeight:S,scrollWidth:T}=t.wtRootElement,{scrollHeight:A,scrollWidth:I}=t.holder;this.hasScrollbarRight=S<A,this.hasScrollbarBottom=T<I,this.hasScrollbarRight&&t.hider.scrollWidth+this.scrollbarSize>T?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&t.hider.scrollHeight+this.scrollbarSize>S&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:t}=this;t.hider.style.height=`${parseInt(t.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:t}=this;t.hider.style.width=`${parseInt(t.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let i=null;return arrayEach$1(t,r=>{r&&r.clone&&r.clone.wtTable.TABLE.contains(e)&&(i=r.clone)}),i}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];arrayEach$1(t,i=>{i&&(i.clone.wtTable.TABLE.className=e.className)})}},overlays_default=Overlays,import_es_error_cause$125=__toESM(require_es_error_cause(),1);function _defineProperty$82(e,t,i){return(t=_toPropertyKey$83(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$83(e){var t=_toPrimitive$83(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$83(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Settings$1=class{constructor(e){_defineProperty$82(this,"settings",{}),_defineProperty$82(this,"defaults",Object.freeze(this.getDefaults())),objectEach(this.defaults,(t,i)=>{if(e[i]!==void 0)this.settings[i]=e[i];else{if(t===void 0)throw new Error(`A required setting "${i}" was not provided`);this.settings[i]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,i)=>{const r=this.getSetting("data",e,t);fastInnerText(i,r??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return t===void 0?objectEach(e,(i,r)=>{this.settings[r]=i}):this.settings[e]=t,this}getSetting(e,t,i,r,o){return typeof this.settings[e]=="function"?this.settings[e](t,i,r,o):t!==void 0&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}},MasterTable=class extends table_default{constructor(e,t,i,r){super(e,t,i,r,"master")}alignOverlaysWithTrimmingContainer(){const e=getTrimmingContainer(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const i=e.parentElement,r=getStyle(e,"height",t),o=getStyle(e,"overflow",t),a=this.holder.style,{scrollWidth:c,scrollHeight:u}=e;let h=e.offsetWidth,d=e.offsetHeight;if(i&&["auto","hidden","scroll"].includes(o)){const m=e.cloneNode(!1);m.style.overflow="auto",m.style.position="absolute",e.nextElementSibling?i.insertBefore(m,e.nextElementSibling):i.appendChild(m);const g=parseInt(getComputedStyle$3(m,t).height,10);i.removeChild(m),g===0&&(d=0)}d=Math.min(d,u),a.height=r==="auto"?"auto":`${d}px`,h=Math.min(h,c),a.width=`${h}px`,a.overflow="",this.hasTableHeight=a.height==="auto"?!0:d>0,this.hasTableWidth=h>0}this.isTableVisible=isVisible$1(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,i="master",o=e.getSetting("columnHeaders").length;if(o&&!t.hasOversizedColumnHeadersMarked[i]){const c=e.getSetting("rowHeaders").length,u=this.getRenderedColumnsCount();for(let h=0;h<o;h++)for(let d=-1*c;d<u;d++)this.markIfOversizedColumnHeader(d);t.hasOversizedColumnHeadersMarked[i]=!0}}};mixin(MasterTable,calculatedRows_default),mixin(MasterTable,calculatedColumns_default);var master_default=MasterTable,Viewport=class{constructor(e,t,i,r,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=i,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new RenderedAllRowsCalculationType:new RenderedRowsCalculationType],["fullyVisible",()=>new FullyVisibleRowsCalculationType],["partiallyVisible",()=>new PartiallyVisibleRowsCalculationType]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new RenderedAllColumnsCalculationType:new RenderedColumnsCalculationType],["fullyVisible",()=>new FullyVisibleColumnsCalculationType],["partiallyVisible",()=>new PartiallyVisibleColumnsCalculationType]]),this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let i=0;return t===this.domBindings.rootWindow?i=e.documentElement.clientHeight:i=outerHeight(t)>0&&t.clientHeight>0?t.clientHeight:1/0,i}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:t,rootWindow:i}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=t.documentElement.offsetWidth,a=e.getSetting("totalColumns"),c=e.getSetting("preventOverflow"),u=e.getSetting("rtlMode"),h=this.wtTable.TABLE.getBoundingClientRect(),d=u?h.right-o:h.left,f=o-d;let m,g;if(c)return outerWidth(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?m=Math.min(f,o):m=Math.min(this.getContainerFillWidth(),f,o),r===i&&a>0&&this.sumColumnWidths(0,a-1)>m)return t.documentElement.clientWidth;if(r!==i&&(g=getStyle(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",i),g==="scroll"||g==="hidden"||g==="auto"))return Math.max(m,r.clientWidth);const v=e.getSetting("stretchH");return v==="none"||!v?Math.max(m,outerWidth(this.wtTable.TABLE)):m}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,t){let i=0,r=e;for(;r<t;)i+=this.wtTable.getColumnWidth(r),r+=1;return i}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);const i=t.offsetWidth;return this.containerWidth=i,e.removeChild(t),i}getWorkspaceOffset(){return offset$2(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=outerHeight(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let i=0,r=t.length;i<r;i++)this.rowHeaderWidth+=e[i]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let r=0,o=t.length;r<o;r++)i?(this.rowHeaderWidth+=outerWidth(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:i}=this;let r=this.getViewportHeight(),o,a;this.rowHeaderWidth=NaN;let c=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const u=t.getSetting("fixedRowsTop"),h=t.getSetting("fixedRowsBottom"),d=t.getSetting("totalRows");return u&&c>=0&&(a=this.dataAccessObject.topOverlay.sumCellSizes(0,u),c+=a,r-=a),h&&this.dataAccessObject.bottomOverlay.clone&&(a=this.dataAccessObject.bottomOverlay.sumCellSizes(d-h,d),r-=a),i.holder.clientHeight===i.holder.offsetHeight?o=0:o=getScrollbarWidth(this.domBindings.rootDocument),new ViewportRowsCalculator({calculationTypes:e.map(f=>[f,this.rowsCalculatorTypes.get(f)()]),viewportHeight:r,scrollOffset:c,totalRows:t.getSetting("totalRows"),rowHeightFn:f=>i.getRowHeight(f),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:i}=this;let r=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const a=t.getSetting("fixedColumnsStart");if(a&&o>=0){const c=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,a);o+=c,r-=c}return i.holder.clientWidth!==i.holder.offsetWidth&&(r-=getScrollbarWidth(this.domBindings.rootDocument)),new ViewportColumnsCalculator({calculationTypes:e.map(c=>[c,this.columnsCalculatorTypes.get(c)()]),viewportWidth:r,scrollOffset:o,totalColumns:t.getSetting("totalColumns"),columnWidthFn:c=>i.getColumnWidth(c),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,i=this.createRowsCalculator(),r=this.createColumnsCalculator();if(e&&!t.getSetting("renderAllRows")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!t.getSetting("renderAllColumns")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=i.getResultsFor("rendered"),this.columnsRenderCalculator=r.getResultsFor("rendered")),this.rowsVisibleCalculator=i.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),t=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=t.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:t,endRow:i}=e;if(t===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.rowsPartiallyVisibleCalculator.startRow,i=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:r,endRow:o}=this.rowsRenderCalculator;return t<r||t===r&&t>0?!1:!(i>o||i===o&&i<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:t,endColumn:i}=e;if(t===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.columnsPartiallyVisibleCalculator.startColumn,i=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:r,endColumn:o}=this.columnsRenderCalculator;return t<r||t===r&&t>0?!1:!(i>o||i===o&&i<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){objectEach(this.hasOversizedColumnHeadersMarked,(e,t,i)=>{i[t]=void 0})}},viewport_default=Viewport,import_es_array_push$93=__toESM(require_es_array_push(),1),Walkontable=class extends CoreAbstract{constructor(e,t){super(e,new Settings$1(t));const i=this.wtSettings.getSetting("facade",this);this.wtTable=new master_default(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new viewport_default(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new SelectionManager(this.wtSettings.getSetting("selections")),this.wtEvent=new event_default(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new overlays_default(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},t=[],i=[];objectEach(e,(r,o)=>{this.wtSettings.getSetting(o).length&&i.push(r),t.push(r)}),removeClass$1(this.wtTable.wtRootElement.parentNode,t),addClass$1(this.wtTable.wtRootElement.parentNode,i)}getOverlayByName(e){var t;if(!CLONE_TYPES.includes(e))return null;const i=e.replace(/_([a-z])/g,r=>r[1].toUpperCase());return(t=this.wtOverlays[`${i}Overlay`])!==null&&t!==void 0?t:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}},WalkontableFacade=class es{constructor(t){t instanceof CoreAbstract?this._wot=t:this._initFromSettings(t)}_initFromSettings(t){t.facade=i=>{const r=new es(i);return()=>r},this._wot=new Walkontable(t.table,t)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(t){this._wot.drawn=t}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(t){this._wot.drawInterrupted=t}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(t){this._wot.lastMouseOver=t}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(t){this._wot.momentumScrolling=t}get touchApplied(){return this._wot.touchApplied}set touchApplied(t){this._wot.touchApplied=t}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(t){this._wot.eventListeners=t}get eventManager(){return this._wot.eventManager}createCellCoords(t,i){return this._wot.createCellCoords(t,i)}createCellRange(t,i,r){return this._wot.createCellRange(t,i,r)}draw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(t),this}getCell(t){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(t,i)}scrollViewport(t,i,r,o,a){return this._wot.scrollViewport(t,i,r,o,a)}scrollViewportHorizontally(t,i,r){return this._wot.scrollViewportHorizontally(t,i,r)}scrollViewportVertically(t,i,r){return this._wot.scrollViewportVertically(t,i,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(t){return this._wot.getOverlayByName(t)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(t,i){return this._wot.wtSettings.update(t,i),this}getSetting(t,i,r,o,a){return this._wot.wtSettings.getSetting(t,i,r,o,a)}hasSetting(t){return this._wot.wtSettings.hasSetting(t)}destroy(){this._wot.destroy()}};function mouseDown(e){let{isShiftKey:t,isLeftClick:i,isRightClick:r,coords:o,selection:a,controller:c,cellCoordsFactory:u}=e;const h=a.isSelected()?a.getSelectedRange().current():null,d=a.isSelectedByCorner(),f=a.isSelectedByRowHeader();if(a.markSource("mouse"),t&&h)o.row>=0&&o.col>=0&&!c.cell?a.setRangeEnd(o):(d||f)&&o.row>=0&&o.col>=0&&!c.cell?a.setRangeEnd(u(o.row,o.col)):d&&o.row<0&&!c.column?a.setRangeEnd(u(h.to.row,o.col)):f&&o.col<0&&!c.row?a.setRangeEnd(u(o.row,h.to.col)):(!d&&!f&&o.col<0||d&&o.col<0)&&!c.row?a.selectRows(Math.max(h.from.row,0),o.row,o.col):(!d&&!f&&o.row<0||f&&o.row<0)&&!c.column&&a.selectColumns(Math.max(h.from.col,0),o.col,o.row);else{const m=!a.inInSelection(o),g=i||r&&m;o.row<0&&o.col>=0&&!c.column?g&&a.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!c.row?g&&a.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!c.cell?g&&a.setRangeStart(o):o.col<0&&o.row<0&&a.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}a.markEndSource()}function mouseOver(e){let{isLeftClick:t,coords:i,selection:r,controller:o,cellCoordsFactory:a}=e;if(!t)return;const c=r.isSelectedByRowHeader(),u=r.isSelectedByColumnHeader(),h=r.tableProps.countCols(),d=r.tableProps.countRows();r.markSource("mouse"),u&&!o.column?r.setRangeEnd(a(d-1,i.col)):c&&!o.row?r.setRangeEnd(a(i.row,h-1)):o.cell||r.setRangeEnd(i),r.markEndSource()}const handlers=new Map([["mousedown",mouseDown],["mouseover",mouseOver],["touchstart",mouseDown]]);function handleMouseEvent(e,t){let{coords:i,selection:r,controller:o,cellCoordsFactory:a}=t;handlers.get(e.type)({coords:i,selection:r,controller:o,cellCoordsFactory:a,isShiftKey:e.shiftKey,isLeftClick:isLeftClick(e)||e.type==="touchstart",isRightClick:isRightClick(e)})}const holder=new WeakMap,rootInstanceSymbol=Symbol("rootInstance");function registerAsRootInstance(e){holder.set(e,!0)}function hasValidParameter(e){return e===rootInstanceSymbol}function isRootInstance(e){return holder.has(e)}var import_es_error_cause$124=__toESM(require_es_error_cause(),1),import_es_array_push$92=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$43(e,t){_checkPrivateRedeclaration$60(e,t),t.add(e)}function _classPrivateFieldInitSpec$43(e,t,i){_checkPrivateRedeclaration$60(e,t),t.set(e,i)}function _checkPrivateRedeclaration$60(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$81(e,t,i){return(t=_toPropertyKey$82(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$82(e){var t=_toPrimitive$82(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$82(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet$43(e,t){return e.get(_assertClassBrand$60(e,t))}function _classPrivateFieldSet$39(e,t,i){return e.set(_assertClassBrand$60(e,t),i),i}function _assertClassBrand$60(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _columnHeadersCount=new WeakMap,_rowHeadersCount=new WeakMap,_selectionMouseDown=new WeakMap,_mouseDown=new WeakMap,_table=new WeakMap,_lastWidth=new WeakMap,_lastHeight=new WeakMap,_TableView_brand=new WeakSet,TableView=class{constructor(e){_classPrivateMethodInitSpec$43(this,_TableView_brand),_defineProperty$81(this,"hot",void 0),_defineProperty$81(this,"eventManager",void 0),_defineProperty$81(this,"settings",void 0),_defineProperty$81(this,"THEAD",void 0),_defineProperty$81(this,"TBODY",void 0),_defineProperty$81(this,"_wt",void 0),_defineProperty$81(this,"activeWt",void 0),_classPrivateFieldInitSpec$43(this,_columnHeadersCount,0),_classPrivateFieldInitSpec$43(this,_rowHeadersCount,0),_defineProperty$81(this,"postponedAdjustElementsSize",!1),_classPrivateFieldInitSpec$43(this,_selectionMouseDown,!1),_classPrivateFieldInitSpec$43(this,_mouseDown,void 0),_classPrivateFieldInitSpec$43(this,_table,void 0),_classPrivateFieldInitSpec$43(this,_lastWidth,0),_classPrivateFieldInitSpec$43(this,_lastHeight,0),this.hot=e,this.eventManager=new eventManager_default(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,t){const i=this._wt.getCell(e,t);return i<0?null:i}scrollViewport(e,t,i,r,o){return this._wt.scrollViewport(e,t,i,r,o)}scrollViewportHorizontally(e,t,i){return this._wt.scrollViewportHorizontally(e,t,i)}scrollViewportVertically(e,t,i){return this._wt.scrollViewportVertically(e,t,i)}createElements(){const{rootElement:e,rootDocument:t}=this.hot,i=e.getAttribute("style");i&&e.setAttribute("data-originalstyle",i),addClass$1(e,"handsontable"),_classPrivateFieldSet$39(_table,this,t.createElement("TABLE")),addClass$1(_classPrivateFieldGet$43(_table,this),"htCore"),this.hot.getSettings().tableClassName&&addClass$1(_classPrivateFieldGet$43(_table,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(setAttribute(_classPrivateFieldGet$43(_table,this),[A11Y_PRESENTATION()]),setAttribute(e,[A11Y_TREEGRID(),A11Y_ROWCOUNT(-1),A11Y_COLCOUNT(this.hot.countCols()),A11Y_MULTISELECTABLE()])),this.THEAD=t.createElement("THEAD"),_classPrivateFieldGet$43(_table,this).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),_classPrivateFieldGet$43(_table,this).appendChild(this.TBODY),this.hot.table=_classPrivateFieldGet$43(_table,this),this.hot.container.insertBefore(_classPrivateFieldGet$43(_table,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:t,selection:i,rootWindow:r}=this.hot,o=t.documentElement;this.eventManager.addEventListener(e,"mousedown",c=>{_classPrivateFieldSet$39(_selectionMouseDown,this,!0),this.isTextSelectionAllowed(c.target)||(clearTextSelection(r),c.preventDefault(),r.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{_classPrivateFieldSet$39(_selectionMouseDown,this,!1)}),this.eventManager.addEventListener(e,"mousemove",c=>{_classPrivateFieldGet$43(_selectionMouseDown,this)&&!this.isTextSelectionAllowed(c.target)&&(this.settings.fragmentSelection&&clearTextSelection(r),c.preventDefault())}),this.eventManager.addEventListener(o,"keyup",c=>{i.isInProgress()&&!c.shiftKey&&i.finish()}),this.eventManager.addEventListener(o,"mouseup",c=>{i.isInProgress()&&isLeftClick(c)&&i.finish(),_classPrivateFieldSet$39(_mouseDown,this,!1);const u=isOutsideInput(t.activeElement);isInput(t.activeElement)&&!u||(u||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!e.contains(c.target)&&!isRightClick(c))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",c=>{i.isInProgress()&&isRightClick(c)&&(i.finish(),_classPrivateFieldSet$39(_mouseDown,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{i.isInProgress()&&i.finish(),_classPrivateFieldSet$39(_mouseDown,this,!1)}),this.eventManager.addEventListener(o,"mousedown",c=>{const u=c.target,h=c.x||c.clientX,d=c.y||c.clientY;let f=c.target;if(_classPrivateFieldGet$43(_mouseDown,this)||!e||!this.hot.view)return;const{holder:m}=this._wt.wtTable;if(f===m){const v=getScrollbarWidth(t);if(t.elementFromPoint(h+v,d)!==m||t.elementFromPoint(h,d+v)!==m)return}else for(;f!==o;){if(f===null){if(c.isTargetWebComponent)break;return}if(f===e)return;f=f.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(u):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=getParentWindow(r);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=getParentWindow(a);this.eventManager.addEventListener(_classPrivateFieldGet$43(_table,this),"selectstart",c=>{this.settings.fragmentSelection||isInput(c.target)||c.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:i}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,i))}translateFromRenderableToVisualIndex(e,t){let i=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return i===null&&(i=e),r===null&&(r=t),[i,r]}countRenderableIndexes(e,t){const i=Math.min(e.getNotTrimmedIndexesLength(),t),r=e.getNearestNotHiddenIndex(i-1,-1);return r===null?0:e.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,i,r){if(isNaN(e)||e<0)return 0;const o=i.getNearestNotHiddenIndex(e,t),a=i.getRenderableFromVisualIndex(o);if(!Number.isInteger(a))return 0;let c=0;return t<0?c=a+1:t>0&&(c=r-a),c}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let i=0;for(let r=e;r<=t;r++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}countRenderableRowsInRange(e,t){let i=0;for(let r=e;r<=t;r++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:_classPrivateFieldGet$43(_table,this),isDataViewInstance:()=>isRootInstance(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,a)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,a)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((a,c)=>{const u=a>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(a):a;this.appendRowHeader(u,c)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),_classPrivateFieldSet$39(_rowHeadersCount,this,o.length),this.hot.getSettings().ariaTags&&_assertClassBrand$60(_TableView_brand,this,_getAriaColcount).call(this)===this.hot.countCols()&&_assertClassBrand$60(_TableView_brand,this,_updateAriaColcount).call(this,_classPrivateFieldGet$43(_rowHeadersCount,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((a,c)=>{const u=a>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(a):a;this.appendColHeader(u,c)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),_classPrivateFieldSet$39(_columnHeadersCount,this,o.length),o},columnWidth:o=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(a===null?o:a)},rowHeight:o=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(a===null?o:a)},rowHeightByOverlayName:(o,a)=>{const c=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),u=c===null?o:c;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(u),u,a)},cellRenderer:(o,a,c)=>{const[u,h]=this.translateFromRenderableToVisualIndex(o,a),d=this.hot.runHooks("modifyGetCellCoords",u,h);let f=u,m=h;Array.isArray(d)&&([f,m]=d);const g=this.hot.getCellMeta(f,m),v=this.hot.colToProp(m);let _=this.hot.getDataAtRowProp(f,v);this.hot.hasHook("beforeValueRender")&&(_=this.hot.runHooks("beforeValueRender",_,g)),this.hot.runHooks("beforeRenderer",c,u,h,v,_,g),this.hot.getCellRenderer(g)(this.hot,c,u,h,v,_,g),this.hot.runHooks("afterRenderer",c,u,h,v,_,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&isVisible$1(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,a,c,u)=>{const h=this.translateFromRenderableToVisualCoords(a),d={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=u,_classPrivateFieldSet$39(_mouseDown,this,!0),this.hot.runHooks("beforeOnCellMouseDown",o,h,c,d),!isImmediatePropagationStopped(o)&&(handleMouseEvent(o,{coords:h,selection:this.hot.selection,controller:d,cellCoordsFactory:(f,m)=>this.hot._createCellCoords(f,m)}),this.hot.runHooks("afterOnCellMouseDown",o,h,c),this.activeWt=this._wt)},onCellContextMenu:(o,a,c,u)=>{const h=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,_classPrivateFieldSet$39(_mouseDown,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,h,c),!isImmediatePropagationStopped(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,h,c),this.activeWt=this._wt)},onCellMouseOut:(o,a,c,u)=>{const h=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,this.hot.runHooks("beforeOnCellMouseOut",o,h,c),!isImmediatePropagationStopped(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,h,c),this.activeWt=this._wt)},onCellMouseOver:(o,a,c,u)=>{const h=this.translateFromRenderableToVisualCoords(a),d={row:!1,column:!1,cell:!1};this.activeWt=u,this.hot.runHooks("beforeOnCellMouseOver",o,h,c,d),!isImmediatePropagationStopped(o)&&(_classPrivateFieldGet$43(_mouseDown,this)&&handleMouseEvent(o,{coords:h,selection:this.hot.selection,controller:d,cellCoordsFactory:(f,m)=>this.hot._createCellCoords(f,m)}),this.hot.runHooks("afterOnCellMouseOver",o,h,c),this.activeWt=this._wt)},onCellMouseUp:(o,a,c,u)=>{const h=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,this.hot.runHooks("beforeOnCellMouseUp",o,h,c),!(isImmediatePropagationStopped(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,h,c),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,a)=>this.beforeRender(o,a),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:o=>{const a=this.hot.rowIndexMapper,c=o<0;let u=o;return!c&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u),this.hot.runHooks("beforeViewportScroll"),c?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:o=>{const a=this.hot.columnIndexMapper,c=o<0;let u=o;return!c&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u),this.hot.runHooks("beforeViewportScroll"),c?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,a,c)=>{const u=this.hot.rowIndexMapper,h=o<0;let d=o;h||(d=u.getVisualFromRenderableIndex(o));const f=this.hot.runHooks("beforeHighlightingRowHeader",d,a,c);return h?f:u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(f,1))},onBeforeHighlightingColumnHeader:(o,a,c)=>{const u=this.hot.columnIndexMapper,h=o<0;let d=o;h||(d=u.getVisualFromRenderableIndex(o));const f=this.hot.runHooks("beforeHighlightingColumnHeader",d,a,c);return h?f:u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(f,1))},onAfterDrawSelection:(o,a,c)=>{let u;const[h,d]=this.translateFromRenderableToVisualIndex(o,a),f=this.hot.selection.getSelectedRange();if(f.size()>0){const g=f.peekByIndex(c??0);u=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",h,d,u,c)},onBeforeDrawBorders:(o,a)=>{const[c,u,h,d]=o,f=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(c),this.hot.columnIndexMapper.getVisualFromRenderableIndex(u),this.hot.rowIndexMapper.getVisualFromRenderableIndex(h),this.hot.columnIndexMapper.getVisualFromRenderableIndex(d)];return this.hot.runHooks("beforeDrawBorders",f,a)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,a)=>{const c=this.hot.columnIndexMapper.getVisualFromRenderableIndex(a);return this.hot.runHooks("beforeStretchingColumnWidth",o,c)},onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,a,c)=>{const u=this.hot.rowIndexMapper,h=this.hot.columnIndexMapper,d=a>=0?h.getVisualFromRenderableIndex(a):a,f=o>=0?u.getVisualFromRenderableIndex(o):o,m=this.hot.runHooks("modifyGetCellCoords",f,d,c);if(Array.isArray(m)){const[g,v,_,b]=m;return[g>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1)):g,v>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(v,1)):v,_>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(_,-1)):_,b>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(b,-1)):b]}},viewportRowCalculatorOverride:o=>{let a=this.settings.viewportRowRenderingOffset;if(a==="auto"&&this.settings.fixedRowsTop&&(a=10),a>0||a==="auto"){const c=this.countRenderableRows(),u=o.startRow,h=o.endRow;if(typeof a=="number")o.startRow=Math.max(u-a,0),o.endRow=Math.min(h+a,c-1);else if(a==="auto"){const d=Math.ceil(h/c*12);o.startRow=Math.max(u-d,0),o.endRow=Math.min(h+d,c-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let a=this.settings.viewportColumnRenderingOffset;if(a==="auto"&&this.settings.fixedColumnsStart&&(a=10),a>0||a==="auto"){const c=this.countRenderableColumns(),u=o.startColumn,h=o.endColumn;if(typeof a=="number"&&(o.startColumn=Math.max(u-a,0),o.endColumn=Math.min(h+a,c-1)),a==="auto"){const d=Math.ceil(h/c*6);o.startColumn=Math.max(u-d,0),o.endColumn=Math.min(h+d,c-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new WalkontableFacade(e),this.activeWt=this._wt;const t=this._wt.wtTable.spreader,{width:i,height:r}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,r),this.eventManager.addEventListener(t,"mousedown",o=>{o.target===t&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(t,"contextmenu",o=>{o.target===t&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(isInput(e))return!0;const t=isChildOf(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&t||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&t||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return _classPrivateFieldGet$43(_mouseDown,this)}isSelectedOnlyCell(){var e,t;return(e=(t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const i=t.firstChild;if(!hasClass$1(i,"relative")){empty(t),this.appendRowHeader(e,t);return}this.updateCellHeader(i.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:i,getRowHeader:r}=this.hot,o=i.createElement("div"),a=i.createElement("span");o.className="relative",a.className="rowHeader",this.updateCellHeader(a,e,r),o.appendChild(a),t.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const a=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return a?a.split(" "):[]};if(t.firstChild){const a=t.firstChild;hasClass$1(a,"relative")?(this.updateCellHeader(a.querySelector(".colHeader"),e,i,r),a.className="",addClass$1(a,["relative",...o()])):(empty(t),this.appendColHeader(e,t,i,r))}else{const{rootDocument:a}=this.hot,c=a.createElement("div"),u=a.createElement("span"),h=o();c.classList.add("relative",...h),u.className="colHeader",this.settings.ariaTags&&(setAttribute(c,...A11Y_PRESENTATION()),setAttribute(u,...A11Y_PRESENTATION())),this.updateCellHeader(u,e,i,r),c.appendChild(u),t.appendChild(c)}this.hot.runHooks("afterGetColHeader",e,t,r)}updateCellHeader(e,t,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=t;const a=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(hasClass$1(e,"colHeader")?o=a.wtTable.columnFilter.sourceToRendered(t):hasClass$1(e,"rowHeader")&&(o=a.wtTable.rowFilter.sourceToRendered(t))),o>-1?fastInnerHTML(e,i(t,r)):(fastInnerText(e,"\xA0"),addClass$1(e,"cornerHeader"))}maximumVisibleElementWidth(e){const i=this._wt.wtViewport.getWorkspaceWidth()-e;return i>0?i:0}maximumVisibleElementHeight(e){const i=this._wt.wtViewport.getWorkspaceHeight()-e;return i>0?i:0}setLastSize(e,t){_classPrivateFieldSet$39(_lastWidth,this,e),_classPrivateFieldSet$39(_lastHeight,this,t)}getLastSize(){return{width:_classPrivateFieldGet$43(_lastWidth,this),height:_classPrivateFieldGet$43(_lastHeight,this)}}getFirstRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedRow(),1):null}getLastRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedRow(),-1):null}getFirstRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedColumn(),1):null}getLastRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedColumn(),-1):null}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return _classPrivateFieldGet$43(_columnHeadersCount,this)}getRowHeadersCount(){return _classPrivateFieldGet$43(_rowHeadersCount,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var t;return((t=this._wt.wtOverlays.getParentOverlay(e))!==null&&t!==void 0?t:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}isVisible(){return this._wt.wtTable.isVisible()}destroy(){this._wt.destroy(),this.eventManager.destroy()}};function _getAriaColcount(){return parseInt(this.hot.rootElement.getAttribute(A11Y_COLCOUNT()[0]),10)}function _updateAriaColcount(e){const t=_assertClassBrand$60(_TableView_brand,this,_getAriaColcount).call(this)+e;setAttribute(this.hot.rootElement,...A11Y_COLCOUNT(t))}var tableView_default=TableView,data_exports={};__export(data_exports,{countFirstRowKeys:()=>countFirstRowKeys,createEmptySpreadsheetData:()=>createEmptySpreadsheetData,createSpreadsheetData:()=>createSpreadsheetData,createSpreadsheetObjectData:()=>createSpreadsheetObjectData,dataRowToChangesArray:()=>dataRowToChangesArray,isArrayOfArrays:()=>isArrayOfArrays,isArrayOfObjects:()=>isArrayOfObjects,spreadsheetColumnIndex:()=>spreadsheetColumnIndex,spreadsheetColumnLabel:()=>spreadsheetColumnLabel});var import_es_array_push$91=__toESM(require_es_array_push(),1);const COLUMN_LABEL_BASE="ABCDEFGHIJKLMNOPQRSTUVWXYZ",COLUMN_LABEL_BASE_LENGTH=COLUMN_LABEL_BASE.length;function spreadsheetColumnLabel(e){let t=e+1,i="",r;for(;t>0;)r=(t-1)%COLUMN_LABEL_BASE_LENGTH,i=String.fromCharCode(65+r)+i,t=parseInt((t-r)/COLUMN_LABEL_BASE_LENGTH,10);return i}function spreadsheetColumnIndex(e){let t=0;if(e)for(let i=0,r=e.length-1;i<e.length;i+=1,r-=1)t+=COLUMN_LABEL_BASE_LENGTH**r*(COLUMN_LABEL_BASE.indexOf(e[i])+1);return t-=1,t}function createSpreadsheetData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const i=[];let r,o;for(r=0;r<e;r++){const a=[];for(o=0;o<t;o++)a.push(spreadsheetColumnLabel(o)+(r+1));i.push(a)}return i}function createSpreadsheetObjectData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const i=[];let r,o;for(r=0;r<e;r++){const a={};for(o=0;o<t;o++)a[`prop${o}`]=spreadsheetColumnLabel(o)+(r+1);i.push(a)}return i}function createEmptySpreadsheetData(e,t){const i=[];let r;for(let o=0;o<e;o++){r=[];for(let a=0;a<t;a++)r.push("");i.push(r)}return i}function dataRowToChangesArray(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=e;const r=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(i=[e]),i.forEach((o,a)=>{Array.isArray(o)?o.forEach((c,u)=>{r.push([a+t,u,c])}):Object.keys(o).forEach(c=>{r.push([a+t,c,o[c]])})}),r}function countFirstRowKeys(e){let t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&isObject$4(e[0])&&(t=deepObjectSize(e[0]))),t}function isArrayOfArrays(e){return!!(Array.isArray(e)&&e.length&&e.every(t=>Array.isArray(t)))}function isArrayOfObjects(e){return!!(Array.isArray(e)&&e.length&&e.every(t=>typeof t=="object"&&!Array.isArray(t)&&t!==null))}var import_es_error_cause$123=__toESM(require_es_error_cause(),1),import_es_array_push$90=__toESM(require_es_array_push(),1);function _defineProperty$80(e,t,i){return(t=_toPropertyKey$81(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$81(e){var t=_toPrimitive$81(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$81(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DataSource=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];_defineProperty$80(this,"hot",void 0),_defineProperty$80(this,"data",void 0),_defineProperty$80(this,"dataType","array"),_defineProperty$80(this,"colToProp",()=>{}),_defineProperty$80(this,"propToCol",()=>{}),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),t!==void 0&&!Number.isInteger(t)?t:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const t=[];return arrayEach$1(this.data,(i,r)=>{const o=this.getAtCell(r,e);t.push(o)}),t}getAtRow(e,t,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=t===void 0&&i===void 0,{dataDotNotation:a}=this.hot.getSettings();let c=null,u=null;if(c=this.modifyRowData(e),Array.isArray(c))u=[],o?c.forEach((h,d)=>{u[d]=this.getAtPhysicalCell(e,d,c)}):rangeEach(t,i,h=>{u[h-t]=this.getAtPhysicalCell(e,h,c)});else if(isObject$4(c)||isFunction$2(c))if(r?u=[]:u={},!o||r){const d=this.countFirstRowKeys()-1;rangeEach(0,d,f=>{const m=this.colToProp(f);if(f>=(t||0)&&f<=(i||d)&&!Number.isInteger(m)){const g=this.getAtPhysicalCell(e,m,c);r?u.push(g):a?setProperty(u,m,g):u[m]=g}})}else objectEach(c,(h,d)=>{const f=this.getAtPhysicalCell(e,d,c);a?setProperty(u,d,f):u[d]=f});return u}setAtCell(e,t,i){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const r=createObjectPropListener(i);this.hot.runHooks("modifySourceData",e,t,r,"set"),r.isTouched()&&(i=r.value)}Number.isInteger(t)?this.data[e][t]=i:setProperty(this.data[e],t,i)}}getAtPhysicalCell(e,t,i){let r=null;if(i)if(typeof t=="string"){const{dataDotNotation:o}=this.hot.getSettings();r=o?getProperty(i,t):i[t]}else typeof t=="function"?r=t(i):r=i[t];if(this.hot.hasHook("modifySourceData")){const o=createObjectPropListener(r);this.hot.runHooks("modifySourceData",e,t,o,"get"),o.isTouched()&&(r=o.value)}return r}getAtCell(e,t){const i=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),i)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=!1,o=null,a=null,c=null,u=null;e===null||t===null?(r=!0,o=0,c=this.countRows()-1):(o=Math.min(e.row,t.row),a=Math.min(e.col,t.col),c=Math.max(e.row,t.row),u=Math.max(e.col,t.col));const h=[];return rangeEach(o,c,d=>{h.push(r?this.getAtRow(d,void 0,void 0,i):this.getAtRow(d,a,u,i))}),h}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return countFirstRowKeys(this.data)}destroy(){this.data=null,this.hot=null}},dataSource_default=DataSource,import_es_error_cause$122=__toESM(require_es_error_cause(),1),import_es_array_push$89=__toESM(require_es_array_push(),1);function _defineProperty$79(e,t,i){return(t=_toPropertyKey$80(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$80(e){var t=_toPrimitive$80(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$80(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IndexMap=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;_defineProperty$79(this,"indexedValues",[]),_defineProperty$79(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length?(this.indexedValues[e]=t,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,isFunction$2(this.initValueOrFn)?rangeEach(e-1,t=>this.indexedValues.push(this.initValueOrFn(t))):rangeEach(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}};mixin(IndexMap,localHooks_default);function getListWithInsertedItems$3(e,t,i,r){const o=i.length?i[0]:void 0;return[...e.slice(0,o),...i.map((a,c)=>isFunction$2(r)?r(a,c):r),...o===void 0?[]:e.slice(o)]}function getListWithRemovedItems$3(e,t){return arrayFilter$1(e,(i,r)=>t.includes(r)===!1)}var PhysicalIndexToValueMap=class extends IndexMap{insert(e,t){this.indexedValues=getListWithInsertedItems$3(this.indexedValues,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=getListWithRemovedItems$3(this.indexedValues,e),super.remove(e)}},import_es_array_push$88=__toESM(require_es_array_push(),1),HidingMap=class extends PhysicalIndexToValueMap{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return arrayReduce(this.getValues(),(e,t,i)=>(t&&e.push(i),e),[])}};function getListWithInsertedItems$2(e,t,i){return[...e.slice(0,t),...i,...e.slice(t)]}function getListWithRemovedItems$2(e,t){return arrayFilter$1(e,i=>t.includes(i)===!1)}function getDecreasedIndexes(e,t){return arrayMap$1(e,i=>i-t.filter(r=>r<i).length)}function getIncreasedIndexes(e,t){const i=t[0],r=t.length;return arrayMap$1(e,o=>o>=i?o+r:o)}var import_es_error_cause$121=__toESM(require_es_error_cause(),1);function _defineProperty$78(e,t,i){return(t=_toPropertyKey$79(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$79(e){var t=_toPrimitive$79(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$79(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LinkedPhysicalIndexToValueMap=class extends IndexMap{constructor(){super(...arguments),_defineProperty$78(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=t,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(i,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=getListWithRemovedItems$2(this.orderOfIndexes,[e]),isFunction$2(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=getListWithInsertedItems$3(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=getIncreasedIndexes(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=getListWithRemovedItems$3(this.indexedValues,e),this.orderOfIndexes=getListWithRemovedItems$2(this.orderOfIndexes,e),this.orderOfIndexes=getDecreasedIndexes(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}},import_es_array_push$87=__toESM(require_es_array_push(),1),TrimmingMap=class extends PhysicalIndexToValueMap{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return arrayReduce(this.getValues(),(e,t,i)=>(t&&e.push(i),e),[])}},import_es_error_cause$120=__toESM(require_es_error_cause(),1);const alterStrategies=new Map([["indexesSequence",{getListWithInsertedItems:getListWithInsertedItems$2,getListWithRemovedItems:getListWithRemovedItems$2}],["physicallyIndexed",{getListWithInsertedItems:getListWithInsertedItems$3,getListWithRemovedItems:getListWithRemovedItems$3}]]),alterUtilsFactory=e=>{if(alterStrategies.has(e)===!1)throw new Error(`Alter strategy with ID '${e}' does not exist.`);return alterStrategies.get(e)};var IndexesSequence=class extends IndexMap{constructor(){super(e=>e)}insert(e,t){const i=getIncreasedIndexes(this.indexedValues,t);this.indexedValues=getListWithInsertedItems$2(i,e,t),super.insert(e,t)}remove(e){const t=getListWithRemovedItems$2(this.indexedValues,e);this.indexedValues=getDecreasedIndexes(t,e),super.remove(e)}},import_es_error_cause$119=__toESM(require_es_error_cause(),1);const availableIndexMapTypes=new Map([["hiding",HidingMap],["index",IndexMap],["linkedPhysicalIndexToValue",LinkedPhysicalIndexToValueMap],["physicalIndexToValue",PhysicalIndexToValueMap],["trimming",TrimmingMap]]);function createIndexMap(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!availableIndexMapTypes.has(e))throw new Error(`The provided map type ("${e}") does not exist.`);return new(availableIndexMapTypes.get(e))(t)}var import_es_error_cause$118=__toESM(require_es_error_cause(),1);function _defineProperty$77(e,t,i){return(t=_toPropertyKey$78(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$78(e){var t=_toPrimitive$78(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$78(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}let registeredMaps=0;var MapCollection=class{constructor(){_defineProperty$77(this,"collection",new Map)}register(e,t){this.collection.has(e)===!1&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)),registeredMaps+=1)}unregister(e){const t=this.collection.get(e);isDefined(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),registeredMaps-=1)}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return isUndefined$1(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(i=>{i.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}};mixin(MapCollection,localHooks_default);function getRegisteredMapsCounter(){return registeredMaps}var import_es_error_cause$117=__toESM(require_es_error_cause(),1),import_es_array_push$86=__toESM(require_es_array_push(),1);function _defineProperty$76(e,t,i){return(t=_toPropertyKey$77(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$77(e){var t=_toPrimitive$77(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$77(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AggregatedCollection=class extends MapCollection{constructor(e,t){super(),_defineProperty$76(this,"mergedValuesCache",[]),_defineProperty$76(this,"aggregationFunction",void 0),_defineProperty$76(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const t=arrayMap$1(this.get(),o=>o.getValues()),i=[],r=isDefined(t[0])&&t[0].length||0;for(let o=0;o<r;o+=1){const a=[];for(let c=0;c<this.getLength();c+=1)a.push(t[c][o]);i.push(a)}return arrayMap$1(i,this.aggregationFunction)}getMergedValueAtIndex(e,t){const i=this.getMergedValues(t)[e];return isDefined(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}},import_es_error_cause$116=__toESM(require_es_error_cause(),1);function _classPrivateFieldInitSpec$42(e,t,i){_checkPrivateRedeclaration$59(e,t),t.set(e,i)}function _checkPrivateRedeclaration$59(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$38(e,t,i){return e.set(_assertClassBrand$59(e,t),i),i}function _classPrivateFieldGet$42(e,t){return e.get(_assertClassBrand$59(e,t))}function _assertClassBrand$59(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _currentInitialChanges=new WeakMap,ChangesObserver=class{constructor(){_classPrivateFieldInitSpec$42(this,_currentInitialChanges,[])}subscribe(e){return this.addLocalHook("change",e),this._write(_classPrivateFieldGet$42(_currentInitialChanges,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){_classPrivateFieldSet$38(_currentInitialChanges,this,e)}};mixin(ChangesObserver,localHooks_default);var import_es_array_push$85=__toESM(require_es_array_push(),1);function arrayDiff(e,t){const i=[];let r=0,o=0;for(;r<e.length&&o<t.length;r++,o++)e[r]!==t[o]&&i.push({op:"replace",index:o,oldValue:e[r],newValue:t[o]});for(;r<t.length;r++)i.push({op:"insert",index:r,oldValue:void 0,newValue:t[r]});for(;o<e.length;o++)i.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return i}var import_es_error_cause$115=__toESM(require_es_error_cause(),1),import_es_set_difference_v2$21=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$21=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$21=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$21=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$21=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$21=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$21=__toESM(require_es_set_union_v2(),1);function _classPrivateFieldInitSpec$41(e,t,i){_checkPrivateRedeclaration$58(e,t),t.set(e,i)}function _checkPrivateRedeclaration$58(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$41(e,t){return e.get(_assertClassBrand$58(e,t))}function _classPrivateFieldSet$37(e,t,i){return e.set(_assertClassBrand$58(e,t),i),i}function _assertClassBrand$58(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _observers=new WeakMap,_indexMatrix=new WeakMap,_currentIndexState=new WeakMap,_isMatrixIndexesInitialized=new WeakMap,_initialIndexValue=new WeakMap,ChangesObservable=class{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_classPrivateFieldInitSpec$41(this,_observers,new Set),_classPrivateFieldInitSpec$41(this,_indexMatrix,[]),_classPrivateFieldInitSpec$41(this,_currentIndexState,[]),_classPrivateFieldInitSpec$41(this,_isMatrixIndexesInitialized,!1),_classPrivateFieldInitSpec$41(this,_initialIndexValue,!1),_classPrivateFieldSet$37(_initialIndexValue,this,e??!1)}createObserver(){const e=new ChangesObserver;return _classPrivateFieldGet$41(_observers,this).add(e),e.addLocalHook("unsubscribe",()=>{_classPrivateFieldGet$41(_observers,this).delete(e)}),e._writeInitialChanges(arrayDiff(_classPrivateFieldGet$41(_indexMatrix,this),_classPrivateFieldGet$41(_currentIndexState,this))),e}emit(e){let t=_classPrivateFieldGet$41(_currentIndexState,this);(!_classPrivateFieldGet$41(_isMatrixIndexesInitialized,this)||_classPrivateFieldGet$41(_indexMatrix,this).length!==e.length)&&(e.length===0?e=new Array(t.length).fill(_classPrivateFieldGet$41(_initialIndexValue,this)):_classPrivateFieldSet$37(_indexMatrix,this,new Array(e.length).fill(_classPrivateFieldGet$41(_initialIndexValue,this))),_classPrivateFieldGet$41(_isMatrixIndexesInitialized,this)||(_classPrivateFieldSet$37(_isMatrixIndexesInitialized,this,!0),t=_classPrivateFieldGet$41(_indexMatrix,this)));const i=arrayDiff(t,e);_classPrivateFieldGet$41(_observers,this).forEach(r=>r._write(i)),_classPrivateFieldSet$37(_currentIndexState,this,e)}},import_es_error_cause$114=__toESM(require_es_error_cause(),1),import_es_set_difference_v2$20=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$20=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$20=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$20=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$20=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$20=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$20=__toESM(require_es_set_union_v2(),1);function _defineProperty$75(e,t,i){return(t=_toPropertyKey$76(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$76(e){var t=_toPrimitive$76(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$76(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IndexMapper=class{constructor(){_defineProperty$75(this,"indexesSequence",new IndexesSequence),_defineProperty$75(this,"trimmingMapsCollection",new AggregatedCollection(e=>e.some(t=>t===!0),!1)),_defineProperty$75(this,"hidingMapsCollection",new AggregatedCollection(e=>e.some(t=>t===!0),!1)),_defineProperty$75(this,"variousMapsCollection",new MapCollection),_defineProperty$75(this,"hidingChangesObservable",new ChangesObservable({initialIndexValue:!1})),_defineProperty$75(this,"notTrimmedIndexesCache",[]),_defineProperty$75(this,"notHiddenIndexesCache",[]),_defineProperty$75(this,"isBatched",!1),_defineProperty$75(this,"indexesSequenceChanged",!1),_defineProperty$75(this,"indexesChangeSource",void 0),_defineProperty$75(this,"trimmedIndexesChanged",!1),_defineProperty$75(this,"hiddenIndexesChanged",!1),_defineProperty$75(this,"renderablePhysicalIndexesCache",[]),_defineProperty$75(this,"fromPhysicalToVisualIndexesCache",new Map),_defineProperty$75(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,i){return this.registerMap(e,createIndexMap(t,i))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof TrimmingMap?this.trimmingMapsCollection.register(e,t):t instanceof HidingMap?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const i=this.getNumberOfIndexes();return i>0&&t.init(i),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return isDefined(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return isDefined(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return isDefined(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return isDefined(t)?t:null}getNearestNotHiddenIndex(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let a=-1;return t>0?a=o.findIndex(c=>c>e):a=o.reverse().findIndex(c=>c<e),a===-1?i?this.getNearestNotHiddenIndex(e,-t,!1):null:o[a]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const i=[...Array(this.getNumberOfIndexes()-e).keys()].map(r=>r+e);this.removeIndexes(i)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(i=>this.isTrimmed(i)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(i=>this.isHidden(i)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(i=>this.isHidden(i)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){typeof e=="number"&&(e=[e]);const i=arrayMap$1(e,h=>this.getPhysicalFromVisualIndex(h)),r=this.getNotTrimmedIndexesLength(),o=e.length,a=getListWithRemovedItems$2(this.getIndexesSequence(),i),c=a.filter(h=>this.isTrimmed(h)===!1);let u=a.indexOf(c[c.length-1])+1;if(t+o<r){const h=c[t];u=a.indexOf(h)}this.indexesChangeSource="move",this.setIndexesSequence(getListWithInsertedItems$2(a,u,i)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const i=this.getNotTrimmedIndexes()[e],r=isDefined(i)?i:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=arrayMap$1(new Array(t).fill(r),(c,u)=>c+u);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,a),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,a),this.hidingMapsCollection.insertToEvery(o,a),this.variousMapsCollection.insertToEvery(o,a),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&t===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const i=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(i,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const i=this.getPhysicalFromRenderableIndex(t),r=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(r,t)}}};mixin(IndexMapper,localHooks_default);function extendNotExistingKeys(e,t){return objectEach(t,(i,r)=>{isUndefined$1(e[r])&&(e[r]=i)}),e}function normalizeLanguageCode(e){const i=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(e);return i?`${i[1].toLowerCase()}-${i[2].toUpperCase()}`:e}function warnUserAboutLanguageRegistration(e){isDefined(e)&&error(toSingleLine`Language with code "${e}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function pluralize(e,t){return Array.isArray(e)&&Number.isInteger(t)?e[t]:e}const{register:registerGloballyPhraseFormatter,getValues:getGlobalPhraseFormatters}=staticRegister("phraseFormatters");function register$1(e,t){registerGloballyPhraseFormatter(e,t)}function getAll(){return getGlobalPhraseFormatters()}register$1("pluralize",pluralize);var constants_exports={};__export(constants_exports,{CHECKBOX_CHECKED:()=>CHECKBOX_CHECKED,CHECKBOX_RENDERER_NAMESPACE:()=>CHECKBOX_RENDERER_NAMESPACE,CHECKBOX_UNCHECKED:()=>CHECKBOX_UNCHECKED,CONTEXTMENU_ITEMS_ADD_COMMENT:()=>CONTEXTMENU_ITEMS_ADD_COMMENT,CONTEXTMENU_ITEMS_ALIGNMENT:()=>CONTEXTMENU_ITEMS_ALIGNMENT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:()=>CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:()=>CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:()=>CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:()=>CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:()=>CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:()=>CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:()=>CONTEXTMENU_ITEMS_ALIGNMENT_TOP,CONTEXTMENU_ITEMS_BORDERS:()=>CONTEXTMENU_ITEMS_BORDERS,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:()=>CONTEXTMENU_ITEMS_BORDERS_BOTTOM,CONTEXTMENU_ITEMS_BORDERS_LEFT:()=>CONTEXTMENU_ITEMS_BORDERS_LEFT,CONTEXTMENU_ITEMS_BORDERS_RIGHT:()=>CONTEXTMENU_ITEMS_BORDERS_RIGHT,CONTEXTMENU_ITEMS_BORDERS_TOP:()=>CONTEXTMENU_ITEMS_BORDERS_TOP,CONTEXTMENU_ITEMS_CLEAR_COLUMN:()=>CONTEXTMENU_ITEMS_CLEAR_COLUMN,CONTEXTMENU_ITEMS_COPY:()=>CONTEXTMENU_ITEMS_COPY,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:()=>CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:()=>CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:()=>CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,CONTEXTMENU_ITEMS_CUT:()=>CONTEXTMENU_ITEMS_CUT,CONTEXTMENU_ITEMS_EDIT_COMMENT:()=>CONTEXTMENU_ITEMS_EDIT_COMMENT,CONTEXTMENU_ITEMS_FREEZE_COLUMN:()=>CONTEXTMENU_ITEMS_FREEZE_COLUMN,CONTEXTMENU_ITEMS_HIDE_COLUMN:()=>CONTEXTMENU_ITEMS_HIDE_COLUMN,CONTEXTMENU_ITEMS_HIDE_ROW:()=>CONTEXTMENU_ITEMS_HIDE_ROW,CONTEXTMENU_ITEMS_INSERT_LEFT:()=>CONTEXTMENU_ITEMS_INSERT_LEFT,CONTEXTMENU_ITEMS_INSERT_RIGHT:()=>CONTEXTMENU_ITEMS_INSERT_RIGHT,CONTEXTMENU_ITEMS_MERGE_CELLS:()=>CONTEXTMENU_ITEMS_MERGE_CELLS,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:()=>CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:()=>CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,CONTEXTMENU_ITEMS_NO_ITEMS:()=>CONTEXTMENU_ITEMS_NO_ITEMS,CONTEXTMENU_ITEMS_READ_ONLY:()=>CONTEXTMENU_ITEMS_READ_ONLY,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:()=>CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,CONTEXTMENU_ITEMS_REDO:()=>CONTEXTMENU_ITEMS_REDO,CONTEXTMENU_ITEMS_REMOVE_BORDERS:()=>CONTEXTMENU_ITEMS_REMOVE_BORDERS,CONTEXTMENU_ITEMS_REMOVE_COLUMN:()=>CONTEXTMENU_ITEMS_REMOVE_COLUMN,CONTEXTMENU_ITEMS_REMOVE_COMMENT:()=>CONTEXTMENU_ITEMS_REMOVE_COMMENT,CONTEXTMENU_ITEMS_REMOVE_ROW:()=>CONTEXTMENU_ITEMS_REMOVE_ROW,CONTEXTMENU_ITEMS_ROW_ABOVE:()=>CONTEXTMENU_ITEMS_ROW_ABOVE,CONTEXTMENU_ITEMS_ROW_BELOW:()=>CONTEXTMENU_ITEMS_ROW_BELOW,CONTEXTMENU_ITEMS_SHOW_COLUMN:()=>CONTEXTMENU_ITEMS_SHOW_COLUMN,CONTEXTMENU_ITEMS_SHOW_ROW:()=>CONTEXTMENU_ITEMS_SHOW_ROW,CONTEXTMENU_ITEMS_UNDO:()=>CONTEXTMENU_ITEMS_UNDO,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:()=>CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,CONTEXTMENU_ITEMS_UNMERGE_CELLS:()=>CONTEXTMENU_ITEMS_UNMERGE_CELLS,CONTEXT_MENU_ITEMS_NAMESPACE:()=>CONTEXT_MENU_ITEMS_NAMESPACE,FILTERS_BUTTONS_CANCEL:()=>FILTERS_BUTTONS_CANCEL,FILTERS_BUTTONS_CLEAR:()=>FILTERS_BUTTONS_CLEAR,FILTERS_BUTTONS_OK:()=>FILTERS_BUTTONS_OK,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:()=>FILTERS_BUTTONS_PLACEHOLDER_SEARCH,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:()=>FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,FILTERS_BUTTONS_PLACEHOLDER_VALUE:()=>FILTERS_BUTTONS_PLACEHOLDER_VALUE,FILTERS_BUTTONS_SELECT_ALL:()=>FILTERS_BUTTONS_SELECT_ALL,FILTERS_CONDITIONS_AFTER:()=>FILTERS_CONDITIONS_AFTER,FILTERS_CONDITIONS_BEFORE:()=>FILTERS_CONDITIONS_BEFORE,FILTERS_CONDITIONS_BEGINS_WITH:()=>FILTERS_CONDITIONS_BEGINS_WITH,FILTERS_CONDITIONS_BETWEEN:()=>FILTERS_CONDITIONS_BETWEEN,FILTERS_CONDITIONS_BY_VALUE:()=>FILTERS_CONDITIONS_BY_VALUE,FILTERS_CONDITIONS_CONTAINS:()=>FILTERS_CONDITIONS_CONTAINS,FILTERS_CONDITIONS_EMPTY:()=>FILTERS_CONDITIONS_EMPTY,FILTERS_CONDITIONS_ENDS_WITH:()=>FILTERS_CONDITIONS_ENDS_WITH,FILTERS_CONDITIONS_EQUAL:()=>FILTERS_CONDITIONS_EQUAL,FILTERS_CONDITIONS_GREATER_THAN:()=>FILTERS_CONDITIONS_GREATER_THAN,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:()=>FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,FILTERS_CONDITIONS_LESS_THAN:()=>FILTERS_CONDITIONS_LESS_THAN,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:()=>FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,FILTERS_CONDITIONS_NAMESPACE:()=>FILTERS_CONDITIONS_NAMESPACE,FILTERS_CONDITIONS_NONE:()=>FILTERS_CONDITIONS_NONE,FILTERS_CONDITIONS_NOT_BETWEEN:()=>FILTERS_CONDITIONS_NOT_BETWEEN,FILTERS_CONDITIONS_NOT_CONTAIN:()=>FILTERS_CONDITIONS_NOT_CONTAIN,FILTERS_CONDITIONS_NOT_EMPTY:()=>FILTERS_CONDITIONS_NOT_EMPTY,FILTERS_CONDITIONS_NOT_EQUAL:()=>FILTERS_CONDITIONS_NOT_EQUAL,FILTERS_CONDITIONS_TODAY:()=>FILTERS_CONDITIONS_TODAY,FILTERS_CONDITIONS_TOMORROW:()=>FILTERS_CONDITIONS_TOMORROW,FILTERS_CONDITIONS_YESTERDAY:()=>FILTERS_CONDITIONS_YESTERDAY,FILTERS_DIVS_FILTER_BY_CONDITION:()=>FILTERS_DIVS_FILTER_BY_CONDITION,FILTERS_DIVS_FILTER_BY_VALUE:()=>FILTERS_DIVS_FILTER_BY_VALUE,FILTERS_LABELS_CONJUNCTION:()=>FILTERS_LABELS_CONJUNCTION,FILTERS_LABELS_DISJUNCTION:()=>FILTERS_LABELS_DISJUNCTION,FILTERS_NAMESPACE:()=>FILTERS_NAMESPACE,FILTERS_VALUES_BLANK_CELLS:()=>FILTERS_VALUES_BLANK_CELLS});const CONTEXT_MENU_ITEMS_NAMESPACE="ContextMenu:items",CM_ALIAS=CONTEXT_MENU_ITEMS_NAMESPACE,CONTEXTMENU_ITEMS_NO_ITEMS=`${CM_ALIAS}.noItems`,CONTEXTMENU_ITEMS_ROW_ABOVE=`${CM_ALIAS}.insertRowAbove`,CONTEXTMENU_ITEMS_ROW_BELOW=`${CM_ALIAS}.insertRowBelow`,CONTEXTMENU_ITEMS_INSERT_LEFT=`${CM_ALIAS}.insertColumnOnTheLeft`,CONTEXTMENU_ITEMS_INSERT_RIGHT=`${CM_ALIAS}.insertColumnOnTheRight`,CONTEXTMENU_ITEMS_REMOVE_ROW=`${CM_ALIAS}.removeRow`,CONTEXTMENU_ITEMS_REMOVE_COLUMN=`${CM_ALIAS}.removeColumn`,CONTEXTMENU_ITEMS_UNDO=`${CM_ALIAS}.undo`,CONTEXTMENU_ITEMS_REDO=`${CM_ALIAS}.redo`,CONTEXTMENU_ITEMS_READ_ONLY=`${CM_ALIAS}.readOnly`,CONTEXTMENU_ITEMS_CLEAR_COLUMN=`${CM_ALIAS}.clearColumn`,CONTEXTMENU_ITEMS_COPY=`${CM_ALIAS}.copy`,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS=`${CM_ALIAS}.copyWithHeaders`,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS=`${CM_ALIAS}.copyWithGroupHeaders`,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY=`${CM_ALIAS}.copyHeadersOnly`,CONTEXTMENU_ITEMS_CUT=`${CM_ALIAS}.cut`,CONTEXTMENU_ITEMS_FREEZE_COLUMN=`${CM_ALIAS}.freezeColumn`,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN=`${CM_ALIAS}.unfreezeColumn`,CONTEXTMENU_ITEMS_MERGE_CELLS=`${CM_ALIAS}.mergeCells`,CONTEXTMENU_ITEMS_UNMERGE_CELLS=`${CM_ALIAS}.unmergeCells`,CONTEXTMENU_ITEMS_ADD_COMMENT=`${CM_ALIAS}.addComment`,CONTEXTMENU_ITEMS_EDIT_COMMENT=`${CM_ALIAS}.editComment`,CONTEXTMENU_ITEMS_REMOVE_COMMENT=`${CM_ALIAS}.removeComment`,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT=`${CM_ALIAS}.readOnlyComment`,CONTEXTMENU_ITEMS_ALIGNMENT=`${CM_ALIAS}.align`,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT=`${CM_ALIAS}.align.left`,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER=`${CM_ALIAS}.align.center`,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT=`${CM_ALIAS}.align.right`,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY=`${CM_ALIAS}.align.justify`,CONTEXTMENU_ITEMS_ALIGNMENT_TOP=`${CM_ALIAS}.align.top`,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE=`${CM_ALIAS}.align.middle`,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM=`${CM_ALIAS}.align.bottom`,CONTEXTMENU_ITEMS_BORDERS=`${CM_ALIAS}.borders`,CONTEXTMENU_ITEMS_BORDERS_TOP=`${CM_ALIAS}.borders.top`,CONTEXTMENU_ITEMS_BORDERS_RIGHT=`${CM_ALIAS}.borders.right`,CONTEXTMENU_ITEMS_BORDERS_BOTTOM=`${CM_ALIAS}.borders.bottom`,CONTEXTMENU_ITEMS_BORDERS_LEFT=`${CM_ALIAS}.borders.left`,CONTEXTMENU_ITEMS_REMOVE_BORDERS=`${CM_ALIAS}.borders.remove`,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD=`${CM_ALIAS}.nestedHeaders.insertChildRow`,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD=`${CM_ALIAS}.nestedHeaders.detachFromParent`,CONTEXTMENU_ITEMS_HIDE_COLUMN=`${CM_ALIAS}.hideColumn`,CONTEXTMENU_ITEMS_SHOW_COLUMN=`${CM_ALIAS}.showColumn`,CONTEXTMENU_ITEMS_HIDE_ROW=`${CM_ALIAS}.hideRow`,CONTEXTMENU_ITEMS_SHOW_ROW=`${CM_ALIAS}.showRow`,FILTERS_NAMESPACE="Filters:",FILTERS_CONDITIONS_NAMESPACE=`${FILTERS_NAMESPACE}conditions`,FILTERS_CONDITIONS_NONE=`${FILTERS_CONDITIONS_NAMESPACE}.none`,FILTERS_CONDITIONS_EMPTY=`${FILTERS_CONDITIONS_NAMESPACE}.isEmpty`,FILTERS_CONDITIONS_NOT_EMPTY=`${FILTERS_CONDITIONS_NAMESPACE}.isNotEmpty`,FILTERS_CONDITIONS_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.isEqualTo`,FILTERS_CONDITIONS_NOT_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.isNotEqualTo`,FILTERS_CONDITIONS_BEGINS_WITH=`${FILTERS_CONDITIONS_NAMESPACE}.beginsWith`,FILTERS_CONDITIONS_ENDS_WITH=`${FILTERS_CONDITIONS_NAMESPACE}.endsWith`,FILTERS_CONDITIONS_CONTAINS=`${FILTERS_CONDITIONS_NAMESPACE}.contains`,FILTERS_CONDITIONS_NOT_CONTAIN=`${FILTERS_CONDITIONS_NAMESPACE}.doesNotContain`,FILTERS_CONDITIONS_BY_VALUE=`${FILTERS_CONDITIONS_NAMESPACE}.byValue`,FILTERS_CONDITIONS_GREATER_THAN=`${FILTERS_CONDITIONS_NAMESPACE}.greaterThan`,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.greaterThanOrEqualTo`,FILTERS_CONDITIONS_LESS_THAN=`${FILTERS_CONDITIONS_NAMESPACE}.lessThan`,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.lessThanOrEqualTo`,FILTERS_CONDITIONS_BETWEEN=`${FILTERS_CONDITIONS_NAMESPACE}.isBetween`,FILTERS_CONDITIONS_NOT_BETWEEN=`${FILTERS_CONDITIONS_NAMESPACE}.isNotBetween`,FILTERS_CONDITIONS_AFTER=`${FILTERS_CONDITIONS_NAMESPACE}.after`,FILTERS_CONDITIONS_BEFORE=`${FILTERS_CONDITIONS_NAMESPACE}.before`,FILTERS_CONDITIONS_TODAY=`${FILTERS_CONDITIONS_NAMESPACE}.today`,FILTERS_CONDITIONS_TOMORROW=`${FILTERS_CONDITIONS_NAMESPACE}.tomorrow`,FILTERS_CONDITIONS_YESTERDAY=`${FILTERS_CONDITIONS_NAMESPACE}.yesterday`,FILTERS_DIVS_FILTER_BY_CONDITION=`${FILTERS_NAMESPACE}labels.filterByCondition`,FILTERS_DIVS_FILTER_BY_VALUE=`${FILTERS_NAMESPACE}labels.filterByValue`,FILTERS_LABELS_CONJUNCTION=`${FILTERS_NAMESPACE}labels.conjunction`,FILTERS_LABELS_DISJUNCTION=`${FILTERS_NAMESPACE}labels.disjunction`,FILTERS_VALUES_BLANK_CELLS=`${FILTERS_NAMESPACE}values.blankCells`,FILTERS_BUTTONS_SELECT_ALL=`${FILTERS_NAMESPACE}buttons.selectAll`,FILTERS_BUTTONS_CLEAR=`${FILTERS_NAMESPACE}buttons.clear`,FILTERS_BUTTONS_OK=`${FILTERS_NAMESPACE}buttons.ok`,FILTERS_BUTTONS_CANCEL=`${FILTERS_NAMESPACE}buttons.cancel`,FILTERS_BUTTONS_PLACEHOLDER_SEARCH=`${FILTERS_NAMESPACE}buttons.placeholder.search`,FILTERS_BUTTONS_PLACEHOLDER_VALUE=`${FILTERS_NAMESPACE}buttons.placeholder.value`,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE=`${FILTERS_NAMESPACE}buttons.placeholder.secondValue`,CHECKBOX_RENDERER_NAMESPACE="CheckboxRenderer:",CHECKBOX_CHECKED=`${CHECKBOX_RENDERER_NAMESPACE}checked`,CHECKBOX_UNCHECKED=`${CHECKBOX_RENDERER_NAMESPACE}unchecked`,dictionary={languageCode:"en-US",[CONTEXTMENU_ITEMS_NO_ITEMS]:"No available options",[CONTEXTMENU_ITEMS_ROW_ABOVE]:"Insert row above",[CONTEXTMENU_ITEMS_ROW_BELOW]:"Insert row below",[CONTEXTMENU_ITEMS_INSERT_LEFT]:"Insert column left",[CONTEXTMENU_ITEMS_INSERT_RIGHT]:"Insert column right",[CONTEXTMENU_ITEMS_REMOVE_ROW]:["Remove row","Remove rows"],[CONTEXTMENU_ITEMS_REMOVE_COLUMN]:["Remove column","Remove columns"],[CONTEXTMENU_ITEMS_UNDO]:"Undo",[CONTEXTMENU_ITEMS_REDO]:"Redo",[CONTEXTMENU_ITEMS_READ_ONLY]:"Read only",[CONTEXTMENU_ITEMS_CLEAR_COLUMN]:"Clear column",[CONTEXTMENU_ITEMS_ALIGNMENT]:"Alignment",[CONTEXTMENU_ITEMS_ALIGNMENT_LEFT]:"Left",[CONTEXTMENU_ITEMS_ALIGNMENT_CENTER]:"Center",[CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT]:"Right",[CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY]:"Justify",[CONTEXTMENU_ITEMS_ALIGNMENT_TOP]:"Top",[CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE]:"Middle",[CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM]:"Bottom",[CONTEXTMENU_ITEMS_FREEZE_COLUMN]:"Freeze column",[CONTEXTMENU_ITEMS_UNFREEZE_COLUMN]:"Unfreeze column",[CONTEXTMENU_ITEMS_BORDERS]:"Borders",[CONTEXTMENU_ITEMS_BORDERS_TOP]:"Top",[CONTEXTMENU_ITEMS_BORDERS_RIGHT]:"Right",[CONTEXTMENU_ITEMS_BORDERS_BOTTOM]:"Bottom",[CONTEXTMENU_ITEMS_BORDERS_LEFT]:"Left",[CONTEXTMENU_ITEMS_REMOVE_BORDERS]:"Remove border(s)",[CONTEXTMENU_ITEMS_ADD_COMMENT]:"Add comment",[CONTEXTMENU_ITEMS_EDIT_COMMENT]:"Edit comment",[CONTEXTMENU_ITEMS_REMOVE_COMMENT]:"Delete comment",[CONTEXTMENU_ITEMS_READ_ONLY_COMMENT]:"Read-only comment",[CONTEXTMENU_ITEMS_MERGE_CELLS]:"Merge cells",[CONTEXTMENU_ITEMS_UNMERGE_CELLS]:"Unmerge cells",[CONTEXTMENU_ITEMS_COPY]:"Copy",[CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS]:["Copy with header","Copy with headers"],[CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS]:["Copy with group header","Copy with group headers"],[CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY]:["Copy header only","Copy headers only"],[CONTEXTMENU_ITEMS_CUT]:"Cut",[CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD]:"Insert child row",[CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD]:"Detach from parent",[CONTEXTMENU_ITEMS_HIDE_COLUMN]:["Hide column","Hide columns"],[CONTEXTMENU_ITEMS_SHOW_COLUMN]:["Show column","Show columns"],[CONTEXTMENU_ITEMS_HIDE_ROW]:["Hide row","Hide rows"],[CONTEXTMENU_ITEMS_SHOW_ROW]:["Show row","Show rows"],[FILTERS_CONDITIONS_NONE]:"None",[FILTERS_CONDITIONS_EMPTY]:"Is empty",[FILTERS_CONDITIONS_NOT_EMPTY]:"Is not empty",[FILTERS_CONDITIONS_EQUAL]:"Is equal to",[FILTERS_CONDITIONS_NOT_EQUAL]:"Is not equal to",[FILTERS_CONDITIONS_BEGINS_WITH]:"Begins with",[FILTERS_CONDITIONS_ENDS_WITH]:"Ends with",[FILTERS_CONDITIONS_CONTAINS]:"Contains",[FILTERS_CONDITIONS_NOT_CONTAIN]:"Does not contain",[FILTERS_CONDITIONS_GREATER_THAN]:"Greater than",[FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL]:"Greater than or equal to",[FILTERS_CONDITIONS_LESS_THAN]:"Less than",[FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL]:"Less than or equal to",[FILTERS_CONDITIONS_BETWEEN]:"Is between",[FILTERS_CONDITIONS_NOT_BETWEEN]:"Is not between",[FILTERS_CONDITIONS_AFTER]:"After",[FILTERS_CONDITIONS_BEFORE]:"Before",[FILTERS_CONDITIONS_TODAY]:"Today",[FILTERS_CONDITIONS_TOMORROW]:"Tomorrow",[FILTERS_CONDITIONS_YESTERDAY]:"Yesterday",[FILTERS_VALUES_BLANK_CELLS]:"Blank cells",[FILTERS_DIVS_FILTER_BY_CONDITION]:"Filter by condition",[FILTERS_DIVS_FILTER_BY_VALUE]:"Filter by value",[FILTERS_LABELS_CONJUNCTION]:"And",[FILTERS_LABELS_DISJUNCTION]:"Or",[FILTERS_BUTTONS_SELECT_ALL]:"Select all",[FILTERS_BUTTONS_CLEAR]:"Clear",[FILTERS_BUTTONS_OK]:"OK",[FILTERS_BUTTONS_CANCEL]:"Cancel",[FILTERS_BUTTONS_PLACEHOLDER_SEARCH]:"Search",[FILTERS_BUTTONS_PLACEHOLDER_VALUE]:"Value",[FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE]:"Second value",[CHECKBOX_CHECKED]:"Checked",[CHECKBOX_UNCHECKED]:"Unchecked"};var en_US_default=dictionary;const dictionaryKeys=constants_exports,DEFAULT_LANGUAGE_CODE=en_US_default.languageCode,{register:registerGloballyLanguageDictionary,getItem:getGlobalLanguageDictionary,hasItem:hasGlobalLanguageDictionary,getValues:getGlobalLanguagesDictionaries}=staticRegister("languagesDictionaries");registerLanguageDictionary(en_US_default);function registerLanguageDictionary(e,t){let i=e,r=t;return isObject$4(e)&&(r=e,i=r.languageCode),extendLanguageDictionary(i,r),registerGloballyLanguageDictionary(i,deepClone(r)),deepClone(r)}function extendLanguageDictionary(e,t){e!==DEFAULT_LANGUAGE_CODE&&extendNotExistingKeys(t,getGlobalLanguageDictionary(DEFAULT_LANGUAGE_CODE))}function getLanguageDictionary(e){return hasLanguageDictionary(e)?deepClone(getGlobalLanguageDictionary(e)):null}function hasLanguageDictionary(e){return hasGlobalLanguageDictionary(e)}function getLanguagesDictionaries(){return getGlobalLanguagesDictionaries()}function getTranslatedPhrase(e,t,i){const r=getLanguageDictionary(e);if(r===null)return null;const o=r[t];if(isUndefined$1(o))return null;const a=getFormattedPhrase(o,i);return Array.isArray(a)?a[0]:a}function getFormattedPhrase(e,t){let i=e;return arrayEach$1(getAll(),r=>{i=r(e,t)}),i}function getValidLanguageCode(e){let t=normalizeLanguageCode(e);return hasLanguageDictionary(t)||(t=DEFAULT_LANGUAGE_CODE,warnUserAboutLanguageRegistration(e)),t}var import_es_error_cause$113=__toESM(require_es_error_cause(),1);function _defineProperty$74(e,t,i){return(t=_toPropertyKey$75(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$75(e){var t=_toPrimitive$75(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$75(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var VisualSelection=class extends selection_default$2{constructor(e,t){super(e,null),_defineProperty$74(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:i}=e,r=this.getNearestNotHiddenCoords(t,1),o=this.getNearestNotHiddenCoords(i,-1);return r===null||o===null?null:((r.row>o.row||r.col>o.col)&&(r=t,o=i),this.settings.createCellRange(r,r,o))}getNearestNotHiddenCoords(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(r===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,i);return o===null?null:this.settings.createCellCoords(r,o)}getNearestNotHiddenIndex(e,t,i){return t<0?t:e.getNearestNotHiddenIndex(t,i)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.from.clone().normalize(),i=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let a=null;if((o===null||o.col===null||o.row===null)&&(a=this.getNearestNotHiddenCoords(t,i,r)),a!==null&&e.overlaps(a)){const c=e.highlight.clone();if(c.row>=0&&(c.row=a.row),c.col>=0&&(c.col=a.col),this.cellRange===null){const u=this.settings.visualToRenderableCoords(c);this.cellRange=this.settings.createCellRange(u)}e.setHighlight(c)}return this.settings.selectionType==="focus"&&o!==null&&a===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const i=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(t);return i.row===null||i.col===null||r.row===null||r.col===null?null:this.settings.createCellRange(i,i,r)}},visualSelection_default=VisualSelection;function createHighlight$8(e){let{activeHeaderClassName:t,...i}=e;return new visualSelection_default({className:t,...i,selectionType:ACTIVE_HEADER_TYPE})}function createHighlight$7(e){let{areaCornerVisible:t,...i}=e;return new visualSelection_default({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:t},...i,selectionType:AREA_TYPE})}function createHighlight$6(e){let{...t}=e;return new visualSelection_default({className:"highlight",...t,selectionType:AREA_TYPE})}function createHighlight$5(e){let{columnClassName:t,...i}=e;return new visualSelection_default({className:t,...i,selectionType:COLUMN_TYPE})}function createHighlight$4(e){let{cellCornerVisible:t,...i}=e;return new visualSelection_default({className:"current",headerAttributes:[A11Y_SELECTED()],border:{width:2,color:"#4b89ff",cornerVisible:t},...i,selectionType:FOCUS_TYPE})}function createHighlight$3(e){let{border:t,visualCellRange:i,...r}=e;return new visualSelection_default({...t,...r,selectionType:CUSTOM_SELECTION_TYPE},i)}function createHighlight$2(e){let{...t}=e;return new visualSelection_default({className:"fill",border:{width:1,color:"#ff0000"},...t,selectionType:FILL_TYPE})}function createHighlight$1(e){let{headerClassName:t,...i}=e;return new visualSelection_default({className:t,...i,selectionType:HEADER_TYPE})}function createHighlight(e){let{rowClassName:t,...i}=e;return new visualSelection_default({className:t,...i,selectionType:ROW_TYPE})}var import_es_error_cause$112=__toESM(require_es_error_cause(),1),import_es_array_push$84=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$42(e,t){_checkPrivateRedeclaration$57(e,t),t.add(e)}function _checkPrivateRedeclaration$57(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$73(e,t,i){return(t=_toPropertyKey$74(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$74(e){var t=_toPrimitive$74(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$74(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand$57(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _Highlight_brand=new WeakSet,Highlight=class{constructor(e){_classPrivateMethodInitSpec$42(this,_Highlight_brand),_defineProperty$73(this,"options",void 0),_defineProperty$73(this,"layerLevel",0),_defineProperty$73(this,"focus",void 0),_defineProperty$73(this,"fill",void 0),_defineProperty$73(this,"layeredAreas",new Map),_defineProperty$73(this,"areas",new Map),_defineProperty$73(this,"rowHeaders",new Map),_defineProperty$73(this,"columnHeaders",new Map),_defineProperty$73(this,"activeRowHeaders",new Map),_defineProperty$73(this,"activeColumnHeaders",new Map),_defineProperty$73(this,"activeCornerHeaders",new Map),_defineProperty$73(this,"rowHighlights",new Map),_defineProperty$73(this,"columnHighlights",new Map),_defineProperty$73(this,"customSelections",[]),this.options=e,this.focus=createHighlight$4(e),this.fill=createHighlight$2(e)}isEnabledFor(e,t){let i=e;e===FOCUS_TYPE&&(i="current");let r=this.options.disabledCellSelection(t.row,t.col);return typeof r=="string"&&(r=[r]),r===!1||Array.isArray(r)&&!r.includes(i)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return _assertClassBrand$57(_Highlight_brand,this,_createHighlight).call(this,this.layeredAreas,createHighlight$7)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return _assertClassBrand$57(_Highlight_brand,this,_createHighlight).call(this,this.areas,createHighlight$6)}getAreas(){return[...this.areas.values()]}createRowHeader(){return _assertClassBrand$57(_Highlight_brand,this,_createHighlight).call(this,this.rowHeaders,createHighlight$1)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return _assertClassBrand$57(_Highlight_brand,this,_createHighlight).call(this,this.columnHeaders,createHighlight$1)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return _assertClassBrand$57(_Highlight_brand,this,_createHighlight).call(this,this.activeRowHeaders,createHighlight$8)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return _assertClassBrand$57(_Highlight_brand,this,_createHighlight).call(this,this.activeColumnHeaders,createHighlight$8)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return _assertClassBrand$57(_Highlight_brand,this,_createHighlight).call(this,this.activeCornerHeaders,createHighlight$8)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return _assertClassBrand$57(_Highlight_brand,this,_createHighlight).call(this,this.rowHighlights,createHighlight)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return _assertClassBrand$57(_Highlight_brand,this,_createHighlight).call(this,this.columnHighlights,createHighlight$5)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(createHighlight$3({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),arrayEach$1(this.areas.values(),e=>void e.clear()),arrayEach$1(this.layeredAreas.values(),e=>void e.clear()),arrayEach$1(this.rowHeaders.values(),e=>void e.clear()),arrayEach$1(this.columnHeaders.values(),e=>void e.clear()),arrayEach$1(this.activeRowHeaders.values(),e=>void e.clear()),arrayEach$1(this.activeColumnHeaders.values(),e=>void e.clear()),arrayEach$1(this.activeCornerHeaders.values(),e=>void e.clear()),arrayEach$1(this.rowHighlights.values(),e=>void e.clear()),arrayEach$1(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}};function _createHighlight(e,t){const i=this.layerLevel;if(e.has(i))return e.get(i);const r=t({layerLevel:i,...this.options});return e.set(i,r),r}var highlight_default=Highlight,import_es_error_cause$111=__toESM(require_es_error_cause(),1),import_es_array_push$83=__toESM(require_es_array_push(),1);function _defineProperty$72(e,t,i){return(t=_toPropertyKey$73(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$73(e){var t=_toPrimitive$73(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$73(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SelectionRange=class{constructor(e){_defineProperty$72(this,"ranges",[]),_defineProperty$72(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(t=>t.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}},range_default=SelectionRange,import_es_error_cause$110=__toESM(require_es_error_cause(),1);function _classPrivateMethodInitSpec$41(e,t){_checkPrivateRedeclaration$56(e,t),t.add(e)}function _classPrivateFieldInitSpec$40(e,t,i){_checkPrivateRedeclaration$56(e,t),t.set(e,i)}function _checkPrivateRedeclaration$56(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$40(e,t){return e.get(_assertClassBrand$56(e,t))}function _classPrivateFieldSet$36(e,t,i){return e.set(_assertClassBrand$56(e,t),i),i}function _assertClassBrand$56(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _range=new WeakMap,_options=new WeakMap,_offset$1=new WeakMap,_Transformation_brand=new WeakSet,Transformation=class{constructor(e,t){_classPrivateMethodInitSpec$41(this,_Transformation_brand),_classPrivateFieldInitSpec$40(this,_range,void 0),_classPrivateFieldInitSpec$40(this,_options,void 0),_classPrivateFieldInitSpec$40(this,_offset$1,{x:0,y:0}),_classPrivateFieldSet$36(_range,this,e),_classPrivateFieldSet$36(_options,this,t)}transformStart(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=_classPrivateFieldGet$40(_options,this).createCellCoords(e,t);let o=_classPrivateFieldGet$40(_range,this).current().highlight;const a=_classPrivateFieldGet$40(_options,this).visualToRenderableCoords(o);let c=0,u=0;if(this.runLocalHooks("beforeTransformStart",r),a.row!==null&&a.col!==null){const{width:h,height:d}=_assertClassBrand$56(_Transformation_brand,this,_getTableSize).call(this),{row:f,col:m}=_assertClassBrand$56(_Transformation_brand,this,_visualToZeroBasedCoords).call(this,o),g=_classPrivateFieldGet$40(_options,this).fixedRowsBottom(),v=_classPrivateFieldGet$40(_options,this).minSpareRows(),_=_classPrivateFieldGet$40(_options,this).minSpareCols(),b=_classPrivateFieldGet$40(_options,this).autoWrapRow(),S=_classPrivateFieldGet$40(_options,this).autoWrapCol(),T=_classPrivateFieldGet$40(_options,this).createCellCoords(f+r.row,m+r.col);if(T.row>=d){const R=createObjectPropListener(i&&v>0&&g===0),O=T.col+1,P=_classPrivateFieldGet$40(_options,this).createCellCoords(T.row-d,O>=h?O-h:O);this.runLocalHooks("beforeColumnWrap",R,_assertClassBrand$56(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,P),O>=h),R.value?this.runLocalHooks("insertRowRequire",_classPrivateFieldGet$40(_options,this).countRenderableRows()):S&&T.assign(P)}else if(T.row<0){const R=createObjectPropListener(S),O=T.col-1,P=_classPrivateFieldGet$40(_options,this).createCellCoords(d+T.row,O<0?h+O:O);this.runLocalHooks("beforeColumnWrap",R,_assertClassBrand$56(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,P),O<0),S&&T.assign(P)}if(T.col>=h){const R=createObjectPropListener(i&&_>0),O=T.row+1,P=_classPrivateFieldGet$40(_options,this).createCellCoords(O>=d?O-d:O,T.col-h);this.runLocalHooks("beforeRowWrap",R,_assertClassBrand$56(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,P),O>=d),R.value?this.runLocalHooks("insertColRequire",_classPrivateFieldGet$40(_options,this).countRenderableColumns()):b&&T.assign(P)}else if(T.col<0){const R=createObjectPropListener(b),O=T.row-1,P=_classPrivateFieldGet$40(_options,this).createCellCoords(O<0?d+O:O,h+T.col);this.runLocalHooks("beforeRowWrap",R,_assertClassBrand$56(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,P),O<0),b&&T.assign(P)}const{rowDir:A,colDir:I}=_assertClassBrand$56(_Transformation_brand,this,_clampCoords).call(this,T);c=A,u=I,o=_assertClassBrand$56(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,T)}return this.runLocalHooks("afterTransformStart",o,c,u),o}transformEnd(e,t){const i=_classPrivateFieldGet$40(_options,this).createCellCoords(e,t),r=_classPrivateFieldGet$40(_range,this).current(),o=_classPrivateFieldGet$40(_options,this).visualToRenderableCoords(r.highlight),a=_assertClassBrand$56(_Transformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,r.to.row,r.from.row),c=_assertClassBrand$56(_Transformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,r.to.col,r.from.col),u=r.to.clone();let h=0,d=0;if(this.runLocalHooks("beforeTransformEnd",i),o.row!==null&&o.col!==null&&a!==null&&c!==null){const{row:f,col:m}=_assertClassBrand$56(_Transformation_brand,this,_visualToZeroBasedCoords).call(this,r.highlight),g=_classPrivateFieldGet$40(_options,this).createCellCoords(a+i.row,c+i.col),v=r.getTopStartCorner(),_=r.getTopEndCorner(),b=r.getBottomEndCorner();if(i.col<0&&c>=m&&g.col<m){const I=g.col-m;g.col=_assertClassBrand$56(_Transformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,v.col,_.col)+I}else if(i.col>0&&c<=m&&g.col>m){const I=_assertClassBrand$56(_Transformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,_.col,v.col),R=Math.max(g.col-I,1);g.col=I+R}if(i.row<0&&a>=f&&g.row<f){const I=g.row-f;g.row=_assertClassBrand$56(_Transformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,v.row,b.row)+I}else if(i.row>0&&a<=f&&g.row>f){const I=_assertClassBrand$56(_Transformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,b.row,v.row),R=Math.max(g.row-I,1);g.row=I+R}const{rowDir:S,colDir:T}=_assertClassBrand$56(_Transformation_brand,this,_clampCoords).call(this,g);h=S,d=T;const A=_assertClassBrand$56(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,g);i.row===0&&i.col!==0?u.col=A.col:i.row!==0&&i.col===0?u.row=A.row:(u.row=A.row,u.col=A.col)}return this.runLocalHooks("afterTransformEnd",u,h,d),u}setOffsetSize(e){let{x:t,y:i}=e;_classPrivateFieldSet$36(_offset$1,this,{x:t,y:i})}resetOffsetSize(){_classPrivateFieldSet$36(_offset$1,this,{x:0,y:0})}};function _clampCoords(e){const{width:t,height:i}=_assertClassBrand$56(_Transformation_brand,this,_getTableSize).call(this);let r=0,o=0;return e.row<0?(r=-1,e.row=0):e.row>0&&e.row>=i&&(r=1,e.row=i-1),e.col<0?(o=-1,e.col=0):e.col>0&&e.col>=t&&(o=1,e.col=t-1),{rowDir:r,colDir:o}}function _getTableSize(){return{width:_classPrivateFieldGet$40(_offset$1,this).x+_classPrivateFieldGet$40(_options,this).countRenderableColumns(),height:_classPrivateFieldGet$40(_offset$1,this).y+_classPrivateFieldGet$40(_options,this).countRenderableRows()}}function _findFirstNonHiddenZeroBasedRow(e,t){const i=_classPrivateFieldGet$40(_options,this).findFirstNonHiddenRenderableRow(e,t);return i===null?null:_classPrivateFieldGet$40(_offset$1,this).y+i}function _findFirstNonHiddenZeroBasedColumn(e,t){const i=_classPrivateFieldGet$40(_options,this).findFirstNonHiddenRenderableColumn(e,t);return i===null?null:_classPrivateFieldGet$40(_offset$1,this).x+i}function _visualToZeroBasedCoords(e){const{row:t,col:i}=_classPrivateFieldGet$40(_options,this).visualToRenderableCoords(e);if(t===null||i===null)throw new Error("Renderable coords are not visible.");return _classPrivateFieldGet$40(_options,this).createCellCoords(_classPrivateFieldGet$40(_offset$1,this).y+t,_classPrivateFieldGet$40(_offset$1,this).x+i)}function _zeroBasedToVisualCoords(e){const t=e.clone();return t.col=e.col-_classPrivateFieldGet$40(_offset$1,this).x,t.row=e.row-_classPrivateFieldGet$40(_offset$1,this).y,_classPrivateFieldGet$40(_options,this).renderableToVisualCoords(t)}mixin(Transformation,localHooks_default);var transformation_default=Transformation,import_es_error_cause$109=__toESM(require_es_error_cause(),1),import_es_array_push$82=__toESM(require_es_array_push(),1),import_es_set_difference_v2$19=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$19=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$19=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$19=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$19=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$19=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$19=__toESM(require_es_set_union_v2(),1);const SELECTION_TYPE_UNRECOGNIZED=0,SELECTION_TYPE_EMPTY=1,SELECTION_TYPE_ARRAY=2,SELECTION_TYPE_OBJECT=3,SELECTION_TYPES=[SELECTION_TYPE_OBJECT,SELECTION_TYPE_ARRAY],ARRAY_TYPE_PATTERN=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],rootCall=Symbol("root"),childCall=Symbol("child");function detectSelectionType(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rootCall;if(t!==rootCall&&t!==childCall)throw new Error("The second argument is used internally only and cannot be overwritten.");const i=Array.isArray(e),r=t===rootCall;let o=SELECTION_TYPE_UNRECOGNIZED;if(i){const a=e[0];e.length===0?o=SELECTION_TYPE_EMPTY:r&&a instanceof range_default$1?o=SELECTION_TYPE_OBJECT:r&&Array.isArray(a)?o=detectSelectionType(a,childCall):e.length>=2&&e.length<=4&&!e.some((u,h)=>!ARRAY_TYPE_PATTERN[h].includes(typeof u))&&(o=SELECTION_TYPE_ARRAY)}return o}function normalizeSelectionFactory(e){let{createCellCoords:t,createCellRange:i,keepDirection:r=!1,propToCol:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!SELECTION_TYPES.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(a){const c=e===SELECTION_TYPE_OBJECT;let u=c?a.from.row:a[0],h=c?a.from.col:a[1],d=c?a.to.row:a[2],f=c?a.to.col:a[3];if(typeof o=="function"&&(typeof h=="string"&&(h=o(h)),typeof f=="string"&&(f=o(f))),isUndefined$1(d)&&(d=u),isUndefined$1(f)&&(f=h),!r){const v=u,_=h,b=d,S=f;u=Math.min(v,b),h=Math.min(_,S),d=Math.max(v,b),f=Math.max(_,S)}const m=t(u,h),g=t(d,f);return i(m,m,g)}}function transformSelectionToColumnDistance(e){const t=detectSelectionType(e.getSelected());if(t===SELECTION_TYPE_UNRECOGNIZED||t===SELECTION_TYPE_EMPTY)return[];const i=normalizeSelectionFactory(t,{createCellCoords:e._createCellCoords.bind(e),createCellRange:e._createCellRange.bind(e)}),r=new Set;arrayEach$1(e.getSelected(),c=>{const{from:u,to:h}=i(c),d=Math.max(u.col,0),f=h.col-d+1;arrayEach$1(Array.from(new Array(f),(m,g)=>d+g),m=>{r.has(m)||r.add(m)})});const o=Array.from(r).sort((c,u)=>c-u);return arrayReduce(o,(c,u,h,d)=>(h!==0&&u===d[h-1]+1?c[c.length-1][1]+=1:c.push([u,1]),c),[])}function transformSelectionToRowDistance(e){const t=detectSelectionType(e.getSelected());if(t===SELECTION_TYPE_UNRECOGNIZED||t===SELECTION_TYPE_EMPTY)return[];const i=normalizeSelectionFactory(t,{createCellCoords:e._createCellCoords.bind(e),createCellRange:e._createCellRange.bind(e)}),r=new Set;arrayEach$1(e.getSelected(),c=>{const{from:u,to:h}=i(c),d=Math.max(u.row,0),f=h.row-d+1;arrayEach$1(Array.from(new Array(f),(m,g)=>d+g),m=>{r.has(m)||r.add(m)})});const o=Array.from(r).sort((c,u)=>c-u);return arrayReduce(o,(c,u,h,d)=>(h!==0&&u===d[h-1]+1?c[c.length-1][1]+=1:c.push([u,1]),c),[])}var import_es_error_cause$108=__toESM(require_es_error_cause(),1),import_es_array_push$81=__toESM(require_es_array_push(),1),import_es_set_difference_v2$18=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$18=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$18=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$18=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$18=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$18=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$18=__toESM(require_es_set_union_v2(),1);function _classPrivateFieldInitSpec$39(e,t,i){_checkPrivateRedeclaration$55(e,t),t.set(e,i)}function _checkPrivateRedeclaration$55(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$71(e,t,i){return(t=_toPropertyKey$72(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$72(e){var t=_toPrimitive$72(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$72(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet$39(e,t){return e.get(_assertClassBrand$55(e,t))}function _classPrivateFieldSet$35(e,t,i){return e.set(_assertClassBrand$55(e,t),i),i}function _assertClassBrand$55(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _transformation=new WeakMap,_focusTransformation=new WeakMap,_isFocusSelectionChanged=new WeakMap,_disableHeadersHighlight=new WeakMap,_selectionSource=new WeakMap,_expectedLayersCount=new WeakMap,Selection$2=class{constructor(e,t){var i=this;_defineProperty$71(this,"settings",void 0),_defineProperty$71(this,"tableProps",void 0),_defineProperty$71(this,"inProgress",!1),_defineProperty$71(this,"selectedRange",new range_default((r,o,a)=>this.tableProps.createCellRange(r,o,a))),_defineProperty$71(this,"highlight",void 0),_classPrivateFieldInitSpec$39(this,_transformation,void 0),_classPrivateFieldInitSpec$39(this,_focusTransformation,void 0),_defineProperty$71(this,"selectedByRowHeader",new Set),_defineProperty$71(this,"selectedByColumnHeader",new Set),_classPrivateFieldInitSpec$39(this,_isFocusSelectionChanged,!1),_classPrivateFieldInitSpec$39(this,_disableHeadersHighlight,!1),_classPrivateFieldInitSpec$39(this,_selectionSource,"unknown"),_classPrivateFieldInitSpec$39(this,_expectedLayersCount,-1),this.settings=e,this.tableProps=t,this.highlight=new highlight_default({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[A11Y_SELECTED()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(r,o)=>this.tableProps.isDisabledCellSelection(r,o),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),createCellCoords:(r,o)=>this.tableProps.createCellCoords(r,o),createCellRange:(r,o,a)=>this.tableProps.createCellRange(r,o,a)}),_classPrivateFieldSet$35(_transformation,this,new transformation_default(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(r,o)=>this.tableProps.createCellCoords(r,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),_classPrivateFieldSet$35(_focusTransformation,this,new transformation_default(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const r=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,r.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const r=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,r.getOuterBottomEndCorner().col)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(r,o)=>this.tableProps.createCellCoords(r,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),_classPrivateFieldGet$39(_transformation,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("beforeModifyTransformStart",...o)}),_classPrivateFieldGet$39(_transformation,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("afterModifyTransformStart",...o)}),_classPrivateFieldGet$39(_transformation,this).addLocalHook("beforeTransformEnd",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("beforeModifyTransformEnd",...o)}),_classPrivateFieldGet$39(_transformation,this).addLocalHook("afterTransformEnd",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("afterModifyTransformEnd",...o)}),_classPrivateFieldGet$39(_transformation,this).addLocalHook("insertRowRequire",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("insertRowRequire",...o)}),_classPrivateFieldGet$39(_transformation,this).addLocalHook("insertColRequire",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("insertColRequire",...o)}),_classPrivateFieldGet$39(_transformation,this).addLocalHook("beforeRowWrap",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("beforeRowWrap",...o)}),_classPrivateFieldGet$39(_transformation,this).addLocalHook("beforeColumnWrap",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("beforeColumnWrap",...o)}),_classPrivateFieldGet$39(_focusTransformation,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("beforeModifyTransformFocus",...o)}),_classPrivateFieldGet$39(_focusTransformation,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){_classPrivateFieldSet$35(_selectionSource,this,e)}markEndSource(){_classPrivateFieldSet$35(_selectionSource,this,"unknown")}getSelectionSource(){return _classPrivateFieldGet$39(_selectionSource,this)}setExpectedLayers(e){_classPrivateFieldSet$35(_expectedLayersCount,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,_classPrivateFieldSet$35(_expectedLayersCount,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",a=isUndefined$1(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,c=e.clone();_classPrivateFieldSet$35(_isFocusSelectionChanged,this,!1),this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,c),(!o||o&&!a&&isUndefined$1(t))&&this.selectedRange.clear(),this.selectedRange.add(c).current().setHighlight(r.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(e)}setRangeStartOnly(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,t,!0,i)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone(),i=this.tableProps.countRows(),r=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((i>0||r>0)&&(i===0&&t.col<0&&!o||r===0&&t.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const a=this.selectedRange.current();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{const u=a.getHorizontalDirection(),h=a.getVerticalDirection(),d=this.isMultiple();a.setTo(t),d&&(u!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),d&&(h!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}i>0&&r>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const c=_classPrivateFieldGet$39(_expectedLayersCount,this)===-1||this.selectedRange.size()===_classPrivateFieldGet$39(_expectedLayersCount,this);this.runLocalHooks("afterSetRangeEnd",e,c)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const i=this.tableProps.countRows(),r=this.tableProps.countCols();t<this.highlight.layerLevel&&(arrayEach$1(this.highlight.getAreas(),v=>void v.clear()),arrayEach$1(this.highlight.getLayeredAreas(),v=>void v.clear()),arrayEach$1(this.highlight.getRowHeaders(),v=>void v.clear()),arrayEach$1(this.highlight.getColumnHeaders(),v=>void v.clear()),arrayEach$1(this.highlight.getActiveRowHeaders(),v=>void v.clear()),arrayEach$1(this.highlight.getActiveColumnHeaders(),v=>void v.clear()),arrayEach$1(this.highlight.getActiveCornerHeaders(),v=>void v.clear()),arrayEach$1(this.highlight.getRowHighlights(),v=>void v.clear()),arrayEach$1(this.highlight.getColumnHighlights(),v=>void v.clear())),this.highlight.useLayerLevel(t);const o=this.highlight.createArea(),a=this.highlight.createLayeredArea(),c=this.highlight.createRowHeader(),u=this.highlight.createColumnHeader(),h=this.highlight.createActiveRowHeader(),d=this.highlight.createActiveColumnHeader(),f=this.highlight.createActiveCornerHeader(),m=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();if(o.clear(),a.clear(),c.clear(),u.clear(),h.clear(),d.clear(),f.clear(),m.clear(),g.clear(),this.highlight.isEnabledFor(AREA_TYPE,e.highlight)&&(this.isMultiple()||t>=1)&&(o.add(e.from).add(e.to).commit(),a.add(e.from).add(e.to).commit(),t===1)){const v=this.selectedRange.previous();this.highlight.useLayerLevel(t-1),this.highlight.createArea().add(v.from).commit().syncWith(v),this.highlight.createLayeredArea().add(v.from).commit().syncWith(v),this.highlight.useLayerLevel(t)}if(this.highlight.isEnabledFor(HEADER_TYPE,e.highlight)){if(!e.isSingleHeader()){const b=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),S=this.tableProps.createCellCoords(e.to.row,-1),T=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),A=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(c.add(b).commit(),u.add(T).commit(),m.add(b).commit(),g.add(T).commit()):(c.add(b).add(S).commit(),u.add(T).add(A).commit(),m.add(b).add(S).commit(),g.add(T).add(A).commit())}const v=!_classPrivateFieldGet$39(_disableHeadersHighlight,this)&&this.isEntireRowSelected()&&(r>0&&r===e.getWidth()||r===0&&this.isSelectedByRowHeader()),_=!_classPrivateFieldGet$39(_disableHeadersHighlight,this)&&this.isEntireColumnSelected()&&(i>0&&i===e.getHeight()||i===0&&this.isSelectedByColumnHeader());v&&h.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),_&&d.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),v&&_&&f.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const t=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),t.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(FOCUS_TYPE,t.highlight)&&i.add(t.highlight).commit().syncWith(t),this.inProgress||(_classPrivateFieldSet$35(_isFocusSelectionChanged,this,!0),this.runLocalHooks("afterSetFocus",t.highlight))}transformStart(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?_classPrivateFieldGet$39(_transformation,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):_classPrivateFieldGet$39(_transformation,this).resetOffsetSize(),this.setRangeStart(_classPrivateFieldGet$39(_transformation,this).transformStart(e,t,i))}transformEnd(e,t){this.settings.navigableHeaders?_classPrivateFieldGet$39(_transformation,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):_classPrivateFieldGet$39(_transformation,this).resetOffsetSize(),this.setRangeEnd(_classPrivateFieldGet$39(_transformation,this).transformEnd(e,t))}transformFocus(e,t){const i=this.selectedRange.current(),{row:r,col:o}=i.getOuterTopStartCorner(),a=this.tableProps.countRenderableColumnsInRange(0,o-1),c=this.tableProps.countRenderableRowsInRange(0,r-1);i.highlight.isHeader()?_classPrivateFieldGet$39(_focusTransformation,this).setOffsetSize({x:o<0?Math.abs(o):-a,y:r<0?Math.abs(r):-c}):_classPrivateFieldGet$39(_focusTransformation,this).setOffsetSize({x:o<0?0:-a,y:r<0?0:-c});const u=_classPrivateFieldGet$39(_focusTransformation,this).transformStart(e,t);this.setRangeFocus(u.normalize())}shiftRows(e,t){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||i.getOuterTopStartCorner().row>=e){const{from:r,to:o,highlight:a}=i,c=this.tableProps.countRows(),u=this.isSelectedByRowHeader(),h=this.isSelectedByColumnHeader(),d=h?-1:0,f=h?0:t;this.getSelectedRange().pop();const m=this.tableProps.createCellCoords(clamp$1(r.row+f,d,c-1),r.col),g=this.tableProps.createCellCoords(clamp$1(o.row+t,d,c-1),o.col);this.markSource("shift"),a.row>=e?this.setRangeStartOnly(m,!0,this.tableProps.createCellCoords(clamp$1(a.row+t,0,c-1),a.col)):this.setRangeStartOnly(m,!0),u&&this.selectedByRowHeader.add(this.getLayerLevel()),h&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}shiftColumns(e,t){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||i.getOuterTopStartCorner().col>=e){const{from:r,to:o,highlight:a}=i,c=this.tableProps.countCols(),u=this.isSelectedByRowHeader(),h=this.isSelectedByColumnHeader(),d=u?-1:0,f=u?0:t;this.getSelectedRange().pop();const m=this.tableProps.createCellCoords(r.row,clamp$1(r.col+f,d,c-1)),g=this.tableProps.createCellCoords(o.row,clamp$1(o.col+t,d,c-1));this.markSource("shift"),a.col>=e?this.setRangeStartOnly(m,!0,this.tableProps.createCellCoords(a.row,clamp$1(a.col+t,0,c-1))):this.setRangeStartOnly(m,!0),u&&this.selectedByRowHeader.add(this.getLayerLevel()),h&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=createObjectPropListener(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&_classPrivateFieldGet$39(_isFocusSelectionChanged,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=r=>{const{col:o}=r.getOuterTopStartCorner(),a=this.tableProps.countRowHeaders(),c=this.tableProps.countCols();return(a>0&&o<0||a===0)&&r.getWidth()===c};if(e===-1)return Array.from(this.selectedRange).some(r=>t(r));const i=this.selectedRange.peekByIndex(e);return i?t(i):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=r=>{const{row:o}=r.getOuterTopStartCorner(),a=this.tableProps.countColHeaders(),c=this.tableProps.countRows();return(a>0&&o<0||a===0)&&r.getHeight()===c};if(e===-1)return Array.from(this.selectedRange).some(r=>t(r));const i=this.selectedRange.peekByIndex(e);return i?t(i):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const t=this.tableProps.visualToRenderableCoords(e);return t.row!==null&&t.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),a=this.tableProps.countCols(),c=this.tableProps.countRowHeaders(),u=this.tableProps.countColHeaders(),h=i?-u:0,d=t?-c:0;if(h===0&&d===0&&(o===0||a===0))return;let f=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:m,disableHeadersHighlight:g}=r;_classPrivateFieldSet$35(_disableHeadersHighlight,this,g),m&&Number.isInteger(m?.row)&&Number.isInteger(m?.col)&&(f=this.tableProps.createCellCoords(clamp$1(m.row,h,o-1),clamp$1(m.col,d,a-1)));const v=this.tableProps.createCellCoords(h,d),_=this.tableProps.createCellCoords(o-1,a-1);this.clear(),this.setRangeStartOnly(v,void 0,f),d<0&&this.selectedByRowHeader.add(this.getLayerLevel()),h<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(_),this.finish(),_classPrivateFieldSet$35(_disableHeadersHighlight,this,!1)}selectCells(e){var t=this;const i=detectSelectionType(e);if(i===SELECTION_TYPE_EMPTY)return!1;if(i===SELECTION_TYPE_UNRECOGNIZED)throw new Error(toSingleLine`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const r=normalizeSelectionFactory(i,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:u=>this.tableProps.propToCol(u),keepDirection:!0}),o=this.settings.navigableHeaders,a={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},c=!e.some(u=>{const h=r(u),d=h.isValid(a);return!(d&&!h.containsHeaders()||d&&h.containsHeaders()&&h.isSingleHeader())});return c&&(this.clear(),this.setExpectedLayers(e.length),arrayEach$1(e,u=>{const{from:h,to:d}=r(u);this.setRangeStartOnly(h.clone(),!1),this.setRangeEnd(d.clone())}),this.finish()),c}selectColumns(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof t=="string"?this.tableProps.propToCol(t):t,a=this.tableProps.countRows(),c=this.tableProps.countCols(),u=this.tableProps.countColHeaders(),h=u===0?0:-u,d=this.tableProps.createCellCoords(h,r),f=this.tableProps.createCellCoords(a-1,o),m=this.tableProps.createCellRange(d,d,f).isValid({countRows:a,countCols:c,countRowHeaders:0,countColHeaders:u});if(m){let g=0,v=0;Number.isInteger(i?.row)&&Number.isInteger(i?.col)?(g=clamp$1(i.row,h,a-1),v=clamp$1(i.col,Math.min(r,o),Math.max(r,o))):(g=clamp$1(i,h,a-1),v=r);const _=this.tableProps.createCellCoords(g,v),b=u===0?0:clamp$1(_.row,h,-1),S=a-1,T=this.tableProps.createCellCoords(b,r),A=this.tableProps.createCellCoords(S,o);this.runLocalHooks("beforeSelectColumns",T,A,_),T.row=b,A.row=S,this.setRangeStartOnly(T,void 0,_),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(A),this.runLocalHooks("afterSelectColumns",T,A,_),this.finish()}return m}selectRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),c=a===0?0:-a,u=this.tableProps.createCellCoords(e,c),h=this.tableProps.createCellCoords(t,o-1),d=this.tableProps.createCellRange(u,u,h).isValid({countRows:r,countCols:o,countRowHeaders:a,countColHeaders:0});if(d){let f=0,m=0;Number.isInteger(i?.row)&&Number.isInteger(i?.col)?(f=clamp$1(i.row,Math.min(e,t),Math.max(e,t)),m=clamp$1(i.col,c,o-1)):(f=e,m=clamp$1(i,c,o-1));const g=this.tableProps.createCellCoords(f,m),v=a===0?0:clamp$1(g.col,c,-1),_=o-1,b=this.tableProps.createCellCoords(e,v),S=this.tableProps.createCellCoords(t,_);this.runLocalHooks("beforeSelectRows",b,S,g),b.col=v,S.col=_,this.setRangeStartOnly(b,void 0,g),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(S),this.runLocalHooks("afterSelectRows",b,S,g),this.finish()}return d}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),t=this.tableProps.countCols();if(e===0||t===0){this.deselect();return}const i=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:r,to:o,highlight:a}=i;this.clear(),a.assign({row:clamp$1(a.row,-1/0,e-1),col:clamp$1(a.col,-1/0,t-1)}),r.assign({row:clamp$1(r.row,-1/0,e-1),col:clamp$1(r.col,-1/0,t-1)}),o.assign({row:clamp$1(o.row,0,e-1),col:clamp$1(o.col,0,t-1)}),this.selectedRange.ranges.push(i),this.highlight.getFocus().add(a).commit().syncWith(i),this.applyAndCommit(i)}commit(){if(this.highlight.getCustomSelections().forEach(r=>{r.commit()}),!this.isSelected())return;const t=this.highlight.getFocus(),i=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(let r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);const o=this.highlight.createArea(),a=this.highlight.createLayeredArea(),c=this.highlight.createRowHeader(),u=this.highlight.createColumnHeader(),h=this.highlight.createActiveRowHeader(),d=this.highlight.createActiveColumnHeader(),f=this.highlight.createActiveCornerHeader(),m=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();o.commit(),a.commit(),c.commit(),u.commit(),h.commit(),d.commit(),f.commit(),m.commit(),g.commit()}this.highlight.useLayerLevel(i)}};mixin(Selection$2,localHooks_default);var selection_default$1=Selection$2;const regUniversalNewLine=/^(\r\n|\n\r|\r|\n)/,regNextCellNoQuotes=/^[^\t\r\n]+/,regNextEmptyCell=/^\t/;function parse$4(e){const t=[[""]];if(e.length===0)return t;let i=0,r=0,o;for(;e.length>0&&o!==e.length;)if(o=e.length,e.match(regNextEmptyCell))e=e.replace(regNextEmptyCell,""),i+=1,t[r][i]="";else if(e.match(regUniversalNewLine))e=e.replace(regUniversalNewLine,""),i=0,r+=1,t[r]=[""];else{let a="";if(e.startsWith('"')){let c=0,u=!0;for(;u;){const h=e.slice(0,1);h==='"'&&(c+=1),a+=h,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&c%2===0)&&(u=!1)}a=a.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,h=>new Array(Math.floor(h.length/2)).fill('"').join(""))}else{const c=e.match(regNextCellNoQuotes);a=c?c[0]:"",e=e.slice(a.length)}t[r][i]=a}return t}function stringify$2(e){let t,i,r,o,a="",c;for(t=0,i=e.length;t<i;t+=1){for(o=e[t].length,r=0;r<o;r+=1)r>0&&(a+="	"),c=e[t][r],typeof c=="string"?c.indexOf(`
`)>-1?a+=`"${c.replace(/"/g,'""')}"`:a+=c:c==null?a+="":a+=c;t!==i-1&&(a+=`
`)}return a}var import_es_error_cause$107=__toESM(require_es_error_cause(),1),import_es_array_push$80=__toESM(require_es_array_push(),1);function _defineProperty$70(e,t,i){return(t=_toPropertyKey$71(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$71(e){var t=_toPrimitive$71(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$71(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DataMap=class Jn{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(t,i,r){_defineProperty$70(this,"hot",void 0),_defineProperty$70(this,"metaManager",void 0),_defineProperty$70(this,"tableMeta",void 0),_defineProperty$70(this,"dataSource",void 0),_defineProperty$70(this,"duckSchema",void 0),_defineProperty$70(this,"colToPropCache",void 0),_defineProperty$70(this,"propToColCache",void 0),this.hot=t,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=i,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const t=this.getSchema();if(typeof t>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const i=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,i){let o=0,a=0,c=!1;if(typeof i=="function"){const u=deepObjectSize(t);o=u>0?u:this.countFirstRowKeys(),c=!0}else{const u=this.tableMeta.maxCols;o=Math.min(u,i.length)}for(r=0;r<o;r++){const u=c?i(r):i[r];if(isObject$4(u)){if(typeof u.data<"u"){const h=c?a:r;this.colToPropCache[h]=u.data,this.propToColCache.set(u.data,h)}a+=1}}}else this.recursiveDuckColumns(t)}countFirstRowKeys(){return countFirstRowKeys(this.dataSource)}recursiveDuckColumns(t,i,r){let o=i,a=r,c;return typeof o>"u"&&(o=0,a=""),typeof t=="object"&&!Array.isArray(t)&&objectEach(t,(u,h)=>{u===null?(c=a+h,this.colToPropCache.push(c),this.propToColCache.set(c,o),o+=1):o=this.recursiveDuckColumns(u,o,`${h}.`)}),o}colToProp(t){if(Number.isInteger(t)===!1)return t;const i=this.hot.toPhysicalColumn(t);return i===null?t:this.colToPropCache&&isDefined(this.colToPropCache[i])?this.colToPropCache[i]:i}propToCol(t){const i=this.propToColCache.get(t);if(isDefined(i))return this.hot.toVisualColumn(i);const r=this.hot.toVisualColumn(t);return r===null?t:r}getSchema(){const t=this.tableMeta.dataSchema;return t?typeof t=="function"?t():t:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?duckSchema(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(t){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:o="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const a=this.hot.countSourceRows();let c=a,u=0,h=t;if((typeof h!="number"||h>=a)&&(h=a),h<this.hot.countRows()&&(c=this.hot.toPhysicalRow(h)),this.hot.runHooks("beforeCreateRow",h,i,r)===!1||c===null)return{delta:0};const f=this.tableMeta.maxRows,m=this.getSchema().length,g=[];for(;u<i&&a+u<f;){let _=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?_=deepClone(this.getSchema()):(_=[],rangeEach(m-1,()=>_.push(null))):this.hot.dataType==="function"?_=this.tableMeta.dataSchema(h+u):(_={},deepExtend(_,this.getSchema())),g.push(_),u+=1}this.hot.rowIndexMapper.insertIndexes(h,u),o==="below"&&(c=Math.min(c+1,a)),this.spliceData(c,0,g);const v=this.hot.toVisualRow(c);return this.hot.countSourceRows()===g.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),u>0&&(t==null?this.metaManager.createRow(null,u):r!=="auto"&&this.metaManager.createRow(c,i)),this.hot.runHooks("afterCreateRow",v,u,r),this.hot.forceFullRender=!0,{delta:u,startPhysicalIndex:c}}createCol(t){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:o="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const a=this.dataSource,c=this.tableMeta.maxCols,u=this.hot.countSourceCols();let h=t;if((typeof h!="number"||h>=u)&&(h=u),this.hot.runHooks("beforeCreateCol",h,i,r)===!1)return{delta:0};let f=u;h<this.hot.countCols()&&(f=this.hot.toPhysicalColumn(h));const m=this.hot.countSourceRows();let g=this.hot.countCols(),v=0,_=f;o==="end"&&(_=Math.min(_+1,u));const b=_;for(;v<i&&g<c;){if(typeof h!="number"||h>=g)if(m>0)for(let T=0;T<m;T+=1)typeof a[T]>"u"&&(a[T]=[]),a[T].push(null);else a.push([null]);else for(let T=0;T<m;T++)a[T].splice(_,0,null);v+=1,_+=1,g+=1}this.hot.columnIndexMapper.insertIndexes(h,v),v>0&&(t==null?this.metaManager.createColumn(null,v):r!=="auto"&&this.metaManager.createColumn(b,i));const S=this.hot.toVisualColumn(b);return this.hot.runHooks("afterCreateCol",S,v,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:v,startPhysicalIndex:b}}removeRow(t){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(t)?t:-i;const a=this.visualRowsToPhysical(o,i),c=this.hot.countSourceRows();if(o=(c+o)%c,this.hot.runHooks("beforeRemoveRow",o,a.length,a,r)===!1)return!1;const h=a.length;if(this.filterData(o,h,a),o<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(a);const f=isDefined(this.tableMeta.columns)||isDefined(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&f===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return a.slice(0).sort((f,m)=>m-f).forEach(f=>{this.metaManager.removeRow(f,1)}),this.hot.runHooks("afterRemoveRow",o,h,a,r),this.hot.forceFullRender=!0,!0}removeCol(t){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let o=typeof t!="number"?-i:t;o=(this.hot.countCols()+o)%this.hot.countCols();const a=this.visualColumnsToPhysical(o,i),c=a.slice(0).sort((m,g)=>g-m);if(this.hot.runHooks("beforeRemoveCol",o,i,a,r)===!1)return!1;let h=!0;const d=c.length,f=this.dataSource;for(let m=0;m<d;m++)h&&a[0]!==a[m]-m&&(h=!1);if(h)for(let m=0,g=this.hot.countSourceRows();m<g;m++)f[m].splice(a[0],i),m===0&&this.metaManager.removeColumn(a[0],i);else for(let m=0,g=this.hot.countSourceRows();m<g;m++)for(let v=0;v<d;v++)f[m].splice(c[v],1),m===0&&this.metaManager.removeColumn(c[v],1);return o<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(a),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",o,i,a,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(t,i,r){const o=this.hot.getDataAtCol(t),a=o.slice(i,i+r),c=o.slice(i+r);for(var u=arguments.length,h=new Array(u>3?u-3:0),d=3;d<u;d++)h[d-3]=arguments[d];extendArray(h,c);let f=0;for(;f<r;)h.push(null),f+=1;return to2dArray(h),this.hot.populateFromArray(i,t,h,null,null,"spliceCol"),a}spliceRow(t,i,r){const o=this.hot.getSourceDataAtRow(t),a=o.slice(i,i+r),c=o.slice(i+r);for(var u=arguments.length,h=new Array(u>3?u-3:0),d=3;d<u;d++)h[d-3]=arguments[d];extendArray(h,c);let f=0;for(;f<r;)h.push(null),f+=1;return this.hot.populateFromArray(t,i,[h],null,null,"spliceRow"),a}spliceData(t,i,r){if(this.hot.runHooks("beforeDataSplice",t,i,r)!==!1){const a=[...this.dataSource.slice(0,t),...r,...this.dataSource.slice(t)];this.dataSource.length=0,a.forEach(c=>this.dataSource.push(c))}}filterData(t,i,r){let o=this.hot.runHooks("filterData",t,i,r);Array.isArray(o)===!1&&(o=this.dataSource.filter((a,c)=>r.indexOf(c)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}get(t,i){const r=this.hot.toPhysicalRow(t);let o=this.dataSource[r];const a=this.hot.runHooks("modifyRowData",r);o=isNaN(a)?a:o;const{dataDotNotation:c}=this.hot.getSettings();let u=null;if(o&&o.hasOwnProperty&&hasOwnProperty$15(o,i))u=o[i];else if(c&&typeof i=="string"&&i.indexOf(".")>-1){let h=o;if(!h)return null;const d=i.split(".");for(let f=0,m=d.length;f<m;f++)if(h=h[d[f]],typeof h>"u")return null;u=h}else typeof i=="function"&&(u=i(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const h=createObjectPropListener(u);this.hot.runHooks("modifyData",r,this.propToCol(i),h,"get"),h.isTouched()&&(u=h.value)}return u}getCopyable(t,i){return this.hot.getCellMeta(t,this.propToCol(i)).copyable?this.get(t,i):""}set(t,i,r){const o=this.hot.toPhysicalRow(t);let a=r,c=this.dataSource[o];const u=this.hot.runHooks("modifyRowData",o);if(c=isNaN(u)?u:c,this.hot.hasHook("modifyData")){const d=createObjectPropListener(a);this.hot.runHooks("modifyData",o,this.propToCol(i),d,"set"),d.isTouched()&&(a=d.value)}const{dataDotNotation:h}=this.hot.getSettings();if(c&&c.hasOwnProperty&&hasOwnProperty$15(c,i))c[i]=a;else if(h&&typeof i=="string"&&i.indexOf(".")>-1){let d=c,f=0,m;const g=i.split(".");for(f=0,m=g.length-1;f<m;f++)typeof d[g[f]]>"u"&&(d[g[f]]={}),d=d[g[f]];d[g[f]]=a}else typeof i=="function"?i(this.dataSource.slice(o,o+1)[0],a):c[i]=a}visualRowsToPhysical(t,i){const r=this.hot.countSourceRows(),o=[];let a=(r+t)%r,c=i,u;for(;a<r&&c;)u=this.hot.toPhysicalRow(a),o.push(u),c-=1,a+=1;return o}visualColumnsToPhysical(t,i){const r=this.hot.countCols(),o=[];let a=(r+t)%r,c=i;for(;a<r&&c;){const u=this.hot.toPhysicalColumn(a);o.push(u),c-=1,a+=1}return o}clear(){for(let t=0;t<this.hot.countSourceRows();t++)for(let i=0;i<this.hot.countCols();i++)this.set(t,this.colToProp(i),"")}getLength(){const t=this.tableMeta.maxRows;let i;t<0||t===0?i=0:i=t||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,i)}getAll(){const t={row:0,col:0},i={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return t.row-i.row===0&&!this.hot.countSourceRows()?[]:this.getRange(t,i,Jn.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(t,i,r){const o=[];let a,c,u;const h=this.tableMeta.maxRows,d=this.tableMeta.maxCols;if(h===0||d===0)return[];const f=r===Jn.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,m=Math.min(Math.max(h-1,0),Math.max(t.row,i.row)),g=Math.min(Math.max(d-1,0),Math.max(t.col,i.col));for(a=Math.min(t.row,i.row);a<=m;a++){u=[];const v=a>=0?this.hot.toPhysicalRow(a):a;for(c=Math.min(t.col,i.col);c<=g&&v!==null;c++)u.push(f.call(this,a,this.colToProp(c)));v!==null&&o.push(u)}return o}getText(t,i){return stringify$2(this.getRange(t,i,Jn.DESTINATION_RENDERER))}getCopyableText(t,i){return stringify$2(this.getRange(t,i,Jn.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}},dataMap_default=DataMap,import_es_error_cause$106=__toESM(require_es_error_cause(),1);const{register,getItem,hasItem,getNames,getValues}=staticRegister("cellTypes");function _getItem(e){if(!hasItem(e))throw Error(`You declared cell type "${e}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return getItem(e)}function _register(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);const{editor:i,renderer:r,validator:o}=t;i&&_register$3(e,i),r&&_register$2(e,r),o&&_register$1(e,o),register(e,t)}var import_es_error_cause$105=__toESM(require_es_error_cause(),1),import_es_set_difference_v2$17=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$17=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$17=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$17=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$17=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$17=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$17=__toESM(require_es_set_union_v2(),1);function canBeOverwritten(e,t){var i;return e==="CELL_TYPE"?!1:((i=t._automaticallyAssignedMetaProps)===null||i===void 0?void 0:i.has(e))||!hasOwnProperty$15(t,e)}function extendByMetaType(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const r=typeof t.type=="string"?_getItem(t.type):t.type;if(e._automaticallyAssignedMetaProps&&objectEach(t,(a,c)=>void e._automaticallyAssignedMetaProps.delete(c)),!isObject$4(r))return;i===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);const o={};objectEach(r,(a,c)=>{if(canBeOverwritten(c,i)){var u;o[c]=a,(u=e._automaticallyAssignedMetaProps)===null||u===void 0||u.add(c)}}),extend$2(e,o)}function columnFactory(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function i(){}inherit$1(i,e);for(let r=0;r<t.length;r++)i.prototype[t[r]]=void 0;return i}function isUnsignedNumber(e){return Number.isInteger(e)&&e>=0}function assert(e,t){if(!e())throw new Error(`Assertion failed: ${t}`)}function isNullish(e){return e==null}var metaSchema_default=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(e){let t,i,r;for(t=0,i=this.countRows();t<i;t++)if(r=this.getDataAtCell(t,e),isEmpty(r)===!1)return!1;return!0},isEmptyRow(e){let t,i,r,o;for(t=0,i=this.countCols();t<i;t++)if(r=this.getDataAtCell(e,t),isEmpty(r)===!1)return typeof r=="object"?(o=this.getCellMeta(e,t),isObjectEqual(this.getSchema()[o.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}),import_es_error_cause$104=__toESM(require_es_error_cause(),1);function _defineProperty$69(e,t,i){return(t=_toPropertyKey$70(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$70(e){var t=_toPrimitive$70(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$70(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function createTableMetaEmptyClass(){return class{}}var GlobalMeta=class{constructor(e){_defineProperty$69(this,"metaCtor",createTableMetaEmptyClass()),_defineProperty$69(this,"meta",void 0),this.meta=this.metaCtor.prototype,extend$2(this.meta,metaSchema_default()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;extend$2(this.meta,e),extendByMetaType(this.meta,{...e,type:(t=e.type)!==null&&t!==void 0?t:this.meta.type},e)}},import_es_error_cause$103=__toESM(require_es_error_cause(),1);function _defineProperty$68(e,t,i){return(t=_toPropertyKey$69(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$69(e){var t=_toPrimitive$69(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$69(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TableMeta=class{constructor(e){_defineProperty$68(this,"meta",void 0);const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){extend$2(this.meta,e),extendByMetaType(this.meta,e,e)}},import_es_error_cause$102=__toESM(require_es_error_cause(),1),import_es_array_push$79=__toESM(require_es_array_push(),1),import_es_set_difference_v2$16=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$16=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$16=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$16=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$16=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$16=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$16=__toESM(require_es_set_union_v2(),1);function _defineProperty$67(e,t,i){return(t=_toPropertyKey$68(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$68(e){var t=_toPrimitive$68(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$68(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LazyFactoryMap=class{constructor(e){_defineProperty$67(this,"valueFactory",void 0),_defineProperty$67(this,"data",[]),_defineProperty$67(this,"index",[]),_defineProperty$67(this,"holes",new Set),this.valueFactory=e}obtain(e){assert(()=>isUnsignedNumber(e),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let i;if(t>=0)i=this.data[t],i===void 0&&(i=this.valueFactory(e),this.data[t]=i);else if(i=this.valueFactory(e),this.holes.size>0){const r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=i,this.index[e]=r}else this.data.push(i),this.index[e]=this.data.length-1;return i}insert(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;assert(()=>isUnsignedNumber(e)||isNullish(e),"Expecting an unsigned number or null/undefined argument.");const i=[],r=this.data.length;for(let a=0;a<t;a++)i.push(r+a),this.data.push(void 0);const o=isNullish(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...i,...this.index.slice(o)]}remove(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;assert(()=>isUnsignedNumber(e)||isNullish(e),"Expecting an unsigned number or null/undefined argument.");const i=this.index.splice(isNullish(e)?this.index.length-t:e,t);for(let r=0;r<i.length;r++){const o=i[r];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return arrayFilter$1(this.data,(e,t)=>!this.holes.has(t))[Symbol.iterator]()}entries(){const e=[];for(let i=0;i<this.data.length;i++){const r=this._getKeyByStorageIndex(i);r!==-1&&e.push([r,this.data[i]])}let t=0;return{next:()=>{if(t<e.length){const i=e[t];return t+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}},import_es_error_cause$101=__toESM(require_es_error_cause(),1);function _defineProperty$66(e,t,i){return(t=_toPropertyKey$67(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$67(e){var t=_toPrimitive$67(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$67(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}const COLUMNS_PROPS_CONFLICTS=["data","width"];var ColumnMeta=class{constructor(e){_defineProperty$66(this,"globalMeta",void 0),_defineProperty$66(this,"metas",new LazyFactoryMap(()=>this._createMeta())),this.globalMeta=e,this.metas=new LazyFactoryMap(()=>this._createMeta())}updateMeta(e,t){const i=this.getMeta(e);extend$2(i,t),extendByMetaType(i,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return columnFactory(this.globalMeta.getMetaConstructor(),COLUMNS_PROPS_CONFLICTS).prototype}},import_es_error_cause$100=__toESM(require_es_error_cause(),1),import_es_array_push$78=__toESM(require_es_array_push(),1);function _defineProperty$65(e,t,i){return(t=_toPropertyKey$66(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$66(e){var t=_toPrimitive$66(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$66(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CellMeta=class{constructor(e){_defineProperty$65(this,"columnMeta",void 0),_defineProperty$65(this,"metas",new LazyFactoryMap(()=>this._createRow())),this.columnMeta=e}updateMeta(e,t,i){const r=this.getMeta(e,t);extend$2(r,i),extendByMetaType(r,i)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,t)}getMeta(e,t,i){const r=this.metas.obtain(e).obtain(t);return i===void 0?r:r[i]}setMeta(e,t,i,r){var o;const a=this.metas.obtain(e).obtain(t);(o=a._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(i),a[i]=r}removeMeta(e,t,i){const r=this.metas.obtain(e).obtain(t);delete r[i]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let i=0;i<t.length;i++)isDefined(t[i])&&e.push(...t[i].values());return e}getMetasAtRow(e){assert(()=>isUnsignedNumber(e),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new LazyFactoryMap(e=>this._createMeta(e))}_createMeta(e){const t=this.columnMeta.getMetaConstructor(e);return new t}},import_es_error_cause$99=__toESM(require_es_error_cause(),1),MetaManager=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new GlobalMeta(e),this.tableMeta=new TableMeta(this.globalMeta),this.columnMeta=new ColumnMeta(this.globalMeta),this.cellMeta=new CellMeta(this.columnMeta),i.forEach(r=>new r(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,i){let{visualRow:r,visualColumn:o}=i;const a=this.cellMeta.getMeta(e,t);return a.visualRow=r,a.visualCol=o,a.row=e,a.col=t,this.runLocalHooks("afterGetCellMeta",a),a}getCellMetaKeyValue(e,t,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,i)}setCellMeta(e,t,i,r){this.cellMeta.setMeta(e,t,i,r)}updateCellMeta(e,t,i){this.cellMeta.updateMeta(e,t,i)}removeCellMeta(e,t,i){this.cellMeta.removeMeta(e,t,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}};mixin(MetaManager,localHooks_default);var import_es_error_cause$98=__toESM(require_es_error_cause(),1),import_es_array_push$77=__toESM(require_es_array_push(),1);function replaceData(e,t,i,r){const{hotInstance:o,dataMap:a,dataSource:c,internalSource:u,source:h,metaManager:d,firstRun:f}=r,m=toUpperCaseFirst(u),g=o.getSettings();Array.isArray(g.dataSchema)?o.dataType="array":isFunction$2(g.dataSchema)?o.dataType="function":o.dataType="object",a&&a.destroy(),e=o.runHooks(`before${m}`,e,f,h);const v=new dataMap_default(o,e,d);if(t(v),typeof e=="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){const _=v.getSchema();e=[];let b,S=0,T=0;for(S=0,T=g.startRows;S<T;S++)if((o.dataType==="object"||o.dataType==="function")&&g.dataSchema)b=deepClone(_),e.push(b);else if(o.dataType==="array")b=deepClone(_[0]),e.push(b);else{b=[];for(let A=0,I=g.startCols;A<I;A++)b.push(null);e.push(b)}}else throw new Error(`${u} only accepts array of objects or array of arrays (${typeof e} given)`);Array.isArray(e[0])&&(o.dataType="array"),g.data=e,v.dataSource=e,c.data=e,c.dataType=o.dataType,c.colToProp=v.colToProp.bind(v),c.propToCol=v.propToCol.bind(v),c.countCachedColumns=v.countCachedColumns.bind(v),i(v),o.runHooks(`after${m}`,e,f,h),f||(o.runHooks("afterChange",null,u),o.render()),o.getSettings().ariaTags&&setAttribute(o.rootElement,[A11Y_ROWCOUNT(-1),A11Y_COLCOUNT(o.countCols()+(o.view?o.countRowHeaders():0))])}var import_es_error_cause$97=__toESM(require_es_error_cause(),1),import_es_set_difference_v2$15=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$15=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$15=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$15=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$15=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$15=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$15=__toESM(require_es_set_union_v2(),1);function _defineProperty$64(e,t,i){return(t=_toPropertyKey$65(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$65(e){var t=_toPrimitive$65(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$65(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DynamicCellMetaMod=class{constructor(e){_defineProperty$64(this,"metaManager",void 0),_defineProperty$64(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),pluginHooks_default.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;const{row:i,col:r}=e;if((t=this.metaSyncMemo.get(i))!==null&&t!==void 0&&t.has(r))return;const{visualRow:o,visualCol:a}=e,c=this.metaManager.hot,u=c.colToProp(a);e.prop=u,c.runHooks("beforeGetCellMeta",o,a,e);const h=hasOwnProperty$15(e,"type")?e.type:null;let d=isFunction$2(e.cells)?e.cells(i,r,u):null;if(h)if(d){var f;d.type=(f=d.type)!==null&&f!==void 0?f:h}else d={type:h};d&&this.metaManager.updateCellMeta(i,r,d),c.runHooks("afterGetCellMeta",o,a,e),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(r)}},import_es_error_cause$96=__toESM(require_es_error_cause(),1),import_es_array_push$76=__toESM(require_es_array_push(),1),import_es_set_difference_v2$14=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$14=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$14=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$14=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$14=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$14=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$14=__toESM(require_es_set_union_v2(),1);function _classPrivateFieldInitSpec$38(e,t,i){_checkPrivateRedeclaration$54(e,t),t.set(e,i)}function _checkPrivateRedeclaration$54(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$63(e,t,i){return(t=_toPropertyKey$64(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$64(e){var t=_toPrimitive$64(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$64(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet$38(e,t){return e.get(_assertClassBrand$54(e,t))}function _assertClassBrand$54(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _initOnlyCallback=new WeakMap,ExtendMetaPropertiesMod=class{constructor(e){_defineProperty$63(this,"metaManager",void 0),_defineProperty$63(this,"usageTracker",new Set),_defineProperty$63(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&t==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),_classPrivateFieldInitSpec$38(this,_initOnlyCallback,(t,i,r)=>{if(!r)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{const{initOnly:i,target:r,onChange:o}=e,a=typeof r=="string",c=a?r:t,u=`_${c}`;this.metaManager.globalMeta.meta[u]=this.metaManager.globalMeta.meta[c],o?(this.installPropWatcher(t,u,o),a&&this.installPropWatcher(r,u,o)):i&&(this.installPropWatcher(t,u,_classPrivateFieldGet$38(_initOnlyCallback,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(t))})}installPropWatcher(e,t,i){const r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(o){const a=!r.usageTracker.has(e);r.usageTracker.add(e),i.call(r,e,o,a),this[t]=o},enumerable:!0,configurable:!0})}};const GRID_GROUP="gridDefault",EDITOR_EDIT_GROUP="editorManager.handlingEditor",command$40={name:"editorCloseAndSave",callback(e){e._getEditorManager().closeEditorAndSaveChanges()}};var import_es_array_push$75=__toESM(require_es_array_push(),1);const MIXIN_NAME="hooksRefRegisterer",hooksRefRegisterer={_hooksStorage:Object.create(null),addHook(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey(e){arrayEach$1(this._hooksStorage[e]||[],t=>{this.hot.removeHook(e,t)})},clearHooks(){objectEach(this._hooksStorage,(e,t)=>this.removeHooksByKey(t)),this._hooksStorage={}}};defineGetter(hooksRefRegisterer,"MIXIN_NAME",MIXIN_NAME,{writable:!1,enumerable:!1});var hooksRefRegisterer_default=hooksRefRegisterer,import_es_error_cause$95=__toESM(require_es_error_cause(),1);function _defineProperty$62(e,t,i){return(t=_toPropertyKey$63(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$63(e){var t=_toPrimitive$63(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$63(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}const EDITOR_TYPE$10="base",EDITOR_STATE=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});var BaseEditor=class{static get EDITOR_TYPE(){return EDITOR_TYPE$10}constructor(e){_defineProperty$62(this,"hot",void 0),_defineProperty$62(this,"state",EDITOR_STATE.VIRGIN),_defineProperty$62(this,"_opened",!1),_defineProperty$62(this,"_fullEditMode",!1),_defineProperty$62(this,"_closeCallback",null),_defineProperty$62(this,"TD",null),_defineProperty$62(this,"row",null),_defineProperty$62(this,"col",null),_defineProperty$62(this,"prop",null),_defineProperty$62(this,"originalValue",null),_defineProperty$62(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,i,r,o,a){this.TD=r,this.row=e,this.col=t,this.prop=i,this.originalValue=o,this.cellProperties=a,this.state=this.isOpened()?this.state:EDITOR_STATE.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let i,r,o,a;if(t){const u=this.hot.getSelectedLast();i=Math.max(Math.min(u[0],u[2]),0),r=Math.max(Math.min(u[1],u[3]),0),o=Math.max(u[0],u[2]),a=Math.max(u[1],u[3])}else[i,r,o,a]=[this.row,this.col,null,null];const c=this.hot.runHooks("modifyGetCellCoords",i,r);Array.isArray(c)&&([i,r]=c),this.hot.populateFromArray(i,r,e,o,a,"edit")}beginEditing(e,t){if(this.state!==EDITOR_STATE.VIRGIN)return;const i=this.hot,r=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=i.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(i.view.scrollViewport(i._createCellCoords(r,o)),this.state=EDITOR_STATE.EDITING,this.isInFullEditMode()){const a=typeof e=="string"?e:stringify$3(this.originalValue);this.setValue(a)}this.open(t),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,t,i){let r;if(i){const o=this._closeCallback;this._closeCallback=a=>{o&&o(a),i(a),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===EDITOR_STATE.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===EDITOR_STATE.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?r=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:r=[[o]],this.state=EDITOR_STATE.WAITING,this.saveValue(r,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",a=>{this.state=EDITOR_STATE.FINISHED,this.discardEditor(a)}):(this.state=EDITOR_STATE.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=EDITOR_STATE.FINISHED,this.discardEditor()}discardEditor(e){this.state===EDITOR_STATE.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=EDITOR_STATE.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=EDITOR_STATE.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===EDITOR_STATE.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:i,wtViewport:r}=this.hot.view._wt,o=this.hot.rootWindow,a=offset$2(t),c=outerWidth(t),u=offset$2(this.hot.rootElement),h=outerWidth(this.hot.rootElement),d=i.topOverlay.holder,f=i.inlineStartOverlay.holder,m=d!==o?d.scrollTop:0,g=f!==o?f.scrollLeft:0,v=o.innerWidth-u.left-h,{wtTable:_}=(e=i.getParentOverlay(t))!==null&&e!==void 0?e:this.hot.view._wt,b=_.name,S=["master","inline_start"].includes(b)?m:0,T=["master","top","bottom"].includes(b)?g:0,A=a.top===u.top?0:1;let I=a.top-u.top-A-S,R=0;this.hot.isRtl()?R=o.innerWidth-a.left-c-v-1+T:R=a.left-u.left-1-T,["top","top_inline_start_corner"].includes(b)&&(I+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(R+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));const O=this.hot.hasColHeaders(),P=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),L=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),U=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(O&&P<=0||P===U)&&(I+=1),L<=0&&(R+=1);const $=r.rowsRenderCalculator.startPosition,Z=r.columnsRenderCalculator.startPosition,ie=Math.abs(i.inlineStartOverlay.getScrollPosition()),ue=i.topOverlay.getScrollPosition(),_e=getScrollbarWidth(this.hot.rootDocument);let Ee=t.offsetTop;if(["inline_start","master"].includes(b)&&(Ee+=$-ue),["bottom","bottom_inline_start_corner"].includes(b)){const{wtViewport:ye,wtTable:we}=i.bottomOverlay.clone;Ee+=ye.getWorkspaceHeight()-we.getHeight()-_e}let pe=t.offsetLeft;this.hot.isRtl()?(pe>=0?pe=_.getWidth()-t.offsetLeft:pe=Math.abs(pe),pe+=Z-ie-c):["top","master","bottom"].includes(b)&&(pe+=Z-ie);const me=getComputedStyle$3(this.TD,this.hot.rootWindow),Se=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Le=parseInt(me[Se],10)>0?0:1,xe=parseInt(me.borderTopWidth,10)>0?0:1,E=outerWidth(t)+Le,k=outerHeight(t)+xe,D=hasVerticalScrollbar(d)?_e:0,q=hasHorizontalScrollbar(f)?_e:0,B=this.hot.view.maximumVisibleElementWidth(pe)-D+Le,se=Math.max(this.hot.view.maximumVisibleElementHeight(Ee)-q+xe,23);return{top:I,start:R,height:k,maxHeight:se,width:E,maxWidth:B}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?t="top-inline-start-corner":t="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?t="bottom-inline-start-corner":t="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}};mixin(BaseEditor,hooksRefRegisterer_default);const command$39={name:"editorCloseAndSaveByArrowKeys",callback(e,t,i){const r=e._getEditorManager(),o=r.getActiveEditor();o.isInFullEditMode()&&o.state===EDITOR_STATE.EDITING||(r.closeEditorAndSaveChanges(),e.getSelected()&&(i.includes("arrowdown")?e.selection.transformStart(1,0):i.includes("arrowup")?e.selection.transformStart(-1,0):i.includes("arrowleft")?e.selection.transformStart(0,-1*e.getDirectionFactor()):i.includes("arrowright")&&e.selection.transformStart(0,e.getDirectionFactor())),t.preventDefault())}},command$38={name:"editorCloseAndSaveByEnter",callback(e,t){const i=e._getEditorManager();i.closeEditorAndSaveChanges(t.ctrlKey||t.metaKey),i.moveSelectionAfterEnter(t)}},command$37={name:"editorCloseWithoutSaving",callback(e){const t=e._getEditorManager();t.closeEditorAndRestoreOriginalValue(e.getShortcutManager().isCtrlPressed()),t.activeEditor.focus()}},command$36={name:"editorFastOpen",callback(e,t){const{highlight:i}=e.getSelectedRangeLast();i.isHeader()||e._getEditorManager().openEditor(null,t,!0)}},command$35={name:"editorOpen",callback(e,t,i){const r=e._getEditorManager(),o=e.getSelectedRangeLast(),{highlight:a}=o;if(e.selection.isMultiple()&&!o.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0){const c=e.getSettings(),u=typeof c.enterMoves=="function"?c.enterMoves(t):c.enterMoves;i.includes("shift")?e.selection.transformFocus(-u.row,-u.col):e.selection.transformFocus(u.row,u.col);return}a.isHeader()||(e.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(t):r.openEditor(null,t,!0):r.moveSelectionAfterEnter(t),stopImmediatePropagation(t))}};function getAllCommands$2(){return[command$40,command$39,command$38,command$37,command$36,command$35]}const command$34={name:"extendCellsSelectionDown",callback(e){const{highlight:t}=e.getSelectedRangeLast();!e.selection.isSelectedByColumnHeader()&&!e.selection.isSelectedByCorner()&&(t.isCell()||t.isHeader()&&e.selection.isSelectedByRowHeader())&&e.selection.transformEnd(1,0)}},command$33={name:"extendCellsSelectionDownByViewportHeight",callback(e){const{to:t}=e.getSelectedRangeLast(),i=Math.min(t.row+e.countVisibleRows(),e.countRows()-1),r=e.rowIndexMapper.getNearestNotHiddenIndex(i,-1);if(r!==null){const o=e._createCellCoords(r,t.col),a=t.row-e.view.getFirstFullyVisibleRow(),c=Math.min(o.row-a,e.countRows()-1);e.selection.setRangeEnd(o),e.scrollViewportTo({row:c,verticalSnap:"top",horizontalSnap:"start"})}}},command$32={name:"extendCellsSelectionLeft",callback(e){const{highlight:t}=e.getSelectedRangeLast();!e.selection.isSelectedByRowHeader()&&!e.selection.isSelectedByCorner()&&(t.isCell()||t.isHeader()&&e.selection.isSelectedByColumnHeader())&&e.selection.transformEnd(0,-1*e.getDirectionFactor())}},command$31={name:"extendCellsSelectionRight",callback(e){const{highlight:t}=e.getSelectedRangeLast();!e.selection.isSelectedByRowHeader()&&!e.selection.isSelectedByCorner()&&(t.isCell()||t.isHeader()&&e.selection.isSelectedByColumnHeader())&&e.selection.transformEnd(0,e.getDirectionFactor())}},command$30={name:"extendCellsSelectionToColumns",callback(e){const{highlight:t,from:i,to:r}=e.getSelectedRangeLast();e.selection.isSelectedByRowHeader()?e.selection.selectAll(!0,!0):e.selectColumns(i.col,r.col,t)}},command$29={name:"extendCellsSelectionToMostBottom",callback(e){const{selection:t,rowIndexMapper:i}=e,{highlight:r,from:o,to:a}=e.getSelectedRangeLast(),c=r.isHeader()&&e.selection.isSelectedByRowHeader();if(r.isCell()||c){const u=i.getNearestNotHiddenIndex(e.countRows()-1,-1),h=o.clone();h.row=r.row,t.setRangeStart(h,void 0,!1,r.clone()),c&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(u,a.col))}}},command$28={name:"extendCellsSelectionToMostInlineEnd",callback(e){const{selection:t,columnIndexMapper:i}=e,{highlight:r,from:o,to:a}=e.getSelectedRangeLast();if(!e.selection.isSelectedByRowHeader()&&!e.selection.isSelectedByCorner()&&r.isCell()){const c=i.getNearestNotHiddenIndex(e.countCols()-1,-1),u=o.clone();u.col=r.col,t.setRangeStart(u,void 0,!1,r.clone()),t.setRangeEnd(e._createCellCoords(a.row,c))}}},command$27={name:"extendCellsSelectionToMostInlineStart",callback(e){const{selection:t,columnIndexMapper:i}=e,{highlight:r,from:o,to:a}=e.getSelectedRangeLast();if(!e.selection.isSelectedByRowHeader()&&!e.selection.isSelectedByCorner()&&r.isCell()){const c=parseInt(e.getSettings().fixedColumnsStart,10),u=i.getNearestNotHiddenIndex(c,1),h=o.clone();h.col=r.col,t.setRangeStart(h,void 0,!1,r.clone()),t.setRangeEnd(e._createCellCoords(a.row,u))}}},command$26={name:"extendCellsSelectionToMostLeft",callback(e){const{selection:t,columnIndexMapper:i}=e,{highlight:r,from:o,to:a}=e.getSelectedRangeLast(),c=r.isHeader()&&e.selection.isSelectedByColumnHeader();if(r.isCell()||c){const u=i.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]),h=o.clone();h.col=r.col,t.setRangeStart(h,void 0,!1,r.clone()),c&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(a.row,u))}}},command$25={name:"extendCellsSelectionToMostRight",callback(e){const{selection:t,columnIndexMapper:i}=e,{highlight:r,from:o,to:a}=e.getSelectedRangeLast(),c=r.isHeader()&&e.selection.isSelectedByColumnHeader();if(r.isCell()||c){const u=i.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]),h=o.clone();h.col=r.col,t.setRangeStart(h,void 0,!1,r.clone()),c&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(a.row,u))}}},command$24={name:"extendCellsSelectionToMostTop",callback(e){const{selection:t,rowIndexMapper:i}=e,{highlight:r,from:o,to:a}=e.getSelectedRangeLast(),c=r.isHeader()&&e.selection.isSelectedByRowHeader();if(r.isCell()||c){const u=i.getNearestNotHiddenIndex(0,1),h=o.clone();h.row=r.row,t.setRangeStart(h,void 0,!1,r.clone()),c&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(u,a.col))}}},command$23={name:"extendCellsSelectionToRows",callback(e){const{highlight:t,from:i,to:r}=e.getSelectedRangeLast();e.selection.isSelectedByColumnHeader()?e.selection.selectAll(!0,!0):e.selectRows(i.row,r.row,t)}},command$22={name:"extendCellsSelectionUp",callback(e){const{highlight:t}=e.getSelectedRangeLast();!e.selection.isSelectedByColumnHeader()&&!e.selection.isSelectedByCorner()&&(t.isCell()||t.isHeader()&&e.selection.isSelectedByRowHeader())&&e.selection.transformEnd(-1,0)}},command$21={name:"extendCellsSelectionUpByViewportHeight",callback(e){const{to:t}=e.getSelectedRangeLast(),i=Math.max(t.row-e.countVisibleRows(),0),r=e.rowIndexMapper.getNearestNotHiddenIndex(i,1);if(r!==null){const o=e._createCellCoords(r,t.col),a=t.row-e.view.getFirstFullyVisibleRow(),c=Math.max(o.row-a,0);e.selection.setRangeEnd(o),e.scrollViewportTo({row:c,verticalSnap:"top",horizontalSnap:"start"})}}};function getAllCommands$1(){return[command$34,command$33,command$32,command$31,command$30,command$29,command$28,command$27,command$26,command$25,command$24,command$23,command$22,command$21]}const command$20={name:"moveCellSelectionDown",callback(e){let{selection:t}=e;t.transformStart(1,0)}},command$19={name:"moveCellSelectionDownByViewportHeight",callback(e){const{navigableHeaders:t}=e.getSettings(),i=t?e.countColHeaders():0,{row:r}=e.getSelectedRangeLast().highlight;let o=e.countVisibleRows()+i;r===e.countRows()-1?o=1:r+o>e.countRows()&&(o=e.countRows()-r-1),e.selection.transformStart(o,0),e.getSelectedRangeLast().highlight.row<0&&e.scrollViewportTo({row:0})}},command$18={name:"moveCellSelectionInlineEnd",callback(e,t){const i=e.getSettings(),r=e.getSelectedRangeLast(),o=typeof i.tabMoves=="function"?i.tabMoves(t):i.tabMoves;e.selection.isMultiple()&&!r.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0?e.selection.transformFocus(-o.row,-o.col):e.selection.transformStart(-o.row,-o.col)}},command$17={name:"moveCellSelectionInlineStart",callback(e,t){const i=e.getSettings(),r=e.getSelectedRangeLast(),o=typeof i.tabMoves=="function"?i.tabMoves(t):i.tabMoves;e.selection.isMultiple()&&!r.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0?e.selection.transformFocus(o.row,o.col):e.selection.transformStart(o.row,o.col)}},command$16={name:"moveCellSelectionLeft",callback(e){e.selection.transformStart(0,-1*e.getDirectionFactor())}},command$15={name:"moveCellSelectionRight",callback(e){e.selection.transformStart(0,e.getDirectionFactor())}},command$14={name:"moveCellSelectionToMostBottom",callback(e){const{col:t}=e.getSelectedRangeLast().highlight;let i=e.rowIndexMapper.getNearestNotHiddenIndex(e.countRows()-1,-1);i===null&&(i=-1),e.selection.setRangeStart(e._createCellCoords(i,t))}},command$13={name:"moveCellSelectionToMostBottomInlineEnd",callback(e){const{selection:t,rowIndexMapper:i,columnIndexMapper:r}=e,o=parseInt(e.getSettings().fixedRowsBottom,10),a=i.getNearestNotHiddenIndex(e.countRows()-o-1,-1),c=r.getNearestNotHiddenIndex(e.countCols()-1,-1);t.setRangeStart(e._createCellCoords(a,c))}},command$12={name:"moveCellSelectionToMostInlineEnd",callback(e){const{selection:t,columnIndexMapper:i}=e;t.setRangeStart(e._createCellCoords(e.getSelectedRangeLast().highlight.row,i.getNearestNotHiddenIndex(e.countCols()-1,-1)))}},command$11={name:"moveCellSelectionToMostInlineStart",callback(e){const{selection:t,columnIndexMapper:i}=e,r=parseInt(e.getSettings().fixedColumnsStart,10),o=e.getSelectedRangeLast().highlight.row,a=i.getNearestNotHiddenIndex(r,1);t.setRangeStart(e._createCellCoords(o,a))}},command$10={name:"moveCellSelectionToMostLeft",callback(e){const{selection:t,columnIndexMapper:i}=e,r=e.getSelectedRangeLast().highlight.row;let o=i.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]);o===null&&(o=e.isRtl()?-1:-e.countRowHeaders()),t.setRangeStart(e._createCellCoords(r,o))}},command$9={name:"moveCellSelectionToMostRight",callback(e){const{selection:t,columnIndexMapper:i}=e,{row:r}=e.getSelectedRangeLast().highlight;let o=i.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]);o===null&&(o=e.isRtl()?-e.countRowHeaders():-1),t.setRangeStart(e._createCellCoords(r,o))}},command$8={name:"moveCellSelectionToMostTop",callback(e){const{col:t}=e.getSelectedRangeLast().highlight;let i=e.rowIndexMapper.getNearestNotHiddenIndex(0,1);i===null&&(i=-e.countColHeaders()),e.selection.setRangeStart(e._createCellCoords(i,t))}},command$7={name:"moveCellSelectionToMostTopInlineStart",callback(e){const{selection:t,rowIndexMapper:i,columnIndexMapper:r}=e,o=parseInt(e.getSettings().fixedRowsTop,10),a=parseInt(e.getSettings().fixedColumnsStart,10),c=i.getNearestNotHiddenIndex(o,1),u=r.getNearestNotHiddenIndex(a,1);t.setRangeStart(e._createCellCoords(c,u))}},command$6={name:"moveCellSelectionUp",callback(e){let{selection:t}=e;t.transformStart(-1,0)}},command$5={name:"moveCellSelectionUpByViewportHight",callback(e){const{navigableHeaders:t}=e.getSettings(),i=t?e.countColHeaders():0,{row:r}=e.getSelectedRangeLast().highlight;let o=-(e.countVisibleRows()+i);r===-i?o=-1:r+o<i&&(o=-(r+i)),e.selection.transformStart(o,0),e.getSelectedRangeLast().highlight.row<0&&e.scrollViewportTo({row:0})}};function getAllCommands(){return[command$20,command$19,command$18,command$17,command$16,command$15,command$14,command$13,command$12,command$11,command$10,command$9,command$8,command$7,command$6,command$5]}const command$4={name:"emptySelectedCells",callback(e){e.emptySelectedCells(),e._getEditorManager().prepareEditor()}},command$3={name:"scrollToFocusedCell",callback(e){const{highlight:t}=e.getSelectedRangeLast(),i=e.view.getFirstFullyVisibleRow()-1,r=e.view.getFirstFullyVisibleColumn()-1,o=e.view.getLastFullyVisibleRow()+1,a=e.view.getLastFullyVisibleColumn()+1,c=e._createCellCoords(i,r),u=e._createCellCoords(o,a);if(!e._createCellRange(c,c,u).includes(t)&&(t.row>=0||t.col>=0)){const d={};if(t.col>=0){const f=Math.floor(e.countVisibleCols()/2);d.col=Math.max(t.col-f,0)}if(t.row>=0){const f=Math.floor(e.countVisibleRows()/2);d.row=Math.max(t.row-f,0)}e.scrollViewportTo({...d,verticalSnap:"top",horizontalSnap:"start"})}}},command$2={name:"selectAllCells",callback(e){e.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},command$1={name:"selectAllCellsAndHeaders",callback(e){e.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},command={name:"populateSelectedCellsData",callback(e){const t=e.getSelectedRange(),{row:i,col:r}=t[t.length-1].highlight.normalize(),o=e.getDataAtCell(i,r),a=new Map;for(let c=0;c<t.length;c++)t[c].forAll((u,h)=>{if(u>=0&&h>=0&&(u!==i||h!==r)){const{readOnly:d}=e.getCellMeta(u,h);d||a.set(`${u}x${h}`,[u,h,o])}});e.setDataAtCell(Array.from(a.values()))}},allCommands=[...getAllCommands$2(),...getAllCommands$1(),...getAllCommands(),command$4,command$3,command$2,command$1,command];function createKeyboardShortcutCommandsPool(e){const t={};return allCommands.forEach(i=>{let{name:r,callback:o}=i;t[r]=function(){for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return o(e,...c)}}),t}function shortcutsEditorContext(e){const t=e.getShortcutManager().addContext("editor"),i=createKeyboardShortcutCommandsPool(e),r={group:EDITOR_EDIT_GROUP};t.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(o,a)=>i.editorCloseAndSaveByEnter(o,a)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(o,a)=>i.editorCloseAndSaveByEnter(o,a)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:(o,a)=>i.editorCloseAndSave(o,a)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(o,a)=>i.editorCloseAndSaveByArrowKeys(o,a)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>i.editorCloseWithoutSaving()}],r)}function shortcutsGridContext(e){const t=e.getShortcutManager().addContext("grid"),i=createKeyboardShortcutCommandsPool(e),r={runOnlyIf:()=>{const{navigableHeaders:o}=e.getSettings();return isDefined(e.getSelected())&&(o||!o&&e.countRenderedRows()>0&&e.countRenderedCols()>0)},group:GRID_GROUP};t.addShortcuts([{keys:[["F2"]],callback:o=>i.editorFastOpen(o)},{keys:[["Enter"],["Enter","Shift"]],callback:(o,a)=>i.editorOpen(o,a)},{keys:[["Backspace"],["Delete"]],callback:()=>i.emptySelectedCells()}],{group:EDITOR_EDIT_GROUP,runOnlyIf:()=>isDefined(e.getSelected())}),t.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>i.selectAllCells(),runOnlyIf:()=>{var o;return!((o=e.getSelectedRangeLast())!==null&&o!==void 0&&o.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var o;return(o=e.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>i.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>i.populateSelectedCellsData(),runOnlyIf:()=>{var o,a;return!((o=e.getSelectedRangeLast())!==null&&o!==void 0&&o.highlight.isHeader())&&((a=e.getSelectedRangeLast())===null||a===void 0?void 0:a.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>i.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>i.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>i.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>i.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>i.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>i.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>i.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>i.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>i.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>i.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>i.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>i.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>i.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>i.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>i.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:o=>i.moveCellSelectionInlineStart(o)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:o=>i.moveCellSelectionInlineEnd(o)},{keys:[["Control/Meta","Backspace"]],callback:()=>i.scrollToFocusedCell()}],r)}function registerAllShortcutContexts(e){[shortcutsGridContext,shortcutsEditorContext].forEach(t=>t(e))}function installFocusDetector(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=e.rootElement,r=createInputElement(e),o=createInputElement(e);return r.addEventListener("focus",()=>t?.onFocusFromTop()),o.addEventListener("focus",()=>t?.onFocusFromBottom()),i.firstChild.before(r),i.lastChild.after(o),{activate(){e._registerTimeout(()=>{r.tabIndex=0,o.tabIndex=0},10)},deactivate(){e._registerTimeout(()=>{r.tabIndex=-1,o.tabIndex=-1},10)}}}function createInputElement(e){const i=e.rootDocument.createElement("input");return i.type="text",i.classList.add("htFocusCatcher"),e.getSettings().ariaTags&&setAttribute(i,[A11Y_PRESENTATION(),A11Y_HIDDEN()]),i}function installFocusCatcher(e){const t=normalizeCoordsIfNeeded(e);let i;const{activate:r,deactivate:o}=installFocusDetector(e,{onFocusFromTop(){var m;const g=(m=t(i))!==null&&m!==void 0?m:getMostTopStartPosition(e);g&&(e.runHooks("modifyFocusOnTabNavigation","from_above",g),e.selectCell(g.row,g.col)),e.listen()},onFocusFromBottom(){var m;const g=(m=t(i))!==null&&m!==void 0?m:getMostBottomEndPosition(e);g&&(e.runHooks("modifyFocusOnTabNavigation","from_below",g),e.selectCell(g.row,g.col)),e.listen()}}),a={wrapped:!1,flipped:!1};let c=!0,u=!1,h=!1;e.addHook("afterListen",()=>o()),e.addHook("afterUnlisten",()=>r()),e.addHook("afterSelection",(m,g,v,_,b)=>{if(u&&(a.wrapped&&a.flipped||h)&&(h=!1,b.value=!0),c){var S;i=(S=e.getSelectedRangeLast())===null||S===void 0?void 0:S.highlight}}),e.addHook("beforeRowWrap",(m,g,v)=>{a.wrapped=!0,a.flipped=v});function d(){a.wrapped=!1,a.flipped=!1,e.deselectCell(),e.unlisten()}const f={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:GRID_GROUP,group:"focusCatcher"};e.getShortcutManager().getContext("grid").addShortcuts([{...f,callback:()=>{const{tabNavigation:m}=e.getSettings();u=!0,e.getSelectedRangeLast()&&!m&&(c=!1),m||(h=!0)},position:"before"},{...f,callback:m=>{const{tabNavigation:g,autoWrapRow:v}=e.getSettings();if(u=!1,c=!0,!g||!e.selection.isSelected()||v&&a.wrapped&&a.flipped||!v&&a.wrapped)return v&&a.wrapped&&a.flipped&&(i=m.shiftKey?getMostTopStartPosition(e):getMostBottomEndPosition(e)),d(),!1;m.preventDefault()},position:"after"}])}function getMostTopStartPosition(e){const{rowIndexMapper:t,columnIndexMapper:i}=e,{navigableHeaders:r}=e.getSettings();let o=r&&e.countColHeaders()>0?-e.countColHeaders():0,a=r&&e.countRowHeaders()>0?-e.countRowHeaders():0;return o===0&&(o=t.getVisualFromRenderableIndex(o)),a===0&&(a=i.getVisualFromRenderableIndex(a)),o===null||a===null?null:e._createCellCoords(o,a)}function getMostBottomEndPosition(e){var t,i;const{rowIndexMapper:r,columnIndexMapper:o}=e,{navigableHeaders:a}=e.getSettings();let c=r.getRenderableIndexesLength()-1,u=o.getRenderableIndexesLength()-1;if(c<0){if(!a||e.countColHeaders()===0)return null;c=-1}if(u<0){if(!a||e.countColHeaders()===0)return null;u=-1}return e._createCellCoords((t=r.getVisualFromRenderableIndex(c))!==null&&t!==void 0?t:c,(i=o.getVisualFromRenderableIndex(u))!==null&&i!==void 0?i:u)}function normalizeCoordsIfNeeded(e){return t=>{if(!t)return null;const i=getMostTopStartPosition(e),r=getMostBottomEndPosition(e);return t.col<i.col&&(t.col=i.col),t.col>r.col&&(t.col=r.col),t.row<i.row&&(t.row=i.row),t.row>r.row&&(t.row=r.row),t}}function columnHeaderScrollStrategy(e){return t=>{let{col:i}=t;e.scrollViewportTo({col:i})}}function cornerHeaderScrollStrategy(){return()=>{}}function focusScrollStrategy(e){return t=>{e.scrollViewportTo(t.toObject())}}function multipleScrollStrategy(e){return t=>{e.scrollViewportTo(t.toObject())}}function noncontiguousScrollStrategy(e){return t=>{e.scrollViewportTo(t.toObject())}}function rowHeaderScrollStrategy(e){return t=>{let{row:i}=t;e.scrollViewportTo({row:i})}}function singleScrollStrategy(e){return t=>{const i=e.selection.getSelectionSource(),{row:r,col:o}=t;if(r<0&&o>=0)e.scrollViewportTo({col:o});else if(o<0&&r>=0)e.scrollViewportTo({row:r});else{if(i==="mouse"&&(o===e.view.getLastPartiallyVisibleColumn()||r===e.view.getLastPartiallyVisibleRow()))return;e.scrollViewportTo({row:r,col:o})}}}function createViewportScroller(e){const{selection:t}=e;let i=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){i=!0},scrollTo(o){var a;if(i||r){i=!1;return}let c;t.isFocusSelectionChanged()?c=focusScrollStrategy(e):t.isSelectedByCorner()?c=cornerHeaderScrollStrategy(e):t.isSelectedByRowHeader()?c=rowHeaderScrollStrategy(e):t.isSelectedByColumnHeader()?c=columnHeaderScrollStrategy(e):t.getSelectedRange().size()===1&&t.isMultiple()?c=multipleScrollStrategy(e):t.getSelectedRange().size()===1&&!t.isMultiple()?c=singleScrollStrategy(e):t.getSelectedRange().size()>1&&(c=noncontiguousScrollStrategy(e)),(a=c)===null||a===void 0||a(o)}}}const mappings=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),normalizeKeys=e=>e.map(t=>{const i=t.toLowerCase();return mappings.has(i)?mappings.get(i):i}).sort().join("+"),getKeysList=e=>e.split("+"),specialCharactersSet=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),normalizeEventKey=e=>{let{which:t,key:i}=e;if(specialCharactersSet.has(t))return specialCharactersSet.get(t);const r=String.fromCharCode(t).toLowerCase();return/^[a-z0-9]$/.test(r)?r:i.toLowerCase()};var import_es_error_cause$94=__toESM(require_es_error_cause(),1),import_es_array_push$74=__toESM(require_es_array_push(),1);const __kindOf=Symbol("shortcut-context");function isContextObject(e){return isObject$4(e)&&e.__kindOf===__kindOf}const createContext=e=>{const t=createUniqueMap({errorIdExists:h=>`The "${h}" shortcut is already registered in the "${e}" context.`}),i=function(){let{keys:h,callback:d,group:f,runOnlyIf:m=()=>!0,captureCtrl:g=!1,preventDefault:v=!0,stopPropagation:_=!1,relativeToGroup:b,position:S,forwardToContext:T}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(isUndefined$1(f))throw new Error("You need to define the shortcut's group.");if(isFunction$2(d)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(h)===!1)throw new Error(toSingleLine`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const A={callback:d,group:f,runOnlyIf:m,captureCtrl:g,preventDefault:v,stopPropagation:_};isDefined(b)&&(A.relativeToGroup=b,A.position=S),isContextObject(T)&&(A.forwardToContext=T),h.forEach(I=>{const R=normalizeKeys(I);if(t.hasItem(R)){const P=t.getItem(R);let L=P.findIndex(V=>V.group===b);L!==-1?S==="before"?L-=1:L+=1:L=P.length,P.splice(L,0,A)}else t.addItem(R,[A])})},r=function(h){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};h.forEach(f=>{objectEach(d,(m,g)=>{Object.prototype.hasOwnProperty.call(f,g)===!1&&(f[g]=d[g])}),i(f)})},o=h=>{const d=normalizeKeys(h);t.removeItem(d)};return{__kindOf,addShortcut:i,addShortcuts:r,getShortcuts:h=>{const d=normalizeKeys(h),f=t.getItem(d);return isDefined(f)?f.slice():[]},hasShortcut:h=>{const d=normalizeKeys(h);return t.hasItem(d)},removeShortcutsByKeys:o,removeShortcutsByGroup:h=>{t.getItems().forEach(f=>{let[m,g]=f;const v=g.filter(_=>_.group!==h);v.length===0?o(getKeysList(m)):(g.length=0,g.push(...v))})}}};var import_es_set_difference_v2$13=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$13=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$13=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$13=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$13=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$13=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$13=__toESM(require_es_set_union_v2(),1);function createKeysObserver(){const e=new Set;return{press(t){e.add(t)},release(t){e.delete(t)},releaseAll(){e.clear()},isPressed(t){return e.has(t)}}}var import_es_array_push$73=__toESM(require_es_array_push(),1);const MODIFIER_KEYS=["meta","alt","shift","control"],modifierKeysObserver=createKeysObserver(),modKeyListeners=[];let instanceCounter=0;function useRecorder(e,t,i,r,o){const a=v=>MODIFIER_KEYS.includes(v),c=function(v){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const b=[];return v.altKey&&b.push("alt"),_&&(v.ctrlKey||v.metaKey)?b.push("control/meta"):(v.ctrlKey&&b.push("control"),v.metaKey&&b.push("meta")),v.shiftKey&&b.push("shift"),b},u=v=>{if(t(v)===!1)return;const _=i(v);if(v.keyCode===229||_===!1||isImmediatePropagationStopped(v))return;const b=normalizeEventKey(v);let S=[];a(b)||(S=c(v));const T=[b].concat(S);!o(v,T)&&(isMacOS()&&S.includes("meta")||!isMacOS()&&S.includes("control"))&&o(v,[b].concat(c(v,!0))),r(v)},h=v=>{if(v.key){const _=normalizeEventKey(v);a(_)&&modifierKeysObserver.press(_)}},d=v=>{if(v.key){const _=normalizeEventKey(v);a(_)&&modifierKeysObserver.release(_)}},f=()=>{modifierKeysObserver.releaseAll()};return{mount:()=>{let v=e;for(instanceCounter+=1;v;)instanceCounter===1&&(v.document.documentElement.addEventListener("keydown",h),modKeyListeners.push({event:"keydown",listener:h}),v.document.documentElement.addEventListener("keyup",d),modKeyListeners.push({event:"keyup",listener:d})),v.document.documentElement.addEventListener("keydown",u),v.document.documentElement.addEventListener("blur",f),v=getParentWindow(v)},unmount:()=>{let v=e;for(instanceCounter-=1;v;){if(instanceCounter===0){for(let _=0;_<modKeyListeners.length;_++){const{event:b,listener:S}=modKeyListeners[_];v.document.documentElement.removeEventListener(b,S)}modKeyListeners.length=0}v.document.documentElement.removeEventListener("keydown",u),v.document.documentElement.removeEventListener("blur",f),v=getParentWindow(v)}},isPressed:v=>modifierKeysObserver.isPressed(v),releasePressedKeys:()=>modifierKeysObserver.releaseAll()}}var import_es_error_cause$93=__toESM(require_es_error_cause(),1);const createShortcutManager=e=>{let{ownerWindow:t,handleEvent:i,beforeKeyDown:r,afterKeyDown:o}=e;const a=createUniqueMap({errorIdExists:_=>`The "${_}" context name is already registered.`});let c="grid";const u=_=>{const b=createContext(_);return a.addItem(_,b),b},h=()=>c,d=_=>a.getItem(_),f=_=>{if(!a.hasItem(_))throw new Error(toSingleLine`You've tried to activate the "${_}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);c=_};let m=!1;const g=function(_,b){let S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:h();const T=isContextObject(S)?S:d(S);let A=!1;if(!T.hasShortcut(b))return A;const I=T.getShortcuts(b);for(let R=0;R<I.length;R++){const{callback:O,runOnlyIf:P,preventDefault:L,stopPropagation:V,captureCtrl:U,forwardToContext:$}=I[R];if(P(_)===!0){if(m=U,A=O(_,b)===!1,m=!1,L&&_.preventDefault(),V&&(stopImmediatePropagation(_),_.stopPropagation()),A)break;$&&g(_,b,$)}}return A},v=useRecorder(t,i,r,o,g);return v.mount(),{addContext:u,getActiveContextName:h,getContext:d,setActiveContextName:f,isCtrlPressed:()=>!m&&(v.isPressed("control")||v.isPressed("meta")),releasePressedKeys:()=>v.releasePressedKeys(),destroy:()=>v.unmount()}};var import_es_error_cause$92=__toESM(require_es_error_cause(),1),import_es_array_push$72=__toESM(require_es_array_push(),1),import_es_set_difference_v2$12=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$12=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$12=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$12=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$12=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$12=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$12=__toESM(require_es_set_union_v2(),1),import_web_immediate=__toESM(require_web_immediate(),1);let activeGuid=null;const foreignHotInstances=new Map;function Core(e,t){var i,r=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this;const c=new eventManager_default(a);let u,h,d,f,m,g,v=!0;hasValidParameter(o)&&registerAsRootInstance(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const _=(i=t?.layoutDirection)!==null&&i!==void 0?i:"inherit",b=["rtl","ltr"].includes(_)?_:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",b),this.isRtl=function(){return b==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},t.language=getValidLanguageCode(t.language);const S=new MetaManager(a,t,[DynamicCellMetaMod,ExtendMetaPropertiesMod]),T=S.getTableMeta(),A=S.getGlobalMeta(),I=createUniqueMap();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),isRootInstance(this)&&_injectProductInfo(t.licenseKey,e),this.guid=`ht_${randomString()}`,foreignHotInstances.set(this.guid,this),this.columnIndexMapper=new IndexMapper,this.rowIndexMapper=new IndexMapper,this.columnIndexMapper.addLocalHook("indexesSequenceChange",E=>{a.runHooks("afterColumnSequenceChange",E)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",E=>{a.runHooks("afterRowSequenceChange",E)}),h=new dataSource_default(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const R=E=>{const{row:k,col:D}=E;return a._createCellCoords(k>=0?a.rowIndexMapper.getRenderableFromVisualIndex(k):k,D>=0?a.columnIndexMapper.getRenderableFromVisualIndex(D):D)},O=E=>{const{row:k,col:D}=E;return a._createCellCoords(k>=0?a.rowIndexMapper.getVisualFromRenderableIndex(k):k,D>=0?a.columnIndexMapper.getVisualFromRenderableIndex(D):D)},P=(E,k)=>{const D=k>E?1:-1,q=Math.min(E,k),B=Math.max(E,k),se=a.rowIndexMapper.getNearestNotHiddenIndex(E,D);return se===null||D===1&&se>B||D===-1&&se<q?null:se>=0?a.rowIndexMapper.getRenderableFromVisualIndex(se):se},L=(E,k)=>{const D=k>E?1:-1,q=Math.min(E,k),B=Math.max(E,k),se=a.columnIndexMapper.getNearestNotHiddenIndex(E,D);return se===null||D===1&&se>B||D===-1&&se<q?null:se>=0?a.columnIndexMapper.getRenderableFromVisualIndex(se):se};let V=new selection_default$1(T,{rowIndexMapper:a.rowIndexMapper,columnIndexMapper:a.columnIndexMapper,countCols:()=>a.countCols(),countRows:()=>a.countRows(),propToCol:E=>u.propToCol(E),isEditorOpened:()=>a.getActiveEditor()?a.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>a.getShortcutManager(),createCellCoords:(E,k)=>a._createCellCoords(E,k),createCellRange:(E,k,D)=>a._createCellRange(E,k,D),visualToRenderableCoords:R,renderableToVisualCoords:O,findFirstNonHiddenRenderableRow:P,findFirstNonHiddenRenderableColumn:L,isDisabledCellSelection:(E,k)=>E<0||k<0?a.getSettings().disableVisualSelection:a.getCellMeta(E,k).disableVisualSelection});this.selection=V;const U=E=>{let{hiddenIndexesChanged:k}=E;k&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",U),this.rowIndexMapper.addLocalHook("cacheUpdated",U),this.selection.addLocalHook("afterSetRangeEnd",(E,k)=>{const D=createObjectPropListener(!1),q=this.selection.getSelectedRange(),{from:B,to:se}=q.current(),ye=q.size()-1;this.runHooks("afterSelection",B.row,B.col,se.row,se.col,D,ye),this.runHooks("afterSelectionByProp",B.row,a.colToProp(B.col),se.row,a.colToProp(se.col),D,ye),k&&(!D.isTouched()||D.isTouched()&&!D.value)&&g.scrollTo(E);const we=V.isSelectedByRowHeader(),de=V.isSelectedByColumnHeader();we&&de?addClass$1(this.rootElement,["ht__selection--rows","ht__selection--columns"]):we?(removeClass$1(this.rootElement,"ht__selection--columns"),addClass$1(this.rootElement,"ht__selection--rows")):de?(removeClass$1(this.rootElement,"ht__selection--rows"),addClass$1(this.rootElement,"ht__selection--columns")):removeClass$1(this.rootElement,["ht__selection--rows","ht__selection--columns"]),V.getSelectionSource()!=="shift"&&f.closeEditor(null),a.view.render(),f.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",E=>{this.runHooks("beforeSelectionFocusSet",E.row,E.col)}),this.selection.addLocalHook("afterSetFocus",E=>{const k=createObjectPropListener(!1);this.runHooks("afterSelectionFocusSet",E.row,E.col,k),(!k.isTouched()||k.isTouched()&&!k.value)&&g.scrollTo(E),f.closeEditor(),a.view.render(),f.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",E=>{const k=E.length-1,{from:D,to:q}=E[k];this.runHooks("afterSelectionEnd",D.row,D.col,q.row,q.col,k),this.runHooks("afterSelectionEndByProp",D.row,a.colToProp(D.col),q.row,a.colToProp(q.col),k)}),this.selection.addLocalHook("afterIsMultipleSelection",E=>{const k=this.runHooks("afterIsMultipleSelection",E.value);E.value&&(E.value=k)}),this.selection.addLocalHook("afterDeselect",()=>{f.closeEditor(),a.view.render(),removeClass$1(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var E=arguments.length,k=new Array(E),D=0;D<E;D++)k[D]=arguments[D];return r.runHooks("beforeSetRangeStart",...k)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var E=arguments.length,k=new Array(E),D=0;D<E;D++)k[D]=arguments[D];return r.runHooks("beforeSetRangeStartOnly",...k)}).addLocalHook("beforeSetRangeEnd",function(){for(var E=arguments.length,k=new Array(E),D=0;D<E;D++)k[D]=arguments[D];return r.runHooks("beforeSetRangeEnd",...k)}).addLocalHook("beforeSelectColumns",function(){for(var E=arguments.length,k=new Array(E),D=0;D<E;D++)k[D]=arguments[D];return r.runHooks("beforeSelectColumns",...k)}).addLocalHook("afterSelectColumns",function(){for(var E=arguments.length,k=new Array(E),D=0;D<E;D++)k[D]=arguments[D];return r.runHooks("afterSelectColumns",...k)}).addLocalHook("beforeSelectRows",function(){for(var E=arguments.length,k=new Array(E),D=0;D<E;D++)k[D]=arguments[D];return r.runHooks("beforeSelectRows",...k)}).addLocalHook("afterSelectRows",function(){for(var E=arguments.length,k=new Array(E),D=0;D<E;D++)k[D]=arguments[D];return r.runHooks("afterSelectRows",...k)}).addLocalHook("beforeModifyTransformStart",function(){for(var E=arguments.length,k=new Array(E),D=0;D<E;D++)k[D]=arguments[D];return r.runHooks("modifyTransformStart",...k)}).addLocalHook("afterModifyTransformStart",function(){for(var E=arguments.length,k=new Array(E),D=0;D<E;D++)k[D]=arguments[D];return r.runHooks("afterModifyTransformStart",...k)}).addLocalHook("beforeModifyTransformFocus",function(){for(var E=arguments.length,k=new Array(E),D=0;D<E;D++)k[D]=arguments[D];return r.runHooks("modifyTransformFocus",...k)}).addLocalHook("afterModifyTransformFocus",function(){for(var E=arguments.length,k=new Array(E),D=0;D<E;D++)k[D]=arguments[D];return r.runHooks("afterModifyTransformFocus",...k)}).addLocalHook("beforeModifyTransformEnd",function(){for(var E=arguments.length,k=new Array(E),D=0;D<E;D++)k[D]=arguments[D];return r.runHooks("modifyTransformEnd",...k)}).addLocalHook("afterModifyTransformEnd",function(){for(var E=arguments.length,k=new Array(E),D=0;D<E;D++)k[D]=arguments[D];return r.runHooks("afterModifyTransformEnd",...k)}).addLocalHook("beforeRowWrap",function(){for(var E=arguments.length,k=new Array(E),D=0;D<E;D++)k[D]=arguments[D];return r.runHooks("beforeRowWrap",...k)}).addLocalHook("beforeColumnWrap",function(){for(var E=arguments.length,k=new Array(E),D=0;D<E;D++)k[D]=arguments[D];return r.runHooks("beforeColumnWrap",...k)}).addLocalHook("insertRowRequire",E=>this.alter("insert_row_above",E,1,"auto")).addLocalHook("insertColRequire",E=>this.alter("insert_col_start",E,1,"auto")),d={alter(E,k){var D,q;let B=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,se=arguments.length>3?arguments[3]:void 0,ye=arguments.length>4?arguments[4]:void 0;const we=de=>{if(de.length===0)return[];const be=[...de];return be.sort((he,Ne)=>{let[le]=he,[Ve]=Ne;return le===Ve?0:le>Ve?1:-1}),arrayReduce(be,(he,Ne)=>{let[le,Ve]=Ne;const Be=he[he.length-1],[je,We]=Be,$e=je+We;if(le<=$e){const H=Math.max(Ve-($e-le),0);Be[1]+=H}else he.push([le,Ve]);return he},[be[0]])};switch(E){case"insert_row_below":case"insert_row_above":const de=a.countSourceRows();if(T.maxRows===de)return;const be=E==="insert_row_below"?"below":"above";k=(D=k)!==null&&D!==void 0?D:be==="below"?de:0;const{delta:fe,startPhysicalIndex:he}=u.createRow(k,B,{source:se,mode:be});V.shiftRows(a.toVisualRow(he),fe);break;case"insert_col_start":case"insert_col_end":const Ne=E==="insert_col_end"?"end":"start";k=(q=k)!==null&&q!==void 0?q:Ne==="end"?a.countSourceCols():0;const{delta:le,startPhysicalIndex:Ve}=u.createCol(k,B,{source:se,mode:Ne});if(le){if(Array.isArray(T.colHeaders)){const We=[a.toVisualColumn(Ve),0];We.length+=le,Array.prototype.splice.apply(T.colHeaders,We)}V.shiftColumns(a.toVisualColumn(Ve),le)}break;case"remove_row":const Be=We=>{let $e=0;arrayEach$1(We,H=>{let[F,G]=H;const oe=isEmpty(F)?a.countRows()-1:Math.max(F-$e,0);if(Number.isInteger(F)&&(F=Math.max(F-$e,0)),!u.removeRow(F,G,se))return;if(V.isSelected()){const{row:W}=a.getSelectedRangeLast().highlight;W>=F&&W<=F+G-1&&f.closeEditor(!0)}const ce=a.countRows();ce===0?V.deselect():se==="ContextMenu.removeRow"?V.refresh():V.shiftRows(F,-G);const ee=T.fixedRowsTop;ee>=oe+1&&(T.fixedRowsTop-=Math.min(G,ee-oe));const te=T.fixedRowsBottom;te&&oe>=ce-te&&(T.fixedRowsBottom-=Math.min(G,te)),$e+=G})};Array.isArray(k)?Be(we(k)):Be([[k,B]]);break;case"remove_col":const je=We=>{let $e=0;arrayEach$1(We,H=>{let[F,G]=H;const oe=isEmpty(F)?a.countCols()-1:Math.max(F-$e,0);let Q=a.toPhysicalColumn(oe);if(Number.isInteger(F)&&(F=Math.max(F-$e,0)),!u.removeCol(F,G,se))return;if(V.isSelected()){const{col:W}=a.getSelectedRangeLast().highlight;W>=F&&W<=F+G-1&&f.closeEditor(!0)}a.countCols()===0?V.deselect():se==="ContextMenu.removeColumn"?V.refresh():V.shiftColumns(F,-G);const te=T.fixedColumnsStart;te>=oe+1&&(T.fixedColumnsStart-=Math.min(G,te-oe)),Array.isArray(T.colHeaders)&&(typeof Q>"u"&&(Q=-1),T.colHeaders.splice(Q,G)),$e+=G})};Array.isArray(k)?je(we(k)):je([[k,B]]);break;default:throw new Error(`There is no such action "${E}"`)}a.view.render(),ye||d.adjustRowsAndCols()},adjustRowsAndCols(){const E=T.minRows,k=T.minSpareRows,D=T.minCols,q=T.minSpareCols;if(E){const B=a.countRows();B<E&&u.createRow(B,E-B,{source:"auto"})}if(k){const B=a.countEmptyRows(!0);if(B<k){const se=k-B,ye=Math.min(se,T.maxRows-a.countSourceRows());u.createRow(a.countRows(),ye,{source:"auto"})}}{let B;(D||q)&&(B=a.countEmptyCols(!0));let se=a.countCols();if(D&&!T.columns&&se<D){const ye=D-se;B+=ye,u.createCol(se,ye,{source:"auto"})}if(q&&!T.columns&&a.dataType==="array"&&B<q){se=a.countCols();const ye=q-B,we=Math.min(ye,T.maxCols-se);u.createCol(se,we,{source:"auto"})}}a.view&&a.view.adjustElementsSize()},populateFromArray(E,k,D,q,B){let se,ye,we,de;const be=[],fe={},he=[],Ne=E.row,le=E.col;if(ye=k.length,ye===0)return!1;let Ve=0,Be=0;switch(isObject$4(D)&&(Ve=D.col-le+1,Be=D.row-Ne+1),B){case"shift_down":const je=pivot(k),We=je.length,$e=Math.max(We,Ve),H=a.getData().slice(Ne),F=pivot(H).slice(le,le+$e);for(we=0;we<$e;we+=1)if(we<We){for(se=0,ye=je[we].length;se<Be-ye;se+=1)je[we].push(je[we][se%ye]);we<F.length?he.push(je[we].concat(F[we])):he.push(je[we].concat(new Array(H.length).fill(null)))}else he.push(je[we%We].concat(F[we]));a.populateFromArray(Ne,le,pivot(he));break;case"shift_right":const G=k.length,oe=Math.max(G,Be),Q=a.getData().slice(Ne).map(Re=>Re.slice(le));for(se=0;se<oe;se+=1)if(se<G){for(we=0,de=k[se].length;we<Ve-de;we+=1)k[se].push(k[se][we%de]);if(se<Q.length)for(let Re=0;Re<Q[se].length;Re+=1)k[se].push(Q[se][Re]);else k[se].push(...new Array(Q[0].length).fill(null))}else k.push(k[se%ye].slice(0,oe).concat(Q[se]));a.populateFromArray(Ne,le,k);break;case"overwrite":default:fe.row=E.row,fe.col=E.col;let ce=0,ee=0,te=!0,W;const j=function(Ie){let ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Te=k[Ie%k.length];return ae!==null?Te[ae%Te.length]:Te},K=k.length,ve=D?D.row-E.row+1:0;for(D?ye=ve:ye=Math.max(K,ve),se=0;se<ye&&!(D&&fe.row>D.row&&ve>K||!T.allowInsertRow&&fe.row>a.countRows()-1||fe.row>=T.maxRows);se++){const Re=se-ce,Ie=j(Re).length,ae=D?D.col-E.col+1:0;if(D?de=ae:de=Math.max(Ie,ae),fe.col=E.col,W=a.getCellMeta(fe.row,fe.col),(q==="CopyPaste.paste"||q==="Autofill.fill")&&W.skipRowOnPaste){ce+=1,fe.row+=1,ye+=1;continue}for(ee=0,we=0;we<de&&!(D&&fe.col>D.col&&ae>Ie||!T.allowInsertColumn&&fe.col>a.countCols()-1||fe.col>=T.maxCols);we++){if(W=a.getCellMeta(fe.row,fe.col),(q==="CopyPaste.paste"||q==="Autofill.fill")&&W.skipColumnOnPaste){ee+=1,fe.col+=1,de+=1;continue}if(W.readOnly&&q!=="UndoRedo.undo"){fe.col+=1;continue}const Te=we-ee;let Me=j(Re,Te),Pe=a.getDataAtCell(fe.row,fe.col);if(Me!==null&&typeof Me=="object")if(Array.isArray(Me)&&Pe===null&&(Pe=[]),Pe===null||typeof Pe!="object")te=!1;else{const De=duckSchema(Array.isArray(Pe)?Pe:Pe[0]||Pe),ze=duckSchema(Array.isArray(Me)?Me:Me[0]||Me);isObjectEqual(De,ze)||Array.isArray(De)&&Array.isArray(ze)?Me=deepClone(Me):te=!1}else Pe!==null&&typeof Pe=="object"&&(te=!1);te&&be.push([fe.row,fe.col,Me]),te=!0,fe.col+=1}fe.row+=1}a.setDataAtCell(be,null,null,q||"populateFromArray");break}}};function $(E){const k=normalizeLanguageCode(E);hasLanguageDictionary(k)?(a.runHooks("beforeLanguageChange",k),A.language=k,a.runHooks("afterLanguageChange",k)):warnUserAboutLanguageRegistration(E)}function Z(E,k){const D=E==="className"?a.rootElement:a.table;if(v)addClass$1(D,k);else{let q=[],B=[];A[E]&&(q=Array.isArray(A[E])?A[E]:stringToArray(A[E])),k&&(B=Array.isArray(k)?k:stringToArray(k));const se=getDifferenceOfArrays(q,B),ye=getDifferenceOfArrays(B,q);se.length&&removeClass$1(D,se),ye.length&&addClass$1(D,ye)}A[E]=k}this.init=function(){h.setData(T.data),a.runHooks("beforeInit"),(isMobileBrowser()||isIpadOS())&&addClass$1(a.rootElement,"mobile"),this.updateSettings(T,!0),this.view=new tableView_default(this),f=editorManager_default.getInstance(a,T,V),g=createViewportScroller(a),m=new FocusManager(a),isRootInstance(this)&&installFocusCatcher(a),a.runHooks("init"),this.forceFullRender=!0,this.view.render(),v&&a.rootElement.offsetParent===null&&observeVisibilityChangeOnce(a.rootElement,()=>{a.view._wt.wtOverlays.updateLastSpreaderSize(),a.render(),a.view.adjustElementsSize()}),typeof v=="object"&&(a.runHooks("afterChange",v[0],v[1]),v=!1),a.runHooks("afterInit")};function ie(){let E=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,E=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&E===!1&&(E=!0,this.onQueueEmpty(this.valid))}}}function ue(E){const k=E.replace(",",".");return isNaN(parseFloat(k))===!1?parseFloat(k):E}function _e(E,k,D){if(!E.length){D();return}const q=a.getActiveEditor(),B=new ie;let se=!0;B.onQueueEmpty=()=>{q&&se&&q.cancelChanges(),D()};for(let ye=E.length-1;ye>=0;ye--){const[we,de,,be]=E[ye],fe=u.propToCol(de);let he;Number.isInteger(fe)?he=a.getCellMeta(we,fe):he={...Object.getPrototypeOf(T),...T},he.type==="numeric"&&typeof be=="string"&&isNumericLike(be)&&(E[ye][3]=ue(be)),a.getCellValidator(he)&&(B.addValidatorToQueue(),a.validateCell(E[ye][3],he,function(Ne,le){return function(Ve){if(typeof Ve!="boolean")throw new Error("Validation error: result is not boolean");Ve===!1&&le.allowInvalid===!1&&(se=!1,E.splice(Ne,1),le.valid=!0),B.removeValidatorFormQueue()}}(ye,he),k))}B.checkIfQueueIsEmpty()}function Ee(E,k){for(let q=E.length-1;q>=0;q--){let B=!1;if(E[q]===null){E.splice(q,1);continue}if(!((E[q][2]===null||E[q][2]===void 0)&&(E[q][3]===null||E[q][3]===void 0))){if(T.allowInsertRow)for(;E[q][0]>a.countRows()-1;){const{delta:se}=u.createRow(void 0,void 0,{source:k});if(se===0){B=!0;break}}if(a.dataType==="array"&&(!T.columns||T.columns.length===0)&&T.allowInsertColumn)for(;u.propToCol(E[q][1])>a.countCols()-1;){const{delta:se}=u.createCol(void 0,void 0,{source:k});if(se===0){B=!0;break}}B||u.set(E[q][0],E[q][1],E[q][3])}}const D=E.length>0;if(a.forceFullRender=!0,D){d.adjustRowsAndCols(),a.runHooks("beforeChangeRender",E,k),f.closeEditor(),a.view.render(),f.prepareEditor(),a.view.adjustElementsSize(),a.runHooks("afterChange",E,k||"edit");const q=a.getActiveEditor();q&&isDefined(q.refreshValue)&&q.refreshValue()}else a.view.render()}this._createCellCoords=function(E,k){return a.view._wt.createCellCoords(E,k)},this._createCellRange=function(E,k,D){return a.view._wt.createCellRange(E,k,D)},this.validateCell=function(E,k,D,q){let B=a.getCellValidator(k);function se(ye){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||k.hidden===!0){D(ye);return}const de=k.visualCol,be=k.visualRow,fe=a.getCell(be,de,!0);if(fe&&fe.nodeName!=="TH"){const he=a.rowIndexMapper.getRenderableFromVisualIndex(be),Ne=a.columnIndexMapper.getRenderableFromVisualIndex(de);a.view._wt.getSetting("cellRenderer",he,Ne,fe)}D(ye)}isRegExp$1(B)&&(B=function(ye){return function(we,de){de(ye.test(we))}}(B)),isFunction$2(B)?(E=a.runHooks("beforeValidate",E,k.visualRow,k.prop,q),a._registerImmediate(()=>{B.call(k,E,ye=>{a&&(ye=a.runHooks("afterValidate",ye,E,k.visualRow,k.prop,q),k.valid=ye,se(ye),a.runHooks("postAfterValidate",ye,E,k.visualRow,k.prop,q))})})):a._registerImmediate(()=>{k.valid=!0,se(k.valid,!1)})};function pe(E,k,D){return Array.isArray(E)?E:[[E,k,D]]}function me(E,k){const D=a.getActiveEditor(),q=a.runHooks("beforeChange",E,k||"edit"),B=E.filter(se=>se!==null);return q===!1||B.length===0?(D&&D.cancelChanges(),[]):B}this.setDataAtCell=function(E,k,D,q){const B=pe(E,k,D),se=[];let ye=q,we,de,be;for(we=0,de=B.length;we<de;we++){if(typeof B[we]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof B[we][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");B[we][1]>=this.countCols()?be=B[we][1]:be=u.colToProp(B[we][1]),se.push([B[we][0],be,h.getAtCell(this.toPhysicalRow(B[we][0]),B[we][1]),B[we][2]])}!ye&&typeof E=="object"&&(ye=k);const fe=me(se,q);a.runHooks("afterSetDataAtCell",fe,ye),_e(fe,ye,()=>{Ee(fe,ye)})},this.setDataAtRowProp=function(E,k,D,q){const B=pe(E,k,D),se=[];let ye=q,we,de;for(we=0,de=B.length;we<de;we++)se.push([B[we][0],B[we][1],h.getAtCell(this.toPhysicalRow(B[we][0]),B[we][1]),B[we][2]]);!ye&&typeof E=="object"&&(ye=k);const be=me(se,q);a.runHooks("afterSetDataAtRowProp",be,ye),_e(be,ye,()=>{Ee(be,ye)})},this.listen=function(){a&&!a.isListening()&&(foreignHotInstances.forEach(E=>{a!==E&&E.unlisten()}),activeGuid=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(activeGuid=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return activeGuid===a.guid},this.destroyEditor=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;f.closeEditor(E),a.view.render(),k&&V.isSelected()&&f.prepareEditor()},this.populateFromArray=function(E,k,D,q,B,se,ye){if(!(typeof D=="object"&&typeof D[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const we=typeof q=="number"?a._createCellCoords(q,B):null;return d.populateFromArray(a._createCellCoords(E,k),D,we,se,ye)},this.spliceCol=function(E,k,D){for(var q=arguments.length,B=new Array(q>3?q-3:0),se=3;se<q;se++)B[se-3]=arguments[se];return u.spliceCol(E,k,D,...B)},this.spliceRow=function(E,k,D){for(var q=arguments.length,B=new Array(q>3?q-3:0),se=3;se<q;se++)B[se-3]=arguments[se];return u.spliceRow(E,k,D,...B)},this.getSelected=function(){if(V.isSelected())return arrayMap$1(V.getSelectedRange(),E=>{let{from:k,to:D}=E;return[k.row,k.col,D.row,D.col]})},this.getSelectedLast=function(){const E=this.getSelected();let k;return E&&E.length>0&&(k=E[E.length-1]),k},this.getSelectedRange=function(){if(V.isSelected())return Array.from(V.getSelectedRange())},this.getSelectedRangeLast=function(){const E=this.getSelectedRange();let k;return E&&E.length>0&&(k=E[E.length-1]),k},this.emptySelectedCells=function(E){if(!V.isSelected()||this.countRows()===0||this.countCols()===0)return;const k=[];arrayEach$1(V.getSelectedRange(),D=>{if(D.isSingleHeader())return;const q=D.getTopStartCorner(),B=D.getBottomEndCorner();rangeEach(q.row,B.row,se=>{rangeEach(q.col,B.col,ye=>{this.getCellMeta(se,ye).readOnly||k.push([se,ye,null])})})}),k.length>0&&this.setDataAtCell(k,E)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const E=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(E,0),!this.isRenderSuspended()&&E===this.renderSuspendedCounter&&(this.renderCall?this.render():a.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||a.view.render())},this.batchRender=function(E){this.suspendRender();const k=E();return this.resumeRender(),k},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const k=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(k,0),(!this.isExecutionSuspended()&&k===this.executionSuspendedCounter||E)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(E){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const D=E();return this.resumeExecution(k),D},this.batch=function(E){this.suspendRender(),this.suspendExecution();const k=E();return this.resumeExecution(),this.resumeRender(),k},this.refreshDimensions=function(){if(!a.view)return;const{width:E,height:k}=a.view.getLastSize(),{width:D,height:q}=a.rootElement.getBoundingClientRect(),B=D!==E||q!==k;a.runHooks("beforeRefreshDimensions",{width:E,height:k},{width:D,height:q},B)!==!1&&((B||a.view._wt.wtOverlays.scrollableElement===a.rootWindow)&&(a.view.setLastSize(D,q),a.render()),a.runHooks("afterRefreshDimensions",{width:E,height:k},{width:D,height:q},B))},this.updateData=function(E,k){replaceData(E,D=>{u=D},D=>{u=D,a.columnIndexMapper.fitToLength(this.getInitialColumnCount()),a.rowIndexMapper.fitToLength(this.countSourceRows()),d.adjustRowsAndCols(),V.refresh()},{hotInstance:a,dataMap:u,dataSource:h,internalSource:"updateData",source:k,metaManager:S,firstRun:v})},this.loadData=function(E,k){replaceData(E,D=>{u=D},()=>{S.clearCellsCache(),a.initIndexMappers(),d.adjustRowsAndCols(),V.refresh(),v&&(v=[null,"loadData"])},{hotInstance:a,dataMap:u,dataSource:h,internalSource:"loadData",source:k,metaManager:S,firstRun:v})},this.getInitialColumnCount=function(){const E=T.columns;let k=0;if(Array.isArray(E))k=E.length;else if(isFunction$2(E))if(a.dataType==="array"){const D=this.countSourceCols();for(let q=0;q<D;q+=1)E(q)&&(k+=1)}else(a.dataType==="object"||a.dataType==="function")&&(k=u.colToPropCache.length);else if(isDefined(T.dataSchema)){const D=u.getSchema();k=Array.isArray(D)?D.length:deepObjectSize(D)}else k=this.countSourceCols();return k},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(E,k,D,q){return isUndefined$1(E)?u.getAll():u.getRange(a._createCellCoords(E,k),a._createCellCoords(D,q),u.DESTINATION_RENDERER)},this.getCopyableText=function(E,k,D,q){return u.getCopyableText(a._createCellCoords(E,k),a._createCellCoords(D,q))},this.getCopyableData=function(E,k){return u.getCopyable(E,u.colToProp(k))},this.getSchema=function(){return u.getSchema()},this.updateSettings=function(E){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const D=(v?a.loadData:a.updateData).bind(this);let q=!1,B,se;if(isDefined(E.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(isDefined(E.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(isDefined(E.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(B in E)B==="data"||(B==="language"?$(E.language):B==="className"?Z("className",E.className):B==="tableClassName"&&a.table?(Z("tableClassName",E.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames()):pluginHooks_default.getSingleton().isRegistered(B)||pluginHooks_default.getSingleton().isDeprecated(B)?(isFunction$2(E[B])||Array.isArray(E[B]))&&(E[B].initialHook=!0,a.addHook(B,E[B])):!k&&hasOwnProperty$15(E,B)&&(A[B]=E[B]));E.data===void 0&&T.data===void 0?D(null,"updateSettings"):E.data!==void 0?D(E.data,"updateSettings"):E.columns!==void 0&&(u.createMap(),a.initIndexMappers());const ye=a.countCols(),we=T.columns;if(we&&isFunction$2(we)&&(q=!0),(E.cell!==void 0||E.cells!==void 0||E.columns!==void 0)&&S.clearCache(),ye>0)for(B=0,se=0;B<ye;B++){if(we){const fe=q?we(B):we[se];fe&&S.updateColumnMeta(se,fe)}se+=1}isDefined(E.cell)&&objectEach(E.cell,fe=>{a.setCellMetaObject(fe.row,fe.col,fe)}),a.runHooks("afterCellMetaReset");let de=a.rootElement.style.height;de!==""&&(de=parseInt(a.rootElement.style.height,10));let be=E.height;if(isFunction$2(be)&&(be=be()),k&&a.rootElement.getAttribute("style")&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style")),be===null){const fe=a.rootElement.getAttribute("data-initialstyle");fe&&(fe.indexOf("height")>-1||fe.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",fe):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else be!==void 0&&(a.rootElement.style.height=isNaN(be)?`${be}`:`${be}px`,a.rootElement.style.overflow="hidden");if(typeof E.width<"u"){let fe=E.width;isFunction$2(fe)&&(fe=fe()),a.rootElement.style.width=isNaN(fe)?`${fe}`:`${fe}px`}k||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",E)),d.adjustRowsAndCols(),a.view&&!v&&(a.forceFullRender=!0,a.view.render(),a.view._wt.wtOverlays.adjustElementsSize()),!k&&a.view&&(de===""||be===""||be===void 0)&&de!==be&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const E=a.getSelectedLast();if(T.getValue){if(isFunction$2(T.getValue))return T.getValue.call(a);if(E)return a.getData()[E[0][0]][T.getValue]}else if(E)return a.getDataAtCell(E[0],E[1])},this.getSettings=function(){return T},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(E,k,D,q,B){d.alter(E,k,D,q,B)},this.getCell=function(E,k){let D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,q=k,B=E;if(k>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(k)))return null;q=this.columnIndexMapper.getRenderableFromVisualIndex(k)}if(E>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(E)))return null;B=this.rowIndexMapper.getRenderableFromVisualIndex(E)}return B===null||q===null||B===void 0||q===void 0?null:a.view.getCellAtCoords(a._createCellCoords(B,q),D)},this.getCoords=function(E){const k=this.view._wt.wtTable.getCoords(E);if(k===null)return null;const{row:D,col:q}=k;let B=D,se=q;return D>=0&&(B=this.rowIndexMapper.getVisualFromRenderableIndex(D)),q>=0&&(se=this.columnIndexMapper.getVisualFromRenderableIndex(q)),a._createCellCoords(B,se)},this.colToProp=function(E){return u.colToProp(E)},this.propToCol=function(E){return u.propToCol(E)},this.toVisualRow=E=>this.rowIndexMapper.getVisualFromPhysicalIndex(E),this.toVisualColumn=E=>this.columnIndexMapper.getVisualFromPhysicalIndex(E),this.toPhysicalRow=E=>this.rowIndexMapper.getPhysicalFromVisualIndex(E),this.toPhysicalColumn=E=>this.columnIndexMapper.getPhysicalFromVisualIndex(E),this.getDataAtCell=function(E,k){return u.get(E,u.colToProp(k))},this.getDataAtRowProp=function(E,k){return u.get(E,k)},this.getDataAtCol=function(E){const k=[],D=u.getRange(a._createCellCoords(0,E),a._createCellCoords(T.data.length-1,E),u.DESTINATION_RENDERER);for(let q=0;q<D.length;q+=1)for(let B=0;B<D[q].length;B+=1)k.push(D[q][B]);return k},this.getDataAtProp=function(E){const k=[],D=u.getRange(a._createCellCoords(0,u.propToCol(E)),a._createCellCoords(T.data.length-1,u.propToCol(E)),u.DESTINATION_RENDERER);for(let q=0;q<D.length;q+=1)for(let B=0;B<D[q].length;B+=1)k.push(D[q][B]);return k},this.getSourceData=function(E,k,D,q){let B;return E===void 0?B=h.getData():B=h.getByRange(a._createCellCoords(E,k),a._createCellCoords(D,q)),B},this.getSourceDataArray=function(E,k,D,q){let B;return E===void 0?B=h.getData(!0):B=h.getByRange(a._createCellCoords(E,k),a._createCellCoords(D,q),!0),B},this.getSourceDataAtCol=function(E){return h.getAtColumn(E)},this.setSourceDataAtCell=function(E,k,D,q){const B=pe(E,k,D),se=this.hasHook("afterSetSourceDataAtCell"),ye=[];se&&arrayEach$1(B,de=>{let[be,fe,he]=de;ye.push([be,fe,h.getAtCell(be,fe),he])}),arrayEach$1(B,de=>{let[be,fe,he]=de;h.setAtCell(be,fe,he)}),se&&this.runHooks("afterSetSourceDataAtCell",ye,q),this.render();const we=a.getActiveEditor();we&&isDefined(we.refreshValue)&&we.refreshValue()},this.getSourceDataAtRow=function(E){return h.getAtRow(E)},this.getSourceDataAtCell=function(E,k){return h.getAtCell(E,k)},this.getDataAtRow=function(E){return u.getRange(a._createCellCoords(E,0),a._createCellCoords(E,this.countCols()-1),u.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(E,k,D,q){const B=E===void 0?[0,0,this.countRows(),this.countCols()]:[E,k,D,q],[se,ye]=B;let[,,we,de]=B,be=null,fe=null;we===void 0&&(we=se),de===void 0&&(de=ye);let he="mixed";return rangeEach(Math.max(Math.min(se,we),0),Math.max(se,we),Ne=>{let le=!0;return rangeEach(Math.max(Math.min(ye,de),0),Math.max(ye,de),Ve=>(fe=this.getCellMeta(Ne,Ve).type,be?le=be===fe:be=fe,le)),he=le?fe:"mixed",le}),he},this.removeCellMeta=function(E,k,D){const[q,B]=[this.toPhysicalRow(E),this.toPhysicalColumn(k)];let se=S.getCellMetaKeyValue(q,B,D);a.runHooks("beforeRemoveCellMeta",E,k,D,se)!==!1&&(S.removeCellMeta(q,B,D),a.runHooks("afterRemoveCellMeta",E,k,D,se)),se=null},this.spliceCellsMeta=function(E){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var D=arguments.length,q=new Array(D>2?D-2:0),B=2;B<D;B++)q[B-2]=arguments[B];if(q.length>0&&!Array.isArray(q[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");k>0&&S.removeRow(this.toPhysicalRow(E),k),q.length>0&&arrayEach$1(q.reverse(),se=>{S.createRow(this.toPhysicalRow(E)),arrayEach$1(se,(ye,we)=>this.setCellMetaObject(E,we,ye))}),a.render()},this.setCellMetaObject=function(E,k,D){typeof D=="object"&&objectEach(D,(q,B)=>{this.setCellMeta(E,k,B,q)})},this.setCellMeta=function(E,k,D,q){if(a.runHooks("beforeSetCellMeta",E,k,D,q)===!1)return;let se=E,ye=k;E<this.countRows()&&(se=this.toPhysicalRow(E)),k<this.countCols()&&(ye=this.toPhysicalColumn(k)),S.setCellMeta(se,ye,D,q),a.runHooks("afterSetCellMeta",E,k,D,q)},this.getCellsMeta=function(){return S.getCellsMeta()},this.getCellMeta=function(E,k){let D=this.toPhysicalRow(E),q=this.toPhysicalColumn(k);return D===null&&(D=E),q===null&&(q=k),S.getCellMeta(D,q,{visualRow:E,visualColumn:k})},this.getColumnMeta=function(E){return S.getColumnMeta(this.toPhysicalColumn(E))},this.getCellMetaAtRow=function(E){return S.getCellsMetaAtRow(E)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||T.columns)},this.getCellRenderer=function(E,k){const D=typeof E=="number"?a.getCellMeta(E,k).renderer:E.renderer;return typeof D=="string"?_getItem$2(D):isUndefined$1(D)?_getItem$2("text"):D},this.getCellEditor=function(E,k){const D=typeof E=="number"?a.getCellMeta(E,k).editor:E.editor;return typeof D=="string"?_getItem$3(D):isUndefined$1(D)?_getItem$3("text"):D},this.getCellValidator=function(E,k){const D=typeof E=="number"?a.getCellMeta(E,k).validator:E.validator;return typeof D=="string"?_getItem$1(D):D},this.validateCells=function(E){this._validateCells(E)},this.validateRows=function(E,k){if(!Array.isArray(E))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(k,E)},this.validateColumns=function(E,k){if(!Array.isArray(E))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(k,void 0,E)},this._validateCells=function(E,k,D){const q=new ie;E&&(q.onQueueEmpty=E);let B=a.countRows()-1;for(;B>=0;){if(k!==void 0&&k.indexOf(B)===-1){B-=1;continue}let se=a.countCols()-1;for(;se>=0;){if(D!==void 0&&D.indexOf(se)===-1){se-=1;continue}q.addValidatorToQueue(),a.validateCell(a.getDataAtCell(B,se),a.getCellMeta(B,se),ye=>{if(typeof ye!="boolean")throw new Error("Validation error: result is not boolean");ye===!1&&(q.valid=!1),q.removeValidatorFormQueue()},"validateCells"),se-=1}B-=1}q.checkIfQueueIsEmpty()},this.getRowHeader=function(E){let k=T.rowHeaders,D=E;return D!==void 0&&(D=a.runHooks("modifyRowHeader",D)),D===void 0?(k=[],rangeEach(a.countRows()-1,q=>{k.push(a.getRowHeader(q))})):Array.isArray(k)&&k[D]!==void 0?k=k[D]:isFunction$2(k)?k=k(D):k&&typeof k!="string"&&typeof k!="number"&&(k=D+1),k},this.hasRowHeaders=function(){return!!T.rowHeaders},this.hasColHeaders=function(){if(T.colHeaders!==void 0&&T.colHeaders!==null)return!!T.colHeaders;for(let E=0,k=a.countCols();E<k;E++)if(a.getColHeader(E))return!0;return!1},this.getColHeader=function(E){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const D=a.runHooks("modifyColHeader",E);if(D===void 0){const we=[],de=a.countCols();for(let be=0;be<de;be++)we.push(a.getColHeader(be));return we}let q=T.colHeaders;const B=function(we){const de=[],be=a.countCols();let fe=0;for(;fe<be;fe++)isFunction$2(T.columns)&&T.columns(fe)&&de.push(fe);return de[we]},se=a.toPhysicalColumn(D),ye=B(se);return T.colHeaders===!1?q=null:T.columns&&isFunction$2(T.columns)&&T.columns(ye)&&T.columns(ye).title?q=T.columns(ye).title:T.columns&&T.columns[se]&&T.columns[se].title?q=T.columns[se].title:Array.isArray(T.colHeaders)&&T.colHeaders[se]!==void 0?q=T.colHeaders[se]:isFunction$2(T.colHeaders)?q=T.colHeaders(se):T.colHeaders&&typeof T.colHeaders!="string"&&typeof T.colHeaders!="number"&&(q=spreadsheetColumnLabel(D)),q=a.runHooks("modifyColumnHeaderValue",q,E,k),q},this._getColWidthFromSettings=function(E){let k;if(E>=0&&(k=a.getCellMeta(0,E).width),(k===void 0||k===T.width)&&(k=T.colWidths),k!=null){switch(typeof k){case"object":k=k[E];break;case"function":k=k(E);break;default:break}typeof k=="string"&&(k=parseInt(k,10))}return k},this.getColWidth=function(E){let k=a._getColWidthFromSettings(E);return k=a.runHooks("modifyColWidth",k,E),k===void 0&&(k=DEFAULT_WIDTH),k},this._getRowHeightFromSettings=function(E){let k=T.rowHeights;if(k!=null){switch(typeof k){case"object":k=k[E];break;case"function":k=k(E);break;default:break}typeof k=="string"&&(k=parseInt(k,10))}return k},this.getRowHeight=function(E){let k=a._getRowHeightFromSettings(E);return k=a.runHooks("modifyRowHeight",k,E),k},this.countSourceRows=function(){return h.countRows()},this.countSourceCols=function(){return h.countFirstRowKeys()},this.countRows=function(){return u.getLength()},this.countCols=function(){const E=T.maxCols,k=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(E,k)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,k=0;return rangeEachReverse(a.countRows()-1,D=>{if(a.isEmptyRow(D))k+=1;else if(E===!0)return!1}),k},this.countEmptyCols=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,k=0;return rangeEachReverse(a.countCols()-1,D=>{if(a.isEmptyCol(D))k+=1;else if(E===!0)return!1}),k},this.isEmptyRow=function(E){return T.isEmptyRow.call(a,E)},this.isEmptyCol=function(E){return T.isEmptyCol.call(a,E)},this.selectCell=function(E,k,D,q){let B=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,se=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return isUndefined$1(E)||isUndefined$1(k)?!1:this.selectCells([[E,k,D,q]],B,se)},this.selectCells=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;k===!1&&g.suspend();const q=V.selectCells(E);return q&&D&&a.listen(),g.resume(),q},this.selectColumns=function(E){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:E,D=arguments.length>2?arguments[2]:void 0;return V.selectColumns(E,k,D)},this.selectRows=function(E){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:E,D=arguments.length>2?arguments[2]:void 0;return V.selectRows(E,k,D)},this.deselectCell=function(){V.deselect()},this.selectAll=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:E,D=arguments.length>2?arguments[2]:void 0;g.skipNextScrollCycle(),V.selectAll(E,k,D)};const Se=(E,k)=>E.getNearestNotHiddenIndex(k,1,!0);this.scrollViewportTo=function(E){var k;if(typeof E=="number"){var D;E={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(D=arguments[4])!==null&&D!==void 0?D:!0}}const{row:q,col:B,verticalSnap:se,horizontalSnap:ye,considerHiddenIndexes:we}=(k=E)!==null&&k!==void 0?k:{};let de,be,fe,he;se!==void 0&&(de=se==="top",be=!de),ye!==void 0&&(fe=ye==="start",he=!fe);let Ne=q,le=B;if(we===void 0||we){const je=Number.isInteger(q)&&q>=0,We=Number.isInteger(B)&&B>=0,$e=je?Se(this.rowIndexMapper,q):void 0,H=We?Se(this.columnIndexMapper,B):void 0;if($e===null||H===null)return!1;Ne=je?a.rowIndexMapper.getRenderableFromVisualIndex($e):q,le=We?a.columnIndexMapper.getRenderableFromVisualIndex(H):B}const Ve=Number.isInteger(Ne),Be=Number.isInteger(le);return Ve&&Ne>=0&&Be&&le>=0?a.view.scrollViewport(a._createCellCoords(Ne,le),de,he,be,fe):Ve&&Ne>=0&&(Be&&le<0||!Be)?a.view.scrollViewportVertically(Ne,de,be):Be&&le>=0&&(Ve&&Ne<0||!Ve)?a.view.scrollViewportHorizontally(le,he,fe):!1},this.scrollToFocusedCell=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",E);const{highlight:k}=this.getSelectedRangeLast();this.scrollViewportTo(k.toObject())?this.view.render():(this.removeHook("afterScroll",E),this._registerImmediate(()=>E()))},this.destroy=function(){if(a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),h&&h.destroy(),h=null,this.getShortcutManager().destroy(),S.clearCache(),foreignHotInstances.delete(this.guid),isRootInstance(a)){const E=this.rootDocument.querySelector(".hot-display-license-info");E&&E.parentNode.removeChild(E)}empty(a.rootElement),c.destroy(),f&&f.destroy(),a.batchExecution(()=>{a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),I.getItems().forEach(E=>{let[,k]=E;k.destroy()}),I.clear(),a.runHooks("afterDestroy")},!0),pluginHooks_default.getSingleton().destroy(a),objectEach(a,(E,k,D)=>{isFunction$2(E)?D[k]=Le(k):k!=="guid"&&(D[k]=null)}),a.isDestroyed=!0,u&&u.destroy(),u=null,d=null,V=null,f=null,a=null};function Le(E){return()=>{throw new Error(`The "${E}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return f.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return a.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return a.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return a.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return a.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return a.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return a.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return a.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return a.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return a.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return a.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return a.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return a.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(E){const k=toUpperCaseFirst(E);return k==="UndoRedo"?this.undoRedo:I.getItem(k)},this.getPluginName=function(E){return E===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:I.getId(E)},this.getInstance=function(){return a},this.addHook=function(E,k,D){pluginHooks_default.getSingleton().add(E,k,a,D)},this.hasHook=function(E){return pluginHooks_default.getSingleton().has(E,a)||pluginHooks_default.getSingleton().has(E)},this.addHookOnce=function(E,k,D){pluginHooks_default.getSingleton().once(E,k,a,D)},this.removeHook=function(E,k){pluginHooks_default.getSingleton().remove(E,k,a)},this.runHooks=function(E,k,D,q,B,se,ye){return pluginHooks_default.getSingleton().run(a,E,k,D,q,B,se,ye)},this.getTranslatedPhrase=function(E,k){return getTranslatedPhrase(T.language,E,k)},this.toHTML=()=>instanceToHTML(this),this.toTableElement=()=>{const E=this.rootDocument.createElement("div");return E.insertAdjacentHTML("afterbegin",instanceToHTML(this)),E.firstElementChild},this.timeouts=[],this._registerTimeout=function(E){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,D=E;typeof D=="function"&&(D=setTimeout(D,k)),this.timeouts.push(D)},this._clearTimeouts=function(){arrayEach$1(this.timeouts,E=>{clearTimeout(E)})},this.immediates=[],this._registerImmediate=function(E){this.immediates.push(setImmediate(E))},this._clearImmediates=function(){arrayEach$1(this.immediates,E=>{clearImmediate(E)})},this._getEditorManager=function(){return f},this.isRtl=function(){return a.rootWindow.getComputedStyle(a.rootElement).direction==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1};const xe=createShortcutManager({handleEvent(){return a.isListening()},beforeKeyDown:E=>this.runHooks("beforeKeyDown",E),afterKeyDown:E=>{this.isDestroyed||a.runHooks("afterDocumentKeyDown",E)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",E=>{E.ctrlKey===!1&&E.metaKey===!1&&xe.releasePressedKeys()}),this.getShortcutManager=function(){return xe},this.getFocusManager=function(){return m},getPluginsNames().forEach(E=>{const k=getPlugin(E);I.addItem(E,new k(this))}),registerAllShortcutContexts(a),xe.setActiveContextName("grid"),pluginHooks_default.getSingleton().run(a,"construct")}function observe(e,t,i){e.addEventListener(t,i,!1)}function unObserve(e,t,i){e.removeEventListener(t,i,!1)}function getComputedStyle$2(e){return e.ownerDocument.defaultView.getComputedStyle(e)}function createInputElementResizer(e){const t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},i=e.body,r=e.createTextNode(""),o=e.createElement("span");let a;function c(){r.textContent=a.value,o.style.position="absolute",o.style.fontSize=getComputedStyle$2(a).fontSize,o.style.fontFamily=getComputedStyle$2(a).fontFamily,o.style.whiteSpace="pre",i.appendChild(o);const f=o.clientWidth+2;i.removeChild(o);const m=a.style;m.height=`${t.minHeight}px`,t.minWidth>f?m.width=`${t.minWidth}px`:f>t.maxWidth?m.width=`${t.maxWidth}px`:m.width=`${f}px`;const g=a.scrollHeight?a.scrollHeight-1:0;t.minHeight>g?m.height=`${t.minHeight}px`:t.maxHeight<g?(m.height=`${t.maxHeight}px`,m.overflowY="visible"):m.height=`${g}px`}function u(){e.defaultView.setTimeout(c,0)}function h(f){if(f&&f.minHeight)if(f.minHeight==="inherit")t.minHeight=a.clientHeight;else{const m=parseInt(f.minHeight,10);isNaN(m)||(t.minHeight=m)}if(f&&f.maxHeight)if(f.maxHeight==="inherit")t.maxHeight=a.clientHeight;else{const m=parseInt(f.maxHeight,10);isNaN(m)||(t.maxHeight=m)}if(f&&f.minWidth)if(f.minWidth==="inherit")t.minWidth=a.clientWidth;else{const m=parseInt(f.minWidth,10);isNaN(m)||(t.minWidth=m)}if(f&&f.maxWidth)if(f.maxWidth==="inherit")t.maxWidth=a.clientWidth;else{const m=parseInt(f.maxWidth,10);isNaN(m)||(t.maxWidth=m)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(r))}function d(f,m){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;a=f,h(m),a.nodeName==="TEXTAREA"&&(a.style.resize="none",a.style.height=`${t.minHeight}px`,a.style.minWidth=`${t.minWidth}px`,a.style.maxWidth=`${t.maxWidth}px`,a.style.overflowY="hidden"),g&&(observe(a,"input",c),observe(a,"keydown",u)),c()}return{init:d,resize:c,unObserve(){unObserve(a,"input",c),unObserve(a,"keydown",u)}}}function updateCaretPosition(e,t){const i=getCaretPosition(t),r=t.value.split(`
`);let o=i,a=0;for(let c=0;c<r.length;c++){const u=r[c];c!==0&&(a+=r[c-1].length+1);const h=a+u.length;if(e==="home"?o=a:e==="end"&&(o=h),i<=h)break}setCaretPosition(t,o)}var import_es_error_cause$91=__toESM(require_es_error_cause(),1);function _defineProperty$61(e,t,i){return(t=_toPropertyKey$62(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$62(e){var t=_toPrimitive$62(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$62(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}const EDITOR_VISIBLE_CLASS_NAME$1="ht_editor_visible",EDITOR_HIDDEN_CLASS_NAME="ht_editor_hidden",SHORTCUTS_GROUP$15="textEditor",EDITOR_TYPE$9="text";var TextEditor=class extends BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$9}constructor(e){super(e),_defineProperty$61(this,"eventManager",new eventManager_default(this)),_defineProperty$61(this,"autoResize",createInputElementResizer(this.hot.rootDocument)),_defineProperty$61(this,"TEXTAREA",void 0),_defineProperty$61(this,"textareaStyle",void 0),_defineProperty$61(this,"TEXTAREA_PARENT",void 0),_defineProperty$61(this,"textareaParentStyle",void 0),_defineProperty$61(this,"layerClass",void 0),this.eventManager=new eventManager_default(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),isThisHotChild(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,i,r,o,a){const c=this.state;if(super.prepare(e,t,i,r,o,a),!a.readOnly){this.refreshDimensions(!0);const{allowInvalid:u}=a;u&&!this.isOpened()&&(this.TEXTAREA.value=""),c!==EDITOR_STATE.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,t){this.state===EDITOR_STATE.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),setAttribute(this.TEXTAREA,[["data-hot-input",""],A11Y_TABINDEX(-1)]),addClass$1(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),addClass$1(this.TEXTAREA_PARENT,"handsontableInputHolder"),hasClass$1(this.TEXTAREA_PARENT,this.layerClass)&&removeClass$1(this.TEXTAREA_PARENT,this.layerClass),addClass$1(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){isEdge()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",removeClass$1(this.TEXTAREA_PARENT,this.layerClass),addClass$1(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;rangeEach(e.length-1,i=>{const r=e[i];if(hasClass$1(r,"handsontableEditor"))return t=!0,!1}),hasClass$1(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME)&&removeClass$1(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME),t?(this.layerClass=EDITOR_VISIBLE_CLASS_NAME$1,addClass$1(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),addClass$1(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==EDITOR_STATE.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:t,start:i,width:r,maxWidth:o,height:a,maxHeight:c}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();const u=getComputedStyle$3(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=u.fontSize,this.TEXTAREA.style.fontFamily=u.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const h=getComputedStyle$3(this.TEXTAREA),d=parseInt(h.paddingLeft,10)+parseInt(h.paddingRight,10),f=parseInt(h.paddingTop,10)+parseInt(h.paddingBottom,10),m=r-d,g=a-f,v=o-d,_=c-f;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(m,v),minHeight:Math.min(g,_),maxWidth:v,maxHeight:_},!0)}bindEvents(){isIOS()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===EDITOR_STATE.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===EDITOR_STATE.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),i={runOnlyIf:()=>isDefined(this.hot.getSelected()),group:SHORTCUTS_GROUP$15},r=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};t.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(r(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(r(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(r(),!1)},{keys:[["Home"]],callback:(o,a)=>{let[c]=a;updateCaretPosition(c,this.TEXTAREA)}},{keys:[["End"]],callback:(o,a)=>{let[c]=a;updateCaretPosition(c,this.TEXTAREA)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP$15)}},import_es_array_push$71=__toESM(require_es_array_push(),1);const RENDERER_TYPE$11="base";function baseRenderer(e,t,i,r,o,a,c){const u=c.ariaTags,h=[],d=[],f=[],m=[];c.className&&addClass$1(t,c.className),c.readOnly?(h.push(c.readOnlyCellClassName),u&&m.push(A11Y_READONLY())):u&&f.push(A11Y_READONLY()[0]),c.valid===!1&&c.invalidCellClassName?(h.push(c.invalidCellClassName),u&&m.push(A11Y_INVALID())):(d.push(c.invalidCellClassName),u&&f.push(A11Y_INVALID()[0])),c.wordWrap===!1&&c.noWordWrapClassName&&h.push(c.noWordWrapClassName),!a&&c.placeholder&&h.push(c.placeholderCellClassName),removeClass$1(t,d),addClass$1(t,h),removeAttribute(t,f),setAttribute(t,m)}baseRenderer.RENDERER_TYPE=RENDERER_TYPE$11;const RENDERER_TYPE$10="text";function textRenderer(e,t,i,r,o,a,c){baseRenderer.apply(this,[e,t,i,r,o,a,c]);let u=a;if(!u&&c.placeholder&&(u=c.placeholder),u=stringify$3(u),c.trimWhitespace&&(u=u.trim()),c.rendererTemplate){empty(t);const h=e.rootDocument.createElement("TEMPLATE");h.setAttribute("bind","{{}}"),h.innerHTML=c.rendererTemplate,HTMLTemplateElement.decorate(h),h.model=e.getSourceDataAtRow(i),t.appendChild(h)}else fastInnerText(t,u)}textRenderer.RENDERER_TYPE=RENDERER_TYPE$10;const CELL_TYPE$9="text",TextCellType={CELL_TYPE:CELL_TYPE$9,editor:TextEditor,renderer:textRenderer};_register(TextCellType),Handsontable.editors={BaseEditor};function Handsontable(e,t){const i=new Core(e,t||{},rootInstanceSymbol);return i.init(),i}Handsontable.Core=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Core(e,t,rootInstanceSymbol)},Handsontable.DefaultSettings=metaSchema_default(),Handsontable.hooks=pluginHooks_default.getSingleton(),Handsontable.CellCoords=coords_default,Handsontable.CellRange=range_default$1,Handsontable.packageName="handsontable",Handsontable.buildDate="17/10/2024 09:16:16",Handsontable.version="14.6.1",Handsontable.languages={dictionaryKeys,getLanguageDictionary,getLanguagesDictionaries,registerLanguageDictionary,getTranslatedPhrase};var base_default=Handsontable;const SHORTCUTS_GROUP$14="handsontableEditor",EDITOR_TYPE$8="handsontable";var HandsontableEditor=class extends TextEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$8}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,i,r,o,a){super.prepare(e,t,i,r,o,a);const c=this,u={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(h,d){const f=this.getSourceData(d.row,d.col);f!==void 0&&c.setValue(f),c.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&extend$2(u,a.handsontable),this.htOptions=u}beginEditing(e,t){const i=this.hot.getSettings().onBeginEditing;i&&i()===!1||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const r=this.htEditor.getValue();r!==void 0&&this.setValue(r)}super.finishEditing(e,t,i)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const i={group:SHORTCUTS_GROUP$14,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"},r=(o,a)=>{const c=this.htEditor;if(o!==void 0&&(o<0||c.flipped&&o>c.countRows()-1?c.deselectCell():c.selectCell(o,0),c.getData().length))return a.preventDefault(),stopImmediatePropagation(a),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const a=this.htEditor;let c,u;return!a.getSelectedLast()&&a.flipped?c=a.countRows()-1:a.getSelectedLast()&&(a.flipped?(u=a.getSelectedLast()[0],c=Math.max(0,u-1)):(u=a.getSelectedLast()[0],c=u-1)),r(c,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const a=this.htEditor;let c,u;if(!a.getSelectedLast()&&!a.flipped)c=0;else if(a.getSelectedLast()){if(a.flipped)c=a.getSelectedLast()[0]+1;else if(!a.flipped){const h=a.countRows()-1;u=a.getSelectedLast()[0],c=Math.min(h,u+1)}}return r(c,o)},preventDefault:!1}],i)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP$14)}},import_es_error_cause$90=__toESM(require_es_error_cause(),1),import_es_array_push$70=__toESM(require_es_array_push(),1);function _classPrivateFieldInitSpec$37(e,t,i){_checkPrivateRedeclaration$53(e,t),t.set(e,i)}function _checkPrivateRedeclaration$53(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$60(e,t,i){return(t=_toPropertyKey$61(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$61(e){var t=_toPrimitive$61(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$61(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet$37(e,t){return e.get(_assertClassBrand$53(e,t))}function _assertClassBrand$53(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const EDITOR_TYPE$7="autocomplete";var _idPrefix=new WeakMap,AutocompleteEditor=class extends HandsontableEditor{constructor(){super(...arguments),_defineProperty$60(this,"query",null),_defineProperty$60(this,"strippedChoices",[]),_defineProperty$60(this,"rawChoices",[]),_classPrivateFieldInitSpec$37(this,_idPrefix,this.hot.guid.slice(0,9)),_defineProperty$60(this,"sortByRelevance",function(e,t,i){const r=[],o=[],a=e.length;let c=t.length,u,h,d,f;if(a===0){for(d=0;d<c;d++)o.push(d);return o}for(d=0;d<c;d++){if(h=stripTags(stringify$3(t[d])),i)f=h.indexOf(e);else{const m=this.cellProperties.locale;f=h.toLocaleLowerCase(m).indexOf(e.toLocaleLowerCase(m))}f!==-1&&(u=h.length-f-a,r.push({baseIndex:d,index:f,charsLeft:u,value:h}))}for(r.sort((m,g)=>{if(g.index===-1)return-1;if(m.index===-1)return 1;if(m.index<g.index)return-1;if(g.index<m.index)return 1;if(m.index===g.index){if(m.charsLeft<g.charsLeft)return-1;if(m.charsLeft>g.charsLeft)return 1}return 0}),d=0,c=r.length;d<c;d++)o.push(r[d].baseIndex);return o})}static get EDITOR_TYPE(){return EDITOR_TYPE$7}getValue(){const e=this.rawChoices.find(t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value);return isDefined(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),addClass$1(this.htContainer,"autocompleteEditor"),addClass$1(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&setAttribute(this.TEXTAREA,[A11Y_TEXT(),A11Y_COMBOBOX(),A11Y_HASPOPUP("listbox"),A11Y_AUTOCOMPLETE()])}prepare(e,t,i,r,o,a){super.prepare(e,t,i,r,o,a),this.hot.getSettings().ariaTags&&setAttribute(this.TEXTAREA,[A11Y_EXPANDED("false"),A11Y_CONTROLS(`${_classPrivateFieldGet$37(_idPrefix,this)}-listbox-${e}-${t}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,t=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,r=i?.length,{row:o,col:a}=this;this.showEditableElement(),this.focus();let c=getScrollbarWidth();c===0&&isMacOS()&&(c+=15),this.addHook("beforeKeyDown",u=>this.onBeforeKeyDown(u)),this.htEditor.updateSettings({colWidths:e?[outerWidth(this.TEXTAREA)-2]:void 0,width:e?outerWidth(this.TEXTAREA)+c:void 0,autoColumnSize:!0,renderer:(u,h,d,f,m,g,v)=>{textRenderer(u,h,d,f,m,g,v);const{filteringCaseSensitive:_,allowHtml:b,locale:S}=this.cellProperties,T=this.query;let A=stringify$3(g),I,R;A&&!b&&(I=_===!0?A.indexOf(T):A.toLocaleLowerCase(S).indexOf(T.toLocaleLowerCase(S)),I!==-1&&(R=A.substr(I,T.length),A=A.replace(R,`<strong>${R}</strong>`))),t&&setAttribute(h,[A11Y_OPTION(),...i?[A11Y_SETSIZE(r)]:[],...i?[A11Y_POSINSET(i.indexOf(g)+1)]:[],["id",`${this.htEditor.rootElement.id}_${d}-${f}`]]),h.innerHTML=A},afterSelectionEnd:(u,h)=>{if(t){const d=this.htEditor.getCell(u,h,!0);setAttribute(d,[A11Y_SELECTED()]),setAttribute(this.TEXTAREA,...A11Y_ACTIVEDESCENDANT(d.id))}}}),t&&(setAttribute(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...A11Y_PRESENTATION()),setAttribute(this.htEditor.rootElement,[A11Y_LISTBOX(),A11Y_LIVE("polite"),A11Y_RELEVANT("text"),["id",`${_classPrivateFieldGet$37(_idPrefix,this)}-listbox-${o}-${a}`]]),setAttribute(this.TEXTAREA,...A11Y_EXPANDED("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&setAttribute(this.TEXTAREA,[A11Y_EXPANDED("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,typeof t=="function"?t.call(this.cellProperties,e,i=>{this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=getCaretPosition(this.TEXTAREA),i=getSelectionEndPosition(this.TEXTAREA),r=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let a=null,c=null,u=e;r&&(a=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),u,this.cellProperties.filteringCaseSensitive));const h=Array.isArray(a)?a.length:0;if(o===!1)h&&(c=a[0]);else{const d=[];for(let f=0,m=u.length;f<m&&!(r&&h<=f);f++)h?d.push(u[a[f]]):d.push(u[f]);c=0,u=d}this.strippedChoices=u,u.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(pivot([u])),u.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(c)),this.hot.listen(),setCaretPosition(this.TEXTAREA,t,t===i?void 0:i)}flipDropdownIfNeeded(){const e=getTrimmingContainer(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,i=this.cellProperties.preventOverflow;if(t||!t&&(i||i==="horizontal"))return!1;const r=offset$2(this.TEXTAREA),o=outerHeight(this.TEXTAREA),a=this.getDropdownHeight(),c=e.scrollTop,u=outerHeight(this.hot.view._wt.wtTable.THEAD),h=offset$2(e),d=r.top-h.top-u+c,f=e.scrollHeight-d-u-o,m=a>f&&d>f;return m?this.flipDropdown(a):this.unflipDropdown(),this.limitDropdownIfNeeded(m?d:f,a),m}limitDropdownIfNeeded(e,t){if(t>e){let i=0,r=0,o=0,a=null;do o=this.htEditor.getRowHeight(r)||this.htEditor.view._wt.getSetting("defaultRowHeight"),i+=o,r+=1;while(i<e);a=i-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+t-a}px`),this.setDropdownHeight(i-o)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){const e=this.htEditor.getColWidth(0)+getScrollbarWidth(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,i=arrayMap$1(e,o=>stringify$3(o));return arrayMap$1(i,o=>t?o:stripTags(o))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),i={row:t?t.from.row:-1};let r=!1;return e===KEY_CODES.ARROW_DOWN&&i.row>0&&i.row<this.htEditor.countRows()-1&&(r=!0),e===KEY_CODES.ARROW_UP&&i.row>-1&&(r=!0),r}onBeforeKeyDown(e){if(isPrintableChar(e.keyCode)||e.keyCode===KEY_CODES.BACKSPACE||e.keyCode===KEY_CODES.DELETE||e.keyCode===KEY_CODES.INSERT){let t=10;if(e.keyCode===KEY_CODES.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(t+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},t)}}};const EDITOR_TYPE$6="checkbox";var CheckboxEditor=class extends BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$6}beginEditing(e,t){if(t&&t.type==="mouseup"&&t.target.nodeName==="TD"){const i=this.TD.querySelector('input[type="checkbox"]');hasClass$1(i,"htBadValue")||i.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}};/*!
* Pikaday
*
* Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
*/const getWindow$2=()=>window,getDocument=()=>window.document,sto=(e,t)=>window.setTimeout(e,t),addEvent=function(e,t,i,r){e.addEventListener(t,i,!!r)},removeEvent=function(e,t,i,r){e.removeEventListener(t,i,!!r)},trim=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},hasClass=function(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")!==-1},addClass=function(e,t){hasClass(e,t)||(e.className=e.className===""?t:e.className+" "+t)},removeClass=function(e,t){e.className=trim((" "+e.className+" ").replace(" "+t+" "," "))},isArray$1=function(e){return/Array/.test(Object.prototype.toString.call(e))},isDate$2=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},isWeekend=function(e){let t=e.getDay();return t===0||t===6},isLeapYear$1=function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth=function(e,t){return[31,isLeapYear$1(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},setToStartOfDay=function(e){isDate$2(e)&&e.setHours(0,0,0,0)},compareDates=function(e,t){return e.getTime()===t.getTime()},extend$1=function(e,t,i){let r,o;for(r in t)o=e[r]!==void 0,o&&typeof t[r]=="object"&&t[r]!==null&&t[r].nodeName===void 0?isDate$2(t[r])?i&&(e[r]=new Date(t[r].getTime())):isArray$1(t[r])?i&&(e[r]=t[r].slice(0)):e[r]=extend$1({},t[r],i):(i||!o)&&(e[r]=t[r]);return e},fireEvent=function(e,t,i){let r=getDocument().createEvent("HTMLEvents");r.initEvent(t,!0,!1),r=extend$1(r,i),e.dispatchEvent(r)},adjustCalendar=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e},defaults$1={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},renderDayName=function(e,t,i){for(t+=e.firstDay;t>=7;)t-=7;return i?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},renderDay=function(e){let t=[],i="false";if(e.isEmpty)if(e.showDaysInNextAndPreviousMonths)t.push("is-outside-current-month"),e.enableSelectionDaysInNextAndPreviousMonths||t.push("is-selection-disabled");else return'<td class="is-empty"></td>';return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),i="true"),e.hasEvent&&t.push("has-event"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+i+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"},isoWeek=function(e,t){e.setHours(0,0,0,0);let i=e.getDate(),r=e.getDay(),o=t,a=o-1,c=7,u=function(g){return(g+c-1)%c};e.setDate(i+a-u(r));let h=new Date(e.getFullYear(),0,o),d=864e5,f=(e.getTime()-h.getTime())/d;return 1+Math.round((f-a+u(h.getDay()))/c)},renderWeek=function(e,t,i,r,o){let a=new Date(r,i,t);return'<td class="pika-week">'+(e.hasMoment?e.moment(a).isoWeek():isoWeek(a,o))+"</td>"},renderRow=function(e,t,i,r){return'<tr class="pika-row'+(i?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(t?e.reverse():e).join("")+"</tr>"},renderBody=function(e){return"<tbody>"+e.join("")+"</tbody>"},renderHead=function(e){let t,i=[];for(e.showWeekNumber&&i.push("<th></th>"),t=0;t<7;t++)i.push('<th scope="col"><abbr title="'+renderDayName(e,t)+'">'+renderDayName(e,t,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?i.reverse():i).join("")+"</tr></thead>"},renderTitle=function(e,t,i,r,o,a){let c,u,h,d=e._o,f=i===d.minYear,m=i===d.maxYear,g='<div id="'+a+'" class="pika-title" role="heading" aria-live="polite">',v,_,b=!0,S=!0;for(h=[],c=0;c<12;c++)h.push('<option value="'+(i===o?c-t:12+c-t)+'"'+(c===r?' selected="selected"':"")+(f&&c<d.minMonth||m&&c>d.maxMonth?' disabled="disabled"':"")+">"+d.i18n.months[c]+"</option>");for(v='<div class="pika-label">'+d.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+h.join("")+"</select></div>",isArray$1(d.yearRange)?(c=d.yearRange[0],u=d.yearRange[1]+1):(c=i-d.yearRange,u=1+i+d.yearRange),h=[];c<u&&c<=d.maxYear;c++)c>=d.minYear&&h.push('<option value="'+c+'"'+(c===i?' selected="selected"':"")+">"+c+"</option>");return _='<div class="pika-label">'+i+d.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+h.join("")+"</select></div>",d.showMonthAfterYear?g+=_+v:g+=v+_,f&&(r===0||d.minMonth>=r)&&(b=!1),m&&(r===11||d.maxMonth<=r)&&(S=!1),t===0&&(g+='<button class="pika-prev'+(b?"":" is-disabled")+'" type="button">'+d.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(g+='<button class="pika-next'+(S?"":" is-disabled")+'" type="button">'+d.i18n.nextMonth+"</button>"),g+="</div>"},renderTable=function(e,t,i){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+i+'">'+renderHead(e)+renderBody(t)+"</table>"};function Pikaday(e){let t=this,i=t.config(e);t._onMouseDown=function(o){if(!t._v)return;o=o||getWindow$2().event;let a=o.target||o.srcElement;if(a)if(hasClass(a,"is-disabled")||(hasClass(a,"pika-button")&&!hasClass(a,"is-empty")&&!hasClass(a.parentNode,"is-disabled")?(t.setDate(new Date(a.getAttribute("data-pika-year"),a.getAttribute("data-pika-month"),a.getAttribute("data-pika-day"))),i.bound&&sto(function(){t.hide(),i.blurFieldOnSelect&&i.field&&i.field.blur()},100)):hasClass(a,"pika-prev")?t.prevMonth():hasClass(a,"pika-next")&&t.nextMonth()),hasClass(a,"pika-select"))t._c=!0;else if(o.preventDefault)o.preventDefault();else return o.returnValue=!1,!1},t._onChange=function(o){o=o||getWindow$2().event;let a=o.target||o.srcElement;a&&(hasClass(a,"pika-select-month")?t.gotoMonth(a.value):hasClass(a,"pika-select-year")&&t.gotoYear(a.value))},t._onKeyChange=function(o){if(o=o||getWindow$2().event,t.isVisible())switch(o.keyCode){case 13:case 27:i.field&&i.field.blur();break;case 37:t.adjustDate("subtract",1);break;case 38:t.adjustDate("subtract",7);break;case 39:t.adjustDate("add",1);break;case 40:t.adjustDate("add",7);break;case 8:case 46:t.setDate(null);break}},t._parseFieldValue=function(){if(i.parse)return i.parse(i.field.value,i.format);if(this.hasMoment){let o=this.moment(i.field.value,i.format,i.formatStrict);return o&&o.isValid()?o.toDate():null}else return new Date(Date.parse(i.field.value))},t._onInputChange=function(o){let a;o.firedBy!==t&&(a=t._parseFieldValue(),isDate$2(a)&&t.setDate(a),t._v||t.show())},t._onInputFocus=function(){t.show()},t._onInputClick=function(){t.show()},t._onInputBlur=function(){let o=getDocument().activeElement;do if(hasClass(o,"pika-single"))return;while(o=o.parentNode);t._c||(t._b=sto(function(){t.hide()},50)),t._c=!1},t._onClick=function(o){o=o||getWindow$2().event;let a=o.target||o.srcElement,c=a;if(a){!hasEventListeners&&hasClass(a,"pika-select")&&(a.onchange||(a.setAttribute("onchange","return;"),addEvent(a,"change",t._onChange)));do if(hasClass(c,"pika-single")||c===i.trigger)return;while(c=c.parentNode);t._v&&a!==i.trigger&&c!==i.trigger&&t.hide()}},t.el=getDocument().createElement("div"),t.el.className="pika-single"+(i.isRTL?" is-rtl":"")+(i.theme?" "+i.theme:""),addEvent(t.el,"mousedown",t._onMouseDown,!0),addEvent(t.el,"touchend",t._onMouseDown,!0),addEvent(t.el,"change",t._onChange),i.keyboardInput&&addEvent(getDocument(),"keydown",t._onKeyChange),i.field&&(i.container?i.container.appendChild(t.el):i.bound?getDocument().body.appendChild(t.el):i.field.parentNode.insertBefore(t.el,i.field.nextSibling),addEvent(i.field,"change",t._onInputChange),i.defaultDate||(i.defaultDate=t._parseFieldValue(),i.setDefaultDate=!0));let r=i.defaultDate;isDate$2(r)?i.setDefaultDate?t.setDate(r,!0):t.gotoDate(r):t.gotoDate(new Date),i.bound?(this.hide(),t.el.className+=" is-bound",addEvent(i.trigger,"click",t._onInputClick),addEvent(i.trigger,"focus",t._onInputFocus),addEvent(i.trigger,"blur",t._onInputBlur)):this.show()}Pikaday.prototype={config:function(e){this._o||(this._o=extend$1({},defaults$1,!0));let t=extend$1(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme=typeof t.theme=="string"&&t.theme?t.theme:null,t.bound=!!(t.bound!==void 0?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn=typeof t.disableDayFn=="function"?t.disableDayFn:null;let i=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=i>4?4:i,isDate$2(t.minDate)||(t.minDate=!1),isDate$2(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),isArray$1(t.yearRange)){let r=new Date().getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||r,t.yearRange[1]=parseInt(t.yearRange[1],10)||r}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||defaults$1.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(e){return e=e||this._o.format,isDate$2(this._d)?this._o.toString?this._o.toString(this._d,e):this.hasMoment?this.moment(this._d).format(e):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(e,t){this.hasMoment&&this.moment.isMoment(e)&&this.setDate(e.toDate(),t)},useMoment:function(e){this.hasMoment=!0,this.moment=e},getDate:function(){return isDate$2(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",fireEvent(this._o.field,"change",{firedBy:this})),this.draw();if(typeof e=="string"&&(e=new Date(Date.parse(e))),!isDate$2(e))return;let i=this._o.minDate,r=this._o.maxDate;isDate$2(i)&&e<i?e=i:isDate$2(r)&&e>r&&(e=r),this._d=new Date(e.getTime()),setToStartOfDay(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),fireEvent(this._o.field,"change",{firedBy:this})),!t&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(e){let t=!0;if(isDate$2(e)){if(this.calendars){let i=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),o=e.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),t=o<i.getTime()||r.getTime()<o}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(e,t){let i=this.getDate()||new Date,r=parseInt(t)*24*60*60*1e3,o;e==="add"?o=new Date(i.valueOf()+r):e==="subtract"&&(o=new Date(i.valueOf()-r)),this.setDate(o)},adjustCalendars:function(){this.calendars[0]=adjustCalendar(this.calendars[0]);for(let e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=adjustCalendar({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(setToStartOfDay(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=defaults$1.minDate,this._o.minYear=defaults$1.minYear,this._o.minMonth=defaults$1.minMonth,this._o.startRange=defaults$1.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(setToStartOfDay(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=defaults$1.maxDate,this._o.maxYear=defaults$1.maxYear,this._o.maxMonth=defaults$1.maxMonth,this._o.endRange=defaults$1.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(!this._v&&!e)return;let t=this._o,i=t.minYear,r=t.maxYear,o=t.minMonth,a=t.maxMonth,c="",u;this._y<=i&&(this._y=i,!isNaN(o)&&this._m<o&&(this._m=o)),this._y>=r&&(this._y=r,!isNaN(a)&&this._m>a&&(this._m=a));for(let h=0;h<t.numberOfMonths;h++)u="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),c+='<div class="pika-lendar">'+renderTitle(this,h,this.calendars[h].year,this.calendars[h].month,this.calendars[0].year,u)+this.render(this.calendars[h].year,this.calendars[h].month,u)+"</div>";this.el.innerHTML=c,t.bound&&t.field.type!=="hidden"&&sto(function(){t.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),t.bound&&t.field.setAttribute("aria-label",t.ariaLabel)},adjustPosition:function(){let e,t,i,r,o,a,c,u,h,d,f;this._o.container||(this.el.style.position="absolute",e=this._o.trigger,t=this.el.offsetWidth,i=this.el.offsetHeight,r=getWindow$2().innerWidth||getDocument().documentElement.clientWidth,o=getWindow$2().innerHeight||getDocument().documentElement.clientHeight,a=getDocument().body.scrollTop||getDocument().documentElement.scrollTop,d=!0,f=!0,h=e.getBoundingClientRect(),c=h.left+getWindow$2().pageXOffset,u=h.bottom+getWindow$2().pageYOffset,(this._o.reposition&&c+t>r||this._o.position.indexOf("right")>-1&&c-t+e.offsetWidth>0)&&(c=c-t+e.offsetWidth,d=!1),(this._o.reposition&&u+i>o+a||this._o.position.indexOf("top")>-1&&u-i-e.offsetHeight>0)&&(u=u-i-e.offsetHeight,f=!1),c<0&&(c=0),u<0&&(u=0),this.el.style.left=c+"px",this.el.style.top=u+"px",addClass(this.el,d?"left-aligned":"right-aligned"),addClass(this.el,f?"bottom-aligned":"top-aligned"),removeClass(this.el,d?"right-aligned":"left-aligned"),removeClass(this.el,f?"top-aligned":"bottom-aligned"))},render:function(e,t,i){let r=this._o,o=new Date,a=getDaysInMonth(e,t),c=new Date(e,t,1).getDay(),u=[],h=[];setToStartOfDay(o),r.firstDay>0&&(c-=r.firstDay,c<0&&(c+=7));let d=t===0?11:t-1,f=t===11?0:t+1,m=t===0?e-1:e,g=t===11?e+1:e,v=getDaysInMonth(m,d),_=a+c,b=_;for(;b>7;)b-=7;_+=7-b;let S=!1;for(let T=0,A=0;T<_;T++){let I=new Date(e,t,1+(T-c)),R=isDate$2(this._d)?compareDates(I,this._d):!1,O=compareDates(I,o),P=r.events.indexOf(I.toDateString())!==-1,L=T<c||T>=a+c,V=1+(T-c),U=t,$=e,Z=r.startRange&&compareDates(r.startRange,I),ie=r.endRange&&compareDates(r.endRange,I),ue=r.startRange&&r.endRange&&r.startRange<I&&I<r.endRange,_e=r.minDate&&I<r.minDate||r.maxDate&&I>r.maxDate||r.disableWeekends&&isWeekend(I)||r.disableDayFn&&r.disableDayFn(I);L&&(T<c?(V=v+V,U=d,$=m):(V=V-a,U=f,$=g));let Ee={day:V,month:U,year:$,hasEvent:P,isSelected:R,isToday:O,isDisabled:_e,isEmpty:L,isStartRange:Z,isEndRange:ie,isInRange:ue,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&R&&(S=!0),h.push(renderDay(Ee)),++A===7&&(r.showWeekNumber&&h.unshift(renderWeek(this,T-c,t,e,r.firstWeekOfYearMinDays)),u.push(renderRow(h,r.isRTL,r.pickWholeWeek,S)),h=[],A=0,S=!1)}return renderTable(r,u,i)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),removeClass(this.el,"is-hidden"),this._o.bound&&(addEvent(getDocument(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let e=this._v;e!==!1&&(this._o.bound&&removeEvent(getDocument(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),addClass(this.el,"is-hidden"),this._v=!1,e!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let e=this._o;this.hide(),removeEvent(this.el,"mousedown",this._onMouseDown,!0),removeEvent(this.el,"touchend",this._onMouseDown,!0),removeEvent(this.el,"change",this._onChange),e.keyboardInput&&removeEvent(getDocument(),"keydown",this._onKeyChange),e.field&&(removeEvent(e.field,"change",this._onInputChange),e.bound&&(removeEvent(e.trigger,"click",this._onInputClick),removeEvent(e.trigger,"focus",this._onInputFocus),removeEvent(e.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};var import_es_error_cause$89=__toESM(require_es_error_cause(),1),import_moment$9=__toESM(require_moment(),1);function _defineProperty$59(e,t,i){return(t=_toPropertyKey$60(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$60(e){var t=_toPrimitive$60(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$60(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}const EDITOR_TYPE$5="date",SHORTCUTS_GROUP_EDITOR="dateEditor";var DateEditor=class extends TextEditor{constructor(){super(...arguments),_defineProperty$59(this,"defaultDateFormat","DD/MM/YYYY"),_defineProperty$59(this,"parentDestroyed",!1),_defineProperty$59(this,"$datePicker",null)}static get EDITOR_TYPE(){return EDITOR_TYPE$5}init(){if(typeof import_moment$9.default!="function")throw new Error("You need to include moment.js to your project.");if(typeof Pikaday!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),addClass$1(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{hasClass$1(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,i,r,o,a){super.prepare(e,t,i,r,o,a)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const i=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),i.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:SHORTCUTS_GROUP_EDITOR})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const r=this.hot._getEditorManager();r.closeEditor(),this.hot.view.render(),r.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP_EDITOR),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,t)}showDatepicker(e){const t=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),r=e?isFunctionKey(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new Pikaday(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(import_moment$9.default),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,(0,import_moment$9.default)(o,t,!0).isValid()&&this.$datePicker.setMoment((0,import_moment$9.default)(o,t),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!r&&!i&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,(0,import_moment$9.default)(o,t,!0).isValid()&&this.$datePicker.setMoment((0,import_moment$9.default)(o,t),!0),!r&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,t={};this.cellProperties&&this.cellProperties.datePickerConfig&&deepExtend(t,this.cellProperties.datePickerConfig);const i=t.onSelect,r=t.onClose;return t.field=e,t.trigger=e,t.container=this.datePicker,t.bound=!1,t.keyboardInput=!1,t.format=t.format||this.defaultDateFormat,t.reposition=t.reposition||!1,t.isRTL=!1,t.onSelect=o=>{let a=o;isNaN(a.getTime())||(a=(0,import_moment$9.default)(a).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(a),i&&i()},t.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),r&&r()},t}refreshDimensions(e){var t;if(super.refreshDimensions(e),this.state!==EDITOR_STATE.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:i,columnIndexMapper:r}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:a}=(t=o.getParentOverlay(this.TD))!==null&&t!==void 0?t:this.hot.view._wt,c=i.getVisualFromRenderableIndex(a.getFirstPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(a.getLastPartiallyVisibleRow()),h=r.getVisualFromRenderableIndex(a.getFirstPartiallyVisibleColumn()),d=r.getVisualFromRenderableIndex(a.getLastPartiallyVisibleColumn());if(this.row>=c&&this.row<=u&&this.col>=h&&this.col<=d){const f=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+f.top+outerHeight(this.TD)}px`;let m=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?m+=f.right-outerWidth(this.datePicker):m+=f.left,this.datePickerStyle.left=`${m}px`}else this.hideDatepicker()}};const EDITOR_TYPE$4="dropdown";var DropdownEditor=class extends AutocompleteEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$4}prepare(e,t,i,r,o,a){super.prepare(e,t,i,r,o,a),this.cellProperties.filter=!1,this.cellProperties.strict=!0}};pluginHooks_default.getSingleton().add("beforeValidate",function(e,t,i){const r=this.propToCol(i);if(Number.isInteger(r)){const o=this.getCellMeta(t,r);o.editor===DropdownEditor&&o.strict===void 0&&(o.filter=!1,o.strict=!0)}});const EDITOR_TYPE$3="numeric";var NumericEditor=class extends TextEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$3}};const EDITOR_TYPE$2="password";var PasswordEditor=class extends TextEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$2}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,empty(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}};const EDITOR_VISIBLE_CLASS_NAME="ht_editor_visible",SHORTCUTS_GROUP$13="selectEditor",EDITOR_TYPE$1="select";var SelectEditor=class extends BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$1}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",addClass$1(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",hasClass$1(this.select,EDITOR_VISIBLE_CLASS_NAME)&&removeClass$1(this.select,EDITOR_VISIBLE_CLASS_NAME),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,i,r,o,a){super.prepare(e,t,i,r,o,a);const c=this.cellProperties.selectOptions;let u;typeof c=="function"?u=this.prepareOptions(c(this.row,this.col,this.prop)):u=this.prepareOptions(c),empty(this.select),objectEach(u,(h,d)=>{const f=this.hot.rootDocument.createElement("OPTION");f.value=d,fastInnerHTML(f,h),this.select.appendChild(f)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let i=0,r=e.length;i<r;i++)t[e[i]]=e[i];else typeof e=="object"&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==EDITOR_STATE.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:t,width:i,height:r}=this.getEditedCellRect(),o=this.select.style;o.height=`${r}px`,o.width=`${i}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${t}px`,o.margin="0px",addClass$1(this.select,EDITOR_VISIBLE_CLASS_NAME)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),i={group:SHORTCUTS_GROUP$13};this.isInFullEditMode()&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const r=this.select.selectedIndex-1;r>=0&&(this.select[r].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const r=this.select.selectedIndex+1;r<=this.select.length-1&&(this.select[r].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP$13)}};const EDITOR_TYPE="time";var TimeEditor=class extends TextEditor{static get EDITOR_TYPE(){return EDITOR_TYPE}prepare(e,t,i,r,o,a){super.prepare(e,t,i,r,o,a),this.TEXTAREA.dir="ltr"}};function registerAllEditors(){_register$3(BaseEditor),_register$3(AutocompleteEditor),_register$3(CheckboxEditor),_register$3(DateEditor),_register$3(DropdownEditor),_register$3(HandsontableEditor),_register$3(NumericEditor),_register$3(PasswordEditor),_register$3(SelectEditor),_register$3(TextEditor),_register$3(TimeEditor)}const RENDERER_TYPE$9="html";function htmlRenderer(e,t,i,r,o,a,c){baseRenderer.apply(this,[e,t,i,r,o,a,c]),fastInnerHTML(t,a??"",!1)}htmlRenderer.RENDERER_TYPE=RENDERER_TYPE$9;const RENDERER_TYPE$8="autocomplete";function autocompleteRenderer(e,t,i,r,o,a,c){const{rootDocument:u}=e,h=c.allowHtml?htmlRenderer:textRenderer,d=u.createElement("DIV"),f=e.getSettings().ariaTags;if(d.className="htAutocompleteArrow",f&&d.setAttribute(...A11Y_HIDDEN()),d.appendChild(u.createTextNode("\u25BC")),h.apply(this,[e,t,i,r,o,a,c]),t.firstChild||t.appendChild(u.createTextNode("\xA0")),t.insertBefore(d,t.firstChild),addClass$1(t,"htAutocomplete"),!e.acArrowListener){const m=new eventManager_default(e);e.acArrowListener=function(g){hasClass$1(g.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(i,r),t)},m.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",()=>{m.destroy()})}}autocompleteRenderer.RENDERER_TYPE=RENDERER_TYPE$8;const RENDERER_TYPE$7="dropdown";function dropdownRenderer(e,t,i,r,o,a,c){autocompleteRenderer.apply(this,[e,t,i,r,o,a,c])}dropdownRenderer.RENDERER_TYPE=RENDERER_TYPE$7;var import_es_array_push$69=__toESM(require_es_array_push(),1);const isListeningKeyDownEvent=new WeakMap,isCheckboxListenerAdded=new WeakMap,BAD_VALUE_CLASS="htBadValue",ATTR_ROW="data-row",ATTR_COLUMN="data-col",SHORTCUTS_GROUP$12="checkboxRenderer",RENDERER_TYPE$6="checkbox";pluginHooks_default.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,i){const{label:r,type:o,row:a,column:c,prop:u}=t;if(o===RENDERER_TYPE$6){if(r){const{value:h,property:d}=r;let f=i;if(h)f=typeof h=="function"?h(a,c,u,i):h;else if(d){const m=this.getDataAtRowProp(a,d);f=m!==null?m:i}e=f}return e}});function checkboxRenderer(e,t,i,r,o,a,c){const{rootDocument:u}=e,h=e.getSettings().ariaTags;baseRenderer.apply(this,[e,t,i,r,o,a,c]),registerEvents(e);let d=createInput(u);const f=c.label;let m=!1;if(typeof c.checkedTemplate>"u"&&(c.checkedTemplate=!0),typeof c.uncheckedTemplate>"u"&&(c.uncheckedTemplate=!1),empty(t),a===c.checkedTemplate||stringify$3(a).toLocaleLowerCase(c.locale)===stringify$3(c.checkedTemplate).toLocaleLowerCase(c.locale)?d.checked=!0:a===c.uncheckedTemplate||stringify$3(a).toLocaleLowerCase(c.locale)===stringify$3(c.uncheckedTemplate).toLocaleLowerCase(c.locale)?d.checked=!1:isEmpty(a)?addClass$1(d,"noValue"):(d.style.display="none",addClass$1(d,BAD_VALUE_CLASS),m=!0),setAttribute(d,[[ATTR_ROW,i],[ATTR_COLUMN,r]]),h&&setAttribute(d,[A11Y_LABEL(d.checked?e.getTranslatedPhrase(CHECKBOX_CHECKED):e.getTranslatedPhrase(CHECKBOX_UNCHECKED)),A11Y_CHECKED(d.checked),A11Y_CHECKBOX()]),!m&&f){let b="";if(f.value)b=typeof f.value=="function"?f.value.call(this,i,r,o,a):f.value;else if(f.property){const T=e.getDataAtRowProp(i,f.property);b=T!==null?T:""}const S=createLabel(u,b,f.separated!==!0);f.position==="before"?f.separated?(t.appendChild(S),t.appendChild(d)):(S.appendChild(d),d=S):(!f.position||f.position==="after")&&(f.separated?(t.appendChild(d),t.appendChild(S)):(S.insertBefore(d,S.firstChild),d=S))}(!f||f&&!f.separated)&&t.appendChild(d),m&&t.appendChild(u.createTextNode("#bad-value#")),isListeningKeyDownEvent.has(e)||(isListeningKeyDownEvent.set(e,!0),g());function g(){const S=e.getShortcutManager().getContext("grid"),T={group:SHORTCUTS_GROUP$12,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"};S.addShortcuts([{keys:[["space"]],callback:()=>(v(),!_()),runOnlyIf:()=>{var A;return(A=e.getSelectedRangeLast())===null||A===void 0?void 0:A.highlight.isCell()}},{keys:[["enter"]],callback:()=>(v(),!_()),runOnlyIf:()=>{const A=e.getSelectedRangeLast();return e.getSettings().enterBeginsEditing&&A?.isSingle()&&A.highlight.isCell()}},{keys:[["delete"],["backspace"]],callback:()=>(v(!0),!_()),runOnlyIf:()=>{var A;return(A=e.getSelectedRangeLast())===null||A===void 0?void 0:A.highlight.isCell()}}],T)}function v(){let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const S=e.getSelectedRange(),T=[],A=new Map;let I=[],R=0;if(S){for(let O=0;O<S.length;O++){const{row:P,col:L}=S[O].getTopStartCorner(),{row:V,col:U}=S[O].getBottomEndCorner();for(let $=P;$<=V;$+=1)for(let Z=L;Z<=U;Z+=1){const ie=e.getCellMeta($,Z),ue={checkedTemplate:ie.checkedTemplate,uncheckedTemplate:ie.uncheckedTemplate};if(ie.type!=="checkbox"){b===!0&&!ie.readOnly&&(A.has(T.length)?A.set(T.length,[...A.get(T.length),[$,Z,null]]):A.set(T.length,[[$,Z,null]]));continue}if(ie.readOnly===!0)continue;typeof ie.checkedTemplate>"u"&&(ie.checkedTemplate=!0),typeof ie.uncheckedTemplate>"u"&&(ie.uncheckedTemplate=!1);const _e=e.getDataAtCell($,Z);b===!1?[ie.checkedTemplate,ie.checkedTemplate.toString()].includes(_e)?I.push([$,Z,ie.uncheckedTemplate,ue]):[ie.uncheckedTemplate,ie.uncheckedTemplate.toString(),null,void 0].includes(_e)&&I.push([$,Z,ie.checkedTemplate,ue]):I.push([$,Z,ie.uncheckedTemplate,ue]),R+=1}T.push(R),R=0}I.every(O=>{let[,,P]=O;return P===I[0][2]})?I=I.map(O=>{let[P,L,V]=O;return[P,L,V]}):I=I.map(O=>{let[P,L,,V]=O;return[P,L,V.checkedTemplate]}),I.length>0&&T.forEach((O,P)=>{let L=I.splice(0,O);A.size&&A.has(P)&&(L=[...L,...A.get(P)]),e.setDataAtCell(L)})}}function _(){const b=e.getSelectedRange();if(b){for(let S=0;S<b.length;S++){const T=b[S].getTopStartCorner(),A=b[S].getBottomEndCorner();for(let I=T.row;I<=A.row;I++)for(let R=T.col;R<=A.col;R++){const O=e.getCellMeta(I,R),P=e.getCell(I,R);if(P==null)return!0;if(P.querySelectorAll("input[type=checkbox]").length>0&&!O.readOnly)return!0}}return!1}}}checkboxRenderer.RENDERER_TYPE=RENDERER_TYPE$6;function registerEvents(e){let t=isCheckboxListenerAdded.get(e);if(!t){const{rootElement:i}=e;t=new eventManager_default(e),t.addEventListener(i,"click",r=>onClick(r,e)),t.addEventListener(i,"mouseup",r=>onMouseUp(r,e)),t.addEventListener(i,"change",r=>onChange(r,e)),isCheckboxListenerAdded.set(e,t)}return t}function createInput(e){const t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function createLabel(e,t,i){const r=e.createElement("label");return r.className=`htCheckboxRendererLabel ${i?"fullWidth":""}`,r.appendChild(e.createTextNode(t)),r.cloneNode(!0)}function onMouseUp(e,t){const{target:i}=e;isCheckboxInput(i)&&(!i.hasAttribute(ATTR_ROW)||!i.hasAttribute(ATTR_COLUMN)||setTimeout(t.listen,10))}function onClick(e,t){const{target:i}=e;if(!isCheckboxInput(i)||!i.hasAttribute(ATTR_ROW)||!i.hasAttribute(ATTR_COLUMN))return;const r=parseInt(i.getAttribute(ATTR_ROW),10),o=parseInt(i.getAttribute(ATTR_COLUMN),10);t.getCellMeta(r,o).readOnly&&e.preventDefault()}function onChange(e,t){const{target:i}=e;if(!isCheckboxInput(i)||!i.hasAttribute(ATTR_ROW)||!i.hasAttribute(ATTR_COLUMN))return;const r=parseInt(i.getAttribute(ATTR_ROW),10),o=parseInt(i.getAttribute(ATTR_COLUMN),10),a=t.getCellMeta(r,o);if(!a.readOnly){let c=null;e.target.checked?c=a.uncheckedTemplate===void 0?!0:a.checkedTemplate:c=a.uncheckedTemplate===void 0?!1:a.uncheckedTemplate,t.setDataAtCell(r,o,c)}}function isCheckboxInput(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}const RENDERER_TYPE$5="handsontable";function handsontableRenderer(e,t,i,r,o,a,c){autocompleteRenderer.apply(this,[e,t,i,r,o,a,c])}handsontableRenderer.RENDERER_TYPE=RENDERER_TYPE$5;var require_numbro_min=__commonJS({"node_modules/.pnpm/numbro@2.1.2/node_modules/numbro/dist/numbro.min.js"(e,t){(function(i){typeof e=="object"&&typeof t<"u"?t.exports=i():typeof define=="function"&&define.amd?define([],i):(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this).numbro=i()})(function(){return function i(r,o,a){function c(d,f){if(!o[d]){if(!r[d]){var m=typeof require=="function"&&require;if(!f&&m)return m(d,!0);if(u)return u(d,!0);var g=new Error("Cannot find module '"+d+"'");throw g.code="MODULE_NOT_FOUND",g}var v=o[d]={exports:{}};r[d][0].call(v.exports,function(_){return c(r[d][1][_]||_)},v,v.exports,i,r,o,a)}return o[d].exports}for(var u=typeof require=="function"&&require,h=0;h<a.length;h++)c(a[h]);return c}({1:[function(i,r,o){(function(a){"use strict";var c,u=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,h=Math.ceil,d=Math.floor,f="[BigNumber Error] ",m=f+"Number primitive has more than 15 significant digits: ",g=1e14,v=14,_=9007199254740991,b=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],S=1e7,T=1e9;function A(U){var $=0|U;return 0<U||U===$?$:$-1}function I(U){for(var $,Z,ie=1,ue=U.length,_e=U[0]+"";ie<ue;){for($=U[ie++]+"",Z=v-$.length;Z--;$="0"+$);_e+=$}for(ue=_e.length;_e.charCodeAt(--ue)===48;);return _e.slice(0,ue+1||1)}function R(U,$){var Z,ie,ue=U.c,_e=$.c,Ee=U.s,pe=$.s,me=U.e,Se=$.e;if(!Ee||!pe)return null;if(Z=ue&&!ue[0],ie=_e&&!_e[0],Z||ie)return Z?ie?0:-pe:Ee;if(Ee!=pe)return Ee;if(Z=Ee<0,ie=me==Se,!ue||!_e)return ie?0:!ue^Z?1:-1;if(!ie)return Se<me^Z?1:-1;for(pe=(me=ue.length)<(Se=_e.length)?me:Se,Ee=0;Ee<pe;Ee++)if(ue[Ee]!=_e[Ee])return ue[Ee]>_e[Ee]^Z?1:-1;return me==Se?0:Se<me^Z?1:-1}function O(U,$,Z,ie){if(U<$||Z<U||U!==(U<0?h(U):d(U)))throw Error(f+(ie||"Argument")+(typeof U=="number"?U<$||Z<U?" out of range: ":" not an integer: ":" not a primitive number: ")+String(U))}function P(U){var $=U.c.length-1;return A(U.e/v)==$&&U.c[$]%2!=0}function L(U,$){return(1<U.length?U.charAt(0)+"."+U.slice(1):U)+($<0?"e":"e+")+$}function V(U,$,Z){var ie,ue;if($<0){for(ue=Z+".";++$;ue+=Z);U=ue+U}else if(++$>(ie=U.length)){for(ue=Z,$-=ie;--$;ue+=Z);U+=ue}else $<ie&&(U=U.slice(0,$)+"."+U.slice($));return U}(c=function U($){var Z,ie,ue,_e,Ee,pe,me,Se,Le,xe,E=le.prototype={constructor:le,toString:null,valueOf:null},k=new le(1),D=20,q=4,B=-7,se=21,ye=-1e7,we=1e7,de=!1,be=1,fe=0,he={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},Ne="0123456789abcdefghijklmnopqrstuvwxyz";function le(H,F){var G,oe,Q,ce,ee,te,W,j,K=this;if(!(K instanceof le))return new le(H,F);if(F==null){if(H instanceof le)return K.s=H.s,K.e=H.e,void(K.c=(H=H.c)?H.slice():H);if((te=typeof H=="number")&&0*H==0){if(K.s=1/H<0?(H=-H,-1):1,H===~~H){for(ce=0,ee=H;10<=ee;ee/=10,ce++);return K.e=ce,void(K.c=[H])}j=String(H)}else{if(j=String(H),!u.test(j))return ue(K,j,te);K.s=j.charCodeAt(0)==45?(j=j.slice(1),-1):1}-1<(ce=j.indexOf("."))&&(j=j.replace(".","")),0<(ee=j.search(/e/i))?(ce<0&&(ce=ee),ce+=+j.slice(ee+1),j=j.substring(0,ee)):ce<0&&(ce=j.length)}else{if(O(F,2,Ne.length,"Base"),j=String(H),F==10)return We(K=new le(H instanceof le?H:j),D+K.e+1,q);if(te=typeof H=="number"){if(0*H!=0)return ue(K,j,te,F);if(K.s=1/H<0?(j=j.slice(1),-1):1,le.DEBUG&&15<j.replace(/^0\.0*|\./,"").length)throw Error(m+H);te=!1}else K.s=j.charCodeAt(0)===45?(j=j.slice(1),-1):1;for(G=Ne.slice(0,F),ce=ee=0,W=j.length;ee<W;ee++)if(G.indexOf(oe=j.charAt(ee))<0){if(oe=="."){if(ce<ee){ce=W;continue}}else if(!Q&&(j==j.toUpperCase()&&(j=j.toLowerCase())||j==j.toLowerCase()&&(j=j.toUpperCase()))){Q=!0,ee=-1,ce=0;continue}return ue(K,String(H),te,F)}-1<(ce=(j=ie(j,F,10,K.s)).indexOf("."))?j=j.replace(".",""):ce=j.length}for(ee=0;j.charCodeAt(ee)===48;ee++);for(W=j.length;j.charCodeAt(--W)===48;);if(j=j.slice(ee,++W)){if(W-=ee,te&&le.DEBUG&&15<W&&(_<H||H!==d(H)))throw Error(m+K.s*H);if(we<(ce=ce-ee-1))K.c=K.e=null;else if(ce<ye)K.c=[K.e=0];else{if(K.e=ce,K.c=[],ee=(ce+1)%v,ce<0&&(ee+=v),ee<W){for(ee&&K.c.push(+j.slice(0,ee)),W-=v;ee<W;)K.c.push(+j.slice(ee,ee+=v));j=j.slice(ee),ee=v-j.length}else ee-=W;for(;ee--;j+="0");K.c.push(+j)}}else K.c=[K.e=0]}function Ve(H,F,G,oe){var Q,ce,ee,te,W;if(G==null?G=q:O(G,0,8),!H.c)return H.toString();if(Q=H.c[0],ee=H.e,F==null)W=I(H.c),W=oe==1||oe==2&&(ee<=B||se<=ee)?L(W,ee):V(W,ee,"0");else if(ce=(H=We(new le(H),F,G)).e,te=(W=I(H.c)).length,oe==1||oe==2&&(F<=ce||ce<=B)){for(;te<F;W+="0",te++);W=L(W,ce)}else if(F-=ee,W=V(W,ce,"0"),te<ce+1){if(0<--F)for(W+=".";F--;W+="0");}else if(0<(F+=ce-te))for(ce+1==te&&(W+=".");F--;W+="0");return H.s<0&&Q?"-"+W:W}function Be(H,F){for(var G,oe=1,Q=new le(H[0]);oe<H.length;oe++){if(!(G=new le(H[oe])).s){Q=G;break}F.call(Q,G)&&(Q=G)}return Q}function je(H,F,G){for(var oe=1,Q=F.length;!F[--Q];F.pop());for(Q=F[0];10<=Q;Q/=10,oe++);return(G=oe+G*v-1)>we?H.c=H.e=null:H.c=G<ye?[H.e=0]:(H.e=G,F),H}function We(H,F,G,oe){var Q,ce,ee,te,W,j,K,ve=H.c,Re=b;if(ve){e:{for(Q=1,te=ve[0];10<=te;te/=10,Q++);if((ce=F-Q)<0)ce+=v,ee=F,K=(W=ve[j=0])/Re[Q-ee-1]%10|0;else if((j=h((ce+1)/v))>=ve.length){if(!oe)break e;for(;ve.length<=j;ve.push(0));W=K=0,ee=(ce%=v)-v+(Q=1)}else{for(W=te=ve[j],Q=1;10<=te;te/=10,Q++);K=(ee=(ce%=v)-v+Q)<0?0:W/Re[Q-ee-1]%10|0}if(oe=oe||F<0||ve[j+1]!=null||(ee<0?W:W%Re[Q-ee-1]),oe=G<4?(K||oe)&&(G==0||G==(H.s<0?3:2)):5<K||K==5&&(G==4||oe||G==6&&(0<ce?0<ee?W/Re[Q-ee]:0:ve[j-1])%10&1||G==(H.s<0?8:7)),F<1||!ve[0])return ve.length=0,oe?(F-=H.e+1,ve[0]=Re[(v-F%v)%v],H.e=-F||0):ve[0]=H.e=0,H;if(ce==0?(ve.length=j,te=1,j--):(ve.length=j+1,te=Re[v-ce],ve[j]=0<ee?d(W/Re[Q-ee]%Re[ee])*te:0),oe)for(;;){if(j==0){for(ce=1,ee=ve[0];10<=ee;ee/=10,ce++);for(ee=ve[0]+=te,te=1;10<=ee;ee/=10,te++);ce!=te&&(H.e++,ve[0]==g&&(ve[0]=1));break}if(ve[j]+=te,ve[j]!=g)break;ve[j--]=0,te=1}for(ce=ve.length;ve[--ce]===0;ve.pop());}H.e>we?H.c=H.e=null:H.e<ye&&(H.c=[H.e=0])}return H}function $e(H){var F,G=H.e;return G===null?H.toString():(F=I(H.c),F=G<=B||se<=G?L(F,G):V(F,G,"0"),H.s<0?"-"+F:F)}return le.clone=U,le.ROUND_UP=0,le.ROUND_DOWN=1,le.ROUND_CEIL=2,le.ROUND_FLOOR=3,le.ROUND_HALF_UP=4,le.ROUND_HALF_DOWN=5,le.ROUND_HALF_EVEN=6,le.ROUND_HALF_CEIL=7,le.ROUND_HALF_FLOOR=8,le.EUCLID=9,le.config=le.set=function(H){var F,G;if(H!=null){if(typeof H!="object")throw Error(f+"Object expected: "+H);if(H.hasOwnProperty(F="DECIMAL_PLACES")&&(O(G=H[F],0,T,F),D=G),H.hasOwnProperty(F="ROUNDING_MODE")&&(O(G=H[F],0,8,F),q=G),H.hasOwnProperty(F="EXPONENTIAL_AT")&&((G=H[F])&&G.pop?(O(G[0],-T,0,F),O(G[1],0,T,F),B=G[0],se=G[1]):(O(G,-T,T,F),B=-(se=G<0?-G:G))),H.hasOwnProperty(F="RANGE"))if((G=H[F])&&G.pop)O(G[0],-T,-1,F),O(G[1],1,T,F),ye=G[0],we=G[1];else{if(O(G,-T,T,F),!G)throw Error(f+F+" cannot be zero: "+G);ye=-(we=G<0?-G:G)}if(H.hasOwnProperty(F="CRYPTO")){if((G=H[F])!==!!G)throw Error(f+F+" not true or false: "+G);if(G){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw de=!G,Error(f+"crypto unavailable");de=G}else de=G}if(H.hasOwnProperty(F="MODULO_MODE")&&(O(G=H[F],0,9,F),be=G),H.hasOwnProperty(F="POW_PRECISION")&&(O(G=H[F],0,T,F),fe=G),H.hasOwnProperty(F="FORMAT")){if(typeof(G=H[F])!="object")throw Error(f+F+" not an object: "+G);he=G}if(H.hasOwnProperty(F="ALPHABET")){if(typeof(G=H[F])!="string"||/^.$|[+-.\s]|(.).*\1/.test(G))throw Error(f+F+" invalid: "+G);Ne=G}}return{DECIMAL_PLACES:D,ROUNDING_MODE:q,EXPONENTIAL_AT:[B,se],RANGE:[ye,we],CRYPTO:de,MODULO_MODE:be,POW_PRECISION:fe,FORMAT:he,ALPHABET:Ne}},le.isBigNumber=function(H){return H instanceof le||H&&H._isBigNumber===!0||!1},le.maximum=le.max=function(){return Be(arguments,E.lt)},le.minimum=le.min=function(){return Be(arguments,E.gt)},le.random=(_e=9007199254740992,Ee=Math.random()*_e&2097151?function(){return d(Math.random()*_e)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(H){var F,G,oe,Q,ce,ee=0,te=[],W=new le(k);if(H==null?H=D:O(H,0,T),Q=h(H/v),de)if(crypto.getRandomValues){for(F=crypto.getRandomValues(new Uint32Array(Q*=2));ee<Q;)9e15<=(ce=131072*F[ee]+(F[ee+1]>>>11))?(G=crypto.getRandomValues(new Uint32Array(2)),F[ee]=G[0],F[ee+1]=G[1]):(te.push(ce%1e14),ee+=2);ee=Q/2}else{if(!crypto.randomBytes)throw de=!1,Error(f+"crypto unavailable");for(F=crypto.randomBytes(Q*=7);ee<Q;)9e15<=(ce=281474976710656*(31&F[ee])+1099511627776*F[ee+1]+4294967296*F[ee+2]+16777216*F[ee+3]+(F[ee+4]<<16)+(F[ee+5]<<8)+F[ee+6])?crypto.randomBytes(7).copy(F,ee):(te.push(ce%1e14),ee+=7);ee=Q/7}if(!de)for(;ee<Q;)(ce=Ee())<9e15&&(te[ee++]=ce%1e14);for(Q=te[--ee],H%=v,Q&&H&&(ce=b[v-H],te[ee]=d(Q/ce)*ce);te[ee]===0;te.pop(),ee--);if(ee<0)te=[oe=0];else{for(oe=-1;te[0]===0;te.splice(0,1),oe-=v);for(ee=1,ce=te[0];10<=ce;ce/=10,ee++);ee<v&&(oe-=v-ee)}return W.e=oe,W.c=te,W}),le.sum=function(){for(var H=1,F=arguments,G=new le(F[0]);H<F.length;)G=G.plus(F[H++]);return G},ie=function(){var H="0123456789";function F(G,oe,Q,ce){for(var ee,te,W=[0],j=0,K=G.length;j<K;){for(te=W.length;te--;W[te]*=oe);for(W[0]+=ce.indexOf(G.charAt(j++)),ee=0;ee<W.length;ee++)W[ee]>Q-1&&(W[ee+1]==null&&(W[ee+1]=0),W[ee+1]+=W[ee]/Q|0,W[ee]%=Q)}return W.reverse()}return function(G,oe,Q,ce,ee){var te,W,j,K,ve,Re,Ie,ae,Te=G.indexOf("."),Me=D,Pe=q;for(0<=Te&&(K=fe,fe=0,G=G.replace(".",""),Re=(ae=new le(oe)).pow(G.length-Te),fe=K,ae.c=F(V(I(Re.c),Re.e,"0"),10,Q,H),ae.e=ae.c.length),j=K=(Ie=F(G,oe,Q,ee?(te=Ne,H):(te=H,Ne))).length;Ie[--K]==0;Ie.pop());if(!Ie[0])return te.charAt(0);if(Te<0?--j:(Re.c=Ie,Re.e=j,Re.s=ce,Ie=(Re=Z(Re,ae,Me,Pe,Q)).c,ve=Re.r,j=Re.e),Te=Ie[W=j+Me+1],K=Q/2,ve=ve||W<0||Ie[W+1]!=null,ve=Pe<4?(Te!=null||ve)&&(Pe==0||Pe==(Re.s<0?3:2)):K<Te||Te==K&&(Pe==4||ve||Pe==6&&1&Ie[W-1]||Pe==(Re.s<0?8:7)),W<1||!Ie[0])G=ve?V(te.charAt(1),-Me,te.charAt(0)):te.charAt(0);else{if(Ie.length=W,ve)for(--Q;++Ie[--W]>Q;)Ie[W]=0,W||(++j,Ie=[1].concat(Ie));for(K=Ie.length;!Ie[--K];);for(Te=0,G="";Te<=K;G+=te.charAt(Ie[Te++]));G=V(G,j,te.charAt(0))}return G}}(),Z=function(){function H(oe,Q,ce){var ee,te,W,j,K=0,ve=oe.length,Re=Q%S,Ie=Q/S|0;for(oe=oe.slice();ve--;)K=((te=Re*(W=oe[ve]%S)+(ee=Ie*W+(j=oe[ve]/S|0)*Re)%S*S+K)/ce|0)+(ee/S|0)+Ie*j,oe[ve]=te%ce;return K&&(oe=[K].concat(oe)),oe}function F(oe,Q,ce,ee){var te,W;if(ce!=ee)W=ee<ce?1:-1;else for(te=W=0;te<ce;te++)if(oe[te]!=Q[te]){W=oe[te]>Q[te]?1:-1;break}return W}function G(oe,Q,ce,ee){for(var te=0;ce--;)oe[ce]-=te,te=oe[ce]<Q[ce]?1:0,oe[ce]=te*ee+oe[ce]-Q[ce];for(;!oe[0]&&1<oe.length;oe.splice(0,1));}return function(oe,Q,ce,ee,te){var W,j,K,ve,Re,Ie,ae,Te,Me,Pe,De,ze,ut,ht,yt,nt,St,Oe=oe.s==Q.s?1:-1,Qe=oe.c,Xe=Q.c;if(!(Qe&&Qe[0]&&Xe&&Xe[0]))return new le(oe.s&&Q.s&&(Qe?!Xe||Qe[0]!=Xe[0]:Xe)?Qe&&Qe[0]==0||!Xe?0*Oe:Oe/0:NaN);for(Me=(Te=new le(Oe)).c=[],Oe=ce+(j=oe.e-Q.e)+1,te||(te=g,j=A(oe.e/v)-A(Q.e/v),Oe=Oe/v|0),K=0;Xe[K]==(Qe[K]||0);K++);if(Xe[K]>(Qe[K]||0)&&j--,Oe<0)Me.push(1),ve=!0;else{for(ht=Qe.length,nt=Xe.length,Oe+=2,1<(Re=d(te/(Xe[K=0]+1)))&&(Xe=H(Xe,Re,te),Qe=H(Qe,Re,te),nt=Xe.length,ht=Qe.length),ut=nt,De=(Pe=Qe.slice(0,nt)).length;De<nt;Pe[De++]=0);St=Xe.slice(),St=[0].concat(St),yt=Xe[0],Xe[1]>=te/2&&yt++;do{if(Re=0,(W=F(Xe,Pe,nt,De))<0){if(ze=Pe[0],nt!=De&&(ze=ze*te+(Pe[1]||0)),1<(Re=d(ze/yt)))for(te<=Re&&(Re=te-1),ae=(Ie=H(Xe,Re,te)).length,De=Pe.length;F(Ie,Pe,ae,De)==1;)Re--,G(Ie,nt<ae?St:Xe,ae,te),ae=Ie.length,W=1;else Re==0&&(W=Re=1),ae=(Ie=Xe.slice()).length;if(ae<De&&(Ie=[0].concat(Ie)),G(Pe,Ie,De,te),De=Pe.length,W==-1)for(;F(Xe,Pe,nt,De)<1;)Re++,G(Pe,nt<De?St:Xe,De,te),De=Pe.length}else W===0&&(Re++,Pe=[0]);Me[K++]=Re,Pe[0]?Pe[De++]=Qe[ut]||0:(Pe=[Qe[ut]],De=1)}while((ut++<ht||Pe[0]!=null)&&Oe--);ve=Pe[0]!=null,Me[0]||Me.splice(0,1)}if(te==g){for(K=1,Oe=Me[0];10<=Oe;Oe/=10,K++);We(Te,ce+(Te.e=K+j*v-1)+1,ee,ve)}else Te.e=j,Te.r=+ve;return Te}}(),pe=/^(-?)0([xbo])(?=\w[\w.]*$)/i,me=/^([^.]+)\.$/,Se=/^\.([^.]+)$/,Le=/^-?(Infinity|NaN)$/,xe=/^\s*\+(?=[\w.])|^\s+|\s+$/g,ue=function(H,F,G,oe){var Q,ce=G?F:F.replace(xe,"");if(Le.test(ce))H.s=isNaN(ce)?null:ce<0?-1:1,H.c=H.e=null;else{if(!G&&(ce=ce.replace(pe,function(ee,te,W){return Q=(W=W.toLowerCase())=="x"?16:W=="b"?2:8,oe&&oe!=Q?ee:te}),oe&&(Q=oe,ce=ce.replace(me,"$1").replace(Se,"0.$1")),F!=ce))return new le(ce,Q);if(le.DEBUG)throw Error(f+"Not a"+(oe?" base "+oe:"")+" number: "+F);H.c=H.e=H.s=null}},E.absoluteValue=E.abs=function(){var H=new le(this);return H.s<0&&(H.s=1),H},E.comparedTo=function(H,F){return R(this,new le(H,F))},E.decimalPlaces=E.dp=function(H,F){var G,oe,Q;if(H!=null)return O(H,0,T),F==null?F=q:O(F,0,8),We(new le(this),H+this.e+1,F);if(!(G=this.c))return null;if(oe=((Q=G.length-1)-A(this.e/v))*v,Q=G[Q])for(;Q%10==0;Q/=10,oe--);return oe<0&&(oe=0),oe},E.dividedBy=E.div=function(H,F){return Z(this,new le(H,F),D,q)},E.dividedToIntegerBy=E.idiv=function(H,F){return Z(this,new le(H,F),0,1)},E.exponentiatedBy=E.pow=function(H,F){var G,oe,Q,ce,ee,te,W,j,K=this;if((H=new le(H)).c&&!H.isInteger())throw Error(f+"Exponent not an integer: "+$e(H));if(F!=null&&(F=new le(F)),ee=14<H.e,!K.c||!K.c[0]||K.c[0]==1&&!K.e&&K.c.length==1||!H.c||!H.c[0])return j=new le(Math.pow(+$e(K),ee?2-P(H):+$e(H))),F?j.mod(F):j;if(te=H.s<0,F){if(F.c?!F.c[0]:!F.s)return new le(NaN);(oe=!te&&K.isInteger()&&F.isInteger())&&(K=K.mod(F))}else{if(9<H.e&&(0<K.e||K.e<-1||(K.e==0?1<K.c[0]||ee&&24e7<=K.c[1]:K.c[0]<8e13||ee&&K.c[0]<=9999975e7)))return ce=K.s<0&&P(H)?-0:0,-1<K.e&&(ce=1/ce),new le(te?1/ce:ce);fe&&(ce=h(fe/v+2))}for(W=ee?(G=new le(.5),te&&(H.s=1),P(H)):(Q=Math.abs(+$e(H)))%2,j=new le(k);;){if(W){if(!(j=j.times(K)).c)break;ce?j.c.length>ce&&(j.c.length=ce):oe&&(j=j.mod(F))}if(Q){if((Q=d(Q/2))===0)break;W=Q%2}else if(We(H=H.times(G),H.e+1,1),14<H.e)W=P(H);else{if((Q=+$e(H))==0)break;W=Q%2}K=K.times(K),ce?K.c&&K.c.length>ce&&(K.c.length=ce):oe&&(K=K.mod(F))}return oe?j:(te&&(j=k.div(j)),F?j.mod(F):ce?We(j,fe,q,void 0):j)},E.integerValue=function(H){var F=new le(this);return H==null?H=q:O(H,0,8),We(F,F.e+1,H)},E.isEqualTo=E.eq=function(H,F){return R(this,new le(H,F))===0},E.isFinite=function(){return!!this.c},E.isGreaterThan=E.gt=function(H,F){return 0<R(this,new le(H,F))},E.isGreaterThanOrEqualTo=E.gte=function(H,F){return(F=R(this,new le(H,F)))===1||F===0},E.isInteger=function(){return!!this.c&&A(this.e/v)>this.c.length-2},E.isLessThan=E.lt=function(H,F){return R(this,new le(H,F))<0},E.isLessThanOrEqualTo=E.lte=function(H,F){return(F=R(this,new le(H,F)))===-1||F===0},E.isNaN=function(){return!this.s},E.isNegative=function(){return this.s<0},E.isPositive=function(){return 0<this.s},E.isZero=function(){return!!this.c&&this.c[0]==0},E.minus=function(H,F){var G,oe,Q,ce,ee=this,te=ee.s;if(F=(H=new le(H,F)).s,!te||!F)return new le(NaN);if(te!=F)return H.s=-F,ee.plus(H);var W=ee.e/v,j=H.e/v,K=ee.c,ve=H.c;if(!W||!j){if(!K||!ve)return K?(H.s=-F,H):new le(ve?ee:NaN);if(!K[0]||!ve[0])return ve[0]?(H.s=-F,H):new le(K[0]?ee:q==3?-0:0)}if(W=A(W),j=A(j),K=K.slice(),te=W-j){for((Q=(ce=te<0)?(te=-te,K):(j=W,ve)).reverse(),F=te;F--;Q.push(0));Q.reverse()}else for(oe=(ce=(te=K.length)<(F=ve.length))?te:F,te=F=0;F<oe;F++)if(K[F]!=ve[F]){ce=K[F]<ve[F];break}if(ce&&(Q=K,K=ve,ve=Q,H.s=-H.s),0<(F=(oe=ve.length)-(G=K.length)))for(;F--;K[G++]=0);for(F=g-1;te<oe;){if(K[--oe]<ve[oe]){for(G=oe;G&&!K[--G];K[G]=F);--K[G],K[oe]+=g}K[oe]-=ve[oe]}for(;K[0]==0;K.splice(0,1),--j);return K[0]?je(H,K,j):(H.s=q==3?-1:1,H.c=[H.e=0],H)},E.modulo=E.mod=function(H,F){var G,oe,Q=this;return H=new le(H,F),!Q.c||!H.s||H.c&&!H.c[0]?new le(NaN):!H.c||Q.c&&!Q.c[0]?new le(Q):(be==9?(oe=H.s,H.s=1,G=Z(Q,H,0,3),H.s=oe,G.s*=oe):G=Z(Q,H,0,be),(H=Q.minus(G.times(H))).c[0]||be!=1||(H.s=Q.s),H)},E.multipliedBy=E.times=function(H,F){var G,oe,Q,ce,ee,te,W,j,K,ve,Re,Ie,ae,Te,Me,Pe=this,De=Pe.c,ze=(H=new le(H,F)).c;if(!(De&&ze&&De[0]&&ze[0]))return!Pe.s||!H.s||De&&!De[0]&&!ze||ze&&!ze[0]&&!De?H.c=H.e=H.s=null:(H.s*=Pe.s,De&&ze?(H.c=[0],H.e=0):H.c=H.e=null),H;for(oe=A(Pe.e/v)+A(H.e/v),H.s*=Pe.s,(W=De.length)<(ve=ze.length)&&(ae=De,De=ze,ze=ae,Q=W,W=ve,ve=Q),Q=W+ve,ae=[];Q--;ae.push(0));for(Te=g,Me=S,Q=ve;0<=--Q;){for(G=0,Re=ze[Q]%Me,Ie=ze[Q]/Me|0,ce=Q+(ee=W);Q<ce;)G=((j=Re*(j=De[--ee]%Me)+(te=Ie*j+(K=De[ee]/Me|0)*Re)%Me*Me+ae[ce]+G)/Te|0)+(te/Me|0)+Ie*K,ae[ce--]=j%Te;ae[ce]=G}return G?++oe:ae.splice(0,1),je(H,ae,oe)},E.negated=function(){var H=new le(this);return H.s=-H.s||null,H},E.plus=function(H,F){var G,oe=this,Q=oe.s;if(F=(H=new le(H,F)).s,!Q||!F)return new le(NaN);if(Q!=F)return H.s=-F,oe.minus(H);var ce=oe.e/v,ee=H.e/v,te=oe.c,W=H.c;if(!ce||!ee){if(!te||!W)return new le(Q/0);if(!te[0]||!W[0])return W[0]?H:new le(te[0]?oe:0*Q)}if(ce=A(ce),ee=A(ee),te=te.slice(),Q=ce-ee){for((G=0<Q?(ee=ce,W):(Q=-Q,te)).reverse();Q--;G.push(0));G.reverse()}for((Q=te.length)-(F=W.length)<0&&(G=W,W=te,te=G,F=Q),Q=0;F;)Q=(te[--F]=te[F]+W[F]+Q)/g|0,te[F]=g===te[F]?0:te[F]%g;return Q&&(te=[Q].concat(te),++ee),je(H,te,ee)},E.precision=E.sd=function(H,F){var G,oe,Q;if(H!=null&&H!==!!H)return O(H,1,T),F==null?F=q:O(F,0,8),We(new le(this),H,F);if(!(G=this.c))return null;if(oe=(Q=G.length-1)*v+1,Q=G[Q]){for(;Q%10==0;Q/=10,oe--);for(Q=G[0];10<=Q;Q/=10,oe++);}return H&&this.e+1>oe&&(oe=this.e+1),oe},E.shiftedBy=function(H){return O(H,-_,_),this.times("1e"+H)},E.squareRoot=E.sqrt=function(){var H,F,G,oe,Q,ce=this,ee=ce.c,te=ce.s,W=ce.e,j=D+4,K=new le("0.5");if(te!==1||!ee||!ee[0])return new le(!te||te<0&&(!ee||ee[0])?NaN:ee?ce:1/0);if((G=(te=Math.sqrt(+$e(ce)))==0||te==1/0?(((F=I(ee)).length+W)%2==0&&(F+="0"),te=Math.sqrt(+F),W=A((W+1)/2)-(W<0||W%2),new le(F=te==1/0?"1e"+W:(F=te.toExponential()).slice(0,F.indexOf("e")+1)+W)):new le(te+"")).c[0]){for((te=(W=G.e)+j)<3&&(te=0);;)if(Q=G,G=K.times(Q.plus(Z(ce,Q,j,1))),I(Q.c).slice(0,te)===(F=I(G.c)).slice(0,te)){if(G.e<W&&--te,(F=F.slice(te-3,te+1))!="9999"&&(oe||F!="4999")){+F&&(+F.slice(1)||F.charAt(0)!="5")||(We(G,G.e+D+2,1),H=!G.times(G).eq(ce));break}if(!oe&&(We(Q,Q.e+D+2,0),Q.times(Q).eq(ce))){G=Q;break}j+=4,te+=4,oe=1}}return We(G,G.e+D+1,q,H)},E.toExponential=function(H,F){return H!=null&&(O(H,0,T),H++),Ve(this,H,F,1)},E.toFixed=function(H,F){return H!=null&&(O(H,0,T),H=H+this.e+1),Ve(this,H,F)},E.toFormat=function(H,F,G){var oe;if(G==null)H!=null&&F&&typeof F=="object"?(G=F,F=null):H&&typeof H=="object"?(G=H,H=F=null):G=he;else if(typeof G!="object")throw Error(f+"Argument not an object: "+G);if(oe=this.toFixed(H,F),this.c){var Q,ce=oe.split("."),ee=+G.groupSize,te=+G.secondaryGroupSize,W=G.groupSeparator||"",j=ce[0],K=ce[1],ve=this.s<0,Re=ve?j.slice(1):j,Ie=Re.length;if(te&&(Q=ee,ee=te,Ie-=te=Q),0<ee&&0<Ie){for(Q=Ie%ee||ee,j=Re.substr(0,Q);Q<Ie;Q+=ee)j+=W+Re.substr(Q,ee);0<te&&(j+=W+Re.slice(Q)),ve&&(j="-"+j)}oe=K?j+(G.decimalSeparator||"")+((te=+G.fractionGroupSize)?K.replace(new RegExp("\\d{"+te+"}\\B","g"),"$&"+(G.fractionGroupSeparator||"")):K):j}return(G.prefix||"")+oe+(G.suffix||"")},E.toFraction=function(H){var F,G,oe,Q,ce,ee,te,W,j,K,ve,Re,Ie=this,ae=Ie.c;if(H!=null&&(!(te=new le(H)).isInteger()&&(te.c||te.s!==1)||te.lt(k)))throw Error(f+"Argument "+(te.isInteger()?"out of range: ":"not an integer: ")+$e(te));if(!ae)return new le(Ie);for(F=new le(k),j=G=new le(k),oe=W=new le(k),Re=I(ae),ce=F.e=Re.length-Ie.e-1,F.c[0]=b[(ee=ce%v)<0?v+ee:ee],H=!H||0<te.comparedTo(F)?0<ce?F:j:te,ee=we,we=1/0,te=new le(Re),W.c[0]=0;K=Z(te,F,0,1),(Q=G.plus(K.times(oe))).comparedTo(H)!=1;)G=oe,oe=Q,j=W.plus(K.times(Q=j)),W=Q,F=te.minus(K.times(Q=F)),te=Q;return Q=Z(H.minus(G),oe,0,1),W=W.plus(Q.times(j)),G=G.plus(Q.times(oe)),W.s=j.s=Ie.s,ve=Z(j,oe,ce*=2,q).minus(Ie).abs().comparedTo(Z(W,G,ce,q).minus(Ie).abs())<1?[j,oe]:[W,G],we=ee,ve},E.toNumber=function(){return+$e(this)},E.toPrecision=function(H,F){return H!=null&&O(H,1,T),Ve(this,H,F,2)},E.toString=function(H){var F,G=this,oe=G.s,Q=G.e;return Q===null?oe?(F="Infinity",oe<0&&(F="-"+F)):F="NaN":(F=H==null?Q<=B||se<=Q?L(I(G.c),Q):V(I(G.c),Q,"0"):H===10?V(I((G=We(new le(G),D+Q+1,q)).c),G.e,"0"):(O(H,2,Ne.length,"Base"),ie(V(I(G.c),Q,"0"),10,H,oe,!0)),oe<0&&G.c[0]&&(F="-"+F)),F},E.valueOf=E.toJSON=function(){return $e(this)},E._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(E[Symbol.toStringTag]="BigNumber",E[Symbol.for("nodejs.util.inspect.custom")]=E.valueOf),$!=null&&le.set($),le}()).default=c.BigNumber=c,r!==void 0&&r.exports?r.exports=c:(a||(a=typeof self<"u"&&self?self:window),a.BigNumber=c)})(this)},{}],2:[function(i,r,o){"use strict";r.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(a){var c=a%10;return~~(a%100/10)==1?"th":c===1?"st":c===2?"nd":c===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(i,r,o){"use strict";function a(A,I){return function(R){if(Array.isArray(R))return R}(A)||function(R,O){var P=[],L=!0,V=!1,U=void 0;try{for(var $,Z=R[Symbol.iterator]();!(L=($=Z.next()).done)&&(P.push($.value),!O||P.length!==O);L=!0);}catch(ie){V=!0,U=ie}finally{try{L||Z.return==null||Z.return()}finally{if(V)throw U}}return P}(A,I)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var c=i("./globalState"),u=i("./validating"),h=i("./parsing"),d=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],f={general:{scale:1024,suffixes:d,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:d,marker:"d"}},m={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function g(A){var I=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},R=2<arguments.length?arguments[2]:void 0;if(typeof I=="string"&&(I=h.parseFormat(I)),!u.validateFormat(I))return"ERROR: invalid format";var O=I.prefix||"",P=I.postfix||"",L=function(V,U,$){switch(U.output){case"currency":return U=T(U,c.currentCurrencyDefaultFormat()),function(Ne,le,Ve){var Be=Ve.currentCurrency(),je=Object.assign({},m,le),We=void 0,$e="",H=!!je.totalLength||!!je.forceAverage||je.average,F=le.currencyPosition||Be.position,G=le.currencySymbol||Be.symbol;je.spaceSeparated&&($e=" "),F==="infix"&&(We=$e+G+$e);var oe=S({instance:Ne,providedFormat:le,state:Ve,decimalSeparator:We});return F==="prefix"&&(oe=Ne._value<0&&je.negative==="sign"?"-".concat($e).concat(G).concat(oe.slice(1)):G+$e+oe),F&&F!=="postfix"||(oe=oe+($e=H?"":$e)+G),oe}(V,U,c);case"percent":return U=T(U,c.currentPercentageDefaultFormat()),function(Ne,le,Ve,Be){var je=le.prefixSymbol,We=S({instance:Be(100*Ne._value),providedFormat:le,state:Ve}),$e=Object.assign({},m,le);return je?"%".concat($e.spaceSeparated?" ":"").concat(We):"".concat(We).concat($e.spaceSeparated?" ":"","%")}(V,U,c,$);case"byte":return U=T(U,c.currentByteDefaultFormat()),k=V,q=c,B=$,se=(D=U).base||"binary",ye=f[se],we=v(k._value,ye.suffixes,ye.scale),de=we.value,be=we.suffix,fe=S({instance:B(de),providedFormat:D,state:q,defaults:q.currentByteDefaultFormat()}),he=q.currentAbbreviations(),"".concat(fe).concat(he.spaced?" ":"").concat(be);case"time":return U=T(U,c.currentTimeDefaultFormat()),Se=V,Le=Math.floor(Se._value/60/60),xe=Math.floor((Se._value-60*Le*60)/60),E=Math.round(Se._value-60*Le*60-60*xe),"".concat(Le,":").concat(xe<10?"0":"").concat(xe,":").concat(E<10?"0":"").concat(E);case"ordinal":return U=T(U,c.currentOrdinalDefaultFormat()),Z=V,ie=U,_e=(ue=c).currentOrdinal(),Ee=Object.assign({},m,ie),pe=S({instance:Z,providedFormat:ie,state:ue}),me=_e(Z._value),"".concat(pe).concat(Ee.spaceSeparated?" ":"").concat(me);case"number":default:return S({instance:V,providedFormat:U,numbro:$})}var Z,ie,ue,_e,Ee,pe,me,Se,Le,xe,E,k,D,q,B,se,ye,we,de,be,fe,he}(A,I,R);return L=(L=O+L)+P}function v(A,I,R){var O=I[0],P=Math.abs(A);if(R<=P){for(var L=1;L<I.length;++L){var V=Math.pow(R,L),U=Math.pow(R,L+1);if(V<=P&&P<U){O=I[L],A/=V;break}}O===I[0]&&(A/=Math.pow(R,I.length-1),O=I[I.length-1])}return{value:A,suffix:O}}function _(A){for(var I="",R=0;R<A;R++)I+="0";return I}function b(A,I){return A.toString().indexOf("e")!==-1?function(R,O){var P=R.toString(),L=a(P.split("e"),2),V=L[0],U=L[1],$=a(V.split("."),2),Z=$[0],ie=$[1],ue=ie===void 0?"":ie;if(0<+U)P=Z+ue+_(U-ue.length);else{var _e=".";_e=+Z<0?"-0".concat(_e):"0".concat(_e);var Ee=(_(-U-1)+Math.abs(Z)+ue).substr(0,O);Ee.length<O&&(Ee+=_(O-Ee.length)),P=_e+Ee}return 0<+U&&0<O&&(P+=".".concat(_(O))),P}(A,I):(Math.round(+"".concat(A,"e+").concat(I))/Math.pow(10,I)).toFixed(I)}function S(A){var I=A.instance,R=A.providedFormat,O=A.state,P=O===void 0?c:O,L=A.decimalSeparator,V=A.defaults,U=V===void 0?P.currentDefaults():V,$=I._value;if($===0&&P.hasZeroFormat())return P.getZeroFormat();if(!isFinite($))return $.toString();var Z,ie,ue,_e,Ee,pe,me,Se,Le=Object.assign({},m,U,R),xe=Le.totalLength,E=xe?0:Le.characteristic,k=Le.optionalCharacteristic,D=Le.forceAverage,q=!!xe||!!D||Le.average,B=xe?-1:q&&R.mantissa===void 0?0:Le.mantissa,se=!xe&&(R.optionalMantissa===void 0?B===-1:Le.optionalMantissa),ye=Le.trimMantissa,we=Le.thousandSeparated,de=Le.spaceSeparated,be=Le.negative,fe=Le.forceSign,he=Le.exponential,Ne="";if(q){var le=function(H){var F=H.value,G=H.forceAverage,oe=H.abbreviations,Q=H.spaceSeparated,ce=Q!==void 0&&Q,ee=H.totalLength,te=ee===void 0?0:ee,W="",j=Math.abs(F),K=-1;if(j>=Math.pow(10,12)&&!G||G==="trillion"?(W=oe.trillion,F/=Math.pow(10,12)):j<Math.pow(10,12)&&j>=Math.pow(10,9)&&!G||G==="billion"?(W=oe.billion,F/=Math.pow(10,9)):j<Math.pow(10,9)&&j>=Math.pow(10,6)&&!G||G==="million"?(W=oe.million,F/=Math.pow(10,6)):(j<Math.pow(10,6)&&j>=Math.pow(10,3)&&!G||G==="thousand")&&(W=oe.thousand,F/=Math.pow(10,3)),W&&(W=(ce?" ":"")+W),te){var ve=F.toString().split(".")[0];K=Math.max(te-ve.length,0)}return{value:F,abbreviation:W,mantissaPrecision:K}}({value:$,forceAverage:D,abbreviations:P.currentAbbreviations(),spaceSeparated:de,totalLength:xe});$=le.value,Ne+=le.abbreviation,xe&&(B=le.mantissaPrecision)}if(he){var Ve=(ie=(Z={value:$,characteristicPrecision:E}).value,ue=Z.characteristicPrecision,_e=ue===void 0?0:ue,Ee=a(ie.toExponential().split("e"),2),pe=Ee[0],me=Ee[1],Se=+pe,_e&&1<_e&&(Se*=Math.pow(10,_e-1),me=0<=(me=+me-(_e-1))?"+".concat(me):me),{value:Se,abbreviation:"e".concat(me)});$=Ve.value,Ne=Ve.abbreviation+Ne}var Be,je,We,$e=function(H,F,G,oe,Q){if(oe===-1)return H;var ce=b(F,oe),ee=a(ce.toString().split("."),2),te=ee[0],W=ee[1],j=W===void 0?"":W;if(j.match(/^0+$/)&&(G||Q))return te;var K=j.match(/0+$/);return Q&&K?"".concat(te,".").concat(j.toString().slice(0,K.index)):ce.toString()}($.toString(),$,se,B,ye);return $e=function(H,F,G,oe,Q){var ce=oe.currentDelimiters(),ee=ce.thousands;Q=Q||ce.decimal;var te=ce.thousandsSize||3,W=H.toString(),j=W.split(".")[0],K=W.split(".")[1];return G&&(F<0&&(j=j.slice(1)),function(ve,Re){for(var Ie=[],ae=0,Te=ve;0<Te;Te--)ae===Re&&(Ie.unshift(Te),ae=0),ae++;return Ie}(j.length,te).forEach(function(ve,Re){j=j.slice(0,ve+Re)+ee+j.slice(ve+Re)}),F<0&&(j="-".concat(j))),W=K?j+Q+K:j}($e=function(H,F,G,oe){var Q=H,ce=a(Q.toString().split("."),2),ee=ce[0],te=ce[1];if(ee.match(/^-?0$/)&&G)return te?"".concat(ee.replace("0",""),".").concat(te):ee.replace("0","");if(ee.length<oe)for(var W=oe-ee.length,j=0;j<W;j++)Q="0".concat(Q);return Q.toString()}($e,0,k,E),$,we,P,L),(q||he)&&($e=$e+Ne),(fe||$<0)&&(Be=$e,We=be,$e=(je=$)===0?Be:+Be==0?Be.replace("-",""):0<je?"+".concat(Be):We==="sign"?Be:"(".concat(Be.replace("-",""),")")),$e}function T(A,I){if(!A)return I;var R=Object.keys(A);return R.length===1&&R[0]==="output"?I:A}r.exports=function(A){return{format:function(){for(var I=arguments.length,R=new Array(I),O=0;O<I;O++)R[O]=arguments[O];return g.apply(void 0,R.concat([A]))},getByteUnit:function(){for(var I=arguments.length,R=new Array(I),O=0;O<I;O++)R[O]=arguments[O];return function(P){var L=f.general;return v(P._value,L.suffixes,L.scale).suffix}.apply(void 0,R.concat([A]))},getBinaryByteUnit:function(){for(var I=arguments.length,R=new Array(I),O=0;O<I;O++)R[O]=arguments[O];return function(P){var L=f.binary;return v(P._value,L.suffixes,L.scale).suffix}.apply(void 0,R.concat([A]))},getDecimalByteUnit:function(){for(var I=arguments.length,R=new Array(I),O=0;O<I;O++)R[O]=arguments[O];return function(P){var L=f.decimal;return v(P._value,L.suffixes,L.scale).suffix}.apply(void 0,R.concat([A]))},formatOrDefault:T}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(i,r,o){"use strict";var a=i("./en-US"),c=i("./validating"),u=i("./parsing"),h={},d=void 0,f={},m=null,g={};function v(b){d=b}function _(){return f[d]}h.languages=function(){return Object.assign({},f)},h.currentLanguage=function(){return d},h.currentCurrency=function(){return _().currency},h.currentAbbreviations=function(){return _().abbreviations},h.currentDelimiters=function(){return _().delimiters},h.currentOrdinal=function(){return _().ordinal},h.currentDefaults=function(){return Object.assign({},_().defaults,g)},h.currentOrdinalDefaultFormat=function(){return Object.assign({},h.currentDefaults(),_().ordinalFormat)},h.currentByteDefaultFormat=function(){return Object.assign({},h.currentDefaults(),_().byteFormat)},h.currentPercentageDefaultFormat=function(){return Object.assign({},h.currentDefaults(),_().percentageFormat)},h.currentCurrencyDefaultFormat=function(){return Object.assign({},h.currentDefaults(),_().currencyFormat)},h.currentTimeDefaultFormat=function(){return Object.assign({},h.currentDefaults(),_().timeFormat)},h.setDefaults=function(b){b=u.parseFormat(b),c.validateFormat(b)&&(g=b)},h.getZeroFormat=function(){return m},h.setZeroFormat=function(b){return m=typeof b=="string"?b:null},h.hasZeroFormat=function(){return m!==null},h.languageData=function(b){if(b){if(f[b])return f[b];throw new Error('Unknown tag "'.concat(b,'"'))}return _()},h.registerLanguage=function(b){var S=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!c.validateLanguage(b))throw new Error("Invalid language data");f[b.languageTag]=b,S&&v(b.languageTag)},h.setLanguage=function(b){var S=1<arguments.length&&arguments[1]!==void 0?arguments[1]:a.languageTag;if(!f[b]){var T=b.split("-")[0],A=Object.keys(f).find(function(I){return I.split("-")[0]===T});return f[A]?void v(A):void v(S)}v(b)},h.registerLanguage(a),d=a.languageTag,r.exports=h},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(i,r,o){"use strict";r.exports=function(a){return{loadLanguagesInNode:function(c){return u=a,void c.forEach(function(h){var d=void 0;try{d=i("../languages/".concat(h))}catch{console.error('Unable to load "'.concat(h,'". No matching language file found.'))}d&&u.registerLanguage(d)});var u}}}},{}],6:[function(i,r,o){"use strict";var a=i("bignumber.js");function c(u,h,d){var f=new a(u._value),m=h;return d.isNumbro(h)&&(m=h._value),m=new a(m),u._value=f.minus(m).toNumber(),u}r.exports=function(u){return{add:function(h,d){return m=d,g=u,v=new a((f=h)._value),_=m,g.isNumbro(m)&&(_=m._value),_=new a(_),f._value=v.plus(_).toNumber(),f;var f,m,g,v,_},subtract:function(h,d){return c(h,d,u)},multiply:function(h,d){return m=d,g=u,v=new a((f=h)._value),_=m,g.isNumbro(m)&&(_=m._value),_=new a(_),f._value=v.times(_).toNumber(),f;var f,m,g,v,_},divide:function(h,d){return m=d,g=u,v=new a((f=h)._value),_=m,g.isNumbro(m)&&(_=m._value),_=new a(_),f._value=v.dividedBy(_).toNumber(),f;var f,m,g,v,_},set:function(h,d){return f=h,g=m=d,u.isNumbro(m)&&(g=m._value),f._value=g,f;var f,m,g},difference:function(h,d){return f=d,c(g=(m=u)(h._value),f,m),Math.abs(g._value);var f,m,g}}}},{"bignumber.js":1}],7:[function(i,r,o){"use strict";function a(S,T){for(var A=0;A<T.length;A++){var I=T[A];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(S,I.key,I)}}var c=i("./globalState"),u=i("./validating"),h=i("./loading")(b),d=i("./unformatting"),f=i("./formatting")(b),m=i("./manipulating")(b),g=i("./parsing"),v=function(){function S(R){(function(O,P){if(!(O instanceof P))throw new TypeError("Cannot call a class as a function")})(this,S),this._value=R}var T,A,I;return T=S,A=[{key:"clone",value:function(){return b(this._value)}},{key:"format",value:function(){var R=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return f.format(this,R)}},{key:"formatCurrency",value:function(R){return typeof R=="string"&&(R=g.parseFormat(R)),(R=f.formatOrDefault(R,c.currentCurrencyDefaultFormat())).output="currency",f.format(this,R)}},{key:"formatTime",value:function(){var R=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return R.output="time",f.format(this,R)}},{key:"binaryByteUnits",value:function(){return f.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return f.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return f.getByteUnit(this)}},{key:"difference",value:function(R){return m.difference(this,R)}},{key:"add",value:function(R){return m.add(this,R)}},{key:"subtract",value:function(R){return m.subtract(this,R)}},{key:"multiply",value:function(R){return m.multiply(this,R)}},{key:"divide",value:function(R){return m.divide(this,R)}},{key:"set",value:function(R){return m.set(this,_(R))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}],a(T.prototype,A),I&&a(T,I),S}();function _(S){var T=S;return b.isNumbro(S)?T=S._value:typeof S=="string"?T=b.unformat(S):isNaN(S)&&(T=NaN),T}function b(S){return new v(_(S))}b.version="2.1.2",b.isNumbro=function(S){return S instanceof v},b.language=c.currentLanguage,b.registerLanguage=c.registerLanguage,b.setLanguage=c.setLanguage,b.languages=c.languages,b.languageData=c.languageData,b.zeroFormat=c.setZeroFormat,b.defaultFormat=c.currentDefaults,b.setDefaults=c.setDefaults,b.defaultCurrencyFormat=c.currentCurrencyDefaultFormat,b.validate=u.validate,b.loadLanguagesInNode=h.loadLanguagesInNode,b.unformat=d.unformat,r.exports=b},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(i,r,o){"use strict";r.exports={parseFormat:function(a){var c,u,h,d,f,m,g,v,_,b,S,T,A,I,R,O,P,L,V,U,$=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof a!="string"?a:(u=$,a=(h=(c=a).match(/^{([^}]*)}/))?(u.prefix=h[1],c.slice(h[0].length)):c,f=$,function(Z,ie){if(Z.indexOf("$")===-1){if(Z.indexOf("%")===-1)return Z.indexOf("bd")!==-1?(ie.output="byte",ie.base="general"):Z.indexOf("b")!==-1?(ie.output="byte",ie.base="binary"):Z.indexOf("d")!==-1?(ie.output="byte",ie.base="decimal"):Z.indexOf(":")===-1?Z.indexOf("o")!==-1&&(ie.output="ordinal"):ie.output="time";ie.output="percent"}else ie.output="currency"}(a=(m=(d=a).match(/{([^}]*)}$/))?(f.postfix=m[1],d.slice(0,-m[0].length)):d,$),g=$,(v=a.match(/[1-9]+[0-9]*/))&&(g.totalLength=+v[0]),_=$,(b=a.split(".")[0].match(/0+/))&&(_.characteristic=b[0].length),function(Z,ie){if(Z.indexOf(".")!==-1){var ue=Z.split(".")[0];ie.optionalCharacteristic=ue.indexOf("0")===-1}}(a,$),S=$,a.indexOf("a")!==-1&&(S.average=!0),A=$,(T=a).indexOf("K")!==-1?A.forceAverage="thousand":T.indexOf("M")!==-1?A.forceAverage="million":T.indexOf("B")!==-1?A.forceAverage="billion":T.indexOf("T")!==-1&&(A.forceAverage="trillion"),function(Z,ie){var ue=Z.split(".")[1];if(ue){var _e=ue.match(/0+/);_e&&(ie.mantissa=_e[0].length)}}(a,$),R=$,(I=a).match(/\[\.]/)?R.optionalMantissa=!0:I.match(/\./)&&(R.optionalMantissa=!1),O=$,a.indexOf(",")!==-1&&(O.thousandSeparated=!0),P=$,a.indexOf(" ")!==-1&&(P.spaceSeparated=!0),V=$,(L=a).match(/^\+?\([^)]*\)$/)&&(V.negative="parenthesis"),L.match(/^\+?-/)&&(V.negative="sign"),U=$,a.match(/^\+/)&&(U.forceSign=!0),$)}}},{}],9:[function(i,r,o){"use strict";var a=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function c(h){return h.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function u(h,d){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",m=3<arguments.length?arguments[3]:void 0,g=4<arguments.length?arguments[4]:void 0,v=5<arguments.length?arguments[5]:void 0,_=6<arguments.length?arguments[6]:void 0;if(h!=="")return h===g?0:function b(S,T){var A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",I=3<arguments.length?arguments[3]:void 0,R=4<arguments.length?arguments[4]:void 0,O=5<arguments.length?arguments[5]:void 0,P=6<arguments.length?arguments[6]:void 0;if(!isNaN(+S))return+S;var L="",V=S.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(V!==S)return-1*b(V,T,A,I,R,O,P);for(var U=0;U<a.length;U++){var $=a[U];if((L=S.replace($.key,""))!==S)return b(L,T,A,I,R,O,P)*$.factor}if((L=S.replace("%",""))!==S)return b(L,T,A,I,R,O,P)/100;var Z=parseFloat(S);if(!isNaN(Z)){var ie=I(Z);if(ie&&ie!=="."&&(L=S.replace(new RegExp("".concat(c(ie),"$")),""))!==S)return b(L,T,A,I,R,O,P);var ue={};Object.keys(O).forEach(function(xe){ue[O[xe]]=xe});for(var _e=Object.keys(ue).sort().reverse(),Ee=_e.length,pe=0;pe<Ee;pe++){var me=_e[pe],Se=ue[me];if((L=S.replace(me,""))!==S){var Le=void 0;switch(Se){case"thousand":Le=Math.pow(10,3);break;case"million":Le=Math.pow(10,6);break;case"billion":Le=Math.pow(10,9);break;case"trillion":Le=Math.pow(10,12)}return b(L,T,A,I,R,O,P)*Le}}}}(function(b,S){var T=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",A=b.replace(T,"");return A=(A=A.replace(new RegExp("([0-9])".concat(c(S.thousands),"([0-9])"),"g"),"$1$2")).replace(S.decimal,".")}(h,d,f),d,f,m,g,v,_)}r.exports={unformat:function(h,d){var f,m,g,v=i("./globalState"),_=v.currentDelimiters(),b=v.currentCurrency().symbol,S=v.currentOrdinal(),T=v.getZeroFormat(),A=v.currentAbbreviations(),I=void 0;if(typeof h=="string")I=function(R,O){if(!R.indexOf(":")||O.thousands===":")return!1;var P=R.split(":");if(P.length!==3)return!1;var L=+P[0],V=+P[1],U=+P[2];return!isNaN(L)&&!isNaN(V)&&!isNaN(U)}(h,_)?(f=h.split(":"),m=+f[0],g=+f[1],+f[2]+60*g+3600*m):u(h,_,b,S,T,A,d);else{if(typeof h!="number")return;I=h}if(I!==void 0)return I}}},{"./globalState":4}],10:[function(i,r,o){"use strict";function a(_){return function(b){if(Array.isArray(b)){for(var S=0,T=new Array(b.length);S<b.length;S++)T[S]=b[S];return T}}(_)||function(b){if(Symbol.iterator in Object(b)||Object.prototype.toString.call(b)==="[object Arguments]")return Array.from(b)}(_)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(_){return(c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b})(_)}var u=i("./unformatting"),h=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,d={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(_,b){return b.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(_){return _.output==="byte"}},characteristic:{type:"number",restriction:function(_){return 0<=_},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(_){return 0<=_},message:"value must be positive"},{restriction:function(_,b){return!b.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(_){return 0<=_},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(_,b){return b.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},f={languageTag:{type:"string",mandatory:!0,restriction:function(_){return _.match(h)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function m(_){return!!u.unformat(_)}function g(_,b,S){var T=3<arguments.length&&arguments[3]!==void 0&&arguments[3],A=Object.keys(_).map(function(I){if(!b[I])return console.error("".concat(S," Invalid key: ").concat(I)),!1;var R=_[I],O=b[I];if(typeof O=="string"&&(O={type:O}),O.type==="format"){if(!g(R,d,"[Validate ".concat(I,"]"),!0))return!1}else if(c(R)!==O.type)return console.error("".concat(S," ").concat(I,' type mismatched: "').concat(O.type,'" expected, "').concat(c(R),'" provided')),!1;if(O.restrictions&&O.restrictions.length)for(var P=O.restrictions.length,L=0;L<P;L++){var V=O.restrictions[L],U=V.restriction,$=V.message;if(!U(R,_))return console.error("".concat(S," ").concat(I," invalid value: ").concat($)),!1}return O.restriction&&!O.restriction(R,_)?(console.error("".concat(S," ").concat(I," invalid value: ").concat(O.message)),!1):O.validValues&&O.validValues.indexOf(R)===-1?(console.error("".concat(S," ").concat(I," invalid value: must be among ").concat(JSON.stringify(O.validValues),', "').concat(R,'" provided')),!1):!(O.children&&!g(R,O.children,"[Validate ".concat(I,"]")))});return T||A.push.apply(A,a(Object.keys(b).map(function(I){var R=b[I];if(typeof R=="string"&&(R={type:R}),R.mandatory){var O=R.mandatory;if(typeof O=="function"&&(O=O(_)),O&&_[I]===void 0)return console.error("".concat(S,' Missing mandatory key "').concat(I,'"')),!1}return!0}))),A.reduce(function(I,R){return I&&R},!0)}function v(_){return g(_,d,"[Validate format]")}r.exports={validate:function(_,b){var S=m(_),T=v(b);return S&&T},validateFormat:v,validateInput:m,validateLanguage:function(_){return g(_,f,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})}}),import_es_array_push$68=__toESM(require_es_array_push(),1),import_numbro_min=__toESM(require_numbro_min(),1);const RENDERER_TYPE$4="numeric";function getRenderedValue(e,t){if(isNumeric(e)){const i=t.numericFormat,r=i&&i.culture||"-",o=i&&i.pattern;if(typeof r<"u"&&!import_numbro_min.default.languages()[r]){const a=r.replace("-",""),c=import_numbro_min.default.allLanguages?import_numbro_min.default.allLanguages[r]:import_numbro_min.default[a];c&&import_numbro_min.default.registerLanguage(c)}import_numbro_min.default.setLanguage(r),e=(0,import_numbro_min.default)(e).format(o||"0")}return e}function numericRenderer(e,t,i,r,o,a,c){let u=a;if(isNumeric(u)){const h=c.className||"",d=h.length?h.split(" "):[];u=getRenderedValue(u,c),d.indexOf("htLeft")<0&&d.indexOf("htCenter")<0&&d.indexOf("htRight")<0&&d.indexOf("htJustify")<0&&d.push("htRight"),d.indexOf("htNumeric")<0&&d.push("htNumeric"),c.className=d.join(" "),t.dir="ltr"}textRenderer(e,t,i,r,o,u,c)}numericRenderer.RENDERER_TYPE=RENDERER_TYPE$4;const RENDERER_TYPE$3="password";function passwordRenderer(e,t,i,r,o,a,c){textRenderer.apply(this,[e,t,i,r,o,a,c]);const u=c.hashLength||t.innerHTML.length,h=c.hashSymbol||"*";let d="";rangeEach(u-1,()=>{d+=h}),fastInnerHTML(t,d)}passwordRenderer.RENDERER_TYPE=RENDERER_TYPE$3;const RENDERER_TYPE$2="select";function selectRenderer(e,t,i,r,o,a,c){textRenderer.apply(this,[e,t,i,r,o,a,c])}selectRenderer.RENDERER_TYPE=RENDERER_TYPE$2;const RENDERER_TYPE$1="time";function timeRenderer(e,t,i,r,o,a,c){textRenderer.apply(this,[e,t,i,r,o,a,c]),t.dir="ltr"}timeRenderer.RENDERER_TYPE=RENDERER_TYPE$1;function registerAllRenderers(){_register$2(autocompleteRenderer),_register$2(baseRenderer),_register$2(checkboxRenderer),_register$2(dropdownRenderer),_register$2(handsontableRenderer),_register$2(htmlRenderer),_register$2(numericRenderer),_register$2(passwordRenderer),_register$2(selectRenderer),_register$2(textRenderer),_register$2(timeRenderer)}const VALIDATOR_TYPE$4="autocomplete";function autocompleteValidator(e,t){let i=e;if(i==null&&(i=""),this.allowEmpty&&i===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(i,process$2(i,t)):process$2(i,t)(this.source):t(!0)}autocompleteValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$4;function process$2(e,t){const i=e;return function(r){let o=!1;for(let a=0,c=r.length;a<c;a++)if(i===r[a]){o=!0;break}t(o)}}var date_exports={};__export(date_exports,{getNormalizedDate:()=>getNormalizedDate});function getNormalizedDate(e){const t=new Date(e);return isNaN(new Date(`${e}T00:00`).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}var import_moment$8=__toESM(require_moment(),1);const VALIDATOR_TYPE$3="date";function dateValidator(e,t){const i=_getEditorInstance(EDITOR_TYPE$5,this.instance);let r=e,o=!0;r==null&&(r="");let a=(0,import_moment$8.default)(r,this.dateFormat||i.defaultDateFormat,!0).isValid(),c=(0,import_moment$8.default)(new Date(r)).isValid()||a;if(this.allowEmpty&&r===""&&(c=!0,a=!0),c||(o=!1),!c&&a&&(o=!0),c&&!a)if(this.correctFormat===!0){const u=correctFormat(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"dateValidator"),o=!0}else o=!1;t(o)}dateValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$3;function correctFormat(e,t){const i=(0,import_moment$8.default)(getNormalizedDate(e)),r=(0,import_moment$8.default)(e,t),o=e.search(/[A-z]/g)>-1;let a;return i.isValid()&&i.format("x")===r.format("x")||!r.isValid()||o?a=i:a=r,a.format(t)}const VALIDATOR_TYPE$2="dropdown";function dropdownValidator(e,t){autocompleteValidator.apply(this,[e,t])}dropdownValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$2;const VALIDATOR_TYPE$1="numeric";function numericValidator(e,t){let i=e;i==null&&(i=""),this.allowEmpty&&i===""?t(!0):t(i===""?!1:isNumeric(e))}numericValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$1;var import_moment$7=__toESM(require_moment(),1);const STRICT_FORMATS=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],VALIDATOR_TYPE="time";function timeValidator(e,t){const i=this.timeFormat||"h:mm:ss a";let r=!0,o=e;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;const a=/^\d{1,2}$/.test(o);a&&(o+=":00");const c=(0,import_moment$7.default)(o,STRICT_FORMATS,!0).isValid()?(0,import_moment$7.default)(o):(0,import_moment$7.default)(o,i);let u=c.isValid(),h=(0,import_moment$7.default)(o,i,!0).isValid()&&!a;if(this.allowEmpty&&o===""&&(u=!0,h=!0),u||(r=!1),!u&&h&&(r=!0),u&&!h)if(this.correctFormat===!0){const d=c.format(i);this.instance.setDataAtCell(this.visualRow,this.visualCol,d,"timeValidator"),r=!0}else r=!1;t(r)}timeValidator.VALIDATOR_TYPE=VALIDATOR_TYPE;function registerAllValidators(){_register$1(autocompleteValidator),_register$1(dropdownValidator),_register$1(dateValidator),_register$1(numericValidator),_register$1(timeValidator)}const CELL_TYPE$8="autocomplete",AutocompleteCellType={CELL_TYPE:CELL_TYPE$8,editor:AutocompleteEditor,renderer:autocompleteRenderer,validator:autocompleteValidator},CELL_TYPE$7="checkbox",CheckboxCellType={CELL_TYPE:CELL_TYPE$7,editor:CheckboxEditor,renderer:checkboxRenderer},RENDERER_TYPE="date";function dateRenderer(e,t,i,r,o,a,c){autocompleteRenderer.apply(this,[e,t,i,r,o,a,c])}dateRenderer.RENDERER_TYPE=RENDERER_TYPE;const CELL_TYPE$6="date",DateCellType={CELL_TYPE:CELL_TYPE$6,editor:DateEditor,renderer:dateRenderer,validator:dateValidator},CELL_TYPE$5="dropdown",DropdownCellType={CELL_TYPE:CELL_TYPE$5,editor:DropdownEditor,renderer:dropdownRenderer,validator:dropdownValidator},CELL_TYPE$4="handsontable",HandsontableCellType={CELL_TYPE:CELL_TYPE$4,editor:HandsontableEditor,renderer:handsontableRenderer},CELL_TYPE$3="numeric",NumericCellType={CELL_TYPE:CELL_TYPE$3,editor:NumericEditor,renderer:numericRenderer,validator:numericValidator,dataType:"number"},CELL_TYPE$2="password",PasswordCellType={CELL_TYPE:CELL_TYPE$2,editor:PasswordEditor,renderer:passwordRenderer,copyable:!1},CELL_TYPE$1="select",SelectCellType={CELL_TYPE:CELL_TYPE$1,editor:SelectEditor,renderer:selectRenderer},CELL_TYPE="time",TimeCellType={CELL_TYPE,editor:TimeEditor,renderer:timeRenderer,validator:timeValidator};function registerAllCellTypes(){_register(AutocompleteCellType),_register(CheckboxCellType),_register(DateCellType),_register(DropdownCellType),_register(HandsontableCellType),_register(NumericCellType),_register(PasswordCellType),_register(SelectCellType),_register(TextCellType),_register(TimeCellType)}var import_es_error_cause$88=__toESM(require_es_error_cause(),1),import_es_array_push$67=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$40(e,t){_checkPrivateRedeclaration$52(e,t),t.add(e)}function _classPrivateFieldInitSpec$36(e,t,i){_checkPrivateRedeclaration$52(e,t),t.set(e,i)}function _checkPrivateRedeclaration$52(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$58(e,t,i){return(t=_toPropertyKey$59(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$59(e){var t=_toPrimitive$59(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$59(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet$36(e,t){return e.get(_assertClassBrand$52(e,t))}function _assertClassBrand$52(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const DEPS_TYPE_CHECKERS=new Map([["plugin",hasPlugin],["cell-type",hasItem],["editor",hasItem$3],["renderer",hasItem$2],["validator",hasItem$1]]),PLUGIN_KEY$33="base",missingDepsMsgs=[];let initializedPlugins=null;var _hooks=new WeakMap,_BasePlugin_brand=new WeakSet,BasePlugin=class{static get PLUGIN_KEY(){return PLUGIN_KEY$33}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){_classPrivateMethodInitSpec$40(this,_BasePlugin_brand),_defineProperty$58(this,"eventManager",new eventManager_default(this)),_defineProperty$58(this,"pluginName",null),_defineProperty$58(this,"pluginsInitializedCallbacks",[]),_defineProperty$58(this,"isPluginsReady",!1),_defineProperty$58(this,"enabled",!1),_defineProperty$58(this,"initialized",!1),_classPrivateFieldInitSpec$36(this,_hooks,{}),defineGetter(this,"hot",e,{writable:!1}),initializedPlugins=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const r=[];if(t.forEach(o=>{const[a,c]=o.split(":");if(!DEPS_TYPE_CHECKERS.has(a))throw new Error(`Unknown plugin dependency type "${a}" was found.`);DEPS_TYPE_CHECKERS.get(a)(c)||r.push(` - ${c} (${a})`)}),r.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${r.join(`
`)}
`].join("");missingDepsMsgs.push(o)}}if(initializedPlugins||(initializedPlugins=getPluginsNames()),initializedPlugins.indexOf("UndoRedo")>=0&&initializedPlugins.splice(initializedPlugins.indexOf("UndoRedo"),1),initializedPlugins.indexOf(this.pluginName)>=0&&initializedPlugins.splice(initializedPlugins.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),initializedPlugins.length===0){if(missingDepsMsgs.length>0){const r=[`${missingDepsMsgs.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(r)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,t,i){_classPrivateFieldGet$36(_hooks,this)[e]=_classPrivateFieldGet$36(_hooks,this)[e]||[];const r=_classPrivateFieldGet$36(_hooks,this)[e];this.hot.addHook(e,t,i),r.push(t),_classPrivateFieldGet$36(_hooks,this)[e]=r}removeHooks(e){arrayEach$1(_classPrivateFieldGet$36(_hooks,this)[e]||[],t=>{this.hot.removeHook(e,t)})}clearHooks(){const e=_classPrivateFieldGet$36(_hooks,this);objectEach(e,(t,i)=>this.removeHooks(i)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){arrayEach$1(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=_assertClassBrand$52(_BasePlugin_brand,this,_isRelevantToSettings).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),objectEach(this,(t,i)=>{i!=="hot"&&(this[i]=null)}),delete this.t,delete this.hot}};function _isRelevantToSettings(e){if(!e)return!1;const t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(let i=0;i<t.length;i++)if(e[t[i]]!==void 0)return!0;return!1}var import_es_error_cause$87=__toESM(require_es_error_cause(),1),import_es_array_push$66=__toESM(require_es_array_push(),1);function _defineProperty$57(e,t,i){return(t=_toPropertyKey$58(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$58(e){var t=_toPrimitive$58(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$58(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GhostTable$1=class{constructor(e){_defineProperty$57(this,"hot",null),_defineProperty$57(this,"container",null),_defineProperty$57(this,"injected",!1),_defineProperty$57(this,"rows",[]),_defineProperty$57(this,"columns",[]),_defineProperty$57(this,"samples",null),_defineProperty$57(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={row:e};this.rows.push(i),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(t!=null){const i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={col:e};this.columns.push(i),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(e){this.injected||this.injectTable(),arrayEach$1(this.rows,t=>{const{height:i}=t.table.getBoundingClientRect();e(t.row,Math.ceil(i)-1)})}getWidths(e){this.injected||this.injectTable(),arrayEach$1(this.columns,t=>{const{width:i}=t.table.getBoundingClientRect();e(t.col,Math.ceil(i))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{arrayEach$1(i.strings,r=>{t.appendChild(this.createColElement(r.col,e))})}),t}createRow(e){const{rootDocument:t}=this.hot,i=t.createDocumentFragment(),r=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,r),i.appendChild(r)),this.samples.forEach(o=>{arrayEach$1(o.strings,a=>{const c=a.col,u=this.hot.getCellMeta(e,c),h=this.hot.getCellRenderer(u),d=t.createElement("td");d.setAttribute("ghost-table",1),h(this.hot,d,e,c,this.hot.colToProp(c),a.value,u),i.appendChild(d)})}),i}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){const r=e.createElement("th");i.push([-1,r]),t.appendChild(r)}this.samples.forEach(r=>{arrayEach$1(r.strings,o=>{const a=o.col,c=e.createElement("th");i.push([a,c]),t.appendChild(c)})}),this.table.tHead.appendChild(t),arrayEach$1(i,r=>{const[o,a]=r;this.hot.view.appendColHeader(o,a)})}createCol(e){const{rootDocument:t}=this.hot,i=t.createDocumentFragment();return this.samples.forEach(r=>{arrayEach$1(r.strings,o=>{const a=o.row,c=this.hot.getCellMeta(a,e),u=this.hot.getCellRenderer(c),h=t.createElement("td"),d=t.createElement("tr");h.setAttribute("ghost-table",1),u(this.hot,h,a,e,this.hot.colToProp(e),o.value,c),d.appendChild(h),i.appendChild(d)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,t){const i=this.hot.rootDocument.createElement("col");let r=0;t>=0&&e>=0&&(r=this.hot.getCellMeta(t,e).colspan);let o=this.hot.getColWidth(e);if(r>1)for(let a=e+1;a<e+r;a++)o+=this.hot.getColWidth(a);return i.style.width=`${o}px`,i}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,i=t.createDocumentFragment(),r=t.createElement("table"),o=t.createElement("thead"),a=t.createElement("tbody"),c=t.createElement("colgroup"),u=t.createElement("tr"),h=t.createElement("th");return this.isVertical()&&r.appendChild(c),this.isHorizontal()&&(u.appendChild(h),o.appendChild(u),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(o),this.isVertical()&&a.appendChild(u),r.appendChild(a),addClass$1(r,e),i.appendChild(r),{fragment:i,table:r,tHead:o,tBody:a,colGroup:c,tr:u,th:h}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,i=t.createDocumentFragment(),r=t.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return addClass$1(r,o),i.appendChild(r),{fragment:i,container:r}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}},ghostTable_default$1=GhostTable$1,import_es_error_cause$86=__toESM(require_es_error_cause(),1),import_es_array_push$65=__toESM(require_es_array_push(),1);function _defineProperty$56(e,t,i){return(t=_toPropertyKey$57(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$57(e){var t=_toPrimitive$57(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$57(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SamplesGenerator=class ts{static get SAMPLE_COUNT(){return 3}constructor(t){_defineProperty$56(this,"samples",null),_defineProperty$56(this,"dataFactory",null),_defineProperty$56(this,"customSampleCount",null),_defineProperty$56(this,"allowDuplicates",!1),this.dataFactory=t}getSampleCount(){return this.customSampleCount?this.customSampleCount:ts.SAMPLE_COUNT}setSampleCount(t){this.customSampleCount=t}setAllowDuplicates(t){this.allowDuplicates=t}generateRowSamples(t,i){return this.generateSamples("row",i,t)}generateColumnSamples(t,i){return this.generateSamples("col",i,t)}generateSamples(t,i,r){const o=new Map,{from:a,to:c}=typeof r=="number"?{from:r,to:r}:r;return rangeEach(a,c,u=>{const h=this.generateSample(t,i,u);o.set(u,h)}),o}generateSample(t,i,r){if(t!=="row"&&t!=="col")throw new Error("Unsupported sample type");const o=new Map,a=t==="row"?"col":"row",c=[];return rangeEach(i.from,i.to,u=>{const h=t==="row"?this.dataFactory(r,u):this.dataFactory(u,r);if(h===!1)return;const{value:d,bundleSeed:f}=h,m=typeof f=="string"&&f.length>0;let g;m?g=f:isObject$4(d)?g=`${Object.keys(d).length}`:Array.isArray(d)?g=`${d.length}`:g=`${stringify$3(d).length}`,o.has(g)||o.set(g,{needed:this.getSampleCount(),strings:[]});const v=o.get(g);v.needed&&(!(c.indexOf(d)>-1)||this.allowDuplicates||m)&&(v.strings.push({value:d,[a]:u}),c.push(d),v.needed-=1)}),o}},samplesGenerator_default=SamplesGenerator,import_es_error_cause$85=__toESM(require_es_error_cause(),1),import_es_array_push$64=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$39(e,t){_checkPrivateRedeclaration$51(e,t),t.add(e)}function _classPrivateFieldInitSpec$35(e,t,i){_checkPrivateRedeclaration$51(e,t),t.set(e,i)}function _checkPrivateRedeclaration$51(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$55(e,t,i){return(t=_toPropertyKey$56(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$56(e){var t=_toPrimitive$56(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$56(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet$35(e,t){return e.get(_assertClassBrand$51(e,t))}function _classPrivateFieldSet$34(e,t,i){return e.set(_assertClassBrand$51(e,t),i),i}function _assertClassBrand$51(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}pluginHooks_default.getSingleton().register("modifyAutoColumnSizeSeed");const PLUGIN_KEY$32="autoColumnSize",PLUGIN_PRIORITY$31=10,COLUMN_SIZE_MAP_NAME="autoColumnSize";var _cachedColumnHeaders=new WeakMap,_visualColumnsToRefresh=new WeakMap,_AutoColumnSize_brand=new WeakSet,AutoColumnSize=class Ti extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$32}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$31}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(t){super(t),_classPrivateMethodInitSpec$39(this,_AutoColumnSize_brand),_defineProperty$55(this,"ghostTable",new ghostTable_default$1(this.hot)),_defineProperty$55(this,"samplesGenerator",new samplesGenerator_default((i,r)=>{const o=this.hot.toPhysicalRow(i),a=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(o)||this.hot.columnIndexMapper.isHidden(a))return!1;const c=this.hot.getCellMeta(i,r);let u="";c.spanned||(u=this.hot.getDataAtCell(i,r));let h="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(h=this.hot.runHooks("modifyAutoColumnSizeSeed",h,c,u)),{value:u,bundleSeed:h}})),_defineProperty$55(this,"inProgress",!1),_defineProperty$55(this,"measuredColumns",0),_defineProperty$55(this,"columnWidthsMap",new PhysicalIndexToValueMap),_classPrivateFieldInitSpec$35(this,_cachedColumnHeaders,[]),_classPrivateFieldInitSpec$35(this,_visualColumnsToRefresh,[]),this.hot.columnIndexMapper.registerMap(COLUMN_SIZE_MAP_NAME,this.columnWidthsMap),this.addHook("beforeColumnResize",(i,r,o)=>_assertClassBrand$51(_AutoColumnSize_brand,this,_onBeforeColumnResize$1).call(this,i,r,o))}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$32]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var t=this;if(this.enabled)return;const i=this.hot.getSettings()[PLUGIN_KEY$32];i&&i.useHeaders!==null&&i.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",i.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return _assertClassBrand$51(_AutoColumnSize_brand,t,_onAfterLoadData$7).call(t,...o)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return _assertClassBrand$51(_AutoColumnSize_brand,t,_onBeforeChange$1).call(t,...o)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return _assertClassBrand$51(_AutoColumnSize_brand,t,_onAfterFormulasValuesUpdate$1).call(t,...o)}),this.addHook("beforeRender",()=>_assertClassBrand$51(_AutoColumnSize_brand,this,_onBeforeRender$1).call(this)),this.addHook("modifyColWidth",(r,o)=>this.getColumnWidth(o,r)),this.addHook("init",()=>_assertClassBrand$51(_AutoColumnSize_brand,this,_onInit$3).call(this)),super.enablePlugin()}updatePlugin(){_classPrivateFieldSet$34(_visualColumnsToRefresh,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(t,i,r)=>_assertClassBrand$51(_AutoColumnSize_brand,this,_onBeforeColumnResize$1).call(this,t,i,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const t=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();if(t===-1||i===-1)return;const r=this.hot.renderCall;this.calculateColumnsWidth({from:t,to:i},void 0,r)}calculateColumnsWidth(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=typeof t=="number"?{from:t,to:t}:t,a=typeof i=="number"?{from:i,to:i}:i;rangeEach(o.from,o.to,c=>{let u=this.hot.toPhysicalColumn(c);u===null&&(u=c),(r||this.columnWidthsMap.getValueAtIndex(u)===null&&!this.hot._getColWidthFromSettings(u))&&this.samplesGenerator.generateColumnSamples(c,a).forEach((d,f)=>this.ghostTable.addColumn(f,d))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((c,u)=>{const h=this.hot.toPhysicalColumn(c);this.columnWidthsMap.setValueAtIndex(h,u)})},!0),this.measuredColumns=o.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const o=this.hot.countCols()-1;let a=null;this.inProgress=!0;const c=()=>{if(!this.hot){cancelAnimationFrame$1(a),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+Ti.CALCULATION_STEP,o)},t,i),r=r+Ti.CALCULATION_STEP+1,r<o?a=requestAnimationFrame$1(c):(cancelAnimationFrame$1(a),this.inProgress=!1,this.hot.view.adjustElementsSize())},u=this.getSyncCalculationLimit();u>=0&&(this.calculateColumnsWidth({from:0,to:u},t,i),r=u+1),r<o?c():this.inProgress=!1}setSamplingOptions(){const t=this.hot.getSettings()[PLUGIN_KEY$32],i=t&&hasOwnProperty$15(t,"samplingRatio")?t.samplingRatio:void 0,r=t&&hasOwnProperty$15(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const t=this.hot.getSettings()[PLUGIN_KEY$32];let i=Ti.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return isObject$4(t)&&(i=t.syncLimit,isPercentValue(i)?i=valueAccordingPercent(r,i):i>>=0),Math.min(i,r)}getColumnWidth(t,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=i;return o===void 0&&(o=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t)),r&&typeof o=="number"&&(o=Math.max(o,DEFAULT_WIDTH))),o}getFirstVisibleColumn(){var t;return(t=this.hot.view.getFirstRenderedVisibleColumn())!==null&&t!==void 0?t:-1}getLastVisibleColumn(){var t;return(t=this.hot.view.getLastRenderedVisibleColumn())!==null&&t!==void 0?t:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,o,a)=>{const c=_classPrivateFieldGet$35(_cachedColumnHeaders,this).length;return(c-1<a||_classPrivateFieldGet$35(_cachedColumnHeaders,this)[a]!==o)&&r.push(this.hot.toVisualColumn(a)),c-1<a?_classPrivateFieldGet$35(_cachedColumnHeaders,this).push(o):_classPrivateFieldGet$35(_cachedColumnHeaders,this)[a]=o,r},[])}clearCache(t){Array.isArray(t)?this.hot.batchExecution(()=>{t.forEach(i=>{this.columnWidthsMap.setValueAtIndex(i,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(t=>t===null).length}destroy(){this.ghostTable.clean(),super.destroy()}};function _calculateSpecificColumnsWidth(e){const t={from:0,to:this.hot.countRows()-1};e.forEach(i=>{const r=this.hot.toPhysicalColumn(i);r!==null&&(this.hot._getColWidthFromSettings(r)||this.samplesGenerator.generateColumnSamples(i,t).forEach((a,c)=>this.ghostTable.addColumn(c,a)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((i,r)=>{const o=this.hot.toPhysicalColumn(i);this.columnWidthsMap.setValueAtIndex(o,r)})},!0),this.ghostTable.clean())}function _onBeforeRender$1(){this.calculateVisibleColumnsWidth(),this.inProgress||(_assertClassBrand$51(_AutoColumnSize_brand,this,_calculateSpecificColumnsWidth).call(this,_classPrivateFieldGet$35(_visualColumnsToRefresh,this)),_classPrivateFieldSet$34(_visualColumnsToRefresh,this,[]))}function _onAfterLoadData$7(e,t){t||this.recalculateAllColumnsWidth()}function _onBeforeChange$1(e){const t=e.reduce((i,r)=>{let[,o]=r;const a=this.hot.propToCol(o);return Number.isInteger(a)&&i.indexOf(a)===-1&&i.push(a),i},[]);_classPrivateFieldGet$35(_visualColumnsToRefresh,this).push(...t)}function _onBeforeColumnResize$1(e,t,i){let r=e;return i&&(this.calculateColumnsWidth(t,void 0,!0),r=this.getColumnWidth(t,void 0,!1)),r}function _onInit$3(){_classPrivateFieldSet$34(_cachedColumnHeaders,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function _onAfterFormulasValuesUpdate$1(e){const t=e.reduce((i,r)=>{var o;const a=(o=r.address)===null||o===void 0?void 0:o.col;if(Number.isInteger(a)){const c=this.hot.toVisualColumn(a);i.indexOf(c)===-1&&i.push(c)}return i},[]);_classPrivateFieldGet$35(_visualColumnsToRefresh,this).push(...t)}const DIRECTIONS={horizontal:"horizontal",vertical:"vertical"};function getDragDirectionAndRange(e,t,i){let r,o,a;return t[0]===e[0]&&t[1]<e[1]?(a="left",r=i(t[0],t[1]),o=i(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(a="right",r=i(t[0],e[3]+1),o=i(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(a="up",r=i(t[0],t[1]),o=i(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(a="down",r=i(e[2]+1,t[1]),o=i(t[2],t[3])),r&&r.normalize(),o&&o.normalize(),{directionOfDrag:a,startOfDragCoords:r,endOfDragCoords:o}}function getMappedFillHandleSetting(e){const t={};return e===!0?(t.directions=Object.keys(DIRECTIONS),t.autoInsertRow=!0):isObject$4(e)?(isDefined(e.autoInsertRow)?e.direction===DIRECTIONS.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,isDefined(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(DIRECTIONS)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}var import_es_error_cause$84=__toESM(require_es_error_cause(),1),import_es_array_push$63=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$38(e,t){_checkPrivateRedeclaration$50(e,t),t.add(e)}function _checkPrivateRedeclaration$50(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$54(e,t,i){return(t=_toPropertyKey$55(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$55(e){var t=_toPrimitive$55(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$55(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand$50(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}pluginHooks_default.getSingleton().register("modifyAutofillRange"),pluginHooks_default.getSingleton().register("beforeAutofill"),pluginHooks_default.getSingleton().register("afterAutofill");const PLUGIN_KEY$31="autofill",PLUGIN_PRIORITY$30=20,SETTING_KEYS$3=["fillHandle"],INSERT_ROW_ALTER_ACTION_NAME="insert_row_below",INTERVAL_FOR_ADDING_ROW=200;var _Autofill_brand=new WeakSet,Autofill=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$38(this,_Autofill_brand),_defineProperty$54(this,"addingStarted",!1),_defineProperty$54(this,"mouseDownOnCellCorner",!1),_defineProperty$54(this,"mouseDragOutside",!1),_defineProperty$54(this,"handleDraggedCells",0),_defineProperty$54(this,"directions",[]),_defineProperty$54(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$31}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$30}static get SETTING_KEYS(){return[PLUGIN_KEY$31,...SETTING_KEYS$3]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>_assertClassBrand$50(_Autofill_brand,this,_onAfterCellCornerMouseDown).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>_assertClassBrand$50(_Autofill_brand,this,_onCellCornerDblClick).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,t)=>_assertClassBrand$50(_Autofill_brand,this,_onBeforeCellMouseOver).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:i}=e.getTopStartCorner(),{row:r,col:o}=e.getBottomEndCorner(),a=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:i,endRow:r,endCol:o}]),c=[],u=[],h=[];return arrayEach$1(a,d=>{for(let f=d.startRow;f<=d.endRow;f+=1)c.indexOf(f)===-1&&c.push(f);for(let f=d.startCol;f<=d.endCol;f+=1)u.indexOf(f)===-1&&u.push(f)}),arrayEach$1(c,d=>{const f=[];arrayEach$1(u,m=>{f.push(this.hot.getCopyableData(d,m))}),h.push(f)}),h}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,i,r]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),a=o.getTopStartCorner(),c=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const u=[a.row,a.col,c.row,c.col],h=this.hot.runHooks("modifyAutofillRange",[Math.min(a.row,e),Math.min(a.col,t),Math.max(c.row,i),Math.max(c.col,r)],u),{directionOfDrag:d,startOfDragCoords:f,endOfDragCoords:m}=getDragDirectionAndRange(u,h,(g,v)=>this.hot._createCellCoords(g,v));if(f&&f.row>-1&&f.col>-1){const g=this.getSelectionData(),v=o.clone(),_=this.hot._createCellRange(f,f,m),b=this.hot.runHooks("beforeAutofill",g,v,_,d);if(b===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let S=b;const T=b;if(["up","left"].indexOf(d)>-1&&!(T.length===1&&T[0].length===0))if(S=[],d==="up"){const A=m.row-f.row+1,I=A%T.length;for(let R=0;R<A;R++)S.push(T[(R+(T.length-I))%T.length])}else{const A=m.col-f.col+1,I=A%T[0].length;for(let R=0;R<T.length;R++){S.push([]);for(let O=0;O<A;O++)S[R].push(T[R][(O+(T[R].length-I))%T[R].length])}}this.hot.populateFromArray(f.row,f.col,S,m.row,m.col,`${this.pluginName}.fill`,null),this.setSelection(h),this.hot.runHooks("afterAutofill",S,v,_,d),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),i=t.getBottomEndCorner();let r=e;if(this.directions.includes(DIRECTIONS.vertical)&&this.directions.includes(DIRECTIONS.horizontal)){const o=t.getTopStartCorner();(i.col<=e.col||o.col>=e.col)&&(r=this.hot._createCellCoords(i.row,e.col)),(i.row<e.row||o.row>e.row)&&(r=this.hot._createCellCoords(e.row,i.col))}else if(this.directions.includes(DIRECTIONS.vertical))r=this.hot._createCellCoords(e.row,i.col);else if(this.directions.includes(DIRECTIONS.horizontal))r=this.hot._createCellCoords(i.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(r)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(INSERT_ROW_ALTER_ACTION_NAME,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},INTERVAL_FOR_ADDING_ROW)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();e[2]<i-1&&t[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),i=this.hot.countRows();let r;for(let o=e[2]+1;o<i;o++){for(let u=e[1];u<=e[3];u++){const h=t[o][u];if(!isEmpty(h))return-1}const a=t[o][e[1]-1],c=t[o][e[3]+1];(!isEmpty(a)||!isEmpty(c))&&(r=o)}return r}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...arrayMap$1(e,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return t===-1||t===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,i=offset$2(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+outerHeight(this.hot.table),r=offset$2(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+outerWidth(this.hot.table);return e.clientY>i&&e.clientX<=r}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand$50(_Autofill_brand,this,_onMouseUp$5).call(this)),this.eventManager.addEventListener(e,"mousemove",t=>_assertClassBrand$50(_Autofill_brand,this,_onMouseMove$4).call(this,t))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=getMappedFillHandleSetting(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}};function _onCellCornerDblClick(){this.selectAdjacent()&&this.fillIn()}function _onAfterCellCornerMouseDown(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function _onBeforeCellMouseOver(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}function _onMouseUp$5(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function _onMouseMove$4(e){const t=this.getIfMouseWasDraggedOutside(e);this.addingStarted===!1&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}var import_es_error_cause$83=__toESM(require_es_error_cause(),1),import_es_array_push$62=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$37(e,t){_checkPrivateRedeclaration$49(e,t),t.add(e)}function _classPrivateFieldInitSpec$34(e,t,i){_checkPrivateRedeclaration$49(e,t),t.set(e,i)}function _checkPrivateRedeclaration$49(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$53(e,t,i){return(t=_toPropertyKey$54(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$54(e){var t=_toPrimitive$54(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$54(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldSet$33(e,t,i){return e.set(_assertClassBrand$49(e,t),i),i}function _classPrivateFieldGet$34(e,t){return e.get(_assertClassBrand$49(e,t))}function _assertClassBrand$49(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$30="autoRowSize",PLUGIN_PRIORITY$29=40,ROW_WIDTHS_MAP_NAME="autoRowSize";var _visualRowsToRefresh=new WeakMap,_AutoRowSize_brand=new WeakSet,AutoRowSize=class xi extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$30}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$29}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(t){super(t),_classPrivateMethodInitSpec$37(this,_AutoRowSize_brand),_defineProperty$53(this,"headerHeight",null),_defineProperty$53(this,"ghostTable",new ghostTable_default$1(this.hot)),_defineProperty$53(this,"samplesGenerator",new samplesGenerator_default((i,r)=>{const o=this.hot.toPhysicalRow(i),a=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(o)||this.hot.columnIndexMapper.isHidden(a)||i>=0&&r>=0&&this.hot.getCellMeta(i,r).hidden)return!1;let c;return i>=0?c=this.hot.getDataAtCell(i,r):i===-1&&(c=this.hot.getColHeader(r)),{value:c}})),_defineProperty$53(this,"inProgress",!1),_defineProperty$53(this,"measuredRows",0),_defineProperty$53(this,"rowHeightsMap",new PhysicalIndexToValueMap),_classPrivateFieldInitSpec$34(this,_visualRowsToRefresh,[]),this.hot.rowIndexMapper.registerMap(ROW_WIDTHS_MAP_NAME,this.rowHeightsMap),this.addHook("beforeRowResize",(i,r,o)=>_assertClassBrand$49(_AutoRowSize_brand,this,_onBeforeRowResize).call(this,i,r,o))}isEnabled(){const t=this.hot.getSettings()[PLUGIN_KEY$30];return t===!0||isObject$4(t)}enablePlugin(){var t=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$49(_AutoRowSize_brand,t,_onAfterLoadData$6).call(t,...r)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$49(_AutoRowSize_brand,t,_onBeforeChange).call(t,...r)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$49(_AutoRowSize_brand,t,_onAfterFormulasValuesUpdate).call(t,...r)}),this.addHook("beforeRender",()=>_assertClassBrand$49(_AutoRowSize_brand,this,_onBeforeRender).call(this)),this.addHook("modifyRowHeight",(i,r)=>this.getRowHeight(r,i)),this.addHook("init",()=>_assertClassBrand$49(_AutoRowSize_brand,this,_onInit$2).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(t,i,r)=>_assertClassBrand$49(_AutoRowSize_brand,this,_onBeforeRowResize).call(this,t,i,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const t=this.getFirstVisibleRow(),i=this.getLastVisibleRow();if(t===-1||i===-1)return;const r=this.hot.renderCall;this.calculateRowsHeight({from:t,to:i},void 0,r)}calculateRowsHeight(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=typeof t=="number"?{from:t,to:t}:t,a=typeof i=="number"?{from:i,to:i}:i;if(this.hot.getColHeader(0)!==null){const c=this.samplesGenerator.generateRowSamples(-1,a);this.ghostTable.addColumnHeadersRow(c.get(-1))}rangeEach(o.from,o.to,c=>{let u=this.hot.toPhysicalRow(c);u===null&&(u=c),(r||this.rowHeightsMap.getValueAtIndex(u)===null)&&this.samplesGenerator.generateRowSamples(c,a).forEach((d,f)=>this.ghostTable.addRow(f,d))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((c,u)=>{c<0?this.headerHeight=u:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(c),u)})},!0),this.measuredRows=o.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const o=this.hot.countRows()-1;let a=null;this.inProgress=!0;const c=()=>{if(!this.hot){cancelAnimationFrame$1(a),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+xi.CALCULATION_STEP,o)},t,i),r=r+xi.CALCULATION_STEP+1,r<o?a=requestAnimationFrame$1(c):(cancelAnimationFrame$1(a),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},u=this.getSyncCalculationLimit();u>=0&&(this.calculateRowsHeight({from:0,to:u},t,i),r=u+1),r<o?c():(this.inProgress=!1,this.hot.view.adjustElementsSize())}setSamplingOptions(){const t=this.hot.getSettings()[PLUGIN_KEY$30],i=t&&hasOwnProperty$15(t,"samplingRatio")?t.samplingRatio:void 0,r=t&&hasOwnProperty$15(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;i&&!isNaN(i)&&this.samplesGenerator.setSampleCount(parseInt(i,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const t=this.hot.getSettings()[PLUGIN_KEY$30];let i=xi.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return isObject$4(t)&&(i=t.syncLimit,isPercentValue(i)?i=valueAccordingPercent(r,i):i>>=0),Math.min(i,r)}getRowHeight(t,i){const r=t<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(t));let o=i;return r!==null&&r>(i||0)&&(o=r),o}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var t;return(t=this.hot.view.getFirstRenderedVisibleRow())!==null&&t!==void 0?t:-1}getLastVisibleRow(){var t;return(t=this.hot.view.getLastRenderedVisibleRow())!==null&&t!==void 0?t:-1}clearCache(t){this.headerHeight=null,Array.isArray(t)?this.hot.batchExecution(()=>{t.forEach(i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(t){const{from:i,to:r}=typeof t=="number"?{from:t,to:t}:t;this.hot.batchExecution(()=>{rangeEach(Math.min(i,r),Math.max(i,r),o=>{this.rowHeightsMap.setValueAtIndex(o,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(t=>t===null).length}destroy(){this.ghostTable.clean(),super.destroy()}};function _calculateSpecificRowsHeight(e){const t={from:0,to:this.hot.countCols()-1};e.forEach(i=>{this.samplesGenerator.generateRowSamples(i,t).forEach((o,a)=>this.ghostTable.addRow(a,o))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((i,r)=>{const o=this.hot.toPhysicalRow(i);this.rowHeightsMap.setValueAtIndex(o,r)})},!0),this.ghostTable.clean())}function _onBeforeRender(){this.calculateVisibleRowsHeight(),this.inProgress||(_assertClassBrand$49(_AutoRowSize_brand,this,_calculateSpecificRowsHeight).call(this,_classPrivateFieldGet$34(_visualRowsToRefresh,this)),_classPrivateFieldSet$33(_visualRowsToRefresh,this,[]))}function _onBeforeRowResize(e,t,i){let r=e;return i&&(this.calculateRowsHeight(t,void 0,!0),r=this.getRowHeight(t)),r}function _onAfterLoadData$6(e,t){t||this.recalculateAllRowsHeight()}function _onBeforeChange(e){const t=e.reduce((i,r)=>{let[o]=r;return i.indexOf(o)===-1&&i.push(o),i},[]);_classPrivateFieldGet$34(_visualRowsToRefresh,this).push(...t)}function _onInit$2(){this.recalculateAllRowsHeight()}function _onAfterFormulasValuesUpdate(e){const t=e.reduce((i,r)=>{var o;const a=(o=r.address)===null||o===void 0?void 0:o.row;if(Number.isInteger(a)){const c=this.hot.toVisualRow(a);i.indexOf(c)===-1&&i.push(c)}return i},[]);_classPrivateFieldGet$34(_visualRowsToRefresh,this).push(...t)}const{getListWithInsertedItems:getListWithInsertedItems$1,getListWithRemovedItems:getListWithRemovedItems$1}=alterUtilsFactory("physicallyIndexed");var LooseBindsMap=class extends IndexMap{constructor(){super(e=>e)}insert(e,t){const i=getIncreasedIndexes(this.indexedValues,t);this.indexedValues=getListWithInsertedItems$1(i,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=getListWithRemovedItems$1(this.indexedValues,e);this.indexedValues=getDecreasedIndexes(t,e),super.remove(e)}},looseBindsMap_default=LooseBindsMap;const{getListWithInsertedItems,getListWithRemovedItems}=alterUtilsFactory("physicallyIndexed");var StrictBindsMap=class extends IndexMap{constructor(){super(e=>e)}insert(e,t){this.indexedValues=getListWithInsertedItems(this.indexedValues,e,t,(i,r)=>this.getNextValue(r)),super.insert(e,t)}remove(e){this.indexedValues=getListWithRemovedItems(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}},strictBindsMap_default=StrictBindsMap,import_es_error_cause$82=__toESM(require_es_error_cause(),1);function _classPrivateMethodInitSpec$36(e,t){_checkPrivateRedeclaration$48(e,t),t.add(e)}function _checkPrivateRedeclaration$48(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$52(e,t,i){return(t=_toPropertyKey$53(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$53(e){var t=_toPrimitive$53(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$53(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand$48(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$29="bindRowsWithHeaders",PLUGIN_PRIORITY$28=210,DEFAULT_BIND="loose",bindTypeToMapStrategy=new Map([["loose",looseBindsMap_default],["strict",strictBindsMap_default]]);var _BindRowsWithHeaders_brand=new WeakSet,BindRowsWithHeaders=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$36(this,_BindRowsWithHeaders_brand),_defineProperty$52(this,"headerIndexes",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$29}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$28}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$29]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[PLUGIN_KEY$29];typeof e!="string"&&(e=DEFAULT_BIND);const t=bindTypeToMapStrategy.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",i=>_assertClassBrand$48(_BindRowsWithHeaders_brand,this,_onModifyRowHeader).call(this,i)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}};function _onModifyRowHeader(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}var import_es_error_cause$81=__toESM(require_es_error_cause(),1),import_es_array_push$61=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$35(e,t){_checkPrivateRedeclaration$47(e,t),t.add(e)}function _classPrivateFieldInitSpec$33(e,t,i){_checkPrivateRedeclaration$47(e,t),t.set(e,i)}function _checkPrivateRedeclaration$47(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$51(e,t,i){return(t=_toPropertyKey$52(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$52(e){var t=_toPrimitive$52(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$52(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet$33(e,t){return e.get(_assertClassBrand$47(e,t))}function _classPrivateFieldSet$32(e,t,i){return e.set(_assertClassBrand$47(e,t),i),i}function _assertClassBrand$47(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$28="collapsibleColumns",PLUGIN_PRIORITY$27=290,SETTING_KEYS$2=["nestedHeaders"],COLLAPSIBLE_ELEMENT_CLASS="collapsibleIndicator",SHORTCUTS_GROUP$11=PLUGIN_KEY$28,actionDictionary=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var _collapsedColumnsMap=new WeakMap,_CollapsibleColumns_brand=new WeakSet,CollapsibleColumns=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$35(this,_CollapsibleColumns_brand),_defineProperty$51(this,"nestedHeadersPlugin",null),_defineProperty$51(this,"headerStateManager",null),_classPrivateFieldInitSpec$33(this,_collapsedColumnsMap,null)}static get PLUGIN_KEY(){return PLUGIN_KEY$28}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$27}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[PLUGIN_KEY$28,...SETTING_KEYS$2]}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$28]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||warn("You need to configure the Nested Headers plugin in order to use collapsible headers."),_classPrivateFieldSet$32(_collapsedColumnsMap,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>_assertClassBrand$47(_CollapsibleColumns_brand,this,_onInit$1).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$47(_CollapsibleColumns_brand,e,_onAfterLoadData$5).call(e,...r)}),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$47(_CollapsibleColumns_brand,e,_onAfterGetColHeader$4).call(e,...r)}),this.addHook("beforeOnCellMouseDown",(i,r,o)=>_assertClassBrand$47(_CollapsibleColumns_brand,this,_onBeforeOnCellMouseDown$6).call(this,i,r,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),_classPrivateFieldSet$32(_collapsedColumnsMap,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:t,col:i}=this.hot.getSelectedRangeLast().highlight,{collapsible:r,isCollapsed:o,columnIndex:a}=(e=this.headerStateManager.getHeaderTreeNodeData(t,i))!==null&&e!==void 0?e:{};if(r)return o?this.expandSection({row:t,col:a}):this.collapseSection({row:t,col:a}),!1},runOnlyIf:()=>{var e,t;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.highlight.isHeader())},group:SHORTCUTS_GROUP$11,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$11)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(a){a&&a.parentNode.removeChild(a)};rangeEach(0,e-1,a=>{const c=t.childNodes[a],u=i.childNodes[a],h=r?r.childNodes[a]:null;rangeEach(0,c.childNodes.length-1,d=>{let f=c.childNodes[d].querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`);o(f),u&&u.childNodes[d]&&(f=u.childNodes[d].querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`),o(f)),r&&h&&h.childNodes[d]&&(f=h.childNodes[d].querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`),o(f))})},!0)}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes(i=>{const{collapsible:r,origColspan:o,headerLevel:a,columnIndex:c,isCollapsed:u}=i;if(r===!0&&o>1&&(u&&e==="expand"||!u&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(a),col:c}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!actionDictionary.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const i=arrayFilter$1(e,g=>{let{row:v}=g;return v<0});let r=i.length>0;arrayEach$1(i,g=>{var v;let{row:_,col:b}=g;const{collapsible:S,isCollapsed:T}=(v=this.headerStateManager.getHeaderSettings(_,b))!==null&&v!==void 0?v:{};if(!S||T&&t==="collapse"||!T&&t==="expand")return r=!1,!1});const o=[],a=[];r&&arrayEach$1(i,g=>{let{row:v,col:_}=g;const{colspanCompensation:b,affectedColumns:S,rollbackModification:T}=this.headerStateManager.triggerNodeModification(t,v,_);b>0&&(a.push(...S),o.push(T))});const c=this.getCollapsedColumns();let u=[];t==="collapse"?u=arrayUnique([...c,...a]):t==="expand"&&(u=arrayFilter$1(c,g=>!a.includes(g)));const h=actionDictionary.get(t);if(this.hot.runHooks(h.beforeHook,c,u,r)===!1){arrayEach$1(o,g=>{g()});return}this.hot.batchExecution(()=>{arrayEach$1(a,g=>{_classPrivateFieldGet$33(_collapsedColumnsMap,this).setValueAtIndex(this.hot.toPhysicalColumn(g),h.hideColumn)})},!0);const f=this.getCollapsedColumns().length!==c.length,m=this.hot.getSelectedRangeLast();if(t==="collapse"&&f&&m){const{row:g,col:v}=m.highlight;if((this.hot.rowIndexMapper.isHidden(g)||this.hot.columnIndexMapper.isHidden(v))&&a.includes(v)){const b=g>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(g,1,!0):g,S=v>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(v,1,!0):v;b!==null&&S!==null&&this.hot.selectCell(b,S)}}this.hot.runHooks(h.afterHook,c,u,r,f),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return _classPrivateFieldGet$33(_collapsedColumnsMap,this).getHiddenIndexes()}destroy(){_classPrivateFieldSet$32(_collapsedColumnsMap,this,null),super.destroy()}};function _onAfterGetColHeader$4(e,t,i){var r;const{collapsible:o,origColspan:a,isCollapsed:c}=(r=this.headerStateManager.getHeaderSettings(i,e))!==null&&r!==void 0?r:{},u=o&&a>1&&e>=this.hot.getSettings().fixedColumnsStart,h=this.hot.getSettings().ariaTags;let d=t.querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`);if(removeAttribute(t,[A11Y_EXPANDED("")[0]]),u)d||(d=this.hot.rootDocument.createElement("div"),addClass$1(d,COLLAPSIBLE_ELEMENT_CLASS),t.querySelector("div:first-child").appendChild(d)),removeClass$1(d,["collapsed","expanded"]),c?(addClass$1(d,"collapsed"),fastInnerText(d,"+"),h&&setAttribute(t,...A11Y_EXPANDED(!1))):(addClass$1(d,"expanded"),fastInnerText(d,"-"),h&&setAttribute(t,...A11Y_EXPANDED(!0))),h&&setAttribute(d,...A11Y_HIDDEN());else{var f;(f=d)===null||f===void 0||f.remove()}}function _onBeforeOnCellMouseDown$6(e,t){hasClass$1(e.target,COLLAPSIBLE_ELEMENT_CLASS)&&(hasClass$1(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):hasClass$1(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),stopImmediatePropagation(e))}function _onInit$1(){this.updatePlugin()}function _onAfterLoadData$5(e,t){t||this.updatePlugin()}var import_es_error_cause$80=__toESM(require_es_error_cause(),1);function _defineProperty$50(e,t,i){return(t=_toPropertyKey$51(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$51(e){var t=_toPrimitive$51(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$51(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}const inheritedColumnProperties=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],SORT_EMPTY_CELLS_DEFAULT=!1,SHOW_SORT_INDICATOR_DEFAULT=!0,HEADER_ACTION_DEFAULT=!0;var ColumnStatesManager=class{constructor(e,t){_defineProperty$50(this,"hot",void 0),_defineProperty$50(this,"sortingStates",new LinkedPhysicalIndexToValueMap),_defineProperty$50(this,"sortEmptyCells",SORT_EMPTY_CELLS_DEFAULT),_defineProperty$50(this,"indicator",SHOW_SORT_INDICATOR_DEFAULT),_defineProperty$50(this,"headerAction",HEADER_ACTION_DEFAULT),_defineProperty$50(this,"compareFunctionFactory",void 0),_defineProperty$50(this,"mapName",void 0),this.hot=e,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){isObject$4(e)&&objectEach(e,(t,i)=>{inheritedColumnProperties.includes(i)&&(this[i]=t)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||t===void 0?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[i]=t;return i===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return isObject$4(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(t=>{let[i,r]=t;return{column:this.hot.toVisualColumn(i),...r}})}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(isDefined(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}};function compareFunctionFactory$4(e,t,i){const r=t.locale;return function(o,a){const{sortEmptyCells:c}=i;return typeof o=="string"&&(o=o.toLocaleLowerCase(r)),typeof a=="string"&&(a=a.toLocaleLowerCase(r)),o===a?DO_NOT_SWAP:isEmpty(o)?isEmpty(a)?DO_NOT_SWAP:c&&e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:isEmpty(a)?c&&e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:isNaN(o)&&!isNaN(a)?e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:!isNaN(o)&&isNaN(a)||(isNaN(o)||isNaN(a)||(o=parseFloat(o),a=parseFloat(a)),o<a)?e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:o>a?e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}const COLUMN_DATA_TYPE$4="default";function compareFunctionFactory$3(e,t,i){return function(r,o){const a=parseFloat(r),c=parseFloat(o),{sortEmptyCells:u}=i;if(a===c||isNaN(a)&&isNaN(c))return DO_NOT_SWAP;if(u){if(isEmpty(r))return e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND;if(isEmpty(o))return e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND}return isNaN(a)?FIRST_AFTER_SECOND:isNaN(c)?FIRST_BEFORE_SECOND:a<c?e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:a>c?e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}const COLUMN_DATA_TYPE$3="numeric";function compareFunctionFactory$2(e,t,i){const r=t.checkedTemplate,o=t.uncheckedTemplate,{sortEmptyCells:a}=i;return function(c,u){const h=isEmpty(c),d=isEmpty(u),f=h?o:c,m=d?o:u,g=f===o||f===r,v=m===o||m===r;if(a===!1){if(h&&d===!1)return FIRST_AFTER_SECOND;if(h===!1&&d)return FIRST_BEFORE_SECOND}return g===!1&&v?e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:g&&v===!1?e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:g===!1&&v===!1?compareFunctionFactory$4(e,t,i)(c,u):f===o&&m===r?e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:f===r&&m===o?e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}const COLUMN_DATA_TYPE$2="checkbox";function compareFunctionFactory$1(e,t,i){return createDateTimeCompareFunction(e,t.dateFormat,i)}const COLUMN_DATA_TYPE$1="date";function compareFunctionFactory(e,t,i){return createDateTimeCompareFunction(e,t.timeFormat,i)}const COLUMN_DATA_TYPE="time",{register:registerCompareFunctionFactory,getItem:getGloballyCompareFunctionFactory,hasItem:hasGloballyCompareFunctionFactory}=staticRegister("sorting.compareFunctionFactory"),{register:registerRootComparator,getItem:getRootComparator}=staticRegister("sorting.mainSortComparator");function getCompareFunctionFactory(e){return hasGloballyCompareFunctionFactory(e)?getGloballyCompareFunctionFactory(e):getGloballyCompareFunctionFactory(COLUMN_DATA_TYPE$4)}registerCompareFunctionFactory(COLUMN_DATA_TYPE$2,compareFunctionFactory$2),registerCompareFunctionFactory(COLUMN_DATA_TYPE$1,compareFunctionFactory$1),registerCompareFunctionFactory(COLUMN_DATA_TYPE$4,compareFunctionFactory$4),registerCompareFunctionFactory(COLUMN_DATA_TYPE$3,compareFunctionFactory$3),registerCompareFunctionFactory(COLUMN_DATA_TYPE,compareFunctionFactory);const DO_NOT_SWAP=0,FIRST_BEFORE_SECOND=-1,FIRST_AFTER_SECOND=1;function sort(e,t){const i=getRootComparator(t);for(var r=arguments.length,o=new Array(r>2?r-2:0),a=2;a<r;a++)o[a-2]=arguments[a];e.sort(i(...o))}var import_es_set_difference_v2$11=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$11=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$11=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$11=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$11=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$11=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$11=__toESM(require_es_set_union_v2(),1),import_moment$6=__toESM(require_moment(),1);const ASC_SORT_STATE="asc",DESC_SORT_STATE="desc",HEADER_SPAN_CLASS="colHeader";function isValidColumnState(e){if(isObject$4(e)===!1)return!1;const{column:t,sortOrder:i}=e;return Number.isInteger(t)&&[ASC_SORT_STATE,DESC_SORT_STATE].includes(i)}function areValidSortStates(e){if(e.some(i=>isValidColumnState(i)===!1))return!1;const t=e.map(i=>{let{column:r}=i;return r});return new Set(t).size===t.length}function getNextSortOrder(e){if(e!==DESC_SORT_STATE)return e===ASC_SORT_STATE?DESC_SORT_STATE:ASC_SORT_STATE}function getHeaderSpanElement(e){return e.querySelector(`.${HEADER_SPAN_CLASS}`)}function isFirstLevelColumnHeader(e,t){if(e<0||!t.parentNode)return!1;const i=t.parentNode.parentNode.childNodes;return Array.from(i).indexOf(t.parentNode)-i.length===-1}function wasHeaderClickedProperly(e,t,i){return e===-1&&t>=0&&isRightClick(i)===!1}function createDateTimeCompareFunction(e,t,i){return function(r,o){const{sortEmptyCells:a}=i;if(r===o)return DO_NOT_SWAP;if(isEmpty(r))return isEmpty(o)?DO_NOT_SWAP:a&&e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND;if(isEmpty(o))return a&&e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND;const c=(0,import_moment$6.default)(r,t),u=(0,import_moment$6.default)(o,t);return c.isValid()?u.isValid()?u.isAfter(c)?e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:u.isBefore(c)?e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP:FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND}}var import_es_array_push$60=__toESM(require_es_array_push(),1);const HEADER_CLASS_ASC_SORT="ascending",HEADER_CLASS_DESC_SORT="descending",HEADER_CLASS_INDICATOR_DISABLED="indicatorDisabled",HEADER_SORT_CLASS="columnSorting",HEADER_ACTION_CLASS="sortAction",orderToCssClass=new Map([[ASC_SORT_STATE,HEADER_CLASS_ASC_SORT],[DESC_SORT_STATE,HEADER_CLASS_DESC_SORT]]);function getClassesToAdd$1(e,t,i,r){const o=[HEADER_SORT_CLASS];if(r&&o.push(HEADER_ACTION_CLASS),i===!1)return o.push(HEADER_CLASS_INDICATOR_DISABLED),o;const a=e.getSortOrderOfColumn(t);return isDefined(a)&&o.push(orderToCssClass.get(a)),o}function getClassesToRemove$1(){return Array.from(orderToCssClass.values()).concat(HEADER_ACTION_CLASS,HEADER_CLASS_INDICATOR_DISABLED,HEADER_SORT_CLASS)}function rootComparator$1(e,t){return function(i,r){const[,...o]=i,[,...a]=r;return function(u){const h=e[u],d=t[u],f=o[u],m=a[u],g=d.columnSorting;return(g.compareFunctionFactory?g.compareFunctionFactory:getCompareFunctionFactory(d.type))(h,d,g)(f,m)}(0)}}var import_es_error_cause$79=__toESM(require_es_error_cause(),1),import_es_array_push$59=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$34(e,t){_checkPrivateRedeclaration$46(e,t),t.add(e)}function _checkPrivateRedeclaration$46(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$49(e,t,i){return(t=_toPropertyKey$50(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$50(e){var t=_toPrimitive$50(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$50(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand$46(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$27="columnSorting",PLUGIN_PRIORITY$26=50,APPEND_COLUMN_CONFIG_STRATEGY="append",REPLACE_COLUMN_CONFIG_STRATEGY="replace",SHORTCUTS_GROUP$10=PLUGIN_KEY$27;registerRootComparator(PLUGIN_KEY$27,rootComparator$1),pluginHooks_default.getSingleton().register("beforeColumnSort"),pluginHooks_default.getSingleton().register("afterColumnSort");var _ColumnSorting_brand=new WeakSet,ColumnSorting=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$34(this,_ColumnSorting_brand),_defineProperty$49(this,"columnStatesManager",null),_defineProperty$49(this,"columnMetaCache",null),_defineProperty$49(this,"pluginKey",PLUGIN_KEY$27),_defineProperty$49(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$27}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$26}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new ColumnStatesManager(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new PhysicalIndexToValueMap(t=>{let i=this.hot.toVisualColumn(t);return i===null&&(i=t),this.getMergedPluginSettings(i)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,i)=>_assertClassBrand$46(_ColumnSorting_brand,this,_onAfterGetColHeader$3).call(this,t,i)),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$46(_ColumnSorting_brand,e,_onBeforeOnCellMouseDown$5).call(e,...i)}),this.addHook("afterOnCellMouseDown",(t,i)=>this.onAfterOnCellMouseDown(t,i)),this.addHook("afterInit",()=>_assertClassBrand$46(_ColumnSorting_brand,this,_loadOrSortBySettings).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$46(_ColumnSorting_brand,e,_onAfterLoadData$4).call(e,...i)}),this.hot.view&&_assertClassBrand$46(_ColumnSorting_brand,this,_loadOrSortBySettings).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(t,i)=>{const r=getHeaderSpanElement(i);isFirstLevelColumnHeader(t,i)===!1||r===null||this.updateHeaderClasses(r)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,t;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(i)&&i.row===-1&&i.col>=0},relativeToGroup:EDITOR_EDIT_GROUP,position:"before",group:SHORTCUTS_GROUP$10})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$10)}sort(e){const t=this.getSortConfig(),i=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(i);this.hot.runHooks("beforeColumnSort",t,i,r)!==!1&&(t.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new IndexesSequence),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",t,r?i:t,r),r&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return isDefined(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return areValidSortStates(e)&&e.every(i=>{let{column:r}=i;return r<=t&&r>=0})}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties(),i=r=>{let{column:o,...a}=r;return{column:this.hot.toPhysicalColumn(o),...a}};t.initialConfig=arrayMap$1(e,i),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,i=r=>{let{column:o,...a}=r;return{column:this.hot.toVisualColumn(o),...a}};return isDefined(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=arrayMap$1(t.initialConfig,i)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(isDefined(t)){const r=getNextSortOrder(t);return isDefined(r)?{column:e,sortOrder:r}:void 0}const i=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<i)return{column:e,sortOrder:getNextSortOrder()}}getNextSortConfig(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:APPEND_COLUMN_CONFIG_STRATEGY;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=i!==-1,o=this.getSortConfig(),a=this.getColumnNextConfig(e);if(r){if(isUndefined$1(a))return[...o.slice(0,i),...o.slice(i+1)];if(t===APPEND_COLUMN_CONFIG_STRATEGY)return[...o.slice(0,i),...o.slice(i+1),a];if(t===REPLACE_COLUMN_CONFIG_STRATEGY)return[...o.slice(0,i),a,...o.slice(i+1)]}return isDefined(a)?o.concat(a):o}getPluginColumnConfig(e){if(isObject$4(e)){const t=e[this.pluginKey];if(isObject$4(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(r);return Array.isArray(o.columns)?Object.assign(i,t,this.getPluginColumnConfig(o.columns[e])):isFunction$2(o.columns)?Object.assign(i,t,this.getPluginColumnConfig(o.columns(e))):Object.assign(i,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),i=Object.create(t);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),i}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const t=[],i=this.hot.countRows(),r=h=>arrayMap$1(e,d=>this.hot.getDataAtCell(h,d.column));for(let h=0;h<this.getNumberOfRowsToSort(i);h+=1)t.push([this.hot.toPhysicalRow(h)].concat(r(h)));const o=arrayMap$1(t,h=>h[0]);sort(t,this.pluginKey,arrayMap$1(e,h=>h.sortOrder),arrayMap$1(e,h=>this.getFirstCellSettings(h.column)));for(let h=t.length;h<i;h+=1)t.push([h].concat(r(h)));const a=arrayMap$1(t,h=>h[0]),c=new Map(arrayMap$1(o,(h,d)=>[h,a[d]])),u=arrayMap$1(this.hot.rowIndexMapper.getIndexesSequence(),h=>c.has(h)?c.get(h):h);this.hot.rowIndexMapper.setIndexesSequence(u)}sortBySettings(e){if(isObject$4(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||isObject$4(t))&&this.sort(t)}else this.hot.render()}updateHeaderClasses(e){if(removeClass$1(e,getClassesToRemove$1(e)),this.enabled!==!1){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];addClass$1(e,getClassesToAdd$1(...i))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),isDefined(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&hasClass$1(e.target,HEADER_SPAN_CLASS)}onAfterOnCellMouseDown(e,t){if(wasHeaderClickedProperly(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col));const i=this.hot.getActiveEditor(),r=this.getColumnNextConfig(t.col);i!=null&&i.isOpened()&&this.hot.getCellValidator(i.row,i.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(r)}):this.sort(r)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}};function _loadOrSortBySettings(){const e=this.getAllSavedSortSettings();if(isObject$4(e))this.sortBySettings(e);else{const t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}function _onAfterGetColHeader$3(e,t){const i=getHeaderSpanElement(t);if(isFirstLevelColumnHeader(e,t)===!1||i===null)return;const r=this.getFirstCellSettings(e)[this.pluginKey],o=r.indicator,a=r.headerAction;if(this.updateHeaderClasses(i,this.columnStatesManager,e,o,a),this.hot.getSettings().ariaTags){const c=this.columnStatesManager.getSortOrderOfColumn(e);setAttribute(t,...A11Y_SORT(c?`${c}ending`:"none"))}}function _onAfterLoadData$4(e){e===!0&&this.hot.view&&_assertClassBrand$46(_ColumnSorting_brand,this,_loadOrSortBySettings).call(this)}function _onBeforeOnCellMouseDown$5(e,t,i,r){wasHeaderClickedProperly(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}var import_es_error_cause$78=__toESM(require_es_error_cause(),1),import_es_array_push$58=__toESM(require_es_array_push(),1);function _defineProperty$48(e,t,i){return(t=_toPropertyKey$49(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$49(e){var t=_toPrimitive$49(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$49(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Endpoints=class{constructor(e,t){_defineProperty$48(this,"plugin",void 0),_defineProperty$48(this,"hot",void 0),_defineProperty$48(this,"endpoints",[]),_defineProperty$48(this,"settings",void 0),_defineProperty$48(this,"settingsType","array"),_defineProperty$48(this,"currentEndpoint",null),_defineProperty$48(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=t}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let i=e;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),arrayEach$1(i,r=>{const o={};this.assignSetting(r,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(r,o,"reversedRowCoords",!1),this.assignSetting(r,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,o,"sourceColumn",r.destinationColumn),this.assignSetting(r,o,"type","sum"),this.assignSetting(r,o,"forceNumeric",!1),this.assignSetting(r,o,"suppressDataTypeErrors",!0),this.assignSetting(r,o,"customFunction",null),this.assignSetting(r,o,"readOnly",!0),this.assignSetting(r,o,"roundFloat",!1),t.push(o)}),t}assignSetting(e,t,i,r){if(i==="ranges"&&e[i]===void 0){t[i]=r;return}else if(i==="ranges"&&e[i].length===0)return;if(e[i]===void 0){if(r instanceof Error)throw r;t[i]=r}else i==="destinationRow"&&t.reversedRowCoords?t[i]=this.hot.countRows()-e[i]-1:t[i]=e[i]}resetSetupBeforeStructureAlteration(e,t,i){if(this.settingsType!=="function")return;const r=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();arrayEach$1(o,a=>{r==="row"&&a.destinationRow>=t&&(e==="insert_row"?a.alterRowOffset=i:e==="remove_row"&&(a.alterRowOffset=-1*i)),r==="col"&&a.destinationColumn>=t&&(e==="insert_col"?a.alterColumnOffset=i:e==="remove_col"&&(a.alterColumnOffset=-1*i))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,t,i,r,o){let a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const m=()=>(this.hot.removeHook("beforeViewRender",m),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",m);return}const c=e.indexOf("row")>-1?"row":"col",u=e.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=e.indexOf("move_row")===0,f=t;arrayEach$1(h,m=>{c==="row"&&m.destinationRow>=f&&(m.alterRowOffset=u*i),c==="col"&&m.destinationColumn>=f&&(m.alterColumnOffset=u*i)}),this.resetAllEndpoints(h,!d),d?arrayEach$1(h,m=>{this.extendEndpointRanges(m,f,r[0],r.length),this.recreatePhysicalRanges(m),this.clearOffsetInformation(m)}):arrayEach$1(h,m=>{this.shiftEndpointCoordinates(m,f)}),a&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,i,r){arrayEach$1(e.ranges,o=>{o[1]&&(t>=o[0]&&t<=o[1]?i>o[1]?o[1]+=r:i<o[0]&&(o[0]-=r):i>=o[0]&&i<=o[1]&&(o[1]-=r,t<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const t=e.ranges,i=[],r=[];arrayEach$1(t,o=>{const a=[];if(o[1])for(let c=o[0];c<=o[1];c++)a.push(this.hot.toPhysicalRow(c));else a.push(this.hot.toPhysicalRow(o[0]));r.push(a)}),arrayEach$1(r,o=>{let a=[];arrayEach$1(o,(c,u)=>{u===0?a.push(c):o[u]!==o[u-1]+1&&(a.push(o[u-1]),i.push(a),a=[],a.push(c)),u===o.length-1&&(a.push(c),i.push(a))})}),e.ranges=i}shiftEndpointCoordinates(e,t){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,arrayEach$1(e.ranges,i=>{arrayEach$1(i,(r,o)=>{r>=t&&(i[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(r=>{const o=r.alterRowOffset||0,a=r.alterColumnOffset||0;return r.destinationRow+o>=this.hot.countRows()||r.destinationColumn+a>=this.hot.countCols()})||(this.cellsToSetCache=[],arrayEach$1(e,r=>{this.resetEndpointValue(r,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],arrayEach$1(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],arrayEach$1(e,(i,r,o)=>{`${i[2]||""}`!=`${i[3]}`&&arrayEach$1(this.getAllEndpoints(),(a,c)=>{this.hot.propToCol(o[r][1])===a.sourceColumn&&t.indexOf(c)===-1&&t.push(c)})}),arrayEach$1(t,i=>{this.refreshEndpoint(this.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const t=this.hot.toVisualRow(e.destinationRow);if(t!==null){const i=this.hot.getCellMeta(t,e.destinationColumn);i.readOnly=e.readOnly,i.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=e.alterRowOffset||0,r=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?i:0)),this.hot.toVisualColumn(e.destinationColumn+(t?r:0)),""])}setEndpointValue(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const a=this.hot.getCellMeta(o,e.destinationColumn);(t==="init"||a.readOnly!==e.readOnly)&&(a.readOnly=e.readOnly,a.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const a=e.roundFloat;let c=0;Number.isInteger(a)&&(c=Math.min(Math.max(0,a),100)),e.result=e.result.toFixed(c)}i?this.hot.setDataAtCell(r,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){warn("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}},endpoints_default=Endpoints;function isNullishOrNaN(e){return e==null||isNaN(e)}var import_es_error_cause$77=__toESM(require_es_error_cause(),1);function _classPrivateMethodInitSpec$33(e,t){_checkPrivateRedeclaration$45(e,t),t.add(e)}function _checkPrivateRedeclaration$45(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$47(e,t,i){return(t=_toPropertyKey$48(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$48(e){var t=_toPrimitive$48(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$48(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand$45(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$26="columnSummary",PLUGIN_PRIORITY$25=220;var _ColumnSummary_brand=new WeakSet,ColumnSummary=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$33(this,_ColumnSummary_brand),_defineProperty$47(this,"endpoints",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$26}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$25}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$26]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[PLUGIN_KEY$26],this.endpoints=new endpoints_default(this,this.settings),this.addHook("afterInit",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$45(_ColumnSummary_brand,e,_onAfterInit$3).call(e,...i)}),this.addHook("afterChange",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$45(_ColumnSummary_brand,e,_onAfterChange$2).call(e,...i)}),this.addHook("afterUpdateSettings",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$45(_ColumnSummary_brand,e,_onAfterUpdateSettings).call(e,...i)}),this.addHook("beforeCreateRow",(t,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,i,null,r)),this.addHook("beforeCreateCol",(t,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,i,null,r)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(t,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,i,null,r)),this.addHook("afterCreateCol",(t,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,i,null,r)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$45(_ColumnSummary_brand,e,_onAfterRowMove).call(e,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break;default:break}}calculateSum(e){let t=0;return objectEach(e.ranges,i=>{t+=this.getPartialSum(i,e.sourceColumn)}),t}getPartialSum(e,t){let i=0,r=e[1]||e[0],o=null,a=0;do{if(o=this.getCellValue(r,t),o=isNullishOrNaN(o)?null:o,o!==null){const c=(`${o}`.split(".")[1]||[]).length||1;c>a&&(a=c)}i+=o||0,r-=1}while(r>=e[0]);return Math.round(i*10**a)/10**a}calculateMinMax(e,t){let i=null;return objectEach(e.ranges,r=>{const o=this.getPartialMinMax(r,e.sourceColumn,t);if(i===null&&o!==null&&(i=o),o!==null)switch(t){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break;default:break}}),i===null?"Not enough data":i}getPartialMinMax(e,t,i){let r=null,o=e[1]||e[0],a;do{if(a=this.getCellValue(o,t),a=isNullishOrNaN(a)?null:a,r===null)r=a;else if(a!==null)switch(i){case"min":r=Math.min(r,a);break;case"max":r=Math.max(r,a);break;default:break}o-=1}while(o>=e[0]);return r}countEmpty(e,t){let i,r=0,o=e[1]||e[0];do i=this.getCellValue(o,t),i=isNullishOrNaN(i)?null:i,i===null&&(r+=1),o-=1;while(o>=e[0]);return r}countEntries(e){let t=0;const i=e.ranges;return objectEach(i,r=>{const o=r[1]===void 0?1:r[1]-r[0]+1,a=this.countEmpty(r,e.sourceColumn);t+=o,t-=a}),t}calculateAverage(e){const t=this.calculateSum(e),i=this.countEntries(e);return t/i}getCellValue(e,t){const i=this.hot.toVisualRow(e),r=this.hot.toVisualColumn(t);let o=this.hot.getSourceDataAtCell(e,t),a="";if(i!==null&&r!==null&&(a=this.hot.getCellMeta(i,r).className||""),a.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(toSingleLine`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}};function _onAfterInit$3(){this.endpoints.initEndpoints()}function _onAfterUpdateSettings(e){e.columns!==void 0&&this.endpoints.refreshCellMetas()}function _onAfterChange$2(e,t){e&&t!=="ColumnSummary.reset"&&t!=="ColumnSummary.set"&&t!=="loadData"&&this.endpoints.refreshChangedEndpoints(e)}function _onAfterRowMove(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}var import_es_error_cause$76=__toESM(require_es_error_cause(),1);function _classPrivateMethodInitSpec$32(e,t){_checkPrivateRedeclaration$44(e,t),t.add(e)}function _classPrivateFieldInitSpec$32(e,t,i){_checkPrivateRedeclaration$44(e,t),t.set(e,i)}function _checkPrivateRedeclaration$44(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$32(e,t){return e.get(_assertClassBrand$44(e,t))}function _classPrivateFieldSet$31(e,t,i){return e.set(_assertClassBrand$44(e,t),i),i}function _assertClassBrand$44(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _ignoreInitialCall=new WeakMap,_observedElement=new WeakMap,_observer=new WeakMap,_EditorResizeObserver_brand=new WeakSet,EditorResizeObserver=class{constructor(){_classPrivateMethodInitSpec$32(this,_EditorResizeObserver_brand),_classPrivateFieldInitSpec$32(this,_ignoreInitialCall,!0),_classPrivateFieldInitSpec$32(this,_observedElement,null),_classPrivateFieldInitSpec$32(this,_observer,new ResizeObserver(e=>_assertClassBrand$44(_EditorResizeObserver_brand,this,_onResize).call(this,e)))}setObservedElement(e){_classPrivateFieldSet$31(_observedElement,this,e)}unobserve(){_classPrivateFieldGet$32(_observer,this).unobserve(_classPrivateFieldGet$32(_observedElement,this))}observe(){_classPrivateFieldSet$31(_ignoreInitialCall,this,!0),_classPrivateFieldGet$32(_observer,this).observe(_classPrivateFieldGet$32(_observedElement,this))}destroy(){_classPrivateFieldGet$32(_observer,this).disconnect()}};function _onResize(e){if(_classPrivateFieldGet$32(_ignoreInitialCall,this)||!Array.isArray(e)||!e.length){_classPrivateFieldSet$31(_ignoreInitialCall,this,!1);return}e.forEach(t=>{let{borderBoxSize:i}=t;const{inlineSize:r,blockSize:o}=i[0];this.runLocalHooks("resize",r,o)})}mixin(EditorResizeObserver,localHooks_default);var import_es_error_cause$75=__toESM(require_es_error_cause(),1);function _classPrivateFieldInitSpec$31(e,t,i){_checkPrivateRedeclaration$43(e,t),t.set(e,i)}function _checkPrivateRedeclaration$43(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$31(e,t){return e.get(_assertClassBrand$43(e,t))}function _classPrivateFieldSet$30(e,t,i){return e.set(_assertClassBrand$43(e,t),i),i}function _assertClassBrand$43(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _rootDocument=new WeakMap,_isRtl=new WeakMap,_container$1=new WeakMap,_editor$1=new WeakMap,_editorStyle=new WeakMap,_hidden=new WeakMap,_resizeObserver=new WeakMap,CommentEditor=class Qn{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(t,i){var r=this;_classPrivateFieldInitSpec$31(this,_rootDocument,void 0),_classPrivateFieldInitSpec$31(this,_isRtl,!1),_classPrivateFieldInitSpec$31(this,_container$1,null),_classPrivateFieldInitSpec$31(this,_editor$1,void 0),_classPrivateFieldInitSpec$31(this,_editorStyle,void 0),_classPrivateFieldInitSpec$31(this,_hidden,!0),_classPrivateFieldInitSpec$31(this,_resizeObserver,new EditorResizeObserver),_classPrivateFieldSet$30(_rootDocument,this,t),_classPrivateFieldSet$30(_isRtl,this,i),_classPrivateFieldSet$30(_editor$1,this,this.createEditor()),_classPrivateFieldSet$30(_editorStyle,this,_classPrivateFieldGet$31(_editor$1,this).style),_classPrivateFieldGet$31(_resizeObserver,this).setObservedElement(this.getInputElement()),_classPrivateFieldGet$31(_resizeObserver,this).addLocalHook("resize",function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return r.runLocalHooks("resize",...a)}),this.hide()}setPosition(t,i){_classPrivateFieldGet$31(_editorStyle,this).left=`${t}px`,_classPrivateFieldGet$31(_editorStyle,this).top=`${i}px`}setSize(t,i){if(t&&i){const r=this.getInputElement();r.style.width=`${t}px`,r.style.height=`${i}px`}}getSize(){return{width:outerWidth(this.getInputElement()),height:outerHeight(this.getInputElement())}}observeSize(){_classPrivateFieldGet$31(_resizeObserver,this).observe()}resetSize(){const t=this.getInputElement();t.style.width="",t.style.height=""}setReadOnlyState(t){const i=this.getInputElement();i.readOnly=t}show(){_classPrivateFieldGet$31(_editorStyle,this).display="block",_classPrivateFieldSet$30(_hidden,this,!1)}hide(){_classPrivateFieldGet$31(_resizeObserver,this).unobserve(),_classPrivateFieldGet$31(_hidden,this)||(_classPrivateFieldGet$31(_editorStyle,this).display="none"),_classPrivateFieldSet$30(_hidden,this,!0)}isVisible(){return _classPrivateFieldGet$31(_editorStyle,this).display==="block"}setValue(){const i=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=i}getValue(){return this.getInputElement().value}isFocused(){return _classPrivateFieldGet$31(_rootDocument,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const t=_classPrivateFieldGet$31(_rootDocument,this).createElement("div"),i=_classPrivateFieldGet$31(_rootDocument,this).createElement("textarea");return t.style.display="none",_classPrivateFieldSet$30(_container$1,this,_classPrivateFieldGet$31(_rootDocument,this).createElement("div")),_classPrivateFieldGet$31(_container$1,this).setAttribute("dir",_classPrivateFieldGet$31(_isRtl,this)?"rtl":"ltr"),addClass$1(_classPrivateFieldGet$31(_container$1,this),Qn.CLASS_EDITOR_CONTAINER),_classPrivateFieldGet$31(_rootDocument,this).body.appendChild(_classPrivateFieldGet$31(_container$1,this)),addClass$1(t,Qn.CLASS_EDITOR),addClass$1(i,Qn.CLASS_INPUT),i.setAttribute("data-hot-input",!0),t.appendChild(i),_classPrivateFieldGet$31(_container$1,this).appendChild(t),t}getInputElement(){return _classPrivateFieldGet$31(_editor$1,this).querySelector(`.${Qn.CLASS_INPUT}`)}destroy(){const t=_classPrivateFieldGet$31(_container$1,this)?_classPrivateFieldGet$31(_container$1,this).parentNode:null;_classPrivateFieldGet$31(_editor$1,this).parentNode.removeChild(_classPrivateFieldGet$31(_editor$1,this)),_classPrivateFieldSet$30(_editor$1,this,null),_classPrivateFieldSet$30(_editorStyle,this,null),_classPrivateFieldGet$31(_resizeObserver,this).destroy(),t&&t.removeChild(_classPrivateFieldGet$31(_container$1,this))}};mixin(CommentEditor,localHooks_default);var commentEditor_default=CommentEditor,import_es_error_cause$74=__toESM(require_es_error_cause(),1);function _defineProperty$46(e,t,i){return(t=_toPropertyKey$47(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$47(e){var t=_toPrimitive$47(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$47(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}const DEFAULT_DISPLAY_DELAY=250,DEFAULT_HIDE_DELAY=250;var DisplaySwitch=class{constructor(e){_defineProperty$46(this,"wasLastActionShow",!0),_defineProperty$46(this,"showDebounced",null),_defineProperty$46(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},DEFAULT_HIDE_DELAY)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:DEFAULT_DISPLAY_DELAY;this.showDebounced=debounce$3(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},e)}destroy(){this.clearLocalHooks()}};mixin(DisplaySwitch,localHooks_default);var displaySwitch_default=DisplaySwitch;function prepareVerticalAlignClass(e,t){return e.indexOf(t)!==-1?e:`${e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${t}`}function prepareHorizontalAlignClass(e,t){return e.indexOf(t)!==-1?e:`${e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${t}`}function getAlignmentClasses(e,t){const i={};return arrayEach$1(e,r=>{r.forAll((o,a)=>{o>=0&&a>=0&&(i[o]||(i[o]=[]),i[o][a]=t(o,a))})}),i}function align(e,t,i,r,o){arrayEach$1(e,a=>{a.forAll((c,u)=>{c>=0&&u>=0&&applyAlignClassName(c,u,t,i,r,o)})})}function applyAlignClassName(e,t,i,r,o,a){const c=o(e,t);let u=r;c.className&&(i==="vertical"?u=prepareVerticalAlignClass(c.className,r):u=prepareHorizontalAlignClass(c.className,r)),a(e,t,"className",u)}function markLabelAsSelected(e){return`<span class="selected">\u2713</span>${e}`}function checkSelectionConsistency(e,t){let i=!1;return Array.isArray(e)&&arrayEach$1(e,r=>(r.forAll((o,a)=>{if(o>=0&&a>=0&&t(o,a))return i=!0,!1}),i)),i}function getDocumentOffsetByElement(e,t){const i={top:0,left:0};if(t!==e.ownerDocument){const{frameElement:r}=t.defaultView,{top:o,left:a}=r.getBoundingClientRect();i.top=o,i.left=a}return i}function getAlignmentComparatorByClass(e){return function(t,i){const r=this.getCellMeta(t,i).className;return r&&r.indexOf(e)!==-1}}function hasSelectionAClass(e,t){return checkSelectionConsistency(e.getSelectedRange(),getAlignmentComparatorByClass(t).bind(e))}const KEY$10="---------";function separatorItem(){return{name:KEY$10}}const KEY="alignment";function alignmentItem(){return{key:KEY,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${KEY}:left`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_LEFT)},ariaChecked(){return hasSelectionAClass(this,"htLeft")},name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_LEFT);return hasSelectionAClass(this,"htLeft")&&(e=markLabelAsSelected(e)),e},callback(){const e=this.getSelectedRange(),t=getAlignmentClasses(e,(o,a)=>this.getCellMeta(o,a).className),i="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",t,e,i,r),align(e,i,r,(o,a)=>this.getCellMeta(o,a),(o,a,c,u)=>this.setCellMeta(o,a,c,u)),this.render()},disabled:!1},{key:`${KEY}:center`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_CENTER)},ariaChecked(){return hasSelectionAClass(this,"htCenter")},name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_CENTER);return hasSelectionAClass(this,"htCenter")&&(e=markLabelAsSelected(e)),e},callback(){const e=this.getSelectedRange(),t=getAlignmentClasses(e,(o,a)=>this.getCellMeta(o,a).className),i="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",t,e,i,r),align(e,i,r,(o,a)=>this.getCellMeta(o,a),(o,a,c,u)=>this.setCellMeta(o,a,c,u)),this.render()},disabled:!1},{key:`${KEY}:right`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT)},ariaChecked(){return hasSelectionAClass(this,"htRight")},name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT);return hasSelectionAClass(this,"htRight")&&(e=markLabelAsSelected(e)),e},callback(){const e=this.getSelectedRange(),t=getAlignmentClasses(e,(o,a)=>this.getCellMeta(o,a).className),i="horizontal",r="htRight";this.runHooks("beforeCellAlignment",t,e,i,r),align(e,i,r,(o,a)=>this.getCellMeta(o,a),(o,a,c,u)=>this.setCellMeta(o,a,c,u)),this.render()},disabled:!1},{key:`${KEY}:justify`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY)},ariaChecked(){return hasSelectionAClass(this,"htJustify")},name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY);return hasSelectionAClass(this,"htJustify")&&(e=markLabelAsSelected(e)),e},callback(){const e=this.getSelectedRange(),t=getAlignmentClasses(e,(o,a)=>this.getCellMeta(o,a).className),i="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",t,e,i,r),align(e,i,r,(o,a)=>this.getCellMeta(o,a),(o,a,c,u)=>this.setCellMeta(o,a,c,u)),this.render()},disabled:!1},{name:KEY$10},{key:`${KEY}:top`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_TOP)},ariaChecked(){return hasSelectionAClass(this,"htTop")},name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_TOP);return hasSelectionAClass(this,"htTop")&&(e=markLabelAsSelected(e)),e},callback(){const e=this.getSelectedRange(),t=getAlignmentClasses(e,(o,a)=>this.getCellMeta(o,a).className),i="vertical",r="htTop";this.runHooks("beforeCellAlignment",t,e,i,r),align(e,i,r,(o,a)=>this.getCellMeta(o,a),(o,a,c,u)=>this.setCellMeta(o,a,c,u)),this.render()},disabled:!1},{key:`${KEY}:middle`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE)},ariaChecked(){return hasSelectionAClass(this,"htMiddle")},name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE);return hasSelectionAClass(this,"htMiddle")&&(e=markLabelAsSelected(e)),e},callback(){const e=this.getSelectedRange(),t=getAlignmentClasses(e,(o,a)=>this.getCellMeta(o,a).className),i="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",t,e,i,r),align(e,i,r,(o,a)=>this.getCellMeta(o,a),(o,a,c,u)=>this.setCellMeta(o,a,c,u)),this.render()},disabled:!1},{key:`${KEY}:bottom`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM)},ariaChecked(){return hasSelectionAClass(this,"htBottom")},name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM);return hasSelectionAClass(this,"htBottom")&&(e=markLabelAsSelected(e)),e},callback(){const e=this.getSelectedRange(),t=getAlignmentClasses(e,(o,a)=>this.getCellMeta(o,a).className),i="vertical",r="htBottom";this.runHooks("beforeCellAlignment",t,e,i,r),align(e,i,r,(o,a)=>this.getCellMeta(o,a),(o,a,c,u)=>this.setCellMeta(o,a,c,u)),this.render()},disabled:!1}]}}}const KEY$1="clear_column";function clearColumnItem(){return{key:KEY$1,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback(e,t){const i=t[0].start.col,r=t[0].end.col;this.countRows()&&this.populateFromArray(0,i,[[null]],Math.max(t[0].start.row,t[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()&&e.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const KEY$2="col_left";function columnLeftItem(){return{key:KEY$2,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_INSERT_LEFT)},callback(){const e=this.getSelectedRangeLast().getTopLeftCorner(),t=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(t,e.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()&&e.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const KEY$3="col_right";function columnRightItem(){return{key:KEY$3,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback(){const e=this.getSelectedRangeLast().getTopRightCorner(),t=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(t,e.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()&&e.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const KEY$4="make_read_only";function readOnlyItem(){return{key:KEY$4,checkable:!0,ariaChecked(){return checkSelectionConsistency(this.getSelectedRange(),(t,i)=>this.getCellMeta(t,i).readOnly)},ariaLabel(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY)},name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY);return checkSelectionConsistency(this.getSelectedRange(),(i,r)=>this.getCellMeta(i,r).readOnly)&&(e=markLabelAsSelected(e)),e},callback(){const e=this.getSelectedRange(),t=checkSelectionConsistency(e,(i,r)=>this.getCellMeta(i,r).readOnly);arrayEach$1(e,i=>{i.forAll((r,o)=>{r>=0&&o>=0&&this.setCellMeta(r,o,"readOnly",!t)})}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const KEY$5="redo";function redoItem(){return{key:KEY$5,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REDO)},callback(){this.redo()},hidden(){const e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const KEY$6="remove_col";function removeColumnItem(){return{key:KEY$6,name(){const e=this.getSelected();let t=0;if(e)if(e.length>1)t=1;else{const[,i,,r]=e[0];i-r!==0&&(t=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_COLUMN,t)},callback(){this.alter("remove_col",transformSelectionToColumnDistance(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader()&&e.highlight.col<0)return!0;const t=this.countCols();return this.selection.isSelectedByCorner()?t===0:this.selection.isSelectedByRowHeader()||t===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const KEY$7="remove_row";function removeRowItem(){return{key:KEY$7,name(){const e=this.getSelected();let t=0;if(e)if(e.length>1)t=1;else{const[i,,r]=e[0];i-r!==0&&(t=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_ROW,t)},callback(){this.alter("remove_row",transformSelectionToRowDistance(this),1,"ContextMenu.removeRow")},disabled(){const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader()&&e.highlight.row<0)return!0;const t=this.countRows();return this.selection.isSelectedByCorner()?t===0:this.selection.isSelectedByColumnHeader()||t===0},hidden(){return!this.getSettings().allowRemoveRow}}}const KEY$8="row_above";function rowAboveItem(){return{key:KEY$8,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ROW_ABOVE)},callback(){const e=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",e.row,1,"ContextMenu.rowAbove")},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()&&e.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const KEY$9="row_below";function rowBelowItem(){return{key:KEY$9,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ROW_BELOW)},callback(){const e=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",e.row,1,"ContextMenu.rowBelow")},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()&&e.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const KEY$11="no_items";function noItemsItem(){return{key:KEY$11,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}}const KEY$12="undo";function undoItem(){return{key:KEY$12,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNDO)},callback(){this.undo()},hidden(){const e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const ITEMS=[KEY$8,KEY$9,KEY$2,KEY$3,KEY$1,KEY$7,KEY$6,KEY$12,KEY$5,KEY$4,KEY,KEY$10,KEY$11],_predefinedItems={[KEY$10]:separatorItem,[KEY$11]:noItemsItem,[KEY$8]:rowAboveItem,[KEY$9]:rowBelowItem,[KEY$2]:columnLeftItem,[KEY$3]:columnRightItem,[KEY$1]:clearColumnItem,[KEY$7]:removeRowItem,[KEY$6]:removeColumnItem,[KEY$12]:undoItem,[KEY$5]:redoItem,[KEY$4]:readOnlyItem,[KEY]:alignmentItem};function predefinedItems(){const e={};return objectEach(_predefinedItems,(t,i)=>{e[i]=t()}),e}function addEditCommentItem(e){return{key:"commentsAddEdit",name(){var t;const i=(t=this.getSelectedRangeLast())===null||t===void 0?void 0:t.highlight;return i!=null&&i.isCell()&&e.getCommentAtCell(i.row,i.col)?this.getTranslatedPhrase(CONTEXTMENU_ITEMS_EDIT_COMMENT):this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ADD_COMMENT)},callback(){const t=this.getSelectedRangeLast();e.setRange(t),e.show(),e.focusEditor()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function removeCommentItem(e){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback(){this.getSelectedRangeLast().forAll((i,r)=>{i>=0&&r>=0&&e.removeCommentAtCell(i,r,!1)}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function readOnlyCommentItem(e){return{key:"commentsReadOnly",name(){const t=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);return checkSelectionConsistency(this.getSelectedRange(),(r,o)=>e.getCommentMeta(r,o,META_READONLY))?markLabelAsSelected(t):t},callback(){this.getSelectedRangeLast().forAll((i,r)=>{if(i>=0&&r>=0){const o=!!e.getCommentMeta(i,r,META_READONLY);e.updateCommentMeta(i,r,{[META_READONLY]:!o})}})},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||!e.getCommentAtCell(t.highlight.row,t.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}var import_es_error_cause$73=__toESM(require_es_error_cause(),1),import_es_array_push$57=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$31(e,t){_checkPrivateRedeclaration$42(e,t),t.add(e)}function _classPrivateFieldInitSpec$30(e,t,i){_checkPrivateRedeclaration$42(e,t),t.set(e,i)}function _checkPrivateRedeclaration$42(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$45(e,t,i){return(t=_toPropertyKey$46(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$46(e){var t=_toPrimitive$46(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$46(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldSet$29(e,t,i){return e.set(_assertClassBrand$42(e,t),i),i}function _classPrivateFieldGet$30(e,t){return e.get(_assertClassBrand$42(e,t))}function _assertClassBrand$42(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$25="comments",PLUGIN_PRIORITY$24=60,META_COMMENT="comment",META_COMMENT_VALUE="value",META_STYLE="style",META_READONLY="readOnly",SHORTCUTS_GROUP$9=PLUGIN_KEY$25,SHORTCUTS_CONTEXT_NAME=`plugin:${PLUGIN_KEY$25}`;var _editor=new WeakMap,_displaySwitch=new WeakMap,_preventEditorAutoSwitch=new WeakMap,_preventEditorHiding=new WeakMap,_cellBelowCursor=new WeakMap,_commentValueBeforeSave=new WeakMap,_Comments_brand=new WeakSet,Comments=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$31(this,_Comments_brand),_defineProperty$45(this,"range",{}),_classPrivateFieldInitSpec$30(this,_editor,null),_classPrivateFieldInitSpec$30(this,_displaySwitch,null),_classPrivateFieldInitSpec$30(this,_preventEditorAutoSwitch,!1),_classPrivateFieldInitSpec$30(this,_preventEditorHiding,!1),_classPrivateFieldInitSpec$30(this,_cellBelowCursor,null),_classPrivateFieldInitSpec$30(this,_commentValueBeforeSave,"")}static get PLUGIN_KEY(){return PLUGIN_KEY$25}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$24}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$25]}enablePlugin(){var e=this;this.enabled||(_classPrivateFieldGet$30(_editor,this)||(_classPrivateFieldSet$29(_editor,this,new commentEditor_default(this.hot.rootDocument,this.hot.isRtl())),_classPrivateFieldGet$30(_editor,this).addLocalHook("resize",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$42(_Comments_brand,e,_onEditorResize).call(e,...i)})),_classPrivateFieldGet$30(_displaySwitch,this)||_classPrivateFieldSet$29(_displaySwitch,this,new displaySwitch_default(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",t=>this.addToContextMenu(t)),this.addHook("afterRenderer",(t,i,r,o,a,c)=>_assertClassBrand$42(_Comments_brand,this,_onAfterRenderer).call(this,t,c)),this.addHook("afterScroll",()=>_assertClassBrand$42(_Comments_brand,this,_onAfterScroll).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",t=>_assertClassBrand$42(_Comments_brand,this,_onAfterDocumentKeyDown).call(this,t)),_classPrivateFieldGet$30(_displaySwitch,this).addLocalHook("hide",()=>this.hide()),_classPrivateFieldGet$30(_displaySwitch,this).addLocalHook("show",(t,i)=>this.showAtCell(t,i)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){_classPrivateFieldGet$30(_displaySwitch,this).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),t=e.getContext("grid"),i=e.addContext(SHORTCUTS_CONTEXT_NAME);t.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const r=this.hot.getSelectedRangeLast();_classPrivateFieldSet$29(_preventEditorHiding,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(r),this.show(),this.focusEditor(),e.setActiveContextName(SHORTCUTS_CONTEXT_NAME),this.hot._registerTimeout(()=>{_classPrivateFieldSet$29(_preventEditorHiding,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var r;return((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isCell())&&!_classPrivateFieldGet$30(_editor,this).isVisible()},group:SHORTCUTS_GROUP$9}),i.addShortcut({keys:[["Escape"]],callback:()=>{_classPrivateFieldGet$30(_editor,this).setValue(_classPrivateFieldGet$30(_commentValueBeforeSave,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>_classPrivateFieldGet$30(_editor,this).isVisible()&&_classPrivateFieldGet$30(_editor,this).isFocused(),group:SHORTCUTS_GROUP$9}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>_classPrivateFieldGet$30(_editor,this).isVisible()&&_classPrivateFieldGet$30(_editor,this).isFocused(),group:SHORTCUTS_GROUP$9})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$9)}registerListeners(){const{rootDocument:e}=this.hot,t=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",i=>_assertClassBrand$42(_Comments_brand,this,_onMouseOver$2).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>_assertClassBrand$42(_Comments_brand,this,_onMouseDown$2).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand$42(_Comments_brand,this,_onMouseUp$4).call(this)),this.eventManager.addEventListener(t,"focus",()=>_assertClassBrand$42(_Comments_brand,this,_onEditorFocus).call(this)),this.eventManager.addEventListener(t,"blur",()=>_assertClassBrand$42(_Comments_brand,this,_onEditorBlur).call(this))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=closest(e.target,"TD","TBODY");return!!(t&&hasClass$1(t,"htCommentCell")&&closest(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=_classPrivateFieldGet$30(_editor,this).getValue();let i="";e!=null?i=e:t!=null&&(i=t);const r=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(r,o,{[META_COMMENT_VALUE]:i}),this.hot.render()}setCommentAtCell(e,t,i){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(i)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,META_COMMENT),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(i)}getComment(){const e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,META_COMMENT_VALUE)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,META_COMMENT_VALUE)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:t,col:i}}=this.range;if(t<0||t>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;const r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return _classPrivateFieldGet$30(_displaySwitch,this).cancelHiding(),_classPrivateFieldGet$30(_editor,this).setValue((e=r[META_COMMENT]?r[META_COMMENT][META_COMMENT_VALUE]:null)!==null&&e!==void 0?e:""),_classPrivateFieldGet$30(_editor,this).show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){_classPrivateFieldGet$30(_editor,this).hide()}refreshEditor(){var e,t;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!_classPrivateFieldGet$30(_editor,this).isVisible()))return;const{rowIndexMapper:r,columnIndexMapper:o}=this.hot,{row:a,col:c}=this.range.from;let u=r.getRenderableFromVisualIndex(a),h=o.getRenderableFromVisualIndex(c);const d=u===null;_classPrivateFieldGet$30(_editor,this).setPosition(0,0),u===null&&(u=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1))),h===null&&(h=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(c,-1)));const f=u===null,m=h===null;u=(e=u)!==null&&e!==void 0?e:0,h=(t=h)!==null&&t!==void 0?t:0;const{rootWindow:g,view:{_wt:v}}=this.hot,{wtTable:_}=v,b=v.getCell({row:u,col:h},!0),S=this.getCommentMeta(a,c,META_STYLE);S?_classPrivateFieldGet$30(_editor,this).setSize(S.width,S.height):_classPrivateFieldGet$30(_editor,this).resetSize();const T=m?0:_.getStretchedColumnWidth(h),A=d&&!f?outerHeight(b):0,{left:I,top:R,width:O,height:P}=b.getBoundingClientRect(),{width:L,height:V}=_classPrivateFieldGet$30(_editor,this).getSize(),{innerWidth:U,innerHeight:$}=this.hot.rootWindow,Z=this.hot.rootDocument.documentElement;let ie=I+g.scrollX+T,ue=R+g.scrollY+A;this.hot.isRtl()&&(ie-=L+T),this.hot.isLtr()&&I+O+L>U?ie=I+g.scrollX-L-1:this.hot.isRtl()&&ie<-(Z.scrollWidth-Z.clientWidth)&&(ie=I+g.scrollX+T+1),R+V>$&&(ue-=V-P+1),_classPrivateFieldGet$30(_editor,this).setPosition(ie,ue),_classPrivateFieldGet$30(_editor,this).setReadOnlyState(this.getCommentMeta(a,c,META_READONLY)),_classPrivateFieldGet$30(_editor,this).observeSize()}focusEditor(){_classPrivateFieldGet$30(_editor,this).focus()}updateCommentMeta(e,t,i){const r=this.hot.getCellMeta(e,t)[META_COMMENT];let o;r?(o=deepClone(r),deepExtend(o,i)):o=i,this.hot.setCellMeta(e,t,META_COMMENT,o)}getCommentMeta(e,t,i){const r=this.hot.getCellMeta(e,t);if(r[META_COMMENT])return r[META_COMMENT][i]}addToContextMenu(e){e.items.push({name:KEY$10},addEditCommentItem(this),removeCommentItem(this),readOnlyCommentItem(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[PLUGIN_KEY$25];if(isObject$4(e))return e.displayDelay}getEditorInputElement(){return _classPrivateFieldGet$30(_editor,this).getInputElement()}destroy(){var e,t;(e=_classPrivateFieldGet$30(_editor,this))===null||e===void 0||e.destroy(),(t=_classPrivateFieldGet$30(_displaySwitch,this))===null||t===void 0||t.destroy(),super.destroy()}};function _onMouseDown$2(e){if(!(!this.hot.view||!this.hot.view._wt)&&!_classPrivateFieldGet$30(_preventEditorAutoSwitch,this)&&!this.targetIsCommentTextArea(e)){const t=closest(e.target,"TD","TBODY");let i=null;t&&(i=this.hot.getCoords(t)),(!t||this.range.from&&i&&(this.range.from.row!==i.row||this.range.from.col!==i.col))&&this.hide()}}function _onMouseOver$2(e){const{rootDocument:t}=this.hot;if(!(_classPrivateFieldGet$30(_preventEditorAutoSwitch,this)||_classPrivateFieldGet$30(_editor,this).isFocused()||hasClass$1(e.target,"wtBorder")||_classPrivateFieldGet$30(_cellBelowCursor,this)===e.target||!_classPrivateFieldGet$30(_editor,this)))if(_classPrivateFieldSet$29(_cellBelowCursor,this,t.elementFromPoint(e.clientX,e.clientY)),this.targetIsCellWithComment(e)){const i=this.hot._createCellRange(this.hot.getCoords(e.target));_classPrivateFieldGet$30(_displaySwitch,this).show(i)}else isChildOf(e.target,t)&&!this.targetIsCommentTextArea(e)&&_classPrivateFieldGet$30(_displaySwitch,this).hide()}function _onMouseUp$4(){_classPrivateFieldSet$29(_preventEditorAutoSwitch,this,!1)}function _onAfterRenderer(e,t){t[META_COMMENT]&&t[META_COMMENT][META_COMMENT_VALUE]&&addClass$1(e,t.commentedCellClassName)}function _onEditorBlur(){_classPrivateFieldSet$29(_commentValueBeforeSave,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function _onEditorFocus(){_classPrivateFieldSet$29(_commentValueBeforeSave,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(SHORTCUTS_CONTEXT_NAME)}function _onEditorResize(e,t){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[META_STYLE]:{width:e,height:t}})}function _onAfterDocumentKeyDown(e){_classPrivateFieldGet$30(_editor,this).isVisible()&&stopImmediatePropagation(e)}function _onAfterScroll(){_classPrivateFieldGet$30(_preventEditorHiding,this)||this.hide()}var require_delete_property_or_throw=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/delete-property-or-throw.js"(e,t){var i=require_try_to_string(),r=TypeError;t.exports=function(o,a){if(!delete o[a])throw new r("Cannot delete property "+i(a)+" of "+i(o))}}}),require_es_array_unshift=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.array.unshift.js"(){var e=require_export(),t=require_to_object(),i=require_length_of_array_like(),r=require_array_set_length(),o=require_delete_property_or_throw(),a=require_does_not_exceed_safe_integer(),c=[].unshift(0)!==1,u=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(d){return d instanceof TypeError}},h=c||!u();e({target:"Array",proto:!0,arity:1,forced:h},{unshift:function(f){var m=t(this),g=i(m),v=arguments.length;if(v){a(g+v);for(var _=g;_--;){var b=_+v;_ in m?m[b]=m[_]:o(m,b)}for(var S=0;S<v;S++)m[S]=arguments[S]}return r(m,g+v)}})}}),import_es_error_cause$72=__toESM(require_es_error_cause(),1),import_es_array_push$56=__toESM(require_es_array_push(),1),import_es_array_unshift=__toESM(require_es_array_unshift(),1);function _defineProperty$44(e,t,i){return(t=_toPropertyKey$45(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$45(e){var t=_toPrimitive$45(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$45(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CommandExecutor=class{constructor(e){_defineProperty$44(this,"hot",void 0),_defineProperty$44(this,"commands",{}),_defineProperty$44(this,"commonCallback",null),this.hot=e}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];const o=e.split(":"),a=o[0],c=o.length===2?o[1]:null;let u=this.commands[a];if(!u)throw new Error(`Menu command '${a}' not exists.`);if(c&&u.submenu&&(u=findSubCommand(c,u.submenu.items)),u.disabled===!0||typeof u.disabled=="function"&&u.disabled.call(this.hot)===!0||hasOwnProperty$15(u,"submenu"))return;const h=[];typeof u.callback=="function"&&h.push(u.callback),typeof this.commonCallback=="function"&&h.push(this.commonCallback),i.unshift(o.join(":")),arrayEach$1(h,d=>d.apply(this.hot,i))}};function findSubCommand(e,t){let i;return arrayEach$1(t,r=>{const o=r.key?r.key.split(":"):null;if(Array.isArray(o)&&o[1]===e)return i=r,!1}),i}var import_es_error_cause$71=__toESM(require_es_error_cause(),1),import_es_array_push$55=__toESM(require_es_array_push(),1);function _defineProperty$43(e,t,i){return(t=_toPropertyKey$44(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$44(e){var t=_toPrimitive$44(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$44(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ItemsFactory=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;_defineProperty$43(this,"hot",void 0),_defineProperty$43(this,"predefinedItems",predefinedItems()),_defineProperty$43(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,objectEach(e,(i,r)=>{let o="";i.name===KEY$10?(t[KEY$10]=i,o=KEY$10):isNaN(parseInt(r,10))?(i.key=i.key===void 0?r:i.key,t[r]=i,o=i.key):(t[i.key]=i,o=i.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=t}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return getItems(e,this.defaultOrderPattern,this.predefinedItems)}};function getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let o=e;return o&&o.items?o=o.items:Array.isArray(o)||(o=t),isObject$4(o)?objectEach(o,(a,c)=>{let u=i[typeof a=="string"?a:c];u||(u=a),isObject$4(a)?extend$2(u,a):typeof u=="string"&&(u={name:u}),u.key===void 0&&(u.key=c),r.push(u)}):arrayEach$1(o,(a,c)=>{let u=i[a];!u&&ITEMS.indexOf(a)>=0||(u||(u={name:a,key:`${c}`}),isObject$4(a)&&extend$2(u,a),u.key===void 0&&(u.key=c),r.push(u))}),r}var import_es_error_cause$70=__toESM(require_es_error_cause(),1);function _defineProperty$42(e,t,i){return(t=_toPropertyKey$43(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$43(e){var t=_toPrimitive$43(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$43(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cursor=class{constructor(e,t){_defineProperty$42(this,"top",void 0),_defineProperty$42(this,"topRelative",void 0),_defineProperty$42(this,"left",void 0),_defineProperty$42(this,"leftRelative",void 0),_defineProperty$42(this,"scrollTop",void 0),_defineProperty$42(this,"scrollLeft",void 0),_defineProperty$42(this,"cellHeight",void 0),_defineProperty$42(this,"cellWidth",void 0);const i=t.scrollY,r=t.scrollX;let o,a,c,u,h,d;this.rootWindow=t,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),c=parseInt(e.left,10),h=e.height||0,d=e.width||0,a=o,u=c,o+=i,c+=r):this.type==="event"&&(o=parseInt(e.pageY,10),c=parseInt(e.pageX,10),h=e.target.clientHeight,d=e.target.clientWidth,a=o-i,u=c-r),this.top=o,this.topRelative=a,this.left=c,this.leftRelative=u,this.scrollTop=i,this.scrollLeft=r,this.cellHeight=h,this.cellWidth=d}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}},import_es_error_cause$69=__toESM(require_es_error_cause(),1);function _classPrivateFieldInitSpec$29(e,t,i){_checkPrivateRedeclaration$41(e,t),t.set(e,i)}function _checkPrivateRedeclaration$41(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$29(e,t){return e.get(_assertClassBrand$41(e,t))}function _classPrivateFieldSet$28(e,t,i){return e.set(_assertClassBrand$41(e,t),i),i}function _assertClassBrand$41(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _container=new WeakMap,_parentContainer=new WeakMap,_cursor=new WeakMap,_keepInViewport=new WeakMap,_offset=new WeakMap,Positioner=class{constructor(e){_classPrivateFieldInitSpec$29(this,_container,void 0),_classPrivateFieldInitSpec$29(this,_parentContainer,void 0),_classPrivateFieldInitSpec$29(this,_cursor,void 0),_classPrivateFieldInitSpec$29(this,_keepInViewport,!1),_classPrivateFieldInitSpec$29(this,_offset,{above:0,below:0,left:0,right:0}),_classPrivateFieldSet$28(_keepInViewport,this,e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return _classPrivateFieldGet$29(_offset,this)[e]=t,this}setElement(e){return _classPrivateFieldSet$28(_container,this,e),this}setParentElement(e){return _classPrivateFieldSet$28(_parentContainer,this,e),this}updatePosition(e){_classPrivateFieldSet$28(_cursor,this,new Cursor(e,_classPrivateFieldGet$29(_container,this).ownerDocument.defaultView)),_classPrivateFieldGet$29(_keepInViewport,this)?(_classPrivateFieldGet$29(_cursor,this).fitsBelow(_classPrivateFieldGet$29(_container,this))?this.setPositionBelowCursor():_classPrivateFieldGet$29(_cursor,this).fitsAbove(_classPrivateFieldGet$29(_container,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){_classPrivateFieldGet$29(_container,this).dir==="rtl"?_classPrivateFieldGet$29(_cursor,this).fitsOnLeft(_classPrivateFieldGet$29(_container,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():_classPrivateFieldGet$29(_cursor,this).fitsOnRight(_classPrivateFieldGet$29(_container,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=_classPrivateFieldGet$29(_offset,this).above+_classPrivateFieldGet$29(_cursor,this).top-_classPrivateFieldGet$29(_container,this).offsetHeight;_classPrivateFieldGet$29(_parentContainer,this)&&(e=_classPrivateFieldGet$29(_cursor,this).top+_classPrivateFieldGet$29(_cursor,this).cellHeight-_classPrivateFieldGet$29(_container,this).offsetHeight+3),_classPrivateFieldGet$29(_container,this).style.top=`${e}px`}setPositionBelowCursor(){let e=_classPrivateFieldGet$29(_offset,this).below+_classPrivateFieldGet$29(_cursor,this).top+1;_classPrivateFieldGet$29(_parentContainer,this)&&(e=_classPrivateFieldGet$29(_cursor,this).top-1),_classPrivateFieldGet$29(_container,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=_classPrivateFieldGet$29(_cursor,this).left;if(_classPrivateFieldGet$29(_parentContainer,this)){const t=Number.parseInt(getComputedStyle(_classPrivateFieldGet$29(_parentContainer,this).querySelector(".htCore")).borderRightWidth,10);e+=_classPrivateFieldGet$29(_cursor,this).cellWidth+t}else e+=_classPrivateFieldGet$29(_offset,this).right;_classPrivateFieldGet$29(_container,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=_classPrivateFieldGet$29(_offset,this).left+_classPrivateFieldGet$29(_cursor,this).left-_classPrivateFieldGet$29(_container,this).offsetWidth;if(_classPrivateFieldGet$29(_parentContainer,this)){const t=Number.parseInt(getComputedStyle(_classPrivateFieldGet$29(_parentContainer,this).querySelector(".htCore")).borderLeftWidth,10);e-=t}_classPrivateFieldGet$29(_container,this).style.left=`${e}px`}},import_es_set_difference_v2$10=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$10=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$10=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$10=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$10=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$10=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$10=__toESM(require_es_set_union_v2(),1);function createPaginator(e){let{initialPage:t=-1,size:i=()=>0,onItemSelect:r=()=>{},onClear:o=()=>{}}=e;const a=new Set;let c=clamp$1(t,-1,_()-1);function u(S,T){const A=_()-1;return S<0&&(S=A),S>A&&(S=0),a.has(S)?-1:(a.add(S),r(S,!1)===!1&&(S=u(T===1?++S:--S,T)),S)}function h(S){S>-1&&S<_()&&r(S,!0)!==!1&&(c=S)}function d(){return c}function f(){_()>0&&(a.clear(),c=u(0,1))}function m(){_()>0&&(a.clear(),c=u(_()-1,-1))}function g(){_()>0&&(a.clear(),c=u(++c,1))}function v(){_()>0&&(a.clear(),c=u(--c,-1))}function _(){return Math.max(i(),0)}function b(){a.clear(),c=t,o()}return{setCurrentPage:h,getCurrentPage:d,toFirstItem:f,toLastItem:m,toNextItem:g,toPreviousItem:v,getSize:_,clear:b}}var import_es_array_push$54=__toESM(require_es_array_push(),1);function normalizeSelection(e){return arrayMap$1(e,t=>({start:t.getTopStartCorner(),end:t.getBottomEndCorner()}))}function isItemSubMenu(e){return hasOwnProperty$15(e,"submenu")}function isItemSeparator(e){return new RegExp(KEY$10,"i").test(e.name)}function isItemDisabled(e,t){return e.disabled===!0||typeof e.disabled=="function"&&e.disabled.call(t)===!0}function isItemSelectionDisabled(e){return hasOwnProperty$15(e,"disableSelection")}function isSeparator(e){return hasClass$1(e,"htSeparator")}function hasSubMenu(e){return hasClass$1(e,"htSubmenu")}function isDisabled(e){return hasClass$1(e,"htDisabled")}function isSelectionDisabled(e){return hasClass$1(e,"htSelectionDisabled")}function isItemHidden(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function shiftSeparators(e,t){const i=e.slice(0);for(let r=0;r<i.length&&i[r].name===t;)i.shift();return i}function popSeparators(e,t){let i=e.slice(0);return i.reverse(),i=shiftSeparators(i,t),i.reverse(),i}function removeDuplicatedSeparators(e){const t=[];return arrayEach$1(e,(i,r)=>{r>0?t[t.length-1].name!==i.name&&t.push(i):t.push(i)}),t}function filterSeparators(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:KEY$10,i=e.slice(0);return i=shiftSeparators(i,t),i=popSeparators(i,t),i=removeDuplicatedSeparators(i),i}function isItemCheckable(e){return e.checkable===!0}function createMenuNavigator(e){return createPaginator({size:()=>e.countRows(),onItemSelect(t,i){const r=e.getCell(t,0);if(!r||isSeparator(r)||isDisabled(r)||isSelectionDisabled(r))return!1;e.selectCell(t,0,...i?[t,0,!1,!1]:[])},onClear(){e.deselectCell()}})}function createDefaultShortcutsList(e){const{hot:t,hotMenu:i}=e;return[{keys:[["Control/Meta","A"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:()=>e.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,o)=>{const a=t.getSettings(),c=typeof a.tabMoves=="function"?a.tabMoves(r):a.tabMoves;o.includes("shift")?t.selection.transformStart(-c.row,-c.col):t.selection.transformStart(c.row,c.col),e.close(!0)}},{keys:[["Escape"]],callback:()=>e.close()},{keys:[["ArrowDown"]],callback:()=>e.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>e.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const r=i.getSelectedLast();if(r){const o=e.openSubMenu(r[0]);o&&o.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{i.getSelectedLast()&&e.isSubMenu()&&(e.close(),e.isSubMenu()&&e.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>e.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>e.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const o=i.getSelectedLast();o&&(i.getSourceDataAtRow(o[0]).submenu?e.openSubMenu(o[0]).getNavigator().toFirstItem():(e.executeCommand(r),e.close(!0)))}},{keys:[["PageUp"]],callback:()=>{i.getSelectedLast()?i.selection.transformStart(-i.countVisibleRows(),0):e.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{i.getSelectedLast()?i.selection.transformStart(i.countVisibleRows(),0):e.getNavigator().toLastItem()}}]}var import_es_array_push$53=__toESM(require_es_array_push(),1);const SHORTCUTS_CONTEXT="menu",SHORTCUTS_GROUP$8=SHORTCUTS_CONTEXT;function createKeyboardShortcutsCtrl(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=[];r(createDefaultShortcutsList(e)),t.forEach(d=>{let{shortcuts:f,contextName:m}=d;o(f,m)});function r(d,f){u(f).addShortcuts(d,{group:SHORTCUTS_CONTEXT})}function o(d,f){const m=u(f);d.forEach(g=>{let{keys:v}=g;v.forEach(_=>m.removeShortcutsByKeys(_))}),i.push({shortcuts:d,contextName:f}),r(d,f)}function a(){return[...i]}function c(d){return d?`${SHORTCUTS_GROUP$8}:${d}`:SHORTCUTS_GROUP$8}function u(d){var f;const m=e.hotMenu.getShortcutManager(),g=c(d);return(f=m.getContext(g))!==null&&f!==void 0?f:m.addContext(g)}function h(d){e.hotMenu.getShortcutManager().setActiveContextName(c(d))}return{addCustomShortcuts:o,getCustomShortcuts:a,getContext:u,listen:h}}function createMenuItemRenderer(e){return(t,i,r,o,a,c)=>{const u=t.getSourceDataAtRow(r),h=e.rootDocument.createElement("div"),d=typeof c=="function"?c.call(e):c,f=typeof u.ariaLabel=="function"?u.ariaLabel.call(e):u.ariaLabel,m=typeof u.ariaChecked=="function"?u.ariaChecked.call(e):u.ariaChecked;if(empty(i),addClass$1(h,"htItemWrapper"),e.getSettings().ariaTags){const g=!isItemDisabled(u,e)&&!isItemSelectionDisabled(u)&&!isItemSeparator(u);setAttribute(i,[...isItemCheckable(u)?[A11Y_MENU_ITEM_CHECKBOX(),A11Y_LABEL(f),A11Y_CHECKED(m)]:[A11Y_MENU_ITEM(),A11Y_LABEL(d)],...g?[A11Y_TABINDEX(-1)]:[],...isItemDisabled(u,e)?[A11Y_DISABLED()]:[],...isItemSubMenu(u)?[A11Y_EXPANDED(!1)]:[]])}i.className="",i.appendChild(h),isItemSeparator(u)?addClass$1(i,"htSeparator"):typeof u.renderer=="function"?(addClass$1(i,"htCustomMenuRenderer"),i.appendChild(u.renderer(t,h,r,o,a,d))):fastInnerHTML(h,d),isItemDisabled(u,e)?addClass$1(i,"htDisabled"):isItemSelectionDisabled(u)?addClass$1(i,"htSelectionDisabled"):isItemSubMenu(u)&&addClass$1(i,"htSubmenu")}}var import_es_error_cause$68=__toESM(require_es_error_cause(),1),import_es_array_push$52=__toESM(require_es_array_push(),1);function _classPrivateFieldInitSpec$28(e,t,i){_checkPrivateRedeclaration$40(e,t),t.set(e,i)}function _checkPrivateRedeclaration$40(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$41(e,t,i){return(t=_toPropertyKey$42(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$42(e){var t=_toPrimitive$42(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$42(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldSet$27(e,t,i){return e.set(_assertClassBrand$40(e,t),i),i}function _classPrivateFieldGet$28(e,t){return e.get(_assertClassBrand$40(e,t))}function _assertClassBrand$40(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const MIN_WIDTH=215;var _navigator=new WeakMap,_shortcutsCtrl=new WeakMap,_tableBorderWidth=new WeakMap,Menu=class ns{get tableBorderWidth(){return _classPrivateFieldGet$28(_tableBorderWidth,this)===void 0&&this.hotMenu&&_classPrivateFieldSet$27(_tableBorderWidth,this,parseInt(getComputedStyle$3(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),_classPrivateFieldGet$28(_tableBorderWidth,this)}constructor(t,i){var r=this;_defineProperty$41(this,"hot",void 0),_defineProperty$41(this,"options",void 0),_defineProperty$41(this,"eventManager",new eventManager_default(this)),_defineProperty$41(this,"container",void 0),_defineProperty$41(this,"positioner",void 0),_defineProperty$41(this,"hotMenu",null),_defineProperty$41(this,"hotSubMenus",{}),_defineProperty$41(this,"parentMenu",void 0),_defineProperty$41(this,"menuItems",null),_defineProperty$41(this,"origOutsideClickDeselects",null),_classPrivateFieldInitSpec$28(this,_navigator,void 0),_classPrivateFieldInitSpec$28(this,_shortcutsCtrl,void 0),_classPrivateFieldInitSpec$28(this,_tableBorderWidth,void 0),this.hot=t,this.options=i||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:MIN_WIDTH,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Positioner(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return r.parentMenu.runLocalHooks("afterSelectionChange",...a)})}registerEvents(){let t=this.hot.rootWindow;for(;t;)this.eventManager.addEventListener(t.document,"mousedown",i=>this.onDocumentMouseDown(i)),this.eventManager.addEventListener(t.document,"touchstart",i=>this.onDocumentMouseDown(i)),this.eventManager.addEventListener(t.document,"contextmenu",i=>this.onDocumentContextMenu(i)),t=getParentWindow(t)}setMenuItems(t){this.menuItems=t}getNavigator(){return _classPrivateFieldGet$28(_navigator,this)}getKeyboardShortcutsCtrl(){return _classPrivateFieldGet$28(_shortcutsCtrl,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const t=debounce$3(u=>this.openSubMenu(u),300),i=this.options.minWidth||MIN_WIDTH;let r=!1,o=arrayFilter$1(this.menuItems,u=>(u.key===KEY$11&&(r=!0),isItemHidden(u,this.hot)));if(o.length<1&&!r)o.push(predefinedItems()[KEY$11]);else if(o.length===0)return;o=filterSeparators(o,KEY$10);let a=!1;const c={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(u){return isDefined(u)&&u<i?i:u},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:createMenuItemRenderer(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(u,h)=>{_classPrivateFieldGet$28(_navigator,this).setCurrentPage(h.row)},afterOnCellMouseOver:(u,h)=>{this.isAllSubMenusClosed()?t(h.row):this.openSubMenu(h.row)},rowHeights:u=>o[u].name===KEY$10?1:void 0,afterOnCellContextMenu:u=>{u.preventDefault(),isWindowsOS()&&a&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(u,h,d,f,m)=>{this.hotMenu.view.isMouseDown()&&(m.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:u=>{this.hasSelectedItem()&&(a=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(u))},afterOnCellMouseUp:u=>{(!isWindowsOS()||!isRightClick(u))&&a&&this.hasSelectedItem()&&(isMobileBrowser()||isIpadOS()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,c),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),_classPrivateFieldSet$27(_navigator,this,createMenuNavigator(this.hotMenu)),_classPrivateFieldSet$27(_shortcutsCtrl,this,createKeyboardShortcutsCtrl(this)),_classPrivateFieldGet$28(_shortcutsCtrl,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(t&&this.isSubMenu())this.parentMenu.close();else if(_classPrivateFieldGet$28(_navigator,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const i=this.parentMenu.hotMenu.getSelectedLast();if(i){const r=this.parentMenu.hotMenu.getCell(i[0],0);setAttribute(r,[A11Y_EXPANDED(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(t){if(!this.hotMenu)return!1;const i=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!i||!hasSubMenu(i))return!1;const r=this.hotMenu.getSourceDataAtRow(t),o=new ns(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(r.submenu.items),o.open(),o.setPosition(i.getBoundingClientRect()),this.hotSubMenus[r.key]=o,this.hot.getSettings().ariaTags&&setAttribute(i,[A11Y_EXPANDED(!0)]),o}closeSubMenu(t){const i=this.hotMenu.getSourceDataAtRow(t),r=this.hotSubMenus[i.key];if(r){r.destroy(),delete this.hotSubMenus[i.key];const o=this.hotMenu.getCell(t,0);this.hot.getSettings().ariaTags&&setAttribute(o,[A11Y_EXPANDED(!1)])}}closeAllSubMenus(){arrayEach$1(this.hotMenu.getData(),(t,i)=>this.closeSubMenu(i))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(t){if(!this.isOpened()||!this.hasSelectedItem())return;const i=this.getSelectedItem();if(this.runLocalHooks("select",i,t),this.isCommandPassive(i))return;const r=this.hot.getSelectedRange(),o=r?normalizeSelection(r):[];this.runLocalHooks("executeCommand",i.key,o,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",i.key,o,t)}isCommandPassive(t){return t.isCommand===!1||isItemSeparator(t)||isItemDisabled(t,this.hot)||isItemSubMenu(t)}setOffset(t){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(t,i)}setPosition(t){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(t)}updateMenuDimensions(){const{wtTable:t}=this.hotMenu.view._wt,i=this.hotMenu.getSettings().data,r=t.hider.style,o=t.holder.style,a=parseInt(r.width,10),c=arrayReduce(i,(u,h,d)=>{const m=this.hotMenu.getCell(d,0)?outerHeight(this.hotMenu.getCell(d,0)):0;return u+(h.name===KEY$10?1:m)},0);o.width=`${a+3}px`,o.height=`${c+3}px`,r.height=o.height}createContainer(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const i=this.options.container.ownerDocument;let r=t,o;return r&&(isFunction$2(r)&&(r=r.call(this.hot),r===null||isUndefined$1(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,o=i.querySelector(`.${this.options.className}.${r}`)),o||(o=i.createElement("div"),addClass$1(o,`htMenu ${this.options.className}`),r&&addClass$1(o,r),this.options.container.appendChild(o)),o}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&setAttribute(this.hotMenu.rootElement,[A11Y_MENU(),A11Y_TABINDEX(-1)])}onDocumentMouseDown(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!isChildOf(t.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!isChildOf(t.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(t){this.isOpened()&&hasClass$1(t.target,"htCore")&&isChildOf(t.target,this.hotMenu.rootElement)&&t.preventDefault()}};mixin(Menu,localHooks_default);var import_es_error_cause$67=__toESM(require_es_error_cause(),1);function _classPrivateMethodInitSpec$30(e,t){_checkPrivateRedeclaration$39(e,t),t.add(e)}function _checkPrivateRedeclaration$39(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$40(e,t,i){return(t=_toPropertyKey$41(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$41(e){var t=_toPrimitive$41(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$41(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand$39(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$24="contextMenu",PLUGIN_PRIORITY$23=70,SHORTCUTS_GROUP$7=PLUGIN_KEY$24;pluginHooks_default.getSingleton().register("afterContextMenuDefaultOptions"),pluginHooks_default.getSingleton().register("beforeContextMenuShow"),pluginHooks_default.getSingleton().register("afterContextMenuShow"),pluginHooks_default.getSingleton().register("afterContextMenuHide"),pluginHooks_default.getSingleton().register("afterContextMenuExecute");var _ContextMenu_brand=new WeakSet,ContextMenu=class rs extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$30(this,_ContextMenu_brand),_defineProperty$40(this,"commandExecutor",new CommandExecutor(this.hot)),_defineProperty$40(this,"itemsFactory",null),_defineProperty$40(this,"menu",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$24}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$23}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[KEY$8,KEY$9,KEY$10,KEY$2,KEY$3,KEY$10,KEY$7,KEY$6,KEY$10,KEY$12,KEY$5,KEY$10,KEY$4,KEY$10,KEY]}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$24]}enablePlugin(){var t=this;if(this.enabled)return;const i=this.hot.getSettings()[PLUGIN_KEY$24];typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),this.menu=new Menu(this.hot,{className:"htContextMenu",keepInViewport:!0,container:i.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>_assertClassBrand$39(_ContextMenu_brand,this,_onMenuBeforeOpen$1).call(this)),this.menu.addLocalHook("afterOpen",()=>_assertClassBrand$39(_ContextMenu_brand,this,_onMenuAfterOpen$1).call(this)),this.menu.addLocalHook("afterClose",()=>_assertClassBrand$39(_ContextMenu_brand,this,_onMenuAfterClose$1).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return t.executeCommand.call(t,...o)}),this.addHook("afterOnCellContextMenu",r=>_assertClassBrand$39(_ContextMenu_brand,this,_onAfterOnCellContextMenu).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const i=this.hot.getCell(t.row,t.col,!0).getBoundingClientRect(),r=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument);this.open({left:i.left+r.left,top:i.top+r.top-1+i.height},{left:i.width,above:-i.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var t;const i=(t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.highlight;return i&&this.hot.selection.isCellVisible(i)&&!this.menu.isOpened()},group:SHORTCUTS_GROUP$7})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$7)}open(t){var i;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((i=this.menu)!==null&&i!==void 0&&i.isOpened())return;this.prepareMenuItems(),this.menu.open(),this.menu.tableBorderWidth>0||(r.below+=1,r.right+=1,r.above-=1,r.left-=1),objectEach(r,(a,c)=>{this.menu.setOffset(c,a)}),this.menu.setPosition(t)}close(){var t;(t=this.menu)===null||t===void 0||t.close(),this.itemsFactory=null}executeCommand(t){this.itemsFactory===null&&this.prepareMenuItems();for(var i=arguments.length,r=new Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];this.commandExecutor.execute(t,...r)}prepareMenuItems(){this.itemsFactory=new ItemsFactory(this.hot,rs.DEFAULT_ITEMS);const t=this.hot.getSettings()[PLUGIN_KEY$24],i={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);const r=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),arrayEach$1(r,o=>this.commandExecutor.registerCommand(o.key,o))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}};function _onAfterOnCellContextMenu(e){const t=this.hot.getSettings(),i=t.rowHeaders,r=t.colHeaders;function o(u){return u.nodeName==="TD"||u.parentNode.nodeName==="TD"}const a=e.target;if(this.close(),hasClass$1(a,"handsontableInput")||(e.preventDefault(),e.stopPropagation(),!(i||r)&&!o(a)&&!(hasClass$1(a,"current")&&hasClass$1(a,"wtBorder"))))return;const c=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument);this.open({top:e.clientY+c.top,left:e.clientX+c.left})}function _onMenuBeforeOpen$1(){this.hot.runHooks("beforeContextMenuShow",this)}function _onMenuAfterOpen$1(){this.hot.runHooks("afterContextMenuShow",this)}function _onMenuAfterClose$1(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}ContextMenu.SEPARATOR={name:KEY$10};function copyItem(e){return{key:"copy",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY)},callback(){e.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;const i=this.getSelected();return!i||i.length>1},hidden:!1}}function copyColumnHeadersOnlyItem(e){return{key:"copy_column_headers_only",name(){const t=this.getSelectedRangeLast(),i=t?clamp$1(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,i)},callback(){e.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;const i=this.getSelected();return!i||i.length>1},hidden:!1}}function copyWithColumnGroupHeadersItem(e){return{key:"copy_with_column_group_headers",name(){const t=this.getSelectedRangeLast(),i=t?clamp$1(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,i)},callback(){e.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;const i=this.getSelected();return!i||i.length>1},hidden:!1}}function copyWithColumnHeadersItem(e){return{key:"copy_with_column_headers",name(){const t=this.getSelectedRangeLast(),i=t?clamp$1(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,i)},callback(){e.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;const i=this.getSelected();return!i||i.length>1},hidden:!1}}function cutItem(e){return{key:"cut",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_CUT)},callback(){e.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;const i=this.getSelected();return!i||i.length>1},hidden:!1}}var ClipboardData=class{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}},PasteEvent=class{constructor(){this.clipboardData=new ClipboardData}preventDefault(){}},import_es_error_cause$66=__toESM(require_es_error_cause(),1),import_es_array_push$51=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$29(e,t){_checkPrivateRedeclaration$38(e,t),t.add(e)}function _classPrivateFieldInitSpec$27(e,t,i){_checkPrivateRedeclaration$38(e,t),t.set(e,i)}function _checkPrivateRedeclaration$38(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$27(e,t){return e.get(_assertClassBrand$38(e,t))}function _classPrivateFieldSet$26(e,t,i){return e.set(_assertClassBrand$38(e,t),i),i}function _assertClassBrand$38(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _selectedRange=new WeakMap,_countRows=new WeakMap,_countColumns=new WeakMap,_rowsLimit=new WeakMap,_columnsLimit$1=new WeakMap,_countColumnHeaders=new WeakMap,_CopyableRangesFactory_brand=new WeakSet,CopyableRangesFactory=class{constructor(e){let{countRows:t,countColumns:i,rowsLimit:r,columnsLimit:o,countColumnHeaders:a}=e;_classPrivateMethodInitSpec$29(this,_CopyableRangesFactory_brand),_classPrivateFieldInitSpec$27(this,_selectedRange,void 0),_classPrivateFieldInitSpec$27(this,_countRows,void 0),_classPrivateFieldInitSpec$27(this,_countColumns,void 0),_classPrivateFieldInitSpec$27(this,_rowsLimit,void 0),_classPrivateFieldInitSpec$27(this,_columnsLimit$1,void 0),_classPrivateFieldInitSpec$27(this,_countColumnHeaders,void 0),_classPrivateFieldSet$26(_countRows,this,t),_classPrivateFieldSet$26(_countColumns,this,i),_classPrivateFieldSet$26(_rowsLimit,this,r),_classPrivateFieldSet$26(_columnsLimit$1,this,o),_classPrivateFieldSet$26(_countColumnHeaders,this,a)}setSelectedRange(e){_classPrivateFieldSet$26(_selectedRange,this,e)}getCellsRange(){if(_classPrivateFieldGet$27(_countRows,this).call(this)===0||_classPrivateFieldGet$27(_countColumns,this).call(this)===0)return null;const{row:e,col:t}=_classPrivateFieldGet$27(_selectedRange,this).getTopStartCorner(),{row:i,col:r}=_classPrivateFieldGet$27(_selectedRange,this).getBottomEndCorner(),o=_assertClassBrand$38(_CopyableRangesFactory_brand,this,_trimRowsRange).call(this,e,i),a=_assertClassBrand$38(_CopyableRangesFactory_brand,this,_trimColumnsRange).call(this,t,r);return{isRangeTrimmed:i!==o||r!==a,startRow:e,startCol:t,endRow:o,endCol:a}}getMostBottomColumnHeadersRange(){if(_classPrivateFieldGet$27(_countColumns,this).call(this)===0||_classPrivateFieldGet$27(_countColumnHeaders,this).call(this)===0)return null;const{col:e}=_classPrivateFieldGet$27(_selectedRange,this).getTopStartCorner(),{col:t}=_classPrivateFieldGet$27(_selectedRange,this).getBottomEndCorner(),i=_assertClassBrand$38(_CopyableRangesFactory_brand,this,_trimColumnsRange).call(this,e,t);return{isRangeTrimmed:t!==i,startRow:-1,startCol:e,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(_classPrivateFieldGet$27(_countColumns,this).call(this)===0||_classPrivateFieldGet$27(_countColumnHeaders,this).call(this)===0)return null;const{col:e}=_classPrivateFieldGet$27(_selectedRange,this).getTopStartCorner(),{col:t}=_classPrivateFieldGet$27(_selectedRange,this).getBottomEndCorner(),i=_assertClassBrand$38(_CopyableRangesFactory_brand,this,_trimColumnsRange).call(this,e,t);return{isRangeTrimmed:t!==i,startRow:-_classPrivateFieldGet$27(_countColumnHeaders,this).call(this),startCol:e,endRow:-1,endCol:i}}};function _trimColumnsRange(e,t){return Math.min(t,Math.max(e+_classPrivateFieldGet$27(_columnsLimit$1,this).call(this)-1,e))}function _trimRowsRange(e,t){return Math.min(t,Math.max(e+_classPrivateFieldGet$27(_rowsLimit,this).call(this)-1,e))}function normalizeRanges$1(e){const t=[],i=[];return arrayEach$1(e,r=>{const o=Math.min(r.startRow,r.endRow),a=Math.max(r.startRow,r.endRow);rangeEach(o,a,h=>{t.indexOf(h)===-1&&t.push(h)});const c=Math.min(r.startCol,r.endCol),u=Math.max(r.startCol,r.endCol);rangeEach(c,u,h=>{i.indexOf(h)===-1&&i.push(h)})}),{rows:t,columns:i}}var import_es_error_cause$65=__toESM(require_es_error_cause(),1),import_es_array_push$50=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$28(e,t){_checkPrivateRedeclaration$37(e,t),t.add(e)}function _classPrivateFieldInitSpec$26(e,t,i){_checkPrivateRedeclaration$37(e,t),t.set(e,i)}function _checkPrivateRedeclaration$37(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$39(e,t,i){return(t=_toPropertyKey$40(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$40(e){var t=_toPrimitive$40(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$40(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet$26(e,t){return e.get(_assertClassBrand$37(e,t))}function _classPrivateFieldSet$25(e,t,i){return e.set(_assertClassBrand$37(e,t),i),i}function _assertClassBrand$37(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}pluginHooks_default.getSingleton().register("afterCopyLimit"),pluginHooks_default.getSingleton().register("modifyCopyableRange"),pluginHooks_default.getSingleton().register("beforeCut"),pluginHooks_default.getSingleton().register("afterCut"),pluginHooks_default.getSingleton().register("beforePaste"),pluginHooks_default.getSingleton().register("afterPaste"),pluginHooks_default.getSingleton().register("beforeCopy"),pluginHooks_default.getSingleton().register("afterCopy");const PLUGIN_KEY$23="copyPaste",PLUGIN_PRIORITY$22=80,SETTING_KEYS$1=["fragmentSelection"],META_HEAD=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var _enableCopyColumnHeaders=new WeakMap,_enableCopyColumnGroupHeaders=new WeakMap,_enableCopyColumnHeadersOnly=new WeakMap,_copyMode=new WeakMap,_isTriggeredByCopy=new WeakMap,_isTriggeredByCut=new WeakMap,_copyableRangesFactory=new WeakMap,_preventViewportScrollOnPaste=new WeakMap,_CopyPaste_brand=new WeakSet,CopyPaste=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$28(this,_CopyPaste_brand),_defineProperty$39(this,"columnsLimit",1/0),_defineProperty$39(this,"rowsLimit",1/0),_defineProperty$39(this,"pasteMode","overwrite"),_defineProperty$39(this,"uiContainer",this.hot.rootDocument.body),_classPrivateFieldInitSpec$26(this,_enableCopyColumnHeaders,!1),_classPrivateFieldInitSpec$26(this,_enableCopyColumnGroupHeaders,!1),_classPrivateFieldInitSpec$26(this,_enableCopyColumnHeadersOnly,!1),_classPrivateFieldInitSpec$26(this,_copyMode,"cells-only"),_classPrivateFieldInitSpec$26(this,_isTriggeredByCopy,!1),_classPrivateFieldInitSpec$26(this,_isTriggeredByCut,!1),_classPrivateFieldInitSpec$26(this,_copyableRangesFactory,new CopyableRangesFactory({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),_classPrivateFieldInitSpec$26(this,_preventViewportScrollOnPaste,!1),_defineProperty$39(this,"copyableRanges",[])}static get PLUGIN_KEY(){return PLUGIN_KEY$23}static get SETTING_KEYS(){return[PLUGIN_KEY$23,...SETTING_KEYS$1]}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$22}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$23]}enablePlugin(){var e=this;if(this.enabled)return;const{[PLUGIN_KEY$23]:t}=this.hot.getSettings();if(typeof t=="object"){var i,r;this.pasteMode=(i=t.pasteMode)!==null&&i!==void 0?i:this.pasteMode,this.rowsLimit=isNaN(t.rowsLimit)?this.rowsLimit:t.rowsLimit,this.columnsLimit=isNaN(t.columnsLimit)?this.columnsLimit:t.columnsLimit,_classPrivateFieldSet$25(_enableCopyColumnHeaders,this,!!t.copyColumnHeaders),_classPrivateFieldSet$25(_enableCopyColumnGroupHeaders,this,!!t.copyColumnGroupHeaders),_classPrivateFieldSet$25(_enableCopyColumnHeadersOnly,this,!!t.copyColumnHeadersOnly),this.uiContainer=(r=t.uiContainer)!==null&&r!==void 0?r:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>_assertClassBrand$37(_CopyPaste_brand,this,_onAfterContextMenuDefaultOptions$4).call(this,o)),this.addHook("afterSelection",function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return _assertClassBrand$37(_CopyPaste_brand,e,_onAfterSelection).call(e,...a)}),this.addHook("afterSelectionEnd",()=>_assertClassBrand$37(_CopyPaste_brand,this,_onAfterSelectionEnd$1).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),isSafari$1()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return _assertClassBrand$37(_CopyPaste_brand,e,_onSafariMouseEnter).call(e,...a)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return _assertClassBrand$37(_CopyPaste_brand,e,_onSafariMouseLeave).call(e,...a)}),this.addHook("afterSelection",()=>_assertClassBrand$37(_CopyPaste_brand,this,_onSafariAfterSelection).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";_classPrivateFieldSet$25(_copyMode,this,e),_classPrivateFieldSet$25(_isTriggeredByCopy,this,!0),_assertClassBrand$37(_CopyPaste_brand,this,_ensureClipboardEventsGetTriggered).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){_classPrivateFieldSet$25(_isTriggeredByCut,this,!0),_assertClassBrand$37(_CopyPaste_brand,this,_ensureClipboardEventsGetTriggered).call(this,"cut")}getRangedCopyableData(e){return stringify$2(this.getRangedData(e))}getRangedData(e){const t=[],{rows:i,columns:r}=normalizeRanges$1(e);return arrayEach$1(i,o=>{const a=[];arrayEach$1(r,c=>{o<0?a.push(this.hot.getColHeader(c,o)):a.push(this.hot.getCopyableData(o,c))}),t.push(a)}),t}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!t)return;const i=new PasteEvent;e&&i.clipboardData.setData("text/plain",e),t&&i.clipboardData.setData("text/html",t),this.onPaste(i)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}_classPrivateFieldGet$26(_copyableRangesFactory,this).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);_classPrivateFieldGet$26(_copyMode,this)==="column-headers-only"?t.set("headers",_classPrivateFieldGet$26(_copyableRangesFactory,this).getMostBottomColumnHeadersRange()):(_classPrivateFieldGet$26(_copyMode,this)==="with-column-headers"?t.set("headers",_classPrivateFieldGet$26(_copyableRangesFactory,this).getMostBottomColumnHeadersRange()):_classPrivateFieldGet$26(_copyMode,this)==="with-column-group-headers"&&t.set("headers",_classPrivateFieldGet$26(_copyableRangesFactory,this).getAllColumnHeadersRange()),t.set("cells",_classPrivateFieldGet$26(_copyableRangesFactory,this).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(r=>r!==null).map(r=>{let{startRow:o,startCol:a,endRow:c,endCol:u}=r;return{startRow:o,startCol:a,endRow:c,endCol:u}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const i=t.get("cells");if(i!==null&&i.isRangeTrimmed){const{startRow:r,startCol:o,endRow:a,endCol:c}=i;this.hot.runHooks("afterCopyLimit",a-r+1,c-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const i=e.length,r=e[0].length,o=[],{row:a,col:c}=t.getTopStartCorner(),{row:u,col:h}=t.getBottomEndCorner();let d=a,f=c,m=a,g=c;for(;o.length<i||d<=u;){const{skipRowOnPaste:v,visualRow:_}=this.hot.getCellMeta(d,c);if(d=_+1,v===!0)continue;m=_,f=c;const b=[],S=o.length%i;for(;b.length<r||f<=h;){const{skipColumnOnPaste:T,visualCol:A}=this.hot.getCellMeta(a,f);if(f=A+1,T===!0)continue;g=A;const I=b.length%r;b.push(e[S][I])}o.push(b)}return _classPrivateFieldSet$25(_preventViewportScrollOnPaste,this,!0),this.hot.populateFromArray(a,c,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,c,m,g]}onCopy(e){var t;const i=this.hot.getFocusManager().getRefocusElement(),r=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!_classPrivateFieldGet$26(_isTriggeredByCopy,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(r&&e.target!==i||!r&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),_classPrivateFieldSet$25(_isTriggeredByCopy,this,!1);const o=this.getRangedData(this.copyableRanges),a=_assertClassBrand$37(_CopyPaste_brand,this,_countCopiedHeaders).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,a)){const u=stringify$2(o);if(e&&e.clipboardData){const h=_dataToHTML(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",u),e.clipboardData.setData("text/html",[META_HEAD,h].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",u);this.hot.runHooks("afterCopy",o,this.copyableRanges,a)}_classPrivateFieldSet$25(_copyMode,this,"cells-only")}onCut(e){var t;const i=this.hot.getFocusManager().getRefocusElement(),r=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!_classPrivateFieldGet$26(_isTriggeredByCut,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(r&&e.target!==i||!r&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),_classPrivateFieldSet$25(_isTriggeredByCut,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const c=stringify$2(o);if(e&&e.clipboardData){const u=_dataToHTML(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",c),e.clipboardData.setData("text/html",[META_HEAD,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",c);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){var t;const i=this.hot.getFocusManager().getRefocusElement(),r=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||e.target instanceof HTMLElement&&(r&&e.target!==i||!r&&e.target!==this.hot.rootDocument.body))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const d=sanitize(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});d&&/(<table)|(<TABLE)/g.test(d)?o=htmlToGridSettings(d,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=parse$4(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[a,c,u,h]=this.populateValues(o);this.hot.selectCell(a,c,Math.min(this.hot.countRows()-1,u),Math.min(this.hot.countCols()-1,h)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}};function _ensureClipboardEventsGetTriggered(e){if(isSafari$1()){const t=this.hot.getSelectedRangeLast();if(t){const{row:i,col:r}=t.highlight,o=this.hot.getCell(i,r,!0);o&&runWithSelectedContendEditableElement(o,()=>{this.hot.rootDocument.execCommand(e)})}}else this.hot.rootDocument.execCommand(e)}function _countCopiedHeaders(e){const{rows:t}=normalizeRanges$1(e);let i=0;for(let r=0;r<t.length&&!(t[r]>=0);r++)i+=1;return{columnHeadersCount:i}}function _addContentEditableToHighlightedCell(){if(this.hot.isListening()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:i}=e.highlight,r=this.hot.getCell(t,i,!0);r&&makeElementContentEditableAndSelectItsContent(r)}}}function _removeContentEditableFromHighlightedCell(){if(this.hot.isListening()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:i}=e.highlight,r=this.hot.getCell(t,i,!0);r!=null&&r.hasAttribute("contenteditable")&&removeContentEditableFromElementAndDeselect(r)}}}function _onAfterContextMenuDefaultOptions$4(e){e.items.push({name:"---------"},copyItem(this)),_classPrivateFieldGet$26(_enableCopyColumnHeaders,this)&&e.items.push(copyWithColumnHeadersItem(this)),_classPrivateFieldGet$26(_enableCopyColumnGroupHeaders,this)&&e.items.push(copyWithColumnGroupHeadersItem(this)),_classPrivateFieldGet$26(_enableCopyColumnHeadersOnly,this)&&e.items.push(copyColumnHeadersOnlyItem(this)),e.items.push(cutItem(this))}function _onAfterSelection(e,t,i,r,o){_classPrivateFieldGet$26(_preventViewportScrollOnPaste,this)&&(o.value=!0),_classPrivateFieldSet$25(_preventViewportScrollOnPaste,this,!1)}function _onAfterSelectionEnd$1(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function _onSafariMouseEnter(){_assertClassBrand$37(_CopyPaste_brand,this,_removeContentEditableFromHighlightedCell).call(this)}function _onSafariMouseLeave(){_assertClassBrand$37(_CopyPaste_brand,this,_addContentEditableToHighlightedCell).call(this)}function _onSafariAfterSelection(){_assertClassBrand$37(_CopyPaste_brand,this,_removeContentEditableFromHighlightedCell).call(this)}function createId(e,t){return`border_row${e}col${t}`}function createDefaultCustomBorder(){return{width:1,color:"#000"}}function createSingleEmptyBorder(){return{hide:!0}}function createDefaultHtBorder(){return{width:1,color:"#000",cornerVisible:!1}}function normalizeBorder(e){if(isDefined(e.start)||isDefined(e.left)){var t;e.start=(t=e.start)!==null&&t!==void 0?t:e.left}if(isDefined(e.end)||isDefined(e.right)){var i;e.end=(i=e.end)!==null&&i!==void 0?i:e.right}return delete e.left,delete e.right,e}function denormalizeBorder(e){return isDefined(e.start)&&(e.left=e.start),isDefined(e.end)&&(e.right=e.end),e}function createEmptyBorders(e,t){return{id:createId(e,t),border:createDefaultHtBorder(),row:e,col:t,top:createSingleEmptyBorder(),bottom:createSingleEmptyBorder(),start:createSingleEmptyBorder(),end:createSingleEmptyBorder()}}function extendDefaultBorder(e,t){return hasOwnProperty$15(t,"border")&&t.border&&(e.border=t.border),hasOwnProperty$15(t,"top")&&isDefined(t.top)&&(t.top?(isObject$4(t.top)||(t.top=createDefaultCustomBorder()),e.top=t.top):(t.top=createSingleEmptyBorder(),e.top=t.top)),hasOwnProperty$15(t,"bottom")&&isDefined(t.bottom)&&(t.bottom?(isObject$4(t.bottom)||(t.bottom=createDefaultCustomBorder()),e.bottom=t.bottom):(t.bottom=createSingleEmptyBorder(),e.bottom=t.bottom)),hasOwnProperty$15(t,"start")&&isDefined(t.start)&&(t.start?(isObject$4(t.start)||(t.start=createDefaultCustomBorder()),e.start=t.start):(t.start=createSingleEmptyBorder(),e.start=t.start)),hasOwnProperty$15(t,"end")&&isDefined(t.end)&&(t.end?(isObject$4(t.end)||(t.end=createDefaultCustomBorder()),e.end=t.end):(t.end=createSingleEmptyBorder(),e.end=t.end)),e}function checkSelectionBorders(e,t){let i=!1;return arrayEach$1(e.getSelectedRange(),r=>{r.forAll((o,a)=>{if(o<0||a<0)return;const c=e.getCellMeta(o,a).borders;if(c)if(t){if(!hasOwnProperty$15(c[t],"hide")||c[t].hide===!1)return i=!0,!1}else return i=!0,!1})}),i}function markSelected(e){return`<span class="selected">\u2713</span>${e}`}function hasLeftRightTypeOptions(e){return e.some(t=>isDefined(t.left)||isDefined(t.right))}function hasStartEndTypeOptions(e){return e.some(t=>isDefined(t.start)||isDefined(t.end))}const physicalToInlinePropNames=new Map([["left","start"],["right","end"]]);function toInlinePropName(e){var t;return(t=physicalToInlinePropNames.get(e))!==null&&t!==void 0?t:e}function bottom$1(e){return{key:"borders:bottom",name(){let t=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_BOTTOM);return checkSelectionBorders(this,"bottom")&&(t=markSelected(t)),t},callback(t,i){const r=checkSelectionBorders(this,"bottom");e.prepareBorder(i,"bottom",r)}}}function left$1(e){const t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let i=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_LEFT);return checkSelectionBorders(this,t)&&(i=markSelected(i)),i},callback(i,r){const o=checkSelectionBorders(this,t);e.prepareBorder(r,t,o)}}}function noBorders(e){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback(t,i){e.prepareBorder(i,"noBorders")},disabled(){return!checkSelectionBorders(this)}}}function right$1(e){const t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let i=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_RIGHT);return checkSelectionBorders(this,t)&&(i=markSelected(i)),i},callback(i,r){const o=checkSelectionBorders(this,t);e.prepareBorder(r,t,o)}}}function top$1(e){return{key:"borders:top",name(){let t=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_TOP);return checkSelectionBorders(this,"top")&&(t=markSelected(t)),t},callback(t,i){const r=checkSelectionBorders(this,"top");e.prepareBorder(i,"top",r)}}}var import_es_error_cause$64=__toESM(require_es_error_cause(),1),import_es_array_push$49=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$27(e,t){_checkPrivateRedeclaration$36(e,t),t.add(e)}function _checkPrivateRedeclaration$36(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$38(e,t,i){return(t=_toPropertyKey$39(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$39(e){var t=_toPrimitive$39(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$39(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand$36(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$22="customBorders",PLUGIN_PRIORITY$21=90;var _CustomBorders_brand=new WeakSet,CustomBorders=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$27(this,_CustomBorders_brand),_defineProperty$38(this,"savedBorders",[])}static get PLUGIN_KEY(){return PLUGIN_KEY$22}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$21}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$22]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>_assertClassBrand$36(_CustomBorders_brand,this,_onAfterContextMenuDefaultOptions$3).call(this,e)),this.addHook("init",()=>_assertClassBrand$36(_CustomBorders_brand,this,_onAfterInit$2).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let i=["top","bottom","start","end"],r=null;t&&(this.checkSettingsCohesion([t]),i=Object.keys(t),r=normalizeBorder(t));const o=detectSelectionType(e),a=normalizeSelectionFactory(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});arrayEach$1(e,c=>{a(c).forAll((u,h)=>{arrayEach$1(i,d=>{this.prepareBorderFromCustomAdded(u,h,r,toInlinePropName(d))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=detectSelectionType(e),i=normalizeSelectionFactory(t,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),r=[];return arrayEach$1(e,o=>{i(o).forAll((a,c)=>{arrayEach$1(this.savedBorders,u=>{u.row===a&&u.col===c&&r.push(denormalizeBorder(u))})})}),r}clearBorders(e){e?this.setBorders(e):(arrayEach$1(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const r=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,r,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:r})}prepareBorderFromCustomAdded(e,t,i,r){const o=this.hot.countRows(),a=this.hot.countCols();if(e>=o||t>=a)return;let c=createEmptyBorders(e,t);i&&(c=extendDefaultBorder(c,i),arrayEach$1(this.hot.selection.highlight.customSelections,u=>{if(c.id===u.settings.id)return Object.assign(u.settings,i),c.id=u.settings.id,c.top=u.settings.top,c.bottom=u.settings.bottom,c.start=u.settings.start,c.end=u.settings.end,!1})),this.hot.setCellMeta(e,t,"borders",denormalizeBorder(c)),this.insertBorderIntoSettings(c,r)}prepareBorderFromCustomAddedRange(e,t){const i=Math.min(e.to.row,this.hot.countRows()-1),r=Math.min(e.to.col,this.hot.countCols()-1);rangeEach(e.from.row,i,o=>{rangeEach(e.from.col,r,a=>{const c=createEmptyBorders(o,a);let u=0;o===e.from.row&&hasOwnProperty$15(t,"top")&&(u+=1,c.top=t.top),o===e.to.row&&hasOwnProperty$15(t,"bottom")&&(u+=1,c.bottom=t.bottom),a===e.from.col&&hasOwnProperty$15(t,"start")&&(u+=1,c.start=t.start),a===e.to.col&&hasOwnProperty$15(t,"end")&&(u+=1,c.end=t.end),u>0&&(this.hot.setCellMeta(o,a,"borders",denormalizeBorder(c)),this.insertBorderIntoSettings(c))})})}removeAllBorders(e,t){const i=createId(e,t);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,i,r){let o=this.hot.getCellMeta(e,t).borders;!o||o.border===void 0?o=createEmptyBorders(e,t):o=normalizeBorder(o),r?(o[i]=createSingleEmptyBorder(),this.countHide(o)===4?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(o,i,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",denormalizeBorder(o)))):(o[i]=createDefaultCustomBorder(),this.checkCustomSelectionsFromContextMenu(o,i,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",denormalizeBorder(o)))}prepareBorder(e,t,i){arrayEach$1(e,r=>{let{start:o,end:a}=r;if(o.row===a.row&&o.col===a.col)t==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,t,i);else switch(t){case"noBorders":rangeEach(o.col,a.col,c=>{rangeEach(o.row,a.row,u=>{this.removeAllBorders(u,c)})});break;case"top":rangeEach(o.col,a.col,c=>{this.setBorder(o.row,c,t,i)});break;case"bottom":rangeEach(o.col,a.col,c=>{this.setBorder(a.row,c,t,i)});break;case"start":rangeEach(o.row,a.row,c=>{this.setBorder(c,o.col,t,i)});break;case"end":rangeEach(o.row,a.row,c=>{this.setBorder(c,a.col,t,i)});break;default:break}})}createCustomBorders(e){arrayEach$1(e,t=>{const i=normalizeBorder(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,i):this.prepareBorderFromCustomAdded(t.row,t.col,i)})}countHide(e){const{top:t,bottom:i,start:r,end:o}=e;return arrayReduce([t,i,r,o],(c,u)=>{let h=c;return u&&u.hide&&(h+=1),h},0)}clearBordersFromSelectionSettings(e){const t=arrayMap$1(this.hot.selection.highlight.customSelections,i=>i.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){arrayEach$1(this.hot.selection.highlight.customSelections,(e,t)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){arrayEach$1(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const t=arrayMap$1(this.savedBorders,i=>i.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),t=!0):arrayEach$1(this.savedBorders,(r,o)=>{if(e.id===r.id)return this.savedBorders[o]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,i){let r=!1;return arrayEach$1(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const a=this.hot.view._wt.selectionManager.getBorderInstances(o);return arrayEach$1(a,c=>{c.toggleHiddenClass(t,i)}),r=!0,!1}}),r}checkCustomSelections(e,t,i){const r=this.countHide(e);let o=!1;return r===4?(this.removeAllBorders(e.row,e.col),o=!0):arrayEach$1(this.hot.selection.highlight.customSelections,a=>{if(e.id===a.settings.id){if(a.visualCellRange=t,a.commit(),i){const c=this.hot.view._wt.selectionManager.getBorderInstances(a);arrayEach$1(c,u=>{u.changeBorderStyle(i,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[PLUGIN_KEY$22];if(Array.isArray(e)){const t=deepClone(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=hasLeftRightTypeOptions(e),i=hasStartEndTypeOptions(e);if(t&&i)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}};function _onAfterContextMenuDefaultOptions$3(e){this.hot.getSettings()[PLUGIN_KEY$22]&&e.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS)},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[top$1(this),right$1(this),bottom$1(this),left$1(this),noBorders(this)]}})}function _onAfterInit$2(){this.changeBorderSettings()}var import_es_error_cause$63=__toESM(require_es_error_cause(),1);function _classPrivateMethodInitSpec$26(e,t){_checkPrivateRedeclaration$35(e,t),t.add(e)}function _checkPrivateRedeclaration$35(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$37(e,t,i){return(t=_toPropertyKey$38(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$38(e){var t=_toPrimitive$38(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$38(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand$35(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$21="dragToScroll",PLUGIN_PRIORITY$20=100;var _DragToScroll_brand=new WeakSet,DragToScroll=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$26(this,_DragToScroll_brand),_defineProperty$37(this,"boundaries",null),_defineProperty$37(this,"callback",null),_defineProperty$37(this,"listening",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$21}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$20}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$21]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>_assertClassBrand$35(_DragToScroll_brand,this,_setupListening).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>_assertClassBrand$35(_DragToScroll_brand,this,_setupListening).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let i=0,r=0;t<this.boundaries.top?r=t-this.boundaries.top:t>this.boundaries.bottom&&(r=t-this.boundaries.bottom),e<this.boundaries.left?i=e-this.boundaries.left:e>this.boundaries.right&&(i=e-this.boundaries.right),this.callback(i,r)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",i=>this.onMouseMove(i)),t=getParentWindow(t)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}};function _setupListening(e){if(isRightClick(e))return;const t=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(t!==this.hot.rootWindow?t.getBoundingClientRect():void 0),this.setCallback((i,r)=>{var o,a;const c=(o=t.scrollLeft)!==null&&o!==void 0?o:t.scrollX,u=(a=t.scrollTop)!==null&&a!==void 0?a:t.scrollY;t.scroll(c+Math.sign(i)*50,u+Math.sign(r)*20)}),this.listen()}var import_es_error_cause$62=__toESM(require_es_error_cause(),1);function _classPrivateMethodInitSpec$25(e,t){_checkPrivateRedeclaration$34(e,t),t.add(e)}function _classPrivateFieldInitSpec$25(e,t,i){_checkPrivateRedeclaration$34(e,t),t.set(e,i)}function _checkPrivateRedeclaration$34(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$36(e,t,i){return(t=_toPropertyKey$37(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$37(e){var t=_toPrimitive$37(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$37(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet$25(e,t){return e.get(_assertClassBrand$34(e,t))}function _classPrivateFieldSet$24(e,t,i){return e.set(_assertClassBrand$34(e,t),i),i}function _assertClassBrand$34(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}pluginHooks_default.getSingleton().register("afterDropdownMenuDefaultOptions"),pluginHooks_default.getSingleton().register("beforeDropdownMenuShow"),pluginHooks_default.getSingleton().register("afterDropdownMenuShow"),pluginHooks_default.getSingleton().register("afterDropdownMenuHide"),pluginHooks_default.getSingleton().register("afterDropdownMenuExecute");const PLUGIN_KEY$20="dropdownMenu",PLUGIN_PRIORITY$19=230,BUTTON_CLASS_NAME="changeType",SHORTCUTS_GROUP$6=PLUGIN_KEY$20;var _isButtonClicked=new WeakMap,_DropdownMenu_brand=new WeakSet,DropdownMenu=class ss extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$20}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$19}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[KEY$2,KEY$3,KEY$10,KEY$6,KEY$10,KEY$1,KEY$10,KEY$4,KEY$10,KEY]}constructor(t){super(t),_classPrivateMethodInitSpec$25(this,_DropdownMenu_brand),_defineProperty$36(this,"commandExecutor",new CommandExecutor(this.hot)),_defineProperty$36(this,"itemsFactory",null),_defineProperty$36(this,"menu",null),_classPrivateFieldInitSpec$25(this,_isButtonClicked,!1),this.hot.addHook("afterGetColHeader",(i,r)=>_assertClassBrand$34(_DropdownMenu_brand,this,_onAfterGetColHeader$2).call(this,i,r))}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$20]}enablePlugin(){var t=this;if(this.enabled)return;this.itemsFactory=new ItemsFactory(this.hot,ss.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return _assertClassBrand$34(_DropdownMenu_brand,t,_onBeforeOnCellMouseDown$4).call(t,...a)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return _assertClassBrand$34(_DropdownMenu_brand,t,_onBeforeViewportScrollHorizontally$1).call(t,...a)});const i=this.hot.getSettings()[PLUGIN_KEY$20],r={items:this.itemsFactory.getItems(i)};this.registerEvents(),typeof i.callback=="function"&&this.commandExecutor.setCommonCallback(i.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const o=this.itemsFactory.getItems(i);this.menu&&this.menu.destroy(),this.menu=new Menu(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:i.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",o),this.menu.setMenuItems(o),this.menu.addLocalHook("beforeOpen",()=>_assertClassBrand$34(_DropdownMenu_brand,this,_onMenuBeforeOpen).call(this)),this.menu.addLocalHook("afterOpen",()=>_assertClassBrand$34(_DropdownMenu_brand,this,_onMenuAfterOpen).call(this)),this.menu.addLocalHook("afterSubmenuOpen",a=>_assertClassBrand$34(_DropdownMenu_brand,this,_onSubMenuAfterOpen).call(this,a)),this.menu.addLocalHook("afterClose",()=>_assertClassBrand$34(_DropdownMenu_brand,this,_onMenuAfterClose).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return t.executeCommand.call(t,...c)}),arrayEach$1(o,a=>this.commandExecutor.registerCommand(a.key,a))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("grid"),i=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:o}=this.hot.getSelectedRangeLast(),a=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument),c=this.hot.getCell(-1,o.col,!0).querySelector(`.${BUTTON_CLASS_NAME}`),u=c.getBoundingClientRect();this.open({left:u.left+a.left,top:u.top+c.offsetHeight+a.top},{left:u.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};t.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:i,runOnlyIf:()=>{var r;const o=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return o&&this.hot.selection.isCellVisible(o)&&o.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:SHORTCUTS_GROUP$6},{keys:[["Shift","Alt","ArrowDown"]],callback:i,runOnlyIf:()=>{var r;const o=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return o&&this.hot.selection.isCellVisible(o)&&o.isCell()&&!this.menu.isOpened()},group:SHORTCUTS_GROUP$6}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$6)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",t=>_assertClassBrand$34(_DropdownMenu_brand,this,_onTableClick).call(this,t))}open(t){var i;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(i=this.menu)!==null&&i!==void 0&&i.isOpened()||(this.menu.open(),objectEach(r,(o,a)=>{this.menu.setOffset(a,o)}),this.menu.setPosition(t))}close(){var t;(t=this.menu)===null||t===void 0||t.close()}executeCommand(t){for(var i=arguments.length,r=new Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];this.commandExecutor.execute(t,...r)}setListening(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}};function _addCustomShortcuts(e){e.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function _onTableClick(e){if(hasClass$1(e.target,BUTTON_CLASS_NAME)){const t=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument),i=e.target.getBoundingClientRect();e.stopPropagation(),_classPrivateFieldSet$24(_isButtonClicked,this,!1),this.open({left:i.left+t.left,top:i.top+e.target.offsetHeight+t.top},{left:i.width,right:0,above:0,below:3})}}function _onAfterGetColHeader$2(e,t){const i=t.parentNode;if(!i)return;const r=i.parentNode.childNodes,o=Array.prototype.indexOf.call(r,i);if(e<0||o!==r.length-1)return;const a=t.querySelector(`.${BUTTON_CLASS_NAME}`);if(this.enabled&&a)return;if(!this.enabled){a&&a.parentNode.removeChild(a);return}const c=this.hot.rootDocument.createElement("button");c.className=BUTTON_CLASS_NAME,c.type="button",c.tabIndex=-1,this.hot.getSettings().ariaTags&&(setAttribute(c,[A11Y_HIDDEN(),A11Y_LABEL(" ")]),setAttribute(t,[A11Y_HASPOPUP("menu")])),c.onclick=function(){return!1},t.firstChild.insertBefore(c,t.firstChild.firstChild)}function _onMenuBeforeOpen(){this.hot.runHooks("beforeDropdownMenuShow",this)}function _onMenuAfterOpen(){this.hot.runHooks("afterDropdownMenuShow",this),_assertClassBrand$34(_DropdownMenu_brand,this,_addCustomShortcuts).call(this,this.menu)}function _onSubMenuAfterOpen(e){_assertClassBrand$34(_DropdownMenu_brand,this,_addCustomShortcuts).call(this,e)}function _onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function _onBeforeViewportScrollHorizontally$1(e){return _classPrivateFieldGet$25(_isButtonClicked,this)?null:e}function _onBeforeOnCellMouseDown$4(e){hasClass$1(e.target,BUTTON_CLASS_NAME)&&_classPrivateFieldSet$24(_isButtonClicked,this,!0)}DropdownMenu.SEPARATOR={name:KEY$10};var import_es_error_cause$61=__toESM(require_es_error_cause(),1),import_es_array_push$48=__toESM(require_es_array_push(),1);function _defineProperty$35(e,t,i){return(t=_toPropertyKey$36(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$36(e){var t=_toPrimitive$36(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$36(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DataProvider=class{constructor(e){_defineProperty$35(this,"hot",void 0),_defineProperty$35(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:i,endCol:r}=this._getDataRange(),o=this.options,a=[];return rangeEach(e,i,c=>{const u=[];!o.exportHiddenRows&&this._isHiddenRow(c)||(rangeEach(t,r,h=>{!o.exportHiddenColumns&&this._isHiddenColumn(h)||u.push(this.hot.getDataAtCell(c,h))}),a.push(u))}),a}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:i}=this._getDataRange(),r=this.hot.getRowHeader();rangeEach(t,i,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(r[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:i}=this._getDataRange(),r=this.hot.getColHeader();rangeEach(t,i,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(r[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[i=0,r=0,o=t,a=e]=this.options.range;return i=Math.max(i,0),r=Math.max(r,0),o=Math.min(o,t),a=Math.min(a,e),{startRow:i,startCol:r,endRow:o,endCol:a}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}},dataProvider_default=DataProvider,import_es_error_cause$60=__toESM(require_es_error_cause(),1);function _defineProperty$34(e,t,i){return(t=_toPropertyKey$35(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$35(e){var t=_toPrimitive$35(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$35(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BaseType=class os{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(t,i){_defineProperty$34(this,"dataProvider",void 0),_defineProperty$34(this,"options",void 0),this.dataProvider=t,this.options=this._mergeOptions(i),this.dataProvider.setOptions(this.options)}_mergeOptions(t){let i=clone$4(this.constructor.DEFAULT_OPTIONS);const r=new Date;return i=extend$2(clone$4(os.DEFAULT_OPTIONS),i),i=extend$2(i,t),i.filename=substitute(i.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),i}},_base_default$3=BaseType;const CHAR_CARRIAGE_RETURN="\r",CHAR_DOUBLE_QUOTES='"',CHAR_LINE_FEED=`
`;var Csv=class extends _base_default$3{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,t=this.dataProvider.getData();let i=this.dataProvider.getColumnHeaders();const r=i.length>0,o=this.dataProvider.getRowHeaders(),a=o.length>0;let c=e.bom?"\uFEFF":"";return r&&(i=arrayMap$1(i,u=>this._escapeCell(u,!0)),a&&(c+=e.columnDelimiter),c+=i.join(e.columnDelimiter),c+=e.rowDelimiter),arrayEach$1(t,(u,h)=>{h>0&&(c+=e.rowDelimiter),a&&(c+=this._escapeCell(o[h])+e.columnDelimiter),c+=u.map(d=>this._escapeCell(d)).join(e.columnDelimiter)}),c}_escapeCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=stringify$3(e);return i!==""&&(t||i.indexOf(CHAR_CARRIAGE_RETURN)>=0||i.indexOf(CHAR_DOUBLE_QUOTES)>=0||i.indexOf(CHAR_LINE_FEED)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`),i}},csv_default=Csv;const TYPE_CSV="csv",EXPORT_TYPES={[TYPE_CSV]:csv_default};function typeFactory(e,t,i){return typeof EXPORT_TYPES[e]=="function"?new EXPORT_TYPES[e](t,i):null}var import_es_error_cause$59=__toESM(require_es_error_cause(),1);const PLUGIN_KEY$19="exportFile",PLUGIN_PRIORITY$18=240;var ExportFile=class extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$19}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$18}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:i,rootWindow:r}=this.hot,o=this._createTypeFormatter(e,t),a=this._createBlob(o),c=r.URL||r.webkitURL,u=i.createElement("a"),h=`${o.options.filename}.${o.options.fileExtension}`;if(u.download!==void 0){const d=c.createObjectURL(a);u.style.display="none",u.setAttribute("href",d),u.setAttribute("download",h),i.body.appendChild(u),u.dispatchEvent(new MouseEvent("click")),i.body.removeChild(u),setTimeout(()=>{c.revokeObjectURL(d)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(a,h)}_createTypeFormatter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!EXPORT_TYPES[e])throw new Error(`Export format type "${e}" is not supported.`);return typeFactory(e,new dataProvider_default(this.hot),t)}_createBlob(e){let t=null;return typeof Blob<"u"&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}},import_es_error_cause$58=__toESM(require_es_error_cause(),1);function _defineProperty$33(e,t,i){return(t=_toPropertyKey$34(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$34(e){var t=_toPrimitive$34(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$34(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BaseComponent=class{constructor(e,t){let{id:i,stateless:r=!0}=t;_defineProperty$33(this,"hot",void 0),_defineProperty$33(this,"id",void 0),_defineProperty$33(this,"elements",[]),_defineProperty$33(this,"hidden",!1),_defineProperty$33(this,"stateId",""),_defineProperty$33(this,"state",void 0),this.hot=e,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new LinkedPhysicalIndexToValueMap)}getElements(){return this.elements}reset(){arrayEach$1(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),arrayEach$1(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}};mixin(BaseComponent,localHooks_default);var import_es_error_cause$57=__toESM(require_es_error_cause(),1);const conditions={};function getCondition(e,t){if(!conditions[e])throw Error(`Filter condition "${e}" does not exist.`);const{condition:i,descriptor:r}=conditions[e];let o=t;return r.inputValuesDecorator&&(o=r.inputValuesDecorator(o)),function(a){return i.apply(a.meta.instance,[].concat([a],[o]))}}function getConditionDescriptor(e){if(!conditions[e])throw Error(`Filter condition "${e}" does not exist.`);return conditions[e].descriptor}function registerCondition(e,t,i){i.key=e,conditions[e]={condition:t,descriptor:i}}const CONDITION_NAME$20="none";function condition$20(){return!0}registerCondition(CONDITION_NAME$20,condition$20,{name:FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1});const CONDITION_NAME$19="empty";function condition$19(e){return isEmpty(e.value)}registerCondition(CONDITION_NAME$19,condition$19,{name:FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0});const CONDITION_NAME$18="not_empty";function condition$18(e,t){return!getCondition(CONDITION_NAME$19,t)(e)}registerCondition(CONDITION_NAME$18,condition$18,{name:FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0});const CONDITION_NAME$17="eq";function condition$17(e,t){let[i]=t;return stringify$3(e.value).toLocaleLowerCase(e.meta.locale)===stringify$3(i)}registerCondition(CONDITION_NAME$17,condition$17,{name:FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0});const CONDITION_NAME$16="neq";function condition$16(e,t){return!getCondition(CONDITION_NAME$17,t)(e)}registerCondition(CONDITION_NAME$16,condition$16,{name:FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0});const CONDITION_NAME$15="gt";function condition$15(e,t){let[i]=t,r=i;return e.meta.type==="numeric"&&(r=parseFloat(r,10)),e.value>r}registerCondition(CONDITION_NAME$15,condition$15,{name:FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0});const CONDITION_NAME$14="gte";function condition$14(e,t){let[i]=t,r=i;return e.meta.type==="numeric"&&(r=parseFloat(r,10)),e.value>=r}registerCondition(CONDITION_NAME$14,condition$14,{name:FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});const CONDITION_NAME$13="lt";function condition$13(e,t){let[i]=t,r=i;return e.meta.type==="numeric"&&(r=parseFloat(r,10)),e.value<r}registerCondition(CONDITION_NAME$13,condition$13,{name:FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0});const CONDITION_NAME$12="lte";function condition$12(e,t){let[i]=t,r=i;return e.meta.type==="numeric"&&(r=parseFloat(r,10)),e.value<=r}registerCondition(CONDITION_NAME$12,condition$12,{name:FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});var import_moment$5=__toESM(require_moment(),1);const CONDITION_NAME$11="date_after";function condition$11(e,t){let[i]=t;const r=(0,import_moment$5.default)(e.value,e.meta.dateFormat),o=(0,import_moment$5.default)(i,e.meta.dateFormat);return!r.isValid()||!o.isValid()?!1:r.diff(o)>=0}registerCondition(CONDITION_NAME$11,condition$11,{name:FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0});var import_moment$4=__toESM(require_moment(),1);const CONDITION_NAME$10="date_before";function condition$10(e,t){let[i]=t;const r=(0,import_moment$4.default)(e.value,e.meta.dateFormat),o=(0,import_moment$4.default)(i,e.meta.dateFormat);return!r.isValid()||!o.isValid()?!1:r.diff(o)<=0}registerCondition(CONDITION_NAME$10,condition$10,{name:FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0});const CONDITION_NAME$9="between";function condition$9(e,t){let[i,r]=t,o=i,a=r;if(e.meta.type==="numeric"){const c=parseFloat(o,10),u=parseFloat(a,10);o=Math.min(c,u),a=Math.max(c,u)}else if(e.meta.type==="date"){const c=getCondition(CONDITION_NAME$10,[a]),u=getCondition(CONDITION_NAME$11,[o]);return c(e)&&u(e)}return e.value>=o&&e.value<=a}registerCondition(CONDITION_NAME$9,condition$9,{name:FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0});const CONDITION_NAME$8="not_between";function condition$8(e,t){return!getCondition(CONDITION_NAME$9,t)(e)}registerCondition(CONDITION_NAME$8,condition$8,{name:FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0});const CONDITION_NAME$7="begins_with";function condition$7(e,t){let[i]=t;return stringify$3(e.value).toLocaleLowerCase(e.meta.locale).startsWith(stringify$3(i))}registerCondition(CONDITION_NAME$7,condition$7,{name:FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0});const CONDITION_NAME$6="ends_with";function condition$6(e,t){let[i]=t;return stringify$3(e.value).toLocaleLowerCase(e.meta.locale).endsWith(stringify$3(i))}registerCondition(CONDITION_NAME$6,condition$6,{name:FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0});const CONDITION_NAME$5="contains";function condition$5(e,t){let[i]=t;return stringify$3(e.value).toLocaleLowerCase(e.meta.locale).indexOf(stringify$3(i))>=0}registerCondition(CONDITION_NAME$5,condition$5,{name:FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0});const CONDITION_NAME$4="not_contains";function condition$4(e,t){return!getCondition(CONDITION_NAME$5,t)(e)}registerCondition(CONDITION_NAME$4,condition$4,{name:FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0});var import_moment$3=__toESM(require_moment(),1);const CONDITION_NAME$3="date_tomorrow";function condition$3(e){const t=(0,import_moment$3.default)(e.value,e.meta.dateFormat);return t.isValid()?t.isSame((0,import_moment$3.default)().subtract(-1,"days").startOf("day"),"d"):!1}registerCondition(CONDITION_NAME$3,condition$3,{name:FILTERS_CONDITIONS_TOMORROW,inputsCount:0});var import_moment$2=__toESM(require_moment(),1);const CONDITION_NAME$2="date_today";function condition$2(e){const t=(0,import_moment$2.default)(e.value,e.meta.dateFormat);return t.isValid()?t.isSame((0,import_moment$2.default)().startOf("day"),"d"):!1}registerCondition(CONDITION_NAME$2,condition$2,{name:FILTERS_CONDITIONS_TODAY,inputsCount:0});var import_moment$1=__toESM(require_moment(),1);const CONDITION_NAME$1="date_yesterday";function condition$1(e){const t=(0,import_moment$1.default)(e.value,e.meta.dateFormat);return t.isValid()?t.isSame((0,import_moment$1.default)().subtract(1,"days").startOf("day"),"d"):!1}registerCondition(CONDITION_NAME$1,condition$1,{name:FILTERS_CONDITIONS_YESTERDAY,inputsCount:0});var import_es_array_push$47=__toESM(require_es_array_push(),1),import_es_set_difference_v2$9=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$9=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$9=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$9=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$9=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$9=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$9=__toESM(require_es_set_union_v2(),1);const sortCompare=getComparisonFunction();function toVisualValue(e,t){let i=e;return i===""&&(i=`(${t})`),i}const SUPPORT_SET_CONSTRUCTOR=new Set([1]).has(1),SUPPORT_FAST_DEDUPE=SUPPORT_SET_CONSTRUCTOR&&typeof Array.from=="function";function createArrayAssertion(e){let t=e;return SUPPORT_SET_CONSTRUCTOR&&(t=new Set(t)),function(i){let r;return SUPPORT_SET_CONSTRUCTOR?r=t.has(i):r=!!~t.indexOf(i),r}}function toEmptyString(e){return e??""}function unifyColumnValues(e){let t=e;return SUPPORT_FAST_DEDUPE?t=Array.from(new Set(t)):t=arrayUnique(t),t=t.sort((i,r)=>typeof i=="number"&&typeof r=="number"?i-r:i===r?0:i>r?1:-1),t}function intersectValues(e,t,i,r){const o=[],a=e===t;let c;return a||(c=createArrayAssertion(t)),arrayEach$1(e,u=>{let h=!1;(a||c(u))&&(h=!0);const d={checked:h,value:u,visualValue:toVisualValue(u,i)};r&&r(d),o.push(d)}),o}const CONDITION_NAME="by_value";function condition(e,t){let[i]=t;return i(e.value)}registerCondition(CONDITION_NAME,condition,{name:"By value",inputsCount:0,inputValuesDecorator(e){let[t]=e;return[createArrayAssertion(t)]},showOperators:!1});var import_es_error_cause$56=__toESM(require_es_error_cause(),1);const operations$1={};function getOperationFunc(e){if(!operations$1[e])throw Error(`Operation with id "${e}" does not exist.`);const t=operations$1[e].func;return function(i,r){return t(i,r)}}function getOperationName(e){return operations$1[e].name}function registerOperation(e,t,i){operations$1[e]={name:t,func:i}}const OPERATION_ID$2="conjunction",SHORT_NAME_FOR_COMPONENT$2=FILTERS_LABELS_CONJUNCTION;function operationResult$2(e,t){return e.every(i=>i.func(t))}registerOperation(OPERATION_ID$2,SHORT_NAME_FOR_COMPONENT$2,operationResult$2);const OPERATION_ID$1="disjunction",SHORT_NAME_FOR_COMPONENT$1=FILTERS_LABELS_DISJUNCTION;function operationResult$1(e,t){return e.some(i=>i.func(t))}registerOperation(OPERATION_ID$1,SHORT_NAME_FOR_COMPONENT$1,operationResult$1);var import_es_error_cause$55=__toESM(require_es_error_cause(),1);const OPERATION_ID="disjunctionWithExtraCondition",SHORT_NAME_FOR_COMPONENT=FILTERS_LABELS_DISJUNCTION;function operationResult(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(i=>i.func(t))&&e[e.length-1].func(t)}registerOperation(OPERATION_ID,SHORT_NAME_FOR_COMPONENT,operationResult);var import_es_array_push$46=__toESM(require_es_array_push(),1);const TYPE_NUMERIC="numeric",TYPE_TEXT="text",TYPE_DATE="date",TYPES={[TYPE_NUMERIC]:[CONDITION_NAME$20,KEY$10,CONDITION_NAME$19,CONDITION_NAME$18,KEY$10,CONDITION_NAME$17,CONDITION_NAME$16,KEY$10,CONDITION_NAME$15,CONDITION_NAME$14,CONDITION_NAME$13,CONDITION_NAME$12,CONDITION_NAME$9,CONDITION_NAME$8],[TYPE_TEXT]:[CONDITION_NAME$20,KEY$10,CONDITION_NAME$19,CONDITION_NAME$18,KEY$10,CONDITION_NAME$17,CONDITION_NAME$16,KEY$10,CONDITION_NAME$7,CONDITION_NAME$6,KEY$10,CONDITION_NAME$5,CONDITION_NAME$4],[TYPE_DATE]:[CONDITION_NAME$20,KEY$10,CONDITION_NAME$19,CONDITION_NAME$18,KEY$10,CONDITION_NAME$17,CONDITION_NAME$16,KEY$10,CONDITION_NAME$10,CONDITION_NAME$11,CONDITION_NAME$9,KEY$10,CONDITION_NAME$3,CONDITION_NAME$2,CONDITION_NAME$1]};function getOptionsList(e){const t=[];let i=e;return TYPES[i]||(i=TYPE_TEXT),arrayEach$1(TYPES[i],r=>{let o;r===KEY$10?o={name:KEY$10}:o=clone$4(getConditionDescriptor(r)),t.push(o)}),t}var import_es_error_cause$54=__toESM(require_es_error_cause(),1);function _defineProperty$32(e,t,i){return(t=_toPropertyKey$33(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$33(e){var t=_toPrimitive$33(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$33(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}const STATE_BUILT$2="built",STATE_BUILDING="building",EVENTS_TO_REGISTER=["click","input","keydown","keypress","keyup","focus","blur","change"];var BaseUI$3=class as{static get DEFAULTS(){return clone$4({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(t,i){_defineProperty$32(this,"hot",void 0),_defineProperty$32(this,"eventManager",new eventManager_default(this)),_defineProperty$32(this,"options",void 0),_defineProperty$32(this,"_element",void 0),_defineProperty$32(this,"buildState",void 0),this.hot=t,this.options=extend$2(as.DEFAULTS,i),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(t){this.options.value=t,this.update()}getValue(){return this.options.value}get element(){return this.buildState===STATE_BUILDING?this._element:this.buildState===STATE_BUILT$2?(this.update(),this._element):(this.buildState=STATE_BUILDING,this.build(),this.buildState=STATE_BUILT$2,this._element)}isBuilt(){return this.buildState===STATE_BUILT$2}translateIfPossible(t){return typeof t=="string"&&t.startsWith(FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(t):t}build(){const t=(i,r)=>{this.eventManager.addEventListener(i,r,o=>this.runLocalHooks(r,o,this))};if(this.buildState||(this.buildState=STATE_BUILDING),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&addClass$1(this._element,this.options.className),this.options.children.length)arrayEach$1(this.options.children,i=>this._element.appendChild(i.element));else if(this.options.wrapIt){const i=this.hot.rootDocument.createElement(this.options.tagName);i.setAttribute("data-hot-input",!0),objectEach(this.options,(r,o)=>{i[o]!==void 0&&o!=="className"&&o!=="tagName"&&o!=="children"&&(i[o]=this.translateIfPossible(r))}),this._element.appendChild(i),arrayEach$1(EVENTS_TO_REGISTER,r=>t(i,r))}else arrayEach$1(EVENTS_TO_REGISTER,i=>t(this._element,i))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};mixin(BaseUI$3,localHooks_default);var import_es_error_cause$53=__toESM(require_es_error_cause(),1);function _classPrivateMethodInitSpec$24(e,t){_checkPrivateRedeclaration$33(e,t),t.add(e)}function _classPrivateFieldInitSpec$24(e,t,i){_checkPrivateRedeclaration$33(e,t),t.set(e,i)}function _checkPrivateRedeclaration$33(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$24(e,t){return e.get(_assertClassBrand$33(e,t))}function _classPrivateFieldSet$23(e,t,i){return e.set(_assertClassBrand$33(e,t),i),i}function _assertClassBrand$33(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _input$1=new WeakMap,_InputUI_brand=new WeakSet,InputUI=class ls extends BaseUI$3{static get DEFAULTS(){return clone$4({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(t,i){super(t,extend$2(ls.DEFAULTS,i)),_classPrivateMethodInitSpec$24(this,_InputUI_brand),_classPrivateFieldInitSpec$24(this,_input$1,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",t=>_assertClassBrand$33(_InputUI_brand,this,_onKeyup).call(this,t))}build(){super.build();const t=this.hot.rootDocument.createElement("div");_classPrivateFieldSet$23(_input$1,this,this._element.firstChild),addClass$1(this._element,"htUIInput"),addClass$1(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(_classPrivateFieldGet$24(_input$1,this).type=this.options.type,_classPrivateFieldGet$24(_input$1,this).placeholder=this.translateIfPossible(this.options.placeholder),_classPrivateFieldGet$24(_input$1,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&_classPrivateFieldGet$24(_input$1,this).focus()}};function _onKeyup(e){this.options.value=e.target.value}var import_es_error_cause$52=__toESM(require_es_error_cause(),1);function _classPrivateMethodInitSpec$23(e,t){_checkPrivateRedeclaration$32(e,t),t.add(e)}function _classPrivateFieldInitSpec$23(e,t,i){_checkPrivateRedeclaration$32(e,t),t.set(e,i)}function _checkPrivateRedeclaration$32(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$22(e,t,i){return e.set(_assertClassBrand$32(e,t),i),i}function _classPrivateFieldGet$23(e,t){return e.get(_assertClassBrand$32(e,t))}function _assertClassBrand$32(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _menu=new WeakMap,_items$1=new WeakMap,_caption=new WeakMap,_captionElement=new WeakMap,_dropdown=new WeakMap,_SelectUI_brand=new WeakSet,SelectUI=class cs extends BaseUI$3{static get DEFAULTS(){return clone$4({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(t,i){super(t,extend$2(cs.DEFAULTS,i)),_classPrivateMethodInitSpec$23(this,_SelectUI_brand),_classPrivateFieldInitSpec$23(this,_menu,null),_classPrivateFieldInitSpec$23(this,_items$1,[]),_classPrivateFieldInitSpec$23(this,_caption,void 0),_classPrivateFieldInitSpec$23(this,_captionElement,void 0),_classPrivateFieldInitSpec$23(this,_dropdown,void 0),this.registerHooks()}getMenu(){return _classPrivateFieldGet$23(_menu,this)}registerHooks(){this.addLocalHook("click",()=>_assertClassBrand$32(_SelectUI_brand,this,_onClick).call(this))}setItems(t){_classPrivateFieldSet$22(_items$1,this,this.translateNames(t)),_classPrivateFieldGet$23(_menu,this)&&_classPrivateFieldGet$23(_menu,this).setMenuItems(_classPrivateFieldGet$23(_items$1,this))}translateNames(t){return arrayEach$1(t,i=>{i.name=this.translateIfPossible(i.name)}),t}build(){super.build(),_classPrivateFieldSet$22(_menu,this,new Menu(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),_classPrivateFieldGet$23(_menu,this).setMenuItems(_classPrivateFieldGet$23(_items$1,this));const t=new BaseUI$3(this.hot,{className:"htUISelectCaption"}),i=new BaseUI$3(this.hot,{className:"htUISelectDropdown"});_classPrivateFieldSet$22(_caption,this,t),_classPrivateFieldSet$22(_captionElement,this,t.element),_classPrivateFieldSet$22(_dropdown,this,i),this.hot.getSettings().ariaTags&&(setAttribute(i.element,[A11Y_HIDDEN()]),setAttribute(this._element,[A11Y_LISTBOX()])),arrayEach$1([t,i],r=>this._element.appendChild(r.element)),_classPrivateFieldGet$23(_menu,this).addLocalHook("select",r=>_assertClassBrand$32(_SelectUI_brand,this,_onMenuSelect).call(this,r)),_classPrivateFieldGet$23(_menu,this).addLocalHook("afterClose",()=>_assertClassBrand$32(_SelectUI_brand,this,_onMenuClosed).call(this)),this.update()}update(){if(!this.isBuilt())return;let t;this.options.value?t=this.options.value.name:t=_classPrivateFieldGet$23(_menu,this).hot.getTranslatedPhrase(FILTERS_CONDITIONS_NONE),_classPrivateFieldGet$23(_captionElement,this).textContent=t,super.update()}openOptions(){const t=this.element.getBoundingClientRect();_classPrivateFieldGet$23(_menu,this)&&(_classPrivateFieldGet$23(_menu,this).open(),_classPrivateFieldGet$23(_menu,this).setPosition({left:this.hot.isLtr()?t.left-5:t.left-31,top:t.top-1,width:t.width,height:t.height}),_classPrivateFieldGet$23(_menu,this).getNavigator().toFirstItem(),_classPrivateFieldGet$23(_menu,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:i=>{this.closeOptions(),this.runLocalHooks("tabKeydown",i)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){_classPrivateFieldGet$23(_menu,this)&&_classPrivateFieldGet$23(_menu,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){_classPrivateFieldGet$23(_menu,this)&&(_classPrivateFieldGet$23(_menu,this).destroy(),_classPrivateFieldSet$22(_menu,this,null)),_classPrivateFieldGet$23(_caption,this)&&_classPrivateFieldGet$23(_caption,this).destroy(),_classPrivateFieldGet$23(_dropdown,this)&&_classPrivateFieldGet$23(_dropdown,this).destroy(),super.destroy()}};function _onMenuSelect(e){e.name!==KEY$10&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}function _onMenuClosed(){this.runLocalHooks("afterClose")}function _onClick(){this.openOptions()}var import_es_error_cause$51=__toESM(require_es_error_cause(),1),import_es_array_push$45=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$22(e,t){_checkPrivateRedeclaration$31(e,t),t.add(e)}function _checkPrivateRedeclaration$31(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$31(e,t,i){return(t=_toPropertyKey$32(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$32(e){var t=_toPrimitive$32(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$32(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand$31(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _ConditionComponent_brand=new WeakSet,ConditionComponent=class extends BaseComponent{constructor(e,t){super(e,{id:t.id,stateless:!1}),_classPrivateMethodInitSpec$22(this,_ConditionComponent_brand),_defineProperty$31(this,"name",""),_defineProperty$31(this,"addSeparator",!1),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new SelectUI(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new InputUI(this.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_VALUE})),this.elements.push(new InputUI(this.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>_assertClassBrand$31(_ConditionComponent_brand,this,_onConditionSelect).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),arrayEach$1(this.getInputElements(),e=>{e.addLocalHook("keydown",t=>_assertClassBrand$31(_ConditionComponent_brand,this,_onInputKeyDown$2).call(this,t))})}setState(e){if(this.reset(),!e)return;const t=clone$4(e.command);t.name.startsWith(FILTERS_CONDITIONS_NAMESPACE)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),arrayEach$1(e.args,(i,r)=>{if(r>t.inputsCount-1)return!1;const o=this.getInputElement(r);o.setValue(i),o[t.inputsCount>r?"show":"hide"](),r||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||getConditionDescriptor(CONDITION_NAME$20),t=[];return arrayEach$1(this.getInputElements(),(i,r)=>{e.inputsCount>r&&t.push(i.getValue())}),{command:e,args:t}}updateState(e,t){const i=getConditionDescriptor(e?e.name:CONDITION_NAME$20);this.state.setValueAtIndex(t,{command:i,args:e?e.args:[]}),e||arrayEach$1(this.getInputElements(),r=>r.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof SelectUI)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof InputUI)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,i,r,o,a)=>{addClass$1(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&addClass$1(t.parentNode,"border");const c=this.hot.rootDocument.createElement("div");return addClass$1(c,"htFiltersMenuLabel"),c.textContent=a,t.appendChild(c),t.parentElement.hasAttribute("ghost-table")||arrayEach$1(this.elements,u=>t.appendChild(u.element)),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[getConditionDescriptor(CONDITION_NAME$20)];if(e!==null){const{visualIndex:i}=e;t=getOptionsList(this.hot.getDataType(0,i,this.hot.countRows(),i))}arrayEach$1(this.getInputElements(),i=>i.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}};function _onConditionSelect(e){arrayEach$1(this.getInputElements(),(t,i)=>{t[e.inputsCount>i?"show":"hide"](),i===0&&this.hot._registerTimeout(()=>t.focus(),10)}),this.runLocalHooks("change",e)}function _onInputKeyDown$2(e){isKey$1(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),stopImmediatePropagation(e))}var import_es_error_cause$50=__toESM(require_es_error_cause(),1);function _classPrivateFieldInitSpec$22(e,t,i){_checkPrivateRedeclaration$30(e,t),t.set(e,i)}function _checkPrivateRedeclaration$30(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$22(e,t){return e.get(_assertClassBrand$30(e,t))}function _classPrivateFieldSet$21(e,t,i){return e.set(_assertClassBrand$30(e,t),i),i}function _assertClassBrand$30(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _input=new WeakMap,_label=new WeakMap,RadioInputUI=class us extends BaseUI$3{static get DEFAULTS(){return clone$4({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(t,i){super(t,extend$2(us.DEFAULTS,i)),_classPrivateFieldInitSpec$22(this,_input,void 0),_classPrivateFieldInitSpec$22(this,_label,void 0)}build(){super.build();const t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),_classPrivateFieldSet$21(_label,this,t),_classPrivateFieldSet$21(_input,this,this._element.firstChild),_classPrivateFieldGet$22(_input,this).checked=this.options.checked,this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(_classPrivateFieldGet$22(_label,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?_classPrivateFieldGet$22(_input,this).checked:!1}setChecked(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(_classPrivateFieldGet$22(_input,this).checked=t)}focus(){this.isBuilt()&&_classPrivateFieldGet$22(_input,this).focus()}},import_es_error_cause$49=__toESM(require_es_error_cause(),1),import_es_array_push$44=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$21(e,t){_checkPrivateRedeclaration$29(e,t),t.add(e)}function _checkPrivateRedeclaration$29(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$30(e,t,i){return(t=_toPropertyKey$31(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$31(e){var t=_toPrimitive$31(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$31(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand$29(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const SELECTED_AT_START_ELEMENT_INDEX=0;var _OperatorsComponent_brand=new WeakSet,OperatorsComponent=class extends BaseComponent{constructor(e,t){super(e,{id:t.id,stateless:!1}),_classPrivateMethodInitSpec$21(this,_OperatorsComponent_brand),_defineProperty$30(this,"name",""),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(addClass$1(t.parentNode,"htFiltersMenuOperators"),arrayEach$1(this.elements,i=>t.appendChild(i.element)),t)}}buildOperatorsElement(){const e=[OPERATION_ID$2,OPERATION_ID$1];arrayEach$1(e,t=>{const i=new RadioInputUI(this.hot,{name:"operator",label:{htmlFor:t,textContent:getOperationName(t)},value:t,checked:t===e[SELECTED_AT_START_ELEMENT_INDEX],id:t});i.addLocalHook("change",r=>_assertClassBrand$29(_OperatorsComponent_brand,this,_onRadioInputChange).call(this,r)),this.elements.push(i)})}setChecked(e){if(this.elements.length<e)throw Error(toSingleLine`Radio button with index ${e} doesn't exist.`);arrayEach$1(this.elements,(t,i)=>{t.setChecked(i===e)})}getActiveOperationId(){const e=this.elements.find(t=>t instanceof RadioInputUI&&t.isChecked());return e?e.getValue():OPERATION_ID$2}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&arrayEach$1(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:OPERATION_ID$2,t=arguments.length>1?arguments[1]:void 0,i=e;i===OPERATION_ID&&(i=OPERATION_ID$1),this.state.setValueAtIndex(t,i)}reset(){this.setChecked(SELECTED_AT_START_ELEMENT_INDEX)}};function _onRadioInputChange(e){this.setState(e.target.value)}var import_es_error_cause$48=__toESM(require_es_error_cause(),1);function _classPrivateFieldInitSpec$21(e,t,i){_checkPrivateRedeclaration$28(e,t),t.set(e,i)}function _checkPrivateRedeclaration$28(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$21(e,t){return e.get(_assertClassBrand$28(e,t))}function _classPrivateFieldSet$20(e,t,i){return e.set(_assertClassBrand$28(e,t),i),i}function _assertClassBrand$28(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _link=new WeakMap,LinkUI=class hs extends BaseUI$3{static get DEFAULTS(){return clone$4({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(t,i){super(t,extend$2(hs.DEFAULTS,i)),_classPrivateFieldInitSpec$21(this,_link,void 0)}build(){super.build(),_classPrivateFieldSet$20(_link,this,this._element.firstChild)}update(){this.isBuilt()&&(_classPrivateFieldGet$21(_link,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&_classPrivateFieldGet$21(_link,this).focus()}activate(){_classPrivateFieldGet$21(_link,this).click()}},import_es_error_cause$47=__toESM(require_es_error_cause(),1),import_es_array_push$43=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$20(e,t){_checkPrivateRedeclaration$27(e,t),t.add(e)}function _classPrivateFieldInitSpec$20(e,t,i){_checkPrivateRedeclaration$27(e,t),t.set(e,i)}function _checkPrivateRedeclaration$27(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$20(e,t){return e.get(_assertClassBrand$27(e,t))}function _classPrivateFieldSet$19(e,t,i){return e.set(_assertClassBrand$27(e,t),i),i}function _assertClassBrand$27(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const SHORTCUTS_GROUP$5="multipleSelect.itemBox";var _items=new WeakMap,_itemsBox=new WeakMap,_locale=new WeakMap,_searchInput=new WeakMap,_selectAllUI=new WeakMap,_clearAllUI=new WeakMap,_MultipleSelectUI_brand=new WeakSet,MultipleSelectUI=class ds extends BaseUI$3{static get DEFAULTS(){return clone$4({className:"htUIMultipleSelect",value:[]})}constructor(t,i){super(t,extend$2(ds.DEFAULTS,i)),_classPrivateMethodInitSpec$20(this,_MultipleSelectUI_brand),_classPrivateFieldInitSpec$20(this,_items,[]),_classPrivateFieldInitSpec$20(this,_itemsBox,void 0),_classPrivateFieldInitSpec$20(this,_locale,void 0),_classPrivateFieldInitSpec$20(this,_searchInput,void 0),_classPrivateFieldInitSpec$20(this,_selectAllUI,void 0),_classPrivateFieldInitSpec$20(this,_clearAllUI,void 0),_classPrivateFieldSet$19(_searchInput,this,new InputUI(this.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"})),_classPrivateFieldSet$19(_selectAllUI,this,new LinkUI(this.hot,{textContent:FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"})),_classPrivateFieldSet$19(_clearAllUI,this,new LinkUI(this.hot,{textContent:FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return _classPrivateFieldGet$20(_itemsBox,this)}registerHooks(){_classPrivateFieldGet$20(_searchInput,this).addLocalHook("keydown",t=>_assertClassBrand$27(_MultipleSelectUI_brand,this,_onInputKeyDown$1).call(this,t)),_classPrivateFieldGet$20(_searchInput,this).addLocalHook("input",t=>_assertClassBrand$27(_MultipleSelectUI_brand,this,_onInput).call(this,t)),_classPrivateFieldGet$20(_selectAllUI,this).addLocalHook("click",t=>_assertClassBrand$27(_MultipleSelectUI_brand,this,_onSelectAllClick).call(this,t)),_classPrivateFieldGet$20(_clearAllUI,this).addLocalHook("click",t=>_assertClassBrand$27(_MultipleSelectUI_brand,this,_onClearAllClick).call(this,t))}setItems(t){var i;_classPrivateFieldSet$19(_items,this,t),(i=_classPrivateFieldGet$20(_itemsBox,this))===null||i===void 0||i.loadData(_classPrivateFieldGet$20(_items,this))}setLocale(t){_classPrivateFieldSet$19(_locale,this,t)}getLocale(){return _classPrivateFieldGet$20(_locale,this)}getItems(){return[..._classPrivateFieldGet$20(_items,this)]}getValue(){return itemsToValue(_classPrivateFieldGet$20(_items,this))}getSearchInputElement(){return _classPrivateFieldGet$20(_searchInput,this)}getSelectAllElement(){return _classPrivateFieldGet$20(_selectAllUI,this)}getClearAllElement(){return _classPrivateFieldGet$20(_clearAllUI,this)}isSelectedAllValues(){return _classPrivateFieldGet$20(_items,this).length===this.getValue().length}build(){super.build();const{rootDocument:t}=this.hot,i=t.createElement("div"),r=new BaseUI$3(this.hot,{className:"htUISelectionControls",children:[_classPrivateFieldGet$20(_selectAllUI,this),_classPrivateFieldGet$20(_clearAllUI,this)]});this._element.appendChild(_classPrivateFieldGet$20(_searchInput,this).element),this._element.appendChild(r.element),this._element.appendChild(i);const o=a=>{var c;if(!this._element)return;(c=_classPrivateFieldGet$20(_itemsBox,this))===null||c===void 0||c.destroy(),addClass$1(a,"htUIMultipleSelectHot"),_classPrivateFieldSet$19(_itemsBox,this,new this.hot.constructor(a,{data:_classPrivateFieldGet$20(_items,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(d,f,m,g,v,_)=>{d.title=_.instance.getDataAtRowProp(f,_.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{_classPrivateFieldGet$20(_itemsBox,this).listen()},colWidths:()=>_classPrivateFieldGet$20(_itemsBox,this).container.scrollWidth-getScrollbarWidth(t),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),_classPrivateFieldGet$20(_itemsBox,this).init();const h=_classPrivateFieldGet$20(_itemsBox,this).getShortcutManager().getContext("grid");h.removeShortcutsByKeys(["Tab"]),h.removeShortcutsByKeys(["Shift","Tab"]),h.addShortcut({keys:[["Escape"]],callback:d=>{this.runLocalHooks("keydown",d,this)},group:SHORTCUTS_GROUP$5}),h.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:d=>{_classPrivateFieldGet$20(_itemsBox,this).deselectCell(),this.runLocalHooks("keydown",d,this),this.runLocalHooks("listTabKeydown",d,this)},group:SHORTCUTS_GROUP$5})};o(i),this.hot._registerTimeout(()=>o(i),100)}focus(){this.isBuilt()&&_classPrivateFieldGet$20(_itemsBox,this).listen()}reset(){_classPrivateFieldGet$20(_searchInput,this).reset(),_classPrivateFieldGet$20(_selectAllUI,this).reset(),_classPrivateFieldGet$20(_clearAllUI,this).reset()}update(){this.isBuilt()&&(_classPrivateFieldGet$20(_itemsBox,this).loadData(valueToItems(_classPrivateFieldGet$20(_items,this),this.options.value)),super.update())}destroy(){var t;(t=_classPrivateFieldGet$20(_itemsBox,this))===null||t===void 0||t.destroy(),_classPrivateFieldGet$20(_searchInput,this).destroy(),_classPrivateFieldGet$20(_clearAllUI,this).destroy(),_classPrivateFieldGet$20(_selectAllUI,this).destroy(),_classPrivateFieldSet$19(_searchInput,this,null),_classPrivateFieldSet$19(_clearAllUI,this,null),_classPrivateFieldSet$19(_selectAllUI,this,null),_classPrivateFieldSet$19(_itemsBox,this,null),_classPrivateFieldSet$19(_items,this,null),super.destroy()}};function _onInput(e){const t=e.target.value.toLocaleLowerCase(this.getLocale());let i;t===""?i=[..._classPrivateFieldGet$20(_items,this)]:i=_classPrivateFieldGet$20(_items,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(t)>=0),_classPrivateFieldGet$20(_itemsBox,this).loadData(i)}function _onInputKeyDown$1(e){this.runLocalHooks("keydown",e,this),partial(isKey$1,e.keyCode)("ARROW_DOWN")&&(e.preventDefault(),stopImmediatePropagation(e),_classPrivateFieldGet$20(_itemsBox,this).listen(),_classPrivateFieldGet$20(_itemsBox,this).selectCell(0,0))}function _onSelectAllClick(e){const t=[];e.preventDefault(),_classPrivateFieldGet$20(_itemsBox,this).getSourceData().forEach((i,r)=>{i.checked=!0,t.push(dataRowToChangesArray(i,r)[0])}),_classPrivateFieldGet$20(_itemsBox,this).setSourceDataAtCell(t)}function _onClearAllClick(e){const t=[];e.preventDefault(),_classPrivateFieldGet$20(_itemsBox,this).getSourceData().forEach((i,r)=>{i.checked=!1,t.push(dataRowToChangesArray(i,r)[0])}),_classPrivateFieldGet$20(_itemsBox,this).setSourceDataAtCell(t)}function valueToItems(e,t){const i=createArrayAssertion(t);return e.map(r=>(r.checked=i(r.value),r))}function itemsToValue(e){const t=[];return e.forEach(i=>{i.checked&&t.push(i.value)}),t}var import_es_error_cause$46=__toESM(require_es_error_cause(),1),import_es_array_push$42=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$19(e,t){_checkPrivateRedeclaration$26(e,t),t.add(e)}function _checkPrivateRedeclaration$26(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$29(e,t,i){return(t=_toPropertyKey$30(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$30(e){var t=_toPrimitive$30(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$30(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand$26(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _ValueComponent_brand=new WeakSet,ValueComponent=class extends BaseComponent{constructor(e,t){super(e,{id:t.id,stateless:!1}),_classPrivateMethodInitSpec$19(this,_ValueComponent_brand),_defineProperty$29(this,"name",""),this.name=t.name,this.elements.push(new MultipleSelectUI(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>_assertClassBrand$26(_ValueComponent_brand,this,_onInputKeyDown).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,t)=>_assertClassBrand$26(_ValueComponent_brand,this,_onModifyDisplayedValue).call(this,e,t))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===CONDITION_NAME){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?CONDITION_NAME$20:CONDITION_NAME},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(i,r,o,a,c)=>{const[u]=arrayFilter$1(r,f=>f.name===CONDITION_NAME),h={},d=this.hot.getTranslatedPhrase(FILTERS_VALUES_BLANK_CELLS);if(u){const f=a(i,c),m=arrayMap$1(f,T=>T.value),g=new Map(f.map(T=>[T.value,this.hot.getCellMeta(T.meta.visualRow,T.meta.visualCol)])),v=unifyColumnValues(m);o&&(u.args[0]=o);const _=[],b=intersectValues(v,u.args[0],d,T=>{T.checked&&_.push(T.value),_assertClassBrand$26(_ValueComponent_brand,this,_triggerModifyMultipleSelectionValueHook).call(this,T,g)}),S=e.editedConditionStack.column;h.locale=this.hot.getCellMeta(0,S).locale,h.args=[_],h.command=getConditionDescriptor(CONDITION_NAME),h.itemsSnapshot=b}else h.args=[],h.command=getConditionDescriptor(CONDITION_NAME$20);this.state.setValueAtIndex(i,h)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof MultipleSelectUI)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,i,r,o,a)=>{addClass$1(t.parentNode,"htFiltersMenuValue");const c=this.hot.rootDocument.createElement("div");return addClass$1(c,"htFiltersMenuLabel"),c.textContent=a,t.appendChild(c),t.parentElement.hasAttribute("ghost-table")||arrayEach$1(this.elements,u=>t.appendChild(u.element)),t}}}reset(){const e=this.hot.getTranslatedPhrase(FILTERS_VALUES_BLANK_CELLS),t=this._getColumnVisibleValues(),i=t.map(u=>u.value),r=new Map(t.map(u=>[u.value,u.meta])),o=unifyColumnValues(i),a=intersectValues(o,o,e,u=>{_assertClassBrand$26(_ValueComponent_brand,this,_triggerModifyMultipleSelectionValueHook).call(this,u,r)});this.getMultipleSelectElement().setItems(a),super.reset(),this.getMultipleSelectElement().setValue(o);const c=this.hot.getPlugin("filters").getSelectedColumn();c!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,c.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:arrayMap$1(this.hot.getDataAtCol(e.visualIndex),(t,i)=>({value:toEmptyString(t),meta:this.hot.getCellMeta(i,e.visualIndex)}))}};function _onInputKeyDown(e){isKey$1(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),stopImmediatePropagation(e))}function _triggerModifyMultipleSelectionValueHook(e,t){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(e.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",e.visualValue,t.get(e.value)))}function _onModifyDisplayedValue(e,t){switch(t.type){case"numeric":return getRenderedValue(e,t);default:return e}}var import_es_error_cause$45=__toESM(require_es_error_cause(),1),import_es_array_push$41=__toESM(require_es_array_push(),1),_ActionBarComponent;function _classPrivateMethodInitSpec$18(e,t){_checkPrivateRedeclaration$25(e,t),t.add(e)}function _checkPrivateRedeclaration$25(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$28(e,t,i){return(t=_toPropertyKey$29(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$29(e){var t=_toPrimitive$29(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$29(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand$25(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _ActionBarComponent_brand=new WeakSet,ActionBarComponent=class ar extends BaseComponent{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(t,i){super(t,{id:i.id,stateless:!0}),_classPrivateMethodInitSpec$18(this,_ActionBarComponent_brand),_defineProperty$28(this,"name",""),this.name=i.name,this.elements.push(new InputUI(this.hot,{type:"button",value:FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:ar.BUTTON_OK})),this.elements.push(new InputUI(this.hot,{type:"button",value:FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:ar.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){arrayEach$1(this.elements,t=>{t.addLocalHook("click",(i,r)=>_assertClassBrand$25(_ActionBarComponent_brand,this,_onButtonClick).call(this,i,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,i)=>(addClass$1(i.parentNode,"htFiltersMenuActionBar"),arrayEach$1(this.elements,r=>i.appendChild(r.element)),i)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}};_ActionBarComponent=ActionBarComponent;function _onButtonClick(e,t){t.options.identifier===_ActionBarComponent.BUTTON_OK?this.accept():this.cancel()}var import_es_error_cause$44=__toESM(require_es_error_cause(),1),import_es_array_push$40=__toESM(require_es_array_push(),1);function _defineProperty$27(e,t,i){return(t=_toPropertyKey$28(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$28(e){var t=_toPrimitive$28(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$28(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}const MAP_NAME="ConditionCollection.filteringStates";var ConditionCollection=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;_defineProperty$27(this,"hot",void 0),_defineProperty$27(this,"isMapRegistrable",void 0),_defineProperty$27(this,"filteringStates",new LinkedPhysicalIndexToValueMap),_defineProperty$27(this,"previousConditionStack",null),this.hot=e,this.isMapRegistrable=t,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(MAP_NAME,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,t){var i;const r=this.filteringStates.getValueAtIndex(t),o=(i=r?.conditions)!==null&&i!==void 0?i:[],a=r?.operation;return this.isMatchInConditions(o,e,a)}isMatchInConditions(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:OPERATION_ID$2;return e.length?getOperationFunc(i)(e,t):!0}addCondition(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:OPERATION_ID$2,r=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,a=arrayMap$1(t.args,d=>typeof d=="string"?d.toLocaleLowerCase(o):d),c=t.name||t.command.key;this.previousConditionStack===null&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",e);const u=this.getOperation(e);if(u){if(u!==i)throw Error(toSingleLine`The column of index ${e} has been already applied with a \`${u}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(isUndefined$1(operations$1[i]))throw new Error(toSingleLine`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const h=this.getConditions(e);h.length===0?this.filteringStates.setValueAtIndex(e,{operation:i,conditions:[{name:c,args:a,func:getCondition(c,a)}]},r):h.push({name:c,args:a,func:getCondition(c,a)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,i;return(t=(i=this.filteringStates.getValueAtIndex(e))===null||i===void 0?void 0:i.conditions)!==null&&t!==void 0?t:[]}getOperation(e){var t;return(t=this.filteringStates.getValueAtIndex(e))===null||t===void 0?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return arrayReduce(this.filteringStates.getEntries(),(e,t)=>{let[i,{operation:r,conditions:o}]=t;return e.push({column:i,operation:r,conditions:arrayMap$1(o,a=>{let{name:c,args:u}=a;return{name:c,args:u}})}),e},[])}importAllConditions(e){this.clean(),arrayEach$1(e,t=>{arrayEach$1(t.conditions,i=>this.addCondition(t.column,i))})}removeConditions(e){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const i=this.getConditions(e);return t?i.some(r=>r.name===t):i.length>0}setPreviousConditionStack(e){this.previousConditionStack=e}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(MAP_NAME),this.filteringStates=null,this.clearLocalHooks()}};mixin(ConditionCollection,localHooks_default);var conditionCollection_default=ConditionCollection,import_es_error_cause$43=__toESM(require_es_error_cause(),1),import_es_array_push$39=__toESM(require_es_array_push(),1);function _defineProperty$26(e,t,i){return(t=_toPropertyKey$27(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$27(e){var t=_toPrimitive$27(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$27(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DataFilter=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];_defineProperty$26(this,"conditionCollection",void 0),_defineProperty$26(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return arrayEach$1(this.conditionCollection.getFilteredColumns(),(t,i)=>{let r=this.columnDataFactory(t);i&&(r=this._getIntersectData(r,e)),e=this.filterByColumn(t,r)}),e}filterByColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=[];return arrayEach$1(t,r=>{r!==void 0&&this.conditionCollection.isMatch(r,e)&&i.push(r)}),i}_getIntersectData(e,t){const i=[];return arrayEach$1(t,r=>{const o=r.meta.visualRow;e[o]!==void 0&&(i[o]=e[o])}),i}},dataFilter_default=DataFilter,import_es_error_cause$42=__toESM(require_es_error_cause(),1),import_es_array_push$38=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$17(e,t){_checkPrivateRedeclaration$24(e,t),t.add(e)}function _checkPrivateRedeclaration$24(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$25(e,t,i){return(t=_toPropertyKey$26(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$26(e){var t=_toPrimitive$26(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$26(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand$24(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _ConditionUpdateObserver_brand=new WeakSet,ConditionUpdateObserver=class{constructor(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];_classPrivateMethodInitSpec$17(this,_ConditionUpdateObserver_brand),_defineProperty$25(this,"hot",void 0),_defineProperty$25(this,"conditionCollection",void 0),_defineProperty$25(this,"columnDataFactory",void 0),_defineProperty$25(this,"changes",[]),_defineProperty$25(this,"grouping",!1),_defineProperty$25(this,"latestEditedColumnPosition",-1),_defineProperty$25(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=t,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",r=>_assertClassBrand$24(_ConditionUpdateObserver_brand,this,_onConditionBeforeModify).call(this,r)),this.conditionCollection.addLocalHook("afterRemove",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("afterAdd",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("beforeClean",()=>_assertClassBrand$24(_ConditionUpdateObserver_brand,this,_onConditionBeforeClean).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>_assertClassBrand$24(_ConditionUpdateObserver_brand,this,_onConditionAfterClean).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,arrayEach$1(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,t){var i=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const r=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const a=r.slice(0,o),c=r.slice(o);c.length&&c[0].column===e&&c.shift();const u=curry(function(d,f){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const g=new conditionCollection_default(i.hot,!1),v=[].concat(d,m);g.importAllConditions(v);const _=i.columnDataFactory(f);let b;g.isEmpty()?b=_:b=new dataFilter_default(g,T=>i.columnDataFactory(T)).filter(),b=arrayMap$1(b,T=>T.meta.visualRow);const S=createArrayAssertion(b);return g.destroy(),arrayFilter$1(_,T=>S(T.meta.visualRow))})(a),h=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:h},dependentConditionStacks:c,filteredRowsFactory:u,conditionArgsChange:t})}destroy(){this.clearLocalHooks(),objectEach(this,(e,t)=>{this[t]=null})}};function _onConditionBeforeModify(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}function _onConditionBeforeClean(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function _onConditionAfterClean(){arrayEach$1(this.latestOrderStack,e=>{this.updateStatesAtColumn(e)})}mixin(ConditionUpdateObserver,localHooks_default);var conditionUpdateObserver_default=ConditionUpdateObserver;function createFocusNavigator(e){return createPaginator({initialPage:0,size:()=>e.length,onItemSelect:(i,r)=>{const o=e[i];if(o instanceof MultipleSelectUI)return r;if(o.element&&!isVisible$1(o.element))return!1;o.focus()}})}const SHORTCUTS_MENU_CONTEXT="filters";function createMenuFocusController(e,t){let i=-1;const r=createFocusNavigator(t),o=h=>()=>{e.isOpened()&&e.getKeyboardShortcutsCtrl().listen(SHORTCUTS_MENU_CONTEXT),r.setCurrentPage(t.indexOf(h))};t.forEach(h=>{h instanceof BaseUI$3&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),e.addLocalHook("afterSelectionChange",h=>{h.key.startsWith("filter_")||r.clear()});function a(h){const d=e.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();r.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(SHORTCUTS_MENU_CONTEXT),callback:()=>{h.isSubMenu()&&h.close(),d.listen(SHORTCUTS_MENU_CONTEXT)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:m=>{const g=e.getNavigator();g.getCurrentPage()>-1&&(i=g.getCurrentPage()),g.clear(),m.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{e.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:m=>{const g=t[r.getCurrentPage()];g instanceof SelectUI&&(g.openOptions(),m.preventDefault()),g instanceof LinkUI&&(g.activate(),m.preventDefault()),g instanceof BaseUI$3||m.preventDefault()}}],SHORTCUTS_MENU_CONTEXT)}e.addLocalHook("afterSubmenuOpen",a),e.addLocalHook("afterOpen",a);function c(){e.focus(),e.getKeyboardShortcutsCtrl().listen(SHORTCUTS_MENU_CONTEXT)}function u(){return i}return{...r,listen:c,getLastMenuPage:u}}var import_es_error_cause$41=__toESM(require_es_error_cause(),1),import_es_array_push$37=__toESM(require_es_array_push(),1),import_es_array_unscopables_flat=__toESM(require_es_array_unscopables_flat(),1);function _classPrivateMethodInitSpec$16(e,t){_checkPrivateRedeclaration$23(e,t),t.add(e)}function _classPrivateFieldInitSpec$19(e,t,i){_checkPrivateRedeclaration$23(e,t),t.set(e,i)}function _checkPrivateRedeclaration$23(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$24(e,t,i){return(t=_toPropertyKey$25(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$25(e){var t=_toPrimitive$25(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$25(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldSet$18(e,t,i){return e.set(_assertClassBrand$23(e,t),i),i}function _classPrivateFieldGet$19(e,t){return e.get(_assertClassBrand$23(e,t))}function _assertClassBrand$23(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$18="filters",PLUGIN_PRIORITY$17=250,SHORTCUTS_GROUP$4=PLUGIN_KEY$18;var _menuFocusNavigator=new WeakMap,_Filters_brand=new WeakSet,Filters=class extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$18}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$17}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),_classPrivateMethodInitSpec$16(this,_Filters_brand),_defineProperty$24(this,"dropdownMenuPlugin",null),_defineProperty$24(this,"conditionCollection",null),_defineProperty$24(this,"conditionUpdateObserver",null),_defineProperty$24(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),_defineProperty$24(this,"filtersRowsMap",null),_classPrivateFieldInitSpec$19(this,_menuFocusNavigator,void 0),this.hot.addHook("afterGetColHeader",(t,i)=>_assertClassBrand$23(_Filters_brand,this,_onAfterGetColHeader$1).call(this,t,i))}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$18]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new TrimmingMap),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,t=e&&e.uiContainer||this.hot.rootDocument.body,i=a=>(a.addLocalHook("accept",()=>_assertClassBrand$23(_Filters_brand,this,_onActionBarSubmit).call(this,"accept")),a.addLocalHook("cancel",()=>_assertClassBrand$23(_Filters_brand,this,_onActionBarSubmit).call(this,"cancel")),a.addLocalHook("change",c=>_assertClassBrand$23(_Filters_brand,this,_onComponentChange).call(this,a,c)),a),r=()=>`${this.hot.getTranslatedPhrase(FILTERS_DIVS_FILTER_BY_CONDITION)}:`,o=()=>`${this.hot.getTranslatedPhrase(FILTERS_DIVS_FILTER_BY_VALUE)}:`;if(!this.components.get("filter_by_condition")){const a=new ConditionComponent(this.hot,{id:"filter_by_condition",name:r,addSeparator:!1,menuContainer:t});a.addLocalHook("afterClose",()=>_assertClassBrand$23(_Filters_brand,this,_onSelectUIClosed).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new OperatorsComponent(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new ConditionComponent(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:t});a.addLocalHook("afterClose",()=>_assertClassBrand$23(_Filters_brand,this,_onSelectUIClosed).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new ValueComponent(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new ActionBarComponent(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new conditionCollection_default(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new conditionUpdateObserver_default(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>_assertClassBrand$23(_Filters_brand,this,_updateComponents).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",a=>_assertClassBrand$23(_Filters_brand,this,_onAfterDropdownMenuDefaultOptions).call(this,a)),this.addHook("afterDropdownMenuShow",()=>_assertClassBrand$23(_Filters_brand,this,_onAfterDropdownMenuShow).call(this)),this.addHook("afterDropdownMenuHide",()=>_assertClassBrand$23(_Filters_brand,this,_onAfterDropdownMenuHide).call(this)),this.addHook("afterChange",a=>_assertClassBrand$23(_Filters_brand,this,_onAfterChange$1).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!_classPrivateFieldGet$19(_menuFocusNavigator,this)&&this.dropdownMenuPlugin.enabled){const a=this.dropdownMenuPlugin.menu,c=[{focus:()=>{const h=a.getNavigator(),d=_classPrivateFieldGet$19(_menuFocusNavigator,this).getLastMenuPage();a.focus(),d>0?h.setCurrentPage(d):h.toFirstItem()}},...Array.from(this.components).map(h=>{let[,d]=h;return d.getElements()}).flat()];_classPrivateFieldSet$18(_menuFocusNavigator,this,createMenuFocusController(a,c));const u=h=>{_classPrivateFieldGet$19(_menuFocusNavigator,this).listen(),h.preventDefault(),isKey$1(h.keyCode,"TAB")&&(h.shiftKey?_classPrivateFieldGet$19(_menuFocusNavigator,this).toPreviousItem():_classPrivateFieldGet$19(_menuFocusNavigator,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",u),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",u)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,i)=>{t.destroy(),this.components.set(i,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:SHORTCUTS_GROUP$4})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$4)}addCondition(e,t,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:OPERATION_ID$2;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:t},args:i},r)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),t=this._createDataFilter(),i=!this.conditionCollection.isEmpty();let r=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o,this.conditionCollection.previousConditionStack)!==!1)if(i){const c=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),r=arrayMap$1(t.filter(),h=>h.meta.visualRow);const u=createArrayAssertion(r);rangeEach(this.hot.countSourceRows()-1,h=>{u(h)||c.push(h)}),arrayEach$1(c,h=>{this.filtersRowsMap.setValueAtIndex(h,!0)})},!0),!e&&!r.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),i=[];return arrayEach$1(this.hot.getSourceDataAtCol(t),(r,o)=>{var a;const{row:c,col:u,visualCol:h,visualRow:d,type:f,instance:m,dateFormat:g,locale:v}=this.hot.getCellMeta(o,t),_=(a=this.hot.getDataAtCell(this.hot.toVisualRow(o),t))!==null&&a!==void 0?a:r;i.push({meta:{row:c,col:u,visualCol:h,visualRow:d,type:f,instance:m,dateFormat:g,locale:v},value:toEmptyString(_)})}),i}updateValueComponentCondition(e){const t=this.hot.getDataAtCol(e),i=unifyColumnValues(t);this.conditionUpdateObserver.updateStatesAtColumn(e,i)}restoreComponents(e){var t;const i=(t=this.getSelectedColumn())===null||t===void 0?void 0:t.physicalIndex;e.forEach(r=>{r.isHidden()||r.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,t,i,r){let o=e;return o===OPERATION_ID$1&&t.command.key!==CONDITION_NAME$20&&i.command.key!==CONDITION_NAME$20&&r.command.key!==CONDITION_NAME$20?o=OPERATION_ID:r.command.key!==CONDITION_NAME$20&&(t.command.key===CONDITION_NAME$20||i.command.key===CONDITION_NAME$20)&&(o=OPERATION_ID$2),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),i=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...i):this.hideComponents(...i)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new dataFilter_default(e,t=>this.getDataMapAtColumn(t))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return arrayEach$1(r,a=>{arrayEach$1(t.menuItems,(c,u)=>{c.key===a.getMenuItemDescriptor().key&&e.push(u)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const i=this.dropdownMenuPlugin.menu.hotMenu,r=i.getPlugin("hiddenRows");for(var o=arguments.length,a=new Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];const u=this.getIndexesOfComponents(...a);e?r.showRows(u):r.hideRows(u),i.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{e!==null&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}};function _onAfterChange$1(e){e&&arrayEach$1(e,t=>{const[,i]=t,r=this.hot.propToCol(i);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function _onAfterDropdownMenuShow(){const e=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),e.updateMenuDimensions()}function _onAfterDropdownMenuHide(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function _onAfterDropdownMenuDefaultOptions(e){e.items.push({name:KEY$10}),this.components.forEach(t=>{e.items.push(t.getMenuItemDescriptor())})}function _onActionBarSubmit(e){var t;if(e==="accept"){const r=this.getSelectedColumn();if(r===null){var i;(i=this.dropdownMenuPlugin)===null||i===void 0||i.close();return}const{physicalIndex:o}=r,a=this.components.get("filter_by_condition").getState(),c=this.components.get("filter_by_condition2").getState(),u=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),a,c,u);this.conditionUpdateObserver.groupChanges();let d=this.conditionCollection.getColumnStackPosition(o);d===-1&&(d=void 0),this.conditionCollection.removeConditions(o),a.command.key!==CONDITION_NAME$20&&(this.conditionCollection.addCondition(o,a,h,d),c.command.key!==CONDITION_NAME$20&&this.conditionCollection.addCondition(o,c,h,d)),u.command.key!==CONDITION_NAME$20&&this.conditionCollection.addCondition(o,u,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(f=>f.saveState(o)),this.filtersRowsMap.clear(),this.filter()}(t=this.dropdownMenuPlugin)===null||t===void 0||t.close()}function _onComponentChange(e,t){this.updateDependentComponentsVisibility(),e.constructor===ConditionComponent&&!t.inputsCount&&this.setListeningDropdownMenu()}function _onSelectUIClosed(){this.setListeningDropdownMenu()}function _onAfterGetColHeader$1(e,t){const i=this.hot.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(i)?addClass$1(t,"htFiltersActive"):removeClass$1(t,"htFiltersActive")}function _updateComponents(e){var t;if(!((t=this.dropdownMenuPlugin)!==null&&t!==void 0&&t.enabled))return;const{editedConditionStack:{conditions:i,column:r}}=e,o=i.filter(c=>c.name===CONDITION_NAME),a=i.filter(c=>c.name!==CONDITION_NAME);if(o.length>=2||a.length>=3)warn(toSingleLine`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const c=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(a[0],r),this.components.get("filter_by_condition2").updateState(a[1],r),this.components.get("filter_operators").updateState(c,r),this.components.get("filter_by_value").updateState(e)}}const DEFAULT_LICENSE_KEY="internal-use-in-handsontable",DEFAULT_SETTINGS={licenseKey:DEFAULT_LICENSE_KEY,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function getEngineSettingsOverrides(e){var t;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[PLUGIN_KEY$17])===null||t===void 0||(t=t.language)===null||t===void 0?void 0:t.langCode}}function cleanEngineSettings(e){return Object.keys(e).reduce((t,i)=>(i!=="hyperformula"&&(t[i]=e[i]),t),{})}function getEngineSettingsWithDefaultsAndOverrides(e){var t;const i=e[PLUGIN_KEY$17],r=cleanEngineSettings(i!=null&&(t=i.engine)!==null&&t!==void 0&&t.hyperformula?i.engine:{}),o=getEngineSettingsOverrides(e);return{...DEFAULT_SETTINGS,...r,...o}}function getEngineSettingsWithOverrides(e){var t;const i=e[PLUGIN_KEY$17],r=cleanEngineSettings(i!=null&&(t=i.engine)!==null&&t!==void 0&&t.hyperformula?i.engine:{}),o=getEngineSettingsOverrides(e);return{...r,...o}}function haveEngineSettingsChanged(e,t){return Object.keys(t).some(i=>t[i]!==void 0&&t[i]!==e[i])}var import_es_array_push$36=__toESM(require_es_array_push(),1);function getEngineRelationshipRegistry(){const e="engine_relationship",t=staticRegister(PLUGIN_KEY$17);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function getSharedEngineUsageRegistry(){const e="shared_engine_usage",t=staticRegister(PLUGIN_KEY$17);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function setupEngine(e){const t=e.getSettings(),i=t[PLUGIN_KEY$17],r=i?.engine;if(i===!0||isUndefined$1(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var o;return registerEngine((o=r.hyperformula)!==null&&o!==void 0?o:r,t,e)}else if(typeof r=="object"&&isUndefined$1(r.hyperformula)){const a=getEngineRelationshipRegistry(),c=getSharedEngineUsageRegistry().get(r);return a.has(r)||a.set(r,[]),a.get(r).push(e),c&&c.push(e.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:DEFAULT_LICENSE_KEY}),(r.getConfig().leapYear1900!==DEFAULT_SETTINGS.leapYear1900||isObjectEqual(r.getConfig().nullDate,DEFAULT_SETTINGS.nullDate)===!1)&&warn(toSingleLine`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function registerEngine(e,t,i){const r=t[PLUGIN_KEY$17],o=getEngineSettingsWithDefaultsAndOverrides(t),a=getEngineRelationshipRegistry(),c=getSharedEngineUsageRegistry();registerCustomFunctions(e,r.functions),registerLanguage(e,r.language);const u=e.buildEmpty(o);return a.set(u,[i]),c.set(u,[i.guid]),registerNamedExpressions(u,r.namedExpressions),u.on("sheetAdded",()=>{u.rebuildAndRecalculate()}),u.on("sheetRemoved",()=>{u.rebuildAndRecalculate()}),u}function getRegisteredHotInstances(e){var t;const i=getEngineRelationshipRegistry(),r=i.size===0?[]:Array.from((t=i.get(e))!==null&&t!==void 0?t:[]);return new Map(r.map(o=>[o.getPlugin("formulas").sheetId,o]))}function unregisterEngine(e,t){if(e){const i=getEngineRelationshipRegistry(),r=i.get(e),o=getSharedEngineUsageRegistry(),a=o.get(e);r&&r.includes(t)&&(r.splice(r.indexOf(t),1),r.length===0&&i.delete(e)),a&&a.includes(t.guid)&&(a.splice(a.indexOf(t.guid),1),a.length===0&&(o.delete(e),e.destroy()))}}function registerCustomFunctions(e,t){t&&t.forEach(i=>{const{name:r,plugin:o,translations:a}=i;try{e.registerFunction(r,o,a)}catch(c){warn(c.message)}})}function registerLanguage(e,t){if(t){const{langCode:i}=t;try{e.registerLanguage(i,t)}catch(r){warn(r.message)}}}function registerNamedExpressions(e,t){t&&(e.suspendEvaluation(),t.forEach(i=>{const{name:r,expression:o,scope:a,options:c}=i;try{e.addNamedExpression(r,o,a,c)}catch(u){warn(u.message)}}),e.resumeEvaluation())}function setupSheet(e,t){return(isUndefined$1(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}var import_moment=__toESM(require_moment(),1);const DEFAULT_DATE_FORMAT_HYPERFORMULA="DD/MM/YYYY";function isEscapedFormulaExpression(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function unescapeFormulaExpression(e){return isEscapedFormulaExpression(e)?e.substr(1):e}function isFormula(e){return typeof e=="string"&&e.startsWith("=")}function isDate$1(e,t){return typeof e=="string"&&t==="date"}function isDateValid(e,t){return(0,import_moment.default)(e,t,!0).isValid()}function getDateInHfFormat(e,t){return(0,import_moment.default)(e,t,!0).format(DEFAULT_DATE_FORMAT_HYPERFORMULA)}function getDateInHotFormat(e,t){return(0,import_moment.default)(e,DEFAULT_DATE_FORMAT_HYPERFORMULA,!0).format(t)}function getDateFromExcelDate(e,t){const r=new Date(Date.UTC(0,0,e+-1));return(0,import_moment.default)(r).format(t)}var import_es_array_push$35=__toESM(require_es_array_push(),1);function getMoveLine(e,t,i){const r=Array.from(Array(i).keys()).filter(a=>e.includes(a)===!1);if(t===0){var o;return(o=r[t])!==null&&o!==void 0?o:0}return r[t-1]+1}function getInitiallyCalculatedMoves(e,t){const i=[];return e.forEach(r=>{const o={from:r,to:t};i.forEach(a=>{const c=a.from>a.to,u=a.to<=o.from;a.from>o.from&&u&&c&&(o.from+=1)}),o.from>=t&&(t+=1),i.push(o)}),i}function adjustedCalculatedMoves(e){return e.forEach((t,i)=>{e.slice(i+1).forEach(o=>{const a=o.from<o.to;o.from>t.from&&a&&(o.from-=1)})}),e}function getMoves(e,t,i){const r=getInitiallyCalculatedMoves(e,getMoveLine(e,t,i));return adjustedCalculatedMoves(r)}var import_es_error_cause$40=__toESM(require_es_error_cause(),1),import_es_array_push$34=__toESM(require_es_array_push(),1);function _classPrivateFieldInitSpec$18(e,t,i){_checkPrivateRedeclaration$22(e,t),t.set(e,i)}function _checkPrivateRedeclaration$22(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$18(e,t){return e.get(_assertClassBrand$22(e,t))}function _classPrivateFieldSet$17(e,t,i){return e.set(_assertClassBrand$22(e,t),i),i}function _assertClassBrand$22(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _axis=new WeakMap,_indexMapper=new WeakMap,_indexSyncer=new WeakMap,_indexesSequence=new WeakMap,_movedIndexes=new WeakMap,_finalIndex=new WeakMap,_removedIndexes=new WeakMap,AxisSyncer=class{constructor(e,t,i){_classPrivateFieldInitSpec$18(this,_axis,void 0),_classPrivateFieldInitSpec$18(this,_indexMapper,void 0),_classPrivateFieldInitSpec$18(this,_indexSyncer,void 0),_classPrivateFieldInitSpec$18(this,_indexesSequence,[]),_classPrivateFieldInitSpec$18(this,_movedIndexes,[]),_classPrivateFieldInitSpec$18(this,_finalIndex,void 0),_classPrivateFieldInitSpec$18(this,_removedIndexes,[]),_classPrivateFieldSet$17(_axis,this,e),_classPrivateFieldSet$17(_indexMapper,this,t),_classPrivateFieldSet$17(_indexSyncer,this,i)}setRemovedHfIndexes(e){return _classPrivateFieldSet$17(_removedIndexes,this,e.map(t=>{const i=_classPrivateFieldGet$18(_indexMapper,this).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(i)})),_classPrivateFieldGet$18(_removedIndexes,this)}getRemovedHfIndexes(){return _classPrivateFieldGet$18(_removedIndexes,this)}getHfIndexFromVisualIndex(e){const t=_classPrivateFieldGet$18(_indexMapper,this).getIndexesSequence(),i=_classPrivateFieldGet$18(_indexMapper,this).getNotTrimmedIndexes();return t.indexOf(i[e])}syncMoves(e){const i=`move${toUpperCaseFirst(_classPrivateFieldGet$18(_axis,this))}s`;_classPrivateFieldGet$18(_indexSyncer,this).getEngine().batch(()=>{e.forEach(r=>{const o=r.from!==r.to,a=r.from+1!==r.to;o&&a&&_classPrivateFieldGet$18(_indexSyncer,this).getEngine()[i](_classPrivateFieldGet$18(_indexSyncer,this).getSheetId(),r.from,1,r.to)})})}storeMovesInformation(e,t,i){i!==!1&&(_classPrivateFieldSet$17(_movedIndexes,this,e.map(r=>this.getHfIndexFromVisualIndex(r))),_classPrivateFieldSet$17(_finalIndex,this,this.getHfIndexFromVisualIndex(t)))}calculateAndSyncMoves(e,t){if(_classPrivateFieldGet$18(_indexSyncer,this).isPerformingUndoRedo()||e===!1||t===!1)return;const i=getMoves(_classPrivateFieldGet$18(_movedIndexes,this),_classPrivateFieldGet$18(_finalIndex,this),_classPrivateFieldGet$18(_indexMapper,this).getNumberOfIndexes());_classPrivateFieldGet$18(_indexSyncer,this).getSheetId()===null?_classPrivateFieldGet$18(_indexSyncer,this).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){const e=`set${toUpperCaseFirst(_classPrivateFieldGet$18(_axis,this))}Order`;return t=>{if(_classPrivateFieldGet$18(_indexSyncer,this).isPerformingUndoRedo())return;const i=_classPrivateFieldGet$18(_indexMapper,this).getIndexesSequence();if(t==="update"&&i.length>0){const r=_classPrivateFieldGet$18(_indexesSequence,this).map(u=>i.indexOf(u)),o=_classPrivateFieldGet$18(_indexSyncer,this).getEngine().getSheetDimensions(_classPrivateFieldGet$18(_indexSyncer,this).getSheetId());let a;_classPrivateFieldGet$18(_axis,this)==="row"?a=o.height:a=o.width;const c=r.length;for(let u=c;u<a;u+=1)r.push(u);_classPrivateFieldGet$18(_indexSyncer,this).getEngine()[e](_classPrivateFieldGet$18(_indexSyncer,this).getSheetId(),r)}_classPrivateFieldSet$17(_indexesSequence,this,i)}}init(){_classPrivateFieldSet$17(_indexesSequence,this,_classPrivateFieldGet$18(_indexMapper,this).getIndexesSequence())}},axisSyncer_default=AxisSyncer,import_es_error_cause$39=__toESM(require_es_error_cause(),1);function _classPrivateFieldInitSpec$17(e,t,i){_checkPrivateRedeclaration$21(e,t),t.set(e,i)}function _checkPrivateRedeclaration$21(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$17(e,t){return e.get(_assertClassBrand$21(e,t))}function _classPrivateFieldSet$16(e,t,i){return e.set(_assertClassBrand$21(e,t),i),i}function _assertClassBrand$21(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _rowIndexSyncer=new WeakMap,_columnIndexSyncer=new WeakMap,_postponeAction=new WeakMap,_isPerformingUndo=new WeakMap,_isPerformingRedo=new WeakMap,_engine=new WeakMap,_sheetId=new WeakMap,IndexSyncer=class{constructor(e,t,i){_classPrivateFieldInitSpec$17(this,_rowIndexSyncer,void 0),_classPrivateFieldInitSpec$17(this,_columnIndexSyncer,void 0),_classPrivateFieldInitSpec$17(this,_postponeAction,void 0),_classPrivateFieldInitSpec$17(this,_isPerformingUndo,!1),_classPrivateFieldInitSpec$17(this,_isPerformingRedo,!1),_classPrivateFieldInitSpec$17(this,_engine,null),_classPrivateFieldInitSpec$17(this,_sheetId,null),_classPrivateFieldSet$16(_rowIndexSyncer,this,new axisSyncer_default("row",e,this)),_classPrivateFieldSet$16(_columnIndexSyncer,this,new axisSyncer_default("column",t,this)),_classPrivateFieldSet$16(_postponeAction,this,i)}getForAxis(e){return e==="row"?_classPrivateFieldGet$17(_rowIndexSyncer,this):_classPrivateFieldGet$17(_columnIndexSyncer,this)}setPerformUndo(e){_classPrivateFieldSet$16(_isPerformingUndo,this,e)}setPerformRedo(e){_classPrivateFieldSet$16(_isPerformingRedo,this,e)}isPerformingUndoRedo(){return _classPrivateFieldGet$17(_isPerformingUndo,this)||_classPrivateFieldGet$17(_isPerformingRedo,this)}getSheetId(){return _classPrivateFieldGet$17(_sheetId,this)}getEngine(){return _classPrivateFieldGet$17(_engine,this)}getPostponeAction(){return _classPrivateFieldGet$17(_postponeAction,this)}setupSyncEndpoint(e,t){_classPrivateFieldSet$16(_engine,this,e),_classPrivateFieldSet$16(_sheetId,this,t),_classPrivateFieldGet$17(_rowIndexSyncer,this).init(),_classPrivateFieldGet$17(_columnIndexSyncer,this).init()}},indexSyncer_default=IndexSyncer,import_es_error_cause$38=__toESM(require_es_error_cause(),1),import_es_array_push$33=__toESM(require_es_array_push(),1),import_es_json_stringify$1=__toESM(require_es_json_stringify(),1),import_es_set_difference_v2$8=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$8=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$8=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$8=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$8=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$8=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$8=__toESM(require_es_set_union_v2(),1);function _classPrivateMethodInitSpec$15(e,t){_checkPrivateRedeclaration$20(e,t),t.add(e)}function _defineProperty$23(e,t,i){return(t=_toPropertyKey$24(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$24(e){var t=_toPrimitive$24(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$24(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldInitSpec$16(e,t,i){_checkPrivateRedeclaration$20(e,t),t.set(e,i)}function _checkPrivateRedeclaration$20(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$15(e,t,i){return e.set(_assertClassBrand$20(e,t),i),i}function _classPrivateFieldGet$16(e,t){return e.get(_assertClassBrand$20(e,t))}function _assertClassBrand$20(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$17="formulas",SETTING_KEYS=["maxRows","maxColumns","language"],PLUGIN_PRIORITY$16=260;pluginHooks_default.getSingleton().register("afterNamedExpressionAdded"),pluginHooks_default.getSingleton().register("afterNamedExpressionRemoved"),pluginHooks_default.getSingleton().register("afterSheetAdded"),pluginHooks_default.getSingleton().register("afterSheetRemoved"),pluginHooks_default.getSingleton().register("afterSheetRenamed"),pluginHooks_default.getSingleton().register("afterFormulasValuesUpdate");const isBlockedSource=e=>e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto";var _internalOperationPending=new WeakMap,_hotWasInitializedWithEmptyData=new WeakMap,_engineListeners=new WeakMap,_Formulas_brand=new WeakSet,Formulas=class extends BasePlugin{constructor(){var e;super(...arguments),e=this,_classPrivateMethodInitSpec$15(this,_Formulas_brand),_classPrivateFieldInitSpec$16(this,_internalOperationPending,!1),_classPrivateFieldInitSpec$16(this,_hotWasInitializedWithEmptyData,!1),_classPrivateFieldInitSpec$16(this,_engineListeners,[["valuesUpdated",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$20(_Formulas_brand,e,_onEngineValuesUpdated).call(e,...i)}],["namedExpressionAdded",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$20(_Formulas_brand,e,_onEngineNamedExpressionsAdded).call(e,...i)}],["namedExpressionRemoved",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$20(_Formulas_brand,e,_onEngineNamedExpressionsRemoved).call(e,...i)}],["sheetAdded",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$20(_Formulas_brand,e,_onEngineSheetAdded).call(e,...i)}],["sheetRenamed",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$20(_Formulas_brand,e,_onEngineSheetRenamed).call(e,...i)}],["sheetRemoved",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$20(_Formulas_brand,e,_onEngineSheetRemoved).call(e,...i)}]]),_defineProperty$23(this,"staticRegister",staticRegister("formulas")),_defineProperty$23(this,"engine",null),_defineProperty$23(this,"sheetName",null),_defineProperty$23(this,"indexSyncer",null),_defineProperty$23(this,"rowAxisSyncer",null),_defineProperty$23(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$17}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$16}static get SETTING_KEYS(){return[PLUGIN_KEY$17,...SETTING_KEYS]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$17]}enablePlugin(){var e,t=this;if(!this.enabled){if(this.engine=(e=setupEngine(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){warn("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const i=this.addSheet(this.sheetName,this.hot.getSourceDataArray());i!==!1&&(this.sheetName=i)}this.addHook("beforeLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$20(_Formulas_brand,t,_onBeforeLoadData$1).call(t,...r)}),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$20(_Formulas_brand,t,_onAfterLoadData$3).call(t,...r)}),this.addHook("beforeUpdateData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$20(_Formulas_brand,t,_onBeforeLoadData$1).call(t,...r)}),this.addHook("afterUpdateData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$20(_Formulas_brand,t,_onAfterLoadData$3).call(t,...r)}),this.addHook("modifyData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$20(_Formulas_brand,t,_onModifyData).call(t,...r)}),this.addHook("modifySourceData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$20(_Formulas_brand,t,_onModifySourceData).call(t,...r)}),this.addHook("beforeValidate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$20(_Formulas_brand,t,_onBeforeValidate).call(t,...r)}),this.addHook("afterSetSourceDataAtCell",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$20(_Formulas_brand,t,_onAfterSetSourceDataAtCell).call(t,...r)}),this.addHook("afterSetDataAtCell",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$20(_Formulas_brand,t,_onAfterSetDataAtCell).call(t,...r)}),this.addHook("afterSetDataAtRowProp",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$20(_Formulas_brand,t,_onAfterSetDataAtCell).call(t,...r)}),this.addHook("beforeCreateRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$20(_Formulas_brand,t,_onBeforeCreateRow).call(t,...r)}),this.addHook("beforeCreateCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$20(_Formulas_brand,t,_onBeforeCreateCol).call(t,...r)}),this.addHook("afterCreateRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$20(_Formulas_brand,t,_onAfterCreateRow$2).call(t,...r)}),this.addHook("afterCreateCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$20(_Formulas_brand,t,_onAfterCreateCol$1).call(t,...r)}),this.addHook("beforeRemoveRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$20(_Formulas_brand,t,_onBeforeRemoveRow$1).call(t,...r)}),this.addHook("beforeRemoveCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$20(_Formulas_brand,t,_onBeforeRemoveCol).call(t,...r)}),this.addHook("afterRemoveRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$20(_Formulas_brand,t,_onAfterRemoveRow$2).call(t,...r)}),this.addHook("afterRemoveCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$20(_Formulas_brand,t,_onAfterRemoveCol$1).call(t,...r)}),this.indexSyncer=new indexSyncer_default(this.hot.rowIndexMapper,this.hot.columnIndexMapper,i=>{this.hot.addHookOnce("init",()=>{i()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(i,r,o,a)=>{this.rowAxisSyncer.storeMovesInformation(i,r,a)}),this.hot.addHook("beforeColumnMove",(i,r,o,a)=>{this.columnAxisSyncer.storeMovesInformation(i,r,a)}),this.hot.addHook("afterRowMove",(i,r,o,a,c)=>{this.rowAxisSyncer.calculateAndSyncMoves(a,c)}),this.hot.addHook("afterColumnMove",(i,r,o,a,c)=>{this.columnAxisSyncer.calculateAndSyncMoves(a,c)}),this.hot.addHook("beforeColumnFreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart,r)}),this.hot.addHook("afterColumnFreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.hot.addHook("beforeColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart-1,r)}),this.hot.addHook("afterColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.addHook("afterCellMetaReset",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$20(_Formulas_brand,t,_onAfterCellMetaReset).call(t,...r)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$20(_Formulas_brand,t,_onAfterDetachChild$1).call(t,...r)}),this.addHook("beforeAutofill",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$20(_Formulas_brand,t,_onBeforeAutofill).call(t,...r)}),_classPrivateFieldGet$16(_engineListeners,this).forEach(i=>{let[r,o]=i;return this.engine.on(r,o)}),super.enablePlugin()}}disablePlugin(){_classPrivateFieldGet$16(_engineListeners,this).forEach(e=>{let[t,i]=e;return this.engine.off(t,i)}),unregisterEngine(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=getEngineSettingsWithOverrides(this.hot.getSettings());haveEngineSettingsChanged(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const i=this.hot.getSettings()[PLUGIN_KEY$17];if(isDefined(i)&&isDefined(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!e.data&&this.sheetName===null){const r=this.hot.getSettings()[PLUGIN_KEY$17].sheetName;r&&this.engine.doesSheetExist(r)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(r??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){_classPrivateFieldGet$16(_engineListeners,this).forEach(e=>{var t;let[i,r]=e;return(t=this.engine)===null||t===void 0?void 0:t.off(i,r)}),_classPrivateFieldSet$15(_engineListeners,this,null),unregisterEngine(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(isDefined(t)&&!isArrayOfArrays(t))return warn("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return warn("Sheet with the provided name already exists."),!1;try{const i=this.engine.addSheet(e??void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(i),t),i}catch(i){return warn(i.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){error(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${toUpperCaseFirst(PLUGIN_KEY$17)}.switchSheet`)}getCellType(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const r=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(t);return r!==null&&o!==null?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=new Set;e.forEach(r=>{var o;const a=r==null||(o=r.address)===null||o===void 0?void 0:o.sheet;a!==void 0&&(i.has(a)||i.add(a))}),getRegisteredHotInstances(this.engine).forEach((r,o)=>{if((t||o!==this.sheetId)&&i.has(o)){var a;r.render(),(a=r.view)===null||a===void 0||a.adjustElementsSize()}})}validateDependentCells(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=o=>{var a;const{row:c,col:u,sheet:h}=(a=o?.address)!==null&&a!==void 0?a:{};return isDefined(h)?`${h}:${c}x${u}`:""},r=new Set(t.map(o=>i(o)));e.forEach(o=>{var a,c;const{row:u,col:h}=(a=o.address)!==null&&a!==void 0?a:{};if(isDefined(u)===!1||isDefined(h)===!1||u>=this.hot.countRows()||h>=this.hot.countCols())return;const d=o==null||(c=o.address)===null||c===void 0?void 0:c.sheet,f=i(o);if(d!==void 0&&!r.has(f)){const m=getRegisteredHotInstances(this.engine).get(d);if(!m)return;m.validateCell(m.getDataAtCell(u,h),m.getCellMeta(u,h),()=>{})}})}syncChangeWithEngine(e,t,i){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(r)){warn(`Not possible to set cell data at ${JSON.stringify(r)}`);return}const o=this.hot.getCellMeta(e,t);return isDate$1(i,o.type)&&(isDateValid(i,o.dateFormat)?i=getDateInHfFormat(i,o.dateFormat):isFormula(i)===!1&&(i=`'${i}`)),this.engine.setCellContents(r,i)}};function _onBeforeValidate(e,t,i){const r=this.hot.propToCol(i);if(this.isFormulaCellType(t,r)){const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},a=this.hot.getCellMeta(t,r);let c=this.engine.getCellValue(o);return a.type==="date"&&isNumeric(c)&&(c=getDateFromExcelDate(c,a.dateFormat)),typeof c=="object"&&c!==null?c.value:c}return e}function _onBeforeAutofill(e,t,i){const{row:r,col:o}=t.getTopStartCorner(),{row:a,col:c}=t.getBottomEndCorner(),{row:u,col:h}=i.getTopStartCorner(),{row:d,col:f}=i.getBottomEndCorner(),m={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}},g={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(d),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(f),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(g)===!1)return!1;const v=this.engine.getFillRangeData(m,g),{row:_,col:b}=m.start,{row:S,col:T}=m.end,A=S-_+1,I=T-b+1;for(let R=0;R<v.length;R+=1)for(let O=0;O<v[R].length;O+=1){const P=v[R][O],L=_+R%A,V=b+O%I,U=this.hot.getCellMeta(L,V);isDate$1(P,U.type)&&(P.startsWith("'")?v[R][O]=P.slice(1):this.isFormulaCellType(L,V,this.sheetId)===!1&&(v[R][O]=getDateInHotFormat(P,U.dateFormat)))}return v}function _onBeforeLoadData$1(e,t){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(toUpperCaseFirst(PLUGIN_KEY$17))||_classPrivateFieldSet$15(_hotWasInitializedWithEmptyData,this,isUndefined$1(this.hot.getSettings().data))}function _onAfterCellMetaReset(){const e=this.hot.getSourceDataArray();let t=!1;e.forEach((i,r)=>{i.forEach((o,a)=>{const c=this.hot.getCellMeta(r,a),u=c.dateFormat;isDate$1(o,c.type)&&(t=!0,isDateValid(o,u)?e[r][a]=getDateInHfFormat(o,u):this.isFormulaCellType(r,a)===!1&&(e[r][a]=`'${o}`))})}),t===!0&&(_classPrivateFieldSet$15(_internalOperationPending,this,!0),this.engine.setSheetContent(this.sheetId,e),_classPrivateFieldSet$15(_internalOperationPending,this,!1))}function _onAfterLoadData$3(e,t){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(toUpperCaseFirst(PLUGIN_KEY$17)))if(this.sheetName=setupSheet(this.engine,this.hot.getSettings()[PLUGIN_KEY$17].sheetName),_classPrivateFieldGet$16(_hotWasInitializedWithEmptyData,this))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){_classPrivateFieldSet$15(_internalOperationPending,this,!0);const o=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),_classPrivateFieldSet$15(_internalOperationPending,this,!1)}}}function _onModifyData(e,t,i,r){if(r!=="get"||_classPrivateFieldGet$16(_internalOperationPending,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const o=this.hot.toVisualRow(e);if(o===null||t===null)return;if(!this.isFormulaCellType(o,t)&&this.getCellType(o,t)!=="ARRAY"){isEscapedFormulaExpression(i.value)&&(i.value=unescapeFormulaExpression(i.value));return}const c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};let u=this.engine.getCellValue(c),h=this.hot.getCellsMeta().find(f=>f.visualRow===o&&f.visualCol===t);h===void 0&&(h={}),h.type==="date"&&isNumeric(u)&&(u=getDateFromExcelDate(u,h.dateFormat));const d=typeof u=="object"&&u!==null?u.value:u;i.value=d}function _onModifySourceData(e,t,i,r){if(r!=="get"||_classPrivateFieldGet$16(_internalOperationPending,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const o=this.hot.toVisualRow(e),a=this.hot.propToCol(t);if(o===null||a===null||!this.isFormulaCellType(o,a)&&this.getCellType(o,a)!=="ARRAY")return;const u=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(u.width===0&&u.height===0)return;const h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId};i.value=this.engine.getCellSerialized(h)}function _onAfterSetDataAtCell(e,t){if(isBlockedSource(t))return;const i=[],r=[],o=this.engine.batch(()=>{e.forEach(a=>{let[c,u,,h]=a;const d=this.hot.propToCol(u),f=this.hot.toPhysicalRow(c),m=this.hot.toPhysicalColumn(d),g={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(d),sheet:this.sheetId};f!==null&&m!==null?this.syncChangeWithEngine(c,d,h):i.push([c,d,h]),r.push({address:g})})});i.length&&this.hot.addHookOnce("afterChange",()=>{const a=this.engine.batch(()=>{i.forEach(c=>{let[u,h,d]=c;this.syncChangeWithEngine(u,h,d)})});this.renderDependentSheets(a,!0)}),this.renderDependentSheets(o),this.validateDependentCells(o,r)}function _onAfterSetSourceDataAtCell(e,t){if(isBlockedSource(t))return;const i=[],r=[];e.forEach(o=>{let[a,c,,u]=o;const h=this.hot.propToCol(c);if(!isNumeric(h))return;const d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(d)){warn(`Not possible to set source cell data at ${JSON.stringify(d)}`);return}r.push({address:d}),i.push(...this.engine.setCellContents(d,u))}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function _onBeforeCreateRow(e,t){let i=this.rowAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countRows()&&(i=e),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[i,t]))return!1}function _onBeforeCreateCol(e,t){let i=this.columnAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countCols()&&(i=e),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[i,t]))return!1}function _onBeforeRemoveRow$1(e,t,i){return this.rowAxisSyncer.setRemovedHfIndexes(i).every(a=>this.engine.isItPossibleToRemoveRows(this.sheetId,[a,1]))===!1?!1:void 0}function _onBeforeRemoveCol(e,t,i){return this.columnAxisSyncer.setRemovedHfIndexes(i).every(a=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[a,1]))===!1?!1:void 0}function _onAfterCreateRow$2(e,t,i){if(isBlockedSource(i))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(r)}function _onAfterCreateCol$1(e,t,i){if(isBlockedSource(i))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(r)}function _onAfterRemoveRow$2(e,t,i,r){if(isBlockedSource(r))return;const o=this.rowAxisSyncer.getRemovedHfIndexes().sort((c,u)=>u-c),a=this.engine.batch(()=>{o.forEach(c=>{this.engine.removeRows(this.sheetId,[c,1])})});this.renderDependentSheets(a)}function _onAfterRemoveCol$1(e,t,i,r){if(isBlockedSource(r))return;const o=this.columnAxisSyncer.getRemovedHfIndexes().sort((c,u)=>u-c),a=this.engine.batch(()=>{o.forEach(c=>{this.engine.removeColumns(this.sheetId,[c,1])})});this.renderDependentSheets(a)}function _onAfterDetachChild$1(e,t,i){var r;_classPrivateFieldSet$15(_internalOperationPending,this,!0);const o=this.hot.getSourceDataArray(i,0,i+(((r=t.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());_classPrivateFieldSet$15(_internalOperationPending,this,!1),o.forEach((a,c)=>{a.forEach((u,h)=>{this.engine.setCellContents({col:h,row:i+c,sheet:this.sheetId},[[u]])})})}function _onEngineValuesUpdated(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}function _onEngineNamedExpressionsAdded(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}function _onEngineNamedExpressionsRemoved(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}function _onEngineSheetAdded(e){this.hot.runHooks("afterSheetAdded",e)}function _onEngineSheetRenamed(e,t){this.sheetName=t,this.hot.runHooks("afterSheetRenamed",e,t)}function _onEngineSheetRemoved(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}var import_es_array_push$32=__toESM(require_es_array_push(),1);function hideColumnItem(e){return{key:"hidden_columns_hide",name(){const t=this.getSelectedLast();let i=0;if(Array.isArray(t)){const[,r,,o]=t;r-o!==0&&(i=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_HIDE_COLUMN,i)},callback(){const{from:t,to:i}=this.getSelectedRangeLast(),r=Math.max(Math.min(t.col,i.col),0),o=Math.max(t.col,i.col),a=[];for(let h=r;h<=o;h+=1)a.push(h);e.hideColumns(a);const c=a[a.length-1],u=this.columnIndexMapper.getNearestNotHiddenIndex(c,1,!0);Number.isInteger(u)&&u>=0?this.selectColumns(u):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}var import_es_array_push$31=__toESM(require_es_array_push(),1);function showColumnItem(e){const t=[];return{key:"hidden_columns_show",name(){const i=t.length>1?1:0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_SHOW_COLUMN,i)},callback(){var i,r;if(t.length===0)return;let o=t[0],a=t[t.length-1];o=(i=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&i!==void 0?i:0,a=(r=this.columnIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&r!==void 0?r:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(),a-o+1===this.countCols()||this.selectColumns(o,a)},disabled:!1,hidden(){const i=arrayMap$1(e.getHiddenColumns(),m=>this.toPhysicalColumn(m));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;t.length=0;const r=this.getSelectedRangeLast(),o=r.getTopStartCorner().col,a=r.getBottomEndCorner().col,c=this.columnIndexMapper,u=c.getRenderableFromVisualIndex(o),h=c.getRenderableFromVisualIndex(a),d=c.getNotTrimmedIndexes(),f=[];if(o!==a){const m=a-o+1,g=h-u+1;if(m>g){const v=d.slice(o,a+1);f.push(...v.filter(_=>i.includes(_)))}}else if(u===0&&u<o)f.push(...d.slice(0,o));else if(u===null)f.push(...d.slice(0,this.countCols()));else{const m=this.countCols()-1,g=c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(m,-1));h===g&&m>a&&f.push(...d.slice(a+1))}return arrayEach$1(f,m=>{t.push(this.toVisualColumn(m))}),t.length===0}}}var import_es_error_cause$37=__toESM(require_es_error_cause(),1),import_es_array_push$30=__toESM(require_es_array_push(),1),import_es_set_difference_v2$7=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$7=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$7=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$7=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$7=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$7=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$7=__toESM(require_es_set_union_v2(),1);function _classPrivateMethodInitSpec$14(e,t){_checkPrivateRedeclaration$19(e,t),t.add(e)}function _classPrivateFieldInitSpec$15(e,t,i){_checkPrivateRedeclaration$19(e,t),t.set(e,i)}function _checkPrivateRedeclaration$19(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$15(e,t){return e.get(_assertClassBrand$19(e,t))}function _classPrivateFieldSet$14(e,t,i){return e.set(_assertClassBrand$19(e,t),i),i}function _assertClassBrand$19(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}pluginHooks_default.getSingleton().register("beforeHideColumns"),pluginHooks_default.getSingleton().register("afterHideColumns"),pluginHooks_default.getSingleton().register("beforeUnhideColumns"),pluginHooks_default.getSingleton().register("afterUnhideColumns");const PLUGIN_KEY$16="hiddenColumns",PLUGIN_PRIORITY$15=310;var _settings$1=new WeakMap,_hiddenColumnsMap=new WeakMap,_HiddenColumns_brand=new WeakSet,HiddenColumns=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$14(this,_HiddenColumns_brand),_classPrivateFieldInitSpec$15(this,_settings$1,{}),_classPrivateFieldInitSpec$15(this,_hiddenColumnsMap,null)}static get PLUGIN_KEY(){return PLUGIN_KEY$16}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$15}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$16]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[PLUGIN_KEY$16];isObject$4(t)&&(_classPrivateFieldSet$14(_settings$1,this,t),isUndefined$1(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),_classPrivateFieldSet$14(_hiddenColumnsMap,this,new HidingMap),_classPrivateFieldGet$15(_hiddenColumnsMap,this).addLocalHook("init",()=>_assertClassBrand$19(_HiddenColumns_brand,this,_onMapInit$4).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$15(_hiddenColumnsMap,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$19(_HiddenColumns_brand,e,_onAfterContextMenuDefaultOptions$2).call(e,...r)}),this.addHook("afterGetCellMeta",(i,r,o)=>_assertClassBrand$19(_HiddenColumns_brand,this,_onAfterGetCellMeta$2).call(this,i,r,o)),this.addHook("modifyColWidth",(i,r)=>_assertClassBrand$19(_HiddenColumns_brand,this,_onModifyColWidth$2).call(this,i,r),2),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$19(_HiddenColumns_brand,e,_onAfterGetColHeader).call(e,...r)}),this.addHook("modifyCopyableRange",i=>_assertClassBrand$19(_HiddenColumns_brand,this,_onModifyCopyableRange$1).call(this,i)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),_classPrivateFieldSet$14(_settings$1,this,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),i=this.isValidConfig(e);let r=t;const o=_classPrivateFieldGet$15(_hiddenColumnsMap,this).getValues().slice(),a=e.length>0;if(i&&a){const u=e.map(h=>this.hot.toPhysicalColumn(h));arrayEach$1(u,h=>{o[h]=!1}),r=arrayReduce(o,(h,d,f)=>(d&&h.push(this.hot.toVisualColumn(f)),h),[])}this.hot.runHooks("beforeUnhideColumns",t,r,i&&a)!==!1&&(i&&a&&_classPrivateFieldGet$15(_hiddenColumnsMap,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,r,i&&a,i&&r.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),i=this.isValidConfig(e);let r=t;i&&(r=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideColumns",t,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{arrayEach$1(e,a=>{_classPrivateFieldGet$15(_hiddenColumnsMap,this).setValueAtIndex(this.hot.toPhysicalColumn(a),!0)})},!0),this.hot.runHooks("afterHideColumns",t,r,i,i&&r.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.hideColumns(t)}getHiddenColumns(){return arrayMap$1(_classPrivateFieldGet$15(_hiddenColumnsMap,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return _classPrivateFieldGet$15(_hiddenColumnsMap,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<t):!1}resetCellsMeta(){arrayEach$1(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){_classPrivateFieldSet$14(_settings$1,this,null),_classPrivateFieldSet$14(_hiddenColumnsMap,this,null),super.destroy()}};function _onModifyColWidth$2(e,t){if(this.isHidden(t))return 0;if(_classPrivateFieldGet$15(_settings$1,this).indicators&&(this.isHidden(t+1)||this.isHidden(t-1))&&typeof e=="number"&&this.hot.hasColHeaders())return e+15}function _onAfterGetCellMeta$2(e,t,i){if(_classPrivateFieldGet$15(_settings$1,this).copyPasteEnabled===!1&&this.isHidden(t)&&(i.skipColumnOnPaste=!0),this.isHidden(t-1))i.className=i.className||"",i.className.indexOf("afterHiddenColumn")===-1&&(i.className+=" afterHiddenColumn");else if(i.className){const r=i.className.split(" ");if(r.length>0){const o=r.indexOf("afterHiddenColumn");o>-1&&r.splice(o,1),i.className=r.join(" ")}}}function _onModifyCopyableRange$1(e){if(_classPrivateFieldGet$15(_settings$1,this).copyPasteEnabled)return e;const t=[],i=(r,o,a,c)=>{t.push({startRow:r,endRow:o,startCol:a,endCol:c})};return arrayEach$1(e,r=>{let o=!0,a=0;rangeEach(r.startCol,r.endCol,c=>{this.isHidden(c)?(o||i(r.startRow,r.endRow,a,c-1),o=!0):(o&&(a=c),c===r.endCol&&i(r.startRow,r.endRow,a,c),o=!1)})}),t}function _onAfterGetColHeader(e,t){if(!_classPrivateFieldGet$15(_settings$1,this).indicators||e<0)return;const i=[];e>=1&&this.isHidden(e-1)&&i.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&i.push("beforeHiddenColumn"),addClass$1(t,i)}function _onAfterContextMenuDefaultOptions$2(e){e.items.push({name:KEY$10},hideColumnItem(this),showColumnItem(this))}function _onMapInit$4(){Array.isArray(_classPrivateFieldGet$15(_settings$1,this).columns)&&this.hideColumns(_classPrivateFieldGet$15(_settings$1,this).columns)}var import_es_array_push$29=__toESM(require_es_array_push(),1);function hideRowItem(e){return{key:"hidden_rows_hide",name(){const t=this.getSelectedLast();let i=0;if(Array.isArray(t)){const[r,,o]=t;r-o!==0&&(i=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_HIDE_ROW,i)},callback(){const{from:t,to:i}=this.getSelectedRangeLast(),r=Math.max(Math.min(t.row,i.row),0),o=Math.max(t.row,i.row),a=[];for(let h=r;h<=o;h+=1)a.push(h);e.hideRows(a);const c=a[a.length-1],u=this.rowIndexMapper.getNearestNotHiddenIndex(c,1,!0);Number.isInteger(u)&&u>=0?this.selectRows(u):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}var import_es_array_push$28=__toESM(require_es_array_push(),1);function showRowItem(e){const t=[];return{key:"hidden_rows_show",name(){const i=t.length>1?1:0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_SHOW_ROW,i)},callback(){var i,r;if(t.length===0)return;let o=t[0],a=t[t.length-1];o=(i=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&i!==void 0?i:0,a=(r=this.rowIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&r!==void 0?r:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(),a-o+1===this.countRows()||this.selectRows(o,a)},disabled:!1,hidden(){const i=arrayMap$1(e.getHiddenRows(),m=>this.toPhysicalRow(m));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;t.length=0;const r=this.getSelectedRangeLast(),o=r.getTopStartCorner().row,a=r.getBottomEndCorner().row,c=this.rowIndexMapper,u=c.getRenderableFromVisualIndex(o),h=c.getRenderableFromVisualIndex(a),d=c.getNotTrimmedIndexes(),f=[];if(o!==a){const m=a-o+1,g=h-u+1;if(m>g){const v=d.slice(o,a+1);f.push(...v.filter(_=>i.includes(_)))}}else if(u===0&&u<o)f.push(...d.slice(0,o));else if(u===null)f.push(...d.slice(0,this.countRows()));else{const m=this.countRows()-1,g=c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(m,-1));h===g&&m>a&&f.push(...d.slice(a+1))}return arrayEach$1(f,m=>{t.push(this.toVisualRow(m))}),t.length===0}}}var import_es_error_cause$36=__toESM(require_es_error_cause(),1),import_es_array_push$27=__toESM(require_es_array_push(),1),import_es_set_difference_v2$6=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$6=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$6=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$6=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$6=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$6=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$6=__toESM(require_es_set_union_v2(),1);function _classPrivateMethodInitSpec$13(e,t){_checkPrivateRedeclaration$18(e,t),t.add(e)}function _classPrivateFieldInitSpec$14(e,t,i){_checkPrivateRedeclaration$18(e,t),t.set(e,i)}function _checkPrivateRedeclaration$18(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$14(e,t){return e.get(_assertClassBrand$18(e,t))}function _classPrivateFieldSet$13(e,t,i){return e.set(_assertClassBrand$18(e,t),i),i}function _assertClassBrand$18(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}pluginHooks_default.getSingleton().register("beforeHideRows"),pluginHooks_default.getSingleton().register("afterHideRows"),pluginHooks_default.getSingleton().register("beforeUnhideRows"),pluginHooks_default.getSingleton().register("afterUnhideRows");const PLUGIN_KEY$15="hiddenRows",PLUGIN_PRIORITY$14=320;var _settings=new WeakMap,_hiddenRowsMap=new WeakMap,_HiddenRows_brand=new WeakSet,HiddenRows=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$13(this,_HiddenRows_brand),_classPrivateFieldInitSpec$14(this,_settings,{}),_classPrivateFieldInitSpec$14(this,_hiddenRowsMap,null)}static get PLUGIN_KEY(){return PLUGIN_KEY$15}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$14}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$15]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[PLUGIN_KEY$15];isObject$4(t)&&(_classPrivateFieldSet$13(_settings,this,t),isUndefined$1(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),_classPrivateFieldSet$13(_hiddenRowsMap,this,new HidingMap),_classPrivateFieldGet$14(_hiddenRowsMap,this).addLocalHook("init",()=>_assertClassBrand$18(_HiddenRows_brand,this,_onMapInit$3).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$14(_hiddenRowsMap,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$18(_HiddenRows_brand,e,_onAfterContextMenuDefaultOptions$1).call(e,...r)}),this.addHook("afterGetCellMeta",(i,r,o)=>_assertClassBrand$18(_HiddenRows_brand,this,_onAfterGetCellMeta$1).call(this,i,r,o)),this.addHook("modifyRowHeight",(i,r)=>_assertClassBrand$18(_HiddenRows_brand,this,_onModifyRowHeight$1).call(this,i,r)),this.addHook("afterGetRowHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$18(_HiddenRows_brand,e,_onAfterGetRowHeader$1).call(e,...r)}),this.addHook("modifyCopyableRange",i=>_assertClassBrand$18(_HiddenRows_brand,this,_onModifyCopyableRange).call(this,i)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),_classPrivateFieldSet$13(_settings,this,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),i=this.isValidConfig(e);let r=t;const o=_classPrivateFieldGet$14(_hiddenRowsMap,this).getValues().slice(),a=e.length>0;if(i&&a){const u=e.map(h=>this.hot.toPhysicalRow(h));arrayEach$1(u,h=>{o[h]=!1}),r=arrayReduce(o,(h,d,f)=>(d&&h.push(this.hot.toVisualRow(f)),h),[])}this.hot.runHooks("beforeUnhideRows",t,r,i&&a)!==!1&&(i&&a&&_classPrivateFieldGet$14(_hiddenRowsMap,this).setValues(o),this.hot.runHooks("afterUnhideRows",t,r,i&&a,i&&r.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),i=this.isValidConfig(e);let r=t;i&&(r=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideRows",t,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{arrayEach$1(e,a=>{_classPrivateFieldGet$14(_hiddenRowsMap,this).setValueAtIndex(this.hot.toPhysicalRow(a),!0)})},!0),this.hot.runHooks("afterHideRows",t,r,i,i&&r.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.hideRows(t)}getHiddenRows(){return arrayMap$1(_classPrivateFieldGet$14(_hiddenRowsMap,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return _classPrivateFieldGet$14(_hiddenRowsMap,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<t):!1}resetCellsMeta(){arrayEach$1(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){_classPrivateFieldSet$13(_settings,this,null),_classPrivateFieldSet$13(_hiddenRowsMap,this,null),super.destroy()}};function _onModifyRowHeight$1(e,t){return this.isHidden(t)?0:e}function _onAfterGetCellMeta$1(e,t,i){if(_classPrivateFieldGet$14(_settings,this).copyPasteEnabled===!1&&this.isHidden(e)&&(i.skipRowOnPaste=!0),this.isHidden(e-1))i.className=i.className||"",i.className.indexOf("afterHiddenRow")===-1&&(i.className+=" afterHiddenRow");else if(i.className){const r=i.className.split(" ");if(r.length>0){const o=r.indexOf("afterHiddenRow");o>-1&&r.splice(o,1),i.className=r.join(" ")}}}function _onModifyCopyableRange(e){if(_classPrivateFieldGet$14(_settings,this).copyPasteEnabled)return e;const t=[],i=(r,o,a,c)=>{t.push({startRow:r,endRow:o,startCol:a,endCol:c})};return arrayEach$1(e,r=>{let o=!0,a=0;rangeEach(r.startRow,r.endRow,c=>{this.isHidden(c)?(o||i(a,c-1,r.startCol,r.endCol),o=!0):(o&&(a=c),c===r.endRow&&i(a,c,r.startCol,r.endCol),o=!1)})}),t}function _onAfterGetRowHeader$1(e,t){if(!_classPrivateFieldGet$14(_settings,this).indicators||e<0)return;const i=[];e>=1&&this.isHidden(e-1)&&i.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&i.push("beforeHiddenRow"),addClass$1(t,i)}function _onAfterContextMenuDefaultOptions$1(e){e.items.push({name:KEY$10},hideRowItem(this),showRowItem(this))}function _onMapInit$3(){Array.isArray(_classPrivateFieldGet$14(_settings,this).rows)&&this.hideRows(_classPrivateFieldGet$14(_settings,this).rows)}function freezeColumnItem(e){return{key:"freeze_column",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback(t,i){const[{start:{col:r}}]=i;e.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const t=this.getSelectedRange();let i=!1;return(t===void 0||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(i=!0),i}}}function unfreezeColumnItem(e){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback(t,i){const[{start:{col:r}}]=i;e.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const t=this.getSelectedRange();let i=!1;return(t===void 0||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsStart)&&(i=!0),i}}}var import_es_error_cause$35=__toESM(require_es_error_cause(),1),import_es_array_push$26=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$12(e,t){_checkPrivateRedeclaration$17(e,t),t.add(e)}function _classPrivateFieldInitSpec$13(e,t,i){_checkPrivateRedeclaration$17(e,t),t.set(e,i)}function _checkPrivateRedeclaration$17(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$13(e,t){return e.get(_assertClassBrand$17(e,t))}function _classPrivateFieldSet$12(e,t,i){return e.set(_assertClassBrand$17(e,t),i),i}function _assertClassBrand$17(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}pluginHooks_default.getSingleton().register("beforeColumnFreeze"),pluginHooks_default.getSingleton().register("afterColumnFreeze"),pluginHooks_default.getSingleton().register("beforeColumnUnfreeze"),pluginHooks_default.getSingleton().register("afterColumnUnfreeze");const PLUGIN_KEY$14="manualColumnFreeze",PLUGIN_PRIORITY$13=110;var _afterFirstUse=new WeakMap,_ManualColumnFreeze_brand=new WeakSet,ManualColumnFreeze=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$12(this,_ManualColumnFreeze_brand),_classPrivateFieldInitSpec$13(this,_afterFirstUse,!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$14}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$13}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$14]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>_assertClassBrand$17(_ManualColumnFreeze_brand,this,_addContextMenuEntry).call(this,e)),this.addHook("beforeColumnMove",(e,t)=>_assertClassBrand$17(_ManualColumnFreeze_brand,this,_onBeforeColumnMove).call(this,e,t)),super.enablePlugin())}disablePlugin(){_classPrivateFieldSet$12(_afterFirstUse,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=this.hot.getSettings(),i=t.fixedColumnsStart<this.hot.countCols()&&e>t.fixedColumnsStart-1;_classPrivateFieldGet$13(_afterFirstUse,this)||_classPrivateFieldSet$12(_afterFirstUse,this,!0),this.hot.runHooks("beforeColumnFreeze",e,i)!==!1&&(i&&(this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart),t._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,i))}unfreezeColumn(e){const t=this.hot.getSettings(),i=t.fixedColumnsStart>0&&e<=t.fixedColumnsStart-1;_classPrivateFieldGet$13(_afterFirstUse,this)||_classPrivateFieldSet$12(_afterFirstUse,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,i)!==!1&&(i&&(t._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,i))}};function _addContextMenuEntry(e){e.items.push({name:"---------"},freezeColumnItem(this),unfreezeColumnItem(this))}function _onBeforeColumnMove(e,t){if(_classPrivateFieldGet$13(_afterFirstUse,this)){const i=this.hot.getSettings().fixedColumnsStart;if(t<i||e.some(r=>r<i))return!1}}var import_es_error_cause$34=__toESM(require_es_error_cause(),1);function _defineProperty$22(e,t,i){return(t=_toPropertyKey$23(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$23(e){var t=_toPrimitive$23(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$23(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}const STATE_INITIALIZED$1=0,STATE_BUILT$1=1,STATE_APPENDED$1=2,UNIT$1="px";var BaseUI$2=class{constructor(e){_defineProperty$22(this,"hot",void 0),_defineProperty$22(this,"_element",null),_defineProperty$22(this,"state",STATE_INITIALIZED$1),_defineProperty$22(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=STATE_APPENDED$1}build(){this.state===STATE_INITIALIZED$1&&(this._element=this.hot.rootDocument.createElement("div"),this.state=STATE_BUILT$1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=STATE_INITIALIZED$1}isAppended(){return this.state===STATE_APPENDED$1}isBuilt(){return this.state>=STATE_BUILT$1}setPosition(e,t){isNumeric(e)&&(this._element.style.top=e+UNIT$1),isNumeric(t)&&(this._element.style[this.inlineProperty]=t+UNIT$1)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){isNumeric(e)&&(this._element.style.width=e+UNIT$1),isNumeric(t)&&(this._element.style.height=t+UNIT$1)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){isNumeric(e)&&(this._element.style.marginTop=e+UNIT$1),isNumeric(t)&&(this._element.style[`margin${toUpperCaseFirst(this.inlineProperty)}`]=t+UNIT$1)}getOffset(){const e=this._element.style,t=`margin${toUpperCaseFirst(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}},_base_default$2=BaseUI$2;const CSS_CLASSNAME$3="ht__manualColumnMove--backlight";var BacklightUI$1=class extends _base_default$2{build(){super.build(),addClass$1(this._element,CSS_CLASSNAME$3)}},backlight_default$1=BacklightUI$1;const CSS_CLASSNAME$2="ht__manualColumnMove--guideline";var GuidelineUI$1=class extends _base_default$2{build(){super.build(),addClass$1(this._element,CSS_CLASSNAME$2)}},guideline_default$1=GuidelineUI$1,import_es_error_cause$33=__toESM(require_es_error_cause(),1),import_es_array_push$25=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$11(e,t){_checkPrivateRedeclaration$16(e,t),t.add(e)}function _classPrivateFieldInitSpec$12(e,t,i){_checkPrivateRedeclaration$16(e,t),t.set(e,i)}function _checkPrivateRedeclaration$16(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$11(e,t,i){return e.set(_assertClassBrand$16(e,t),i),i}function _classPrivateFieldGet$12(e,t){return e.get(_assertClassBrand$16(e,t))}function _assertClassBrand$16(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}pluginHooks_default.getSingleton().register("beforeColumnMove"),pluginHooks_default.getSingleton().register("afterColumnMove");const PLUGIN_KEY$13="manualColumnMove",PLUGIN_PRIORITY$12=120,CSS_PLUGIN$1="ht__manualColumnMove",CSS_SHOW_UI$1="show-ui",CSS_ON_MOVING$1="on-moving--columns",CSS_AFTER_SELECTION$1="after-selection--columns";var _backlight$1=new WeakMap,_guideline$1=new WeakMap,_columnsToMove=new WeakMap,_countCols=new WeakMap,_pressed$3=new WeakMap,_target$1=new WeakMap,_cachedDropIndex$1=new WeakMap,_hoveredColumn=new WeakMap,_rootElementOffset=new WeakMap,_hasRowHeaders=new WeakMap,_fixedColumnsStart=new WeakMap,_ManualColumnMove_brand=new WeakSet,ManualColumnMove=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$11(this,_ManualColumnMove_brand),_classPrivateFieldInitSpec$12(this,_backlight$1,new backlight_default$1(this.hot)),_classPrivateFieldInitSpec$12(this,_guideline$1,new guideline_default$1(this.hot)),_classPrivateFieldInitSpec$12(this,_columnsToMove,[]),_classPrivateFieldInitSpec$12(this,_countCols,0),_classPrivateFieldInitSpec$12(this,_pressed$3,!1),_classPrivateFieldInitSpec$12(this,_target$1,{}),_classPrivateFieldInitSpec$12(this,_cachedDropIndex$1,void 0),_classPrivateFieldInitSpec$12(this,_hoveredColumn,void 0),_classPrivateFieldInitSpec$12(this,_rootElementOffset,void 0),_classPrivateFieldInitSpec$12(this,_hasRowHeaders,void 0),_classPrivateFieldInitSpec$12(this,_fixedColumnsStart,void 0)}static get PLUGIN_KEY(){return PLUGIN_KEY$13}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$12}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$13]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$16(_ManualColumnMove_brand,e,_onBeforeOnCellMouseDown$3).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$16(_ManualColumnMove_brand,e,_onBeforeOnCellMouseOver$2).call(e,...i)}),this.addHook("afterScrollVertically",()=>_assertClassBrand$16(_ManualColumnMove_brand,this,_onAfterScrollVertically).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$16(_ManualColumnMove_brand,e,_onAfterLoadData$2).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),addClass$1(this.hot.rootElement,CSS_PLUGIN$1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){removeClass$1(this.hot.rootElement,CSS_PLUGIN$1),this.unregisterEvents(),_classPrivateFieldGet$12(_backlight$1,this).destroy(),_classPrivateFieldGet$12(_guideline$1,this).destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const i=_classPrivateFieldGet$12(_cachedDropIndex$1,this),r=this.isMovePossible(e,t),o=this.hot.runHooks("beforeColumnMove",e,t,i,r);if(_classPrivateFieldSet$11(_cachedDropIndex$1,this,void 0),o===!1)return;r&&this.hot.columnIndexMapper.moveIndexes(e,t);const a=r&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,i,r,a),a}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const i=this.countFinalIndex(e,t);return _classPrivateFieldSet$11(_cachedDropIndex$1,this,t),this.moveColumns(e,i)}isMovePossible(e,t){const i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=e.length+t>i,o=t<0,a=e.some(u=>u<0),c=e.some(u=>u>=i);return!(r||o||a||c)}isColumnOrderChanged(e,t){return e.some((i,r)=>i-r!==t)}countFinalIndex(e,t){const i=arrayReduce(e,(r,o)=>(o<t&&(r+=1),r),0);return t-i}getColumnsWidth(e,t){const i=this.hot.columnIndexMapper;let r=0;for(let o=e;o<=t;o+=1){const a=i.getRenderableFromVisualIndex(o);o<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:a!==null&&(r+=this.hot.view._wt.wtTable.getStretchedColumnWidth(a)||0)}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[PLUGIN_KEY$13];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const i=[];return rangeEach(e,t,r=>{i.push(r)}),i}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(_classPrivateFieldGet$12(_hoveredColumn,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const t=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,r=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,_classPrivateFieldGet$12(_hoveredColumn,this)-1);const a=t.hider.offsetWidth,c=t.TBODY.offsetLeft,u=_classPrivateFieldGet$12(_backlight$1,this).getOffset().start,h=_classPrivateFieldGet$12(_backlight$1,this).getSize().width;let d=0,f=0;if(this.hot.isRtl()){const v=this.hot.rootWindow,_=outerWidth(this.hot.rootElement),b=v.innerWidth-_classPrivateFieldGet$12(_rootElementOffset,this)-_;f=v.innerWidth-_classPrivateFieldGet$12(_target$1,this).eventPageX-b-(i.scrollX===void 0?r:0)}else f=_classPrivateFieldGet$12(_target$1,this).eventPageX-(_classPrivateFieldGet$12(_rootElementOffset,this)-(i.scrollX===void 0?r:0));if(_classPrivateFieldGet$12(_hasRowHeaders,this)&&(d=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(_classPrivateFieldGet$12(_hoveredColumn,this))&&(o+=r),o+=d,_classPrivateFieldGet$12(_hoveredColumn,this)<0)_classPrivateFieldGet$12(_fixedColumnsStart,this)>0?_classPrivateFieldGet$12(_target$1,this).col=0:_classPrivateFieldGet$12(_target$1,this).col=e>0?e-1:e;else if(_classPrivateFieldGet$12(_target$1,this).TD.offsetWidth/2+o<=f){const v=_classPrivateFieldGet$12(_hoveredColumn,this)>=_classPrivateFieldGet$12(_countCols,this)?_classPrivateFieldGet$12(_countCols,this)-1:_classPrivateFieldGet$12(_hoveredColumn,this);_classPrivateFieldGet$12(_target$1,this).col=v+1,o+=_classPrivateFieldGet$12(_target$1,this).TD.offsetWidth}else _classPrivateFieldGet$12(_target$1,this).col=_classPrivateFieldGet$12(_hoveredColumn,this);let m=f,g=o;f+h+u>=a?m=a-h-u:f+u<c+d&&(m=c+d+Math.abs(u)),o>=a-1?g=a-1:g===0?g=1:i.scrollX!==void 0&&_classPrivateFieldGet$12(_hoveredColumn,this)<_classPrivateFieldGet$12(_fixedColumnsStart,this)&&(g-=_classPrivateFieldGet$12(_rootElementOffset,this)<=i.scrollX?_classPrivateFieldGet$12(_rootElementOffset,this):0),_classPrivateFieldGet$12(_backlight$1,this).setPosition(null,m),_classPrivateFieldGet$12(_guideline$1,this).setPosition(null,g)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>_assertClassBrand$16(_ManualColumnMove_brand,this,_onMouseMove$3).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand$16(_ManualColumnMove_brand,this,_onMouseUp$3).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){_classPrivateFieldGet$12(_backlight$1,this).build(),_classPrivateFieldGet$12(_guideline$1,this).build()}destroy(){_classPrivateFieldGet$12(_backlight$1,this).destroy(),_classPrivateFieldGet$12(_guideline$1,this).destroy(),super.destroy()}};function _onBeforeOnCellMouseDown$3(e,t,i,r){const o=this.hot.view._wt.wtTable,a=this.hot.selection.isSelectedByColumnHeader(),c=this.hot.getSelectedRangeLast(),u=hasClass$1(e.target,"sortAction");if(!c||!a||_classPrivateFieldGet$12(_pressed$3,this)||e.button!==0||u){_classPrivateFieldSet$11(_pressed$3,this,!1),_classPrivateFieldGet$12(_columnsToMove,this).length=0,removeClass$1(this.hot.rootElement,[CSS_ON_MOVING$1,CSS_SHOW_UI$1]);return}const h=_classPrivateFieldGet$12(_guideline$1,this).isBuilt()&&!_classPrivateFieldGet$12(_guideline$1,this).isAppended(),d=_classPrivateFieldGet$12(_backlight$1,this).isBuilt()&&!_classPrivateFieldGet$12(_backlight$1,this).isAppended();h&&d&&(_classPrivateFieldGet$12(_guideline$1,this).appendTo(o.hider),_classPrivateFieldGet$12(_backlight$1,this).appendTo(o.hider));const{from:f,to:m}=c,g=Math.min(f.col,m.col),v=Math.max(f.col,m.col);if(t.row<0&&t.col>=g&&t.col<=v){r.column=!0,_classPrivateFieldSet$11(_pressed$3,this,!0);const _=i.firstChild?offsetRelativeTo(e,i.firstChild).x:e.offsetX;_classPrivateFieldGet$12(_target$1,this).eventPageX=e.pageX,_classPrivateFieldSet$11(_hoveredColumn,this,t.col),_classPrivateFieldGet$12(_target$1,this).TD=i,_classPrivateFieldGet$12(_target$1,this).col=t.col,_classPrivateFieldSet$11(_columnsToMove,this,this.prepareColumnsToMoving(g,v)),_classPrivateFieldSet$11(_hasRowHeaders,this,!!this.hot.getSettings().rowHeaders),_classPrivateFieldSet$11(_countCols,this,this.hot.countCols()),_classPrivateFieldSet$11(_fixedColumnsStart,this,this.hot.getSettings().fixedColumnsStart),_classPrivateFieldSet$11(_rootElementOffset,this,offset$2(this.hot.rootElement).left);const b=_classPrivateFieldGet$12(_hasRowHeaders,this)?-1:0,S=o.holder.scrollTop+o.getColumnHeaderHeight(0)+1,T=t.col<_classPrivateFieldGet$12(_fixedColumnsStart,this),A=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),I=Math.abs(_-(this.hot.isRtl()?i.offsetWidth:0)),R=this.getColumnsWidth(g,t.col-1)+I,O=this.getColumnsWidth(b,g-1)+(T?A:0)+R;_classPrivateFieldGet$12(_backlight$1,this).setPosition(S,O),_classPrivateFieldGet$12(_backlight$1,this).setSize(this.getColumnsWidth(g,v),o.hider.offsetHeight-S),_classPrivateFieldGet$12(_backlight$1,this).setOffset(null,-R),addClass$1(this.hot.rootElement,CSS_ON_MOVING$1)}else removeClass$1(this.hot.rootElement,CSS_AFTER_SELECTION$1),_classPrivateFieldSet$11(_pressed$3,this,!1),_classPrivateFieldGet$12(_columnsToMove,this).length=0}function _onMouseMove$3(e){_classPrivateFieldGet$12(_pressed$3,this)&&(_classPrivateFieldGet$12(_target$1,this).eventPageX=e.pageX,this.refreshPositions())}function _onBeforeOnCellMouseOver$2(e,t,i,r){!this.hot.getSelectedRangeLast()||!_classPrivateFieldGet$12(_pressed$3,this)||(_classPrivateFieldGet$12(_columnsToMove,this).indexOf(t.col)>-1?removeClass$1(this.hot.rootElement,CSS_SHOW_UI$1):addClass$1(this.hot.rootElement,CSS_SHOW_UI$1),r.row=!0,r.column=!0,r.cell=!0,_classPrivateFieldSet$11(_hoveredColumn,this,t.col),_classPrivateFieldGet$12(_target$1,this).TD=i)}function _onMouseUp$3(){const e=_classPrivateFieldGet$12(_target$1,this).col,t=_classPrivateFieldGet$12(_columnsToMove,this).length;if(_classPrivateFieldSet$11(_hoveredColumn,this,void 0),_classPrivateFieldSet$11(_pressed$3,this,!1),removeClass$1(this.hot.rootElement,[CSS_ON_MOVING$1,CSS_SHOW_UI$1,CSS_AFTER_SELECTION$1]),this.hot.selection.isSelectedByColumnHeader()&&addClass$1(this.hot.rootElement,CSS_AFTER_SELECTION$1),t<1||e===void 0)return;const i=_classPrivateFieldGet$12(_columnsToMove,this)[0],r=this.hot.toPhysicalColumn(i),o=this.dragColumns(_classPrivateFieldGet$12(_columnsToMove,this),e);if(_classPrivateFieldGet$12(_columnsToMove,this).length=0,o===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const a=this.hot.toVisualColumn(r),c=a+t-1;this.hot.selectColumns(a,c)}}function _onAfterScrollVertically(){const e=this.hot.view._wt.wtTable,t=e.getColumnHeaderHeight(0)+1,i=e.holder.scrollTop,r=t+i;_classPrivateFieldGet$12(_backlight$1,this).setPosition(r),_classPrivateFieldGet$12(_backlight$1,this).setSize(null,e.hider.offsetHeight-r)}function _onAfterLoadData$2(){this.moveBySettingsOrLoad()}var import_es_error_cause$32=__toESM(require_es_error_cause(),1),import_es_array_push$24=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$10(e,t){_checkPrivateRedeclaration$15(e,t),t.add(e)}function _classPrivateFieldInitSpec$11(e,t,i){_checkPrivateRedeclaration$15(e,t),t.set(e,i)}function _checkPrivateRedeclaration$15(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$10(e,t,i){return e.set(_assertClassBrand$15(e,t),i),i}function _classPrivateFieldGet$11(e,t){return e.get(_assertClassBrand$15(e,t))}function _assertClassBrand$15(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$12="manualColumnResize",PLUGIN_PRIORITY$11=130,PERSISTENT_STATE_KEY$1="manualColumnWidths";var _currentTH$1=new WeakMap,_currentCol=new WeakMap,_selectedCols=new WeakMap,_currentWidth=new WeakMap,_newSize$1=new WeakMap,_startY$1=new WeakMap,_startWidth=new WeakMap,_startOffset$1=new WeakMap,_handle$1=new WeakMap,_guide$1=new WeakMap,_pressed$2=new WeakMap,_isTriggeredByRMB$1=new WeakMap,_dblclick$1=new WeakMap,_autoresizeTimeout$1=new WeakMap,_columnWidthsMap=new WeakMap,_config$1=new WeakMap,_ManualColumnResize_brand=new WeakSet,ManualColumnResize=class extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$12}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$11}constructor(e){super(e),_classPrivateMethodInitSpec$10(this,_ManualColumnResize_brand),_classPrivateFieldInitSpec$11(this,_currentTH$1,null),_classPrivateFieldInitSpec$11(this,_currentCol,null),_classPrivateFieldInitSpec$11(this,_selectedCols,[]),_classPrivateFieldInitSpec$11(this,_currentWidth,null),_classPrivateFieldInitSpec$11(this,_newSize$1,null),_classPrivateFieldInitSpec$11(this,_startY$1,null),_classPrivateFieldInitSpec$11(this,_startWidth,null),_classPrivateFieldInitSpec$11(this,_startOffset$1,null),_classPrivateFieldInitSpec$11(this,_handle$1,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec$11(this,_guide$1,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec$11(this,_pressed$2,null),_classPrivateFieldInitSpec$11(this,_isTriggeredByRMB$1,!1),_classPrivateFieldInitSpec$11(this,_dblclick$1,0),_classPrivateFieldInitSpec$11(this,_autoresizeTimeout$1,null),_classPrivateFieldInitSpec$11(this,_columnWidthsMap,void 0),_classPrivateFieldInitSpec$11(this,_config$1,void 0),addClass$1(_classPrivateFieldGet$11(_handle$1,this),"manualColumnResizer"),addClass$1(_classPrivateFieldGet$11(_guide$1,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$12]}enablePlugin(){this.enabled||(_classPrivateFieldSet$10(_columnWidthsMap,this,new PhysicalIndexToValueMap),_classPrivateFieldGet$11(_columnWidthsMap,this).addLocalHook("init",()=>_assertClassBrand$15(_ManualColumnResize_brand,this,_onMapInit$2).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$11(_columnWidthsMap,this)),this.addHook("modifyColWidth",(e,t)=>_assertClassBrand$15(_ManualColumnResize_brand,this,_onModifyColWidth$1).call(this,e,t),1),this.addHook("beforeStretchingColumnWidth",(e,t)=>_assertClassBrand$15(_ManualColumnResize_brand,this,_onBeforeStretchingColumnWidth).call(this,e,t)),this.addHook("beforeColumnResize",(e,t,i)=>_assertClassBrand$15(_ManualColumnResize_brand,this,_onBeforeColumnResize).call(this,e,t,i)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){_classPrivateFieldSet$10(_config$1,this,_classPrivateFieldGet$11(_columnWidthsMap,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",PERSISTENT_STATE_KEY$1,_classPrivateFieldGet$11(_columnWidthsMap,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",PERSISTENT_STATE_KEY$1,e),e.value}setManualSize(e,t){const i=Math.max(t,20),r=this.hot.toPhysicalColumn(e);return _classPrivateFieldGet$11(_columnWidthsMap,this).setValueAtIndex(r,i),i}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);_classPrivateFieldGet$11(_columnWidthsMap,this).setValueAtIndex(t,null)}setupHandlePosition(e){if(!e.parentNode)return;_classPrivateFieldSet$10(_currentTH$1,this,e);const{_wt:t}=this.hot.view,i=t.wtTable.getCoords(_classPrivateFieldGet$11(_currentTH$1,this)),r=i.col;if(r<0)return;const o=outerHeight(_classPrivateFieldGet$11(_currentTH$1,this)),a=_classPrivateFieldGet$11(_currentTH$1,this).getBoundingClientRect(),c=r<t.getSetting("fixedColumnsStart");let u;c&&(u=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(_classPrivateFieldGet$11(_currentTH$1,this),i.row,i.col)),u||(u=t.wtOverlays.topOverlay.getRelativeCellPosition(_classPrivateFieldGet$11(_currentTH$1,this),i.row,i.col)),_classPrivateFieldSet$10(_currentCol,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)),_classPrivateFieldSet$10(_selectedCols,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();arrayEach$1(d,f=>{const m=f.getTopStartCorner().col,g=f.getBottomEndCorner().col;rangeEach(m,g,v=>{_classPrivateFieldGet$11(_selectedCols,this).includes(v)||_classPrivateFieldGet$11(_selectedCols,this).push(v)})})}_classPrivateFieldGet$11(_selectedCols,this).includes(_classPrivateFieldGet$11(_currentCol,this))||_classPrivateFieldSet$10(_selectedCols,this,[_classPrivateFieldGet$11(_currentCol,this)]),_classPrivateFieldSet$10(_startOffset$1,this,u.start-6),_classPrivateFieldSet$10(_startWidth,this,parseInt(a.width,10)),_classPrivateFieldGet$11(_handle$1,this).style.top=`${u.top}px`,_classPrivateFieldGet$11(_handle$1,this).style[this.inlineDir]=`${_classPrivateFieldGet$11(_startOffset$1,this)+_classPrivateFieldGet$11(_startWidth,this)}px`,_classPrivateFieldGet$11(_handle$1,this).style.height=`${o}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet$11(_handle$1,this))}refreshHandlePosition(){_classPrivateFieldGet$11(_handle$1,this).style[this.inlineDir]=`${_classPrivateFieldGet$11(_startOffset$1,this)+_classPrivateFieldGet$11(_currentWidth,this)}px`}setupGuidePosition(){const e=parseInt(outerHeight(_classPrivateFieldGet$11(_handle$1,this)),10),t=parseInt(_classPrivateFieldGet$11(_handle$1,this).style.top,10)+e,i=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);addClass$1(_classPrivateFieldGet$11(_handle$1,this),"active"),addClass$1(_classPrivateFieldGet$11(_guide$1,this),"active"),_classPrivateFieldGet$11(_guide$1,this).style.top=`${t}px`,this.refreshGuidePosition(),_classPrivateFieldGet$11(_guide$1,this).style.height=`${i-e}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet$11(_guide$1,this))}refreshGuidePosition(){_classPrivateFieldGet$11(_guide$1,this).style[this.inlineDir]=_classPrivateFieldGet$11(_handle$1,this).style[this.inlineDir]}hideHandleAndGuide(){removeClass$1(_classPrivateFieldGet$11(_handle$1,this),"active"),removeClass$1(_classPrivateFieldGet$11(_guide$1,this),"active")}checkIfColumnHeader(e){const t=closest(e,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,r.clone.wtTable.THEAD].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(i,r)=>{const o=this.hot.runHooks("beforeColumnResize",_classPrivateFieldGet$11(_newSize$1,this),i,!0);o!==void 0&&_classPrivateFieldSet$10(_newSize$1,this,o),this.hot.getSettings().stretchH==="all"?this.clearManualSize(i):this.setManualSize(i,_classPrivateFieldGet$11(_newSize$1,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",_classPrivateFieldGet$11(_newSize$1,this),i,!0),r&&e()};_classPrivateFieldGet$11(_dblclick$1,this)>=2&&(_classPrivateFieldGet$11(_selectedCols,this).length>1?(arrayEach$1(_classPrivateFieldGet$11(_selectedCols,this),r=>{t(r)}),e()):arrayEach$1(_classPrivateFieldGet$11(_selectedCols,this),r=>{t(r,!0)})),_classPrivateFieldSet$10(_dblclick$1,this,0),_classPrivateFieldSet$10(_autoresizeTimeout$1,this,null)}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",i=>_assertClassBrand$15(_ManualColumnResize_brand,this,_onMouseOver$1).call(this,i)),this.eventManager.addEventListener(t,"mousedown",i=>_assertClassBrand$15(_ManualColumnResize_brand,this,_onMouseDown$1).call(this,i)),this.eventManager.addEventListener(e,"mousemove",i=>_assertClassBrand$15(_ManualColumnResize_brand,this,_onMouseMove$2).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand$15(_ManualColumnResize_brand,this,_onMouseUp$2).call(this)),this.eventManager.addEventListener(_classPrivateFieldGet$11(_handle$1,this),"contextmenu",()=>_assertClassBrand$15(_ManualColumnResize_brand,this,_onContextMenu$1).call(this))}destroy(){super.destroy()}};function _onMapInit$2(){const e=this.hot.getSettings()[PLUGIN_KEY$12],t=this.loadManualColumnWidths();typeof t<"u"?this.hot.batchExecution(()=>{t.forEach((i,r)=>{_classPrivateFieldGet$11(_columnWidthsMap,this).setValueAtIndex(r,i)})},!0):Array.isArray(e)?(this.hot.batchExecution(()=>{e.forEach((i,r)=>{_classPrivateFieldGet$11(_columnWidthsMap,this).setValueAtIndex(r,i)})},!0),_classPrivateFieldSet$10(_config$1,this,e)):e===!0&&Array.isArray(_classPrivateFieldGet$11(_config$1,this))&&this.hot.batchExecution(()=>{_classPrivateFieldGet$11(_config$1,this).forEach((i,r)=>{_classPrivateFieldGet$11(_columnWidthsMap,this).setValueAtIndex(r,i)})},!0)}function _onMouseOver$1(e){if(!isDetached(e.target)&&_classPrivateFieldGet$11(_isTriggeredByRMB$1,this)!==!0&&this.checkIfColumnHeader(e.target)){const t=this.getClosestTHParent(e.target);if(!t)return;const i=t.getAttribute("colspan");t&&(i===null||i==="1")&&(_classPrivateFieldGet$11(_pressed$2,this)||this.setupHandlePosition(t))}}function _onMouseDown$1(e){e.target.parentNode===this.hot.rootElement&&hasClass$1(e.target,"manualColumnResizer")&&(this.setupHandlePosition(_classPrivateFieldGet$11(_currentTH$1,this)),this.setupGuidePosition(),_classPrivateFieldSet$10(_pressed$2,this,!0),_classPrivateFieldGet$11(_autoresizeTimeout$1,this)===null&&(_classPrivateFieldSet$10(_autoresizeTimeout$1,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(_classPrivateFieldGet$11(_autoresizeTimeout$1,this))),_classPrivateFieldSet$10(_dblclick$1,this,_classPrivateFieldGet$11(_dblclick$1,this)+1),this.startX=e.pageX,_classPrivateFieldSet$10(_newSize$1,this,_classPrivateFieldGet$11(_startWidth,this)))}function _onMouseMove$2(e){if(_classPrivateFieldGet$11(_pressed$2,this)){const t=(e.pageX-this.startX)*this.hot.getDirectionFactor();_classPrivateFieldSet$10(_currentWidth,this,_classPrivateFieldGet$11(_startWidth,this)+t),arrayEach$1(_classPrivateFieldGet$11(_selectedCols,this),i=>{_classPrivateFieldSet$10(_newSize$1,this,this.setManualSize(i,_classPrivateFieldGet$11(_currentWidth,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function _onMouseUp$2(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(i,r)=>{this.hot.runHooks("beforeColumnResize",_classPrivateFieldGet$11(_newSize$1,this),i,!1),r&&e(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",_classPrivateFieldGet$11(_newSize$1,this),i,!1)};_classPrivateFieldGet$11(_pressed$2,this)&&(this.hideHandleAndGuide(),_classPrivateFieldSet$10(_pressed$2,this,!1),_classPrivateFieldGet$11(_newSize$1,this)!==_classPrivateFieldGet$11(_startWidth,this)&&(_classPrivateFieldGet$11(_selectedCols,this).length>1?(arrayEach$1(_classPrivateFieldGet$11(_selectedCols,this),r=>{t(r)}),e()):arrayEach$1(_classPrivateFieldGet$11(_selectedCols,this),r=>{t(r,!0)})),this.setupHandlePosition(_classPrivateFieldGet$11(_currentTH$1,this)))}function _onContextMenu$1(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(_classPrivateFieldGet$11(_handle$1,this)),this.hot.rootElement.removeChild(_classPrivateFieldGet$11(_guide$1,this)),_classPrivateFieldSet$10(_pressed$2,this,!1),_classPrivateFieldSet$10(_isTriggeredByRMB$1,this,!0),this.hot._registerImmediate(()=>{_classPrivateFieldSet$10(_isTriggeredByRMB$1,this,!1)})}function _onModifyColWidth$1(e,t){let i=e;if(this.enabled){const r=this.hot.toPhysicalColumn(t),o=_classPrivateFieldGet$11(_columnWidthsMap,this).getValueAtIndex(r);this.hot.getSettings()[PLUGIN_KEY$12]&&o&&(i=o)}return i}function _onBeforeStretchingColumnWidth(e,t){let i=_classPrivateFieldGet$11(_columnWidthsMap,this).getValueAtIndex(t);return i===null&&(i=e),i}function _onBeforeColumnResize(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}var import_es_error_cause$31=__toESM(require_es_error_cause(),1);function _defineProperty$21(e,t,i){return(t=_toPropertyKey$22(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$22(e){var t=_toPrimitive$22(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$22(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}const STATE_INITIALIZED=0,STATE_BUILT=1,STATE_APPENDED=2,UNIT="px";var BaseUI$1=class{constructor(e){_defineProperty$21(this,"hot",void 0),_defineProperty$21(this,"_element",null),_defineProperty$21(this,"state",STATE_INITIALIZED),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=STATE_APPENDED}build(){this.state===STATE_INITIALIZED&&(this._element=this.hot.rootDocument.createElement("div"),this.state=STATE_BUILT)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=STATE_INITIALIZED}isAppended(){return this.state===STATE_APPENDED}isBuilt(){return this.state>=STATE_BUILT}setPosition(e,t){e!==void 0&&(this._element.style.top=e+UNIT),t!==void 0&&(this._element.style.left=t+UNIT)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+UNIT),t&&(this._element.style.height=t+UNIT)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+UNIT),t&&(this._element.style.marginLeft=t+UNIT)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}},_base_default$1=BaseUI$1;const CSS_CLASSNAME$1="ht__manualRowMove--backlight";var BacklightUI=class extends _base_default$1{build(){super.build(),addClass$1(this._element,CSS_CLASSNAME$1)}},backlight_default=BacklightUI;const CSS_CLASSNAME="ht__manualRowMove--guideline";var GuidelineUI=class extends _base_default$1{build(){super.build(),addClass$1(this._element,CSS_CLASSNAME)}},guideline_default=GuidelineUI,import_es_error_cause$30=__toESM(require_es_error_cause(),1),import_es_array_push$23=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$9(e,t){_checkPrivateRedeclaration$14(e,t),t.add(e)}function _classPrivateFieldInitSpec$10(e,t,i){_checkPrivateRedeclaration$14(e,t),t.set(e,i)}function _checkPrivateRedeclaration$14(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$9(e,t,i){return e.set(_assertClassBrand$14(e,t),i),i}function _classPrivateFieldGet$10(e,t){return e.get(_assertClassBrand$14(e,t))}function _assertClassBrand$14(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}pluginHooks_default.getSingleton().register("beforeRowMove"),pluginHooks_default.getSingleton().register("afterRowMove");const PLUGIN_KEY$11="manualRowMove",PLUGIN_PRIORITY$10=140,CSS_PLUGIN="ht__manualRowMove",CSS_SHOW_UI="show-ui",CSS_ON_MOVING="on-moving--rows",CSS_AFTER_SELECTION="after-selection--rows";var _backlight=new WeakMap,_guideline=new WeakMap,_rowsToMove=new WeakMap,_pressed$1=new WeakMap,_target=new WeakMap,_cachedDropIndex=new WeakMap,_ManualRowMove_brand=new WeakSet,ManualRowMove=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$9(this,_ManualRowMove_brand),_classPrivateFieldInitSpec$10(this,_backlight,new backlight_default(this.hot)),_classPrivateFieldInitSpec$10(this,_guideline,new guideline_default(this.hot)),_classPrivateFieldInitSpec$10(this,_rowsToMove,[]),_classPrivateFieldInitSpec$10(this,_pressed$1,void 0),_classPrivateFieldInitSpec$10(this,_target,{}),_classPrivateFieldInitSpec$10(this,_cachedDropIndex,void 0)}static get PLUGIN_KEY(){return PLUGIN_KEY$11}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$10}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$11]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$14(_ManualRowMove_brand,e,_onBeforeOnCellMouseDown$2).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$14(_ManualRowMove_brand,e,_onBeforeOnCellMouseOver$1).call(e,...i)}),this.addHook("afterScrollHorizontally",()=>_assertClassBrand$14(_ManualRowMove_brand,this,_onAfterScrollHorizontally).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$14(_ManualRowMove_brand,e,_onAfterLoadData$1).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),addClass$1(this.hot.rootElement,CSS_PLUGIN),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){removeClass$1(this.hot.rootElement,CSS_PLUGIN),this.unregisterEvents(),_classPrivateFieldGet$10(_backlight,this).destroy(),_classPrivateFieldGet$10(_guideline,this).destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const i=_classPrivateFieldGet$10(_cachedDropIndex,this),r=this.isMovePossible(e,t),o=this.hot.runHooks("beforeRowMove",e,t,i,r);if(_classPrivateFieldSet$9(_cachedDropIndex,this,void 0),o===!1)return;r&&this.hot.rowIndexMapper.moveIndexes(e,t);const a=r&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,i,r,a),a}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const i=this.countFinalIndex(e,t);return _classPrivateFieldSet$9(_cachedDropIndex,this,t),this.moveRows(e,i)}isMovePossible(e,t){const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=e.length+t>i,o=t<0,a=e.some(u=>u<0),c=e.some(u=>u>=i);return!(r||o||a||c)}isRowOrderChanged(e,t){return e.some((i,r)=>i-r!==t)}countFinalIndex(e,t){const i=arrayReduce(e,(r,o)=>(o<t&&(r+=1),r),0);return t-i}getRowsHeight(e,t){const i=this.hot.rowIndexMapper;let r=0;for(let o=e;o<=t;o++){const a=i.getRenderableFromVisualIndex(o);a!==null&&(r+=this.hot.view._wt.wtTable.getRowHeight(a)||23)}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[PLUGIN_KEY$11];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:i,to:r}=e,o=Math.min(i.row,r.row),a=Math.max(i.row,r.row);return rangeEach(o,a,c=>{t.push(c)}),t}refreshPositions(){const e=_classPrivateFieldGet$10(_target,this).coords,t=this.hot.view.getFirstFullyVisibleRow(),i=this.hot.view.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(e.row)&&t>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1)),this.isFixedRowBottom(e.row)&&i<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,a=_classPrivateFieldGet$10(_target,this).TD,c=this.hot.rootElement,u=offset$2(c),h=getTrimmingContainer(c),d=o.holder.scrollTop,f=this.hot.rootWindow!==h?h.scrollTop:0,m=u.top-f,g=_classPrivateFieldGet$10(_target,this).eventPageY-m+d,v=o.hider.offsetHeight,_=o.TBODY.offsetTop,b=_classPrivateFieldGet$10(_backlight,this).getOffset().top,S=_classPrivateFieldGet$10(_backlight,this).getSize().height,T=a.offsetHeight/2,A=a.offsetHeight;let I=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const R=g>=I+T;this.isFixedRowTop(e.row)&&(I+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?_classPrivateFieldGet$10(_target,this).row=t>0?t-1:t:R?(_classPrivateFieldGet$10(_target,this).row=e.row+1,I+=e.row===0?A-1:A):_classPrivateFieldGet$10(_target,this).row=e.row;let O=g,P=I;g+S+b>=v?O=v-S-b:g+b<_&&(O=_+Math.abs(b)),I>=v-1&&(P=v-1),_classPrivateFieldGet$10(_backlight,this).setPosition(O),_classPrivateFieldGet$10(_guideline,this).setPosition(P)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>_assertClassBrand$14(_ManualRowMove_brand,this,_onMouseMove$1).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand$14(_ManualRowMove_brand,this,_onMouseUp$1).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){_classPrivateFieldGet$10(_backlight,this).build(),_classPrivateFieldGet$10(_guideline,this).build()}destroy(){_classPrivateFieldGet$10(_backlight,this).destroy(),_classPrivateFieldGet$10(_guideline,this).destroy(),super.destroy()}};function _onBeforeOnCellMouseDown$2(e,t,i,r){const{wtTable:o,wtViewport:a}=this.hot.view._wt,c=this.hot.selection.isSelectedByRowHeader(),u=this.hot.getSelectedRangeLast();if(!u||!c||_classPrivateFieldGet$10(_pressed$1,this)||e.button!==0){_classPrivateFieldSet$9(_pressed$1,this,!1),_classPrivateFieldGet$10(_rowsToMove,this).length=0,removeClass$1(this.hot.rootElement,[CSS_ON_MOVING,CSS_SHOW_UI]);return}const h=_classPrivateFieldGet$10(_guideline,this).isBuilt()&&!_classPrivateFieldGet$10(_guideline,this).isAppended(),d=_classPrivateFieldGet$10(_backlight,this).isBuilt()&&!_classPrivateFieldGet$10(_backlight,this).isAppended();h&&d&&(_classPrivateFieldGet$10(_guideline,this).appendTo(o.hider),_classPrivateFieldGet$10(_backlight,this).appendTo(o.hider));const{from:f,to:m}=u,g=Math.min(f.row,m.row),v=Math.max(f.row,m.row);if(t.col<0&&t.row>=g&&t.row<=v){r.row=!0,_classPrivateFieldSet$9(_pressed$1,this,!0),_classPrivateFieldGet$10(_target,this).eventPageY=e.pageY,_classPrivateFieldGet$10(_target,this).coords=t,_classPrivateFieldGet$10(_target,this).TD=i,_classPrivateFieldSet$9(_rowsToMove,this,this.prepareRowsToMoving());const _=o.holder.scrollLeft+a.getRowHeaderWidth(),b=this.getRowsHeight(g,t.row-1)+e.offsetY;_classPrivateFieldGet$10(_backlight,this).setPosition(null,_),_classPrivateFieldGet$10(_backlight,this).setSize(o.hider.offsetWidth-_,this.getRowsHeight(g,v)),_classPrivateFieldGet$10(_backlight,this).setOffset(-b,null),addClass$1(this.hot.rootElement,CSS_ON_MOVING),this.refreshPositions()}else removeClass$1(this.hot.rootElement,CSS_AFTER_SELECTION),_classPrivateFieldSet$9(_pressed$1,this,!1),_classPrivateFieldGet$10(_rowsToMove,this).length=0}function _onMouseMove$1(e){_classPrivateFieldGet$10(_pressed$1,this)&&(_classPrivateFieldGet$10(_target,this).eventPageY=e.pageY,this.refreshPositions())}function _onBeforeOnCellMouseOver$1(e,t,i,r){!this.hot.getSelectedRangeLast()||!_classPrivateFieldGet$10(_pressed$1,this)||(_classPrivateFieldGet$10(_rowsToMove,this).indexOf(t.row)>-1?removeClass$1(this.hot.rootElement,CSS_SHOW_UI):addClass$1(this.hot.rootElement,CSS_SHOW_UI),r.row=!0,r.column=!0,r.cell=!0,_classPrivateFieldGet$10(_target,this).coords=t,_classPrivateFieldGet$10(_target,this).TD=i)}function _onMouseUp$1(){const e=_classPrivateFieldGet$10(_target,this).row,t=_classPrivateFieldGet$10(_rowsToMove,this).length;if(_classPrivateFieldSet$9(_pressed$1,this,!1),removeClass$1(this.hot.rootElement,[CSS_ON_MOVING,CSS_SHOW_UI,CSS_AFTER_SELECTION]),this.hot.selection.isSelectedByRowHeader()&&addClass$1(this.hot.rootElement,CSS_AFTER_SELECTION),t<1||e===void 0)return;const i=_classPrivateFieldGet$10(_rowsToMove,this)[0],r=this.hot.toPhysicalRow(i),o=this.dragRows(_classPrivateFieldGet$10(_rowsToMove,this),e);if(_classPrivateFieldGet$10(_rowsToMove,this).length=0,o===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const a=this.hot.toVisualRow(r),c=a+t-1;this.hot.selectRows(a,c)}}function _onAfterScrollHorizontally(){const e=this.hot.view._wt.wtTable,t=this.hot.view._wt.wtViewport.getRowHeaderWidth(),i=e.holder.scrollLeft,r=t+i;_classPrivateFieldGet$10(_backlight,this).setPosition(null,r),_classPrivateFieldGet$10(_backlight,this).setSize(e.hider.offsetWidth-r)}function _onAfterLoadData$1(){this.moveBySettingsOrLoad()}var import_es_error_cause$29=__toESM(require_es_error_cause(),1),import_es_array_push$22=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$8(e,t){_checkPrivateRedeclaration$13(e,t),t.add(e)}function _classPrivateFieldInitSpec$9(e,t,i){_checkPrivateRedeclaration$13(e,t),t.set(e,i)}function _checkPrivateRedeclaration$13(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$8(e,t,i){return e.set(_assertClassBrand$13(e,t),i),i}function _classPrivateFieldGet$9(e,t){return e.get(_assertClassBrand$13(e,t))}function _assertClassBrand$13(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$10="manualRowResize",PLUGIN_PRIORITY$9=30,PERSISTENT_STATE_KEY="manualRowHeights";var _currentTH=new WeakMap,_currentRow=new WeakMap,_selectedRows=new WeakMap,_currentHeight=new WeakMap,_newSize=new WeakMap,_startY=new WeakMap,_startHeight=new WeakMap,_startOffset=new WeakMap,_handle=new WeakMap,_guide=new WeakMap,_pressed=new WeakMap,_isTriggeredByRMB=new WeakMap,_dblclick=new WeakMap,_autoresizeTimeout=new WeakMap,_rowHeightsMap=new WeakMap,_config=new WeakMap,_ManualRowResize_brand=new WeakSet,ManualRowResize=class extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$10}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$9}constructor(e){super(e),_classPrivateMethodInitSpec$8(this,_ManualRowResize_brand),_classPrivateFieldInitSpec$9(this,_currentTH,null),_classPrivateFieldInitSpec$9(this,_currentRow,null),_classPrivateFieldInitSpec$9(this,_selectedRows,[]),_classPrivateFieldInitSpec$9(this,_currentHeight,null),_classPrivateFieldInitSpec$9(this,_newSize,null),_classPrivateFieldInitSpec$9(this,_startY,null),_classPrivateFieldInitSpec$9(this,_startHeight,null),_classPrivateFieldInitSpec$9(this,_startOffset,null),_classPrivateFieldInitSpec$9(this,_handle,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec$9(this,_guide,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec$9(this,_pressed,!1),_classPrivateFieldInitSpec$9(this,_isTriggeredByRMB,!1),_classPrivateFieldInitSpec$9(this,_dblclick,0),_classPrivateFieldInitSpec$9(this,_autoresizeTimeout,null),_classPrivateFieldInitSpec$9(this,_rowHeightsMap,void 0),_classPrivateFieldInitSpec$9(this,_config,void 0),addClass$1(_classPrivateFieldGet$9(_handle,this),"manualRowResizer"),addClass$1(_classPrivateFieldGet$9(_guide,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$10]}enablePlugin(){this.enabled||(_classPrivateFieldSet$8(_rowHeightsMap,this,new PhysicalIndexToValueMap),_classPrivateFieldGet$9(_rowHeightsMap,this).addLocalHook("init",()=>_assertClassBrand$13(_ManualRowResize_brand,this,_onMapInit$1).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$9(_rowHeightsMap,this)),this.addHook("modifyRowHeight",(e,t)=>_assertClassBrand$13(_ManualRowResize_brand,this,_onModifyRowHeight).call(this,e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){_classPrivateFieldSet$8(_config,this,_classPrivateFieldGet$9(_rowHeightsMap,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",PERSISTENT_STATE_KEY,_classPrivateFieldGet$9(_rowHeightsMap,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",PERSISTENT_STATE_KEY,e),e.value}setManualSize(e,t){const i=this.hot.toPhysicalRow(e),r=Math.max(t,DEFAULT_HEIGHT);return _classPrivateFieldGet$9(_rowHeightsMap,this).setValueAtIndex(i,r),r}getLastDesiredRowHeight(){return _classPrivateFieldGet$9(_currentHeight,this)}setupHandlePosition(e){_classPrivateFieldSet$8(_currentTH,this,e);const{view:t}=this.hot,{_wt:i}=t,r=i.wtTable.getCoords(_classPrivateFieldGet$9(_currentTH,this)),o=r.row;if(o<0)return;const a=outerWidth(_classPrivateFieldGet$9(_currentTH,this)),c=_classPrivateFieldGet$9(_currentTH,this).getBoundingClientRect(),u=o<i.getSetting("fixedRowsTop"),h=o>=t.countNotHiddenRowIndexes(0,1)-i.getSetting("fixedRowsBottom");let d;u?d=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(_classPrivateFieldGet$9(_currentTH,this),r.row,r.col):h&&(d=i.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(_classPrivateFieldGet$9(_currentTH,this),r.row,r.col)),d||(d=i.wtOverlays.inlineStartOverlay.getRelativeCellPosition(_classPrivateFieldGet$9(_currentTH,this),r.row,r.col)),_classPrivateFieldSet$8(_currentRow,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),_classPrivateFieldSet$8(_selectedRows,this,[]);const f=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&f){const m=this.hot.getSelectedRange();arrayEach$1(m,g=>{const v=g.getTopStartCorner().row,_=g.getBottomStartCorner().row;rangeEach(v,_,b=>{_classPrivateFieldGet$9(_selectedRows,this).includes(b)||_classPrivateFieldGet$9(_selectedRows,this).push(b)})})}_classPrivateFieldGet$9(_selectedRows,this).includes(_classPrivateFieldGet$9(_currentRow,this))||_classPrivateFieldSet$8(_selectedRows,this,[_classPrivateFieldGet$9(_currentRow,this)]),_classPrivateFieldSet$8(_startOffset,this,d.top-6),_classPrivateFieldSet$8(_startHeight,this,parseInt(c.height,10)),_classPrivateFieldGet$9(_handle,this).style.top=`${_classPrivateFieldGet$9(_startOffset,this)+_classPrivateFieldGet$9(_startHeight,this)}px`,_classPrivateFieldGet$9(_handle,this).style[this.inlineDir]=`${d.start}px`,_classPrivateFieldGet$9(_handle,this).style.width=`${a}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet$9(_handle,this))}refreshHandlePosition(){_classPrivateFieldGet$9(_handle,this).style.top=`${_classPrivateFieldGet$9(_startOffset,this)+_classPrivateFieldGet$9(_currentHeight,this)}px`}setupGuidePosition(){const e=parseInt(outerWidth(_classPrivateFieldGet$9(_handle,this)),10),t=parseInt(_classPrivateFieldGet$9(_handle,this).style[this.inlineDir],10)+e,i=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);addClass$1(_classPrivateFieldGet$9(_handle,this),"active"),addClass$1(_classPrivateFieldGet$9(_guide,this),"active"),_classPrivateFieldGet$9(_guide,this).style.top=_classPrivateFieldGet$9(_handle,this).style.top,_classPrivateFieldGet$9(_guide,this).style[this.inlineDir]=`${t}px`,_classPrivateFieldGet$9(_guide,this).style.width=`${i-e}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet$9(_guide,this))}refreshGuidePosition(){_classPrivateFieldGet$9(_guide,this).style.top=_classPrivateFieldGet$9(_handle,this).style.top}hideHandleAndGuide(){removeClass$1(_classPrivateFieldGet$9(_handle,this),"active"),removeClass$1(_classPrivateFieldGet$9(_guide,this),"active")}checkIfRowHeader(e){const t=closest(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,r.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return t!==void 0&&_classPrivateFieldGet$9(_newSize,this)<t?t:_classPrivateFieldGet$9(_newSize,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(i,r)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!0);o!==void 0&&_classPrivateFieldSet$8(_newSize,this,o),this.setManualSize(i,_classPrivateFieldGet$9(_newSize,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!0),r&&e()};_classPrivateFieldGet$9(_dblclick,this)>=2&&(_classPrivateFieldGet$9(_selectedRows,this).length>1?(arrayEach$1(_classPrivateFieldGet$9(_selectedRows,this),r=>{t(r)}),e()):arrayEach$1(_classPrivateFieldGet$9(_selectedRows,this),r=>{t(r,!0)})),_classPrivateFieldSet$8(_dblclick,this,0),_classPrivateFieldSet$8(_autoresizeTimeout,this,null)}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",i=>_assertClassBrand$13(_ManualRowResize_brand,this,_onMouseOver).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>_assertClassBrand$13(_ManualRowResize_brand,this,_onMouseDown).call(this,i)),this.eventManager.addEventListener(t,"mousemove",i=>_assertClassBrand$13(_ManualRowResize_brand,this,_onMouseMove).call(this,i)),this.eventManager.addEventListener(t,"mouseup",()=>_assertClassBrand$13(_ManualRowResize_brand,this,_onMouseUp).call(this)),this.eventManager.addEventListener(_classPrivateFieldGet$9(_handle,this),"contextmenu",()=>_assertClassBrand$13(_ManualRowResize_brand,this,_onContextMenu).call(this))}destroy(){super.destroy()}};function _onMouseOver(e){if(!isDetached(e.target)&&_classPrivateFieldGet$9(_isTriggeredByRMB,this)!==!0&&this.checkIfRowHeader(e.target)){const t=this.getClosestTHParent(e.target);t&&(_classPrivateFieldGet$9(_pressed,this)||this.setupHandlePosition(t))}}function _onMouseDown(e){hasClass$1(e.target,"manualRowResizer")&&(this.setupHandlePosition(_classPrivateFieldGet$9(_currentTH,this)),this.setupGuidePosition(),_classPrivateFieldSet$8(_pressed,this,!0),_classPrivateFieldGet$9(_autoresizeTimeout,this)===null&&(_classPrivateFieldSet$8(_autoresizeTimeout,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(_classPrivateFieldGet$9(_autoresizeTimeout,this))),_classPrivateFieldSet$8(_dblclick,this,_classPrivateFieldGet$9(_dblclick,this)+1),_classPrivateFieldSet$8(_startY,this,e.pageY),_classPrivateFieldSet$8(_newSize,this,_classPrivateFieldGet$9(_startHeight,this)))}function _onMouseMove(e){_classPrivateFieldGet$9(_pressed,this)&&(_classPrivateFieldSet$8(_currentHeight,this,_classPrivateFieldGet$9(_startHeight,this)+(e.pageY-_classPrivateFieldGet$9(_startY,this))),arrayEach$1(_classPrivateFieldGet$9(_selectedRows,this),t=>{_classPrivateFieldSet$8(_newSize,this,this.setManualSize(t,_classPrivateFieldGet$9(_currentHeight,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function _onMouseUp(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(i,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!1),r&&e(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!1)};_classPrivateFieldGet$9(_pressed,this)&&(this.hideHandleAndGuide(),_classPrivateFieldSet$8(_pressed,this,!1),_classPrivateFieldGet$9(_newSize,this)!==_classPrivateFieldGet$9(_startHeight,this)&&(_classPrivateFieldGet$9(_selectedRows,this).length>1?(arrayEach$1(_classPrivateFieldGet$9(_selectedRows,this),r=>{t(r)}),e()):arrayEach$1(_classPrivateFieldGet$9(_selectedRows,this),r=>{t(r,!0)})),this.setupHandlePosition(_classPrivateFieldGet$9(_currentTH,this)))}function _onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(_classPrivateFieldGet$9(_handle,this)),this.hot.rootElement.removeChild(_classPrivateFieldGet$9(_guide,this)),_classPrivateFieldSet$8(_pressed,this,!1),_classPrivateFieldSet$8(_isTriggeredByRMB,this,!0),this.hot._registerImmediate(()=>{_classPrivateFieldSet$8(_isTriggeredByRMB,this,!1)})}function _onModifyRowHeight(e,t){let i=e;if(this.enabled){const r=this.hot.toPhysicalRow(t),o=_classPrivateFieldGet$9(_rowHeightsMap,this).getValueAtIndex(r);this.hot.getSettings()[PLUGIN_KEY$10]&&o&&(i=o)}return i}function _onMapInit$1(){const e=this.hot.getSettings()[PLUGIN_KEY$10],t=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof t<"u"?t.forEach((i,r)=>{_classPrivateFieldGet$9(_rowHeightsMap,this).setValueAtIndex(r,i)}):Array.isArray(e)?(e.forEach((i,r)=>{_classPrivateFieldGet$9(_rowHeightsMap,this).setValueAtIndex(r,i)}),_classPrivateFieldSet$8(_config,this,e)):e===!0&&Array.isArray(_classPrivateFieldGet$9(_config,this))&&_classPrivateFieldGet$9(_config,this).forEach((i,r)=>{_classPrivateFieldGet$9(_rowHeightsMap,this).setValueAtIndex(r,i)})},!0)}var import_es_error_cause$28=__toESM(require_es_error_cause(),1);function _classPrivateFieldInitSpec$8(e,t,i){_checkPrivateRedeclaration$12(e,t),t.set(e,i)}function _checkPrivateRedeclaration$12(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$20(e,t,i){return(t=_toPropertyKey$21(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$21(e){var t=_toPrimitive$21(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$21(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet$8(e,t){return e.get(_assertClassBrand$12(e,t))}function _classPrivateFieldSet$7(e,t,i){return e.set(_assertClassBrand$12(e,t),i),i}function _assertClassBrand$12(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _cellRange=new WeakMap,MergedCellCoords=class{constructor(e,t,i,r,o,a){_defineProperty$20(this,"row",void 0),_defineProperty$20(this,"col",void 0),_defineProperty$20(this,"rowspan",void 0),_defineProperty$20(this,"colspan",void 0),_defineProperty$20(this,"removed",!1),_defineProperty$20(this,"cellCoordsFactory",void 0),_defineProperty$20(this,"cellRangeFactory",void 0),_classPrivateFieldInitSpec$8(this,_cellRange,null),this.row=e,this.col=t,this.rowspan=i,this.colspan=r,this.cellCoordsFactory=o,this.cellRangeFactory=a}static NEGATIVE_VALUES_WARNING(e){let{row:t,col:i,rowspan:r,colspan:o}=e;return toSingleLine`The merged cell declared with {row: ${t}, col: ${i},\x20
      rowspan: ${r}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:t,col:i}=e;return toSingleLine`The merged cell declared at [${t}, ${i}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:t,col:i}=e;return toSingleLine`The merged cell declared at [${t}, ${i}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:t,col:i}=e;return toSingleLine`The merged cell declared at [${t}, ${i}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:t,col:i,rowspan:r,colspan:o}=e;return t<0||i<0||r<0||o<0}static isSingleCell(e){let{rowspan:t,colspan:i}=e;return i===1&&t===1}static containsZeroSpan(e){let{rowspan:t,colspan:i}=e;return i===0||t===0}static isOutOfBounds(e,t,i){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=i||e.col+e.colspan-1>=i}normalize(e){const t=e.countRows(),i=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col),_classPrivateFieldSet$7(_cellRange,this,null)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const i=e[0]||e[1],r=t+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",a=e[0]?"col":"row",c=Math.min(t,r),u=Math.max(t,r),h=this[a],d=this[a]+this[o]-1;if(h>=t&&(this[a]+=i),i>0)t<=d&&t>h&&(this[o]+=i);else if(i<0){if(c<=h&&u>=d)return this.removed=!0,_classPrivateFieldSet$7(_cellRange,this,null),!1;if(h>=c&&h<=u){const f=u-h+1,m=Math.abs(i)-f;this[a]-=m+i,this[o]-=f}else if(h<=c&&d>=u)this[o]+=i;else if(h<=c&&d>=c&&d<u){const f=d-c+1;this[o]-=f}}return _classPrivateFieldSet$7(_cellRange,this,null),!0}isFarther(e,t){return e?t==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:t==="up"?e.row>this.row:t==="right"?e.col+e.colspan-1<this.col+this.colspan-1:t==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return _classPrivateFieldGet$8(_cellRange,this)||_classPrivateFieldSet$7(_cellRange,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),_classPrivateFieldGet$8(_cellRange,this)}},cellCoords_default=MergedCellCoords,import_es_error_cause$27=__toESM(require_es_error_cause(),1),import_es_array_push$21=__toESM(require_es_array_push(),1),import_es_array_unscopables_flat_map=__toESM(require_es_array_unscopables_flat_map(),1),import_es_set_difference_v2$5=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$5=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$5=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$5=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$5=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$5=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$5=__toESM(require_es_set_union_v2(),1);function _classPrivateMethodInitSpec$7(e,t){_checkPrivateRedeclaration$11(e,t),t.add(e)}function _checkPrivateRedeclaration$11(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$19(e,t,i){return(t=_toPropertyKey$20(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$20(e){var t=_toPrimitive$20(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$20(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand$11(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _MergedCellsCollection_brand=new WeakSet,MergedCellsCollection=class lr{constructor(t){_classPrivateMethodInitSpec$7(this,_MergedCellsCollection_brand),_defineProperty$19(this,"plugin",void 0),_defineProperty$19(this,"mergedCells",[]),_defineProperty$19(this,"mergedCellsMatrix",new Map),_defineProperty$19(this,"hot",void 0),this.plugin=t,this.hot=t.hot}static IS_OVERLAPPING_WARNING(t){let{row:i,col:r}=t;return toSingleLine`The merged cell declared at [${i}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(t,i){var r;return this.mergedCellsMatrix.has(t)&&(r=this.mergedCellsMatrix.get(t).get(i))!==null&&r!==void 0?r:!1}getByRange(t){let i=!1;return arrayEach$1(this.mergedCells,r=>r.row<=t.from.row&&r.row+r.rowspan-1>=t.to.row&&r.col<=t.from.col&&r.col+r.colspan-1>=t.to.col?(i=r,i):!0),i}filterOverlappingMergeCells(t){const i=new Set;return this.mergedCells.forEach(o=>{const{row:a,col:c,colspan:u,rowspan:h}=o;for(let d=a;d<a+h;d++)for(let f=c;f<c+u;f++)i.add(`r${d},c${f}`)}),t.filter(o=>{const{row:a,col:c,colspan:u,rowspan:h}=o,d=new Set;let f=!1;for(let m=a;m<a+h;m++){for(let g=c;g<c+u;g++){const v=`r${m},c${g}`;if(i.has(v)){warn(lr.IS_OVERLAPPING_WARNING(o)),f=!0;break}d.add(v)}if(f)break}return f||i.add(...d),!f})}getWithinRange(t){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:o}=t.getTopStartCorner(),{row:a,col:c}=t.getBottomEndCorner(),u=[];for(let h=r;h<=a;h++)for(let d=o;d<=c;d++){const f=this.get(h,d);f&&(i||!i&&f.row===h&&f.col===d)&&u.push(f)}return u}add(t){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=t.row,o=t.col,a=t.rowspan,c=t.colspan,u=new cellCoords_default(r,o,a,c,this.hot._createCellCoords,this.hot._createCellRange),h=this.get(r,o),d=i?!1:this.isOverlapping(u);return!h&&!d?(this.hot&&u.normalize(this.hot),this.mergedCells.push(u),_assertClassBrand$11(_MergedCellsCollection_brand,this,_addMergedCellToMatrix).call(this,u),u):(warn(lr.IS_OVERLAPPING_WARNING(u)),!1)}remove(t,i){const r=this.get(t,i),o=r?this.mergedCells.indexOf(r):-1;return r&&o!==-1?(this.mergedCells.splice(o,1),_assertClassBrand$11(_MergedCellsCollection_brand,this,_removeMergedCellFromMatrix).call(this,r),r):!1}clear(){arrayEach$1(this.mergedCells,t=>{let{row:i,col:r,rowspan:o,colspan:a}=t;rangeEach(i,i+o,c=>{rangeEach(r,r+a,u=>{const h=this.hot.getCell(c,u);h&&(h.removeAttribute("rowspan"),h.removeAttribute("colspan"),h.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(t){const i=t.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(i))return!0;return!1}isFirstRenderableMergedCell(t,i){const r=this.get(t,i);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===t&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===i}getFirstRenderableCoords(t,i){const r=this.get(t,i);if(!r||this.isFirstRenderableMergedCell(t,i))return this.hot._createCellCoords(t,i);const o=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(o,a)}getStartMostColumnIndex(t,i){const r=_assertClassBrand$11(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,t,"col",-1);let o=i;for(let a=0;a<r.length;a++)if(r[a]<=i){o=r[a];break}return o}getEndMostColumnIndex(t,i){const r=_assertClassBrand$11(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,t,"col",1);let o=i;for(let a=0;a<r.length;a++)if(r[a]>=i){o=r[a];break}return o}getTopMostRowIndex(t,i){const r=_assertClassBrand$11(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,t,"row",-1);let o=i;for(let a=0;a<r.length;a++)if(r[a]<=i){o=r[a];break}return o}getBottomMostRowIndex(t,i){const r=_assertClassBrand$11(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,t,"row",1);let o=i;for(let a=0;a<r.length;a++)if(r[a]>=i){o=r[a];break}return o}shiftCollections(t,i,r){const o=[0,0];switch(t){case"right":o[0]+=r;break;case"left":o[0]-=r;break;case"down":o[1]+=r;break;case"up":o[1]-=r;break;default:}const a=[];this.mergedCells.forEach(c=>{c.shift(o,i),c.removed&&a.push(c)}),a.forEach(c=>{this.mergedCells.splice(this.mergedCells.indexOf(c),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(c=>{_assertClassBrand$11(_MergedCellsCollection_brand,this,_addMergedCellToMatrix).call(this,c)})}};function _getNonIntersectingIndexes(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,o=i===1?e.getTopStartCorner():e.getBottomEndCorner(),a=i===1?e.getBottomEndCorner():e.getTopStartCorner();for(let c=o.row;i===1?c<=a.row:c>=a.row;c+=i)for(let u=o.col;i===1?u<=a.col:u>=a.col;u+=i){const h=t==="row"?c:u,d=this.get(c,u);let f=h;d&&(f=i===1?d[t]+d[`${t}span`]-1:d[t]),r.has(h)||r.set(h,new Set),r.get(h).add(f)}return Array.from(new Set(Array.from(r.entries()).filter(c=>{let[,u]=c;return u.size===1}).flatMap(c=>{let[,u]=c;return Array.from(u)})))}function _addMergedCellToMatrix(e){for(let t=e.row;t<e.row+e.rowspan;t++)for(let i=e.col;i<e.col+e.colspan;i++)this.mergedCellsMatrix.has(t)||this.mergedCellsMatrix.set(t,new Map),this.mergedCellsMatrix.get(t).set(i,e)}function _removeMergedCellFromMatrix(e){for(let t=e.row;t<e.row+e.rowspan;t++)for(let i=e.col;i<e.col+e.colspan;i++)this.mergedCellsMatrix.get(t).delete(i)}var cellsCollection_default=MergedCellsCollection,import_es_error_cause$26=__toESM(require_es_error_cause(),1);function _defineProperty$18(e,t,i){return(t=_toPropertyKey$19(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$19(e){var t=_toPrimitive$19(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$19(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AutofillCalculations=class{constructor(e){_defineProperty$18(this,"plugin",void 0),_defineProperty$18(this,"mergedCellsCollection",void 0),_defineProperty$18(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}getDirection(e,t){let i=null;return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?i="down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?i="up":t[1]===e[1]&&t[2]===e[2]?i="right":i="left",i}snapDragArea(e,t,i,r){const o=t.slice(0),a=this.getAutofillSize(e,t,i),[c,u,h,d]=e,m=["up","down"].indexOf(i)>-1?h-c+1:d-u+1,g=Math.floor(a/m)*m,v=a-g,_=this.getFarthestCollection(e,t,i,r);if(_){if(i==="down"){const b=_.row+_.rowspan-c-v;o[2]+b>=this.plugin.hot.countRows()?o[2]-=v:o[2]+=v?b:0}else if(i==="right"){const b=_.col+_.colspan-u-v;o[3]+b>=this.plugin.hot.countCols()?o[3]-=v:o[3]+=v?b:0}else if(i==="up"){const b=h-v-_.row+1;o[0]+b<0?o[0]+=v:o[0]-=v?b:0}else if(i==="left"){const b=d-v-_.col+1;o[1]+b<0?o[1]+=v:o[1]-=v?b:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:i,foundMergedCells:r,fillSize:a,dragArea:o,cycleLength:m}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),extend$2(this.currentFillData,e)}getAutofillSize(e,t,i){const[r,o,a,c]=e,[u,h,d,f]=t;switch(i){case"up":return r-u;case"down":return d-a;case"left":return o-h;case"right":return f-c;default:return null}}getDragArea(e,t,i){const[r,o,a,c]=e,[u,h,d,f]=t;switch(i){case"up":return[u,h,r-1,c];case"down":return[a+1,o,d,c];case"left":return[u,h,a,o-1];case"right":return[r,c+1,d,f];default:return null}}getFarthestCollection(e,t,i,r){const[o,a,c,u]=e,h=["up","down"].indexOf(i)>-1,d=h?c:u,f=h?o:a,m=this.getAutofillSize(e,t,i),g=h?c-o+1:u-a+1,v=Math.floor(m/g)*g,_=m-v;let b=null,S=null,T=null;switch(i){case"up":b="includesVertically",T=d-_+1;break;case"left":b="includesHorizontally",T=d-_+1;break;case"down":b="includesVertically",T=f+_-1;break;case"right":b="includesHorizontally",T=f+_-1;break;default:}return arrayEach$1(r,A=>{A[b](T)&&A.isFarther(S,i)&&(S=A)}),S}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),i=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,o=(h,d)=>{switch(r){case"up":return h.row-d>=t.from.row;case"down":return h.row+h.rowspan-1+d<=t.to.row;case"left":return h.col-d>=t.from.column;case"right":return h.col+h.colspan-1+d<=t.to.column;default:return null}};let a=0,c=null,u=1;do for(let h=0;h<i.length;h+=1){if(c=i[h],a=u*this.currentFillData.cycleLength,o(c,a))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:c.row-a,rowspan:c.rowspan,col:c.col,colspan:c.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:c.row+a,rowspan:c.rowspan,col:c.col,colspan:c.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:c.row,rowspan:c.rowspan,col:c.col-a,colspan:c.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:c.row,rowspan:c.rowspan,col:c.col+a,colspan:c.colspan});break;default:}h===i.length-1&&(u+=1)}while(o(c,a));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},i={min:null,max:null};return arrayEach$1(e,r=>{const o=r[0],a=this.plugin.hot.propToCol(r[1]);(t.min===null||o<t.min)&&(t.min=o),(t.max===null||o>t.max)&&(t.max=o),(i.min===null||a<i.min)&&(i.min=a),(i.max===null||a>i.max)&&(i.max=a)}),{from:{row:t.min,column:i.min},to:{row:t.max,column:i.max}}}dragAreaOverlapsCollections(e,t,i){const r=this.getDragArea(e,t,i),[o,a,c,u]=r,h=this.plugin.hot._createCellCoords(o,a),d=this.plugin.hot._createCellCoords(c,u),f=this.plugin.hot._createCellRange(h,h,d);return this.mergedCellsCollection.getWithinRange(f,!0).length>0}},autofill_default=AutofillCalculations,import_es_error_cause$25=__toESM(require_es_error_cause(),1),import_es_array_push$20=__toESM(require_es_array_push(),1);function _defineProperty$17(e,t,i){return(t=_toPropertyKey$18(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$18(e){var t=_toPrimitive$18(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$18(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SelectionCalculations=class{constructor(e){_defineProperty$17(this,"plugin",void 0),_defineProperty$17(this,"hot",void 0),_defineProperty$17(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,t,i,r){const o=Math.min(i[0],i[2]),a=Math.min(i[1],i[3]),c=Math.max(i[0],i[2]),u=Math.max(i[1],i[3]);if(r===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const d=this.plugin.mergedCellsCollection.get(e,t);if(!d)return;const f=d.getLastRow(),m=d.getLastColumn();if(o<=d.row&&a<=d.col&&c>=f&&u>=m)return`${this.fullySelectedMergedCellClassName}-${r}`;if(this.isMergeCellFullySelected(d,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,t){const i=[];if(!t||!e)return!1;for(let r=0;r<e.rowspan;r+=1)for(let o=0;o<e.colspan;o+=1)i.push(this.hot._createCellCoords(e.row+r,e.col+o));for(let r=0;r<i.length;r+=1){const o=[];for(let a=0;a<t.length;a+=1)o[a]=t[a].includes(i[r]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}},selection_default=SelectionCalculations;function toggleMergeItem(e){return{key:"mergeCells",name(){const t=this.getSelectedLast();if(t){const i=e.mergedCellsCollection.get(t[0],t[1]);if(i.row===t[0]&&i.col===t[1]&&i.row+i.rowspan-1===t[2]&&i.col+i.colspan-1===t[3])return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_MERGE_CELLS)},callback(){const t=this.getSelectedRangeLast();if(!t)return;t.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:i,to:r}=t;e.toggleMerge(t),this.selectCell(i.row,i.col,r.row,r.col,!1)},disabled(){const t=this.getSelectedLast();return t?cellCoords_default.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}var import_es_error_cause$24=__toESM(require_es_error_cause(),1);function _defineProperty$16(e,t,i){return(t=_toPropertyKey$17(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$17(e){var t=_toPrimitive$17(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$17(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NodeStructure=class{constructor(e){_defineProperty$16(this,"data",void 0),_defineProperty$16(this,"next",null),_defineProperty$16(this,"prev",null),this.data=e}},LinkedList=class{constructor(){_defineProperty$16(this,"first",null),_defineProperty$16(this,"last",null)}push(e){const t=new NodeStructure(e);if(this.first===null)this.first=t,this.last=t;else{const i=this.last;this.last=t,t.prev=i,i.next=t}return t}unshift(e){const t=new NodeStructure(e);if(this.first===null)this.first=t,this.last=t;else{const i=this.first;this.first=t,t.next=i,i.prev=t}}inorder(e){let t=this.first;for(;t;){const i=e(t);if(t===this.last||i===!0)break;t=t.next}}remove(e){if(this.first===null)return!1;let t=this.first,i,r;for(;t;){if(t.data===e)return i=t.next,r=t.prev,i&&(i.prev=r),r&&(r.next=i),t===this.first&&(this.first=i),t===this.last&&(this.last=r),!0;t=t.next}return!1}hasCycle(){let e=this.first,t=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,t=t.next,e===t)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(i,r){r&&(e(r,r.next),r.next=i)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const t=this.first;this.first=this.last,this.last=t}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,t=this.first,i;for(;e;)i=e.next,e.next=t,t.prev=e,t=e,e=i;this.first.next=null,this.last.prev=null,i=this.first,this.first=t,this.last=i}},linkedList_default=LinkedList,import_es_error_cause$23=__toESM(require_es_error_cause(),1),import_es_array_push$19=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$6(e,t){_checkPrivateRedeclaration$10(e,t),t.add(e)}function _classPrivateFieldInitSpec$7(e,t,i){_checkPrivateRedeclaration$10(e,t),t.set(e,i)}function _checkPrivateRedeclaration$10(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$7(e,t){return e.get(_assertClassBrand$10(e,t))}function _classPrivateFieldSet$6(e,t,i){return e.set(_assertClassBrand$10(e,t),i),i}function _assertClassBrand$10(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _cellsHorizontalOrder=new WeakMap,_cellsVerticalOrder=new WeakMap,_currentHorizontalLinkedNode=new WeakMap,_currentVerticalLinkedNode=new WeakMap,_mergedCellsGetter=new WeakMap,_rowIndexMapper=new WeakMap,_columnIndexMapper=new WeakMap,_FocusOrder_brand=new WeakSet,FocusOrder=class{constructor(e){let{mergedCellsGetter:t,rowIndexMapper:i,columnIndexMapper:r}=e;_classPrivateMethodInitSpec$6(this,_FocusOrder_brand),_classPrivateFieldInitSpec$7(this,_cellsHorizontalOrder,new linkedList_default),_classPrivateFieldInitSpec$7(this,_cellsVerticalOrder,new linkedList_default),_classPrivateFieldInitSpec$7(this,_currentHorizontalLinkedNode,null),_classPrivateFieldInitSpec$7(this,_currentVerticalLinkedNode,null),_classPrivateFieldInitSpec$7(this,_mergedCellsGetter,null),_classPrivateFieldInitSpec$7(this,_rowIndexMapper,null),_classPrivateFieldInitSpec$7(this,_columnIndexMapper,null),_classPrivateFieldSet$6(_mergedCellsGetter,this,t),_classPrivateFieldSet$6(_rowIndexMapper,this,i),_classPrivateFieldSet$6(_columnIndexMapper,this,r)}getCurrentVerticalNode(){return _classPrivateFieldGet$7(_currentVerticalLinkedNode,this).data}getFirstVerticalNode(){return _classPrivateFieldGet$7(_cellsVerticalOrder,this).first.data}getNextVerticalNode(){return _classPrivateFieldGet$7(_currentVerticalLinkedNode,this).next.data}getPrevVerticalNode(){return _classPrivateFieldGet$7(_currentVerticalLinkedNode,this).prev.data}getCurrentHorizontalNode(){return _classPrivateFieldGet$7(_currentHorizontalLinkedNode,this).data}getFirstHorizontalNode(){return _classPrivateFieldGet$7(_cellsHorizontalOrder,this).first.data}getNextHorizontalNode(){return _classPrivateFieldGet$7(_currentHorizontalLinkedNode,this).next.data}getPrevHorizontalNode(){return _classPrivateFieldGet$7(_currentHorizontalLinkedNode,this).prev.data}setPrevNodeAsActive(){_classPrivateFieldSet$6(_currentVerticalLinkedNode,this,_classPrivateFieldGet$7(_currentVerticalLinkedNode,this).prev),_classPrivateFieldSet$6(_currentHorizontalLinkedNode,this,_classPrivateFieldGet$7(_currentHorizontalLinkedNode,this).prev)}setNextNodeAsActive(){_classPrivateFieldSet$6(_currentVerticalLinkedNode,this,_classPrivateFieldGet$7(_currentVerticalLinkedNode,this).next),_classPrivateFieldSet$6(_currentHorizontalLinkedNode,this,_classPrivateFieldGet$7(_currentHorizontalLinkedNode,this).next)}buildFocusOrder(e){const t=e.getTopStartCorner(),i=e.getBottomEndCorner(),r=new WeakSet;_classPrivateFieldSet$6(_cellsHorizontalOrder,this,new linkedList_default);for(let a=t.row;a<=i.row;a++)if(!_classPrivateFieldGet$7(_rowIndexMapper,this).isHidden(a))for(let c=t.col;c<=i.col;c++){if(_classPrivateFieldGet$7(_columnIndexMapper,this).isHidden(c))continue;const u=_assertClassBrand$10(_FocusOrder_brand,this,_pushOrderNode).call(this,e,_classPrivateFieldGet$7(_cellsHorizontalOrder,this),r,a,c);u&&_classPrivateFieldSet$6(_currentHorizontalLinkedNode,this,u)}_classPrivateFieldGet$7(_cellsHorizontalOrder,this).first&&(_classPrivateFieldGet$7(_cellsHorizontalOrder,this).first.prev=_classPrivateFieldGet$7(_cellsHorizontalOrder,this).last,_classPrivateFieldGet$7(_cellsHorizontalOrder,this).last.next=_classPrivateFieldGet$7(_cellsHorizontalOrder,this).first);const o=new WeakSet;_classPrivateFieldSet$6(_cellsVerticalOrder,this,new linkedList_default);for(let a=t.col;a<=i.col;a++)if(!_classPrivateFieldGet$7(_columnIndexMapper,this).isHidden(a))for(let c=t.row;c<=i.row;c++){if(_classPrivateFieldGet$7(_rowIndexMapper,this).isHidden(c))continue;const u=_assertClassBrand$10(_FocusOrder_brand,this,_pushOrderNode).call(this,e,_classPrivateFieldGet$7(_cellsVerticalOrder,this),o,c,a);u&&_classPrivateFieldSet$6(_currentVerticalLinkedNode,this,u)}_classPrivateFieldGet$7(_cellsVerticalOrder,this).first&&(_classPrivateFieldGet$7(_cellsVerticalOrder,this).first.prev=_classPrivateFieldGet$7(_cellsVerticalOrder,this).last,_classPrivateFieldGet$7(_cellsVerticalOrder,this).last.next=_classPrivateFieldGet$7(_cellsVerticalOrder,this).first)}setActiveNode(e,t){return _classPrivateFieldGet$7(_cellsHorizontalOrder,this).inorder(i=>{const{rowStart:r,rowEnd:o,colStart:a,colEnd:c}=i.data;if(e>=r&&e<=o&&t>=a&&t<=c)return _classPrivateFieldSet$6(_currentHorizontalLinkedNode,this,i),!1}),_classPrivateFieldGet$7(_cellsVerticalOrder,this).inorder(i=>{const{rowStart:r,rowEnd:o,colStart:a,colEnd:c}=i.data;if(e>=r&&e<=o&&t>=a&&t<=c)return _classPrivateFieldSet$6(_currentVerticalLinkedNode,this,i),!1}),this}};function _pushOrderNode(e,t,i,r,o){const a=e.getTopStartCorner(),c=e.getBottomEndCorner(),u=e.highlight.clone().normalize(),h=_classPrivateFieldGet$7(_mergedCellsGetter,this).call(this,r,o);if(h&&i.has(h))return null;const d={colStart:o,colEnd:o,rowStart:r,rowEnd:r};if(h){if(i.add(h),h.row<a.row||h.row+h.rowspan-1>c.row||h.col<a.col||h.col+h.colspan-1>c.col)return null;d.colStart=h.col,d.colEnd=h.col+h.colspan-1,d.rowStart=h.row,d.rowEnd=h.row+h.rowspan-1}const f=t.push(d);return r===u.row&&o===u.col||h&&u.row>=h.row&&u.row<=h.row+h.rowspan-1&&u.col>=h.col&&u.col<=h.col+h.colspan-1?f:null}function createMergeCellRenderer(e){const{hot:t}=e,{rowIndexMapper:i,columnIndexMapper:r}=t;function o(){}function a(c,u,h){const d=e.mergedCellsCollection.get(u,h);if(!isObject$4(d)){c.removeAttribute("rowspan"),c.removeAttribute("colspan"),c.style.display="";return}const{row:f,col:m,colspan:g,rowspan:v}=d,[_,b]=e.translateMergedCellToRenderable(f,v,m,g),S=i.getRenderableFromVisualIndex(u),T=r.getRenderableFromVisualIndex(h),A=_-S+1,I=b-T+1,R=i.getNearestNotHiddenIndex(f,1),O=r.getNearestNotHiddenIndex(m,1),P=Math.min(v,A),L=Math.min(g,I);R===u&&O===h?(c.setAttribute("rowspan",P),c.setAttribute("colspan",L)):(c.removeAttribute("rowspan"),c.removeAttribute("colspan"),c.style.display="none")}return{before:o,after:a}}var import_es_error_cause$22=__toESM(require_es_error_cause(),1),import_es_array_push$18=__toESM(require_es_array_push(),1),import_es_set_difference_v2$4=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$4=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$4=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$4=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$4=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$4=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$4=__toESM(require_es_set_union_v2(),1);function _classPrivateMethodInitSpec$5(e,t){_checkPrivateRedeclaration$9(e,t),t.add(e)}function _classPrivateFieldInitSpec$6(e,t,i){_checkPrivateRedeclaration$9(e,t),t.set(e,i)}function _checkPrivateRedeclaration$9(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$15(e,t,i){return(t=_toPropertyKey$16(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$16(e){var t=_toPrimitive$16(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$16(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldSet$5(e,t,i){return e.set(_assertClassBrand$9(e,t),i),i}function _classPrivateFieldGet$6(e,t){return e.get(_assertClassBrand$9(e,t))}function _assertClassBrand$9(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}pluginHooks_default.getSingleton().register("beforeMergeCells"),pluginHooks_default.getSingleton().register("afterMergeCells"),pluginHooks_default.getSingleton().register("beforeUnmergeCells"),pluginHooks_default.getSingleton().register("afterUnmergeCells");const PLUGIN_KEY$9="mergeCells",PLUGIN_PRIORITY$8=150,SHORTCUTS_GROUP$3=PLUGIN_KEY$9;var _lastSelectedFocus=new WeakMap,_lastFocusDelta=new WeakMap,_focusOrder=new WeakMap,_cellRenderer=new WeakMap,_MergeCells_brand=new WeakSet,MergeCells=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$5(this,_MergeCells_brand),_defineProperty$15(this,"mergedCellsCollection",null),_defineProperty$15(this,"autofillCalculations",null),_defineProperty$15(this,"selectionCalculations",null),_classPrivateFieldInitSpec$6(this,_lastSelectedFocus,null),_classPrivateFieldInitSpec$6(this,_lastFocusDelta,{row:0,col:0}),_classPrivateFieldInitSpec$6(this,_focusOrder,new FocusOrder({mergedCellsGetter:(e,t)=>this.mergedCellsCollection.get(e,t),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),_classPrivateFieldInitSpec$6(this,_cellRenderer,createMergeCellRenderer(this))}static get PLUGIN_KEY(){return PLUGIN_KEY$9}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$8}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$9]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new cellsCollection_default(this),this.autofillCalculations=new autofill_default(this),this.selectionCalculations=new selection_default(this),this.addHook("afterInit",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onAfterInit$1).call(e,...i)}),this.addHook("modifyTransformFocus",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onModifyTransformFocus).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onModifyTransformStart$1).call(e,...i)}),this.addHook("modifyTransformEnd",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onModifyTransformEnd).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onBeforeSelectionHighlightSet$1).call(e,...i)}),this.addHook("beforeSetRangeStart",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onBeforeSetRangeStart).call(e,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onBeforeSetRangeStart).call(e,...i)}),this.addHook("beforeSelectionFocusSet",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onBeforeSelectionFocusSet).call(e,...i)}),this.addHook("afterSelectionFocusSet",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onAfterSelectionFocusSet).call(e,...i)}),this.addHook("afterSelectionEnd",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onAfterSelectionEnd).call(e,...i)}),this.addHook("modifyGetCellCoords",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onModifyGetCellCoords).call(e,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onAfterIsMultipleSelection).call(e,...i)}),this.addHook("afterRenderer",function(){return _classPrivateFieldGet$6(_cellRenderer,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_addMergeActionsToContextMenu).call(e,...i)}),this.addHook("afterGetCellMeta",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onAfterGetCellMeta).call(e,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onAfterViewportRowCalculatorOverride).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onAfterViewportColumnCalculatorOverride$1).call(e,...i)}),this.addHook("modifyAutofillRange",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onModifyAutofillRange).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onAfterCreateCol).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onAfterRemoveCol).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onAfterCreateRow$1).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onAfterRemoveRow$1).call(e,...i)}),this.addHook("afterChange",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onAfterChange).call(e,...i)}),this.addHook("beforeDrawBorders",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onBeforeDrawAreaBorders).call(e,...i)}),this.addHook("afterDrawSelection",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onAfterDrawSelection).call(e,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onBeforeRemoveCellClassNames).call(e,...i)}),this.addHook("beforeBeginEditing",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onBeforeBeginEditing).call(e,...i)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$9(_MergeCells_brand,e,_onModifyRowHeightByOverlayName).call(e,...i)}),this.addHook("beforeUndoStackChange",(t,i)=>{if(i==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[PLUGIN_KEY$9];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!isChrome())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach(i=>{const{row:r,rowspan:o}=i;for(let a=r+1;a<r+o;a++)t.push(a)}),t=[...new Set(t)],t.forEach(i=>{const r=this.hot.rowIndexMapper.getRenderableFromVisualIndex(i);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>o?.name==="master"?o:o.clone.wtTable).forEach(o=>{const a=o.getRow(r);a&&(a.style.background=getStyle(a,"backgroundColor").replace(")",", 0.99)"),e.push(a))})}),this.hot._registerTimeout(()=>{e.forEach(i=>{i.style.background=getStyle(i,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){return e?cellCoords_default.containsNegativeValues(e)?(warn(cellCoords_default.NEGATIVE_VALUES_WARNING(e)),!1):cellCoords_default.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(warn(cellCoords_default.IS_OUT_OF_BOUNDS_WARNING(e)),!1):cellCoords_default.isSingleCell(e)?(warn(cellCoords_default.IS_SINGLE_CELL(e)),!1):cellCoords_default.containsZeroSpan(e)?(warn(cellCoords_default.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(e){if(!Array.isArray(e))return;const t=e.filter(o=>this.validateSetting(o)),i=this.mergedCellsCollection.filterOverlappingMergeCells(t),r=[];i.forEach(o=>{const{row:a,col:c,rowspan:u,colspan:h}=o,d=this.hot._createCellCoords(a,c),f=this.hot._createCellCoords(a+u-1,c+h-1),m=this.hot._createCellRange(d,d,f);this.mergeRange(m,!0,!0);for(let g=a;g<a+u;g++)for(let v=c;v<c+h;v++)(g!==a||v!==c)&&r.push([g,v,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:i}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,i.row,i.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:i}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,i.row,i.col,!1)}mergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=e.getTopStartCorner(),o=e.getBottomEndCorner(),a={row:r.row,col:r.col,rowspan:o.row-r.row+1,colspan:o.col-r.col+1},c=[];let u=null;return this.canMergeRange(a,t)?(this.hot.runHooks("beforeMergeCells",e,t),rangeEach(0,a.rowspan-1,d=>{rangeEach(0,a.colspan-1,f=>{let m=null;c[d]||(c[d]=[]),d===0&&f===0?m=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(a.row),this.hot.toPhysicalColumn(a.col)):this.hot.setCellMeta(a.row+d,a.col+f,"hidden",!0),c[d][f]=m})}),this.hot.setCellMeta(a.row,a.col,"spanned",!0),this.mergedCellsCollection.add(a,t)?(i?u=[a.row,a.col,c]:this.hot.populateFromArray(a.row,a.col,c,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,a,t),u):!0):!1}unmergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=this.mergedCellsCollection.getWithinRange(e);i.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,t),arrayEach$1(i,r=>{this.mergedCellsCollection.remove(r.row,r.col),rangeEach(0,r.rowspan-1,o=>{rangeEach(0,r.colspan-1,a=>{this.hot.removeCellMeta(r.row+o,r.col+a,"hidden"),this.hot.removeCellMeta(r.row+o,r.col+a,"copyable")})}),this.hot.removeCellMeta(r.row,r.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,i,r){const o=this.hot._createCellCoords(e,t),a=this.hot._createCellCoords(i,r);this.mergeRange(this.hot._createCellRange(o,o,a))}unmerge(e,t,i,r){const o=this.hot._createCellCoords(e,t),a=this.hot._createCellCoords(i,r);this.unmergeRange(this.hot._createCellRange(o,o,a))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const i=this.hot.getSelectedRangeLast();i&&!i.isSingleHeader()&&(this.toggleMerge(i),this.hot.render())},runOnlyIf:i=>!i.altKey,group:SHORTCUTS_GROUP$3})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$3)}modifyViewportRowStart(e,t){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<t;o+=1){const a=this.mergedCellsCollection.get(r,o);if(isObject$4(a)){const c=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a.row,1));if(c<e.startRow){e.startRow=c,this.modifyViewportRowStart(e,t);return}}}}modifyViewportRowEnd(e,t){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<t;o+=1){const a=this.mergedCellsCollection.get(r,o);if(isObject$4(a)){const c=a.row+a.rowspan-1,u=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(c,-1));if(u>e.endRow){e.endRow=u,this.modifyViewportRowEnd(e,t);return}}}}modifyViewportColumnStart(e,t){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<t;o+=1){const a=this.mergedCellsCollection.get(o,r);if(isObject$4(a)){const c=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a.col,1));if(c<e.startColumn){e.startColumn=c,this.modifyViewportColumnStart(e,t);return}}}}modifyViewportColumnEnd(e,t){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<t;o+=1){const a=this.mergedCellsCollection.get(o,r);if(isObject$4(a)){const c=a.col+a.colspan-1,u=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(c,-1));if(u>e.endColumn){e.endColumn=u,this.modifyViewportColumnEnd(e,t);return}}}}translateMergedCellToRenderable(e,t,i,r){const{rowIndexMapper:o,columnIndexMapper:a}=this.hot;let c,u;t===0?c=o.getNearestNotHiddenIndex(e,1):c=o.getNearestNotHiddenIndex(e+t-1,-1),r===0?u=a.getNearestNotHiddenIndex(i,1):u=a.getNearestNotHiddenIndex(i+r-1,-1);const h=e>=0?o.getRenderableFromVisualIndex(c):e,d=i>=0?a.getRenderableFromVisualIndex(u):i;return[h,d]}};function _onAfterInit$1(){this.generateFromSettings(this.hot.getSettings()[PLUGIN_KEY$9]),this.hot.render()}function _onAfterIsMultipleSelection(e){if(e){const t=this.mergedCellsCollection.mergedCells,i=this.hot.getSelectedRangeLast(),r=i.getTopStartCorner(),o=i.getBottomEndCorner();for(let a=0;a<t.length;a+=1)if(r.row===t[a].row&&r.col===t[a].col&&o.row===t[a].row+t[a].rowspan-1&&o.col===t[a].col+t[a].colspan-1)return!1}return e}function _onModifyTransformFocus(e){_classPrivateFieldGet$6(_lastFocusDelta,this).row=e.row,_classPrivateFieldGet$6(_lastFocusDelta,this).col=e.col}function _onModifyTransformStart$1(e){const t=this.hot.getSelectedRangeLast(),{highlight:i}=t,{columnIndexMapper:r,rowIndexMapper:o}=this.hot;_classPrivateFieldGet$6(_lastSelectedFocus,this)&&(o.getRenderableFromVisualIndex(_classPrivateFieldGet$6(_lastSelectedFocus,this).row)!==null&&(i.row=_classPrivateFieldGet$6(_lastSelectedFocus,this).row),r.getRenderableFromVisualIndex(_classPrivateFieldGet$6(_lastSelectedFocus,this).col)!==null&&(i.col=_classPrivateFieldGet$6(_lastSelectedFocus,this).col),_classPrivateFieldSet$5(_lastSelectedFocus,this,null));const a=this.mergedCellsCollection.get(i.row,i.col);if(!a)return;const c=a.col,u=a.col+a.colspan-1;if(e.col<0){const f=i.col>=c&&i.col<=u?c-1:u,m=r.getNearestNotHiddenIndex(f,-1);m===null?e.col=-this.hot.view.countRenderableColumnsInRange(0,i.col):e.col=-Math.max(this.hot.view.countRenderableColumnsInRange(m,i.col)-1,1)}else if(e.col>0){const f=i.col>=c&&i.col<=u?u+1:c,m=r.getNearestNotHiddenIndex(f,1);m===null?e.col=this.hot.view.countRenderableColumnsInRange(i.col,this.hot.countCols()):e.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,m)-1,1)}const h=a.row,d=a.row+a.rowspan-1;if(e.row<0){const f=i.row>=h&&i.row<=d?h-1:d,m=o.getNearestNotHiddenIndex(f,-1);m===null?e.row=-this.hot.view.countRenderableRowsInRange(0,i.row):e.row=-Math.max(this.hot.view.countRenderableRowsInRange(m,i.row)-1,1)}else if(e.row>0){const f=i.row>=h&&i.row<=d?d+1:h,m=o.getNearestNotHiddenIndex(f,1);m===null?e.row=this.hot.view.countRenderableRowsInRange(i.row,this.hot.countRows()):e.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,m)-1,1)}}function _onModifyTransformEnd(e){const t=this.hot.getSelectedRangeLast(),i=t.clone(),{to:r}=t,{columnIndexMapper:o,rowIndexMapper:a}=this.hot,c=(u,h)=>{i.expand(this.hot._createCellCoords(u,h));for(let d=0;d<this.mergedCellsCollection.mergedCells.length;d+=1)i.expandByRange(this.mergedCellsCollection.mergedCells[d].getRange())};if(e.col<0){let u=this.mergedCellsCollection.getStartMostColumnIndex(t,r.col)+e.col;c(r.row,u),t.getHorizontalDirection()==="E-W"&&i.getHorizontalDirection()==="E-W"&&(u=i.getTopStartCorner().col);const h=o.getNearestNotHiddenIndex(u,1);h!==null&&(e.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,r.col)-1,1))}else if(e.col>0){let u=this.mergedCellsCollection.getEndMostColumnIndex(t,r.col)+e.col;c(r.row,u),t.getHorizontalDirection()==="W-E"&&i.getHorizontalDirection()==="W-E"&&(u=i.getBottomEndCorner().col);const h=o.getNearestNotHiddenIndex(u,-1);h!==null&&(e.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,h)-1,1))}if(e.row<0){let u=this.mergedCellsCollection.getTopMostRowIndex(t,r.row)+e.row;c(u,r.col),t.getVerticalDirection()==="S-N"&&i.getVerticalDirection()==="S-N"&&(u=i.getTopStartCorner().row);const h=a.getNearestNotHiddenIndex(u,1);h!==null&&(e.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,r.row)-1,1))}else if(e.row>0){let u=this.mergedCellsCollection.getBottomMostRowIndex(t,r.row)+e.row;c(u,r.col),t.getVerticalDirection()==="N-S"&&i.getVerticalDirection()==="N-S"&&(u=i.getBottomStartCorner().row);const h=a.getNearestNotHiddenIndex(u,-1);h!==null&&(e.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,h)-1,1))}}function _onBeforeSelectionHighlightSet$1(){const e=this.hot.getSelectedRangeLast(),{highlight:t}=e;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){_classPrivateFieldSet$5(_lastSelectedFocus,this,t.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)e.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)e.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const i=this.mergedCellsCollection.get(t.row,t.col);_classPrivateFieldSet$5(_lastSelectedFocus,this,t.clone()),i&&t.assign(i)}function _onModifyGetCellCoords(e,t){if(e<0||t<0)return;const i=this.mergedCellsCollection.get(e,t);if(!i)return;const{row:r,col:o,colspan:a,rowspan:c}=i;return[r,o,r+c-1,o+a-1]}function _addMergeActionsToContextMenu(e){e.items.push({name:"---------"},toggleMergeItem(this))}function _onBeforeSetRangeStart(){_classPrivateFieldSet$5(_lastSelectedFocus,this,null)}function _onBeforeSelectionFocusSet(){if(_classPrivateFieldGet$6(_lastSelectedFocus,this).isCell())return;const e=this.hot.getSelectedRangeLast(),t=e.getVerticalDirection(),i=e.getHorizontalDirection(),r=_classPrivateFieldGet$6(_lastSelectedFocus,this).clone().normalize();_classPrivateFieldGet$6(_focusOrder,this).setActiveNode(r.row,r.col),_classPrivateFieldGet$6(_lastFocusDelta,this).row>0||_classPrivateFieldGet$6(_lastFocusDelta,this).col>0?_classPrivateFieldGet$6(_focusOrder,this).setPrevNodeAsActive():(i==="E-W"&&_classPrivateFieldGet$6(_lastFocusDelta,this).col<0||t==="S-N"&&_classPrivateFieldGet$6(_lastFocusDelta,this).row<0)&&_classPrivateFieldGet$6(_focusOrder,this).setNextNodeAsActive()}function _onAfterSelectionFocusSet(e,t){const i=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:o}=this.hot;let a=null,c=null;if(_classPrivateFieldGet$6(_lastFocusDelta,this).col<0){const{rowEnd:u,colEnd:h}=_classPrivateFieldGet$6(_focusOrder,this).getPrevHorizontalNode();c=r.getNearestNotHiddenIndex(h,-1),a=o.getNearestNotHiddenIndex(u,-1)}else if(_classPrivateFieldGet$6(_lastFocusDelta,this).col>0){const{rowStart:u,colStart:h}=_classPrivateFieldGet$6(_focusOrder,this).getNextHorizontalNode();c=r.getNearestNotHiddenIndex(h,1),a=o.getNearestNotHiddenIndex(u,1)}else if(_classPrivateFieldGet$6(_lastFocusDelta,this).row<0){const{rowEnd:u,colEnd:h}=_classPrivateFieldGet$6(_focusOrder,this).getPrevVerticalNode();c=r.getNearestNotHiddenIndex(h,-1),a=o.getNearestNotHiddenIndex(u,-1)}else if(_classPrivateFieldGet$6(_lastFocusDelta,this).row>0){const{rowStart:u,colStart:h}=_classPrivateFieldGet$6(_focusOrder,this).getNextVerticalNode();c=r.getNearestNotHiddenIndex(h,1),a=o.getNearestNotHiddenIndex(u,1)}if(a!==null||c!==null){const u=this.hot._createCellCoords(a,c),h=this.mergedCellsCollection.get(u.row,u.col),d=this.hot.selection.highlight.getFocus();e=u.row,t=u.col,h?i.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(h.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(h.col,1)}):i.highlight.assign(u),d.clear(),d.add(u).commit()}_classPrivateFieldGet$6(_focusOrder,this).setActiveNode(e,t),_classPrivateFieldSet$5(_lastFocusDelta,this,{row:0,col:0})}function _onAfterSelectionEnd(){this.hot.getSelectedRangeLast().isHeader()||_classPrivateFieldGet$6(_focusOrder,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function _onAfterGetCellMeta(e,t,i){const r=this.mergedCellsCollection.get(e,t);r&&(r.row!==e||r.col!==t?i.copyable=!1:(i.rowspan=r.rowspan,i.colspan=r.colspan))}function _onAfterViewportRowCalculatorOverride(e){const t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}function _onAfterViewportColumnCalculatorOverride$1(e){const t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}function _onModifyAutofillRange(e,t){this.autofillCalculations.correctSelectionAreaSize(t);const i=this.autofillCalculations.getDirection(t,e);let r=e;if(this.autofillCalculations.dragAreaOverlapsCollections(t,r,i))return r=t,r;const o=this.hot._createCellCoords(t[0],t[1]),a=this.hot._createCellCoords(t[2],t[3]),c=this.hot._createCellRange(o,o,a),u=this.mergedCellsCollection.getWithinRange(c);return u.length===0||(r=this.autofillCalculations.snapDragArea(t,r,i,u)),r}function _onAfterCreateCol(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}function _onAfterRemoveCol(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}function _onAfterCreateRow$1(e,t,i){i!=="auto"&&this.mergedCellsCollection.shiftCollections("down",e,t)}function _onAfterRemoveRow$1(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}function _onAfterChange(e,t){t==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(e)}function _onBeforeDrawAreaBorders(e,t){if(t&&t==="area"){const i=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(i);arrayEach$1(r,o=>{i.getBottomEndCorner().row===o.getLastRow()&&i.getBottomEndCorner().col===o.getLastColumn()&&(e[2]=o.row,e[3]=o.col)})}}function _onAfterDrawSelection(e,t,i,r){if(i)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,i,r)}function _onBeforeRemoveCellClassNames(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function _onBeforeBeginEditing(e,t,i,r){if(!(r instanceof MouseEvent))return;const o=this.hot.getSelectedRangeLast(),a=this.mergedCellsCollection.getByRange(o);if(!a)return;const c=this.hot._createCellCoords(a.row,a.col),u=this.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1);return this.hot.selection.getLayerLevel()===0&&o.isEqual(this.hot._createCellRange(c,c,u))}function _onModifyRowHeightByOverlayName(e,t,i){if(this.hot.getSettings().rowHeaders||i==="bottom"||i==="bottom_inline_start_corner")return e;let r,o;if(i==="master")r=this.hot.view.getFirstRenderedVisibleColumn(),o=this.hot.view.getLastRenderedVisibleColumn();else{const g=this.hot.view.getOverlayByName(i);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(g.clone.wtTable.getFirstRenderedColumn()),o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(g.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(t,r))return e;const c=this.hot._createCellCoords(t,r),u=this.hot._createCellCoords(t,o),h=this.hot._createCellRange(c,c,u),d=this.mergedCellsCollection.getWithinRange(h),f=d.reduce((g,v)=>{let{rowspan:_}=v;return Math.max(g,_)},1);let m=0;return d.length>1&&d[0].rowspan<f&&(m=f-d[0].rowspan),d.forEach(g=>{var v;let{rowspan:_}=g,b=0;i==="top"||i==="top_inline_start_corner"?b=Math.min(f,this.hot.view.countNotHiddenFixedRowsTop()-t):b=_-m,e=Math.max((v=e)!==null&&v!==void 0?v:0,_assertClassBrand$9(_MergeCells_brand,this,_sumCellsHeights).call(this,t,b))}),e}function _sumCellsHeights(e,t){const i=this.hot.view._wt.wtSettings.getSettingPure("defaultRowHeight"),r=this.hot.getPlugin("autoRowSize");let o=0;for(let c=e;c<e+t;c++)if(!this.hot.rowIndexMapper.isHidden(c)){var a;o+=(a=r?.getRowHeight(c))!==null&&a!==void 0?a:i}return o}function rootComparator(e,t){return function(i,r){const[,...o]=i,[,...a]=r;return function c(u){const h=e[u],d=t[u],f=o[u],m=a[u],g=d.multiColumnSorting,_=(g.compareFunctionFactory?g.compareFunctionFactory:getCompareFunctionFactory(d.type))(h,d,g)(f,m);if(_===DO_NOT_SWAP){const b=u+1;if(typeof t[b]<"u")return c(b)}return _}(0)}}function warnAboutPluginsConflict(){warn(toSingleLine`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}var import_es_array_push$17=__toESM(require_es_array_push(),1);const COLUMN_ORDER_PREFIX="sort";function getClassesToAdd(e,t,i){const r=[];return i===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&r.push(`${COLUMN_ORDER_PREFIX}-${e.getIndexOfColumnInSortQueue(t)+1}`),r}function getClassesToRemove(e){const t=e.className.split(" "),i=new RegExp(`^${COLUMN_ORDER_PREFIX}-[0-9]{1,2}$`);return t.filter(r=>i.test(r))}var import_es_error_cause$21=__toESM(require_es_error_cause(),1);function _defineProperty$14(e,t,i){return(t=_toPropertyKey$15(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$15(e){var t=_toPrimitive$15(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$15(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}const PLUGIN_KEY$8="multiColumnSorting",PLUGIN_PRIORITY$7=170,CONFLICTED_PLUGIN_KEY="columnSorting",SHORTCUTS_GROUP$2=PLUGIN_KEY$8;registerRootComparator(PLUGIN_KEY$8,rootComparator);var MultiColumnSorting=class extends ColumnSorting{constructor(){super(...arguments),_defineProperty$14(this,"pluginKey",PLUGIN_KEY$8)}static get PLUGIN_KEY(){return PLUGIN_KEY$8}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$7}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[CONFLICTED_PLUGIN_KEY]&&(warnAboutPluginsConflict(),this.hot.getPlugin(CONFLICTED_PLUGIN_KEY).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,APPEND_COLUMN_CONFIG_STRATEGY)),!1},runOnlyIf:()=>{var e,t;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(i)&&i.isHeader()},relativeToGroup:EDITOR_EDIT_GROUP,position:"before",group:SHORTCUTS_GROUP$2})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$2)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];super.updateHeaderClasses(e,...i),removeClass$1(e,getClassesToRemove(e)),this.enabled!==!1&&addClass$1(e,getClassesToAdd(...i))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[CONFLICTED_PLUGIN_KEY]&&warnAboutPluginsConflict(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,t){wasHeaderClickedProperly(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,APPEND_COLUMN_CONFIG_STRATEGY))):this.sort(this.getColumnNextConfig(t.col)))}},import_es_error_cause$20=__toESM(require_es_error_cause(),1),import_es_array_push$16=__toESM(require_es_array_push(),1);function _defineProperty$13(e,t,i){return(t=_toPropertyKey$14(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$14(e){var t=_toPrimitive$14(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$14(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}const PLUGIN_KEY$7="multipleSelectionHandles",PLUGIN_PRIORITY$6=160;var MultipleSelectionHandles=class extends BasePlugin{constructor(){super(...arguments),_defineProperty$13(this,"dragged",[]),_defineProperty$13(this,"lastSetCell",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$7}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$6}isEnabled(){return isMobileBrowser()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function i(r){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(r);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",r=>{let o;if(hasClass$1(r.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},r.preventDefault(),!1;if(hasClass$1(r.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},r.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchend",r=>{if(hasClass$1(r.target,"topSelectionHandle-HitArea"))return i.call(e,"top"),e.touchStartRange=void 0,r.preventDefault(),!1;if(hasClass$1(r.target,"bottomSelectionHandle-HitArea"))return i.call(e,"bottom"),e.touchStartRange=void 0,r.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchmove",r=>{const{rootDocument:o}=this.hot;let a,c,u,h,d,f;if(e.dragged.length===0)return;const m=o.elementFromPoint(r.touches[0].clientX,r.touches[0].clientY);!m||m===e.lastSetCell||((m.nodeName==="TD"||m.nodeName==="TH")&&(a=e.hot.getCoords(m),a.col===-1&&(a.col=0),c=e.hot.getSelectedRangeLast(),u=c.getWidth(),h=c.getHeight(),d=c.getDirection(),u===1&&h===1&&e.hot.selection.setRangeEnd(a),f=e.getCurrentRangeCoords(c,a,e.touchStartRange.direction,d,e.dragged[0]),f.start!==null&&e.hot.selection.setRangeStart(f.start),e.hot.selection.setRangeEnd(f.end),e.lastSetCell=m),r.preventDefault())})}getCurrentRangeCoords(e,t,i,r,o){const a=e.getTopStartCorner(),c=e.getBottomEndCorner(),u=e.getBottomStartCorner(),h=e.getTopEndCorner();let d={start:null,end:null};switch(i){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":o==="top"?d={start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(u.row,t.col)}:d={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,a.col)};break;case"SE-NW":o==="bottom"&&(d={start:this.hot._createCellCoords(c.row,t.col),end:this.hot._createCellCoords(t.row,a.col)});break;default:break}break;case"NW-SE":switch(r){case"NE-SW":o==="top"?d={start:t,end:u}:d.end=t;break;case"NW-SE":o==="top"?d={start:t,end:c}:d.end=t;break;case"SE-NW":o==="top"?d={start:t,end:a}:d.end=t;break;case"SW-NE":o==="top"?d={start:t,end:h}:d.end=t;break;default:break}break;case"SW-NE":switch(r){case"NW-SE":o==="bottom"?d={start:this.hot._createCellCoords(t.row,a.col),end:this.hot._createCellCoords(u.row,t.col)}:d={start:this.hot._createCellCoords(a.row,t.col),end:this.hot._createCellCoords(t.row,c.col)};break;case"SW-NE":o==="top"?d={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,c.col)}:d={start:this.hot._createCellCoords(t.row,a.col),end:this.hot._createCellCoords(a.row,t.col)};break;case"SE-NW":o==="bottom"?d={start:this.hot._createCellCoords(t.row,h.col),end:this.hot._createCellCoords(a.row,t.col)}:o==="top"&&(d={start:u,end:t});break;default:break}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(d.end=t);break;case"SE-NW":o==="top"?d.end=t:d={start:t,end:a};break;default:break}break;default:break}return d}isDragged(){return this.dragged.length>0}};function createDefaultHeaderSettings(){let{label:e="",colspan:t=1,origColspan:i=1,collapsible:r=!1,crossHiddenColumns:o=[],isCollapsed:a=!1,isHidden:c=!1,isRoot:u=!1,isPlaceholder:h=!1,headerClassNames:d=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:e,colspan:t,origColspan:i,collapsible:r,isCollapsed:a,crossHiddenColumns:o,isHidden:c,isRoot:u,isPlaceholder:h,headerClassNames:d}}function createPlaceholderHeaderSettings(){return{label:"",isPlaceholder:!0}}var import_es_array_push$15=__toESM(require_es_array_push(),1);function normalizeSettings(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const i=[];if(t===0)return i;arrayEach$1(e,o=>{const a=[];let c=0;i.push(a),arrayEach$1(o,u=>{const h=createDefaultHeaderSettings();if(isObject$4(u)){const{label:f,colspan:m,headerClassName:g}=u;h.label=stringify$3(f),typeof m=="number"&&m>1&&(h.colspan=m,h.origColspan=m),typeof g=="string"&&(h.headerClassNames=[...g.split(" ")])}else h.label=stringify$3(u);c+=h.origColspan;let d=!1;if(c>=t&&(h.colspan=h.origColspan-(c-t),h.origColspan=h.colspan,d=!0),a.push(h),h.colspan>1)for(let f=0;f<h.colspan-1;f++)a.push(createPlaceholderHeaderSettings());return!d})});const r=Math.max(...arrayMap$1(i,o=>o.length));return arrayEach$1(i,o=>{if(o.length<r){const a=arrayMap$1(new Array(r-o.length),()=>createDefaultHeaderSettings());o.splice(o.length,0,...a)}}),i}var import_es_error_cause$19=__toESM(require_es_error_cause(),1),import_es_array_push$14=__toESM(require_es_array_push(),1);function _classPrivateFieldInitSpec$5(e,t,i){_checkPrivateRedeclaration$8(e,t),t.set(e,i)}function _checkPrivateRedeclaration$8(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$5(e,t){return e.get(_assertClassBrand$8(e,t))}function _classPrivateFieldSet$4(e,t,i){return e.set(_assertClassBrand$8(e,t),i),i}function _assertClassBrand$8(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const HEADER_CONFIGURABLE_PROPS=["label","collapsible"];var _data=new WeakMap,_dataLength=new WeakMap,_columnsLimit=new WeakMap,SourceSettings=class{constructor(){_classPrivateFieldInitSpec$5(this,_data,[]),_classPrivateFieldInitSpec$5(this,_dataLength,0),_classPrivateFieldInitSpec$5(this,_columnsLimit,1/0)}setColumnsLimit(e){_classPrivateFieldSet$4(_columnsLimit,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];_classPrivateFieldSet$4(_data,this,normalizeSettings(e,_classPrivateFieldGet$5(_columnsLimit,this))),_classPrivateFieldSet$4(_dataLength,this,_classPrivateFieldGet$5(_data,this).length)}getData(){return _classPrivateFieldGet$5(_data,this)}mergeWith(e){arrayEach$1(e,t=>{let{row:i,col:r,...o}=t;const a=this.getHeaderSettings(i,r);a!==null&&extend$2(a,o,HEADER_CONFIGURABLE_PROPS)})}map(e){arrayEach$1(_classPrivateFieldGet$5(_data,this),t=>{arrayEach$1(t,i=>{const r=e({...i});isObject$4(r)&&extend$2(i,r,HEADER_CONFIGURABLE_PROPS)})})}getHeaderSettings(e,t){var i;if(e>=_classPrivateFieldGet$5(_dataLength,this)||e<0)return null;const r=_classPrivateFieldGet$5(_data,this)[e];return Array.isArray(r)===!1||t>=r.length?null:(i=r[t])!==null&&i!==void 0?i:null}getHeadersSettings(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=[];if(e>=_classPrivateFieldGet$5(_dataLength,this)||e<0)return r;const o=_classPrivateFieldGet$5(_data,this)[e];let a=0;for(let c=t;c<o.length;c++){const u=o[c];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(a+=u.colspan,r.push(u),u.colspan>1&&(c+=u.colspan-1),a===i)break;if(a>i)throw new Error("The last column settings cannot overlap the other header layers")}return r}getLayersCount(){return _classPrivateFieldGet$5(_dataLength,this)}getColumnsCount(){return _classPrivateFieldGet$5(_dataLength,this)>0?_classPrivateFieldGet$5(_data,this)[0].length:0}clear(){_classPrivateFieldSet$4(_data,this,[]),_classPrivateFieldSet$4(_dataLength,this,0)}},import_es_error_cause$18=__toESM(require_es_error_cause(),1),import_es_array_push$13=__toESM(require_es_array_push(),1);function _defineProperty$12(e,t,i){return(t=_toPropertyKey$13(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$13(e){var t=_toPrimitive$13(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$13(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}const TRAVERSAL_DF_PRE="DF-pre-order";function depthFirstPreOrder(e,t){let i=e.call(t,this);for(let r=0;r<this.childs.length;r++){if(i===!1)return!1;i=depthFirstPreOrder.call(this.childs[r],e,t)}return i}const TRAVERSAL_DF_POST="DF-post-order";function depthFirstPostOrder(e,t){for(let i=0;i<this.childs.length;i++)if(depthFirstPostOrder.call(this.childs[i],e,t)===!1)return!1;return e.call(t,this)}const TRAVERSAL_BF="BF";function breadthFirst(e,t){const i=[this];function r(){if(i.length===0)return;const o=i.shift();i.push(...o.childs),e.call(t,o)!==!1&&r()}r()}const DEFAULT_TRAVERSAL_STRATEGY=TRAVERSAL_BF,TRAVERSAL_STRATEGIES=new Map([[TRAVERSAL_DF_PRE,depthFirstPreOrder],[TRAVERSAL_DF_POST,depthFirstPostOrder],[TRAVERSAL_BF,breadthFirst]]);var TreeNode=class fs{constructor(t){_defineProperty$12(this,"data",{}),_defineProperty$12(this,"parent",null),_defineProperty$12(this,"childs",[]),this.data=t}addChild(t){t.parent=this,this.childs.push(t)}cloneTree(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const i=new fs({...t.data});for(let r=0;r<t.childs.length;r++)i.addChild(this.cloneTree(t.childs[r]));return i}replaceTreeWith(t){this.data={...t.data},this.childs=[];for(let i=0;i<t.childs.length;i++)this.addChild(t.childs[i])}walkDown(t){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DEFAULT_TRAVERSAL_STRATEGY;if(!TRAVERSAL_STRATEGIES.has(i))throw new Error(`Traversal strategy "${i}" does not exist`);TRAVERSAL_STRATEGIES.get(i).call(this,t,this)}walkUp(t){const i=this,r=o=>{t.call(i,o)!==!1&&o.parent!==null&&r(o.parent)};r(this)}},import_es_error_cause$17=__toESM(require_es_error_cause(),1);function _classPrivateFieldInitSpec$4(e,t,i){_checkPrivateRedeclaration$7(e,t),t.set(e,i)}function _checkPrivateRedeclaration$7(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$4(e,t){return e.get(_assertClassBrand$7(e,t))}function _classPrivateFieldSet$3(e,t,i){return e.set(_assertClassBrand$7(e,t),i),i}function _assertClassBrand$7(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _rootNodes=new WeakMap,_rootsIndex=new WeakMap,_sourceSettings$1=new WeakMap,HeadersTree=class{constructor(e){_classPrivateFieldInitSpec$4(this,_rootNodes,new Map),_classPrivateFieldInitSpec$4(this,_rootsIndex,new Map),_classPrivateFieldInitSpec$4(this,_sourceSettings$1,null),_classPrivateFieldSet$3(_sourceSettings$1,this,e)}getRoots(){return Array.from(_classPrivateFieldGet$4(_rootNodes,this).values())}getRootByColumn(e){let t;return _classPrivateFieldGet$4(_rootsIndex,this).has(e)&&(t=_classPrivateFieldGet$4(_rootNodes,this).get(_classPrivateFieldGet$4(_rootsIndex,this).get(e))),t}getNode(e,t){const i=this.getRootByColumn(t);if(!i)return;const r=t-_classPrivateFieldGet$4(_rootsIndex,this).get(t);let o=0,a;return i.walkDown(c=>{const{data:{origColspan:u,headerLevel:h}}=c;if(e===h){if(r>=o&&r<=o+u-1)return a=c,a.data.isRoot=t===a.data.columnIndex,!1;o+=u}}),a}rebuildTreeIndex(){let e=0;_classPrivateFieldGet$4(_rootsIndex,this).clear(),arrayEach$1(_classPrivateFieldGet$4(_rootNodes,this),t=>{let[,{data:{colspan:i}}]=t;for(let r=e;r<e+i;r++)_classPrivateFieldGet$4(_rootsIndex,this).set(r,e);e+=i})}buildTree(){this.clear();const e=_classPrivateFieldGet$4(_sourceSettings$1,this).getColumnsCount();let t=0;for(;t<e;){const i=_classPrivateFieldGet$4(_sourceSettings$1,this).getHeaderSettings(0,t),r=new TreeNode;_classPrivateFieldGet$4(_rootNodes,this).set(t,r),this.buildLeaves(r,t,0,i.origColspan),t+=i.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=_classPrivateFieldGet$4(_sourceSettings$1,this).getHeadersSettings(i,t,r);i+=1,arrayEach$1(o,a=>{const c={...a,headerLevel:i-1,columnIndex:t};let u;i===1?(e.data=c,u=e):(u=new TreeNode(c),e.addChild(u)),i<_classPrivateFieldGet$4(_sourceSettings$1,this).getLayersCount()&&this.buildLeaves(u,t,i,a.origColspan),t+=a.origColspan})}clear(){_classPrivateFieldGet$4(_rootNodes,this).clear(),_classPrivateFieldGet$4(_rootsIndex,this).clear()}};function traverseHiddenNodeColumnIndexes(e,t){e.walkDown(i=>{let{data:r,childs:o}=i;if(!r.isHidden&&(t(r.columnIndex),o.length===0))for(let a=1;a<r.colspan;a++)t(r.columnIndex+a)})}function getFirstChildProperty(e,t){let{childs:i}=e;if(i.length!==0)return i[0].data[t]}function isNodeReflectsFirstChildColspan(e){return getFirstChildProperty(e,"origColspan")===e.data.origColspan}var import_es_set_difference_v2$3=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$3=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$3=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$3=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$3=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$3=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$3=__toESM(require_es_set_union_v2(),1);function expandNode(e){const{data:t,childs:i}=e;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(isNodeReflectsFirstChildColspan(e))return expandNode(i[0]);t.isCollapsed=!1;const o=i.slice(1),a=new Set;let c=0;if(o.length>0)arrayEach$1(o,u=>{u.replaceTreeWith(u.data.clonedTree),u.data.clonedTree=null;const h=u.data;c+=h.colspan,traverseHiddenNodeColumnIndexes(u,d=>{a.add(d)})});else{const{colspan:u,origColspan:h,columnIndex:d}=t;c=h-u;for(let f=1;f<h;f++)a.add(d+f)}return e.walkUp(u=>{const{data:h}=u;h.colspan+=c,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):isNodeReflectsFirstChildColspan(u)&&(h.isCollapsed=getFirstChildProperty(u,"isCollapsed"))}),{rollbackModification:()=>collapseNode(e),affectedColumns:Array.from(a),colspanCompensation:c}}var import_es_set_difference_v2$2=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$2=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$2=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$2=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$2=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$2=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$2=__toESM(require_es_set_union_v2(),1);function collapseNode(e){var t;const{data:i,childs:r}=e;if(i.isCollapsed||i.isHidden||i.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(isNodeReflectsFirstChildColspan(e))return collapseNode(r[0]);i.isCollapsed=!0;const a=r.slice(1),c=new Set;if(a.length>0)arrayEach$1(a,h=>{traverseHiddenNodeColumnIndexes(h,d=>{c.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(d=>{let{data:f}=d;f.isHidden=!0})});else{const{origColspan:h,columnIndex:d}=i;for(let f=1;f<h;f++){const m=d+f;c.add(m)}}const u=i.colspan-((t=getFirstChildProperty(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(h=>{const{data:d}=h;d.colspan-=u,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):isNodeReflectsFirstChildColspan(h)&&(d.isCollapsed=getFirstChildProperty(h,"isCollapsed"))}),{rollbackModification:()=>expandNode(e),affectedColumns:Array.from(c),colspanCompensation:u}}var import_es_error_cause$16=__toESM(require_es_error_cause(),1),import_es_array_push$12=__toESM(require_es_array_push(),1);function hideColumn(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(toSingleLine`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:i}=e.data;if(i.includes(t))return;let r=!1;e.walkUp(o=>{const{data:{collapsible:a}}=o;if(a)return r=!0,!1}),!r&&e.walkUp(o=>{const{data:a}=o;a.crossHiddenColumns.push(t),a.colspan>1?a.colspan-=1:a.isHidden=!0})}var import_es_error_cause$15=__toESM(require_es_error_cause(),1);function showColumn(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(toSingleLine`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:i}=e.data;if(!i.includes(t))return;let r=!1;e.walkUp(o=>{const{data:{collapsible:a}}=o;if(a)return r=!0,!1}),!r&&e.walkUp(o=>{const{data:a}=o;a.crossHiddenColumns.splice(a.crossHiddenColumns.indexOf(t),1),!a.isHidden&&a.colspan<a.origColspan&&(a.colspan+=1),a.isHidden=!1})}var import_es_error_cause$14=__toESM(require_es_error_cause(),1);const availableModifiers=new Map([["collapse",collapseNode],["expand",expandNode],["hide-column",hideColumn],["show-column",showColumn]]);function triggerNodeModification(e,t,i){if(!availableModifiers.has(e))throw new Error(`The node modifier action ("${e}") does not exist.`);return availableModifiers.get(e)(t,i)}var import_es_array_push$11=__toESM(require_es_array_push(),1);function generateMatrix(e){const t=[];return arrayEach$1(e,i=>{i.walkDown(r=>{const o=r.data,{origColspan:a,columnIndex:c,headerLevel:u,crossHiddenColumns:h}=o,d=createNestedArrayIfNecessary(t,u);let f=!1;for(let m=c;m<c+a;m++)if(h.includes(m)||f)d.push(createPlaceholderHeaderSettings(o));else{const v=createHeaderSettings(o);v.isRoot=!0,d.push(v),f=!0}})}),t}function createHeaderSettings(e){const{crossHiddenColumns:t,...i}=createDefaultHeaderSettings(e);return i}function createNestedArrayIfNecessary(e,t){let i;return Array.isArray(e[t])?i=e[t]:(i=[],e[t]=i),i}var import_es_error_cause$13=__toESM(require_es_error_cause(),1),import_es_array_push$10=__toESM(require_es_array_push(),1);function _classPrivateFieldInitSpec$3(e,t,i){_checkPrivateRedeclaration$6(e,t),t.set(e,i)}function _checkPrivateRedeclaration$6(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$2(e,t,i){return e.set(_assertClassBrand$6(e,t),i),i}function _classPrivateFieldGet$3(e,t){return e.get(_assertClassBrand$6(e,t))}function _assertClassBrand$6(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _sourceSettings=new WeakMap,_headersTree=new WeakMap,_stateMatrix=new WeakMap,StateManager=class{constructor(){_classPrivateFieldInitSpec$3(this,_sourceSettings,new SourceSettings),_classPrivateFieldInitSpec$3(this,_headersTree,new HeadersTree(_classPrivateFieldGet$3(_sourceSettings,this))),_classPrivateFieldInitSpec$3(this,_stateMatrix,[[]])}setState(e){_classPrivateFieldGet$3(_sourceSettings,this).setData(e);let t=!1;try{_classPrivateFieldGet$3(_headersTree,this).buildTree()}catch{_classPrivateFieldGet$3(_headersTree,this).clear(),_classPrivateFieldGet$3(_sourceSettings,this).clear(),t=!0}return _classPrivateFieldSet$2(_stateMatrix,this,generateMatrix(_classPrivateFieldGet$3(_headersTree,this).getRoots())),t}setColumnsLimit(e){_classPrivateFieldGet$3(_sourceSettings,this).setColumnsLimit(e)}mergeStateWith(e){const t=arrayMap$1(e,i=>{let{row:r,...o}=i;return{row:r<0?this.rowCoordsToLevel(r):r,...o}});_classPrivateFieldGet$3(_sourceSettings,this).mergeWith(t),_classPrivateFieldGet$3(_headersTree,this).buildTree(),_classPrivateFieldSet$2(_stateMatrix,this,generateMatrix(_classPrivateFieldGet$3(_headersTree,this).getRoots()))}mapState(e){_classPrivateFieldGet$3(_sourceSettings,this).map(e),_classPrivateFieldGet$3(_headersTree,this).buildTree(),_classPrivateFieldSet$2(_stateMatrix,this,generateMatrix(_classPrivateFieldGet$3(_headersTree,this).getRoots()))}mapNodes(e){return arrayReduce(_classPrivateFieldGet$3(_headersTree,this).getRoots(),(t,i)=>(i.walkDown(r=>{const o=e(r.data);o!==void 0&&t.push(o)}),t),[])}triggerNodeModification(e,t,i){t<0&&(t=this.rowCoordsToLevel(t));const r=_classPrivateFieldGet$3(_headersTree,this).getNode(t,i);let o;return r&&(o=triggerNodeModification(e,r,i),_classPrivateFieldSet$2(_stateMatrix,this,generateMatrix(_classPrivateFieldGet$3(_headersTree,this).getRoots()))),o}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var i,r;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(i=(r=_classPrivateFieldGet$3(_stateMatrix,this)[e])===null||r===void 0?void 0:r[t])!==null&&i!==void 0?i:null}getHeaderTreeNodeData(e,t){const i=this.getHeaderTreeNode(e,t);return i?{...i.data}:null}getHeaderTreeNode(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const i=_classPrivateFieldGet$3(_headersTree,this).getNode(e,t);return i||null}findTopMostEntireHeaderLevel(e){var t;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=i-e+1;let o=!1,a=null;for(let c=e;c<=i;c++){const u=_classPrivateFieldGet$3(_headersTree,this).getRootByColumn(c);if(!u)break;o=!0,u.walkDown(h=>{const{columnIndex:d,headerLevel:f,origColspan:m,isHidden:g}=h.data;g||m<=r&&d>=e&&d+m-1<=i&&(a===null||f<a)&&(a=f)},TRAVERSAL_DF_PRE)}return o&&a===null?-1:this.levelToRowCoords((t=a)!==null&&t!==void 0?t:0)}findLeftMostColumnIndex(e,t){var i;const{isRoot:r}=(i=this.getHeaderSettings(e,t))!==null&&i!==void 0?i:{isRoot:!0};if(r)return t;let o=t-1;for(;o>=0;){var a;const{isRoot:c}=(a=this.getHeaderSettings(e,o))!==null&&a!==void 0?a:{isRoot:!0};if(c)break;o-=1}return o}findRightMostColumnIndex(e,t){var i;const{isRoot:r,origColspan:o}=(i=this.getHeaderSettings(e,t))!==null&&i!==void 0?i:{isRoot:!0,origColspan:1};if(r)return t+o-1;let a=t+1;for(;a<this.getColumnsCount();){var c;const{isRoot:u}=(c=this.getHeaderSettings(e,a))!==null&&c!==void 0?c:{isRoot:!0};if(u)break;a+=1}return a-1}getLayersCount(){return _classPrivateFieldGet$3(_sourceSettings,this).getLayersCount()}getColumnsCount(){return _classPrivateFieldGet$3(_sourceSettings,this).getColumnsCount()}clear(){_classPrivateFieldSet$2(_stateMatrix,this,[]),_classPrivateFieldGet$3(_sourceSettings,this).clear(),_classPrivateFieldGet$3(_headersTree,this).clear()}},import_es_error_cause$12=__toESM(require_es_error_cause(),1);function _defineProperty$11(e,t,i){return(t=_toPropertyKey$12(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$12(e){var t=_toPrimitive$12(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$12(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GhostTable=class{constructor(e,t){_defineProperty$11(this,"hot",void 0),_defineProperty$11(this,"nestedHeaderSettingsGetter",void 0),_defineProperty$11(this,"layersCount",0),_defineProperty$11(this,"container",void 0),_defineProperty$11(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsMap.clear();for(let i=0;i<t;i++){const r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),o=this.hot.toPhysicalColumn(r);this.widthsMap.setValueAtIndex(o,e[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:i}=this.hot,r=t.createDocumentFragment(),o=t.createElement("table"),a=!!this.hot.getSettings().dropdownMenu,c=i.getRenderableIndexesLength();for(let u=0;u<this.layersCount;u++){const h=t.createElement("tr");for(let d=0;d<c;d++){let f=i.getVisualFromRenderableIndex(d);f===null&&(f=d);const m=t.createElement("th"),g=this.nestedHeaderSettingsGetter(u,f);if(g&&(!g.isPlaceholder||g.isHidden)){let v=g.label;a&&(v+='<button class="changeType"></button>'),fastInnerHTML(m,v),m.colSpan=g.colspan,h.appendChild(m)}}o.appendChild(h)}r.appendChild(o),e.appendChild(r)}clear(){this.widthsMap.clear(),this.container=null}},ghostTable_default=GhostTable,import_es_error_cause$11=__toESM(require_es_error_cause(),1),import_es_array_push$9=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$4(e,t){_checkPrivateRedeclaration$5(e,t),t.add(e)}function _defineProperty$10(e,t,i){return(t=_toPropertyKey$11(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$11(e){var t=_toPrimitive$11(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$11(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldInitSpec$2(e,t,i){_checkPrivateRedeclaration$5(e,t),t.set(e,i)}function _checkPrivateRedeclaration$5(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$1(e,t,i){return e.set(_assertClassBrand$5(e,t),i),i}function _classPrivateFieldGet$2(e,t){return e.get(_assertClassBrand$5(e,t))}function _assertClassBrand$5(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$6="nestedHeaders",PLUGIN_PRIORITY$5=280;var _stateManager=new WeakMap,_hidingIndexMapObserver=new WeakMap,_focusInitialCoords=new WeakMap,_isColumnsSelectionInProgress=new WeakMap,_NestedHeaders_brand=new WeakSet,NestedHeaders=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$4(this,_NestedHeaders_brand),_classPrivateFieldInitSpec$2(this,_stateManager,new StateManager),_classPrivateFieldInitSpec$2(this,_hidingIndexMapObserver,null),_classPrivateFieldInitSpec$2(this,_focusInitialCoords,null),_classPrivateFieldInitSpec$2(this,_isColumnsSelectionInProgress,!1),_defineProperty$10(this,"ghostTable",new ghostTable_default(this.hot,(e,t)=>this.getHeaderSettings(e,t))),_defineProperty$10(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$6}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$5}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$6]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();(!Array.isArray(t)||!Array.isArray(t[0]))&&warn(toSingleLine`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>_assertClassBrand$5(_NestedHeaders_brand,this,_onInit).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$5(_NestedHeaders_brand,e,_onAfterLoadData).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$5(_NestedHeaders_brand,e,_onBeforeOnCellMouseDown$1).call(e,...r)}),this.addHook("afterOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$5(_NestedHeaders_brand,e,_onAfterOnCellMouseDown).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$5(_NestedHeaders_brand,e,_onBeforeOnCellMouseOver).call(e,...r)}),this.addHook("beforeOnCellMouseUp",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$5(_NestedHeaders_brand,e,_onBeforeOnCellMouseUp).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$5(_NestedHeaders_brand,e,_onBeforeSelectionHighlightSet).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$5(_NestedHeaders_brand,e,_onModifyTransformStart).call(e,...r)}),this.addHook("afterSelection",()=>_assertClassBrand$5(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this)),this.addHook("afterSelectionFocusSet",()=>_assertClassBrand$5(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$5(_NestedHeaders_brand,e,_onBeforeViewportScrollHorizontally).call(e,...r)}),this.addHook("afterGetColumnHeaderRenderers",i=>_assertClassBrand$5(_NestedHeaders_brand,this,_onAfterGetColumnHeaderRenderers).call(this,i)),this.addHook("modifyColWidth",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$5(_NestedHeaders_brand,e,_onModifyColWidth).call(e,...r)}),this.addHook("modifyColumnHeaderValue",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$5(_NestedHeaders_brand,e,_onModifyColumnHeaderValue).call(e,...r)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$5(_NestedHeaders_brand,e,_onBeforeHighlightingColumnHeader).call(e,...r)}),this.addHook("beforeCopy",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$5(_NestedHeaders_brand,e,_onBeforeCopy).call(e,...r)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$5(_NestedHeaders_brand,e,_onBeforeSelectColumns).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$5(_NestedHeaders_brand,e,_onAfterViewportColumnCalculatorOverride).call(e,...r)}),this.addHook("modifyFocusedElement",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$5(_NestedHeaders_brand,e,_onModifyFocusedElement).call(e,...r)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>_assertClassBrand$5(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>_assertClassBrand$5(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();_classPrivateFieldGet$2(_stateManager,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=_classPrivateFieldGet$2(_stateManager,this).setState(e)),this.detectedOverlappedHeaders&&warn(toSingleLine`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,i)=>{const r=t===!0?"hide-column":"show-column";_classPrivateFieldGet$2(_stateManager,this).triggerColumnModification(r,i)}),!_classPrivateFieldGet$2(_hidingIndexMapObserver,this)&&this.enabled&&_classPrivateFieldSet$1(_hidingIndexMapObserver,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(i=>{let{op:r,index:o,newValue:a}=i;if(r==="replace"){const c=a===!0?"hide-column":"show-column";_classPrivateFieldGet$2(_stateManager,this).triggerColumnModification(c,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),_classPrivateFieldGet$2(_stateManager,this).clear(),_classPrivateFieldGet$2(_hidingIndexMapObserver,this).unsubscribe(),_classPrivateFieldSet$1(_hidingIndexMapObserver,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return _classPrivateFieldGet$2(_stateManager,this)}getLayersCount(){return _classPrivateFieldGet$2(_stateManager,this).getLayersCount()}getHeaderSettings(e,t){return _classPrivateFieldGet$2(_stateManager,this).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,i=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let a=0;a<t;a++){const c=i.childNodes[a];if(!c)break;const u=r.childNodes[a],h=o?o.childNodes[a]:null;for(let d=0,f=c.childNodes.length;d<f;d++)c.childNodes[d].removeAttribute("colspan"),removeClass$1(c.childNodes[d],"hiddenHeader"),u&&u.childNodes[d]&&(u.childNodes[d].removeAttribute("colspan"),removeClass$1(u.childNodes[d],"hiddenHeader")),o&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),removeClass$1(h.childNodes[d],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const i=this.hot.view._wt.getSetting("fixedColumnsStart");return(r,o)=>{var a;const{columnIndexMapper:c,view:u}=this.hot;let h=c.getVisualFromRenderableIndex(r);h===null&&(h=r),o.removeAttribute("colspan"),removeClass$1(o,"hiddenHeader");const{colspan:d,isHidden:f,isPlaceholder:m,headerClassNames:g}=(a=_classPrivateFieldGet$2(_stateManager,this).getHeaderSettings(e,h))!==null&&a!==void 0?a:{label:""};if(m||f)addClass$1(o,"hiddenHeader");else if(d>1){var v,_;const{wtOverlays:b}=u._wt,S=(v=b.topInlineStartCornerOverlay)===null||v===void 0?void 0:v.clone.wtTable.THEAD.contains(o),T=(_=b.inlineStartOverlay)===null||_===void 0?void 0:_.clone.wtTable.THEAD.contains(o),A=S||T?Math.min(d,i-r):d;A>1&&o.setAttribute("colspan",A)}if(this.hot.view.appendColHeader(h,o,function(){return t.getColumnHeaderValue(...arguments)},e),!m&&!f){const b=o.querySelector("div.relative");b&&g&&g.length>0&&(removeClass$1(b,this.hot.getColumnMeta(h).headerClassName),addClass$1(b,g))}}}getColumnHeaderValue(e,t){var i;const{isHidden:r,isPlaceholder:o}=(i=_classPrivateFieldGet$2(_stateManager,this).getHeaderSettings(t,e))!==null&&i!==void 0?i:{};return o||r?"":this.hot.getColHeader(e,t)}destroy(){_classPrivateFieldSet$1(_stateManager,this,null),_classPrivateFieldGet$2(_hidingIndexMapObserver,this)!==null&&(_classPrivateFieldGet$2(_hidingIndexMapObserver,this).unsubscribe(),_classPrivateFieldSet$1(_hidingIndexMapObserver,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return _classPrivateFieldGet$2(_stateManager,this).getHeaderTreeNodeData(e.row,e.col)}};function _updateFocusHighlightPosition(){var e;const t=(e=this.hot)===null||e===void 0?void 0:e.getSelectedRangeLast();if(!t)return;const{highlight:i}=t;if(i.isHeader()&&i.col>=0){const o=_classPrivateFieldGet$2(_stateManager,this).findLeftMostColumnIndex(i.row,i.col),a=this.hot.selection.highlight.getFocus();a.visualCellRange.highlight.col=o,a.visualCellRange.from.col=o,a.visualCellRange.to.col=o,a.commit()}}function _onBeforeViewportScrollHorizontally(e){const t=this.hot.getSelectedRangeLast();if(!t)return e;const{highlight:i}=t;if(!(i.isHeader()&&i.col>=0))return e;const o=this.hot.view.getFirstFullyVisibleColumn(),a=this.hot.view.getLastFullyVisibleColumn(),c=_classPrivateFieldGet$2(_stateManager,this).findLeftMostColumnIndex(i.row,i.col),u=_classPrivateFieldGet$2(_stateManager,this).findRightMostColumnIndex(i.row,i.col);return c<o&&u>a?e:c<o?c:u}function _onBeforeHighlightingColumnHeader(e,t,i){const r=_classPrivateFieldGet$2(_stateManager,this).getHeaderTreeNodeData(t,e);if(!r)return e;const{columnCursor:o,selectionType:a,selectionWidth:c}=i,{isRoot:u,colspan:h}=_classPrivateFieldGet$2(_stateManager,this).getHeaderSettings(t,e);if(a===HEADER_TYPE){if(!u)return r.columnIndex}else if(a===ACTIVE_HEADER_TYPE&&(h>c-o||!u))return null;return e}function _onBeforeCopy(e,t,i){let{columnHeadersCount:r}=i;if(r!==0)for(let a=0;a<t.length;a++){const{startRow:c,startCol:u,endRow:h,endCol:d}=t[a],f=h-c+1,m=u-d+1;if(c>=0||m===1)break;for(let g=u;g<=d;g++)for(let v=c;v<=h;v++){var o;const _=f+v,b=g-u;if(b===0)continue;((o=_classPrivateFieldGet$2(_stateManager,this).getHeaderTreeNodeData(v,g))===null||o===void 0?void 0:o.isRoot)===!1&&(e[_][b]="")}}}function _onBeforeOnCellMouseDown$1(e,t,i,r){this._getHeaderTreeNodeDataByCoords(t)&&(r.column=!0)}function _onAfterOnCellMouseDown(e,t){const i=this._getHeaderTreeNodeDataByCoords(t);if(!i)return;_classPrivateFieldSet$1(_focusInitialCoords,this,t.clone()),_classPrivateFieldSet$1(_isColumnsSelectionInProgress,this,!0);const{selection:r}=this.hot,o=r.isSelected()?r.getSelectedRange().current():null,a=[],{columnIndex:c,origColspan:u}=i,h=!r.inInSelection(t);e.shiftKey&&o?t.col<o.from.col?a.push(o.getTopEndCorner().col,c,t.row):t.col>o.from.col?a.push(o.getTopStartCorner().col,c+u-1,t.row):a.push(c,c+u-1,t.row):(isLeftClick(e)||isRightClick(e)&&h||isTouchEvent(e))&&a.push(c,c+u-1,t.row),r.selectColumns(...a)}function _onBeforeOnCellMouseOver(e,t,i,r){if(!this.hot.view.isMouseDown())return;const o=this._getHeaderTreeNodeDataByCoords(t);if(!o)return;const{columnIndex:a,origColspan:c}=o,u=this.hot.getSelectedRangeLast(),h=u.getTopStartCorner(),d=u.getBottomEndCorner(),{from:f}=u;r.column=!0,r.cell=!0;const m=[],g=clamp$1(t.row,-1/0,-1);t.col<f.col?m.push(d.col,a,g):t.col>f.col?m.push(h.col,a+c-1,g):m.push(a,a+c-1,g),this.hot.selection.selectColumns(...m)}function _onBeforeOnCellMouseUp(){_classPrivateFieldSet$1(_isColumnsSelectionInProgress,this,!1)}function _onBeforeSelectionHighlightSet(){const{navigableHeaders:e}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!_classPrivateFieldGet$2(_isColumnsSelectionInProgress,this)||!e)return;const t=this.hot.getSelectedRangeLast(),i=t.getTopStartCorner().col,r=t.getBottomEndCorner().col,{columnIndex:o,origColspan:a}=_classPrivateFieldGet$2(_stateManager,this).getHeaderTreeNodeData(_classPrivateFieldGet$2(_focusInitialCoords,this).row,_classPrivateFieldGet$2(_focusInitialCoords,this).col);if(t.setHighlight(_classPrivateFieldGet$2(_focusInitialCoords,this)),a>t.getWidth()||o<i||o+a-1>r){const c=_classPrivateFieldGet$2(_stateManager,this).findTopMostEntireHeaderLevel(clamp$1(i,o,o+a-1),clamp$1(r,o,o+a-1));t.highlight.row=c,t.highlight.col=t.from.col}}function _onModifyTransformStart(e){const{highlight:t}=this.hot.getSelectedRangeLast(),i=this.hot._createCellCoords(t.row+e.row,t.col+e.col);if(!(i.isHeader()&&i.col>=0))return;const o=_classPrivateFieldGet$2(_stateManager,this).findLeftMostColumnIndex(i.row,i.col),a=_classPrivateFieldGet$2(_stateManager,this).findRightMostColumnIndex(i.row,i.col);if(e.col<0){const c=t.col>=o&&t.col<=a?o-1:a,u=this.hot.columnIndexMapper.getNearestNotHiddenIndex(c,-1);u===null?e.col=-this.hot.view.countRenderableColumnsInRange(0,t.col):e.col=-Math.max(this.hot.view.countRenderableColumnsInRange(u,t.col)-1,1)}else if(e.col>0){const c=t.col>=o&&t.col<=a?a+1:o,u=this.hot.columnIndexMapper.getNearestNotHiddenIndex(c,1);u===null?e.col=this.hot.view.countRenderableColumnsInRange(t.col,this.hot.countCols()):e.col=Math.max(this.hot.view.countRenderableColumnsInRange(t.col,u)-1,1)}}function _onBeforeSelectColumns(e,t){const i=e.row,r=this._getHeaderTreeNodeDataByCoords({row:i,col:e.col}),o=this._getHeaderTreeNodeDataByCoords({row:i,col:t.col});t.col<e.col?(r&&(e.col=r.columnIndex+r.origColspan-1),o&&(t.col=o.columnIndex)):t.col>=e.col&&(r&&(e.col=r.columnIndex),o&&(t.col=o.columnIndex+o.origColspan-1))}function _onAfterGetColumnHeaderRenderers(e){e.length=0;for(let t=0;t<_classPrivateFieldGet$2(_stateManager,this).getLayersCount();t++)e.push(this.headerRendererFactory(t))}function _onAfterViewportColumnCalculatorOverride(e){const t=_classPrivateFieldGet$2(_stateManager,this).getLayersCount();let i=e.startColumn,r=!!t;for(let o=0;o<t;o++){const a=_classPrivateFieldGet$2(_stateManager,this).findLeftMostColumnIndex(o,e.startColumn),c=this.hot.columnIndexMapper.getRenderableFromVisualIndex(a);if(a>=0&&(r=!1),isNumeric(c)&&c<e.startColumn){i=c;break}}e.startColumn=r?_classPrivateFieldGet$2(_stateManager,this).getHeaderTreeNodeData(0,i).columnIndex:i}function _onModifyColWidth(e,t){const i=this.ghostTable.getWidth(t);return e>i?e:i}function _onModifyColumnHeaderValue(e,t,i){var r;const{label:o}=(r=_classPrivateFieldGet$2(_stateManager,this).getHeaderTreeNodeData(i,t))!==null&&r!==void 0?r:{label:""};return o}function _onModifyFocusedElement(e,t){if(e<0)return this.hot.getCell(e,_classPrivateFieldGet$2(_stateManager,this).findLeftMostColumnIndex(e,t),!0)}function _onInit(){this.updatePlugin()}function _onAfterLoadData(e,t){t||this.updatePlugin()}var import_es_error_cause$10=__toESM(require_es_error_cause(),1),import_es_array_push$8=__toESM(require_es_array_push(),1);function _defineProperty$9(e,t,i){return(t=_toPropertyKey$10(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$10(e){var t=_toPrimitive$10(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$10(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DataManager=class{constructor(e,t){_defineProperty$9(this,"hot",void 0),_defineProperty$9(this,"data",null),_defineProperty$9(this,"plugin",void 0),_defineProperty$9(this,"parentReference",new WeakMap),_defineProperty$9(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=t,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},rangeEach(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,i){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:i,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&arrayEach$1(e.__children,r=>{this.cacheNode(r,t+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,t,i,r){let o=!1,a=t;if(isNaN(a)&&a.end)return a;let c=e;return c||(c={__children:this.data},o=!0,a-=1),i!=null&&a===i?{result:c,end:!0}:r!=null&&c===r?{result:a,end:!0}:(a+=1,c.__children&&arrayEach$1(c.__children,u=>{if(this.parentReference.set(u,o?null:c),a=this.readTreeNodes(u,a,i,r),isNaN(a)&&a.end)return!1}),a)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return objectEach(this.data[0],(t,i)=>{e[i]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;isNaN(e)?t=e:t=this.getDataObject(e);const i=this.getRowParent(e);return i==null?this.data.indexOf(t):i.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,i=e;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(arrayEach$1(i.__children,r=>{t+=1,r.__children&&(t+=this.countChildren(r))}),t)}getRowParent(e){let t;return isNaN(e)?t=e:t=this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let t=null;return isNaN(e)?t=e:t=this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!!(t.__children&&t.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,t){var i;return((i=e.__children)===null||i===void 0?void 0:i[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let i=e;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((t=i.__children)===null||t===void 0?void 0:t.length)!==0}addChild(e,t){let i=t;this.hot.runHooks("beforeAddChild",e,i);let r=null;e&&(r=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),i||(i=this.mockNode()),o.__children.push(i),this.rewriteCache();const a=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(a,1),this.hot.runHooks("afterCreateRow",a,1),this.hot.runHooks("afterAddChild",e,i)}addChildAtIndex(e,t,i){let r=i,o;if(r||(r=this.mockNode()),this.hot.runHooks("beforeAddChild",e,r,t),e){const c=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",c,1),e.__children.splice(t,null,r),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(c,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",c,1),o=c}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[t]);r=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,r,t)}addSibling(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const i=this.translateTrimmedRow(e),r=this.getRowParent(i),o=this.getRowIndexWithinParent(i);switch(t){case"below":this.addChildAtIndex(r,o+1,null);break;case"above":this.addChildAtIndex(r,o,null);break;default:break}}detachFromParent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null;const r=[];Array.isArray(e)?(rangeEach(e[0],e[2],m=>{const g=this.translateTrimmedRow(m);r.push(this.getDataObject(g))}),rangeEach(0,r.length-2,m=>{this.detachFromParent(r[m],!1)}),i=r[r.length-1]):i=e;const o=this.getRowIndex(i),a=this.countChildren(i),c=this.getRowIndexWithinParent(i),u=this.getRowParent(i),h=this.getRowParent(u),d=this.getRowIndex(h);let f=null;if(this.hot.runHooks("beforeDetachChild",u,i),c!=null){const m=Array.from(new Array(o+a+1).keys()).splice(-1*(a+1));if(this.hot.runHooks("beforeRemoveRow",o,a+1,m,this.plugin.pluginName),u.__children.splice(c,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,a+1,m,this.plugin.pluginName),h){f=d+this.countChildren(h);const g=this.getChild(h,this.countChildren(h)-1),v=this.getRowIndex(g);this.hot.runHooks("beforeCreateRow",v+1,a+1,this.plugin.pluginName),h.__children.push(i)}else f=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",f-2,a+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",f-2,a+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",u,i,this.getRowIndex(i)),t&&this.hot.render()}filterData(e,t,i){const r=[];arrayEach$1(i,o=>{r.push(this.getDataObject(o))}),arrayEach$1(r,o=>{const a=this.getRowIndexWithinParent(o),c=this.getRowParent(o);c===null?this.data.splice(a,1):c.__children.splice(a,1)}),this.rewriteCache()}spliceData(e,t,i){const r=this.getDataObject(e-1);let o=null,a=e;r&&r.__children&&r.__children.length===0?(o=r,a=0):e<this.countAllRows()&&(o=this.getRowParent(e),a=this.getRowIndexWithinParent(e)),o?i?o.__children.splice(a,t,...i):o.__children.splice(a,t):i?this.data.splice(a,t,...i):this.data.splice(a,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,i=null;do i=this.getRowParent(i),i!==null&&(t=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,i,r){const o=t===this.hot.countRows(),a=this.getRowParent(e),c=this.getRowIndexWithinParent(e),u=a.__children.slice(c,c+1),h=e>t;let d=o?this.getRowParent(t-1):this.getRowParent(t);d==null&&(d=this.getRowParent(t-1)),d==null&&(d=this.getDataObject(t-1)),d?d.__children||(d.__children=[]):(d=this.getDataObject(t),d.__children=[]);const f=o||i||r?d.__children.length:this.getRowIndexWithinParent(t),m=a===d;d.__children.splice(f,0,u[0]),a.__children.splice(c+(h&&m?1:0),1),this.syncRowWithRawSource(a),m||this.syncRowWithRawSource(d)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}},dataManager_default=DataManager,import_es_error_cause$9=__toESM(require_es_error_cause(),1);function _defineProperty$8(e,t,i){return(t=_toPropertyKey$9(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$9(e){var t=_toPrimitive$9(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$9(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BaseUI=class{constructor(e,t){_defineProperty$8(this,"hot",void 0),_defineProperty$8(this,"plugin",void 0),this.hot=t,this.plugin=e}},_base_default=BaseUI,HeadersUI=class cn extends _base_default{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(t,i){super(t,i),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(t,i){const r=this.hot.toPhysicalRow(t),o=this.dataManager.getRowLevel(r),a=this.dataManager.getDataObject(r),c=i.getElementsByTagName("DIV")[0],u=c.querySelector("span.rowHeader"),h=c.querySelectorAll('[class^="ht_nesting"]'),d=this.hot.getSettings().ariaTags;if(arrayEach$1(h,f=>{f&&c.removeChild(f)}),addClass$1(i,cn.CSS_CLASSES.indicatorContainer),o){const{rootDocument:f}=this.hot,m=u.cloneNode(!0);c.innerHTML="",rangeEach(0,o-1,()=>{const g=f.createElement("SPAN");addClass$1(g,cn.CSS_CLASSES.emptyIndicator),c.appendChild(g)}),c.appendChild(m)}if(this.dataManager.hasChildren(a)){const f=this.hot.rootDocument.createElement("DIV");d&&setAttribute(f,[A11Y_HIDDEN()]),addClass$1(i,cn.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(addClass$1(f,`${cn.CSS_CLASSES.button} ${cn.CSS_CLASSES.expandButton}`),d&&setAttribute(i,[A11Y_EXPANDED(!1)])):(addClass$1(f,`${cn.CSS_CLASSES.button} ${cn.CSS_CLASSES.collapseButton}`),d&&setAttribute(i,[A11Y_EXPANDED(!0)])),c.appendChild(f)}}updateRowHeaderWidth(t){let i=t;i||(i=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*i+25),this.hot.render()}},headers_default=HeadersUI,import_es_array_push$7=__toESM(require_es_array_push(),1),CollapsingUI=class extends _base_default{constructor(e,t){var i;super(e,t),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,r)},shiftStash:function(r,o){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),arrayEach$1(i.lastCollapsedRows,(c,u)=>{c>=r&&c<o&&(i.lastCollapsedRows[u]=c+a)})},applyStash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,r),i.lastCollapsedRows=void 0},trimStash:(r,o)=>{rangeEach(r,r+o-1,a=>{const c=this.lastCollapsedRows.indexOf(a);c>-1&&this.lastCollapsedRows.splice(c,1)})}}}collapseChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let o=null,a=null,c=null;return isNaN(e)?(o=e,a=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),a=e),this.dataManager.hasChildren(o)&&arrayEach$1(o.__children,u=>{r.push(this.dataManager.getRowIndex(u))}),c=this.collapseRows(r,!0,!1),i&&this.trimRows(c),t&&this.renderAndAdjust(),this.collapsedRows.indexOf(a)===-1&&this.collapsedRows.push(a),c}collapseMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];arrayEach$1(e,o=>{r.push(...this.collapseChildren(o,!1,!1))}),i&&this.trimRows(r),t&&this.renderAndAdjust()}collapseRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],t)}collapseRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return arrayEach$1(e,o=>{r.push(o),t&&this.collapseChildRows(o,r)}),i&&this.trimRows(r),r}collapseChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const o=this.dataManager.getDataObject(e);arrayEach$1(o.__children,a=>{const c=this.dataManager.getRowIndex(a);t.push(c),this.collapseChildRows(c,t)})}r&&this.trimRows(t)}expandRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],t)}expandRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return arrayEach$1(e,o=>{r.push(o),t&&this.expandChildRows(o,r)}),i&&this.untrimRows(r),r}expandChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const o=this.dataManager.getDataObject(e);arrayEach$1(o.__children,a=>{if(!this.isAnyParentCollapsed(a)){const c=this.dataManager.getRowIndex(a);t.push(c),this.expandChildRows(c,t)}})}r&&this.untrimRows(t)}expandChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let o=null,a=null,c=null;return isNaN(e)?(o=e,a=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),a=e),this.collapsedRows.splice(this.collapsedRows.indexOf(a),1),this.dataManager.hasChildren(o)&&arrayEach$1(o.__children,u=>{const h=this.dataManager.getRowIndex(u);r.push(h)}),c=this.expandRows(r,!0,!1),i&&this.untrimRows(c),t&&this.renderAndAdjust(),c}expandMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];arrayEach$1(e,o=>{r.push(...this.expandChildren(o,!1,!1))}),i&&this.untrimRows(r),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];arrayEach$1(e,i=>{this.dataManager.hasChildren(i)&&t.push(i)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];arrayEach$1(e,i=>{this.dataManager.hasChildren(i)&&t.push(i)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{arrayEach$1(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{arrayEach$1(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),i=!0;return t===null&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&arrayEach$1(t.__children,r=>{const o=this.dataManager.getRowIndex(r);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return i=!1,!1}),i}isAnyParentCollapsed(e){let t=e;for(;t!==null;){t=this.dataManager.getRowParent(t);const i=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(i)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const i=this.translateTrimmedRow(t.row);hasClass$1(e.target,headers_default.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),stopImmediatePropagation(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}},collapsing_default=CollapsingUI,import_es_error_cause$8=__toESM(require_es_error_cause(),1);function _classPrivateFieldInitSpec$1(e,t,i){_checkPrivateRedeclaration$4(e,t),t.set(e,i)}function _checkPrivateRedeclaration$4(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$7(e,t,i){return(t=_toPropertyKey$8(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$8(e){var t=_toPrimitive$8(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$8(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet$1(e,t){return e.get(_assertClassBrand$4(e,t))}function _assertClassBrand$4(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}var _menuEntries=new WeakMap,ContextMenuUI=class extends _base_default{constructor(){super(...arguments),_defineProperty$7(this,"dataManager",this.plugin.dataManager),_classPrivateFieldInitSpec$1(this,_menuEntries,{row_above:(e,t)=>{const i=t[t.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(e,t)=>{const i=t[t.length-1];this.dataManager.addSibling(i.start.row,"below")}})}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:()=>{const i=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),r=this.dataManager.getDataObject(i);this.dataManager.addChild(r)},disabled:()=>{const i=this.hot.getSelectedLast();return!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const i=this.hot.getSelectedLast(),r=this.dataManager.translateTrimmedRow(i[0]);return!this.dataManager.getRowParent(r)||!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return rangeEach(0,e.items.length-1,i=>{if(i===0)return arrayEach$1(t,(r,o)=>{e.items.splice(i+o,0,r)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return rangeEach(0,e.items.length-1,t=>{const i=_classPrivateFieldGet$1(_menuEntries,this)[e.items[t].key];i!=null&&(e.items[t].callback=i)}),e}},contextMenu_default=ContextMenuUI,import_es_error_cause$7=__toESM(require_es_error_cause(),1),import_es_array_push$6=__toESM(require_es_array_push(),1);function _defineProperty$6(e,t,i){return(t=_toPropertyKey$7(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$7(e){var t=_toPrimitive$7(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$7(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RowMoveController=class{constructor(e){_defineProperty$6(this,"plugin",void 0),_defineProperty$6(this,"hot",void 0),_defineProperty$6(this,"dataManager",void 0),_defineProperty$6(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,i,r){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:i,movePossible:r}))return!1;this.movedToCollapsed=!1;const a=i===this.hot.countRows(),c=a?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i);let u=!0;const h=e.map(v=>{if(!u)return!1;const _=this.dataManager.translateTrimmedRow(v);return u=this.shouldAllowMoving(_,c),_}),d=h.indexOf(c)===-1;if(!u||!d)return!1;const f=this.getBaseParent(h),m=this.getTargetParent(a,c),g=f===m;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(m),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(h,c,g),this.moveRows(h,c,m),this.dataManager.rewriteCache(),this.moveCellsMeta(h,c),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,i,r,r&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,i),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:i,dropIndex:r,movePossible:o}=e;let a=!1;return isUndefined$1(r)&&(warn(toSingleLine`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,i,r,o,!1),a=!0),a}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||t===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let i=this.dataManager.getRowParent(e?t-1:t);return i==null&&(i=this.dataManager.getRowParent(t-1)),i}shiftCollapsibleParentsLocations(e,t,i){i||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,i){const r=t===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,t,this.movedToCollapsed,r)})})}moveCellsMeta(e,t){const i=[],r=Math.max(...e)<t;e.forEach(o=>{i.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(r?i.length:0),0,...i)}selectCells(e,t){const i=e.length;let r=0,o=0,a=null,c=null;if(this.movedToCollapsed){let u=null;e[i-1]<t?u=this.dataManager.translateTrimmedRow(t-i):u=this.dataManager.translateTrimmedRow(t);const h=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),d=this.dataManager.getRowIndex(h);r=this.dataManager.untranslateTrimmedRow(d),o=r}else e[i-1]<t?(o=t-1,r=o-i+1):(r=t,o=r+i-1);a=this.hot.selection,c=this.hot.countCols()-1,a.setRangeStart(this.hot._createCellCoords(r,0)),a.setRangeEnd(this.hot._createCellCoords(o,c),!0)}isRowOrderChanged(e,t){return e.some((i,r)=>i-r!==t)}},import_es_error_cause$6=__toESM(require_es_error_cause(),1),import_es_array_push$5=__toESM(require_es_array_push(),1),import_es_set_difference_v2$1=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2$1=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2$1=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2$1=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2$1=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2$1=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2$1=__toESM(require_es_set_union_v2(),1);function _classPrivateMethodInitSpec$3(e,t){_checkPrivateRedeclaration$3(e,t),t.add(e)}function _classPrivateFieldInitSpec(e,t,i){_checkPrivateRedeclaration$3(e,t),t.set(e,i)}function _checkPrivateRedeclaration$3(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$5(e,t,i){return(t=_toPropertyKey$6(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$6(e){var t=_toPrimitive$6(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$6(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet(e,t){return e.get(_assertClassBrand$3(e,t))}function _classPrivateFieldSet(e,t,i){return e.set(_assertClassBrand$3(e,t),i),i}function _assertClassBrand$3(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$5="nestedRows",PLUGIN_PRIORITY$4=300,SHORTCUTS_GROUP$1=PLUGIN_KEY$5,WRONG_DATA_TYPE_ERROR="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var _skipRender=new WeakMap,_skipCoreAPIModifiers=new WeakMap,_NestedRows_brand=new WeakSet,NestedRows=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$3(this,_NestedRows_brand),_defineProperty$5(this,"dataManager",null),_defineProperty$5(this,"headersUI",null),_defineProperty$5(this,"collapsedRowsMap",null),_classPrivateFieldInitSpec(this,_skipRender,!1),_classPrivateFieldInitSpec(this,_skipCoreAPIModifiers,!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$5}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$4}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$5]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new TrimmingMap),this.dataManager=new dataManager_default(this,this.hot),this.collapsingUI=new collapsing_default(this,this.hot),this.headersUI=new headers_default(this,this.hot),this.contextMenuUI=new contextMenu_default(this,this.hot),this.rowMoveController=new RowMoveController(this),this.addHook("afterInit",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$3(_NestedRows_brand,e,_onAfterInit).call(e,...i)}),this.addHook("beforeViewRender",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$3(_NestedRows_brand,e,_onBeforeViewRender).call(e,...i)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$3(_NestedRows_brand,e,_onFilterData).call(e,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$3(_NestedRows_brand,e,_onAfterContextMenuDefaultOptions).call(e,...i)}),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$3(_NestedRows_brand,e,_onAfterGetRowHeader).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$3(_NestedRows_brand,e,_onBeforeOnCellMouseDown).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$3(_NestedRows_brand,e,_onBeforeRemoveRow).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$3(_NestedRows_brand,e,_onAfterRemoveRow).call(e,...i)}),this.addHook("beforeAddChild",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$3(_NestedRows_brand,e,_onBeforeAddChild).call(e,...i)}),this.addHook("afterAddChild",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$3(_NestedRows_brand,e,_onAfterAddChild).call(e,...i)}),this.addHook("beforeDetachChild",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$3(_NestedRows_brand,e,_onBeforeDetachChild).call(e,...i)}),this.addHook("afterDetachChild",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$3(_NestedRows_brand,e,_onAfterDetachChild).call(e,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$3(_NestedRows_brand,e,_onModifyRowHeaderWidth).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$3(_NestedRows_brand,e,_onAfterCreateRow).call(e,...i)}),this.addHook("beforeRowMove",function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return _assertClassBrand$3(_NestedRows_brand,e,_onBeforeRowMove).call(e,...i)}),this.addHook("beforeLoadData",t=>_assertClassBrand$3(_NestedRows_brand,this,_onBeforeLoadData).call(this,t)),this.addHook("beforeUpdateData",t=>_assertClassBrand$3(_NestedRows_brand,this,_onBeforeLoadData).call(this,t)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(t)?this.collapsingUI.expandChildren(t):this.collapsingUI.collapseChildren(t),!1},runOnlyIf:()=>{var e,t;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(i)&&i.col===-1&&i.row>=0},group:SHORTCUTS_GROUP$1,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$1)}disableCoreAPIModifiers(){_classPrivateFieldSet(_skipCoreAPIModifiers,this,!0)}enableCoreAPIModifiers(){_classPrivateFieldSet(_skipCoreAPIModifiers,this,!1)}onModifyRowData(e){if(!_classPrivateFieldGet(_skipCoreAPIModifiers,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!_classPrivateFieldGet(_skipCoreAPIModifiers,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,i){return _classPrivateFieldGet(_skipCoreAPIModifiers,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,t,i),!1)}destroy(){super.destroy()}};function _onBeforeRowMove(e,t,i,r){return this.rowMoveController.onBeforeRowMove(e,t,i,r)}function _onBeforeOnCellMouseDown(e,t,i){this.collapsingUI.toggleState(e,t,i)}function _onFilterData(e,t,i){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(i[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(i[0],null,-1*t),this.dataManager.filterData(e,t,i),_classPrivateFieldSet(_skipRender,this,!0),this.dataManager.getData().slice()}function _onAfterContextMenuDefaultOptions(e){return this.contextMenuUI.appendOptions(e)}function _onAfterGetRowHeader(e,t){this.headersUI.appendLevelIndicators(e,t)}function _onModifyRowHeaderWidth(e){return Math.max(this.headersUI.rowHeaderWidthCache,e)}function _onAfterRemoveRow(e,t,i,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{_classPrivateFieldSet(_skipRender,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function _onBeforeRemoveRow(e,t,i){const r=Array.from(i.reduce((o,a)=>{if(this.dataManager.isParent(a)){const c=this.dataManager.getDataObject(a).__children;return o.add(a),Array.isArray(c)&&c.forEach(u=>o.add(this.dataManager.getRowIndex(u))),o}return o.add(a)},new Set));i.length=0,i.push(...r)}function _onBeforeAddChild(){this.collapsingUI.collapsedRowsStash.stash()}function _onAfterAddChild(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function _onBeforeDetachChild(){this.collapsingUI.collapsedRowsStash.stash()}function _onAfterDetachChild(e,t,i){this.collapsingUI.collapsedRowsStash.shiftStash(i,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function _onAfterCreateRow(){this.dataManager.rewriteCache()}function _onAfterInit(){this.headersUI.updateRowHeaderWidth()}function _onBeforeViewRender(e,t){_classPrivateFieldGet(_skipRender,this)&&(t.skipRender=!0)}function _onBeforeLoadData(e){if(!isArrayOfObjects(e)){error(WRONG_DATA_TYPE_ERROR),this.hot.getSettings()[PLUGIN_KEY$5]=!1,this.disablePlugin();return}this.dataManager.setData(e),this.dataManager.rewriteCache()}var import_es_error_cause$5=__toESM(require_es_error_cause(),1),import_es_array_push$4=__toESM(require_es_array_push(),1),import_es_json_stringify=__toESM(require_es_json_stringify(),1);function _defineProperty$4(e,t,i){return(t=_toPropertyKey$5(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$5(e){var t=_toPrimitive$5(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$5(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Storage=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;_defineProperty$4(this,"rootWindow",void 0),_defineProperty$4(this,"prefix",void 0),_defineProperty$4(this,"savedKeys",[]),this.rootWindow=t,this.prefix=e,this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const i=typeof e>"u"?t:e,r=this.rootWindow.localStorage.getItem(`${this.prefix}_${i}`);return r===null?void 0:JSON.parse(r)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){arrayEach$1(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}},storage_default=Storage,import_es_error_cause$4=__toESM(require_es_error_cause(),1);function _defineProperty$3(e,t,i){return(t=_toPropertyKey$4(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$4(e){var t=_toPrimitive$4(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$4(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}pluginHooks_default.getSingleton().register("persistentStateSave"),pluginHooks_default.getSingleton().register("persistentStateLoad"),pluginHooks_default.getSingleton().register("persistentStateReset");const PLUGIN_KEY$4="persistentState",PLUGIN_PRIORITY$3=0;var PersistentState=class extends BasePlugin{constructor(){super(...arguments),_defineProperty$3(this,"storage",void 0)}static get PLUGIN_KEY(){return PLUGIN_KEY$4}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$3}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$4]}enablePlugin(){this.enabled||(this.storage||(this.storage=new storage_default(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}},import_es_error_cause$3=__toESM(require_es_error_cause(),1),import_es_array_push$3=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$2(e,t){_checkPrivateRedeclaration$2(e,t),t.add(e)}function _checkPrivateRedeclaration$2(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$2(e,t,i){return(t=_toPropertyKey$3(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$3(e){var t=_toPrimitive$3(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$3(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand$2(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$3="search",PLUGIN_PRIORITY$2=190,DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",DEFAULT_CALLBACK=function(e,t,i,r,o){e.getCellMeta(t,i).isSearchResult=o},DEFAULT_QUERY_METHOD=function(e,t,i){return isUndefined$1(e)||e===null||!e.toLocaleLowerCase||e.length===0||isUndefined$1(t)||t===null?!1:t.toString().toLocaleLowerCase(i.locale).indexOf(e.toLocaleLowerCase(i.locale))!==-1};var _Search_brand=new WeakSet,Search=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$2(this,_Search_brand),_defineProperty$2(this,"callback",DEFAULT_CALLBACK),_defineProperty$2(this,"queryMethod",DEFAULT_QUERY_METHOD),_defineProperty$2(this,"searchResultClass",DEFAULT_SEARCH_RESULT_CLASS)}static get PLUGIN_KEY(){return PLUGIN_KEY$3}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$2}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$3]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[PLUGIN_KEY$3];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$2(_Search_brand,e,_onBeforeRenderer).call(e,...r)}),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _assertClassBrand$2(_Search_brand,e,_onBeforeRenderer).call(e,...r)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const r=this.hot.countRows(),o=this.hot.countCols(),a=[],c=this.hot;return rangeEach(0,r-1,u=>{rangeEach(0,o-1,h=>{const d=this.hot.getDataAtCell(u,h),f=this.hot.getCellMeta(u,h),m=f.search.callback||t,v=(f.search.queryMethod||i)(e,d,f);if(v){const _={row:u,col:h,data:d};a.push(_)}m&&m(c,u,h,d,v)})}),a}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){isObject$4(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}};function _onBeforeRenderer(e,t,i,r,o,a){const c=a.className||[];let u=[];typeof c=="string"?u=c.split(" "):u.push(...c),this.isEnabled()&&a.isSearchResult?u.includes(this.searchResultClass)||u.push(`${this.searchResultClass}`):u.includes(this.searchResultClass)&&u.splice(u.indexOf(this.searchResultClass),1),a.className=u.join(" ")}var import_es_error_cause$2=__toESM(require_es_error_cause(),1),import_es_array_push$2=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec$1(e,t){_checkPrivateRedeclaration$1(e,t),t.add(e)}function _checkPrivateRedeclaration$1(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1(e,t,i){return(t=_toPropertyKey$2(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$2(e){var t=_toPrimitive$2(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$2(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand$1(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$2="touchScroll",PLUGIN_PRIORITY$1=200;var _TouchScroll_brand=new WeakSet,TouchScroll=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$1(this,_TouchScroll_brand),_defineProperty$1(this,"scrollbars",[]),_defineProperty$1(this,"clones",[]),_defineProperty$1(this,"lockedCollection",!1),_defineProperty$1(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$2}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$1}static get SETTING_KEYS(){return!0}isEnabled(){return isTouchSupported()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>_assertClassBrand$1(_TouchScroll_brand,this,_onAfterViewRender).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>_assertClassBrand$1(_TouchScroll_brand,this,_onBeforeTouchScroll).call(this)),this.addHook("afterMomentumScroll",()=>_assertClassBrand$1(_TouchScroll_brand,this,_onAfterMomentumScroll).call(this))}};function _onAfterViewRender(){if(this.lockedCollection)return;const{topOverlay:e,bottomOverlay:t,inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),t.clone&&this.scrollbars.push(t),this.scrollbars.push(i),r&&this.scrollbars.push(r),o&&o.clone&&this.scrollbars.push(o),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),o&&o.clone&&this.clones.push(o.clone.wtTable.holder.parentNode)}function _onBeforeTouchScroll(){this.freezeOverlays=!0,arrayEach$1(this.clones,e=>{addClass$1(e,"hide-tween")})}function _onAfterMomentumScroll(){this.freezeOverlays=!1,arrayEach$1(this.clones,e=>{removeClass$1(e,"hide-tween"),addClass$1(e,"show-tween")}),this.hot._registerTimeout(()=>{arrayEach$1(this.clones,e=>{removeClass$1(e,"show-tween")})},400),arrayEach$1(this.scrollbars,e=>{e.refresh(),e.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}var import_es_error_cause$1=__toESM(require_es_error_cause(),1),import_es_array_push$1=__toESM(require_es_array_push(),1),import_es_set_difference_v2=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2=__toESM(require_es_set_union_v2(),1);function _classPrivateMethodInitSpec(e,t){_checkPrivateRedeclaration(e,t),t.add(e)}function _checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty(e,t,i){return(t=_toPropertyKey$1(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey$1(e){var t=_toPrimitive$1(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$1(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand(e,t,i){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$1="trimRows",PLUGIN_PRIORITY=330;var _TrimRows_brand=new WeakSet,TrimRows=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec(this,_TrimRows_brand),_defineProperty(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$1}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$1]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new TrimmingMap),this.trimmedRowsMap.addLocalHook("init",()=>_assertClassBrand(_TrimRows_brand,this,_onMapInit).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[PLUGIN_KEY$1];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),arrayEach$1(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),i=this.isValidConfig(e);let r=t;i&&(r=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeTrimRow",t,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{arrayEach$1(e,a=>{this.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),this.hot.runHooks("afterTrimRow",t,r,i,i&&r.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),i=this.isValidConfig(e);let r=t;const o=this.trimmedRowsMap.getValues().slice(),a=e.length>0;i&&a&&(arrayEach$1(e,u=>{o[u]=!1}),r=arrayReduce(o,(u,h,d)=>(h&&u.push(d),u),[])),this.hot.runHooks("beforeUntrimRow",t,r,i&&a)!==!1&&(i&&a&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",t,r,i&&a,i&&r.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(i=>Number.isInteger(i)&&i>=0&&i<t)}destroy(){super.destroy()}};function _onMapInit(){const e=this.hot.getSettings()[PLUGIN_KEY$1];Array.isArray(e)&&this.hot.batchExecution(()=>{arrayEach$1(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0)}var require_iterators=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/iterators.js"(e,t){t.exports={}}}),require_is_array_iterator_method=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/is-array-iterator-method.js"(e,t){var i=require_well_known_symbol(),r=require_iterators(),o=i("iterator"),a=Array.prototype;t.exports=function(c){return c!==void 0&&(r.Array===c||a[o]===c)}}}),require_get_iterator_method=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/get-iterator-method.js"(e,t){var i=require_classof(),r=require_get_method(),o=require_is_null_or_undefined(),a=require_iterators(),c=require_well_known_symbol(),u=c("iterator");t.exports=function(h){if(!o(h))return r(h,u)||r(h,"@@iterator")||a[i(h)]}}}),require_get_iterator=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/get-iterator.js"(e,t){var i=require_function_call(),r=require_a_callable(),o=require_an_object(),a=require_try_to_string(),c=require_get_iterator_method(),u=TypeError;t.exports=function(h,d){var f=arguments.length<2?c(h):d;if(r(f))return o(i(f,h));throw new u(a(h)+" is not iterable")}}}),require_iterate=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/iterate.js"(e,t){var i=require_function_bind_context(),r=require_function_call(),o=require_an_object(),a=require_try_to_string(),c=require_is_array_iterator_method(),u=require_length_of_array_like(),h=require_object_is_prototype_of(),d=require_get_iterator(),f=require_get_iterator_method(),m=require_iterator_close(),g=TypeError,v=function(b,S){this.stopped=b,this.result=S},_=v.prototype;t.exports=function(b,S,T){var A=T&&T.that,I=!!(T&&T.AS_ENTRIES),R=!!(T&&T.IS_RECORD),O=!!(T&&T.IS_ITERATOR),P=!!(T&&T.INTERRUPTED),L=i(S,A),V,U,$,Z,ie,ue,_e,Ee=function(me){return V&&m(V,"normal",me),new v(!0,me)},pe=function(me){return I?(o(me),P?L(me[0],me[1],Ee):L(me[0],me[1])):P?L(me,Ee):L(me)};if(R)V=b.iterator;else if(O)V=b;else{if(U=f(b),!U)throw new g(a(b)+" is not iterable");if(c(U)){for($=0,Z=u(b);Z>$;$++)if(ie=pe(b[$]),ie&&h(_,ie))return ie;return new v(!1)}V=d(b,U)}for(ue=R?b.next:V.next;!(_e=r(ue,V)).done;){try{ie=pe(_e.value)}catch(me){m(V,"throw",me)}if(typeof ie=="object"&&ie&&h(_,ie))return ie}return new v(!1)}}}),require_create_property=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/create-property.js"(e,t){var i=require_descriptors(),r=require_object_define_property(),o=require_create_property_descriptor();t.exports=function(a,c,u){i?r.f(a,c,o(0,u)):a[c]=u}}}),require_es_object_from_entries=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.object.from-entries.js"(){var e=require_export(),t=require_iterate(),i=require_create_property();e({target:"Object",stat:!0},{fromEntries:function(o){var a={};return t(o,function(c,u){i(a,c,u)},{AS_ENTRIES:!0}),a}})}}),import_es_array_push=__toESM(require_es_array_push(),1),import_es_object_from_entries=__toESM(require_es_object_from_entries(),1);const SHORTCUTS_GROUP="undoRedo",PLUGIN_KEY="undoRedo";function UndoRedo(e){const t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(r,o){const a=r&&r.length;if(!a||!r.find(h=>{const[,,d,f]=h;return d!==f}))return;const u=()=>{const h=r.reduce((f,m)=>(f.push([...m]),f),[]);arrayEach$1(h,f=>{f[1]=e.propToCol(f[1])});const d=a>1?this.getSelected():[[h[0][0],h[0][1]]];return new UndoRedo.ChangeAction(h,d)};t.done(u,o)}),e.addHook("afterCreateRow",(r,o,a)=>{t.done(()=>new UndoRedo.CreateRowAction(r,o),a)});const i=(r,o,a,c)=>{const u=["visualRow","visualCol","row","col","prop"],h=u.length,d=[];return rangeEach(a,c,f=>{rangeEach(r,o,m=>{const g=e.getCellMeta(m,f);if(Object.keys(g).length!==h){const v=Object.fromEntries(Object.entries(g).filter(_=>{let[b]=_;return u.includes(b)===!1}));d.push([g.visualRow,g.visualCol,v])}})}),d};e.addHook("beforeRemoveRow",(r,o,a,c)=>{const u=()=>{const h=e.toPhysicalRow(r),d=h+o-1,f=deepClone(t.instance.getSourceData(h,0,h+o-1,t.instance.countSourceCols()-1));return new UndoRedo.RemoveRowAction(h,f,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence(),i(h,d,0,e.countCols()-1))};t.done(u,c)}),e.addHook("afterCreateCol",(r,o,a)=>{t.done(()=>new UndoRedo.CreateColumnAction(r,o),a)}),e.addHook("beforeRemoveCol",(r,o,a,c)=>{const u=()=>{const h=t.instance.getSourceDataArray(),d=(t.instance.countCols()+r)%t.instance.countCols(),f=d+o-1,m=[],g=[],v=[];rangeEach(h.length-1,S=>{const T=[],A=h[S];rangeEach(d,f,I=>{T.push(A[e.toPhysicalColumn(I)])}),m.push(T)}),rangeEach(o-1,S=>{v.push(e.toPhysicalColumn(d+S))}),Array.isArray(e.getSettings().colHeaders)&&rangeEach(o-1,S=>{g.push(e.getSettings().colHeaders[e.toPhysicalColumn(d+S)]||null)});const _=e.columnIndexMapper.getIndexesSequence(),b=e.rowIndexMapper.getIndexesSequence();return new UndoRedo.RemoveColumnAction(d,v,m,g,_,b,e.getSettings().fixedColumnsStart,i(0,e.countRows(),d,f))};t.done(u,c)}),e.addHook("beforeCellAlignment",(r,o,a,c)=>{t.done(()=>new UndoRedo.CellAlignmentAction(r,o,a,c))}),e.addHook("beforeFilter",(r,o)=>{t.done(()=>new UndoRedo.FiltersAction(r,o))}),e.addHook("beforeRowMove",(r,o)=>{r!==!1&&t.done(()=>new UndoRedo.RowMoveAction(r,o))}),e.addHook("beforeColumnMove",(r,o)=>{r!==!1&&t.done(()=>new UndoRedo.ColumnMoveAction(r,o))}),e.addHook("beforeMergeCells",(r,o)=>{o||t.done(()=>new UndoRedo.MergeCellsAction(e,r))}),e.addHook("afterUnmergeCells",(r,o)=>{o||t.done(()=>new UndoRedo.UnmergeCellsAction(e,r))}),e.addHook("beforeColumnSort",(r,o,a)=>{a&&t.done(()=>new UndoRedo.ColumnSortAction(r,o))}),e.addHook("afterInit",()=>{t.init()})}UndoRedo.prototype.done=function(e,t){if(this.ignoreNewActions||t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,t)===!1)return;const a=e(),c=this.undoneActions.slice();this.doneActions.push(a),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",c),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",c,this.undoneActions.slice())},UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){const e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);const t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());const i=deepClone(t);if(this.instance.runHooks("beforeUndo",i)===!1)return;this.ignoreNewActions=!0;const o=this,a=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",a),t.undo(this.instance,()=>{o.ignoreNewActions=!1,o.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice()),this.instance.runHooks("afterUndo",i)}},UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){const e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);const t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const i=deepClone(t);if(this.instance.runHooks("beforeRedo",i)===!1)return;this.ignoreNewActions=!0;const o=this,a=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",a),t.redo(this.instance,()=>{o.ignoreNewActions=!1,o.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",a,this.doneActions.slice()),this.instance.runHooks("afterRedo",i)}},UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0},UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},UndoRedo.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},UndoRedo.prototype.isEnabled=function(){return this.enabled},UndoRedo.prototype.enable=function(){if(this.isEnabled())return;const e=this.instance;this.enabled=!0,exposeUndoRedoMethods(e),this.registerShortcuts(),e.addHook("afterChange",onAfterChange)},UndoRedo.prototype.disable=function(){if(!this.isEnabled())return;const e=this.instance;this.enabled=!1,removeExposedUndoRedoMethods(e),this.unregisterShortcuts(),e.removeHook("afterChange",onAfterChange)},UndoRedo.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},UndoRedo.Action=function(){},UndoRedo.Action.prototype.undo=function(){},UndoRedo.Action.prototype.redo=function(){},UndoRedo.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"},inherit$1(UndoRedo.ChangeAction,UndoRedo.Action),UndoRedo.ChangeAction.prototype.undo=function(e,t){const i=deepClone(this.changes),r=e.countEmptyRows(!0),o=e.countEmptyCols(!0);for(let c=0,u=i.length;c<u;c++)i[c].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(i,null,null,"UndoRedo.undo");for(let c=0,u=i.length;c<u;c++){const[h,d]=i[c];e.getSettings().minSpareRows&&h+1+e.getSettings().minSpareRows===e.countRows()&&r===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(h+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&d+1+e.getSettings().minSpareCols===e.countCols()&&o===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(d+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}const a=e.getSelectedLast();if(a!==void 0){const[c,u]=i[0],[h,d]=a,f=e.view.getFirstFullyVisibleRow(),m=e.view.getFirstFullyVisibleColumn(),g=c>=f,v=u>=m;if((g&&v)===!1&&(h!==c||d!==u)===!0){const S={row:c,col:u};g===!1&&(S.verticalSnap="top"),v===!1&&(S.horizontalSnap="start"),e.scrollViewportTo(S)}}e.selectCells(this.selected,!1,!1)},UndoRedo.ChangeAction.prototype.redo=function(e,t){const i=deepClone(this.changes);for(let r=0,o=i.length;r<o;r++)i[r].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(i,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)},UndoRedo.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"},inherit$1(UndoRedo.CreateRowAction,UndoRedo.Action),UndoRedo.CreateRowAction.prototype.undo=function(e,t){const i=e.countRows(),r=e.getSettings().minSpareRows;this.index>=i&&this.index-r<i&&(this.index-=r),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},UndoRedo.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},UndoRedo.RemoveRowAction=function(e,t,i,r,o,a){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=i,this.fixedRowsTop=r,this.rowIndexesSequence=o,this.removedCellMetas=a},inherit$1(UndoRedo.RemoveRowAction,UndoRedo.Action),UndoRedo.RemoveRowAction.prototype.undo=function(e,t){const i=e.getSettings(),r=[];i.fixedRowsBottom=this.fixedRowsBottom,i.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,a)=>{Object.keys(o).forEach(c=>{const u=parseInt(c,10);r.push([this.index+a,isNaN(u)?c:u,o[c]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(o=>{let[a,c,u]=o;e.setCellMetaObject(a,c,u)}),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},UndoRedo.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},UndoRedo.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"},inherit$1(UndoRedo.CreateColumnAction,UndoRedo.Action),UndoRedo.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},UndoRedo.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},UndoRedo.RemoveColumnAction=function(e,t,i,r,o,a,c,u){this.index=e,this.indexes=t,this.data=i,this.amount=this.data[0].length,this.headers=r,this.columnPositions=o.slice(0),this.rowPositions=a.slice(0),this.actionType="remove_col",this.fixedColumnsStart=c,this.removedCellMetas=u},inherit$1(UndoRedo.RemoveColumnAction,UndoRedo.Action),UndoRedo.RemoveColumnAction.prototype.undo=function(e,t){const i=e.getSettings();i.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),o=(d,f,m)=>m[this.indexes.indexOf(r[f])],a=this.data.length,c=[];for(let d=0;d<a;d++)c.push(arrayMap$1(this.data[d],o));const u=arrayMap$1(this.headers,o),h=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),arrayEach$1(e.getSourceDataArray(),(d,f)=>{arrayEach$1(r,(m,g)=>{d[m]=c[f][g],h.push([f,m,d[m]])})}),e.setSourceDataAtCell(h,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&arrayEach$1(u,(d,f)=>{e.getSettings().colHeaders[r[f]]=d}),this.removedCellMetas.forEach(d=>{let[f,m,g]=d;e.setCellMetaObject(f,m,g)}),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()},UndoRedo.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},UndoRedo.CellAlignmentAction=function(e,t,i,r){this.stateBefore=e,this.range=t,this.type=i,this.alignment=r},UndoRedo.CellAlignmentAction.prototype.undo=function(e,t){arrayEach$1(this.range,i=>{i.forAll((r,o)=>{r>=0&&o>=0&&e.setCellMeta(r,o,"className",this.stateBefore[r][o]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()},UndoRedo.CellAlignmentAction.prototype.redo=function(e,t){align(this.range,this.type,this.alignment,(i,r)=>e.getCellMeta(i,r),(i,r,o,a)=>e.setCellMeta(i,r,o,a)),e.addHookOnce("afterViewRender",t),e.render()},UndoRedo.FiltersAction=function(e,t){this.previousConditionsStack=t,this.conditionsStack=e,this.actionType="filter"},inherit$1(UndoRedo.FiltersAction,UndoRedo.Action),UndoRedo.FiltersAction.prototype.undo=function(e,t){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),this.previousConditionsStack&&i.conditionCollection.importAllConditions(this.previousConditionsStack),i.filter()},UndoRedo.FiltersAction.prototype.redo=function(e,t){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),i.conditionCollection.importAllConditions(this.conditionsStack),i.filter()};var MergeCellsAction=class extends UndoRedo.Action{constructor(e,t){super(),this.cellRange=t;const i=this.cellRange.getTopStartCorner(),r=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(i.row,i.col,r.row,r.col)}undo(e,t){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.unmergeRange(this.cellRange,!0);const r=this.cellRange.getTopStartCorner();e.populateFromArray(r.row,r.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,t){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.mergeRange(this.cellRange)}};UndoRedo.MergeCellsAction=MergeCellsAction;var UnmergeCellsAction=class extends UndoRedo.Action{constructor(e,t){super(),this.cellRange=t}undo(e,t){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.mergeRange(this.cellRange,!0)}redo(e,t){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.unmergeRange(this.cellRange,!0),e.render()}};UndoRedo.UnmergeCellsAction=UnmergeCellsAction,UndoRedo.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalRowIndex=t,this.actionType="row_move"},inherit$1(UndoRedo.RowMoveAction,UndoRedo.Action),UndoRedo.RowMoveAction.prototype.undo=function(e,t){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),getMoves(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:a,to:c}=o;a<c&&(c-=1),i.moveRow(c,a)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},UndoRedo.RowMoveAction.prototype.redo=function(e,t){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),i.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)},UndoRedo.ColumnMoveAction=function(e,t){this.columns=e.slice(),this.finalColumnIndex=t,this.actionType="col_move"},inherit$1(UndoRedo.ColumnMoveAction,UndoRedo.Action),UndoRedo.ColumnMoveAction.prototype.undo=function(e,t){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t),getMoves(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:a,to:c}=o;a<c&&(c-=1),i.moveColumn(c,a)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)},UndoRedo.ColumnMoveAction.prototype.redo=function(e,t){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t),i.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)},UndoRedo.ColumnSortAction=function(e,t){this.previousSortState=e,this.nextSortState=t},inherit$1(UndoRedo.ColumnSortAction,UndoRedo.Action),UndoRedo.ColumnSortAction.prototype.undo=function(e,t){const i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting"),o=r.isEnabled()?r:i;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),t()},UndoRedo.ColumnSortAction.prototype.redo=function(e,t){const i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting");(r.isEnabled()?r:i).sort(this.nextSortState),t()},UndoRedo.prototype.init=function(){const e=this.instance.getSettings().undo,t=typeof e>"u"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},UndoRedo.prototype.registerShortcuts=function(){const t=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:o=>!o.altKey,group:SHORTCUTS_GROUP};t.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)},UndoRedo.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP)};function onAfterChange(e,t){const i=this;if(t==="loadData")return i.undoRedo.clear()}function exposeUndoRedoMethods(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function removeExposedUndoRedoMethods(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}const hook=pluginHooks_default.getSingleton();hook.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()}),hook.register("beforeUndo"),hook.register("afterUndo"),hook.register("beforeRedo"),hook.register("afterRedo"),UndoRedo.PLUGIN_KEY=PLUGIN_KEY,UndoRedo.SETTING_KEYS=!0;var undoRedo_default=UndoRedo;function registerAllPlugins(){registerPlugin(AutoColumnSize),registerPlugin(Autofill),registerPlugin(AutoRowSize),registerPlugin(BindRowsWithHeaders),registerPlugin(CollapsibleColumns),registerPlugin(ColumnSorting),registerPlugin(ColumnSummary),registerPlugin(Comments),registerPlugin(ContextMenu),registerPlugin(CopyPaste),registerPlugin(CustomBorders),registerPlugin(DragToScroll),registerPlugin(DropdownMenu),registerPlugin(ExportFile),registerPlugin(Filters),registerPlugin(Formulas),registerPlugin(HiddenColumns),registerPlugin(HiddenRows),registerPlugin(ManualColumnFreeze),registerPlugin(ManualColumnMove),registerPlugin(ManualColumnResize),registerPlugin(ManualRowMove),registerPlugin(ManualRowResize),registerPlugin(MergeCells),registerPlugin(MultiColumnSorting),registerPlugin(MultipleSelectionHandles),registerPlugin(NestedHeaders),registerPlugin(NestedRows),registerPlugin(PersistentState),registerPlugin(Search),registerPlugin(TouchScroll),registerPlugin(TrimRows),registerPlugin(undoRedo_default)}function registerAllModules(){registerAllEditors(),registerAllRenderers(),registerAllValidators(),registerAllCellTypes(),registerAllPlugins()}var import_es_error_cause=__toESM(require_es_error_cause(),1);function jQueryWrapper(e){const t=typeof window>"u"?!1:window.jQuery;t&&(t.fn.handsontable=function(i){const r=this.first();let o=r.data("handsontable");if(typeof i!="string"){const d=i||{};return o?o.updateSettings(d):(o=new e.Core(r[0],d),r.data("handsontable",o),o.init()),r}let a;if(o)if(typeof o[i]<"u"){for(var c=arguments.length,u=new Array(c>1?c-1:0),h=1;h<c;h++)u[h-1]=arguments[h];a=o[i].call(o,...u),i==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${i}`);return a})}var _Handsontable$cellTyp,_Handsontable$editors,_Handsontable$rendere,_Handsontable$validat,_Handsontable$plugins;registerAllModules(),jQueryWrapper(base_default),base_default.__GhostTable=ghostTable_default$1,base_default._getListenersCounter=getListenersCounter,base_default._getRegisteredMapsCounter=getRegisteredMapsCounter,base_default.EventManager=eventManager_default;const HELPERS=[array_exports,browser_exports,data_exports,date_exports,feature_exports,function_exports,mixed_exports,number_exports,object_exports,string_exports,unicode_exports,parseTable_exports],DOM=[element_exports,event_exports];base_default.helper={},base_default.dom={},arrayEach$1(HELPERS,e=>{arrayEach$1(Object.getOwnPropertyNames(e),t=>{t.charAt(0)!=="_"&&(base_default.helper[t]=e[t])})}),arrayEach$1(DOM,e=>{arrayEach$1(Object.getOwnPropertyNames(e),t=>{t.charAt(0)!=="_"&&(base_default.dom[t]=e[t])})}),base_default.cellTypes=(_Handsontable$cellTyp=base_default.cellTypes)!==null&&_Handsontable$cellTyp!==void 0?_Handsontable$cellTyp:{},arrayEach$1(getNames(),e=>{base_default.cellTypes[e]=_getItem(e)}),base_default.cellTypes.registerCellType=_register,base_default.cellTypes.getCellType=_getItem,base_default.editors=(_Handsontable$editors=base_default.editors)!==null&&_Handsontable$editors!==void 0?_Handsontable$editors:{},arrayEach$1(getNames$3(),e=>{base_default.editors[`${toUpperCaseFirst(e)}Editor`]=_getItem$3(e)}),base_default.editors.registerEditor=_register$3,base_default.editors.getEditor=_getItem$3,base_default.renderers=(_Handsontable$rendere=base_default.renderers)!==null&&_Handsontable$rendere!==void 0?_Handsontable$rendere:{},arrayEach$1(getNames$2(),e=>{const t=_getItem$2(e);e==="base"&&(base_default.renderers.cellDecorator=t),base_default.renderers[`${toUpperCaseFirst(e)}Renderer`]=t}),base_default.renderers.registerRenderer=_register$2,base_default.renderers.getRenderer=_getItem$2,base_default.validators=(_Handsontable$validat=base_default.validators)!==null&&_Handsontable$validat!==void 0?_Handsontable$validat:{},arrayEach$1(getNames$1(),e=>{base_default.validators[`${toUpperCaseFirst(e)}Validator`]=_getItem$1(e)}),base_default.validators.registerValidator=_register$1,base_default.validators.getValidator=_getItem$1,base_default.plugins=(_Handsontable$plugins=base_default.plugins)!==null&&_Handsontable$plugins!==void 0?_Handsontable$plugins:{},arrayEach$1(getPluginsNames(),e=>{base_default.plugins[e]=getPlugin(e)}),base_default.plugins[`${toUpperCaseFirst(BasePlugin.PLUGIN_KEY)}Plugin`]=BasePlugin,base_default.plugins.registerPlugin=registerPlugin,base_default.plugins.getPlugin=getPlugin;var handsontable_default=base_default,LuxonError=class extends Error{},InvalidDateTimeError=class extends LuxonError{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}},InvalidIntervalError=class extends LuxonError{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}},InvalidDurationError=class extends LuxonError{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}},ConflictingSpecificationError=class extends LuxonError{},InvalidUnitError=class extends LuxonError{constructor(e){super(`Invalid unit ${e}`)}},InvalidArgumentError=class extends LuxonError{},ZoneIsAbstractError=class extends LuxonError{constructor(){super("Zone is an abstract class")}};const n="numeric",s="short",l="long",DATE_SHORT={year:n,month:n,day:n},DATE_MED={year:n,month:s,day:n},DATE_MED_WITH_WEEKDAY={year:n,month:s,day:n,weekday:s},DATE_FULL={year:n,month:l,day:n},DATE_HUGE={year:n,month:l,day:n,weekday:l},TIME_SIMPLE={hour:n,minute:n},TIME_WITH_SECONDS={hour:n,minute:n,second:n},TIME_WITH_SHORT_OFFSET={hour:n,minute:n,second:n,timeZoneName:s},TIME_WITH_LONG_OFFSET={hour:n,minute:n,second:n,timeZoneName:l},TIME_24_SIMPLE={hour:n,minute:n,hourCycle:"h23"},TIME_24_WITH_SECONDS={hour:n,minute:n,second:n,hourCycle:"h23"},TIME_24_WITH_SHORT_OFFSET={hour:n,minute:n,second:n,hourCycle:"h23",timeZoneName:s},TIME_24_WITH_LONG_OFFSET={hour:n,minute:n,second:n,hourCycle:"h23",timeZoneName:l},DATETIME_SHORT={year:n,month:n,day:n,hour:n,minute:n},DATETIME_SHORT_WITH_SECONDS={year:n,month:n,day:n,hour:n,minute:n,second:n},DATETIME_MED={year:n,month:s,day:n,hour:n,minute:n},DATETIME_MED_WITH_SECONDS={year:n,month:s,day:n,hour:n,minute:n,second:n},DATETIME_MED_WITH_WEEKDAY={year:n,month:s,day:n,weekday:s,hour:n,minute:n},DATETIME_FULL={year:n,month:l,day:n,hour:n,minute:n,timeZoneName:s},DATETIME_FULL_WITH_SECONDS={year:n,month:l,day:n,hour:n,minute:n,second:n,timeZoneName:s},DATETIME_HUGE={year:n,month:l,day:n,weekday:l,hour:n,minute:n,timeZoneName:l},DATETIME_HUGE_WITH_SECONDS={year:n,month:l,day:n,weekday:l,hour:n,minute:n,second:n,timeZoneName:l};var Zone=class{get type(){throw new ZoneIsAbstractError}get name(){throw new ZoneIsAbstractError}get ianaName(){return this.name}get isUniversal(){throw new ZoneIsAbstractError}offsetName(e,t){throw new ZoneIsAbstractError}formatOffset(e,t){throw new ZoneIsAbstractError}offset(e){throw new ZoneIsAbstractError}equals(e){throw new ZoneIsAbstractError}get isValid(){throw new ZoneIsAbstractError}};let singleton$1=null;var SystemZone=class ms extends Zone{static get instance(){return singleton$1===null&&(singleton$1=new ms),singleton$1}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(t,{format:i,locale:r}){return parseZoneInfo(t,i,r)}formatOffset(t,i){return formatOffset(this.offset(t),i)}offset(t){return-new Date(t).getTimezoneOffset()}equals(t){return t.type==="system"}get isValid(){return!0}};let dtfCache={};function makeDTF(e){return dtfCache[e]||(dtfCache[e]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),dtfCache[e]}const typeToPos={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function hackyOffset(e,t){const i=e.format(t).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(i),[,o,a,c,u,h,d,f]=r;return[c,o,a,u,h,d,f]}function partsOffset(e,t){const i=e.formatToParts(t),r=[];for(let o=0;o<i.length;o++){const{type:a,value:c}=i[o],u=typeToPos[a];a==="era"?r[u]=c:isUndefined(u)||(r[u]=parseInt(c,10))}return r}let ianaZoneCache={};var IANAZone=class cr extends Zone{static create(t){return ianaZoneCache[t]||(ianaZoneCache[t]=new cr(t)),ianaZoneCache[t]}static resetCache(){ianaZoneCache={},dtfCache={}}static isValidSpecifier(t){return this.isValidZone(t)}static isValidZone(t){if(!t)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:t}).format(),!0}catch{return!1}}constructor(t){super(),this.zoneName=t,this.valid=cr.isValidZone(t)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(t,{format:i,locale:r}){return parseZoneInfo(t,i,r,this.name)}formatOffset(t,i){return formatOffset(this.offset(t),i)}offset(t){const i=new Date(t);if(isNaN(i))return NaN;const r=makeDTF(this.name);let[o,a,c,u,h,d,f]=r.formatToParts?partsOffset(r,i):hackyOffset(r,i);u==="BC"&&(o=-Math.abs(o)+1);const g=objToLocalTS({year:o,month:a,day:c,hour:h===24?0:h,minute:d,second:f,millisecond:0});let v=+i;const _=v%1e3;return v-=_>=0?_:1e3+_,(g-v)/6e4}equals(t){return t.type==="iana"&&t.name===this.name}get isValid(){return this.valid}};let intlLFCache={};function getCachedLF(e,t={}){const i=JSON.stringify([e,t]);let r=intlLFCache[i];return r||(r=new Intl.ListFormat(e,t),intlLFCache[i]=r),r}let intlDTCache={};function getCachedDTF(e,t={}){const i=JSON.stringify([e,t]);let r=intlDTCache[i];return r||(r=new Intl.DateTimeFormat(e,t),intlDTCache[i]=r),r}let intlNumCache={};function getCachedINF(e,t={}){const i=JSON.stringify([e,t]);let r=intlNumCache[i];return r||(r=new Intl.NumberFormat(e,t),intlNumCache[i]=r),r}let intlRelCache={};function getCachedRTF(e,t={}){const{base:i,...r}=t,o=JSON.stringify([e,r]);let a=intlRelCache[o];return a||(a=new Intl.RelativeTimeFormat(e,t),intlRelCache[o]=a),a}let sysLocaleCache=null;function systemLocale(){return sysLocaleCache||(sysLocaleCache=new Intl.DateTimeFormat().resolvedOptions().locale,sysLocaleCache)}let weekInfoCache={};function getCachedWeekInfo(e){let t=weekInfoCache[e];if(!t){const i=new Intl.Locale(e);t="getWeekInfo"in i?i.getWeekInfo():i.weekInfo,weekInfoCache[e]=t}return t}function parseLocaleString(e){const t=e.indexOf("-x-");t!==-1&&(e=e.substring(0,t));const i=e.indexOf("-u-");if(i===-1)return[e];{let r,o;try{r=getCachedDTF(e).resolvedOptions(),o=e}catch{const h=e.substring(0,i);r=getCachedDTF(h).resolvedOptions(),o=h}const{numberingSystem:a,calendar:c}=r;return[o,a,c]}}function intlConfigString(e,t,i){return(i||t)&&(e.includes("-u-")||(e+="-u"),i&&(e+=`-ca-${i}`),t&&(e+=`-nu-${t}`)),e}function mapMonths(e){const t=[];for(let i=1;i<=12;i++){const r=DateTime.utc(2009,i,1);t.push(e(r))}return t}function mapWeekdays(e){const t=[];for(let i=1;i<=7;i++){const r=DateTime.utc(2016,11,13+i);t.push(e(r))}return t}function listStuff(e,t,i,r){const o=e.listingMode();return o==="error"?null:o==="en"?i(t):r(t)}function supportsFastNumbers(e){return e.numberingSystem&&e.numberingSystem!=="latn"?!1:e.numberingSystem==="latn"||!e.locale||e.locale.startsWith("en")||new Intl.DateTimeFormat(e.intl).resolvedOptions().numberingSystem==="latn"}var PolyNumberFormatter=class{constructor(e,t,i){this.padTo=i.padTo||0,this.floor=i.floor||!1;const{padTo:r,floor:o,...a}=i;if(!t||Object.keys(a).length>0){const c={useGrouping:!1,...i};i.padTo>0&&(c.minimumIntegerDigits=i.padTo),this.inf=getCachedINF(e,c)}}format(e){if(this.inf){const t=this.floor?Math.floor(e):e;return this.inf.format(t)}else{const t=this.floor?Math.floor(e):roundTo(e,3);return padStart(t,this.padTo)}}},PolyDateFormatter=class{constructor(e,t,i){this.opts=i,this.originalZone=void 0;let r;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const a=-1*(e.offset/60),c=a>=0?`Etc/GMT+${a}`:`Etc/GMT${a}`;e.offset!==0&&IANAZone.create(c).valid?(r=c,this.dt=e):(r="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,r=e.zone.name):(r="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const o={...this.opts};o.timeZone=o.timeZone||r,this.dtf=getCachedDTF(t,o)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(t=>{if(t.type==="timeZoneName"){const i=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...t,value:i}}else return t}):e}resolvedOptions(){return this.dtf.resolvedOptions()}},PolyRelFormatter=class{constructor(e,t,i){this.opts={style:"long",...i},!t&&hasRelative()&&(this.rtf=getCachedRTF(e,i))}format(e,t){return this.rtf?this.rtf.format(e,t):formatRelativeTime(t,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]}};const fallbackWeekSettings={firstDay:1,minimalDays:4,weekend:[6,7]};var Locale$1=class ei{static fromOpts(t){return ei.create(t.locale,t.numberingSystem,t.outputCalendar,t.weekSettings,t.defaultToEN)}static create(t,i,r,o,a=!1){const c=t||Settings.defaultLocale,u=c||(a?"en-US":systemLocale()),h=i||Settings.defaultNumberingSystem,d=r||Settings.defaultOutputCalendar,f=validateWeekSettings(o)||Settings.defaultWeekSettings;return new ei(u,h,d,f,c)}static resetCache(){sysLocaleCache=null,intlDTCache={},intlNumCache={},intlRelCache={}}static fromObject({locale:t,numberingSystem:i,outputCalendar:r,weekSettings:o}={}){return ei.create(t,i,r,o)}constructor(t,i,r,o,a){const[c,u,h]=parseLocaleString(t);this.locale=c,this.numberingSystem=i||u||null,this.outputCalendar=r||h||null,this.weekSettings=o,this.intl=intlConfigString(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=a,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=supportsFastNumbers(this)),this.fastNumbersCached}listingMode(){const t=this.isEnglish(),i=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return t&&i?"en":"intl"}clone(t){return!t||Object.getOwnPropertyNames(t).length===0?this:ei.create(t.locale||this.specifiedLocale,t.numberingSystem||this.numberingSystem,t.outputCalendar||this.outputCalendar,validateWeekSettings(t.weekSettings)||this.weekSettings,t.defaultToEN||!1)}redefaultToEN(t={}){return this.clone({...t,defaultToEN:!0})}redefaultToSystem(t={}){return this.clone({...t,defaultToEN:!1})}months(t,i=!1){return listStuff(this,t,months,()=>{const r=i?{month:t,day:"numeric"}:{month:t},o=i?"format":"standalone";return this.monthsCache[o][t]||(this.monthsCache[o][t]=mapMonths(a=>this.extract(a,r,"month"))),this.monthsCache[o][t]})}weekdays(t,i=!1){return listStuff(this,t,weekdays,()=>{const r=i?{weekday:t,year:"numeric",month:"long",day:"numeric"}:{weekday:t},o=i?"format":"standalone";return this.weekdaysCache[o][t]||(this.weekdaysCache[o][t]=mapWeekdays(a=>this.extract(a,r,"weekday"))),this.weekdaysCache[o][t]})}meridiems(){return listStuff(this,void 0,()=>meridiems,()=>{if(!this.meridiemCache){const t={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[DateTime.utc(2016,11,13,9),DateTime.utc(2016,11,13,19)].map(i=>this.extract(i,t,"dayperiod"))}return this.meridiemCache})}eras(t){return listStuff(this,t,eras,()=>{const i={era:t};return this.eraCache[t]||(this.eraCache[t]=[DateTime.utc(-40,1,1),DateTime.utc(2017,1,1)].map(r=>this.extract(r,i,"era"))),this.eraCache[t]})}extract(t,i,r){const o=this.dtFormatter(t,i),a=o.formatToParts(),c=a.find(u=>u.type.toLowerCase()===r);return c?c.value:null}numberFormatter(t={}){return new PolyNumberFormatter(this.intl,t.forceSimple||this.fastNumbers,t)}dtFormatter(t,i={}){return new PolyDateFormatter(t,this.intl,i)}relFormatter(t={}){return new PolyRelFormatter(this.intl,this.isEnglish(),t)}listFormatter(t={}){return getCachedLF(this.intl,t)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:hasLocaleWeekInfo()?getCachedWeekInfo(this.locale):fallbackWeekSettings}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(t){return this.locale===t.locale&&this.numberingSystem===t.numberingSystem&&this.outputCalendar===t.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}};let singleton=null;var FixedOffsetZone=class ti extends Zone{static get utcInstance(){return singleton===null&&(singleton=new ti(0)),singleton}static instance(t){return t===0?ti.utcInstance:new ti(t)}static parseSpecifier(t){if(t){const i=t.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(i)return new ti(signedOffset(i[1],i[2]))}return null}constructor(t){super(),this.fixed=t}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${formatOffset(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${formatOffset(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(t,i){return formatOffset(this.fixed,i)}get isUniversal(){return!0}offset(){return this.fixed}equals(t){return t.type==="fixed"&&t.fixed===this.fixed}get isValid(){return!0}},InvalidZone=class extends Zone{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}};function normalizeZone(e,t){let i;if(isUndefined(e)||e===null)return t;if(e instanceof Zone)return e;if(isString$1(e)){const r=e.toLowerCase();return r==="default"?t:r==="local"||r==="system"?SystemZone.instance:r==="utc"||r==="gmt"?FixedOffsetZone.utcInstance:FixedOffsetZone.parseSpecifier(r)||IANAZone.create(e)}else return isNumber(e)?FixedOffsetZone.instance(e):typeof e=="object"&&"offset"in e&&typeof e.offset=="function"?e:new InvalidZone(e)}const numberingSystems={arab:"[\u0660-\u0669]",arabext:"[\u06F0-\u06F9]",bali:"[\u1B50-\u1B59]",beng:"[\u09E6-\u09EF]",deva:"[\u0966-\u096F]",fullwide:"[\uFF10-\uFF19]",gujr:"[\u0AE6-\u0AEF]",hanidec:"[\u3007|\u4E00|\u4E8C|\u4E09|\u56DB|\u4E94|\u516D|\u4E03|\u516B|\u4E5D]",khmr:"[\u17E0-\u17E9]",knda:"[\u0CE6-\u0CEF]",laoo:"[\u0ED0-\u0ED9]",limb:"[\u1946-\u194F]",mlym:"[\u0D66-\u0D6F]",mong:"[\u1810-\u1819]",mymr:"[\u1040-\u1049]",orya:"[\u0B66-\u0B6F]",tamldec:"[\u0BE6-\u0BEF]",telu:"[\u0C66-\u0C6F]",thai:"[\u0E50-\u0E59]",tibt:"[\u0F20-\u0F29]",latn:"\\d"},numberingSystemsUTF16={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},hanidecChars=numberingSystems.hanidec.replace(/[\[|\]]/g,"").split("");function parseDigits(e){let t=parseInt(e,10);if(isNaN(t)){t="";for(let i=0;i<e.length;i++){const r=e.charCodeAt(i);if(e[i].search(numberingSystems.hanidec)!==-1)t+=hanidecChars.indexOf(e[i]);else for(const o in numberingSystemsUTF16){const[a,c]=numberingSystemsUTF16[o];r>=a&&r<=c&&(t+=r-a)}}return parseInt(t,10)}else return t}let digitRegexCache={};function resetDigitRegexCache(){digitRegexCache={}}function digitRegex({numberingSystem:e},t=""){const i=e||"latn";return digitRegexCache[i]||(digitRegexCache[i]={}),digitRegexCache[i][t]||(digitRegexCache[i][t]=new RegExp(`${numberingSystems[i]}${t}`)),digitRegexCache[i][t]}let now$1=()=>Date.now(),defaultZone="system",defaultLocale=null,defaultNumberingSystem=null,defaultOutputCalendar=null,twoDigitCutoffYear=60,throwOnInvalid,defaultWeekSettings=null;var Settings=class{static get now(){return now$1}static set now(e){now$1=e}static set defaultZone(e){defaultZone=e}static get defaultZone(){return normalizeZone(defaultZone,SystemZone.instance)}static get defaultLocale(){return defaultLocale}static set defaultLocale(e){defaultLocale=e}static get defaultNumberingSystem(){return defaultNumberingSystem}static set defaultNumberingSystem(e){defaultNumberingSystem=e}static get defaultOutputCalendar(){return defaultOutputCalendar}static set defaultOutputCalendar(e){defaultOutputCalendar=e}static get defaultWeekSettings(){return defaultWeekSettings}static set defaultWeekSettings(e){defaultWeekSettings=validateWeekSettings(e)}static get twoDigitCutoffYear(){return twoDigitCutoffYear}static set twoDigitCutoffYear(e){twoDigitCutoffYear=e%100}static get throwOnInvalid(){return throwOnInvalid}static set throwOnInvalid(e){throwOnInvalid=e}static resetCaches(){Locale$1.resetCache(),IANAZone.resetCache(),DateTime.resetCache(),resetDigitRegexCache()}},Invalid=class{constructor(e,t){this.reason=e,this.explanation=t}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}};const nonLeapLadder=[0,31,59,90,120,151,181,212,243,273,304,334],leapLadder=[0,31,60,91,121,152,182,213,244,274,305,335];function unitOutOfRange(e,t){return new Invalid("unit out of range",`you specified ${t} (of type ${typeof t}) as a ${e}, which is invalid`)}function dayOfWeek(e,t,i){const r=new Date(Date.UTC(e,t-1,i));e<100&&e>=0&&r.setUTCFullYear(r.getUTCFullYear()-1900);const o=r.getUTCDay();return o===0?7:o}function computeOrdinal(e,t,i){return i+(isLeapYear(e)?leapLadder:nonLeapLadder)[t-1]}function uncomputeOrdinal(e,t){const i=isLeapYear(e)?leapLadder:nonLeapLadder,r=i.findIndex(a=>a<t),o=t-i[r];return{month:r+1,day:o}}function isoWeekdayToLocal(e,t){return(e-t+7)%7+1}function gregorianToWeek(e,t=4,i=1){const{year:r,month:o,day:a}=e,c=computeOrdinal(r,o,a),u=isoWeekdayToLocal(dayOfWeek(r,o,a),i);let h=Math.floor((c-u+14-t)/7),d;return h<1?(d=r-1,h=weeksInWeekYear(d,t,i)):h>weeksInWeekYear(r,t,i)?(d=r+1,h=1):d=r,{weekYear:d,weekNumber:h,weekday:u,...timeObject(e)}}function weekToGregorian(e,t=4,i=1){const{weekYear:r,weekNumber:o,weekday:a}=e,c=isoWeekdayToLocal(dayOfWeek(r,1,t),i),u=daysInYear(r);let h=o*7+a-c-7+t,d;h<1?(d=r-1,h+=daysInYear(d)):h>u?(d=r+1,h-=daysInYear(r)):d=r;const{month:f,day:m}=uncomputeOrdinal(d,h);return{year:d,month:f,day:m,...timeObject(e)}}function gregorianToOrdinal(e){const{year:t,month:i,day:r}=e,o=computeOrdinal(t,i,r);return{year:t,ordinal:o,...timeObject(e)}}function ordinalToGregorian(e){const{year:t,ordinal:i}=e,{month:r,day:o}=uncomputeOrdinal(t,i);return{year:t,month:r,day:o,...timeObject(e)}}function usesLocalWeekValues(e,t){if(!isUndefined(e.localWeekday)||!isUndefined(e.localWeekNumber)||!isUndefined(e.localWeekYear)){if(!isUndefined(e.weekday)||!isUndefined(e.weekNumber)||!isUndefined(e.weekYear))throw new ConflictingSpecificationError("Cannot mix locale-based week fields with ISO-based week fields");return isUndefined(e.localWeekday)||(e.weekday=e.localWeekday),isUndefined(e.localWeekNumber)||(e.weekNumber=e.localWeekNumber),isUndefined(e.localWeekYear)||(e.weekYear=e.localWeekYear),delete e.localWeekday,delete e.localWeekNumber,delete e.localWeekYear,{minDaysInFirstWeek:t.getMinDaysInFirstWeek(),startOfWeek:t.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function hasInvalidWeekData(e,t=4,i=1){const r=isInteger(e.weekYear),o=integerBetween(e.weekNumber,1,weeksInWeekYear(e.weekYear,t,i)),a=integerBetween(e.weekday,1,7);return r?o?a?!1:unitOutOfRange("weekday",e.weekday):unitOutOfRange("week",e.weekNumber):unitOutOfRange("weekYear",e.weekYear)}function hasInvalidOrdinalData(e){const t=isInteger(e.year),i=integerBetween(e.ordinal,1,daysInYear(e.year));return t?i?!1:unitOutOfRange("ordinal",e.ordinal):unitOutOfRange("year",e.year)}function hasInvalidGregorianData(e){const t=isInteger(e.year),i=integerBetween(e.month,1,12),r=integerBetween(e.day,1,daysInMonth(e.year,e.month));return t?i?r?!1:unitOutOfRange("day",e.day):unitOutOfRange("month",e.month):unitOutOfRange("year",e.year)}function hasInvalidTimeData(e){const{hour:t,minute:i,second:r,millisecond:o}=e,a=integerBetween(t,0,23)||t===24&&i===0&&r===0&&o===0,c=integerBetween(i,0,59),u=integerBetween(r,0,59),h=integerBetween(o,0,999);return a?c?u?h?!1:unitOutOfRange("millisecond",o):unitOutOfRange("second",r):unitOutOfRange("minute",i):unitOutOfRange("hour",t)}function isUndefined(e){return typeof e>"u"}function isNumber(e){return typeof e=="number"}function isInteger(e){return typeof e=="number"&&e%1===0}function isString$1(e){return typeof e=="string"}function isDate(e){return Object.prototype.toString.call(e)==="[object Date]"}function hasRelative(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function hasLocaleWeekInfo(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function maybeArray(e){return Array.isArray(e)?e:[e]}function bestBy(e,t,i){if(e.length!==0)return e.reduce((r,o)=>{const a=[t(o),o];return r&&i(r[0],a[0])===r[0]?r:a},null)[1]}function pick(e,t){return t.reduce((i,r)=>(i[r]=e[r],i),{})}function hasOwnProperty$14(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function validateWeekSettings(e){if(e==null)return null;if(typeof e!="object")throw new InvalidArgumentError("Week settings must be an object");if(!integerBetween(e.firstDay,1,7)||!integerBetween(e.minimalDays,1,7)||!Array.isArray(e.weekend)||e.weekend.some(t=>!integerBetween(t,1,7)))throw new InvalidArgumentError("Invalid week settings");return{firstDay:e.firstDay,minimalDays:e.minimalDays,weekend:Array.from(e.weekend)}}function integerBetween(e,t,i){return isInteger(e)&&e>=t&&e<=i}function floorMod(e,t){return e-t*Math.floor(e/t)}function padStart(e,t=2){const i=e<0;let r;return i?r="-"+(""+-e).padStart(t,"0"):r=(""+e).padStart(t,"0"),r}function parseInteger(e){if(!(isUndefined(e)||e===null||e===""))return parseInt(e,10)}function parseFloating(e){if(!(isUndefined(e)||e===null||e===""))return parseFloat(e)}function parseMillis(e){if(!(isUndefined(e)||e===null||e==="")){const t=parseFloat("0."+e)*1e3;return Math.floor(t)}}function roundTo(e,t,i=!1){const r=10**t;return(i?Math.trunc:Math.round)(e*r)/r}function isLeapYear(e){return e%4===0&&(e%100!==0||e%400===0)}function daysInYear(e){return isLeapYear(e)?366:365}function daysInMonth(e,t){const i=floorMod(t-1,12)+1,r=e+(t-i)/12;return i===2?isLeapYear(r)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][i-1]}function objToLocalTS(e){let t=Date.UTC(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond);return e.year<100&&e.year>=0&&(t=new Date(t),t.setUTCFullYear(e.year,e.month-1,e.day)),+t}function firstWeekOffset(e,t,i){return-isoWeekdayToLocal(dayOfWeek(e,1,t),i)+t-1}function weeksInWeekYear(e,t=4,i=1){const r=firstWeekOffset(e,t,i),o=firstWeekOffset(e+1,t,i);return(daysInYear(e)-r+o)/7}function untruncateYear(e){return e>99?e:e>Settings.twoDigitCutoffYear?1900+e:2e3+e}function parseZoneInfo(e,t,i,r=null){const o=new Date(e),a={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};r&&(a.timeZone=r);const c={timeZoneName:t,...a},u=new Intl.DateTimeFormat(i,c).formatToParts(o).find(h=>h.type.toLowerCase()==="timezonename");return u?u.value:null}function signedOffset(e,t){let i=parseInt(e,10);Number.isNaN(i)&&(i=0);const r=parseInt(t,10)||0,o=i<0||Object.is(i,-0)?-r:r;return i*60+o}function asNumber(e){const t=Number(e);if(typeof e=="boolean"||e===""||Number.isNaN(t))throw new InvalidArgumentError(`Invalid unit value ${e}`);return t}function normalizeObject(e,t){const i={};for(const r in e)if(hasOwnProperty$14(e,r)){const o=e[r];if(o==null)continue;i[t(r)]=asNumber(o)}return i}function formatOffset(e,t){const i=Math.trunc(Math.abs(e/60)),r=Math.trunc(Math.abs(e%60)),o=e>=0?"+":"-";switch(t){case"short":return`${o}${padStart(i,2)}:${padStart(r,2)}`;case"narrow":return`${o}${i}${r>0?`:${r}`:""}`;case"techie":return`${o}${padStart(i,2)}${padStart(r,2)}`;default:throw new RangeError(`Value format ${t} is out of range for property format`)}}function timeObject(e){return pick(e,["hour","minute","second","millisecond"])}const monthsLong=["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],monthsNarrow=["J","F","M","A","M","J","J","A","S","O","N","D"];function months(e){switch(e){case"narrow":return[...monthsNarrow];case"short":return[...monthsShort];case"long":return[...monthsLong];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const weekdaysLong=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],weekdaysShort=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],weekdaysNarrow=["M","T","W","T","F","S","S"];function weekdays(e){switch(e){case"narrow":return[...weekdaysNarrow];case"short":return[...weekdaysShort];case"long":return[...weekdaysLong];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const meridiems=["AM","PM"],erasLong=["Before Christ","Anno Domini"],erasShort=["BC","AD"],erasNarrow=["B","A"];function eras(e){switch(e){case"narrow":return[...erasNarrow];case"short":return[...erasShort];case"long":return[...erasLong];default:return null}}function meridiemForDateTime(e){return meridiems[e.hour<12?0:1]}function weekdayForDateTime(e,t){return weekdays(t)[e.weekday-1]}function monthForDateTime(e,t){return months(t)[e.month-1]}function eraForDateTime(e,t){return eras(t)[e.year<0?0:1]}function formatRelativeTime(e,t,i="always",r=!1){const o={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},a=["hours","minutes","seconds"].indexOf(e)===-1;if(i==="auto"&&a){const m=e==="days";switch(t){case 1:return m?"tomorrow":`next ${o[e][0]}`;case-1:return m?"yesterday":`last ${o[e][0]}`;case 0:return m?"today":`this ${o[e][0]}`;default:}}const c=Object.is(t,-0)||t<0,u=Math.abs(t),h=u===1,d=o[e],f=r?h?d[1]:d[2]||d[1]:h?o[e][0]:e;return c?`${u} ${f} ago`:`in ${u} ${f}`}function stringifyTokens(e,t){let i="";for(const r of e)r.literal?i+=r.val:i+=t(r.val);return i}const macroTokenToFormatOpts={D:DATE_SHORT,DD:DATE_MED,DDD:DATE_FULL,DDDD:DATE_HUGE,t:TIME_SIMPLE,tt:TIME_WITH_SECONDS,ttt:TIME_WITH_SHORT_OFFSET,tttt:TIME_WITH_LONG_OFFSET,T:TIME_24_SIMPLE,TT:TIME_24_WITH_SECONDS,TTT:TIME_24_WITH_SHORT_OFFSET,TTTT:TIME_24_WITH_LONG_OFFSET,f:DATETIME_SHORT,ff:DATETIME_MED,fff:DATETIME_FULL,ffff:DATETIME_HUGE,F:DATETIME_SHORT_WITH_SECONDS,FF:DATETIME_MED_WITH_SECONDS,FFF:DATETIME_FULL_WITH_SECONDS,FFFF:DATETIME_HUGE_WITH_SECONDS};var Formatter=class ni{static create(t,i={}){return new ni(t,i)}static parseFormat(t){let i=null,r="",o=!1;const a=[];for(let c=0;c<t.length;c++){const u=t.charAt(c);u==="'"?(r.length>0&&a.push({literal:o||/^\s+$/.test(r),val:r}),i=null,r="",o=!o):o||u===i?r+=u:(r.length>0&&a.push({literal:/^\s+$/.test(r),val:r}),r=u,i=u)}return r.length>0&&a.push({literal:o||/^\s+$/.test(r),val:r}),a}static macroTokenToFormatOpts(t){return macroTokenToFormatOpts[t]}constructor(t,i){this.opts=i,this.loc=t,this.systemLoc=null}formatWithSystemDefault(t,i){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(t,{...this.opts,...i}).format()}dtFormatter(t,i={}){return this.loc.dtFormatter(t,{...this.opts,...i})}formatDateTime(t,i){return this.dtFormatter(t,i).format()}formatDateTimeParts(t,i){return this.dtFormatter(t,i).formatToParts()}formatInterval(t,i){return this.dtFormatter(t.start,i).dtf.formatRange(t.start.toJSDate(),t.end.toJSDate())}resolvedOptions(t,i){return this.dtFormatter(t,i).resolvedOptions()}num(t,i=0){if(this.opts.forceSimple)return padStart(t,i);const r={...this.opts};return i>0&&(r.padTo=i),this.loc.numberFormatter(r).format(t)}formatDateTimeFromString(t,i){const r=this.loc.listingMode()==="en",o=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",a=(v,_)=>this.loc.extract(t,v,_),c=v=>t.isOffsetFixed&&t.offset===0&&v.allowZ?"Z":t.isValid?t.zone.formatOffset(t.ts,v.format):"",u=()=>r?meridiemForDateTime(t):a({hour:"numeric",hourCycle:"h12"},"dayperiod"),h=(v,_)=>r?monthForDateTime(t,v):a(_?{month:v}:{month:v,day:"numeric"},"month"),d=(v,_)=>r?weekdayForDateTime(t,v):a(_?{weekday:v}:{weekday:v,month:"long",day:"numeric"},"weekday"),f=v=>{const _=ni.macroTokenToFormatOpts(v);return _?this.formatWithSystemDefault(t,_):v},m=v=>r?eraForDateTime(t,v):a({era:v},"era"),g=v=>{switch(v){case"S":return this.num(t.millisecond);case"u":case"SSS":return this.num(t.millisecond,3);case"s":return this.num(t.second);case"ss":return this.num(t.second,2);case"uu":return this.num(Math.floor(t.millisecond/10),2);case"uuu":return this.num(Math.floor(t.millisecond/100));case"m":return this.num(t.minute);case"mm":return this.num(t.minute,2);case"h":return this.num(t.hour%12===0?12:t.hour%12);case"hh":return this.num(t.hour%12===0?12:t.hour%12,2);case"H":return this.num(t.hour);case"HH":return this.num(t.hour,2);case"Z":return c({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return c({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return c({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return t.zone.offsetName(t.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return t.zone.offsetName(t.ts,{format:"long",locale:this.loc.locale});case"z":return t.zoneName;case"a":return u();case"d":return o?a({day:"numeric"},"day"):this.num(t.day);case"dd":return o?a({day:"2-digit"},"day"):this.num(t.day,2);case"c":return this.num(t.weekday);case"ccc":return d("short",!0);case"cccc":return d("long",!0);case"ccccc":return d("narrow",!0);case"E":return this.num(t.weekday);case"EEE":return d("short",!1);case"EEEE":return d("long",!1);case"EEEEE":return d("narrow",!1);case"L":return o?a({month:"numeric",day:"numeric"},"month"):this.num(t.month);case"LL":return o?a({month:"2-digit",day:"numeric"},"month"):this.num(t.month,2);case"LLL":return h("short",!0);case"LLLL":return h("long",!0);case"LLLLL":return h("narrow",!0);case"M":return o?a({month:"numeric"},"month"):this.num(t.month);case"MM":return o?a({month:"2-digit"},"month"):this.num(t.month,2);case"MMM":return h("short",!1);case"MMMM":return h("long",!1);case"MMMMM":return h("narrow",!1);case"y":return o?a({year:"numeric"},"year"):this.num(t.year);case"yy":return o?a({year:"2-digit"},"year"):this.num(t.year.toString().slice(-2),2);case"yyyy":return o?a({year:"numeric"},"year"):this.num(t.year,4);case"yyyyyy":return o?a({year:"numeric"},"year"):this.num(t.year,6);case"G":return m("short");case"GG":return m("long");case"GGGGG":return m("narrow");case"kk":return this.num(t.weekYear.toString().slice(-2),2);case"kkkk":return this.num(t.weekYear,4);case"W":return this.num(t.weekNumber);case"WW":return this.num(t.weekNumber,2);case"n":return this.num(t.localWeekNumber);case"nn":return this.num(t.localWeekNumber,2);case"ii":return this.num(t.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(t.localWeekYear,4);case"o":return this.num(t.ordinal);case"ooo":return this.num(t.ordinal,3);case"q":return this.num(t.quarter);case"qq":return this.num(t.quarter,2);case"X":return this.num(Math.floor(t.ts/1e3));case"x":return this.num(t.ts);default:return f(v)}};return stringifyTokens(ni.parseFormat(i),g)}formatDurationFromString(t,i){const r=h=>{switch(h[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},o=h=>d=>{const f=r(d);return f?this.num(h.get(f),d.length):d},a=ni.parseFormat(i),c=a.reduce((h,{literal:d,val:f})=>d?h:h.concat(f),[]),u=t.shiftTo(...c.map(r).filter(h=>h));return stringifyTokens(a,o(u))}};const ianaRegex=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function combineRegexes(...e){const t=e.reduce((i,r)=>i+r.source,"");return RegExp(`^${t}$`)}function combineExtractors(...e){return t=>e.reduce(([i,r,o],a)=>{const[c,u,h]=a(t,o);return[{...i,...c},u||r,h]},[{},null,1]).slice(0,2)}function parse$3(e,...t){if(e==null)return[null,null];for(const[i,r]of t){const o=i.exec(e);if(o)return r(o)}return[null,null]}function simpleParse(...e){return(t,i)=>{const r={};let o;for(o=0;o<e.length;o++)r[e[o]]=parseInteger(t[i+o]);return[r,null,i+o]}}const offsetRegex=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,isoExtendedZone=`(?:${offsetRegex.source}?(?:\\[(${ianaRegex.source})\\])?)?`,isoTimeBaseRegex=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,isoTimeRegex=RegExp(`${isoTimeBaseRegex.source}${isoExtendedZone}`),isoTimeExtensionRegex=RegExp(`(?:T${isoTimeRegex.source})?`),isoYmdRegex=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,isoWeekRegex=/(\d{4})-?W(\d\d)(?:-?(\d))?/,isoOrdinalRegex=/(\d{4})-?(\d{3})/,extractISOWeekData=simpleParse("weekYear","weekNumber","weekDay"),extractISOOrdinalData=simpleParse("year","ordinal"),sqlYmdRegex=/(\d{4})-(\d\d)-(\d\d)/,sqlTimeRegex=RegExp(`${isoTimeBaseRegex.source} ?(?:${offsetRegex.source}|(${ianaRegex.source}))?`),sqlTimeExtensionRegex=RegExp(`(?: ${sqlTimeRegex.source})?`);function int(e,t,i){const r=e[t];return isUndefined(r)?i:parseInteger(r)}function extractISOYmd(e,t){return[{year:int(e,t),month:int(e,t+1,1),day:int(e,t+2,1)},null,t+3]}function extractISOTime(e,t){return[{hours:int(e,t,0),minutes:int(e,t+1,0),seconds:int(e,t+2,0),milliseconds:parseMillis(e[t+3])},null,t+4]}function extractISOOffset(e,t){const i=!e[t]&&!e[t+1],r=signedOffset(e[t+1],e[t+2]),o=i?null:FixedOffsetZone.instance(r);return[{},o,t+3]}function extractIANAZone(e,t){const i=e[t]?IANAZone.create(e[t]):null;return[{},i,t+1]}const isoTimeOnly=RegExp(`^T?${isoTimeBaseRegex.source}$`),isoDuration=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function extractISODuration(e){const[t,i,r,o,a,c,u,h,d]=e,f=t[0]==="-",m=h&&h[0]==="-",g=(v,_=!1)=>v!==void 0&&(_||v&&f)?-v:v;return[{years:g(parseFloating(i)),months:g(parseFloating(r)),weeks:g(parseFloating(o)),days:g(parseFloating(a)),hours:g(parseFloating(c)),minutes:g(parseFloating(u)),seconds:g(parseFloating(h),h==="-0"),milliseconds:g(parseMillis(d),m)}]}const obsOffsets={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function fromStrings(e,t,i,r,o,a,c){const u={year:t.length===2?untruncateYear(parseInteger(t)):parseInteger(t),month:monthsShort.indexOf(i)+1,day:parseInteger(r),hour:parseInteger(o),minute:parseInteger(a)};return c&&(u.second=parseInteger(c)),e&&(u.weekday=e.length>3?weekdaysLong.indexOf(e)+1:weekdaysShort.indexOf(e)+1),u}const rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function extractRFC2822(e){const[,t,i,r,o,a,c,u,h,d,f,m]=e,g=fromStrings(t,o,r,i,a,c,u);let v;return h?v=obsOffsets[h]:d?v=0:v=signedOffset(f,m),[g,new FixedOffsetZone(v)]}function preprocessRFC2822(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const rfc1123=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,rfc850=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,ascii=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function extractRFC1123Or850(e){const[,t,i,r,o,a,c,u]=e;return[fromStrings(t,o,r,i,a,c,u),FixedOffsetZone.utcInstance]}function extractASCII(e){const[,t,i,r,o,a,c,u]=e;return[fromStrings(t,u,i,r,o,a,c),FixedOffsetZone.utcInstance]}const isoYmdWithTimeExtensionRegex=combineRegexes(isoYmdRegex,isoTimeExtensionRegex),isoWeekWithTimeExtensionRegex=combineRegexes(isoWeekRegex,isoTimeExtensionRegex),isoOrdinalWithTimeExtensionRegex=combineRegexes(isoOrdinalRegex,isoTimeExtensionRegex),isoTimeCombinedRegex=combineRegexes(isoTimeRegex),extractISOYmdTimeAndOffset=combineExtractors(extractISOYmd,extractISOTime,extractISOOffset,extractIANAZone),extractISOWeekTimeAndOffset=combineExtractors(extractISOWeekData,extractISOTime,extractISOOffset,extractIANAZone),extractISOOrdinalDateAndTime=combineExtractors(extractISOOrdinalData,extractISOTime,extractISOOffset,extractIANAZone),extractISOTimeAndOffset=combineExtractors(extractISOTime,extractISOOffset,extractIANAZone);function parseISODate(e){return parse$3(e,[isoYmdWithTimeExtensionRegex,extractISOYmdTimeAndOffset],[isoWeekWithTimeExtensionRegex,extractISOWeekTimeAndOffset],[isoOrdinalWithTimeExtensionRegex,extractISOOrdinalDateAndTime],[isoTimeCombinedRegex,extractISOTimeAndOffset])}function parseRFC2822Date(e){return parse$3(preprocessRFC2822(e),[rfc2822,extractRFC2822])}function parseHTTPDate(e){return parse$3(e,[rfc1123,extractRFC1123Or850],[rfc850,extractRFC1123Or850],[ascii,extractASCII])}function parseISODuration(e){return parse$3(e,[isoDuration,extractISODuration])}const extractISOTimeOnly=combineExtractors(extractISOTime);function parseISOTimeOnly(e){return parse$3(e,[isoTimeOnly,extractISOTimeOnly])}const sqlYmdWithTimeExtensionRegex=combineRegexes(sqlYmdRegex,sqlTimeExtensionRegex),sqlTimeCombinedRegex=combineRegexes(sqlTimeRegex),extractISOTimeOffsetAndIANAZone=combineExtractors(extractISOTime,extractISOOffset,extractIANAZone);function parseSQL(e){return parse$3(e,[sqlYmdWithTimeExtensionRegex,extractISOYmdTimeAndOffset],[sqlTimeCombinedRegex,extractISOTimeOffsetAndIANAZone])}const INVALID$3="Invalid Duration",lowOrderMatrix={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},casualMatrix={years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6},...lowOrderMatrix},daysInYearAccurate=365.2425,daysInMonthAccurate=30.436875,accurateMatrix={years:{quarters:4,months:12,weeks:daysInYearAccurate/7,days:daysInYearAccurate,hours:daysInYearAccurate*24,minutes:daysInYearAccurate*24*60,seconds:daysInYearAccurate*24*60*60,milliseconds:daysInYearAccurate*24*60*60*1e3},quarters:{months:3,weeks:daysInYearAccurate/28,days:daysInYearAccurate/4,hours:daysInYearAccurate*24/4,minutes:daysInYearAccurate*24*60/4,seconds:daysInYearAccurate*24*60*60/4,milliseconds:daysInYearAccurate*24*60*60*1e3/4},months:{weeks:daysInMonthAccurate/7,days:daysInMonthAccurate,hours:daysInMonthAccurate*24,minutes:daysInMonthAccurate*24*60,seconds:daysInMonthAccurate*24*60*60,milliseconds:daysInMonthAccurate*24*60*60*1e3},...lowOrderMatrix},orderedUnits$1=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],reverseUnits=orderedUnits$1.slice(0).reverse();function clone$3(e,t,i=!1){const r={values:i?t.values:{...e.values,...t.values||{}},loc:e.loc.clone(t.loc),conversionAccuracy:t.conversionAccuracy||e.conversionAccuracy,matrix:t.matrix||e.matrix};return new Duration(r)}function durationToMillis(e,t){let i=t.milliseconds??0;for(const r of reverseUnits.slice(1))t[r]&&(i+=t[r]*e[r].milliseconds);return i}function normalizeValues(e,t){const i=durationToMillis(e,t)<0?-1:1;orderedUnits$1.reduceRight((r,o)=>{if(isUndefined(t[o]))return r;if(r){const a=t[r]*i,c=e[o][r],u=Math.floor(a/c);t[o]+=u*i,t[r]-=u*c*i}return o},null),orderedUnits$1.reduce((r,o)=>{if(isUndefined(t[o]))return r;if(r){const a=t[r]%1;t[r]-=a,t[o]+=a*e[r][o]}return o},null)}function removeZeroes(e){const t={};for(const[i,r]of Object.entries(e))r!==0&&(t[i]=r);return t}var Duration=class Ct{constructor(t){const i=t.conversionAccuracy==="longterm"||!1;let r=i?accurateMatrix:casualMatrix;t.matrix&&(r=t.matrix),this.values=t.values,this.loc=t.loc||Locale$1.create(),this.conversionAccuracy=i?"longterm":"casual",this.invalid=t.invalid||null,this.matrix=r,this.isLuxonDuration=!0}static fromMillis(t,i){return Ct.fromObject({milliseconds:t},i)}static fromObject(t,i={}){if(t==null||typeof t!="object")throw new InvalidArgumentError(`Duration.fromObject: argument expected to be an object, got ${t===null?"null":typeof t}`);return new Ct({values:normalizeObject(t,Ct.normalizeUnit),loc:Locale$1.fromObject(i),conversionAccuracy:i.conversionAccuracy,matrix:i.matrix})}static fromDurationLike(t){if(isNumber(t))return Ct.fromMillis(t);if(Ct.isDuration(t))return t;if(typeof t=="object")return Ct.fromObject(t);throw new InvalidArgumentError(`Unknown duration argument ${t} of type ${typeof t}`)}static fromISO(t,i){const[r]=parseISODuration(t);return r?Ct.fromObject(r,i):Ct.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static fromISOTime(t,i){const[r]=parseISOTimeOnly(t);return r?Ct.fromObject(r,i):Ct.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static invalid(t,i=null){if(!t)throw new InvalidArgumentError("need to specify a reason the Duration is invalid");const r=t instanceof Invalid?t:new Invalid(t,i);if(Settings.throwOnInvalid)throw new InvalidDurationError(r);return new Ct({invalid:r})}static normalizeUnit(t){const i={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[t&&t.toLowerCase()];if(!i)throw new InvalidUnitError(t);return i}static isDuration(t){return t&&t.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(t,i={}){const r={...i,floor:i.round!==!1&&i.floor!==!1};return this.isValid?Formatter.create(this.loc,r).formatDurationFromString(this,t):INVALID$3}toHuman(t={}){if(!this.isValid)return INVALID$3;const i=orderedUnits$1.map(r=>{const o=this.values[r];return isUndefined(o)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...t,unit:r.slice(0,-1)}).format(o)}).filter(r=>r);return this.loc.listFormatter({type:"conjunction",style:t.listStyle||"narrow",...t}).format(i)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let t="P";return this.years!==0&&(t+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(t+=this.months+this.quarters*3+"M"),this.weeks!==0&&(t+=this.weeks+"W"),this.days!==0&&(t+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(t+="T"),this.hours!==0&&(t+=this.hours+"H"),this.minutes!==0&&(t+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(t+=roundTo(this.seconds+this.milliseconds/1e3,3)+"S"),t==="P"&&(t+="T0S"),t}toISOTime(t={}){if(!this.isValid)return null;const i=this.toMillis();return i<0||i>=864e5?null:(t={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...t,includeOffset:!1},DateTime.fromMillis(i,{zone:"UTC"}).toISOTime(t))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?durationToMillis(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(t){if(!this.isValid)return this;const i=Ct.fromDurationLike(t),r={};for(const o of orderedUnits$1)(hasOwnProperty$14(i.values,o)||hasOwnProperty$14(this.values,o))&&(r[o]=i.get(o)+this.get(o));return clone$3(this,{values:r},!0)}minus(t){if(!this.isValid)return this;const i=Ct.fromDurationLike(t);return this.plus(i.negate())}mapUnits(t){if(!this.isValid)return this;const i={};for(const r of Object.keys(this.values))i[r]=asNumber(t(this.values[r],r));return clone$3(this,{values:i},!0)}get(t){return this[Ct.normalizeUnit(t)]}set(t){if(!this.isValid)return this;const i={...this.values,...normalizeObject(t,Ct.normalizeUnit)};return clone$3(this,{values:i})}reconfigure({locale:t,numberingSystem:i,conversionAccuracy:r,matrix:o}={}){const c={loc:this.loc.clone({locale:t,numberingSystem:i}),matrix:o,conversionAccuracy:r};return clone$3(this,c)}as(t){return this.isValid?this.shiftTo(t).get(t):NaN}normalize(){if(!this.isValid)return this;const t=this.toObject();return normalizeValues(this.matrix,t),clone$3(this,{values:t},!0)}rescale(){if(!this.isValid)return this;const t=removeZeroes(this.normalize().shiftToAll().toObject());return clone$3(this,{values:t},!0)}shiftTo(...t){if(!this.isValid)return this;if(t.length===0)return this;t=t.map(c=>Ct.normalizeUnit(c));const i={},r={},o=this.toObject();let a;for(const c of orderedUnits$1)if(t.indexOf(c)>=0){a=c;let u=0;for(const d in r)u+=this.matrix[d][c]*r[d],r[d]=0;isNumber(o[c])&&(u+=o[c]);const h=Math.trunc(u);i[c]=h,r[c]=(u*1e3-h*1e3)/1e3}else isNumber(o[c])&&(r[c]=o[c]);for(const c in r)r[c]!==0&&(i[a]+=c===a?r[c]:r[c]/this.matrix[a][c]);return normalizeValues(this.matrix,i),clone$3(this,{values:i},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const t={};for(const i of Object.keys(this.values))t[i]=this.values[i]===0?0:-this.values[i];return clone$3(this,{values:t},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(t){if(!this.isValid||!t.isValid||!this.loc.equals(t.loc))return!1;function i(r,o){return r===void 0||r===0?o===void 0||o===0:r===o}for(const r of orderedUnits$1)if(!i(this.values[r],t.values[r]))return!1;return!0}};const INVALID$2="Invalid Interval";function validateStartEnd(e,t){return!e||!e.isValid?Interval.invalid("missing or invalid start"):!t||!t.isValid?Interval.invalid("missing or invalid end"):t<e?Interval.invalid("end before start",`The end of an interval must be after its start, but you had start=${e.toISO()} and end=${t.toISO()}`):null}var Interval=class bt{constructor(t){this.s=t.start,this.e=t.end,this.invalid=t.invalid||null,this.isLuxonInterval=!0}static invalid(t,i=null){if(!t)throw new InvalidArgumentError("need to specify a reason the Interval is invalid");const r=t instanceof Invalid?t:new Invalid(t,i);if(Settings.throwOnInvalid)throw new InvalidIntervalError(r);return new bt({invalid:r})}static fromDateTimes(t,i){const r=friendlyDateTime(t),o=friendlyDateTime(i),a=validateStartEnd(r,o);return a??new bt({start:r,end:o})}static after(t,i){const r=Duration.fromDurationLike(i),o=friendlyDateTime(t);return bt.fromDateTimes(o,o.plus(r))}static before(t,i){const r=Duration.fromDurationLike(i),o=friendlyDateTime(t);return bt.fromDateTimes(o.minus(r),o)}static fromISO(t,i){const[r,o]=(t||"").split("/",2);if(r&&o){let a,c;try{a=DateTime.fromISO(r,i),c=a.isValid}catch{c=!1}let u,h;try{u=DateTime.fromISO(o,i),h=u.isValid}catch{h=!1}if(c&&h)return bt.fromDateTimes(a,u);if(c){const d=Duration.fromISO(o,i);if(d.isValid)return bt.after(a,d)}else if(h){const d=Duration.fromISO(r,i);if(d.isValid)return bt.before(u,d)}}return bt.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static isInterval(t){return t&&t.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(t="milliseconds"){return this.isValid?this.toDuration(t).get(t):NaN}count(t="milliseconds",i){if(!this.isValid)return NaN;const r=this.start.startOf(t,i);let o;return i?.useLocaleWeeks?o=this.end.reconfigure({locale:r.locale}):o=this.end,o=o.startOf(t,i),Math.floor(o.diff(r,t).get(t))+(o.valueOf()!==this.end.valueOf())}hasSame(t){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,t):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(t){return this.isValid?this.s>t:!1}isBefore(t){return this.isValid?this.e<=t:!1}contains(t){return this.isValid?this.s<=t&&this.e>t:!1}set({start:t,end:i}={}){return this.isValid?bt.fromDateTimes(t||this.s,i||this.e):this}splitAt(...t){if(!this.isValid)return[];const i=t.map(friendlyDateTime).filter(c=>this.contains(c)).sort((c,u)=>c.toMillis()-u.toMillis()),r=[];let{s:o}=this,a=0;for(;o<this.e;){const c=i[a]||this.e,u=+c>+this.e?this.e:c;r.push(bt.fromDateTimes(o,u)),o=u,a+=1}return r}splitBy(t){const i=Duration.fromDurationLike(t);if(!this.isValid||!i.isValid||i.as("milliseconds")===0)return[];let{s:r}=this,o=1,a;const c=[];for(;r<this.e;){const u=this.start.plus(i.mapUnits(h=>h*o));a=+u>+this.e?this.e:u,c.push(bt.fromDateTimes(r,a)),r=a,o+=1}return c}divideEqually(t){return this.isValid?this.splitBy(this.length()/t).slice(0,t):[]}overlaps(t){return this.e>t.s&&this.s<t.e}abutsStart(t){return this.isValid?+this.e==+t.s:!1}abutsEnd(t){return this.isValid?+t.e==+this.s:!1}engulfs(t){return this.isValid?this.s<=t.s&&this.e>=t.e:!1}equals(t){return!this.isValid||!t.isValid?!1:this.s.equals(t.s)&&this.e.equals(t.e)}intersection(t){if(!this.isValid)return this;const i=this.s>t.s?this.s:t.s,r=this.e<t.e?this.e:t.e;return i>=r?null:bt.fromDateTimes(i,r)}union(t){if(!this.isValid)return this;const i=this.s<t.s?this.s:t.s,r=this.e>t.e?this.e:t.e;return bt.fromDateTimes(i,r)}static merge(t){const[i,r]=t.sort((o,a)=>o.s-a.s).reduce(([o,a],c)=>a?a.overlaps(c)||a.abutsStart(c)?[o,a.union(c)]:[o.concat([a]),c]:[o,c],[[],null]);return r&&i.push(r),i}static xor(t){let i=null,r=0;const o=[],a=t.map(h=>[{time:h.s,type:"s"},{time:h.e,type:"e"}]),c=Array.prototype.concat(...a),u=c.sort((h,d)=>h.time-d.time);for(const h of u)r+=h.type==="s"?1:-1,r===1?i=h.time:(i&&+i!=+h.time&&o.push(bt.fromDateTimes(i,h.time)),i=null);return bt.merge(o)}difference(...t){return bt.xor([this].concat(t)).map(i=>this.intersection(i)).filter(i=>i&&!i.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} \u2013 ${this.e.toISO()})`:INVALID$2}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(t=DATE_SHORT,i={}){return this.isValid?Formatter.create(this.s.loc.clone(i),t).formatInterval(this):INVALID$2}toISO(t){return this.isValid?`${this.s.toISO(t)}/${this.e.toISO(t)}`:INVALID$2}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:INVALID$2}toISOTime(t){return this.isValid?`${this.s.toISOTime(t)}/${this.e.toISOTime(t)}`:INVALID$2}toFormat(t,{separator:i=" \u2013 "}={}){return this.isValid?`${this.s.toFormat(t)}${i}${this.e.toFormat(t)}`:INVALID$2}toDuration(t,i){return this.isValid?this.e.diff(this.s,t,i):Duration.invalid(this.invalidReason)}mapEndpoints(t){return bt.fromDateTimes(t(this.s),t(this.e))}},Info=class{static hasDST(e=Settings.defaultZone){const t=DateTime.now().setZone(e).set({month:12});return!e.isUniversal&&t.offset!==t.set({month:6}).offset}static isValidIANAZone(e){return IANAZone.isValidZone(e)}static normalizeZone(e){return normalizeZone(e,Settings.defaultZone)}static getStartOfWeek({locale:e=null,locObj:t=null}={}){return(t||Locale$1.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:t=null}={}){return(t||Locale$1.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:t=null}={}){return(t||Locale$1.create(e)).getWeekendDays().slice()}static months(e="long",{locale:t=null,numberingSystem:i=null,locObj:r=null,outputCalendar:o="gregory"}={}){return(r||Locale$1.create(t,i,o)).months(e)}static monthsFormat(e="long",{locale:t=null,numberingSystem:i=null,locObj:r=null,outputCalendar:o="gregory"}={}){return(r||Locale$1.create(t,i,o)).months(e,!0)}static weekdays(e="long",{locale:t=null,numberingSystem:i=null,locObj:r=null}={}){return(r||Locale$1.create(t,i,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:t=null,numberingSystem:i=null,locObj:r=null}={}){return(r||Locale$1.create(t,i,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return Locale$1.create(e).meridiems()}static eras(e="short",{locale:t=null}={}){return Locale$1.create(t,null,"gregory").eras(e)}static features(){return{relative:hasRelative(),localeWeek:hasLocaleWeekInfo()}}};function dayDiff(e,t){const i=o=>o.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),r=i(t)-i(e);return Math.floor(Duration.fromMillis(r).as("days"))}function highOrderDiffs(e,t,i){const r=[["years",(h,d)=>d.year-h.year],["quarters",(h,d)=>d.quarter-h.quarter+(d.year-h.year)*4],["months",(h,d)=>d.month-h.month+(d.year-h.year)*12],["weeks",(h,d)=>{const f=dayDiff(h,d);return(f-f%7)/7}],["days",dayDiff]],o={},a=e;let c,u;for(const[h,d]of r)i.indexOf(h)>=0&&(c=h,o[h]=d(e,t),u=a.plus(o),u>t?(o[h]--,e=a.plus(o),e>t&&(u=e,o[h]--,e=a.plus(o))):e=u);return[e,o,u,c]}function diff_default(e,t,i,r){let[o,a,c,u]=highOrderDiffs(e,t,i);const h=t-o,d=i.filter(m=>["hours","minutes","seconds","milliseconds"].indexOf(m)>=0);d.length===0&&(c<t&&(c=o.plus({[u]:1})),c!==o&&(a[u]=(a[u]||0)+h/(c-o)));const f=Duration.fromObject(a,r);return d.length>0?Duration.fromMillis(h,r).shiftTo(...d).plus(f):f}const MISSING_FTP="missing Intl.DateTimeFormat.formatToParts support";function intUnit(e,t=i=>i){return{regex:e,deser:([i])=>t(parseDigits(i))}}const NBSP="\xA0",spaceOrNBSP=`[ ${NBSP}]`,spaceOrNBSPRegExp=new RegExp(spaceOrNBSP,"g");function fixListRegex(e){return e.replace(/\./g,"\\.?").replace(spaceOrNBSPRegExp,spaceOrNBSP)}function stripInsensitivities(e){return e.replace(/\./g,"").replace(spaceOrNBSPRegExp," ").toLowerCase()}function oneOf(e,t){return e===null?null:{regex:RegExp(e.map(fixListRegex).join("|")),deser:([i])=>e.findIndex(r=>stripInsensitivities(i)===stripInsensitivities(r))+t}}function offset$1(e,t){return{regex:e,deser:([,i,r])=>signedOffset(i,r),groups:t}}function simple(e){return{regex:e,deser:([t])=>t}}function escapeToken(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function unitForToken(e,t){const i=digitRegex(t),r=digitRegex(t,"{2}"),o=digitRegex(t,"{3}"),a=digitRegex(t,"{4}"),c=digitRegex(t,"{6}"),u=digitRegex(t,"{1,2}"),h=digitRegex(t,"{1,3}"),d=digitRegex(t,"{1,6}"),f=digitRegex(t,"{1,9}"),m=digitRegex(t,"{2,4}"),g=digitRegex(t,"{4,6}"),v=S=>({regex:RegExp(escapeToken(S.val)),deser:([T])=>T,literal:!0}),b=(S=>{if(e.literal)return v(S);switch(S.val){case"G":return oneOf(t.eras("short"),0);case"GG":return oneOf(t.eras("long"),0);case"y":return intUnit(d);case"yy":return intUnit(m,untruncateYear);case"yyyy":return intUnit(a);case"yyyyy":return intUnit(g);case"yyyyyy":return intUnit(c);case"M":return intUnit(u);case"MM":return intUnit(r);case"MMM":return oneOf(t.months("short",!0),1);case"MMMM":return oneOf(t.months("long",!0),1);case"L":return intUnit(u);case"LL":return intUnit(r);case"LLL":return oneOf(t.months("short",!1),1);case"LLLL":return oneOf(t.months("long",!1),1);case"d":return intUnit(u);case"dd":return intUnit(r);case"o":return intUnit(h);case"ooo":return intUnit(o);case"HH":return intUnit(r);case"H":return intUnit(u);case"hh":return intUnit(r);case"h":return intUnit(u);case"mm":return intUnit(r);case"m":return intUnit(u);case"q":return intUnit(u);case"qq":return intUnit(r);case"s":return intUnit(u);case"ss":return intUnit(r);case"S":return intUnit(h);case"SSS":return intUnit(o);case"u":return simple(f);case"uu":return simple(u);case"uuu":return intUnit(i);case"a":return oneOf(t.meridiems(),0);case"kkkk":return intUnit(a);case"kk":return intUnit(m,untruncateYear);case"W":return intUnit(u);case"WW":return intUnit(r);case"E":case"c":return intUnit(i);case"EEE":return oneOf(t.weekdays("short",!1),1);case"EEEE":return oneOf(t.weekdays("long",!1),1);case"ccc":return oneOf(t.weekdays("short",!0),1);case"cccc":return oneOf(t.weekdays("long",!0),1);case"Z":case"ZZ":return offset$1(new RegExp(`([+-]${u.source})(?::(${r.source}))?`),2);case"ZZZ":return offset$1(new RegExp(`([+-]${u.source})(${r.source})?`),2);case"z":return simple(/[a-z_+-/]{1,256}?/i);case" ":return simple(/[^\S\n\r]/);default:return v(S)}})(e)||{invalidReason:MISSING_FTP};return b.token=e,b}const partTypeStyleToTokenVal={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function tokenForPart(e,t,i){const{type:r,value:o}=e;if(r==="literal"){const h=/^\s+$/.test(o);return{literal:!h,val:h?" ":o}}const a=t[r];let c=r;r==="hour"&&(t.hour12!=null?c=t.hour12?"hour12":"hour24":t.hourCycle!=null?t.hourCycle==="h11"||t.hourCycle==="h12"?c="hour12":c="hour24":c=i.hour12?"hour12":"hour24");let u=partTypeStyleToTokenVal[c];if(typeof u=="object"&&(u=u[a]),u)return{literal:!1,val:u}}function buildRegex(e){return[`^${e.map(i=>i.regex).reduce((i,r)=>`${i}(${r.source})`,"")}$`,e]}function match(e,t,i){const r=e.match(t);if(r){const o={};let a=1;for(const c in i)if(hasOwnProperty$14(i,c)){const u=i[c],h=u.groups?u.groups+1:1;!u.literal&&u.token&&(o[u.token.val[0]]=u.deser(r.slice(a,a+h))),a+=h}return[r,o]}else return[r,{}]}function dateTimeFromMatches(e){const t=a=>{switch(a){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let i=null,r;return isUndefined(e.z)||(i=IANAZone.create(e.z)),isUndefined(e.Z)||(i||(i=new FixedOffsetZone(e.Z)),r=e.Z),isUndefined(e.q)||(e.M=(e.q-1)*3+1),isUndefined(e.h)||(e.h<12&&e.a===1?e.h+=12:e.h===12&&e.a===0&&(e.h=0)),e.G===0&&e.y&&(e.y=-e.y),isUndefined(e.u)||(e.S=parseMillis(e.u)),[Object.keys(e).reduce((a,c)=>{const u=t(c);return u&&(a[u]=e[c]),a},{}),i,r]}let dummyDateTimeCache=null;function getDummyDateTime(){return dummyDateTimeCache||(dummyDateTimeCache=DateTime.fromMillis(1555555555555)),dummyDateTimeCache}function maybeExpandMacroToken(e,t){if(e.literal)return e;const i=Formatter.macroTokenToFormatOpts(e.val),r=formatOptsToTokens(i,t);return r==null||r.includes(void 0)?e:r}function expandMacroTokens(e,t){return Array.prototype.concat(...e.map(i=>maybeExpandMacroToken(i,t)))}var TokenParser=class{constructor(e,t){if(this.locale=e,this.format=t,this.tokens=expandMacroTokens(Formatter.parseFormat(t),e),this.units=this.tokens.map(i=>unitForToken(i,e)),this.disqualifyingUnit=this.units.find(i=>i.invalidReason),!this.disqualifyingUnit){const[i,r]=buildRegex(this.units);this.regex=RegExp(i,"i"),this.handlers=r}}explainFromTokens(e){if(this.isValid){const[t,i]=match(e,this.regex,this.handlers),[r,o,a]=i?dateTimeFromMatches(i):[null,null,void 0];if(hasOwnProperty$14(i,"a")&&hasOwnProperty$14(i,"H"))throw new ConflictingSpecificationError("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:this.tokens,regex:this.regex,rawMatches:t,matches:i,result:r,zone:o,specificOffset:a}}else return{input:e,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}};function explainFromTokens(e,t,i){return new TokenParser(e,i).explainFromTokens(t)}function parseFromTokens(e,t,i){const{result:r,zone:o,specificOffset:a,invalidReason:c}=explainFromTokens(e,t,i);return[r,o,a,c]}function formatOptsToTokens(e,t){if(!e)return null;const r=Formatter.create(t,e).dtFormatter(getDummyDateTime()),o=r.formatToParts(),a=r.resolvedOptions();return o.map(c=>tokenForPart(c,e,a))}const INVALID$1="Invalid DateTime",MAX_DATE=864e13;function unsupportedZone(e){return new Invalid("unsupported zone",`the zone "${e.name}" is not supported`)}function possiblyCachedWeekData(e){return e.weekData===null&&(e.weekData=gregorianToWeek(e.c)),e.weekData}function possiblyCachedLocalWeekData(e){return e.localWeekData===null&&(e.localWeekData=gregorianToWeek(e.c,e.loc.getMinDaysInFirstWeek(),e.loc.getStartOfWeek())),e.localWeekData}function clone$2(e,t){const i={ts:e.ts,zone:e.zone,c:e.c,o:e.o,loc:e.loc,invalid:e.invalid};return new DateTime({...i,...t,old:i})}function fixOffset(e,t,i){let r=e-t*60*1e3;const o=i.offset(r);if(t===o)return[r,t];r-=(o-t)*60*1e3;const a=i.offset(r);return o===a?[r,o]:[e-Math.min(o,a)*60*1e3,Math.max(o,a)]}function tsToObj(e,t){e+=t*60*1e3;const i=new Date(e);return{year:i.getUTCFullYear(),month:i.getUTCMonth()+1,day:i.getUTCDate(),hour:i.getUTCHours(),minute:i.getUTCMinutes(),second:i.getUTCSeconds(),millisecond:i.getUTCMilliseconds()}}function objToTS(e,t,i){return fixOffset(objToLocalTS(e),t,i)}function adjustTime(e,t){const i=e.o,r=e.c.year+Math.trunc(t.years),o=e.c.month+Math.trunc(t.months)+Math.trunc(t.quarters)*3,a={...e.c,year:r,month:o,day:Math.min(e.c.day,daysInMonth(r,o))+Math.trunc(t.days)+Math.trunc(t.weeks)*7},c=Duration.fromObject({years:t.years-Math.trunc(t.years),quarters:t.quarters-Math.trunc(t.quarters),months:t.months-Math.trunc(t.months),weeks:t.weeks-Math.trunc(t.weeks),days:t.days-Math.trunc(t.days),hours:t.hours,minutes:t.minutes,seconds:t.seconds,milliseconds:t.milliseconds}).as("milliseconds"),u=objToLocalTS(a);let[h,d]=fixOffset(u,i,e.zone);return c!==0&&(h+=c,d=e.zone.offset(h)),{ts:h,o:d}}function parseDataToDateTime(e,t,i,r,o,a){const{setZone:c,zone:u}=i;if(e&&Object.keys(e).length!==0||t){const h=t||u,d=DateTime.fromObject(e,{...i,zone:h,specificOffset:a});return c?d:d.setZone(u)}else return DateTime.invalid(new Invalid("unparsable",`the input "${o}" can't be parsed as ${r}`))}function toTechFormat(e,t,i=!0){return e.isValid?Formatter.create(Locale$1.create("en-US"),{allowZ:i,forceSimple:!0}).formatDateTimeFromString(e,t):null}function toISODate(e,t){const i=e.c.year>9999||e.c.year<0;let r="";return i&&e.c.year>=0&&(r+="+"),r+=padStart(e.c.year,i?6:4),t?(r+="-",r+=padStart(e.c.month),r+="-",r+=padStart(e.c.day)):(r+=padStart(e.c.month),r+=padStart(e.c.day)),r}function toISOTime(e,t,i,r,o,a){let c=padStart(e.c.hour);return t?(c+=":",c+=padStart(e.c.minute),(e.c.millisecond!==0||e.c.second!==0||!i)&&(c+=":")):c+=padStart(e.c.minute),(e.c.millisecond!==0||e.c.second!==0||!i)&&(c+=padStart(e.c.second),(e.c.millisecond!==0||!r)&&(c+=".",c+=padStart(e.c.millisecond,3))),o&&(e.isOffsetFixed&&e.offset===0&&!a?c+="Z":e.o<0?(c+="-",c+=padStart(Math.trunc(-e.o/60)),c+=":",c+=padStart(Math.trunc(-e.o%60))):(c+="+",c+=padStart(Math.trunc(e.o/60)),c+=":",c+=padStart(Math.trunc(e.o%60)))),a&&(c+="["+e.zone.ianaName+"]"),c}const defaultUnitValues={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},defaultWeekUnitValues={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},defaultOrdinalUnitValues={ordinal:1,hour:0,minute:0,second:0,millisecond:0},orderedUnits=["year","month","day","hour","minute","second","millisecond"],orderedWeekUnits=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],orderedOrdinalUnits=["year","ordinal","hour","minute","second","millisecond"];function normalizeUnit(e){const t={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[e.toLowerCase()];if(!t)throw new InvalidUnitError(e);return t}function normalizeUnitWithLocalWeeks(e){switch(e.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return normalizeUnit(e)}}function guessOffsetForZone(e){return zoneOffsetGuessCache[e]||(zoneOffsetTs===void 0&&(zoneOffsetTs=Settings.now()),zoneOffsetGuessCache[e]=e.offset(zoneOffsetTs)),zoneOffsetGuessCache[e]}function quickDT(e,t){const i=normalizeZone(t.zone,Settings.defaultZone);if(!i.isValid)return DateTime.invalid(unsupportedZone(i));const r=Locale$1.fromObject(t);let o,a;if(isUndefined(e.year))o=Settings.now();else{for(const h of orderedUnits)isUndefined(e[h])&&(e[h]=defaultUnitValues[h]);const c=hasInvalidGregorianData(e)||hasInvalidTimeData(e);if(c)return DateTime.invalid(c);const u=guessOffsetForZone(i);[o,a]=objToTS(e,u,i)}return new DateTime({ts:o,zone:i,loc:r,o:a})}function diffRelative(e,t,i){const r=isUndefined(i.round)?!0:i.round,o=(c,u)=>(c=roundTo(c,r||i.calendary?0:2,!0),t.loc.clone(i).relFormatter(i).format(c,u)),a=c=>i.calendary?t.hasSame(e,c)?0:t.startOf(c).diff(e.startOf(c),c).get(c):t.diff(e,c).get(c);if(i.unit)return o(a(i.unit),i.unit);for(const c of i.units){const u=a(c);if(Math.abs(u)>=1)return o(u,c)}return o(e>t?-0:0,i.units[i.units.length-1])}function lastOpts(e){let t={},i;return e.length>0&&typeof e[e.length-1]=="object"?(t=e[e.length-1],i=Array.from(e).slice(0,e.length-1)):i=Array.from(e),[t,i]}let zoneOffsetTs,zoneOffsetGuessCache={};var DateTime=class ot{constructor(t){const i=t.zone||Settings.defaultZone;let r=t.invalid||(Number.isNaN(t.ts)?new Invalid("invalid input"):null)||(i.isValid?null:unsupportedZone(i));this.ts=isUndefined(t.ts)?Settings.now():t.ts;let o=null,a=null;if(!r)if(t.old&&t.old.ts===this.ts&&t.old.zone.equals(i))[o,a]=[t.old.c,t.old.o];else{const u=isNumber(t.o)&&!t.old?t.o:i.offset(this.ts);o=tsToObj(this.ts,u),r=Number.isNaN(o.year)?new Invalid("invalid input"):null,o=r?null:o,a=r?null:u}this._zone=i,this.loc=t.loc||Locale$1.create(),this.invalid=r,this.weekData=null,this.localWeekData=null,this.c=o,this.o=a,this.isLuxonDateTime=!0}static now(){return new ot({})}static local(){const[t,i]=lastOpts(arguments),[r,o,a,c,u,h,d]=i;return quickDT({year:r,month:o,day:a,hour:c,minute:u,second:h,millisecond:d},t)}static utc(){const[t,i]=lastOpts(arguments),[r,o,a,c,u,h,d]=i;return t.zone=FixedOffsetZone.utcInstance,quickDT({year:r,month:o,day:a,hour:c,minute:u,second:h,millisecond:d},t)}static fromJSDate(t,i={}){const r=isDate(t)?t.valueOf():NaN;if(Number.isNaN(r))return ot.invalid("invalid input");const o=normalizeZone(i.zone,Settings.defaultZone);return o.isValid?new ot({ts:r,zone:o,loc:Locale$1.fromObject(i)}):ot.invalid(unsupportedZone(o))}static fromMillis(t,i={}){if(isNumber(t))return t<-MAX_DATE||t>MAX_DATE?ot.invalid("Timestamp out of range"):new ot({ts:t,zone:normalizeZone(i.zone,Settings.defaultZone),loc:Locale$1.fromObject(i)});throw new InvalidArgumentError(`fromMillis requires a numerical input, but received a ${typeof t} with value ${t}`)}static fromSeconds(t,i={}){if(isNumber(t))return new ot({ts:t*1e3,zone:normalizeZone(i.zone,Settings.defaultZone),loc:Locale$1.fromObject(i)});throw new InvalidArgumentError("fromSeconds requires a numerical input")}static fromObject(t,i={}){t=t||{};const r=normalizeZone(i.zone,Settings.defaultZone);if(!r.isValid)return ot.invalid(unsupportedZone(r));const o=Locale$1.fromObject(i),a=normalizeObject(t,normalizeUnitWithLocalWeeks),{minDaysInFirstWeek:c,startOfWeek:u}=usesLocalWeekValues(a,o),h=Settings.now(),d=isUndefined(i.specificOffset)?r.offset(h):i.specificOffset,f=!isUndefined(a.ordinal),m=!isUndefined(a.year),g=!isUndefined(a.month)||!isUndefined(a.day),v=m||g,_=a.weekYear||a.weekNumber;if((v||f)&&_)throw new ConflictingSpecificationError("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(g&&f)throw new ConflictingSpecificationError("Can't mix ordinal dates with month/day");const b=_||a.weekday&&!v;let S,T,A=tsToObj(h,d);b?(S=orderedWeekUnits,T=defaultWeekUnitValues,A=gregorianToWeek(A,c,u)):f?(S=orderedOrdinalUnits,T=defaultOrdinalUnitValues,A=gregorianToOrdinal(A)):(S=orderedUnits,T=defaultUnitValues);let I=!1;for(const $ of S){const Z=a[$];isUndefined(Z)?I?a[$]=T[$]:a[$]=A[$]:I=!0}const R=b?hasInvalidWeekData(a,c,u):f?hasInvalidOrdinalData(a):hasInvalidGregorianData(a),O=R||hasInvalidTimeData(a);if(O)return ot.invalid(O);const P=b?weekToGregorian(a,c,u):f?ordinalToGregorian(a):a,[L,V]=objToTS(P,d,r),U=new ot({ts:L,zone:r,o:V,loc:o});return a.weekday&&v&&t.weekday!==U.weekday?ot.invalid("mismatched weekday",`you can't specify both a weekday of ${a.weekday} and a date of ${U.toISO()}`):U.isValid?U:ot.invalid(U.invalid)}static fromISO(t,i={}){const[r,o]=parseISODate(t);return parseDataToDateTime(r,o,i,"ISO 8601",t)}static fromRFC2822(t,i={}){const[r,o]=parseRFC2822Date(t);return parseDataToDateTime(r,o,i,"RFC 2822",t)}static fromHTTP(t,i={}){const[r,o]=parseHTTPDate(t);return parseDataToDateTime(r,o,i,"HTTP",i)}static fromFormat(t,i,r={}){if(isUndefined(t)||isUndefined(i))throw new InvalidArgumentError("fromFormat requires an input string and a format");const{locale:o=null,numberingSystem:a=null}=r,c=Locale$1.fromOpts({locale:o,numberingSystem:a,defaultToEN:!0}),[u,h,d,f]=parseFromTokens(c,t,i);return f?ot.invalid(f):parseDataToDateTime(u,h,r,`format ${i}`,t,d)}static fromString(t,i,r={}){return ot.fromFormat(t,i,r)}static fromSQL(t,i={}){const[r,o]=parseSQL(t);return parseDataToDateTime(r,o,i,"SQL",t)}static invalid(t,i=null){if(!t)throw new InvalidArgumentError("need to specify a reason the DateTime is invalid");const r=t instanceof Invalid?t:new Invalid(t,i);if(Settings.throwOnInvalid)throw new InvalidDateTimeError(r);return new ot({invalid:r})}static isDateTime(t){return t&&t.isLuxonDateTime||!1}static parseFormatForOpts(t,i={}){const r=formatOptsToTokens(t,Locale$1.fromObject(i));return r?r.map(o=>o?o.val:null).join(""):null}static expandFormat(t,i={}){return expandMacroTokens(Formatter.parseFormat(t),Locale$1.fromObject(i)).map(o=>o.val).join("")}static resetCache(){zoneOffsetTs=void 0,zoneOffsetGuessCache={}}get(t){return this[t]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?possiblyCachedWeekData(this).weekYear:NaN}get weekNumber(){return this.isValid?possiblyCachedWeekData(this).weekNumber:NaN}get weekday(){return this.isValid?possiblyCachedWeekData(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?possiblyCachedLocalWeekData(this).weekday:NaN}get localWeekNumber(){return this.isValid?possiblyCachedLocalWeekData(this).weekNumber:NaN}get localWeekYear(){return this.isValid?possiblyCachedLocalWeekData(this).weekYear:NaN}get ordinal(){return this.isValid?gregorianToOrdinal(this.c).ordinal:NaN}get monthShort(){return this.isValid?Info.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Info.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Info.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Info.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const t=864e5,i=6e4,r=objToLocalTS(this.c),o=this.zone.offset(r-t),a=this.zone.offset(r+t),c=this.zone.offset(r-o*i),u=this.zone.offset(r-a*i);if(c===u)return[this];const h=r-c*i,d=r-u*i,f=tsToObj(h,c),m=tsToObj(d,u);return f.hour===m.hour&&f.minute===m.minute&&f.second===m.second&&f.millisecond===m.millisecond?[clone$2(this,{ts:h}),clone$2(this,{ts:d})]:[this]}get isInLeapYear(){return isLeapYear(this.year)}get daysInMonth(){return daysInMonth(this.year,this.month)}get daysInYear(){return this.isValid?daysInYear(this.year):NaN}get weeksInWeekYear(){return this.isValid?weeksInWeekYear(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?weeksInWeekYear(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(t={}){const{locale:i,numberingSystem:r,calendar:o}=Formatter.create(this.loc.clone(t),t).resolvedOptions(this);return{locale:i,numberingSystem:r,outputCalendar:o}}toUTC(t=0,i={}){return this.setZone(FixedOffsetZone.instance(t),i)}toLocal(){return this.setZone(Settings.defaultZone)}setZone(t,{keepLocalTime:i=!1,keepCalendarTime:r=!1}={}){if(t=normalizeZone(t,Settings.defaultZone),t.equals(this.zone))return this;if(t.isValid){let o=this.ts;if(i||r){const a=t.offset(this.ts),c=this.toObject();[o]=objToTS(c,a,t)}return clone$2(this,{ts:o,zone:t})}else return ot.invalid(unsupportedZone(t))}reconfigure({locale:t,numberingSystem:i,outputCalendar:r}={}){const o=this.loc.clone({locale:t,numberingSystem:i,outputCalendar:r});return clone$2(this,{loc:o})}setLocale(t){return this.reconfigure({locale:t})}set(t){if(!this.isValid)return this;const i=normalizeObject(t,normalizeUnitWithLocalWeeks),{minDaysInFirstWeek:r,startOfWeek:o}=usesLocalWeekValues(i,this.loc),a=!isUndefined(i.weekYear)||!isUndefined(i.weekNumber)||!isUndefined(i.weekday),c=!isUndefined(i.ordinal),u=!isUndefined(i.year),h=!isUndefined(i.month)||!isUndefined(i.day),d=u||h,f=i.weekYear||i.weekNumber;if((d||c)&&f)throw new ConflictingSpecificationError("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(h&&c)throw new ConflictingSpecificationError("Can't mix ordinal dates with month/day");let m;a?m=weekToGregorian({...gregorianToWeek(this.c,r,o),...i},r,o):isUndefined(i.ordinal)?(m={...this.toObject(),...i},isUndefined(i.day)&&(m.day=Math.min(daysInMonth(m.year,m.month),m.day))):m=ordinalToGregorian({...gregorianToOrdinal(this.c),...i});const[g,v]=objToTS(m,this.o,this.zone);return clone$2(this,{ts:g,o:v})}plus(t){if(!this.isValid)return this;const i=Duration.fromDurationLike(t);return clone$2(this,adjustTime(this,i))}minus(t){if(!this.isValid)return this;const i=Duration.fromDurationLike(t).negate();return clone$2(this,adjustTime(this,i))}startOf(t,{useLocaleWeeks:i=!1}={}){if(!this.isValid)return this;const r={},o=Duration.normalizeUnit(t);switch(o){case"years":r.month=1;case"quarters":case"months":r.day=1;case"weeks":case"days":r.hour=0;case"hours":r.minute=0;case"minutes":r.second=0;case"seconds":r.millisecond=0;break;case"milliseconds":break}if(o==="weeks")if(i){const a=this.loc.getStartOfWeek(),{weekday:c}=this;c<a&&(r.weekNumber=this.weekNumber-1),r.weekday=a}else r.weekday=1;if(o==="quarters"){const a=Math.ceil(this.month/3);r.month=(a-1)*3+1}return this.set(r)}endOf(t,i){return this.isValid?this.plus({[t]:1}).startOf(t,i).minus(1):this}toFormat(t,i={}){return this.isValid?Formatter.create(this.loc.redefaultToEN(i)).formatDateTimeFromString(this,t):INVALID$1}toLocaleString(t=DATE_SHORT,i={}){return this.isValid?Formatter.create(this.loc.clone(i),t).formatDateTime(this):INVALID$1}toLocaleParts(t={}){return this.isValid?Formatter.create(this.loc.clone(t),t).formatDateTimeParts(this):[]}toISO({format:t="extended",suppressSeconds:i=!1,suppressMilliseconds:r=!1,includeOffset:o=!0,extendedZone:a=!1}={}){if(!this.isValid)return null;const c=t==="extended";let u=toISODate(this,c);return u+="T",u+=toISOTime(this,c,i,r,o,a),u}toISODate({format:t="extended"}={}){return this.isValid?toISODate(this,t==="extended"):null}toISOWeekDate(){return toTechFormat(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:t=!1,suppressSeconds:i=!1,includeOffset:r=!0,includePrefix:o=!1,extendedZone:a=!1,format:c="extended"}={}){return this.isValid?(o?"T":"")+toISOTime(this,c==="extended",i,t,r,a):null}toRFC2822(){return toTechFormat(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return toTechFormat(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?toISODate(this,!0):null}toSQLTime({includeOffset:t=!0,includeZone:i=!1,includeOffsetSpace:r=!0}={}){let o="HH:mm:ss.SSS";return(i||t)&&(r&&(o+=" "),i?o+="z":t&&(o+="ZZ")),toTechFormat(this,o,!0)}toSQL(t={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(t)}`:null}toString(){return this.isValid?this.toISO():INVALID$1}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(t={}){if(!this.isValid)return{};const i={...this.c};return t.includeConfig&&(i.outputCalendar=this.outputCalendar,i.numberingSystem=this.loc.numberingSystem,i.locale=this.loc.locale),i}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(t,i="milliseconds",r={}){if(!this.isValid||!t.isValid)return Duration.invalid("created by diffing an invalid DateTime");const o={locale:this.locale,numberingSystem:this.numberingSystem,...r},a=maybeArray(i).map(Duration.normalizeUnit),c=t.valueOf()>this.valueOf(),u=c?this:t,h=c?t:this,d=diff_default(u,h,a,o);return c?d.negate():d}diffNow(t="milliseconds",i={}){return this.diff(ot.now(),t,i)}until(t){return this.isValid?Interval.fromDateTimes(this,t):this}hasSame(t,i,r){if(!this.isValid)return!1;const o=t.valueOf(),a=this.setZone(t.zone,{keepLocalTime:!0});return a.startOf(i,r)<=o&&o<=a.endOf(i,r)}equals(t){return this.isValid&&t.isValid&&this.valueOf()===t.valueOf()&&this.zone.equals(t.zone)&&this.loc.equals(t.loc)}toRelative(t={}){if(!this.isValid)return null;const i=t.base||ot.fromObject({},{zone:this.zone}),r=t.padding?this<i?-t.padding:t.padding:0;let o=["years","months","days","hours","minutes","seconds"],a=t.unit;return Array.isArray(t.unit)&&(o=t.unit,a=void 0),diffRelative(i,this.plus(r),{...t,numeric:"always",units:o,unit:a})}toRelativeCalendar(t={}){return this.isValid?diffRelative(t.base||ot.fromObject({},{zone:this.zone}),this,{...t,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...t){if(!t.every(ot.isDateTime))throw new InvalidArgumentError("min requires all arguments be DateTimes");return bestBy(t,i=>i.valueOf(),Math.min)}static max(...t){if(!t.every(ot.isDateTime))throw new InvalidArgumentError("max requires all arguments be DateTimes");return bestBy(t,i=>i.valueOf(),Math.max)}static fromFormatExplain(t,i,r={}){const{locale:o=null,numberingSystem:a=null}=r,c=Locale$1.fromOpts({locale:o,numberingSystem:a,defaultToEN:!0});return explainFromTokens(c,t,i)}static fromStringExplain(t,i,r={}){return ot.fromFormatExplain(t,i,r)}static buildFormatParser(t,i={}){const{locale:r=null,numberingSystem:o=null}=i,a=Locale$1.fromOpts({locale:r,numberingSystem:o,defaultToEN:!0});return new TokenParser(a,t)}static fromFormatParser(t,i,r={}){if(isUndefined(t)||isUndefined(i))throw new InvalidArgumentError("fromFormatParser requires an input string and a format parser");const{locale:o=null,numberingSystem:a=null}=r,c=Locale$1.fromOpts({locale:o,numberingSystem:a,defaultToEN:!0});if(!c.equals(i.locale))throw new InvalidArgumentError(`fromFormatParser called with a locale of ${c}, but the format parser was created for ${i.locale}`);const{result:u,zone:h,specificOffset:d,invalidReason:f}=i.explainFromTokens(t);return f?ot.invalid(f):parseDataToDateTime(u,h,r,`format ${i.format}`,t,d)}static get DATE_SHORT(){return DATE_SHORT}static get DATE_MED(){return DATE_MED}static get DATE_MED_WITH_WEEKDAY(){return DATE_MED_WITH_WEEKDAY}static get DATE_FULL(){return DATE_FULL}static get DATE_HUGE(){return DATE_HUGE}static get TIME_SIMPLE(){return TIME_SIMPLE}static get TIME_WITH_SECONDS(){return TIME_WITH_SECONDS}static get TIME_WITH_SHORT_OFFSET(){return TIME_WITH_SHORT_OFFSET}static get TIME_WITH_LONG_OFFSET(){return TIME_WITH_LONG_OFFSET}static get TIME_24_SIMPLE(){return TIME_24_SIMPLE}static get TIME_24_WITH_SECONDS(){return TIME_24_WITH_SECONDS}static get TIME_24_WITH_SHORT_OFFSET(){return TIME_24_WITH_SHORT_OFFSET}static get TIME_24_WITH_LONG_OFFSET(){return TIME_24_WITH_LONG_OFFSET}static get DATETIME_SHORT(){return DATETIME_SHORT}static get DATETIME_SHORT_WITH_SECONDS(){return DATETIME_SHORT_WITH_SECONDS}static get DATETIME_MED(){return DATETIME_MED}static get DATETIME_MED_WITH_SECONDS(){return DATETIME_MED_WITH_SECONDS}static get DATETIME_MED_WITH_WEEKDAY(){return DATETIME_MED_WITH_WEEKDAY}static get DATETIME_FULL(){return DATETIME_FULL}static get DATETIME_FULL_WITH_SECONDS(){return DATETIME_FULL_WITH_SECONDS}static get DATETIME_HUGE(){return DATETIME_HUGE}static get DATETIME_HUGE_WITH_SECONDS(){return DATETIME_HUGE_WITH_SECONDS}};function friendlyDateTime(e){if(DateTime.isDateTime(e))return e;if(e&&e.valueOf&&isNumber(e.valueOf()))return DateTime.fromJSDate(e);if(e&&typeof e=="object")return DateTime.fromObject(e);throw new InvalidArgumentError(`Unknown datetime argument: ${e}, of type ${typeof e}`)}var freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global,_freeGlobal_default=freeGlobal,freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root$1=_freeGlobal_default||freeSelf||Function("return this")(),_root_default=root$1,Symbol$1=_root_default.Symbol,_Symbol_default=Symbol$1,objectProto$15=Object.prototype,hasOwnProperty$13=objectProto$15.hasOwnProperty,nativeObjectToString$1=objectProto$15.toString,symToStringTag$1=_Symbol_default?_Symbol_default.toStringTag:void 0;function getRawTag(e){var t=hasOwnProperty$13.call(e,symToStringTag$1),i=e[symToStringTag$1];try{e[symToStringTag$1]=void 0;var r=!0}catch{}var o=nativeObjectToString$1.call(e);return r&&(t?e[symToStringTag$1]=i:delete e[symToStringTag$1]),o}var _getRawTag_default=getRawTag,objectProto$14=Object.prototype,nativeObjectToString=objectProto$14.toString;function objectToString(e){return nativeObjectToString.call(e)}var _objectToString_default=objectToString,nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=_Symbol_default?_Symbol_default.toStringTag:void 0;function baseGetTag(e){return e==null?e===void 0?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(e)?_getRawTag_default(e):_objectToString_default(e)}var _baseGetTag_default=baseGetTag;function isObjectLike(e){return e!=null&&typeof e=="object"}var isObjectLike_default=isObjectLike,symbolTag$3="[object Symbol]";function isSymbol(e){return typeof e=="symbol"||isObjectLike_default(e)&&_baseGetTag_default(e)==symbolTag$3}var isSymbol_default=isSymbol;function arrayMap(e,t){for(var i=-1,r=e==null?0:e.length,o=Array(r);++i<r;)o[i]=t(e[i],i,e);return o}var _arrayMap_default=arrayMap,isArray=Array.isArray,isArray_default=isArray,INFINITY$1=1/0,symbolProto$2=_Symbol_default?_Symbol_default.prototype:void 0,symbolToString=symbolProto$2?symbolProto$2.toString:void 0;function baseToString(e){if(typeof e=="string")return e;if(isArray_default(e))return _arrayMap_default(e,baseToString)+"";if(isSymbol_default(e))return symbolToString?symbolToString.call(e):"";var t=e+"";return t=="0"&&1/e==-INFINITY$1?"-0":t}var _baseToString_default=baseToString,reWhitespace=/\s/;function trimmedEndIndex(e){for(var t=e.length;t--&&reWhitespace.test(e.charAt(t)););return t}var _trimmedEndIndex_default=trimmedEndIndex,reTrimStart=/^\s+/;function baseTrim(e){return e&&e.slice(0,_trimmedEndIndex_default(e)+1).replace(reTrimStart,"")}var _baseTrim_default=baseTrim;function isObject$2(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var isObject_default=isObject$2,NAN=NaN,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(e){if(typeof e=="number")return e;if(isSymbol_default(e))return NAN;if(isObject_default(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=isObject_default(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=_baseTrim_default(e);var i=reIsBinary.test(e);return i||reIsOctal.test(e)?freeParseInt(e.slice(2),i?2:8):reIsBadHex.test(e)?NAN:+e}var toNumber_default=toNumber;function identity(e){return e}var identity_default=identity,asyncTag="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction$1(e){if(!isObject_default(e))return!1;var t=_baseGetTag_default(e);return t==funcTag$2||t==genTag$1||t==asyncTag||t==proxyTag}var isFunction_default=isFunction$1,coreJsData=_root_default["__core-js_shared__"],_coreJsData_default=coreJsData,maskSrcKey=function(){var e=/[^.]+$/.exec(_coreJsData_default&&_coreJsData_default.keys&&_coreJsData_default.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function isMasked(e){return!!maskSrcKey&&maskSrcKey in e}var _isMasked_default=isMasked,funcProto$2=Function.prototype,funcToString$2=funcProto$2.toString;function toSource(e){if(e!=null){try{return funcToString$2.call(e)}catch{}try{return e+""}catch{}}return""}var _toSource_default=toSource,reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$13=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$12=objectProto$13.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$12).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){if(!isObject_default(e)||_isMasked_default(e))return!1;var t=isFunction_default(e)?reIsNative:reIsHostCtor;return t.test(_toSource_default(e))}var _baseIsNative_default=baseIsNative;function getValue(e,t){return e?.[t]}var _getValue_default=getValue;function getNative(e,t){var i=_getValue_default(e,t);return _baseIsNative_default(i)?i:void 0}var _getNative_default=getNative,WeakMap$1=_getNative_default(_root_default,"WeakMap"),_WeakMap_default=WeakMap$1,objectCreate=Object.create,baseCreate=function(){function e(){}return function(t){if(!isObject_default(t))return{};if(objectCreate)return objectCreate(t);e.prototype=t;var i=new e;return e.prototype=void 0,i}}(),_baseCreate_default=baseCreate;function apply(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}var _apply_default=apply;function copyArray(e,t){var i=-1,r=e.length;for(t||(t=Array(r));++i<r;)t[i]=e[i];return t}var _copyArray_default=copyArray,HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(e){var t=0,i=0;return function(){var r=nativeNow(),o=HOT_SPAN-(r-i);if(i=r,o>0){if(++t>=HOT_COUNT)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var _shortOut_default=shortOut;function constant(e){return function(){return e}}var constant_default=constant,defineProperty$1=function(){try{var e=_getNative_default(Object,"defineProperty");return e({},"",{}),e}catch{}}(),_defineProperty_default=defineProperty$1,baseSetToString=_defineProperty_default?function(e,t){return _defineProperty_default(e,"toString",{configurable:!0,enumerable:!1,value:constant_default(t),writable:!0})}:identity_default,_baseSetToString_default=baseSetToString,setToString=_shortOut_default(_baseSetToString_default),_setToString_default=setToString;function arrayEach(e,t){for(var i=-1,r=e==null?0:e.length;++i<r&&t(e[i],i,e)!==!1;);return e}var _arrayEach_default=arrayEach,MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(e,t){var i=typeof e;return t=t??MAX_SAFE_INTEGER$1,!!t&&(i=="number"||i!="symbol"&&reIsUint.test(e))&&e>-1&&e%1==0&&e<t}var _isIndex_default=isIndex;function baseAssignValue(e,t,i){t=="__proto__"&&_defineProperty_default?_defineProperty_default(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}var _baseAssignValue_default=baseAssignValue;function eq$1(e,t){return e===t||e!==e&&t!==t}var eq_default=eq$1,objectProto$12=Object.prototype,hasOwnProperty$11=objectProto$12.hasOwnProperty;function assignValue(e,t,i){var r=e[t];(!(hasOwnProperty$11.call(e,t)&&eq_default(r,i))||i===void 0&&!(t in e))&&_baseAssignValue_default(e,t,i)}var _assignValue_default=assignValue;function copyObject(e,t,i,r){var o=!i;i||(i={});for(var a=-1,c=t.length;++a<c;){var u=t[a],h=r?r(i[u],e[u],u,i,e):void 0;h===void 0&&(h=e[u]),o?_baseAssignValue_default(i,u,h):_assignValue_default(i,u,h)}return i}var _copyObject_default=copyObject,nativeMax$1=Math.max;function overRest(e,t,i){return t=nativeMax$1(t===void 0?e.length-1:t,0),function(){for(var r=arguments,o=-1,a=nativeMax$1(r.length-t,0),c=Array(a);++o<a;)c[o]=r[t+o];o=-1;for(var u=Array(t+1);++o<t;)u[o]=r[o];return u[t]=i(c),_apply_default(e,this,u)}}var _overRest_default=overRest;function baseRest(e,t){return _setToString_default(_overRest_default(e,t,identity_default),e+"")}var _baseRest_default=baseRest,MAX_SAFE_INTEGER=9007199254740991;function isLength$1(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=MAX_SAFE_INTEGER}var isLength_default=isLength$1;function isArrayLike(e){return e!=null&&isLength_default(e.length)&&!isFunction_default(e)}var isArrayLike_default=isArrayLike;function isIterateeCall(e,t,i){if(!isObject_default(i))return!1;var r=typeof t;return(r=="number"?isArrayLike_default(i)&&_isIndex_default(t,i.length):r=="string"&&t in i)?eq_default(i[t],e):!1}var _isIterateeCall_default=isIterateeCall;function createAssigner(e){return _baseRest_default(function(t,i){var r=-1,o=i.length,a=o>1?i[o-1]:void 0,c=o>2?i[2]:void 0;for(a=e.length>3&&typeof a=="function"?(o--,a):void 0,c&&_isIterateeCall_default(i[0],i[1],c)&&(a=o<3?void 0:a,o=1),t=Object(t);++r<o;){var u=i[r];u&&e(t,u,r,a)}return t})}var _createAssigner_default=createAssigner,objectProto$11=Object.prototype;function isPrototype(e){var t=e&&e.constructor,i=typeof t=="function"&&t.prototype||objectProto$11;return e===i}var _isPrototype_default=isPrototype;function baseTimes(e,t){for(var i=-1,r=Array(e);++i<e;)r[i]=t(i);return r}var _baseTimes_default=baseTimes,argsTag$3="[object Arguments]";function baseIsArguments(e){return isObjectLike_default(e)&&_baseGetTag_default(e)==argsTag$3}var _baseIsArguments_default=baseIsArguments,objectProto$10=Object.prototype,hasOwnProperty$10=objectProto$10.hasOwnProperty,propertyIsEnumerable$1=objectProto$10.propertyIsEnumerable,isArguments=_baseIsArguments_default(function(){return arguments}())?_baseIsArguments_default:function(e){return isObjectLike_default(e)&&hasOwnProperty$10.call(e,"callee")&&!propertyIsEnumerable$1.call(e,"callee")},isArguments_default=isArguments;function stubFalse(){return!1}var stubFalse_default=stubFalse,freeExports$2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$2=moduleExports$2?_root_default.Buffer:void 0,nativeIsBuffer=Buffer$2?Buffer$2.isBuffer:void 0,isBuffer=nativeIsBuffer||stubFalse_default,isBuffer_default=isBuffer,argsTag$2="[object Arguments]",arrayTag$2="[object Array]",boolTag$3="[object Boolean]",dateTag$3="[object Date]",errorTag$2="[object Error]",funcTag$1="[object Function]",mapTag$5="[object Map]",numberTag$3="[object Number]",objectTag$4="[object Object]",regexpTag$3="[object RegExp]",setTag$5="[object Set]",stringTag$4="[object String]",weakMapTag$2="[object WeakMap]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$4="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",typedArrayTags={};typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=!0,typedArrayTags[argsTag$2]=typedArrayTags[arrayTag$2]=typedArrayTags[arrayBufferTag$3]=typedArrayTags[boolTag$3]=typedArrayTags[dataViewTag$4]=typedArrayTags[dateTag$3]=typedArrayTags[errorTag$2]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$5]=typedArrayTags[numberTag$3]=typedArrayTags[objectTag$4]=typedArrayTags[regexpTag$3]=typedArrayTags[setTag$5]=typedArrayTags[stringTag$4]=typedArrayTags[weakMapTag$2]=!1;function baseIsTypedArray(e){return isObjectLike_default(e)&&isLength_default(e.length)&&!!typedArrayTags[_baseGetTag_default(e)]}var _baseIsTypedArray_default=baseIsTypedArray;function baseUnary(e){return function(t){return e(t)}}var _baseUnary_default=baseUnary,freeExports$1=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&_freeGlobal_default.process,nodeUtil=function(){try{var e=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return e||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch{}}(),_nodeUtil_default=nodeUtil,nodeIsTypedArray=_nodeUtil_default&&_nodeUtil_default.isTypedArray,isTypedArray=nodeIsTypedArray?_baseUnary_default(nodeIsTypedArray):_baseIsTypedArray_default,isTypedArray_default=isTypedArray,objectProto$9=Object.prototype,hasOwnProperty$9=objectProto$9.hasOwnProperty;function arrayLikeKeys(e,t){var i=isArray_default(e),r=!i&&isArguments_default(e),o=!i&&!r&&isBuffer_default(e),a=!i&&!r&&!o&&isTypedArray_default(e),c=i||r||o||a,u=c?_baseTimes_default(e.length,String):[],h=u.length;for(var d in e)(t||hasOwnProperty$9.call(e,d))&&!(c&&(d=="length"||o&&(d=="offset"||d=="parent")||a&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||_isIndex_default(d,h)))&&u.push(d);return u}var _arrayLikeKeys_default=arrayLikeKeys;function overArg(e,t){return function(i){return e(t(i))}}var _overArg_default=overArg,nativeKeys=_overArg_default(Object.keys,Object),_nativeKeys_default=nativeKeys,objectProto$8=Object.prototype,hasOwnProperty$8=objectProto$8.hasOwnProperty;function baseKeys(e){if(!_isPrototype_default(e))return _nativeKeys_default(e);var t=[];for(var i in Object(e))hasOwnProperty$8.call(e,i)&&i!="constructor"&&t.push(i);return t}var _baseKeys_default=baseKeys;function keys(e){return isArrayLike_default(e)?_arrayLikeKeys_default(e):_baseKeys_default(e)}var keys_default=keys;function nativeKeysIn(e){var t=[];if(e!=null)for(var i in Object(e))t.push(i);return t}var _nativeKeysIn_default=nativeKeysIn,objectProto$7=Object.prototype,hasOwnProperty$7=objectProto$7.hasOwnProperty;function baseKeysIn(e){if(!isObject_default(e))return _nativeKeysIn_default(e);var t=_isPrototype_default(e),i=[];for(var r in e)r=="constructor"&&(t||!hasOwnProperty$7.call(e,r))||i.push(r);return i}var _baseKeysIn_default=baseKeysIn;function keysIn(e){return isArrayLike_default(e)?_arrayLikeKeys_default(e,!0):_baseKeysIn_default(e)}var keysIn_default=keysIn,assignIn=_createAssigner_default(function(e,t){_copyObject_default(t,keysIn_default(t),e)}),assignIn_default=assignIn,reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(e,t){if(isArray_default(e))return!1;var i=typeof e;return i=="number"||i=="symbol"||i=="boolean"||e==null||isSymbol_default(e)?!0:reIsPlainProp.test(e)||!reIsDeepProp.test(e)||t!=null&&e in Object(t)}var _isKey_default=isKey,nativeCreate=_getNative_default(Object,"create"),_nativeCreate_default=nativeCreate;function hashClear(){this.__data__=_nativeCreate_default?_nativeCreate_default(null):{},this.size=0}var _hashClear_default=hashClear;function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var _hashDelete_default=hashDelete,HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$6=Object.prototype,hasOwnProperty$6=objectProto$6.hasOwnProperty;function hashGet(e){var t=this.__data__;if(_nativeCreate_default){var i=t[e];return i===HASH_UNDEFINED$2?void 0:i}return hasOwnProperty$6.call(t,e)?t[e]:void 0}var _hashGet_default=hashGet,objectProto$5=Object.prototype,hasOwnProperty$5=objectProto$5.hasOwnProperty;function hashHas(e){var t=this.__data__;return _nativeCreate_default?t[e]!==void 0:hasOwnProperty$5.call(t,e)}var _hashHas_default=hashHas,HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=_nativeCreate_default&&t===void 0?HASH_UNDEFINED$1:t,this}var _hashSet_default=hashSet;function Hash(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}Hash.prototype.clear=_hashClear_default,Hash.prototype.delete=_hashDelete_default,Hash.prototype.get=_hashGet_default,Hash.prototype.has=_hashHas_default,Hash.prototype.set=_hashSet_default;var _Hash_default=Hash;function listCacheClear(){this.__data__=[],this.size=0}var _listCacheClear_default=listCacheClear;function assocIndexOf(e,t){for(var i=e.length;i--;)if(eq_default(e[i][0],t))return i;return-1}var _assocIndexOf_default=assocIndexOf,arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(e){var t=this.__data__,i=_assocIndexOf_default(t,e);if(i<0)return!1;var r=t.length-1;return i==r?t.pop():splice.call(t,i,1),--this.size,!0}var _listCacheDelete_default=listCacheDelete;function listCacheGet(e){var t=this.__data__,i=_assocIndexOf_default(t,e);return i<0?void 0:t[i][1]}var _listCacheGet_default=listCacheGet;function listCacheHas(e){return _assocIndexOf_default(this.__data__,e)>-1}var _listCacheHas_default=listCacheHas;function listCacheSet(e,t){var i=this.__data__,r=_assocIndexOf_default(i,e);return r<0?(++this.size,i.push([e,t])):i[r][1]=t,this}var _listCacheSet_default=listCacheSet;function ListCache(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}ListCache.prototype.clear=_listCacheClear_default,ListCache.prototype.delete=_listCacheDelete_default,ListCache.prototype.get=_listCacheGet_default,ListCache.prototype.has=_listCacheHas_default,ListCache.prototype.set=_listCacheSet_default;var _ListCache_default=ListCache,Map$1=_getNative_default(_root_default,"Map"),_Map_default=Map$1;function mapCacheClear(){this.size=0,this.__data__={hash:new _Hash_default,map:new(_Map_default||_ListCache_default),string:new _Hash_default}}var _mapCacheClear_default=mapCacheClear;function isKeyable(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var _isKeyable_default=isKeyable;function getMapData(e,t){var i=e.__data__;return _isKeyable_default(t)?i[typeof t=="string"?"string":"hash"]:i.map}var _getMapData_default=getMapData;function mapCacheDelete(e){var t=_getMapData_default(this,e).delete(e);return this.size-=t?1:0,t}var _mapCacheDelete_default=mapCacheDelete;function mapCacheGet(e){return _getMapData_default(this,e).get(e)}var _mapCacheGet_default=mapCacheGet;function mapCacheHas(e){return _getMapData_default(this,e).has(e)}var _mapCacheHas_default=mapCacheHas;function mapCacheSet(e,t){var i=_getMapData_default(this,e),r=i.size;return i.set(e,t),this.size+=i.size==r?0:1,this}var _mapCacheSet_default=mapCacheSet;function MapCache(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}MapCache.prototype.clear=_mapCacheClear_default,MapCache.prototype.delete=_mapCacheDelete_default,MapCache.prototype.get=_mapCacheGet_default,MapCache.prototype.has=_mapCacheHas_default,MapCache.prototype.set=_mapCacheSet_default;var _MapCache_default=MapCache,FUNC_ERROR_TEXT$2="Expected a function";function memoize(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(FUNC_ERROR_TEXT$2);var i=function(){var r=arguments,o=t?t.apply(this,r):r[0],a=i.cache;if(a.has(o))return a.get(o);var c=e.apply(this,r);return i.cache=a.set(o,c)||a,c};return i.cache=new(memoize.Cache||_MapCache_default),i}memoize.Cache=_MapCache_default;var memoize_default=memoize,MAX_MEMOIZE_SIZE=500;function memoizeCapped(e){var t=memoize_default(e,function(r){return i.size===MAX_MEMOIZE_SIZE&&i.clear(),r}),i=t.cache;return t}var _memoizeCapped_default=memoizeCapped,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=_memoizeCapped_default(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(rePropName,function(i,r,o,a){t.push(o?a.replace(reEscapeChar,"$1"):r||i)}),t}),_stringToPath_default=stringToPath;function toString$1(e){return e==null?"":_baseToString_default(e)}var toString_default=toString$1;function castPath(e,t){return isArray_default(e)?e:_isKey_default(e,t)?[e]:_stringToPath_default(toString_default(e))}var _castPath_default=castPath,INFINITY=1/0;function toKey(e){if(typeof e=="string"||isSymbol_default(e))return e;var t=e+"";return t=="0"&&1/e==-INFINITY?"-0":t}var _toKey_default=toKey;function baseGet(e,t){t=_castPath_default(t,e);for(var i=0,r=t.length;e!=null&&i<r;)e=e[_toKey_default(t[i++])];return i&&i==r?e:void 0}var _baseGet_default=baseGet;function get(e,t,i){var r=e==null?void 0:_baseGet_default(e,t);return r===void 0?i:r}var get_default=get;function arrayPush(e,t){for(var i=-1,r=t.length,o=e.length;++i<r;)e[o+i]=t[i];return e}var _arrayPush_default=arrayPush,getPrototype=_overArg_default(Object.getPrototypeOf,Object),_getPrototype_default=getPrototype,objectTag$3="[object Object]",funcProto=Function.prototype,objectProto$4=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$4=objectProto$4.hasOwnProperty,objectCtorString=funcToString.call(Object);function isPlainObject$1(e){if(!isObjectLike_default(e)||_baseGetTag_default(e)!=objectTag$3)return!1;var t=_getPrototype_default(e);if(t===null)return!0;var i=hasOwnProperty$4.call(t,"constructor")&&t.constructor;return typeof i=="function"&&i instanceof i&&funcToString.call(i)==objectCtorString}var isPlainObject_default=isPlainObject$1;function baseSlice(e,t,i){var r=-1,o=e.length;t<0&&(t=-t>o?0:o+t),i=i>o?o:i,i<0&&(i+=o),o=t>i?0:i-t>>>0,t>>>=0;for(var a=Array(o);++r<o;)a[r]=e[r+t];return a}var _baseSlice_default=baseSlice;function stackClear(){this.__data__=new _ListCache_default,this.size=0}var _stackClear_default=stackClear;function stackDelete(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}var _stackDelete_default=stackDelete;function stackGet(e){return this.__data__.get(e)}var _stackGet_default=stackGet;function stackHas(e){return this.__data__.has(e)}var _stackHas_default=stackHas,LARGE_ARRAY_SIZE=200;function stackSet(e,t){var i=this.__data__;if(i instanceof _ListCache_default){var r=i.__data__;if(!_Map_default||r.length<LARGE_ARRAY_SIZE-1)return r.push([e,t]),this.size=++i.size,this;i=this.__data__=new _MapCache_default(r)}return i.set(e,t),this.size=i.size,this}var _stackSet_default=stackSet;function Stack(e){var t=this.__data__=new _ListCache_default(e);this.size=t.size}Stack.prototype.clear=_stackClear_default,Stack.prototype.delete=_stackDelete_default,Stack.prototype.get=_stackGet_default,Stack.prototype.has=_stackHas_default,Stack.prototype.set=_stackSet_default;var _Stack_default=Stack;function baseAssign(e,t){return e&&_copyObject_default(t,keys_default(t),e)}var _baseAssign_default=baseAssign;function baseAssignIn(e,t){return e&&_copyObject_default(t,keysIn_default(t),e)}var _baseAssignIn_default=baseAssignIn,freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer$1=moduleExports?_root_default.Buffer:void 0,allocUnsafe=Buffer$1?Buffer$1.allocUnsafe:void 0;function cloneBuffer(e,t){if(t)return e.slice();var i=e.length,r=allocUnsafe?allocUnsafe(i):new e.constructor(i);return e.copy(r),r}var _cloneBuffer_default=cloneBuffer;function arrayFilter(e,t){for(var i=-1,r=e==null?0:e.length,o=0,a=[];++i<r;){var c=e[i];t(c,i,e)&&(a[o++]=c)}return a}var _arrayFilter_default=arrayFilter;function stubArray(){return[]}var stubArray_default=stubArray,objectProto$3=Object.prototype,propertyIsEnumerable=objectProto$3.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols$1?function(e){return e==null?[]:(e=Object(e),_arrayFilter_default(nativeGetSymbols$1(e),function(t){return propertyIsEnumerable.call(e,t)}))}:stubArray_default,_getSymbols_default=getSymbols;function copySymbols(e,t){return _copyObject_default(e,_getSymbols_default(e),t)}var _copySymbols_default=copySymbols,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols?function(e){for(var t=[];e;)_arrayPush_default(t,_getSymbols_default(e)),e=_getPrototype_default(e);return t}:stubArray_default,_getSymbolsIn_default=getSymbolsIn;function copySymbolsIn(e,t){return _copyObject_default(e,_getSymbolsIn_default(e),t)}var _copySymbolsIn_default=copySymbolsIn;function baseGetAllKeys(e,t,i){var r=t(e);return isArray_default(e)?r:_arrayPush_default(r,i(e))}var _baseGetAllKeys_default=baseGetAllKeys;function getAllKeys(e){return _baseGetAllKeys_default(e,keys_default,_getSymbols_default)}var _getAllKeys_default=getAllKeys;function getAllKeysIn(e){return _baseGetAllKeys_default(e,keysIn_default,_getSymbolsIn_default)}var _getAllKeysIn_default=getAllKeysIn,DataView$1=_getNative_default(_root_default,"DataView"),_DataView_default=DataView$1,Promise$1=_getNative_default(_root_default,"Promise"),_Promise_default=Promise$1,Set$1=_getNative_default(_root_default,"Set"),_Set_default=Set$1,mapTag$4="[object Map]",objectTag$2="[object Object]",promiseTag="[object Promise]",setTag$4="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$3="[object DataView]",dataViewCtorString=_toSource_default(_DataView_default),mapCtorString=_toSource_default(_Map_default),promiseCtorString=_toSource_default(_Promise_default),setCtorString=_toSource_default(_Set_default),weakMapCtorString=_toSource_default(_WeakMap_default),getTag=_baseGetTag_default;(_DataView_default&&getTag(new _DataView_default(new ArrayBuffer(1)))!=dataViewTag$3||_Map_default&&getTag(new _Map_default)!=mapTag$4||_Promise_default&&getTag(_Promise_default.resolve())!=promiseTag||_Set_default&&getTag(new _Set_default)!=setTag$4||_WeakMap_default&&getTag(new _WeakMap_default)!=weakMapTag$1)&&(getTag=function(e){var t=_baseGetTag_default(e),i=t==objectTag$2?e.constructor:void 0,r=i?_toSource_default(i):"";if(r)switch(r){case dataViewCtorString:return dataViewTag$3;case mapCtorString:return mapTag$4;case promiseCtorString:return promiseTag;case setCtorString:return setTag$4;case weakMapCtorString:return weakMapTag$1}return t});var _getTag_default=getTag,objectProto$2=Object.prototype,hasOwnProperty$3=objectProto$2.hasOwnProperty;function initCloneArray(e){var t=e.length,i=new e.constructor(t);return t&&typeof e[0]=="string"&&hasOwnProperty$3.call(e,"index")&&(i.index=e.index,i.input=e.input),i}var _initCloneArray_default=initCloneArray,Uint8Array$1=_root_default.Uint8Array,_Uint8Array_default=Uint8Array$1;function cloneArrayBuffer(e){var t=new e.constructor(e.byteLength);return new _Uint8Array_default(t).set(new _Uint8Array_default(e)),t}var _cloneArrayBuffer_default=cloneArrayBuffer;function cloneDataView(e,t){var i=t?_cloneArrayBuffer_default(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}var _cloneDataView_default=cloneDataView,reFlags=/\w*$/;function cloneRegExp(e){var t=new e.constructor(e.source,reFlags.exec(e));return t.lastIndex=e.lastIndex,t}var _cloneRegExp_default=cloneRegExp,symbolProto$1=_Symbol_default?_Symbol_default.prototype:void 0,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:void 0;function cloneSymbol(e){return symbolValueOf$1?Object(symbolValueOf$1.call(e)):{}}var _cloneSymbol_default=cloneSymbol;function cloneTypedArray(e,t){var i=t?_cloneArrayBuffer_default(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}var _cloneTypedArray_default=cloneTypedArray,boolTag$2="[object Boolean]",dateTag$2="[object Date]",mapTag$3="[object Map]",numberTag$2="[object Number]",regexpTag$2="[object RegExp]",setTag$3="[object Set]",stringTag$3="[object String]",symbolTag$2="[object Symbol]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(e,t,i){var r=e.constructor;switch(t){case arrayBufferTag$2:return _cloneArrayBuffer_default(e);case boolTag$2:case dateTag$2:return new r(+e);case dataViewTag$2:return _cloneDataView_default(e,i);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return _cloneTypedArray_default(e,i);case mapTag$3:return new r;case numberTag$2:case stringTag$3:return new r(e);case regexpTag$2:return _cloneRegExp_default(e);case setTag$3:return new r;case symbolTag$2:return _cloneSymbol_default(e)}}var _initCloneByTag_default=initCloneByTag;function initCloneObject(e){return typeof e.constructor=="function"&&!_isPrototype_default(e)?_baseCreate_default(_getPrototype_default(e)):{}}var _initCloneObject_default=initCloneObject,mapTag$2="[object Map]";function baseIsMap(e){return isObjectLike_default(e)&&_getTag_default(e)==mapTag$2}var _baseIsMap_default=baseIsMap,nodeIsMap=_nodeUtil_default&&_nodeUtil_default.isMap,isMap=nodeIsMap?_baseUnary_default(nodeIsMap):_baseIsMap_default,isMap_default=isMap,setTag$2="[object Set]";function baseIsSet(e){return isObjectLike_default(e)&&_getTag_default(e)==setTag$2}var _baseIsSet_default=baseIsSet,nodeIsSet=_nodeUtil_default&&_nodeUtil_default.isSet,isSet=nodeIsSet?_baseUnary_default(nodeIsSet):_baseIsSet_default,isSet_default=isSet,CLONE_DEEP_FLAG$2=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG$3=4,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag$1="[object Map]",numberTag$1="[object Number]",objectTag$1="[object Object]",regexpTag$1="[object RegExp]",setTag$1="[object Set]",stringTag$2="[object String]",symbolTag$1="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",cloneableTags={};cloneableTags[argsTag$1]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$1]=cloneableTags[dataViewTag$1]=cloneableTags[boolTag$1]=cloneableTags[dateTag$1]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag$1]=cloneableTags[numberTag$1]=cloneableTags[objectTag$1]=cloneableTags[regexpTag$1]=cloneableTags[setTag$1]=cloneableTags[stringTag$2]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag$1]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;function baseClone(e,t,i,r,o,a){var c,u=t&CLONE_DEEP_FLAG$2,h=t&CLONE_FLAT_FLAG,d=t&CLONE_SYMBOLS_FLAG$3;if(i&&(c=o?i(e,r,o,a):i(e)),c!==void 0)return c;if(!isObject_default(e))return e;var f=isArray_default(e);if(f){if(c=_initCloneArray_default(e),!u)return _copyArray_default(e,c)}else{var m=_getTag_default(e),g=m==funcTag||m==genTag;if(isBuffer_default(e))return _cloneBuffer_default(e,u);if(m==objectTag$1||m==argsTag$1||g&&!o){if(c=h||g?{}:_initCloneObject_default(e),!u)return h?_copySymbolsIn_default(e,_baseAssignIn_default(c,e)):_copySymbols_default(e,_baseAssign_default(c,e))}else{if(!cloneableTags[m])return o?e:{};c=_initCloneByTag_default(e,m,u)}}a||(a=new _Stack_default);var v=a.get(e);if(v)return v;a.set(e,c),isSet_default(e)?e.forEach(function(S){c.add(baseClone(S,t,i,S,e,a))}):isMap_default(e)&&e.forEach(function(S,T){c.set(T,baseClone(S,t,i,T,e,a))});var _=d?h?_getAllKeysIn_default:_getAllKeys_default:h?keysIn_default:keys_default,b=f?void 0:_(e);return _arrayEach_default(b||e,function(S,T){b&&(T=S,S=e[T]),_assignValue_default(c,T,baseClone(S,t,i,T,e,a))}),c}var _baseClone_default=baseClone,CLONE_SYMBOLS_FLAG$2=4;function clone$1(e){return _baseClone_default(e,CLONE_SYMBOLS_FLAG$2)}var clone_default=clone$1,CLONE_DEEP_FLAG$1=1,CLONE_SYMBOLS_FLAG$1=4;function cloneDeep(e){return _baseClone_default(e,CLONE_DEEP_FLAG$1|CLONE_SYMBOLS_FLAG$1)}var cloneDeep_default=cloneDeep,CLONE_DEEP_FLAG=1,CLONE_SYMBOLS_FLAG=4;function cloneDeepWith(e,t){return t=typeof t=="function"?t:void 0,_baseClone_default(e,CLONE_DEEP_FLAG|CLONE_SYMBOLS_FLAG,t)}var cloneDeepWith_default=cloneDeepWith,HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(e){return this.__data__.set(e,HASH_UNDEFINED),this}var _setCacheAdd_default=setCacheAdd;function setCacheHas(e){return this.__data__.has(e)}var _setCacheHas_default=setCacheHas;function SetCache(e){var t=-1,i=e==null?0:e.length;for(this.__data__=new _MapCache_default;++t<i;)this.add(e[t])}SetCache.prototype.add=SetCache.prototype.push=_setCacheAdd_default,SetCache.prototype.has=_setCacheHas_default;var _SetCache_default=SetCache;function arraySome(e,t){for(var i=-1,r=e==null?0:e.length;++i<r;)if(t(e[i],i,e))return!0;return!1}var _arraySome_default=arraySome;function cacheHas(e,t){return e.has(t)}var _cacheHas_default=cacheHas,COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays(e,t,i,r,o,a){var c=i&COMPARE_PARTIAL_FLAG$5,u=e.length,h=t.length;if(u!=h&&!(c&&h>u))return!1;var d=a.get(e),f=a.get(t);if(d&&f)return d==t&&f==e;var m=-1,g=!0,v=i&COMPARE_UNORDERED_FLAG$3?new _SetCache_default:void 0;for(a.set(e,t),a.set(t,e);++m<u;){var _=e[m],b=t[m];if(r)var S=c?r(b,_,m,t,e,a):r(_,b,m,e,t,a);if(S!==void 0){if(S)continue;g=!1;break}if(v){if(!_arraySome_default(t,function(T,A){if(!_cacheHas_default(v,A)&&(_===T||o(_,T,i,r,a)))return v.push(A)})){g=!1;break}}else if(!(_===b||o(_,b,i,r,a))){g=!1;break}}return a.delete(e),a.delete(t),g}var _equalArrays_default=equalArrays;function mapToArray(e){var t=-1,i=Array(e.size);return e.forEach(function(r,o){i[++t]=[o,r]}),i}var _mapToArray_default=mapToArray;function setToArray(e){var t=-1,i=Array(e.size);return e.forEach(function(r){i[++t]=r}),i}var _setToArray_default=setToArray,COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2,boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",mapTag="[object Map]",numberTag="[object Number]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag$1="[object String]",symbolTag="[object Symbol]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",symbolProto=_Symbol_default?_Symbol_default.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag(e,t,i,r,o,a,c){switch(i){case dataViewTag:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case arrayBufferTag:return!(e.byteLength!=t.byteLength||!a(new _Uint8Array_default(e),new _Uint8Array_default(t)));case boolTag:case dateTag:case numberTag:return eq_default(+e,+t);case errorTag:return e.name==t.name&&e.message==t.message;case regexpTag:case stringTag$1:return e==t+"";case mapTag:var u=_mapToArray_default;case setTag:var h=r&COMPARE_PARTIAL_FLAG$4;if(u||(u=_setToArray_default),e.size!=t.size&&!h)return!1;var d=c.get(e);if(d)return d==t;r|=COMPARE_UNORDERED_FLAG$2,c.set(e,t);var f=_equalArrays_default(u(e),u(t),r,o,a,c);return c.delete(e),f;case symbolTag:if(symbolValueOf)return symbolValueOf.call(e)==symbolValueOf.call(t)}return!1}var _equalByTag_default=equalByTag,COMPARE_PARTIAL_FLAG$3=1,objectProto$1=Object.prototype,hasOwnProperty$2=objectProto$1.hasOwnProperty;function equalObjects(e,t,i,r,o,a){var c=i&COMPARE_PARTIAL_FLAG$3,u=_getAllKeys_default(e),h=u.length,d=_getAllKeys_default(t),f=d.length;if(h!=f&&!c)return!1;for(var m=h;m--;){var g=u[m];if(!(c?g in t:hasOwnProperty$2.call(t,g)))return!1}var v=a.get(e),_=a.get(t);if(v&&_)return v==t&&_==e;var b=!0;a.set(e,t),a.set(t,e);for(var S=c;++m<h;){g=u[m];var T=e[g],A=t[g];if(r)var I=c?r(A,T,g,t,e,a):r(T,A,g,e,t,a);if(!(I===void 0?T===A||o(T,A,i,r,a):I)){b=!1;break}S||(S=g=="constructor")}if(b&&!S){var R=e.constructor,O=t.constructor;R!=O&&"constructor"in e&&"constructor"in t&&!(typeof R=="function"&&R instanceof R&&typeof O=="function"&&O instanceof O)&&(b=!1)}return a.delete(e),a.delete(t),b}var _equalObjects_default=equalObjects,COMPARE_PARTIAL_FLAG$2=1,argsTag="[object Arguments]",arrayTag="[object Array]",objectTag="[object Object]",objectProto=Object.prototype,hasOwnProperty$1=objectProto.hasOwnProperty;function baseIsEqualDeep(e,t,i,r,o,a){var c=isArray_default(e),u=isArray_default(t),h=c?arrayTag:_getTag_default(e),d=u?arrayTag:_getTag_default(t);h=h==argsTag?objectTag:h,d=d==argsTag?objectTag:d;var f=h==objectTag,m=d==objectTag,g=h==d;if(g&&isBuffer_default(e)){if(!isBuffer_default(t))return!1;c=!0,f=!1}if(g&&!f)return a||(a=new _Stack_default),c||isTypedArray_default(e)?_equalArrays_default(e,t,i,r,o,a):_equalByTag_default(e,t,h,i,r,o,a);if(!(i&COMPARE_PARTIAL_FLAG$2)){var v=f&&hasOwnProperty$1.call(e,"__wrapped__"),_=m&&hasOwnProperty$1.call(t,"__wrapped__");if(v||_){var b=v?e.value():e,S=_?t.value():t;return a||(a=new _Stack_default),o(b,S,i,r,a)}}return g?(a||(a=new _Stack_default),_equalObjects_default(e,t,i,r,o,a)):!1}var _baseIsEqualDeep_default=baseIsEqualDeep;function baseIsEqual(e,t,i,r,o){return e===t?!0:e==null||t==null||!isObjectLike_default(e)&&!isObjectLike_default(t)?e!==e&&t!==t:_baseIsEqualDeep_default(e,t,i,r,baseIsEqual,o)}var _baseIsEqual_default=baseIsEqual,COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch(e,t,i,r){var o=i.length,a=o,c=!r;if(e==null)return!a;for(e=Object(e);o--;){var u=i[o];if(c&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++o<a;){u=i[o];var h=u[0],d=e[h],f=u[1];if(c&&u[2]){if(d===void 0&&!(h in e))return!1}else{var m=new _Stack_default;if(r)var g=r(d,f,h,e,t,m);if(!(g===void 0?_baseIsEqual_default(f,d,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,r,m):g))return!1}}return!0}var _baseIsMatch_default=baseIsMatch;function isStrictComparable(e){return e===e&&!isObject_default(e)}var _isStrictComparable_default=isStrictComparable;function getMatchData(e){for(var t=keys_default(e),i=t.length;i--;){var r=t[i],o=e[r];t[i]=[r,o,_isStrictComparable_default(o)]}return t}var _getMatchData_default=getMatchData;function matchesStrictComparable(e,t){return function(i){return i==null?!1:i[e]===t&&(t!==void 0||e in Object(i))}}var _matchesStrictComparable_default=matchesStrictComparable;function baseMatches(e){var t=_getMatchData_default(e);return t.length==1&&t[0][2]?_matchesStrictComparable_default(t[0][0],t[0][1]):function(i){return i===e||_baseIsMatch_default(i,e,t)}}var _baseMatches_default=baseMatches;function baseHasIn(e,t){return e!=null&&t in Object(e)}var _baseHasIn_default=baseHasIn;function hasPath(e,t,i){t=_castPath_default(t,e);for(var r=-1,o=t.length,a=!1;++r<o;){var c=_toKey_default(t[r]);if(!(a=e!=null&&i(e,c)))break;e=e[c]}return a||++r!=o?a:(o=e==null?0:e.length,!!o&&isLength_default(o)&&_isIndex_default(c,o)&&(isArray_default(e)||isArguments_default(e)))}var _hasPath_default=hasPath;function hasIn(e,t){return e!=null&&_hasPath_default(e,t,_baseHasIn_default)}var hasIn_default=hasIn,COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty(e,t){return _isKey_default(e)&&_isStrictComparable_default(t)?_matchesStrictComparable_default(_toKey_default(e),t):function(i){var r=get_default(i,e);return r===void 0&&r===t?hasIn_default(i,e):_baseIsEqual_default(t,r,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}var _baseMatchesProperty_default=baseMatchesProperty;function baseProperty(e){return function(t){return t?.[e]}}var _baseProperty_default=baseProperty;function basePropertyDeep(e){return function(t){return _baseGet_default(t,e)}}var _basePropertyDeep_default=basePropertyDeep;function property(e){return _isKey_default(e)?_baseProperty_default(_toKey_default(e)):_basePropertyDeep_default(e)}var property_default=property;function baseIteratee(e){return typeof e=="function"?e:e==null?identity_default:typeof e=="object"?isArray_default(e)?_baseMatchesProperty_default(e[0],e[1]):_baseMatches_default(e):property_default(e)}var _baseIteratee_default=baseIteratee;function createBaseFor(e){return function(t,i,r){for(var o=-1,a=Object(t),c=r(t),u=c.length;u--;){var h=c[e?u:++o];if(i(a[h],h,a)===!1)break}return t}}var _createBaseFor_default=createBaseFor,baseFor=_createBaseFor_default(),_baseFor_default=baseFor;function baseForOwn(e,t){return e&&_baseFor_default(e,t,keys_default)}var _baseForOwn_default=baseForOwn,now=function(){return _root_default.Date.now()},now_default=now,FUNC_ERROR_TEXT$1="Expected a function",nativeMax=Math.max,nativeMin=Math.min;function debounce$2(e,t,i){var r,o,a,c,u,h,d=0,f=!1,m=!1,g=!0;if(typeof e!="function")throw new TypeError(FUNC_ERROR_TEXT$1);t=toNumber_default(t)||0,isObject_default(i)&&(f=!!i.leading,m="maxWait"in i,a=m?nativeMax(toNumber_default(i.maxWait)||0,t):a,g="trailing"in i?!!i.trailing:g);function v(P){var L=r,V=o;return r=o=void 0,d=P,c=e.apply(V,L),c}function _(P){return d=P,u=setTimeout(T,t),f?v(P):c}function b(P){var L=P-h,V=P-d,U=t-L;return m?nativeMin(U,a-V):U}function S(P){var L=P-h,V=P-d;return h===void 0||L>=t||L<0||m&&V>=a}function T(){var P=now_default();if(S(P))return A(P);u=setTimeout(T,b(P))}function A(P){return u=void 0,g&&r?v(P):(r=o=void 0,c)}function I(){u!==void 0&&clearTimeout(u),d=0,r=h=o=u=void 0}function R(){return u===void 0?c:A(now_default())}function O(){var P=now_default(),L=S(P);if(r=arguments,o=this,h=P,L){if(u===void 0)return _(h);if(m)return clearTimeout(u),u=setTimeout(T,t),v(h)}return u===void 0&&(u=setTimeout(T,t)),c}return O.cancel=I,O.flush=R,O}var debounce_default=debounce$2;function assignMergeValue(e,t,i){(i!==void 0&&!eq_default(e[t],i)||i===void 0&&!(t in e))&&_baseAssignValue_default(e,t,i)}var _assignMergeValue_default=assignMergeValue;function isArrayLikeObject(e){return isObjectLike_default(e)&&isArrayLike_default(e)}var isArrayLikeObject_default=isArrayLikeObject;function safeGet(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var _safeGet_default=safeGet;function toPlainObject(e){return _copyObject_default(e,keysIn_default(e))}var toPlainObject_default=toPlainObject;function baseMergeDeep(e,t,i,r,o,a,c){var u=_safeGet_default(e,i),h=_safeGet_default(t,i),d=c.get(h);if(d){_assignMergeValue_default(e,i,d);return}var f=a?a(u,h,i+"",e,t,c):void 0,m=f===void 0;if(m){var g=isArray_default(h),v=!g&&isBuffer_default(h),_=!g&&!v&&isTypedArray_default(h);f=h,g||v||_?isArray_default(u)?f=u:isArrayLikeObject_default(u)?f=_copyArray_default(u):v?(m=!1,f=_cloneBuffer_default(h,!0)):_?(m=!1,f=_cloneTypedArray_default(h,!0)):f=[]:isPlainObject_default(h)||isArguments_default(h)?(f=u,isArguments_default(u)?f=toPlainObject_default(u):(!isObject_default(u)||isFunction_default(u))&&(f=_initCloneObject_default(h))):m=!1}m&&(c.set(h,f),o(f,h,r,a,c),c.delete(h)),_assignMergeValue_default(e,i,f)}var _baseMergeDeep_default=baseMergeDeep;function baseMerge(e,t,i,r,o){e!==t&&_baseFor_default(t,function(a,c){if(o||(o=new _Stack_default),isObject_default(a))_baseMergeDeep_default(e,t,c,i,baseMerge,r,o);else{var u=r?r(_safeGet_default(e,c),a,c+"",e,t,o):void 0;u===void 0&&(u=a),_assignMergeValue_default(e,c,u)}},keysIn_default)}var _baseMerge_default=baseMerge;function last(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var last_default=last,stringTag="[object String]";function isString(e){return typeof e=="string"||!isArray_default(e)&&isObjectLike_default(e)&&_baseGetTag_default(e)==stringTag}var isString_default=isString;function parent(e,t){return t.length<2?e:_baseGet_default(e,_baseSlice_default(t,0,-1))}var _parent_default=parent;function isElement$4(e){return isObjectLike_default(e)&&e.nodeType===1&&!isPlainObject_default(e)}var isElement_default=isElement$4;function isEqual(e,t){return _baseIsEqual_default(e,t)}var isEqual_default=isEqual;function isEqualWith(e,t,i){i=typeof i=="function"?i:void 0;var r=i?i(e,t):void 0;return r===void 0?_baseIsEqual_default(e,t,void 0,i):!!r}var isEqualWith_default=isEqualWith;function mapValues(e,t){var i={};return t=_baseIteratee_default(t,3),_baseForOwn_default(e,function(r,o,a){_baseAssignValue_default(i,o,t(r,o,a))}),i}var mapValues_default=mapValues,merge$1=_createAssigner_default(function(e,t,i){_baseMerge_default(e,t,i)}),merge_default=merge$1;function baseUnset(e,t){return t=_castPath_default(t,e),e=_parent_default(e,t),e==null||delete e[_toKey_default(last_default(t))]}var _baseUnset_default=baseUnset;function baseSet(e,t,i,r){if(!isObject_default(e))return e;t=_castPath_default(t,e);for(var o=-1,a=t.length,c=a-1,u=e;u!=null&&++o<a;){var h=_toKey_default(t[o]),d=i;if(h==="__proto__"||h==="constructor"||h==="prototype")return e;if(o!=c){var f=u[h];d=r?r(f,h,u):void 0,d===void 0&&(d=isObject_default(f)?f:_isIndex_default(t[o+1])?[]:{})}_assignValue_default(u,h,d),u=u[h]}return e}var _baseSet_default=baseSet;function set(e,t,i){return e==null?e:_baseSet_default(e,t,i)}var set_default=set,FUNC_ERROR_TEXT="Expected a function";function throttle(e,t,i){var r=!0,o=!0;if(typeof e!="function")throw new TypeError(FUNC_ERROR_TEXT);return isObject_default(i)&&(r="leading"in i?!!i.leading:r,o="trailing"in i?!!i.trailing:o),debounce_default(e,t,{leading:r,maxWait:t,trailing:o})}var throttle_default=throttle;function unset(e,t){return e==null?!0:_baseUnset_default(e,t)}var unset_default=unset;/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/let globalVar;try{globalVar={window,document}}catch{/* istanbul ignore next -- @preserve */globalVar={window:{},document:{}}}var global$1=globalVar;function getUserAgent(){try{return navigator.userAgent.toLowerCase()}catch{return""}}const userAgent=getUserAgent(),env={isMac:isMac(userAgent),isWindows:isWindows(userAgent),isGecko:isGecko(userAgent),isSafari:isSafari(userAgent),isiOS:isiOS(userAgent),isAndroid:isAndroid(userAgent),isBlink:isBlink(userAgent),get isMediaForcedColors(){return isMediaForcedColors()},get isMotionReduced(){return isMotionReduced()},features:{isRegExpUnicodePropertySupported:isRegExpUnicodePropertySupported()}};function isMac(e){return e.indexOf("macintosh")>-1}function isWindows(e){return e.indexOf("windows")>-1}function isGecko(e){return!!e.match(/gecko\/\d+/)}function isSafari(e){return e.indexOf(" applewebkit/")>-1&&e.indexOf("chrome")===-1}function isiOS(e){return!!e.match(/iphone|ipad/i)||isMac(e)&&navigator.maxTouchPoints>0}function isAndroid(e){return e.indexOf("android")>-1}function isBlink(e){return e.indexOf("chrome/")>-1&&e.indexOf("edge/")<0}function isRegExpUnicodePropertySupported(){let e=!1;try{e="\u0107".search(new RegExp("[\\p{L}]","u"))===0}catch{}return e}function isMediaForcedColors(){return global$1.window.matchMedia?global$1.window.matchMedia("(forced-colors: active)").matches:!1}function isMotionReduced(){return global$1.window.matchMedia?global$1.window.matchMedia("(prefers-reduced-motion)").matches:!1}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function fastDiff(e,t,i,r){i=i||function(h,d){return h===d};const o=Array.isArray(e)?e:Array.prototype.slice.call(e),a=Array.isArray(t)?t:Array.prototype.slice.call(t),c=findChangeBoundaryIndexes(o,a,i);return r?changeIndexesToAtomicChanges(c,a.length):changeIndexesToChanges(a,c)}function findChangeBoundaryIndexes(e,t,i){const r=findFirstDifferenceIndex(e,t,i);if(r===-1)return{firstIndex:-1,lastIndexOld:-1,lastIndexNew:-1};const o=cutAndReverse(e,r),a=cutAndReverse(t,r),c=findFirstDifferenceIndex(o,a,i),u=e.length-c,h=t.length-c;return{firstIndex:r,lastIndexOld:u,lastIndexNew:h}}function findFirstDifferenceIndex(e,t,i){for(let r=0;r<Math.max(e.length,t.length);r++)if(e[r]===void 0||t[r]===void 0||!i(e[r],t[r]))return r;return-1}function cutAndReverse(e,t){return e.slice(t).reverse()}function changeIndexesToChanges(e,t){const i=[],{firstIndex:r,lastIndexOld:o,lastIndexNew:a}=t;return a-r>0&&i.push({index:r,type:"insert",values:e.slice(r,a)}),o-r>0&&i.push({index:r+(a-r),type:"delete",howMany:o-r}),i}function changeIndexesToAtomicChanges(e,t){const{firstIndex:i,lastIndexOld:r,lastIndexNew:o}=e;if(i===-1)return Array(t).fill("equal");let a=[];return i>0&&(a=a.concat(Array(i).fill("equal"))),o-i>0&&(a=a.concat(Array(o-i).fill("insert"))),r-i>0&&(a=a.concat(Array(r-i).fill("delete"))),o<t&&(a=a.concat(Array(t-o).fill("equal"))),a}function diff(e,t,i){i=i||function(b,S){return b===S};const r=e.length,o=t.length;if(r>200||o>200||r+o>300)return diff.fastDiff(e,t,i,!0);let a,c;if(o<r){const b=e;e=t,t=b,a="delete",c="insert"}else a="insert",c="delete";const u=e.length,h=t.length,d=h-u,f={},m={};function g(b){const S=(m[b-1]!==void 0?m[b-1]:-1)+1,T=m[b+1]!==void 0?m[b+1]:-1,A=S>T?-1:1;f[b+A]&&(f[b]=f[b+A].slice(0)),f[b]||(f[b]=[]),f[b].push(S>T?a:c);let I=Math.max(S,T),R=I-b;for(;R<u&&I<h&&i(e[R],t[I]);)R++,I++,f[b].push("equal");return I}let v=0,_;do{for(_=-v;_<d;_++)m[_]=g(_);for(_=d+v;_>d;_--)m[_]=g(_);m[d]=g(d),v++}while(m[d]!==h);return f[d].slice(1)}diff.fastDiff=fastDiff;/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function spy$1(){return function e(){e.called=!0}}var EventInfo=class{source;name;path;stop;off;return;constructor(e,t){this.source=e,this.name=t,this.path=[],this.stop=spy$1(),this.off=spy$1()}};/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/const HEX_NUMBERS=new Array(256).fill("").map((e,t)=>("0"+t.toString(16)).slice(-2));function uid(){const[e,t,i,r]=crypto.getRandomValues(new Uint32Array(4));return"e"+HEX_NUMBERS[e>>0&255]+HEX_NUMBERS[e>>8&255]+HEX_NUMBERS[e>>16&255]+HEX_NUMBERS[e>>24&255]+HEX_NUMBERS[t>>0&255]+HEX_NUMBERS[t>>8&255]+HEX_NUMBERS[t>>16&255]+HEX_NUMBERS[t>>24&255]+HEX_NUMBERS[i>>0&255]+HEX_NUMBERS[i>>8&255]+HEX_NUMBERS[i>>16&255]+HEX_NUMBERS[i>>24&255]+HEX_NUMBERS[r>>0&255]+HEX_NUMBERS[r>>8&255]+HEX_NUMBERS[r>>16&255]+HEX_NUMBERS[r>>24&255]}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/const priorities={get(e="normal"){return typeof e!="number"?this[e]||this.normal:e},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};function insertToPriorityArray(e,t){const i=priorities.get(t.priority);let r=0,o=e.length;for(;r<o;){const a=r+o>>1;priorities.get(e[a].priority)<i?o=a:r=a+1}e.splice(r,0,t)}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/const DOCUMENTATION_URL="https://ckeditor.com/docs/ckeditor5/latest/support/error-codes.html";var CKEditorError=class gs extends Error{context;data;constructor(t,i,r){super(getErrorMessage(t,r)),this.name="CKEditorError",this.context=i,this.data=r}is(t){return t==="CKEditorError"}static rethrowUnexpectedError(t,i){if(t.is&&t.is("CKEditorError"))throw t;const r=new gs(t.message,i);throw r.stack=t.stack,r}};function logWarning(e,t){console.warn(...formatConsoleArguments(e,t))}function logError(e,t){console.error(...formatConsoleArguments(e,t))}function getLinkToDocumentationMessage(e){return`
Read more: ${DOCUMENTATION_URL}#error-${e}`}function getErrorMessage(e,t){const i=new WeakSet,o=t?` ${JSON.stringify(t,(c,u)=>{if(typeof u=="object"&&u!==null){if(i.has(u))return`[object ${u.constructor.name}]`;i.add(u)}return u})}`:"",a=getLinkToDocumentationMessage(e);return e+o+a}function formatConsoleArguments(e,t){const i=getLinkToDocumentationMessage(e);return t?[e,t,i]:[e,i]}const version="44.1.0",releaseDate=new Date(2024,11,16);/* istanbul ignore next -- @preserve */if(globalThis.CKEDITOR_VERSION)throw new CKEditorError("ckeditor-duplicated-modules",null);globalThis.CKEDITOR_VERSION=version;const _listeningTo=Symbol("listeningTo"),_emitterId=Symbol("emitterId"),_delegations=Symbol("delegations"),defaultEmitterClass$1=EmitterMixin(Object);function EmitterMixin(e){if(!e)return defaultEmitterClass$1;class t extends e{on(r,o,a){this.listenTo(this,r,o,a)}once(r,o,a){let c=!1;const u=(h,...d)=>{c||(c=!0,h.off(),o.call(this,h,...d))};this.listenTo(this,r,u,a)}off(r,o){this.stopListening(this,r,o)}listenTo(r,o,a,c={}){let u,h;this[_listeningTo]||(this[_listeningTo]={});const d=this[_listeningTo];_getEmitterId(r)||_setEmitterId(r);const f=_getEmitterId(r);(u=d[f])||(u=d[f]={emitter:r,callbacks:{}}),(h=u.callbacks[o])||(h=u.callbacks[o]=[]),h.push(a),addEventListener(this,r,o,a,c)}stopListening(r,o,a){const c=this[_listeningTo];let u=r&&_getEmitterId(r);const h=c&&u?c[u]:void 0,d=h&&o?h.callbacks[o]:void 0;if(!(!c||r&&!h||o&&!d))if(a)removeEventListener(this,r,o,a),d.indexOf(a)!==-1&&(d.length===1?delete h.callbacks[o]:removeEventListener(this,r,o,a));else if(d){for(;a=d.pop();)removeEventListener(this,r,o,a);delete h.callbacks[o]}else if(h){for(o in h.callbacks)this.stopListening(r,o);delete c[u]}else{for(u in c)this.stopListening(c[u].emitter);delete this[_listeningTo]}}fire(r,...o){try{const a=r instanceof EventInfo?r:new EventInfo(this,r),c=a.name;let u=getCallbacksForEvent(this,c);if(a.path.push(this),u){u=u.slice();for(let d=0;d<u.length;d++){const f=u[d].callback;if(f.call(this,a,...o),a.off.called&&(delete a.off.called,this._removeEventListener(c,f)),a.stop.called)break}}const h=this[_delegations];if(h){const d=h.get(c),f=h.get("*");d&&fireDelegatedEvents(d,a,o),f&&fireDelegatedEvents(f,a,o)}return a.return}catch(a){/* istanbul ignore next -- @preserve */CKEditorError.rethrowUnexpectedError(a,this)}}delegate(...r){return{to:(o,a)=>{this[_delegations]||(this[_delegations]=new Map),r.forEach(c=>{const u=this[_delegations].get(c);u?u.set(o,a):this[_delegations].set(c,new Map([[o,a]]))})}}}stopDelegating(r,o){if(this[_delegations])if(!r)this[_delegations].clear();else if(!o)this[_delegations].delete(r);else{const a=this[_delegations].get(r);a&&a.delete(o)}}_addEventListener(r,o,a){createEventNamespace(this,r);const c=getCallbacksListsForNamespace(this,r),u=priorities.get(a.priority),h={callback:o,priority:u};for(const d of c)insertToPriorityArray(d,h)}_removeEventListener(r,o){const a=getCallbacksListsForNamespace(this,r);for(const c of a)for(let u=0;u<c.length;u++)c[u].callback==o&&(c.splice(u,1),u--)}}return t}["on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(e=>{EmitterMixin[e]=defaultEmitterClass$1.prototype[e]});function _getEmitterListenedTo(e,t){const i=e[_listeningTo];return i&&i[t]?i[t].emitter:null}function _setEmitterId(e,t){e[_emitterId]||(e[_emitterId]=t||uid())}function _getEmitterId(e){return e[_emitterId]}function getEvents(e){return e._events||Object.defineProperty(e,"_events",{value:{}}),e._events}function makeEventNode(){return{callbacks:[],childEvents:[]}}function createEventNamespace(e,t){const i=getEvents(e);if(i[t])return;let r=t,o=null;const a=[];for(;r!==""&&!i[r];)i[r]=makeEventNode(),a.push(i[r]),o&&i[r].childEvents.push(o),o=r,r=r.substr(0,r.lastIndexOf(":"));if(r!==""){for(const c of a)c.callbacks=i[r].callbacks.slice();i[r].childEvents.push(o)}}function getCallbacksListsForNamespace(e,t){const i=getEvents(e)[t];if(!i)return[];let r=[i.callbacks];for(let o=0;o<i.childEvents.length;o++){const a=getCallbacksListsForNamespace(e,i.childEvents[o]);r=r.concat(a)}return r}function getCallbacksForEvent(e,t){if(!e._events)return null;let i=t;do{const r=e._events[i];if(r&&r.callbacks&&r.callbacks.length)return r.callbacks;const o=i.lastIndexOf(":");i=o>-1?i.substring(0,o):""}while(i);return null}function fireDelegatedEvents(e,t,i){for(let[r,o]of e){o?typeof o=="function"&&(o=o(t.name)):o=t.name;const a=new EventInfo(t.source,o);a.path=[...t.path],r.fire(a,...i)}}function addEventListener(e,t,i,r,o){t._addEventListener?t._addEventListener(i,r,o):e._addEventListener.call(t,i,r,o)}function removeEventListener(e,t,i,r){t._removeEventListener?t._removeEventListener(i,r):e._removeEventListener.call(t,i,r)}const observablePropertiesSymbol=Symbol("observableProperties"),boundObservablesSymbol=Symbol("boundObservables"),boundPropertiesSymbol=Symbol("boundProperties"),decoratedMethods=Symbol("decoratedMethods"),decoratedOriginal=Symbol("decoratedOriginal"),defaultObservableClass=ObservableMixin(EmitterMixin());function ObservableMixin(e){if(!e)return defaultObservableClass;class t extends e{set(r,o){if(isObject_default(r)){Object.keys(r).forEach(c=>{this.set(c,r[c])},this);return}initObservable$1(this);const a=this[observablePropertiesSymbol];if(r in this&&!a.has(r))throw new CKEditorError("observable-set-cannot-override",this);Object.defineProperty(this,r,{enumerable:!0,configurable:!0,get(){return a.get(r)},set(c){const u=a.get(r);let h=this.fire(`set:${r}`,r,c,u);h===void 0&&(h=c),(u!==h||!a.has(r))&&(a.set(r,h),this.fire(`change:${r}`,r,h,u))}}),this[r]=o}bind(...r){if(!r.length||!isStringArray$1(r))throw new CKEditorError("observable-bind-wrong-properties",this);if(new Set(r).size!==r.length)throw new CKEditorError("observable-bind-duplicate-properties",this);initObservable$1(this);const o=this[boundPropertiesSymbol];r.forEach(c=>{if(o.has(c))throw new CKEditorError("observable-bind-rebind",this)});const a=new Map;return r.forEach(c=>{const u={property:c,to:[]};o.set(c,u),a.set(c,u)}),{to:bindTo,toMany:bindToMany,_observable:this,_bindProperties:r,_to:[],_bindings:a}}unbind(...r){if(!this[observablePropertiesSymbol])return;const o=this[boundPropertiesSymbol],a=this[boundObservablesSymbol];if(r.length){if(!isStringArray$1(r))throw new CKEditorError("observable-unbind-wrong-properties",this);r.forEach(c=>{const u=o.get(c);u&&(u.to.forEach(([h,d])=>{const f=a.get(h),m=f[d];m.delete(u),m.size||delete f[d],Object.keys(f).length||(a.delete(h),this.stopListening(h,"change"))}),o.delete(c))})}else a.forEach((c,u)=>{this.stopListening(u,"change")}),a.clear(),o.clear()}decorate(r){initObservable$1(this);const o=this[r];if(!o)throw new CKEditorError("observablemixin-cannot-decorate-undefined",this,{object:this,methodName:r});this.on(r,(a,c)=>{a.return=o.apply(this,c)}),this[r]=function(...a){return this.fire(r,a)},this[r][decoratedOriginal]=o,this[decoratedMethods]||(this[decoratedMethods]=[]),this[decoratedMethods].push(r)}stopListening(r,o,a){if(!r&&this[decoratedMethods]){for(const c of this[decoratedMethods])this[c]=this[c][decoratedOriginal];delete this[decoratedMethods]}super.stopListening(r,o,a)}[observablePropertiesSymbol];[decoratedMethods];[boundPropertiesSymbol];[boundObservablesSymbol]}return t}["set","bind","unbind","decorate","on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(e=>{ObservableMixin[e]=defaultObservableClass.prototype[e]});function initObservable$1(e){e[observablePropertiesSymbol]||(Object.defineProperty(e,observablePropertiesSymbol,{value:new Map}),Object.defineProperty(e,boundObservablesSymbol,{value:new Map}),Object.defineProperty(e,boundPropertiesSymbol,{value:new Map}))}function bindTo(...e){const t=parseBindToArgs(...e),i=Array.from(this._bindings.keys()),r=i.length;if(!t.callback&&t.to.length>1)throw new CKEditorError("observable-bind-to-no-callback",this);if(r>1&&t.callback)throw new CKEditorError("observable-bind-to-extra-callback",this);t.to.forEach(o=>{if(o.properties.length&&o.properties.length!==r)throw new CKEditorError("observable-bind-to-properties-length",this);o.properties.length||(o.properties=this._bindProperties)}),this._to=t.to,t.callback&&(this._bindings.get(i[0]).callback=t.callback),attachBindToListeners(this._observable,this._to),updateBindToBound(this),this._bindProperties.forEach(o=>{updateBoundObservableProperty(this._observable,o)})}function bindToMany(e,t,i){if(this._bindings.size>1)throw new CKEditorError("observable-bind-to-many-not-one-binding",this);this.to(...getBindingTargets(e,t),i)}function getBindingTargets(e,t){const i=e.map(r=>[r,t]);return Array.prototype.concat.apply([],i)}function isStringArray$1(e){return e.every(t=>typeof t=="string")}function parseBindToArgs(...e){if(!e.length)throw new CKEditorError("observable-bind-to-parse-error",null);const t={to:[]};let i;return typeof e[e.length-1]=="function"&&(t.callback=e.pop()),e.forEach(r=>{if(typeof r=="string")i.properties.push(r);else if(typeof r=="object")i={observable:r,properties:[]},t.to.push(i);else throw new CKEditorError("observable-bind-to-parse-error",null)}),t}function updateBoundObservables(e,t,i,r){const o=e[boundObservablesSymbol],a=o.get(i),c=a||{};c[r]||(c[r]=new Set),c[r].add(t),a||o.set(i,c)}function updateBindToBound(e){let t;e._bindings.forEach((i,r)=>{e._to.forEach(o=>{t=o.properties[i.callback?0:e._bindProperties.indexOf(r)],i.to.push([o.observable,t]),updateBoundObservables(e._observable,i,o.observable,t)})})}function updateBoundObservableProperty(e,t){const r=e[boundPropertiesSymbol].get(t);let o;r.callback?o=r.callback.apply(e,r.to.map(a=>a[0][a[1]])):(o=r.to[0],o=o[0][o[1]]),Object.prototype.hasOwnProperty.call(e,t)?e[t]=o:e.set(t,o)}function attachBindToListeners(e,t){t.forEach(i=>{const r=e[boundObservablesSymbol];let o;r.get(i.observable)||e.listenTo(i.observable,"change",(a,c)=>{o=r.get(i.observable)[c],o&&o.forEach(u=>{updateBoundObservableProperty(e,u.property)})})})}var ElementReplacer=class{_replacedElements;constructor(){this._replacedElements=[]}replace(e,t){this._replacedElements.push({element:e,newElement:t}),e.style.display="none",t&&e.parentNode.insertBefore(t,e.nextSibling)}restore(){this._replacedElements.forEach(({element:e,newElement:t})=>{e.style.display="",t&&t.remove()}),this._replacedElements=[]}};/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function count(e){let t=0;for(const i of e)t++;return t}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function compareArrays(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++)if(e[r]!=t[r])return r;return e.length==t.length?"same":e.length<t.length?"prefix":"extension"}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function isIterable(e){return!!(e&&e[Symbol.iterator])}function createElement(e,t,i={},r=[]){const o=i&&i.xmlns,a=o?e.createElementNS(o,t):e.createElement(t);for(const c in i)a.setAttribute(c,i[c]);(isString_default(r)||!isIterable(r))&&(r=[r]);for(let c of r)isString_default(c)&&(c=e.createTextNode(c)),a.appendChild(c);return a}var Config=class{_config;constructor(e,t){this._config=Object.create(null),t&&this.define(cloneConfig(t)),e&&this._setObjectToTarget(this._config,e)}set(e,t){this._setToTarget(this._config,e,t)}define(e,t){this._setToTarget(this._config,e,t,!0)}get(e){return this._getFromSource(this._config,e)}*names(){for(const e of Object.keys(this._config))yield e}_setToTarget(e,t,i,r=!1){if(isPlainObject_default(t)){this._setObjectToTarget(e,t,r);return}const o=t.split(".");t=o.pop();for(const a of o)isPlainObject_default(e[a])||(e[a]=Object.create(null)),e=e[a];if(isPlainObject_default(i)){isPlainObject_default(e[t])||(e[t]=Object.create(null)),e=e[t],this._setObjectToTarget(e,i,r);return}r&&typeof e[t]<"u"||(e[t]=i)}_getFromSource(e,t){const i=t.split(".");t=i.pop();for(const r of i){if(!isPlainObject_default(e[r])){e=null;break}e=e[r]}return e?cloneConfig(e[t]):void 0}_setObjectToTarget(e,t,i){Object.keys(t).forEach(r=>{this._setToTarget(e,r,t[r],i)})}};function cloneConfig(e){return cloneDeepWith_default(e,leaveItemReferences)}function leaveItemReferences(e){return isElement_default(e)||typeof e=="function"?e:void 0}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function isNode(e){if(e){if(e.defaultView)return e instanceof e.defaultView.Document;if(e.ownerDocument&&e.ownerDocument.defaultView)return e instanceof e.ownerDocument.defaultView.Node}return!1}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function isWindow(e){const t=Object.prototype.toString.apply(e);return t=="[object Window]"||t=="[object global]"}const defaultEmitterClass=DomEmitterMixin(EmitterMixin());function DomEmitterMixin(e){if(!e)return defaultEmitterClass;class t extends e{listenTo(r,o,a,c={}){if(isNode(r)||isWindow(r)){const u={capture:!!c.useCapture,passive:!!c.usePassive},h=this._getProxyEmitter(r,u)||new ProxyEmitter(r,u);this.listenTo(h,o,a,c)}else super.listenTo(r,o,a,c)}stopListening(r,o,a){if(isNode(r)||isWindow(r)){const c=this._getAllProxyEmitters(r);for(const u of c)this.stopListening(u,o,a)}else super.stopListening(r,o,a)}_getProxyEmitter(r,o){return _getEmitterListenedTo(this,getProxyEmitterId(r,o))}_getAllProxyEmitters(r){return[{capture:!1,passive:!1},{capture:!1,passive:!0},{capture:!0,passive:!1},{capture:!0,passive:!0}].map(o=>this._getProxyEmitter(r,o)).filter(o=>!!o)}}return t}["_getProxyEmitter","_getAllProxyEmitters","on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(e=>{DomEmitterMixin[e]=defaultEmitterClass.prototype[e]});var ProxyEmitter=class extends EmitterMixin(){_domNode;_options;constructor(e,t){super(),_setEmitterId(this,getProxyEmitterId(e,t)),this._domNode=e,this._options=t}_domListeners;attach(e){if(this._domListeners&&this._domListeners[e])return;const t=this._createDomListener(e);this._domNode.addEventListener(e,t,this._options),this._domListeners||(this._domListeners={}),this._domListeners[e]=t}detach(e){let t;this._domListeners[e]&&(!(t=this._events[e])||!t.callbacks.length)&&this._domListeners[e].removeListener()}_addEventListener(e,t,i){this.attach(e),EmitterMixin().prototype._addEventListener.call(this,e,t,i)}_removeEventListener(e,t){EmitterMixin().prototype._removeEventListener.call(this,e,t),this.detach(e)}_createDomListener(e){const t=i=>{this.fire(e,i)};return t.removeListener=()=>{this._domNode.removeEventListener(e,t,this._options),delete this._domListeners[e]},t}};function getNodeUID(e){return e["data-ck-expando"]||(e["data-ck-expando"]=uid())}function getProxyEmitterId(e,t){let i=getNodeUID(e);for(const r of Object.keys(t).sort())t[r]&&(i+="-"+r);return i}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function getAncestors(e){const t=[];let i=e;for(;i&&i.nodeType!=Node.DOCUMENT_NODE;)t.unshift(i),i=i.parentNode;return t}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function getDataFromElement(e){return e instanceof HTMLTextAreaElement?e.value:e.innerHTML}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function getBorderWidths(e){const t=e.ownerDocument.defaultView.getComputedStyle(e);return{top:parseInt(t.borderTopWidth,10),right:parseInt(t.borderRightWidth,10),bottom:parseInt(t.borderBottomWidth,10),left:parseInt(t.borderLeftWidth,10)}}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function getRangeFromMouseEvent(e){if(!e.target)return null;const t=e.target.ownerDocument,i=e.clientX,r=e.clientY;let o=null;return t.caretRangeFromPoint&&t.caretRangeFromPoint(i,r)?o=t.caretRangeFromPoint(i,r):e.rangeParent&&(o=t.createRange(),o.setStart(e.rangeParent,e.rangeOffset),o.collapse(!0)),o}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function isText(e){return Object.prototype.toString.call(e)=="[object Text]"}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function isRange(e){return Object.prototype.toString.apply(e)=="[object Range]"}function getPositionedAncestor(e){return!e||!e.parentNode||e.offsetParent===global$1.document.body?null:e.offsetParent}const rectProperties=["top","right","bottom","left","width","height"];var Rect=class Jt{top;right;bottom;left;width;height;_source;constructor(t){const i=isRange(t);if(Object.defineProperty(this,"_source",{value:t._source||t,writable:!0,enumerable:!1}),isDomElement(t)||i)if(i){const r=Jt.getDomRangeRects(t);copyRectProperties(this,Jt.getBoundingRect(r))}else copyRectProperties(this,t.getBoundingClientRect());else if(isWindow(t)){const{innerWidth:r,innerHeight:o}=t;copyRectProperties(this,{top:0,right:r,bottom:o,left:0,width:r,height:o})}else copyRectProperties(this,t)}clone(){return new Jt(this)}moveTo(t,i){return this.top=i,this.right=t+this.width,this.bottom=i+this.height,this.left=t,this}moveBy(t,i){return this.top+=i,this.right+=t,this.left+=t,this.bottom+=i,this}getIntersection(t){const i={top:Math.max(this.top,t.top),right:Math.min(this.right,t.right),bottom:Math.min(this.bottom,t.bottom),left:Math.max(this.left,t.left),width:0,height:0};if(i.width=i.right-i.left,i.height=i.bottom-i.top,i.width<0||i.height<0)return null;{const r=new Jt(i);return r._source=this._source,r}}getIntersectionArea(t){const i=this.getIntersection(t);return i?i.getArea():0}getArea(){return this.width*this.height}getVisible(){const t=this._source;let i=this.clone();if(isBody(t))return i;let r=t,o=t.parentNode||t.commonAncestorContainer,a;for(;o&&!isBody(o);){const c=getElementOverflow(o)==="visible";r instanceof HTMLElement&&getElementPosition(r)==="absolute"&&(a=r);const u=getElementPosition(o);if(c||a&&(u==="relative"&&c||u!=="relative")){r=o,o=o.parentNode;continue}const h=new Jt(o),d=i.getIntersection(h);if(d)d.getArea()<i.getArea()&&(i=d);else return null;r=o,o=o.parentNode}return i}isEqual(t){for(const i of rectProperties)if(this[i]!==t[i])return!1;return!0}contains(t){const i=this.getIntersection(t);return!!(i&&i.isEqual(t))}toAbsoluteRect(){const{scrollX:t,scrollY:i}=global$1.window,r=this.clone().moveBy(t,i);if(isDomElement(r._source)){const o=getPositionedAncestor(r._source);o&&shiftRectToCompensatePositionedAncestor(r,o)}return r}excludeScrollbarsAndBorders(){const t=this._source;let i,r,o;if(isWindow(t))i=t.innerWidth-t.document.documentElement.clientWidth,r=t.innerHeight-t.document.documentElement.clientHeight,o=t.getComputedStyle(t.document.documentElement).direction;else{const a=getBorderWidths(t);i=t.offsetWidth-t.clientWidth-a.left-a.right,r=t.offsetHeight-t.clientHeight-a.top-a.bottom,o=t.ownerDocument.defaultView.getComputedStyle(t).direction,this.left+=a.left,this.top+=a.top,this.right-=a.right,this.bottom-=a.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top}return this.width-=i,o==="ltr"?this.right-=i:this.left+=i,this.height-=r,this.bottom-=r,this}static getDomRangeRects(t){const i=[],r=Array.from(t.getClientRects());if(r.length)for(const o of r)i.push(new Jt(o));else{let o=t.startContainer;isText(o)&&(o=o.parentNode);const a=new Jt(o.getBoundingClientRect());a.right=a.left,a.width=0,i.push(a)}return i}static getBoundingRect(t){const i={left:Number.POSITIVE_INFINITY,top:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY,bottom:Number.NEGATIVE_INFINITY,width:0,height:0};let r=0;for(const o of t)r++,i.left=Math.min(i.left,o.left),i.top=Math.min(i.top,o.top),i.right=Math.max(i.right,o.right),i.bottom=Math.max(i.bottom,o.bottom);return r==0?null:(i.width=i.right-i.left,i.height=i.bottom-i.top,new Jt(i))}};function copyRectProperties(e,t){for(const i of rectProperties)e[i]=t[i]}function isBody(e){return isDomElement(e)?e===e.ownerDocument.body:!1}function isDomElement(e){return e!==null&&typeof e=="object"&&e.nodeType===1&&typeof e.getBoundingClientRect=="function"}function getElementPosition(e){return e instanceof HTMLElement?e.ownerDocument.defaultView.getComputedStyle(e).position:"static"}function getElementOverflow(e){return e instanceof HTMLElement?e.ownerDocument.defaultView.getComputedStyle(e).overflow:"visible"}function shiftRectToCompensatePositionedAncestor(e,t){const i=new Rect(t),r=getBorderWidths(t);let o=0,a=0;o-=i.left,a-=i.top,o+=t.scrollLeft,a+=t.scrollTop,o-=r.left,a-=r.top,e.moveBy(o,a)}var ResizeObserver$1=class ft{_element;_callback;static _observerInstance=null;static _elementCallbacks=null;constructor(t,i){ft._observerInstance||ft._createObserver(),this._element=t,this._callback=i,ft._addElementCallback(t,i),ft._observerInstance.observe(t)}get element(){return this._element}destroy(){ft._deleteElementCallback(this._element,this._callback)}static _addElementCallback(t,i){ft._elementCallbacks||(ft._elementCallbacks=new Map);let r=ft._elementCallbacks.get(t);r||(r=new Set,ft._elementCallbacks.set(t,r)),r.add(i)}static _deleteElementCallback(t,i){const r=ft._getElementCallbacks(t);r&&(r.delete(i),r.size||(ft._elementCallbacks.delete(t),ft._observerInstance.unobserve(t))),ft._elementCallbacks&&!ft._elementCallbacks.size&&(ft._observerInstance=null,ft._elementCallbacks=null)}static _getElementCallbacks(t){return ft._elementCallbacks?ft._elementCallbacks.get(t):null}static _createObserver(){ft._observerInstance=new global$1.window.ResizeObserver(t=>{for(const i of t){const r=ft._getElementCallbacks(i.target);if(r)for(const o of r)o(i)}})}};/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function setDataInElement(e,t){e instanceof HTMLTextAreaElement&&(e.value=t),e.innerHTML=t}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function toUnit(e){return t=>t+e}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function indexOf$1(e){let t=0;for(;e.previousSibling;)e=e.previousSibling,t++;return t}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function insertAt(e,t,i){e.insertBefore(i,e.childNodes[t]||null)}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function isComment(e){return e&&e.nodeType===Node.COMMENT_NODE}function isValidAttributeName(e){try{global$1.document.createAttribute(e)}catch{return!1}return!0}function isVisible(e){return e?isText(e)?isVisible(e.parentElement):e.getClientRects?!!e.getClientRects().length:!1:!1}function getOptimalPosition({element:e,target:t,positions:i,limiter:r,fitInViewport:o,viewportOffsetConfig:a}){isFunction_default(t)&&(t=t()),isFunction_default(r)&&(r=r());const c=getPositionedAncestor(e),u=getConstrainedViewportRect(a),h=new Rect(e),d=getVisibleViewportIntersectionRect(t,u);let f;if(!d||!u.getIntersection(d))return null;const m={targetRect:d,elementRect:h,positionedElementAncestor:c,viewportRect:u};if(!r&&!o)f=new PositionObject(i[0],m);else{if(r){const g=getVisibleViewportIntersectionRect(r,u);g&&(m.limiterRect=g)}f=getBestPosition(i,m)}return f}function getVisibleViewportIntersectionRect(e,t){const i=new Rect(e).getVisible();return i?i.getIntersection(t):null}function getConstrainedViewportRect(e){e=Object.assign({top:0,bottom:0,left:0,right:0},e);const t=new Rect(global$1.window);return t.top+=e.top,t.height-=e.top,t.bottom-=e.bottom,t.height-=e.bottom,t}function getBestPosition(e,t){const{elementRect:i}=t,r=i.getArea(),o=e.map(u=>new PositionObject(u,t)).filter(u=>!!u.name);let a=0,c=null;for(const u of o){const{limiterIntersectionArea:h,viewportIntersectionArea:d}=u;if(h===r)return u;const f=d**2+h**2;f>a&&(a=f,c=u)}return c}var PositionObject=class{name;config;_positioningFunctionCoordinates;_options;_cachedRect;_cachedAbsoluteRect;constructor(e,t){const i=e(t.targetRect,t.elementRect,t.viewportRect,t.limiterRect);if(!i)return;const{left:r,top:o,name:a,config:c}=i;this.name=a,this.config=c,this._positioningFunctionCoordinates={left:r,top:o},this._options=t}get left(){return this._absoluteRect.left}get top(){return this._absoluteRect.top}get limiterIntersectionArea(){const e=this._options.limiterRect;return e?e.getIntersectionArea(this._rect):0}get viewportIntersectionArea(){return this._options.viewportRect.getIntersectionArea(this._rect)}get _rect(){return this._cachedRect?this._cachedRect:(this._cachedRect=this._options.elementRect.clone().moveTo(this._positioningFunctionCoordinates.left,this._positioningFunctionCoordinates.top),this._cachedRect)}get _absoluteRect(){return this._cachedAbsoluteRect?this._cachedAbsoluteRect:(this._cachedAbsoluteRect=this._rect.toAbsoluteRect(),this._cachedAbsoluteRect)}};/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function remove$3(e){const t=e.parentNode;t&&t.removeChild(e)}function scrollViewportToShowTarget({target:e,viewportOffset:t=0,ancestorOffset:i=0,alignToTop:r,forceScroll:o}){const a=getWindow$1(e);let c=a,u=null;for(t=normalizeViewportOffset(t);c;){let h;c==a?h=getParentElement(e):h=getParentElement(u),scrollAncestorsToShowRect({parent:h,getRect:()=>getRectRelativeToWindow(e,c),alignToTop:r,ancestorOffset:i,forceScroll:o});let d=getRectRelativeToWindow(e,c);const f=getRectRelativeToWindow(h,c);if(d.height>f.height){const m=d.getIntersection(f);m&&(d=m)}if(scrollWindowToShowRect({window:c,rect:d,viewportOffset:t,alignToTop:r,forceScroll:o}),c.parent!=c){if(u=c.frameElement,c=c.parent,!u)return}else c=null}}function scrollWindowToShowRect({window:e,rect:t,alignToTop:i,forceScroll:r,viewportOffset:o}){const a=t.clone().moveBy(0,o.bottom),c=t.clone().moveBy(0,-o.top),u=new Rect(e).excludeScrollbarsAndBorders(),h=[c,a],d=i&&r,f=h.every(b=>u.contains(b));let{scrollX:m,scrollY:g}=e;const v=m,_=g;d?g-=u.top-t.top+o.top:f||(isAbove(c,u)?g-=u.top-t.top+o.top:isBelow(a,u)&&(i?g+=t.top-u.top-o.top:g+=t.bottom-u.bottom+o.bottom)),f||(isLeftOf(t,u)?m-=u.left-t.left+o.left:isRightOf(t,u)&&(m+=t.right-u.right+o.right)),(m!=v||g!==_)&&e.scrollTo(m,g)}function scrollAncestorsToShowRect({parent:e,getRect:t,alignToTop:i,forceScroll:r,ancestorOffset:o=0,limiterElement:a}){const c=getWindow$1(e),u=i&&r;let h,d,f;const m=a||c.document.body;for(;e!=m;)d=t(),h=new Rect(e).excludeScrollbarsAndBorders(),f=h.contains(d),u?e.scrollTop-=h.top-d.top+o:f||(isAbove(d,h)?e.scrollTop-=h.top-d.top+o:isBelow(d,h)&&(i?e.scrollTop+=d.top-h.top-o:e.scrollTop+=d.bottom-h.bottom+o)),f||(isLeftOf(d,h)?e.scrollLeft-=h.left-d.left+o:isRightOf(d,h)&&(e.scrollLeft+=d.right-h.right+o)),e=e.parentNode}function isBelow(e,t){return e.bottom>t.bottom}function isAbove(e,t){return e.top<t.top}function isLeftOf(e,t){return e.left<t.left}function isRightOf(e,t){return e.right>t.right}function getWindow$1(e){return isRange(e)?e.startContainer.ownerDocument.defaultView:e.ownerDocument.defaultView}function getParentElement(e){if(isRange(e)){let t=e.commonAncestorContainer;return isText(t)&&(t=t.parentNode),t}else return e.parentNode}function getRectRelativeToWindow(e,t){const i=getWindow$1(e),r=new Rect(e);if(i===t)return r;{let o=i;for(;o!=t;){const a=o.frameElement,c=new Rect(a).excludeScrollbarsAndBorders();r.moveBy(c.left,c.top),o=o.parent}}return r}function normalizeViewportOffset(e){return typeof e=="number"?{top:e,bottom:e,left:e,right:e}:e}const modifiersToGlyphsMac={ctrl:"\u2303",cmd:"\u2318",alt:"\u2325",shift:"\u21E7"},modifiersToGlyphsNonMac={ctrl:"Ctrl+",alt:"Alt+",shift:"Shift+"},keyCodesToGlyphs={37:"\u2190",38:"\u2191",39:"\u2192",40:"\u2193",9:"\u21E5",33:"Page Up",34:"Page Down"},keyCodes=generateKnownKeyCodes(),keyCodeNames=Object.fromEntries(Object.entries(keyCodes).map(([e,t])=>{let i;return t in keyCodesToGlyphs?i=keyCodesToGlyphs[t]:i=e.charAt(0).toUpperCase()+e.slice(1),[t,i]}));function getCode(e){let t;if(typeof e=="string"){if(t=keyCodes[e.toLowerCase()],!t)throw new CKEditorError("keyboard-unknown-key",null,{key:e})}else t=e.keyCode+(e.altKey?keyCodes.alt:0)+(e.ctrlKey?keyCodes.ctrl:0)+(e.shiftKey?keyCodes.shift:0)+(e.metaKey?keyCodes.cmd:0);return t}function parseKeystroke(e){return typeof e=="string"&&(e=splitKeystrokeText(e)),e.map(t=>typeof t=="string"?getEnvKeyCode(t):t).reduce((t,i)=>i+t,0)}function getEnvKeystrokeText(e){let t=parseKeystroke(e);return Object.entries(env.isMac||env.isiOS?modifiersToGlyphsMac:modifiersToGlyphsNonMac).reduce((o,[a,c])=>(t&keyCodes[a]&&(t&=~keyCodes[a],o+=c),o),"")+(t?keyCodeNames[t]:"")}function isArrowKeyCode(e){return e==keyCodes.arrowright||e==keyCodes.arrowleft||e==keyCodes.arrowup||e==keyCodes.arrowdown}function getLocalizedArrowKeyCodeDirection(e,t){const i=t==="ltr";switch(e){case keyCodes.arrowleft:return i?"left":"right";case keyCodes.arrowright:return i?"right":"left";case keyCodes.arrowup:return"up";case keyCodes.arrowdown:return"down"}}function getEnvKeyCode(e){if(e.endsWith("!"))return getCode(e.slice(0,-1));const t=getCode(e);return(env.isMac||env.isiOS)&&t==keyCodes.ctrl?keyCodes.cmd:t}function isForwardArrowKeyCode(e,t){const i=getLocalizedArrowKeyCodeDirection(e,t);return i==="down"||i==="right"}function generateKnownKeyCodes(){const e={pageup:33,pagedown:34,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,shift:2228224,alt:4456448,cmd:8912896};for(let t=65;t<=90;t++){const i=String.fromCharCode(t);e[i.toLowerCase()]=t}for(let t=48;t<=57;t++)e[t-48]=t;for(let t=112;t<=123;t++)e["f"+(t-111)]=t;return Object.assign(e,{"'":222,",":108,"-":109,".":110,"/":111,";":186,"=":187,"[":219,"\\":220,"]":221,"`":223}),e}function splitKeystrokeText(e){return e.split("+").map(t=>t.trim())}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/const RTL_LANGUAGE_CODES=["ar","ara","dv","div","fa","per","fas","he","heb","ku","kur","ug","uig"];function getLanguageDirection(e){return RTL_LANGUAGE_CODES.includes(e)?"rtl":"ltr"}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function toArray$1(e){return Array.isArray(e)?e:[e]}/* istanbul ignore else -- @preserve */global$1.window.CKEDITOR_TRANSLATIONS||(global$1.window.CKEDITOR_TRANSLATIONS={});function _translate(e,t,i=1,r){if(typeof i!="number")throw new CKEditorError("translation-service-quantity-not-a-number",null,{quantity:i});const o=r||global$1.window.CKEDITOR_TRANSLATIONS,a=getNumberOfLanguages(o);a===1&&(e=Object.keys(o)[0]);const c=t.id||t.string;if(a===0||!hasTranslation(e,c,o))return i!==1?t.plural:t.string;const u=o[e].dictionary,h=o[e].getPluralForm||(m=>m===1?0:1),d=u[c];if(typeof d=="string")return d;const f=Number(h(i));return d[f]}function _unifyTranslations(e){return Array.isArray(e)?e.reduce((t,i)=>merge_default(t,i)):e}function hasTranslation(e,t,i){return!!i[e]&&!!i[e].dictionary[t]}function getNumberOfLanguages(e){return Object.keys(e).length}var Locale=class{uiLanguage;uiLanguageDirection;contentLanguage;contentLanguageDirection;t;translations;constructor({uiLanguage:e="en",contentLanguage:t,translations:i}={}){this.uiLanguage=e,this.contentLanguage=t||this.uiLanguage,this.uiLanguageDirection=getLanguageDirection(this.uiLanguage),this.contentLanguageDirection=getLanguageDirection(this.contentLanguage),this.translations=_unifyTranslations(i),this.t=(r,o)=>this._t(r,o)}get language(){return console.warn("locale-deprecated-language-property: The Locale#language property has been deprecated and will be removed in the near future. Please use #uiLanguage and #contentLanguage properties instead."),this.uiLanguage}_t(e,t=[]){t=toArray$1(t),typeof e=="string"&&(e={string:e});const r=!!e.plural?t[0]:1,o=_translate(this.uiLanguage,e,r,this.translations);return interpolateString(o,t)}};function interpolateString(e,t){return e.replace(/%(\d+)/g,(i,r)=>r<t.length?t[r]:i)}var Collection=class extends EmitterMixin(){_items;_itemMap;_idProperty;_bindToCollection;_bindToExternalToInternalMap;_bindToInternalToExternalMap;_skippedIndexesFromExternal;constructor(e={},t={}){super();const i=isIterable(e);if(i||(t=e),this._items=[],this._itemMap=new Map,this._idProperty=t.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[],i)for(const r of e)this._items.push(r),this._itemMap.set(this._getItemIdBeforeAdding(r),r)}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(e,t){return this.addMany([e],t)}addMany(e,t){if(t===void 0)t=this._items.length;else if(t>this._items.length||t<0)throw new CKEditorError("collection-add-item-invalid-index",this);let i=0;for(const r of e){const o=this._getItemIdBeforeAdding(r),a=t+i;this._items.splice(a,0,r),this._itemMap.set(o,r),this.fire("add",r,a),i++}return this.fire("change",{added:e,removed:[],index:t}),this}get(e){let t;if(typeof e=="string")t=this._itemMap.get(e);else if(typeof e=="number")t=this._items[e];else throw new CKEditorError("collection-get-invalid-arg",this);return t||null}has(e){if(typeof e=="string")return this._itemMap.has(e);{const t=this._idProperty,i=e[t];return i&&this._itemMap.has(i)}}getIndex(e){let t;return typeof e=="string"?t=this._itemMap.get(e):t=e,t?this._items.indexOf(t):-1}remove(e){const[t,i]=this._remove(e);return this.fire("change",{added:[],removed:[t],index:i}),t}map(e,t){return this._items.map(e,t)}forEach(e,t){this._items.forEach(e,t)}find(e,t){return this._items.find(e,t)}filter(e,t){return this._items.filter(e,t)}clear(){this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);const e=Array.from(this._items);for(;this.length;)this._remove(0);this.fire("change",{added:[],removed:e,index:0})}bindTo(e){if(this._bindToCollection)throw new CKEditorError("collection-bind-to-rebind",this);return this._bindToCollection=e,{as:t=>{this._setUpBindToBinding(i=>new t(i))},using:t=>{typeof t=="function"?this._setUpBindToBinding(t):this._setUpBindToBinding(i=>i[t])}}}_setUpBindToBinding(e){const t=this._bindToCollection,i=(r,o,a)=>{const c=t._bindToCollection==this,u=t._bindToInternalToExternalMap.get(o);if(c&&u)this._bindToExternalToInternalMap.set(o,u),this._bindToInternalToExternalMap.set(u,o);else{const h=e(o);if(!h){this._skippedIndexesFromExternal.push(a);return}let d=a;for(const f of this._skippedIndexesFromExternal)a>f&&d--;for(const f of t._skippedIndexesFromExternal)d>=f&&d++;this._bindToExternalToInternalMap.set(o,h),this._bindToInternalToExternalMap.set(h,o),this.add(h,d);for(let f=0;f<t._skippedIndexesFromExternal.length;f++)d<=t._skippedIndexesFromExternal[f]&&t._skippedIndexesFromExternal[f]++}};for(const r of t)i(null,r,t.getIndex(r));this.listenTo(t,"add",i),this.listenTo(t,"remove",(r,o,a)=>{const c=this._bindToExternalToInternalMap.get(o);c&&this.remove(c),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce((u,h)=>(a<h&&u.push(h-1),a>h&&u.push(h),u),[])})}_getItemIdBeforeAdding(e){const t=this._idProperty;let i;if(t in e){if(i=e[t],typeof i!="string")throw new CKEditorError("collection-add-invalid-id",this);if(this.get(i))throw new CKEditorError("collection-add-item-already-exists",this)}else e[t]=i=uid();return i}_remove(e){let t,i,r,o=!1;const a=this._idProperty;if(typeof e=="string"?(i=e,r=this._itemMap.get(i),o=!r,r&&(t=this._items.indexOf(r))):typeof e=="number"?(t=e,r=this._items[t],o=!r,r&&(i=r[a])):(r=e,i=r[a],t=this._items.indexOf(r),o=t==-1||!this._itemMap.get(i)),o)throw new CKEditorError("collection-remove-404",this);this._items.splice(t,1),this._itemMap.delete(i);const c=this._bindToInternalToExternalMap.get(r);return this._bindToInternalToExternalMap.delete(r),this._bindToExternalToInternalMap.delete(c),this.fire("remove",r,t),[r,t]}[Symbol.iterator](){return this._items[Symbol.iterator]()}};/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function first(e){const t=e.next();return t.done?null:t.value}var FocusTracker=class extends DomEmitterMixin(ObservableMixin()){_elements=new Set;_externalViews=new Set;_blurTimeout=null;constructor(){super(),this.set("isFocused",!1),this.set("focusedElement",null)}get elements(){return Array.from(this._elements.values())}get externalViews(){return Array.from(this._externalViews.values())}add(e){if(isElement$3(e))this._addElement(e);else if(isViewWithFocusTracker(e))this._addView(e);else{if(!e.element)throw new CKEditorError("focustracker-add-view-missing-element",{focusTracker:this,view:e});this._addElement(e.element)}}remove(e){isElement$3(e)?this._removeElement(e):isViewWithFocusTracker(e)?this._removeView(e):this._removeElement(e.element)}_addElement(e){if(this._elements.has(e))throw new CKEditorError("focustracker-add-element-already-exist",this);this.listenTo(e,"focus",()=>{const t=this.externalViews.find(i=>isExternalViewSubtreeFocused(e,i));t?this._focus(t.element):this._focus(e)},{useCapture:!0}),this.listenTo(e,"blur",()=>{this._blur()},{useCapture:!0}),this._elements.add(e)}_removeElement(e){this._elements.has(e)&&(this.stopListening(e),this._elements.delete(e)),e===this.focusedElement&&this._blur()}_addView(e){e.element&&this._addElement(e.element),this.listenTo(e.focusTracker,"change:focusedElement",()=>{e.focusTracker.focusedElement?e.element&&this._focus(e.element):this._blur()}),this._externalViews.add(e)}_removeView(e){e.element&&this._removeElement(e.element),this.stopListening(e.focusTracker),this._externalViews.delete(e)}destroy(){this.stopListening(),this._elements.clear(),this._externalViews.clear(),this.isFocused=!1,this.focusedElement=null}_focus(e){this._clearBlurTimeout(),this.focusedElement=e,this.isFocused=!0}_blur(){this.elements.find(i=>i.contains(document.activeElement))||this.externalViews.find(i=>i.focusTracker.isFocused&&!i.focusTracker._blurTimeout)||(this._clearBlurTimeout(),this._blurTimeout=setTimeout(()=>{this.focusedElement=null,this.isFocused=!1},0))}_clearBlurTimeout(){clearTimeout(this._blurTimeout),this._blurTimeout=null}};function isViewWithFocusTracker(e){return"focusTracker"in e&&e.focusTracker instanceof FocusTracker}function isElement$3(e){return isElement_default(e)}function isExternalViewSubtreeFocused(e,t){return isFocusedView(e,t)?!0:!!t.focusTracker.externalViews.find(i=>isFocusedView(e,i))}function isFocusedView(e,t){return!!t.element&&t.element.contains(document.activeElement)&&e.contains(t.element)}var KeystrokeHandler=class{_listener;constructor(){this._listener=new(DomEmitterMixin())}listenTo(e){this._listener.listenTo(e,"keydown",(t,i)=>{this._listener.fire("_keydown:"+getCode(i),i)})}set(e,t,i={}){const r=parseKeystroke(e),o=i.priority;this._listener.listenTo(this._listener,"_keydown:"+r,(a,c)=>{i.filter&&!i.filter(c)||(t(c,()=>{c.preventDefault(),c.stopPropagation(),a.stop()}),a.return=!0)},{priority:o})}press(e){return!!this._listener.fire("_keydown:"+getCode(e),e)}stopListening(e){this._listener.stopListening(e)}destroy(){this.stopListening()}};/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function objectToMap(e){const t=new Map;for(const i in e)t.set(i,e[i]);return t}function toMap(e){return isIterable(e)?new Map(e):objectToMap(e)}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function spliceArray(e,t,i){const r=e.length,o=t.length;for(let a=r-1;a>=i;a--)e[a+o]=e[a];for(let a=0;a<o;a++)e[i+a]=t[a]}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function delay(e,t){let i;function r(...o){r.cancel(),i=setTimeout(()=>e(...o),t)}return r.cancel=()=>{clearTimeout(i)},r}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function parseBase64EncodedObject(e){try{if(!e.startsWith("ey"))return null;const t=atob(e.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(t)}catch{return null}}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function makeCrcTable(){const e=[];for(let t=0;t<256;t++){let i=t;for(let r=0;r<8;r++)i&1?i=3988292384^i>>>1:i=i>>>1;e[t]=i}return e}function crc32(e){const t=Array.isArray(e)?e:[e],i=makeCrcTable();let r=-1;const o=t.map(a=>Array.isArray(a)?a.join(""):String(a)).join("");for(let a=0;a<o.length;a++){const c=o.charCodeAt(a);r=r>>>8^i[(r^c)&255]}return r=(r^-1)>>>0,r.toString(16).padStart(8,"0")}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function isCombiningMark(e){return!!e&&e.length==1&&/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(e)}function isHighSurrogateHalf(e){return!!e&&e.length==1&&/[\ud800-\udbff]/.test(e)}function isLowSurrogateHalf(e){return!!e&&e.length==1&&/[\udc00-\udfff]/.test(e)}function isInsideSurrogatePair(e,t){return isHighSurrogateHalf(e.charAt(t-1))&&isLowSurrogateHalf(e.charAt(t))}function isInsideCombinedSymbol(e,t){return isCombiningMark(e.charAt(t))}const EMOJI_PATTERN=buildEmojiRegexp();function isInsideEmojiSequence(e,t){const i=String(e).matchAll(EMOJI_PATTERN);return Array.from(i).some(r=>r.index<t&&t<r.index+r[0].length)}function buildEmojiRegexp(){const e=[/\p{Emoji}[\u{E0020}-\u{E007E}]+\u{E007F}/u,/\p{Emoji}\u{FE0F}?\u{20E3}/u,/\p{Emoji}\u{FE0F}/u,/(?=\p{General_Category=Other_Symbol})\p{Emoji}\p{Emoji_Modifier}*/u],t=/\p{Regional_Indicator}{2}/u.source,i="(?:"+e.map(o=>o.source).join("|")+")",r=`${t}|${i}(?:\u200D${i})*`;return new RegExp(r,"ug")}const documentPlaceholders=new WeakMap;let hasDisplayedPlaceholderDeprecationWarning=!1;function enablePlaceholder({view:e,element:t,text:i,isDirectHost:r=!0,keepOnFocus:o=!1}){const a=e.document;documentPlaceholders.has(a)||(documentPlaceholders.set(a,new Map),a.registerPostFixer(u=>updateDocumentPlaceholders(a,u)),a.on("change:isComposing",()=>{e.change(u=>updateDocumentPlaceholders(a,u))},{priority:"high"})),t.is("editableElement")&&t.on("change:placeholder",(u,h,d)=>{c(d)}),t.placeholder?c(t.placeholder):i&&c(i),i&&showPlaceholderTextDeprecationWarning();function c(u){documentPlaceholders.get(a).set(t,{text:u,isDirectHost:r,keepOnFocus:o,hostElement:r?t:null}),e.change(h=>updateDocumentPlaceholders(a,h))}}function showPlaceholder(e,t){return t.hasClass("ck-placeholder")?!1:(e.addClass("ck-placeholder",t),!0)}function hidePlaceholder(e,t){return t.hasClass("ck-placeholder")?(e.removeClass("ck-placeholder",t),!0):!1}function needsPlaceholder(e,t){if(!e.isAttached()||Array.from(e.getChildren()).some(c=>!c.is("uiElement")))return!1;const r=e.document,a=r.selection.anchor;return r.isComposing&&a&&a.parent===e?!1:t||!r.isFocused?!0:!!a&&a.parent!==e}function updateDocumentPlaceholders(e,t){const i=documentPlaceholders.get(e),r=[];let o=!1;for(const[a,c]of i)c.isDirectHost&&(r.push(a),updatePlaceholder(t,a,c)&&(o=!0));for(const[a,c]of i){if(c.isDirectHost)continue;const u=getChildPlaceholderHostSubstitute(a);u&&(r.includes(u)||(c.hostElement=u,updatePlaceholder(t,a,c)&&(o=!0)))}return o}function updatePlaceholder(e,t,i){const{text:r,isDirectHost:o,hostElement:a}=i;let c=!1;return a.getAttribute("data-placeholder")!==r&&(e.setAttribute("data-placeholder",r,a),c=!0),(o||t.childCount==1)&&needsPlaceholder(a,i.keepOnFocus)?showPlaceholder(e,a)&&(c=!0):hidePlaceholder(e,a)&&(c=!0),c}function getChildPlaceholderHostSubstitute(e){if(e.childCount){const t=e.getChild(0);if(t.is("element")&&!t.is("uiElement")&&!t.is("attributeElement"))return t}return null}function showPlaceholderTextDeprecationWarning(){hasDisplayedPlaceholderDeprecationWarning||logWarning("enableplaceholder-deprecated-text-option"),hasDisplayedPlaceholderDeprecationWarning=!0}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/let TypeCheckable$1=class{is(){throw new Error("is() method is abstract")}},Node$2=class extends EmitterMixin(TypeCheckable$1){document;parent;constructor(t){super(),this.document=t,this.parent=null}get index(){let t;if(!this.parent)return null;if((t=this.parent.getChildIndex(this))==-1)throw new CKEditorError("view-node-not-found-in-parent",this);return t}get nextSibling(){const t=this.index;return t!==null&&this.parent.getChild(t+1)||null}get previousSibling(){const t=this.index;return t!==null&&this.parent.getChild(t-1)||null}get root(){let t=this;for(;t.parent;)t=t.parent;return t}isAttached(){return this.root.is("rootElement")}getPath(){const t=[];let i=this;for(;i.parent;)t.unshift(i.index),i=i.parent;return t}getAncestors(t={}){const i=[];let r=t.includeSelf?this:this.parent;for(;r;)i[t.parentFirst?"push":"unshift"](r),r=r.parent;return i}getCommonAncestor(t,i={}){const r=this.getAncestors(i),o=t.getAncestors(i);let a=0;for(;r[a]==o[a]&&r[a];)a++;return a===0?null:r[a-1]}isBefore(t){if(this==t||this.root!==t.root)return!1;const i=this.getPath(),r=t.getPath(),o=compareArrays(i,r);switch(o){case"prefix":return!0;case"extension":return!1;default:return i[o]<r[o]}}isAfter(t){return this==t||this.root!==t.root?!1:!this.isBefore(t)}_remove(){this.parent._removeChildren(this.index)}_fireChange(t,i){this.fire(`change:${t}`,i),this.parent&&this.parent._fireChange(t,i)}toJSON(){const t=clone_default(this);return delete t.parent,t}};Node$2.prototype.is=function(e){return e==="node"||e==="view:node"};let Text$1=class ur extends Node$2{_textData;constructor(t,i){super(t),this._textData=i}get data(){return this._textData}get _data(){return this.data}set _data(t){this._fireChange("text",this),this._textData=t}isSimilar(t){return t instanceof ur?this===t||this.data===t.data:!1}_clone(){return new ur(this.document,this.data)}};Text$1.prototype.is=function(e){return e==="$text"||e==="view:$text"||e==="text"||e==="view:text"||e==="node"||e==="view:node"};let TextProxy$1=class extends TypeCheckable$1{textNode;data;offsetInText;constructor(t,i,r){if(super(),this.textNode=t,i<0||i>t.data.length)throw new CKEditorError("view-textproxy-wrong-offsetintext",this);if(r<0||i+r>t.data.length)throw new CKEditorError("view-textproxy-wrong-length",this);this.data=t.data.substring(i,i+r),this.offsetInText=i}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}getAncestors(t={}){const i=[];let r=t.includeSelf?this.textNode:this.parent;for(;r!==null;)i[t.parentFirst?"push":"unshift"](r),r=r.parent;return i}};TextProxy$1.prototype.is=function(e){return e==="$textProxy"||e==="view:$textProxy"||e==="textProxy"||e==="view:textProxy"};var Matcher=class{_patterns=[];constructor(...e){this.add(...e)}add(...e){for(let t of e)(typeof t=="string"||t instanceof RegExp)&&(t={name:t}),this._patterns.push(t)}match(...e){for(const t of e)for(const i of this._patterns){const r=isElementMatching(t,i);if(r)return{element:t,pattern:i,match:r}}return null}matchAll(...e){const t=[];for(const i of e)for(const r of this._patterns){const o=isElementMatching(i,r);o&&t.push({element:i,pattern:r,match:o})}return t.length>0?t:null}getElementName(){if(this._patterns.length!==1)return null;const e=this._patterns[0],t=e.name;return typeof e!="function"&&t&&!(t instanceof RegExp)?t:null}};function isElementMatching(e,t){if(typeof t=="function")return t(e);const i={};return t.name&&(i.name=matchName(t.name,e.name),!i.name)||t.attributes&&(i.attributes=matchAttributes(t.attributes,e),!i.attributes)||t.classes&&(i.classes=matchClasses(t.classes,e),!i.classes)||t.styles&&(i.styles=matchStyles(t.styles,e),!i.styles)?null:i}function matchName(e,t){return e instanceof RegExp?!!t.match(e):e===t}function matchPatterns(e,t,i){const r=normalizePatterns(e),o=Array.from(t),a=[];if(r.forEach(([c,u])=>{o.forEach(h=>{isKeyMatched(c,h)&&isValueMatched(u,h,i)&&a.push(h)})}),!(!r.length||a.length<r.length))return a}function normalizePatterns(e){if(Array.isArray(e))return e.map(i=>typeof i!="object"||i instanceof RegExp?[i,!0]:((i.key===void 0||i.value===void 0)&&logWarning("matcher-pattern-missing-key-or-value",i),[i.key,i.value]));if(typeof e!="object"||e instanceof RegExp)return[[e,!0]];const t=[];for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.push([i,e[i]]);return t}function isKeyMatched(e,t){return e===!0||e===t||e instanceof RegExp&&t.match(e)}function isValueMatched(e,t,i){if(e===!0)return!0;const r=i(t);return e===r||e instanceof RegExp&&!!String(r).match(e)}function matchAttributes(e,t){const i=new Set(t.getAttributeKeys());return typeof e=="object"&&!(e instanceof RegExp)&&!Array.isArray(e)?(e.style!==void 0&&logWarning("matcher-pattern-deprecated-attributes-style-key",e),e.class!==void 0&&logWarning("matcher-pattern-deprecated-attributes-class-key",e)):(i.delete("style"),i.delete("class")),matchPatterns(e,i,r=>t.getAttribute(r))}function matchClasses(e,t){return matchPatterns(e,t.getClassNames(),()=>{})}function matchStyles(e,t){return matchPatterns(e,t.getStyleNames(!0),i=>t.getStyle(i))}var StylesMap=class{_styles;_cachedStyleNames=null;_cachedExpandedStyleNames=null;_styleProcessor;constructor(e){this._styles={},this._styleProcessor=e}get isEmpty(){return!Object.entries(this._styles).length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(e){this.clear();const t=parseInlineStyles(e);for(const[i,r]of t)this._styleProcessor.toNormalizedForm(i,r,this._styles)}has(e){if(this.isEmpty)return!1;const i=this._styleProcessor.getReducedForm(e,this._styles).find(([r])=>r===e);return Array.isArray(i)}set(e,t){if(this._cachedStyleNames=null,this._cachedExpandedStyleNames=null,isObject_default(e))for(const[i,r]of Object.entries(e))this._styleProcessor.toNormalizedForm(i,r,this._styles);else this._styleProcessor.toNormalizedForm(e,t,this._styles)}remove(e){this._cachedStyleNames=null,this._cachedExpandedStyleNames=null;const t=toPath(e);unset_default(this._styles,t),delete this._styles[e],this._cleanEmptyObjectsOnPath(t)}getNormalized(e){return this._styleProcessor.getNormalized(e,this._styles)}toString(){return this.isEmpty?"":this.getStylesEntries().map(e=>e.join(":")).sort().join(";")+";"}getAsString(e){if(this.isEmpty)return;if(this._styles[e]&&!isObject_default(this._styles[e]))return this._styles[e];const i=this._styleProcessor.getReducedForm(e,this._styles).find(([r])=>r===e);if(Array.isArray(i))return i[1]}getStyleNames(e=!1){return this.isEmpty?[]:e?(this._cachedExpandedStyleNames=this._cachedExpandedStyleNames||this._styleProcessor.getStyleNames(this._styles),this._cachedExpandedStyleNames):(this._cachedStyleNames=this._cachedStyleNames||this.getStylesEntries().map(([t])=>t),this._cachedStyleNames)}clear(){this._styles={},this._cachedStyleNames=null,this._cachedExpandedStyleNames=null}getStylesEntries(){const e=[],t=Object.keys(this._styles);for(const i of t)e.push(...this._styleProcessor.getReducedForm(i,this._styles));return e}_cleanEmptyObjectsOnPath(e){const t=e.split(".");if(!(t.length>1))return;const r=t.splice(0,t.length-1).join("."),o=get_default(this._styles,r);if(!o)return;!Object.keys(o).length&&this.remove(r)}},StylesProcessor=class{_normalizers;_extractors;_reducers;_consumables;constructor(){this._normalizers=new Map,this._extractors=new Map,this._reducers=new Map,this._consumables=new Map}toNormalizedForm(e,t,i){if(isObject_default(t)){appendStyleValue(i,toPath(e),t);return}if(this._normalizers.has(e)){const r=this._normalizers.get(e),{path:o,value:a}=r(t);appendStyleValue(i,o,a)}else appendStyleValue(i,e,t)}getNormalized(e,t){if(!e)return merge_default({},t);if(t[e]!==void 0)return t[e];if(this._extractors.has(e)){const i=this._extractors.get(e);if(typeof i=="string")return get_default(t,i);const r=i(e,t);if(r)return r}return get_default(t,toPath(e))}getReducedForm(e,t){const i=this.getNormalized(e,t);return i===void 0?[]:this._reducers.has(e)?this._reducers.get(e)(i):[[e,i]]}getStyleNames(e){const t=new Set;for(const i of this._consumables.keys()){const r=this.getNormalized(i,e);r&&(typeof r!="object"||Object.keys(r).length)&&t.add(i)}for(const i of Object.keys(e))t.add(i);return Array.from(t)}getRelatedStyles(e){return this._consumables.get(e)||[]}setNormalizer(e,t){this._normalizers.set(e,t)}setExtractor(e,t){this._extractors.set(e,t)}setReducer(e,t){this._reducers.set(e,t)}setStyleRelation(e,t){this._mapStyleNames(e,t);for(const i of t)this._mapStyleNames(i,[e])}_mapStyleNames(e,t){this._consumables.has(e)||this._consumables.set(e,[]),this._consumables.get(e).push(...t)}};function parseInlineStyles(e){let t=null,i=0,r=0,o=null;const a=new Map;if(e==="")return a;e.charAt(e.length-1)!=";"&&(e=e+";");for(let c=0;c<e.length;c++){const u=e.charAt(c);if(t===null)switch(u){case":":o||(o=e.substr(i,c-i),r=c+1);break;case'"':case"'":t=u;break;case";":{const h=e.substr(r,c-r);o&&a.set(o.trim(),h.trim()),o=null,i=c+1;break}}else u===t&&(t=null)}return a}function toPath(e){return e.replace("-",".")}function appendStyleValue(e,t,i){let r=i;isObject_default(i)&&(r=merge_default({},get_default(e,t),i)),set_default(e,t,r)}let Element$1=class ps extends Node$2{name;_unsafeAttributesToRender=[];_attrs;_children;_classes;_styles;_customProperties=new Map;constructor(t,i,r,o){if(super(t),this.name=i,this._attrs=parseAttributes(r),this._children=[],o&&this._insertChild(0,o),this._classes=new Set,this._attrs.has("class")){const a=this._attrs.get("class");parseClasses(this._classes,a),this._attrs.delete("class")}this._styles=new StylesMap(this.document.stylesProcessor),this._attrs.has("style")&&(this._styles.setTo(this._attrs.get("style")),this._attrs.delete("style"))}get childCount(){return this._children.length}get isEmpty(){return this._children.length===0}getChild(t){return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes.size>0&&(yield"class"),this._styles.isEmpty||(yield"style"),yield*this._attrs.keys()}*getAttributes(){yield*this._attrs.entries(),this._classes.size>0&&(yield["class",this.getAttribute("class")]),this._styles.isEmpty||(yield["style",this.getAttribute("style")])}getAttribute(t){if(t=="class")return this._classes.size>0?[...this._classes].join(" "):void 0;if(t=="style"){const i=this._styles.toString();return i==""?void 0:i}return this._attrs.get(t)}hasAttribute(t){return t=="class"?this._classes.size>0:t=="style"?!this._styles.isEmpty:this._attrs.has(t)}isSimilar(t){if(!(t instanceof ps))return!1;if(this===t)return!0;if(this.name!=t.name||this._attrs.size!==t._attrs.size||this._classes.size!==t._classes.size||this._styles.size!==t._styles.size)return!1;for(const[i,r]of this._attrs)if(!t._attrs.has(i)||t._attrs.get(i)!==r)return!1;for(const i of this._classes)if(!t._classes.has(i))return!1;for(const i of this._styles.getStyleNames())if(!t._styles.has(i)||t._styles.getAsString(i)!==this._styles.getAsString(i))return!1;return!0}hasClass(...t){for(const i of t)if(!this._classes.has(i))return!1;return!0}getClassNames(){return this._classes.keys()}getStyle(t){return this._styles.getAsString(t)}getNormalizedStyle(t){return this._styles.getNormalized(t)}getStyleNames(t){return this._styles.getStyleNames(t)}hasStyle(...t){for(const i of t)if(!this._styles.has(i))return!1;return!0}findAncestor(...t){const i=new Matcher(...t);let r=this.parent;for(;r&&!r.is("documentFragment");){if(i.match(r))return r;r=r.parent}return null}getCustomProperty(t){return this._customProperties.get(t)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const t=Array.from(this._classes).sort().join(","),i=this._styles.toString(),r=Array.from(this._attrs).map(o=>`${o[0]}="${o[1]}"`).sort().join(" ");return this.name+(t==""?"":` class="${t}"`)+(i?` style="${i}"`:"")+(r==""?"":` ${r}`)}shouldRenderUnsafeAttribute(t){return this._unsafeAttributesToRender.includes(t)}_clone(t=!1){const i=[];if(t)for(const o of this.getChildren())i.push(o._clone(t));const r=new this.constructor(this.document,this.name,this._attrs,i);return r._classes=new Set(this._classes),r._styles.set(this._styles.getNormalized()),r._customProperties=new Map(this._customProperties),r.getFillerOffset=this.getFillerOffset,r._unsafeAttributesToRender=this._unsafeAttributesToRender,r}_appendChild(t){return this._insertChild(this.childCount,t)}_insertChild(t,i){this._fireChange("children",this);let r=0;const o=normalize$3(this.document,i);for(const a of o)a.parent!==null&&a._remove(),a.parent=this,a.document=this.document,this._children.splice(t,0,a),t++,r++;return r}_removeChildren(t,i=1){this._fireChange("children",this);for(let r=t;r<t+i;r++)this._children[r].parent=null;return this._children.splice(t,i)}_setAttribute(t,i){const r=String(i);this._fireChange("attributes",this),t=="class"?parseClasses(this._classes,r):t=="style"?this._styles.setTo(r):this._attrs.set(t,r)}_removeAttribute(t){return this._fireChange("attributes",this),t=="class"?this._classes.size>0?(this._classes.clear(),!0):!1:t=="style"?this._styles.isEmpty?!1:(this._styles.clear(),!0):this._attrs.delete(t)}_addClass(t){this._fireChange("attributes",this);for(const i of toArray$1(t))this._classes.add(i)}_removeClass(t){this._fireChange("attributes",this);for(const i of toArray$1(t))this._classes.delete(i)}_setStyle(t,i){this._fireChange("attributes",this),typeof t!="string"?this._styles.set(t):this._styles.set(t,i)}_removeStyle(t){this._fireChange("attributes",this);for(const i of toArray$1(t))this._styles.remove(i)}_setCustomProperty(t,i){this._customProperties.set(t,i)}_removeCustomProperty(t){return this._customProperties.delete(t)}};Element$1.prototype.is=function(e,t){return t?t===this.name&&(e==="element"||e==="view:element"):e==="element"||e==="view:element"||e==="node"||e==="view:node"};function parseAttributes(e){const t=toMap(e);for(const[i,r]of t)r===null?t.delete(i):typeof r!="string"&&t.set(i,String(r));return t}function parseClasses(e,t){const i=t.split(/\s+/);e.clear(),i.forEach(r=>e.add(r))}function normalize$3(e,t){if(typeof t=="string")return[new Text$1(e,t)];isIterable(t)||(t=[t]);const i=[];for(const r of t)typeof r=="string"?i.push(new Text$1(e,r)):r instanceof TextProxy$1?i.push(new Text$1(e,r.data)):i.push(r);return i}var ContainerElement=class extends Element$1{constructor(e,t,i,r){super(e,t,i,r),this.getFillerOffset=getFillerOffset$4}};ContainerElement.prototype.is=function(e,t){return t?t===this.name&&(e==="containerElement"||e==="view:containerElement"||e==="element"||e==="view:element"):e==="containerElement"||e==="view:containerElement"||e==="element"||e==="view:element"||e==="node"||e==="view:node"};function getFillerOffset$4(){const e=[...this.getChildren()],t=e[this.childCount-1];if(t&&t.is("element","br"))return this.childCount;for(const i of e)if(!i.is("uiElement"))return null;return this.childCount}var EditableElement=class extends ObservableMixin(ContainerElement){constructor(e,t,i,r){super(e,t,i,r),this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("placeholder",void 0),this.bind("isReadOnly").to(e),this.bind("isFocused").to(e,"isFocused",o=>o&&e.selection.editableElement==this),this.listenTo(e.selection,"change",()=>{this.isFocused=e.isFocused&&e.selection.editableElement==this})}destroy(){this.stopListening()}};EditableElement.prototype.is=function(e,t){return t?t===this.name&&(e==="editableElement"||e==="view:editableElement"||e==="containerElement"||e==="view:containerElement"||e==="element"||e==="view:element"):e==="editableElement"||e==="view:editableElement"||e==="containerElement"||e==="view:containerElement"||e==="element"||e==="view:element"||e==="node"||e==="view:node"};const rootNameSymbol=Symbol("rootName");var RootEditableElement=class extends EditableElement{constructor(e,t){super(e,t),this.rootName="main"}get rootName(){return this.getCustomProperty(rootNameSymbol)}set rootName(e){this._setCustomProperty(rootNameSymbol,e)}set _name(e){this.name=e}};RootEditableElement.prototype.is=function(e,t){return t?t===this.name&&(e==="rootElement"||e==="view:rootElement"||e==="editableElement"||e==="view:editableElement"||e==="containerElement"||e==="view:containerElement"||e==="element"||e==="view:element"):e==="rootElement"||e==="view:rootElement"||e==="editableElement"||e==="view:editableElement"||e==="containerElement"||e==="view:containerElement"||e==="element"||e==="view:element"||e==="node"||e==="view:node"};let TreeWalker$1=class{direction;boundaries;singleCharacters;shallow;ignoreElementEnd;_position;_boundaryStartParent;_boundaryEndParent;constructor(t={}){if(!t.boundaries&&!t.startPosition)throw new CKEditorError("view-tree-walker-no-start-position",null);if(t.direction&&t.direction!="forward"&&t.direction!="backward")throw new CKEditorError("view-tree-walker-unknown-direction",t.startPosition,{direction:t.direction});this.boundaries=t.boundaries||null,t.startPosition?this._position=Position$1._createAt(t.startPosition):this._position=Position$1._createAt(t.boundaries[t.direction=="backward"?"end":"start"]),this.direction=t.direction||"forward",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}get position(){return this._position}skip(t){let i,r;do r=this.position,i=this.next();while(!i.done&&t(i.value));i.done||(this._position=r)}next(){return this.direction=="forward"?this._next():this._previous()}_next(){let t=this.position.clone();const i=this.position,r=t.parent;if(r.parent===null&&t.offset===r.childCount)return{done:!0,value:void 0};if(r===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0,value:void 0};let o;if(r&&r.is("view:$text")){if(t.isAtEnd)return this._position=Position$1._createAfter(r),this._next();o=r.data[t.offset]}else o=r.getChild(t.offset);if(typeof o=="string"){let a;this.singleCharacters?a=1:a=(r===this._boundaryEndParent?this.boundaries.end.offset:r.data.length)-t.offset;const c=new TextProxy$1(r,t.offset,a);return t.offset+=a,this._position=t,this._formatReturnValue("text",c,i,t,a)}if(o&&o.is("view:element")){if(!this.shallow)t=new Position$1(o,0);else{if(this.boundaries&&this.boundaries.end.isBefore(t))return{done:!0,value:void 0};t.offset++}return this._position=t,this._formatReturnValue("elementStart",o,i,t,1)}if(o&&o.is("view:$text")){if(this.singleCharacters)return t=new Position$1(o,0),this._position=t,this._next();let a=o.data.length,c;return o==this._boundaryEndParent?(a=this.boundaries.end.offset,c=new TextProxy$1(o,0,a),t=Position$1._createAfter(c)):(c=new TextProxy$1(o,0,o.data.length),t.offset++),this._position=t,this._formatReturnValue("text",c,i,t,a)}return t=Position$1._createAfter(r),this._position=t,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",r,i,t)}_previous(){let t=this.position.clone();const i=this.position,r=t.parent;if(r.parent===null&&t.offset===0)return{done:!0,value:void 0};if(r==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0,value:void 0};let o;if(r.is("view:$text")){if(t.isAtStart)return this._position=Position$1._createBefore(r),this._previous();o=r.data[t.offset-1]}else o=r.getChild(t.offset-1);if(typeof o=="string"){let a;if(this.singleCharacters)a=1;else{const u=r===this._boundaryStartParent?this.boundaries.start.offset:0;a=t.offset-u}t.offset-=a;const c=new TextProxy$1(r,t.offset,a);return this._position=t,this._formatReturnValue("text",c,i,t,a)}if(o&&o.is("view:element"))return this.shallow?(t.offset--,this._position=t,this._formatReturnValue("elementStart",o,i,t,1)):(t=new Position$1(o,o.childCount),this._position=t,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",o,i,t));if(o&&o.is("view:$text")){if(this.singleCharacters)return t=new Position$1(o,o.data.length),this._position=t,this._previous();let a=o.data.length,c;if(o==this._boundaryStartParent){const u=this.boundaries.start.offset;c=new TextProxy$1(o,u,o.data.length-u),a=c.data.length,t=Position$1._createBefore(c)}else c=new TextProxy$1(o,0,o.data.length),t.offset--;return this._position=t,this._formatReturnValue("text",c,i,t,a)}return t=Position$1._createBefore(r),this._position=t,this._formatReturnValue("elementStart",r,i,t,1)}_formatReturnValue(t,i,r,o,a){return i.is("view:$textProxy")&&(i.offsetInText+i.data.length==i.textNode.data.length&&(this.direction=="forward"&&!(this.boundaries&&this.boundaries.end.isEqual(this.position))?(o=Position$1._createAfter(i.textNode),this._position=o):r=Position$1._createAfter(i.textNode)),i.offsetInText===0&&(this.direction=="backward"&&!(this.boundaries&&this.boundaries.start.isEqual(this.position))?(o=Position$1._createBefore(i.textNode),this._position=o):r=Position$1._createBefore(i.textNode))),{done:!1,value:{type:t,item:i,previousPosition:r,nextPosition:o,length:a}}}},Position$1=class Qt extends TypeCheckable$1{parent;offset;constructor(t,i){super(),this.parent=t,this.offset=i}get nodeAfter(){return this.parent.is("$text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("$text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return this.offset===0}get isAtEnd(){const t=this.parent.is("$text")?this.parent.data.length:this.parent.childCount;return this.offset===t}get root(){return this.parent.root}get editableElement(){let t=this.parent;for(;!(t instanceof EditableElement);)if(t.parent)t=t.parent;else return null;return t}getShiftedBy(t){const i=Qt._createAt(this),r=i.offset+t;return i.offset=r<0?0:r,i}getLastMatchingPosition(t,i={}){i.startPosition=this;const r=new TreeWalker$1(i);return r.skip(t),r.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(t){const i=this.getAncestors(),r=t.getAncestors();let o=0;for(;i[o]==r[o]&&i[o];)o++;return o===0?null:i[o-1]}isEqual(t){return this.parent==t.parent&&this.offset==t.offset}isBefore(t){return this.compareWith(t)=="before"}isAfter(t){return this.compareWith(t)=="after"}compareWith(t){if(this.root!==t.root)return"different";if(this.isEqual(t))return"same";const i=this.parent.is("node")?this.parent.getPath():[],r=t.parent.is("node")?t.parent.getPath():[];i.push(this.offset),r.push(t.offset);const o=compareArrays(i,r);switch(o){case"prefix":return"before";case"extension":return"after";default:return i[o]<r[o]?"before":"after"}}getWalker(t={}){return t.startPosition=this,new TreeWalker$1(t)}clone(){return new Qt(this.parent,this.offset)}static _createAt(t,i){if(t instanceof Qt)return new this(t.parent,t.offset);{const r=t;if(i=="end")i=r.is("$text")?r.data.length:r.childCount;else{if(i=="before")return this._createBefore(r);if(i=="after")return this._createAfter(r);if(i!==0&&!i)throw new CKEditorError("view-createpositionat-offset-required",r)}return new Qt(r,i)}}static _createAfter(t){if(t.is("$textProxy"))return new Qt(t.textNode,t.offsetInText+t.data.length);if(!t.parent)throw new CKEditorError("view-position-after-root",t,{root:t});return new Qt(t.parent,t.index+1)}static _createBefore(t){if(t.is("$textProxy"))return new Qt(t.textNode,t.offsetInText);if(!t.parent)throw new CKEditorError("view-position-before-root",t,{root:t});return new Qt(t.parent,t.index)}};Position$1.prototype.is=function(e){return e==="position"||e==="view:position"};let Range$1=class un extends TypeCheckable$1{start;end;constructor(t,i=null){super(),this.start=t.clone(),this.end=i?i.clone():t.clone()}*[Symbol.iterator](){yield*new TreeWalker$1({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let t=this.start.getLastMatchingPosition(enlargeTrimSkip,{direction:"backward"}),i=this.end.getLastMatchingPosition(enlargeTrimSkip);return t.parent.is("$text")&&t.isAtStart&&(t=Position$1._createBefore(t.parent)),i.parent.is("$text")&&i.isAtEnd&&(i=Position$1._createAfter(i.parent)),new un(t,i)}getTrimmed(){let t=this.start.getLastMatchingPosition(enlargeTrimSkip);if(t.isAfter(this.end)||t.isEqual(this.end))return new un(t,t);let i=this.end.getLastMatchingPosition(enlargeTrimSkip,{direction:"backward"});const r=t.nodeAfter,o=i.nodeBefore;return r&&r.is("$text")&&(t=new Position$1(r,0)),o&&o.is("$text")&&(i=new Position$1(o,o.data.length)),new un(t,i)}isEqual(t){return this==t||this.start.isEqual(t.start)&&this.end.isEqual(t.end)}containsPosition(t){return t.isAfter(this.start)&&t.isBefore(this.end)}containsRange(t,i=!1){t.isCollapsed&&(i=!1);const r=this.containsPosition(t.start)||i&&this.start.isEqual(t.start),o=this.containsPosition(t.end)||i&&this.end.isEqual(t.end);return r&&o}getDifference(t){const i=[];return this.isIntersecting(t)?(this.containsPosition(t.start)&&i.push(new un(this.start,t.start)),this.containsPosition(t.end)&&i.push(new un(t.end,this.end))):i.push(this.clone()),i}getIntersection(t){if(this.isIntersecting(t)){let i=this.start,r=this.end;return this.containsPosition(t.start)&&(i=t.start),this.containsPosition(t.end)&&(r=t.end),new un(i,r)}return null}getWalker(t={}){return t.boundaries=this,new TreeWalker$1(t)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let t=this.start.nodeAfter,i=this.end.nodeBefore;return this.start.parent.is("$text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(t=this.start.parent.nextSibling),this.end.parent.is("$text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(i=this.end.parent.previousSibling),t&&t.is("element")&&t===i?t:null}clone(){return new un(this.start,this.end)}*getItems(t={}){t.boundaries=this,t.ignoreElementEnd=!0;const i=new TreeWalker$1(t);for(const r of i)yield r.item}*getPositions(t={}){t.boundaries=this;const i=new TreeWalker$1(t);yield i.position;for(const r of i)yield r.nextPosition}isIntersecting(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}static _createFromParentsAndOffsets(t,i,r,o){return new this(new Position$1(t,i),new Position$1(r,o))}static _createFromPositionAndShift(t,i){const r=t,o=t.getShiftedBy(i);return i>0?new this(r,o):new this(o,r)}static _createIn(t){return this._createFromParentsAndOffsets(t,0,t,t.childCount)}static _createOn(t){const i=t.is("$textProxy")?t.offsetSize:1;return this._createFromPositionAndShift(Position$1._createBefore(t),i)}};Range$1.prototype.is=function(e){return e==="range"||e==="view:range"};function enlargeTrimSkip(e){return!!(e.item.is("attributeElement")||e.item.is("uiElement"))}let Selection$1=class vs extends EmitterMixin(TypeCheckable$1){_ranges;_lastRangeBackward;_isFake;_fakeSelectionLabel;constructor(...t){super(),this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",t.length&&this.setTo(...t)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const t=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?t.end:t.start).clone()}get focus(){if(!this._ranges.length)return null;const t=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?t.start:t.end).clone()}get isCollapsed(){return this.rangeCount===1&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const t of this._ranges)yield t.clone()}getFirstRange(){let t=null;for(const i of this._ranges)(!t||i.start.isBefore(t.start))&&(t=i);return t?t.clone():null}getLastRange(){let t=null;for(const i of this._ranges)(!t||i.end.isAfter(t.end))&&(t=i);return t?t.clone():null}getFirstPosition(){const t=this.getFirstRange();return t?t.start.clone():null}getLastPosition(){const t=this.getLastRange();return t?t.end.clone():null}isEqual(t){if(this.isFake!=t.isFake||this.isFake&&this.fakeSelectionLabel!=t.fakeSelectionLabel||this.rangeCount!=t.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(t.anchor)||!this.focus.isEqual(t.focus))return!1;for(const i of this._ranges){let r=!1;for(const o of t._ranges)if(i.isEqual(o)){r=!0;break}if(!r)return!1}return!0}isSimilar(t){if(this.isBackward!=t.isBackward)return!1;const i=count(this.getRanges()),r=count(t.getRanges());if(i!=r)return!1;if(i==0)return!0;for(let o of this.getRanges()){o=o.getTrimmed();let a=!1;for(let c of t.getRanges())if(c=c.getTrimmed(),o.start.isEqual(c.start)&&o.end.isEqual(c.end)){a=!0;break}if(!a)return!1}return!0}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}setTo(...t){let[i,r,o]=t;if(typeof r=="object"&&(o=r,r=void 0),i===null)this._setRanges([]),this._setFakeOptions(o);else if(i instanceof vs||i instanceof DocumentSelection$1)this._setRanges(i.getRanges(),i.isBackward),this._setFakeOptions({fake:i.isFake,label:i.fakeSelectionLabel});else if(i instanceof Range$1)this._setRanges([i],o&&o.backward),this._setFakeOptions(o);else if(i instanceof Position$1)this._setRanges([new Range$1(i)]),this._setFakeOptions(o);else if(i instanceof Node$2){const a=!!o&&!!o.backward;let c;if(r===void 0)throw new CKEditorError("view-selection-setto-required-second-parameter",this);r=="in"?c=Range$1._createIn(i):r=="on"?c=Range$1._createOn(i):c=new Range$1(Position$1._createAt(i,r)),this._setRanges([c],a),this._setFakeOptions(o)}else if(isIterable(i))this._setRanges(i,o&&o.backward),this._setFakeOptions(o);else throw new CKEditorError("view-selection-setto-not-selectable",this);this.fire("change")}setFocus(t,i){if(this.anchor===null)throw new CKEditorError("view-selection-setfocus-no-ranges",this);const r=Position$1._createAt(t,i);if(r.compareWith(this.focus)=="same")return;const o=this.anchor;this._ranges.pop(),r.compareWith(o)=="before"?this._addRange(new Range$1(r,o),!0):this._addRange(new Range$1(o,r)),this.fire("change")}_setRanges(t,i=!1){t=Array.from(t),this._ranges=[];for(const r of t)this._addRange(r);this._lastRangeBackward=!!i}_setFakeOptions(t={}){this._isFake=!!t.fake,this._fakeSelectionLabel=t.fake&&t.label||""}_addRange(t,i=!1){if(!(t instanceof Range$1))throw new CKEditorError("view-selection-add-range-not-range",this);this._pushRange(t),this._lastRangeBackward=!!i}_pushRange(t){for(const i of this._ranges)if(t.isIntersecting(i))throw new CKEditorError("view-selection-range-intersects",this,{addedRange:t,intersectingRange:i});this._ranges.push(new Range$1(t.start,t.end))}};Selection$1.prototype.is=function(e){return e==="selection"||e==="view:selection"};let DocumentSelection$1=class extends EmitterMixin(TypeCheckable$1){_selection;constructor(...t){super(),this._selection=new Selection$1,this._selection.delegate("change").to(this),t.length&&this._selection.setTo(...t)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(t){return this._selection.isEqual(t)}isSimilar(t){return this._selection.isSimilar(t)}_setTo(...t){this._selection.setTo(...t)}_setFocus(t,i){this._selection.setFocus(t,i)}};DocumentSelection$1.prototype.is=function(e){return e==="selection"||e=="documentSelection"||e=="view:selection"||e=="view:documentSelection"};var BubblingEventInfo=class extends EventInfo{startRange;_eventPhase;_currentTarget;constructor(e,t,i){super(e,t),this.startRange=i,this._eventPhase="none",this._currentTarget=null}get eventPhase(){return this._eventPhase}get currentTarget(){return this._currentTarget}};const contextsSymbol=Symbol("bubbling contexts");function BubblingEmitterMixin(e){class t extends e{fire(r,...o){try{const a=r instanceof EventInfo?r:new EventInfo(this,r),c=getBubblingContexts(this);if(!c.size)return;if(updateEventInfo(a,"capturing",this),fireListenerFor(c,"$capture",a,...o))return a.return;const u=a.startRange||this.selection.getFirstRange(),h=u?u.getContainedElement():null,d=h?!!getCustomContext(c,h):!1;let f=h||getDeeperRangeParent(u);if(updateEventInfo(a,"atTarget",f),!d){if(fireListenerFor(c,"$text",a,...o))return a.return;updateEventInfo(a,"bubbling",f)}for(;f;){if(f.is("rootElement")){if(fireListenerFor(c,"$root",a,...o))return a.return}else if(f.is("element")&&fireListenerFor(c,f.name,a,...o))return a.return;if(fireListenerFor(c,f,a,...o))return a.return;f=f.parent,updateEventInfo(a,"bubbling",f)}return updateEventInfo(a,"bubbling",this),fireListenerFor(c,"$document",a,...o),a.return}catch(a){/* istanbul ignore next -- @preserve */CKEditorError.rethrowUnexpectedError(a,this)}}_addEventListener(r,o,a){const c=toArray$1(a.context||"$document"),u=getBubblingContexts(this);for(const h of c){let d=u.get(h);d||(d=new(EmitterMixin()),u.set(h,d)),this.listenTo(d,r,o,a)}}_removeEventListener(r,o){const a=getBubblingContexts(this);for(const c of a.values())this.stopListening(c,r,o)}}return t}{const e=BubblingEmitterMixin(Object);["fire","_addEventListener","_removeEventListener"].forEach(t=>{BubblingEmitterMixin[t]=e.prototype[t]})}function updateEventInfo(e,t,i){e instanceof BubblingEventInfo&&(e._eventPhase=t,e._currentTarget=i)}function fireListenerFor(e,t,i,...r){const o=typeof t=="string"?e.get(t):getCustomContext(e,t);return o?(o.fire(i,...r),i.stop.called):!1}function getCustomContext(e,t){for(const[i,r]of e)if(typeof i=="function"&&i(t))return r;return null}function getBubblingContexts(e){return e[contextsSymbol]||(e[contextsSymbol]=new Map),e[contextsSymbol]}function getDeeperRangeParent(e){if(!e)return null;const t=e.start.parent,i=e.end.parent,r=t.getPath(),o=i.getPath();return r.length>o.length?t:i}let Document$1=class extends BubblingEmitterMixin(ObservableMixin()){selection;roots;stylesProcessor;_postFixers=new Set;constructor(t){super(),this.selection=new DocumentSelection$1,this.roots=new Collection({idProperty:"rootName"}),this.stylesProcessor=t,this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isSelecting",!1),this.set("isComposing",!1)}getRoot(t="main"){return this.roots.get(t)}registerPostFixer(t){this._postFixers.add(t)}destroy(){this.roots.forEach(t=>t.destroy()),this.stopListening()}_callPostFixers(t){let i=!1;do for(const r of this._postFixers)if(i=r(t),i)break;while(i)}};const DEFAULT_PRIORITY=10;var AttributeElement=class extends Element$1{static DEFAULT_PRIORITY=DEFAULT_PRIORITY;_priority=DEFAULT_PRIORITY;_id=null;_clonesGroup=null;constructor(e,t,i,r){super(e,t,i,r),this.getFillerOffset=getFillerOffset$3}get priority(){return this._priority}get id(){return this._id}getElementsWithSameId(){if(this.id===null)throw new CKEditorError("attribute-element-get-elements-with-same-id-no-id",this);return new Set(this._clonesGroup)}isSimilar(e){return this.id!==null||e.id!==null?this.id===e.id:super.isSimilar(e)&&this.priority==e.priority}_clone(e=!1){const t=super._clone(e);return t._priority=this._priority,t._id=this._id,t}};AttributeElement.prototype.is=function(e,t){return t?t===this.name&&(e==="attributeElement"||e==="view:attributeElement"||e==="element"||e==="view:element"):e==="attributeElement"||e==="view:attributeElement"||e==="element"||e==="view:element"||e==="node"||e==="view:node"};function getFillerOffset$3(){if(nonUiChildrenCount(this))return null;let e=this.parent;for(;e&&e.is("attributeElement");){if(nonUiChildrenCount(e)>1)return null;e=e.parent}return!e||nonUiChildrenCount(e)>1?null:this.childCount}function nonUiChildrenCount(e){return Array.from(e.getChildren()).filter(t=>!t.is("uiElement")).length}var EmptyElement=class extends Element$1{constructor(e,t,i,r){super(e,t,i,r),this.getFillerOffset=getFillerOffset$2}_insertChild(e,t){if(t&&(t instanceof Node$2||Array.from(t).length>0))throw new CKEditorError("view-emptyelement-cannot-add",[this,t]);return 0}};EmptyElement.prototype.is=function(e,t){return t?t===this.name&&(e==="emptyElement"||e==="view:emptyElement"||e==="element"||e==="view:element"):e==="emptyElement"||e==="view:emptyElement"||e==="element"||e==="view:element"||e==="node"||e==="view:node"};function getFillerOffset$2(){return null}var UIElement=class extends Element$1{constructor(e,t,i,r){super(e,t,i,r),this.getFillerOffset=getFillerOffset$1}_insertChild(e,t){if(t&&(t instanceof Node$2||Array.from(t).length>0))throw new CKEditorError("view-uielement-cannot-add",[this,t]);return 0}render(e,t){return this.toDomElement(e)}toDomElement(e){const t=e.createElement(this.name);for(const i of this.getAttributeKeys())t.setAttribute(i,this.getAttribute(i));return t}};UIElement.prototype.is=function(e,t){return t?t===this.name&&(e==="uiElement"||e==="view:uiElement"||e==="element"||e==="view:element"):e==="uiElement"||e==="view:uiElement"||e==="element"||e==="view:element"||e==="node"||e==="view:node"};function injectUiElementHandling(e){e.document.on("arrowKey",(t,i)=>jumpOverUiElement(t,i,e.domConverter),{priority:"low"})}function getFillerOffset$1(){return null}function jumpOverUiElement(e,t,i){if(t.keyCode==keyCodes.arrowright){const r=t.domTarget.ownerDocument.defaultView.getSelection(),o=r.rangeCount==1&&r.getRangeAt(0).collapsed;if(o||t.shiftKey){const a=r.focusNode,c=r.focusOffset,u=i.domPositionToView(a,c);if(u===null)return;let h=!1;const d=u.getLastMatchingPosition(f=>(f.item.is("uiElement")&&(h=!0),!!(f.item.is("uiElement")||f.item.is("attributeElement"))));if(h){const f=i.viewPositionToDom(d);o?r.collapse(f.parent,f.offset):r.extend(f.parent,f.offset)}}}}var RawElement=class extends Element$1{constructor(e,t,i,r){super(e,t,i,r),this.getFillerOffset=getFillerOffset}_insertChild(e,t){if(t&&(t instanceof Node$2||Array.from(t).length>0))throw new CKEditorError("view-rawelement-cannot-add",[this,t]);return 0}render(e,t){}};RawElement.prototype.is=function(e,t){return t?t===this.name&&(e==="rawElement"||e==="view:rawElement"||e==="element"||e==="view:element"):e==="rawElement"||e==="view:rawElement"||e===this.name||e==="view:"+this.name||e==="element"||e==="view:element"||e==="node"||e==="view:node"};function getFillerOffset(){return null}let DocumentFragment$1=class extends EmitterMixin(TypeCheckable$1){document;_children=[];_customProperties=new Map;constructor(t,i){super(),this.document=t,i&&this._insertChild(0,i)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return this.childCount===0}get root(){return this}get parent(){return null}get name(){}get getFillerOffset(){}getCustomProperty(t){return this._customProperties.get(t)}*getCustomProperties(){yield*this._customProperties.entries()}_appendChild(t){return this._insertChild(this.childCount,t)}getChild(t){return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(t,i){this._fireChange("children",this);let r=0;const o=normalize$2(this.document,i);for(const a of o)a.parent!==null&&a._remove(),a.parent=this,this._children.splice(t,0,a),t++,r++;return r}_removeChildren(t,i=1){this._fireChange("children",this);for(let r=t;r<t+i;r++)this._children[r].parent=null;return this._children.splice(t,i)}_fireChange(t,i){this.fire("change:"+t,i)}_setCustomProperty(t,i){this._customProperties.set(t,i)}_removeCustomProperty(t){return this._customProperties.delete(t)}};DocumentFragment$1.prototype.is=function(e){return e==="documentFragment"||e==="view:documentFragment"};function normalize$2(e,t){return typeof t=="string"?[new Text$1(e,t)]:(isIterable(t)||(t=[t]),Array.from(t).map(i=>typeof i=="string"?new Text$1(e,i):i instanceof TextProxy$1?new Text$1(e,i.data):i))}var DowncastWriter=class{document;_cloneGroups=new Map;_slotFactory=null;constructor(e){this.document=e}setSelection(...e){this.document.selection._setTo(...e)}setSelectionFocus(e,t){this.document.selection._setFocus(e,t)}createDocumentFragment(e){return new DocumentFragment$1(this.document,e)}createText(e){return new Text$1(this.document,e)}createAttributeElement(e,t,i={}){const r=new AttributeElement(this.document,e,t);return typeof i.priority=="number"&&(r._priority=i.priority),i.id&&(r._id=i.id),i.renderUnsafeAttributes&&r._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),r}createContainerElement(e,t,i={},r={}){let o=null;isPlainObject_default(i)?r=i:o=i;const a=new ContainerElement(this.document,e,t,o);return r.renderUnsafeAttributes&&a._unsafeAttributesToRender.push(...r.renderUnsafeAttributes),a}createEditableElement(e,t,i={}){const r=new EditableElement(this.document,e,t);return i.renderUnsafeAttributes&&r._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),r}createEmptyElement(e,t,i={}){const r=new EmptyElement(this.document,e,t);return i.renderUnsafeAttributes&&r._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),r}createUIElement(e,t,i){const r=new UIElement(this.document,e,t);return i&&(r.render=i),r}createRawElement(e,t,i,r={}){const o=new RawElement(this.document,e,t);return i&&(o.render=i),r.renderUnsafeAttributes&&o._unsafeAttributesToRender.push(...r.renderUnsafeAttributes),o}setAttribute(e,t,i){i._setAttribute(e,t)}removeAttribute(e,t){t._removeAttribute(e)}addClass(e,t){t._addClass(e)}removeClass(e,t){t._removeClass(e)}setStyle(e,t,i){isPlainObject_default(e)&&i===void 0?t._setStyle(e):i._setStyle(e,t)}removeStyle(e,t){t._removeStyle(e)}setCustomProperty(e,t,i){i._setCustomProperty(e,t)}removeCustomProperty(e,t){return t._removeCustomProperty(e)}breakAttributes(e){return e instanceof Position$1?this._breakAttributes(e):this._breakAttributesRange(e)}breakContainer(e){const t=e.parent;if(!t.is("containerElement"))throw new CKEditorError("view-writer-break-non-container-element",this.document);if(!t.parent)throw new CKEditorError("view-writer-break-root",this.document);if(e.isAtStart)return Position$1._createBefore(t);if(!e.isAtEnd){const i=t._clone(!1);this.insert(Position$1._createAfter(t),i);const r=new Range$1(e,Position$1._createAt(t,"end")),o=new Position$1(i,0);this.move(r,o)}return Position$1._createAfter(t)}mergeAttributes(e){const t=e.offset,i=e.parent;if(i.is("$text"))return e;if(i.is("attributeElement")&&i.childCount===0){const a=i.parent,c=i.index;return i._remove(),this._removeFromClonedElementsGroup(i),this.mergeAttributes(new Position$1(a,c))}const r=i.getChild(t-1),o=i.getChild(t);if(!r||!o)return e;if(r.is("$text")&&o.is("$text"))return mergeTextNodes(r,o);if(r.is("attributeElement")&&o.is("attributeElement")&&r.isSimilar(o)){const a=r.childCount;return r._appendChild(o.getChildren()),o._remove(),this._removeFromClonedElementsGroup(o),this.mergeAttributes(new Position$1(r,a))}return e}mergeContainers(e){const t=e.nodeBefore,i=e.nodeAfter;if(!t||!i||!t.is("containerElement")||!i.is("containerElement"))throw new CKEditorError("view-writer-merge-containers-invalid-position",this.document);const r=t.getChild(t.childCount-1),o=r instanceof Text$1?Position$1._createAt(r,"end"):Position$1._createAt(t,"end");return this.move(Range$1._createIn(i),Position$1._createAt(t,"end")),this.remove(Range$1._createOn(i)),o}insert(e,t){t=isIterable(t)?[...t]:[t],validateNodesToInsert(t,this.document);const i=t.reduce((a,c)=>{const u=a[a.length-1],h=!c.is("uiElement");return!u||u.breakAttributes!=h?a.push({breakAttributes:h,nodes:[c]}):u.nodes.push(c),a},[]);let r=null,o=e;for(const{nodes:a,breakAttributes:c}of i){const u=this._insertNodes(o,a,c);r||(r=u.start),o=u.end}return r?new Range$1(r,o):new Range$1(e)}remove(e){const t=e instanceof Range$1?e:Range$1._createOn(e);if(validateRangeContainer(t,this.document),t.isCollapsed)return new DocumentFragment$1(this.document);const{start:i,end:r}=this._breakAttributesRange(t,!0),o=i.parent,a=r.offset-i.offset,c=o._removeChildren(i.offset,a);for(const h of c)this._removeFromClonedElementsGroup(h);const u=this.mergeAttributes(i);return t.start=u,t.end=u.clone(),new DocumentFragment$1(this.document,c)}clear(e,t){validateRangeContainer(e,this.document);const i=e.getWalker({direction:"backward",ignoreElementEnd:!0});for(const r of i){const o=r.item;let a;if(o.is("element")&&t.isSimilar(o))a=Range$1._createOn(o);else if(!r.nextPosition.isAfter(e.start)&&o.is("$textProxy")){const c=o.getAncestors().find(u=>u.is("element")&&t.isSimilar(u));c&&(a=Range$1._createIn(c))}a&&(a.end.isAfter(e.end)&&(a.end=e.end),a.start.isBefore(e.start)&&(a.start=e.start),this.remove(a))}}move(e,t){let i;if(t.isAfter(e.end)){t=this._breakAttributes(t,!0);const r=t.parent,o=r.childCount;e=this._breakAttributesRange(e,!0),i=this.remove(e),t.offset+=r.childCount-o}else i=this.remove(e);return this.insert(t,i)}wrap(e,t){if(!(t instanceof AttributeElement))throw new CKEditorError("view-writer-wrap-invalid-attribute",this.document);if(validateRangeContainer(e,this.document),e.isCollapsed){let i=e.start;i.parent.is("element")&&!_hasNonUiChildren(i.parent)&&(i=i.getLastMatchingPosition(o=>o.item.is("uiElement"))),i=this._wrapPosition(i,t);const r=this.document.selection;return r.isCollapsed&&r.getFirstPosition().isEqual(e.start)&&this.setSelection(i),new Range$1(i)}else return this._wrapRange(e,t)}unwrap(e,t){if(!(t instanceof AttributeElement))throw new CKEditorError("view-writer-unwrap-invalid-attribute",this.document);if(validateRangeContainer(e,this.document),e.isCollapsed)return e;const{start:i,end:r}=this._breakAttributesRange(e,!0),o=i.parent,a=this._unwrapChildren(o,i.offset,r.offset,t),c=this.mergeAttributes(a.start);c.isEqual(a.start)||a.end.offset--;const u=this.mergeAttributes(a.end);return new Range$1(c,u)}rename(e,t){const i=new ContainerElement(this.document,e,t.getAttributes());return this.insert(Position$1._createAfter(t),i),this.move(Range$1._createIn(t),Position$1._createAt(i,0)),this.remove(Range$1._createOn(t)),i}clearClonedElementsGroup(e){this._cloneGroups.delete(e)}createPositionAt(e,t){return Position$1._createAt(e,t)}createPositionAfter(e){return Position$1._createAfter(e)}createPositionBefore(e){return Position$1._createBefore(e)}createRange(e,t){return new Range$1(e,t)}createRangeOn(e){return Range$1._createOn(e)}createRangeIn(e){return Range$1._createIn(e)}createSelection(...e){return new Selection$1(...e)}createSlot(e="children"){if(!this._slotFactory)throw new CKEditorError("view-writer-invalid-create-slot-context",this.document);return this._slotFactory(this,e)}_registerSlotFactory(e){this._slotFactory=e}_clearSlotFactory(){this._slotFactory=null}_insertNodes(e,t,i){let r;if(i?r=getParentContainer(e):r=e.parent.is("$text")?e.parent.parent:e.parent,!r)throw new CKEditorError("view-writer-invalid-position-container",this.document);let o;i?o=this._breakAttributes(e,!0):o=e.parent.is("$text")?breakTextNode(e):e;const a=r._insertChild(o.offset,t);for(const d of t)this._addToClonedElementsGroup(d);const c=o.getShiftedBy(a),u=this.mergeAttributes(o);u.isEqual(o)||c.offset--;const h=this.mergeAttributes(c);return new Range$1(u,h)}_wrapChildren(e,t,i,r){let o=t;const a=[];for(;o<i;){const u=e.getChild(o),h=u.is("$text"),d=u.is("attributeElement");if(d&&this._wrapAttributeElement(r,u))a.push(new Position$1(e,o));else if(h||!d||shouldABeOutsideB(r,u)){const f=r._clone();u._remove(),f._appendChild(u),e._insertChild(o,f),this._addToClonedElementsGroup(f),a.push(new Position$1(e,o))}else this._wrapChildren(u,0,u.childCount,r);o++}let c=0;for(const u of a){if(u.offset-=c,u.offset==t)continue;this.mergeAttributes(u).isEqual(u)||(c++,i--)}return Range$1._createFromParentsAndOffsets(e,t,e,i)}_unwrapChildren(e,t,i,r){let o=t;const a=[];for(;o<i;){const u=e.getChild(o);if(!u.is("attributeElement")){o++;continue}if(u.isSimilar(r)){const h=u.getChildren(),d=u.childCount;u._remove(),e._insertChild(o,h),this._removeFromClonedElementsGroup(u),a.push(new Position$1(e,o),new Position$1(e,o+d)),o+=d,i+=d-1;continue}if(this._unwrapAttributeElement(r,u)){a.push(new Position$1(e,o),new Position$1(e,o+1)),o++;continue}this._unwrapChildren(u,0,u.childCount,r),o++}let c=0;for(const u of a){if(u.offset-=c,u.offset==t||u.offset==i)continue;this.mergeAttributes(u).isEqual(u)||(c++,i--)}return Range$1._createFromParentsAndOffsets(e,t,e,i)}_wrapRange(e,t){const{start:i,end:r}=this._breakAttributesRange(e,!0),o=i.parent,a=this._wrapChildren(o,i.offset,r.offset,t),c=this.mergeAttributes(a.start);c.isEqual(a.start)||a.end.offset--;const u=this.mergeAttributes(a.end);return new Range$1(c,u)}_wrapPosition(e,t){if(t.isSimilar(e.parent))return movePositionToTextNode(e.clone());e.parent.is("$text")&&(e=breakTextNode(e));const i=this.createAttributeElement("_wrapPosition-fake-element");i._priority=Number.POSITIVE_INFINITY,i.isSimilar=()=>!1,e.parent._insertChild(e.offset,i);const r=new Range$1(e,e.getShiftedBy(1));this.wrap(r,t);const o=new Position$1(i.parent,i.index);i._remove();const a=o.nodeBefore,c=o.nodeAfter;return a&&a.is("view:$text")&&c&&c.is("view:$text")?mergeTextNodes(a,c):movePositionToTextNode(o)}_wrapAttributeElement(e,t){if(!canBeJoined(e,t)||e.name!==t.name||e.priority!==t.priority)return!1;for(const i of e.getAttributeKeys())if(!(i==="class"||i==="style")&&t.hasAttribute(i)&&t.getAttribute(i)!==e.getAttribute(i))return!1;for(const i of e.getStyleNames())if(t.hasStyle(i)&&t.getStyle(i)!==e.getStyle(i))return!1;for(const i of e.getAttributeKeys())i==="class"||i==="style"||t.hasAttribute(i)||this.setAttribute(i,e.getAttribute(i),t);for(const i of e.getStyleNames())t.hasStyle(i)||this.setStyle(i,e.getStyle(i),t);for(const i of e.getClassNames())t.hasClass(i)||this.addClass(i,t);return!0}_unwrapAttributeElement(e,t){if(!canBeJoined(e,t)||e.name!==t.name||e.priority!==t.priority)return!1;for(const i of e.getAttributeKeys())if(!(i==="class"||i==="style")&&(!t.hasAttribute(i)||t.getAttribute(i)!==e.getAttribute(i)))return!1;if(!t.hasClass(...e.getClassNames()))return!1;for(const i of e.getStyleNames())if(!t.hasStyle(i)||t.getStyle(i)!==e.getStyle(i))return!1;for(const i of e.getAttributeKeys())i==="class"||i==="style"||this.removeAttribute(i,t);return this.removeClass(Array.from(e.getClassNames()),t),this.removeStyle(Array.from(e.getStyleNames()),t),!0}_breakAttributesRange(e,t=!1){const i=e.start,r=e.end;if(validateRangeContainer(e,this.document),e.isCollapsed){const u=this._breakAttributes(e.start,t);return new Range$1(u,u)}const o=this._breakAttributes(r,t),a=o.parent.childCount,c=this._breakAttributes(i,t);return o.offset+=o.parent.childCount-a,new Range$1(c,o)}_breakAttributes(e,t=!1){const i=e.offset,r=e.parent;if(e.parent.is("emptyElement"))throw new CKEditorError("view-writer-cannot-break-empty-element",this.document);if(e.parent.is("uiElement"))throw new CKEditorError("view-writer-cannot-break-ui-element",this.document);if(e.parent.is("rawElement"))throw new CKEditorError("view-writer-cannot-break-raw-element",this.document);if(!t&&r.is("$text")&&isContainerOrFragment(r.parent)||isContainerOrFragment(r))return e.clone();if(r.is("$text"))return this._breakAttributes(breakTextNode(e),t);const o=r.childCount;if(i==o){const a=new Position$1(r.parent,r.index+1);return this._breakAttributes(a,t)}else if(i===0){const a=new Position$1(r.parent,r.index);return this._breakAttributes(a,t)}else{const a=r.index+1,c=r._clone();r.parent._insertChild(a,c),this._addToClonedElementsGroup(c);const u=r.childCount-i,h=r._removeChildren(i,u);c._appendChild(h);const d=new Position$1(r.parent,a);return this._breakAttributes(d,t)}}_addToClonedElementsGroup(e){if(!e.root.is("rootElement"))return;if(e.is("element"))for(const r of e.getChildren())this._addToClonedElementsGroup(r);const t=e.id;if(!t)return;let i=this._cloneGroups.get(t);i||(i=new Set,this._cloneGroups.set(t,i)),i.add(e),e._clonesGroup=i}_removeFromClonedElementsGroup(e){if(e.is("element"))for(const r of e.getChildren())this._removeFromClonedElementsGroup(r);const t=e.id;if(!t)return;const i=this._cloneGroups.get(t);i&&i.delete(e)}};function _hasNonUiChildren(e){return Array.from(e.getChildren()).some(t=>!t.is("uiElement"))}function getParentContainer(e){let t=e.parent;for(;!isContainerOrFragment(t);){if(!t)return;t=t.parent}return t}function shouldABeOutsideB(e,t){return e.priority<t.priority?!0:e.priority>t.priority?!1:e.getIdentity()<t.getIdentity()}function movePositionToTextNode(e){const t=e.nodeBefore;if(t&&t.is("$text"))return new Position$1(t,t.data.length);const i=e.nodeAfter;return i&&i.is("$text")?new Position$1(i,0):e}function breakTextNode(e){if(e.offset==e.parent.data.length)return new Position$1(e.parent.parent,e.parent.index+1);if(e.offset===0)return new Position$1(e.parent.parent,e.parent.index);const t=e.parent.data.slice(e.offset);return e.parent._data=e.parent.data.slice(0,e.offset),e.parent.parent._insertChild(e.parent.index+1,new Text$1(e.root.document,t)),new Position$1(e.parent.parent,e.parent.index+1)}function mergeTextNodes(e,t){const i=e.data.length;return e._data+=t.data,t._remove(),new Position$1(e,i)}const validNodesToInsert=[Text$1,AttributeElement,ContainerElement,EmptyElement,RawElement,UIElement];function validateNodesToInsert(e,t){for(const i of e){if(!validNodesToInsert.some(r=>i instanceof r))throw new CKEditorError("view-writer-insert-invalid-node-type",t);i.is("$text")||validateNodesToInsert(i.getChildren(),t)}}function isContainerOrFragment(e){return e&&(e.is("containerElement")||e.is("documentFragment"))}function validateRangeContainer(e,t){const i=getParentContainer(e.start),r=getParentContainer(e.end);if(!i||!r||i!==r)throw new CKEditorError("view-writer-invalid-range-container",t)}function canBeJoined(e,t){return e.id===null&&t.id===null}const NBSP_FILLER=e=>e.createTextNode("\xA0"),MARKED_NBSP_FILLER=e=>{const t=e.createElement("span");return t.dataset.ckeFiller="true",t.innerText="\xA0",t},BR_FILLER=e=>{const t=e.createElement("br");return t.dataset.ckeFiller="true",t},INLINE_FILLER_LENGTH=7,INLINE_FILLER="\u2060".repeat(INLINE_FILLER_LENGTH);function startsWithFiller(e){return typeof e=="string"?e.substr(0,INLINE_FILLER_LENGTH)===INLINE_FILLER:isText(e)&&e.data.substr(0,INLINE_FILLER_LENGTH)===INLINE_FILLER}function isInlineFiller(e){return e.data.length==INLINE_FILLER_LENGTH&&startsWithFiller(e)}function getDataWithoutFiller(e){const t=typeof e=="string"?e:e.data;return startsWithFiller(e)?t.slice(INLINE_FILLER_LENGTH):t}function injectQuirksHandling(e){e.document.on("arrowKey",jumpOverInlineFiller,{priority:"low"})}function jumpOverInlineFiller(e,t){if(t.keyCode==keyCodes.arrowleft){const i=t.domTarget.ownerDocument.defaultView.getSelection();if(i.rangeCount==1&&i.getRangeAt(0).collapsed){const r=i.getRangeAt(0).startContainer,o=i.getRangeAt(0).startOffset;startsWithFiller(r)&&o<=INLINE_FILLER_LENGTH&&i.collapse(r,0)}}}var Renderer$1=class extends ObservableMixin(){domDocuments=new Set;domConverter;markedAttributes=new Set;markedChildren=new Set;markedTexts=new Set;selection;_inlineFiller=null;_fakeSelectionContainer=null;constructor(e,t){super(),this.domConverter=e,this.selection=t,this.set("isFocused",!1),this.set("isSelecting",!1),this.set("isComposing",!1),env.isBlink&&!env.isAndroid&&this.on("change:isSelecting",()=>{this.isSelecting||this.render()})}markToSync(e,t){if(e==="text")this.domConverter.mapViewToDom(t.parent)&&this.markedTexts.add(t);else{if(!this.domConverter.mapViewToDom(t))return;if(e==="attributes")this.markedAttributes.add(t);else if(e==="children")this.markedChildren.add(t);else throw new CKEditorError("view-renderer-unknown-type",this)}}render(){if(this.isComposing&&!env.isAndroid)return;let e=null;const t=env.isBlink&&!env.isAndroid?!this.isSelecting:!0;for(const i of this.markedChildren)this._updateChildrenMappings(i);t?(this._inlineFiller&&!this._isSelectionInInlineFiller()&&this._removeInlineFiller(),this._inlineFiller?e=this._getInlineFillerPosition():this._needsInlineFillerAtSelection()&&(e=this.selection.getFirstPosition(),this.markedChildren.add(e.parent))):this._inlineFiller&&this._inlineFiller.parentNode&&(e=this.domConverter.domPositionToView(this._inlineFiller),e&&e.parent.is("$text")&&(e=Position$1._createBefore(e.parent)));for(const i of this.markedAttributes)this._updateAttrs(i);for(const i of this.markedChildren)this._updateChildren(i,{inlineFillerPosition:e});for(const i of this.markedTexts)!this.markedChildren.has(i.parent)&&this.domConverter.mapViewToDom(i.parent)&&this._updateText(i,{inlineFillerPosition:e});if(t)if(e){const i=this.domConverter.viewPositionToDom(e),r=i.parent.ownerDocument;startsWithFiller(i.parent)?this._inlineFiller=i.parent:this._inlineFiller=addInlineFiller(r,i.parent,i.offset)}else this._inlineFiller=null;this._updateFocus(),this._updateSelection(),this.domConverter._clearTemporaryCustomProperties(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear()}_updateChildrenMappings(e){const t=this.domConverter.mapViewToDom(e);if(!t)return;const i=Array.from(t.childNodes),r=Array.from(this.domConverter.viewChildrenToDom(e,{withChildren:!1})),o=this._diffNodeLists(i,r),a=this._findUpdateActions(o,i,r,areSimilarElements);if(a.indexOf("update")!==-1){const c={equal:0,insert:0,delete:0};for(const u of a)if(u==="update"){const h=c.equal+c.insert,d=c.equal+c.delete,f=e.getChild(h);f&&!f.is("uiElement")&&!f.is("rawElement")&&this._updateElementMappings(f,i[d]),remove$3(r[h]),c.equal++}else c[u]++}}_updateElementMappings(e,t){this.domConverter.unbindDomElement(t),this.domConverter.bindElements(t,e),this.markedChildren.add(e),this.markedAttributes.add(e)}_getInlineFillerPosition(){const e=this.selection.getFirstPosition();return e.parent.is("$text")?Position$1._createBefore(e.parent):e}_isSelectionInInlineFiller(){if(this.selection.rangeCount!=1||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=this.domConverter.viewPositionToDom(e);return!!(t&&isText(t.parent)&&startsWithFiller(t.parent))}_removeInlineFiller(){const e=this._inlineFiller;if(!startsWithFiller(e))throw new CKEditorError("view-renderer-filler-was-lost",this);isInlineFiller(e)?e.remove():e.data=e.data.substr(INLINE_FILLER_LENGTH),this._inlineFiller=null}_needsInlineFillerAtSelection(){if(this.selection.rangeCount!=1||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=e.parent,i=e.offset;if(!this.domConverter.mapViewToDom(t.root)||!t.is("element")||!isEditable(t))return!1;const r=e.nodeBefore,o=e.nodeAfter;return!(r instanceof Text$1||o instanceof Text$1||i===t.getFillerOffset()&&(!r||!r.is("element","br"))||env.isAndroid&&(r||o))}_updateText(e,t){const i=this.domConverter.findCorrespondingDomText(e);let o=this.domConverter.viewToDom(e).data;const a=t.inlineFillerPosition;a&&a.parent==e.parent&&a.offset==e.index&&(o=INLINE_FILLER+o),this._updateTextNode(i,o)}_updateAttrs(e){const t=this.domConverter.mapViewToDom(e);if(t){for(const i of Array.from(t.attributes)){const r=i.name;e.hasAttribute(r)||this.domConverter.removeDomElementAttribute(t,r)}for(const i of e.getAttributeKeys())this.domConverter.setDomElementAttribute(t,i,e.getAttribute(i),e)}}_updateChildren(e,t){const i=this.domConverter.mapViewToDom(e);if(!i)return;if(env.isAndroid){let f=null;for(const m of Array.from(i.childNodes)){if(f&&isText(f)&&isText(m)){i.normalize();break}f=m}}const r=t.inlineFillerPosition,o=i.childNodes,a=Array.from(this.domConverter.viewChildrenToDom(e,{bind:!0}));r&&r.parent===e&&addInlineFiller(i.ownerDocument,a,r.offset);const c=this._diffNodeLists(o,a),u=this._findUpdateActions(c,o,a,areTextNodes);let h=0;const d=new Set;for(const f of u)f==="delete"?(d.add(o[h]),remove$3(o[h])):(f==="equal"||f==="update")&&h++;h=0;for(const f of u)f==="insert"?(insertAt(i,h,a[h]),h++):f==="update"?(this._updateTextNode(o[h],a[h].data),h++):f==="equal"&&(this._markDescendantTextToSync(this.domConverter.domToView(a[h])),h++);for(const f of d)f.parentNode||this.domConverter.unbindDomElement(f)}_diffNodeLists(e,t){return e=filterOutFakeSelectionContainer(e,this._fakeSelectionContainer),diff(e,t,sameNodes$1.bind(null,this.domConverter))}_findUpdateActions(e,t,i,r){if(e.indexOf("insert")===-1||e.indexOf("delete")===-1)return e;let o=[],a=[],c=[];const u={equal:0,insert:0,delete:0};for(const h of e)h==="insert"?c.push(i[u.equal+u.insert]):h==="delete"?a.push(t[u.equal+u.delete]):(o=o.concat(diff(a,c,r).map(d=>d==="equal"?"update":d)),o.push("equal"),a=[],c=[]),u[h]++;return o.concat(diff(a,c,r).map(h=>h==="equal"?"update":h))}_updateTextNode(e,t){const i=e.data;i!=t&&(env.isAndroid&&this.isComposing&&i.replace(/\u00A0/g," ")==t.replace(/\u00A0/g," ")||this._updateTextNodeInternal(e,t))}_updateTextNodeInternal(e,t){const i=fastDiff(e.data,t);for(const r of i)r.type==="insert"?e.insertData(r.index,r.values.join("")):e.deleteData(r.index,r.howMany)}_markDescendantTextToSync(e){if(e){if(e.is("$text"))this.markedTexts.add(e);else if(e.is("element"))for(const t of e.getChildren())this._markDescendantTextToSync(t)}}_updateSelection(){if(env.isBlink&&!env.isAndroid&&this.isSelecting&&!this.markedChildren.size)return;if(this.selection.rangeCount===0){this._removeDomSelection(),this._removeFakeSelection();return}const e=this.domConverter.mapViewToDom(this.selection.editableElement);!this.isFocused||!e||(this.selection.isFake?this._updateFakeSelection(e):this._fakeSelectionContainer&&this._fakeSelectionContainer.isConnected?(this._removeFakeSelection(),this._updateDomSelection(e)):this.isComposing&&env.isAndroid||this._updateDomSelection(e))}_updateFakeSelection(e){const t=e.ownerDocument;this._fakeSelectionContainer||(this._fakeSelectionContainer=createFakeSelectionContainer(t));const i=this._fakeSelectionContainer;if(this.domConverter.bindFakeSelection(i,this.selection),!this._fakeSelectionNeedsUpdate(e))return;(!i.parentElement||i.parentElement!=e)&&e.appendChild(i),i.textContent=this.selection.fakeSelectionLabel||"\xA0";const r=t.getSelection(),o=t.createRange();r.removeAllRanges(),o.selectNodeContents(i),r.addRange(o)}_updateDomSelection(e){const t=e.ownerDocument.defaultView.getSelection();if(!this._domSelectionNeedsUpdate(t))return;const i=this.domConverter.viewPositionToDom(this.selection.anchor),r=this.domConverter.viewPositionToDom(this.selection.focus);t.setBaseAndExtent(i.parent,i.offset,r.parent,r.offset),env.isGecko&&fixGeckoSelectionAfterBr(r,t)}_domSelectionNeedsUpdate(e){if(!this.domConverter.isDomSelectionCorrect(e))return!0;const t=e&&this.domConverter.domSelectionToView(e);return!(t&&this.selection.isEqual(t)||!this.selection.isCollapsed&&this.selection.isSimilar(t))}_fakeSelectionNeedsUpdate(e){const t=this._fakeSelectionContainer,i=e.ownerDocument.getSelection();return!t||t.parentElement!==e||i.anchorNode!==t&&!t.contains(i.anchorNode)?!0:t.textContent!==this.selection.fakeSelectionLabel}_removeDomSelection(){for(const e of this.domDocuments){const t=e.getSelection();if(t.rangeCount){const i=e.activeElement,r=this.domConverter.mapDomToView(i);i&&r&&t.removeAllRanges()}}}_removeFakeSelection(){const e=this._fakeSelectionContainer;e&&e.remove()}_updateFocus(){if(this.isFocused){const e=this.selection.editableElement;e&&this.domConverter.focus(e)}}};function isEditable(e){if(e.getAttribute("contenteditable")=="false")return!1;const t=e.findAncestor(i=>i.hasAttribute("contenteditable"));return!t||t.getAttribute("contenteditable")=="true"}function addInlineFiller(e,t,i){const r=t instanceof Array?t:t.childNodes,o=r[i];if(isText(o))return o.data=INLINE_FILLER+o.data,o;{const a=e.createTextNode(INLINE_FILLER);return Array.isArray(t)?r.splice(i,0,a):insertAt(t,i,a),a}}function areSimilarElements(e,t){return isNode(e)&&isNode(t)&&!isText(e)&&!isText(t)&&!isComment(e)&&!isComment(t)&&e.tagName.toLowerCase()===t.tagName.toLowerCase()}function areTextNodes(e,t){return isNode(e)&&isNode(t)&&isText(e)&&isText(t)}function sameNodes$1(e,t,i){return t===i?!0:isText(t)&&isText(i)?t.data===i.data:!!(e.isBlockFiller(t)&&e.isBlockFiller(i))}function fixGeckoSelectionAfterBr(e,t){let i=e.parent,r=e.offset;if(isText(i)&&isInlineFiller(i)&&(r=indexOf$1(i)+1,i=i.parentNode),i.nodeType!=Node.ELEMENT_NODE||r!=i.childNodes.length-1)return;const o=i.childNodes[r];o&&o.tagName=="BR"&&t.addRange(t.getRangeAt(0))}function filterOutFakeSelectionContainer(e,t){const i=Array.from(e);return i.length==0||!t||i[i.length-1]==t&&i.pop(),i}function createFakeSelectionContainer(e){const t=e.createElement("div");return t.className="ck-fake-selection-container",Object.assign(t.style,{position:"fixed",top:0,left:"-9999px",width:"42px"}),t.textContent="\xA0",t}const BR_FILLER_REF=BR_FILLER(global$1.document),NBSP_FILLER_REF=NBSP_FILLER(global$1.document),MARKED_NBSP_FILLER_REF=MARKED_NBSP_FILLER(global$1.document),UNSAFE_ATTRIBUTE_NAME_PREFIX="data-ck-unsafe-attribute-",UNSAFE_ELEMENT_REPLACEMENT_ATTRIBUTE="data-ck-unsafe-element";var DomConverter=class{document;renderingMode;blockFillerMode;preElements;blockElements;inlineObjectElements;unsafeElements;_domDocument;_domToViewMapping=new WeakMap;_viewToDomMapping=new WeakMap;_fakeSelectionMapping=new WeakMap;_rawContentElementMatcher=new Matcher;_inlineObjectElementMatcher=new Matcher;_elementsWithTemporaryCustomProperties=new Set;constructor(e,{blockFillerMode:t,renderingMode:i="editing"}={}){this.document=e,this.renderingMode=i,this.blockFillerMode=t||(i==="editing"?"br":"nbsp"),this.preElements=["pre","textarea"],this.blockElements=["address","article","aside","blockquote","caption","center","dd","details","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","legend","li","main","menu","nav","ol","p","pre","section","summary","table","tbody","td","tfoot","th","thead","tr","ul"],this.inlineObjectElements=["object","iframe","input","button","textarea","select","option","video","embed","audio","img","canvas"],this.unsafeElements=["script","style"],this._domDocument=this.renderingMode==="editing"?global$1.document:global$1.document.implementation.createHTMLDocument("")}bindFakeSelection(e,t){this._fakeSelectionMapping.set(e,new Selection$1(t))}fakeSelectionToView(e){return this._fakeSelectionMapping.get(e)}bindElements(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}unbindDomElement(e){const t=this._domToViewMapping.get(e);if(t){this._domToViewMapping.delete(e),this._viewToDomMapping.delete(t);for(const i of e.children)this.unbindDomElement(i)}}bindDocumentFragments(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}shouldRenderAttribute(e,t,i){return this.renderingMode==="data"?!0:(e=e.toLowerCase(),e.startsWith("on")||e==="srcdoc"&&t.match(/\bon\S+\s*=|javascript:|<\s*\/*script/i)?!1:i==="img"&&(e==="src"||e==="srcset")||i==="source"&&e==="srcset"?!0:!t.match(/^\s*(javascript:|data:(image\/svg|text\/x?html))/i))}setContentOf(e,t){if(this.renderingMode==="data"){e.innerHTML=t;return}const i=new DOMParser().parseFromString(t,"text/html"),r=i.createDocumentFragment(),o=i.body.childNodes;for(;o.length>0;)r.appendChild(o[0]);const a=i.createTreeWalker(r,NodeFilter.SHOW_ELEMENT),c=[];let u;for(;u=a.nextNode();)c.push(u);for(const h of c){for(const f of h.getAttributeNames())this.setDomElementAttribute(h,f,h.getAttribute(f));const d=h.tagName.toLowerCase();this._shouldRenameElement(d)&&(_logUnsafeElement(d),h.replaceWith(this._createReplacementDomElement(d,h)))}for(;e.firstChild;)e.firstChild.remove();e.append(r)}viewToDom(e,t={}){if(e.is("$text")){const i=this._processDataFromViewText(e);return this._domDocument.createTextNode(i)}else{const i=e;if(this.mapViewToDom(i))if(i.getCustomProperty("editingPipeline:doNotReuseOnce"))this._elementsWithTemporaryCustomProperties.add(i);else return this.mapViewToDom(i);let r;if(i.is("documentFragment"))r=this._domDocument.createDocumentFragment(),t.bind&&this.bindDocumentFragments(r,i);else{if(i.is("uiElement"))return i.name==="$comment"?r=this._domDocument.createComment(i.getCustomProperty("$rawContent")):r=i.render(this._domDocument,this),t.bind&&this.bindElements(r,i),r;this._shouldRenameElement(i.name)?(_logUnsafeElement(i.name),r=this._createReplacementDomElement(i.name)):i.hasAttribute("xmlns")?r=this._domDocument.createElementNS(i.getAttribute("xmlns"),i.name):r=this._domDocument.createElement(i.name),i.is("rawElement")&&i.render(r,this),t.bind&&this.bindElements(r,i);for(const o of i.getAttributeKeys())this.setDomElementAttribute(r,o,i.getAttribute(o),i)}if(t.withChildren!==!1)for(const o of this.viewChildrenToDom(i,t))r instanceof HTMLTemplateElement?r.content.appendChild(o):r.appendChild(o);return r}}setDomElementAttribute(e,t,i,r){const o=this.shouldRenderAttribute(t,i,e.tagName.toLowerCase())||r&&r.shouldRenderUnsafeAttribute(t);if(o||logWarning("domconverter-unsafe-attribute-detected",{domElement:e,key:t,value:i}),!isValidAttributeName(t)){logWarning("domconverter-invalid-attribute-detected",{domElement:e,key:t,value:i});return}e.hasAttribute(t)&&!o?e.removeAttribute(t):e.hasAttribute(UNSAFE_ATTRIBUTE_NAME_PREFIX+t)&&o&&e.removeAttribute(UNSAFE_ATTRIBUTE_NAME_PREFIX+t),e.setAttribute(o?t:UNSAFE_ATTRIBUTE_NAME_PREFIX+t,i)}removeDomElementAttribute(e,t){t!=UNSAFE_ELEMENT_REPLACEMENT_ATTRIBUTE&&(e.removeAttribute(t),e.removeAttribute(UNSAFE_ATTRIBUTE_NAME_PREFIX+t))}*viewChildrenToDom(e,t={}){const i=e.getFillerOffset&&e.getFillerOffset();let r=0;for(const o of e.getChildren()){i===r&&(yield this._getBlockFiller());const a=o.is("element")&&!!o.getCustomProperty("dataPipeline:transparentRendering")&&!first(o.getAttributes());if(a&&this.renderingMode=="data")if(o.is("rawElement")){const c=this._domDocument.createElement(o.name);o.render(c,this),yield*[...c.childNodes]}else yield*this.viewChildrenToDom(o,t);else a&&logWarning("domconverter-transparent-rendering-unsupported-in-editing-pipeline",{viewElement:o}),yield this.viewToDom(o,t);r++}i===r&&(yield this._getBlockFiller())}viewRangeToDom(e){const t=this.viewPositionToDom(e.start),i=this.viewPositionToDom(e.end),r=this._domDocument.createRange();return r.setStart(t.parent,t.offset),r.setEnd(i.parent,i.offset),r}viewPositionToDom(e){const t=e.parent;if(t.is("$text")){const i=this.findCorrespondingDomText(t);if(!i)return null;let r=e.offset;return startsWithFiller(i)&&(r+=INLINE_FILLER_LENGTH),{parent:i,offset:r}}else{let i,r,o;if(e.offset===0){if(i=this.mapViewToDom(t),!i)return null;o=i.childNodes[0]}else{const c=e.nodeBefore;if(r=c.is("$text")?this.findCorrespondingDomText(c):this.mapViewToDom(c),!r)return null;i=r.parentNode,o=r.nextSibling}if(isText(o)&&startsWithFiller(o))return{parent:o,offset:INLINE_FILLER_LENGTH};const a=r?indexOf$1(r)+1:0;return{parent:i,offset:a}}}domToView(e,t={}){const i=[],r=this._domToView(e,t,i),o=r.next().value;return!o||(r.next(),this._processDomInlineNodes(null,i,t),o.is("$text")&&o.data.length==0)?null:o}*domChildrenToView(e,t={},i=[]){let r=[];e instanceof HTMLTemplateElement?r=[...e.content.childNodes]:r=[...e.childNodes];for(let o=0;o<r.length;o++){const a=r[o],c=this._domToView(a,t,i),u=c.next().value;u!==null&&(this._isBlockViewElement(u)&&this._processDomInlineNodes(e,i,t),yield u,c.next())}this._processDomInlineNodes(e,i,t)}domSelectionToView(e){if(isGeckoRestrictedDomSelection(e))return new Selection$1([]);if(e.rangeCount===1){let r=e.getRangeAt(0).startContainer;isText(r)&&(r=r.parentNode);const o=this.fakeSelectionToView(r);if(o)return o}const t=this.isDomSelectionBackward(e),i=[];for(let r=0;r<e.rangeCount;r++){const o=e.getRangeAt(r),a=this.domRangeToView(o);a&&i.push(a)}return new Selection$1(i,{backward:t})}domRangeToView(e){const t=this.domPositionToView(e.startContainer,e.startOffset),i=this.domPositionToView(e.endContainer,e.endOffset);return t&&i?new Range$1(t,i):null}domPositionToView(e,t=0){if(this.isBlockFiller(e))return this.domPositionToView(e.parentNode,indexOf$1(e));const i=this.mapDomToView(e);if(i&&(i.is("uiElement")||i.is("rawElement")))return Position$1._createBefore(i);if(isText(e)){if(isInlineFiller(e))return this.domPositionToView(e.parentNode,indexOf$1(e));const r=this.findCorrespondingViewText(e);let o=t;return r?(startsWithFiller(e)&&(o-=INLINE_FILLER_LENGTH,o=o<0?0:o),new Position$1(r,o)):null}else{if(t===0){const r=this.mapDomToView(e);if(r)return new Position$1(r,0)}else{const r=e.childNodes[t-1];if(isText(r)&&isInlineFiller(r)||r&&this.isBlockFiller(r))return this.domPositionToView(r.parentNode,indexOf$1(r));const o=isText(r)?this.findCorrespondingViewText(r):this.mapDomToView(r);if(o&&o.parent)return new Position$1(o.parent,o.index+1)}return null}}mapDomToView(e){return this.getHostViewElement(e)||this._domToViewMapping.get(e)}findCorrespondingViewText(e){if(isInlineFiller(e))return null;const t=this.getHostViewElement(e);if(t)return t;const i=e.previousSibling;if(i){if(!this.isElement(i))return null;const r=this.mapDomToView(i);if(r){const o=r.nextSibling;return o instanceof Text$1?o:null}}else{const r=this.mapDomToView(e.parentNode);if(r){const o=r.getChild(0);return o instanceof Text$1?o:null}}return null}mapViewToDom(e){return this._viewToDomMapping.get(e)}findCorrespondingDomText(e){const t=e.previousSibling;return t&&this.mapViewToDom(t)?this.mapViewToDom(t).nextSibling:!t&&e.parent&&this.mapViewToDom(e.parent)?this.mapViewToDom(e.parent).childNodes[0]:null}focus(e){const t=this.mapViewToDom(e);if(t&&t.ownerDocument.activeElement!==t){const{scrollX:i,scrollY:r}=global$1.window,o=[];forEachDomElementAncestor(t,a=>{const{scrollLeft:c,scrollTop:u}=a;o.push([c,u])}),t.focus(),forEachDomElementAncestor(t,a=>{const[c,u]=o.shift();a.scrollLeft=c,a.scrollTop=u}),global$1.window.scrollTo(i,r)}}_clearDomSelection(){const e=this.mapViewToDom(this.document.selection.editableElement);if(!e)return;const t=e.ownerDocument.defaultView.getSelection(),i=this.domSelectionToView(t);i&&i.rangeCount>0&&t.removeAllRanges()}isElement(e){return e&&e.nodeType==Node.ELEMENT_NODE}isDocumentFragment(e){return e&&e.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isBlockFiller(e){return this.blockFillerMode=="br"?e.isEqualNode(BR_FILLER_REF):e.tagName==="BR"&&hasBlockParent(e,this.blockElements)&&e.parentNode.childNodes.length===1?!0:e.isEqualNode(MARKED_NBSP_FILLER_REF)||isNbspBlockFiller(e,this.blockElements)}isDomSelectionBackward(e){if(e.isCollapsed)return!1;const t=this._domDocument.createRange();try{t.setStart(e.anchorNode,e.anchorOffset),t.setEnd(e.focusNode,e.focusOffset)}catch{return!1}const i=t.collapsed;return t.detach(),i}getHostViewElement(e){const t=getAncestors(e);for(t.pop();t.length;){const i=t.pop(),r=this._domToViewMapping.get(i);if(r&&(r.is("uiElement")||r.is("rawElement")))return r}return null}isDomSelectionCorrect(e){return this._isDomSelectionPositionCorrect(e.anchorNode,e.anchorOffset)&&this._isDomSelectionPositionCorrect(e.focusNode,e.focusOffset)}registerRawContentMatcher(e){this._rawContentElementMatcher.add(e)}registerInlineObjectMatcher(e){this._inlineObjectElementMatcher.add(e)}_clearTemporaryCustomProperties(){for(const e of this._elementsWithTemporaryCustomProperties)e._removeCustomProperty("editingPipeline:doNotReuseOnce");this._elementsWithTemporaryCustomProperties.clear()}_getBlockFiller(){switch(this.blockFillerMode){case"nbsp":return NBSP_FILLER(this._domDocument);case"markedNbsp":return MARKED_NBSP_FILLER(this._domDocument);case"br":return BR_FILLER(this._domDocument)}}_isDomSelectionPositionCorrect(e,t){if(isText(e)&&startsWithFiller(e)&&t<INLINE_FILLER_LENGTH||this.isElement(e)&&startsWithFiller(e.childNodes[t]))return!1;const i=this.mapDomToView(e);return!(i&&(i.is("uiElement")||i.is("rawElement")))}*_domToView(e,t,i){if(this.isBlockFiller(e))return null;const r=this.getHostViewElement(e);if(r)return r;if(isComment(e)&&t.skipComments)return null;if(isText(e)){if(isInlineFiller(e))return null;{const o=e.data;if(o==="")return null;const a=new Text$1(this.document,o);return i.push(a),a}}else{let o=this.mapDomToView(e);if(o)return this._isInlineObjectElement(o)&&i.push(o),o;if(this.isDocumentFragment(e))o=new DocumentFragment$1(this.document),t.bind&&this.bindDocumentFragments(e,o);else{o=this._createViewElement(e,t),t.bind&&this.bindElements(e,o);const c=e.attributes;if(c)for(let u=c.length,h=0;h<u;h++)o._setAttribute(c[h].name,c[h].value);if(this._isViewElementWithRawContent(o,t))return o._setCustomProperty("$rawContent",e.innerHTML),this._isBlockViewElement(o)||i.push(o),o;if(isComment(e))return o._setCustomProperty("$rawContent",e.data),o}yield o;const a=[];if(t.withChildren!==!1)for(const c of this.domChildrenToView(e,t,a))o._appendChild(c);if(this._isInlineObjectElement(o))i.push(o),this._processDomInlineNodes(null,a,t);else for(const c of a)i.push(c)}}_processDomInlineNodes(e,t,i){if(!t.length||e&&!this.isDocumentFragment(e)&&!this._isBlockDomElement(e))return;let r=!1;for(let o=0;o<t.length;o++){const a=t[o];if(!a.is("$text")){r=!1;continue}let c,u=!1;if(this._isPreFormatted(a))c=getDataWithoutFiller(a.data);else{c=a.data.replace(/[ \n\t\r]{1,}/g," "),u=/[^\S\u00A0]/.test(c.charAt(c.length-1));const h=o>0?t[o-1]:null,d=o+1<t.length?t[o+1]:null,f=!h||h.is("element")&&h.name=="br"||r,m=d?!1:!startsWithFiller(a.data);i.withChildren!==!1&&(f&&(c=c.replace(/^ /,"")),m&&(c=c.replace(/ $/,""))),c=getDataWithoutFiller(c),c=c.replace(/ \u00A0/g,"  ");const g=d&&d.is("element")&&d.name!="br",v=d&&d.is("$text")&&d.data.charAt(0)==" ";(/[ \u00A0]\u00A0$/.test(c)||!d||g||v)&&(c=c.replace(/\u00A0$/," ")),(f||h&&h.is("element")&&h.name!="br")&&(c=c.replace(/^\u00A0/," "))}c.length==0&&a.parent?(a._remove(),t.splice(o,1),o--):(a._data=c,r=u)}t.length=0}_processDataFromViewText(e){let t=e.data;if(this._isPreFormatted(e))return t;if(t.charAt(0)==" "){const i=this._getTouchingInlineViewNode(e,!1);(i&&i.is("$textProxy")&&this._nodeEndsWithSpace(i)||!i)&&(t="\xA0"+t.substr(1))}if(t.charAt(t.length-1)==" "){const i=this._getTouchingInlineViewNode(e,!0),r=i&&i.is("$textProxy")&&i.data.charAt(0)==" ";(t.charAt(t.length-2)==" "||!i||r)&&(t=t.substr(0,t.length-1)+"\xA0")}return t.replace(/ {2}/g," \xA0")}_nodeEndsWithSpace(e){if(this._isPreFormatted(e))return!1;const t=this._processDataFromViewText(e);return t.charAt(t.length-1)==" "}_isPreFormatted(e){if(_hasViewParentOfType(e,this.preElements))return!0;for(const t of e.getAncestors({parentFirst:!0}))if(!(!t.is("element")||!t.hasStyle("white-space")||t.getStyle("white-space")==="inherit"))return["pre","pre-wrap","break-spaces"].includes(t.getStyle("white-space"));return!1}_getTouchingInlineViewNode(e,t){const i=new TreeWalker$1({startPosition:t?Position$1._createAfter(e):Position$1._createBefore(e),direction:t?"forward":"backward"});for(const{item:r}of i){if(r.is("$textProxy"))return r;if(r.is("element")&&r.getCustomProperty("dataPipeline:transparentRendering"))continue;if(r.is("element","br"))return null;if(this._isInlineObjectElement(r))return r;if(r.is("containerElement"))return null}return null}_isBlockDomElement(e){return this.isElement(e)&&this.blockElements.includes(e.tagName.toLowerCase())}_isBlockViewElement(e){return e.is("element")&&this.blockElements.includes(e.name)}_isInlineObjectElement(e){return e.is("element")?e.name=="br"||this.inlineObjectElements.includes(e.name)||!!this._inlineObjectElementMatcher.match(e):!1}_createViewElement(e,t){if(isComment(e))return new UIElement(this.document,"$comment");const i=t.keepOriginalCase?e.tagName:e.tagName.toLowerCase();return new Element$1(this.document,i)}_isViewElementWithRawContent(e,t){return t.withChildren!==!1&&e.is("element")&&!!this._rawContentElementMatcher.match(e)}_shouldRenameElement(e){const t=e.toLowerCase();return this.renderingMode==="editing"&&this.unsafeElements.includes(t)}_createReplacementDomElement(e,t){const i=this._domDocument.createElement("span");if(i.setAttribute(UNSAFE_ELEMENT_REPLACEMENT_ATTRIBUTE,e),t){for(;t.firstChild;)i.appendChild(t.firstChild);for(const r of t.getAttributeNames())i.setAttribute(r,t.getAttribute(r))}return i}};function _hasViewParentOfType(e,t){return e.getAncestors().some(i=>i.is("element")&&t.includes(i.name))}function forEachDomElementAncestor(e,t){let i=e;for(;i;)t(i),i=i.parentElement}function isNbspBlockFiller(e,t){return e.isEqualNode(NBSP_FILLER_REF)&&hasBlockParent(e,t)&&e.parentNode.childNodes.length===1}function hasBlockParent(e,t){const i=e.parentNode;return!!i&&!!i.tagName&&t.includes(i.tagName.toLowerCase())}function _logUnsafeElement(e){e==="script"&&logWarning("domconverter-unsafe-script-element-detected"),e==="style"&&logWarning("domconverter-unsafe-style-element-detected")}function isGeckoRestrictedDomSelection(e){if(!env.isGecko||!e.rangeCount)return!1;const t=e.getRangeAt(0).startContainer;try{Object.prototype.toString.call(t)}catch{return!0}return!1}var Observer=class extends DomEmitterMixin(){view;document;_isEnabled=!1;constructor(e){super(),this.view=e,this.document=e.document}get isEnabled(){return this._isEnabled}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}destroy(){this.disable(),this.stopListening()}checkShouldIgnoreEventFromTarget(e){return e&&e.nodeType===3&&(e=e.parentNode),!e||e.nodeType!==1?!1:e.matches("[data-cke-ignore-events], [data-cke-ignore-events] *")}},DomEventData=class{view;document;domEvent;domTarget;constructor(e,t,i){this.view=e,this.document=e.document,this.domEvent=t,this.domTarget=t.target,assignIn_default(this,i)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}},DomEventObserver=class extends Observer{useCapture=!1;usePassive=!1;observe(e){(typeof this.domEventType=="string"?[this.domEventType]:this.domEventType).forEach(i=>{this.listenTo(e,i,(r,o)=>{this.isEnabled&&!this.checkShouldIgnoreEventFromTarget(o.target)&&this.onDomEvent(o)},{useCapture:this.useCapture,usePassive:this.usePassive})})}stopObserving(e){this.stopListening(e)}fire(e,t,i){this.isEnabled&&this.document.fire(e,new DomEventData(this.view,t,i))}},KeyObserver=class extends DomEventObserver{domEventType=["keydown","keyup"];onDomEvent(e){const t={keyCode:e.keyCode,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,get keystroke(){return getCode(this)}};this.fire(e.type,e,t)}},FakeSelectionObserver=class extends Observer{_fireSelectionChangeDoneDebounced;constructor(e){super(e),this._fireSelectionChangeDoneDebounced=debounce_default(t=>{this.document.fire("selectionChangeDone",t)},200)}observe(){const e=this.document;e.on("arrowKey",(t,i)=>{e.selection.isFake&&this.isEnabled&&i.preventDefault()},{context:"$capture"}),e.on("arrowKey",(t,i)=>{e.selection.isFake&&this.isEnabled&&this._handleSelectionMove(i.keyCode)},{priority:"lowest"})}stopObserving(){}destroy(){super.destroy(),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionMove(e){const t=this.document.selection,i=new Selection$1(t.getRanges(),{backward:t.isBackward,fake:!1});(e==keyCodes.arrowleft||e==keyCodes.arrowup)&&i.setTo(i.getFirstPosition()),(e==keyCodes.arrowright||e==keyCodes.arrowdown)&&i.setTo(i.getLastPosition());const r={oldSelection:t,newSelection:i,domSelection:null};this.document.fire("selectionChange",r),this._fireSelectionChangeDoneDebounced(r)}},MutationObserver$1=class extends Observer{domConverter;_config;_domElements;_mutationObserver;constructor(e){super(e),this._config={childList:!0,characterData:!0,subtree:!0},this.domConverter=e.domConverter,this._domElements=new Set,this._mutationObserver=new window.MutationObserver(this._onMutations.bind(this))}flush(){this._onMutations(this._mutationObserver.takeRecords())}observe(e){this._domElements.add(e),this.isEnabled&&this._mutationObserver.observe(e,this._config)}stopObserving(e){if(this._domElements.delete(e),this.isEnabled){this._mutationObserver.disconnect();for(const t of this._domElements)this._mutationObserver.observe(t,this._config)}}enable(){super.enable();for(const e of this._domElements)this._mutationObserver.observe(e,this._config)}disable(){super.disable(),this._mutationObserver.disconnect()}destroy(){super.destroy(),this._mutationObserver.disconnect()}_onMutations(e){if(e.length===0)return;const t=this.domConverter,i=new Set,r=new Set;for(const a of e){const c=t.mapDomToView(a.target);c&&(c.is("uiElement")||c.is("rawElement")||a.type==="childList"&&!this._isBogusBrMutation(a)&&r.add(c))}for(const a of e){const c=t.mapDomToView(a.target);if(!(c&&(c.is("uiElement")||c.is("rawElement")))&&a.type==="characterData"){const u=t.findCorrespondingViewText(a.target);u&&!r.has(u.parent)?i.add(u):!u&&startsWithFiller(a.target)&&r.add(t.mapDomToView(a.target.parentNode))}}const o=[];for(const a of i)o.push({type:"text",node:a});for(const a of r){const c=t.mapViewToDom(a),u=Array.from(a.getChildren()),h=Array.from(t.domChildrenToView(c,{withChildren:!1}));isEqualWith_default(u,h,sameNodes)||o.push({type:"children",node:a})}o.length&&this.document.fire("mutations",{mutations:o})}_isBogusBrMutation(e){let t=null;return e.nextSibling===null&&e.removedNodes.length===0&&e.addedNodes.length==1&&(t=this.domConverter.domToView(e.addedNodes[0],{withChildren:!1})),t&&t.is("element","br")}};function sameNodes(e,t){if(!Array.isArray(e))return e===t?!0:e.is("$text")&&t.is("$text")?e.data===t.data:!1}var FocusObserver=class extends DomEventObserver{_renderTimeoutId=null;_isFocusChanging=!1;domEventType=["focus","blur"];constructor(e){super(e),this.useCapture=!0;const t=this.document;t.on("focus",()=>this._handleFocus()),t.on("blur",(i,r)=>this._handleBlur(r)),t.on("beforeinput",()=>{t.isFocused||this._handleFocus()},{priority:"highest"})}flush(){this._isFocusChanging&&(this._isFocusChanging=!1,this.document.isFocused=!0)}onDomEvent(e){this.fire(e.type,e)}destroy(){this._clearTimeout(),super.destroy()}_handleFocus(){this._clearTimeout(),this._isFocusChanging=!0,this._renderTimeoutId=setTimeout(()=>{this._renderTimeoutId=null,this.flush(),this.view.change(()=>{})},50)}_handleBlur(e){const t=this.document.selection.editableElement;(t===null||t===e.target)&&(this.document.isFocused=!1,this._isFocusChanging=!1,this.view.change(()=>{}))}_clearTimeout(){this._renderTimeoutId&&(clearTimeout(this._renderTimeoutId),this._renderTimeoutId=null)}},SelectionObserver=class extends Observer{mutationObserver;focusObserver;selection;domConverter;_documents;_fireSelectionChangeDoneDebounced;_clearInfiniteLoopInterval;_documentIsSelectingInactivityTimeoutDebounced;_loopbackCounter;constructor(e){super(e),this.mutationObserver=e.getObserver(MutationObserver$1),this.focusObserver=e.getObserver(FocusObserver),this.selection=this.document.selection,this.domConverter=e.domConverter,this._documents=new WeakSet,this._fireSelectionChangeDoneDebounced=debounce_default(t=>{this.document.fire("selectionChangeDone",t)},200),this._clearInfiniteLoopInterval=setInterval(()=>this._clearInfiniteLoop(),1e3),this._documentIsSelectingInactivityTimeoutDebounced=debounce_default(()=>this.document.isSelecting=!1,5e3),this._loopbackCounter=0}observe(e){const t=e.ownerDocument,i=()=>{this.document.isSelecting=!0,this._documentIsSelectingInactivityTimeoutDebounced()},r=()=>{this.document.isSelecting&&(this._handleSelectionChange(t),this.document.isSelecting=!1,this._documentIsSelectingInactivityTimeoutDebounced.cancel())};this.listenTo(e,"selectstart",i,{priority:"highest"}),this.listenTo(e,"keydown",r,{priority:"highest",useCapture:!0}),this.listenTo(e,"keyup",r,{priority:"highest",useCapture:!0}),!this._documents.has(t)&&(this.listenTo(t,"mouseup",r,{priority:"highest",useCapture:!0}),this.listenTo(t,"selectionchange",()=>{this.document.isComposing&&!env.isAndroid||(this._handleSelectionChange(t),this._documentIsSelectingInactivityTimeoutDebounced())}),this.listenTo(this.view.document,"compositionstart",()=>{this._handleSelectionChange(t)},{priority:"lowest"}),this._documents.add(t))}stopObserving(e){this.stopListening(e)}destroy(){super.destroy(),clearInterval(this._clearInfiniteLoopInterval),this._fireSelectionChangeDoneDebounced.cancel(),this._documentIsSelectingInactivityTimeoutDebounced.cancel()}_reportInfiniteLoop(){}_handleSelectionChange(e){if(!this.isEnabled)return;const t=e.defaultView.getSelection();if(this.checkShouldIgnoreEventFromTarget(t.anchorNode))return;this.mutationObserver.flush();const i=this.domConverter.domSelectionToView(t);if(i.rangeCount==0){this.view.hasDomSelection=!1;return}if(this.view.hasDomSelection=!0,this.focusObserver.flush(),!(this.selection.isEqual(i)&&this.domConverter.isDomSelectionCorrect(t))){if(++this._loopbackCounter>60){this._reportInfiniteLoop();return}if(this.selection.isSimilar(i))this.view.forceRender();else{const r={oldSelection:this.selection,newSelection:i,domSelection:t};this.document.fire("selectionChange",r),this._fireSelectionChangeDoneDebounced(r)}}}_clearInfiniteLoop(){this._loopbackCounter=0}},CompositionObserver=class extends DomEventObserver{domEventType=["compositionstart","compositionupdate","compositionend"];constructor(e){super(e);const t=this.document;t.on("compositionstart",()=>{t.isComposing=!0},{priority:"low"}),t.on("compositionend",()=>{t.isComposing=!1},{priority:"low"})}onDomEvent(e){this.fire(e.type,e,{data:e.data})}},DataTransfer=class{_files;_native;constructor(e,t={}){this._files=t.cacheFiles?getFiles(e):null,this._native=e}get files(){return this._files||(this._files=getFiles(this._native)),this._files}get types(){return this._native.types}getData(e){return this._native.getData(e)}setData(e,t){this._native.setData(e,t)}set effectAllowed(e){this._native.effectAllowed=e}get effectAllowed(){return this._native.effectAllowed}set dropEffect(e){this._native.dropEffect=e}get dropEffect(){return this._native.dropEffect}setDragImage(e,t,i){this._native.setDragImage(e,t,i)}get isCanceled(){return this._native.dropEffect=="none"||!!this._native.mozUserCancelled}};function getFiles(e){const t=Array.from(e.files||[]),i=Array.from(e.items||[]);return t.length?t:i.filter(r=>r.kind==="file").map(r=>r.getAsFile())}var InputObserver=class extends DomEventObserver{domEventType="beforeinput";onDomEvent(e){const t=e.getTargetRanges(),i=this.view,r=i.document;let o=null,a=null,c=[];if(e.dataTransfer&&(o=new DataTransfer(e.dataTransfer)),e.data!==null?a=e.data:o&&(a=o.getData("text/plain")),r.selection.isFake)c=Array.from(r.selection.getRanges());else if(t.length)c=t.map(u=>{const h=i.domConverter.domPositionToView(u.startContainer,u.startOffset),d=i.domConverter.domPositionToView(u.endContainer,u.endOffset);if(h)return i.createRange(h,d);if(d)return i.createRange(d)}).filter(u=>!!u);else if(env.isAndroid){const u=e.target.ownerDocument.defaultView.getSelection();c=Array.from(i.domConverter.domSelectionToView(u).getRanges())}if(env.isAndroid&&e.inputType=="insertCompositionText"&&a&&a.endsWith(`
`)){this.fire(e.type,e,{inputType:"insertParagraph",targetRanges:[i.createRange(c[0].end)]});return}if(e.inputType=="insertText"&&a&&a.includes(`
`)){const u=a.split(/\n{1,2}/g);let h=c;for(let d=0;d<u.length;d++){const f=u[d];f!=""&&(this.fire(e.type,e,{data:f,dataTransfer:o,targetRanges:h,inputType:e.inputType,isComposing:e.isComposing}),h=[r.selection.getFirstRange()]),d+1<u.length&&(this.fire(e.type,e,{inputType:"insertParagraph",targetRanges:h}),h=[r.selection.getFirstRange()])}return}this.fire(e.type,e,{data:a,dataTransfer:o,targetRanges:c,inputType:e.inputType,isComposing:e.isComposing})}},ArrowKeysObserver=class extends Observer{constructor(e){super(e),this.document.on("keydown",(t,i)=>{if(this.isEnabled&&isArrowKeyCode(i.keyCode)){const r=new BubblingEventInfo(this.document,"arrowKey",this.document.selection.getFirstRange());this.document.fire(r,i),r.stop.called&&t.stop()}})}observe(){}stopObserving(){}},TabObserver=class extends Observer{constructor(e){super(e);const t=this.document;t.on("keydown",(i,r)=>{if(!this.isEnabled||r.keyCode!=keyCodes.tab||r.ctrlKey)return;const o=new BubblingEventInfo(t,"tab",t.selection.getFirstRange());t.fire(o,r),o.stop.called&&i.stop()})}observe(){}stopObserving(){}},View$1=class extends ObservableMixin(){document;domConverter;domRoots=new Map;_renderer;_initialDomRootAttributes=new WeakMap;_observers=new Map;_writer;_ongoingChange=!1;_postFixersInProgress=!1;_renderingDisabled=!1;_hasChangedSinceTheLastRendering=!1;constructor(e){super(),this.document=new Document$1(e),this.domConverter=new DomConverter(this.document),this.set("isRenderingInProgress",!1),this.set("hasDomSelection",!1),this._renderer=new Renderer$1(this.domConverter,this.document.selection),this._renderer.bind("isFocused","isSelecting","isComposing").to(this.document,"isFocused","isSelecting","isComposing"),this._writer=new DowncastWriter(this.document),this.addObserver(MutationObserver$1),this.addObserver(FocusObserver),this.addObserver(SelectionObserver),this.addObserver(KeyObserver),this.addObserver(FakeSelectionObserver),this.addObserver(CompositionObserver),this.addObserver(ArrowKeysObserver),this.addObserver(InputObserver),this.addObserver(TabObserver),injectQuirksHandling(this),injectUiElementHandling(this),this.on("render",()=>{this._render(),this.document.fire("layoutChanged"),this._hasChangedSinceTheLastRendering=!1}),this.listenTo(this.document.selection,"change",()=>{this._hasChangedSinceTheLastRendering=!0}),this.listenTo(this.document,"change:isFocused",()=>{this._hasChangedSinceTheLastRendering=!0}),env.isiOS&&this.listenTo(this.document,"blur",(t,i)=>{this.domConverter.mapDomToView(i.domEvent.relatedTarget)||this.domConverter._clearDomSelection()}),this.listenTo(this.document,"mutations",(t,{mutations:i})=>{i.forEach(r=>this._renderer.markToSync(r.type,r.node))},{priority:"low"}),this.listenTo(this.document,"mutations",()=>{this.forceRender()},{priority:"lowest"})}attachDomRoot(e,t="main"){const i=this.document.getRoot(t);i._name=e.tagName.toLowerCase();const r={};for(const{name:a,value:c}of Array.from(e.attributes))r[a]=c,a==="class"?this._writer.addClass(c.split(" "),i):i.hasAttribute(a)||this._writer.setAttribute(a,c,i);this._initialDomRootAttributes.set(e,r);const o=()=>{this._writer.setAttribute("contenteditable",(!i.isReadOnly).toString(),i),i.isReadOnly?this._writer.addClass("ck-read-only",i):this._writer.removeClass("ck-read-only",i)};o(),this.domRoots.set(t,e),this.domConverter.bindElements(e,i),this._renderer.markToSync("children",i),this._renderer.markToSync("attributes",i),this._renderer.domDocuments.add(e.ownerDocument),i.on("change:children",(a,c)=>this._renderer.markToSync("children",c)),i.on("change:attributes",(a,c)=>this._renderer.markToSync("attributes",c)),i.on("change:text",(a,c)=>this._renderer.markToSync("text",c)),i.on("change:isReadOnly",()=>this.change(o)),i.on("change",()=>{this._hasChangedSinceTheLastRendering=!0});for(const a of this._observers.values())a.observe(e,t)}detachDomRoot(e){const t=this.domRoots.get(e);Array.from(t.attributes).forEach(({name:r})=>t.removeAttribute(r));const i=this._initialDomRootAttributes.get(t);for(const r in i)t.setAttribute(r,i[r]);this.domRoots.delete(e),this.domConverter.unbindDomElement(t);for(const r of this._observers.values())r.stopObserving(t)}getDomRoot(e="main"){return this.domRoots.get(e)}addObserver(e){let t=this._observers.get(e);if(t)return t;t=new e(this),this._observers.set(e,t);for(const[i,r]of this.domRoots)t.observe(r,i);return t.enable(),t}getObserver(e){return this._observers.get(e)}disableObservers(){for(const e of this._observers.values())e.disable()}enableObservers(){for(const e of this._observers.values())e.enable()}scrollToTheSelection({alignToTop:e,forceScroll:t,viewportOffset:i=20,ancestorOffset:r=20}={}){const o=this.document.selection.getFirstRange();if(!o)return;const a=cloneDeep_default({alignToTop:e,forceScroll:t,viewportOffset:i,ancestorOffset:r});typeof i=="number"&&(i={top:i,bottom:i,left:i,right:i});const c={target:this.domConverter.viewRangeToDom(o),viewportOffset:i,ancestorOffset:r,alignToTop:e,forceScroll:t};this.fire("scrollToTheSelection",c,a),scrollViewportToShowTarget(c)}focus(){if(!this.document.isFocused){const e=this.document.selection.editableElement;e&&(this.domConverter.focus(e),this.forceRender())}}change(e){if(this.isRenderingInProgress||this._postFixersInProgress)throw new CKEditorError("cannot-change-view-tree",this);try{if(this._ongoingChange)return e(this._writer);this._ongoingChange=!0;const t=e(this._writer);return this._ongoingChange=!1,!this._renderingDisabled&&this._hasChangedSinceTheLastRendering&&(this._postFixersInProgress=!0,this.document._callPostFixers(this._writer),this._postFixersInProgress=!1,this.fire("render")),t}catch(t){/* istanbul ignore next -- @preserve */CKEditorError.rethrowUnexpectedError(t,this)}}forceRender(){this._hasChangedSinceTheLastRendering=!0,this.getObserver(FocusObserver).flush(),this.change(()=>{})}destroy(){for(const e of this._observers.values())e.destroy();this.document.destroy(),this.stopListening()}createPositionAt(e,t){return Position$1._createAt(e,t)}createPositionAfter(e){return Position$1._createAfter(e)}createPositionBefore(e){return Position$1._createBefore(e)}createRange(e,t){return new Range$1(e,t)}createRangeOn(e){return Range$1._createOn(e)}createRangeIn(e){return Range$1._createIn(e)}createSelection(...e){return new Selection$1(...e)}_disableRendering(e){this._renderingDisabled=e,e==!1&&this.change(()=>{})}_render(){this.isRenderingInProgress=!0,this.disableObservers(),this._renderer.render(),this.enableObservers(),this.isRenderingInProgress=!1}},TypeCheckable=class{is(){throw new Error("is() method is abstract")}},TextProxy=class extends TypeCheckable{textNode;data;offsetInText;constructor(e,t,i){if(super(),this.textNode=e,t<0||t>e.offsetSize)throw new CKEditorError("model-textproxy-wrong-offsetintext",this);if(i<0||t+i>e.offsetSize)throw new CKEditorError("model-textproxy-wrong-length",this);this.data=e.data.substring(t,t+i),this.offsetInText=t}get startOffset(){return this.textNode.startOffset!==null?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return this.startOffset!==null?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}getPath(){const e=this.textNode.getPath();return e.length>0&&(e[e.length-1]+=this.offsetInText),e}getAncestors(e={}){const t=[];let i=e.includeSelf?this:this.parent;for(;i;)t[e.parentFirst?"push":"unshift"](i),i=i.parent;return t}hasAttribute(e){return this.textNode.hasAttribute(e)}getAttribute(e){return this.textNode.getAttribute(e)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}};TextProxy.prototype.is=function(e){return e==="$textProxy"||e==="model:$textProxy"||e==="textProxy"||e==="model:textProxy"};var TreeWalker=class{direction;boundaries;singleCharacters;shallow;ignoreElementEnd;_position;_boundaryStartParent;_boundaryEndParent;_visitedParent;constructor(e){if(!e||!e.boundaries&&!e.startPosition)throw new CKEditorError("model-tree-walker-no-start-position",null);const t=e.direction||"forward";if(t!="forward"&&t!="backward")throw new CKEditorError("model-tree-walker-unknown-direction",e,{direction:t});this.direction=t,this.boundaries=e.boundaries||null,e.startPosition?this._position=e.startPosition.clone():this._position=Position._createAt(this.boundaries[this.direction=="backward"?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}get position(){return this._position}skip(e){let t,i,r,o;do r=this.position,o=this._visitedParent,{done:t,value:i}=this.next();while(!t&&e(i));t||(this._position=r,this._visitedParent=o)}next(){return this.direction=="forward"?this._next():this._previous()}_next(){const e=this.position,t=this.position.clone(),i=this._visitedParent;if(i.parent===null&&t.offset===i.maxOffset)return{done:!0,value:void 0};if(i===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0,value:void 0};const r=getTextNodeAtPosition(t,i),o=r||getNodeAfterPosition(t,i,r);if(o&&o.is("model:element")){if(!this.shallow)t.path.push(0),this._visitedParent=o;else{if(this.boundaries&&this.boundaries.end.isBefore(t))return{done:!0,value:void 0};t.offset++}return this._position=t,formatReturnValue("elementStart",o,e,t,1)}if(o&&o.is("model:$text")){let a;if(this.singleCharacters)a=1;else{let h=o.endOffset;this._boundaryEndParent==i&&this.boundaries.end.offset<h&&(h=this.boundaries.end.offset),a=h-t.offset}const c=t.offset-o.startOffset,u=new TextProxy(o,c,a);return t.offset+=a,this._position=t,formatReturnValue("text",u,e,t,a)}return t.path.pop(),t.offset++,this._position=t,this._visitedParent=i.parent,this.ignoreElementEnd?this._next():formatReturnValue("elementEnd",i,e,t)}_previous(){const e=this.position,t=this.position.clone(),i=this._visitedParent;if(i.parent===null&&t.offset===0)return{done:!0,value:void 0};if(i==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0,value:void 0};const r=t.parent,o=getTextNodeAtPosition(t,r),a=o||getNodeBeforePosition(t,r,o);if(a&&a.is("model:element"))return t.offset--,this.shallow?(this._position=t,formatReturnValue("elementStart",a,e,t,1)):(t.path.push(a.maxOffset),this._position=t,this._visitedParent=a,this.ignoreElementEnd?this._previous():formatReturnValue("elementEnd",a,e,t));if(a&&a.is("model:$text")){let c;if(this.singleCharacters)c=1;else{let d=a.startOffset;this._boundaryStartParent==i&&this.boundaries.start.offset>d&&(d=this.boundaries.start.offset),c=t.offset-d}const u=t.offset-a.startOffset,h=new TextProxy(a,u-c,c);return t.offset-=c,this._position=t,formatReturnValue("text",h,e,t,c)}return t.path.pop(),this._position=t,this._visitedParent=i.parent,formatReturnValue("elementStart",i,e,t,1)}};function formatReturnValue(e,t,i,r,o){return{done:!1,value:{type:e,item:t,previousPosition:i,nextPosition:r,length:o}}}var Position=class Vt extends TypeCheckable{root;path;stickiness;constructor(t,i,r="toNone"){if(super(),!t.is("element")&&!t.is("documentFragment"))throw new CKEditorError("model-position-root-invalid",t);if(!Array.isArray(i)||i.length===0)throw new CKEditorError("model-position-path-incorrect-format",t,{path:i});t.is("rootElement")?i=i.slice():(i=[...t.getPath(),...i],t=t.root),this.root=t,this.path=i,this.stickiness=r}get offset(){return this.path[this.path.length-1]}set offset(t){this.path[this.path.length-1]=t}get parent(){let t=this.root;for(let i=0;i<this.path.length-1;i++)if(t=t.getChildAtOffset(this.path[i]),!t)throw new CKEditorError("model-position-path-incorrect",this,{position:this});if(t.is("$text"))throw new CKEditorError("model-position-path-incorrect",this,{position:this});return t}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){return getTextNodeAtPosition(this,this.parent)}get nodeAfter(){const t=this.parent;return getNodeAfterPosition(this,t,getTextNodeAtPosition(this,t))}get nodeBefore(){const t=this.parent;return getNodeBeforePosition(this,t,getTextNodeAtPosition(this,t))}get isAtStart(){return this.offset===0}get isAtEnd(){return this.offset==this.parent.maxOffset}isValid(){if(this.offset<0)return!1;let t=this.root;for(let i=0;i<this.path.length-1;i++)if(t=t.getChildAtOffset(this.path[i]),!t)return!1;return this.offset<=t.maxOffset}compareWith(t){if(this.root!=t.root)return"different";const i=compareArrays(this.path,t.path);switch(i){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[i]<t.path[i]?"before":"after"}}getLastMatchingPosition(t,i={}){i.startPosition=this;const r=new TreeWalker(i);return r.skip(t),r.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){const t=this.parent;return t.is("documentFragment")?[t]:t.getAncestors({includeSelf:!0})}findAncestor(t){const i=this.parent;return i.is("element")?i.findAncestor(t,{includeSelf:!0}):null}getCommonPath(t){if(this.root!=t.root)return[];const i=compareArrays(this.path,t.path),r=typeof i=="string"?Math.min(this.path.length,t.path.length):i;return this.path.slice(0,r)}getCommonAncestor(t){const i=this.getAncestors(),r=t.getAncestors();let o=0;for(;i[o]==r[o]&&i[o];)o++;return o===0?null:i[o-1]}getShiftedBy(t){const i=this.clone(),r=i.offset+t;return i.offset=r<0?0:r,i}isAfter(t){return this.compareWith(t)=="after"}isBefore(t){return this.compareWith(t)=="before"}isEqual(t){return this.compareWith(t)=="same"}isTouching(t){if(this.root!==t.root)return!1;const i=Math.min(this.path.length,t.path.length);for(let r=0;r<i;r++){const o=this.path[r]-t.path[r];if(o<-1||o>1)return!1;if(o===1)return checkTouchingBranch(t,this,r);if(o===-1)return checkTouchingBranch(this,t,r)}return this.path.length===t.path.length?!0:this.path.length>t.path.length?checkOnlyZeroes(this.path,i):checkOnlyZeroes(t.path,i)}hasSameParentAs(t){if(this.root!==t.root)return!1;const i=this.getParentPath(),r=t.getParentPath();return compareArrays(i,r)=="same"}getTransformedByOperation(t){let i;switch(t.type){case"insert":i=this._getTransformedByInsertOperation(t);break;case"move":case"remove":case"reinsert":i=this._getTransformedByMoveOperation(t);break;case"split":i=this._getTransformedBySplitOperation(t);break;case"merge":i=this._getTransformedByMergeOperation(t);break;default:i=Vt._createAt(this);break}return i}_getTransformedByInsertOperation(t){return this._getTransformedByInsertion(t.position,t.howMany)}_getTransformedByMoveOperation(t){return this._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany)}_getTransformedBySplitOperation(t){const i=t.movedRange;return i.containsPosition(this)||i.start.isEqual(this)&&this.stickiness=="toNext"?this._getCombined(t.splitPosition,t.moveTargetPosition):t.graveyardPosition?this._getTransformedByMove(t.graveyardPosition,t.insertionPosition,1):this._getTransformedByInsertion(t.insertionPosition,1)}_getTransformedByMergeOperation(t){const i=t.movedRange,r=i.containsPosition(this)||i.start.isEqual(this);let o;return r?(o=this._getCombined(t.sourcePosition,t.targetPosition),t.sourcePosition.isBefore(t.targetPosition)&&(o=o._getTransformedByDeletion(t.deletionPosition,1))):this.isEqual(t.deletionPosition)?o=Vt._createAt(t.deletionPosition):o=this._getTransformedByMove(t.deletionPosition,t.graveyardPosition,1),o}_getTransformedByDeletion(t,i){const r=Vt._createAt(this);if(this.root!=t.root)return r;if(compareArrays(t.getParentPath(),this.getParentPath())=="same"){if(t.offset<this.offset){if(t.offset+i>this.offset)return null;r.offset-=i}}else if(compareArrays(t.getParentPath(),this.getParentPath())=="prefix"){const o=t.path.length-1;if(t.offset<=this.path[o]){if(t.offset+i>this.path[o])return null;r.path[o]-=i}}return r}_getTransformedByInsertion(t,i){const r=Vt._createAt(this);if(this.root!=t.root)return r;if(compareArrays(t.getParentPath(),this.getParentPath())=="same")(t.offset<this.offset||t.offset==this.offset&&this.stickiness!="toPrevious")&&(r.offset+=i);else if(compareArrays(t.getParentPath(),this.getParentPath())=="prefix"){const o=t.path.length-1;t.offset<=this.path[o]&&(r.path[o]+=i)}return r}_getTransformedByMove(t,i,r){if(i=i._getTransformedByDeletion(t,r),t.isEqual(i))return Vt._createAt(this);const o=this._getTransformedByDeletion(t,r);return o===null||t.isEqual(this)&&this.stickiness=="toNext"||t.getShiftedBy(r).isEqual(this)&&this.stickiness=="toPrevious"?this._getCombined(t,i):o._getTransformedByInsertion(i,r)}_getCombined(t,i){const r=t.path.length-1,o=Vt._createAt(i);return o.stickiness=this.stickiness,o.offset=o.offset+this.path[r]-t.offset,o.path=[...o.path,...this.path.slice(r+1)],o}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(t,i,r="toNone"){if(t.is("model:position"))return new Vt(t.root,t.path,t.stickiness);{const o=t;if(i=="end")i=o.maxOffset;else{if(i=="before")return this._createBefore(o,r);if(i=="after")return this._createAfter(o,r);if(i!==0&&!i)throw new CKEditorError("model-createpositionat-offset-required",[this,t])}if(!o.is("element")&&!o.is("documentFragment"))throw new CKEditorError("model-position-parent-incorrect",[this,t]);const a=o.getPath();return a.push(i),new this(o.root,a,r)}}static _createAfter(t,i){if(!t.parent)throw new CKEditorError("model-position-after-root",[this,t],{root:t});return this._createAt(t.parent,t.endOffset,i)}static _createBefore(t,i){if(!t.parent)throw new CKEditorError("model-position-before-root",t,{root:t});return this._createAt(t.parent,t.startOffset,i)}static fromJSON(t,i){if(t.root==="$graveyard"){const r=new Vt(i.graveyard,t.path);return r.stickiness=t.stickiness,r}if(!i.getRoot(t.root))throw new CKEditorError("model-position-fromjson-no-root",i,{rootName:t.root});return new Vt(i.getRoot(t.root),t.path,t.stickiness)}};Position.prototype.is=function(e){return e==="position"||e==="model:position"};function getTextNodeAtPosition(e,t){const i=t.getChildAtOffset(e.offset);return i&&i.is("$text")&&i.startOffset<e.offset?i:null}function getNodeAfterPosition(e,t,i){return i!==null?null:t.getChildAtOffset(e.offset)}function getNodeBeforePosition(e,t,i){return i!==null?null:t.getChild(t.offsetToIndex(e.offset)-1)}function checkTouchingBranch(e,t,i){return!(i+1===e.path.length||!checkOnlyZeroes(t.path,i+1)||!checkOnlyMaxOffset(e,i+1))}function checkOnlyZeroes(e,t){for(;t<e.length;){if(e[t]!==0)return!1;t++}return!0}function checkOnlyMaxOffset(e,t){let i=e.parent,r=e.path.length-1,o=0;for(;r>=t;){if(e.path[r]+o!==i.maxOffset)return!1;o=1,r--,i=i.parent}return!0}var Range=class at extends TypeCheckable{start;end;constructor(t,i){super(),this.start=Position._createAt(t),this.end=i?Position._createAt(i):Position._createAt(t),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new TreeWalker({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){const t=this.start.getParentPath(),i=this.end.getParentPath();return compareArrays(t,i)=="same"}get root(){return this.start.root}containsPosition(t){return t.isAfter(this.start)&&t.isBefore(this.end)}containsRange(t,i=!1){t.isCollapsed&&(i=!1);const r=this.containsPosition(t.start)||i&&this.start.isEqual(t.start),o=this.containsPosition(t.end)||i&&this.end.isEqual(t.end);return r&&o}containsItem(t){const i=Position._createBefore(t);return this.containsPosition(i)||this.start.isEqual(i)}isEqual(t){return this.start.isEqual(t.start)&&this.end.isEqual(t.end)}isIntersecting(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}getDifference(t){const i=[];return this.isIntersecting(t)?(this.containsPosition(t.start)&&i.push(new at(this.start,t.start)),this.containsPosition(t.end)&&i.push(new at(t.end,this.end))):i.push(new at(this.start,this.end)),i}getIntersection(t){if(this.isIntersecting(t)){let i=this.start,r=this.end;return this.containsPosition(t.start)&&(i=t.start),this.containsPosition(t.end)&&(r=t.end),new at(i,r)}return null}getJoined(t,i=!1){let r=this.isIntersecting(t);if(r||(this.start.isBefore(t.start)?r=i?this.end.isTouching(t.start):this.end.isEqual(t.start):r=i?t.end.isTouching(this.start):t.end.isEqual(this.start)),!r)return null;let o=this.start,a=this.end;return t.start.isBefore(o)&&(o=t.start),t.end.isAfter(a)&&(a=t.end),new at(o,a)}getMinimalFlatRanges(){const t=[],i=this.start.getCommonPath(this.end).length,r=Position._createAt(this.start);let o=r.parent;for(;r.path.length>i+1;){const a=o.maxOffset-r.offset;a!==0&&t.push(new at(r,r.getShiftedBy(a))),r.path=r.path.slice(0,-1),r.offset++,o=o.parent}for(;r.path.length<=this.end.path.length;){const a=this.end.path[r.path.length-1],c=a-r.offset;c!==0&&t.push(new at(r,r.getShiftedBy(c))),r.offset=a,r.path.push(0)}return t}getWalker(t={}){return t.boundaries=this,new TreeWalker(t)}*getItems(t={}){t.boundaries=this,t.ignoreElementEnd=!0;const i=new TreeWalker(t);for(const r of i)yield r.item}*getPositions(t={}){t.boundaries=this;const i=new TreeWalker(t);yield i.position;for(const r of i)yield r.nextPosition}getTransformedByOperation(t){switch(t.type){case"insert":return this._getTransformedByInsertOperation(t);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(t);case"split":return[this._getTransformedBySplitOperation(t)];case"merge":return[this._getTransformedByMergeOperation(t)]}return[new at(this.start,this.end)]}getTransformedByOperations(t){const i=[new at(this.start,this.end)];for(const r of t)for(let o=0;o<i.length;o++){const a=i[o].getTransformedByOperation(r);i.splice(o,1,...a),o+=a.length-1}for(let r=0;r<i.length;r++){const o=i[r];for(let a=r+1;a<i.length;a++){const c=i[a];(o.containsRange(c)||c.containsRange(o)||o.isEqual(c))&&i.splice(a,1)}}return i}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;const t=this.start.nodeAfter,i=this.end.nodeBefore;return t&&t.is("element")&&t===i?t:null}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(t,i=!1){return this._getTransformedByInsertion(t.position,t.howMany,i)}_getTransformedByMoveOperation(t,i=!1){const r=t.sourcePosition,o=t.howMany,a=t.targetPosition;return this._getTransformedByMove(r,a,o,i)}_getTransformedBySplitOperation(t){const i=this.start._getTransformedBySplitOperation(t);let r=this.end._getTransformedBySplitOperation(t);return this.end.isEqual(t.insertionPosition)&&(r=this.end.getShiftedBy(1)),i.root!=r.root&&(r=this.end.getShiftedBy(-1)),new at(i,r)}_getTransformedByMergeOperation(t){if(this.start.isEqual(t.targetPosition)&&this.end.isEqual(t.deletionPosition))return new at(this.start);let i=this.start._getTransformedByMergeOperation(t),r=this.end._getTransformedByMergeOperation(t);return i.root!=r.root&&(r=this.end.getShiftedBy(-1)),i.isAfter(r)?(t.sourcePosition.isBefore(t.targetPosition)?(i=Position._createAt(r),i.offset=0):(t.deletionPosition.isEqual(i)||(r=t.deletionPosition),i=t.targetPosition),new at(i,r)):new at(i,r)}_getTransformedByInsertion(t,i,r=!1){if(r&&this.containsPosition(t))return[new at(this.start,t),new at(t.getShiftedBy(i),this.end._getTransformedByInsertion(t,i))];{const o=new at(this.start,this.end);return o.start=o.start._getTransformedByInsertion(t,i),o.end=o.end._getTransformedByInsertion(t,i),[o]}}_getTransformedByMove(t,i,r,o=!1){if(this.isCollapsed){const m=this.start._getTransformedByMove(t,i,r);return[new at(m)]}const a=at._createFromPositionAndShift(t,r),c=i._getTransformedByDeletion(t,r);if(this.containsPosition(i)&&!o&&(a.containsPosition(this.start)||a.containsPosition(this.end))){const m=this.start._getTransformedByMove(t,i,r),g=this.end._getTransformedByMove(t,i,r);return[new at(m,g)]}let u;const h=this.getDifference(a);let d=null;const f=this.getIntersection(a);if(h.length==1?d=new at(h[0].start._getTransformedByDeletion(t,r),h[0].end._getTransformedByDeletion(t,r)):h.length==2&&(d=new at(this.start,this.end._getTransformedByDeletion(t,r))),d?u=d._getTransformedByInsertion(c,r,f!==null||o):u=[],f){const m=new at(f.start._getCombined(a.start,c),f.end._getCombined(a.start,c));u.length==2?u.splice(1,0,m):u.push(m)}return u}_getTransformedByDeletion(t,i){let r=this.start._getTransformedByDeletion(t,i),o=this.end._getTransformedByDeletion(t,i);return r==null&&o==null?null:(r==null&&(r=t),o==null&&(o=t),new at(r,o))}static _createFromPositionAndShift(t,i){const r=t,o=t.getShiftedBy(i);return i>0?new this(r,o):new this(o,r)}static _createIn(t){return new this(Position._createAt(t,0),Position._createAt(t,t.maxOffset))}static _createOn(t){return this._createFromPositionAndShift(Position._createBefore(t),t.offsetSize)}static _createFromRanges(t){if(t.length===0)throw new CKEditorError("range-create-from-ranges-empty-array",null);if(t.length==1)return t[0].clone();const i=t[0];t.sort((a,c)=>a.start.isAfter(c.start)?1:-1);const r=t.indexOf(i),o=new this(i.start,i.end);for(let a=r-1;a>=0&&t[a].end.isEqual(o.start);a--)o.start=Position._createAt(t[a].start);for(let a=r+1;a<t.length&&t[a].start.isEqual(o.end);a++)o.end=Position._createAt(t[a].end);return o}static fromJSON(t,i){return new this(Position.fromJSON(t.start,i),Position.fromJSON(t.end,i))}};Range.prototype.is=function(e){return e==="range"||e==="model:range"};var Mapper=class extends EmitterMixin(){_modelToViewMapping=new WeakMap;_viewToModelMapping=new WeakMap;_viewToModelLengthCallbacks=new Map;_markerNameToElements=new Map;_elementToMarkerNames=new Map;_deferredBindingRemovals=new Map;_unboundMarkerNames=new Set;constructor(){super(),this.on("modelToViewPosition",(e,t)=>{if(t.viewPosition)return;const i=this._modelToViewMapping.get(t.modelPosition.parent);if(!i)throw new CKEditorError("mapping-model-position-view-parent-not-found",this,{modelPosition:t.modelPosition});t.viewPosition=this.findPositionIn(i,t.modelPosition.offset)},{priority:"low"}),this.on("viewToModelPosition",(e,t)=>{if(t.modelPosition)return;const i=this.findMappedViewAncestor(t.viewPosition),r=this._viewToModelMapping.get(i),o=this._toModelOffset(t.viewPosition.parent,t.viewPosition.offset,i);t.modelPosition=Position._createAt(r,o)},{priority:"low"})}bindElements(e,t){this._modelToViewMapping.set(e,t),this._viewToModelMapping.set(t,e)}unbindViewElement(e,t={}){const i=this.toModelElement(e);if(this._elementToMarkerNames.has(e))for(const r of this._elementToMarkerNames.get(e))this._unboundMarkerNames.add(r);t.defer?this._deferredBindingRemovals.set(e,e.root):(this._viewToModelMapping.delete(e),this._modelToViewMapping.get(i)==e&&this._modelToViewMapping.delete(i))}unbindModelElement(e){const t=this.toViewElement(e);this._modelToViewMapping.delete(e),this._viewToModelMapping.get(t)==e&&this._viewToModelMapping.delete(t)}bindElementToMarker(e,t){const i=this._markerNameToElements.get(t)||new Set;i.add(e);const r=this._elementToMarkerNames.get(e)||new Set;r.add(t),this._markerNameToElements.set(t,i),this._elementToMarkerNames.set(e,r)}unbindElementFromMarkerName(e,t){const i=this._markerNameToElements.get(t);i&&(i.delete(e),i.size==0&&this._markerNameToElements.delete(t));const r=this._elementToMarkerNames.get(e);r&&(r.delete(t),r.size==0&&this._elementToMarkerNames.delete(e))}flushUnboundMarkerNames(){const e=Array.from(this._unboundMarkerNames);return this._unboundMarkerNames.clear(),e}flushDeferredBindings(){for(const[e,t]of this._deferredBindingRemovals)e.root==t&&this.unbindViewElement(e);this._deferredBindingRemovals=new Map}clearBindings(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set,this._deferredBindingRemovals=new Map}toModelElement(e){return this._viewToModelMapping.get(e)}toViewElement(e){return this._modelToViewMapping.get(e)}toModelRange(e){return new Range(this.toModelPosition(e.start),this.toModelPosition(e.end))}toViewRange(e){return new Range$1(this.toViewPosition(e.start),this.toViewPosition(e.end))}toModelPosition(e){const t={viewPosition:e,mapper:this};return this.fire("viewToModelPosition",t),t.modelPosition}toViewPosition(e,t={}){const i={modelPosition:e,mapper:this,isPhantom:t.isPhantom};return this.fire("modelToViewPosition",i),i.viewPosition}markerNameToElements(e){const t=this._markerNameToElements.get(e);if(!t)return null;const i=new Set;for(const r of t)if(r.is("attributeElement"))for(const o of r.getElementsWithSameId())i.add(o);else i.add(r);return i}registerViewToModelLength(e,t){this._viewToModelLengthCallbacks.set(e,t)}findMappedViewAncestor(e){let t=e.parent;for(;!this._viewToModelMapping.has(t);)t=t.parent;return t}_toModelOffset(e,t,i){if(i!=e){const o=this._toModelOffset(e.parent,e.index,i),a=this._toModelOffset(e,t,e);return o+a}if(e.is("$text"))return t;let r=0;for(let o=0;o<t;o++)r+=this.getModelLength(e.getChild(o));return r}getModelLength(e){const t=[e];let i=0;for(;t.length>0;){const r=t.pop(),o=r.name&&this._viewToModelLengthCallbacks.size>0&&this._viewToModelLengthCallbacks.get(r.name);if(o)i+=o(r);else if(this._viewToModelMapping.has(r))i+=1;else if(r.is("$text"))i+=r.data.length;else{if(r.is("uiElement"))continue;for(const a of r.getChildren())t.push(a)}}return i}findPositionIn(e,t){let i,r=0,o=0,a=0;if(e.is("$text"))return new Position$1(e,t);for(;o<t;)i=e.getChild(a),r=this.getModelLength(i),o+=r,a++;return o==t?this._moveViewPositionToTextNode(new Position$1(e,a)):this.findPositionIn(i,t-(o-r))}_moveViewPositionToTextNode(e){const t=e.nodeBefore,i=e.nodeAfter;return t&&t.is("view:$text")?new Position$1(t,t.data.length):i&&i.is("view:$text")?new Position$1(i,0):e}},ModelConsumable=class{_consumable=new Map;_textProxyRegistry=new Map;add(e,t){t=_normalizeConsumableType(t),e instanceof TextProxy&&(e=this._getSymbolForTextProxy(e)),this._consumable.has(e)||this._consumable.set(e,new Map),this._consumable.get(e).set(t,!0)}consume(e,t){return t=_normalizeConsumableType(t),e instanceof TextProxy&&(e=this._getSymbolForTextProxy(e)),this.test(e,t)?(this._consumable.get(e).set(t,!1),!0):!1}test(e,t){t=_normalizeConsumableType(t),e instanceof TextProxy&&(e=this._getSymbolForTextProxy(e));const i=this._consumable.get(e);if(i===void 0)return null;const r=i.get(t);return r===void 0?null:r}revert(e,t){t=_normalizeConsumableType(t),e instanceof TextProxy&&(e=this._getSymbolForTextProxy(e));const i=this.test(e,t);return i===!1?(this._consumable.get(e).set(t,!0),!0):i===!0?!1:null}verifyAllConsumed(e){const t=[];for(const[i,r]of this._consumable)for(const[o,a]of r){const c=o.split(":")[0];a&&e==c&&t.push({event:o,item:i.name||i.description})}if(t.length)throw new CKEditorError("conversion-model-consumable-not-consumed",null,{items:t})}_getSymbolForTextProxy(e){let t=null;const i=this._textProxyRegistry.get(e.startOffset);if(i){const r=i.get(e.endOffset);r&&(t=r.get(e.parent))}return t||(t=this._addSymbolForTextProxy(e)),t}_addSymbolForTextProxy(e){const t=e.startOffset,i=e.endOffset,r=e.parent,o=Symbol("$textProxy:"+e.data);let a,c;return a=this._textProxyRegistry.get(t),a||(a=new Map,this._textProxyRegistry.set(t,a)),c=a.get(i),c||(c=new Map,a.set(i,c)),c.set(r,o),o}};function _normalizeConsumableType(e){const t=e.split(":");return t[0]=="insert"?t[0]:t[0]=="addMarker"||t[0]=="removeMarker"?e:t.length>1?t[0]+":"+t[1]:t[0]}var DowncastDispatcher=class extends EmitterMixin(){_conversionApi;_firedEventsMap;constructor(e){super(),this._conversionApi={dispatcher:this,...e},this._firedEventsMap=new WeakMap}convertChanges(e,t,i){const r=this._createConversionApi(i,e.getRefreshedItems());for(const a of e.getMarkersToRemove())this._convertMarkerRemove(a.name,a.range,r);const o=this._reduceChanges(e.getChanges());for(const a of o)a.type==="insert"?this._convertInsert(Range._createFromPositionAndShift(a.position,a.length),r):a.type==="reinsert"?this._convertReinsert(Range._createFromPositionAndShift(a.position,a.length),r):a.type==="remove"?this._convertRemove(a.position,a.length,a.name,r):this._convertAttribute(a.range,a.attributeKey,a.attributeOldValue,a.attributeNewValue,r);r.mapper.flushDeferredBindings();for(const a of r.mapper.flushUnboundMarkerNames()){const c=t.get(a).getRange();this._convertMarkerRemove(a,c,r),this._convertMarkerAdd(a,c,r)}for(const a of e.getMarkersToAdd())this._convertMarkerAdd(a.name,a.range,r);r.consumable.verifyAllConsumed("insert")}convert(e,t,i,r={}){const o=this._createConversionApi(i,void 0,r);this._convertInsert(e,o);for(const[a,c]of t)this._convertMarkerAdd(a,c,o);o.consumable.verifyAllConsumed("insert")}convertSelection(e,t,i){const r=this._createConversionApi(i);this.fire("cleanSelection",{selection:e},r);const o=e.getFirstPosition().root;if(!r.mapper.toViewElement(o))return;const a=Array.from(t.getMarkersAtPosition(e.getFirstPosition()));if(this._addConsumablesForSelection(r.consumable,e,a),this.fire("selection",{selection:e},r),!!e.isCollapsed){for(const c of a)if(r.consumable.test(e,"addMarker:"+c.name)){const u=c.getRange();if(!shouldMarkerChangeBeConverted(e.getFirstPosition(),c,r.mapper))continue;const h={item:e,markerName:c.name,markerRange:u};this.fire(`addMarker:${c.name}`,h,r)}for(const c of e.getAttributeKeys())if(r.consumable.test(e,"attribute:"+c)){const u={item:e,range:e.getFirstRange(),attributeKey:c,attributeOldValue:null,attributeNewValue:e.getAttribute(c)};this.fire(`attribute:${c}:$text`,u,r)}}}_convertInsert(e,t,i={}){i.doNotAddConsumables||this._addConsumablesForInsert(t.consumable,e);for(const r of e.getWalker({shallow:!0}))this._testAndFire("insert",walkerValueToEventData(r),t)}_convertRemove(e,t,i,r){this.fire(`remove:${i}`,{position:e,length:t},r)}_convertAttribute(e,t,i,r,o){this._addConsumablesForRange(o.consumable,e,`attribute:${t}`);for(const a of e){const c={item:a.item,range:Range._createFromPositionAndShift(a.previousPosition,a.length),attributeKey:t,attributeOldValue:i,attributeNewValue:r};this._testAndFire(`attribute:${t}`,c,o)}}_convertReinsert(e,t){const i=Array.from(e.getWalker({shallow:!0}));this._addConsumablesForInsert(t.consumable,i);for(const r of i.map(walkerValueToEventData))this._testAndFire("insert",{...r,reconversion:!0},t)}_convertMarkerAdd(e,t,i){if(t.root.rootName=="$graveyard")return;const r=`addMarker:${e}`;if(i.consumable.add(t,r),this.fire(r,{markerName:e,markerRange:t},i),!!i.consumable.consume(t,r)){this._addConsumablesForRange(i.consumable,t,r);for(const o of t.getItems()){if(!i.consumable.test(o,r))continue;const a={item:o,range:Range._createOn(o),markerName:e,markerRange:t};this.fire(r,a,i)}}}_convertMarkerRemove(e,t,i){t.root.rootName!="$graveyard"&&this.fire(`removeMarker:${e}`,{markerName:e,markerRange:t},i)}_reduceChanges(e){const t={changes:e};return this.fire("reduceChanges",t),t.changes}_addConsumablesForInsert(e,t){for(const i of t){const r=i.item;if(e.test(r,"insert")===null){e.add(r,"insert");for(const o of r.getAttributeKeys())e.add(r,"attribute:"+o)}}return e}_addConsumablesForRange(e,t,i){for(const r of t.getItems())e.add(r,i);return e}_addConsumablesForSelection(e,t,i){e.add(t,"selection");for(const r of i)e.add(t,"addMarker:"+r.name);for(const r of t.getAttributeKeys())e.add(t,"attribute:"+r);return e}_testAndFire(e,t,i){const r=getEventName(e,t),o=t.item.is("$textProxy")?i.consumable._getSymbolForTextProxy(t.item):t.item,a=this._firedEventsMap.get(i),c=a.get(o);if(!c)a.set(o,new Set([r]));else if(!c.has(r))c.add(r);else return;this.fire(r,t,i)}_testAndFireAddAttributes(e,t){const i={item:e,range:Range._createOn(e)};for(const r of i.item.getAttributeKeys())i.attributeKey=r,i.attributeOldValue=null,i.attributeNewValue=i.item.getAttribute(r),this._testAndFire(`attribute:${r}`,i,t)}_createConversionApi(e,t=new Set,i={}){const r={...this._conversionApi,consumable:new ModelConsumable,writer:e,options:i,convertItem:o=>this._convertInsert(Range._createOn(o),r),convertChildren:o=>this._convertInsert(Range._createIn(o),r,{doNotAddConsumables:!0}),convertAttributes:o=>this._testAndFireAddAttributes(o,r),canReuseView:o=>!t.has(r.mapper.toModelElement(o))};return this._firedEventsMap.set(r,new Map),r}};function shouldMarkerChangeBeConverted(e,t,i){const r=t.getRange(),o=Array.from(e.getAncestors());return o.shift(),o.reverse(),!o.some(c=>{if(r.containsItem(c))return!!i.toViewElement(c).getCustomProperty("addHighlight")})}function getEventName(e,t){const i=t.item.is("element")?t.item.name:"$text";return`${e}:${i}`}function walkerValueToEventData(e){return{item:e.item,range:Range._createFromPositionAndShift(e.previousPosition,e.length)}}let Node$1$1=class extends TypeCheckable{parent=null;_attrs;_index=null;_startOffset=null;constructor(t){super(),this._attrs=toMap(t)}get document(){return null}get index(){return this._index}get startOffset(){return this._startOffset}get offsetSize(){return 1}get endOffset(){return this.startOffset===null?null:this.startOffset+this.offsetSize}get nextSibling(){const t=this.index;return t!==null&&this.parent.getChild(t+1)||null}get previousSibling(){const t=this.index;return t!==null&&this.parent.getChild(t-1)||null}get root(){let t=this;for(;t.parent;)t=t.parent;return t}isAttached(){return this.parent===null?!1:this.root.isAttached()}getPath(){const t=[];let i=this;for(;i.parent;)t.unshift(i.startOffset),i=i.parent;return t}getAncestors(t={}){const i=[];let r=t.includeSelf?this:this.parent;for(;r;)i[t.parentFirst?"push":"unshift"](r),r=r.parent;return i}getCommonAncestor(t,i={}){const r=this.getAncestors(i),o=t.getAncestors(i);let a=0;for(;r[a]==o[a]&&r[a];)a++;return a===0?null:r[a-1]}isBefore(t){if(this==t||this.root!==t.root)return!1;const i=this.getPath(),r=t.getPath(),o=compareArrays(i,r);switch(o){case"prefix":return!0;case"extension":return!1;default:return i[o]<r[o]}}isAfter(t){return this==t||this.root!==t.root?!1:!this.isBefore(t)}hasAttribute(t){return this._attrs.has(t)}getAttribute(t){return this._attrs.get(t)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const t={};return this._attrs.size&&(t.attributes=Array.from(this._attrs).reduce((i,r)=>(i[r[0]]=r[1],i),{})),t}_clone(t){return new this.constructor(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(t,i){this._attrs.set(t,i)}_setAttributesTo(t){this._attrs=toMap(t)}_removeAttribute(t){return this._attrs.delete(t)}_clearAttributes(){this._attrs.clear()}};Node$1$1.prototype.is=function(e){return e==="node"||e==="model:node"};var Selection=class ws extends EmitterMixin(TypeCheckable){_lastRangeBackward=!1;_attrs=new Map;_ranges=[];constructor(...t){super(),t.length&&this.setTo(...t)}get anchor(){if(this._ranges.length>0){const t=this._ranges[this._ranges.length-1];return this._lastRangeBackward?t.end:t.start}return null}get focus(){if(this._ranges.length>0){const t=this._ranges[this._ranges.length-1];return this._lastRangeBackward?t.start:t.end}return null}get isCollapsed(){return this._ranges.length===1?this._ranges[0].isCollapsed:!1}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}isEqual(t){if(this.rangeCount!=t.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(t.anchor)||!this.focus.isEqual(t.focus))return!1;for(const i of this._ranges){let r=!1;for(const o of t._ranges)if(i.isEqual(o)){r=!0;break}if(!r)return!1}return!0}*getRanges(){for(const t of this._ranges)yield new Range(t.start,t.end)}getFirstRange(){let t=null;for(const i of this._ranges)(!t||i.start.isBefore(t.start))&&(t=i);return t?new Range(t.start,t.end):null}getLastRange(){let t=null;for(const i of this._ranges)(!t||i.end.isAfter(t.end))&&(t=i);return t?new Range(t.start,t.end):null}getFirstPosition(){const t=this.getFirstRange();return t?t.start.clone():null}getLastPosition(){const t=this.getLastRange();return t?t.end.clone():null}setTo(...t){let[i,r,o]=t;if(typeof r=="object"&&(o=r,r=void 0),i===null)this._setRanges([]);else if(i instanceof ws)this._setRanges(i.getRanges(),i.isBackward);else if(i&&typeof i.getRanges=="function")this._setRanges(i.getRanges(),i.isBackward);else if(i instanceof Range)this._setRanges([i],!!o&&!!o.backward);else if(i instanceof Position)this._setRanges([new Range(i)]);else if(i instanceof Node$1$1){const a=!!o&&!!o.backward;let c;if(r=="in")c=Range._createIn(i);else if(r=="on")c=Range._createOn(i);else if(r!==void 0)c=new Range(Position._createAt(i,r));else throw new CKEditorError("model-selection-setto-required-second-parameter",[this,i]);this._setRanges([c],a)}else if(isIterable(i))this._setRanges(i,o&&!!o.backward);else throw new CKEditorError("model-selection-setto-not-selectable",[this,i])}_setRanges(t,i=!1){const r=Array.from(t),o=r.some(a=>{if(!(a instanceof Range))throw new CKEditorError("model-selection-set-ranges-not-range",[this,t]);return this._ranges.every(c=>!c.isEqual(a))});r.length===this._ranges.length&&!o||(this._replaceAllRanges(r),this._lastRangeBackward=!!i,this.fire("change:range",{directChange:!0}))}setFocus(t,i){if(this.anchor===null)throw new CKEditorError("model-selection-setfocus-no-ranges",[this,t]);const r=Position._createAt(t,i);if(r.compareWith(this.focus)=="same")return;const o=this.anchor;this._ranges.length&&this._popRange(),r.compareWith(o)=="before"?(this._pushRange(new Range(r,o)),this._lastRangeBackward=!0):(this._pushRange(new Range(o,r)),this._lastRangeBackward=!1),this.fire("change:range",{directChange:!0})}getAttribute(t){return this._attrs.get(t)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}hasAttribute(t){return this._attrs.has(t)}removeAttribute(t){this.hasAttribute(t)&&(this._attrs.delete(t),this.fire("change:attribute",{attributeKeys:[t],directChange:!0}))}setAttribute(t,i){this.getAttribute(t)!==i&&(this._attrs.set(t,i),this.fire("change:attribute",{attributeKeys:[t],directChange:!0}))}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}*getSelectedBlocks(){const t=new WeakSet;for(const i of this.getRanges()){const r=getParentBlock$1(i.start,t);isStartBlockSelected(r,i)&&(yield r);for(const a of i.getWalker()){const c=a.item;a.type=="elementEnd"&&isUnvisitedTopBlock(c,t,i)&&(yield c)}const o=getParentBlock$1(i.end,t);isEndBlockSelected(o,i)&&(yield o)}}containsEntireContent(t=this.anchor.root){const i=Position._createAt(t,0),r=Position._createAt(t,"end");return i.isTouching(this.getFirstPosition())&&r.isTouching(this.getLastPosition())}_pushRange(t){this._checkRange(t),this._ranges.push(new Range(t.start,t.end))}_checkRange(t){for(let i=0;i<this._ranges.length;i++)if(t.isIntersecting(this._ranges[i]))throw new CKEditorError("model-selection-range-intersects",[this,t],{addedRange:t,intersectingRange:this._ranges[i]})}_replaceAllRanges(t){this._removeAllRanges();for(const i of t)this._pushRange(i)}_removeAllRanges(){for(;this._ranges.length>0;)this._popRange()}_popRange(){this._ranges.pop()}};Selection.prototype.is=function(e){return e==="selection"||e==="model:selection"};function isUnvisitedBlock(e,t){return t.has(e)?!1:(t.add(e),e.root.document.model.schema.isBlock(e)&&!!e.parent)}function isUnvisitedTopBlock(e,t,i){return isUnvisitedBlock(e,t)&&isTopBlockInRange(e,i)}function getParentBlock$1(e,t){const r=e.parent.root.document.model.schema,o=e.parent.getAncestors({parentFirst:!0,includeSelf:!0});let a=!1;const c=o.find(u=>a?!1:(a=r.isLimit(u),!a&&isUnvisitedBlock(u,t)));return o.forEach(u=>t.add(u)),c}function isTopBlockInRange(e,t){const i=findAncestorBlock(e);return i?!t.containsRange(Range._createOn(i),!0):!0}function isStartBlockSelected(e,t){return e?t.isCollapsed||e.isEmpty?!0:t.start.isTouching(Position._createAt(e,e.maxOffset))?!1:isTopBlockInRange(e,t):!1}function isEndBlockSelected(e,t){return e?t.isCollapsed||e.isEmpty?!0:t.end.isTouching(Position._createAt(e,0))?!1:isTopBlockInRange(e,t):!1}function findAncestorBlock(e){const t=e.root.document.model.schema;let i=e.parent;for(;i;){if(t.isBlock(i))return i;i=i.parent}}var LiveRange=class _s extends EmitterMixin(Range){constructor(t,i){super(t,i),bindWithDocument$1.call(this)}detach(){this.stopListening()}toRange(){return new Range(this.start,this.end)}static fromRange(t){return new _s(t.start,t.end)}};LiveRange.prototype.is=function(e){return e==="liveRange"||e==="model:liveRange"||e=="range"||e==="model:range"};function bindWithDocument$1(){this.listenTo(this.root.document.model,"applyOperation",(e,t)=>{const i=t[0];i.isDocumentOperation&&transform$2.call(this,i)},{priority:"low"})}function transform$2(e){const t=this.getTransformedByOperation(e),i=Range._createFromRanges(t),r=!i.isEqual(this),o=doesOperationChangeRangeContent(this,e);let a=null;if(r){i.root.rootName=="$graveyard"&&(e.type=="remove"?a=e.sourcePosition:a=e.deletionPosition);const c=this.toRange();this.start=i.start,this.end=i.end,this.fire("change:range",c,{deletionPosition:a})}else o&&this.fire("change:content",this.toRange(),{deletionPosition:a})}function doesOperationChangeRangeContent(e,t){switch(t.type){case"insert":return e.containsPosition(t.position);case"move":case"remove":case"reinsert":case"merge":return e.containsPosition(t.sourcePosition)||e.start.isEqual(t.sourcePosition)||e.containsPosition(t.targetPosition);case"split":return e.containsPosition(t.splitPosition)||e.containsPosition(t.insertionPosition)}return!1}var Text=class hr extends Node$1$1{_data;constructor(t,i){super(i),this._data=t||""}get offsetSize(){return this.data.length}get data(){return this._data}toJSON(){const t=super.toJSON();return t.data=this.data,t}_clone(){return new hr(this.data,this.getAttributes())}static fromJSON(t){return new hr(t.data,t.attributes)}};Text.prototype.is=function(e){return e==="$text"||e==="model:$text"||e==="text"||e==="model:text"||e==="node"||e==="model:node"};const storePrefix="selection:";var DocumentSelection=class extends EmitterMixin(TypeCheckable){_selection;constructor(e){super(),this._selection=new LiveSelection(e),this._selection.delegate("change:range").to(this),this._selection.delegate("change:attribute").to(this),this._selection.delegate("change:marker").to(this)}get isCollapsed(){return this._selection.isCollapsed}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get rangeCount(){return this._selection.rangeCount}get hasOwnRange(){return this._selection.hasOwnRange}get isBackward(){return this._selection.isBackward}get isGravityOverridden(){return this._selection.isGravityOverridden}get markers(){return this._selection.markers}get _ranges(){return this._selection._ranges}getRanges(){return this._selection.getRanges()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getSelectedBlocks(){return this._selection.getSelectedBlocks()}getSelectedElement(){return this._selection.getSelectedElement()}containsEntireContent(e){return this._selection.containsEntireContent(e)}destroy(){this._selection.destroy()}getAttributeKeys(){return this._selection.getAttributeKeys()}getAttributes(){return this._selection.getAttributes()}getAttribute(e){return this._selection.getAttribute(e)}hasAttribute(e){return this._selection.hasAttribute(e)}refresh(){this._selection.updateMarkers(),this._selection._updateAttributes(!1)}observeMarkers(e){this._selection.observeMarkers(e)}_setFocus(e,t){this._selection.setFocus(e,t)}_setTo(...e){this._selection.setTo(...e)}_setAttribute(e,t){this._selection.setAttribute(e,t)}_removeAttribute(e){this._selection.removeAttribute(e)}_getStoredAttributes(){return this._selection.getStoredAttributes()}_overrideGravity(){return this._selection.overrideGravity()}_restoreGravity(e){this._selection.restoreGravity(e)}static _getStoreAttributeKey(e){return storePrefix+e}static _isStoreAttributeKey(e){return e.startsWith(storePrefix)}};DocumentSelection.prototype.is=function(e){return e==="selection"||e=="model:selection"||e=="documentSelection"||e=="model:documentSelection"};var LiveSelection=class extends Selection{markers=new Collection({idProperty:"name"});_model;_document;_attributePriority=new Map;_selectionRestorePosition=null;_hasChangedRange=!1;_overriddenGravityRegister=new Set;_observedMarkers=new Set;constructor(e){super(),this._model=e.model,this._document=e,this.listenTo(this._model,"applyOperation",(t,i)=>{const r=i[0];!r.isDocumentOperation||r.type=="marker"||r.type=="rename"||r.type=="noop"||(this._ranges.length==0&&this._selectionRestorePosition&&this._fixGraveyardSelection(this._selectionRestorePosition),this._selectionRestorePosition=null,this._hasChangedRange&&(this._hasChangedRange=!1,this.fire("change:range",{directChange:!1})))},{priority:"lowest"}),this.on("change:range",()=>{this._validateSelectionRanges(this.getRanges())}),this.listenTo(this._model.markers,"update",(t,i,r,o)=>{this._updateMarker(i,o)}),this.listenTo(this._document,"change",(t,i)=>{clearAttributesStoredInElement(this._model,i)})}get isCollapsed(){return this._ranges.length===0?this._document._getDefaultRange().isCollapsed:super.isCollapsed}get anchor(){return super.anchor||this._document._getDefaultRange().start}get focus(){return super.focus||this._document._getDefaultRange().end}get rangeCount(){return this._ranges.length?this._ranges.length:1}get hasOwnRange(){return this._ranges.length>0}get isGravityOverridden(){return!!this._overriddenGravityRegister.size}destroy(){for(let e=0;e<this._ranges.length;e++)this._ranges[e].detach();this.stopListening()}*getRanges(){this._ranges.length?yield*super.getRanges():yield this._document._getDefaultRange()}getFirstRange(){return super.getFirstRange()||this._document._getDefaultRange()}getLastRange(){return super.getLastRange()||this._document._getDefaultRange()}setTo(...e){super.setTo(...e),this._updateAttributes(!0),this.updateMarkers()}setFocus(e,t){super.setFocus(e,t),this._updateAttributes(!0),this.updateMarkers()}setAttribute(e,t){if(this._setAttribute(e,t)){const i=[e];this.fire("change:attribute",{attributeKeys:i,directChange:!0})}}removeAttribute(e){if(this._removeAttribute(e)){const t=[e];this.fire("change:attribute",{attributeKeys:t,directChange:!0})}}overrideGravity(){const e=uid();return this._overriddenGravityRegister.add(e),this._overriddenGravityRegister.size===1&&this._updateAttributes(!0),e}restoreGravity(e){if(!this._overriddenGravityRegister.has(e))throw new CKEditorError("document-selection-gravity-wrong-restore",this,{uid:e});this._overriddenGravityRegister.delete(e),this.isGravityOverridden||this._updateAttributes(!0)}observeMarkers(e){this._observedMarkers.add(e),this.updateMarkers()}_replaceAllRanges(e){this._validateSelectionRanges(e),super._replaceAllRanges(e)}_popRange(){this._ranges.pop().detach()}_pushRange(e){const t=this._prepareRange(e);t&&this._ranges.push(t)}_validateSelectionRanges(e){for(const t of e)if(!this._document._validateSelectionRange(t))throw new CKEditorError("document-selection-wrong-position",this,{range:t})}_prepareRange(e){if(this._checkRange(e),e.root==this._document.graveyard)return;const t=LiveRange.fromRange(e);return t.on("change:range",(i,r,o)=>{if(this._hasChangedRange=!0,t.root==this._document.graveyard){this._selectionRestorePosition=o.deletionPosition;const a=this._ranges.indexOf(t);this._ranges.splice(a,1),t.detach()}}),t}updateMarkers(){if(!this._observedMarkers.size)return;const e=[];let t=!1;for(const r of this._model.markers){const o=r.name.split(":",1)[0];if(!this._observedMarkers.has(o))continue;const a=r.getRange();for(const c of this.getRanges())a.containsRange(c,!c.isCollapsed)&&e.push(r)}const i=Array.from(this.markers);for(const r of e)this.markers.has(r)||(this.markers.add(r),t=!0);for(const r of Array.from(this.markers))e.includes(r)||(this.markers.remove(r),t=!0);t&&this.fire("change:marker",{oldMarkers:i,directChange:!1})}_updateMarker(e,t){const i=e.name.split(":",1)[0];if(!this._observedMarkers.has(i))return;let r=!1;const o=Array.from(this.markers),a=this.markers.has(e);if(!t)a&&(this.markers.remove(e),r=!0);else{let c=!1;for(const u of this.getRanges())if(t.containsRange(u,!u.isCollapsed)){c=!0;break}c&&!a?(this.markers.add(e),r=!0):!c&&a&&(this.markers.remove(e),r=!0)}r&&this.fire("change:marker",{oldMarkers:o,directChange:!1})}_updateAttributes(e){const t=toMap(this._getSurroundingAttributes()),i=toMap(this.getAttributes());if(e)this._attributePriority=new Map,this._attrs=new Map;else for(const[o,a]of this._attributePriority)a=="low"&&(this._attrs.delete(o),this._attributePriority.delete(o));this._setAttributesTo(t);const r=[];for(const[o,a]of this.getAttributes())(!i.has(o)||i.get(o)!==a)&&r.push(o);for(const[o]of i)this.hasAttribute(o)||r.push(o);r.length>0&&this.fire("change:attribute",{attributeKeys:r,directChange:!1})}_setAttribute(e,t,i=!0){const r=i?"normal":"low";return r=="low"&&this._attributePriority.get(e)=="normal"||super.getAttribute(e)===t?!1:(this._attrs.set(e,t),this._attributePriority.set(e,r),!0)}_removeAttribute(e,t=!0){const i=t?"normal":"low";return i=="low"&&this._attributePriority.get(e)=="normal"||(this._attributePriority.set(e,i),!super.hasAttribute(e))?!1:(this._attrs.delete(e),!0)}_setAttributesTo(e){const t=new Set;for(const[i,r]of this.getAttributes())e.get(i)!==r&&this._removeAttribute(i,!1);for(const[i,r]of e)this._setAttribute(i,r,!1)&&t.add(i);return t}*getStoredAttributes(){const e=this.getFirstPosition().parent;if(this.isCollapsed&&e.isEmpty)for(const t of e.getAttributeKeys())t.startsWith(storePrefix)&&(yield[t.substr(storePrefix.length),e.getAttribute(t)])}_getSurroundingAttributes(){const e=this.getFirstPosition(),t=this._model.schema;if(e.root.rootName=="$graveyard")return null;let i=null;if(this.isCollapsed){const r=e.textNode?e.textNode:e.nodeBefore,o=e.textNode?e.textNode:e.nodeAfter;if(this.isGravityOverridden||(i=getTextAttributes(r,t)),i||(i=getTextAttributes(o,t)),!this.isGravityOverridden&&!i){let a=r;for(;a&&!i;)a=a.previousSibling,i=getTextAttributes(a,t)}if(!i){let a=o;for(;a&&!i;)a=a.nextSibling,i=getTextAttributes(a,t)}i||(i=this.getStoredAttributes())}else{const r=this.getFirstRange();for(const o of r){if(o.item.is("element")&&t.isObject(o.item)){i=getTextAttributes(o.item,t);break}if(o.type=="text"){i=o.item.getAttributes();break}}}return i}_fixGraveyardSelection(e){const t=this._model.schema.getNearestSelectionRange(e);t&&this._pushRange(t)}};function getTextAttributes(e,t){if(!e)return null;if(e instanceof TextProxy||e instanceof Text)return e.getAttributes();if(!t.isInline(e))return null;if(!t.isObject(e))return[];const i=[];for(const[r,o]of e.getAttributes())t.checkAttribute("$text",r)&&t.getAttributeProperties(r).copyFromObject!==!1&&i.push([r,o]);return i}function clearAttributesStoredInElement(e,t){const i=e.document.differ;for(const r of i.getChanges()){if(r.type!="insert")continue;const o=r.position.parent;r.length===o.maxOffset&&e.enqueueChange(t,c=>{const u=Array.from(o.getAttributeKeys()).filter(h=>h.startsWith(storePrefix));for(const h of u)c.removeAttribute(h,o)})}}var NodeList=class{_nodes=[];_offsetToNode=[];constructor(e){e&&this._insertNodes(0,e)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._offsetToNode.length}getNode(e){return this._nodes[e]||null}getNodeAtOffset(e){return this._offsetToNode[e]||null}getNodeIndex(e){return e.index}getNodeStartOffset(e){return e.startOffset}indexToOffset(e){if(e==this._nodes.length)return this.maxOffset;const t=this._nodes[e];if(!t)throw new CKEditorError("model-nodelist-index-out-of-bounds",this);return this.getNodeStartOffset(t)}offsetToIndex(e){if(e==this._offsetToNode.length)return this._nodes.length;const t=this._offsetToNode[e];if(!t)throw new CKEditorError("model-nodelist-offset-out-of-bounds",this,{offset:e,nodeList:this});return this.getNodeIndex(t)}_insertNodes(e,t){const i=[];for(const o of t){if(!(o instanceof Node$1$1))throw new CKEditorError("model-nodelist-insertnodes-not-node",this);i.push(o)}let r=this.indexToOffset(e);spliceArray(this._nodes,i,e),spliceArray(this._offsetToNode,makeOffsetsArray(i),r);for(let o=e;o<this._nodes.length;o++)this._nodes[o]._index=o,this._nodes[o]._startOffset=r,r+=this._nodes[o].offsetSize}_removeNodes(e,t=1){if(t==0)return[];let i=this.indexToOffset(e);const r=this._nodes.splice(e,t),o=r[r.length-1],a=o.startOffset+o.offsetSize-i;this._offsetToNode.splice(i,a);for(const c of r)c._index=null,c._startOffset=null;for(let c=e;c<this._nodes.length;c++)this._nodes[c]._index=c,this._nodes[c]._startOffset=i,i+=this._nodes[c].offsetSize;return r}_removeNodesArray(e){if(e.length==0)return;for(const i of e)i._index=null,i._startOffset=null;this._nodes=this._nodes.filter(i=>i.index!==null),this._offsetToNode=this._offsetToNode.filter(i=>i.index!==null);let t=0;for(let i=0;i<this._nodes.length;i++)this._nodes[i]._index=i,this._nodes[i]._startOffset=t,t+=this._nodes[i].offsetSize}toJSON(){return this._nodes.map(e=>e.toJSON())}};function makeOffsetsArray(e){const t=[];let i=0;for(const r of e)for(let o=0;o<r.offsetSize;o++)t[i++]=r;return t}var Element$2=class Ri extends Node$1$1{name;_children=new NodeList;constructor(t,i,r){super(i),this.name=t,r&&this._insertChild(0,r)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}getChild(t){return this._children.getNode(t)}getChildAtOffset(t){return this._children.getNodeAtOffset(t)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(t){return this._children.getNodeIndex(t)}getChildStartOffset(t){return this._children.getNodeStartOffset(t)}offsetToIndex(t){return this._children.offsetToIndex(t)}getNodeByPath(t){let i=this;for(const r of t)i=i.getChildAtOffset(r);return i}findAncestor(t,i={}){let r=i.includeSelf?this:this.parent;for(;r;){if(r.name===t)return r;r=r.parent}return null}toJSON(){const t=super.toJSON();if(t.name=this.name,this._children.length>0){t.children=[];for(const i of this._children)t.children.push(i.toJSON())}return t}_clone(t=!1){const i=t?cloneNodes(this._children):void 0;return new Ri(this.name,this.getAttributes(),i)}_appendChild(t){this._insertChild(this.childCount,t)}_insertChild(t,i){const r=normalize$1(i);for(const o of r)o.parent!==null&&o._remove(),o.parent=this;this._children._insertNodes(t,r)}_removeChildren(t,i=1){const r=this._children._removeNodes(t,i);for(const o of r)o.parent=null;return r}_removeChildrenArray(t){this._children._removeNodesArray(t);for(const i of t)i.parent=null}static fromJSON(t){let i;if(t.children){i=[];for(const r of t.children)r.name?i.push(Ri.fromJSON(r)):i.push(Text.fromJSON(r))}return new Ri(t.name,t.attributes,i)}};Element$2.prototype.is=function(e,t){return t?t===this.name&&(e==="element"||e==="model:element"):e==="element"||e==="model:element"||e==="node"||e==="model:node"};function normalize$1(e){if(typeof e=="string")return[new Text(e)];isIterable(e)||(e=[e]);const t=[];for(const i of e)typeof i=="string"?t.push(new Text(i)):i instanceof TextProxy?t.push(new Text(i.data,i.getAttributes())):t.push(i);return t}function cloneNodes(e){const t=[];for(const i of e)t.push(i._clone(!0));return t}var ConversionHelpers=class{_dispatchers;constructor(e){this._dispatchers=e}add(e){for(const t of this._dispatchers)e(t);return this}},DowncastHelpers=class extends ConversionHelpers{elementToElement(e){return this.add(downcastElementToElement(e))}elementToStructure(e){return this.add(downcastElementToStructure(e))}attributeToElement(e){return this.add(downcastAttributeToElement(e))}attributeToAttribute(e){return this.add(downcastAttributeToAttribute(e))}markerToElement(e){return this.add(downcastMarkerToElement(e))}markerToHighlight(e){return this.add(downcastMarkerToHighlight(e))}markerToData(e){return this.add(downcastMarkerToData(e))}};function insertText(){return(e,t,i)=>{if(!i.consumable.consume(t.item,e.name))return;const r=i.writer,o=i.mapper.toViewPosition(t.range.start),a=r.createText(t.item.data);r.insert(o,a)}}function insertAttributesAndChildren(){return(e,t,i)=>{i.convertAttributes(t.item),!t.reconversion&&t.item.is("element")&&!t.item.isEmpty&&i.convertChildren(t.item)}}function remove$2(){return(e,t,i)=>{const r=i.mapper.toViewPosition(t.position),o=t.position.getShiftedBy(t.length),a=i.mapper.toViewPosition(o,{isPhantom:!0}),c=i.writer.createRange(r,a),u=i.writer.remove(c.getTrimmed());for(const h of i.writer.createRangeIn(u).getItems())i.mapper.unbindViewElement(h,{defer:!0})}}function createViewElementFromHighlightDescriptor(e,t){const i=e.createAttributeElement("span",t.attributes);return t.classes&&i._addClass(t.classes),typeof t.priority=="number"&&(i._priority=t.priority),i._id=t.id,i}function convertRangeSelection(){return(e,t,i)=>{const r=t.selection;if(r.isCollapsed||!i.consumable.consume(r,"selection"))return;const o=[];for(const a of r.getRanges())o.push(i.mapper.toViewRange(a));i.writer.setSelection(o,{backward:r.isBackward})}}function convertCollapsedSelection(){return(e,t,i)=>{const r=t.selection;if(!r.isCollapsed||!i.consumable.consume(r,"selection"))return;const o=i.writer,a=r.getFirstPosition(),c=i.mapper.toViewPosition(a),u=o.breakAttributes(c);o.setSelection(u)}}function cleanSelection(){return(e,t,i)=>{const r=i.writer,o=r.document.selection;for(const a of o.getRanges())a.isCollapsed&&a.end.parent.isAttached()&&i.writer.mergeAttributes(a.start);r.setSelection(null)}}function wrap(e){return(t,i,r)=>{if(!r.consumable.test(i.item,t.name))return;const o=e(i.attributeOldValue,r,i),a=e(i.attributeNewValue,r,i);if(!o&&!a)return;r.consumable.consume(i.item,t.name);const c=r.writer,u=c.document.selection;if(i.item instanceof Selection||i.item instanceof DocumentSelection)c.wrap(u.getFirstRange(),a);else{let h=r.mapper.toViewRange(i.range);i.attributeOldValue!==null&&o&&(h=c.unwrap(h,o)),i.attributeNewValue!==null&&a&&c.wrap(h,a)}}}function insertElement(e,t=defaultConsumer){return(i,r,o)=>{if(!t(r.item,o.consumable,{preflight:!0}))return;const a=e(r.item,o,r);if(!a)return;t(r.item,o.consumable);const c=o.mapper.toViewPosition(r.range.start);o.mapper.bindElements(r.item,a),o.writer.insert(c,a),o.convertAttributes(r.item),reinsertOrConvertNodes(a,r.item.getChildren(),o,{reconversion:r.reconversion})}}function insertStructure(e,t){return(i,r,o)=>{if(!t(r.item,o.consumable,{preflight:!0}))return;const a=new Map;o.writer._registerSlotFactory(createSlotFactory(r.item,a,o));const c=e(r.item,o,r);if(o.writer._clearSlotFactory(),!c)return;validateSlotsChildren(r.item,a,o),t(r.item,o.consumable);const u=o.mapper.toViewPosition(r.range.start);o.mapper.bindElements(r.item,c),o.writer.insert(u,c),o.convertAttributes(r.item),fillSlots(c,a,o,{reconversion:r.reconversion})}}function insertUIElement(e){return(t,i,r)=>{i.isOpening=!0;const o=e(i,r);i.isOpening=!1;const a=e(i,r);if(!o||!a)return;const c=i.markerRange;if(c.isCollapsed&&!r.consumable.consume(c,t.name))return;for(const d of c)if(!r.consumable.consume(d.item,t.name))return;const u=r.mapper,h=r.writer;h.insert(u.toViewPosition(c.start),o),r.mapper.bindElementToMarker(o,i.markerName),c.isCollapsed||(h.insert(u.toViewPosition(c.end),a),r.mapper.bindElementToMarker(a,i.markerName)),t.stop()}}function removeUIElement(){return(e,t,i)=>{const r=i.mapper.markerNameToElements(t.markerName);if(r){for(const o of r)i.mapper.unbindElementFromMarkerName(o,t.markerName),i.writer.clear(i.writer.createRangeOn(o),o);i.writer.clearClonedElementsGroup(t.markerName),e.stop()}}}function insertMarkerData(e){return(t,i,r)=>{const o=e(i.markerName,r);if(!o)return;const a=i.markerRange;r.consumable.consume(a,t.name)&&(handleMarkerBoundary(a,!1,r,i,o),handleMarkerBoundary(a,!0,r,i,o),t.stop())}}function handleMarkerBoundary(e,t,i,r,o){const a=t?e.start:e.end,c=a.nodeAfter&&a.nodeAfter.is("element")?a.nodeAfter:null,u=a.nodeBefore&&a.nodeBefore.is("element")?a.nodeBefore:null;if(c||u){let d,f;t&&c||!t&&!u?(d=c,f=!0):(d=u,f=!1);const m=i.mapper.toViewElement(d);if(m){insertMarkerAsAttribute(m,t,f,i,r,o);return}}const h=i.mapper.toViewPosition(a);insertMarkerAsElement(h,t,i,r,o)}function insertMarkerAsAttribute(e,t,i,r,o,a){const c=`data-${a.group}-${t?"start":"end"}-${i?"before":"after"}`,u=e.hasAttribute(c)?e.getAttribute(c).split(","):[];u.unshift(a.name),r.writer.setAttribute(c,u.join(","),e),r.mapper.bindElementToMarker(e,o.markerName)}function insertMarkerAsElement(e,t,i,r,o){const a=`${o.group}-${t?"start":"end"}`,c=o.name?{name:o.name}:null,u=i.writer.createUIElement(a,c);i.writer.insert(e,u),i.mapper.bindElementToMarker(u,r.markerName)}function removeMarkerData(e){return(t,i,r)=>{const o=e(i.markerName,r);if(!o)return;const a=r.mapper.markerNameToElements(i.markerName);if(!a)return;for(const u of a)r.mapper.unbindElementFromMarkerName(u,i.markerName),u.is("containerElement")?(c(`data-${o.group}-start-before`,u),c(`data-${o.group}-start-after`,u),c(`data-${o.group}-end-before`,u),c(`data-${o.group}-end-after`,u)):r.writer.clear(r.writer.createRangeOn(u),u);r.writer.clearClonedElementsGroup(i.markerName),t.stop();function c(u,h){if(h.hasAttribute(u)){const d=new Set(h.getAttribute(u).split(","));d.delete(o.name),d.size==0?r.writer.removeAttribute(u,h):r.writer.setAttribute(u,Array.from(d).join(","),h)}}}}function changeAttribute(e){return(t,i,r)=>{if(!r.consumable.test(i.item,t.name))return;const o=e(i.attributeOldValue,r,i),a=e(i.attributeNewValue,r,i);if(!o&&!a)return;r.consumable.consume(i.item,t.name);const c=r.mapper.toViewElement(i.item),u=r.writer;if(!c)throw new CKEditorError("conversion-attribute-to-attribute-on-text",r.dispatcher,i);if(i.attributeOldValue!==null&&o)if(o.key=="class"){const h=typeof o.value=="string"?o.value.split(/\s+/):o.value;for(const d of h)u.removeClass(d,c)}else if(o.key=="style")if(typeof o.value=="string"){const h=new StylesMap(u.document.stylesProcessor);h.setTo(o.value);for(const[d]of h.getStylesEntries())u.removeStyle(d,c)}else{const h=Object.keys(o.value);for(const d of h)u.removeStyle(d,c)}else u.removeAttribute(o.key,c);if(i.attributeNewValue!==null&&a)if(a.key=="class"){const h=typeof a.value=="string"?a.value.split(/\s+/):a.value;for(const d of h)u.addClass(d,c)}else if(a.key=="style")if(typeof a.value=="string"){const h=new StylesMap(u.document.stylesProcessor);h.setTo(a.value);for(const[d,f]of h.getStylesEntries())u.setStyle(d,f,c)}else{const h=Object.keys(a.value);for(const d of h)u.setStyle(d,a.value[d],c)}else u.setAttribute(a.key,a.value,c)}}function highlightText(e){return(t,i,r)=>{if(!i.item||!(i.item instanceof Selection||i.item instanceof DocumentSelection)&&!i.item.is("$textProxy"))return;const o=prepareDescriptor(e,i,r);if(!o||!r.consumable.consume(i.item,t.name))return;const a=r.writer,c=createViewElementFromHighlightDescriptor(a,o),u=a.document.selection;if(i.item instanceof Selection||i.item instanceof DocumentSelection)a.wrap(u.getFirstRange(),c);else{const h=r.mapper.toViewRange(i.range),d=a.wrap(h,c);for(const f of d.getItems())if(f.is("attributeElement")&&f.isSimilar(c)){r.mapper.bindElementToMarker(f,i.markerName);break}}}}function highlightElement(e){return(t,i,r)=>{if(!i.item||!(i.item instanceof Element$2))return;const o=prepareDescriptor(e,i,r);if(!o||!r.consumable.test(i.item,t.name))return;const a=r.mapper.toViewElement(i.item);if(a&&a.getCustomProperty("addHighlight")){r.consumable.consume(i.item,t.name);for(const u of Range._createIn(i.item))r.consumable.consume(u.item,t.name);a.getCustomProperty("addHighlight")(a,o,r.writer),r.mapper.bindElementToMarker(a,i.markerName)}}}function removeHighlight(e){return(t,i,r)=>{if(i.markerRange.isCollapsed)return;const o=prepareDescriptor(e,i,r);if(!o)return;const a=createViewElementFromHighlightDescriptor(r.writer,o),c=r.mapper.markerNameToElements(i.markerName);if(c){for(const u of c)r.mapper.unbindElementFromMarkerName(u,i.markerName),u.is("attributeElement")?r.writer.unwrap(r.writer.createRangeOn(u),a):u.getCustomProperty("removeHighlight")(u,o.id,r.writer);r.writer.clearClonedElementsGroup(i.markerName),t.stop()}}}function downcastElementToElement(e){const t=normalizeModelElementConfig(e.model),i=normalizeToElementConfig(e.view,"container");return t.attributes.length&&(t.children=!0),r=>{r.on(`insert:${t.name}`,insertElement(i,createConsumer(t)),{priority:e.converterPriority||"normal"}),(t.children||t.attributes.length)&&r.on("reduceChanges",createChangeReducer(t),{priority:"low"})}}function downcastElementToStructure(e){const t=normalizeModelElementConfig(e.model),i=normalizeToElementConfig(e.view,"container");return t.children=!0,r=>{if(r._conversionApi.schema.checkChild(t.name,"$text"))throw new CKEditorError("conversion-element-to-structure-disallowed-text",r,{elementName:t.name});r.on(`insert:${t.name}`,insertStructure(i,createConsumer(t)),{priority:e.converterPriority||"normal"}),r.on("reduceChanges",createChangeReducer(t),{priority:"low"})}}function downcastAttributeToElement(e){e=cloneDeep_default(e);let t=e.model;typeof t=="string"&&(t={key:t});let i=`attribute:${t.key}`;if(t.name&&(i+=":"+t.name),t.values)for(const o of t.values)e.view[o]=normalizeToElementConfig(e.view[o],"attribute");else e.view=normalizeToElementConfig(e.view,"attribute");const r=getFromAttributeCreator(e);return o=>{o.on(i,wrap(r),{priority:e.converterPriority||"normal"})}}function downcastAttributeToAttribute(e){e=cloneDeep_default(e);let t=e.model;typeof t=="string"&&(t={key:t});let i=`attribute:${t.key}`;if(t.name&&(i+=":"+t.name),t.values)for(const o of t.values)e.view[o]=normalizeToAttributeConfig(e.view[o]);else e.view=normalizeToAttributeConfig(e.view);const r=getFromAttributeCreator(e);return o=>{o.on(i,changeAttribute(r),{priority:e.converterPriority||"normal"})}}function downcastMarkerToElement(e){const t=normalizeToElementConfig(e.view,"ui");return i=>{i.on(`addMarker:${e.model}`,insertUIElement(t),{priority:e.converterPriority||"normal"}),i.on(`removeMarker:${e.model}`,removeUIElement(),{priority:e.converterPriority||"normal"})}}function downcastMarkerToData(e){e=cloneDeep_default(e);const t=e.model;let i=e.view;return i||(i=r=>({group:t,name:r.substr(e.model.length+1)})),r=>{r.on(`addMarker:${t}`,insertMarkerData(i),{priority:e.converterPriority||"normal"}),r.on(`removeMarker:${t}`,removeMarkerData(i),{priority:e.converterPriority||"normal"})}}function downcastMarkerToHighlight(e){return t=>{t.on(`addMarker:${e.model}`,highlightText(e.view),{priority:e.converterPriority||"normal"}),t.on(`addMarker:${e.model}`,highlightElement(e.view),{priority:e.converterPriority||"normal"}),t.on(`removeMarker:${e.model}`,removeHighlight(e.view),{priority:e.converterPriority||"normal"})}}function normalizeModelElementConfig(e){return typeof e=="string"&&(e={name:e}),{name:e.name,attributes:e.attributes?toArray$1(e.attributes):[],children:!!e.children}}function normalizeToElementConfig(e,t){return typeof e=="function"?e:(i,r)=>createViewElementFromDefinition(e,r,t)}function createViewElementFromDefinition(e,t,i){typeof e=="string"&&(e={name:e});let r;const o=t.writer,a=Object.assign({},e.attributes);if(i=="container")r=o.createContainerElement(e.name,a);else if(i=="attribute"){const c={priority:e.priority||AttributeElement.DEFAULT_PRIORITY};r=o.createAttributeElement(e.name,a,c)}else r=o.createUIElement(e.name,a);if(e.styles){const c=Object.keys(e.styles);for(const u of c)o.setStyle(u,e.styles[u],r)}if(e.classes){const c=e.classes;if(typeof c=="string")o.addClass(c,r);else for(const u of c)o.addClass(u,r)}return r}function getFromAttributeCreator(e){return e.model.values?(t,i,r)=>{const o=e.view[t];return o?o(t,i,r):null}:e.view}function normalizeToAttributeConfig(e){return typeof e=="string"?t=>({key:e,value:t}):typeof e=="object"?e.value?()=>e:t=>({key:e.key,value:t}):e}function prepareDescriptor(e,t,i){const r=typeof e=="function"?e(t,i):e;return r?(r.priority||(r.priority=10),r.id||(r.id=t.markerName),r):null}function createChangeReducerCallback(e){return(t,i)=>{if(!t.is("element",e.name))return!1;if(i.type=="attribute"){if(e.attributes.includes(i.attributeKey))return!0}else if(e.children)return!0;return!1}}function createChangeReducer(e){const t=createChangeReducerCallback(e);return(i,r)=>{const o=[];r.reconvertedElements||(r.reconvertedElements=new Set);for(const a of r.changes){const c=a.type=="attribute"?a.range.start.nodeAfter:a.position.parent;if(!c||!t(c,a)){o.push(a);continue}if(!r.reconvertedElements.has(c)){r.reconvertedElements.add(c);const u=Position._createBefore(c);let h=o.length;for(let d=o.length-1;d>=0;d--){const f=o[d],g=(f.type=="attribute"?f.range.start:f.position).compareWith(u);if(g=="before"||f.type=="remove"&&g=="same")break;h=d}o.splice(h,0,{type:"remove",name:c.name,position:u,length:1},{type:"reinsert",name:c.name,position:u,length:1})}}r.changes=o}}function createConsumer(e){return(t,i,r={})=>{const o=["insert"];for(const a of e.attributes)t.hasAttribute(a)&&o.push(`attribute:${a}`);return o.every(a=>i.test(t,a))?(r.preflight||o.forEach(a=>i.consume(t,a)),!0):!1}}function createSlotFactory(e,t,i){return(r,o)=>{const a=r.createContainerElement("$slot");let c=null;if(o==="children")c=Array.from(e.getChildren());else if(typeof o=="function")c=Array.from(e.getChildren()).filter(u=>o(u));else throw new CKEditorError("conversion-slot-mode-unknown",i.dispatcher,{modeOrFilter:o});return t.set(a,c),a}}function validateSlotsChildren(e,t,i){const r=Array.from(t.values()).flat(),o=new Set(r);if(o.size!=r.length)throw new CKEditorError("conversion-slot-filter-overlap",i.dispatcher,{element:e});if(o.size!=e.childCount)throw new CKEditorError("conversion-slot-filter-incomplete",i.dispatcher,{element:e})}function fillSlots(e,t,i,r){i.mapper.on("modelToViewPosition",c,{priority:"highest"});let o=null,a=null;for([o,a]of t)reinsertOrConvertNodes(e,a,i,r),i.writer.move(i.writer.createRangeIn(o),i.writer.createPositionBefore(o)),i.writer.remove(o);i.mapper.off("modelToViewPosition",c);function c(u,h){const d=h.modelPosition.nodeAfter,f=a.indexOf(d);f<0||(h.viewPosition=h.mapper.findPositionIn(o,f))}}function reinsertOrConvertNodes(e,t,i,r){for(const o of t)reinsertNode(e.root,o,i,r)||i.convertItem(o)}function reinsertNode(e,t,i,r){const{writer:o,mapper:a}=i;if(!r.reconversion)return!1;const c=a.toViewElement(t);return!c||c.root==e||!i.canReuseView(c)?!1:(o.move(o.createRangeOn(c),a.toViewPosition(Position._createBefore(t))),!0)}function defaultConsumer(e,t,{preflight:i}={}){return i?t.test(e,"insert"):t.consume(e,"insert")}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function autoParagraphEmptyRoots(e){const{schema:t,document:i}=e.model;for(const r of i.getRoots())if(r.isEmpty&&!t.checkChild(r,"$text")&&t.checkChild(r,"paragraph"))return e.insertElement("paragraph",r),!0;return!1}function isParagraphable(e,t,i){const r=i.createContext(e);return!(!i.checkChild(r,"paragraph")||!i.checkChild(r.push("paragraph"),t))}function wrapInParagraph(e,t){const i=t.createElement("paragraph");return t.insert(i,e),t.createPositionAt(i,0)}var UpcastHelpers=class extends ConversionHelpers{elementToElement(e){return this.add(upcastElementToElement(e))}elementToAttribute(e){return this.add(upcastElementToAttribute(e))}attributeToAttribute(e){return this.add(upcastAttributeToAttribute(e))}elementToMarker(e){return this.add(upcastElementToMarker(e))}dataToMarker(e){return this.add(upcastDataToMarker(e))}};function convertToModelFragment$1(){return(e,t,i)=>{if(!t.modelRange&&i.consumable.consume(t.viewItem,{name:!0})){const{modelRange:r,modelCursor:o}=i.convertChildren(t.viewItem,t.modelCursor);t.modelRange=r,t.modelCursor=o}}}function convertText(){return(e,t,{schema:i,consumable:r,writer:o})=>{let a=t.modelCursor;if(!r.test(t.viewItem))return;if(!i.checkChild(a,"$text")){if(!isParagraphable(a,"$text",i)||t.viewItem.data.trim().length==0)return;a=wrapInParagraph(a,o)}r.consume(t.viewItem);const c=o.createText(t.viewItem.data);o.insert(c,a),t.modelRange=o.createRange(a,a.getShiftedBy(c.offsetSize)),t.modelCursor=t.modelRange.end}}function convertSelectionChange(e,t){return(i,r)=>{const o=r.newSelection,a=[];for(const u of o.getRanges())a.push(t.toModelRange(u));const c=e.createSelection(a,{backward:o.isBackward});c.isEqual(e.document.selection)||e.change(u=>{u.setSelection(c)})}}function upcastElementToElement(e){e=cloneDeep_default(e);const t=prepareToElementConverter(e),i=getViewElementNameFromConfig(e.view),r=i?`element:${i}`:"element";return o=>{o.on(r,t,{priority:e.converterPriority||"normal"})}}function upcastElementToAttribute(e){e=cloneDeep_default(e),normalizeModelAttributeConfig(e);const t=prepareToAttributeConverter(e,!1),i=getViewElementNameFromConfig(e.view),r=i?`element:${i}`:"element";return o=>{o.on(r,t,{priority:e.converterPriority||"low"})}}function upcastAttributeToAttribute(e){e=cloneDeep_default(e);let t=null;(typeof e.view=="string"||e.view.key)&&(t=normalizeViewAttributeKeyValueConfig(e)),normalizeModelAttributeConfig(e,t);const i=prepareToAttributeConverter(e,!0);return r=>{r.on("element",i,{priority:e.converterPriority||"low"})}}function upcastElementToMarker(e){const t=normalizeElementToMarkerModelConfig(e.model);return upcastElementToElement({...e,model:t})}function upcastDataToMarker(e){e=cloneDeep_default(e),e.model||(e.model=o=>o?e.view+":"+o:e.view);const t={view:e.view,model:e.model},i=prepareToElementConverter(normalizeDataToMarkerConfig(t,"start")),r=prepareToElementConverter(normalizeDataToMarkerConfig(t,"end"));return o=>{o.on(`element:${e.view}-start`,i,{priority:e.converterPriority||"normal"}),o.on(`element:${e.view}-end`,r,{priority:e.converterPriority||"normal"});const a=priorities.low,c=priorities.highest,u=priorities.get(e.converterPriority)/c;o.on("element",upcastAttributeToMarker(t),{priority:a+u})}}function upcastAttributeToMarker(e){return(t,i,r)=>{const o=`data-${e.view}`;if(!r.consumable.test(i.viewItem,{attributes:o+"-end-after"})&&!r.consumable.test(i.viewItem,{attributes:o+"-start-after"})&&!r.consumable.test(i.viewItem,{attributes:o+"-end-before"})&&!r.consumable.test(i.viewItem,{attributes:o+"-start-before"}))return;i.modelRange||Object.assign(i,r.convertChildren(i.viewItem,i.modelCursor)),r.consumable.consume(i.viewItem,{attributes:o+"-end-after"})&&a(i.modelRange.end,i.viewItem.getAttribute(o+"-end-after").split(",")),r.consumable.consume(i.viewItem,{attributes:o+"-start-after"})&&a(i.modelRange.end,i.viewItem.getAttribute(o+"-start-after").split(",")),r.consumable.consume(i.viewItem,{attributes:o+"-end-before"})&&a(i.modelRange.start,i.viewItem.getAttribute(o+"-end-before").split(",")),r.consumable.consume(i.viewItem,{attributes:o+"-start-before"})&&a(i.modelRange.start,i.viewItem.getAttribute(o+"-start-before").split(","));function a(c,u){for(const h of u){const d=e.model(h,r),f=r.writer.createElement("$marker",{"data-name":d});r.writer.insert(f,c),i.modelCursor.isEqual(c)?i.modelCursor=i.modelCursor.getShiftedBy(1):i.modelCursor=i.modelCursor._getTransformedByInsertion(c,1),i.modelRange=i.modelRange._getTransformedByInsertion(c,1)[0]}}}}function getViewElementNameFromConfig(e){return typeof e=="string"?e:typeof e=="object"&&typeof e.name=="string"?e.name:null}function prepareToElementConverter(e){const t=new Matcher(e.view);return(i,r,o)=>{const a=t.match(r.viewItem);if(!a)return;const c=a.match;if(c.name=!0,!o.consumable.test(r.viewItem,c))return;const u=getModelElement(e.model,r.viewItem,o);u&&o.safeInsert(u,r.modelCursor)&&(o.consumable.consume(r.viewItem,c),o.convertChildren(r.viewItem,u),o.updateConversionResult(u,r))}}function getModelElement(e,t,i){return e instanceof Function?e(t,i):i.writer.createElement(e)}function normalizeViewAttributeKeyValueConfig(e){typeof e.view=="string"&&(e.view={key:e.view});const t=e.view.key,i=typeof e.view.value>"u"?/[\s\S]*/:e.view.value;let r;return t=="class"||t=="style"?r={[t=="class"?"classes":"styles"]:i}:r={attributes:{[t]:i}},e.view.name&&(r.name=e.view.name),e.view=r,t}function normalizeModelAttributeConfig(e,t=null){const i=t===null?!0:a=>a.getAttribute(t),r=typeof e.model!="object"?e.model:e.model.key,o=typeof e.model!="object"||typeof e.model.value>"u"?i:e.model.value;e.model={key:r,value:o}}function prepareToAttributeConverter(e,t){const i=new Matcher(e.view);return(r,o,a)=>{if(!o.modelRange&&t)return;const c=i.match(o.viewItem);if(!c||(onlyViewNameIsDefined(e.view,o.viewItem)?c.match.name=!0:delete c.match.name,!a.consumable.test(o.viewItem,c.match)))return;const u=e.model.key,h=typeof e.model.value=="function"?e.model.value(o.viewItem,a):e.model.value;if(h===null)return;o.modelRange||Object.assign(o,a.convertChildren(o.viewItem,o.modelCursor)),setAttributeOn(o.modelRange,{key:u,value:h},t,a)&&(a.consumable.test(o.viewItem,{name:!0})&&(c.match.name=!0),a.consumable.consume(o.viewItem,c.match))}}function onlyViewNameIsDefined(e,t){const i=typeof e=="function"?e(t):e;return typeof i=="object"&&!getViewElementNameFromConfig(i)?!1:!i.classes&&!i.attributes&&!i.styles}function setAttributeOn(e,t,i,r){let o=!1;for(const a of Array.from(e.getItems({shallow:i})))r.schema.checkAttribute(a,t.key)&&(o=!0,!a.hasAttribute(t.key)&&r.writer.setAttribute(t.key,t.value,a));return o}function normalizeElementToMarkerModelConfig(e){return(t,i)=>{const r=typeof e=="string"?e:e(t,i);return i.writer.createElement("$marker",{"data-name":r})}}function normalizeDataToMarkerConfig(e,t){const i=(r,o)=>{const a=r.getAttribute("name"),c=e.model(a,o);return o.writer.createElement("$marker",{"data-name":c})};return{view:`${e.view}-${t}`,model:i}}function injectSelectionPostFixer(e){e.document.registerPostFixer(t=>selectionPostFixer(t,e))}function selectionPostFixer(e,t){const i=t.document.selection,r=t.schema,o=[];let a=!1;for(const c of i.getRanges()){const u=tryFixingRange(c,r);u&&!u.isEqual(c)?(o.push(u),a=!0):o.push(c)}return a&&e.setSelection(mergeIntersectingRanges(o),{backward:i.isBackward}),!1}function tryFixingRange(e,t){return e.isCollapsed?tryFixingCollapsedRange(e,t):tryFixingNonCollapsedRage(e,t)}function tryFixingCollapsedRange(e,t){const i=e.start,r=t.getNearestSelectionRange(i);if(!r){const a=i.getAncestors().reverse().find(c=>t.isObject(c));return a?Range._createOn(a):null}if(!r.isCollapsed)return r;const o=r.start;return i.isEqual(o)?null:new Range(o)}function tryFixingNonCollapsedRage(e,t){const{start:i,end:r}=e,o=t.checkChild(i,"$text"),a=t.checkChild(r,"$text"),c=t.getLimitElement(i),u=t.getLimitElement(r);if(c===u){if(o&&a)return null;if(checkSelectionOnNonLimitElements(i,r,t)){const m=i.nodeAfter&&t.isSelectable(i.nodeAfter)?null:t.getNearestSelectionRange(i,"forward"),v=r.nodeBefore&&t.isSelectable(r.nodeBefore)?null:t.getNearestSelectionRange(r,"backward"),_=m?m.start:i,b=v?v.end:r;return new Range(_,b)}}const h=c&&!c.is("rootElement"),d=u&&!u.is("rootElement");if(h||d){const f=i.nodeAfter&&r.nodeBefore&&i.nodeAfter.parent===r.nodeBefore.parent,m=h&&(!f||!isSelectable(i.nodeAfter,t)),g=d&&(!f||!isSelectable(r.nodeBefore,t));let v=i,_=r;return m&&(v=Position._createBefore(findOutermostLimitAncestor(c,t))),g&&(_=Position._createAfter(findOutermostLimitAncestor(u,t))),new Range(v,_)}return null}function findOutermostLimitAncestor(e,t){let i=e,r=i;for(;t.isLimit(r)&&r.parent;)i=r,r=r.parent;return i}function checkSelectionOnNonLimitElements(e,t,i){const r=e.nodeAfter&&!i.isLimit(e.nodeAfter)||i.checkChild(e,"$text"),o=t.nodeBefore&&!i.isLimit(t.nodeBefore)||i.checkChild(t,"$text");return r||o}function mergeIntersectingRanges(e){const t=[...e],i=new Set;let r=1;for(;r<t.length;){const a=t[r],c=t.slice(0,r);for(const[u,h]of c.entries())if(!i.has(u)){if(a.isEqual(h))i.add(u);else if(a.isIntersecting(h)){i.add(u),i.add(r);const d=a.getJoined(h);t.push(d)}}r++}return t.filter((a,c)=>!i.has(c))}function isSelectable(e,t){return e&&t.isSelectable(e)}var EditingController=class extends ObservableMixin(){model;view;mapper;downcastDispatcher;constructor(e,t){super(),this.model=e,this.view=new View$1(t),this.mapper=new Mapper,this.downcastDispatcher=new DowncastDispatcher({mapper:this.mapper,schema:e.schema});const i=this.model.document,r=i.selection,o=this.model.markers;this.listenTo(this.model,"_beforeChanges",()=>{this.view._disableRendering(!0)},{priority:"highest"}),this.listenTo(this.model,"_afterChanges",()=>{this.view._disableRendering(!1)},{priority:"lowest"}),this.listenTo(i,"change",()=>{this.view.change(a=>{this.downcastDispatcher.convertChanges(i.differ,o,a),this.downcastDispatcher.convertSelection(r,o,a)})},{priority:"low"}),this.listenTo(this.view.document,"selectionChange",convertSelectionChange(this.model,this.mapper)),this.listenTo(this.view.document,"beforeinput",fixTargetRanges(this.mapper,this.model.schema,this.view),{priority:"high"}),this.downcastDispatcher.on("insert:$text",insertText(),{priority:"lowest"}),this.downcastDispatcher.on("insert",insertAttributesAndChildren(),{priority:"lowest"}),this.downcastDispatcher.on("remove",remove$2(),{priority:"low"}),this.downcastDispatcher.on("cleanSelection",cleanSelection()),this.downcastDispatcher.on("selection",convertRangeSelection(),{priority:"low"}),this.downcastDispatcher.on("selection",convertCollapsedSelection(),{priority:"low"}),this.view.document.roots.bindTo(this.model.document.roots).using(a=>{if(a.rootName=="$graveyard")return null;const c=new RootEditableElement(this.view.document,a.name);return c.rootName=a.rootName,this.mapper.bindElements(a,c),c})}destroy(){this.view.destroy(),this.stopListening()}reconvertMarker(e){const t=typeof e=="string"?e:e.name,i=this.model.markers.get(t);if(!i)throw new CKEditorError("editingcontroller-reconvertmarker-marker-not-exist",this,{markerName:t});this.model.change(()=>{this.model.markers._refresh(i)})}reconvertItem(e){this.model.change(()=>{this.model.document.differ._refreshItem(e)})}};function fixTargetRanges(e,t,i){return(r,o)=>{if(!(i.document.isComposing&&!env.isAndroid))for(let a=0;a<o.targetRanges.length;a++){const c=o.targetRanges[a],u=e.toModelRange(c),h=tryFixingRange(u,t);!h||h.isEqual(u)||(o.targetRanges[a]=e.toViewRange(h))}}}var ViewConsumable=class Mi{_consumables=new Map;add(t,i){let r;if(t.is("$text")||t.is("documentFragment")){this._consumables.set(t,!0);return}this._consumables.has(t)?r=this._consumables.get(t):(r=new ViewElementConsumables(t),this._consumables.set(t,r)),r.add(i)}test(t,i){const r=this._consumables.get(t);return r===void 0?null:t.is("$text")||t.is("documentFragment")?r:r.test(i)}consume(t,i){return this.test(t,i)?(t.is("$text")||t.is("documentFragment")?this._consumables.set(t,!1):this._consumables.get(t).consume(i),!0):!1}revert(t,i){const r=this._consumables.get(t);r!==void 0&&(t.is("$text")||t.is("documentFragment")?this._consumables.set(t,!0):r.revert(i))}static consumablesFromElement(t){const i={element:t,name:!0,attributes:[],classes:[],styles:[]},r=t.getAttributeKeys();for(const c of r)c=="style"||c=="class"||i.attributes.push(c);const o=t.getClassNames();for(const c of o)i.classes.push(c);const a=t.getStyleNames();for(const c of a)i.styles.push(c);return i}static createFrom(t,i){if(i||(i=new Mi),t.is("$text"))return i.add(t),i;t.is("element")&&i.add(t,Mi.consumablesFromElement(t)),t.is("documentFragment")&&i.add(t);for(const r of t.getChildren())i=Mi.createFrom(r,i);return i}};const CONSUMABLE_TYPES=["attributes","classes","styles"];var ViewElementConsumables=class{element;_canConsumeName;_consumables;constructor(e){this.element=e,this._canConsumeName=null,this._consumables={attributes:new Map,styles:new Map,classes:new Map}}add(e){e.name&&(this._canConsumeName=!0);for(const t of CONSUMABLE_TYPES)t in e&&this._add(t,e[t])}test(e){if(e.name&&!this._canConsumeName)return this._canConsumeName;for(const t of CONSUMABLE_TYPES)if(t in e){const i=this._test(t,e[t]);if(i!==!0)return i}return!0}consume(e){e.name&&(this._canConsumeName=!1);for(const t of CONSUMABLE_TYPES)t in e&&this._consume(t,e[t])}revert(e){e.name&&(this._canConsumeName=!0);for(const t of CONSUMABLE_TYPES)t in e&&this._revert(t,e[t])}_add(e,t){const i=toArray$1(t),r=this._consumables[e];for(const o of i){if(e==="attributes"&&(o==="class"||o==="style"))throw new CKEditorError("viewconsumable-invalid-attribute",this);if(r.set(o,!0),e==="styles")for(const a of this.element.document.stylesProcessor.getRelatedStyles(o))r.set(a,!0)}}_test(e,t){const i=toArray$1(t),r=this._consumables[e];for(const o of i)if(e==="attributes"&&(o==="class"||o==="style")){const a=o=="class"?"classes":"styles",c=this._test(a,[...this._consumables[a].keys()]);if(c!==!0)return c}else{const a=r.get(o);if(a===void 0)return null;if(!a)return!1}return!0}_consume(e,t){const i=toArray$1(t),r=this._consumables[e];for(const o of i)if(e==="attributes"&&(o==="class"||o==="style")){const a=o=="class"?"classes":"styles";this._consume(a,[...this._consumables[a].keys()])}else if(r.set(o,!1),e=="styles")for(const a of this.element.document.stylesProcessor.getRelatedStyles(o))r.set(a,!1)}_revert(e,t){const i=toArray$1(t),r=this._consumables[e];for(const o of i)if(e==="attributes"&&(o==="class"||o==="style")){const a=o=="class"?"classes":"styles";this._revert(a,[...this._consumables[a].keys()])}else r.get(o)===!1&&r.set(o,!0)}},Schema=class extends ObservableMixin(){_sourceDefinitions={};_attributeProperties=Object.create(null);_customChildChecks=new Map;_customAttributeChecks=new Map;_genericCheckSymbol=Symbol("$generic");_compiledDefinitions;constructor(){super(),this.decorate("checkChild"),this.decorate("checkAttribute"),this.on("checkAttribute",(e,t)=>{t[0]=new SchemaContext(t[0])},{priority:"highest"}),this.on("checkChild",(e,t)=>{t[0]=new SchemaContext(t[0]),t[1]=this.getDefinition(t[1])},{priority:"highest"})}register(e,t){if(this._sourceDefinitions[e])throw new CKEditorError("schema-cannot-register-item-twice",this,{itemName:e});this._sourceDefinitions[e]=[Object.assign({},t)],this._clearCache()}extend(e,t){if(!this._sourceDefinitions[e])throw new CKEditorError("schema-cannot-extend-missing-item",this,{itemName:e});this._sourceDefinitions[e].push(Object.assign({},t)),this._clearCache()}getDefinitions(){return this._compiledDefinitions||this._compile(),this._compiledDefinitions}getDefinition(e){let t;return typeof e=="string"?t=e:"is"in e&&(e.is("$text")||e.is("$textProxy"))?t="$text":t=e.name,this.getDefinitions()[t]}isRegistered(e){return!!this.getDefinition(e)}isBlock(e){const t=this.getDefinition(e);return!!(t&&t.isBlock)}isLimit(e){const t=this.getDefinition(e);return t?!!(t.isLimit||t.isObject):!1}isObject(e){const t=this.getDefinition(e);return t?!!(t.isObject||t.isLimit&&t.isSelectable&&t.isContent):!1}isInline(e){const t=this.getDefinition(e);return!!(t&&t.isInline)}isSelectable(e){const t=this.getDefinition(e);return t?!!(t.isSelectable||t.isObject):!1}isContent(e){const t=this.getDefinition(e);return t?!!(t.isContent||t.isObject):!1}checkChild(e,t){return t?this._checkContextMatch(e,t):!1}checkAttribute(e,t){const i=this.getDefinition(e.last);if(!i)return!1;const r=this._evaluateAttributeChecks(e,t);return r!==void 0?r:i.allowAttributes.includes(t)}checkMerge(e,t){if(e instanceof Position){const i=e.nodeBefore,r=e.nodeAfter;if(!(i instanceof Element$2))throw new CKEditorError("schema-check-merge-no-element-before",this);if(!(r instanceof Element$2))throw new CKEditorError("schema-check-merge-no-element-after",this);return this.checkMerge(i,r)}if(this.isLimit(e)||this.isLimit(t))return!1;for(const i of t.getChildren())if(!this.checkChild(e,i))return!1;return!0}addChildCheck(e,t){const i=t!==void 0?t:this._genericCheckSymbol,r=this._customChildChecks.get(i)||[];r.push(e),this._customChildChecks.set(i,r)}addAttributeCheck(e,t){const i=t!==void 0?t:this._genericCheckSymbol,r=this._customAttributeChecks.get(i)||[];r.push(e),this._customAttributeChecks.set(i,r)}setAttributeProperties(e,t){this._attributeProperties[e]=Object.assign(this.getAttributeProperties(e),t)}getAttributeProperties(e){return this._attributeProperties[e]||Object.create(null)}getLimitElement(e){let t;for(e instanceof Position?t=e.parent:t=(e instanceof Range?[e]:Array.from(e.getRanges())).reduce((r,o)=>{const a=o.getCommonAncestor();return r?r.getCommonAncestor(a,{includeSelf:!0}):a},null);!this.isLimit(t)&&t.parent;)t=t.parent;return t}checkAttributeInSelection(e,t){if(e.isCollapsed){const r=[...e.getFirstPosition().getAncestors(),new Text("",e.getAttributes())];return this.checkAttribute(r,t)}else{const i=e.getRanges();for(const r of i)for(const o of r)if(this.checkAttribute(o.item,t))return!0}return!1}*getValidRanges(e,t){e=convertToMinimalFlatRanges(e);for(const i of e)yield*this._getValidRangesForRange(i,t)}getNearestSelectionRange(e,t="both"){if(e.root.rootName=="$graveyard")return null;if(this.checkChild(e,"$text"))return new Range(e);let i,r;const o=e.getAncestors().reverse().find(a=>this.isLimit(a))||e.root;(t=="both"||t=="backward")&&(i=new TreeWalker({boundaries:Range._createIn(o),startPosition:e,direction:"backward"})),(t=="both"||t=="forward")&&(r=new TreeWalker({boundaries:Range._createIn(o),startPosition:e}));for(const a of combineWalkers(i,r)){const c=a.walker==i?"elementEnd":"elementStart",u=a.value;if(u.type==c&&this.isObject(u.item))return Range._createOn(u.item);if(this.checkChild(u.nextPosition,"$text"))return new Range(u.nextPosition)}return null}findAllowedParent(e,t){let i=e.parent;for(;i;){if(this.checkChild(i,t))return i;if(this.isLimit(i))return null;i=i.parent}return null}setAllowedAttributes(e,t,i){const r=i.model;for(const[o,a]of Object.entries(t))r.schema.checkAttribute(e,o)&&i.setAttribute(o,a,e)}removeDisallowedAttributes(e,t){for(const i of e)if(i.is("$text"))removeDisallowedAttributeFromNode(this,i,t);else{const o=Range._createIn(i).getPositions();for(const a of o){const c=a.nodeBefore||a.parent;removeDisallowedAttributeFromNode(this,c,t)}}}getAttributesWithProperty(e,t,i){const r={};for(const[o,a]of e.getAttributes()){const c=this.getAttributeProperties(o);c[t]!==void 0&&(i===void 0||i===c[t])&&(r[o]=a)}return r}createContext(e){return new SchemaContext(e)}_clearCache(){this._compiledDefinitions=null}_compile(){const e={},t=this._sourceDefinitions,i=Object.keys(t);for(const o of i)e[o]=compileBaseItemRule(t[o],o);const r=Object.values(e);for(const o of r)propagateAllowIn(e,o),propagateAllowChildren(e,o),propagateDisallowIn(e,o),propagateDisallowChildren(e,o);for(const o of r)resolveDisallows(e,o);for(const o of r)compileAllowContentOf(e,o);for(const o of r)compileAllowWhere(e,o);for(const o of r)compileAllowAttributesOf(e,o);for(const o of r)compileInheritPropertiesFrom(e,o);this._compiledDefinitions=compileDefinitions(e)}_checkContextMatch(e,t){const i=e.last;let r=this._evaluateChildChecks(e,t);if(r=r!==void 0?r:t.allowIn.includes(i.name),!r)return!1;const o=this.getDefinition(i),a=e.trimLast();return o?a.length==0?!0:this._checkContextMatch(a,o):!1}_evaluateChildChecks(e,t){const i=this._customChildChecks.get(this._genericCheckSymbol)||[],r=this._customChildChecks.get(t.name)||[];for(const o of[...i,...r]){const a=o(e,t);if(a!==void 0)return a}}_evaluateAttributeChecks(e,t){const i=this._customAttributeChecks.get(this._genericCheckSymbol)||[],r=this._customAttributeChecks.get(t)||[];for(const o of[...i,...r]){const a=o(e,t);if(a!==void 0)return a}}*_getValidRangesForRange(e,t){let i=e.start,r=e.start;for(const o of e.getItems({shallow:!0}))o.is("element")&&(yield*this._getValidRangesForRange(Range._createIn(o),t)),this.checkAttribute(o,t)||(i.isEqual(r)||(yield new Range(i,r)),i=Position._createAfter(o)),r=Position._createAfter(o);i.isEqual(r)||(yield new Range(i,r))}findOptimalInsertionRange(e,t){const i=e.getSelectedElement();if(i&&this.isObject(i)&&!this.isInline(i))return t=="before"||t=="after"?new Range(Position._createAt(i,t)):Range._createOn(i);const r=first(e.getSelectedBlocks());if(!r)return new Range(e.focus);if(r.isEmpty)return new Range(Position._createAt(r,0));const o=Position._createAfter(r);return e.focus.isTouching(o)?new Range(o):new Range(Position._createBefore(r))}},SchemaContext=class ki{_items;constructor(t){if(t instanceof ki)return t;let i;typeof t=="string"?i=[t]:Array.isArray(t)?i=t:i=t.getAncestors({includeSelf:!0}),this._items=i.map(mapContextItem)}get length(){return this._items.length}get last(){return this._items[this._items.length-1]}[Symbol.iterator](){return this._items[Symbol.iterator]()}push(t){const i=new ki([t]);return i._items=[...this._items,...i._items],i}trimLast(){const t=new ki([]);return t._items=this._items.slice(0,-1),t}getItem(t){return this._items[t]}*getNames(){yield*this._items.map(t=>t.name)}endsWith(t){return Array.from(this.getNames()).join(" ").endsWith(t)}startsWith(t){return Array.from(this.getNames()).join(" ").startsWith(t)}};function compileBaseItemRule(e,t){const i={name:t,allowIn:new Set,allowChildren:new Set,disallowIn:new Set,disallowChildren:new Set,allowContentOf:new Set,allowWhere:new Set,allowAttributes:new Set,disallowAttributes:new Set,allowAttributesOf:new Set,inheritTypesFrom:new Set};return copyTypes(e,i),copyProperty(e,i,"allowIn"),copyProperty(e,i,"allowChildren"),copyProperty(e,i,"disallowIn"),copyProperty(e,i,"disallowChildren"),copyProperty(e,i,"allowContentOf"),copyProperty(e,i,"allowWhere"),copyProperty(e,i,"allowAttributes"),copyProperty(e,i,"disallowAttributes"),copyProperty(e,i,"allowAttributesOf"),copyProperty(e,i,"inheritTypesFrom"),resolveInheritAll(e,i),i}function propagateAllowIn(e,t){for(const i of t.allowIn){const r=e[i];r?r.allowChildren.add(t.name):t.allowIn.delete(i)}}function propagateAllowChildren(e,t){for(const i of t.allowChildren){const r=e[i];r?r.allowIn.add(t.name):t.allowChildren.delete(i)}}function propagateDisallowIn(e,t){for(const i of t.disallowIn){const r=e[i];r?r.disallowChildren.add(t.name):t.disallowIn.delete(i)}}function propagateDisallowChildren(e,t){for(const i of t.disallowChildren){const r=e[i];r?r.disallowIn.add(t.name):t.disallowChildren.delete(i)}}function resolveDisallows(e,t){for(const i of t.disallowChildren)t.allowChildren.delete(i);for(const i of t.disallowIn)t.allowIn.delete(i);for(const i of t.disallowAttributes)t.allowAttributes.delete(i)}function compileAllowContentOf(e,t){for(const i of t.allowContentOf){const r=e[i];r&&(r.disallowChildren.forEach(o=>{t.allowChildren.has(o)||(t.disallowChildren.add(o),e[o].disallowIn.add(t.name))}),r.allowChildren.forEach(o=>{t.disallowChildren.has(o)||(t.allowChildren.add(o),e[o].allowIn.add(t.name))}))}}function compileAllowWhere(e,t){for(const i of t.allowWhere){const r=e[i];r&&(r.disallowIn.forEach(o=>{t.allowIn.has(o)||(t.disallowIn.add(o),e[o].disallowChildren.add(t.name))}),r.allowIn.forEach(o=>{t.disallowIn.has(o)||(t.allowIn.add(o),e[o].allowChildren.add(t.name))}))}}function compileDefinitions(e){const t={};for(const i of Object.values(e))t[i.name]={name:i.name,isBlock:!!i.isBlock,isContent:!!i.isContent,isInline:!!i.isInline,isLimit:!!i.isLimit,isObject:!!i.isObject,isSelectable:!!i.isSelectable,allowIn:Array.from(i.allowIn).filter(r=>!!e[r]),allowChildren:Array.from(i.allowChildren).filter(r=>!!e[r]),allowAttributes:Array.from(i.allowAttributes)};return t}function compileAllowAttributesOf(e,t){for(const i of t.allowAttributesOf){const r=e[i];if(!r)return;r.allowAttributes.forEach(o=>{t.disallowAttributes.has(o)||t.allowAttributes.add(o)})}}function compileInheritPropertiesFrom(e,t){for(const i of t.inheritTypesFrom){const r=e[i];if(r){const o=Object.keys(r).filter(a=>a.startsWith("is"));for(const a of o)a in t||(t[a]=r[a])}}}function copyTypes(e,t){for(const i of e){const r=Object.keys(i).filter(o=>o.startsWith("is"));for(const o of r)t[o]=!!i[o]}}function copyProperty(e,t,i){for(const r of e){let o=r[i];typeof o=="string"&&(o=[o]),Array.isArray(o)&&o.forEach(a=>t[i].add(a))}}function resolveInheritAll(e,t){for(const i of e){const r=i.inheritAllFrom;r&&(t.allowContentOf.add(r),t.allowWhere.add(r),t.allowAttributesOf.add(r),t.inheritTypesFrom.add(r))}}function mapContextItem(e){return typeof e=="string"||e.is("documentFragment")?{name:typeof e=="string"?e:"$documentFragment",*getAttributeKeys(){},getAttribute(){}}:{name:e.is("element")?e.name:"$text",*getAttributeKeys(){yield*e.getAttributeKeys()},getAttribute(t){return e.getAttribute(t)}}}function*combineWalkers(e,t){let i=!1;for(;!i;){if(i=!0,e){const r=e.next();r.done||(i=!1,yield{walker:e,value:r.value})}if(t){const r=t.next();r.done||(i=!1,yield{walker:t,value:r.value})}}}function*convertToMinimalFlatRanges(e){for(const t of e)yield*t.getMinimalFlatRanges()}function removeDisallowedAttributeFromNode(e,t,i){for(const r of t.getAttributeKeys())e.checkAttribute(t,r)||i.removeAttribute(r,t)}var UpcastDispatcher=class extends EmitterMixin(){conversionApi;_splitParts=new Map;_cursorParents=new Map;_modelCursor=null;_emptyElementsToKeep=new Set;constructor(e){super(),this.conversionApi={...e,consumable:null,writer:null,store:null,convertItem:(t,i)=>this._convertItem(t,i),convertChildren:(t,i)=>this._convertChildren(t,i),safeInsert:(t,i)=>this._safeInsert(t,i),updateConversionResult:(t,i)=>this._updateConversionResult(t,i),splitToAllowedParent:(t,i)=>this._splitToAllowedParent(t,i),getSplitParts:t=>this._getSplitParts(t),keepEmptyElement:t=>this._keepEmptyElement(t)}}convert(e,t,i=["$root"]){this.fire("viewCleanup",e),this._modelCursor=createContextTree(i,t),this.conversionApi.writer=t,this.conversionApi.consumable=ViewConsumable.createFrom(e),this.conversionApi.store={};const{modelRange:r}=this._convertItem(e,this._modelCursor),o=t.createDocumentFragment();if(r){this._removeEmptyElements();const a=this._modelCursor.parent,c=a._removeChildren(0,a.childCount);o._insertChild(0,c),o.markers=extractMarkersFromModelFragment(o,t)}return this._modelCursor=null,this._splitParts.clear(),this._cursorParents.clear(),this._emptyElementsToKeep.clear(),this.conversionApi.writer=null,this.conversionApi.store=null,o}_convertItem(e,t){const i={viewItem:e,modelCursor:t,modelRange:null};if(e.is("element")?this.fire(`element:${e.name}`,i,this.conversionApi):e.is("$text")?this.fire("text",i,this.conversionApi):this.fire("documentFragment",i,this.conversionApi),i.modelRange&&!(i.modelRange instanceof Range))throw new CKEditorError("view-conversion-dispatcher-incorrect-result",this);return{modelRange:i.modelRange,modelCursor:i.modelCursor}}_convertChildren(e,t){let i=t.is("position")?t:Position._createAt(t,0);const r=new Range(i);for(const o of Array.from(e.getChildren())){const a=this._convertItem(o,i);a.modelRange instanceof Range&&(r.end=a.modelRange.end,i=a.modelCursor)}return{modelRange:r,modelCursor:i}}_safeInsert(e,t){const i=this._splitToAllowedParent(e,t);return i?(this.conversionApi.writer.insert(e,i.position),!0):!1}_updateConversionResult(e,t){const i=this._getSplitParts(e),r=this.conversionApi.writer;t.modelRange||(t.modelRange=r.createRange(r.createPositionBefore(e),r.createPositionAfter(i[i.length-1])));const o=this._cursorParents.get(e);o?t.modelCursor=r.createPositionAt(o,0):t.modelCursor=t.modelRange.end}_splitToAllowedParent(e,t){const{schema:i,writer:r}=this.conversionApi;let o=i.findAllowedParent(t,e);if(o){if(o===t.parent)return{position:t};this._modelCursor.parent.getAncestors().includes(o)&&(o=null)}if(!o)return isParagraphable(t,e,i)?{position:wrapInParagraph(t,r)}:null;const a=this.conversionApi.writer.split(t,o),c=[];for(const h of a.range.getWalker())if(h.type=="elementEnd")c.push(h.item);else{const d=c.pop(),f=h.item;this._registerSplitPair(d,f)}const u=a.range.end.parent;return this._cursorParents.set(e,u),{position:a.position,cursorParent:u}}_registerSplitPair(e,t){this._splitParts.has(e)||this._splitParts.set(e,[e]);const i=this._splitParts.get(e);this._splitParts.set(t,i),i.push(t)}_getSplitParts(e){let t;return this._splitParts.has(e)?t=this._splitParts.get(e):t=[e],t}_keepEmptyElement(e){this._emptyElementsToKeep.add(e)}_removeEmptyElements(){const e=new Map;for(const t of this._splitParts.keys())if(t.isEmpty&&!this._emptyElementsToKeep.has(t)){const i=e.get(t.parent)||[];i.push(t),this._splitParts.delete(t),e.set(t.parent,i)}for(const[t,i]of e)t._removeChildrenArray(i);e.size&&this._removeEmptyElements()}};function extractMarkersFromModelFragment(e,t){const i=new Set,r=new Map,o=Range._createIn(e).getItems();for(const a of o)a.is("element","$marker")&&i.add(a);for(const a of i){const c=a.getAttribute("data-name"),u=t.createPositionBefore(a);r.has(c)?r.get(c).end=u.clone():r.set(c,new Range(u.clone())),t.remove(a)}return r}function createContextTree(e,t){let i;for(const r of new SchemaContext(e)){const o={};for(const c of r.getAttributeKeys())o[c]=r.getAttribute(c);const a=t.createElement(r.name,o);i&&t.insert(a,i),i=Position._createAt(a,0)}return i}var BasicHtmlWriter=class{getHtml(e){const i=global$1.document.implementation.createHTMLDocument("").createElement("div");return i.appendChild(e),i.innerHTML}},HtmlDataProcessor=class{domParser;domConverter;htmlWriter;skipComments=!0;constructor(e){this.domParser=new DOMParser,this.domConverter=new DomConverter(e,{renderingMode:"data"}),this.htmlWriter=new BasicHtmlWriter}toData(e){const t=this.domConverter.viewToDom(e);return this.htmlWriter.getHtml(t)}toView(e){const t=this._toDom(e);return this.domConverter.domToView(t,{skipComments:this.skipComments})}registerRawContentMatcher(e){this.domConverter.registerRawContentMatcher(e)}useFillerType(e){this.domConverter.blockFillerMode=e=="marked"?"markedNbsp":"nbsp"}_toDom(e){/<(?:html|body|head|meta)(?:\s[^>]*)?>/i.test(e.trim().slice(0,1e4))||(e=`<body>${e}</body>`);const t=this.domParser.parseFromString(e,"text/html"),i=t.createDocumentFragment(),r=t.body.childNodes;for(;r.length>0;)i.appendChild(r[0]);return i}},DataController=class extends EmitterMixin(){model;mapper;downcastDispatcher;upcastDispatcher;viewDocument;stylesProcessor;htmlProcessor;processor;_viewWriter;constructor(e,t){super(),this.model=e,this.mapper=new Mapper,this.downcastDispatcher=new DowncastDispatcher({mapper:this.mapper,schema:e.schema}),this.downcastDispatcher.on("insert:$text",insertText(),{priority:"lowest"}),this.downcastDispatcher.on("insert",insertAttributesAndChildren(),{priority:"lowest"}),this.upcastDispatcher=new UpcastDispatcher({schema:e.schema}),this.viewDocument=new Document$1(t),this.stylesProcessor=t,this.htmlProcessor=new HtmlDataProcessor(this.viewDocument),this.processor=this.htmlProcessor,this._viewWriter=new DowncastWriter(this.viewDocument),this.upcastDispatcher.on("text",convertText(),{priority:"lowest"}),this.upcastDispatcher.on("element",convertToModelFragment$1(),{priority:"lowest"}),this.upcastDispatcher.on("documentFragment",convertToModelFragment$1(),{priority:"lowest"}),ObservableMixin().prototype.decorate.call(this,"init"),ObservableMixin().prototype.decorate.call(this,"set"),ObservableMixin().prototype.decorate.call(this,"get"),ObservableMixin().prototype.decorate.call(this,"toView"),ObservableMixin().prototype.decorate.call(this,"toModel"),this.on("init",()=>{this.fire("ready")},{priority:"lowest"}),this.on("ready",()=>{this.model.enqueueChange({isUndoable:!1},autoParagraphEmptyRoots)},{priority:"lowest"})}get(e={}){const{rootName:t="main",trim:i="empty"}=e;if(!this._checkIfRootsExists([t]))throw new CKEditorError("datacontroller-get-non-existent-root",this);const r=this.model.document.getRoot(t);return r.isAttached()||logWarning("datacontroller-get-detached-root",this),i==="empty"&&!this.model.hasContent(r,{ignoreWhitespaces:!0})?"":this.stringify(r,e)}stringify(e,t={}){const i=this.toView(e,t);return this.processor.toData(i)}toView(e,t={}){const i=this.viewDocument,r=this._viewWriter;this.mapper.clearBindings();const o=Range._createIn(e),a=new DocumentFragment$1(i);this.mapper.bindElements(e,a);const c=e.is("documentFragment")?e.markers:_getMarkersRelativeToElement(e);return this.downcastDispatcher.convert(o,c,r,t),a}init(e){if(this.model.document.version)throw new CKEditorError("datacontroller-init-document-not-empty",this);let t={};if(typeof e=="string"?t.main=e:t=e,!this._checkIfRootsExists(Object.keys(t)))throw new CKEditorError("datacontroller-init-non-existent-root",this);return this.model.enqueueChange({isUndoable:!1},i=>{for(const r of Object.keys(t)){const o=this.model.document.getRoot(r);i.insert(this.parse(t[r],o),o,0)}}),Promise.resolve()}set(e,t={}){let i={};if(typeof e=="string"?i.main=e:i=e,!this._checkIfRootsExists(Object.keys(i)))throw new CKEditorError("datacontroller-set-non-existent-root",this);this.model.enqueueChange(t.batchType||{},r=>{r.setSelection(null),r.removeSelectionAttribute(this.model.document.selection.getAttributeKeys());for(const o of Object.keys(i)){const a=this.model.document.getRoot(o);r.remove(r.createRangeIn(a)),r.insert(this.parse(i[o],a),a,0)}})}parse(e,t="$root"){const i=this.processor.toView(e);return this.toModel(i,t)}toModel(e,t="$root"){return this.model.change(i=>this.upcastDispatcher.convert(e,i,t))}addStyleProcessorRules(e){e(this.stylesProcessor)}registerRawContentMatcher(e){this.processor&&this.processor!==this.htmlProcessor&&this.processor.registerRawContentMatcher(e),this.htmlProcessor.registerRawContentMatcher(e)}destroy(){this.stopListening()}_checkIfRootsExists(e){for(const t of e)if(!this.model.document.getRoot(t))return!1;return!0}};function _getMarkersRelativeToElement(e){const t=[],i=e.root.document;if(!i)return new Map;const r=Range._createIn(e);for(const o of i.model.markers){const a=o.getRange(),c=a.isCollapsed,u=a.start.isEqual(r.start)||a.end.isEqual(r.end);if(c&&u)t.push([o.name,a]);else{const h=r.getIntersection(a);h&&t.push([o.name,h])}}return t.sort(([o,a],[c,u])=>{if(a.end.compareWith(u.start)!=="after")return 1;if(a.start.compareWith(u.end)!=="before")return-1;switch(a.start.compareWith(u.start)){case"before":return 1;case"after":return-1;default:switch(a.end.compareWith(u.end)){case"before":return 1;case"after":return-1;default:return c.localeCompare(o)}}}),new Map(t)}var Conversion=class{_helpers=new Map;_downcast;_upcast;constructor(e,t){this._downcast=toArray$1(e),this._createConversionHelpers({name:"downcast",dispatchers:this._downcast,isDowncast:!0}),this._upcast=toArray$1(t),this._createConversionHelpers({name:"upcast",dispatchers:this._upcast,isDowncast:!1})}addAlias(e,t){const i=this._downcast.includes(t);if(!this._upcast.includes(t)&&!i)throw new CKEditorError("conversion-add-alias-dispatcher-not-registered",this);this._createConversionHelpers({name:e,dispatchers:[t],isDowncast:i})}for(e){if(!this._helpers.has(e))throw new CKEditorError("conversion-for-unknown-group",this);return this._helpers.get(e)}elementToElement(e){this.for("downcast").elementToElement(e);for(const{model:t,view:i}of _getAllUpcastDefinitions(e))this.for("upcast").elementToElement({model:t,view:i,converterPriority:e.converterPriority})}attributeToElement(e){this.for("downcast").attributeToElement(e);for(const{model:t,view:i}of _getAllUpcastDefinitions(e))this.for("upcast").elementToAttribute({view:i,model:t,converterPriority:e.converterPriority})}attributeToAttribute(e){this.for("downcast").attributeToAttribute(e);for(const{model:t,view:i}of _getAllUpcastDefinitions(e))this.for("upcast").attributeToAttribute({view:i,model:t})}_createConversionHelpers({name:e,dispatchers:t,isDowncast:i}){if(this._helpers.has(e))throw new CKEditorError("conversion-group-exists",this);const r=i?new DowncastHelpers(t):new UpcastHelpers(t);this._helpers.set(e,r)}};function*_getAllUpcastDefinitions(e){if(e.model.values)for(const t of e.model.values){const i={key:e.model.key,value:t},r=e.view[t],o=e.upcastAlso?e.upcastAlso[t]:void 0;yield*_getUpcastDefinition(i,r,o)}else yield*_getUpcastDefinition(e.model,e.view,e.upcastAlso)}function*_getUpcastDefinition(e,t,i){if(yield{model:e,view:t},i)for(const r of toArray$1(i))yield{model:e,view:r}}var XmlDataProcessor=class{namespaces;domParser;domConverter;htmlWriter;skipComments=!0;constructor(e,t={}){this.namespaces=t.namespaces||[],this.domParser=new DOMParser,this.domConverter=new DomConverter(e,{renderingMode:"data"}),this.htmlWriter=new BasicHtmlWriter}toData(e){const t=this.domConverter.viewToDom(e);return this.htmlWriter.getHtml(t)}toView(e){const t=this._toDom(e);return this.domConverter.domToView(t,{keepOriginalCase:!0,skipComments:this.skipComments})}registerRawContentMatcher(e){this.domConverter.registerRawContentMatcher(e)}useFillerType(e){this.domConverter.blockFillerMode=e=="marked"?"markedNbsp":"nbsp"}_toDom(e){e=`<xml ${this.namespaces.map(c=>`xmlns:${c}="nsp"`).join(" ")}>${e}</xml>`;const i=this.domParser.parseFromString(e,"text/xml"),r=i.querySelector("parsererror");if(r)throw new Error("Parse error - "+r.textContent);const o=i.createDocumentFragment(),a=i.documentElement.childNodes;for(;a.length>0;)o.appendChild(a[0]);return o}},Operation=class{baseVersion;isDocumentOperation;batch;constructor(e){this.baseVersion=e,this.isDocumentOperation=this.baseVersion!==null,this.batch=null}_validate(){}toJSON(){const e=Object.assign({},this);return e.__className=this.constructor.className,delete e.batch,delete e.isDocumentOperation,e}static get className(){return"Operation"}static fromJSON(e,t){return new this(e.baseVersion)}};function _insert(e,t){const i=_normalizeNodes(t),r=i.reduce((c,u)=>c+u.offsetSize,0),o=e.parent;_splitNodeAtPosition(e);const a=e.index;return o._insertChild(a,i),_mergeNodesAtIndex(o,a+i.length),_mergeNodesAtIndex(o,a),new Range(e,e.getShiftedBy(r))}function _remove(e){if(!e.isFlat)throw new CKEditorError("operation-utils-remove-range-not-flat",this);const t=e.start.parent;_splitNodeAtPosition(e.start),_splitNodeAtPosition(e.end);const i=t._removeChildren(e.start.index,e.end.index-e.start.index);return _mergeNodesAtIndex(t,e.start.index),i}function _move(e,t){if(!e.isFlat)throw new CKEditorError("operation-utils-move-range-not-flat",this);const i=_remove(e);return t=t._getTransformedByDeletion(e.start,e.end.offset-e.start.offset),_insert(t,i)}function _setAttribute(e,t,i){_splitNodeAtPosition(e.start),_splitNodeAtPosition(e.end);for(const r of e.getItems({shallow:!0})){const o=r.is("$textProxy")?r.textNode:r;i!==null?o._setAttribute(t,i):o._removeAttribute(t),_mergeNodesAtIndex(o.parent,o.index)}_mergeNodesAtIndex(e.end.parent,e.end.index)}function _normalizeNodes(e){const t=[];function i(r){if(typeof r=="string")t.push(new Text(r));else if(r instanceof TextProxy)t.push(new Text(r.data,r.getAttributes()));else if(r instanceof Node$1$1)t.push(r);else if(isIterable(r))for(const o of r)i(o)}i(e);for(let r=1;r<t.length;r++){const o=t[r],a=t[r-1];o instanceof Text&&a instanceof Text&&_haveSameAttributes(o,a)&&(t.splice(r-1,2,new Text(a.data+o.data,a.getAttributes())),r--)}return t}function _mergeNodesAtIndex(e,t){const i=e.getChild(t-1),r=e.getChild(t);if(i&&r&&i.is("$text")&&r.is("$text")&&_haveSameAttributes(i,r)){const o=new Text(i.data+r.data,i.getAttributes());e._removeChildren(t-1,2),e._insertChild(t-1,o)}}function _splitNodeAtPosition(e){const t=e.textNode,i=e.parent;if(t){const r=e.offset-t.startOffset,o=t.index;i._removeChildren(o,1);const a=new Text(t.data.substr(0,r),t.getAttributes()),c=new Text(t.data.substr(r),t.getAttributes());i._insertChild(o,[a,c])}}function _haveSameAttributes(e,t){const i=e.getAttributes(),r=t.getAttributes();for(const o of i){if(o[1]!==t.getAttribute(o[0]))return!1;r.next()}return r.next().done}var MoveOperation=class dr extends Operation{sourcePosition;howMany;targetPosition;constructor(t,i,r,o){super(o),this.sourcePosition=t.clone(),this.sourcePosition.stickiness="toNext",this.howMany=i,this.targetPosition=r.clone(),this.targetPosition.stickiness="toNone"}get type(){return this.targetPosition.root.rootName=="$graveyard"?"remove":this.sourcePosition.root.rootName=="$graveyard"?"reinsert":"move"}get affectedSelectable(){return[Range._createFromPositionAndShift(this.sourcePosition,this.howMany),Range._createFromPositionAndShift(this.targetPosition,0)]}clone(){return new dr(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion)}getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}getReversed(){const t=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new dr(this.getMovedRangeStart(),this.howMany,t,this.baseVersion+1)}_validate(){const t=this.sourcePosition.parent,i=this.targetPosition.parent,r=this.sourcePosition.offset,o=this.targetPosition.offset;if(r+this.howMany>t.maxOffset)throw new CKEditorError("move-operation-nodes-do-not-exist",this);if(t===i&&r<o&&o<r+this.howMany)throw new CKEditorError("move-operation-range-into-itself",this);if(this.sourcePosition.root==this.targetPosition.root&&compareArrays(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())=="prefix"){const a=this.sourcePosition.path.length-1;if(this.targetPosition.path[a]>=r&&this.targetPosition.path[a]<r+this.howMany)throw new CKEditorError("move-operation-node-into-itself",this)}}_execute(){_move(Range._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition)}toJSON(){const t=super.toJSON();return t.sourcePosition=this.sourcePosition.toJSON(),t.targetPosition=this.targetPosition.toJSON(),t}static get className(){return"MoveOperation"}static fromJSON(t,i){const r=Position.fromJSON(t.sourcePosition,i),o=Position.fromJSON(t.targetPosition,i);return new this(r,t.howMany,o,t.baseVersion)}},InsertOperation=class fr extends Operation{position;nodes;shouldReceiveAttributes;constructor(t,i,r){super(r),this.position=t.clone(),this.position.stickiness="toNone",this.nodes=new NodeList(_normalizeNodes(i)),this.shouldReceiveAttributes=!1}get type(){return"insert"}get howMany(){return this.nodes.maxOffset}get affectedSelectable(){return this.position.clone()}clone(){const t=new NodeList([...this.nodes].map(r=>r._clone(!0))),i=new fr(this.position,t,this.baseVersion);return i.shouldReceiveAttributes=this.shouldReceiveAttributes,i}getReversed(){const t=this.position.root.document.graveyard,i=new Position(t,[0]);return new MoveOperation(this.position,this.nodes.maxOffset,i,this.baseVersion+1)}_validate(){const t=this.position.parent;if(!t||t.maxOffset<this.position.offset)throw new CKEditorError("insert-operation-position-invalid",this)}_execute(){const t=this.nodes;this.nodes=new NodeList([...t].map(i=>i._clone(!0))),_insert(this.position,t)}toJSON(){const t=super.toJSON();return t.position=this.position.toJSON(),t.nodes=this.nodes.toJSON(),t}static get className(){return"InsertOperation"}static fromJSON(t,i){const r=[];for(const a of t.nodes)a.name?r.push(Element$2.fromJSON(a)):r.push(Text.fromJSON(a));const o=new fr(Position.fromJSON(t.position,i),r,t.baseVersion);return o.shouldReceiveAttributes=t.shouldReceiveAttributes,o}},SplitOperation=class ys extends Operation{splitPosition;howMany;insertionPosition;graveyardPosition;constructor(t,i,r,o,a){super(a),this.splitPosition=t.clone(),this.splitPosition.stickiness="toNext",this.howMany=i,this.insertionPosition=r,this.graveyardPosition=o?o.clone():null,this.graveyardPosition&&(this.graveyardPosition.stickiness="toNext")}get type(){return"split"}get moveTargetPosition(){const t=this.insertionPosition.path.slice();return t.push(0),new Position(this.insertionPosition.root,t)}get movedRange(){const t=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new Range(this.splitPosition,t)}get affectedSelectable(){const t=[Range._createFromPositionAndShift(this.splitPosition,0),Range._createFromPositionAndShift(this.insertionPosition,0)];return this.graveyardPosition&&t.push(Range._createFromPositionAndShift(this.graveyardPosition,0)),t}clone(){return new ys(this.splitPosition,this.howMany,this.insertionPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const t=this.splitPosition.root.document.graveyard,i=new Position(t,[0]);return new MergeOperation(this.moveTargetPosition,this.howMany,this.splitPosition,i,this.baseVersion+1)}_validate(){const t=this.splitPosition.parent,i=this.splitPosition.offset;if(!t||t.maxOffset<i)throw new CKEditorError("split-operation-position-invalid",this);if(t.parent){if(this.howMany!=t.maxOffset-this.splitPosition.offset)throw new CKEditorError("split-operation-how-many-invalid",this);if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new CKEditorError("split-operation-graveyard-position-invalid",this)}else throw new CKEditorError("split-operation-split-in-root",this)}_execute(){const t=this.splitPosition.parent;if(this.graveyardPosition)_move(Range._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{const r=t._clone();_insert(this.insertionPosition,r)}const i=new Range(Position._createAt(t,this.splitPosition.offset),Position._createAt(t,t.maxOffset));_move(i,this.moveTargetPosition)}toJSON(){const t=super.toJSON();return t.splitPosition=this.splitPosition.toJSON(),t.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(t.graveyardPosition=this.graveyardPosition.toJSON()),t}static get className(){return"SplitOperation"}static getInsertionPosition(t){const i=t.path.slice(0,-1);return i[i.length-1]++,new Position(t.root,i,"toPrevious")}static fromJSON(t,i){const r=Position.fromJSON(t.splitPosition,i),o=Position.fromJSON(t.insertionPosition,i),a=t.graveyardPosition?Position.fromJSON(t.graveyardPosition,i):null;return new this(r,t.howMany,o,a,t.baseVersion)}},MergeOperation=class bs extends Operation{sourcePosition;howMany;targetPosition;graveyardPosition;constructor(t,i,r,o,a){super(a),this.sourcePosition=t.clone(),this.sourcePosition.stickiness="toPrevious",this.howMany=i,this.targetPosition=r.clone(),this.targetPosition.stickiness="toNext",this.graveyardPosition=o.clone()}get type(){return"merge"}get deletionPosition(){return new Position(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1))}get movedRange(){const t=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new Range(this.sourcePosition,t)}get affectedSelectable(){const t=this.sourcePosition.parent;return[Range._createOn(t),Range._createFromPositionAndShift(this.targetPosition,0),Range._createFromPositionAndShift(this.graveyardPosition,0)]}clone(){return new bs(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const t=this.targetPosition._getTransformedByMergeOperation(this),i=this.sourcePosition.path.slice(0,-1),r=new Position(this.sourcePosition.root,i)._getTransformedByMergeOperation(this);return new SplitOperation(t,this.howMany,r,this.graveyardPosition,this.baseVersion+1)}_validate(){const t=this.sourcePosition.parent,i=this.targetPosition.parent;if(t.parent)if(i.parent){if(this.howMany!=t.maxOffset)throw new CKEditorError("merge-operation-how-many-invalid",this)}else throw new CKEditorError("merge-operation-target-position-invalid",this);else throw new CKEditorError("merge-operation-source-position-invalid",this)}_execute(){const t=this.sourcePosition.parent,i=Range._createIn(t);_move(i,this.targetPosition),_move(Range._createOn(t),this.graveyardPosition)}toJSON(){const t=super.toJSON();return t.sourcePosition=t.sourcePosition.toJSON(),t.targetPosition=t.targetPosition.toJSON(),t.graveyardPosition=t.graveyardPosition.toJSON(),t}static get className(){return"MergeOperation"}static fromJSON(t,i){const r=Position.fromJSON(t.sourcePosition,i),o=Position.fromJSON(t.targetPosition,i),a=Position.fromJSON(t.graveyardPosition,i);return new this(r,t.howMany,o,a,t.baseVersion)}},MarkerOperation=class Oi extends Operation{name;oldRange;newRange;affectsData;_markers;constructor(t,i,r,o,a,c){super(c),this.name=t,this.oldRange=i?i.clone():null,this.newRange=r?r.clone():null,this.affectsData=a,this._markers=o}get type(){return"marker"}get affectedSelectable(){const t=[];return this.oldRange&&t.push(this.oldRange.clone()),this.newRange&&(this.oldRange?t.push(...this.newRange.getDifference(this.oldRange)):t.push(this.newRange.clone())),t}clone(){return new Oi(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion)}getReversed(){return new Oi(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1)}_execute(){this.newRange?this._markers._set(this.name,this.newRange,!0,this.affectsData):this._markers._remove(this.name)}toJSON(){const t=super.toJSON();return this.oldRange&&(t.oldRange=this.oldRange.toJSON()),this.newRange&&(t.newRange=this.newRange.toJSON()),delete t._markers,t}static get className(){return"MarkerOperation"}static fromJSON(t,i){return new Oi(t.name,t.oldRange?Range.fromJSON(t.oldRange,i):null,t.newRange?Range.fromJSON(t.newRange,i):null,i.model.markers,t.affectsData,t.baseVersion)}},AttributeOperation=class Pi extends Operation{range;key;oldValue;newValue;constructor(t,i,r,o,a){super(a),this.range=t.clone(),this.key=i,this.oldValue=r===void 0?null:r,this.newValue=o===void 0?null:o}get type(){return this.oldValue===null?"addAttribute":this.newValue===null?"removeAttribute":"changeAttribute"}get affectedSelectable(){return this.range.clone()}clone(){return new Pi(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new Pi(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}toJSON(){const t=super.toJSON();return t.range=this.range.toJSON(),t}_validate(){if(!this.range.isFlat)throw new CKEditorError("attribute-operation-range-not-flat",this);for(const t of this.range.getItems({shallow:!0})){if(this.oldValue!==null&&!isEqual_default(t.getAttribute(this.key),this.oldValue))throw new CKEditorError("attribute-operation-wrong-old-value",this,{item:t,key:this.key,value:this.oldValue});if(this.oldValue===null&&this.newValue!==null&&t.hasAttribute(this.key))throw new CKEditorError("attribute-operation-attribute-exists",this,{node:t,key:this.key})}}_execute(){isEqual_default(this.oldValue,this.newValue)||_setAttribute(this.range,this.key,this.newValue)}static get className(){return"AttributeOperation"}static fromJSON(t,i){return new Pi(Range.fromJSON(t.range,i),t.key,t.oldValue,t.newValue,t.baseVersion)}},NoOperation=class mr extends Operation{get type(){return"noop"}get affectedSelectable(){return null}clone(){return new mr(this.baseVersion)}getReversed(){return new mr(this.baseVersion+1)}_execute(){}static get className(){return"NoOperation"}},RenameOperation=class Ai extends Operation{position;oldName;newName;constructor(t,i,r,o){super(o),this.position=t,this.position.stickiness="toNext",this.oldName=i,this.newName=r}get type(){return"rename"}get affectedSelectable(){return this.position.nodeAfter}clone(){return new Ai(this.position.clone(),this.oldName,this.newName,this.baseVersion)}getReversed(){return new Ai(this.position.clone(),this.newName,this.oldName,this.baseVersion+1)}_validate(){const t=this.position.nodeAfter;if(t instanceof Element$2){if(t.name!==this.oldName)throw new CKEditorError("rename-operation-wrong-name",this)}else throw new CKEditorError("rename-operation-wrong-position",this)}_execute(){const t=this.position.nodeAfter;t.name=this.newName}toJSON(){const t=super.toJSON();return t.position=this.position.toJSON(),t}static get className(){return"RenameOperation"}static fromJSON(t,i){return new Ai(Position.fromJSON(t.position,i),t.oldName,t.newName,t.baseVersion)}},RootAttributeOperation=class Ii extends Operation{root;key;oldValue;newValue;constructor(t,i,r,o,a){super(a),this.root=t,this.key=i,this.oldValue=r===void 0?null:r,this.newValue=o===void 0?null:o}get type(){return this.oldValue===null?"addRootAttribute":this.newValue===null?"removeRootAttribute":"changeRootAttribute"}get affectedSelectable(){return this.root}clone(){return new Ii(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new Ii(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_validate(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new CKEditorError("rootattribute-operation-not-a-root",this,{root:this.root,key:this.key});if(this.oldValue!==null&&this.root.getAttribute(this.key)!==this.oldValue)throw new CKEditorError("rootattribute-operation-wrong-old-value",this,{root:this.root,key:this.key});if(this.oldValue===null&&this.newValue!==null&&this.root.hasAttribute(this.key))throw new CKEditorError("rootattribute-operation-attribute-exists",this,{root:this.root,key:this.key})}_execute(){this.newValue!==null?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key)}toJSON(){const t=super.toJSON();return t.root=this.root.toJSON(),t}static get className(){return"RootAttributeOperation"}static fromJSON(t,i){if(!i.getRoot(t.root))throw new CKEditorError("rootattribute-operation-fromjson-no-root",this,{rootName:t.root});return new Ii(i.getRoot(t.root),t.key,t.oldValue,t.newValue,t.baseVersion)}},RootOperation=class Ni extends Operation{rootName;elementName;isAdd;_document;constructor(t,i,r,o,a){if(super(a),this.rootName=t,this.elementName=i,this.isAdd=r,this._document=o,!this._document.getRoot(this.rootName)){const c=this._document.createRoot(this.elementName,this.rootName);c._isAttached=!1}}get type(){return this.isAdd?"addRoot":"detachRoot"}get affectedSelectable(){return this._document.getRoot(this.rootName)}clone(){return new Ni(this.rootName,this.elementName,this.isAdd,this._document,this.baseVersion)}getReversed(){return new Ni(this.rootName,this.elementName,!this.isAdd,this._document,this.baseVersion+1)}_execute(){this._document.getRoot(this.rootName)._isAttached=this.isAdd}toJSON(){const t=super.toJSON();return delete t._document,t}static get className(){return"RootOperation"}static fromJSON(t,i){return new Ni(t.rootName,t.elementName,t.isAdd,i,t.baseVersion)}};const operations={};operations[AttributeOperation.className]=AttributeOperation,operations[InsertOperation.className]=InsertOperation,operations[MarkerOperation.className]=MarkerOperation,operations[MoveOperation.className]=MoveOperation,operations[NoOperation.className]=NoOperation,operations[Operation.className]=Operation,operations[RenameOperation.className]=RenameOperation,operations[RootAttributeOperation.className]=RootAttributeOperation,operations[RootOperation.className]=RootOperation,operations[SplitOperation.className]=SplitOperation,operations[MergeOperation.className]=MergeOperation;var OperationFactory=class{static fromJSON(e,t){return operations[e.__className].fromJSON(e,t)}};const transformations=new Map;function setTransformation(e,t,i){let r=transformations.get(e);r||(r=new Map,transformations.set(e,r)),r.set(t,i)}function getTransformation(e,t){const i=transformations.get(e);return i&&i.has(t)?i.get(t):noUpdateTransformation}function noUpdateTransformation(e){return[e]}function transform$1(e,t,i={}){const r=getTransformation(e.constructor,t.constructor);try{return e=e.clone(),r(e,t,i)}catch(o){throw o}}function transformSets(e,t,i){e=e.slice(),t=t.slice();const r=new ContextFactory(i.document,i.useRelations,i.forceWeakRemove);r.setOriginalOperations(e),r.setOriginalOperations(t);const o=r.originalOperations;if(e.length==0||t.length==0)return{operationsA:e,operationsB:t,originalOperations:o};const a=new WeakMap;for(const h of e)a.set(h,0);const c={nextBaseVersionA:e[e.length-1].baseVersion+1,nextBaseVersionB:t[t.length-1].baseVersion+1,originalOperationsACount:e.length,originalOperationsBCount:t.length};let u=0;for(;u<e.length;){const h=e[u],d=a.get(h);if(d==t.length){u++;continue}const f=t[d],m=transform$1(h,f,r.getContext(h,f,!0)),g=transform$1(f,h,r.getContext(f,h,!1));r.updateRelation(h,f),r.setOriginalOperations(m,h),r.setOriginalOperations(g,f);for(const v of m)a.set(v,d+g.length);e.splice(u,1,...m),t.splice(d,1,...g)}if(handlePartialMarkerOperations(e),handlePartialMarkerOperations(t),i.padWithNoOps){const h=e.length-c.originalOperationsACount,d=t.length-c.originalOperationsBCount;padWithNoOps(e,d-h),padWithNoOps(t,h-d)}return updateBaseVersions(e,c.nextBaseVersionB),updateBaseVersions(t,c.nextBaseVersionA),{operationsA:e,operationsB:t,originalOperations:o}}var ContextFactory=class{originalOperations;_history;_useRelations;_forceWeakRemove;_relations;constructor(e,t,i=!1){this.originalOperations=new Map,this._history=e.history,this._useRelations=t,this._forceWeakRemove=!!i,this._relations=new Map}setOriginalOperations(e,t=null){const i=t?this.originalOperations.get(t):null;for(const r of e)this.originalOperations.set(r,i||r)}updateRelation(e,t){if(e instanceof MoveOperation)t instanceof MergeOperation?e.targetPosition.isEqual(t.sourcePosition)||t.movedRange.containsPosition(e.targetPosition)?this._setRelation(e,t,"insertAtSource"):e.targetPosition.isEqual(t.deletionPosition)?this._setRelation(e,t,"insertBetween"):e.targetPosition.isAfter(t.sourcePosition)&&this._setRelation(e,t,"moveTargetAfter"):t instanceof MoveOperation&&(e.targetPosition.isEqual(t.sourcePosition)||e.targetPosition.isBefore(t.sourcePosition)?this._setRelation(e,t,"insertBefore"):this._setRelation(e,t,"insertAfter"));else if(e instanceof SplitOperation){if(t instanceof MergeOperation)e.splitPosition.isBefore(t.sourcePosition)&&this._setRelation(e,t,"splitBefore");else if(t instanceof MoveOperation)if(e.splitPosition.isEqual(t.sourcePosition)||e.splitPosition.isBefore(t.sourcePosition))this._setRelation(e,t,"splitBefore");else{const i=Range._createFromPositionAndShift(t.sourcePosition,t.howMany);if(e.splitPosition.hasSameParentAs(t.sourcePosition)&&i.containsPosition(e.splitPosition)){const r=i.end.offset-e.splitPosition.offset,o=e.splitPosition.offset-i.start.offset;this._setRelation(e,t,{howMany:r,offset:o})}}}else if(e instanceof MergeOperation)t instanceof MergeOperation?(e.targetPosition.isEqual(t.sourcePosition)||this._setRelation(e,t,"mergeTargetNotMoved"),e.sourcePosition.isEqual(t.targetPosition)&&this._setRelation(e,t,"mergeSourceNotMoved"),e.sourcePosition.isEqual(t.sourcePosition)&&this._setRelation(e,t,"mergeSameElement")):t instanceof SplitOperation?e.sourcePosition.isEqual(t.splitPosition)&&this._setRelation(e,t,"splitAtSource"):t instanceof MoveOperation&&t.howMany>0&&(e.sourcePosition.isEqual(t.sourcePosition.getShiftedBy(t.howMany))&&this._setRelation(e,t,"mergeSourceAffected"),e.targetPosition.isEqual(t.sourcePosition)&&this._setRelation(e,t,"mergeTargetWasBefore"));else if(e instanceof MarkerOperation){const i=e.newRange;if(!i)return;if(t instanceof MergeOperation){const r=i.start.isEqual(t.targetPosition),o=i.start.isEqual(t.deletionPosition),a=i.end.isEqual(t.deletionPosition),c=i.end.isEqual(t.sourcePosition);(r||o||a||c)&&this._setRelation(e,t,{wasInLeftElement:r,wasStartBeforeMergedElement:o,wasEndBeforeMergedElement:a,wasInRightElement:c})}}}getContext(e,t,i){return{aIsStrong:i,aWasUndone:this._wasUndone(e),bWasUndone:this._wasUndone(t),abRelation:this._useRelations?this._getRelation(e,t):null,baRelation:this._useRelations?this._getRelation(t,e):null,forceWeakRemove:this._forceWeakRemove}}_wasUndone(e){const t=this.originalOperations.get(e);return t.wasUndone||this._history.isUndoneOperation(t)}_getRelation(e,t){const i=this.originalOperations.get(t),r=this._history.getUndoneOperation(i);if(!r)return null;const o=this.originalOperations.get(e),a=this._relations.get(o);return a&&a.get(r)||null}_setRelation(e,t,i){const r=this.originalOperations.get(e),o=this.originalOperations.get(t);let a=this._relations.get(r);a||(a=new Map,this._relations.set(r,a)),a.set(o,i)}};function updateBaseVersions(e,t){for(const i of e)i.baseVersion=t++}function padWithNoOps(e,t){for(let i=0;i<t;i++)e.push(new NoOperation(0))}function handlePartialMarkerOperations(e){const t=new Map;for(let i=0;i<e.length;i++){const r=e[i];r instanceof MarkerOperation&&(r.baseVersion!==-1?t.set(r.name,{op:r,ranges:r.newRange?[r.newRange]:[]}):(r.newRange&&t.get(r.name).ranges.push(r.newRange),e.splice(i,1),i--))}for(const{op:i,ranges:r}of t.values())r.length?i.newRange=Range._createFromRanges(r):i.newRange=null}setTransformation(AttributeOperation,AttributeOperation,(e,t,i)=>{if(e.key===t.key&&e.range.start.hasSameParentAs(t.range.start)){const r=e.range.getDifference(t.range).map(a=>new AttributeOperation(a,e.key,e.oldValue,e.newValue,0)),o=e.range.getIntersection(t.range);return o&&i.aIsStrong&&r.push(new AttributeOperation(o,t.key,t.newValue,e.newValue,0)),r.length==0?[new NoOperation(0)]:r}else return[e]}),setTransformation(AttributeOperation,InsertOperation,(e,t)=>{if(e.range.start.hasSameParentAs(t.position)&&e.range.containsPosition(t.position)){const r=e.range._getTransformedByInsertion(t.position,t.howMany,!t.shouldReceiveAttributes).map(o=>new AttributeOperation(o,e.key,e.oldValue,e.newValue,e.baseVersion));if(t.shouldReceiveAttributes){const o=_getComplementaryAttributeOperations(t,e.key,e.oldValue);o&&r.unshift(o)}return r}return e.range=e.range._getTransformedByInsertion(t.position,t.howMany,!1)[0],[e]});function _getComplementaryAttributeOperations(e,t,i){const o=e.nodes.getNode(0).getAttribute(t);if(o==i)return null;const a=new Range(e.position,e.position.getShiftedBy(e.howMany));return new AttributeOperation(a,t,o,i,0)}setTransformation(AttributeOperation,MergeOperation,(e,t)=>{const i=[];e.range.start.hasSameParentAs(t.deletionPosition)&&(e.range.containsPosition(t.deletionPosition)||e.range.start.isEqual(t.deletionPosition))&&i.push(Range._createFromPositionAndShift(t.graveyardPosition,1));const r=e.range._getTransformedByMergeOperation(t);return r.isCollapsed||i.push(r),i.map(o=>new AttributeOperation(o,e.key,e.oldValue,e.newValue,e.baseVersion))}),setTransformation(AttributeOperation,MoveOperation,(e,t)=>_breakRangeByMoveOperation(e.range,t).map(r=>new AttributeOperation(r,e.key,e.oldValue,e.newValue,e.baseVersion)));function _breakRangeByMoveOperation(e,t){const i=Range._createFromPositionAndShift(t.sourcePosition,t.howMany);let r=null,o=[];i.containsRange(e,!0)?r=e:e.start.hasSameParentAs(i.start)?(o=e.getDifference(i),r=e.getIntersection(i)):o=[e];const a=[];for(let c of o){c=c._getTransformedByDeletion(t.sourcePosition,t.howMany);const u=t.getMovedRangeStart(),h=c.start.hasSameParentAs(u),d=c._getTransformedByInsertion(u,t.howMany,h);a.push(...d)}return r&&a.push(r._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany,!1)[0]),a}setTransformation(AttributeOperation,SplitOperation,(e,t)=>{if(e.range.end.isEqual(t.insertionPosition))return t.graveyardPosition||e.range.end.offset++,[e];if(e.range.start.hasSameParentAs(t.splitPosition)&&e.range.containsPosition(t.splitPosition)){const i=e.clone();return i.range=new Range(t.moveTargetPosition.clone(),e.range.end._getCombined(t.splitPosition,t.moveTargetPosition)),e.range.end=t.splitPosition.clone(),e.range.end.stickiness="toPrevious",[e,i]}return e.range=e.range._getTransformedBySplitOperation(t),[e]}),setTransformation(InsertOperation,AttributeOperation,(e,t)=>{const i=[e];if(e.shouldReceiveAttributes&&e.position.hasSameParentAs(t.range.start)&&t.range.containsPosition(e.position)){const r=_getComplementaryAttributeOperations(e,t.key,t.newValue);r&&i.push(r)}return i}),setTransformation(InsertOperation,InsertOperation,(e,t,i)=>e.position.isEqual(t.position)&&i.aIsStrong?[e]:(e.position=e.position._getTransformedByInsertOperation(t),[e])),setTransformation(InsertOperation,MoveOperation,(e,t)=>(e.position=e.position._getTransformedByMoveOperation(t),[e])),setTransformation(InsertOperation,SplitOperation,(e,t)=>(e.position=e.position._getTransformedBySplitOperation(t),[e])),setTransformation(InsertOperation,MergeOperation,(e,t)=>(e.position=e.position._getTransformedByMergeOperation(t),[e])),setTransformation(MarkerOperation,InsertOperation,(e,t)=>(e.oldRange&&(e.oldRange=e.oldRange._getTransformedByInsertOperation(t)[0]),e.newRange&&(e.newRange=e.newRange._getTransformedByInsertOperation(t)[0]),[e])),setTransformation(MarkerOperation,MarkerOperation,(e,t,i)=>{if(e.name==t.name)if(i.aIsStrong)e.oldRange=t.newRange?t.newRange.clone():null;else return[new NoOperation(0)];return[e]}),setTransformation(MarkerOperation,MergeOperation,(e,t)=>(e.oldRange&&(e.oldRange=e.oldRange._getTransformedByMergeOperation(t)),e.newRange&&(e.newRange=e.newRange._getTransformedByMergeOperation(t)),[e])),setTransformation(MarkerOperation,MoveOperation,(e,t)=>{const i=[e];if(e.oldRange&&(e.oldRange=Range._createFromRanges(e.oldRange._getTransformedByMoveOperation(t))),e.newRange){const r=e.newRange._getTransformedByMoveOperation(t);e.newRange=r[0];for(let o=1;o<r.length;o++){const a=e.clone();a.oldRange=null,a.newRange=r[o],a.baseVersion=-1,i.push(a)}}return i}),setTransformation(MarkerOperation,SplitOperation,(e,t,i)=>{if(e.oldRange&&(e.oldRange=e.oldRange._getTransformedBySplitOperation(t)),e.newRange){if(i.abRelation){const r=e.newRange._getTransformedBySplitOperation(t);return e.newRange.start.isEqual(t.splitPosition)&&i.abRelation.wasStartBeforeMergedElement?e.newRange.start=Position._createAt(t.insertionPosition):e.newRange.start.isEqual(t.splitPosition)&&!i.abRelation.wasInLeftElement?e.newRange.start=Position._createAt(t.moveTargetPosition):e.newRange.start=r.start,e.newRange.end.isEqual(t.splitPosition)&&i.abRelation.wasInRightElement?e.newRange.end=Position._createAt(t.moveTargetPosition):e.newRange.end.isEqual(t.splitPosition)&&i.abRelation.wasEndBeforeMergedElement?e.newRange.end=Position._createAt(t.insertionPosition):e.newRange.end=r.end,[e]}e.newRange=e.newRange._getTransformedBySplitOperation(t)}return[e]}),setTransformation(MergeOperation,InsertOperation,(e,t)=>(e.sourcePosition.hasSameParentAs(t.position)&&(e.howMany+=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByInsertOperation(t),e.targetPosition=e.targetPosition._getTransformedByInsertOperation(t),[e])),setTransformation(MergeOperation,MergeOperation,(e,t,i)=>{if(e.sourcePosition.isEqual(t.sourcePosition)&&e.targetPosition.isEqual(t.targetPosition))if(i.bWasUndone){const r=t.graveyardPosition.path.slice();return r.push(0),e.sourcePosition=new Position(t.graveyardPosition.root,r),e.howMany=0,[e]}else return[new NoOperation(0)];if(e.sourcePosition.isEqual(t.sourcePosition)&&!e.targetPosition.isEqual(t.targetPosition)&&!i.bWasUndone&&i.abRelation!="splitAtSource"){const r=e.targetPosition.root.rootName=="$graveyard",o=t.targetPosition.root.rootName=="$graveyard";if(o&&!r||!(r&&!o)&&i.aIsStrong){const h=t.targetPosition._getTransformedByMergeOperation(t),d=e.targetPosition._getTransformedByMergeOperation(t);return[new MoveOperation(h,e.howMany,d,0)]}else return[new NoOperation(0)]}return e.sourcePosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByMergeOperation(t),e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),(!e.graveyardPosition.isEqual(t.graveyardPosition)||!i.aIsStrong)&&(e.graveyardPosition=e.graveyardPosition._getTransformedByMergeOperation(t)),[e]}),setTransformation(MergeOperation,MoveOperation,(e,t,i)=>{const r=Range._createFromPositionAndShift(t.sourcePosition,t.howMany);return t.type=="remove"&&!i.bWasUndone&&e.deletionPosition.hasSameParentAs(t.sourcePosition)&&r.containsPosition(e.sourcePosition)?[new NoOperation(0)]:(t.sourcePosition.getShiftedBy(t.howMany).isEqual(e.sourcePosition)?e.sourcePosition.stickiness="toNone":t.targetPosition.isEqual(e.sourcePosition)&&i.abRelation=="mergeSourceAffected"?e.sourcePosition.stickiness="toNext":t.sourcePosition.isEqual(e.targetPosition)?(e.targetPosition.stickiness="toNone",e.howMany-=t.howMany):t.targetPosition.isEqual(e.targetPosition)&&i.abRelation=="mergeTargetWasBefore"?(e.targetPosition.stickiness="toPrevious",e.howMany+=t.howMany):(e.sourcePosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.sourcePosition.hasSameParentAs(t.sourcePosition)&&(e.howMany-=t.howMany)),e.sourcePosition=e.sourcePosition._getTransformedByMoveOperation(t),e.targetPosition=e.targetPosition._getTransformedByMoveOperation(t),e.sourcePosition.stickiness="toPrevious",e.targetPosition.stickiness="toNext",e.graveyardPosition.isEqual(t.targetPosition)||(e.graveyardPosition=e.graveyardPosition._getTransformedByMoveOperation(t)),[e])}),setTransformation(MergeOperation,SplitOperation,(e,t,i)=>{if(t.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedByDeletion(t.graveyardPosition,1),e.deletionPosition.isEqual(t.graveyardPosition)&&(e.howMany=t.howMany)),e.targetPosition.isEqual(t.splitPosition)&&(t.graveyardPosition&&e.deletionPosition.isEqual(t.graveyardPosition)||i.abRelation=="mergeTargetNotMoved"))return e.sourcePosition=e.sourcePosition._getTransformedBySplitOperation(t),[e];if(e.sourcePosition.isEqual(t.splitPosition)){if(i.abRelation=="mergeSourceNotMoved")return e.howMany=0,e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e];if(i.abRelation=="mergeSameElement"||e.sourcePosition.offset>0)return e.sourcePosition=t.moveTargetPosition.clone(),e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e]}return e.sourcePosition.hasSameParentAs(t.splitPosition)&&(e.howMany=t.splitPosition.offset),e.sourcePosition=e.sourcePosition._getTransformedBySplitOperation(t),e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e]}),setTransformation(MoveOperation,InsertOperation,(e,t)=>{const r=Range._createFromPositionAndShift(e.sourcePosition,e.howMany)._getTransformedByInsertOperation(t,!1)[0];return e.sourcePosition=r.start,e.howMany=r.end.offset-r.start.offset,e.targetPosition.isEqual(t.position)||(e.targetPosition=e.targetPosition._getTransformedByInsertOperation(t)),[e]}),setTransformation(MoveOperation,MoveOperation,(e,t,i)=>{const r=Range._createFromPositionAndShift(e.sourcePosition,e.howMany),o=Range._createFromPositionAndShift(t.sourcePosition,t.howMany);let a=i.aIsStrong,c=!i.aIsStrong;i.abRelation=="insertBefore"||i.baRelation=="insertAfter"?c=!0:(i.abRelation=="insertAfter"||i.baRelation=="insertBefore")&&(c=!1);let u;if(e.targetPosition.isEqual(t.targetPosition)&&c?u=e.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany):u=e.targetPosition._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),_moveTargetIntoMovedRange(e,t)&&_moveTargetIntoMovedRange(t,e))return[t.getReversed()];if(r.containsPosition(t.targetPosition)&&r.containsRange(o,!0))return r.start=r.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),r.end=r.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),_makeMoveOperationsFromRanges([r],u);if(o.containsPosition(e.targetPosition)&&o.containsRange(r,!0))return r.start=r.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),r.end=r.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),_makeMoveOperationsFromRanges([r],u);const f=compareArrays(e.sourcePosition.getParentPath(),t.sourcePosition.getParentPath());if(f=="prefix"||f=="extension")return r.start=r.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),r.end=r.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),_makeMoveOperationsFromRanges([r],u);e.type=="remove"&&t.type!="remove"&&!i.aWasUndone&&!i.forceWeakRemove?a=!0:e.type!="remove"&&t.type=="remove"&&!i.bWasUndone&&!i.forceWeakRemove&&(a=!1);const m=[],g=r.getDifference(o);for(const _ of g){_.start=_.start._getTransformedByDeletion(t.sourcePosition,t.howMany),_.end=_.end._getTransformedByDeletion(t.sourcePosition,t.howMany);const b=compareArrays(_.start.getParentPath(),t.getMovedRangeStart().getParentPath())=="same",S=_._getTransformedByInsertion(t.getMovedRangeStart(),t.howMany,b);m.push(...S)}const v=r.getIntersection(o);return v!==null&&a&&(v.start=v.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),v.end=v.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),m.length===0?m.push(v):m.length==1?o.start.isBefore(r.start)||o.start.isEqual(r.start)?m.unshift(v):m.push(v):m.splice(1,0,v)),m.length===0?[new NoOperation(e.baseVersion)]:_makeMoveOperationsFromRanges(m,u)}),setTransformation(MoveOperation,SplitOperation,(e,t,i)=>{let r=e.targetPosition.clone();(!e.targetPosition.isEqual(t.insertionPosition)||!t.graveyardPosition||i.abRelation=="moveTargetAfter")&&(r=e.targetPosition._getTransformedBySplitOperation(t));const o=Range._createFromPositionAndShift(e.sourcePosition,e.howMany);if(o.end.isEqual(t.insertionPosition))return t.graveyardPosition||e.howMany++,e.targetPosition=r,[e];if(o.start.hasSameParentAs(t.splitPosition)&&o.containsPosition(t.splitPosition)){let u=new Range(t.splitPosition,o.end);u=u._getTransformedBySplitOperation(t);const h=[new Range(o.start,t.splitPosition),u];return _makeMoveOperationsFromRanges(h,r)}e.targetPosition.isEqual(t.splitPosition)&&i.abRelation=="insertAtSource"&&(r=t.moveTargetPosition),e.targetPosition.isEqual(t.insertionPosition)&&i.abRelation=="insertBetween"&&(r=e.targetPosition);const c=[o._getTransformedBySplitOperation(t)];if(t.graveyardPosition){const u=o.start.isEqual(t.graveyardPosition)||o.containsPosition(t.graveyardPosition);e.howMany>1&&u&&!i.aWasUndone&&c.push(Range._createFromPositionAndShift(t.insertionPosition,1))}return _makeMoveOperationsFromRanges(c,r)}),setTransformation(MoveOperation,MergeOperation,(e,t,i)=>{const r=Range._createFromPositionAndShift(e.sourcePosition,e.howMany);if(t.deletionPosition.hasSameParentAs(e.sourcePosition)&&r.containsPosition(t.sourcePosition)){if(e.type=="remove"&&!i.forceWeakRemove){if(!i.aWasUndone){const c=[];let u=t.graveyardPosition.clone(),h=t.targetPosition._getTransformedByMergeOperation(t);const d=e.targetPosition.getTransformedByOperation(t);e.howMany>1&&(c.push(new MoveOperation(e.sourcePosition,e.howMany-1,d,0)),u=u._getTransformedByMove(e.sourcePosition,d,e.howMany-1),h=h._getTransformedByMove(e.sourcePosition,d,e.howMany-1));const f=t.deletionPosition._getCombined(e.sourcePosition,d),m=new MoveOperation(u,1,f,0),g=m.getMovedRangeStart().path.slice();g.push(0);const v=new Position(m.targetPosition.root,g);h=h._getTransformedByMove(u,f,1);const _=new MoveOperation(h,t.howMany,v,0);return c.push(m),c.push(_),c}}else if(e.howMany==1)return i.bWasUndone?(e.sourcePosition=t.graveyardPosition.clone(),e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),[e]):[new NoOperation(0)]}const a=Range._createFromPositionAndShift(e.sourcePosition,e.howMany)._getTransformedByMergeOperation(t);return e.sourcePosition=a.start,e.howMany=a.end.offset-a.start.offset,e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),[e]}),setTransformation(RenameOperation,InsertOperation,(e,t)=>(e.position=e.position._getTransformedByInsertOperation(t),[e])),setTransformation(RenameOperation,MergeOperation,(e,t)=>e.position.isEqual(t.deletionPosition)?(e.position=t.graveyardPosition.clone(),e.position.stickiness="toNext",[e]):(e.position=e.position._getTransformedByMergeOperation(t),[e])),setTransformation(RenameOperation,MoveOperation,(e,t)=>(e.position=e.position._getTransformedByMoveOperation(t),[e])),setTransformation(RenameOperation,RenameOperation,(e,t,i)=>{if(e.position.isEqual(t.position))if(i.aIsStrong)e.oldName=t.newName;else return[new NoOperation(0)];return[e]}),setTransformation(RenameOperation,SplitOperation,(e,t)=>{const i=e.position.path,r=t.splitPosition.getParentPath();if(compareArrays(i,r)=="same"&&!t.graveyardPosition){const o=new RenameOperation(e.position.getShiftedBy(1),e.oldName,e.newName,0);return[e,o]}return e.position=e.position._getTransformedBySplitOperation(t),[e]}),setTransformation(RootAttributeOperation,RootAttributeOperation,(e,t,i)=>{if(e.root===t.root&&e.key===t.key){if(!i.aIsStrong||e.newValue===t.newValue)return[new NoOperation(0)];e.oldValue=t.newValue}return[e]}),setTransformation(RootOperation,RootOperation,(e,t)=>e.rootName===t.rootName&&e.isAdd===t.isAdd?[new NoOperation(0)]:[e]),setTransformation(SplitOperation,InsertOperation,(e,t)=>(e.splitPosition.hasSameParentAs(t.position)&&e.splitPosition.offset<t.position.offset&&(e.howMany+=t.howMany),e.splitPosition=e.splitPosition._getTransformedByInsertOperation(t),e.insertionPosition=e.insertionPosition._getTransformedByInsertOperation(t),[e])),setTransformation(SplitOperation,MergeOperation,(e,t,i)=>{if(!e.graveyardPosition&&!i.bWasUndone&&e.splitPosition.hasSameParentAs(t.sourcePosition)){const r=t.graveyardPosition.path.slice();r.push(0);const o=new Position(t.graveyardPosition.root,r),a=SplitOperation.getInsertionPosition(new Position(t.graveyardPosition.root,r)),c=new SplitOperation(o,0,a,null,0);return e.splitPosition=e.splitPosition._getTransformedByMergeOperation(t),e.insertionPosition=SplitOperation.getInsertionPosition(e.splitPosition),e.graveyardPosition=c.insertionPosition.clone(),e.graveyardPosition.stickiness="toNext",[c,e]}return e.splitPosition.hasSameParentAs(t.deletionPosition)&&!e.splitPosition.isAfter(t.deletionPosition)&&e.howMany--,e.splitPosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.splitPosition=e.splitPosition._getTransformedByMergeOperation(t),e.insertionPosition=SplitOperation.getInsertionPosition(e.splitPosition),e.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedByMergeOperation(t)),[e]}),setTransformation(SplitOperation,MoveOperation,(e,t,i)=>{const r=Range._createFromPositionAndShift(t.sourcePosition,t.howMany);if(e.graveyardPosition){const a=r.start.isEqual(e.graveyardPosition)||r.containsPosition(e.graveyardPosition);if(!i.bWasUndone&&a){const c=e.splitPosition._getTransformedByMoveOperation(t),u=e.graveyardPosition._getTransformedByMoveOperation(t),h=u.path.slice();h.push(0);const d=new Position(u.root,h);return[new MoveOperation(c,e.howMany,d,0)]}e.graveyardPosition=e.graveyardPosition._getTransformedByMoveOperation(t)}const o=e.splitPosition.isEqual(t.targetPosition);if(o&&(i.baRelation=="insertAtSource"||i.abRelation=="splitBefore"))return e.howMany+=t.howMany,e.splitPosition=e.splitPosition._getTransformedByDeletion(t.sourcePosition,t.howMany),e.insertionPosition=SplitOperation.getInsertionPosition(e.splitPosition),[e];if(o&&i.abRelation&&i.abRelation.howMany){const{howMany:a,offset:c}=i.abRelation;return e.howMany+=a,e.splitPosition=e.splitPosition.getShiftedBy(c),[e]}if(e.splitPosition.hasSameParentAs(t.sourcePosition)&&r.containsPosition(e.splitPosition)){const a=t.howMany-(e.splitPosition.offset-t.sourcePosition.offset);return e.howMany-=a,e.splitPosition.hasSameParentAs(t.targetPosition)&&e.splitPosition.offset<t.targetPosition.offset&&(e.howMany+=t.howMany),e.splitPosition=t.sourcePosition.clone(),e.insertionPosition=SplitOperation.getInsertionPosition(e.splitPosition),[e]}return t.sourcePosition.isEqual(t.targetPosition)||(e.splitPosition.hasSameParentAs(t.sourcePosition)&&e.splitPosition.offset<=t.sourcePosition.offset&&(e.howMany-=t.howMany),e.splitPosition.hasSameParentAs(t.targetPosition)&&e.splitPosition.offset<t.targetPosition.offset&&(e.howMany+=t.howMany)),e.splitPosition.stickiness="toNone",e.splitPosition=e.splitPosition._getTransformedByMoveOperation(t),e.splitPosition.stickiness="toNext",e.graveyardPosition?e.insertionPosition=e.insertionPosition._getTransformedByMoveOperation(t):e.insertionPosition=SplitOperation.getInsertionPosition(e.splitPosition),[e]}),setTransformation(SplitOperation,SplitOperation,(e,t,i)=>{if(e.splitPosition.isEqual(t.splitPosition)){if(!e.graveyardPosition&&!t.graveyardPosition)return[new NoOperation(0)];if(e.graveyardPosition&&t.graveyardPosition&&e.graveyardPosition.isEqual(t.graveyardPosition))return[new NoOperation(0)];if(i.abRelation=="splitBefore")return e.howMany=0,e.graveyardPosition=e.graveyardPosition._getTransformedBySplitOperation(t),[e]}if(e.graveyardPosition&&t.graveyardPosition&&e.graveyardPosition.isEqual(t.graveyardPosition)){const r=e.splitPosition.root.rootName=="$graveyard",o=t.splitPosition.root.rootName=="$graveyard";if(o&&!r||!(r&&!o)&&i.aIsStrong){const h=[];return t.howMany&&h.push(new MoveOperation(t.moveTargetPosition,t.howMany,t.splitPosition,0)),e.howMany&&h.push(new MoveOperation(e.splitPosition,e.howMany,e.moveTargetPosition,0)),h}else return[new NoOperation(0)]}if(e.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedBySplitOperation(t)),e.splitPosition.isEqual(t.insertionPosition)&&i.abRelation=="splitBefore")return e.howMany++,[e];if(t.splitPosition.isEqual(e.insertionPosition)&&i.baRelation=="splitBefore"){const r=t.insertionPosition.path.slice();r.push(0);const o=new Position(t.insertionPosition.root,r),a=new MoveOperation(e.insertionPosition,1,o,0);return[e,a]}return e.splitPosition.hasSameParentAs(t.splitPosition)&&e.splitPosition.offset<t.splitPosition.offset&&(e.howMany-=t.howMany),e.splitPosition=e.splitPosition._getTransformedBySplitOperation(t),e.insertionPosition=SplitOperation.getInsertionPosition(e.splitPosition),[e]});function _moveTargetIntoMovedRange(e,t){return e.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany)===null}function _makeMoveOperationsFromRanges(e,t){const i=[];for(let r=0;r<e.length;r++){const o=e[r],a=new MoveOperation(o.start,o.end.offset-o.start.offset,t,0);i.push(a);for(let c=r+1;c<e.length;c++)e[c]=e[c]._getTransformedByMove(a.sourcePosition,a.targetPosition,a.howMany)[0];t=t._getTransformedByMove(a.sourcePosition,a.targetPosition,a.howMany)}return i}var LivePosition=class extends EmitterMixin(Position){constructor(e,t,i="toNone"){if(super(e,t,i),!this.root.is("rootElement"))throw new CKEditorError("model-liveposition-root-not-rootelement",e);bindWithDocument.call(this)}detach(){this.stopListening()}toPosition(){return new Position(this.root,this.path.slice(),this.stickiness)}static fromPosition(e,t){return new this(e.root,e.path.slice(),t||e.stickiness)}};LivePosition.prototype.is=function(e){return e==="livePosition"||e==="model:livePosition"||e=="position"||e==="model:position"};function bindWithDocument(){this.listenTo(this.root.document.model,"applyOperation",(e,t)=>{const i=t[0];i.isDocumentOperation&&transform.call(this,i)},{priority:"low"})}function transform(e){const t=this.getTransformedByOperation(e);if(!this.isEqual(t)){const i=this.toPosition();this.path=t.path,this.root=t.root,this.fire("change",i)}}var Batch=class{operations;isUndoable;isLocal;isUndo;isTyping;constructor(e={}){typeof e=="string"&&(e=e==="transparent"?{isUndoable:!1}:{},logWarning("batch-constructor-deprecated-string-type"));const{isUndoable:t=!0,isLocal:i=!0,isUndo:r=!1,isTyping:o=!1}=e;this.operations=[],this.isUndoable=t,this.isLocal=i,this.isUndo=r,this.isTyping=o}get type(){return logWarning("batch-type-deprecated"),"default"}get baseVersion(){for(const e of this.operations)if(e.baseVersion!==null)return e.baseVersion;return null}addOperation(e){return e.batch=this,this.operations.push(e),e}},Differ=class gr{static _statesPriority=[void 0,"refresh","rename","move"];_markerCollection;_changesInElement=new Map;_elementsSnapshots=new Map;_elementChildrenSnapshots=new Map;_elementState=new Map;_changedMarkers=new Map;_changedRoots=new Map;_changeCount=0;_cachedChanges=null;_cachedChangesWithGraveyard=null;_refreshedItems=new Set;constructor(t){this._markerCollection=t}get isEmpty(){return this._changesInElement.size==0&&this._changedMarkers.size==0&&this._changedRoots.size==0}bufferOperation(t){const i=t;switch(i.type){case"insert":{if(this._isInInsertedElement(i.position.parent))return;this._markInsert(i.position.parent,i.position.offset,i.nodes.maxOffset);break}case"addAttribute":case"removeAttribute":case"changeAttribute":{for(const r of i.range.getItems({shallow:!0}))this._isInInsertedElement(r.parent)||this._markAttribute(r);break}case"remove":case"move":case"reinsert":{if(i.sourcePosition.isEqual(i.targetPosition)||i.sourcePosition.getShiftedBy(i.howMany).isEqual(i.targetPosition))return;const r=this._isInInsertedElement(i.sourcePosition.parent),o=this._isInInsertedElement(i.targetPosition.parent);r||this._markRemove(i.sourcePosition.parent,i.sourcePosition.offset,i.howMany),o||this._markInsert(i.targetPosition.parent,i.getMovedRangeStart().offset,i.howMany);const a=Range._createFromPositionAndShift(i.sourcePosition,i.howMany);for(const c of a.getItems({shallow:!0}))this._setElementState(c,"move");break}case"rename":{if(this._isInInsertedElement(i.position.parent))return;this._markRemove(i.position.parent,i.position.offset,1),this._markInsert(i.position.parent,i.position.offset,1);const r=Range._createFromPositionAndShift(i.position,1);for(const o of this._markerCollection.getMarkersIntersectingRange(r)){const a=o.getData();this.bufferMarkerChange(o.name,a,a)}this._setElementState(i.position.nodeAfter,"rename");break}case"split":{const r=i.splitPosition.parent;if(!this._isInInsertedElement(r)){this._markRemove(r,i.splitPosition.offset,i.howMany);const o=Range._createFromPositionAndShift(i.splitPosition,i.howMany);for(const a of o.getItems({shallow:!0}))this._setElementState(a,"move")}this._isInInsertedElement(i.insertionPosition.parent)||this._markInsert(i.insertionPosition.parent,i.insertionPosition.offset,1),i.graveyardPosition&&(this._markRemove(i.graveyardPosition.parent,i.graveyardPosition.offset,1),this._setElementState(i.graveyardPosition.nodeAfter,"move"));break}case"merge":{const r=i.sourcePosition.parent;this._isInInsertedElement(r.parent)||this._markRemove(r.parent,r.startOffset,1);const o=i.graveyardPosition.parent;this._markInsert(o,i.graveyardPosition.offset,1),this._setElementState(r,"move");const a=i.targetPosition.parent;if(!this._isInInsertedElement(a)){this._markInsert(a,i.targetPosition.offset,r.maxOffset);const c=Range._createFromPositionAndShift(i.sourcePosition,i.howMany);for(const u of c.getItems({shallow:!0}))this._setElementState(u,"move")}break}case"detachRoot":case"addRoot":{const r=i.affectedSelectable;if(!r._isLoaded||r.isAttached()==i.isAdd)return;this._bufferRootStateChange(i.rootName,i.isAdd);break}case"addRootAttribute":case"removeRootAttribute":case"changeRootAttribute":{if(!i.root._isLoaded)return;const r=i.root.rootName;this._bufferRootAttributeChange(r,i.key,i.oldValue,i.newValue);break}}this._cachedChanges=null}bufferMarkerChange(t,i,r){i.range&&i.range.root.is("rootElement")&&!i.range.root._isLoaded&&(i.range=null),r.range&&r.range.root.is("rootElement")&&!r.range.root._isLoaded&&(r.range=null);let o=this._changedMarkers.get(t);o?o.newMarkerData=r:(o={newMarkerData:r,oldMarkerData:i},this._changedMarkers.set(t,o)),o.oldMarkerData.range==null&&r.range==null&&this._changedMarkers.delete(t)}getMarkersToRemove(){const t=[];for(const[i,r]of this._changedMarkers)r.oldMarkerData.range!=null&&t.push({name:i,range:r.oldMarkerData.range});return t}getMarkersToAdd(){const t=[];for(const[i,r]of this._changedMarkers)r.newMarkerData.range!=null&&t.push({name:i,range:r.newMarkerData.range});return t}getChangedMarkers(){return Array.from(this._changedMarkers).map(([t,i])=>({name:t,data:{oldRange:i.oldMarkerData.range,newRange:i.newMarkerData.range}}))}hasDataChanges(){if(this.getChanges().length||this._changedRoots.size>0)return!0;for(const{newMarkerData:t,oldMarkerData:i}of this._changedMarkers.values()){if(t.affectsData!==i.affectsData)return!0;if(t.affectsData){const r=t.range&&!i.range,o=!t.range&&i.range,a=t.range&&i.range&&!t.range.isEqual(i.range);if(r||o||a)return!0}}return!1}getChanges(t={}){if(this._cachedChanges)return t.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();let i=[];for(const r of this._changesInElement.keys()){const o=this._changesInElement.get(r).sort((f,m)=>f.offset===m.offset?f.type!=m.type?f.type=="remove"?-1:1:0:f.offset<m.offset?-1:1),a=this._elementChildrenSnapshots.get(r),c=_getChildrenSnapshots(r.getChildren()),u=_generateDiffInstructionsFromChanges(a.length,o);let h=0,d=0;for(const f of u)if(f==="i"){const m=this._getDiffActionForNode(c[h].node,"insert"),g=this._elementsSnapshots.get(c[h].node),v=this._getInsertDiff(r,h,m,c[h],g);i.push(v),h++}else if(f==="r"){const m=this._getDiffActionForNode(a[d].node,"remove"),g=this._getRemoveDiff(r,h,m,a[d]);i.push(g),d++}else if(f==="a"){const m=a[d].attributes,g=c[h].attributes;let v;if(c[h].name=="$text")v=new Range(Position._createAt(r,h),Position._createAt(r,h+1));else{const b=r.offsetToIndex(h);v=new Range(Position._createAt(r,h),Position._createAt(r.getChild(b),0))}const _=this._getAttributesDiff(v,m,g);i.push(..._),h++,d++}else h++,d++}i.sort((r,o)=>r.position.root!=o.position.root?r.position.root.rootName<o.position.root.rootName?-1:1:r.position.isEqual(o.position)?r.changeCount-o.changeCount:r.position.isBefore(o.position)?-1:1);for(let r=1,o=0;r<i.length;r++){const a=i[o],c=i[r],u=a.type=="remove"&&c.type=="remove"&&a.name=="$text"&&c.name=="$text"&&a.position.isEqual(c.position),h=a.type=="insert"&&c.type=="insert"&&a.name=="$text"&&c.name=="$text"&&a.position.parent==c.position.parent&&a.position.offset+a.length==c.position.offset,d=a.type=="attribute"&&c.type=="attribute"&&a.position.parent==c.position.parent&&a.range.isFlat&&c.range.isFlat&&a.position.offset+a.length==c.position.offset&&a.attributeKey==c.attributeKey&&a.attributeOldValue==c.attributeOldValue&&a.attributeNewValue==c.attributeNewValue;u||h||d?(a.length++,d&&(a.range.end=a.range.end.getShiftedBy(1)),i[r]=null):o=r}i=i.filter(r=>r);for(const r of i)delete r.changeCount,r.type=="attribute"&&(delete r.position,delete r.length);return this._changeCount=0,this._cachedChangesWithGraveyard=i,this._cachedChanges=i.filter(_changesInGraveyardFilter),t.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice()}getChangedRoots(){return Array.from(this._changedRoots.values()).map(t=>{const i={...t};return i.state!==void 0&&delete i.attributes,i})}getRefreshedItems(){return new Set(this._refreshedItems)}reset(){this._changesInElement.clear(),this._elementChildrenSnapshots.clear(),this._elementsSnapshots.clear(),this._elementState.clear(),this._changedMarkers.clear(),this._changedRoots.clear(),this._refreshedItems.clear(),this._cachedChanges=null}_refreshItem(t){if(this._isInInsertedElement(t.parent))return;this._markRemove(t.parent,t.startOffset,t.offsetSize),this._markInsert(t.parent,t.startOffset,t.offsetSize),this._refreshedItems.add(t),this._setElementState(t,"refresh");const i=Range._createOn(t);for(const r of this._markerCollection.getMarkersIntersectingRange(i)){const o=r.getData();this.bufferMarkerChange(r.name,o,o)}this._cachedChanges=null}_bufferRootLoad(t){if(t.isAttached()){this._bufferRootStateChange(t.rootName,!0),this._markInsert(t,0,t.maxOffset);for(const i of t.getAttributeKeys())this._bufferRootAttributeChange(t.rootName,i,null,t.getAttribute(i));for(const i of this._markerCollection)if(i.getRange().root==t){const r=i.getData();this.bufferMarkerChange(i.name,{...r,range:null},r)}}}_bufferRootStateChange(t,i){if(!this._changedRoots.has(t)){this._changedRoots.set(t,{name:t,state:i?"attached":"detached"});return}const r=this._changedRoots.get(t);r.state!==void 0?(delete r.state,r.attributes===void 0&&this._changedRoots.delete(t)):r.state=i?"attached":"detached"}_bufferRootAttributeChange(t,i,r,o){const a=this._changedRoots.get(t)||{name:t},c=a.attributes||{};if(c[i]){const u=c[i];o===u.oldValue?delete c[i]:u.newValue=o}else c[i]={oldValue:r,newValue:o};Object.entries(c).length===0?(delete a.attributes,a.state===void 0&&this._changedRoots.delete(t)):(a.attributes=c,this._changedRoots.set(t,a))}_markInsert(t,i,r){if(t.root.is("rootElement")&&!t.root._isLoaded)return;const o={type:"insert",offset:i,howMany:r,count:this._changeCount++};this._markChange(t,o)}_markRemove(t,i,r){if(t.root.is("rootElement")&&!t.root._isLoaded)return;const o={type:"remove",offset:i,howMany:r,count:this._changeCount++};this._markChange(t,o),this._removeAllNestedChanges(t,i,r)}_markAttribute(t){if(t.root.is("rootElement")&&!t.root._isLoaded)return;const i={type:"attribute",offset:t.startOffset,howMany:t.offsetSize,count:this._changeCount++};this._markChange(t.parent,i)}_markChange(t,i){this._makeSnapshots(t);const r=this._getChangesForElement(t);this._handleChange(i,r),r.push(i);for(let o=0;o<r.length;o++)r[o].howMany<1&&(r.splice(o,1),o--)}_setElementState(t,i){if(!t.is("element"))return;const r=gr._statesPriority.indexOf(this._elementState.get(t));gr._statesPriority.indexOf(i)>r&&this._elementState.set(t,i)}_getDiffActionForNode(t,i){if(!t.is("element")||!this._elementsSnapshots.has(t))return i;const r=this._elementState.get(t);return!r||r=="move"?i:r}_getChangesForElement(t){let i;return this._changesInElement.has(t)?i=this._changesInElement.get(t):(i=[],this._changesInElement.set(t,i)),i}_makeSnapshots(t){if(this._elementChildrenSnapshots.has(t))return;const i=_getChildrenSnapshots(t.getChildren());this._elementChildrenSnapshots.set(t,i);for(const r of i)this._elementsSnapshots.set(r.node,r)}_handleChange(t,i){t.nodesToHandle=t.howMany;for(const r of i){const o=t.offset+t.howMany,a=r.offset+r.howMany;if(t.type=="insert"&&(r.type=="insert"&&(t.offset<=r.offset?r.offset+=t.howMany:t.offset<a&&(r.howMany+=t.nodesToHandle,t.nodesToHandle=0)),r.type=="remove"&&t.offset<r.offset&&(r.offset+=t.howMany),r.type=="attribute")){if(t.offset<=r.offset)r.offset+=t.howMany;else if(t.offset<a){const c=r.howMany;r.howMany=t.offset-r.offset,i.unshift({type:"attribute",offset:o,howMany:c-r.howMany,count:this._changeCount++})}}if(t.type=="remove"){if(r.type=="insert"){if(o<=r.offset)r.offset-=t.howMany;else if(o<=a)if(t.offset<r.offset){const c=o-r.offset;r.offset=t.offset,r.howMany-=c,t.nodesToHandle-=c}else r.howMany-=t.nodesToHandle,t.nodesToHandle=0;else if(t.offset<=r.offset)t.nodesToHandle-=r.howMany,r.howMany=0;else if(t.offset<a){const c=a-t.offset;r.howMany-=c,t.nodesToHandle-=c}}if(r.type=="remove"&&(o<=r.offset?r.offset-=t.howMany:t.offset<r.offset&&(t.nodesToHandle+=r.howMany,r.howMany=0)),r.type=="attribute"){if(o<=r.offset)r.offset-=t.howMany;else if(t.offset<r.offset){const c=o-r.offset;r.offset=t.offset,r.howMany-=c}else if(t.offset<a)if(o<=a){const c=r.howMany;r.howMany=t.offset-r.offset;const u=c-r.howMany-t.nodesToHandle;i.unshift({type:"attribute",offset:t.offset,howMany:u,count:this._changeCount++})}else r.howMany-=a-t.offset}}if(t.type=="attribute"){if(r.type=="insert")if(t.offset<r.offset&&o>r.offset){if(o>a){const c={type:"attribute",offset:a,howMany:o-a,count:this._changeCount++};this._handleChange(c,i),i.push(c)}t.nodesToHandle=r.offset-t.offset,t.howMany=t.nodesToHandle}else t.offset>=r.offset&&t.offset<a&&(o>a?(t.nodesToHandle=o-a,t.offset=a):t.nodesToHandle=0);if(r.type=="remove"&&t.offset<r.offset&&o>r.offset){const c={type:"attribute",offset:r.offset,howMany:o-r.offset,count:this._changeCount++};this._handleChange(c,i),i.push(c),t.nodesToHandle=r.offset-t.offset,t.howMany=t.nodesToHandle}r.type=="attribute"&&(t.offset>=r.offset&&o<=a?(t.nodesToHandle=0,t.howMany=0,t.offset=0):t.offset<=r.offset&&o>=a&&(r.howMany=0))}}t.howMany=t.nodesToHandle,delete t.nodesToHandle}_getInsertDiff(t,i,r,o,a){const c={type:"insert",position:Position._createAt(t,i),name:o.name,attributes:new Map(o.attributes),length:1,changeCount:this._changeCount++,action:r};return r!="insert"&&a&&(c.before={name:a.name,attributes:new Map(a.attributes)}),c}_getRemoveDiff(t,i,r,o){return{type:"remove",action:r,position:Position._createAt(t,i),name:o.name,attributes:new Map(o.attributes),length:1,changeCount:this._changeCount++}}_getAttributesDiff(t,i,r){const o=[];r=new Map(r);for(const[a,c]of i){const u=r.has(a)?r.get(a):null;u!==c&&o.push({type:"attribute",position:t.start,range:t.clone(),length:1,attributeKey:a,attributeOldValue:c,attributeNewValue:u,changeCount:this._changeCount++}),r.delete(a)}for(const[a,c]of r)o.push({type:"attribute",position:t.start,range:t.clone(),length:1,attributeKey:a,attributeOldValue:null,attributeNewValue:c,changeCount:this._changeCount++});return o}_isInInsertedElement(t){const i=t.parent;if(!i)return!1;const r=this._changesInElement.get(i),o=t.startOffset;if(r){for(const a of r)if(a.type=="insert"&&o>=a.offset&&o<a.offset+a.howMany)return!0}return this._isInInsertedElement(i)}_removeAllNestedChanges(t,i,r){const o=new Range(Position._createAt(t,i),Position._createAt(t,i+r));for(const a of o.getItems({shallow:!0}))a.is("element")&&(this._changesInElement.delete(a),this._removeAllNestedChanges(a,0,a.maxOffset))}};function _getSingleNodeSnapshot(e){return{node:e,name:e.is("$text")?"$text":e.name,attributes:new Map(e.getAttributes())}}function _getChildrenSnapshots(e){const t=[];for(const i of e)if(i.is("$text"))for(let r=0;r<i.data.length;++r)t.push(_getSingleNodeSnapshot(i));else t.push(_getSingleNodeSnapshot(i));return t}function _generateDiffInstructionsFromChanges(e,t){const i=[];let r=0,o=0;for(const a of t){if(a.offset>r){for(let c=0;c<a.offset-r;c++)i.push("e");o+=a.offset-r}if(a.type=="insert"){for(let c=0;c<a.howMany;c++)i.push("i");r=a.offset+a.howMany}else if(a.type=="remove"){for(let c=0;c<a.howMany;c++)i.push("r");r=a.offset,o+=a.howMany}else{if(a.howMany>1500)for(let c=0;c<a.howMany;c++)i.push("a");else i.push(..."a".repeat(a.howMany).split(""));r=a.offset+a.howMany,o+=a.howMany}}if(o<e)for(let a=0;a<e-o-r;a++)i.push("e");return i}function _changesInGraveyardFilter(e){const t="position"in e&&e.position.root.rootName=="$graveyard",i="range"in e&&e.range.root.rootName=="$graveyard";return!t&&!i}var History=class{_operations=[];_undoPairs=new Map;_undoneOperations=new Set;_baseVersionToOperationIndex=new Map;_version=0;_gaps=new Map;get version(){return this._version}set version(e){this._operations.length&&e>this._version+1&&this._gaps.set(this._version,e),this._version=e}get lastOperation(){return this._operations[this._operations.length-1]}addOperation(e){if(e.baseVersion!==this.version)throw new CKEditorError("model-document-history-addoperation-incorrect-version",this,{operation:e,historyVersion:this.version});this._operations.push(e),this._version++,this._baseVersionToOperationIndex.set(e.baseVersion,this._operations.length-1)}getOperations(e,t=this.version){if(!this._operations.length)return[];const i=this._operations[0];e===void 0&&(e=i.baseVersion);let r=t-1;for(const[c,u]of this._gaps)e>c&&e<u&&(e=u),r>c&&r<u&&(r=c-1);if(r<i.baseVersion||e>this.lastOperation.baseVersion)return[];let o=this._baseVersionToOperationIndex.get(e);o===void 0&&(o=0);let a=this._baseVersionToOperationIndex.get(r);return a===void 0&&(a=this._operations.length-1),this._operations.slice(o,a+1)}getOperation(e){const t=this._baseVersionToOperationIndex.get(e);if(t!==void 0)return this._operations[t]}setOperationAsUndone(e,t){this._undoPairs.set(t,e),this._undoneOperations.add(e)}isUndoingOperation(e){return this._undoPairs.has(e)}isUndoneOperation(e){return this._undoneOperations.has(e)}getUndoneOperation(e){return this._undoPairs.get(e)}reset(){this._version=0,this._undoPairs=new Map,this._operations=[],this._undoneOperations=new Set,this._gaps=new Map,this._baseVersionToOperationIndex=new Map}},RootElement=class extends Element$2{rootName;_document;_isAttached=!0;_isLoaded=!0;constructor(e,t,i="main"){super(t),this._document=e,this.rootName=i}get document(){return this._document}isAttached(){return this._isAttached}toJSON(){return this.rootName}};RootElement.prototype.is=function(e,t){return t?t===this.name&&(e==="rootElement"||e==="model:rootElement"||e==="element"||e==="model:element"):e==="rootElement"||e==="model:rootElement"||e==="element"||e==="model:element"||e==="node"||e==="model:node"};const graveyardName="$graveyard";var Document=class extends EmitterMixin(){model;history;selection;roots;differ;isReadOnly;_postFixers;_hasSelectionChangedFromTheLastChangeBlock;constructor(e){super(),this.model=e,this.history=new History,this.selection=new DocumentSelection(this),this.roots=new Collection({idProperty:"rootName"}),this.differ=new Differ(e.markers),this.isReadOnly=!1,this._postFixers=new Set,this._hasSelectionChangedFromTheLastChangeBlock=!1,this.createRoot("$root",graveyardName),this.listenTo(e,"applyOperation",(t,i)=>{const r=i[0];r.isDocumentOperation&&this.differ.bufferOperation(r)},{priority:"high"}),this.listenTo(e,"applyOperation",(t,i)=>{const r=i[0];r.isDocumentOperation&&this.history.addOperation(r)},{priority:"low"}),this.listenTo(this.selection,"change",()=>{this._hasSelectionChangedFromTheLastChangeBlock=!0}),this.listenTo(e.markers,"update",(t,i,r,o,a)=>{const c={...i.getData(),range:o};this.differ.bufferMarkerChange(i.name,a,c),r===null&&i.on("change",(u,h)=>{const d=i.getData();this.differ.bufferMarkerChange(i.name,{...d,range:h},d)})}),this.registerPostFixer(t=>{let i=!1;for(const r of this.roots)!r.isAttached()&&!r.isEmpty&&(t.remove(t.createRangeIn(r)),i=!0);for(const r of this.model.markers)r.getRange().root.isAttached()||(t.removeMarker(r),i=!0);return i})}get version(){return this.history.version}set version(e){this.history.version=e}get graveyard(){return this.getRoot(graveyardName)}createRoot(e="$root",t="main"){if(this.roots.get(t))throw new CKEditorError("model-document-createroot-name-exists",this,{name:t});const i=new RootElement(this,e,t);return this.roots.add(i),i}destroy(){this.selection.destroy(),this.stopListening()}getRoot(e="main"){return this.roots.get(e)}getRootNames(e=!1){return this.getRoots(e).map(t=>t.rootName)}getRoots(e=!1){return this.roots.filter(t=>t!=this.graveyard&&(e||t.isAttached())&&t._isLoaded)}registerPostFixer(e){this._postFixers.add(e)}toJSON(){const e=clone_default(this);return e.selection="[engine.model.DocumentSelection]",e.model="[engine.model.Model]",e}_handleChangeBlock(e){this._hasDocumentChangedFromTheLastChangeBlock()&&(this._callPostFixers(e),this.selection.refresh(),this.differ.hasDataChanges()?this.fire("change:data",e.batch):this.fire("change",e.batch),this.selection.refresh(),this.differ.reset()),this._hasSelectionChangedFromTheLastChangeBlock=!1}_hasDocumentChangedFromTheLastChangeBlock(){return!this.differ.isEmpty||this._hasSelectionChangedFromTheLastChangeBlock}_getDefaultRoot(){const e=this.getRoots();return e.length?e[0]:this.graveyard}_getDefaultRange(){const e=this._getDefaultRoot(),t=this.model,i=t.schema,r=t.createPositionFromPath(e,[0]);return i.getNearestSelectionRange(r)||t.createRange(r)}_validateSelectionRange(e){return e.start.isValid()&&e.end.isValid()&&validateTextNodePosition(e.start)&&validateTextNodePosition(e.end)}_callPostFixers(e){let t=!1;do for(const i of this._postFixers)if(this.selection.refresh(),t=i(e),t)break;while(t)}};function validateTextNodePosition(e){const t=e.textNode;if(t){const i=t.data,r=e.offset-t.startOffset;return!isInsideSurrogatePair(i,r)&&!isInsideCombinedSymbol(i,r)}return!0}var MarkerCollection=class extends EmitterMixin(){_markers=new Map;[Symbol.iterator](){return this._markers.values()}has(e){const t=e instanceof Marker?e.name:e;return this._markers.has(t)}get(e){return this._markers.get(e)||null}_set(e,t,i=!1,r=!1){const o=e instanceof Marker?e.name:e;if(o.includes(","))throw new CKEditorError("markercollection-incorrect-marker-name",this);const a=this._markers.get(o);if(a){const h=a.getData(),d=a.getRange();let f=!1;return d.isEqual(t)||(a._attachLiveRange(LiveRange.fromRange(t)),f=!0),i!=a.managedUsingOperations&&(a._managedUsingOperations=i,f=!0),typeof r=="boolean"&&r!=a.affectsData&&(a._affectsData=r,f=!0),f&&this.fire(`update:${o}`,a,d,t,h),a}const c=LiveRange.fromRange(t),u=new Marker(o,c,i,r);return this._markers.set(o,u),this.fire(`update:${o}`,u,null,t,{...u.getData(),range:null}),u}_remove(e){const t=e instanceof Marker?e.name:e,i=this._markers.get(t);return i?(this._markers.delete(t),this.fire(`update:${t}`,i,i.getRange(),null,i.getData()),this._destroyMarker(i),!0):!1}_refresh(e){const t=e instanceof Marker?e.name:e,i=this._markers.get(t);if(!i)throw new CKEditorError("markercollection-refresh-marker-not-exists",this);const r=i.getRange();this.fire(`update:${t}`,i,r,r,i.getData())}*getMarkersAtPosition(e){for(const t of this)t.getRange().containsPosition(e)&&(yield t)}*getMarkersIntersectingRange(e){for(const t of this)t.getRange().getIntersection(e)!==null&&(yield t)}destroy(){for(const e of this._markers.values())this._destroyMarker(e);this._markers=null,this.stopListening()}*getMarkersGroup(e){for(const t of this._markers.values())t.name.startsWith(e+":")&&(yield t)}_destroyMarker(e){e.stopListening(),e._detachLiveRange()}},Marker=class extends EmitterMixin(TypeCheckable){name;_managedUsingOperations;_affectsData;_liveRange;constructor(e,t,i,r){super(),this.name=e,this._liveRange=this._attachLiveRange(t),this._managedUsingOperations=i,this._affectsData=r}get managedUsingOperations(){if(!this._liveRange)throw new CKEditorError("marker-destroyed",this);return this._managedUsingOperations}get affectsData(){if(!this._liveRange)throw new CKEditorError("marker-destroyed",this);return this._affectsData}getData(){return{range:this.getRange(),affectsData:this.affectsData,managedUsingOperations:this.managedUsingOperations}}getStart(){if(!this._liveRange)throw new CKEditorError("marker-destroyed",this);return this._liveRange.start.clone()}getEnd(){if(!this._liveRange)throw new CKEditorError("marker-destroyed",this);return this._liveRange.end.clone()}getRange(){if(!this._liveRange)throw new CKEditorError("marker-destroyed",this);return this._liveRange.toRange()}_attachLiveRange(e){return this._liveRange&&this._detachLiveRange(),e.delegate("change:range").to(this),e.delegate("change:content").to(this),this._liveRange=e,e}_detachLiveRange(){this._liveRange.stopDelegating("change:range",this),this._liveRange.stopDelegating("change:content",this),this._liveRange.detach(),this._liveRange=null}};Marker.prototype.is=function(e){return e==="marker"||e==="model:marker"};var DetachOperation=class extends Operation{sourcePosition;howMany;constructor(e,t){super(null),this.sourcePosition=e.clone(),this.howMany=t}get type(){return"detach"}get affectedSelectable(){return null}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e}_validate(){if(this.sourcePosition.root.document)throw new CKEditorError("detach-operation-on-document-node",this)}_execute(){_remove(Range._createFromPositionAndShift(this.sourcePosition,this.howMany))}static get className(){return"DetachOperation"}},DocumentFragment=class Cs extends TypeCheckable{markers=new Map;_children=new NodeList;constructor(t){super(),t&&this._insertChild(0,t)}[Symbol.iterator](){return this.getChildren()}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}get nextSibling(){return null}get previousSibling(){return null}get root(){return this}get parent(){return null}get document(){return null}isAttached(){return!1}getAncestors(){return[]}getChild(t){return this._children.getNode(t)}getChildAtOffset(t){return this._children.getNodeAtOffset(t)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(t){return this._children.getNodeIndex(t)}getChildStartOffset(t){return this._children.getNodeStartOffset(t)}getPath(){return[]}getNodeByPath(t){let i=this;for(const r of t)i=i.getChildAtOffset(r);return i}offsetToIndex(t){return this._children.offsetToIndex(t)}toJSON(){const t=[];for(const i of this._children)t.push(i.toJSON());return t}static fromJSON(t){const i=[];for(const r of t)r.name?i.push(Element$2.fromJSON(r)):i.push(Text.fromJSON(r));return new Cs(i)}_appendChild(t){this._insertChild(this.childCount,t)}_insertChild(t,i){const r=normalize$4(i);for(const o of r)o.parent!==null&&o._remove(),o.parent=this;this._children._insertNodes(t,r)}_removeChildren(t,i=1){const r=this._children._removeNodes(t,i);for(const o of r)o.parent=null;return r}_removeChildrenArray(t){this._children._removeNodesArray(t);for(const i of t)i.parent=null}};DocumentFragment.prototype.is=function(e){return e==="documentFragment"||e==="model:documentFragment"};function normalize$4(e){return typeof e=="string"?[new Text(e)]:(isIterable(e)||(e=[e]),Array.from(e).map(t=>typeof t=="string"?new Text(t):t instanceof TextProxy?new Text(t.data,t.getAttributes()):t))}var Writer=class{model;batch;constructor(e,t){this.model=e,this.batch=t}createText(e,t){return new Text(e,t)}createElement(e,t){return new Element$2(e,t)}createDocumentFragment(){return new DocumentFragment}cloneElement(e,t=!0){return e._clone(t)}insert(e,t,i=0){if(this._assertWriterUsedCorrectly(),e instanceof Text&&e.data=="")return;const r=Position._createAt(t,i);if(e.parent)if(isSameTree(e.root,r.root)){this.move(Range._createOn(e),r);return}else{if(e.root.document)throw new CKEditorError("model-writer-insert-forbidden-move",this);this.remove(e)}const o=r.root.document?r.root.document.version:null,a=e instanceof DocumentFragment?e._removeChildren(0,e.childCount):e,c=new InsertOperation(r,a,o);if(e instanceof Text&&(c.shouldReceiveAttributes=!0),this.batch.addOperation(c),this.model.applyOperation(c),e instanceof DocumentFragment)for(const[u,h]of e.markers){const d=Position._createAt(h.root,0),m={range:new Range(h.start._getCombined(d,r),h.end._getCombined(d,r)),usingOperation:!0,affectsData:!0};this.model.markers.has(u)?this.updateMarker(u,m):this.addMarker(u,m)}}insertText(e,t,i,r){t instanceof DocumentFragment||t instanceof Element$2||t instanceof Position?this.insert(this.createText(e),t,i):this.insert(this.createText(e,t),i,r)}insertElement(e,t,i,r){t instanceof DocumentFragment||t instanceof Element$2||t instanceof Position?this.insert(this.createElement(e),t,i):this.insert(this.createElement(e,t),i,r)}append(e,t){this.insert(e,t,"end")}appendText(e,t,i){t instanceof DocumentFragment||t instanceof Element$2?this.insert(this.createText(e),t,"end"):this.insert(this.createText(e,t),i,"end")}appendElement(e,t,i){t instanceof DocumentFragment||t instanceof Element$2?this.insert(this.createElement(e),t,"end"):this.insert(this.createElement(e,t),i,"end")}setAttribute(e,t,i){if(this._assertWriterUsedCorrectly(),i instanceof Range){const r=i.getMinimalFlatRanges();for(const o of r)setAttributeOnRange(this,e,t,o)}else setAttributeOnItem(this,e,t,i)}setAttributes(e,t){for(const[i,r]of toMap(e))this.setAttribute(i,r,t)}removeAttribute(e,t){if(this._assertWriterUsedCorrectly(),t instanceof Range){const i=t.getMinimalFlatRanges();for(const r of i)setAttributeOnRange(this,e,null,r)}else setAttributeOnItem(this,e,null,t)}clearAttributes(e){this._assertWriterUsedCorrectly();const t=i=>{for(const r of i.getAttributeKeys())this.removeAttribute(r,i)};if(!(e instanceof Range))t(e);else for(const i of e.getItems())t(i)}move(e,t,i){if(this._assertWriterUsedCorrectly(),!(e instanceof Range))throw new CKEditorError("writer-move-invalid-range",this);if(!e.isFlat)throw new CKEditorError("writer-move-range-not-flat",this);const r=Position._createAt(t,i);if(r.isEqual(e.start))return;if(this._addOperationForAffectedMarkers("move",e),!isSameTree(e.root,r.root))throw new CKEditorError("writer-move-different-document",this);const o=e.root.document?e.root.document.version:null,a=new MoveOperation(e.start,e.end.offset-e.start.offset,r,o);this.batch.addOperation(a),this.model.applyOperation(a)}remove(e){this._assertWriterUsedCorrectly();const i=(e instanceof Range?e:Range._createOn(e)).getMinimalFlatRanges().reverse();for(const r of i)this._addOperationForAffectedMarkers("move",r),applyRemoveOperation(r.start,r.end.offset-r.start.offset,this.batch,this.model)}merge(e){this._assertWriterUsedCorrectly();const t=e.nodeBefore,i=e.nodeAfter;if(this._addOperationForAffectedMarkers("merge",e),!(t instanceof Element$2))throw new CKEditorError("writer-merge-no-element-before",this);if(!(i instanceof Element$2))throw new CKEditorError("writer-merge-no-element-after",this);e.root.document?this._merge(e):this._mergeDetached(e)}createPositionFromPath(e,t,i){return this.model.createPositionFromPath(e,t,i)}createPositionAt(e,t){return this.model.createPositionAt(e,t)}createPositionAfter(e){return this.model.createPositionAfter(e)}createPositionBefore(e){return this.model.createPositionBefore(e)}createRange(e,t){return this.model.createRange(e,t)}createRangeIn(e){return this.model.createRangeIn(e)}createRangeOn(e){return this.model.createRangeOn(e)}createSelection(...e){return this.model.createSelection(...e)}_mergeDetached(e){const t=e.nodeBefore,i=e.nodeAfter;this.move(Range._createIn(i),Position._createAt(t,"end")),this.remove(i)}_merge(e){const t=Position._createAt(e.nodeBefore,"end"),i=Position._createAt(e.nodeAfter,0),r=e.root.document.graveyard,o=new Position(r,[0]),a=e.root.document.version,c=new MergeOperation(i,e.nodeAfter.maxOffset,t,o,a);this.batch.addOperation(c),this.model.applyOperation(c)}rename(e,t){if(this._assertWriterUsedCorrectly(),!(e instanceof Element$2))throw new CKEditorError("writer-rename-not-element-instance",this);const i=e.root.document?e.root.document.version:null,r=new RenameOperation(Position._createBefore(e),e.name,t,i);this.batch.addOperation(r),this.model.applyOperation(r)}split(e,t){this._assertWriterUsedCorrectly();let i=e.parent;if(!i.parent)throw new CKEditorError("writer-split-element-no-parent",this);if(t||(t=i.parent),!e.parent.getAncestors({includeSelf:!0}).includes(t))throw new CKEditorError("writer-split-invalid-limit-element",this);let r,o;do{const a=i.root.document?i.root.document.version:null,c=i.maxOffset-e.offset,u=SplitOperation.getInsertionPosition(e),h=new SplitOperation(e,c,u,null,a);this.batch.addOperation(h),this.model.applyOperation(h),!r&&!o&&(r=i,o=e.parent.nextSibling),e=this.createPositionAfter(e.parent),i=e.parent}while(i!==t);return{position:e,range:new Range(Position._createAt(r,"end"),Position._createAt(o,0))}}wrap(e,t){if(this._assertWriterUsedCorrectly(),!e.isFlat)throw new CKEditorError("writer-wrap-range-not-flat",this);const i=t instanceof Element$2?t:new Element$2(t);if(i.childCount>0)throw new CKEditorError("writer-wrap-element-not-empty",this);if(i.parent!==null)throw new CKEditorError("writer-wrap-element-attached",this);this.insert(i,e.start);const r=new Range(e.start.getShiftedBy(1),e.end.getShiftedBy(1));this.move(r,Position._createAt(i,0))}unwrap(e){if(this._assertWriterUsedCorrectly(),e.parent===null)throw new CKEditorError("writer-unwrap-element-no-parent",this);this.move(Range._createIn(e),this.createPositionAfter(e)),this.remove(e)}addMarker(e,t){if(this._assertWriterUsedCorrectly(),!t||typeof t.usingOperation!="boolean")throw new CKEditorError("writer-addmarker-no-usingoperation",this);const i=t.usingOperation,r=t.range,o=t.affectsData===void 0?!1:t.affectsData;if(this.model.markers.has(e))throw new CKEditorError("writer-addmarker-marker-exists",this);if(!r)throw new CKEditorError("writer-addmarker-no-range",this);return i?(applyMarkerOperation(this,e,null,r,o),this.model.markers.get(e)):this.model.markers._set(e,r,i,o)}updateMarker(e,t){this._assertWriterUsedCorrectly();const i=typeof e=="string"?e:e.name,r=this.model.markers.get(i);if(!r)throw new CKEditorError("writer-updatemarker-marker-not-exists",this);if(!t){logWarning("writer-updatemarker-reconvert-using-editingcontroller",{markerName:i}),this.model.markers._refresh(r);return}const o=typeof t.usingOperation=="boolean",a=typeof t.affectsData=="boolean",c=a?t.affectsData:r.affectsData;if(!o&&!t.range&&!a)throw new CKEditorError("writer-updatemarker-wrong-options",this);const u=r.getRange(),h=t.range?t.range:u;if(o&&t.usingOperation!==r.managedUsingOperations){t.usingOperation?applyMarkerOperation(this,i,null,h,c):(applyMarkerOperation(this,i,u,null,c),this.model.markers._set(i,h,void 0,c));return}r.managedUsingOperations?applyMarkerOperation(this,i,u,h,c):this.model.markers._set(i,h,void 0,c)}removeMarker(e){this._assertWriterUsedCorrectly();const t=typeof e=="string"?e:e.name;if(!this.model.markers.has(t))throw new CKEditorError("writer-removemarker-no-marker",this);const i=this.model.markers.get(t);if(!i.managedUsingOperations){this.model.markers._remove(t);return}const r=i.getRange();applyMarkerOperation(this,t,r,null,i.affectsData)}addRoot(e,t="$root"){this._assertWriterUsedCorrectly();const i=this.model.document.getRoot(e);if(i&&i.isAttached())throw new CKEditorError("writer-addroot-root-exists",this);const r=this.model.document,o=new RootOperation(e,t,!0,r,r.version);return this.batch.addOperation(o),this.model.applyOperation(o),this.model.document.getRoot(e)}detachRoot(e){this._assertWriterUsedCorrectly();const t=typeof e=="string"?this.model.document.getRoot(e):e;if(!t||!t.isAttached())throw new CKEditorError("writer-detachroot-no-root",this);for(const o of this.model.markers)o.getRange().root===t&&this.removeMarker(o);for(const o of t.getAttributeKeys())this.removeAttribute(o,t);this.remove(this.createRangeIn(t));const i=this.model.document,r=new RootOperation(t.rootName,t.name,!1,i,i.version);this.batch.addOperation(r),this.model.applyOperation(r)}setSelection(...e){this._assertWriterUsedCorrectly(),this.model.document.selection._setTo(...e)}setSelectionFocus(e,t){this._assertWriterUsedCorrectly(),this.model.document.selection._setFocus(e,t)}setSelectionAttribute(e,t){if(this._assertWriterUsedCorrectly(),typeof e=="string")this._setSelectionAttribute(e,t);else for(const[i,r]of toMap(e))this._setSelectionAttribute(i,r)}removeSelectionAttribute(e){if(this._assertWriterUsedCorrectly(),typeof e=="string")this._removeSelectionAttribute(e);else for(const t of e)this._removeSelectionAttribute(t)}overrideSelectionGravity(){return this.model.document.selection._overrideGravity()}restoreSelectionGravity(e){this.model.document.selection._restoreGravity(e)}_setSelectionAttribute(e,t){const i=this.model.document.selection;if(i.isCollapsed&&i.anchor.parent.isEmpty){const r=DocumentSelection._getStoreAttributeKey(e);this.setAttribute(r,t,i.anchor.parent)}i._setAttribute(e,t)}_removeSelectionAttribute(e){const t=this.model.document.selection;if(t.isCollapsed&&t.anchor.parent.isEmpty){const i=DocumentSelection._getStoreAttributeKey(e);this.removeAttribute(i,t.anchor.parent)}t._removeAttribute(e)}_assertWriterUsedCorrectly(){if(this.model._currentWriter!==this)throw new CKEditorError("writer-incorrect-use",this)}_addOperationForAffectedMarkers(e,t){for(const i of this.model.markers){if(!i.managedUsingOperations)continue;const r=i.getRange();let o=!1;if(e==="move"){const a=t;o=a.containsPosition(r.start)||a.start.isEqual(r.start)||a.containsPosition(r.end)||a.end.isEqual(r.end)}else{const a=t,c=a.nodeBefore,u=a.nodeAfter,h=r.start.parent==c&&r.start.isAtEnd,d=r.end.parent==u&&r.end.offset==0,f=r.end.nodeAfter==u,m=r.start.nodeAfter==u;o=h||d||f||m}o&&this.updateMarker(i.name,{range:r})}}};function setAttributeOnRange(e,t,i,r){const o=e.model,a=o.document;let c=r.start,u,h,d;for(const m of r.getWalker({shallow:!0}))d=m.item.getAttribute(t),u&&h!=d&&(h!=i&&f(),c=u),u=m.nextPosition,h=d;u instanceof Position&&u!=c&&h!=i&&f();function f(){const m=new Range(c,u),g=m.root.document?a.version:null,v=new AttributeOperation(m,t,h,i,g);e.batch.addOperation(v),o.applyOperation(v)}}function setAttributeOnItem(e,t,i,r){const o=e.model,a=o.document,c=r.getAttribute(t);let u,h;if(c!=i){if(r.root===r){const f=r.document?a.version:null;h=new RootAttributeOperation(r,t,c,i,f)}else{u=new Range(Position._createBefore(r),e.createPositionAfter(r));const f=u.root.document?a.version:null;h=new AttributeOperation(u,t,c,i,f)}e.batch.addOperation(h),o.applyOperation(h)}}function applyMarkerOperation(e,t,i,r,o){const a=e.model,c=a.document,u=new MarkerOperation(t,i,r,a.markers,!!o,c.version);e.batch.addOperation(u),a.applyOperation(u)}function applyRemoveOperation(e,t,i,r){let o;if(e.root.document){const a=r.document,c=new Position(a.graveyard,[0]);o=new MoveOperation(e,t,c,a.version)}else o=new DetachOperation(e,t);i.addOperation(o),r.applyOperation(o)}function isSameTree(e,t){return e===t||e instanceof RootElement&&t instanceof RootElement}function deleteContent(e,t,i={}){if(t.isCollapsed)return;const r=t.getFirstRange();if(r.root.rootName=="$graveyard")return;const o=e.schema;e.change(a=>{if(!i.doNotResetEntireContent&&shouldEntireContentBeReplacedWithParagraph(o,t)){replaceEntireContentWithParagraph(a,t);return}const c={};if(!i.doNotAutoparagraph){const d=t.getSelectedElement();d&&Object.assign(c,o.getAttributesWithProperty(d,"copyOnReplace",!0))}const[u,h]=getLivePositionsForSelectedBlocks(r);u.isTouching(h)||a.remove(a.createRange(u,h)),i.leaveUnmerged||(mergeBranches(a,u,h),o.removeDisallowedAttributes(u.parent.getChildren(),a)),collapseSelectionAt(a,t,u),!i.doNotAutoparagraph&&shouldAutoparagraph(o,u)&&insertParagraph(a,u,t,c),u.detach(),h.detach()})}function getLivePositionsForSelectedBlocks(e){const t=e.root.document.model,i=e.start;let r=e.end;if(t.hasContent(e,{ignoreMarkers:!0})){const o=getParentBlock(r);if(o&&r.isTouching(t.createPositionAt(o,0))){const a=t.createSelection(e);t.modifySelection(a,{direction:"backward"});const c=a.getLastPosition(),u=t.createRange(c,r);t.hasContent(u,{ignoreMarkers:!0})||(r=c)}}return[LivePosition.fromPosition(i,"toPrevious"),LivePosition.fromPosition(r,"toNext")]}function getParentBlock(e){const t=e.parent,i=t.root.document.model.schema,r=t.getAncestors({parentFirst:!0,includeSelf:!0});for(const o of r){if(i.isLimit(o))return null;if(i.isBlock(o))return o}}function mergeBranches(e,t,i){const r=e.model;if(!checkShouldMerge(e.model.schema,t,i))return;const[o,a]=getAncestorsJustBelowCommonAncestor(t,i);!o||!a||(!r.hasContent(o,{ignoreMarkers:!0})&&r.hasContent(a,{ignoreMarkers:!0})?mergeBranchesRight(e,t,i,o.parent):mergeBranchesLeft(e,t,i,o.parent))}function mergeBranchesLeft(e,t,i,r){const o=t.parent,a=i.parent;if(!(o==r||a==r)){for(t=e.createPositionAfter(o),i=e.createPositionBefore(a),i.isEqual(t)||e.insert(a,t),e.merge(t);i.parent.isEmpty;){const c=i.parent;i=e.createPositionBefore(c),e.remove(c)}checkShouldMerge(e.model.schema,t,i)&&mergeBranchesLeft(e,t,i,r)}}function mergeBranchesRight(e,t,i,r){const o=t.parent,a=i.parent;if(!(o==r||a==r)){for(t=e.createPositionAfter(o),i=e.createPositionBefore(a),i.isEqual(t)||e.insert(o,i);t.parent.isEmpty;){const c=t.parent;t=e.createPositionBefore(c),e.remove(c)}i=e.createPositionBefore(a),mergeRight(e,i),checkShouldMerge(e.model.schema,t,i)&&mergeBranchesRight(e,t,i,r)}}function mergeRight(e,t){const i=t.nodeBefore,r=t.nodeAfter;i.name!=r.name&&e.rename(i,r.name),e.clearAttributes(i),e.setAttributes(Object.fromEntries(r.getAttributes()),i),e.merge(t)}function checkShouldMerge(e,t,i){const r=t.parent,o=i.parent;return r==o||e.isLimit(r)||e.isLimit(o)?!1:isCrossingLimitElement(t,i,e)}function getAncestorsJustBelowCommonAncestor(e,t){const i=e.getAncestors(),r=t.getAncestors();let o=0;for(;i[o]&&i[o]==r[o];)o++;return[i[o],r[o]]}function shouldAutoparagraph(e,t){const i=e.checkChild(t,"$text"),r=e.checkChild(t,"paragraph");return!i&&r}function isCrossingLimitElement(e,t,i){const r=new Range(e,t);for(const o of r.getWalker())if(i.isLimit(o.item))return!1;return!0}function insertParagraph(e,t,i,r={}){const o=e.createElement("paragraph");e.model.schema.setAllowedAttributes(o,r,e),e.insert(o,t),collapseSelectionAt(e,i,e.createPositionAt(o,0))}function replaceEntireContentWithParagraph(e,t){const i=e.model.schema.getLimitElement(t);e.remove(e.createRangeIn(i)),insertParagraph(e,e.createPositionAt(i,0),t)}function shouldEntireContentBeReplacedWithParagraph(e,t){const i=e.getLimitElement(t);if(!t.containsEntireContent(i))return!1;const r=t.getFirstRange();return r.start.parent==r.end.parent?!1:e.checkChild(i,"paragraph")}function collapseSelectionAt(e,t,i){t instanceof DocumentSelection?e.setSelection(i):t.setTo(i)}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function getSelectedContent(e,t){return e.change(i=>{const r=i.createDocumentFragment(),o=t.getFirstRange();if(!o||o.isCollapsed)return r;const a=o.start.root,c=o.start.getCommonPath(o.end),u=a.getNodeByPath(c);let h;o.start.parent==o.end.parent?h=o:h=i.createRange(i.createPositionAt(u,o.start.path[c.length]),i.createPositionAt(u,o.end.path[c.length]+1));const d=h.end.offset-h.start.offset;for(const f of h.getItems({shallow:!0}))f.is("$textProxy")?i.appendText(f.data,f.getAttributes(),r):i.append(i.cloneElement(f,!0),r);if(h!=o){const f=o._getTransformedByMove(h.start,i.createPositionAt(r,0),d)[0],m=i.createRange(i.createPositionAt(r,0),f.start),g=i.createRange(f.end,i.createPositionAt(r,"end"));removeRangeContent(g,i),removeRangeContent(m,i)}return r})}function removeRangeContent(e,t){const i=[];Array.from(e.getItems({direction:"backward"})).map(r=>t.createRangeOn(r)).filter(r=>(r.start.isAfter(e.start)||r.start.isEqual(e.start))&&(r.end.isBefore(e.end)||r.end.isEqual(e.end))).forEach(r=>{i.push(r.start.parent),t.remove(r)}),i.forEach(r=>{let o=r;for(;o.parent&&o.isEmpty;){const a=t.createRangeOn(o);o=o.parent,t.remove(a)}})}function insertContent(e,t,i){return e.change(r=>{const o=i||e.document.selection;o.isCollapsed||e.deleteContent(o,{doNotAutoparagraph:!0});const a=new Insertion(e,r,o.anchor),c=[];let u;if(t.is("documentFragment")){if(t.markers.size){const f=[];for(const[m,g]of t.markers){const{start:v,end:_}=g,b=v.isEqual(_);f.push({position:v,name:m,isCollapsed:b},{position:_,name:m,isCollapsed:b})}f.sort(({position:m},{position:g})=>m.isBefore(g)?1:-1);for(const{position:m,name:g,isCollapsed:v}of f){let _=null,b=null;const S=m.parent===t&&m.isAtStart,T=m.parent===t&&m.isAtEnd;!S&&!T?(_=r.createElement("$marker"),r.insert(_,m)):v&&(b=S?"start":"end"),c.push({name:g,element:_,collapsed:b})}}u=t.getChildren()}else u=[t];a.handleNodes(u);let h=a.getSelectionRange();if(t.is("documentFragment")&&c.length){const f=h?LiveRange.fromRange(h):null,m={};for(let g=c.length-1;g>=0;g--){const{name:v,element:_,collapsed:b}=c[g],S=!m[v];if(S&&(m[v]=[]),_){const T=r.createPositionAt(_,"before");m[v].push(T),r.remove(_)}else{const T=a.getAffectedRange();if(!T){b&&m[v].push(a.position);continue}b?m[v].push(T[b]):m[v].push(S?T.start:T.end)}}for(const[g,[v,_]]of Object.entries(m))v&&_&&v.root===_.root&&v.root.document&&!r.model.markers.has(g)&&r.addMarker(g,{usingOperation:!0,affectsData:!0,range:new Range(v,_)});f&&(h=f.toRange(),f.detach())}/* istanbul ignore else -- @preserve */h&&(o instanceof DocumentSelection?r.setSelection(h):o.setTo(h));const d=a.getAffectedRange()||e.createRange(o.anchor);return a.destroy(),d})}var Insertion=class{model;writer;position;canMergeWith;schema;_documentFragment;_documentFragmentPosition;_firstNode=null;_lastNode=null;_lastAutoParagraph=null;_filterAttributesOf=[];_affectedStart=null;_affectedEnd=null;_nodeToSelect=null;constructor(e,t,i){this.model=e,this.writer=t,this.position=i,this.canMergeWith=new Set([this.position.parent]),this.schema=e.schema,this._documentFragment=t.createDocumentFragment(),this._documentFragmentPosition=t.createPositionAt(this._documentFragment,0)}handleNodes(e){for(const t of Array.from(e))this._handleNode(t);this._insertPartialFragment(),this._lastAutoParagraph&&this._updateLastNodeFromAutoParagraph(this._lastAutoParagraph),this._mergeOnRight(),this.schema.removeDisallowedAttributes(this._filterAttributesOf,this.writer),this._filterAttributesOf=[]}_updateLastNodeFromAutoParagraph(e){const t=this.writer.createPositionAfter(this._lastNode),i=this.writer.createPositionAfter(e);if(i.isAfter(t)){this._lastNode=e;/* istanbul ignore if -- @preserve */if(this.position.parent!=e||!this.position.isAtEnd)throw new CKEditorError("insertcontent-invalid-insertion-position",this);this.position=i,this._setAffectedBoundaries(this.position)}}getSelectionRange(){return this._nodeToSelect?Range._createOn(this._nodeToSelect):this.model.schema.getNearestSelectionRange(this.position)}getAffectedRange(){return this._affectedStart?new Range(this._affectedStart,this._affectedEnd):null}destroy(){this._affectedStart&&this._affectedStart.detach(),this._affectedEnd&&this._affectedEnd.detach()}_handleNode(e){if(!this._checkAndSplitToAllowedPosition(e)){this.schema.isObject(e)||this._handleDisallowedNode(e);return}this._appendToFragment(e),this._firstNode||(this._firstNode=e),this._lastNode=e}_insertPartialFragment(){if(this._documentFragment.isEmpty)return;const e=LivePosition.fromPosition(this.position,"toNext");this._setAffectedBoundaries(this.position),this._documentFragment.getChild(0)==this._firstNode&&(this.writer.insert(this._firstNode,this.position),this._mergeOnLeft(),this.position=e.toPosition()),this._documentFragment.isEmpty||this.writer.insert(this._documentFragment,this.position),this._documentFragmentPosition=this.writer.createPositionAt(this._documentFragment,0),this.position=e.toPosition(),e.detach()}_handleDisallowedNode(e){e.is("element")&&this.handleNodes(e.getChildren())}_appendToFragment(e){/* istanbul ignore if -- @preserve */if(!this.schema.checkChild(this.position,e))throw new CKEditorError("insertcontent-wrong-position",this,{node:e,position:this.position});this.writer.insert(e,this._documentFragmentPosition),this._documentFragmentPosition=this._documentFragmentPosition.getShiftedBy(e.offsetSize),this.schema.isObject(e)&&!this.schema.checkChild(this.position,"$text")?this._nodeToSelect=e:this._nodeToSelect=null,this._filterAttributesOf.push(e)}_setAffectedBoundaries(e){this._affectedStart||(this._affectedStart=LivePosition.fromPosition(e,"toPrevious")),(!this._affectedEnd||this._affectedEnd.isBefore(e))&&(this._affectedEnd&&this._affectedEnd.detach(),this._affectedEnd=LivePosition.fromPosition(e,"toNext"))}_mergeOnLeft(){const e=this._firstNode;if(!(e instanceof Element$2)||!this._canMergeLeft(e))return;const t=LivePosition._createBefore(e);t.stickiness="toNext";const i=LivePosition.fromPosition(this.position,"toNext");this._affectedStart.isEqual(t)&&(this._affectedStart.detach(),this._affectedStart=LivePosition._createAt(t.nodeBefore,"end","toPrevious")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.isEqual(this._affectedEnd)&&this._firstNode===this._lastNode&&(this._affectedEnd.detach(),this._affectedEnd=LivePosition._createAt(t.nodeBefore,"end","toNext")),this.position=i.toPosition(),i.detach(),this._filterAttributesOf.push(this.position.parent),t.detach()}_mergeOnRight(){const e=this._lastNode;if(!(e instanceof Element$2)||!this._canMergeRight(e))return;const t=LivePosition._createAfter(e);t.stickiness="toNext";/* istanbul ignore if -- @preserve */if(!this.position.isEqual(t))throw new CKEditorError("insertcontent-invalid-insertion-position",this);this.position=Position._createAt(t.nodeBefore,"end");const i=LivePosition.fromPosition(this.position,"toPrevious");this._affectedEnd.isEqual(t)&&(this._affectedEnd.detach(),this._affectedEnd=LivePosition._createAt(t.nodeBefore,"end","toNext")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.getShiftedBy(-1).isEqual(this._affectedStart)&&this._firstNode===this._lastNode&&(this._affectedStart.detach(),this._affectedStart=LivePosition._createAt(t.nodeBefore,0,"toPrevious")),this.position=i.toPosition(),i.detach(),this._filterAttributesOf.push(this.position.parent),t.detach()}_canMergeLeft(e){const t=e.previousSibling;return t instanceof Element$2&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(t,e)}_canMergeRight(e){const t=e.nextSibling;return t instanceof Element$2&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(e,t)}_insertAutoParagraph(){this._insertPartialFragment();const e=this.writer.createElement("paragraph");this.writer.insert(e,this.position),this._setAffectedBoundaries(this.position),this._lastAutoParagraph=e,this.position=this.writer.createPositionAt(e,0)}_checkAndSplitToAllowedPosition(e){const t=this._getAllowedIn(this.position.parent,e);if(!t)return!1;for(t!=this.position.parent&&this._insertPartialFragment();t!=this.position.parent;)if(this.position.isAtStart){const i=this.position.parent;this.position=this.writer.createPositionBefore(i),i.isEmpty&&i.parent===t&&this.writer.remove(i)}else if(this.position.isAtEnd)this.position=this.writer.createPositionAfter(this.position.parent);else{const i=this.writer.createPositionAfter(this.position.parent);this._setAffectedBoundaries(this.position),this.writer.split(this.position),this.position=i,this.canMergeWith.add(this.position.nodeAfter)}return this.schema.checkChild(this.position.parent,e)||this._insertAutoParagraph(),!0}_getAllowedIn(e,t){return this.schema.checkChild(e,t)||this.schema.checkChild(e,"paragraph")&&this.schema.checkChild("paragraph",t)?e:this.schema.isLimit(e)?null:this._getAllowedIn(e.parent,t)}};function insertObject(e,t,i,r={}){if(!e.schema.isObject(t))throw new CKEditorError("insertobject-element-not-an-object",e,{object:t});const o=i||e.document.selection;let a=o;r.findOptimalPosition&&e.schema.isBlock(t)&&(a=e.createSelection(e.schema.findOptimalInsertionRange(o,r.findOptimalPosition)));const c=first(o.getSelectedBlocks()),u={};return c&&Object.assign(u,e.schema.getAttributesWithProperty(c,"copyOnReplace",!0)),e.change(h=>{a.isCollapsed||e.deleteContent(a,{doNotAutoparagraph:!0});let d=t;const f=a.anchor.parent;!e.schema.checkChild(f,t)&&e.schema.checkChild(f,"paragraph")&&e.schema.checkChild("paragraph",t)&&(d=h.createElement("paragraph"),h.insert(t,d)),e.schema.setAllowedAttributes(d,u,h);const m=e.insertContent(d,a);return m.isCollapsed||r.setSelection&&updateSelection(h,t,r.setSelection,u),m})}function updateSelection(e,t,i,r){const o=e.model;if(i=="on"){e.setSelection(t,"on");return}if(i!="after")throw new CKEditorError("insertobject-invalid-place-parameter-value",o);let a=t.nextSibling;if(o.schema.isInline(t)){e.setSelection(t,"after");return}!(a&&o.schema.checkChild(a,"$text"))&&o.schema.checkChild(t.parent,"paragraph")&&(a=e.createElement("paragraph"),o.schema.setAllowedAttributes(a,r,e),o.insertContent(a,e.createPositionAfter(t))),a&&e.setSelection(a,0)}const wordBoundaryCharacters=' ,.?!:;"-()';function modifySelection(e,t,i={}){const r=e.schema,o=i.direction!="backward",a=i.unit?i.unit:"character",c=!!i.treatEmojiAsSingleUnit,u=t.focus,h=new TreeWalker({boundaries:getSearchRange(u,o),singleCharacters:!0,direction:o?"forward":"backward"}),d={walker:h,schema:r,isForward:o,unit:a,treatEmojiAsSingleUnit:c};let f;for(;f=h.next();){if(f.done)return;const m=tryExtendingTo(d,f.value);if(m){t instanceof DocumentSelection?e.change(g=>{g.setSelectionFocus(m)}):t.setFocus(m);return}}}function tryExtendingTo(e,t){const{isForward:i,walker:r,unit:o,schema:a,treatEmojiAsSingleUnit:c}=e,{type:u,item:h,nextPosition:d}=t;if(u=="text")return e.unit==="word"?getCorrectWordBreakPosition(r,i):getCorrectPosition(r,o,c);if(u==(i?"elementStart":"elementEnd")){if(a.isSelectable(h))return Position._createAt(h,i?"after":"before");if(a.checkChild(d,"$text"))return d}else{if(a.isLimit(h)){r.skip(()=>!0);return}if(a.checkChild(d,"$text"))return d}}function getCorrectPosition(e,t,i){const r=e.position.textNode;if(r){const o=r.data;let a=e.position.offset-r.startOffset;for(;isInsideSurrogatePair(o,a)||t=="character"&&isInsideCombinedSymbol(o,a)||i&&isInsideEmojiSequence(o,a);)e.next(),a=e.position.offset-r.startOffset}return e.position}function getCorrectWordBreakPosition(e,t){let i=e.position.textNode;for(i||(i=t?e.position.nodeAfter:e.position.nodeBefore);i&&i.is("$text");){const r=e.position.offset-i.startOffset;if(isAtNodeBoundary(i,r,t))i=t?e.position.nodeAfter:e.position.nodeBefore;else{if(isAtWordBoundary(i.data,r,t))break;e.next()}}return e.position}function getSearchRange(e,t){const i=e.root,r=Position._createAt(i,t?"end":0);return t?new Range(e,r):new Range(r,e)}function isAtWordBoundary(e,t,i){const r=t+(i?0:-1);return wordBoundaryCharacters.includes(e.charAt(r))}function isAtNodeBoundary(e,t,i){return t===(i?e.offsetSize:0)}var Model$1=class extends ObservableMixin(){markers;document;schema;_pendingChanges;_currentWriter;constructor(){super(),this.markers=new MarkerCollection,this.document=new Document(this),this.schema=new Schema,this._pendingChanges=[],this._currentWriter=null,["deleteContent","modifySelection","getSelectedContent","applyOperation"].forEach(e=>this.decorate(e)),this.on("applyOperation",(e,t)=>{t[0]._validate()},{priority:"highest"}),this.schema.register("$root",{isLimit:!0}),this.schema.register("$container",{allowIn:["$root","$container"]}),this.schema.register("$block",{allowIn:["$root","$container"],isBlock:!0}),this.schema.register("$blockObject",{allowWhere:"$block",isBlock:!0,isObject:!0}),this.schema.register("$inlineObject",{allowWhere:"$text",allowAttributesOf:"$text",isInline:!0,isObject:!0}),this.schema.register("$text",{allowIn:"$block",isInline:!0,isContent:!0}),this.schema.register("$clipboardHolder",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$documentFragment",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$marker"),this.schema.addChildCheck(()=>!0,"$marker"),injectSelectionPostFixer(this),this.document.registerPostFixer(autoParagraphEmptyRoots),this.on("insertContent",(e,[t,i])=>{e.return=insertContent(this,t,i)}),this.on("insertObject",(e,[t,i,r])=>{e.return=insertObject(this,t,i,r)}),this.on("canEditAt",e=>{const t=!this.document.isReadOnly;e.return=t,t||e.stop()})}change(e){try{return this._pendingChanges.length===0?(this._pendingChanges.push({batch:new Batch,callback:e}),this._runPendingChanges()[0]):e(this._currentWriter)}catch(t){/* istanbul ignore next -- @preserve */CKEditorError.rethrowUnexpectedError(t,this)}}enqueueChange(e,t){try{e?typeof e=="function"?(t=e,e=new Batch):e instanceof Batch||(e=new Batch(e)):e=new Batch,this._pendingChanges.push({batch:e,callback:t}),this._pendingChanges.length==1&&this._runPendingChanges()}catch(i){/* istanbul ignore next -- @preserve */CKEditorError.rethrowUnexpectedError(i,this)}}applyOperation(e){e._execute()}insertContent(e,t,i,...r){const o=normalizeSelectable(t,i);return this.fire("insertContent",[e,o,i,...r])}insertObject(e,t,i,r,...o){const a=normalizeSelectable(t,i);return this.fire("insertObject",[e,a,r,r,...o])}deleteContent(e,t){deleteContent(this,e,t)}modifySelection(e,t){modifySelection(this,e,t)}getSelectedContent(e){return getSelectedContent(this,e)}hasContent(e,t={}){const i=e instanceof Range?e:Range._createIn(e);if(i.isCollapsed)return!1;const{ignoreWhitespaces:r=!1,ignoreMarkers:o=!1}=t;if(!o){for(const a of this.markers.getMarkersIntersectingRange(i))if(a.affectsData)return!0}for(const a of i.getItems())if(this.schema.isContent(a))if(a.is("$textProxy"))if(r){if(a.data.search(/\S/)!==-1)return!0}else return!0;else return!0;return!1}canEditAt(e){const t=normalizeSelectable(e);return this.fire("canEditAt",[t])}createPositionFromPath(e,t,i){return new Position(e,t,i)}createPositionAt(e,t){return Position._createAt(e,t)}createPositionAfter(e){return Position._createAfter(e)}createPositionBefore(e){return Position._createBefore(e)}createRange(e,t){return new Range(e,t)}createRangeIn(e){return Range._createIn(e)}createRangeOn(e){return Range._createOn(e)}createSelection(...e){return new Selection(...e)}createBatch(e){return new Batch(e)}createOperationFromJSON(e){return OperationFactory.fromJSON(e,this.document)}destroy(){this.document.destroy(),this.stopListening()}_runPendingChanges(){const e=[];this.fire("_beforeChanges");try{for(;this._pendingChanges.length;){const t=this._pendingChanges[0].batch;this._currentWriter=new Writer(this,t);const i=this._pendingChanges[0].callback(this._currentWriter);e.push(i),this.document._handleChangeBlock(this._currentWriter),this._pendingChanges.shift(),this._currentWriter=null}}finally{this._pendingChanges.length=0,this._currentWriter=null,this.fire("_afterChanges")}return e}};function normalizeSelectable(e,t){if(e)return e instanceof Selection||e instanceof DocumentSelection?e:e instanceof Node$1$1?t||t===0?new Selection(e,t):e.is("rootElement")?new Selection(e,"in"):new Selection(e,"on"):new Selection(e)}var MouseObserver=class extends DomEventObserver{domEventType=["mousedown","mouseup","mouseover","mouseout"];onDomEvent(e){this.fire(e.type,e)}};/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/const HEX_COLOR_REGEXP=/^#([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/i,RGB_COLOR_REGEXP=/^rgb\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}[0-9]{1,3}[ %]?\)$/i,RGBA_COLOR_REGEXP=/^rgba\([ ]?([0-9]{1,3}[ %]?,[ ]?){3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,HSL_COLOR_REGEXP=/^hsl\([ ]?([0-9]{1,3}[ %]?[,]?[ ]*){3}(1|[0-9]+%|[0]?\.?[0-9]+)?\)$/i,HSLA_COLOR_REGEXP=/^hsla\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,CSS_SHORTHAND_VALUE_REGEXP=/\w+\((?:[^()]|\([^()]*\))*\)|\S+/gi,COLOR_NAMES=new Set(["black","silver","gray","white","maroon","red","purple","fuchsia","green","lime","olive","yellow","navy","blue","teal","aqua","orange","aliceblue","antiquewhite","aquamarine","azure","beige","bisque","blanchedalmond","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","gainsboro","ghostwhite","gold","goldenrod","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","limegreen","linen","magenta","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","oldlace","olivedrab","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","thistle","tomato","turquoise","violet","wheat","whitesmoke","yellowgreen","activeborder","activecaption","appworkspace","background","buttonface","buttonhighlight","buttonshadow","buttontext","captiontext","graytext","highlight","highlighttext","inactiveborder","inactivecaption","inactivecaptiontext","infobackground","infotext","menu","menutext","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","window","windowframe","windowtext","rebeccapurple","currentcolor","transparent"]);function isColor(e){return e.startsWith("#")?HEX_COLOR_REGEXP.test(e):e.startsWith("rgb")?RGB_COLOR_REGEXP.test(e)||RGBA_COLOR_REGEXP.test(e):e.startsWith("hsl")?HSL_COLOR_REGEXP.test(e)||HSLA_COLOR_REGEXP.test(e):COLOR_NAMES.has(e.toLowerCase())}const lengthRegExp=/^([+-]?[0-9]*([.][0-9]+)?(px|cm|mm|in|pc|pt|ch|em|ex|rem|vh|vw|vmin|vmax)|0)$/;function isLength(e){return lengthRegExp.test(e)}const PERCENTAGE_VALUE_REGEXP=/^[+-]?[0-9]*([.][0-9]+)?%$/;function isPercentage(e){return PERCENTAGE_VALUE_REGEXP.test(e)}const repeatValues=["repeat-x","repeat-y","repeat","space","round","no-repeat"];function isRepeat(e){return repeatValues.includes(e)}const positionValues=["center","top","bottom","left","right"];function isPosition(e){return positionValues.includes(e)}const attachmentValues=["fixed","scroll","local"];function isAttachment(e){return attachmentValues.includes(e)}const urlRegExp=/^url\(/;function isURL(e){return urlRegExp.test(e)}function getShorthandValues(e){const t=e.trim().slice(0,1500).matchAll(CSS_SHORTHAND_VALUE_REGEXP);return Array.from(t).map(i=>i[0])}function addBackgroundRules(e){e.setNormalizer("background",getBackgroundNormalizer()),e.setNormalizer("background-color",getBackgroundColorNormalizer()),e.setReducer("background",getBackgroundReducer()),e.setStyleRelation("background",["background-color"])}function getBackgroundNormalizer(){return e=>{const t={},i=getShorthandValues(e);for(const r of i)isRepeat(r)?(t.repeat=t.repeat||[],t.repeat.push(r)):isPosition(r)?(t.position=t.position||[],t.position.push(r)):isAttachment(r)?t.attachment=r:isColor(r)?t.color=r:isURL(r)&&(t.image=r);return{path:"background",value:t}}}function getBackgroundColorNormalizer(){return e=>({path:"background.color",value:e})}function getBackgroundReducer(){return e=>{const t=[];return t.push(["background-color",e.color]),t}}const ELEMENT_RANGE_START_TOKEN="[",ELEMENT_RANGE_END_TOKEN="]",TEXT_RANGE_START_TOKEN="{",TEXT_RANGE_END_TOKEN="}",allowedTypes={container:ContainerElement,attribute:AttributeElement,empty:EmptyElement,ui:UIElement,raw:RawElement},domConverterStub={setContentOf:(e,t)=>{e.innerHTML=t}};function getData$1(e,t={}){if(!(e instanceof View$1))throw new TypeError("View needs to be an instance of module:engine/view/view~View.");const i=e.document,r=!!t.withoutSelection,o=t.rootName||"main",a=i.getRoot(o),c={showType:t.showType,showPriority:t.showPriority,renderUIElements:t.renderUIElements,renderRawElements:t.renderRawElements,ignoreRoot:!0,domConverter:t.domConverter};return r?getData$1._stringify(a,null,c):getData$1._stringify(a,i.selection,c)}getData$1._stringify=stringify$1;function setData$1(e,t,i={}){if(!(e instanceof View$1))throw new TypeError("View needs to be an instance of module:engine/view/view~View.");const r=e.document,o=i.rootName||"main",a=r.getRoot(o);e.change(c=>{const u=setData$1._parse(t,{rootElement:a});u.view&&u.selection&&c.setSelection(u.selection)})}setData$1._parse=parse$1;function stringify$1(e,t=null,i={}){let r;return t instanceof Position$1||t instanceof Range$1?r=new DocumentSelection$1(t):r=t,new ViewStringify(e,r,i).stringify()}function parse$1(e,t={}){const i=new Document$1(new StylesProcessor);t.order=t.order||[];const r=new RangeParser({sameSelectionCharacters:t.sameSelectionCharacters}),o=new XmlDataProcessor(i,{namespaces:Object.keys(allowedTypes)});t.inlineObjectElements&&o.domConverter.inlineObjectElements.push(...t.inlineObjectElements);let a=o.toView(e);if(a=_convertViewElements(a),t.rootElement){const u=t.rootElement,h=a._removeChildren(0,a.childCount);u._removeChildren(0,u.childCount),u._appendChild(h),a=u}const c=r.parse(a,t.order);if(a.is("documentFragment")&&a.childCount===1&&(a=a.getChild(0)),c.length){const u=new DocumentSelection$1(c,{backward:!!t.lastRangeBackward});return{view:a,selection:u}}return a.parent&&a._remove(),a}var RangeParser=class{sameSelectionCharacters;_positions;constructor(e){this.sameSelectionCharacters=!!e.sameSelectionCharacters}parse(e,t){this._positions=[],this._getPositions(e);let i=this._createRanges();if(t.length){if(t.length!=i.length)throw new Error(`Parse error - there are ${i.length} ranges found, but ranges order array contains ${t.length} elements.`);i=this._sortRanges(i,t)}return i}_getPositions(e){if(e.is("documentFragment")||e.is("element")){const t=[...e.getChildren()];for(const i of t)this._getPositions(i)}if(e.is("$text")){const t=new RegExp(`[${TEXT_RANGE_START_TOKEN}${TEXT_RANGE_END_TOKEN}\\${ELEMENT_RANGE_END_TOKEN}\\${ELEMENT_RANGE_START_TOKEN}]`,"g");let i=e.data,r,o=0;const a=[];for(;r=t.exec(i);){const h=r.index,d=r[0];a.push({bracket:d,textOffset:h-o}),o++}i=i.replace(t,""),e._data=i;const c=e.index,u=e.parent;i||e._remove();for(const h of a)if(i)if(this.sameSelectionCharacters||!this.sameSelectionCharacters&&(h.bracket==TEXT_RANGE_START_TOKEN||h.bracket==TEXT_RANGE_END_TOKEN))this._positions.push({bracket:h.bracket,position:new Position$1(e,h.textOffset)});else{if(!this.sameSelectionCharacters&&h.textOffset!==0&&h.textOffset!==i.length)throw new Error(`Parse error - range delimiter '${h.bracket}' is placed inside text node.`);const d=h.textOffset===0?c:c+1;this._positions.push({bracket:h.bracket,position:new Position$1(u,d)})}else{if(!this.sameSelectionCharacters&&h.bracket==TEXT_RANGE_START_TOKEN||h.bracket==TEXT_RANGE_END_TOKEN)throw new Error(`Parse error - text range delimiter '${h.bracket}' is placed inside empty text node. `);this._positions.push({bracket:h.bracket,position:new Position$1(u,c)})}}}_sortRanges(e,t){const i=[];let r=0;for(const o of t){if(e[o-1]===void 0)throw new Error("Parse error - provided ranges order is invalid.");i[o-1]=e[r],r++}return i}_createRanges(){const e=[];let t=null;for(const i of this._positions){if(!t&&(i.bracket==ELEMENT_RANGE_END_TOKEN||i.bracket==TEXT_RANGE_END_TOKEN))throw new Error(`Parse error - end of range was found '${i.bracket}' but range was not started before.`);if(t&&(i.bracket==ELEMENT_RANGE_START_TOKEN||i.bracket==TEXT_RANGE_START_TOKEN))throw new Error(`Parse error - start of range was found '${i.bracket}' but one range is already started.`);i.bracket==ELEMENT_RANGE_START_TOKEN||i.bracket==TEXT_RANGE_START_TOKEN?t=new Range$1(i.position,i.position):(t.end=i.position,e.push(t),t=null)}if(t!==null)throw new Error("Parse error - range was started but no end delimiter was found.");return e}},ViewStringify=class{root;selection;ranges;showType;showPriority;showAttributeElementId;ignoreRoot;sameSelectionCharacters;renderUIElements;renderRawElements;domConverter;constructor(e,t,i){this.root=e,this.selection=t,this.ranges=[],t&&(this.ranges=[...t.getRanges()]),this.showType=!!i.showType,this.showPriority=!!i.showPriority,this.showAttributeElementId=!!i.showAttributeElementId,this.ignoreRoot=!!i.ignoreRoot,this.sameSelectionCharacters=!!i.sameSelectionCharacters,this.renderUIElements=!!i.renderUIElements,this.renderRawElements=!!i.renderRawElements,this.domConverter=i.domConverter||domConverterStub}stringify(){let e="";return this._walkView(this.root,t=>{e+=t}),e}_walkView(e,t){const i=this.ignoreRoot&&this.root===e;if(e.is("element")||e.is("documentFragment")){if(e.is("element")&&!i&&t(this._stringifyElementOpen(e)),this.renderUIElements&&e.is("uiElement"))t(e.render(document,this.domConverter).innerHTML);else if(this.renderRawElements&&e.is("rawElement")){const r=document.createElement("div");e.render(r,this.domConverter),t(r.innerHTML)}else{let r=0;t(this._stringifyElementRanges(e,r));for(const o of e.getChildren())this._walkView(o,t),r++,t(this._stringifyElementRanges(e,r))}e.is("element")&&!i&&t(this._stringifyElementClose(e))}e.is("$text")&&t(this._stringifyTextRanges(e))}_stringifyElementRanges(e,t){let i="",r="",o="";for(const a of this.ranges)a.start.parent==e&&a.start.offset===t&&(a.isCollapsed?o+=ELEMENT_RANGE_START_TOKEN+ELEMENT_RANGE_END_TOKEN:i+=ELEMENT_RANGE_START_TOKEN),a.end.parent===e&&a.end.offset===t&&!a.isCollapsed&&(r+=ELEMENT_RANGE_END_TOKEN);return r+o+i}_stringifyTextRanges(e){const t=e.data.length,i=e.data.split("");let r,o;this.sameSelectionCharacters?(r=ELEMENT_RANGE_START_TOKEN,o=ELEMENT_RANGE_END_TOKEN):(r=TEXT_RANGE_START_TOKEN,o=TEXT_RANGE_END_TOKEN),i[t]="";const a=i.map(c=>({letter:c,start:"",end:"",collapsed:""}));for(const c of this.ranges){const u=c.start,h=c.end;u.parent==e&&u.offset>=0&&u.offset<=t&&(c.isCollapsed?a[h.offset].collapsed+=r+o:a[u.offset].start+=r),h.parent==e&&h.offset>=0&&h.offset<=t&&!c.isCollapsed&&(a[h.offset].end+=o)}return a.map(c=>c.end+c.collapsed+c.start+c.letter).join("")}_stringifyElementOpen(e){const t=this._stringifyElementPriority(e),i=this._stringifyElementId(e),o=[this._stringifyElementType(e),e.name].filter(u=>u!=="").join(":"),a=this._stringifyElementAttributes(e);return`<${[o,t,i,a].filter(u=>u!=="").join(" ")}>`}_stringifyElementClose(e){return`</${[this._stringifyElementType(e),e.name].filter(r=>r!=="").join(":")}>`}_stringifyElementType(e){if(this.showType){for(const t in allowedTypes)if(e instanceof allowedTypes[t])return t}return""}_stringifyElementPriority(e){return this.showPriority&&e.is("attributeElement")?`view-priority="${e.priority}"`:""}_stringifyElementId(e){return this.showAttributeElementId&&e.is("attributeElement")&&e.id?`view-id="${e.id}"`:""}_stringifyElementAttributes(e){const t=[],i=[...e.getAttributeKeys()].sort();for(const r of i){let o;r==="class"?o=[...e.getClassNames()].sort().join(" "):r==="style"?o=[...e.getStyleNames()].sort().map(a=>`${a}:${e.getStyle(a).replace(/"/g,"&quot;")}`).join(";"):o=e.getAttribute(r),t.push(`${r}="${o}"`)}return t.join(" ")}};function _convertViewElements(e){if(e.is("element")||e.is("documentFragment")){const t=e.is("documentFragment")?new DocumentFragment$1(e.document):_convertElement(e.document,e);for(const i of[...e.getChildren()]){if(t.is("emptyElement"))throw new Error("Parse error - cannot parse inside EmptyElement.");if(t.is("uiElement"))throw new Error("Parse error - cannot parse inside UIElement.");if(t.is("rawElement"))throw new Error("Parse error - cannot parse inside RawElement.");t._appendChild(_convertViewElements(i))}return t}return e}function _convertElement(e,t){const i=_convertElementNameAndInfo(t),r=allowedTypes[i.type],o=r?new r(e,i.name):new Element$1(e,i.name);o.is("attributeElement")&&(i.priority!==null&&(o._priority=i.priority),i.id!==null&&(o._id=i.id));for(const a of t.getAttributeKeys())o._setAttribute(a,t.getAttribute(a));return o}function _convertElementNameAndInfo(e){const t=e.name.split(":"),i=_convertPriority(e.getAttribute("view-priority")),r=e.hasAttribute("view-id")?e.getAttribute("view-id"):null;if(e._removeAttribute("view-priority"),e._removeAttribute("view-id"),t.length==1)return{name:t[0],type:i!==null?"attribute":null,priority:i,id:r};const o=_convertType(t[0]);if(o)return{name:t[1],type:o,priority:i,id:r};throw new Error(`Parse error - cannot parse element's name: ${e.name}.`)}function _convertType(e){return e in allowedTypes?e:null}function _convertPriority(e){const t=parseInt(e,10);return isNaN(t)?null:t}function getData(e,t={}){if(!(e instanceof Model$1))throw new TypeError("Model needs to be an instance of module:engine/model/model~Model.");const i=t.rootName||"main",r=e.document.getRoot(i);return getData._stringify(r,t.withoutSelection?null:e.document.selection,t.convertMarkers?e.markers:null)}getData._stringify=stringify;function setData(e,t,i={}){if(!(e instanceof Model$1))throw new TypeError("Model needs to be an instance of module:engine/model/model~Model.");let r,o=null;const a=e.document.getRoot(i.rootName||"main"),c=setData._parse(t,e.schema,{lastRangeBackward:i.lastRangeBackward,selectionAttributes:i.selectionAttributes,context:[a.name],inlineObjectElements:i.inlineObjectElements});"model"in c?(r=c.model,o=c.selection):r=c,i.batchType!==void 0?e.enqueueChange(i.batchType,u):e.change(u);function u(h){if(h.remove(h.createRangeIn(a)),h.insert(r,a),h.setSelection(null),h.removeSelectionAttribute(e.document.selection.getAttributeKeys()),o){const d=[];for(const f of o.getRanges()){const m=new Position(a,f.start.path),g=new Position(a,f.end.path);d.push(new Range(m,g))}h.setSelection(d,{backward:o.isBackward}),i.selectionAttributes&&h.setSelectionAttribute(o.getAttributes())}}}setData._parse=parse$2;function stringify(e,t=null,i=null){const r=new Model$1,o=new Mapper;let a=null,c;if(e instanceof RootElement||e instanceof DocumentFragment)c=r.createRangeIn(e);else if(e.parent)c=new Range(r.createPositionBefore(e),r.createPositionAfter(e));else{const b=new DocumentFragment(e);c=r.createRangeIn(b)}t instanceof Selection||t instanceof DocumentSelection?a=t:t instanceof Range?a=new Selection(t):t instanceof Position&&(a=new Selection(t));const u=new StylesProcessor,h=new View$1(u),d=h.document,f=new RootEditableElement(d,"div");f.rootName="main",d.roots.add(f);const m=new DowncastDispatcher({mapper:o,schema:r.schema});o.bindElements(e.root,f),m.on("insert:$text",insertText()),m.on("insert",insertAttributesAndChildren(),{priority:"lowest"}),m.on("attribute",(b,S,T)=>{(S.item instanceof Selection||S.item instanceof DocumentSelection||S.item.is("$textProxy"))&&wrap((I,{writer:R})=>R.createAttributeElement("model-text-with-attributes",{[S.attributeKey]:stringifyAttributeValue(I)}))(b,S,T)}),m.on("insert",insertElement(b=>{const S=convertAttributes(b.getAttributes(),stringifyAttributeValue);return new ContainerElement(d,b.name,S)})),m.on("selection",convertRangeSelection()),m.on("selection",convertCollapsedSelection()),m.on("addMarker",insertUIElement((b,{writer:S})=>{const T=b.markerName+":"+(b.isOpening?"start":"end");return S.createUIElement(T)}));const g=new Map;if(i)for(const b of Array.from(i).sort((S,T)=>S.name<T.name?1:-1))g.set(b.name,b.getRange());const v=h._writer;m.convert(c,g,v),a&&m.convertSelection(a,i||r.markers,v);let _=stringify$1(f,d.selection,{sameSelectionCharacters:!0});return _=_.substr(5,_.length-11),h.destroy(),_.replace(new RegExp("model-text-with-attributes","g"),"$text")}function parse$2(e,t,i={}){const r=new Mapper;e=e.replace(new RegExp("\\$text","g"),"model-text-with-attributes");const o=parse$1(e,{sameSelectionCharacters:!0,lastRangeBackward:!!i.lastRangeBackward,inlineObjectElements:i.inlineObjectElements});let a,c=null,u=null;"view"in o&&"selection"in o?(a=o.view,c=o.selection):a=o;const h=new Model$1,d=new UpcastDispatcher({schema:t});d.on("documentFragment",convertToModelFragment(r)),d.on("element:model-text-with-attributes",convertToModelText()),d.on("element",convertToModelElement(r)),d.on("text",convertToModelText());let f=h.change(m=>d.convert(a.root,m,i.context||"$root"));if(r.bindElements(f,a.root),f.childCount==1&&(f=f.getChild(0)),c){const m=[];for(const g of c.getRanges())m.push(r.toModelRange(g));u=new Selection(m,{backward:c.isBackward});for(const[g,v]of toMap(i.selectionAttributes||[]))u.setAttribute(g,v)}return u?{model:f,selection:u}:f}function convertToModelFragment(e){return(t,i,r)=>{const o=r.convertChildren(i.viewItem,i.modelCursor);e.bindElements(i.modelCursor.parent,i.viewItem),i=Object.assign(i,o),t.stop()}}function convertToModelElement(e){return(t,i,r)=>{const o=i.viewItem.name;if(!r.schema.checkChild(i.modelCursor,o))throw new Error(`Element '${o}' was not allowed in given position.`);const a=convertAttributes(i.viewItem.getAttributes(),parseAttributeValue),c=r.writer.createElement(i.viewItem.name,a);r.writer.insert(c,i.modelCursor),e.bindElements(c,i.viewItem),r.convertChildren(i.viewItem,c),i.modelRange=Range._createOn(c),i.modelCursor=i.modelRange.end,t.stop()}}function convertToModelText(){return(e,t,i)=>{if(!i.schema.checkChild(t.modelCursor,"$text"))throw new Error("Text was not allowed in given position.");let r;if(t.viewItem.is("element")){const o=convertAttributes(t.viewItem.getAttributes(),parseAttributeValue),a=t.viewItem.getChild(0);r=i.writer.createText(a.data,o)}else r=i.writer.createText(t.viewItem.data);i.writer.insert(r,t.modelCursor),t.modelRange=Range._createFromPositionAndShift(t.modelCursor,r.offsetSize),t.modelCursor=t.modelRange.end,e.stop()}}function parseAttributeValue(e){try{return JSON.parse(e)}catch{return e}}function stringifyAttributeValue(e){return isPlainObject_default(e)?JSON.stringify(e):e}function*convertAttributes(e,t){for(const[i,r]of e)yield[i,t(r)]}var Watchdog=class{crashes=[];state="initializing";_crashNumberLimit;_now=Date.now;_minimumNonErrorTimePeriod;_boundErrorHandler;_listeners;constructor(e){if(this.crashes=[],this._crashNumberLimit=typeof e.crashNumberLimit=="number"?e.crashNumberLimit:3,this._minimumNonErrorTimePeriod=typeof e.minimumNonErrorTimePeriod=="number"?e.minimumNonErrorTimePeriod:5e3,this._boundErrorHandler=t=>{const i="error"in t?t.error:t.reason;i instanceof Error&&this._handleError(i,t)},this._listeners={},!this._restart)throw new Error("The Watchdog class was split into the abstract `Watchdog` class and the `EditorWatchdog` class. Please, use `EditorWatchdog` if you have used the `Watchdog` class previously.")}destroy(){this._stopErrorHandling(),this._listeners={}}on(e,t){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t)}off(e,t){this._listeners[e]=this._listeners[e].filter(i=>i!==t)}_fire(e,...t){const i=this._listeners[e]||[];for(const r of i)r.apply(this,[null,...t])}_startErrorHandling(){window.addEventListener("error",this._boundErrorHandler),window.addEventListener("unhandledrejection",this._boundErrorHandler)}_stopErrorHandling(){window.removeEventListener("error",this._boundErrorHandler),window.removeEventListener("unhandledrejection",this._boundErrorHandler)}_handleError(e,t){if(this._shouldReactToError(e)){this.crashes.push({message:e.message,stack:e.stack,filename:t instanceof ErrorEvent?t.filename:void 0,lineno:t instanceof ErrorEvent?t.lineno:void 0,colno:t instanceof ErrorEvent?t.colno:void 0,date:this._now()});const i=this._shouldRestart();this.state="crashed",this._fire("stateChange"),this._fire("error",{error:e,causesRestart:i}),i?this._restart():(this.state="crashedPermanently",this._fire("stateChange"))}}_shouldReactToError(e){return e.is&&e.is("CKEditorError")&&e.context!==void 0&&e.context!==null&&this.state==="ready"&&this._isErrorComingFromThisItem(e)}_shouldRestart(){if(this.crashes.length<=this._crashNumberLimit)return!0;const e=this.crashes[this.crashes.length-1].date,t=this.crashes[this.crashes.length-1-this._crashNumberLimit].date;return(e-t)/this._crashNumberLimit>this._minimumNonErrorTimePeriod}};/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function getSubNodes(e,t=new Set){const i=[e],r=new Set;let o=0;for(;i.length>o;){const a=i[o++];if(!(r.has(a)||!shouldNodeBeIncluded(a)||t.has(a)))if(r.add(a),Symbol.iterator in a)try{for(const c of a)i.push(c)}catch{}else for(const c in a)c!=="defaultValue"&&i.push(a[c])}return r}function shouldNodeBeIncluded(e){const t=Object.prototype.toString.call(e),i=typeof e;return!(i==="number"||i==="boolean"||i==="string"||i==="symbol"||i==="function"||t==="[object Date]"||t==="[object RegExp]"||t==="[object Module]"||e===void 0||e===null||e._watchdogExcluded||e instanceof EventTarget||e instanceof Event)}function areConnectedThroughProperties(e,t,i=new Set){if(e===t&&isObject$1(e))return!0;const r=getSubNodes(e,i),o=getSubNodes(t,i);for(const a of r)if(o.has(a))return!0;return!1}function isObject$1(e){return typeof e=="object"&&e!==null}var EditorWatchdog=class extends Watchdog{_editor=null;_lifecyclePromise=null;_throttledSave;_data;_lastDocumentVersion;_elementOrData;_initUsingData=!0;_editables={};_config;_excludedProps;constructor(e,t={}){super(t),this._throttledSave=throttle_default(this._save.bind(this),typeof t.saveInterval=="number"?t.saveInterval:5e3),e&&(this._creator=(i,r)=>e.create(i,r)),this._destructor=i=>i.destroy()}get editor(){return this._editor}get _item(){return this._editor}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}_restart(){return Promise.resolve().then(()=>(this.state="initializing",this._fire("stateChange"),this._destroy())).catch(e=>{console.error("An error happened during the editor destroying.",e)}).then(()=>{const e={},t=[],i=this._config.rootsAttributes||{},r={};for(const[a,c]of Object.entries(this._data.roots))c.isLoaded?(e[a]="",r[a]=i[a]||{}):t.push(a);const o={...this._config,extraPlugins:this._config.extraPlugins||[],lazyRoots:t,rootsAttributes:r,_watchdogInitialData:this._data};return delete o.initialData,o.extraPlugins.push(EditorWatchdogInitPlugin),this._initUsingData?this.create(e,o,o.context):isElement_default(this._elementOrData)?this.create(this._elementOrData,o,o.context):this.create(this._editables,o,o.context)}).then(()=>{this._fire("restart")})}create(e=this._elementOrData,t=this._config,i){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(super._startErrorHandling(),this._elementOrData=e,this._initUsingData=typeof e=="string"||Object.keys(e).length>0&&typeof Object.values(e)[0]=="string",this._config=this._cloneEditorConfiguration(t)||{},this._config.context=i,this._creator(e,this._config))).then(r=>{this._editor=r,r.model.document.on("change:data",this._throttledSave),this._lastDocumentVersion=r.model.document.version,this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this.state="ready",this._fire("stateChange")}).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}destroy(){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy())).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling(),this._throttledSave.cancel();const e=this._editor;return this._editor=null,e.model.document.off("change:data",this._throttledSave),this._destructor(e)})}_save(){const e=this._editor.model.document.version;try{this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this._lastDocumentVersion=e}catch(t){console.error(t,"An error happened during restoring editor data. Editor will be restored from the previously saved data.")}}_setExcludedProperties(e){this._excludedProps=e}_getData(){const e=this._editor,t=e.model.document.roots.filter(c=>c.isAttached()&&c.rootName!="$graveyard"),{plugins:i}=e,r=i.has("CommentsRepository")&&i.get("CommentsRepository"),o=i.has("TrackChanges")&&i.get("TrackChanges"),a={roots:{},markers:{},commentThreads:JSON.stringify([]),suggestions:JSON.stringify([])};t.forEach(c=>{a.roots[c.rootName]={content:JSON.stringify(Array.from(c.getChildren())),attributes:JSON.stringify(Array.from(c.getAttributes())),isLoaded:c._isLoaded}});for(const c of e.model.markers)c._affectsData&&(a.markers[c.name]={rangeJSON:c.getRange().toJSON(),usingOperation:c._managedUsingOperations,affectsData:c._affectsData});return r&&(a.commentThreads=JSON.stringify(r.getCommentThreads({toJSON:!0,skipNotAttached:!0}))),o&&(a.suggestions=JSON.stringify(o.getSuggestions({toJSON:!0,skipNotAttached:!0}))),a}_getEditables(){const e={};for(const t of this.editor.model.document.getRootNames()){const i=this.editor.ui.getEditableElement(t);i&&(e[t]=i)}return e}_isErrorComingFromThisItem(e){return areConnectedThroughProperties(this._editor,e.context,this._excludedProps)}_cloneEditorConfiguration(e){return cloneDeepWith_default(e,(t,i)=>{if(isElement_default(t)||i==="context")return t})}},EditorWatchdogInitPlugin=class{editor;_data;constructor(e){this.editor=e,this._data=e.config.get("_watchdogInitialData")}init(){this.editor.data.on("init",e=>{e.stop(),this.editor.model.enqueueChange({isUndoable:!1},t=>{this._restoreCollaborationData(),this._restoreEditorData(t)}),this.editor.data.fire("ready")},{priority:999})}_createNode(e,t){if("name"in t){const i=e.createElement(t.name,t.attributes);if(t.children)for(const r of t.children)i._appendChild(this._createNode(e,r));return i}else return e.createText(t.data,t.attributes)}_restoreEditorData(e){const t=this.editor;Object.entries(this._data.roots).forEach(([i,{content:r,attributes:o}])=>{const a=JSON.parse(r),c=JSON.parse(o),u=t.model.document.getRoot(i);for(const[h,d]of c)e.setAttribute(h,d,u);for(const h of a){const d=this._createNode(e,h);e.insert(d,u,"end")}}),Object.entries(this._data.markers).forEach(([i,r])=>{const{document:o}=t.model,{rangeJSON:{start:a,end:c},...u}=r,h=o.getRoot(a.root),d=e.createPositionFromPath(h,a.path,a.stickiness),f=e.createPositionFromPath(h,c.path,c.stickiness),m=e.createRange(d,f);e.addMarker(i,{range:m,...u})})}_restoreCollaborationData(){const e=JSON.parse(this._data.commentThreads),t=JSON.parse(this._data.suggestions);e.forEach(i=>{const r=this.editor.config.get("collaboration.channelId"),o=this.editor.plugins.get("CommentsRepository");o.hasCommentThread(i.threadId)&&o.getCommentThread(i.threadId).remove(),o.addCommentThread({channelId:r,...i})}),t.forEach(i=>{const r=this.editor.plugins.get("TrackChangesEditing");if(r.hasSuggestion(i.id)){const o=r.getSuggestion(i.id);o.attributes=i.attributes}else r.addSuggestionData(i)})}};/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/const mainQueueId=Symbol("MainQueueId");var ContextWatchdog=class extends Watchdog{_watchdogs=new Map;_watchdogConfig;_context=null;_contextProps=new Set;_actionQueues=new ActionQueues;_contextConfig;_item;constructor(e,t={}){super(t),this._watchdogConfig=t,this._creator=i=>e.create(i),this._destructor=i=>i.destroy(),this._actionQueues.onEmpty(()=>{this.state==="initializing"&&(this.state="ready",this._fire("stateChange"))})}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}get context(){return this._context}create(e={}){return this._actionQueues.enqueue(mainQueueId,()=>(this._contextConfig=e,this._create()))}getItem(e){return this._getWatchdog(e)._item}getItemState(e){return this._getWatchdog(e).state}add(e){const t=toArray(e);return Promise.all(t.map(i=>this._actionQueues.enqueue(i.id,()=>{if(this.state==="destroyed")throw new Error("Cannot add items to destroyed watchdog.");if(!this._context)throw new Error("Context was not created yet. You should call the `ContextWatchdog#create()` method first.");let r;if(this._watchdogs.has(i.id))throw new Error(`Item with the given id is already added: '${i.id}'.`);if(i.type==="editor")return r=new EditorWatchdog(null,this._watchdogConfig),r.setCreator(i.creator),r._setExcludedProperties(this._contextProps),i.destructor&&r.setDestructor(i.destructor),this._watchdogs.set(i.id,r),r.on("error",(o,{error:a,causesRestart:c})=>{this._fire("itemError",{itemId:i.id,error:a}),c&&this._actionQueues.enqueue(i.id,()=>new Promise(u=>{const h=()=>{r.off("restart",h),this._fire("itemRestart",{itemId:i.id}),u()};r.on("restart",h)}))}),r.create(i.sourceElementOrData,i.config,this._context);throw new Error(`Not supported item type: '${i.type}'.`)})))}remove(e){const t=toArray(e);return Promise.all(t.map(i=>this._actionQueues.enqueue(i,()=>{const r=this._getWatchdog(i);return this._watchdogs.delete(i),r.destroy()})))}destroy(){return this._actionQueues.enqueue(mainQueueId,()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy()))}_restart(){return this._actionQueues.enqueue(mainQueueId,()=>(this.state="initializing",this._fire("stateChange"),this._destroy().catch(e=>{console.error("An error happened during destroying the context or items.",e)}).then(()=>this._create()).then(()=>this._fire("restart"))))}_create(){return Promise.resolve().then(()=>(this._startErrorHandling(),this._creator(this._contextConfig))).then(e=>(this._context=e,this._contextProps=getSubNodes(this._context),Promise.all(Array.from(this._watchdogs.values()).map(t=>(t._setExcludedProperties(this._contextProps),t.create(void 0,void 0,this._context))))))}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling();const e=this._context;return this._context=null,this._contextProps=new Set,Promise.all(Array.from(this._watchdogs.values()).map(t=>t.destroy())).then(()=>this._destructor(e))})}_getWatchdog(e){const t=this._watchdogs.get(e);if(!t)throw new Error(`Item with the given id was not registered: ${e}.`);return t}_isErrorComingFromThisItem(e){for(const t of this._watchdogs.values())if(t._isErrorComingFromThisItem(e))return!1;return areConnectedThroughProperties(this._context,e.context)}},ActionQueues=class{_onEmptyCallbacks=[];_queues=new Map;_activeActions=0;onEmpty(e){this._onEmptyCallbacks.push(e)}enqueue(e,t){const i=e===mainQueueId;this._activeActions++,this._queues.get(e)||this._queues.set(e,Promise.resolve());const o=(i?Promise.all(this._queues.values()):Promise.all([this._queues.get(mainQueueId),this._queues.get(e)])).then(t),a=o.catch(()=>{});return this._queues.set(e,a),o.finally(()=>{this._activeActions--,this._queues.get(e)===a&&this._activeActions===0&&this._onEmptyCallbacks.forEach(c=>c())})}};function toArray(e){return Array.isArray(e)?e:[e]}var Plugin=class extends ObservableMixin(){editor;_disableStack=new Set;constructor(e){super(),this.editor=e,this.set("isEnabled",!0)}forceDisabled(e){this._disableStack.add(e),this._disableStack.size==1&&(this.on("set:isEnabled",forceDisable$1,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),this._disableStack.size==0&&(this.off("set:isEnabled",forceDisable$1),this.isEnabled=!0)}destroy(){this.stopListening()}static get isContextPlugin(){return!1}static get isOfficialPlugin(){return!1}static get isPremiumPlugin(){return!1}};function forceDisable$1(e){e.return=!1,e.stop()}var Command=class extends ObservableMixin(){editor;_isEnabledBasedOnSelection;_affectsData;_disableStack;constructor(e){super(),this.editor=e,this.set("value",void 0),this.set("isEnabled",!1),this._affectsData=!0,this._isEnabledBasedOnSelection=!0,this._disableStack=new Set,this.decorate("execute"),this.listenTo(this.editor.model.document,"change",()=>{this.refresh()}),this.listenTo(e,"change:isReadOnly",()=>{this.refresh()}),this.on("set:isEnabled",t=>{if(!this.affectsData)return;const i=e.model.document.selection,o=!(i.getFirstPosition().root.rootName=="$graveyard")&&e.model.canEditAt(i);(e.isReadOnly||this._isEnabledBasedOnSelection&&!o)&&(t.return=!1,t.stop())},{priority:"highest"}),this.on("execute",t=>{this.isEnabled||t.stop()},{priority:"high"})}get affectsData(){return this._affectsData}set affectsData(e){this._affectsData=e}refresh(){this.isEnabled=!0}forceDisabled(e){this._disableStack.add(e),this._disableStack.size==1&&(this.on("set:isEnabled",forceDisable,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),this._disableStack.size==0&&(this.off("set:isEnabled",forceDisable),this.refresh())}execute(...e){}destroy(){this.stopListening()}};function forceDisable(e){e.return=!1,e.stop()}var PluginCollection=class extends EmitterMixin(){_context;_plugins=new Map;_availablePlugins;_contextPlugins;constructor(e,t=[],i=[]){super(),this._context=e,this._availablePlugins=new Map;for(const r of t)r.pluginName&&this._availablePlugins.set(r.pluginName,r);this._contextPlugins=new Map;for(const[r,o]of i)this._contextPlugins.set(r,o),this._contextPlugins.set(o,r),r.pluginName&&this._availablePlugins.set(r.pluginName,r)}*[Symbol.iterator](){for(const e of this._plugins)typeof e[0]=="function"&&(yield e)}get(e){const t=this._plugins.get(e);if(!t){let i=e;throw typeof e=="function"&&(i=e.pluginName||e.name),new CKEditorError("plugincollection-plugin-not-loaded",this._context,{plugin:i})}return t}has(e){return this._plugins.has(e)}init(e,t=[],i=[]){const r=this,o=this._context;g(e),_(e);const a=e.filter(O=>!f(O,t)),c=[...v(a)];R(c,i);const u=A(c);return I(u,"init").then(()=>I(u,"afterInit")).then(()=>u);function h(O){return typeof O=="function"}function d(O){return h(O)&&!!O.isContextPlugin}function f(O,P){return P.some(L=>L===O||m(O)===L||m(L)===O)}function m(O){return h(O)?O.pluginName||O.name:O}function g(O,P=new Set){O.forEach(L=>{h(L)&&(P.has(L)||(P.add(L),L.pluginName&&!r._availablePlugins.has(L.pluginName)&&r._availablePlugins.set(L.pluginName,L),L.requires&&g(L.requires,P)))})}function v(O,P=new Set){return O.map(L=>h(L)?L:r._availablePlugins.get(L)).reduce((L,V)=>P.has(V)?L:(P.add(V),V.requires&&(_(V.requires,V),v(V.requires,P).forEach(U=>L.add(U))),L.add(V)),new Set)}function _(O,P=null){O.map(L=>h(L)?L:r._availablePlugins.get(L)||L).forEach(L=>{b(L,P),S(L,P),T(L,P)})}function b(O,P){if(!h(O))throw P?new CKEditorError("plugincollection-soft-required",o,{missingPlugin:O,requiredBy:m(P)}):new CKEditorError("plugincollection-plugin-not-found",o,{plugin:O})}function S(O,P){if(d(P)&&!d(O))throw new CKEditorError("plugincollection-context-required",o,{plugin:m(O),requiredBy:m(P)})}function T(O,P){if(P&&f(O,t))throw new CKEditorError("plugincollection-required",o,{plugin:m(O),requiredBy:m(P)})}function A(O){return O.map(P=>{let L=r._contextPlugins.get(P);return L=L||new P(o),r._add(P,L),L})}function I(O,P){return O.reduce((L,V)=>!V[P]||r._contextPlugins.has(V)?L:L.then(V[P].bind(V)),Promise.resolve())}function R(O,P){for(const L of P){if(typeof L!="function")throw new CKEditorError("plugincollection-replace-plugin-invalid-type",null,{pluginItem:L});const V=L.pluginName;if(!V)throw new CKEditorError("plugincollection-replace-plugin-missing-name",null,{pluginItem:L});if(L.requires&&L.requires.length)throw new CKEditorError("plugincollection-plugin-for-replacing-cannot-have-dependencies",null,{pluginName:V});const U=r._availablePlugins.get(V);if(!U)throw new CKEditorError("plugincollection-plugin-for-replacing-not-exist",null,{pluginName:V});const $=O.indexOf(U);if($===-1){if(r._contextPlugins.has(U))return;throw new CKEditorError("plugincollection-plugin-for-replacing-not-loaded",null,{pluginName:V})}if(U.requires&&U.requires.length)throw new CKEditorError("plugincollection-replaced-plugin-cannot-have-dependencies",null,{pluginName:V});O.splice($,1,L),r._availablePlugins.set(V,L)}}}destroy(){const e=[];for(const[,t]of this)typeof t.destroy=="function"&&!this._contextPlugins.has(t)&&e.push(t.destroy());return Promise.all(e)}_add(e,t){this._plugins.set(e,t);const i=e.pluginName;if(i){if(this._plugins.has(i))throw new CKEditorError("plugincollection-plugin-name-conflict",null,{pluginName:i,plugin1:this._plugins.get(i).constructor,plugin2:e});this._plugins.set(i,t)}}},Context=class{config;plugins;locale;t;editors;static defaultConfig;static builtinPlugins;_contextOwner=null;constructor(e){const{translations:t,...i}=e||{};this.config=new Config(i,this.constructor.defaultConfig);const r=this.constructor.builtinPlugins;this.config.define("plugins",r),this.plugins=new PluginCollection(this,r);const o=this.config.get("language")||{};this.locale=new Locale({uiLanguage:typeof o=="string"?o:o.ui,contentLanguage:this.config.get("language.content"),translations:t}),this.t=this.locale.t,this.editors=new Collection}initPlugins(){const e=this.config.get("plugins")||[],t=this.config.get("substitutePlugins")||[];for(const i of e.concat(t)){if(typeof i!="function")throw new CKEditorError("context-initplugins-constructor-only",null,{Plugin:i});if(i.isContextPlugin!==!0)throw new CKEditorError("context-initplugins-invalid-plugin",null,{Plugin:i})}return this.plugins.init(e,[],t)}destroy(){return Promise.all(Array.from(this.editors,e=>e.destroy())).then(()=>this.plugins.destroy())}_addEditor(e,t){if(this._contextOwner)throw new CKEditorError("context-addeditor-private-context");this.editors.add(e),t&&(this._contextOwner=e)}_removeEditor(e){return this.editors.has(e)&&this.editors.remove(e),this._contextOwner===e?this.destroy():Promise.resolve()}_getEditorConfig(){const e={};for(const t of this.config.names())["plugins","removePlugins","extraPlugins"].includes(t)||(e[t]=this.config.get(t));return e}static create(e){return new Promise(t=>{const i=new this(e);t(i.initPlugins().then(()=>i))})}},CommandCollection=class{_commands;constructor(){this._commands=new Map}add(e,t){this._commands.set(e,t)}get(e){return this._commands.get(e)}execute(e,...t){const i=this.get(e);if(!i)throw new CKEditorError("commandcollection-command-not-found",this,{commandName:e});return i.execute(...t)}*names(){yield*this._commands.keys()}*commands(){yield*this._commands.values()}[Symbol.iterator](){return this._commands[Symbol.iterator]()}destroy(){for(const e of this.commands())e.destroy()}},EditingKeystrokeHandler=class extends KeystrokeHandler{editor;constructor(e){super(),this.editor=e}set(e,t,i={}){if(typeof t=="string"){const r=t;t=(o,a)=>{this.editor.execute(r),a()}}super.set(e,t,i)}};const DEFAULT_CATEGORY_ID="contentEditing",DEFAULT_GROUP_ID="common";var Accessibility=class{keystrokeInfos=new Map;_editor;constructor(e){this._editor=e;const t=e.config.get("menuBar.isVisible"),i=e.locale.t;this.addKeystrokeInfoCategory({id:DEFAULT_CATEGORY_ID,label:i("Content editing keystrokes"),description:i("These keyboard shortcuts allow for quick access to content editing features.")});const r=[{label:i("Close contextual balloons, dropdowns, and dialogs"),keystroke:"Esc"},{label:i("Open the accessibility help dialog"),keystroke:"Alt+0"},{label:i("Move focus between form fields (inputs, buttons, etc.)"),keystroke:[["Tab"],["Shift+Tab"]]},{label:i("Move focus to the toolbar, navigate between toolbars"),keystroke:"Alt+F10",mayRequireFn:!0},{label:i("Navigate through the toolbar or menu bar"),keystroke:[["arrowup"],["arrowright"],["arrowdown"],["arrowleft"]]},{label:i("Execute the currently focused button. Executing buttons that interact with the editor content moves the focus back to the content."),keystroke:[["Enter"],["Space"]]}];t&&r.push({label:i("Move focus to the menu bar, navigate between menu bars"),keystroke:"Alt+F9",mayRequireFn:!0}),this.addKeystrokeInfoCategory({id:"navigation",label:i("User interface and content navigation keystrokes"),description:i("Use the following keystrokes for more efficient navigation in the CKEditor 5 user interface."),groups:[{id:"common",keystrokes:r}]})}addKeystrokeInfoCategory({id:e,label:t,description:i,groups:r}){this.keystrokeInfos.set(e,{id:e,label:t,description:i,groups:new Map}),this.addKeystrokeInfoGroup({categoryId:e,id:DEFAULT_GROUP_ID}),r&&r.forEach(o=>{this.addKeystrokeInfoGroup({categoryId:e,...o})})}addKeystrokeInfoGroup({categoryId:e=DEFAULT_CATEGORY_ID,id:t,label:i,keystrokes:r}){const o=this.keystrokeInfos.get(e);if(!o)throw new CKEditorError("accessibility-unknown-keystroke-info-category",this._editor,{groupId:t,categoryId:e});o.groups.set(t,{id:t,label:i,keystrokes:r||[]})}addKeystrokeInfos({categoryId:e=DEFAULT_CATEGORY_ID,groupId:t=DEFAULT_GROUP_ID,keystrokes:i}){if(!this.keystrokeInfos.has(e))throw new CKEditorError("accessibility-unknown-keystroke-info-category",this._editor,{categoryId:e,keystrokes:i});const r=this.keystrokeInfos.get(e);if(!r.groups.has(t))throw new CKEditorError("accessibility-unknown-keystroke-info-group",this._editor,{groupId:t,categoryId:e,keystrokes:i});r.groups.get(t).keystrokes.push(...i)}};function getEditorUsageData(e){return{sessionId:getSessionId(),pageSessionId:getPageSessionID(),hostname:window.location.hostname,version:globalThis.CKEDITOR_VERSION,type:getEditorType(e),plugins:getPluginsUsageData(e.plugins),distribution:getDistributionUsageData(),env:getEnvUsageData(),integration:Object.create(null),menuBar:{isVisible:!!e.config.get("menuBar.isVisible")},language:{ui:e.locale.uiLanguage,content:e.locale.contentLanguage},toolbar:{main:getToolbarUsageData(e.config.get("toolbar")),block:getToolbarUsageData(e.config.get("blockToolbar")),balloon:getToolbarUsageData(e.config.get("balloonToolbar"))}}}function getEditorType(e){return Object.getPrototypeOf(e).constructor.editorName}function getPluginsUsageData(e){return Array.from(e).filter(([t])=>!!t.pluginName).map(([t])=>{const{pluginName:i,isContextPlugin:r,isOfficialPlugin:o,isPremiumPlugin:a}=t;return{isContext:!!r,isOfficial:!!o,isPremium:!!a,name:i}})}function getToolbarUsageData(e){if(!e)return;const t=Array.isArray(e)?{items:e}:e,i=a(t.items||[]);return{isMultiline:i.includes("-"),shouldNotGroupWhenFull:!!t.shouldNotGroupWhenFull,items:o(i)};function o(c){return c.filter(u=>u!=="|"&&u!=="-")}function a(c){return c.flatMap(u=>typeof u=="string"?[u]:a(u.items))}}function getDistributionUsageData(){return{channel:window[Symbol.for("cke distribution")]||"sh"}}function getEnvUsageData(){let e="unknown",t="unknown";return env.isMac?e="mac":env.isWindows?e="windows":env.isiOS?e="ios":env.isAndroid&&(e="android"),env.isGecko?t="gecko":env.isBlink?t="blink":env.isSafari&&(t="safari"),{os:e,browser:t}}function getSessionId(){return localStorage.getItem("__ckeditor-session-id")||localStorage.setItem("__ckeditor-session-id",uid()),localStorage.getItem("__ckeditor-session-id")}function getPageSessionID(){return global$1.window.CKEDITOR_PAGE_SESSION_ID=global$1.window.CKEDITOR_PAGE_SESSION_ID||uid(),global$1.window.CKEDITOR_PAGE_SESSION_ID}var Editor=class extends ObservableMixin(){static get editorName(){return"Editor"}accessibility;commands;config;conversion;data;editing;locale;model;plugins;keystrokes;t;static defaultConfig;static builtinPlugins;_context;_readOnlyLocks;constructor(e={}){if(super(),"sanitizeHtml"in e)throw new CKEditorError("editor-config-sanitizehtml-not-supported");const t=this.constructor,{translations:i,...r}=t.defaultConfig||{},{translations:o=i,...a}=e,c=e.language||r.language;this._context=e.context||new Context({language:c,translations:o}),this._context._addEditor(this,!e.context);const u=Array.from(t.builtinPlugins||[]);this.config=new Config(a,r),this.config.define("plugins",u),this.config.define(this._context._getEditorConfig()),d(this.config),this.plugins=new PluginCollection(this,u,this._context.plugins),this.locale=this._context.locale,this.t=this.locale.t,this._readOnlyLocks=new Set,this.commands=new CommandCollection,this.set("state","initializing"),this.once("ready",()=>this.state="ready",{priority:"high"}),this.once("destroy",()=>this.state="destroyed",{priority:"high"}),this.model=new Model$1,this.on("change:isReadOnly",()=>{this.model.document.isReadOnly=this.isReadOnly});const h=new StylesProcessor;this.data=new DataController(this.model,h),this.editing=new EditingController(this.model,h),this.editing.view.document.bind("isReadOnly").to(this),this.conversion=new Conversion([this.editing.downcastDispatcher,this.data.downcastDispatcher],this.data.upcastDispatcher),this.conversion.addAlias("dataDowncast",this.data.downcastDispatcher),this.conversion.addAlias("editingDowncast",this.editing.downcastDispatcher),this.keystrokes=new EditingKeystrokeHandler(this),this.keystrokes.listenTo(this.editing.view.document),this.accessibility=new Accessibility(this),f(this);function d(m){let g=m.get("licenseKey");if(!g&&window.CKEDITOR_GLOBAL_LICENSE_KEY&&(g=window.CKEDITOR_GLOBAL_LICENSE_KEY,m.set("licenseKey",g)),!g)throw new CKEditorError("license-key-missing")}function f(m){const g=m.config.get("licenseKey"),v=window[Symbol.for("cke distribution")]||"sh";function _(L){m.enableReadOnlyMode(Symbol("invalidLicense")),m._showLicenseError(L)}function b(L){const V=L.split(".");return V.length!=3?null:V[1]}function S(L){return["exp","jti","vc"].every(U=>U in L)}function T(L){return Object.getOwnPropertyNames(L).sort().filter($=>$!="vc"&&L[$]!=null).map($=>L[$])}function A(L){const{hostname:V}=new URL(window.location.href);if(L.includes(V))return!0;const U=V.split(".");return L.filter($=>$.includes("*")).map($=>$.split(".")).filter($=>$.length<=U.length).map($=>Array(U.length-$.length).fill($[0]==="*"?"*":"").concat($)).some($=>U.every((Z,ie)=>$[ie]===Z||$[ie]==="*"))}if(g=="GPL"){v=="cloud"&&_("distributionChannel");return}const I=b(g);if(!I){_("invalid");return}const R=parseBase64EncodedObject(I);if(!R){_("invalid");return}if(!S(R)){_("invalid");return}if(R.distributionChannel&&!toArray$1(R.distributionChannel).includes(v)){_("distributionChannel");return}if(crc32(T(R))!=R.vc.toLowerCase()){_("invalid");return}if(new Date(R.exp*1e3)<releaseDate){_("expired");return}const P=R.licensedHosts;if(P&&P.length>0&&!A(P)){_("domainLimit");return}if(["evaluation","trial"].includes(R.licenseType)&&R.exp*1e3<Date.now()){_("expired");return}if(["evaluation","trial","development"].includes(R.licenseType)){const L=R.licenseType;console.info(`You are using the ${L} version of CKEditor 5 with limited usage. Make sure you will not use it in the production environment.`);const V=setTimeout(()=>{_(`${L}Limit`)},6e5);m.on("destroy",()=>{clearTimeout(V)})}R.usageEndpoint&&m.once("ready",()=>{const L={requestId:uid(),requestTime:Math.round(Date.now()/1e3),license:g,editor:collectUsageData(m)};m._sendUsageRequest(R.usageEndpoint,L).then(V=>{const{status:U,message:$}=V;$&&console.warn($),U!="ok"&&_("usageLimit")},()=>{logError("license-key-validation-endpoint-not-reachable",{url:R.usageEndpoint})})},{priority:"high"})}}get isReadOnly(){return this._readOnlyLocks.size>0}set isReadOnly(e){throw new CKEditorError("editor-isreadonly-has-no-setter")}enableReadOnlyMode(e){if(typeof e!="string"&&typeof e!="symbol")throw new CKEditorError("editor-read-only-lock-id-invalid",null,{lockId:e});this._readOnlyLocks.has(e)||(this._readOnlyLocks.add(e),this._readOnlyLocks.size===1&&this.fire("change:isReadOnly","isReadOnly",!0,!1))}disableReadOnlyMode(e){if(typeof e!="string"&&typeof e!="symbol")throw new CKEditorError("editor-read-only-lock-id-invalid",null,{lockId:e});this._readOnlyLocks.has(e)&&(this._readOnlyLocks.delete(e),this._readOnlyLocks.size===0&&this.fire("change:isReadOnly","isReadOnly",!1,!0))}setData(e){this.data.set(e)}getData(e){return this.data.get(e)}initPlugins(){const e=this.config,t=e.get("plugins"),i=e.get("removePlugins")||[],r=e.get("extraPlugins")||[],o=e.get("substitutePlugins")||[];return this.plugins.init(t.concat(r),i,o)}destroy(){let e=Promise.resolve();return this.state=="initializing"&&(e=new Promise(t=>this.once("ready",t))),e.then(()=>{this.fire("destroy"),this.stopListening(),this.commands.destroy()}).then(()=>this.plugins.destroy()).then(()=>{this.model.destroy(),this.data.destroy(),this.editing.destroy(),this.keystrokes.destroy()}).then(()=>this._context._removeEditor(this))}execute(e,...t){try{return this.commands.execute(e,...t)}catch(i){/* istanbul ignore next -- @preserve */CKEditorError.rethrowUnexpectedError(i,this)}}focus(){this.editing.view.focus()}static create(...e){throw new Error("This is an abstract method.")}static Context=Context;static EditorWatchdog=EditorWatchdog;static ContextWatchdog=ContextWatchdog;_showLicenseError(e,t){setTimeout(()=>{if(e=="invalid")throw new CKEditorError("invalid-license-key");if(e=="expired")throw new CKEditorError("license-key-expired");if(e=="domainLimit")throw new CKEditorError("license-key-domain-limit");if(e=="featureNotAllowed")throw new CKEditorError("license-key-plugin-not-allowed",null,{pluginName:t});if(e=="evaluationLimit")throw new CKEditorError("license-key-evaluation-limit");if(e=="trialLimit")throw new CKEditorError("license-key-trial-limit");if(e=="developmentLimit")throw new CKEditorError("license-key-development-limit");if(e=="usageLimit")throw new CKEditorError("license-key-usage-limit");if(e=="distributionChannel")throw new CKEditorError("license-key-invalid-distribution-channel")},0),this._showLicenseError=()=>{}}async _sendUsageRequest(e,t){const i=new Headers({"Content-Type":"application/json"}),r=await fetch(new URL(e),{method:"POST",headers:i,body:JSON.stringify(t)});if(!r.ok)throw new Error(`HTTP Response: ${r.status}`);return r.json()}};function collectUsageData(e){const t=getEditorUsageData(e);function i(r,o){if(get_default(t,r)!==void 0)throw new CKEditorError("editor-usage-data-path-already-set",{path:r});set_default(t,r,o)}return e.fire("collectUsageData",{setUsageData:i}),t}function attachToForm(e){if(!isFunction_default(e.updateSourceElement))throw new CKEditorError("attachtoform-missing-elementapi-interface",e);const t=e.sourceElement;if(isTextArea(t)&&t.form){let i;const r=t.form,o=()=>e.updateSourceElement();isFunction_default(r.submit)&&(i=r.submit,r.submit=()=>{o(),i.apply(r)}),r.addEventListener("submit",o),e.on("destroy",()=>{r.removeEventListener("submit",o),i&&(r.submit=i)})}}function isTextArea(e){return!!e&&e.tagName.toLowerCase()==="textarea"}function ElementApiMixin(e){class t extends e{sourceElement;updateSourceElement(r){if(!this.sourceElement)throw new CKEditorError("editor-missing-sourceelement",this);const o=this.config.get("updateSourceElementOnDestroy"),a=this.sourceElement instanceof HTMLTextAreaElement;if(!o&&!a){setDataInElement(this.sourceElement,"");return}const c=typeof r=="string"?r:this.data.get();setDataInElement(this.sourceElement,c)}}return t}ElementApiMixin.updateSourceElement=ElementApiMixin(Object).prototype.updateSourceElement;var cancel='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.591 10.177 4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414l-4.243 4.243z"/></svg>',caption='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 16h9a1 1 0 0 1 0 2H2a1 1 0 0 1 0-2z"/><path d="M17 1a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14zm0 1.5H3a.5.5 0 0 0-.492.41L2.5 3v9a.5.5 0 0 0 .41.492L3 12.5h14a.5.5 0 0 0 .492-.41L17.5 12V3a.5.5 0 0 0-.41-.492L17 2.5z" fill-opacity=".6"/></svg>',check='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.972 16.615a.997.997 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a.997.997 0 0 1-.745.292z"/></svg>',cog='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.333 2 .19 2.263a5.899 5.899 0 0 1 1.458.604L14.714 3.4 16.6 5.286l-1.467 1.733c.263.452.468.942.605 1.46L18 8.666v2.666l-2.263.19a5.899 5.899 0 0 1-.604 1.458l1.467 1.733-1.886 1.886-1.733-1.467a5.899 5.899 0 0 1-1.46.605L11.334 18H8.667l-.19-2.263a5.899 5.899 0 0 1-1.458-.604L5.286 16.6 3.4 14.714l1.467-1.733a5.899 5.899 0 0 1-.604-1.458L2 11.333V8.667l2.262-.189a5.899 5.899 0 0 1 .605-1.459L3.4 5.286 5.286 3.4l1.733 1.467a5.899 5.899 0 0 1 1.46-.605L8.666 2h2.666zM10 6.267a3.733 3.733 0 1 0 0 7.466 3.733 3.733 0 0 0 0-7.466z"/></svg>',colorPalette='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.209 18.717A8.5 8.5 0 1 1 18.686 9.6h-.008l.002.12a3 3 0 0 1-2.866 2.997h-.268l-.046-.002v.002h-4.791a2 2 0 1 0 0 4 1 1 0 1 1-.128 1.992 8.665 8.665 0 0 1-.372.008Zm-3.918-7.01a1.25 1.25 0 1 0-2.415-.648 1.25 1.25 0 0 0 2.415.647ZM5.723 8.18a1.25 1.25 0 1 0 .647-2.414 1.25 1.25 0 0 0-.647 2.414ZM9.76 6.155a1.25 1.25 0 1 0 .647-2.415 1.25 1.25 0 0 0-.647 2.415Zm4.028 1.759a1.25 1.25 0 1 0 .647-2.415 1.25 1.25 0 0 0-.647 2.415Z"/></svg>',eraser='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m8.636 9.531-2.758 3.94a.5.5 0 0 0 .122.696l3.224 2.284h1.314l2.636-3.736L8.636 9.53zm.288 8.451L5.14 15.396a2 2 0 0 1-.491-2.786l6.673-9.53a2 2 0 0 1 2.785-.49l3.742 2.62a2 2 0 0 1 .491 2.785l-7.269 10.053-2.147-.066z"/><path d="M4 18h5.523v-1H4zm-2 0h1v-1H2z"/></svg>',history='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11 1a9 9 0 1 1-8.027 13.075l1.128-1.129A7.502 7.502 0 0 0 18.5 10a7.5 7.5 0 1 0-14.962.759l-.745-.746-.76.76A9 9 0 0 1 11 1z"/><path d="M.475 8.17a.75.75 0 0 1 .978.047l.075.082 1.284 1.643 1.681-1.284a.75.75 0 0 1 .978.057l.073.083a.75.75 0 0 1-.057.978l-.083.073-2.27 1.737a.75.75 0 0 1-.973-.052l-.074-.082-1.741-2.23a.75.75 0 0 1 .13-1.052z"/><path d="M11.5 5v4.999l3.196 3.196-1.06 1.06L10.1 10.72l-.1-.113V5z"/></svg>',lowVision='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.085 6.22 2.943 4.078a.75.75 0 1 1 1.06-1.06l2.592 2.59A11.094 11.094 0 0 1 10 5.068c4.738 0 8.578 3.101 8.578 5.083 0 1.197-1.401 2.803-3.555 3.887l1.714 1.713a.75.75 0 0 1-.09 1.138.488.488 0 0 1-.15.084.75.75 0 0 1-.821-.16L6.17 7.304c-.258.11-.51.233-.757.365l6.239 6.24-.006.005.78.78c-.388.094-.78.166-1.174.215l-1.11-1.11h.011L4.55 8.197a7.2 7.2 0 0 0-.665.514l-.112.098 4.897 4.897-.005.006 1.276 1.276a10.164 10.164 0 0 1-1.477-.117l-.479-.479-.009.009-4.863-4.863-.022.031a2.563 2.563 0 0 0-.124.2c-.043.077-.08.158-.108.241a.534.534 0 0 0-.028.133.29.29 0 0 0 .008.072.927.927 0 0 0 .082.226c.067.133.145.26.234.379l3.242 3.365.025.01.59.623c-3.265-.918-5.59-3.155-5.59-4.668 0-1.194 1.448-2.838 3.663-3.93zm7.07.531a4.632 4.632 0 0 1 1.108 5.992l.345.344.046-.018a9.313 9.313 0 0 0 2-1.112c.256-.187.5-.392.727-.613.137-.134.27-.277.392-.431.072-.091.141-.185.203-.286.057-.093.107-.19.148-.292a.72.72 0 0 0 .036-.12.29.29 0 0 0 .008-.072.492.492 0 0 0-.028-.133.999.999 0 0 0-.036-.096 2.165 2.165 0 0 0-.071-.145 2.917 2.917 0 0 0-.125-.2 3.592 3.592 0 0 0-.263-.335 5.444 5.444 0 0 0-.53-.523 7.955 7.955 0 0 0-1.054-.768 9.766 9.766 0 0 0-1.879-.891c-.337-.118-.68-.219-1.027-.301zm-2.85.21-.069.002a.508.508 0 0 0-.254.097.496.496 0 0 0-.104.679.498.498 0 0 0 .326.199l.045.005c.091.003.181.003.272.012a2.45 2.45 0 0 1 2.017 1.513c.024.061.043.125.069.185a.494.494 0 0 0 .45.287h.008a.496.496 0 0 0 .35-.158.482.482 0 0 0 .13-.335.638.638 0 0 0-.048-.219 3.379 3.379 0 0 0-.36-.723 3.438 3.438 0 0 0-2.791-1.543l-.028-.001h-.013z"/></svg>',textAlternative='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.035 1C2.446 1 2 1.54 2 2.098V10.5h1.5v-8h13v8H18V2.098C18 1.539 17.48 1 16.9 1H3.035Zm10.453 2.61a1.885 1.885 0 0 0-1.442.736 1.89 1.89 0 0 0 1.011 2.976 1.903 1.903 0 0 0 2.253-1.114 1.887 1.887 0 0 0-1.822-2.598ZM7.463 8.163a.611.611 0 0 0-.432.154L5.071 10.5h5.119L7.88 8.348a.628.628 0 0 0-.417-.185Zm6.236 1.059a.62.62 0 0 0-.42.164L12.07 10.5h2.969l-.92-1.113a.618.618 0 0 0-.42-.165ZM.91 11.5a.91.91 0 0 0-.91.912v6.877c0 .505.405.91.91.91h18.178a.91.91 0 0 0 .912-.91v-6.877a.908.908 0 0 0-.912-.912H.91ZM3.668 13h1.947l2.135 5.7H5.898l-.28-.946H3.601l-.278.945H1.516L3.668 13Zm4.947 0h1.801v4.3h2.7v1.4h-4.5V13h-.001Zm4.5 0h5.4v1.4h-1.798v4.3h-1.701v-4.3h-1.9V13h-.001Zm-8.517 1.457-.614 2.059h1.262l-.648-2.059Z"/></svg>',loupe='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.68 13.74h-.001l4.209 4.208a1 1 0 1 0 1.414-1.414l-4.267-4.268a6 6 0 1 0-1.355 1.474ZM13 9a4 4 0 1 1-8 0 4 4 0 0 1 8 0Z"/></svg>',previousArrow='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.463 5.187a.888.888 0 1 1 1.254 1.255L9.16 10l3.557 3.557a.888.888 0 1 1-1.254 1.255L7.26 10.61a.888.888 0 0 1 .16-1.382l4.043-4.042z"/></svg>',nextArrow='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.537 14.813a.888.888 0 1 1-1.254-1.255L10.84 10 7.283 6.442a.888.888 0 1 1 1.254-1.255L12.74 9.39a.888.888 0 0 1-.16 1.382l-4.043 4.042z"/></svg>',image='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.66 9.118a.693.693 0 0 1 .956.032l3.65 3.411 2.422-2.238a.695.695 0 0 1 .945 0L17.5 13.6V2.5h-15v11.1l4.16-4.482ZM17.8 1c.652 0 1.2.47 1.2 1.1v14.362c0 .64-.532 1.038-1.184 1.038H2.184C1.532 17.5 1 17.103 1 16.462V2.1C1 1.47 1.537 1 2.2 1h15.6Zm-5.655 6a2.128 2.128 0 0 1 .157-2.364A2.133 2.133 0 1 1 12.145 7Z"/></svg>',imageUpload='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.201 1C.538 1 0 1.47 0 2.1v14.363c0 .64.534 1.037 1.186 1.037h9.494a2.97 2.97 0 0 1-.414-.287 2.998 2.998 0 0 1-1.055-2.03 3.003 3.003 0 0 1 .693-2.185l.383-.455-.02.018-3.65-3.41a.695.695 0 0 0-.957-.034L1.5 13.6V2.5h15v5.535a2.97 2.97 0 0 1 1.412.932l.088.105V2.1c0-.63-.547-1.1-1.2-1.1H1.202Zm11.713 2.803a2.146 2.146 0 0 0-2.049 1.992 2.14 2.14 0 0 0 1.28 2.096 2.13 2.13 0 0 0 2.644-3.11 2.134 2.134 0 0 0-1.875-.978Z"/><path d="M15.522 19.1a.79.79 0 0 0 .79-.79v-5.373l2.059 2.455a.79.79 0 1 0 1.211-1.015l-3.352-3.995a.79.79 0 0 0-.995-.179.784.784 0 0 0-.299.221l-3.35 3.99a.79.79 0 1 0 1.21 1.017l1.936-2.306v5.185c0 .436.353.79.79.79Z"/><path d="M15.522 19.1a.79.79 0 0 0 .79-.79v-5.373l2.059 2.455a.79.79 0 1 0 1.211-1.015l-3.352-3.995a.79.79 0 0 0-.995-.179.784.784 0 0 0-.299.221l-3.35 3.99a.79.79 0 1 0 1.21 1.017l1.936-2.306v5.185c0 .436.353.79.79.79Z"/></svg>',imageAssetManager='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.201 1c-.662 0-1.2.47-1.2 1.1v14.248c0 .64.533 1.152 1.185 1.152h6.623v-7.236L6.617 9.15a.694.694 0 0 0-.957-.033L1.602 13.55V2.553l14.798.003V9.7H18V2.1c0-.63-.547-1.1-1.2-1.1H1.202Zm11.723 2.805a2.094 2.094 0 0 0-1.621.832 2.127 2.127 0 0 0 1.136 3.357 2.13 2.13 0 0 0 2.611-1.506 2.133 2.133 0 0 0-.76-2.244 2.13 2.13 0 0 0-1.366-.44Z"/><path clip-rule="evenodd" d="M19.898 12.369v6.187a.844.844 0 0 1-.844.844h-8.719a.844.844 0 0 1-.843-.844v-7.312a.844.844 0 0 1 .843-.844h2.531a.843.843 0 0 1 .597.248l.838.852h4.75c.223 0 .441.114.6.272a.844.844 0 0 1 .247.597Zm-1.52.654-4.377.02-1.1-1.143H11v6h7.4l-.023-4.877Z"/></svg>',imageUrl='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.201 1C.538 1 0 1.47 0 2.1v14.363c0 .64.534 1.037 1.186 1.037h7.029a5.401 5.401 0 0 1 .615-4.338l.762-1.232-2.975-2.78a.696.696 0 0 0-.957-.033L1.5 13.6V2.5h15v6.023c.449.131.887.32 1.307.573l.058.033c.046.028.09.057.135.086V2.1c0-.63-.547-1.1-1.2-1.1H1.202Zm11.713 2.803a2.15 2.15 0 0 0-1.611.834 2.118 2.118 0 0 0-.438 1.158 2.14 2.14 0 0 0 1.277 2.096 2.132 2.132 0 0 0 2.645-3.11 2.13 2.13 0 0 0-1.873-.978Z"/><path d="M16.63 10.294a3.003 3.003 0 0 0-4.142.887l-.117.177a.647.647 0 0 0-.096.492.664.664 0 0 0 .278.418.7.7 0 0 0 .944-.234 1.741 1.741 0 0 1 2.478-.463 1.869 1.869 0 0 1 .476 2.55.637.637 0 0 0-.071.5.646.646 0 0 0 .309.396.627.627 0 0 0 .869-.19l.027-.041a3.226 3.226 0 0 0-.956-4.492Zm-6.061 3.78-.044.066a3.228 3.228 0 0 0 .82 4.403 3.005 3.005 0 0 0 4.275-.798l.13-.197a.626.626 0 0 0 .092-.475.638.638 0 0 0-.268-.402.713.713 0 0 0-.99.26l-.018.029a1.741 1.741 0 0 1-2.477.461 1.87 1.87 0 0 1-.475-2.55l.029-.047a.647.647 0 0 0 .086-.485.66.66 0 0 0-.275-.408l-.04-.027a.609.609 0 0 0-.845.17Z"/><path d="M15.312 13.925c.24-.36.154-.838-.19-1.067-.346-.23-.82-.124-1.059.236l-1.268 1.907c-.239.36-.153.838.192 1.067.345.23.818.123 1.057-.236l1.268-1.907Z"/></svg>',alignBottom='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.239 13.938-2.88-1.663a.75.75 0 0 1 .75-1.3L9 12.067V4.75a.75.75 0 1 1 1.5 0v7.318l1.89-1.093a.75.75 0 0 1 .75 1.3l-2.879 1.663a.752.752 0 0 1-.511.187.752.752 0 0 1-.511-.187zM4.25 17a.75.75 0 1 1 0-1.5h10.5a.75.75 0 0 1 0 1.5H4.25z"/></svg>',alignMiddle='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.75 11.875a.752.752 0 0 1 .508.184l2.883 1.666a.75.75 0 0 1-.659 1.344l-.091-.044-1.892-1.093.001 4.318a.75.75 0 1 1-1.5 0v-4.317l-1.89 1.092a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .51-.187zM15.25 9a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM9.75.375a.75.75 0 0 1 .75.75v4.318l1.89-1.093.092-.045a.75.75 0 0 1 .659 1.344l-2.883 1.667a.752.752 0 0 1-.508.184.752.752 0 0 1-.511-.187L6.359 5.65a.75.75 0 0 1 .75-1.299L9 5.442V1.125a.75.75 0 0 1 .75-.75z"/></svg>',alignTop='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m10.261 7.062 2.88 1.663a.75.75 0 0 1-.75 1.3L10.5 8.933v7.317a.75.75 0 1 1-1.5 0V8.932l-1.89 1.093a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .511-.187.752.752 0 0 1 .511.187zM15.25 4a.75.75 0 1 1 0 1.5H4.75a.75.75 0 0 1 0-1.5h10.5z"/></svg>',alignLeft='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',alignCenter='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm2.286 4c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75z"/></svg>',alignRight='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M18 3.75a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 8a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 4a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75zm0-8a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75z"/></svg>',alignJustify='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',objectBlockLeft='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',objectCenter='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M15.003 7v5.5a1 1 0 0 1-1 1H5.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H6.5V12h6.997V7.5z"/></svg>',objectBlockRight='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',objectFullWidth='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18 7v5.5a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1zm-1.505.5H3.504V12h12.991V7.5z"/></svg>',objectInline='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',objectLeft='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zm0-3H18v1.5h-4.5zm0-3H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',objectRight='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2zm0-9h5v1.5H2zm0 3h5v1.5H2zm0 3h5v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',objectSizeFull='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M18.095 2H1.905C.853 2 0 2.895 0 4v12c0 1.105.853 2 1.905 2h16.19C19.147 18 20 17.105 20 16V4c0-1.105-.853-2-1.905-2zm0 1.5c.263 0 .476.224.476.5v12c0 .276-.213.5-.476.5H1.905a.489.489 0 0 1-.476-.5V4c0-.276.213-.5.476-.5h16.19z"/></svg>',objectSizeCustom='<svg xmlns="http://www.w3.org/2000/svg" xmlns:v="https://vecta.io/nano" viewBox="0 0 20 20"><path d="M.95 1.43a.95.95 0 0 0-.95.95v3.1a.95.95 0 0 0 .95.95h.75v6.3H.95a.95.95 0 0 0-.95.95v3.1a.95.95 0 0 0 .95.95h3.1a.95.95 0 0 0 .95-.95v-.65h1.932l1.539-1.5H5v-.95a.95.95 0 0 0-.95-.95H3.2v-6.3h.85A.95.95 0 0 0 5 5.48v-.55h10v.55a.95.95 0 0 0 .95.95h3.1a.95.95 0 0 0 .95-.95v-3.1a.95.95 0 0 0-.95-.95h-3.1a.95.95 0 0 0-.95.95v1.05H5V2.38a.95.95 0 0 0-.95-.95H.95zm.55 3.5v-2h2v2h-2zm0 9.3v2h2v-2h-2zm15-11.3v2h2v-2h-2z"/><path d="M8.139 20.004v-2.388l7.045-7.048 2.391 2.391-7.046 7.046h-2.39zm11.421-9.101a.64.64 0 0 1-.138.206l-1.165 1.168-2.391-2.391 1.167-1.163a.63.63 0 0 1 .206-.138.635.635 0 0 1 .243-.049.63.63 0 0 1 .449.187l1.491 1.488c.059.059.108.129.138.206s.049.16.049.243a.6.6 0 0 1-.049.243z"/></svg>',objectSizeLarge='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 16.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1ZM1 15v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 13v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 11v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 9v1H0V9h1Zm19 0v1h-1V9h1ZM1 7v1H0V7h1Zm19 0v1h-1V7h1ZM1 5v1H0V5h1Zm19 0v1h-1V5h1Zm0-2v1h-1V3h1ZM1 3v1H0V3h1Zm13.5-1.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm-8 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm8 0v1h-1v-1h1Zm-10 0v1h-1v-1h1Z"/><path d="M13 5.5H2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2v-8a2 2 0 0 0-2-2ZM13 7a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-8A.5.5 0 0 1 2 7h11Z"/></svg>',objectSizeSmall='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 16.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1ZM1 15v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 13v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 11v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 9v1H0V9h1Zm19 0v1h-1V9h1ZM1 7v1H0V7h1Zm19 0v1h-1V7h1ZM1 5v1H0V5h1Zm19 0v1h-1V5h1Zm0-2v1h-1V3h1ZM1 3v1H0V3h1Zm13.5-1.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm-8 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm8 0v1h-1v-1h1Zm-10 0v1h-1v-1h1Z"/><path d="M7 9.5H2a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h5a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2ZM7 11a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-4A.5.5 0 0 1 2 11h5Z"/></svg>',objectSizeMedium='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 16.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1ZM1 15v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 13v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 11v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 9v1H0V9h1Zm19 0v1h-1V9h1ZM1 7v1H0V7h1Zm19 0v1h-1V7h1ZM1 5v1H0V5h1Zm19 0v1h-1V5h1Zm0-2v1h-1V3h1ZM1 3v1H0V3h1Zm13.5-1.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm-8 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm8 0v1h-1v-1h1Zm-10 0v1h-1v-1h1Z"/><path d="M10 7.5H2a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-6a2 2 0 0 0-2-2ZM10 9a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-6A.5.5 0 0 1 2 9h8Z"/></svg>',pencil='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m7.3 17.37-.061.088a1.518 1.518 0 0 1-.934.535l-4.178.663-.806-4.153a1.495 1.495 0 0 1 .187-1.058l.056-.086L8.77 2.639c.958-1.351 2.803-1.076 4.296-.03 1.497 1.047 2.387 2.693 1.433 4.055L7.3 17.37zM9.14 4.728l-5.545 8.346 3.277 2.294 5.544-8.346L9.14 4.728zM6.07 16.512l-3.276-2.295.53 2.73 2.746-.435zM9.994 3.506 13.271 5.8c.316-.452-.16-1.333-1.065-1.966-.905-.634-1.895-.78-2.212-.328zM8 18.5 9.375 17H19v1.5H8z"/></svg>',pilcrow='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.999 2H15a1 1 0 0 1 0 2h-1.004v13a1 1 0 1 1-2 0V4H8.999v13a1 1 0 1 1-2 0v-7A4 4 0 0 1 3 6a4 4 0 0 1 3.999-4z"/></svg>',quote='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 10.423a6.5 6.5 0 0 1 6.056-6.408l.038.67C6.448 5.423 5.354 7.663 5.22 10H9c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574zm8 0a6.5 6.5 0 0 1 6.056-6.408l.038.67c-2.646.739-3.74 2.979-3.873 5.315H17c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574z"/></svg>',threeVerticalDots='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="9.5" cy="4.5" r="1.5"/><circle cx="9.5" cy="10.5" r="1.5"/><circle cx="9.5" cy="16.5" r="1.5"/></svg>',dragIndicator='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5 3.25a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M12 3.25a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M5 10a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M12 10a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M5 16.75a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M12 16.75a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/></svg>',bold='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.187 17H5.773c-.637 0-1.092-.138-1.364-.415-.273-.277-.409-.718-.409-1.323V4.738c0-.617.14-1.062.419-1.332.279-.27.73-.406 1.354-.406h4.68c.69 0 1.288.041 1.793.124.506.083.96.242 1.36.478.341.197.644.447.906.75a3.262 3.262 0 0 1 .808 2.162c0 1.401-.722 2.426-2.167 3.075C15.05 10.175 16 11.315 16 13.01a3.756 3.756 0 0 1-2.296 3.504 6.1 6.1 0 0 1-1.517.377c-.571.073-1.238.11-2 .11zm-.217-6.217H7v4.087h3.069c1.977 0 2.965-.69 2.965-2.072 0-.707-.256-1.22-.768-1.537-.512-.319-1.277-.478-2.296-.478zM7 5.13v3.619h2.606c.729 0 1.292-.067 1.69-.2a1.6 1.6 0 0 0 .91-.765c.165-.267.247-.566.247-.897 0-.707-.26-1.176-.778-1.409-.519-.232-1.31-.348-2.375-.348H7z"/></svg>',paragraph='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.5 5.5H7v5h3.5a2.5 2.5 0 1 0 0-5zM5 3h6.5v.025a5 5 0 0 1 0 9.95V13H7v4a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1z"/></svg>',plus='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 0 0-1 1v6H3a1 1 0 1 0 0 2h6v6a1 1 0 1 0 2 0v-6h6a1 1 0 1 0 0-2h-6V3a1 1 0 0 0-1-1Z"/></svg>',text='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.816 11.5 7.038 4.785 4.261 11.5h5.555Zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663L10.436 13Z"/><path d="m12.09 17-.534-1.292.848-1.971.545 1.319L12.113 17h-.023Zm1.142-5.187.545 1.319L15.5 9.13l1.858 4.316h-3.45l.398.965h3.467L18.887 17H20l-3.873-9h-1.254l-1.641 3.813Z"/></svg>',importExport='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M19 4.5 14 0H3v12.673l.868-1.041c.185-.222.4-.402.632-.54V1.5h8v5h5v7.626a2.24 2.24 0 0 1 1.5.822V4.5ZM14 5V2l3.3 3H14Zm-3.692 12.5c.062.105.133.206.213.303L11.52 19H8v-.876a2.243 2.243 0 0 0 1.82-.624h.488Zm7.518-.657a.75.75 0 0 0-1.152-.96L15.5 17.29V12H14v5.29l-1.174-1.408a.75.75 0 0 0-1.152.96l2.346 2.816a.95.95 0 0 0 1.46 0l2.346-2.815Zm-15.056-.38a.75.75 0 0 1-.096-1.056l2.346-2.815a.95.95 0 0 1 1.46 0l2.346 2.815a.75.75 0 1 1-1.152.96L6.5 14.96V20H5v-5.04l-1.174 1.408a.75.75 0 0 1-1.056.096Z"/></svg>',redo='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m14.958 9.367-2.189 1.837a.75.75 0 0 0 .965 1.149l3.788-3.18a.747.747 0 0 0 .21-.284.75.75 0 0 0-.17-.945L13.77 4.762a.75.75 0 1 0-.964 1.15l2.331 1.955H6.22A.75.75 0 0 0 6 7.9a4 4 0 1 0 1.477 7.718l-.344-1.489A2.5 2.5 0 1 1 6.039 9.4l-.008-.032h8.927z"/></svg>',undo='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m5.042 9.367 2.189 1.837a.75.75 0 0 1-.965 1.149l-3.788-3.18a.747.747 0 0 1-.21-.284.75.75 0 0 1 .17-.945L6.23 4.762a.75.75 0 1 1 .964 1.15L4.863 7.866h8.917A.75.75 0 0 1 14 7.9a4 4 0 1 1-1.477 7.718l.344-1.489a2.5 2.5 0 1 0 1.094-4.73l.008-.032H5.042z"/></svg>',bulletedList='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0C1 4.784 1.777 4 2.75 4c.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75C1.784 7.5 1 6.723 1 5.75zm6 9c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0c0-.966.777-1.75 1.75-1.75.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75-.966 0-1.75-.777-1.75-1.75z"/></svg>',numberedList='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM3.5 3v5H2V3.7H1v-1h2.5V3zM.343 17.857l2.59-3.257H2.92a.6.6 0 1 0-1.04 0H.302a2 2 0 1 1 3.995 0h-.001c-.048.405-.16.734-.333.988-.175.254-.59.692-1.244 1.312H4.3v1h-4l.043-.043zM7 14.75a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>',todoList='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m2.315 14.705 2.224-2.24a.689.689 0 0 1 .963 0 .664.664 0 0 1 0 .949L2.865 16.07a.682.682 0 0 1-.112.089.647.647 0 0 1-.852-.051L.688 14.886a.635.635 0 0 1 0-.903.647.647 0 0 1 .91 0l.717.722zm5.185.045a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75zM2.329 5.745l2.21-2.226a.689.689 0 0 1 .963 0 .664.664 0 0 1 0 .95L2.865 7.125a.685.685 0 0 1-.496.196.644.644 0 0 1-.468-.187L.688 5.912a.635.635 0 0 1 0-.903.647.647 0 0 1 .91 0l.73.736zM7.5 5.75A.75.75 0 0 1 8.25 5h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>',codeBlock='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.87 12.61a.75.75 0 0 1-.089.976l-.085.07-3.154 2.254 3.412 2.414a.75.75 0 0 1 .237.95l-.057.095a.75.75 0 0 1-.95.237l-.096-.058-4.272-3.022-.003-1.223 4.01-2.867a.75.75 0 0 1 1.047.174zm2.795-.231.095.057 4.011 2.867-.003 1.223-4.272 3.022-.095.058a.75.75 0 0 1-.88-.151l-.07-.086-.058-.095a.75.75 0 0 1 .15-.88l.087-.07 3.412-2.414-3.154-2.253-.085-.071a.75.75 0 0 1 .862-1.207zM16 0a2 2 0 0 1 2 2v9.354l-.663-.492-.837-.001V2a.5.5 0 0 0-.5-.5H2a.5.5 0 0 0-.5.5v15a.5.5 0 0 0 .5.5h3.118L7.156 19H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h14zM5.009 15l.003 1H3v-1h2.009zm2.188-2-1.471 1H5v-1h2.197zM10 11v.095L8.668 12H7v-1h3zm4-2v1H7V9h7zm0-2v1H7V7h7zm-4-2v1H5V5h5zM6 3v1H3V3h3z"/></svg>',browseFiles='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.627 16.5zm5.873-.196zm0-7.001V8h-13v8.5h4.341c.191.54.457 1.044.785 1.5H2a1.5 1.5 0 0 1-1.5-1.5v-13A1.5 1.5 0 0 1 2 2h4.5a1.5 1.5 0 0 1 1.06.44L9.122 4H16a1.5 1.5 0 0 1 1.5 1.5v1A1.5 1.5 0 0 1 19 8v2.531a6.027 6.027 0 0 0-1.5-1.228zM16 6.5v-1H8.5l-2-2H2v13h1V8a1.5 1.5 0 0 1 1.5-1.5H16z"/><path d="M14.5 19.5a5 5 0 1 1 0-10 5 5 0 0 1 0 10zM15 14v-2h-1v2h-2v1h2v2h1v-2h2v-1h-2z"/></svg>',heading1='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M19 9v10h-2v-8h-2V9h4zM4 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1H10a1 1 0 0 1-1-1V11H4v4.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1H3a1 1 0 0 1 1 1v4.5z"/></svg>',heading2='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1V11H3v4.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1H2a1 1 0 0 1 1 1v4.5zm16.076 8.343V18.5h-6.252c.067-.626.27-1.22.61-1.78.338-.561 1.006-1.305 2.005-2.232.804-.749 1.297-1.257 1.479-1.523.245-.368.368-.732.368-1.092 0-.398-.107-.703-.32-.917-.214-.214-.51-.32-.886-.32-.372 0-.669.111-.889.336-.22.224-.347.596-.38 1.117l-1.778-.178c.106-.982.438-1.686.997-2.114.558-.427 1.257-.64 2.095-.64.918 0 1.64.247 2.164.742.525.495.787 1.11.787 1.847 0 .419-.075.818-.225 1.197-.15.378-.388.775-.714 1.19-.216.275-.605.67-1.168 1.187-.563.516-.92.859-1.07 1.028a3.11 3.11 0 0 0-.365.495h3.542z"/></svg>',heading3='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1V11H3v4.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1H2a1 1 0 0 1 1 1v4.5zm9.989 7.53 1.726-.209c.055.44.203.777.445 1.01.24.232.533.349.876.349.368 0 .678-.14.93-.42.251-.279.377-.655.377-1.13 0-.448-.12-.803-.362-1.066a1.153 1.153 0 0 0-.882-.393c-.228 0-.501.044-.819.133l.197-1.453c.482.012.85-.092 1.105-.315.253-.222.38-.517.38-.885 0-.313-.093-.563-.279-.75-.186-.185-.434-.278-.743-.278a1.07 1.07 0 0 0-.78.317c-.216.212-.347.52-.394.927l-1.644-.28c.114-.562.287-1.012.517-1.348.231-.337.553-.601.965-.794a3.24 3.24 0 0 1 1.387-.289c.876 0 1.579.28 2.108.838.436.457.653.973.653 1.549 0 .817-.446 1.468-1.339 1.955.533.114.96.37 1.28.768.319.398.478.878.478 1.441 0 .817-.298 1.513-.895 2.088-.596.576-1.339.864-2.228.864-.842 0-1.54-.243-2.094-.727-.555-.485-.876-1.118-.965-1.901z"/></svg>',heading4='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V11h-5v4.5a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v4.5zm13.55 10v-1.873h-3.81v-1.561l4.037-5.91h1.498v5.904h1.156v1.567h-1.156V18.5H17.05zm0-3.44v-3.18l-2.14 3.18h2.14z"/></svg>',heading5='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V11h-5v4.5a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v4.5zm9.578 7.607 1.777-.184c.05.402.201.72.45.955a1.223 1.223 0 0 0 1.81-.101c.258-.303.387-.759.387-1.368 0-.572-.128-1-.384-1.286-.256-.285-.59-.428-1-.428-.512 0-.971.226-1.377.679l-1.448-.21.915-4.843h4.716v1.67H15.56l-.28 1.58a2.697 2.697 0 0 1 1.219-.298 2.68 2.68 0 0 1 2.012.863c.55.576.825 1.323.825 2.241a3.36 3.36 0 0 1-.666 2.05c-.605.821-1.445 1.232-2.52 1.232-.86 0-1.56-.23-2.101-.692-.542-.461-.866-1.081-.971-1.86z"/></svg>',heading6='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V11h-5v4.5a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v4.5zm15.595 2.973-1.726.19c-.043-.355-.153-.617-.33-.787-.178-.169-.409-.253-.692-.253-.377 0-.695.169-.956.507-.26.339-.424 1.043-.492 2.114.445-.525.997-.787 1.657-.787.745 0 1.383.284 1.914.85.531.568.797 1.3.797 2.197 0 .952-.28 1.716-.838 2.291-.559.576-1.276.864-2.152.864-.94 0-1.712-.365-2.317-1.095-.605-.73-.908-1.927-.908-3.59 0-1.705.316-2.935.946-3.688.63-.753 1.45-1.13 2.457-1.13.706 0 1.291.198 1.755.594.463.395.758.97.885 1.723zm-4.043 3.891c0 .58.133 1.028.4 1.343.266.315.57.473.914.473.33 0 .605-.13.825-.388.22-.258.33-.68.33-1.27 0-.604-.118-1.047-.355-1.329a1.115 1.115 0 0 0-.89-.422c-.342 0-.632.134-.869.403s-.355.666-.355 1.19z"/></svg>',horizontalLine='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 9h16v2H2z"/></svg>',html='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17 0a2 2 0 0 1 2 2v7a1 1 0 0 1 1 1v5a1 1 0 0 1-.883.993l-.118.006L19 17a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2l-.001-1.001-.116-.006A1 1 0 0 1 0 15v-5a1 1 0 0 1 .999-1L1 2a2 2 0 0 1 2-2h14zm.499 15.999h-15L2.5 17a.5.5 0 0 0 .5.5h14a.5.5 0 0 0 .5-.5l-.001-1.001zm-3.478-6.013-.014.014H14v.007l-1.525 1.525-1.46-1.46-.015.013V10h-1v5h1v-3.53l1.428 1.43.048.043.131-.129L14 11.421V15h1v-5h-.965l-.014-.014zM2 10H1v5h1v-2h2v2h1v-5H4v2H2v-2zm7 0H6v1h1v4h1v-4h1v-1zm8 0h-1v5h3v-1h-2v-4zm0-8.5H3a.5.5 0 0 0-.5.5l-.001 6.999h15L17.5 2a.5.5 0 0 0-.5-.5zM10 7v1H4V7h6zm3-2v1H4V5h9zm-3-2v1H4V3h6z"/></svg>',indent='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zM1.632 6.95 5.02 9.358a.4.4 0 0 1-.013.661l-3.39 2.207A.4.4 0 0 1 1 11.892V7.275a.4.4 0 0 1 .632-.326z"/></svg>',outdent='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zm1.618-9.55L.98 9.358a.4.4 0 0 0 .013.661l3.39 2.207A.4.4 0 0 0 5 11.892V7.275a.4.4 0 0 0-.632-.326z"/></svg>',table='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 5.5v3h4v-3H3Zm0 4v3h4v-3H3Zm0 4v3h4v-3H3Zm5 3h4v-3H8v3Zm5 0h4v-3h-4v3Zm4-4v-3h-4v3h4Zm0-4v-3h-4v3h4Zm1.5 8A1.5 1.5 0 0 1 17 18H3a1.5 1.5 0 0 1-1.5-1.5V3c.222-.863 1.068-1.5 2-1.5h13c.932 0 1.778.637 2 1.5v13.5Zm-6.5-4v-3H8v3h4Zm0-4v-3H8v3h4Z"/></svg>',remove$1='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.2 7h9.2c.6 0 1 .4 1 1v9.9c0 .5-.4 1-1 1H5.2a1 1 0 0 1-1-1V8c0-.6.4-1 1-1Zm1 1.5c-.3 0-.5.2-.5.5v8c0 .3.2.5.5.5h.5c.2 0 .5-.2.5-.5V9c0-.3-.3-.5-.5-.5h-.5Zm3.2 0c-.2 0-.5.2-.5.5v8c0 .3.3.5.5.5h.5c.3 0 .5-.2.5-.5V9c0-.3-.2-.5-.5-.5h-.5Zm3.5 0c-.2 0-.5.2-.5.5v8c0 .3.3.5.5.5h.5c.3 0 .5-.2.5-.5V9c0-.3-.2-.5-.5-.5h-.5Zm-1.4-7.1H8.3L6.5 3.6H3.8c-.5 0-.7.3-.7.8s.2.7.7.7h12c.6 0 .9-.2.9-.7 0-.5-.3-.8-1-.8h-2.4l-1.8-2.2Z"/></svg>',bookmark='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M5.68 3.417a.238.238 0 0 0-.24.236v12.66l3.793-3.102a1.215 1.215 0 0 1 1.534 0l3.793 3.103V3.654a.238.238 0 0 0-.24-.237H5.68ZM4 3.653C4 2.74 4.752 2 5.68 2h8.64c.928 0 1.68.74 1.68 1.653v13.164c0 1-1.185 1.547-1.967.908L10 14.426l-4.033 3.299c-.782.64-1.967.092-1.967-.908V3.653Z"/></svg>',bookmarkInline='<svg viewBox="0 0 14 16" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M2 14.436V2a1 1 0 0 1 1-1h8a1 1 0 0 1 1 1v12.436a.5.5 0 0 1-.819.385l-3.862-3.2a.5.5 0 0 0-.638 0l-3.862 3.2A.5.5 0 0 1 2 14.436Z"/></svg>';const icons={bold,cancel,caption,check,cog,colorPalette,eraser,history,image,imageUpload,imageAssetManager,imageUrl,lowVision,textAlternative,loupe,previousArrow,nextArrow,importExport,paragraph,plus,text,alignBottom,alignMiddle,alignTop,alignLeft,alignCenter,alignRight,alignJustify,objectLeft,objectCenter,objectRight,objectFullWidth,objectInline,objectBlockLeft,objectBlockRight,objectSizeCustom,objectSizeFull,objectSizeLarge,objectSizeSmall,objectSizeMedium,pencil,pilcrow,quote,threeVerticalDots,dragIndicator,redo,undo,bulletedList,numberedList,todoList,codeBlock,browseFiles,heading1,heading2,heading3,heading4,heading5,heading6,horizontalLine,html,indent,outdent,table,remove:remove$1,bookmark,bookmarkInline};var require_color_name=__commonJS({"node_modules/.pnpm/color-name@1.1.4/node_modules/color-name/index.js"(e,t){t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}}}),import_color_name=__toESM(require_color_name(),1),color_parse_default=parse,baseHues={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function parse(e){var t,i=[],r=1,o;if(typeof e=="string")if(import_color_name.default[e])i=import_color_name.default[e].slice(),o="rgb";else if(e==="transparent")r=0,o="rgb",i=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(e)){var a=e.slice(1),c=a.length,u=c<=4;r=1,u?(i=[parseInt(a[0]+a[0],16),parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16)],c===4&&(r=parseInt(a[3]+a[3],16)/255)):(i=[parseInt(a[0]+a[1],16),parseInt(a[2]+a[3],16),parseInt(a[4]+a[5],16)],c===8&&(r=parseInt(a[6]+a[7],16)/255)),i[0]||(i[0]=0),i[1]||(i[1]=0),i[2]||(i[2]=0),o="rgb"}else if(t=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(e)){var h=t[1],d=h==="rgb",a=h.replace(/a$/,"");o=a;var c=a==="cmyk"?4:a==="gray"?1:3;i=t[2].trim().split(/\s*[,\/]\s*|\s+/).map(function(g,v){if(/%$/.test(g))return v===c?parseFloat(g)/100:a==="rgb"?parseFloat(g)*255/100:parseFloat(g);if(a[v]==="h"){if(/deg$/.test(g))return parseFloat(g);if(baseHues[g]!==void 0)return baseHues[g]}return parseFloat(g)}),h===a&&i.push(1),r=d||i[c]===void 0?1:i[c],i=i.slice(0,c)}else e.length>10&&/[0-9](?:\s|\/)/.test(e)&&(i=e.match(/([0-9]+)/g).map(function(f){return parseFloat(f)}),o=e.match(/([a-z])/gi).join("").toLowerCase());else isNaN(e)?Array.isArray(e)||e.length?(i=[e[0],e[1],e[2]],o="rgb",r=e.length===4?e[3]:1):e instanceof Object&&(e.r!=null||e.red!=null||e.R!=null?(o="rgb",i=[e.r||e.red||e.R||0,e.g||e.green||e.G||0,e.b||e.blue||e.B||0]):(o="hsl",i=[e.h||e.hue||e.H||0,e.s||e.saturation||e.S||0,e.l||e.lightness||e.L||e.b||e.brightness]),r=e.a||e.alpha||e.opacity||1,e.opacity!=null&&(r/=100)):(o="rgb",i=[e>>>16,(e&65280)>>>8,e&255]);return{space:o,values:i,alpha:r}}var require_conversions=__commonJS({"node_modules/.pnpm/color-convert@2.0.1/node_modules/color-convert/conversions.js"(e,t){const i=require_color_name(),r={};for(const c of Object.keys(i))r[i[c]]=c;const o={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};t.exports=o;for(const c of Object.keys(o)){if(!("channels"in o[c]))throw new Error("missing channels property: "+c);if(!("labels"in o[c]))throw new Error("missing channel labels property: "+c);if(o[c].labels.length!==o[c].channels)throw new Error("channel and label counts mismatch: "+c);const{channels:u,labels:h}=o[c];delete o[c].channels,delete o[c].labels,Object.defineProperty(o[c],"channels",{value:u}),Object.defineProperty(o[c],"labels",{value:h})}o.rgb.hsl=function(c){const u=c[0]/255,h=c[1]/255,d=c[2]/255,f=Math.min(u,h,d),m=Math.max(u,h,d),g=m-f;let v,_;m===f?v=0:u===m?v=(h-d)/g:h===m?v=2+(d-u)/g:d===m&&(v=4+(u-h)/g),v=Math.min(v*60,360),v<0&&(v+=360);const b=(f+m)/2;return m===f?_=0:b<=.5?_=g/(m+f):_=g/(2-m-f),[v,_*100,b*100]},o.rgb.hsv=function(c){let u,h,d,f,m;const g=c[0]/255,v=c[1]/255,_=c[2]/255,b=Math.max(g,v,_),S=b-Math.min(g,v,_),T=function(A){return(b-A)/6/S+.5};return S===0?(f=0,m=0):(m=S/b,u=T(g),h=T(v),d=T(_),g===b?f=d-h:v===b?f=.3333333333333333+u-d:_===b&&(f=.6666666666666666+h-u),f<0?f+=1:f>1&&(f-=1)),[f*360,m*100,b*100]},o.rgb.hwb=function(c){const u=c[0],h=c[1];let d=c[2];const f=o.rgb.hsl(c)[0],m=.00392156862745098*Math.min(u,Math.min(h,d));return d=1-.00392156862745098*Math.max(u,Math.max(h,d)),[f,m*100,d*100]},o.rgb.cmyk=function(c){const u=c[0]/255,h=c[1]/255,d=c[2]/255,f=Math.min(1-u,1-h,1-d),m=(1-u-f)/(1-f)||0,g=(1-h-f)/(1-f)||0,v=(1-d-f)/(1-f)||0;return[m*100,g*100,v*100,f*100]};function a(c,u){return(c[0]-u[0])**2+(c[1]-u[1])**2+(c[2]-u[2])**2}o.rgb.keyword=function(c){const u=r[c];if(u)return u;let h=1/0,d;for(const f of Object.keys(i)){const m=i[f],g=a(c,m);g<h&&(h=g,d=f)}return d},o.keyword.rgb=function(c){return i[c]},o.rgb.xyz=function(c){let u=c[0]/255,h=c[1]/255,d=c[2]/255;u=u>.04045?((u+.055)/1.055)**2.4:u/12.92,h=h>.04045?((h+.055)/1.055)**2.4:h/12.92,d=d>.04045?((d+.055)/1.055)**2.4:d/12.92;const f=u*.4124+h*.3576+d*.1805,m=u*.2126+h*.7152+d*.0722,g=u*.0193+h*.1192+d*.9505;return[f*100,m*100,g*100]},o.rgb.lab=function(c){const u=o.rgb.xyz(c);let h=u[0],d=u[1],f=u[2];h/=95.047,d/=100,f/=108.883,h=h>.008856?h**.3333333333333333:7.787*h+.13793103448275862,d=d>.008856?d**.3333333333333333:7.787*d+.13793103448275862,f=f>.008856?f**.3333333333333333:7.787*f+.13793103448275862;const m=116*d-16,g=500*(h-d),v=200*(d-f);return[m,g,v]},o.hsl.rgb=function(c){const u=c[0]/360,h=c[1]/100,d=c[2]/100;let f,m,g;if(h===0)return g=d*255,[g,g,g];d<.5?f=d*(1+h):f=d+h-d*h;const v=2*d-f,_=[0,0,0];for(let b=0;b<3;b++)m=u+.3333333333333333*-(b-1),m<0&&m++,m>1&&m--,6*m<1?g=v+(f-v)*6*m:2*m<1?g=f:3*m<2?g=v+(f-v)*(.6666666666666666-m)*6:g=v,_[b]=g*255;return _},o.hsl.hsv=function(c){const u=c[0];let h=c[1]/100,d=c[2]/100,f=h;const m=Math.max(d,.01);d*=2,h*=d<=1?d:2-d,f*=m<=1?m:2-m;const g=(d+h)/2,v=d===0?2*f/(m+f):2*h/(d+h);return[u,v*100,g*100]},o.hsv.rgb=function(c){const u=c[0]/60,h=c[1]/100;let d=c[2]/100;const f=Math.floor(u)%6,m=u-Math.floor(u),g=255*d*(1-h),v=255*d*(1-h*m),_=255*d*(1-h*(1-m));switch(d*=255,f){case 0:return[d,_,g];case 1:return[v,d,g];case 2:return[g,d,_];case 3:return[g,v,d];case 4:return[_,g,d];case 5:return[d,g,v]}},o.hsv.hsl=function(c){const u=c[0],h=c[1]/100,d=c[2]/100,f=Math.max(d,.01);let m,g;g=(2-h)*d;const v=(2-h)*f;return m=h*f,m/=v<=1?v:2-v,m=m||0,g/=2,[u,m*100,g*100]},o.hwb.rgb=function(c){const u=c[0]/360;let h=c[1]/100,d=c[2]/100;const f=h+d;let m;f>1&&(h/=f,d/=f);const g=Math.floor(6*u),v=1-d;m=6*u-g,g&1&&(m=1-m);const _=h+m*(v-h);let b,S,T;switch(g){default:case 6:case 0:b=v,S=_,T=h;break;case 1:b=_,S=v,T=h;break;case 2:b=h,S=v,T=_;break;case 3:b=h,S=_,T=v;break;case 4:b=_,S=h,T=v;break;case 5:b=v,S=h,T=_;break}return[b*255,S*255,T*255]},o.cmyk.rgb=function(c){const u=c[0]/100,h=c[1]/100,d=c[2]/100,f=c[3]/100,m=1-Math.min(1,u*(1-f)+f),g=1-Math.min(1,h*(1-f)+f),v=1-Math.min(1,d*(1-f)+f);return[m*255,g*255,v*255]},o.xyz.rgb=function(c){const u=c[0]/100,h=c[1]/100,d=c[2]/100;let f,m,g;return f=u*3.2406+h*-1.5372+d*-.4986,m=u*-.9689+h*1.8758+d*.0415,g=u*.0557+h*-.204+d*1.057,f=f>.0031308?1.055*f**.4166666666666667-.055:f*12.92,m=m>.0031308?1.055*m**.4166666666666667-.055:m*12.92,g=g>.0031308?1.055*g**.4166666666666667-.055:g*12.92,f=Math.min(Math.max(0,f),1),m=Math.min(Math.max(0,m),1),g=Math.min(Math.max(0,g),1),[f*255,m*255,g*255]},o.xyz.lab=function(c){let u=c[0],h=c[1],d=c[2];u/=95.047,h/=100,d/=108.883,u=u>.008856?u**.3333333333333333:7.787*u+.13793103448275862,h=h>.008856?h**.3333333333333333:7.787*h+.13793103448275862,d=d>.008856?d**.3333333333333333:7.787*d+.13793103448275862;const f=116*h-16,m=500*(u-h),g=200*(h-d);return[f,m,g]},o.lab.xyz=function(c){const u=c[0],h=c[1],d=c[2];let f,m,g;m=(u+16)/116,f=h/500+m,g=m-d/200;const v=m**3,_=f**3,b=g**3;return m=v>.008856?v:(m-.13793103448275862)/7.787,f=_>.008856?_:(f-.13793103448275862)/7.787,g=b>.008856?b:(g-.13793103448275862)/7.787,f*=95.047,m*=100,g*=108.883,[f,m,g]},o.lab.lch=function(c){const u=c[0],h=c[1],d=c[2];let f;f=Math.atan2(d,h)*360/2/Math.PI,f<0&&(f+=360);const g=Math.sqrt(h*h+d*d);return[u,g,f]},o.lch.lab=function(c){const u=c[0],h=c[1],f=c[2]/360*2*Math.PI,m=h*Math.cos(f),g=h*Math.sin(f);return[u,m,g]},o.rgb.ansi16=function(c,u=null){const[h,d,f]=c;let m=u===null?o.rgb.hsv(c)[2]:u;if(m=Math.round(m/50),m===0)return 30;let g=30+(Math.round(f/255)<<2|Math.round(d/255)<<1|Math.round(h/255));return m===2&&(g+=60),g},o.hsv.ansi16=function(c){return o.rgb.ansi16(o.hsv.rgb(c),c[2])},o.rgb.ansi256=function(c){const u=c[0],h=c[1],d=c[2];return u===h&&h===d?u<8?16:u>248?231:Math.round((u-8)/247*24)+232:16+36*Math.round(u/255*5)+6*Math.round(h/255*5)+Math.round(d/255*5)},o.ansi16.rgb=function(c){let u=c%10;if(u===0||u===7)return c>50&&(u+=3.5),u=u/10.5*255,[u,u,u];const h=(~~(c>50)+1)*.5,d=(u&1)*h*255,f=(u>>1&1)*h*255,m=(u>>2&1)*h*255;return[d,f,m]},o.ansi256.rgb=function(c){if(c>=232){const m=(c-232)*10+8;return[m,m,m]}c-=16;let u;const h=Math.floor(c/36)/5*255,d=Math.floor((u=c%36)/6)/5*255,f=u%6/5*255;return[h,d,f]},o.rgb.hex=function(c){const h=(((Math.round(c[0])&255)<<16)+((Math.round(c[1])&255)<<8)+(Math.round(c[2])&255)).toString(16).toUpperCase();return"000000".substring(h.length)+h},o.hex.rgb=function(c){const u=c.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!u)return[0,0,0];let h=u[0];u[0].length===3&&(h=h.split("").map(v=>v+v).join(""));const d=parseInt(h,16),f=d>>16&255,m=d>>8&255,g=d&255;return[f,m,g]},o.rgb.hcg=function(c){const u=c[0]/255,h=c[1]/255,d=c[2]/255,f=Math.max(Math.max(u,h),d),m=Math.min(Math.min(u,h),d),g=f-m;let v,_;return g<1?v=m/(1-g):v=0,g<=0?_=0:f===u?_=(h-d)/g%6:f===h?_=2+(d-u)/g:_=4+(u-h)/g,_/=6,_%=1,[_*360,g*100,v*100]},o.hsl.hcg=function(c){const u=c[1]/100,h=c[2]/100,d=h<.5?2*u*h:2*u*(1-h);let f=0;return d<1&&(f=(h-.5*d)/(1-d)),[c[0],d*100,f*100]},o.hsv.hcg=function(c){const u=c[1]/100,h=c[2]/100,d=u*h;let f=0;return d<1&&(f=(h-d)/(1-d)),[c[0],d*100,f*100]},o.hcg.rgb=function(c){const u=c[0]/360,h=c[1]/100,d=c[2]/100;if(h===0)return[d*255,d*255,d*255];const f=[0,0,0],m=u%1*6,g=m%1,v=1-g;let _=0;switch(Math.floor(m)){case 0:f[0]=1,f[1]=g,f[2]=0;break;case 1:f[0]=v,f[1]=1,f[2]=0;break;case 2:f[0]=0,f[1]=1,f[2]=g;break;case 3:f[0]=0,f[1]=v,f[2]=1;break;case 4:f[0]=g,f[1]=0,f[2]=1;break;default:f[0]=1,f[1]=0,f[2]=v}return _=(1-h)*d,[(h*f[0]+_)*255,(h*f[1]+_)*255,(h*f[2]+_)*255]},o.hcg.hsv=function(c){const u=c[1]/100,h=c[2]/100,d=u+h*(1-u);let f=0;return d>0&&(f=u/d),[c[0],f*100,d*100]},o.hcg.hsl=function(c){const u=c[1]/100,d=c[2]/100*(1-u)+.5*u;let f=0;return d>0&&d<.5?f=u/(2*d):d>=.5&&d<1&&(f=u/(2*(1-d))),[c[0],f*100,d*100]},o.hcg.hwb=function(c){const u=c[1]/100,h=c[2]/100,d=u+h*(1-u);return[c[0],(d-u)*100,(1-d)*100]},o.hwb.hcg=function(c){const u=c[1]/100,d=1-c[2]/100,f=d-u;let m=0;return f<1&&(m=(d-f)/(1-f)),[c[0],f*100,m*100]},o.apple.rgb=function(c){return[c[0]/65535*255,c[1]/65535*255,c[2]/65535*255]},o.rgb.apple=function(c){return[c[0]/255*65535,c[1]/255*65535,c[2]/255*65535]},o.gray.rgb=function(c){return[c[0]/100*255,c[0]/100*255,c[0]/100*255]},o.gray.hsl=function(c){return[0,0,c[0]]},o.gray.hsv=o.gray.hsl,o.gray.hwb=function(c){return[0,100,c[0]]},o.gray.cmyk=function(c){return[0,0,0,c[0]]},o.gray.lab=function(c){return[c[0],0,0]},o.gray.hex=function(c){const u=Math.round(c[0]/100*255)&255,d=((u<<16)+(u<<8)+u).toString(16).toUpperCase();return"000000".substring(d.length)+d},o.rgb.gray=function(c){return[(c[0]+c[1]+c[2])/3/255*100]}}}),require_route=__commonJS({"node_modules/.pnpm/color-convert@2.0.1/node_modules/color-convert/route.js"(e,t){const i=require_conversions();function r(){const u={},h=Object.keys(i);for(let d=h.length,f=0;f<d;f++)u[h[f]]={distance:-1,parent:null};return u}function o(u){const h=r(),d=[u];for(h[u].distance=0;d.length;){const f=d.pop(),m=Object.keys(i[f]);for(let g=m.length,v=0;v<g;v++){const _=m[v],b=h[_];b.distance===-1&&(b.distance=h[f].distance+1,b.parent=f,d.unshift(_))}}return h}function a(u,h){return function(d){return h(u(d))}}function c(u,h){const d=[h[u].parent,u];let f=i[h[u].parent][u],m=h[u].parent;for(;h[m].parent;)d.unshift(h[m].parent),f=a(i[h[m].parent][m],f),m=h[m].parent;return f.conversion=d,f}t.exports=function(u){const h=o(u),d={},f=Object.keys(h);for(let m=f.length,g=0;g<m;g++){const v=f[g];h[v].parent!==null&&(d[v]=c(v,h))}return d}}}),require_color_convert=__commonJS({"node_modules/.pnpm/color-convert@2.0.1/node_modules/color-convert/index.js"(e,t){const i=require_conversions(),r=require_route(),o={},a=Object.keys(i);function c(h){const d=function(...f){const m=f[0];return m==null?m:(m.length>1&&(f=m),h(f))};return"conversion"in h&&(d.conversion=h.conversion),d}function u(h){const d=function(...f){const m=f[0];if(m==null)return m;m.length>1&&(f=m);const g=h(f);if(typeof g=="object")for(let v=g.length,_=0;_<v;_++)g[_]=Math.round(g[_]);return g};return"conversion"in h&&(d.conversion=h.conversion),d}a.forEach(h=>{o[h]={},Object.defineProperty(o[h],"channels",{value:i[h].channels}),Object.defineProperty(o[h],"labels",{value:i[h].labels});const d=r(h);Object.keys(d).forEach(m=>{const g=d[m];o[h][m]=u(g),o[h][m].raw=c(g)})}),t.exports=o}});const clamp=(e,t=0,i=1)=>e>i?i:e<t?t:e,round$1=(e,t=0,i=Math.pow(10,t))=>Math.round(i*e)/i,angleUnits={grad:.9,turn:360,rad:360/(Math.PI*2)},hexToHsva=e=>rgbaToHsva(hexToRgba(e)),hexToRgba=e=>(e[0]==="#"&&(e=e.substring(1)),e.length<6?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:e.length===4?round$1(parseInt(e[3]+e[3],16)/255,2):1}:{r:parseInt(e.substring(0,2),16),g:parseInt(e.substring(2,4),16),b:parseInt(e.substring(4,6),16),a:e.length===8?round$1(parseInt(e.substring(6,8),16)/255,2):1}),hsvaToHex=e=>rgbaToHex(hsvaToRgba(e)),hsvaToHsla=({h:e,s:t,v:i,a:r})=>{const o=(200-t)*i/100;return{h:round$1(e),s:round$1(o>0&&o<200?t*i/100/(o<=100?o:200-o)*100:0),l:round$1(o/2),a:round$1(r,2)}},hsvaToHslString=e=>{const{h:t,s:i,l:r}=hsvaToHsla(e);return`hsl(${t}, ${i}%, ${r}%)`},hsvaToRgba=({h:e,s:t,v:i,a:r})=>{e=e/360*6,t=t/100,i=i/100;const o=Math.floor(e),a=i*(1-t),c=i*(1-(e-o)*t),u=i*(1-(1-e+o)*t),h=o%6;return{r:round$1([i,c,a,a,u,i][h]*255),g:round$1([u,i,i,c,a,a][h]*255),b:round$1([a,a,u,i,i,c][h]*255),a:round$1(r,2)}},format=e=>{const t=e.toString(16);return t.length<2?"0"+t:t},rgbaToHex=({r:e,g:t,b:i,a:r})=>{const o=r<1?format(round$1(r*255)):"";return"#"+format(e)+format(t)+format(i)+o},rgbaToHsva=({r:e,g:t,b:i,a:r})=>{const o=Math.max(e,t,i),a=o-Math.min(e,t,i),c=a?o===e?(t-i)/a:o===t?2+(i-e)/a:4+(e-t)/a:0;return{h:round$1(60*(c<0?c+6:c)),s:round$1(o?a/o*100:0),v:round$1(o/255*100),a:r}},equalColorObjects=(e,t)=>{if(e===t)return!0;for(const i in e)if(e[i]!==t[i])return!1;return!0},equalHex=(e,t)=>e.toLowerCase()===t.toLowerCase()?!0:equalColorObjects(hexToRgba(e),hexToRgba(t)),cache={},tpl=e=>{let t=cache[e];return t||(t=document.createElement("template"),t.innerHTML=e,cache[e]=t),t},fire=(e,t,i)=>{e.dispatchEvent(new CustomEvent(t,{bubbles:!0,detail:i}))};let hasTouched=!1;const isTouch=e=>"touches"in e,isValid$1=e=>hasTouched&&!isTouch(e)?!1:(hasTouched||(hasTouched=isTouch(e)),!0),pointerMove=(e,t)=>{const i=isTouch(t)?t.touches[0]:t,r=e.el.getBoundingClientRect();fire(e.el,"move",e.getMove({x:clamp((i.pageX-(r.left+window.pageXOffset))/r.width),y:clamp((i.pageY-(r.top+window.pageYOffset))/r.height)}))},keyMove=(e,t)=>{const i=t.keyCode;i>40||e.xy&&i<37||i<33||(t.preventDefault(),fire(e.el,"move",e.getMove({x:i===39?.01:i===37?-.01:i===34?.05:i===33?-.05:i===35?1:i===36?-1:0,y:i===40?.01:i===38?-.01:0},!0)))};var Slider=class{constructor(e,t,i,r){const o=tpl(`<div role="slider" tabindex="0" part="${t}" ${i}><div part="${t}-pointer"></div></div>`);e.appendChild(o.content.cloneNode(!0));const a=e.querySelector(`[part=${t}]`);a.addEventListener("mousedown",this),a.addEventListener("touchstart",this),a.addEventListener("keydown",this),this.el=a,this.xy=r,this.nodes=[a.firstChild,a]}set dragging(e){const t=e?document.addEventListener:document.removeEventListener;t(hasTouched?"touchmove":"mousemove",this),t(hasTouched?"touchend":"mouseup",this)}handleEvent(e){switch(e.type){case"mousedown":case"touchstart":if(e.preventDefault(),!isValid$1(e)||!hasTouched&&e.button!=0)return;this.el.focus(),pointerMove(this,e),this.dragging=!0;break;case"mousemove":case"touchmove":e.preventDefault(),pointerMove(this,e);break;case"mouseup":case"touchend":this.dragging=!1;break;case"keydown":keyMove(this,e);break}}style(e){e.forEach((t,i)=>{for(const r in t)this.nodes[i].style.setProperty(r,t[r])})}},Hue=class extends Slider{constructor(e){super(e,"hue",'aria-label="Hue" aria-valuemin="0" aria-valuemax="360"',!1)}update({h:e}){this.h=e,this.style([{left:`${e/360*100}%`,color:hsvaToHslString({h:e,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuenow",`${round$1(e)}`)}getMove(e,t){return{h:t?clamp(this.h+e.x*360,0,360):360*e.x}}},Saturation=class extends Slider{constructor(e){super(e,"saturation",'aria-label="Color"',!0)}update(e){this.hsva=e,this.style([{top:`${100-e.v}%`,left:`${e.s}%`,color:hsvaToHslString(e)},{"background-color":hsvaToHslString({h:e.h,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuetext",`Saturation ${round$1(e.s)}%, Brightness ${round$1(e.v)}%`)}getMove(e,t){return{s:t?clamp(this.hsva.s+e.x*100,0,100):e.x*100,v:t?clamp(this.hsva.v-e.y*100,0,100):Math.round(100-e.y*100)}}},color_picker_default=':host{display:flex;flex-direction:column;position:relative;width:200px;height:200px;user-select:none;-webkit-user-select:none;cursor:default}:host([hidden]){display:none!important}[role=slider]{position:relative;touch-action:none;user-select:none;-webkit-user-select:none;outline:0}[role=slider]:last-child{border-radius:0 0 8px 8px}[part$=pointer]{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;display:flex;place-content:center center;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}[part$=pointer]::after{content:"";width:100%;height:100%;border-radius:inherit;background-color:currentColor}[role=slider]:focus [part$=pointer]{transform:translate(-50%,-50%) scale(1.1)}',hue_default="[part=hue]{flex:0 0 24px;background:linear-gradient(to right,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red 100%)}[part=hue-pointer]{top:50%;z-index:2}",saturation_default="[part=saturation]{flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(to top,#000,transparent),linear-gradient(to right,#fff,rgba(255,255,255,0));box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part=saturation-pointer]{z-index:3}";const $isSame=Symbol("same"),$color=Symbol("color"),$hsva=Symbol("hsva"),$update=Symbol("update"),$parts=Symbol("parts"),$css=Symbol("css"),$sliders=Symbol("sliders");var ColorPicker=class extends HTMLElement{static get observedAttributes(){return["color"]}get[$css](){return[color_picker_default,hue_default,saturation_default]}get[$sliders](){return[Saturation,Hue]}get color(){return this[$color]}set color(e){if(!this[$isSame](e)){const t=this.colorModel.toHsva(e);this[$update](t),this[$color]=e}}constructor(){super();const e=tpl(`<style>${this[$css].join("")}</style>`),t=this.attachShadow({mode:"open"});t.appendChild(e.content.cloneNode(!0)),t.addEventListener("move",this),this[$parts]=this[$sliders].map(i=>new i(t))}connectedCallback(){if(this.hasOwnProperty("color")){const e=this.color;delete this.color,this.color=e}else this.color||(this.color=this.colorModel.defaultColor)}attributeChangedCallback(e,t,i){const r=this.colorModel.fromAttr(i);this[$isSame](r)||(this.color=r)}handleEvent(e){const t=this[$hsva],i={...t,...e.detail};this[$update](i);let r;!equalColorObjects(i,t)&&!this[$isSame](r=this.colorModel.fromHsva(i))&&(this[$color]=r,fire(this,"color-changed",{value:r}))}[$isSame](e){return this.color&&this.colorModel.equal(e,this.color)}[$update](e){this[$hsva]=e,this[$parts].forEach(t=>t.update(e))}};const colorModel={defaultColor:"#000",toHsva:hexToHsva,fromHsva:({h:e,s:t,v:i})=>hsvaToHex({h:e,s:t,v:i,a:1}),equal:equalHex,fromAttr:e=>e};var HexBase=class extends ColorPicker{get colorModel(){return colorModel}},import_color_convert=__toESM(require_color_convert(),1),ViewCollection=class extends Collection{_parentElement;constructor(e=[]){super(e,{idProperty:"viewUid"}),this.on("add",(t,i,r)=>{this._renderViewIntoCollectionParent(i,r)}),this.on("remove",(t,i)=>{i.element&&this._parentElement&&i.element.remove()}),this._parentElement=null}destroy(){this.map(e=>e.destroy())}setParent(e){this._parentElement=e;for(const t of this)this._renderViewIntoCollectionParent(t)}delegate(...e){if(!e.length||!isStringArray(e))throw new CKEditorError("ui-viewcollection-delegate-wrong-events",this);return{to:t=>{for(const i of this)for(const r of e)i.delegate(r).to(t);this.on("add",(i,r)=>{for(const o of e)r.delegate(o).to(t)}),this.on("remove",(i,r)=>{for(const o of e)r.stopDelegating(o,t)})}}}_renderViewIntoCollectionParent(e,t){e.isRendered||e.render(),e.element&&this._parentElement&&this._parentElement.insertBefore(e.element,this._parentElement.children[t])}remove(e){return super.remove(e)}};function isStringArray(e){return e.every(t=>typeof t=="string")}const xhtmlNs="http://www.w3.org/1999/xhtml";var Template=class extends EmitterMixin(){ns;tag;text;attributes;children;eventListeners;_isRendered;_revertData;constructor(e){super(),Object.assign(this,normalize(clone(e))),this._isRendered=!1,this._revertData=null}render(){const e=this._renderNode({intoFragment:!0});return this._isRendered=!0,e}apply(e){return this._revertData=getEmptyRevertData(),this._renderNode({node:e,intoFragment:!1,isApplying:!0,revertData:this._revertData}),e}revert(e){if(!this._revertData)throw new CKEditorError("ui-template-revert-not-applied",[this,e]);this._revertTemplateFromNode(e,this._revertData)}*getViews(){function*e(t){if(t.children)for(const i of t.children)isView(i)?yield i:isTemplate(i)&&(yield*e(i))}yield*e(this)}static bind(e,t){return{to(i,r){return new TemplateToBinding({eventNameOrFunction:i,attribute:i,observable:e,emitter:t,callback:r})},if(i,r,o){return new TemplateIfBinding({observable:e,emitter:t,attribute:i,valueIfTrue:r,callback:o})}}}static extend(e,t){if(e._isRendered)throw new CKEditorError("template-extend-render",[this,e]);extendTemplate(e,normalize(clone(t)))}_renderNode(e){let t;if(e.node?t=this.tag&&this.text:t=this.tag?this.text:!this.text,t)throw new CKEditorError("ui-template-wrong-syntax",this);return this.text?this._renderText(e):this._renderElement(e)}_renderElement(e){let t=e.node;return t||(t=e.node=document.createElementNS(this.ns||xhtmlNs,this.tag)),this._renderAttributes(e),this._renderElementChildren(e),this._setUpListeners(e),t}_renderText(e){let t=e.node;return t?e.revertData.text=t.textContent:t=e.node=document.createTextNode(""),hasTemplateBinding(this.text)?this._bindToObservable({schema:this.text,updater:getTextUpdater(t),data:e}):t.textContent=this.text.join(""),t}_renderAttributes(e){if(!this.attributes)return;const t=e.node,i=e.revertData;for(const r in this.attributes){const o=t.getAttribute(r),a=this.attributes[r];i&&(i.attributes[r]=o);const c=isNamespaced(a)?a[0].ns:null;if(hasTemplateBinding(a)){const u=isNamespaced(a)?a[0].value:a;i&&shouldExtend(r)&&u.unshift(o),this._bindToObservable({schema:u,updater:getAttributeUpdater(t,r,c),data:e})}else if(r=="style"&&typeof a[0]!="string")this._renderStyleAttribute(a[0],e);else{i&&o&&shouldExtend(r)&&a.unshift(o);const u=a.map(h=>h&&(h.value||h)).reduce((h,d)=>h.concat(d),[]).reduce(arrayValueReducer,"");isFalsy(u)||t.setAttributeNS(c,r,u)}}}_renderStyleAttribute(e,t){const i=t.node;for(const r in e){const o=e[r];hasTemplateBinding(o)?this._bindToObservable({schema:[o],updater:getStyleUpdater(i,r),data:t}):i.style[r]=o}}_renderElementChildren(e){const t=e.node,i=e.intoFragment?document.createDocumentFragment():t,r=e.isApplying;let o=0;for(const a of this.children)if(isViewCollection(a)){if(!r){a.setParent(t);for(const c of a)i.appendChild(c.element)}}else if(isView(a))r||(a.isRendered||a.render(),i.appendChild(a.element));else if(isNode(a))i.appendChild(a);else if(r){const c=e.revertData,u=getEmptyRevertData();c.children.push(u),a._renderNode({intoFragment:!1,node:i.childNodes[o++],isApplying:!0,revertData:u})}else i.appendChild(a.render());e.intoFragment&&t.appendChild(i)}_setUpListeners(e){if(this.eventListeners)for(const t in this.eventListeners){const i=this.eventListeners[t].map(r=>{const[o,a]=t.split("@");return r.activateDomEventListener(o,a,e)});e.revertData&&e.revertData.bindings.push(i)}}_bindToObservable({schema:e,updater:t,data:i}){const r=i.revertData;syncValueSchemaValue(e,t,i);const o=e.filter(a=>!isFalsy(a)).filter(a=>a.observable).map(a=>a.activateAttributeListener(e,t,i));r&&r.bindings.push(o)}_revertTemplateFromNode(e,t){for(const r of t.bindings)for(const o of r)o();if(t.text){e.textContent=t.text;return}const i=e;for(const r in t.attributes){const o=t.attributes[r];o===null?i.removeAttribute(r):i.setAttribute(r,o)}for(let r=0;r<t.children.length;++r)this._revertTemplateFromNode(i.childNodes[r],t.children[r])}},TemplateBinding=class{attribute;observable;emitter;callback;constructor(e){this.attribute=e.attribute,this.observable=e.observable,this.emitter=e.emitter,this.callback=e.callback}getValue(e){const t=this.observable[this.attribute];return this.callback?this.callback(t,e):t}activateAttributeListener(e,t,i){const r=()=>syncValueSchemaValue(e,t,i);return this.emitter.listenTo(this.observable,`change:${this.attribute}`,r),()=>{this.emitter.stopListening(this.observable,`change:${this.attribute}`,r)}}},TemplateToBinding=class extends TemplateBinding{eventNameOrFunction;constructor(e){super(e),this.eventNameOrFunction=e.eventNameOrFunction}activateDomEventListener(e,t,i){const r=(o,a)=>{(!t||a.target.matches(t))&&(typeof this.eventNameOrFunction=="function"?this.eventNameOrFunction(a):this.observable.fire(this.eventNameOrFunction,a))};return this.emitter.listenTo(i.node,e,r),()=>{this.emitter.stopListening(i.node,e,r)}}},TemplateIfBinding=class extends TemplateBinding{valueIfTrue;constructor(e){super(e),this.valueIfTrue=e.valueIfTrue}getValue(e){const t=super.getValue(e);return isFalsy(t)?!1:this.valueIfTrue||!0}};function hasTemplateBinding(e){return e?(e.value&&(e=e.value),Array.isArray(e)?e.some(hasTemplateBinding):e instanceof TemplateBinding):!1}function getValueSchemaValue(e,t){return e.map(i=>i instanceof TemplateBinding?i.getValue(t):i)}function syncValueSchemaValue(e,t,{node:i}){const r=getValueSchemaValue(e,i);let o;e.length==1&&e[0]instanceof TemplateIfBinding?o=r[0]:o=r.reduce(arrayValueReducer,""),isFalsy(o)?t.remove():t.set(o)}function getTextUpdater(e){return{set(t){e.textContent=t},remove(){e.textContent=""}}}function getAttributeUpdater(e,t,i){return{set(r){e.setAttributeNS(i,t,r)},remove(){e.removeAttributeNS(i,t)}}}function getStyleUpdater(e,t){return{set(i){e.style[t]=i},remove(){e.style[t]=null}}}function clone(e){return cloneDeepWith_default(e,i=>{if(i&&(i instanceof TemplateBinding||isTemplate(i)||isView(i)||isViewCollection(i)))return i})}function normalize(e){if(typeof e=="string"?e=normalizePlainTextDefinition(e):e.text&&normalizeTextDefinition(e),e.on&&(e.eventListeners=normalizeListeners(e.on),delete e.on),!e.text){e.attributes&&normalizeAttributes(e.attributes);const t=[];if(e.children)if(isViewCollection(e.children))t.push(e.children);else for(const i of e.children)isTemplate(i)||isView(i)||isNode(i)?t.push(i):t.push(new Template(i));e.children=t}return e}function normalizeAttributes(e){for(const t in e)e[t].value&&(e[t].value=toArray$1(e[t].value)),arrayify(e,t)}function normalizeListeners(e){for(const t in e)arrayify(e,t);return e}function normalizePlainTextDefinition(e){return{text:[e]}}function normalizeTextDefinition(e){e.text=toArray$1(e.text)}function arrayify(e,t){e[t]=toArray$1(e[t])}function arrayValueReducer(e,t){return isFalsy(t)?e:isFalsy(e)?t:`${e} ${t}`}function extendObjectValueArray(e,t){for(const i in t)e[i]?e[i].push(...t[i]):e[i]=t[i]}function extendTemplate(e,t){if(t.attributes&&(e.attributes||(e.attributes={}),extendObjectValueArray(e.attributes,t.attributes)),t.eventListeners&&(e.eventListeners||(e.eventListeners={}),extendObjectValueArray(e.eventListeners,t.eventListeners)),t.text&&e.text.push(...t.text),t.children&&t.children.length){if(e.children.length!=t.children.length)throw new CKEditorError("ui-template-extend-children-mismatch",e);let i=0;for(const r of t.children)extendTemplate(e.children[i++],r)}}function isFalsy(e){return!e&&e!==0}function isView(e){return e instanceof View}function isTemplate(e){return e instanceof Template}function isViewCollection(e){return e instanceof ViewCollection}function isNamespaced(e){return isObject_default(e[0])&&e[0].ns}function getEmptyRevertData(){return{children:[],bindings:[],attributes:{}}}function shouldExtend(e){return e=="class"||e=="style"}var View=class extends DomEmitterMixin(ObservableMixin()){element;isRendered;locale;t;template;_viewCollections;_unboundChildren;_bindTemplate;constructor(e){super(),this.element=null,this.isRendered=!1,this.locale=e,this.t=e&&e.t,this._viewCollections=new Collection,this._unboundChildren=this.createCollection(),this._viewCollections.on("add",(t,i)=>{i.locale=e,i.t=e&&e.t}),this.decorate("render")}get bindTemplate(){return this._bindTemplate?this._bindTemplate:this._bindTemplate=Template.bind(this,this)}createCollection(e){const t=new ViewCollection(e);return this._viewCollections.add(t),t}registerChild(e){isIterable(e)||(e=[e]);for(const t of e)this._unboundChildren.add(t)}deregisterChild(e){isIterable(e)||(e=[e]);for(const t of e)this._unboundChildren.remove(t)}setTemplate(e){this.template=new Template(e)}extendTemplate(e){Template.extend(this.template,e)}render(){if(this.isRendered)throw new CKEditorError("ui-view-render-already-rendered",this);this.template&&(this.element=this.template.render(),this.registerChild(this.template.getViews())),this.isRendered=!0}destroy(){this.stopListening(),this._viewCollections.map(e=>e.destroy()),this.template&&this.template._revertData&&this.template.revert(this.element)}};/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function clickOutsideHandler({emitter:e,activator:t,callback:i,contextElements:r,listenerOptions:o}){e.listenTo(document,"mousedown",(a,c)=>{if(!t())return;const u=typeof c.composedPath=="function"?c.composedPath():[],h=typeof r=="function"?r():r;for(const d of h)if(d.contains(c.target)||u.includes(d))return;i()},o)}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function addKeyboardHandlingForGrid({keystrokeHandler:e,focusTracker:t,gridItems:i,numberOfColumns:r,uiLanguageDirection:o}){const a=typeof r=="number"?()=>r:r;e.set("arrowright",c((d,f)=>o==="rtl"?h(d,f.length):u(d,f.length))),e.set("arrowleft",c((d,f)=>o==="rtl"?u(d,f.length):h(d,f.length))),e.set("arrowup",c((d,f)=>{let m=d-a();return m<0&&(m=d+a()*Math.floor(f.length/a()),m>f.length-1&&(m-=a())),m})),e.set("arrowdown",c((d,f)=>{let m=d+a();return m>f.length-1&&(m=d%a()),m}));function c(d){return f=>{const m=i.find(_=>_.element===t.focusedElement),g=i.getIndex(m),v=d(g,i);i.get(v).focus(),f.stopPropagation(),f.preventDefault()}}function u(d,f){return d===f-1?0:d+1}function h(d,f){return d===0?f-1:d-1}}var IconView=class Ss extends View{static presentationalAttributeNames=["alignment-baseline","baseline-shift","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-rendering","cursor","direction","display","dominant-baseline","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","image-rendering","letter-spacing","lighting-color","marker-end","marker-mid","marker-start","mask","opacity","overflow","paint-order","pointer-events","shape-rendering","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-anchor","text-decoration","text-overflow","text-rendering","transform","unicode-bidi","vector-effect","visibility","white-space","word-spacing","writing-mode"];constructor(){super();const t=this.bindTemplate;this.set("content",""),this.set("viewBox","0 0 20 20"),this.set("fillColor",""),this.set("isColorInherited",!0),this.set("isVisible",!0),this.setTemplate({tag:"svg",ns:"http://www.w3.org/2000/svg",attributes:{class:["ck","ck-icon",t.if("isVisible","ck-hidden",i=>!i),"ck-reset_all-excluded",t.if("isColorInherited","ck-icon_inherit-color")],viewBox:t.to("viewBox"),"aria-hidden":!0}})}render(){super.render(),this._updateXMLContent(),this._colorFillPaths(),this.on("change:content",()=>{this._updateXMLContent(),this._colorFillPaths()}),this.on("change:fillColor",()=>{this._colorFillPaths()})}_updateXMLContent(){if(this.content){const i=new DOMParser().parseFromString(this.content.trim(),"image/svg+xml").querySelector("svg"),r=i.getAttribute("viewBox");r&&(this.viewBox=r);for(const{name:o,value:a}of Array.from(i.attributes))Ss.presentationalAttributeNames.includes(o)&&this.element.setAttribute(o,a);for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(;i.childNodes.length>0;)this.element.appendChild(i.childNodes[0])}}_colorFillPaths(){this.fillColor&&this.element.querySelectorAll(".ck-icon__fill").forEach(t=>{t.style.fill=this.fillColor})}},ButtonLabelView=class extends View{constructor(){super(),this.set({style:void 0,text:void 0,id:void 0});const e=this.bindTemplate;this.setTemplate({tag:"span",attributes:{class:["ck","ck-button__label"],style:e.to("style"),id:e.to("id")},children:[{text:e.to("text")}]})}},ButtonView=class extends View{children;labelView;iconView;keystrokeView;_focusDelayed=null;constructor(e,t=new ButtonLabelView){super(e);const i=this.bindTemplate,r=uid();this.set("_ariaPressed",!1),this.set("_ariaChecked",!1),this.set("ariaLabel",void 0),this.set("ariaLabelledBy",`ck-editor__aria-label_${r}`),this.set("class",void 0),this.set("labelStyle",void 0),this.set("icon",void 0),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isVisible",!0),this.set("isToggleable",!1),this.set("keystroke",void 0),this.set("label",void 0),this.set("role",void 0),this.set("tabindex",-1),this.set("tooltip",!1),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.set("withKeystroke",!1),this.children=this.createCollection(),this.labelView=this._setupLabelView(t),this.iconView=new IconView,this.iconView.extendTemplate({attributes:{class:"ck-button__icon"}}),this.keystrokeView=this._createKeystrokeView(),this.bind("_tooltipString").to(this,"tooltip",this,"label",this,"keystroke",this._getTooltipString.bind(this));const o={tag:"button",attributes:{class:["ck","ck-button",i.to("class"),i.if("isEnabled","ck-disabled",a=>!a),i.if("isVisible","ck-hidden",a=>!a),i.to("isOn",a=>a?"ck-on":"ck-off"),i.if("withText","ck-button_with-text"),i.if("withKeystroke","ck-button_with-keystroke")],role:i.to("role"),type:i.to("type",a=>a||"button"),tabindex:i.to("tabindex"),"aria-checked":i.to("_ariaChecked"),"aria-pressed":i.to("_ariaPressed"),"aria-label":i.to("ariaLabel"),"aria-labelledby":i.to("ariaLabelledBy"),"aria-disabled":i.if("isEnabled",!0,a=>!a),"data-cke-tooltip-text":i.to("_tooltipString"),"data-cke-tooltip-position":i.to("tooltipPosition")},children:this.children,on:{click:i.to(a=>{this.isEnabled?this.fire("execute"):a.preventDefault()})}};this.bind("_ariaPressed").to(this,"isOn",this,"isToggleable",this,"role",(a,c,u)=>!c||isCheckableRole(u)?!1:String(!!a)),this.bind("_ariaChecked").to(this,"isOn",this,"isToggleable",this,"role",(a,c,u)=>!c||!isCheckableRole(u)?!1:String(!!a)),env.isSafari&&(this._focusDelayed||(this._focusDelayed=delay(()=>this.focus(),0)),o.on.mousedown=i.to(()=>{this._focusDelayed()}),o.on.mouseup=i.to(()=>{this._focusDelayed.cancel()})),this.setTemplate(o)}render(){super.render(),this.icon&&(this.iconView.bind("content").to(this,"icon"),this.children.add(this.iconView)),this.children.add(this.labelView),this.withKeystroke&&this.keystroke&&this.children.add(this.keystrokeView)}focus(){this.element.focus()}destroy(){this._focusDelayed&&this._focusDelayed.cancel(),super.destroy()}_setupLabelView(e){return e.bind("text","style","id").to(this,"label","labelStyle","ariaLabelledBy"),e}_createKeystrokeView(){const e=new View;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__keystroke"]},children:[{text:this.bindTemplate.to("keystroke",t=>getEnvKeystrokeText(t))}]}),e}_getTooltipString(e,t,i){return e?typeof e=="string"?e:(i&&(i=getEnvKeystrokeText(i)),e instanceof Function?e(t,i):`${t}${i?` (${i})`:""}`):""}};function isCheckableRole(e){switch(e){case"radio":case"checkbox":case"option":case"switch":case"menuitemcheckbox":case"menuitemradio":return!0;default:return!1}}var FormHeaderView=class extends View{children;iconView;constructor(e,t={}){super(e);const i=this.bindTemplate;this.set("label",t.label||""),this.set("class",t.class||null),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form__header",i.to("class")]},children:this.children}),t.icon&&(this.iconView=new IconView,this.iconView.content=t.icon,this.children.add(this.iconView));const r=new View(e);r.setTemplate({tag:"h2",attributes:{class:["ck","ck-form__header__label"],role:"presentation"},children:[{text:i.to("label")}]}),this.children.add(r)}},FocusCycler=class extends EmitterMixin(){focusables;focusTracker;keystrokeHandler;actions;constructor(e){if(super(),this.focusables=e.focusables,this.focusTracker=e.focusTracker,this.keystrokeHandler=e.keystrokeHandler,this.actions=e.actions,e.actions&&e.keystrokeHandler)for(const t in e.actions){let i=e.actions[t];typeof i=="string"&&(i=[i]);for(const r of i)e.keystrokeHandler.set(r,(o,a)=>{this[t](),a()},e.keystrokeHandlerOptions)}this.on("forwardCycle",()=>this.focusFirst(),{priority:"low"}),this.on("backwardCycle",()=>this.focusLast(),{priority:"low"})}get first(){return this.focusables.find(isDomFocusable)||null}get last(){return this.focusables.filter(isDomFocusable).slice(-1)[0]||null}get next(){return this._getDomFocusableItem(1)}get previous(){return this._getDomFocusableItem(-1)}get current(){let e=null;return this.focusTracker.focusedElement===null?null:(this.focusables.find((t,i)=>{const r=t.element===this.focusTracker.focusedElement;return r&&(e=i),r}),e)}focusFirst(){this._focus(this.first,1)}focusLast(){this._focus(this.last,-1)}focusNext(){const e=this.next;if(e&&this.focusables.getIndex(e)===this.current){this.fire("forwardCycle");return}e===this.first?this.fire("forwardCycle"):this._focus(e,1)}focusPrevious(){const e=this.previous;if(e&&this.focusables.getIndex(e)===this.current){this.fire("backwardCycle");return}e===this.last?this.fire("backwardCycle"):this._focus(e,-1)}chain(e){const t=()=>this.current===null?null:this.focusables.get(this.current);this.listenTo(e,"forwardCycle",i=>{const r=t();this.focusNext(),r!==t()&&i.stop()},{priority:"low"}),this.listenTo(e,"backwardCycle",i=>{const r=t();this.focusPrevious(),r!==t()&&i.stop()},{priority:"low"})}unchain(e){this.stopListening(e)}_focus(e,t){e&&this.focusTracker.focusedElement!==e.element&&e.focus(t)}_getDomFocusableItem(e){const t=this.focusables.length;if(!t)return null;const i=this.current;if(i===null)return this[e===1?"first":"last"];let r=this.focusables.get(i),o=(i+t+e)%t;do{const a=this.focusables.get(o);if(isDomFocusable(a)){r=a;break}o=(o+t+e)%t}while(o!==i);return r}};function isDomFocusable(e){return isFocusable(e)&&isVisible(e.element)}function isFocusable(e){return"focus"in e&&typeof e.focus=="function"}function isViewWithFocusCycler(e){return isFocusable(e)&&"focusCycler"in e&&e.focusCycler instanceof FocusCycler}function DraggableViewMixin(e){class t extends e{_onDragBound=this._onDrag.bind(this);_onDragEndBound=this._onDragEnd.bind(this);_lastDraggingCoordinates={x:0,y:0};constructor(...r){super(...r),this.on("render",()=>{this._attachListeners()}),this.set("isDragging",!1)}_attachListeners(){this.listenTo(this.element,"mousedown",this._onDragStart.bind(this)),this.listenTo(this.element,"touchstart",this._onDragStart.bind(this))}_attachDragListeners(){this.listenTo(global$1.document,"mouseup",this._onDragEndBound),this.listenTo(global$1.document,"touchend",this._onDragEndBound),this.listenTo(global$1.document,"mousemove",this._onDragBound),this.listenTo(global$1.document,"touchmove",this._onDragBound)}_detachDragListeners(){this.stopListening(global$1.document,"mouseup",this._onDragEndBound),this.stopListening(global$1.document,"touchend",this._onDragEndBound),this.stopListening(global$1.document,"mousemove",this._onDragBound),this.stopListening(global$1.document,"touchmove",this._onDragBound)}_onDragStart(r,o){if(!this._isHandleElementPressed(o))return;this._attachDragListeners();let a=0,c=0;o instanceof MouseEvent?(a=o.clientX,c=o.clientY):(a=o.touches[0].clientX,c=o.touches[0].clientY),this._lastDraggingCoordinates={x:a,y:c},this.isDragging=!0}_onDrag(r,o){if(!this.isDragging){this._detachDragListeners();return}let a=0,c=0;o instanceof MouseEvent?(a=o.clientX,c=o.clientY):(a=o.touches[0].clientX,c=o.touches[0].clientY),o.preventDefault(),this.fire("drag",{deltaX:Math.round(a-this._lastDraggingCoordinates.x),deltaY:Math.round(c-this._lastDraggingCoordinates.y)}),this._lastDraggingCoordinates={x:a,y:c}}_onDragEnd(){this._detachDragListeners(),this.isDragging=!1}_isHandleElementPressed(r){return this.dragHandleElement?this.dragHandleElement===r.target||r.target instanceof HTMLElement&&this.dragHandleElement.contains(r.target):!1}}return t}var DialogActionsView=class extends View{children;keystrokes;focusCycler;_focusTracker;_focusables;constructor(e){super(e),this.children=this.createCollection(),this.keystrokes=new KeystrokeHandler,this._focusTracker=new FocusTracker,this._focusables=new ViewCollection,this.focusCycler=new FocusCycler({focusables:this._focusables,focusTracker:this._focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog__actions"]},children:this.children})}render(){super.render(),this.keystrokes.listenTo(this.element)}setButtons(e){for(const t of e){const i=new ButtonView(this.locale);let r;i.on("execute",()=>t.onExecute()),t.onCreate&&t.onCreate(i);for(r in t)r!="onExecute"&&r!="onCreate"&&i.set(r,t[r]);this.children.add(i)}this._updateFocusCyclableItems()}focus(e){e===-1?this.focusCycler.focusLast():this.focusCycler.focusFirst()}_updateFocusCyclableItems(){Array.from(this.children).forEach(e=>{this._focusables.add(e),this._focusTracker.add(e.element)})}},DialogContentView=class extends View{children;constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog__content"]},children:this.children})}reset(){for(;this.children.length;)this.children.remove(0)}};const DialogViewPosition={SCREEN_CENTER:"screen-center",EDITOR_CENTER:"editor-center",EDITOR_TOP_SIDE:"editor-top-side",EDITOR_TOP_CENTER:"editor-top-center",EDITOR_BOTTOM_CENTER:"editor-bottom-center",EDITOR_ABOVE_CENTER:"editor-above-center",EDITOR_BELOW_CENTER:"editor-below-center"},toPx$6=toUnit("px");var DialogView=class Es extends DraggableViewMixin(View){parts;headerView;closeButtonView;actionsView;static defaultOffset=15;contentView;keystrokes;focusTracker;wasMoved=!1;_getCurrentDomRoot;_getViewportOffset;_focusables;_focusCycler;constructor(t,{getCurrentDomRoot:i,getViewportOffset:r}){super(t);const o=this.bindTemplate,a=t.t;this.set("className",""),this.set("ariaLabel",a("Editor dialog")),this.set("isModal",!1),this.set("position",DialogViewPosition.SCREEN_CENTER),this.set("_isVisible",!1),this.set("_isTransparent",!1),this.set("_top",0),this.set("_left",0),this._getCurrentDomRoot=i,this._getViewportOffset=r,this.decorate("moveTo"),this.parts=this.createCollection(),this.keystrokes=new KeystrokeHandler,this.focusTracker=new FocusTracker,this._focusables=new ViewCollection,this._focusCycler=new FocusCycler({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog-overlay",o.if("isModal","ck-dialog-overlay__transparent",c=>!c),o.if("_isVisible","ck-hidden",c=>!c)],tabindex:"-1"},children:[{tag:"div",attributes:{tabindex:"-1",class:["ck","ck-dialog",o.if("isModal","ck-dialog_modal"),o.to("className")],role:"dialog","aria-label":o.to("ariaLabel"),style:{top:o.to("_top",c=>toPx$6(c)),left:o.to("_left",c=>toPx$6(c)),visibility:o.if("_isTransparent","hidden")}},children:this.parts}]})}render(){super.render(),this.keystrokes.set("Esc",(t,i)=>{t.defaultPrevented||(this.fire("close",{source:"escKeyPress"}),i())}),this.on("drag",(t,{deltaX:i,deltaY:r})=>{this.wasMoved=!0,this.moveBy(i,r)}),this.listenTo(global$1.window,"resize",()=>{this._isVisible&&!this.wasMoved&&this.updatePosition()}),this.listenTo(global$1.document,"scroll",()=>{this._isVisible&&!this.wasMoved&&this.updatePosition()}),this.on("change:_isVisible",(t,i,r)=>{r&&(this._isTransparent=!0,setTimeout(()=>{this.updatePosition(),this._isTransparent=!1,this.focus()},10))}),this.keystrokes.listenTo(this.element)}get dragHandleElement(){return this.headerView&&!this.isModal?this.headerView.element:null}setupParts({icon:t,title:i,hasCloseButton:r=!0,content:o,actionButtons:a}){i&&(this.headerView=new FormHeaderView(this.locale,{icon:t}),r&&(this.closeButtonView=this._createCloseButton(),this.headerView.children.add(this.closeButtonView)),this.headerView.label=i,this.ariaLabel=i,this.parts.add(this.headerView,0)),o&&(o instanceof View&&(o=[o]),this.contentView=new DialogContentView(this.locale),this.contentView.children.addMany(o),this.parts.add(this.contentView)),a&&(this.actionsView=new DialogActionsView(this.locale),this.actionsView.setButtons(a),this.parts.add(this.actionsView)),this._updateFocusCyclableItems()}focus(){this._focusCycler.focusFirst()}moveTo(t,i){const r=this._getViewportRect(),o=this._getDialogRect();t+o.width>r.right&&(t=r.right-o.width),t<r.left&&(t=r.left),i<r.top&&(i=r.top),this._moveTo(t,i)}_moveTo(t,i){this._left=t,this._top=i}moveBy(t,i){this.moveTo(this._left+t,this._top+i)}_moveOffScreen(){this._moveTo(-9999,-9999)}updatePosition(){if(!this.element||!this.element.parentNode)return;const t=this._getViewportRect();let i=this.position,r;this._getCurrentDomRoot()?r=this._getVisibleDomRootRect(t):i=DialogViewPosition.SCREEN_CENTER;const o=Es.defaultOffset,a=this._getDialogRect();switch(i){case DialogViewPosition.EDITOR_TOP_SIDE:{if(r){const c=this.locale.contentLanguageDirection==="ltr"?r.right-a.width-o:r.left+o;this.moveTo(c,r.top+o)}else this._moveOffScreen();break}case DialogViewPosition.EDITOR_CENTER:{r?this.moveTo(Math.round(r.left+r.width/2-a.width/2),Math.round(r.top+r.height/2-a.height/2)):this._moveOffScreen();break}case DialogViewPosition.SCREEN_CENTER:{this.moveTo(Math.round((t.width-a.width)/2),Math.round((t.height-a.height)/2));break}case DialogViewPosition.EDITOR_TOP_CENTER:{r?this.moveTo(Math.round(r.left+r.width/2-a.width/2),r.top+o):this._moveOffScreen();break}case DialogViewPosition.EDITOR_BOTTOM_CENTER:{r?this.moveTo(Math.round(r.left+r.width/2-a.width/2),r.bottom-a.height-o):this._moveOffScreen();break}case DialogViewPosition.EDITOR_ABOVE_CENTER:{r?this.moveTo(Math.round(r.left+r.width/2-a.width/2),r.top-a.height-o):this._moveOffScreen();break}case DialogViewPosition.EDITOR_BELOW_CENTER:{r?this.moveTo(Math.round(r.left+r.width/2-a.width/2),r.bottom+o):this._moveOffScreen();break}}}_getVisibleDomRootRect(t){let i=new Rect(this._getCurrentDomRoot()).getVisible();if(i){if(i=t.getIntersection(i),!i)return null}else return null;return i}_getDialogRect(){return new Rect(this.element.firstElementChild)}_getViewportRect(){const t=new Rect(global$1.window);if(this.isModal)return t;const i={top:0,bottom:0,left:0,right:0,...this._getViewportOffset()};return t.top+=i.top,t.height-=i.top,t.bottom-=i.bottom,t.height-=i.bottom,t.left+=i.left,t.right-=i.right,t.width-=i.left+i.right,t}_updateFocusCyclableItems(){const t=[];if(this.contentView)for(const i of this.contentView.children)isFocusable(i)&&t.push(i);this.actionsView&&t.push(this.actionsView),this.closeButtonView&&t.push(this.closeButtonView),t.forEach(i=>{this._focusables.add(i),this.focusTracker.add(i.element),isViewWithFocusCycler(i)&&this._focusCycler.chain(i.focusCycler)})}_createCloseButton(){const t=new ButtonView(this.locale),i=this.locale.t;return t.set({label:i("Close"),tooltip:!0,icon:icons.cancel}),t.on("execute",()=>this.fire("close",{source:"closeButton"})),t}},Dialog=class hn extends Plugin{view;static _visibleDialogPlugin;_onHide;static get pluginName(){return"Dialog"}static get isOfficialPlugin(){return!0}constructor(t){super(t);const i=t.t;this._initShowHideListeners(),this._initFocusToggler(),this._initMultiRootIntegration(),this.set({id:null,isOpen:!1}),t.accessibility.addKeystrokeInfos({categoryId:"navigation",keystrokes:[{label:i("Move focus in and out of an active dialog window"),keystroke:"Ctrl+F6",mayRequireFn:!0}]})}destroy(){super.destroy(),this._unlockBodyScroll()}_initShowHideListeners(){this.on("show",(t,i)=>{this._show(i)}),this.on("show",(t,i)=>{i.onShow&&i.onShow(this)},{priority:"low"}),this.on("hide",()=>{hn._visibleDialogPlugin&&hn._visibleDialogPlugin._hide()}),this.on("hide",()=>{this._onHide&&(this._onHide(this),this._onHide=void 0)},{priority:"low"})}_initFocusToggler(){const t=this.editor;t.keystrokes.set("Ctrl+F6",(i,r)=>{!this.isOpen||this.view.isModal||(this.view.focusTracker.isFocused?t.editing.view.focus():this.view.focus(),r())})}_initMultiRootIntegration(){const t=this.editor.model;t.document.on("change:data",()=>{if(!this.view)return;const i=t.document.differ.getChangedRoots();for(const r of i)r.state&&this.view.updatePosition()})}show(t){this.hide(),this.fire(`show:${t.id}`,t)}_show({id:t,icon:i,title:r,hasCloseButton:o=!0,content:a,actionButtons:c,className:u,isModal:h,position:d,onHide:f}){const m=this.editor;this.view=new DialogView(m.locale,{getCurrentDomRoot:()=>m.editing.view.getDomRoot(m.model.document.selection.anchor.root.rootName),getViewportOffset:()=>m.ui.viewportOffset});const g=this.view;g.on("close",()=>{this.hide()}),m.ui.view.body.add(g),m.keystrokes.listenTo(g.element),d||(d=h?DialogViewPosition.SCREEN_CENTER:DialogViewPosition.EDITOR_CENTER),h&&this._lockBodyScroll(),g.set({position:d,_isVisible:!0,className:u,isModal:h}),g.setupParts({icon:i,title:r,hasCloseButton:o,content:a,actionButtons:c}),this.id=t,f&&(this._onHide=f),this.isOpen=!0,hn._visibleDialogPlugin=this}hide(){hn._visibleDialogPlugin&&hn._visibleDialogPlugin.fire(`hide:${hn._visibleDialogPlugin.id}`)}_hide(){if(!this.view)return;const t=this.editor,i=this.view;i.isModal&&this._unlockBodyScroll(),i.contentView&&i.contentView.reset(),t.ui.view.body.remove(i),t.ui.focusTracker.remove(i.element),t.keystrokes.stopListening(i.element),i.destroy(),t.editing.view.focus(),this.id=null,this.isOpen=!1,hn._visibleDialogPlugin=null}_lockBodyScroll(){document.documentElement.classList.add("ck-dialog-scroll-locked")}_unlockBodyScroll(){document.documentElement.classList.remove("ck-dialog-scroll-locked")}},ListItemButtonView=class extends ButtonView{_checkIconHolderView=new CheckIconHolderView;constructor(e,t=new ButtonLabelView){super(e,t),this.set({hasCheckSpace:!1,_hasCheck:this.isToggleable});const i=this.bindTemplate;this.extendTemplate({attributes:{class:["ck-list-item-button",i.if("isToggleable","ck-list-item-button_toggleable")]}}),this.bind("_hasCheck").to(this,"hasCheckSpace",this,"isToggleable",(r,o)=>r||o)}render(){super.render(),this._hasCheck&&this.children.add(this._checkIconHolderView,0),this._watchCheckIconHolderMount()}_watchCheckIconHolderMount(){this._checkIconHolderView.bind("isOn").to(this,"isOn",e=>this.isToggleable&&e),this.on("change:_hasCheck",(e,t,i)=>{const{children:r,_checkIconHolderView:o}=this;i?r.add(o,0):r.remove(o)})}},CheckIconHolderView=class extends View{children;_checkIconView=this._createCheckIconView();constructor(){super();const e=this.bindTemplate;this.children=this.createCollection(),this.set("isOn",!1),this.setTemplate({tag:"span",children:this.children,attributes:{class:["ck","ck-list-item-button__check-holder",e.to("isOn",t=>t?"ck-on":"ck-off")]}})}render(){super.render(),this.isOn&&this.children.add(this._checkIconView,0),this._watchCheckIconMount()}_watchCheckIconMount(){this.on("change:isOn",(e,t,i)=>{const{children:r,_checkIconView:o}=this;i&&!r.has(o)?r.add(o):!i&&r.has(o)&&r.remove(o)})}_createCheckIconView(){const e=new IconView;return e.content=icons.check,e.extendTemplate({attributes:{class:"ck-list-item-button__check-icon"}}),e}},MenuBarMenuListItemButtonView=class extends ListItemButtonView{constructor(e){super(e),this.set({withText:!0,withKeystroke:!0,tooltip:!1,role:"menuitem"}),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item__button"]}})}},LabelView=class extends View{id;constructor(e){super(e),this.set("text",void 0),this.set("for",void 0),this.id=`ck-editor__label_${uid()}`;const t=this.bindTemplate;this.setTemplate({tag:"label",attributes:{class:["ck","ck-label"],id:this.id,for:t.to("for")},children:[{text:t.to("text")}]})}},AccessibilityHelpContentView=class extends View{constructor(e,t){super(e);const i=e.t,r=new LabelView;r.text=i("Help Contents. To close this dialog press ESC."),this.setTemplate({tag:"div",attributes:{class:["ck","ck-accessibility-help-dialog__content"],"aria-labelledby":r.id,role:"document",tabindex:-1},children:[createElement(document,"p",{},i("Below, you can find a list of keyboard shortcuts that can be used in the editor.")),...this._createCategories(Array.from(t.values())),r]})}focus(){this.element.focus()}_createCategories(e){return e.map(t=>{const i=[createElement(document,"h3",{},t.label),...Array.from(t.groups.values()).map(r=>this._createGroup(r)).flat()];return t.description&&i.splice(1,0,createElement(document,"p",{},t.description)),createElement(document,"section",{},i)})}_createGroup(e){const t=e.keystrokes.sort((r,o)=>r.label.localeCompare(o.label)).map(r=>this._createGroupRow(r)).flat(),i=[createElement(document,"dl",{},t)];return e.label&&i.unshift(createElement(document,"h4",{},e.label)),i}_createGroupRow(e){const t=this.locale.t,i=createElement(document,"dt"),r=createElement(document,"dd"),o=normalizeKeystrokeDefinition(e.keystroke),a=[];for(const c of o)a.push(c.map(keystrokeToEnvKbd).join(""));return i.innerHTML=e.label,r.innerHTML=a.join(", ")+(e.mayRequireFn&&env.isMac?` ${t("(may require <kbd>Fn</kbd>)")}`:""),[i,r]}};function keystrokeToEnvKbd(e){return getEnvKeystrokeText(e).split("+").map(t=>`<kbd>${t}</kbd>`).join("+")}function normalizeKeystrokeDefinition(e){return typeof e=="string"?[[e]]:typeof e[0]=="string"?[e]:e}var accessibilityIcon='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 6.628a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"/><path d="M8.5 9.125a.3.3 0 0 0-.253-.296L5.11 8.327a.75.75 0 1 1 .388-1.449l4.04.716c.267.072.624.08.893.009l4.066-.724a.75.75 0 1 1 .388 1.45l-3.132.5a.3.3 0 0 0-.253.296v1.357a.3.3 0 0 0 .018.102l1.615 4.438a.75.75 0 0 1-1.41.513l-1.35-3.71a.3.3 0 0 0-.281-.197h-.209a.3.3 0 0 0-.282.198l-1.35 3.711a.75.75 0 0 1-1.41-.513l1.64-4.509a.3.3 0 0 0 .019-.103V9.125Z"/><path clip-rule="evenodd" d="M10 18.5a8.5 8.5 0 1 1 0-17 8.5 8.5 0 0 1 0 17Zm0 1.5c5.523 0 10-4.477 10-10S15.523 0 10 0 0 4.477 0 10s4.477 10 10 10Z"/></svg>',AccessibilityHelp=class extends Plugin{contentView=null;static get requires(){return[Dialog]}static get pluginName(){return"AccessibilityHelp"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.locale.t;e.ui.componentFactory.add("accessibilityHelp",()=>{const i=this._createButton(ButtonView);return i.set({tooltip:!0,withText:!1,label:t("Accessibility help")}),i}),e.ui.componentFactory.add("menuBar:accessibilityHelp",()=>{const i=this._createButton(MenuBarMenuListItemButtonView);return i.label=t("Accessibility"),i}),e.keystrokes.set("Alt+0",(i,r)=>{this._toggleDialog(),r()}),this._setupRootLabels()}_createButton(e){const t=this.editor,i=t.plugins.get("Dialog"),r=t.locale,o=new e(r);return o.set({keystroke:"Alt+0",icon:accessibilityIcon,isToggleable:!0}),o.on("execute",()=>this._toggleDialog()),o.bind("isOn").to(i,"id",a=>a==="accessibilityHelp"),o}_setupRootLabels(){const e=this.editor,t=e.editing.view,i=e.t;e.ui.on("ready",()=>{t.change(o=>{for(const a of t.document.roots)r(o,a)}),e.on("addRoot",(o,a)=>{const c=e.editing.view.document.getRoot(a.rootName);t.change(u=>r(u,c))},{priority:"low"})});function r(o,a){const u=[a.getAttribute("aria-label"),i("Press %0 for help.",[getEnvKeystrokeText("Alt+0")])].filter(h=>h).join(". ");o.setAttribute("aria-label",u,a)}}_toggleDialog(){const e=this.editor,t=e.plugins.get("Dialog"),i=e.locale.t;this.contentView||(this.contentView=new AccessibilityHelpContentView(e.locale,e.accessibility.keystrokeInfos)),t.id==="accessibilityHelp"?t.hide():t.show({id:"accessibilityHelp",className:"ck-accessibility-help-dialog",title:i("Accessibility help"),icon:accessibilityIcon,hasCloseButton:!0,content:this.contentView})}},BodyCollection=class Bt extends ViewCollection{locale;_bodyCollectionContainer;static _bodyWrapper;constructor(t,i=[]){super(i),this.locale=t}get bodyCollectionContainer(){return this._bodyCollectionContainer}attachToDom(){this._bodyCollectionContainer=new Template({tag:"div",attributes:{class:["ck","ck-reset_all","ck-body","ck-rounded-corners"],dir:this.locale.uiLanguageDirection,role:"application"},children:this}).render(),(!Bt._bodyWrapper||!Bt._bodyWrapper.isConnected)&&(Bt._bodyWrapper=createElement(document,"div",{class:"ck-body-wrapper"}),document.body.appendChild(Bt._bodyWrapper)),Bt._bodyWrapper.appendChild(this._bodyCollectionContainer)}detachFromDom(){super.destroy(),this._bodyCollectionContainer&&this._bodyCollectionContainer.remove(),Bt._bodyWrapper&&!Bt._bodyWrapper.childElementCount&&(Bt._bodyWrapper.remove(),delete Bt._bodyWrapper)}},SwitchButtonView=class extends ButtonView{toggleSwitchView;constructor(e){super(e),this.isToggleable=!0,this.toggleSwitchView=this._createToggleView(),this.extendTemplate({attributes:{class:"ck-switchbutton"}})}render(){super.render(),this.children.add(this.toggleSwitchView)}_createToggleView(){const e=new View;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__toggle"]},children:[{tag:"span",attributes:{class:["ck","ck-button__toggle__inner"]}}]}),e}},FileDialogListItemButtonView=class extends FileDialogViewMixin(ListItemButtonView){};function FileDialogViewMixin(e){class t extends e{buttonView;_fileInputView;constructor(...r){super(...r),this.buttonView=this,this._fileInputView=new FileInputView(this.locale),this._fileInputView.bind("acceptedType").to(this),this._fileInputView.bind("allowMultipleFiles").to(this),this._fileInputView.delegate("done").to(this),this.on("execute",()=>{this._fileInputView.open()}),this.extendTemplate({attributes:{class:"ck-file-dialog-button"}})}render(){super.render(),this.children.add(this._fileInputView)}}return t}var FileInputView=class extends View{constructor(e){super(e),this.set("acceptedType",void 0),this.set("allowMultipleFiles",!1);const t=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck-hidden"],type:"file",tabindex:"-1",accept:t.to("acceptedType"),multiple:t.to("allowMultipleFiles")},on:{change:t.to(()=>{this.element&&this.element.files&&this.element.files.length&&this.fire("done",this.element.files),this.element.value=""})}})}open(){this.element.click()}},dropdownArrowIcon='<svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path d="M.941 4.523a.75.75 0 1 1 1.06-1.06l3.006 3.005 3.005-3.005a.75.75 0 1 1 1.06 1.06l-3.549 3.55a.75.75 0 0 1-1.168-.136L.941 4.523z"/></svg>';/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function getLocalizedColorOptions(e,t){const i=e.t,r={Black:i("Black"),"Dim grey":i("Dim grey"),Grey:i("Grey"),"Light grey":i("Light grey"),White:i("White"),Red:i("Red"),Orange:i("Orange"),Yellow:i("Yellow"),"Light green":i("Light green"),Green:i("Green"),Aquamarine:i("Aquamarine"),Turquoise:i("Turquoise"),"Light blue":i("Light blue"),Blue:i("Blue"),Purple:i("Purple")};return t.map(o=>{const a=r[o.label];return a&&a!=o.label&&(o.label=a),o})}function normalizeColorOptions(e){return e.map(normalizeSingleColorDefinition).filter(t=>!!t)}function normalizeSingleColorDefinition(e){return typeof e=="string"?{model:e,label:e,hasBorder:!1,view:{name:"span",styles:{color:e}}}:{model:e.color,label:e.label||e.color,hasBorder:e.hasBorder===void 0?!1:e.hasBorder,view:{name:"span",styles:{color:`${e.color}`}}}}var checkIcon='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M16.935 5.328a2 2 0 0 1 0 2.829l-7.778 7.778a2 2 0 0 1-2.829 0L3.5 13.107a1.999 1.999 0 1 1 2.828-2.829l.707.707a1 1 0 0 0 1.414 0l5.658-5.657a2 2 0 0 1 2.828 0z"/><path d="M14.814 6.035 8.448 12.4a1 1 0 0 1-1.414 0l-1.413-1.415A1 1 0 1 0 4.207 12.4l2.829 2.829a1 1 0 0 0 1.414 0l7.778-7.778a1 1 0 1 0-1.414-1.415z"/></svg>',ColorTileView=class extends ButtonView{constructor(e){super(e);const t=this.bindTemplate;this.set("color",void 0),this.set("hasBorder",!1),this.icon=checkIcon,this.extendTemplate({attributes:{style:{backgroundColor:t.to("color",i=>env.isMediaForcedColors?null:i)},class:["ck","ck-color-grid__tile",t.if("hasBorder","ck-color-selector__color-tile_bordered")]}})}render(){super.render(),this.iconView.fillColor="hsl(0, 0%, 100%)"}},ColorGridView=class extends View{columns;items;focusTracker;keystrokes;constructor(e,t){super(e);const i=t&&t.colorDefinitions?t.colorDefinitions:[];this.columns=t&&t.columns?t.columns:5;const r={gridTemplateColumns:`repeat( ${this.columns}, 1fr)`};this.set("selectedColor",void 0),this.items=this.createCollection(),this.focusTracker=new FocusTracker,this.keystrokes=new KeystrokeHandler,this.items.on("add",(o,a)=>{a.isOn=a.color===this.selectedColor}),i.forEach(o=>{const a=new ColorTileView;a.set({color:o.color,label:o.label,tooltip:!0,hasBorder:o.options.hasBorder}),a.on("execute",()=>{this.fire("execute",{value:o.color,hasBorder:o.options.hasBorder,label:o.label})}),this.items.add(a)}),this.setTemplate({tag:"div",children:this.items,attributes:{class:["ck","ck-color-grid"],style:r}}),this.on("change:selectedColor",(o,a,c)=>{for(const u of this.items)u.isOn=u.color===c})}focus(){this.items.length&&this.items.first.focus()}focusLast(){this.items.length&&this.items.last.focus()}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",(e,t)=>{this.focusTracker.add(t.element)}),this.items.on("remove",(e,t)=>{this.focusTracker.remove(t.element)}),this.keystrokes.listenTo(this.element),addKeyboardHandlingForGrid({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.items,numberOfColumns:this.columns,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}};/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function convertColor(e,t){if(!e)return"";const i=parseColorString(e);if(!i)return"";if(i.space===t)return e;if(!canConvertParsedColor(i))return"";const o=import_color_convert[i.space][t];if(!o)return"";const a=o(i.space==="hex"?i.hexValue:i.values);return formatColorOutput(a,t)}function convertToHex(e){if(!e)return"";const t=parseColorString(e);return t?t.space==="hex"?t.hexValue:convertColor(e,"hex"):"#000"}function registerCustomElement(e,t){customElements.get(e)===void 0&&customElements.define(e,t)}function formatColorOutput(e,t){switch(t){case"hex":return`#${e}`;case"rgb":return`rgb(${e[0]}, ${e[1]}, ${e[2]})`;case"hsl":return`hsl(${e[0]}, ${e[1]}%, ${e[2]}%)`;case"hwb":return`hwb(${e[0]}, ${e[1]}, ${e[2]})`;case"lab":return`lab(${e[0]}% ${e[1]} ${e[2]})`;case"lch":return`lch(${e[0]}% ${e[1]} ${e[2]})`;default:return""}}function parseColorString(e){if(e.startsWith("#")){const i=color_parse_default(e);return{space:"hex",values:i.values,hexValue:e,alpha:i.alpha}}const t=color_parse_default(e);return t.space?t:null}function canConvertParsedColor(e){return Object.keys(import_color_convert).includes(e.space)}var LabeledFieldView=class extends View{fieldView;labelView;statusView;fieldWrapperChildren;constructor(e,t){super(e);const i=`ck-labeled-field-view-${uid()}`,r=`ck-labeled-field-view-status-${uid()}`;this.fieldView=t(this,i,r),this.set("label",void 0),this.set("isEnabled",!0),this.set("isEmpty",!0),this.set("isFocused",!1),this.set("errorText",null),this.set("infoText",null),this.set("class",void 0),this.set("placeholder",void 0),this.labelView=this._createLabelView(i),this.statusView=this._createStatusView(r),this.fieldWrapperChildren=this.createCollection([this.fieldView,this.labelView]),this.bind("_statusText").to(this,"errorText",this,"infoText",(a,c)=>a||c);const o=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view",o.to("class"),o.if("isEnabled","ck-disabled",a=>!a),o.if("isEmpty","ck-labeled-field-view_empty"),o.if("isFocused","ck-labeled-field-view_focused"),o.if("placeholder","ck-labeled-field-view_placeholder"),o.if("errorText","ck-error")]},children:[{tag:"div",attributes:{class:["ck","ck-labeled-field-view__input-wrapper"]},children:this.fieldWrapperChildren},this.statusView]})}_createLabelView(e){const t=new LabelView(this.locale);return t.for=e,t.bind("text").to(this,"label"),t}_createStatusView(e){const t=new View(this.locale),i=this.bindTemplate;return t.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view__status",i.if("errorText","ck-labeled-field-view__status_error"),i.if("_statusText","ck-hidden",r=>!r)],id:e,role:i.if("errorText","alert")},children:[{text:i.to("_statusText")}]}),t}focus(e){this.fieldView.focus(e)}},InputBase=class extends View{focusTracker;constructor(e){super(e),this.set("value",void 0),this.set("id",void 0),this.set("placeholder",void 0),this.set("tabIndex",void 0),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("ariaDescribedById",void 0),this.set("ariaLabel",void 0),this.focusTracker=new FocusTracker,this.bind("isFocused").to(this.focusTracker),this.set("isEmpty",!0);const t=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck","ck-input",t.if("isFocused","ck-input_focused"),t.if("isEmpty","ck-input-text_empty"),t.if("hasError","ck-error")],id:t.to("id"),placeholder:t.to("placeholder"),tabindex:t.to("tabIndex"),readonly:t.to("isReadOnly"),"aria-invalid":t.if("hasError",!0),"aria-describedby":t.to("ariaDescribedById"),"aria-label":t.to("ariaLabel")},on:{input:t.to((...i)=>{this.fire("input",...i),this._updateIsEmpty()}),change:t.to(this._updateIsEmpty.bind(this))}})}render(){super.render(),this.focusTracker.add(this.element),this._setDomElementValue(this.value),this._updateIsEmpty(),this.on("change:value",(e,t,i)=>{this._setDomElementValue(i),this._updateIsEmpty()})}destroy(){super.destroy(),this.focusTracker.destroy()}select(){this.element.select()}focus(){this.element.focus()}reset(){this.value=this.element.value="",this._updateIsEmpty()}_updateIsEmpty(){this.isEmpty=isInputElementEmpty(this.element)}_setDomElementValue(e){this.element.value=!e&&e!==0?"":e}};function isInputElementEmpty(e){return!e.value}var InputView=class extends InputBase{constructor(e){super(e),this.set("inputMode","text");const t=this.bindTemplate;this.extendTemplate({attributes:{inputmode:t.to("inputMode")}})}},InputTextView=class extends InputView{constructor(e){super(e),this.extendTemplate({attributes:{type:"text",class:["ck-input-text"]}})}},DropdownPanelView=class extends View{children;constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-dropdown__panel",t.to("position",i=>`ck-dropdown__panel_${i}`),t.if("isVisible","ck-dropdown__panel-visible")],tabindex:"-1"},children:this.children,on:{selectstart:t.to(i=>{i.target.tagName.toLocaleLowerCase()!=="input"&&i.preventDefault()})}})}focus(){if(this.children.length){const e=this.children.first;typeof e.focus=="function"?e.focus():logWarning("ui-dropdown-panel-focus-child-missing-focus",{childView:this.children.first,dropdownPanel:this})}}focusLast(){if(this.children.length){const e=this.children.last;typeof e.focusLast=="function"?e.focusLast():e.focus()}}},DropdownView=class pr extends View{buttonView;panelView;focusTracker;keystrokes;listView;toolbarView;menuView;constructor(t,i,r){super(t);const o=this.bindTemplate;this.buttonView=i,this.panelView=r,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("class",void 0),this.set("id",void 0),this.set("panelPosition","auto"),this.panelView.bind("isVisible").to(this,"isOpen"),this.keystrokes=new KeystrokeHandler,this.focusTracker=new FocusTracker,this.setTemplate({tag:"div",attributes:{class:["ck","ck-dropdown",o.to("class"),o.if("isEnabled","ck-disabled",a=>!a)],id:o.to("id"),"aria-describedby":o.to("ariaDescribedById")},children:[i,r]}),i.extendTemplate({attributes:{class:["ck-dropdown__button"],"data-cke-tooltip-disabled":o.to("isOpen")}})}render(){super.render(),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.listenTo(this.buttonView,"open",()=>{this.isOpen=!this.isOpen}),this.on("change:isOpen",(i,r,o)=>{if(o)if(this.panelPosition==="auto"){const a=pr._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions});this.panelView.position=a?a.name:this._defaultPanelPositionName}else this.panelView.position=this.panelPosition}),this.keystrokes.listenTo(this.element);const t=(i,r)=>{this.isOpen&&(this.isOpen=!1,r())};this.keystrokes.set("arrowdown",(i,r)=>{this.buttonView.isEnabled&&!this.isOpen&&(this.isOpen=!0,r())}),this.keystrokes.set("arrowright",(i,r)=>{this.isOpen&&r()}),this.keystrokes.set("arrowleft",t),this.keystrokes.set("esc",t)}focus(){this.buttonView.focus()}get _panelPositions(){const{south:t,north:i,southEast:r,southWest:o,northEast:a,northWest:c,southMiddleEast:u,southMiddleWest:h,northMiddleEast:d,northMiddleWest:f}=pr.defaultPanelPositions;return this.locale.uiLanguageDirection!=="rtl"?[r,o,u,h,t,a,c,d,f,i]:[o,r,h,u,t,c,a,f,d,i]}get _defaultPanelPositionName(){return this.locale.uiLanguageDirection==="rtl"?"sw":"se"}static defaultPanelPositions={south:(t,i)=>({top:t.bottom,left:t.left-(i.width-t.width)/2,name:"s"}),southEast:t=>({top:t.bottom,left:t.left,name:"se"}),southWest:(t,i)=>({top:t.bottom,left:t.left-i.width+t.width,name:"sw"}),southMiddleEast:(t,i)=>({top:t.bottom,left:t.left-(i.width-t.width)/4,name:"sme"}),southMiddleWest:(t,i)=>({top:t.bottom,left:t.left-(i.width-t.width)*3/4,name:"smw"}),north:(t,i)=>({top:t.top-i.height,left:t.left-(i.width-t.width)/2,name:"n"}),northEast:(t,i)=>({top:t.top-i.height,left:t.left,name:"ne"}),northWest:(t,i)=>({top:t.top-i.height,left:t.left-i.width+t.width,name:"nw"}),northMiddleEast:(t,i)=>({top:t.top-i.height,left:t.left-(i.width-t.width)/4,name:"nme"}),northMiddleWest:(t,i)=>({top:t.top-i.height,left:t.left-(i.width-t.width)*3/4,name:"nmw"})};static _getOptimalPosition=getOptimalPosition},DropdownButtonView=class extends ButtonView{arrowView;constructor(e){super(e),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{"aria-haspopup":!0,"aria-expanded":this.bindTemplate.to("isOn",t=>String(t))}}),this.delegate("execute").to(this,"open")}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new IconView;return e.content=dropdownArrowIcon,e.extendTemplate({attributes:{class:"ck-dropdown__arrow"}}),e}},ListItemView=class extends View{children;constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!0),this.children=this.createCollection(),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__item",t.if("isVisible","ck-hidden",i=>!i)],role:"presentation"},children:this.children})}focus(){this.children.first&&this.children.first.focus()}},ListSeparatorView=class extends View{constructor(e){super(e),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__separator"]}})}},ListItemGroupView=class extends View{labelView;items;children;constructor(e,t=new LabelView){super(e);const i=this.bindTemplate,r=new ListView(e);this.set({label:"",isVisible:!0}),this.labelView=t,this.labelView.bind("text").to(this,"label"),this.children=this.createCollection(),this.children.addMany([this.labelView,r]),r.set({role:"group",ariaLabelledBy:t.id}),r.focusTracker.destroy(),r.keystrokes.destroy(),this.items=r.items,this.setTemplate({tag:"li",attributes:{role:"presentation",class:["ck","ck-list__group",i.if("isVisible","ck-hidden",o=>!o)]},children:this.children})}focus(){if(this.items){const e=this.items.find(t=>!(t instanceof ListSeparatorView));e&&e.focus()}}},ListView=class extends View{focusables;items;focusTracker;keystrokes;_focusCycler;_listItemGroupToChangeListeners=new WeakMap;constructor(e){super(e);const t=this.bindTemplate;this.focusables=new ViewCollection,this.items=this.createCollection(),this.focusTracker=new FocusTracker,this.keystrokes=new KeystrokeHandler,this._focusCycler=new FocusCycler({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this.set("ariaLabel",void 0),this.set("ariaLabelledBy",void 0),this.set("role",void 0),this.setTemplate({tag:"ul",attributes:{class:["ck","ck-reset","ck-list"],role:t.to("role"),"aria-label":t.to("ariaLabel"),"aria-labelledby":t.to("ariaLabelledBy")},children:this.items})}render(){super.render();for(const e of this.items)e instanceof ListItemGroupView?this._registerFocusableItemsGroup(e):e instanceof ListItemView&&this._registerFocusableListItem(e);this.items.on("change",(e,t)=>{for(const i of t.removed)i instanceof ListItemGroupView?this._deregisterFocusableItemsGroup(i):i instanceof ListItemView&&this._deregisterFocusableListItem(i);for(const i of Array.from(t.added).reverse())i instanceof ListItemGroupView?this._registerFocusableItemsGroup(i,t.index):this._registerFocusableListItem(i,t.index)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}focusFirst(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}_registerFocusableListItem(e,t){this.focusTracker.add(e.element),this.focusables.add(e,t)}_deregisterFocusableListItem(e){this.focusTracker.remove(e.element),this.focusables.remove(e)}_getOnGroupItemsChangeCallback(e){return(t,i)=>{for(const r of i.removed)this._deregisterFocusableListItem(r);for(const r of Array.from(i.added).reverse())this._registerFocusableListItem(r,this.items.getIndex(e)+i.index)}}_registerFocusableItemsGroup(e,t){Array.from(e.items).forEach((r,o)=>{const a=typeof t<"u"?t+o:void 0;this._registerFocusableListItem(r,a)});const i=this._getOnGroupItemsChangeCallback(e);this._listItemGroupToChangeListeners.set(e,i),e.items.on("change",i)}_deregisterFocusableItemsGroup(e){for(const t of e.items)this._deregisterFocusableListItem(t);e.items.off("change",this._listItemGroupToChangeListeners.get(e)),this._listItemGroupToChangeListeners.delete(e)}};const toPx$5=toUnit("px"),POSITION_OFF_SCREEN={top:-99999,left:-99999,name:"arrowless",config:{withArrow:!1}};var BalloonPanelView=class Cn extends View{content;_pinWhenIsVisibleCallback;_resizeObserver;constructor(t){super(t);const i=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("position","arrow_nw"),this.set("isVisible",!1),this.set("withArrow",!0),this.set("class",void 0),this._pinWhenIsVisibleCallback=null,this._resizeObserver=null,this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-panel",i.to("position",r=>`ck-balloon-panel_${r}`),i.if("isVisible","ck-balloon-panel_visible"),i.if("withArrow","ck-balloon-panel_with-arrow"),i.to("class")],style:{top:i.to("top",toPx$5),left:i.to("left",toPx$5)}},children:this.content})}destroy(){this.hide(),super.destroy()}show(){this.isVisible=!0}hide(){this.isVisible=!1}attachTo(t){const i=getDomElement(t.target);if(i&&!isVisible(i))return!1;this.show();const r=Cn.defaultPositions,o=Object.assign({},{element:this.element,positions:[r.southArrowNorth,r.southArrowNorthMiddleWest,r.southArrowNorthMiddleEast,r.southArrowNorthWest,r.southArrowNorthEast,r.northArrowSouth,r.northArrowSouthMiddleWest,r.northArrowSouthMiddleEast,r.northArrowSouthWest,r.northArrowSouthEast,r.viewportStickyNorth],limiter:global$1.document.body,fitInViewport:!0},t),a=Cn._getOptimalPosition(o)||POSITION_OFF_SCREEN,c=parseInt(a.left),u=parseInt(a.top),h=a.name,d=a.config||{},{withArrow:f=!0}=d;return this.top=u,this.left=c,this.position=h,this.withArrow=f,!0}pin(t){this.unpin(),this._startPinning(t)&&(this._pinWhenIsVisibleCallback=()=>{this.isVisible?this._startPinning(t):this._stopPinning()},this.listenTo(this,"change:isVisible",this._pinWhenIsVisibleCallback))}unpin(){this._pinWhenIsVisibleCallback&&(this._stopPinning(),this.stopListening(this,"change:isVisible",this._pinWhenIsVisibleCallback),this._pinWhenIsVisibleCallback=null,this.hide())}_startPinning(t){if(!this.attachTo(t))return!1;let i=getDomElement(t.target);const r=t.limiter?getDomElement(t.limiter):global$1.document.body;if(this.listenTo(global$1.document,"scroll",(o,a)=>{const c=a.target,u=i&&c.contains(i),h=r&&c.contains(r);(u||h||!i||!r)&&this.attachTo(t)},{useCapture:!0}),this.listenTo(global$1.window,"resize",()=>{this.attachTo(t)}),!this._resizeObserver&&(i&&isText(i)&&(i=i.parentElement),i)){const o=()=>{isVisible(i)||this.unpin()};this._resizeObserver=new ResizeObserver$1(i,o)}return!0}_stopPinning(){this.stopListening(global$1.document,"scroll"),this.stopListening(global$1.window,"resize"),this._resizeObserver&&(this._resizeObserver.destroy(),this._resizeObserver=null)}static generatePositions(t={}){const{sideOffset:i=Cn.arrowSideOffset,heightOffset:r=Cn.arrowHeightOffset,stickyVerticalOffset:o=Cn.stickyVerticalOffset,config:a}=t;return{northWestArrowSouthWest:(h,d)=>({top:c(h,d),left:h.left-i,name:"arrow_sw",...a&&{config:a}}),northWestArrowSouthMiddleWest:(h,d)=>({top:c(h,d),left:h.left-d.width*.25-i,name:"arrow_smw",...a&&{config:a}}),northWestArrowSouth:(h,d)=>({top:c(h,d),left:h.left-d.width/2,name:"arrow_s",...a&&{config:a}}),northWestArrowSouthMiddleEast:(h,d)=>({top:c(h,d),left:h.left-d.width*.75+i,name:"arrow_sme",...a&&{config:a}}),northWestArrowSouthEast:(h,d)=>({top:c(h,d),left:h.left-d.width+i,name:"arrow_se",...a&&{config:a}}),northArrowSouthWest:(h,d)=>({top:c(h,d),left:h.left+h.width/2-i,name:"arrow_sw",...a&&{config:a}}),northArrowSouthMiddleWest:(h,d)=>({top:c(h,d),left:h.left+h.width/2-d.width*.25-i,name:"arrow_smw",...a&&{config:a}}),northArrowSouth:(h,d)=>({top:c(h,d),left:h.left+h.width/2-d.width/2,name:"arrow_s",...a&&{config:a}}),northArrowSouthMiddleEast:(h,d)=>({top:c(h,d),left:h.left+h.width/2-d.width*.75+i,name:"arrow_sme",...a&&{config:a}}),northArrowSouthEast:(h,d)=>({top:c(h,d),left:h.left+h.width/2-d.width+i,name:"arrow_se",...a&&{config:a}}),northEastArrowSouthWest:(h,d)=>({top:c(h,d),left:h.right-i,name:"arrow_sw",...a&&{config:a}}),northEastArrowSouthMiddleWest:(h,d)=>({top:c(h,d),left:h.right-d.width*.25-i,name:"arrow_smw",...a&&{config:a}}),northEastArrowSouth:(h,d)=>({top:c(h,d),left:h.right-d.width/2,name:"arrow_s",...a&&{config:a}}),northEastArrowSouthMiddleEast:(h,d)=>({top:c(h,d),left:h.right-d.width*.75+i,name:"arrow_sme",...a&&{config:a}}),northEastArrowSouthEast:(h,d)=>({top:c(h,d),left:h.right-d.width+i,name:"arrow_se",...a&&{config:a}}),southWestArrowNorthWest:h=>({top:u(h),left:h.left-i,name:"arrow_nw",...a&&{config:a}}),southWestArrowNorthMiddleWest:(h,d)=>({top:u(h),left:h.left-d.width*.25-i,name:"arrow_nmw",...a&&{config:a}}),southWestArrowNorth:(h,d)=>({top:u(h),left:h.left-d.width/2,name:"arrow_n",...a&&{config:a}}),southWestArrowNorthMiddleEast:(h,d)=>({top:u(h),left:h.left-d.width*.75+i,name:"arrow_nme",...a&&{config:a}}),southWestArrowNorthEast:(h,d)=>({top:u(h),left:h.left-d.width+i,name:"arrow_ne",...a&&{config:a}}),southArrowNorthWest:h=>({top:u(h),left:h.left+h.width/2-i,name:"arrow_nw",...a&&{config:a}}),southArrowNorthMiddleWest:(h,d)=>({top:u(h),left:h.left+h.width/2-d.width*.25-i,name:"arrow_nmw",...a&&{config:a}}),southArrowNorth:(h,d)=>({top:u(h),left:h.left+h.width/2-d.width/2,name:"arrow_n",...a&&{config:a}}),southArrowNorthMiddleEast:(h,d)=>({top:u(h),left:h.left+h.width/2-d.width*.75+i,name:"arrow_nme",...a&&{config:a}}),southArrowNorthEast:(h,d)=>({top:u(h),left:h.left+h.width/2-d.width+i,name:"arrow_ne",...a&&{config:a}}),southEastArrowNorthWest:h=>({top:u(h),left:h.right-i,name:"arrow_nw",...a&&{config:a}}),southEastArrowNorthMiddleWest:(h,d)=>({top:u(h),left:h.right-d.width*.25-i,name:"arrow_nmw",...a&&{config:a}}),southEastArrowNorth:(h,d)=>({top:u(h),left:h.right-d.width/2,name:"arrow_n",...a&&{config:a}}),southEastArrowNorthMiddleEast:(h,d)=>({top:u(h),left:h.right-d.width*.75+i,name:"arrow_nme",...a&&{config:a}}),southEastArrowNorthEast:(h,d)=>({top:u(h),left:h.right-d.width+i,name:"arrow_ne",...a&&{config:a}}),westArrowEast:(h,d)=>({top:h.top+h.height/2-d.height/2,left:h.left-d.width-r,name:"arrow_e",...a&&{config:a}}),eastArrowWest:(h,d)=>({top:h.top+h.height/2-d.height/2,left:h.right+r,name:"arrow_w",...a&&{config:a}}),viewportStickyNorth:(h,d,f,m)=>{const g=m||f;return!h.getIntersection(g)||g.height-h.height>o?null:{top:g.top+o,left:h.left+h.width/2-d.width/2,name:"arrowless",config:{withArrow:!1,...a}}}};function c(h,d){return h.top-d.height-r}function u(h){return h.bottom+r}}static arrowSideOffset=25;static arrowHeightOffset=10;static stickyVerticalOffset=20;static _getOptimalPosition=getOptimalPosition;static defaultPositions=Cn.generatePositions()};function getDomElement(e){return isElement_default(e)?e:isRange(e)?e.commonAncestorContainer:typeof e=="function"?getDomElement(e()):null}var ToolbarSeparatorView=class extends View{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__separator"]}})}},ToolbarLineBreakView=class extends View{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__line-break"]}})}};/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function preventDefault(e){return e.bindTemplate.to(t=>{t.target===e.element&&t.preventDefault()})}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function normalizeToolbarConfig(e){if(Array.isArray(e))return{items:e,removeItems:[]};const t={items:[],removeItems:[]};return e?{...t,...e}:t}const NESTED_TOOLBAR_ICONS={alignLeft:icons.alignLeft,bold:icons.bold,importExport:icons.importExport,paragraph:icons.paragraph,plus:icons.plus,text:icons.text,threeVerticalDots:icons.threeVerticalDots,pilcrow:icons.pilcrow,dragIndicator:icons.dragIndicator};var ToolbarView=class extends View{options;items;focusTracker;keystrokes;itemsView;children;focusables;_focusCycler;_behavior;constructor(e,t){super(e);const i=this.bindTemplate,r=this.t;this.options=t||{},this.set("ariaLabel",r("Editor toolbar")),this.set("maxWidth","auto"),this.items=this.createCollection(),this.focusTracker=new FocusTracker,this.keystrokes=new KeystrokeHandler,this.set("class",void 0),this.set("isCompact",!1),this.itemsView=new ItemsView(e),this.children=this.createCollection(),this.children.add(this.itemsView),this.focusables=this.createCollection();const o=e.uiLanguageDirection==="rtl";this._focusCycler=new FocusCycler({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:[o?"arrowright":"arrowleft","arrowup"],focusNext:[o?"arrowleft":"arrowright","arrowdown"]}});const a=["ck","ck-toolbar",i.to("class"),i.if("isCompact","ck-toolbar_compact")];this.options.shouldGroupWhenFull&&this.options.isFloating&&a.push("ck-toolbar_floating"),this.setTemplate({tag:"div",attributes:{class:a,role:"toolbar","aria-label":i.to("ariaLabel"),style:{maxWidth:i.to("maxWidth")},tabindex:-1},children:this.children,on:{mousedown:preventDefault(this)}}),this._behavior=this.options.shouldGroupWhenFull?new DynamicGrouping(this):new StaticLayout(this)}render(){super.render(),this.focusTracker.add(this.element);for(const e of this.items)this.focusTracker.add(e);this.items.on("add",(e,t)=>{this.focusTracker.add(t)}),this.items.on("remove",(e,t)=>{this.focusTracker.remove(t)}),this.keystrokes.listenTo(this.element),this._behavior.render(this)}destroy(){return this._behavior.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy(),super.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}fillFromConfig(e,t,i){this.items.addMany(this._buildItemsFromConfig(e,t,i))}_buildItemsFromConfig(e,t,i){const r=normalizeToolbarConfig(e),o=i||r.removeItems;return this._cleanItemsConfiguration(r.items,t,o).map(c=>isObject_default(c)?this._createNestedToolbarDropdown(c,t,o):c==="|"?new ToolbarSeparatorView:c==="-"?new ToolbarLineBreakView:t.create(c)).filter(c=>!!c)}_cleanItemsConfiguration(e,t,i){const r=e.filter((o,a,c)=>o==="|"?!0:i.indexOf(o)!==-1?!1:o==="-"?this.options.shouldGroupWhenFull?(logWarning("toolbarview-line-break-ignored-when-grouping-items",c),!1):!0:!isObject_default(o)&&!t.has(o)?(logWarning("toolbarview-item-unavailable",{item:o}),!1):!0);return this._cleanSeparatorsAndLineBreaks(r)}_cleanSeparatorsAndLineBreaks(e){const t=a=>a!=="-"&&a!=="|",i=e.length,r=e.findIndex(t);if(r===-1)return[];const o=i-e.slice().reverse().findIndex(t);return e.slice(r,o).filter((a,c,u)=>t(a)?!0:!(c>0&&u[c-1]===a))}_createNestedToolbarDropdown(e,t,i){let{label:r,icon:o,items:a,tooltip:c=!0,withText:u=!1}=e;if(a=this._cleanItemsConfiguration(a,t,i),!a.length)return null;const h=this.locale,d=createDropdown(h);return r||logWarning("toolbarview-nested-toolbar-dropdown-missing-label",e),d.class="ck-toolbar__nested-toolbar-dropdown",d.buttonView.set({label:r,tooltip:c,withText:!!u}),o!==!1?d.buttonView.icon=NESTED_TOOLBAR_ICONS[o]||o||icons.threeVerticalDots:d.buttonView.withText=!0,addToolbarToDropdown(d,()=>d.toolbarView._buildItemsFromConfig(a,t,i)),d}},ItemsView=class extends View{children;constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar__items"]},children:this.children})}},StaticLayout=class{constructor(e){const t=e.bindTemplate;e.set("isVertical",!1),e.itemsView.children.bindTo(e.items).using(i=>i),e.focusables.bindTo(e.items).using(i=>isFocusable(i)?i:null),e.extendTemplate({attributes:{class:[t.if("isVertical","ck-toolbar_vertical")]}})}render(){}destroy(){}},DynamicGrouping=class{view;viewChildren;viewFocusables;viewItemsView;viewFocusTracker;viewLocale;ungroupedItems;groupedItems;groupedItemsDropdown;resizeObserver=null;cachedPadding=null;shouldUpdateGroupingOnNextResize=!1;viewElement;constructor(e){this.view=e,this.viewChildren=e.children,this.viewFocusables=e.focusables,this.viewItemsView=e.itemsView,this.viewFocusTracker=e.focusTracker,this.viewLocale=e.locale,this.ungroupedItems=e.createCollection(),this.groupedItems=e.createCollection(),this.groupedItemsDropdown=this._createGroupedItemsDropdown(),e.itemsView.children.bindTo(this.ungroupedItems).using(t=>t),this.ungroupedItems.on("change",this._updateFocusCyclableItems.bind(this)),e.children.on("change",this._updateFocusCyclableItems.bind(this)),e.items.on("change",(t,i)=>{const r=i.index,o=Array.from(i.added);for(const a of i.removed)r>=this.ungroupedItems.length?this.groupedItems.remove(a):this.ungroupedItems.remove(a);for(let a=r;a<r+o.length;a++){const c=o[a-r];a>this.ungroupedItems.length?this.groupedItems.add(c,a-this.ungroupedItems.length):this.ungroupedItems.add(c,a)}this._updateGrouping()}),e.extendTemplate({attributes:{class:["ck-toolbar_grouping"]}})}render(e){this.viewElement=e.element,this._enableGroupingOnResize(),this._enableGroupingOnMaxWidthChange(e)}destroy(){this.groupedItemsDropdown.destroy(),this.resizeObserver.destroy()}_updateGrouping(){if(!this.viewElement.ownerDocument.body.contains(this.viewElement))return;if(!isVisible(this.viewElement)){this.shouldUpdateGroupingOnNextResize=!0;return}const e=this.groupedItems.length;let t;for(;this._areItemsOverflowing;)this._groupLastItem(),t=!0;if(!t&&this.groupedItems.length){for(;this.groupedItems.length&&!this._areItemsOverflowing;)this._ungroupFirstItem();this._areItemsOverflowing&&this._groupLastItem()}this.groupedItems.length!==e&&this.view.fire("groupedItemsUpdate")}get _areItemsOverflowing(){if(!this.ungroupedItems.length)return!1;const e=this.viewElement,t=this.viewLocale.uiLanguageDirection,i=new Rect(e.lastChild),r=new Rect(e);if(!this.cachedPadding){const o=global$1.window.getComputedStyle(e),a=t==="ltr"?"paddingRight":"paddingLeft";this.cachedPadding=Number.parseInt(o[a])}return t==="ltr"?i.right>r.right-this.cachedPadding:i.left<r.left+this.cachedPadding}_enableGroupingOnResize(){let e;this.resizeObserver=new ResizeObserver$1(this.viewElement,t=>{(!e||e!==t.contentRect.width||this.shouldUpdateGroupingOnNextResize)&&(this.shouldUpdateGroupingOnNextResize=!1,this._updateGrouping(),e=t.contentRect.width)}),this._updateGrouping()}_enableGroupingOnMaxWidthChange(e){e.on("change:maxWidth",()=>{this._updateGrouping()})}_groupLastItem(){this.groupedItems.length||(this.viewChildren.add(new ToolbarSeparatorView),this.viewChildren.add(this.groupedItemsDropdown),this.viewFocusTracker.add(this.groupedItemsDropdown.element)),this.groupedItems.add(this.ungroupedItems.remove(this.ungroupedItems.last),0)}_ungroupFirstItem(){this.ungroupedItems.add(this.groupedItems.remove(this.groupedItems.first)),this.groupedItems.length||(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last),this.viewFocusTracker.remove(this.groupedItemsDropdown.element))}_createGroupedItemsDropdown(){const e=this.viewLocale,t=e.t,i=createDropdown(e);return i.class="ck-toolbar__grouped-dropdown",i.panelPosition=e.uiLanguageDirection==="ltr"?"sw":"se",addToolbarToDropdown(i,this.groupedItems),i.buttonView.set({label:t("Show more items"),tooltip:!0,tooltipPosition:e.uiLanguageDirection==="rtl"?"se":"sw",icon:icons.threeVerticalDots}),i}_updateFocusCyclableItems(){this.viewFocusables.clear(),this.ungroupedItems.map(e=>{isFocusable(e)&&this.viewFocusables.add(e)}),this.groupedItems.length&&this.viewFocusables.add(this.groupedItemsDropdown)}},SplitButtonView=class extends View{children;actionView;arrowView;keystrokes;focusTracker;constructor(e,t){super(e);const i=this.bindTemplate;this.set("class",void 0),this.set("labelStyle",void 0),this.set("icon",void 0),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isToggleable",!1),this.set("isVisible",!0),this.set("keystroke",void 0),this.set("withKeystroke",!1),this.set("label",void 0),this.set("tabindex",-1),this.set("tooltip",!1),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.children=this.createCollection(),this.actionView=this._createActionView(t),this.arrowView=this._createArrowView(),this.keystrokes=new KeystrokeHandler,this.focusTracker=new FocusTracker,this.setTemplate({tag:"div",attributes:{class:["ck","ck-splitbutton",i.to("class"),i.if("isVisible","ck-hidden",r=>!r),this.arrowView.bindTemplate.if("isOn","ck-splitbutton_open")]},children:this.children})}render(){super.render(),this.children.add(this.actionView),this.children.add(this.arrowView),this.focusTracker.add(this.actionView.element),this.focusTracker.add(this.arrowView.element),this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",(e,t)=>{this.focusTracker.focusedElement===this.actionView.element&&(this.arrowView.focus(),t())}),this.keystrokes.set("arrowleft",(e,t)=>{this.focusTracker.focusedElement===this.arrowView.element&&(this.actionView.focus(),t())})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this.actionView.focus()}_createActionView(e){const t=e||new ButtonView;return e||t.bind("icon","isEnabled","isOn","isToggleable","keystroke","label","tabindex","tooltip","tooltipPosition","type","withText").to(this),t.extendTemplate({attributes:{class:"ck-splitbutton__action"}}),t.delegate("execute").to(this),t}_createArrowView(){const e=new ButtonView,t=e.bindTemplate;return e.icon=dropdownArrowIcon,e.extendTemplate({attributes:{class:["ck-splitbutton__arrow"],"data-cke-tooltip-disabled":t.to("isOn"),"aria-haspopup":!0,"aria-expanded":t.to("isOn",i=>String(i))}}),e.bind("isEnabled").to(this),e.bind("label").to(this),e.bind("tooltip").to(this),e.delegate("execute").to(this,"open"),e}};function createDropdown(e,t=DropdownButtonView){const i=typeof t=="function"?new t(e):t,r=new DropdownPanelView(e),o=new DropdownView(e,i,r);return i.bind("isEnabled").to(o),i instanceof SplitButtonView?i.arrowView.bind("isOn").to(o,"isOpen"):i.bind("isOn").to(o,"isOpen"),addDefaultBehaviors(o),o}function addToolbarToDropdown(e,t,i={}){e.extendTemplate({attributes:{class:["ck-toolbar-dropdown"]}}),e.isOpen?addToolbarToOpenDropdown(e,t,i):e.once("change:isOpen",()=>addToolbarToOpenDropdown(e,t,i),{priority:"highest"}),i.enableActiveItemFocusOnDropdownOpen&&focusChildOnDropdownOpen(e,()=>e.toolbarView.items.find(r=>r.isOn))}function addToolbarToOpenDropdown(e,t,i){const r=e.locale,o=r.t,a=e.toolbarView=new ToolbarView(r),c=typeof t=="function"?t():t;a.ariaLabel=i.ariaLabel||o("Dropdown toolbar"),i.maxWidth&&(a.maxWidth=i.maxWidth),i.class&&(a.class=i.class),i.isCompact&&(a.isCompact=i.isCompact),i.isVertical&&(a.isVertical=!0),c instanceof ViewCollection?a.items.bindTo(c).using(u=>u):a.items.addMany(c),e.panelView.children.add(a),e.focusTracker.add(a),a.items.delegate("execute").to(e)}function addListToDropdown(e,t,i={}){e.isOpen?addListToOpenDropdown(e,t,i):e.once("change:isOpen",()=>addListToOpenDropdown(e,t,i),{priority:"highest"}),focusChildOnDropdownOpen(e,()=>e.listView.items.find(r=>r instanceof ListItemView?r.children.first.isOn:!1))}function addListToOpenDropdown(e,t,i){const r=e.locale,o=e.listView=new ListView(r),a=typeof t=="function"?t():t;o.ariaLabel=i.ariaLabel,o.role=i.role,bindViewCollectionItemsToDefinitions(e,o.items,a,r),e.panelView.children.add(o),o.items.delegate("execute").to(e)}function focusChildOnDropdownOpen(e,t){e.on("change:isOpen",()=>{if(!e.isOpen)return;const i=t();i&&(typeof i.focus=="function"?i.focus():logWarning("ui-dropdown-focus-child-on-open-child-missing-focus",{view:i}))},{priority:priorities.low-10})}function addDefaultBehaviors(e){closeDropdownOnClickOutside(e),closeDropdownOnExecute(e),closeDropdownOnBlur(e),focusDropdownContentsOnArrows(e),focusDropdownButtonOnClose(e),focusDropdownPanelOnOpen(e)}function closeDropdownOnClickOutside(e){clickOutsideHandler({emitter:e,activator:()=>e.isRendered&&e.isOpen,callback:()=>{e.isOpen=!1},contextElements:()=>[e.element,...getFocusTrackerTreeElements(e.focusTracker).filter(t=>!e.element.contains(t))]})}function getFocusTrackerTreeElements(e){return[...e.elements,...e.externalViews.flatMap(t=>getFocusTrackerTreeElements(t.focusTracker))]}function closeDropdownOnExecute(e){e.on("execute",t=>{t.source instanceof SwitchButtonView||(e.isOpen=!1)})}function closeDropdownOnBlur(e){e.focusTracker.on("change:isFocused",(t,i,r)=>{r||!e.isOpen||(e.isOpen=!1)})}function focusDropdownContentsOnArrows(e){e.keystrokes.set("arrowdown",(t,i)=>{e.isOpen&&(e.panelView.focus(),i())}),e.keystrokes.set("arrowup",(t,i)=>{e.isOpen&&(e.panelView.focusLast(),i())})}function focusDropdownButtonOnClose(e){e.on("change:isOpen",(t,i,r)=>{if(r)return;e.focusTracker.elements.some(a=>a.contains(global$1.document.activeElement))&&e.buttonView.focus()})}function focusDropdownPanelOnOpen(e){e.on("change:isOpen",(t,i,r)=>{r&&e.panelView.focus()},{priority:"low"})}function bindViewCollectionItemsToDefinitions(e,t,i,r){t.on("change",()=>{const o=[...t].reduce((c,u)=>(u instanceof ListItemView&&u.children.first instanceof ListItemButtonView&&c.push(u.children.first),c),[]),a=o.some(c=>c.isToggleable);o.forEach(c=>{c.hasCheckSpace=a})}),t.bindTo(i).using(o=>{if(o.type==="separator")return new ListSeparatorView(r);if(o.type==="group"){const a=new ListItemGroupView(r);return a.set({label:o.label}),bindViewCollectionItemsToDefinitions(e,a.items,o.items,r),a.items.delegate("execute").to(e),a}else if(o.type==="button"||o.type==="switchbutton"){const a=o.model.role==="menuitemcheckbox"||o.model.role==="menuitemradio",c=new ListItemView(r);let u;return o.type==="button"?(u=new ListItemButtonView(r),u.set({isToggleable:a})):u=new SwitchButtonView(r),u.bind(...Object.keys(o.model)).to(o.model),u.delegate("execute").to(c),c.children.add(u),c}return null})}const createLabeledInputText=(e,t,i)=>{const r=new InputTextView(e.locale);return r.set({id:t,ariaDescribedById:i}),r.bind("isReadOnly").to(e,"isEnabled",o=>!o),r.bind("hasError").to(e,"errorText",o=>!!o),r.on("input",()=>{e.errorText=null}),e.bind("isEmpty","isFocused","placeholder").to(r),r},waitingTime=150;var ColorPickerView=class extends View{hexInputRow;_debounceColorPickerEvent;_config;constructor(e,t={}){super(e),this.set({color:"",_hexColor:""}),this.hexInputRow=this._createInputRow();const i=this.createCollection();t.hideInput||i.add(this.hexInputRow),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker"],tabindex:-1},children:i}),this._config=t,this._debounceColorPickerEvent=debounce_default(r=>{this.set("color",r),this.fire("colorSelected",{color:this.color})},waitingTime,{leading:!0}),this.on("set:color",(r,o,a)=>{r.return=convertColor(a,this._config.format||"hsl")}),this.on("change:color",()=>{this._hexColor=convertColorToCommonHexFormat(this.color)}),this.on("change:_hexColor",()=>{document.activeElement!==this.picker&&this.picker.setAttribute("color",this._hexColor),convertColorToCommonHexFormat(this.color)!=convertColorToCommonHexFormat(this._hexColor)&&(this.color=this._hexColor)})}render(){if(super.render(),registerCustomElement("hex-color-picker",HexBase),this.picker=global$1.document.createElement("hex-color-picker"),this.picker.setAttribute("class","hex-color-picker"),this.picker.setAttribute("tabindex","-1"),this._createSlidersView(),this.element){this.hexInputRow.element?this.element.insertBefore(this.picker,this.hexInputRow.element):this.element.appendChild(this.picker);const e=document.createElement("style");e.textContent='[role="slider"]:focus [part$="pointer"] {border: 1px solid #fff;outline: 1px solid var(--ck-color-focus-border);box-shadow: 0 0 0 2px #fff;}',this.picker.shadowRoot.appendChild(e)}this.picker.addEventListener("color-changed",e=>{const t=e.detail.value;this._debounceColorPickerEvent(t)})}focus(){/* istanbul ignore next -- @preserve */!this._config.hideInput&&(env.isGecko||env.isiOS||env.isSafari)&&this.hexInputRow.children.get(1).focus(),this.slidersView.first.focus()}_createSlidersView(){const i=[...this.picker.shadowRoot.children].filter(r=>r.getAttribute("role")==="slider").map(r=>new SliderView(r));this.slidersView=this.createCollection(),i.forEach(r=>{this.slidersView.add(r)})}_createInputRow(){const e=this._createColorInput();return new ColorPickerInputRowView(this.locale,e)}_createColorInput(){const e=new LabeledFieldView(this.locale,createLabeledInputText),{t}=this.locale;return e.set({label:t("HEX"),class:"color-picker-hex-input"}),e.fieldView.bind("value").to(this,"_hexColor",i=>e.isFocused?e.fieldView.value:i.startsWith("#")?i.substring(1):i),e.fieldView.on("input",()=>{const i=e.fieldView.element.value;if(i){const r=tryParseHexColor(i);r&&this._debounceColorPickerEvent(r)}}),e}isValid(){const{t:e}=this.locale;return this._config.hideInput?!0:(this.resetValidationStatus(),this.hexInputRow.getParsedColor()?!0:(this.hexInputRow.inputView.errorText=e('Please enter a valid color (e.g. "ff0000").'),!1))}resetValidationStatus(){this.hexInputRow.inputView.errorText=null}};function convertColorToCommonHexFormat(e){let t=convertToHex(e);return t||(t="#000"),t.length===4&&(t="#"+[t[1],t[1],t[2],t[2],t[3],t[3]].join("")),t.toLowerCase()}var SliderView=class extends View{constructor(e){super(),this.element=e}focus(){this.element.focus()}},HashView=class extends View{constructor(e){super(e),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker__hash-view"]},children:"#"})}},ColorPickerInputRowView=class extends View{children;inputView;constructor(e,t){super(e),this.inputView=t,this.children=this.createCollection([new HashView,this.inputView]),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker__row"]},children:this.children})}getParsedColor(){return tryParseHexColor(this.inputView.fieldView.element.value)}};function tryParseHexColor(e){if(!e)return null;const t=e.trim().replace(/^#/,"");return![3,4,6,8].includes(t.length)||!/^(([0-9a-fA-F]{2}){3,4}|([0-9a-fA-F]){3,4})$/.test(t)?null:`#${t}`}var DocumentColorCollection=class extends ObservableMixin(Collection){constructor(e){super(e),this.set("isEmpty",!0),this.on("change",()=>{this.set("isEmpty",this.length===0)})}add(e,t){return this.find(i=>i.color===e.color)?this:super.add(e,t)}hasColor(e){return!!this.find(t=>t.color===e)}},ColorGridsFragmentView=class extends View{items;colorDefinitions;focusTracker;columns;documentColors;documentColorsCount;staticColorsGrid;documentColorsGrid;colorPickerButtonView;removeColorButtonView;_focusables;_documentColorsLabel;_removeButtonLabel;_colorPickerLabel;constructor(e,{colors:t,columns:i,removeButtonLabel:r,documentColorsLabel:o,documentColorsCount:a,colorPickerLabel:c,focusTracker:u,focusables:h}){super(e);const d=this.bindTemplate;this.set("isVisible",!0),this.focusTracker=u,this.items=this.createCollection(),this.colorDefinitions=t,this.columns=i,this.documentColors=new DocumentColorCollection,this.documentColorsCount=a,this._focusables=h,this._removeButtonLabel=r,this._colorPickerLabel=c,this._documentColorsLabel=o,this.setTemplate({tag:"div",attributes:{class:["ck-color-grids-fragment",d.if("isVisible","ck-hidden",f=>!f)]},children:this.items}),this.removeColorButtonView=this._createRemoveColorButton(),this.items.add(this.removeColorButtonView)}updateDocumentColors(e,t){const i=e.document,r=this.documentColorsCount;this.documentColors.clear();for(const o of i.getRoots()){const a=e.createRangeIn(o);for(const c of a.getItems())if(c.is("$textProxy")&&c.hasAttribute(t)&&(this._addColorToDocumentColors(c.getAttribute(t)),this.documentColors.length>=r))return}}updateSelectedColors(){const e=this.documentColorsGrid,t=this.staticColorsGrid,i=this.selectedColor;t.selectedColor=i,e&&(e.selectedColor=i)}render(){if(super.render(),this.staticColorsGrid=this._createStaticColorsGrid(),this.items.add(this.staticColorsGrid),this.documentColorsCount){const e=Template.bind(this.documentColors,this.documentColors),t=new View(this.locale);t.setTemplate({tag:"span",attributes:{class:["ck","ck-color-grid__label",e.if("isEmpty","ck-hidden")]},children:[{text:this._documentColorsLabel}]}),this.items.add(t),this.documentColorsGrid=this._createDocumentColorsGrid(),this.items.add(this.documentColorsGrid)}this._createColorPickerButton(),this._addColorSelectorElementsToFocusTracker()}focus(){this.removeColorButtonView.focus()}destroy(){super.destroy()}addColorPickerButton(){this.colorPickerButtonView&&(this.items.add(this.colorPickerButtonView),this.focusTracker.add(this.colorPickerButtonView.element),this._focusables.add(this.colorPickerButtonView))}_addColorSelectorElementsToFocusTracker(){this.focusTracker.add(this.removeColorButtonView.element),this._focusables.add(this.removeColorButtonView),this.staticColorsGrid&&(this.focusTracker.add(this.staticColorsGrid.element),this._focusables.add(this.staticColorsGrid)),this.documentColorsGrid&&(this.focusTracker.add(this.documentColorsGrid.element),this._focusables.add(this.documentColorsGrid))}_createColorPickerButton(){this.colorPickerButtonView=new ButtonView,this.colorPickerButtonView.set({label:this._colorPickerLabel,withText:!0,icon:icons.colorPalette,class:"ck-color-selector__color-picker"}),this.colorPickerButtonView.on("execute",()=>{this.fire("colorPicker:show")})}_createRemoveColorButton(){const e=new ButtonView;return e.set({withText:!0,icon:icons.eraser,label:this._removeButtonLabel}),e.class="ck-color-selector__remove-color",e.on("execute",()=>{this.fire("execute",{value:null,source:"removeColorButton"})}),e.render(),e}_createStaticColorsGrid(){const e=new ColorGridView(this.locale,{colorDefinitions:this.colorDefinitions,columns:this.columns});return e.on("execute",(t,i)=>{this.fire("execute",{value:i.value,source:"staticColorsGrid"})}),e}_createDocumentColorsGrid(){const e=Template.bind(this.documentColors,this.documentColors),t=new ColorGridView(this.locale,{columns:this.columns});return t.extendTemplate({attributes:{class:e.if("isEmpty","ck-hidden")}}),t.items.bindTo(this.documentColors).using(i=>{const r=new ColorTileView;return r.set({color:i.color,hasBorder:i.options&&i.options.hasBorder}),i.label&&r.set({label:i.label,tooltip:!0}),r.on("execute",()=>{this.fire("execute",{value:i.color,source:"documentColorsGrid"})}),r}),this.documentColors.on("change:isEmpty",(i,r,o)=>{o&&(t.selectedColor=null)}),t}_addColorToDocumentColors(e){const t=this.colorDefinitions.find(i=>i.color===e);t?this.documentColors.add(Object.assign({},t)):this.documentColors.add({color:e,label:e,options:{hasBorder:!1}})}},ColorPickerFragmentView=class extends View{items;colorPickerView;saveButtonView;cancelButtonView;actionBarView;focusTracker;keystrokes;_focusables;_colorPickerViewConfig;constructor(e,{focusTracker:t,focusables:i,keystrokes:r,colorPickerViewConfig:o}){super(e),this.items=this.createCollection(),this.focusTracker=t,this.keystrokes=r,this.set("isVisible",!1),this.set("selectedColor",void 0),this._focusables=i,this._colorPickerViewConfig=o;const a=this.bindTemplate,{saveButtonView:c,cancelButtonView:u}=this._createActionButtons();this.saveButtonView=c,this.cancelButtonView=u,this.actionBarView=this._createActionBarView({saveButtonView:c,cancelButtonView:u}),this.setTemplate({tag:"div",attributes:{class:["ck-color-picker-fragment",a.if("isVisible","ck-hidden",h=>!h)]},children:this.items})}render(){super.render();const e=new ColorPickerView(this.locale,{...this._colorPickerViewConfig});this.colorPickerView=e,this.colorPickerView.render(),this.selectedColor&&(e.color=this.selectedColor),this.listenTo(this,"change:selectedColor",(t,i,r)=>{e.color=r}),this.items.add(this.colorPickerView),this.items.add(this.actionBarView),this._addColorPickersElementsToFocusTracker(),this._stopPropagationOnArrowsKeys(),this._executeOnEnterPress(),this._executeUponColorChange()}destroy(){super.destroy()}focus(){this.colorPickerView.focus()}resetValidationStatus(){this.colorPickerView.resetValidationStatus()}_executeOnEnterPress(){this.keystrokes.set("enter",e=>{this.isVisible&&this.focusTracker.focusedElement!==this.cancelButtonView.element&&this.colorPickerView.isValid()&&(this.fire("execute",{value:this.selectedColor}),e.stopPropagation(),e.preventDefault())})}_stopPropagationOnArrowsKeys(){const e=t=>t.stopPropagation();this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e)}_addColorPickersElementsToFocusTracker(){for(const t of this.colorPickerView.slidersView)this.focusTracker.add(t.element),this._focusables.add(t);const e=this.colorPickerView.hexInputRow.children.get(1);e.element&&(this.focusTracker.add(e.element),this._focusables.add(e)),this.focusTracker.add(this.saveButtonView.element),this._focusables.add(this.saveButtonView),this.focusTracker.add(this.cancelButtonView.element),this._focusables.add(this.cancelButtonView)}_createActionBarView({saveButtonView:e,cancelButtonView:t}){const i=new View,r=this.createCollection();return r.add(e),r.add(t),i.setTemplate({tag:"div",attributes:{class:["ck","ck-color-selector_action-bar"]},children:r}),i}_createActionButtons(){const e=this.locale,t=e.t,i=new ButtonView(e),r=new ButtonView(e);return i.set({icon:icons.check,class:"ck-button-save",type:"button",withText:!1,label:t("Accept")}),r.set({icon:icons.cancel,class:"ck-button-cancel",type:"button",withText:!1,label:t("Cancel")}),i.on("execute",()=>{this.colorPickerView.isValid()&&this.fire("execute",{source:"colorPickerSaveButton",value:this.selectedColor})}),r.on("execute",()=>{this.fire("colorPicker:cancel")}),{saveButtonView:i,cancelButtonView:r}}_executeUponColorChange(){this.colorPickerView.on("colorSelected",(e,t)=>{this.fire("execute",{value:t.color,source:"colorPicker"}),this.set("selectedColor",t.color)})}},ColorSelectorView=class extends View{focusTracker;keystrokes;items;colorGridsFragmentView;colorPickerFragmentView;_focusCycler;_focusables;_colorPickerViewConfig;constructor(e,{colors:t,columns:i,removeButtonLabel:r,documentColorsLabel:o,documentColorsCount:a,colorPickerLabel:c,colorPickerViewConfig:u}){super(e),this.items=this.createCollection(),this.focusTracker=new FocusTracker,this.keystrokes=new KeystrokeHandler,this._focusables=new ViewCollection,this._colorPickerViewConfig=u,this._focusCycler=new FocusCycler({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.colorGridsFragmentView=new ColorGridsFragmentView(e,{colors:t,columns:i,removeButtonLabel:r,documentColorsLabel:o,documentColorsCount:a,colorPickerLabel:c,focusTracker:this.focusTracker,focusables:this._focusables}),this.colorPickerFragmentView=new ColorPickerFragmentView(e,{focusables:this._focusables,focusTracker:this.focusTracker,keystrokes:this.keystrokes,colorPickerViewConfig:u}),this.set("_isColorGridsFragmentVisible",!0),this.set("_isColorPickerFragmentVisible",!1),this.set("selectedColor",void 0),this.colorGridsFragmentView.bind("isVisible").to(this,"_isColorGridsFragmentVisible"),this.colorPickerFragmentView.bind("isVisible").to(this,"_isColorPickerFragmentVisible"),this.on("change:selectedColor",(h,d,f)=>{this.colorGridsFragmentView.set("selectedColor",f),this.colorPickerFragmentView.set("selectedColor",f)}),this.colorGridsFragmentView.on("change:selectedColor",(h,d,f)=>{this.set("selectedColor",f)}),this.colorPickerFragmentView.on("change:selectedColor",(h,d,f)=>{this.set("selectedColor",f)}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-selector"]},children:this.items})}render(){super.render(),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}appendUI(){this._appendColorGridsFragment(),this._colorPickerViewConfig&&this._appendColorPickerFragment()}showColorPickerFragment(){!this.colorPickerFragmentView.colorPickerView||this._isColorPickerFragmentVisible||(this._isColorPickerFragmentVisible=!0,this.colorPickerFragmentView.focus(),this.colorPickerFragmentView.resetValidationStatus(),this._isColorGridsFragmentVisible=!1)}showColorGridsFragment(){this._isColorGridsFragmentVisible||(this._isColorGridsFragmentVisible=!0,this.colorGridsFragmentView.focus(),this._isColorPickerFragmentVisible=!1)}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}updateDocumentColors(e,t){this.colorGridsFragmentView.updateDocumentColors(e,t)}updateSelectedColors(){this.colorGridsFragmentView.updateSelectedColors()}_appendColorGridsFragment(){this.items.length||(this.items.add(this.colorGridsFragmentView),this.colorGridsFragmentView.delegate("execute").to(this),this.colorGridsFragmentView.delegate("colorPicker:show").to(this))}_appendColorPickerFragment(){this.items.length!==2&&(this.items.add(this.colorPickerFragmentView),this.colorGridsFragmentView.colorPickerButtonView&&this.colorGridsFragmentView.colorPickerButtonView.on("execute",()=>{this.showColorPickerFragment()}),this.colorGridsFragmentView.addColorPickerButton(),this.colorPickerFragmentView.delegate("execute").to(this),this.colorPickerFragmentView.delegate("colorPicker:cancel").to(this))}},ComponentFactory=class{editor;_components=new Map;constructor(e){this.editor=e}*names(){for(const e of this._components.values())yield e.originalName}add(e,t){this._components.set(getNormalized(e),{callback:t,originalName:e})}create(e){if(!this.has(e))throw new CKEditorError("componentfactory-item-missing",this,{name:e});return this._components.get(getNormalized(e)).callback(this.editor.locale)}has(e){return this._components.has(getNormalized(e))}};function getNormalized(e){return String(e).toLowerCase()}const BALLOON_CLASS="ck-tooltip";var TooltipManager=class kt extends DomEmitterMixin(){tooltipTextView;balloonPanelView;static defaultBalloonPositions=BalloonPanelView.generatePositions({heightOffset:5,sideOffset:13});_currentElementWithTooltip=null;_currentTooltipPosition=null;_mutationObserver=null;_pinTooltipDebounced;_unpinTooltipDebounced;_watchdogExcluded;static _editors=new Set;static _instance=null;constructor(t){if(super(),kt._editors.add(t),kt._instance)return kt._instance;kt._instance=this,this.tooltipTextView=new View(t.locale),this.tooltipTextView.set("text",""),this.tooltipTextView.setTemplate({tag:"span",attributes:{class:["ck","ck-tooltip__text"]},children:[{text:this.tooltipTextView.bindTemplate.to("text")}]}),this.balloonPanelView=new BalloonPanelView(t.locale),this.balloonPanelView.class=BALLOON_CLASS,this.balloonPanelView.content.add(this.tooltipTextView),this._mutationObserver=createMutationObserver(()=>{this._updateTooltipPosition()}),this._pinTooltipDebounced=debounce_default(this._pinTooltip,600),this._unpinTooltipDebounced=debounce_default(this._unpinTooltip,400),this.listenTo(global$1.document,"keydown",this._onKeyDown.bind(this),{useCapture:!0}),this.listenTo(global$1.document,"mouseenter",this._onEnterOrFocus.bind(this),{useCapture:!0}),this.listenTo(global$1.document,"mouseleave",this._onLeaveOrBlur.bind(this),{useCapture:!0}),this.listenTo(global$1.document,"focus",this._onEnterOrFocus.bind(this),{useCapture:!0}),this.listenTo(global$1.document,"blur",this._onLeaveOrBlur.bind(this),{useCapture:!0}),this.listenTo(global$1.document,"scroll",this._onScroll.bind(this),{useCapture:!0}),this._watchdogExcluded=!0}destroy(t){const i=t.ui.view&&t.ui.view.body;kt._editors.delete(t),this.stopListening(t.ui),i&&i.has(this.balloonPanelView)&&i.remove(this.balloonPanelView),kt._editors.size||(this._unpinTooltip(),this.balloonPanelView.destroy(),this.stopListening(),kt._instance=null)}static getPositioningFunctions(t){const i=kt.defaultBalloonPositions;return{s:[i.southArrowNorth,i.southArrowNorthEast,i.southArrowNorthWest],n:[i.northArrowSouth],e:[i.eastArrowWest],w:[i.westArrowEast],sw:[i.southArrowNorthEast],se:[i.southArrowNorthWest]}[t]}_onKeyDown(t,i){i.key==="Escape"&&this._currentElementWithTooltip&&(this._unpinTooltip(),i.stopPropagation())}_onEnterOrFocus(t,{target:i}){const r=getDescendantWithTooltip(i);if(!r){t.name==="focus"&&this._unpinTooltip();return}r!==this._currentElementWithTooltip&&(this._unpinTooltip(),t.name==="focus"&&!r.matches(":hover")?this._pinTooltip(r,getTooltipData(r)):this._pinTooltipDebounced(r,getTooltipData(r)))}_onLeaveOrBlur(t,{target:i,relatedTarget:r}){if(t.name==="mouseleave"){if(!isElement_default(i))return;const o=this.balloonPanelView.element,a=o&&(o===r||o.contains(r)),c=!a&&i===o;if(a){this._unpinTooltipDebounced.cancel();return}if(!c&&this._currentElementWithTooltip&&i!==this._currentElementWithTooltip)return;const u=getDescendantWithTooltip(i),h=getDescendantWithTooltip(r);(c||u&&u!==h)&&this._unpinTooltipDebounced()}else{if(this._currentElementWithTooltip&&i!==this._currentElementWithTooltip)return;this._unpinTooltipDebounced()}}_onScroll(t,{target:i}){this._currentElementWithTooltip&&(i.contains(this.balloonPanelView.element)&&i.contains(this._currentElementWithTooltip)||this._unpinTooltip())}_pinTooltip(t,{text:i,position:r,cssClass:o}){this._unpinTooltip();const a=first(kt._editors.values()).ui.view.body;a.has(this.balloonPanelView)||a.add(this.balloonPanelView),this.tooltipTextView.text=i,this.balloonPanelView.class=[BALLOON_CLASS,o].filter(c=>c).join(" "),this.balloonPanelView.pin({target:t,positions:kt.getPositioningFunctions(r)}),this._mutationObserver.attach(t);for(const c of kt._editors)this.listenTo(c.ui,"update",this._updateTooltipPosition.bind(this),{priority:"low"});this._currentElementWithTooltip=t,this._currentTooltipPosition=r}_unpinTooltip(){this._unpinTooltipDebounced.cancel(),this._pinTooltipDebounced.cancel(),this.balloonPanelView.unpin();for(const t of kt._editors)this.stopListening(t.ui,"update");this._currentElementWithTooltip=null,this._currentTooltipPosition=null,this.tooltipTextView.text="",this._mutationObserver.detach()}_updateTooltipPosition(){if(!this._currentElementWithTooltip)return;const t=getTooltipData(this._currentElementWithTooltip);if(!isVisible(this._currentElementWithTooltip)||!t.text){this._unpinTooltip();return}this.balloonPanelView.pin({target:this._currentElementWithTooltip,positions:kt.getPositioningFunctions(t.position)})}};function getDescendantWithTooltip(e){return isElement_default(e)?e.closest("[data-cke-tooltip-text]:not([data-cke-tooltip-disabled])"):null}function getTooltipData(e){return{text:e.dataset.ckeTooltipText,position:e.dataset.ckeTooltipPosition||"s",cssClass:e.dataset.ckeTooltipClass||""}}function createMutationObserver(e){const t=new MutationObserver(()=>{e()});return{attach(i){t.observe(i,{attributes:!0,attributeFilter:["data-cke-tooltip-text","data-cke-tooltip-position"]})},detach(){t.disconnect()}}}const NARROW_ROOT_HEIGHT_THRESHOLD=50,NARROW_ROOT_WIDTH_THRESHOLD=350;var Badge=class extends DomEmitterMixin(){editor;_balloonView=null;_showBalloonThrottled=throttle_default(()=>this._showBalloon(),50,{leading:!0});_lastFocusedEditableElement=null;_balloonClass;constructor(e,t={}){super(),this.editor=e,this._balloonClass=t.balloonClass,e.on("ready",()=>this._handleEditorReady())}destroy(){const e=this._balloonView;e&&(e.unpin(),this._balloonView=null),this._showBalloonThrottled.cancel(),this.stopListening()}_handleEditorReady(){const e=this.editor;this._isEnabled()&&e.ui.view&&(e.ui.focusTracker.on("change:isFocused",(t,i,r)=>{this._updateLastFocusedEditableElement(),r?this._showBalloon():this._hideBalloon()}),e.ui.focusTracker.on("change:focusedElement",(t,i,r)=>{this._updateLastFocusedEditableElement(),r&&this._showBalloon()}),e.ui.on("update",()=>{this._showBalloonThrottled()}))}_getNormalizedConfig(){return{side:this.editor.locale.contentLanguageDirection==="ltr"?"right":"left",position:"border",verticalOffset:0,horizontalOffset:5}}_showBalloon(){const e=this._getBalloonAttachOptions();e&&(this._balloonView||(this._balloonView=this._createBalloonView()),this._balloonView.pin(e))}_hideBalloon(){this._balloonView&&this._balloonView.unpin()}_createBalloonView(){const e=this.editor,t=new BalloonPanelView,i=this._createBadgeContent();return t.content.add(i),this._balloonClass&&(t.class=this._balloonClass),e.ui.view.body.add(t),t}_getBalloonAttachOptions(){if(!this._lastFocusedEditableElement)return null;const e=this._getNormalizedConfig(),t=e.side==="right"?getLowerRightCornerPosition(this._lastFocusedEditableElement,e):getLowerLeftCornerPosition(this._lastFocusedEditableElement,e);return{target:this._lastFocusedEditableElement,positions:[t]}}_updateLastFocusedEditableElement(){const e=this.editor,t=e.ui.focusTracker.isFocused,i=e.ui.focusTracker.focusedElement;if(!t||!i){this._lastFocusedEditableElement=null;return}const r=Array.from(e.ui.getEditableElementsNames()).map(o=>e.ui.getEditableElement(o));r.includes(i)?this._lastFocusedEditableElement=i:this._lastFocusedEditableElement=r[0]}};function getLowerRightCornerPosition(e,t){return getLowerCornerPosition(e,t,(i,r)=>i.left+i.width-r.width-t.horizontalOffset)}function getLowerLeftCornerPosition(e,t){return getLowerCornerPosition(e,t,i=>i.left+t.horizontalOffset)}function getLowerCornerPosition(e,t,i){return(r,o)=>{const a=new Rect(e);if(a.width<NARROW_ROOT_WIDTH_THRESHOLD||a.height<NARROW_ROOT_HEIGHT_THRESHOLD)return null;let c;t.position==="inside"?c=a.bottom-o.height:c=a.bottom-o.height/2,c-=t.verticalOffset;const u=i(a,o),d=r.clone().moveTo(u,c).getIntersection(o.clone().moveTo(u,c)).getVisible();return!d||d.getArea()<o.getArea()?null:{top:c,left:u,name:`position_${t.position}-side_${t.side}`,config:{withArrow:!1}}}}var poweredByIcon=`<svg xmlns="http://www.w3.org/2000/svg" width="53" height="10" viewBox="0 0 53 10"><path fill="#1C2331" d="M31.724 1.492a15.139 15.139 0 0 0 .045 1.16 2.434 2.434 0 0 0-.687-.34 3.68 3.68 0 0 0-1.103-.166 2.332 2.332 0 0 0-1.14.255 1.549 1.549 0 0 0-.686.87c-.15.41-.225.98-.225 1.712 0 .939.148 1.659.444 2.161.297.503.792.754 1.487.754.452.015.9-.094 1.294-.316.296-.174.557-.4.771-.669l.14.852h1.282V.007h-1.623v1.485ZM31 6.496a1.77 1.77 0 0 1-.494.061.964.964 0 0 1-.521-.127.758.758 0 0 1-.296-.466 3.984 3.984 0 0 1-.093-.992 4.208 4.208 0 0 1 .098-1.052.753.753 0 0 1 .307-.477 1.08 1.08 0 0 1 .55-.122c.233-.004.466.026.69.089l.483.144v2.553c-.11.076-.213.143-.307.2a1.73 1.73 0 0 1-.417.189ZM35.68 0l-.702.004c-.322.002-.482.168-.48.497l.004.581c.002.33.164.493.486.49l.702-.004c.322-.002.481-.167.48-.496L36.165.49c-.002-.33-.164-.493-.486-.491ZM36.145 2.313l-1.612.01.034 5.482 1.613-.01-.035-5.482ZM39.623.79 37.989.8 38 2.306l-.946.056.006 1.009.949-.006.024 2.983c.003.476.143.844.419 1.106.275.26.658.39 1.148.387.132 0 .293-.01.483-.03.19-.02.38-.046.57-.08.163-.028.324-.068.482-.119l-.183-1.095-.702.004a.664.664 0 0 1-.456-.123.553.553 0 0 1-.14-.422l-.016-2.621 1.513-.01-.006-1.064-1.514.01-.01-1.503ZM46.226 2.388c-.41-.184-.956-.274-1.636-.27-.673.004-1.215.101-1.627.29-.402.179-.72.505-.888.91-.18.419-.268.979-.264 1.68.004.688.1 1.24.285 1.655.172.404.495.724.9.894.414.18.957.268 1.63.264.68-.004 1.224-.099 1.632-.284.4-.176.714-.501.878-.905.176-.418.263-.971.258-1.658-.004-.702-.097-1.261-.28-1.677a1.696 1.696 0 0 0-.888-.9Zm-.613 3.607a.77.77 0 0 1-.337.501 1.649 1.649 0 0 1-1.317.009.776.776 0 0 1-.343-.497 4.066 4.066 0 0 1-.105-1.02 4.136 4.136 0 0 1 .092-1.03.786.786 0 0 1 .337-.507 1.59 1.59 0 0 1 1.316-.008.79.79 0 0 1 .344.502c.078.337.113.683.105 1.03.012.343-.019.685-.092 1.02ZM52.114 2.07a2.67 2.67 0 0 0-1.128.278c-.39.191-.752.437-1.072.73l-.157-.846-1.273.008.036 5.572 1.623-.01-.024-3.78c.35-.124.646-.22.887-.286.26-.075.53-.114.8-.118l.45-.003.144-1.546-.286.001ZM22.083 7.426l-1.576-2.532a2.137 2.137 0 0 0-.172-.253 1.95 1.95 0 0 0-.304-.29.138.138 0 0 1 .042-.04 1.7 1.7 0 0 0 .328-.374l1.75-2.71c.01-.015.025-.028.024-.048-.01-.01-.021-.007-.031-.007L20.49 1.17a.078.078 0 0 0-.075.045l-.868 1.384c-.23.366-.46.732-.688 1.099a.108.108 0 0 1-.112.06c-.098-.005-.196-.001-.294-.002-.018 0-.038.006-.055-.007.002-.02.002-.039.005-.058a4.6 4.6 0 0 0 .046-.701V1.203c0-.02-.009-.032-.03-.03h-.033L16.93 1.17c-.084 0-.073-.01-.073.076v6.491c-.001.018.006.028.025.027h1.494c.083 0 .072.007.072-.071v-2.19c0-.055-.003-.11-.004-.166a3.366 3.366 0 0 0-.05-.417h.06c.104 0 .209.002.313-.002a.082.082 0 0 1 .084.05c.535.913 1.07 1.824 1.607 2.736a.104.104 0 0 0 .103.062c.554-.003 1.107-.002 1.66-.002l.069-.003-.019-.032-.188-.304ZM27.112 6.555c-.005-.08-.004-.08-.082-.08h-2.414c-.053 0-.106-.003-.159-.011a.279.279 0 0 1-.246-.209.558.558 0 0 1-.022-.15c0-.382 0-.762-.002-1.143 0-.032.007-.049.042-.044h2.504c.029.003.037-.012.034-.038V3.814c0-.089.013-.078-.076-.078h-2.44c-.07 0-.062.003-.062-.06v-.837c0-.047.004-.093.013-.14a.283.283 0 0 1 .241-.246.717.717 0 0 1 .146-.011h2.484c.024.002.035-.009.036-.033l.003-.038.03-.496c.01-.183.024-.365.034-.548.005-.085.003-.087-.082-.094-.218-.018-.437-.038-.655-.05a17.845 17.845 0 0 0-.657-.026 72.994 72.994 0 0 0-1.756-.016 1.7 1.7 0 0 0-.471.064 1.286 1.286 0 0 0-.817.655c-.099.196-.149.413-.145.633v3.875c0 .072.003.144.011.216a1.27 1.27 0 0 0 .711 1.029c.228.113.48.167.734.158.757-.005 1.515.002 2.272-.042.274-.016.548-.034.82-.053.03-.002.043-.008.04-.041-.008-.104-.012-.208-.019-.312a69.964 69.964 0 0 1-.05-.768ZM16.14 7.415l-.127-1.075c-.004-.03-.014-.04-.044-.037a13.125 13.125 0 0 1-.998.073c-.336.01-.672.02-1.008.016-.116-.001-.233-.014-.347-.039a.746.746 0 0 1-.45-.262c-.075-.1-.132-.211-.167-.33a3.324 3.324 0 0 1-.126-.773 9.113 9.113 0 0 1-.015-.749c0-.285.022-.57.065-.852.023-.158.066-.312.127-.46a.728.728 0 0 1 .518-.443 1.64 1.64 0 0 1 .397-.048c.628-.001 1.255.003 1.882.05.022.001.033-.006.036-.026l.003-.031.06-.55c.019-.177.036-.355.057-.532.004-.034-.005-.046-.04-.056a5.595 5.595 0 0 0-1.213-.21 10.783 10.783 0 0 0-.708-.02c-.24-.003-.48.01-.719.041a3.477 3.477 0 0 0-.625.14 1.912 1.912 0 0 0-.807.497c-.185.2-.33.433-.424.688a4.311 4.311 0 0 0-.24 1.096c-.031.286-.045.572-.042.86-.006.43.024.86.091 1.286.04.25.104.497.193.734.098.279.26.53.473.734.214.205.473.358.756.446.344.11.702.17 1.063.177a8.505 8.505 0 0 0 1.578-.083 6.11 6.11 0 0 0 .766-.18c.03-.008.047-.023.037-.057a.157.157 0 0 1-.003-.025Z"/><path fill="#AFE229" d="M6.016 6.69a1.592 1.592 0 0 0-.614.21c-.23.132-.422.32-.56.546-.044.072-.287.539-.287.539l-.836 1.528.009.006c.038.025.08.046.123.063.127.046.26.07.395.073.505.023 1.011-.007 1.517-.003.29.009.58.002.869-.022a.886.886 0 0 0 .395-.116.962.962 0 0 0 .312-.286c.056-.083.114-.163.164-.249.24-.408.48-.816.718-1.226.075-.128.148-.257.222-.386l.112-.192a1.07 1.07 0 0 0 .153-.518l-1.304.023s-1.258-.005-1.388.01Z"/><path fill="#771BFF" d="m2.848 9.044.76-1.39.184-.352c-.124-.067-.245-.14-.367-.21-.346-.204-.706-.384-1.045-.6a.984.984 0 0 1-.244-.207c-.108-.134-.136-.294-.144-.46-.021-.409-.002-.818-.009-1.227-.003-.195 0-.39.003-.585.004-.322.153-.553.427-.713l.833-.488c.22-.13.44-.257.662-.385.05-.029.105-.052.158-.077.272-.128.519-.047.76.085l.044.028c.123.06.242.125.358.196.318.178.635.357.952.537.095.056.187.117.275.184.194.144.254.35.266.578.016.284.007.569.006.853-.001.28.004.558 0 .838.592-.003 1.259 0 1.259 0l.723-.013c-.003-.292-.007-.584-.007-.876 0-.524.015-1.048-.016-1.571-.024-.42-.135-.8-.492-1.067a5.02 5.02 0 0 0-.506-.339A400.52 400.52 0 0 0 5.94.787C5.722.664 5.513.524 5.282.423 5.255.406 5.228.388 5.2.373 4.758.126 4.305-.026 3.807.21c-.097.046-.197.087-.29.14A699.896 699.896 0 0 0 .783 1.948c-.501.294-.773.717-.778 1.31-.004.36-.009.718-.001 1.077.016.754-.017 1.508.024 2.261.016.304.07.6.269.848.127.15.279.28.448.382.622.4 1.283.734 1.92 1.11l.183.109Z"/></svg>
`;const DEFAULT_LABEL="Powered by";var PoweredBy=class extends Badge{constructor(e){super(e,{balloonClass:"ck-powered-by-balloon"})}_isEnabled(){const e=this.editor;if(e.config.get("ui.poweredBy.forceVisible"))return!0;const i=e.config.get("licenseKey");if(i=="GPL")return!0;const r=parseBase64EncodedObject(i.split(".")[1]);return r?!r.whiteLabel:!0}_createBadgeContent(){return new PoweredByView(this.editor.locale,this._getNormalizedConfig().label)}_getNormalizedConfig(){const e=super._getNormalizedConfig(),t=this.editor.config.get("ui.poweredBy")||{},i=t.position||e.position,r=i==="inside"?5:e.verticalOffset;return{position:i,side:t.side||e.side,label:t.label===void 0?DEFAULT_LABEL:t.label,verticalOffset:t.verticalOffset!==void 0?t.verticalOffset:r,horizontalOffset:t.horizontalOffset!==void 0?t.horizontalOffset:e.horizontalOffset,forceVisible:!!t.forceVisible}}},PoweredByView=class extends View{constructor(e,t){super(e);const i=new IconView,r=this.bindTemplate;i.set({content:poweredByIcon,isColorInherited:!1}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-powered-by"],"aria-hidden":!0},children:[{tag:"a",attributes:{href:"https://ckeditor.com/powered-by-ckeditor/?utm_source=ckeditor&utm_medium=referral&utm_campaign=701Dn000000hVgmIAE_powered_by_ckeditor_logo",target:"_blank",tabindex:"-1"},children:[...t?[{tag:"span",attributes:{class:["ck","ck-powered-by__label"]},children:[t]}]:[],i],on:{dragstart:r.to(o=>o.preventDefault())}}]})}},EvaluationBadge=class extends Badge{licenseTypeMessage={evaluation:"For evaluation purposes only",trial:"For evaluation purposes only",development:"For development purposes only"};constructor(e){super(e,{balloonClass:"ck-evaluation-badge-balloon"})}_isEnabled(){const t=this.editor.config.get("licenseKey"),i=getLicenseTypeFromLicenseKey(t);return!!(i&&this.licenseTypeMessage[i])}_createBadgeContent(){const e=this.editor.config.get("licenseKey"),t=getLicenseTypeFromLicenseKey(e);return new EvaluationBadgeView(this.editor.locale,this.licenseTypeMessage[t])}_getNormalizedConfig(){const e=super._getNormalizedConfig(),t=this.editor.config.get("ui.poweredBy")||{},i=t.position||e.position,r=t.side||e.side;return{position:i,side:r==="left"?"right":"left",verticalOffset:e.verticalOffset,horizontalOffset:e.horizontalOffset}}},EvaluationBadgeView=class extends View{constructor(e,t){super(e),this.setTemplate({tag:"div",attributes:{class:["ck","ck-evaluation-badge"],"aria-hidden":!0},children:[{tag:"span",attributes:{class:["ck","ck-evaluation-badge__label"]},children:[t]}]})}};function getLicenseTypeFromLicenseKey(e){if(e=="GPL")return"GPL";const t=parseBase64EncodedObject(e.split(".")[1]);return t?t.licenseType||"production":null}const AriaLiveAnnouncerPoliteness={POLITE:"polite",ASSERTIVE:"assertive"};var AriaLiveAnnouncer=class{editor;view;constructor(e){this.editor=e,e.once("ready",()=>{for(const t of Object.values(AriaLiveAnnouncerPoliteness))this.announce("",t)})}announce(e,t=AriaLiveAnnouncerPoliteness.POLITE){const i=this.editor;if(!i.ui.view)return;this.view||(this.view=new AriaLiveAnnouncerView(i.locale),i.ui.view.body.add(this.view));const{politeness:r,isUnsafeHTML:o}=typeof t=="string"?{politeness:t}:t;let a=this.view.regionViews.find(c=>c.politeness===r);a||(a=new AriaLiveAnnouncerRegionView(i,r),this.view.regionViews.add(a)),a.announce({announcement:e,isUnsafeHTML:o})}},AriaLiveAnnouncerView=class extends View{regionViews;constructor(e){super(e),this.regionViews=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-aria-live-announcer"]},children:this.regionViews})}},AriaLiveAnnouncerRegionView=class extends View{politeness;_domConverter;_pruneAnnouncementsInterval;constructor(e,t){super(e.locale),this.setTemplate({tag:"div",attributes:{"aria-live":t,"aria-relevant":"additions"},children:[{tag:"ul",attributes:{class:["ck","ck-aria-live-region-list"]}}]}),e.on("destroy",()=>{this._pruneAnnouncementsInterval!==null&&(clearInterval(this._pruneAnnouncementsInterval),this._pruneAnnouncementsInterval=null)}),this.politeness=t,this._domConverter=e.data.htmlProcessor.domConverter,this._pruneAnnouncementsInterval=setInterval(()=>{this.element&&this._listElement.firstChild&&this._listElement.firstChild.remove()},5e3)}announce({announcement:e,isUnsafeHTML:t}){if(!e.trim().length)return;const i=document.createElement("li");t?this._domConverter.setContentOf(i,e):i.innerText=e,this._listElement.appendChild(i)}get _listElement(){return this.element.querySelector("ul")}},MenuBarMenuListItemView=class extends ListItemView{constructor(e,t){super(e);const i=this.bindTemplate;this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item"]},on:{mouseenter:i.to("mouseenter")}}),this.delegate("mouseenter").to(t)}};const NESTED_PANEL_HORIZONTAL_OFFSET=5,MenuBarBehaviors={toggleMenusAndFocusItemsOnHover(e){e.on("menu:mouseenter",t=>{if(!(!e.isFocusBorderEnabled&&!e.isOpen)){if(e.isOpen)for(const i of e.menus){const r=t.path[0],o=r instanceof MenuBarMenuListItemView&&r.children.first===i;i.isOpen=(t.path.includes(i)||o)&&i.isEnabled}t.source.focus()}})},focusCycleMenusOnArrows(e){const t=e.locale.uiLanguageDirection==="rtl";e.on("menu:arrowright",r=>{i(r.source,t?-1:1)}),e.on("menu:arrowleft",r=>{i(r.source,t?1:-1)});function i(r,o){const a=e.children.getIndex(r),c=r.isOpen,u=e.children.length,h=e.children.get((a+u+o)%u);r.isOpen=!1,c&&(h.isOpen=!0),h.buttonView.focus()}},closeMenusWhenTheBarCloses(e){e.on("change:isOpen",()=>{e.isOpen||e.menus.forEach(t=>{t.isOpen=!1})})},closeMenuWhenAnotherOnTheSameLevelOpens(e){e.on("menu:change:isOpen",(t,i,r)=>{r&&e.menus.filter(o=>t.source.parentMenuView===o.parentMenuView&&t.source!==o&&o.isOpen).forEach(o=>{o.isOpen=!1})})},closeOnClickOutside(e){clickOutsideHandler({emitter:e,activator:()=>e.isOpen,callback:()=>e.close(),contextElements:()=>e.children.map(t=>t.element)})},enableFocusHighlightOnInteraction(e){let t=!1;e.on("change:isOpen",(i,r,o)=>{o||(t||(e.isFocusBorderEnabled=!1),t=!1)}),e.listenTo(e.element,"keydown",()=>{t=!0},{useCapture:!0}),e.listenTo(e.element,"keyup",()=>{t=!1},{useCapture:!0}),e.listenTo(e.element,"focus",()=>{t&&(e.isFocusBorderEnabled=!0)},{useCapture:!0})}},MenuBarMenuBehaviors={openAndFocusPanelOnArrowDownKey(e){e.keystrokes.set("arrowdown",(t,i)=>{e.focusTracker.focusedElement===e.buttonView.element&&(e.isOpen||(e.isOpen=!0),e.panelView.focus(),i())})},openOnArrowRightKey(e){const t=e.locale.uiLanguageDirection==="rtl"?"arrowleft":"arrowright";e.keystrokes.set(t,(i,r)=>{e.focusTracker.focusedElement!==e.buttonView.element||!e.isEnabled||(e.isOpen||(e.isOpen=!0),e.panelView.focus(),r())})},openOnButtonClick(e){e.buttonView.on("execute",()=>{e.isOpen=!0})},toggleOnButtonClick(e){e.buttonView.on("execute",()=>{e.isOpen=!e.isOpen})},openAndFocusOnEnterKeyPress(e){e.keystrokes.set("enter",(t,i)=>{e.focusTracker.focusedElement===e.buttonView.element&&(e.isOpen=!0,e.panelView.focus(),i())})},closeOnArrowLeftKey(e){const t=e.locale.uiLanguageDirection==="rtl"?"arrowright":"arrowleft";e.keystrokes.set(t,(i,r)=>{e.isOpen&&(e.isOpen=!1,e.focus(),r())})},closeOnEscKey(e){e.keystrokes.set("esc",(t,i)=>{e.isOpen&&(e.isOpen=!1,e.focus(),i())})},closeOnParentClose(e){e.parentMenuView.on("change:isOpen",(t,i,r)=>{!r&&t.source===e.parentMenuView&&(e.isOpen=!1)})}},MenuBarMenuViewPanelPositioningFunctions={southEast:e=>({top:e.bottom,left:e.left,name:"se"}),southWest:(e,t)=>({top:e.bottom,left:e.left-t.width+e.width,name:"sw"}),northEast:(e,t)=>({top:e.top-t.height,left:e.left,name:"ne"}),northWest:(e,t)=>({top:e.top-t.height,left:e.left-t.width+e.width,name:"nw"}),eastSouth:e=>({top:e.top,left:e.right-NESTED_PANEL_HORIZONTAL_OFFSET,name:"es"}),eastNorth:(e,t)=>({top:e.top-t.height,left:e.right-NESTED_PANEL_HORIZONTAL_OFFSET,name:"en"}),westSouth:(e,t)=>({top:e.top,left:e.left-t.width+NESTED_PANEL_HORIZONTAL_OFFSET,name:"ws"}),westNorth:(e,t)=>({top:e.top-t.height,left:e.left-t.width+NESTED_PANEL_HORIZONTAL_OFFSET,name:"wn"})},DefaultMenuBarItems=[{menuId:"file",label:"File",groups:[{groupId:"export",items:["menuBar:exportPdf","menuBar:exportWord"]},{groupId:"import",items:["menuBar:importWord"]},{groupId:"revisionHistory",items:["menuBar:revisionHistory"]}]},{menuId:"edit",label:"Edit",groups:[{groupId:"undo",items:["menuBar:undo","menuBar:redo"]},{groupId:"selectAll",items:["menuBar:selectAll"]},{groupId:"findAndReplace",items:["menuBar:findAndReplace"]}]},{menuId:"view",label:"View",groups:[{groupId:"sourceEditing",items:["menuBar:sourceEditing"]},{groupId:"showBlocks",items:["menuBar:showBlocks"]},{groupId:"previewMergeFields",items:["menuBar:previewMergeFields"]},{groupId:"restrictedEditing",items:["menuBar:restrictedEditing"]}]},{menuId:"insert",label:"Insert",groups:[{groupId:"insertMainWidgets",items:["menuBar:insertImage","menuBar:ckbox","menuBar:ckfinder","menuBar:insertTable"]},{groupId:"insertInline",items:["menuBar:link","menuBar:bookmark","menuBar:comment","menuBar:insertMergeField"]},{groupId:"insertMinorWidgets",items:["menuBar:mediaEmbed","menuBar:insertTemplate","menuBar:specialCharacters","menuBar:blockQuote","menuBar:codeBlock","menuBar:htmlEmbed"]},{groupId:"insertStructureWidgets",items:["menuBar:horizontalLine","menuBar:pageBreak","menuBar:tableOfContents"]},{groupId:"restrictedEditingException",items:["menuBar:restrictedEditingException"]}]},{menuId:"format",label:"Format",groups:[{groupId:"textAndFont",items:[{menuId:"text",label:"Text",groups:[{groupId:"basicStyles",items:["menuBar:bold","menuBar:italic","menuBar:underline","menuBar:strikethrough","menuBar:superscript","menuBar:subscript","menuBar:code"]},{groupId:"textPartLanguage",items:["menuBar:textPartLanguage"]}]},{menuId:"font",label:"Font",groups:[{groupId:"fontProperties",items:["menuBar:fontSize","menuBar:fontFamily"]},{groupId:"fontColors",items:["menuBar:fontColor","menuBar:fontBackgroundColor"]},{groupId:"highlight",items:["menuBar:highlight"]}]},"menuBar:heading"]},{groupId:"list",items:["menuBar:bulletedList","menuBar:numberedList","menuBar:multiLevelList","menuBar:todoList"]},{groupId:"indent",items:["menuBar:alignment","menuBar:indent","menuBar:outdent"]},{groupId:"caseChange",items:["menuBar:caseChange"]},{groupId:"removeFormat",items:["menuBar:removeFormat"]}]},{menuId:"tools",label:"Tools",groups:[{groupId:"aiTools",items:["menuBar:aiAssistant","menuBar:aiCommands"]},{groupId:"tools",items:["menuBar:trackChanges","menuBar:commentsArchive"]}]},{menuId:"help",label:"Help",groups:[{groupId:"help",items:["menuBar:accessibilityHelp"]}]}];function normalizeMenuBarConfig(e){let t;return!("items"in e)||!e.items?t={items:cloneDeep_default(DefaultMenuBarItems),addItems:[],removeItems:[],isVisible:!0,isUsingDefaultConfig:!0,...e}:t={items:e.items,removeItems:[],addItems:[],isVisible:!0,isUsingDefaultConfig:!1,...e},t}function processMenuBarConfig({normalizedConfig:e,locale:t,componentFactory:i,extraItems:r}){const o=cloneDeep_default(e);return handleAdditions(e,o,r),handleRemovals(e,o),handleAdditions(e,o,o.addItems),purgeUnavailableComponents(e,o,i),purgeEmptyMenus(e,o),localizeMenuLabels(o,t),o}function handleRemovals(e,t){const i=t.removeItems,r=[];t.items=t.items.filter(({menuId:o})=>i.includes(o)?(r.push(o),!1):!0),walkConfigMenus(t.items,o=>{o.groups=o.groups.filter(({groupId:a})=>i.includes(a)?(r.push(a),!1):!0);for(const a of o.groups)a.items=a.items.filter(c=>{const u=getIdFromGroupItem(c);return i.includes(u)?(r.push(u),!1):!0})});for(const o of i)r.includes(o)||logWarning("menu-bar-item-could-not-be-removed",{menuBarConfig:e,itemName:o})}function handleAdditions(e,t,i){const r=[];if(i.length!=0){for(const o of i){const a=getRelationFromPosition(o.position),c=getRelativeIdFromPosition(o.position);if(isMenuBarMenuAddition(o))if(!c)a==="start"?(t.items.unshift(o.menu),r.push(o)):a==="end"&&(t.items.push(o.menu),r.push(o));else{const u=t.items.findIndex(h=>h.menuId===c);u!=-1?a==="before"?(t.items.splice(u,0,o.menu),r.push(o)):a==="after"&&(t.items.splice(u+1,0,o.menu),r.push(o)):addMenuOrItemToGroup(t,o.menu,c,a)&&r.push(o)}else isMenuBarMenuGroupAddition(o)?walkConfigMenus(t.items,u=>{if(u.menuId===c)a==="start"?(u.groups.unshift(o.group),r.push(o)):a==="end"&&(u.groups.push(o.group),r.push(o));else{const h=u.groups.findIndex(d=>d.groupId===c);h!==-1&&(a==="before"?(u.groups.splice(h,0,o.group),r.push(o)):a==="after"&&(u.groups.splice(h+1,0,o.group),r.push(o)))}}):addMenuOrItemToGroup(t,o.item,c,a)&&r.push(o)}for(const o of i)r.includes(o)||logWarning("menu-bar-item-could-not-be-added",{menuBarConfig:e,addedItemConfig:o})}}function addMenuOrItemToGroup(e,t,i,r){let o=!1;return walkConfigMenus(e.items,a=>{for(const{groupId:c,items:u}of a.groups){if(o)return;if(c===i)r==="start"?(u.unshift(t),o=!0):r==="end"&&(u.push(t),o=!0);else{const h=u.findIndex(d=>getIdFromGroupItem(d)===i);h!==-1&&(r==="before"?(u.splice(h,0,t),o=!0):r==="after"&&(u.splice(h+1,0,t),o=!0))}}}),o}function purgeUnavailableComponents(e,t,i){walkConfigMenus(t.items,r=>{for(const o of r.groups)o.items=o.items.filter(a=>{const c=typeof a=="string"&&!i.has(a);return c&&!t.isUsingDefaultConfig&&logWarning("menu-bar-item-unavailable",{menuBarConfig:e,parentMenuConfig:cloneDeep_default(r),componentName:a}),!c})})}function purgeEmptyMenus(e,t){const i=t.isUsingDefaultConfig;let r=!1;if(t.items=t.items.filter(o=>o.groups.length?!0:(warnAboutEmptyMenu(e,o,i),!1)),!t.items.length){warnAboutEmptyMenu(e,e,i);return}walkConfigMenus(t.items,o=>{o.groups=o.groups.filter(a=>a.items.length?!0:(r=!0,!1));for(const a of o.groups)a.items=a.items.filter(c=>isMenuDefinition(c)&&!c.groups.length?(warnAboutEmptyMenu(e,c,i),r=!0,!1):!0)}),r&&purgeEmptyMenus(e,t)}function warnAboutEmptyMenu(e,t,i){i||logWarning("menu-bar-menu-empty",{menuBarConfig:e,emptyMenuConfig:t})}function localizeMenuLabels(e,t){const i=t.t,r={File:i({string:"File",id:"MENU_BAR_MENU_FILE"}),Edit:i({string:"Edit",id:"MENU_BAR_MENU_EDIT"}),View:i({string:"View",id:"MENU_BAR_MENU_VIEW"}),Insert:i({string:"Insert",id:"MENU_BAR_MENU_INSERT"}),Format:i({string:"Format",id:"MENU_BAR_MENU_FORMAT"}),Tools:i({string:"Tools",id:"MENU_BAR_MENU_TOOLS"}),Help:i({string:"Help",id:"MENU_BAR_MENU_HELP"}),Text:i({string:"Text",id:"MENU_BAR_MENU_TEXT"}),Font:i({string:"Font",id:"MENU_BAR_MENU_FONT"})};walkConfigMenus(e.items,o=>{o.label in r&&(o.label=r[o.label])})}function walkConfigMenus(e,t){if(Array.isArray(e))for(const r of e)i(r);function i(r){t(r);for(const o of r.groups)for(const a of o.items)isMenuDefinition(a)&&i(a)}}function isMenuBarMenuAddition(e){return typeof e=="object"&&"menu"in e}function isMenuBarMenuGroupAddition(e){return typeof e=="object"&&"group"in e}function getRelationFromPosition(e){return e.startsWith("start")?"start":e.startsWith("end")?"end":e.startsWith("after")?"after":"before"}function getRelativeIdFromPosition(e){const t=e.match(/^[^:]+:(.+)/);return t?t[1]:null}function getIdFromGroupItem(e){return typeof e=="string"?e:e.menuId}function isMenuDefinition(e){return typeof e=="object"&&"menuId"in e}var EditorUI=class extends ObservableMixin(){editor;componentFactory;focusTracker;tooltipManager;poweredBy;evaluationBadge;ariaLiveAnnouncer;isReady=!1;_editableElementsMap=new Map;_focusableToolbarDefinitions=[];_extraMenuBarElements=[];_lastFocusedForeignElement=null;constructor(e){super();const t=e.editing.view;this.editor=e,this.componentFactory=new ComponentFactory(e),this.focusTracker=new FocusTracker,this.tooltipManager=new TooltipManager(e),this.poweredBy=new PoweredBy(e),this.evaluationBadge=new EvaluationBadge(e),this.ariaLiveAnnouncer=new AriaLiveAnnouncer(e),this.set("viewportOffset",this._readViewportOffsetFromConfig()),this.once("ready",()=>{this._bindBodyCollectionWithFocusTracker(),this.isReady=!0}),this.listenTo(t.document,"layoutChanged",this.update.bind(this)),this.listenTo(t,"scrollToTheSelection",this._handleScrollToTheSelection.bind(this)),this._initFocusTracking()}get element(){return null}update(){this.fire("update")}destroy(){this.stopListening(),this.focusTracker.destroy(),this.tooltipManager.destroy(this.editor),this.poweredBy.destroy(),this.evaluationBadge.destroy();for(const e of this._editableElementsMap.values())e.ckeditorInstance=null,this.editor.keystrokes.stopListening(e);this._editableElementsMap=new Map,this._focusableToolbarDefinitions=[]}setEditableElement(e,t){this._editableElementsMap.set(e,t),t.ckeditorInstance||(t.ckeditorInstance=this.editor),this.focusTracker.add(t);const i=()=>{this.editor.editing.view.getDomRoot(e)||this.editor.keystrokes.listenTo(t)};this.isReady?i():this.once("ready",i)}removeEditableElement(e){const t=this._editableElementsMap.get(e);t&&(this._editableElementsMap.delete(e),this.editor.keystrokes.stopListening(t),this.focusTracker.remove(t),t.ckeditorInstance=null)}getEditableElement(e="main"){return this._editableElementsMap.get(e)}getEditableElementsNames(){return this._editableElementsMap.keys()}addToolbar(e,t={}){e.isRendered?(this.focusTracker.add(e),this.editor.keystrokes.listenTo(e.element)):e.once("render",()=>{this.focusTracker.add(e),this.editor.keystrokes.listenTo(e.element)}),this._focusableToolbarDefinitions.push({toolbarView:e,options:t})}extendMenuBar(e){this._extraMenuBarElements.push(e)}get _editableElements(){return console.warn("editor-ui-deprecated-editable-elements: The EditorUI#_editableElements property has been deprecated and will be removed in the near future.",{editorUI:this}),this._editableElementsMap}_initMenuBar(e){const t=e.element;this.focusTracker.add(t),this.editor.keystrokes.listenTo(t);const i=normalizeMenuBarConfig(this.editor.config.get("menuBar")||{});e.fillFromConfig(i,this.componentFactory,this._extraMenuBarElements),this.editor.keystrokes.set("Esc",(r,o)=>{t.contains(this.editor.ui.focusTracker.focusedElement)&&(this._lastFocusedForeignElement?(this._lastFocusedForeignElement.focus(),this._lastFocusedForeignElement=null):this.editor.editing.view.focus(),o())}),this.editor.keystrokes.set("Alt+F9",(r,o)=>{t.contains(this.editor.ui.focusTracker.focusedElement)||(this._saveLastFocusedForeignElement(),e.isFocusBorderEnabled=!0,e.focus(),o())})}_readViewportOffsetFromConfig(){const e=this.editor,t=e.config.get("ui.viewportOffset");if(t)return t;const i=e.config.get("toolbar.viewportTopOffset");return i?(console.warn("editor-ui-deprecated-viewport-offset-config: The `toolbar.vieportTopOffset` configuration option is deprecated. It will be removed from future CKEditor versions. Use `ui.viewportOffset.top` instead."),{top:i}):{top:0}}_initFocusTracking(){const e=this.editor;let t;e.keystrokes.set("Alt+F10",(i,r)=>{this._saveLastFocusedForeignElement();const o=this._getCurrentFocusedToolbarDefinition();(!o||!t)&&(t=this._getFocusableCandidateToolbarDefinitions());for(let a=0;a<t.length;a++){const c=t.shift();if(t.push(c),c!==o&&this._focusFocusableCandidateToolbar(c)){o&&o.options.afterBlur&&o.options.afterBlur();break}}r()}),e.keystrokes.set("Esc",(i,r)=>{const o=this._getCurrentFocusedToolbarDefinition();o&&(this._lastFocusedForeignElement?(this._lastFocusedForeignElement.focus(),this._lastFocusedForeignElement=null):e.editing.view.focus(),o.options.afterBlur&&o.options.afterBlur(),r())})}_saveLastFocusedForeignElement(){const e=this.focusTracker.focusedElement;Array.from(this._editableElementsMap.values()).includes(e)&&!Array.from(this.editor.editing.view.domRoots.values()).includes(e)&&(this._lastFocusedForeignElement=e)}_getFocusableCandidateToolbarDefinitions(){const e=[];for(const t of this._focusableToolbarDefinitions){const{toolbarView:i,options:r}=t;(isVisible(i.element)||r.beforeFocus)&&e.push(t)}return e.sort((t,i)=>getToolbarDefinitionWeight(t)-getToolbarDefinitionWeight(i)),e}_getCurrentFocusedToolbarDefinition(){for(const e of this._focusableToolbarDefinitions)if(e.toolbarView.element&&e.toolbarView.element.contains(this.focusTracker.focusedElement))return e;return null}_focusFocusableCandidateToolbar(e){const{toolbarView:t,options:{beforeFocus:i}}=e;return i&&i(),isVisible(t.element)?(t.focus(),!0):!1}_handleScrollToTheSelection(e,t){const i={top:0,bottom:0,left:0,right:0,...this.viewportOffset};t.viewportOffset.top+=i.top,t.viewportOffset.bottom+=i.bottom,t.viewportOffset.left+=i.left,t.viewportOffset.right+=i.right}_bindBodyCollectionWithFocusTracker(){const e=this.view.body;for(const t of e)this.focusTracker.add(t.element);e.on("add",(t,i)=>{this.focusTracker.add(i.element)}),e.on("remove",(t,i)=>{this.focusTracker.remove(i.element)})}};function getToolbarDefinitionWeight(e){const{toolbarView:t,options:i}=e;let r=10;return isVisible(t.element)&&r--,i.isContextual&&r--,r}var EditorUIView=class extends View{body;menuBarView;constructor(e){super(e),this.body=new BodyCollection(e)}render(){super.render(),this.body.attachToDom()}destroy(){return this.body.detachFromDom(),super.destroy()}},BoxedEditorUIView=class extends EditorUIView{top;main;_voiceLabelView;constructor(e){super(e),this.top=this.createCollection(),this.main=this.createCollection(),this._voiceLabelView=this._createVoiceLabel(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-editor","ck-rounded-corners"],role:"application",dir:e.uiLanguageDirection,lang:e.uiLanguage,"aria-labelledby":this._voiceLabelView.id},children:[this._voiceLabelView,{tag:"div",attributes:{class:["ck","ck-editor__top","ck-reset_all"],role:"presentation"},children:this.top},{tag:"div",attributes:{class:["ck","ck-editor__main"],role:"presentation"},children:this.main}]})}_createVoiceLabel(){const e=this.t,t=new LabelView;return t.text=e("Rich Text Editor"),t.extendTemplate({attributes:{class:"ck-voice-label"}}),t}},EditableUIView=class extends View{name=null;_editingView;_editableElement;_hasExternalElement;constructor(e,t,i){super(e),this.setTemplate({tag:"div",attributes:{class:["ck","ck-content","ck-editor__editable","ck-rounded-corners"],lang:e.contentLanguage,dir:e.contentLanguageDirection}}),this.set("isFocused",!1),this._editableElement=i,this._hasExternalElement=!!this._editableElement,this._editingView=t}render(){super.render(),this._hasExternalElement?this.template.apply(this.element=this._editableElement):this._editableElement=this.element,this.on("change:isFocused",()=>this._updateIsFocusedClasses()),this._updateIsFocusedClasses()}destroy(){this._hasExternalElement&&this.template.revert(this._editableElement),super.destroy()}get hasExternalElement(){return this._hasExternalElement}_updateIsFocusedClasses(){const e=this._editingView;e.isRenderingInProgress?i(this):t(this);function t(r){e.change(o=>{const a=e.document.getRoot(r.name);o.addClass(r.isFocused?"ck-focused":"ck-blurred",a),o.removeClass(r.isFocused?"ck-blurred":"ck-focused",a)})}function i(r){e.once("change:isRenderingInProgress",(o,a,c)=>{c?i(r):t(r)})}}},InlineEditableUIView=class extends EditableUIView{_options;constructor(e,t,i,r={}){super(e,t,i),this._options=r,this.extendTemplate({attributes:{role:"textbox",class:"ck-editor__editable_inline"}})}render(){super.render();const e=this._editingView;e.change(t=>{const i=e.document.getRoot(this.name);t.setAttribute("aria-label",this.getEditableAriaLabel(),i)})}getEditableAriaLabel(){const e=this.locale.t,t=this._options.label,i=this._editableElement,r=this.name;if(typeof t=="string")return t;if(typeof t=="object")return t[r];if(typeof t=="function")return t(this);if(i){const o=i.getAttribute("aria-label");if(o)return o}return e("Rich Text Editor. Editing area: %0",r)}},Model=class extends ObservableMixin(){constructor(e,t){super(),t&&assignIn_default(this,t),e&&this.set(e)}};const toPx$3=toUnit("px");var StickyPanelView=class extends View{content;contentPanelElement;_contentPanelPlaceholder;constructor(e){super(e);const t=this.bindTemplate;this.set("isActive",!1),this.set("isSticky",!1),this.set("limiterElement",null),this.set("limiterBottomOffset",50),this.set("viewportTopOffset",0),this.set("_marginLeft",null),this.set("_isStickyToTheBottomOfLimiter",!1),this.set("_stickyTopOffset",null),this.set("_stickyBottomOffset",null),this.content=this.createCollection(),this._contentPanelPlaceholder=new Template({tag:"div",attributes:{class:["ck","ck-sticky-panel__placeholder"],style:{display:t.to("isSticky",i=>i?"block":"none"),height:t.to("isSticky",i=>i?toPx$3(this._contentPanelRect.height):null)}}}).render(),this.contentPanelElement=new Template({tag:"div",attributes:{class:["ck","ck-sticky-panel__content",t.if("isSticky","ck-sticky-panel__content_sticky"),t.if("_isStickyToTheBottomOfLimiter","ck-sticky-panel__content_sticky_bottom-limit")],style:{width:t.to("isSticky",i=>i?toPx$3(this._contentPanelPlaceholder.getBoundingClientRect().width):null),top:t.to("_stickyTopOffset",i=>i&&toPx$3(i)),bottom:t.to("_stickyBottomOffset",i=>i&&toPx$3(i)),marginLeft:t.to("_marginLeft")}},children:this.content}).render(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-sticky-panel"]},children:[this._contentPanelPlaceholder,this.contentPanelElement]})}render(){super.render(),this.checkIfShouldBeSticky(),this.listenTo(global$1.document,"scroll",()=>{this.checkIfShouldBeSticky()},{useCapture:!0}),this.listenTo(this,"change:isActive",()=>{this.checkIfShouldBeSticky()})}checkIfShouldBeSticky(){if(!this.limiterElement||!this.isActive){this._unstick();return}const e=new Rect(this.limiterElement);let t=e.getVisible();if(t){const i=new Rect(global$1.window);i.top+=this.viewportTopOffset,i.height-=this.viewportTopOffset,t=t.getIntersection(i)}if(t&&e.top<t.top){const i=t.top;if(i+this._contentPanelRect.height+this.limiterBottomOffset>t.bottom){const r=Math.max(e.bottom-t.bottom,0)+this.limiterBottomOffset;e.bottom-r>e.top+this._contentPanelRect.height?this._stickToBottomOfLimiter(r):this._unstick()}else this._contentPanelRect.height+this.limiterBottomOffset<e.height?this._stickToTopOfAncestors(i):this._unstick()}else this._unstick()}_stickToTopOfAncestors(e){this.isSticky=!0,this._isStickyToTheBottomOfLimiter=!1,this._stickyTopOffset=e,this._stickyBottomOffset=null,this._marginLeft=toPx$3(-global$1.window.scrollX)}_stickToBottomOfLimiter(e){this.isSticky=!0,this._isStickyToTheBottomOfLimiter=!0,this._stickyTopOffset=null,this._stickyBottomOffset=e,this._marginLeft=toPx$3(-global$1.window.scrollX)}_unstick(){this.isSticky=!1,this._isStickyToTheBottomOfLimiter=!1,this._stickyTopOffset=null,this._stickyBottomOffset=null,this._marginLeft=null}get _contentPanelRect(){return new Rect(this.contentPanelElement)}},MenuBarMenuButtonView=class extends ListItemButtonView{arrowView;constructor(e){super(e);const t=this.bindTemplate;this.set({withText:!0,role:"menuitem"}),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__button"],"aria-haspopup":!0,"aria-expanded":this.bindTemplate.to("isOn",i=>String(i)),"data-cke-tooltip-disabled":t.to("isOn")},on:{mouseenter:t.to("mouseenter")}})}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new IconView;return e.content=dropdownArrowIcon,e.extendTemplate({attributes:{class:"ck-menu-bar__menu__button__arrow"}}),e}},MenuBarMenuPanelView=class extends View{children;constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-menu-bar__menu__panel",t.to("position",i=>`ck-menu-bar__menu__panel_position_${i}`),t.if("isVisible","ck-hidden",i=>!i)],tabindex:"-1"},children:this.children,on:{selectstart:t.to(i=>{i.target.tagName.toLocaleLowerCase()!=="input"&&i.preventDefault()})}})}focus(e=1){this.children.length&&(e===1?this.children.first.focus():this.children.last.focus())}},MenuBarMenuView=class Ts extends View{buttonView;panelView;focusTracker;keystrokes;constructor(t){super(t);const i=this.bindTemplate;this.buttonView=new MenuBarMenuButtonView(t),this.buttonView.delegate("mouseenter").to(this),this.buttonView.bind("isOn","isEnabled").to(this,"isOpen","isEnabled"),this.panelView=new MenuBarMenuPanelView(t),this.panelView.bind("isVisible").to(this,"isOpen"),this.keystrokes=new KeystrokeHandler,this.focusTracker=new FocusTracker,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("panelPosition","w"),this.set("class",void 0),this.set("parentMenuView",null),this.setTemplate({tag:"div",attributes:{class:["ck","ck-menu-bar__menu",i.to("class"),i.if("isEnabled","ck-disabled",r=>!r),i.if("parentMenuView","ck-menu-bar__menu_top-level",r=>!r)]},children:[this.buttonView,this.panelView]})}render(){super.render(),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.keystrokes.listenTo(this.element),MenuBarMenuBehaviors.closeOnEscKey(this),this._repositionPanelOnOpen()}_attachBehaviors(){this.parentMenuView?(MenuBarMenuBehaviors.openOnButtonClick(this),MenuBarMenuBehaviors.openOnArrowRightKey(this),MenuBarMenuBehaviors.closeOnArrowLeftKey(this),MenuBarMenuBehaviors.openAndFocusOnEnterKeyPress(this),MenuBarMenuBehaviors.closeOnParentClose(this)):(this._propagateArrowKeystrokeEvents(),MenuBarMenuBehaviors.openAndFocusPanelOnArrowDownKey(this),MenuBarMenuBehaviors.toggleOnButtonClick(this))}_propagateArrowKeystrokeEvents(){this.keystrokes.set("arrowright",(t,i)=>{this.fire("arrowright"),i()}),this.keystrokes.set("arrowleft",(t,i)=>{this.fire("arrowleft"),i()})}_repositionPanelOnOpen(){this.on("change:isOpen",(t,i,r)=>{if(!r)return;const o=Ts._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions});this.panelView.position=o?o.name:this._defaultMenuPositionName})}focus(){this.buttonView.focus()}get _panelPositions(){const{southEast:t,southWest:i,northEast:r,northWest:o,westSouth:a,eastSouth:c,westNorth:u,eastNorth:h}=MenuBarMenuViewPanelPositioningFunctions;return this.locale.uiLanguageDirection==="ltr"?this.parentMenuView?[c,h,a,u]:[t,i,r,o]:this.parentMenuView?[a,u,c,h]:[i,t,o,r]}get _defaultMenuPositionName(){return this.locale.uiLanguageDirection==="ltr"?this.parentMenuView?"es":"se":this.parentMenuView?"ws":"sw"}static _getOptimalPosition=getOptimalPosition},MenuBarMenuListView=class extends ListView{constructor(e){super(e),this.role="menu",this.items.on("change",this._setItemsCheckSpace.bind(this))}_setItemsCheckSpace(){const e=Array.from(this.items).some(t=>{const i=pickListButtonMenuViewIfPresent(t);return i&&i.isToggleable});this.items.forEach(t=>{const i=pickListButtonMenuViewIfPresent(t);i&&(i.hasCheckSpace=e)})}};function pickListButtonMenuViewIfPresent(e){return e instanceof ListItemView?e.children.map(t=>isNestedMenuLikeView(t)?t.buttonView:t).find(t=>t instanceof ListItemButtonView):null}function isNestedMenuLikeView(e){return typeof e=="object"&&"buttonView"in e&&e.buttonView instanceof ButtonView}var MenuBarMenuListItemFileDialogButtonView=class extends FileDialogListItemButtonView{constructor(e){super(e),this.set({withText:!0,withKeystroke:!0,tooltip:!1,role:"menuitem"}),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item__button"]}})}};const EVENT_NAME_DELEGATES=["mouseenter","arrowleft","arrowright","change:isOpen"];var MenuBarView=class extends View{children;menus=[];constructor(e){super(e);const t=e.t,i=this.bindTemplate;this.set({isOpen:!1,isFocusBorderEnabled:!1}),this._setupIsOpenUpdater(),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-menu-bar",i.if("isFocusBorderEnabled","ck-menu-bar_focus-border-enabled")],"aria-label":t("Editor menu bar"),role:"menubar"},children:this.children})}fillFromConfig(e,t,i=[]){const r=this.locale,a=processMenuBarConfig({normalizedConfig:e,locale:r,componentFactory:t,extraItems:i}).items.map(c=>this._createMenu({componentFactory:t,menuDefinition:c}));this.children.addMany(a)}render(){super.render(),MenuBarBehaviors.toggleMenusAndFocusItemsOnHover(this),MenuBarBehaviors.closeMenusWhenTheBarCloses(this),MenuBarBehaviors.closeMenuWhenAnotherOnTheSameLevelOpens(this),MenuBarBehaviors.focusCycleMenusOnArrows(this),MenuBarBehaviors.closeOnClickOutside(this),MenuBarBehaviors.enableFocusHighlightOnInteraction(this)}focus(){this.children.first&&this.children.first.focus()}close(){for(const e of this.children)e.isOpen=!1}registerMenu(e,t=null){t?(e.delegate(...EVENT_NAME_DELEGATES).to(t),e.parentMenuView=t):e.delegate(...EVENT_NAME_DELEGATES).to(this,i=>"menu:"+i),e._attachBehaviors(),this.menus.push(e)}_createMenu({componentFactory:e,menuDefinition:t,parentMenuView:i}){const r=this.locale,o=new MenuBarMenuView(r);return this.registerMenu(o,i),o.buttonView.set({label:t.label}),o.once("change:isOpen",()=>{const a=new MenuBarMenuListView(r);a.ariaLabel=t.label,o.panelView.children.add(a),a.items.addMany(this._createMenuItems({menuDefinition:t,parentMenuView:o,componentFactory:e}))}),o}_createMenuItems({menuDefinition:e,parentMenuView:t,componentFactory:i}){const r=this.locale,o=[];for(const a of e.groups){for(const c of a.items){const u=new MenuBarMenuListItemView(r,t);if(isObject_default(c))u.children.add(this._createMenu({componentFactory:i,menuDefinition:c,parentMenuView:t}));else{const h=this._createMenuItemContentFromFactory({componentName:c,componentFactory:i,parentMenuView:t});if(!h)continue;u.children.add(h)}o.push(u)}a!==e.groups[e.groups.length-1]&&o.push(new ListSeparatorView(r))}return o}_createMenuItemContentFromFactory({componentName:e,parentMenuView:t,componentFactory:i}){const r=i.create(e);return r instanceof MenuBarMenuView||r instanceof MenuBarMenuListItemButtonView||r instanceof MenuBarMenuListItemFileDialogButtonView?(this._registerMenuTree(r,t),r.on("execute",()=>{this.close()}),r):(logWarning("menu-bar-component-unsupported",{componentName:e,componentView:r}),null)}_registerMenuTree(e,t){if(!(e instanceof MenuBarMenuView)){e.delegate("mouseenter").to(t);return}this.registerMenu(e,t);const i=e.panelView.children.filter(o=>o instanceof MenuBarMenuListView)[0];if(!i){e.delegate("mouseenter").to(t);return}const r=i.items.filter(o=>o instanceof ListItemView);for(const o of r)this._registerMenuTree(o.children.get(0),e)}_setupIsOpenUpdater(){let e;this.on("menu:change:isOpen",(t,i,r)=>{clearTimeout(e),r?this.isOpen=!0:e=setTimeout(()=>{this.isOpen=Array.from(this.children).some(o=>o.isOpen)},0)})}},ChangeBuffer=class{model;limit;_isLocked;_size;_batch=null;_changeCallback;_selectionChangeCallback;constructor(e,t=20){this.model=e,this._size=0,this.limit=t,this._isLocked=!1,this._changeCallback=(i,r)=>{r.isLocal&&r.isUndoable&&r!==this._batch&&this._reset(!0)},this._selectionChangeCallback=()=>{this._reset()},this.model.document.on("change",this._changeCallback),this.model.document.selection.on("change:range",this._selectionChangeCallback),this.model.document.selection.on("change:attribute",this._selectionChangeCallback)}get batch(){return this._batch||(this._batch=this.model.createBatch({isTyping:!0})),this._batch}get size(){return this._size}input(e){this._size+=e,this._size>=this.limit&&this._reset(!0)}get isLocked(){return this._isLocked}lock(){this._isLocked=!0}unlock(){this._isLocked=!1}destroy(){this.model.document.off("change",this._changeCallback),this.model.document.selection.off("change:range",this._selectionChangeCallback),this.model.document.selection.off("change:attribute",this._selectionChangeCallback)}_reset(e=!1){(!this.isLocked||e)&&(this._batch=null,this._size=0)}},InsertTextCommand=class extends Command{_buffer;constructor(e,t){super(e),this._buffer=new ChangeBuffer(e.model,t),this._isEnabledBasedOnSelection=!1}get buffer(){return this._buffer}destroy(){super.destroy(),this._buffer.destroy()}execute(e={}){const t=this.editor.model,i=t.document,r=e.text||"",o=r.length;let a=i.selection;if(e.selection?a=e.selection:e.range&&(a=t.createSelection(e.range)),!t.canEditAt(a))return;const c=e.resultRange;t.enqueueChange(this._buffer.batch,u=>{this._buffer.lock();const h=Array.from(i.selection.getAttributes());t.deleteContent(a),r&&t.insertContent(u.createText(r,h),a),c?u.setSelection(c):a.is("documentSelection")||u.setSelection(a),this._buffer.unlock(),this._buffer.input(o)})}};const TYPING_INPUT_TYPES=["insertText","insertReplacementText"],TYPING_INPUT_TYPES_ANDROID=[...TYPING_INPUT_TYPES,"insertCompositionText"];var InsertTextObserver=class extends Observer{focusObserver;constructor(e){super(e),this.focusObserver=e.getObserver(FocusObserver);const t=env.isAndroid?TYPING_INPUT_TYPES_ANDROID:TYPING_INPUT_TYPES,i=e.document;i.on("beforeinput",(r,o)=>{if(!this.isEnabled)return;const{data:a,targetRanges:c,inputType:u,domEvent:h}=o;if(!t.includes(u))return;this.focusObserver.flush();const d=new EventInfo(i,"insertText");i.fire(d,new DomEventData(e,h,{text:a,selection:e.createSelection(c)})),d.stop.called&&r.stop()}),env.isAndroid||i.on("compositionend",(r,{data:o,domEvent:a})=>{this.isEnabled&&o&&i.fire("insertText",new DomEventData(e,a,{text:o}))},{priority:"lowest"})}observe(){}stopObserving(){}},Input=class extends Plugin{_compositionQueue;static get pluginName(){return"Input"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.model,i=e.editing.view,r=e.editing.mapper,o=t.document.selection;this._compositionQueue=new CompositionQueue(e),i.addObserver(InsertTextObserver);const a=new InsertTextCommand(e,e.config.get("typing.undoStep")||20);e.commands.add("insertText",a),e.commands.add("input",a),this.listenTo(i.document,"insertText",(c,u)=>{i.document.isComposing||u.preventDefault(),env.isAndroid&&i.document.isComposing&&this._compositionQueue.flush("next beforeinput");const{text:h,selection:d}=u;let f;d?f=Array.from(d.getRanges()).map(v=>r.toModelRange(v)):f=Array.from(o.getRanges());let m=h;if(env.isAndroid){const v=Array.from(f[0].getItems()).reduce((_,b)=>_+(b.is("$textProxy")?b.data:""),"");if(v&&(v.length<=m.length?m.startsWith(v)&&(m=m.substring(v.length),f[0].start=f[0].start.getShiftedBy(v.length)):v.startsWith(m)&&(f[0].start=f[0].start.getShiftedBy(m.length),m="")),m.length==0&&f[0].isCollapsed)return}const g={text:m,selection:t.createSelection(f)};env.isAndroid&&i.document.isComposing?this._compositionQueue.push(g):(e.execute("insertText",g),i.scrollToTheSelection())}),env.isAndroid?this.listenTo(i.document,"keydown",(c,u)=>{o.isCollapsed||u.keyCode!=229||!i.document.isComposing||deleteSelectionContent(t,a)}):this.listenTo(i.document,"compositionstart",()=>{o.isCollapsed||deleteSelectionContent(t,a)}),env.isAndroid?(this.listenTo(i.document,"mutations",(c,{mutations:u})=>{if(i.document.isComposing)for(const{node:h}of u){const d=findMappedViewAncestor(h,r),f=r.toModelElement(d);if(this._compositionQueue.isComposedElement(f)){this._compositionQueue.flush("mutations");return}}}),this.listenTo(i.document,"compositionend",()=>{this._compositionQueue.flush("composition end")}),this.listenTo(i.document,"compositionend",()=>{const c=[];for(const u of this._compositionQueue.flushComposedElements()){const h=r.toViewElement(u);h&&c.push({type:"children",node:h})}c.length&&i.document.fire("mutations",{mutations:c})},{priority:"lowest"})):this.listenTo(i.document,"compositionend",()=>{i.document.fire("mutations",{mutations:[]})},{priority:"lowest"})}destroy(){super.destroy(),this._compositionQueue.destroy()}},CompositionQueue=class{editor;flushDebounced=debounce_default(()=>this.flush("timeout"),50);_queue=[];_compositionElements=new Set;constructor(e){this.editor=e}destroy(){for(this.flushDebounced.cancel(),this._compositionElements.clear();this._queue.length;)this.shift()}get length(){return this._queue.length}push(e){const t={text:e.text};if(e.selection){t.selectionRanges=[];for(const i of e.selection.getRanges())t.selectionRanges.push(LiveRange.fromRange(i)),this._compositionElements.add(i.start.parent)}this._queue.push(t),this.flushDebounced()}shift(){const e=this._queue.shift(),t={text:e.text};if(e.selectionRanges){const i=e.selectionRanges.map(r=>detachLiveRange(r)).filter(r=>!!r);i.length&&(t.selection=this.editor.model.createSelection(i))}return t}flush(e){const t=this.editor,i=t.model,r=t.editing.view;if(this.flushDebounced.cancel(),!this._queue.length)return;const a=t.commands.get("insertText").buffer;i.enqueueChange(a.batch,()=>{for(a.lock();this._queue.length;){const c=this.shift();t.execute("insertText",c)}a.unlock()}),r.scrollToTheSelection()}isComposedElement(e){return this._compositionElements.has(e)}flushComposedElements(){const e=Array.from(this._compositionElements);return this._compositionElements.clear(),e}};function deleteSelectionContent(e,t){if(!t.isEnabled)return;const i=t.buffer;i.lock(),e.enqueueChange(i.batch,()=>{e.deleteContent(e.document.selection)}),i.unlock()}function detachLiveRange(e){const t=e.toRange();return e.detach(),t.root.rootName=="$graveyard"?null:t}function findMappedViewAncestor(e,t){let i=e.is("$text")?e.parent:e;for(;!t.toModelElement(i);)i=i.parent;return i}var DeleteCommand=class extends Command{direction;_buffer;constructor(e,t){super(e),this.direction=t,this._buffer=new ChangeBuffer(e.model,e.config.get("typing.undoStep")),this._isEnabledBasedOnSelection=!1}get buffer(){return this._buffer}execute(e={}){const t=this.editor.model,i=t.document;t.enqueueChange(this._buffer.batch,r=>{this._buffer.lock();const o=r.createSelection(e.selection||i.selection);if(!t.canEditAt(o))return;const a=e.sequence||1,c=o.isCollapsed;if(o.isCollapsed&&t.modifySelection(o,{direction:this.direction,unit:e.unit,treatEmojiAsSingleUnit:!0}),this._shouldEntireContentBeReplacedWithParagraph(a)){this._replaceEntireContentWithParagraph(r);return}if(this._shouldReplaceFirstBlockWithParagraph(o,a)){this.editor.execute("paragraph",{selection:o});return}if(o.isCollapsed)return;let u=0;o.getFirstRange().getMinimalFlatRanges().forEach(h=>{u+=count(h.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))}),t.deleteContent(o,{doNotResetEntireContent:c,direction:this.direction}),this._buffer.input(u),r.setSelection(o),this._buffer.unlock()})}_shouldEntireContentBeReplacedWithParagraph(e){if(e>1)return!1;const t=this.editor.model,r=t.document.selection,o=t.schema.getLimitElement(r);if(!(r.isCollapsed&&r.containsEntireContent(o))||!t.schema.checkChild(o,"paragraph"))return!1;const c=o.getChild(0);return!(c&&c.is("element","paragraph"))}_replaceEntireContentWithParagraph(e){const t=this.editor.model,r=t.document.selection,o=t.schema.getLimitElement(r),a=e.createElement("paragraph");e.remove(e.createRangeIn(o)),e.insert(a,o),e.setSelection(a,0)}_shouldReplaceFirstBlockWithParagraph(e,t){const i=this.editor.model;if(t>1||this.direction!="backward"||!e.isCollapsed)return!1;const r=e.getFirstPosition(),o=i.schema.getLimitElement(r),a=o.getChild(0);return!(r.parent!=a||!e.containsEntireContent(a)||!i.schema.checkChild(o,"paragraph")||a.name=="paragraph")}};const DELETE_CHARACTER="character",DELETE_WORD="word",DELETE_CODE_POINT="codePoint",DELETE_SELECTION="selection",DELETE_BACKWARD="backward",DELETE_FORWARD="forward",DELETE_EVENT_TYPES={deleteContent:{unit:DELETE_SELECTION,direction:DELETE_BACKWARD},deleteContentBackward:{unit:DELETE_CODE_POINT,direction:DELETE_BACKWARD},deleteWordBackward:{unit:DELETE_WORD,direction:DELETE_BACKWARD},deleteHardLineBackward:{unit:DELETE_SELECTION,direction:DELETE_BACKWARD},deleteSoftLineBackward:{unit:DELETE_SELECTION,direction:DELETE_BACKWARD},deleteContentForward:{unit:DELETE_CHARACTER,direction:DELETE_FORWARD},deleteWordForward:{unit:DELETE_WORD,direction:DELETE_FORWARD},deleteHardLineForward:{unit:DELETE_SELECTION,direction:DELETE_FORWARD},deleteSoftLineForward:{unit:DELETE_SELECTION,direction:DELETE_FORWARD}};var DeleteObserver=class extends Observer{constructor(e){super(e);const t=e.document;let i=0;t.on("keydown",()=>{i++}),t.on("keyup",()=>{i=0}),t.on("beforeinput",(r,o)=>{if(!this.isEnabled)return;const{targetRanges:a,domEvent:c,inputType:u}=o,h=DELETE_EVENT_TYPES[u];if(!h)return;const d={direction:h.direction,unit:h.unit,sequence:i};d.unit==DELETE_SELECTION&&(d.selectionToRemove=e.createSelection(a[0])),u==="deleteContentBackward"&&(env.isAndroid&&(d.sequence=1),shouldUseTargetRanges(a)&&(d.unit=DELETE_SELECTION,d.selectionToRemove=e.createSelection(a)));const f=new BubblingEventInfo(t,"delete",a[0]);t.fire(f,new DomEventData(e,c,d)),f.stop.called&&r.stop()}),env.isBlink&&enableChromeWorkaround(this)}observe(){}stopObserving(){}};function enableChromeWorkaround(e){const t=e.view,i=t.document;let r=null,o=!1;i.on("keydown",(u,{keyCode:h})=>{r=h,o=!1}),i.on("keyup",(u,{keyCode:h,domEvent:d})=>{const f=i.selection,m=e.isEnabled&&h==r&&a(h)&&!f.isCollapsed&&!o;if(r=null,m){const g=f.getFirstRange(),v=new BubblingEventInfo(i,"delete",g),_={unit:DELETE_SELECTION,direction:c(h),selectionToRemove:f};i.fire(v,new DomEventData(t,d,_))}}),i.on("beforeinput",(u,{inputType:h})=>{const d=DELETE_EVENT_TYPES[h];a(r)&&d&&d.direction==c(r)&&(o=!0)},{priority:"high"}),i.on("beforeinput",(u,{inputType:h,data:d})=>{r==keyCodes.delete&&h=="insertText"&&d=="\x7F"&&u.stop()},{priority:"high"});function a(u){return u==keyCodes.backspace||u==keyCodes.delete}function c(u){return u==keyCodes.backspace?DELETE_BACKWARD:DELETE_FORWARD}}function shouldUseTargetRanges(e){if(e.length!=1||e[0].isCollapsed)return!1;const t=e[0].getWalker({direction:"backward",singleCharacters:!0,ignoreElementEnd:!0});let i=0;for(const{nextPosition:r,item:o}of t){if(r.parent.is("$text")){const a=r.parent.data,c=r.offset;if(isInsideSurrogatePair(a,c)||isInsideCombinedSymbol(a,c)||isInsideEmojiSequence(a,c))continue;i++}else(o.is("containerElement")||o.is("emptyElement"))&&i++;if(i>1)return!0}return!1}var Delete=class extends Plugin{_undoOnBackspace;static get pluginName(){return"Delete"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.editing.view,i=t.document,r=e.model.document;t.addObserver(DeleteObserver),this._undoOnBackspace=!1;const o=new DeleteCommand(e,"forward");e.commands.add("deleteForward",o),e.commands.add("forwardDelete",o),e.commands.add("delete",new DeleteCommand(e,"backward")),this.listenTo(i,"delete",(a,c)=>{i.isComposing||c.preventDefault();const{direction:u,sequence:h,selectionToRemove:d,unit:f}=c,m=u==="forward"?"deleteForward":"delete",g={sequence:h};if(f=="selection"){const v=Array.from(d.getRanges()).map(_=>e.editing.mapper.toModelRange(_));g.selection=e.model.createSelection(v)}else g.unit=f;e.execute(m,g),t.scrollToTheSelection()},{priority:"low"}),this.editor.plugins.has("UndoEditing")&&(this.listenTo(i,"delete",(a,c)=>{this._undoOnBackspace&&c.direction=="backward"&&c.sequence==1&&c.unit=="codePoint"&&(this._undoOnBackspace=!1,e.execute("undo"),c.preventDefault(),a.stop())},{context:"$capture"}),this.listenTo(r,"change",()=>{this._undoOnBackspace=!1}))}requestUndoOnBackspace(){this.editor.plugins.has("UndoEditing")&&(this._undoOnBackspace=!0)}},Typing=class extends Plugin{static get requires(){return[Input,Delete]}static get pluginName(){return"Typing"}static get isOfficialPlugin(){return!0}};const TRANSFORMATIONS={copyright:{from:"(c)",to:"\xA9"},registeredTrademark:{from:"(r)",to:"\xAE"},trademark:{from:"(tm)",to:"\u2122"},oneHalf:{from:/(^|[^/a-z0-9])(1\/2)([^/a-z0-9])$/i,to:[null,"\xBD",null]},oneThird:{from:/(^|[^/a-z0-9])(1\/3)([^/a-z0-9])$/i,to:[null,"\u2153",null]},twoThirds:{from:/(^|[^/a-z0-9])(2\/3)([^/a-z0-9])$/i,to:[null,"\u2154",null]},oneForth:{from:/(^|[^/a-z0-9])(1\/4)([^/a-z0-9])$/i,to:[null,"\xBC",null]},threeQuarters:{from:/(^|[^/a-z0-9])(3\/4)([^/a-z0-9])$/i,to:[null,"\xBE",null]},lessThanOrEqual:{from:"<=",to:"\u2264"},greaterThanOrEqual:{from:">=",to:"\u2265"},notEqual:{from:"!=",to:"\u2260"},arrowLeft:{from:"<-",to:"\u2190"},arrowRight:{from:"->",to:"\u2192"},horizontalEllipsis:{from:"...",to:"\u2026"},enDash:{from:/(^| )(--)( )$/,to:[null,"\u2013",null]},emDash:{from:/(^| )(---)( )$/,to:[null,"\u2014",null]},quotesPrimary:{from:buildQuotesRegExp('"'),to:[null,"\u201C",null,"\u201D"]},quotesSecondary:{from:buildQuotesRegExp("'"),to:[null,"\u2018",null,"\u2019"]},quotesPrimaryEnGb:{from:buildQuotesRegExp("'"),to:[null,"\u2018",null,"\u2019"]},quotesSecondaryEnGb:{from:buildQuotesRegExp('"'),to:[null,"\u201C",null,"\u201D"]},quotesPrimaryPl:{from:buildQuotesRegExp('"'),to:[null,"\u201E",null,"\u201D"]},quotesSecondaryPl:{from:buildQuotesRegExp("'"),to:[null,"\u201A",null,"\u2019"]}};function buildQuotesRegExp(e){return new RegExp(`(^|\\s)(${e})([^${e}]*)(${e})$`)}var AttributeCommand=class extends Command{attributeKey;constructor(e,t){super(e),this.attributeKey=t}refresh(){const e=this.editor.model,t=e.document;this.value=this._getValueFromFirstAllowedNode(),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,this.attributeKey)}execute(e={}){const t=this.editor.model,r=t.document.selection,o=e.forceValue===void 0?!this.value:e.forceValue;t.change(a=>{if(r.isCollapsed)o?a.setSelectionAttribute(this.attributeKey,!0):a.removeSelectionAttribute(this.attributeKey);else{const c=t.schema.getValidRanges(r.getRanges(),this.attributeKey);for(const u of c)o?a.setAttribute(this.attributeKey,o,u):a.removeAttribute(this.attributeKey,u)}})}_getValueFromFirstAllowedNode(){const e=this.editor.model,t=e.schema,i=e.document.selection;if(i.isCollapsed)return i.hasAttribute(this.attributeKey);for(const r of i.getRanges())for(const o of r.getItems())if(t.checkAttribute(o,this.attributeKey))return o.hasAttribute(this.attributeKey);return!1}};const BOLD$1="bold";var BoldEditing=class extends Plugin{static get pluginName(){return"BoldEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=this.editor.t;e.model.schema.extend("$text",{allowAttributes:BOLD$1}),e.model.schema.setAttributeProperties(BOLD$1,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:BOLD$1,view:"strong",upcastAlso:["b",i=>{const r=i.getStyle("font-weight");return r&&(r=="bold"||Number(r)>=600)?{name:!0,styles:["font-weight"]}:null}]}),e.commands.add(BOLD$1,new AttributeCommand(e,BOLD$1)),e.keystrokes.set("CTRL+B",BOLD$1),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Bold text"),keystroke:"CTRL+B"}]})}};function getButtonCreator({editor:e,commandName:t,plugin:i,icon:r,label:o,keystroke:a}){return c=>{const u=e.commands.get(t),h=new c(e.locale);return h.set({label:o,icon:r,keystroke:a,isToggleable:!0}),h.bind("isEnabled").to(u,"isEnabled"),h.bind("isOn").to(u,"value"),h instanceof MenuBarMenuListItemButtonView?h.set({role:"menuitemcheckbox"}):h.set({tooltip:!0}),i.listenTo(h,"execute",()=>{e.execute(t),e.editing.view.focus()}),h}}const BOLD="bold";var BoldUI=class extends Plugin{static get pluginName(){return"BoldUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.locale.t,i=getButtonCreator({editor:e,commandName:BOLD,plugin:this,icon:icons.bold,label:t("Bold"),keystroke:"CTRL+B"});e.ui.componentFactory.add(BOLD,()=>i(ButtonView)),e.ui.componentFactory.add("menuBar:"+BOLD,()=>i(MenuBarMenuListItemButtonView))}},Bold=class extends Plugin{static get requires(){return[BoldEditing,BoldUI]}static get pluginName(){return"Bold"}static get isOfficialPlugin(){return!0}};const ITALIC$1="italic";var ItalicEditing=class extends Plugin{static get pluginName(){return"ItalicEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=this.editor.t;e.model.schema.extend("$text",{allowAttributes:ITALIC$1}),e.model.schema.setAttributeProperties(ITALIC$1,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:ITALIC$1,view:"i",upcastAlso:["em",{styles:{"font-style":"italic"}}]}),e.commands.add(ITALIC$1,new AttributeCommand(e,ITALIC$1)),e.keystrokes.set("CTRL+I",ITALIC$1),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Italic text"),keystroke:"CTRL+I"}]})}},italicIcon='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.586 14.633.021.004c-.036.335.095.655.393.962.082.083.173.15.274.201h1.474a.6.6 0 1 1 0 1.2H5.304a.6.6 0 0 1 0-1.2h1.15c.474-.07.809-.182 1.005-.334.157-.122.291-.32.404-.597l2.416-9.55a1.053 1.053 0 0 0-.281-.823 1.12 1.12 0 0 0-.442-.296H8.15a.6.6 0 0 1 0-1.2h6.443a.6.6 0 1 1 0 1.2h-1.195c-.376.056-.65.155-.823.296-.215.175-.423.439-.623.79l-2.366 9.347z"/></svg>';const ITALIC="italic";var ItalicUI=class extends Plugin{static get pluginName(){return"ItalicUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.locale.t,i=getButtonCreator({editor:e,commandName:ITALIC,plugin:this,icon:italicIcon,keystroke:"CTRL+I",label:t("Italic")});e.ui.componentFactory.add(ITALIC,()=>i(ButtonView)),e.ui.componentFactory.add("menuBar:"+ITALIC,()=>i(MenuBarMenuListItemButtonView))}},Italic=class extends Plugin{static get requires(){return[ItalicEditing,ItalicUI]}static get pluginName(){return"Italic"}static get isOfficialPlugin(){return!0}};/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function*getCopyOnEnterAttributes(e,t){for(const i of t)i&&e.getAttributeProperties(i[0]).copyOnEnter&&(yield i)}var EnterCommand=class extends Command{execute(){this.editor.model.change(e=>{this.enterBlock(e),this.fire("afterExecute",{writer:e})})}enterBlock(e){const t=this.editor.model,i=t.document.selection,r=t.schema,o=i.isCollapsed,a=i.getFirstRange(),c=a.start.parent,u=a.end.parent;if(r.isLimit(c)||r.isLimit(u))return!o&&c==u&&t.deleteContent(i),!1;if(o){const h=getCopyOnEnterAttributes(e.model.schema,i.getAttributes());return splitBlock(e,a.start),e.setSelectionAttribute(h),!0}else{const h=!(a.start.isAtStart&&a.end.isAtEnd),d=c==u;if(t.deleteContent(i,{leaveUnmerged:h}),h){if(d)return splitBlock(e,i.focus),!0;e.setSelection(u,0)}}return!1}};function splitBlock(e,t){e.split(t),e.setSelection(t.parent.nextSibling,0)}const ENTER_EVENT_TYPES={insertParagraph:{isSoft:!1},insertLineBreak:{isSoft:!0}};var EnterObserver=class extends Observer{constructor(e){super(e);const t=this.document;let i=!1;t.on("keydown",(r,o)=>{i=o.shiftKey}),t.on("beforeinput",(r,o)=>{if(!this.isEnabled)return;let a=o.inputType;env.isSafari&&i&&a=="insertParagraph"&&(a="insertLineBreak");const c=o.domEvent,u=ENTER_EVENT_TYPES[a];if(!u)return;const h=new BubblingEventInfo(t,"enter",o.targetRanges[0]);t.fire(h,new DomEventData(e,c,{isSoft:u.isSoft})),h.stop.called&&r.stop()})}observe(){}stopObserving(){}},Enter=class extends Plugin{static get pluginName(){return"Enter"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.editing.view,i=t.document,r=this.editor.t;t.addObserver(EnterObserver),e.commands.add("enter",new EnterCommand(e)),this.listenTo(i,"enter",(o,a)=>{i.isComposing||a.preventDefault(),!a.isSoft&&(e.execute("enter"),t.scrollToTheSelection())},{priority:"low"}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:r("Insert a hard break (a new paragraph)"),keystroke:"Enter"}]})}},ShiftEnterCommand=class extends Command{execute(){const e=this.editor.model,t=e.document;e.change(i=>{softBreakAction(e,i,t.selection),this.fire("afterExecute",{writer:i})})}refresh(){const e=this.editor.model,t=e.document;this.isEnabled=isEnabled(e.schema,t.selection)}};function isEnabled(e,t){if(t.rangeCount>1)return!1;const i=t.anchor;if(!i||!e.checkChild(i,"softBreak"))return!1;const r=t.getFirstRange(),o=r.start.parent,a=r.end.parent;return!((isInsideLimitElement(o,e)||isInsideLimitElement(a,e))&&o!==a)}function softBreakAction(e,t,i){const r=i.isCollapsed,o=i.getFirstRange(),a=o.start.parent,c=o.end.parent,u=a==c;if(r){const h=getCopyOnEnterAttributes(e.schema,i.getAttributes());insertBreak(e,t,o.end),t.removeSelectionAttribute(i.getAttributeKeys()),t.setSelectionAttribute(h)}else{const h=!(o.start.isAtStart&&o.end.isAtEnd);e.deleteContent(i,{leaveUnmerged:h}),u?insertBreak(e,t,i.focus):h&&t.setSelection(c,0)}}function insertBreak(e,t,i){const r=t.createElement("softBreak");e.insertContent(r,i),t.setSelection(r,"after")}function isInsideLimitElement(e,t){return e.is("rootElement")?!1:t.isLimit(e)||isInsideLimitElement(e.parent,t)}var ShiftEnter=class extends Plugin{static get pluginName(){return"ShiftEnter"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.model.schema,i=e.conversion,r=e.editing.view,o=r.document,a=this.editor.t;t.register("softBreak",{allowWhere:"$text",isInline:!0}),i.for("upcast").elementToElement({model:"softBreak",view:"br"}),i.for("downcast").elementToElement({model:"softBreak",view:(c,{writer:u})=>u.createEmptyElement("br")}),r.addObserver(EnterObserver),e.commands.add("shiftEnter",new ShiftEnterCommand(e)),this.listenTo(o,"enter",(c,u)=>{o.isComposing||u.preventDefault(),u.isSoft&&(e.execute("shiftEnter"),r.scrollToTheSelection())},{priority:"low"}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:a("Insert a soft break (a <code>&lt;br&gt;</code> element)"),keystroke:"Shift+Enter"}]})}};const WIDGET_SELECTED_CLASS_NAME="ck-widget_selected";function isWidget(e){return e.is("element")?!!e.getCustomProperty("widget"):!1}function getLabel(e){return e.getCustomProperty("widgetLabel").reduce((i,r)=>typeof r=="function"?i?i+". "+r():r():i?i+". "+r:r,"")}const TYPE_AROUND_SELECTION_ATTRIBUTE="widget-type-around";function isTypeAroundWidget(e,t,i){return!!e&&isWidget(e)&&!i.isInline(t)}function getClosestTypeAroundDomButton(e){return e.closest(".ck-widget__type-around__button")}function getTypeAroundButtonPosition(e){return e.classList.contains("ck-widget__type-around__button_before")?"before":"after"}function getClosestWidgetViewElement(e,t){const i=e.closest(".ck-widget");return t.mapDomToView(i)}function getTypeAroundFakeCaretPosition(e){return e.getAttribute(TYPE_AROUND_SELECTION_ATTRIBUTE)}var returnIcon='<svg viewBox="0 0 10 8" xmlns="http://www.w3.org/2000/svg"><path d="M9.055.263v3.972h-6.77M1 4.216l2-2.038m-2 2 2 2.038"/></svg>';const POSSIBLE_INSERTION_POSITIONS=["before","after"],RETURN_ARROW_ICON_ELEMENT=new DOMParser().parseFromString(returnIcon,"image/svg+xml").firstChild,PLUGIN_DISABLED_EDITING_ROOT_CLASS="ck-widget__type-around_disabled";var WidgetTypeAround=class extends Plugin{_currentFakeCaretModelElement=null;static get pluginName(){return"WidgetTypeAround"}static get isOfficialPlugin(){return!0}static get requires(){return[Enter,Delete]}init(){const e=this.editor,t=e.editing.view;this.on("change:isEnabled",(i,r,o)=>{t.change(a=>{for(const c of t.document.roots)o?a.removeClass(PLUGIN_DISABLED_EDITING_ROOT_CLASS,c):a.addClass(PLUGIN_DISABLED_EDITING_ROOT_CLASS,c)}),o||e.model.change(a=>{a.removeSelectionAttribute(TYPE_AROUND_SELECTION_ATTRIBUTE)})}),this._enableTypeAroundUIInjection(),this._enableInsertingParagraphsOnButtonClick(),this._enableInsertingParagraphsOnEnterKeypress(),this._enableInsertingParagraphsOnTypingKeystroke(),this._enableTypeAroundFakeCaretActivationUsingKeyboardArrows(),this._enableDeleteIntegration(),this._enableInsertContentIntegration(),this._enableInsertObjectIntegration(),this._enableDeleteContentIntegration()}destroy(){super.destroy(),this._currentFakeCaretModelElement=null}_insertParagraph(e,t){const i=this.editor,r=i.editing.view,o=i.model.schema.getAttributesWithProperty(e,"copyOnReplace",!0);i.execute("insertParagraph",{position:i.model.createPositionAt(e,t),attributes:o}),r.focus(),r.scrollToTheSelection()}_listenToIfEnabled(e,t,i,r){this.listenTo(e,t,(...o)=>{this.isEnabled&&i(...o)},r)}_insertParagraphAccordingToFakeCaretPosition(){const i=this.editor.model.document.selection,r=getTypeAroundFakeCaretPosition(i);if(!r)return!1;const o=i.getSelectedElement();return this._insertParagraph(o,r),!0}_enableTypeAroundUIInjection(){const e=this.editor,t=e.model.schema,i=e.locale.t,r={before:i("Insert paragraph before block"),after:i("Insert paragraph after block")};e.editing.downcastDispatcher.on("insert",(o,a,c)=>{const u=c.mapper.toViewElement(a.item);u&&isTypeAroundWidget(u,a.item,t)&&(injectUIIntoWidget(c.writer,r,u),u.getCustomProperty("widgetLabel").push(()=>this.isEnabled?i("Press Enter to type after or press Shift + Enter to type before the widget"):""))},{priority:"low"})}_enableTypeAroundFakeCaretActivationUsingKeyboardArrows(){const e=this.editor,t=e.model,i=t.document.selection,r=t.schema,o=e.editing.view;this._listenToIfEnabled(o.document,"arrowKey",(c,u)=>{this._handleArrowKeyPress(c,u)},{context:[isWidget,"$text"],priority:"high"}),this._listenToIfEnabled(i,"change:range",(c,u)=>{u.directChange&&e.model.change(h=>{h.removeSelectionAttribute(TYPE_AROUND_SELECTION_ATTRIBUTE)})}),this._listenToIfEnabled(t.document,"change:data",()=>{const c=i.getSelectedElement();if(c){const u=e.editing.mapper.toViewElement(c);if(isTypeAroundWidget(u,c,r))return}e.model.change(u=>{u.removeSelectionAttribute(TYPE_AROUND_SELECTION_ATTRIBUTE)})}),this._listenToIfEnabled(e.editing.downcastDispatcher,"selection",(c,u,h)=>{const d=h.writer;if(this._currentFakeCaretModelElement){const v=h.mapper.toViewElement(this._currentFakeCaretModelElement);v&&(d.removeClass(POSSIBLE_INSERTION_POSITIONS.map(a),v),this._currentFakeCaretModelElement=null)}const f=u.selection.getSelectedElement();if(!f)return;const m=h.mapper.toViewElement(f);if(!isTypeAroundWidget(m,f,r))return;const g=getTypeAroundFakeCaretPosition(u.selection);g&&(d.addClass(a(g),m),this._currentFakeCaretModelElement=f)}),this._listenToIfEnabled(e.ui.focusTracker,"change:isFocused",(c,u,h)=>{h||e.model.change(d=>{d.removeSelectionAttribute(TYPE_AROUND_SELECTION_ATTRIBUTE)})});function a(c){return`ck-widget_type-around_show-fake-caret_${c}`}}_handleArrowKeyPress(e,t){const i=this.editor,r=i.model,o=r.document.selection,a=r.schema,c=i.editing.view,u=t.keyCode,h=isForwardArrowKeyCode(u,i.locale.contentLanguageDirection),d=c.document.selection.getSelectedElement(),f=i.editing.mapper.toModelElement(d);let m;isTypeAroundWidget(d,f,a)?m=this._handleArrowKeyPressOnSelectedWidget(h):o.isCollapsed?m=this._handleArrowKeyPressWhenSelectionNextToAWidget(h):t.shiftKey||(m=this._handleArrowKeyPressWhenNonCollapsedSelection(h)),m&&(t.preventDefault(),e.stop())}_handleArrowKeyPressOnSelectedWidget(e){const i=this.editor.model,r=i.document.selection,o=getTypeAroundFakeCaretPosition(r);return i.change(a=>{if(o){if(!(o===(e?"after":"before")))return a.removeSelectionAttribute(TYPE_AROUND_SELECTION_ATTRIBUTE),!0}else return a.setSelectionAttribute(TYPE_AROUND_SELECTION_ATTRIBUTE,e?"after":"before"),!0;return!1})}_handleArrowKeyPressWhenSelectionNextToAWidget(e){const t=this.editor,i=t.model,r=i.schema,o=t.plugins.get("Widget"),a=o._getObjectElementNextToSelection(e),c=t.editing.mapper.toViewElement(a);return isTypeAroundWidget(c,a,r)?(i.change(u=>{o._setSelectionOverElement(a),u.setSelectionAttribute(TYPE_AROUND_SELECTION_ATTRIBUTE,e?"before":"after")}),!0):!1}_handleArrowKeyPressWhenNonCollapsedSelection(e){const t=this.editor,i=t.model,r=i.schema,o=t.editing.mapper,a=i.document.selection,c=e?a.getLastPosition().nodeBefore:a.getFirstPosition().nodeAfter,u=o.toViewElement(c);return isTypeAroundWidget(u,c,r)?(i.change(h=>{h.setSelection(c,"on"),h.setSelectionAttribute(TYPE_AROUND_SELECTION_ATTRIBUTE,e?"after":"before")}),!0):!1}_enableInsertingParagraphsOnButtonClick(){const e=this.editor,t=e.editing.view;this._listenToIfEnabled(t.document,"mousedown",(i,r)=>{const o=getClosestTypeAroundDomButton(r.domTarget);if(!o)return;const a=getTypeAroundButtonPosition(o),c=getClosestWidgetViewElement(o,t.domConverter),u=e.editing.mapper.toModelElement(c);this._insertParagraph(u,a),r.preventDefault(),i.stop()})}_enableInsertingParagraphsOnEnterKeypress(){const e=this.editor,t=e.model.document.selection,i=e.editing.view;this._listenToIfEnabled(i.document,"enter",(r,o)=>{if(r.eventPhase!="atTarget")return;const a=t.getSelectedElement(),c=e.editing.mapper.toViewElement(a),u=e.model.schema;let h;this._insertParagraphAccordingToFakeCaretPosition()?h=!0:isTypeAroundWidget(c,a,u)&&(this._insertParagraph(a,o.isSoft?"before":"after"),h=!0),h&&(o.preventDefault(),r.stop())},{context:isWidget})}_enableInsertingParagraphsOnTypingKeystroke(){const t=this.editor.editing.view.document;this._listenToIfEnabled(t,"insertText",(i,r)=>{this._insertParagraphAccordingToFakeCaretPosition()&&(r.selection=t.selection)},{priority:"high"}),env.isAndroid?this._listenToIfEnabled(t,"keydown",(i,r)=>{r.keyCode==229&&this._insertParagraphAccordingToFakeCaretPosition()}):this._listenToIfEnabled(t,"compositionstart",()=>{this._insertParagraphAccordingToFakeCaretPosition()},{priority:"high"})}_enableDeleteIntegration(){const e=this.editor,t=e.editing.view,i=e.model,r=i.schema;this._listenToIfEnabled(t.document,"delete",(o,a)=>{if(o.eventPhase!="atTarget")return;const c=getTypeAroundFakeCaretPosition(i.document.selection);if(!c)return;const u=a.direction,h=i.document.selection.getSelectedElement(),d=c==="before",f=u=="forward";if(d===f)e.execute("delete",{selection:i.createSelection(h,"on")});else{const g=r.getNearestSelectionRange(i.createPositionAt(h,c),u);if(g)if(!g.isCollapsed)i.change(v=>{v.setSelection(g),e.execute(f?"deleteForward":"delete")});else{const v=i.createSelection(g.start);if(i.modifySelection(v,{direction:u}),!v.focus.isEqual(g.start))i.change(_=>{_.setSelection(g),e.execute(f?"deleteForward":"delete")});else{const _=getDeepestEmptyElementAncestor(r,g.start.parent);i.deleteContent(i.createSelection(_,"on"),{doNotAutoparagraph:!0})}}}a.preventDefault(),o.stop()},{context:isWidget})}_enableInsertContentIntegration(){const e=this.editor,t=this.editor.model,i=t.document.selection;this._listenToIfEnabled(e.model,"insertContent",(r,[o,a])=>{if(a&&!a.is("documentSelection"))return;const c=getTypeAroundFakeCaretPosition(i);if(c)return r.stop(),t.change(u=>{const h=i.getSelectedElement(),d=t.createPositionAt(h,c),f=u.createSelection(d),m=t.insertContent(o,f);return u.setSelection(f),m})},{priority:"high"})}_enableInsertObjectIntegration(){const e=this.editor,i=this.editor.model.document.selection;this._listenToIfEnabled(e.model,"insertObject",(r,o)=>{const[,a,c={}]=o;if(a&&!a.is("documentSelection"))return;const u=getTypeAroundFakeCaretPosition(i);u&&(c.findOptimalPosition=u,o[3]=c)},{priority:"high"})}_enableDeleteContentIntegration(){const e=this.editor,i=this.editor.model.document.selection;this._listenToIfEnabled(e.model,"deleteContent",(r,[o])=>{if(o&&!o.is("documentSelection"))return;getTypeAroundFakeCaretPosition(i)&&r.stop()},{priority:"high"})}};function injectUIIntoWidget(e,t,i){const r=e.createUIElement("div",{class:"ck ck-reset_all ck-widget__type-around"},function(o){const a=this.toDomElement(o);return injectButtons(a,t),injectFakeCaret(a),a});e.insert(e.createPositionAt(i,"end"),r)}function injectButtons(e,t){for(const i of POSSIBLE_INSERTION_POSITIONS){const r=new Template({tag:"div",attributes:{class:["ck","ck-widget__type-around__button",`ck-widget__type-around__button_${i}`],title:t[i],"aria-hidden":"true"},children:[e.ownerDocument.importNode(RETURN_ARROW_ICON_ELEMENT,!0)]});e.appendChild(r.render())}}function injectFakeCaret(e){const t=new Template({tag:"div",attributes:{class:["ck","ck-widget__type-around__fake-caret"]}});e.appendChild(t.render())}function getDeepestEmptyElementAncestor(e,t){let i=t;for(const r of t.getAncestors({parentFirst:!0})){if(r.childCount>1||e.isLimit(r))break;i=r}return i}function verticalNavigationHandler(e){const t=e.model;return(i,r)=>{const o=r.keyCode==keyCodes.arrowup,a=r.keyCode==keyCodes.arrowdown,c=r.shiftKey,u=t.document.selection;if(!o&&!a)return;const h=a;if(c&&selectionWillShrink(u,h))return;const d=findTextRangeFromSelection(e,u,h);if(d){if(d.isCollapsed){if(u.isCollapsed)return;if(c)return}(d.isCollapsed||isSingleLineRange(e,d,h))&&(t.change(f=>{const m=h?d.end:d.start;if(c){const g=t.createSelection(u.anchor);g.setFocus(m),f.setSelection(g)}else f.setSelection(m)}),i.stop(),r.preventDefault(),r.stopPropagation())}}}function findTextRangeFromSelection(e,t,i){const r=e.model;if(i){const o=t.isCollapsed?t.focus:t.getLastPosition(),a=getNearestNonInlineLimit(r,o,"forward");if(!a)return null;const c=r.createRange(o,a),u=getNearestTextPosition(r.schema,c,"backward");return u?r.createRange(o,u):null}else{const o=t.isCollapsed?t.focus:t.getFirstPosition(),a=getNearestNonInlineLimit(r,o,"backward");if(!a)return null;const c=r.createRange(a,o),u=getNearestTextPosition(r.schema,c,"forward");return u?r.createRange(u,o):null}}function getNearestNonInlineLimit(e,t,i){const r=e.schema,o=e.createRangeIn(t.root),a=i=="forward"?"elementStart":"elementEnd";for(const{previousPosition:c,item:u,type:h}of o.getWalker({startPosition:t,direction:i})){if(r.isLimit(u)&&!r.isInline(u))return c;if(h==a&&r.isBlock(u))return null}return null}function getNearestTextPosition(e,t,i){const r=i=="backward"?t.end:t.start;if(e.checkChild(r,"$text"))return r;for(const{nextPosition:o}of t.getWalker({direction:i}))if(e.checkChild(o,"$text"))return o;return null}function isSingleLineRange(e,t,i){const r=e.model,o=e.view.domConverter;if(i){const d=r.createSelection(t.start);r.modifySelection(d),!d.focus.isAtEnd&&!t.start.isEqual(d.focus)&&(t=r.createRange(d.focus,t.end))}const a=e.mapper.toViewRange(t),c=o.viewRangeToDom(a),u=Rect.getDomRangeRects(c);let h;for(const d of u){if(h===void 0){h=Math.round(d.bottom);continue}if(Math.round(d.top)>=h)return!1;h=Math.max(h,Math.round(d.bottom))}return!0}function selectionWillShrink(e,t){return!e.isCollapsed&&e.isBackward==t}var Widget=class extends Plugin{_previouslySelected=new Set;static get pluginName(){return"Widget"}static get isOfficialPlugin(){return!0}static get requires(){return[WidgetTypeAround,Delete]}init(){const e=this.editor,t=e.editing.view,i=t.document,r=e.t;this.editor.editing.downcastDispatcher.on("selection",(o,a,c)=>{const u=c.writer,h=a.selection;if(h.isCollapsed)return;const d=h.getSelectedElement();if(!d)return;const f=e.editing.mapper.toViewElement(d);isWidget(f)&&c.consumable.consume(h,"selection")&&u.setSelection(u.createRangeOn(f),{fake:!0,label:getLabel(f)})}),this.editor.editing.downcastDispatcher.on("selection",(o,a,c)=>{this._clearPreviouslySelectedWidgets(c.writer);const u=c.writer,h=u.document.selection;let d=null;for(const f of h.getRanges())for(const m of f){const g=m.item;isWidget(g)&&!isChild(g,d)&&(u.addClass(WIDGET_SELECTED_CLASS_NAME,g),this._previouslySelected.add(g),d=g)}},{priority:"low"}),t.addObserver(MouseObserver),this.listenTo(i,"mousedown",(...o)=>this._onMousedown(...o)),this.listenTo(i,"arrowKey",(...o)=>{this._handleSelectionChangeOnArrowKeyPress(...o)},{context:[isWidget,"$text"]}),this.listenTo(i,"arrowKey",(...o)=>{this._preventDefaultOnArrowKeyPress(...o)},{context:"$root"}),this.listenTo(i,"arrowKey",verticalNavigationHandler(this.editor.editing),{context:"$text"}),this.listenTo(i,"delete",(o,a)=>{this._handleDelete(a.direction=="forward")&&(a.preventDefault(),o.stop())},{context:"$root"}),this.listenTo(i,"tab",(o,a)=>{o.eventPhase=="atTarget"&&(a.shiftKey||this._selectFirstNestedEditable()&&(a.preventDefault(),o.stop()))},{context:isWidget,priority:"low"}),this.listenTo(i,"tab",(o,a)=>{a.shiftKey&&this._selectAncestorWidget()&&(a.preventDefault(),o.stop())},{priority:"low"}),this.listenTo(i,"keydown",(o,a)=>{a.keystroke==keyCodes.esc&&this._selectAncestorWidget()&&(a.preventDefault(),o.stop())},{priority:"low"}),e.accessibility.addKeystrokeInfoGroup({id:"widget",label:r("Keystrokes that can be used when a widget is selected (for example: image, table, etc.)"),keystrokes:[{label:r("Move focus from an editable area back to the parent widget"),keystroke:"Esc"},{label:r("Insert a new paragraph directly after a widget"),keystroke:"Enter"},{label:r("Insert a new paragraph directly before a widget"),keystroke:"Shift+Enter"},{label:r("Move the caret to allow typing directly before a widget"),keystroke:[["arrowup"],["arrowleft"]]},{label:r("Move the caret to allow typing directly after a widget"),keystroke:[["arrowdown"],["arrowright"]]}]})}_onMousedown(e,t){const i=this.editor,r=i.editing.view,o=r.document;let a=t.target;if(!a)return;if(t.domEvent.detail>=3){this._selectBlockContent(a)&&t.preventDefault();return}if(!isWidget(a)){const u=findClosestEditableOrWidgetAncestor(a);if(!u)return;if(isWidget(u))a=u;else{const h=getElementFromMouseEvent(r,t);if(h&&isWidget(h))a=h;else return}}env.isAndroid&&t.preventDefault(),o.isFocused||r.focus();const c=i.editing.mapper.toModelElement(a);this._setSelectionOverElement(c)}_selectBlockContent(e){const t=this.editor,i=t.model,r=t.editing.mapper,o=i.schema,a=r.findMappedViewAncestor(this.editor.editing.view.createPositionAt(e,0)),c=findTextBlockAncestor(r.toModelElement(a),i.schema);return c?(i.change(u=>{const h=o.isLimit(c)?null:findNextTextBlock(u.createPositionAfter(c),o),d=u.createPositionAt(c,0),f=h?u.createPositionAt(h,0):u.createPositionAt(c,"end");u.setSelection(u.createRange(d,f))}),!0):!1}_handleSelectionChangeOnArrowKeyPress(e,t){const i=t.keyCode,r=this.editor.model,o=r.schema,a=r.document.selection,c=a.getSelectedElement(),u=getLocalizedArrowKeyCodeDirection(i,this.editor.locale.contentLanguageDirection),h=u=="down"||u=="right",d=u=="up"||u=="down";if(c&&o.isObject(c)){const m=h?a.getLastPosition():a.getFirstPosition(),g=o.getNearestSelectionRange(m,h?"forward":"backward");g&&(r.change(v=>{v.setSelection(g)}),t.preventDefault(),e.stop());return}if(!a.isCollapsed&&!t.shiftKey){const m=a.getFirstPosition(),g=a.getLastPosition(),v=m.nodeAfter,_=g.nodeBefore;(v&&o.isObject(v)||_&&o.isObject(_))&&(r.change(b=>{b.setSelection(h?g:m)}),t.preventDefault(),e.stop());return}if(!a.isCollapsed)return;const f=this._getObjectElementNextToSelection(h);if(f&&o.isObject(f)){if(o.isInline(f)&&d)return;this._setSelectionOverElement(f),t.preventDefault(),e.stop()}}_preventDefaultOnArrowKeyPress(e,t){const i=this.editor.model,r=i.schema,o=i.document.selection.getSelectedElement();o&&r.isObject(o)&&(t.preventDefault(),e.stop())}_handleDelete(e){const i=this.editor.model.document.selection;if(!this.editor.model.canEditAt(i)||!i.isCollapsed)return;const r=this._getObjectElementNextToSelection(e);if(r)return this.editor.model.change(o=>{let a=i.anchor.parent;for(;a.isEmpty;){const c=a;a=c.parent,o.remove(c)}this._setSelectionOverElement(r)}),!0}_setSelectionOverElement(e){this.editor.model.change(t=>{t.setSelection(t.createRangeOn(e))})}_getObjectElementNextToSelection(e){const t=this.editor.model,i=t.schema,r=t.document.selection,o=t.createSelection(r);if(t.modifySelection(o,{direction:e?"forward":"backward"}),o.isEqual(r))return null;const a=e?o.focus.nodeBefore:o.focus.nodeAfter;return a&&i.isObject(a)?a:null}_clearPreviouslySelectedWidgets(e){for(const t of this._previouslySelected)e.removeClass(WIDGET_SELECTED_CLASS_NAME,t);this._previouslySelected.clear()}_selectFirstNestedEditable(){const e=this.editor,i=this.editor.editing.view.document;for(const r of i.selection.getFirstRange().getItems())if(r.is("editableElement")){const o=e.editing.mapper.toModelElement(r);/* istanbul ignore next -- @preserve */if(!o)continue;const a=e.model.createPositionAt(o,0),c=e.model.schema.getNearestSelectionRange(a,"forward");return e.model.change(u=>{u.setSelection(c)}),!0}return!1}_selectAncestorWidget(){const e=this.editor,t=e.editing.mapper,r=e.editing.view.document.selection.getFirstPosition().parent,a=(r.is("$text")?r.parent:r).findAncestor(isWidget);if(!a)return!1;const c=t.toModelElement(a);/* istanbul ignore next -- @preserve */return c?(e.model.change(u=>{u.setSelection(c,"on")}),!0):!1}};function findClosestEditableOrWidgetAncestor(e){let t=e;for(;t;){if(t.is("editableElement")||isWidget(t))return t;t=t.parent}return null}function getElementFromMouseEvent(e,t){const i=getRangeFromMouseEvent(t.domEvent);let r=null;if(i?r=e.domConverter.domRangeToView(i):r=e.createRange(e.createPositionAt(t.target,0)),!r)return null;const o=r.start;if(!o.parent)return null;let a=o.parent;return o.parent.is("editableElement")&&(o.isAtEnd&&o.nodeBefore?a=o.nodeBefore:o.isAtStart&&o.nodeAfter&&(a=o.nodeAfter)),a.is("$text")?a.parent:a}function isChild(e,t){return t?Array.from(e.getAncestors()).includes(t):!1}function findTextBlockAncestor(e,t){for(const i of e.getAncestors({includeSelf:!0,parentFirst:!0})){if(t.checkChild(i,"$text"))return i;if(t.isLimit(i)&&!t.isObject(i))break}return null}function findNextTextBlock(e,t){const i=new TreeWalker({startPosition:e});for(const{item:r}of i){if(t.isLimit(r)||!r.is("element"))return null;if(t.checkChild(r,"$text"))return r}return null}var ClipboardObserver=class extends DomEventObserver{domEventType=["paste","copy","cut","drop","dragover","dragstart","dragend","dragenter","dragleave"];constructor(e){super(e);const t=this.document;this.listenTo(t,"paste",i("clipboardInput"),{priority:"low"}),this.listenTo(t,"drop",i("clipboardInput"),{priority:"low"}),this.listenTo(t,"dragover",i("dragging"),{priority:"low"});function i(r){return(o,a)=>{a.preventDefault();const c=a.dropRange?[a.dropRange]:null,u=new EventInfo(t,r);t.fire(u,{dataTransfer:a.dataTransfer,method:o.name,targetRanges:c,target:a.target,domEvent:a.domEvent}),u.stop.called&&a.stopPropagation()}}}onDomEvent(e){const t="clipboardData"in e?e.clipboardData:e.dataTransfer,i=e.type=="drop"||e.type=="paste",r={dataTransfer:new DataTransfer(t,{cacheFiles:i})};if(e.type=="drop"||e.type=="dragover"){const o=getRangeFromMouseEvent(e);r.dropRange=o&&this.view.domConverter.domRangeToView(o)}this.fire(e.type,e,r)}};/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function plainTextToHtml(e){return e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/^\s/,"&nbsp;").replace(/\s$/,"&nbsp;").replace(/\s\s/g," &nbsp;"),(e.includes("</p><p>")||e.includes("<br>"))&&(e=`<p>${e}</p>`),e}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function normalizeClipboardData(e){return e.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(t,i)=>i.length==1?" ":i).replace(/<!--[\s\S]*?-->/g,"")}/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/const smallPaddingElements=["figcaption","li"],listElements=["ol","ul"];function viewToPlainText(e){if(e.is("$text")||e.is("$textProxy"))return e.data;if(e.is("element","img")&&e.hasAttribute("alt"))return e.getAttribute("alt");if(e.is("element","br"))return`
`;let t="",i=null;for(const r of e.getChildren())t+=newLinePadding(r,i)+viewToPlainText(r),i=r;return t}function newLinePadding(e,t){return t?e.is("element","li")&&!e.isEmpty&&e.getChild(0).is("containerElement")||listElements.includes(e.name)&&listElements.includes(t.name)?`

`:!e.is("containerElement")&&!t.is("containerElement")?"":smallPaddingElements.includes(e.name)||smallPaddingElements.includes(t.name)?`
`:e.is("element")&&e.getCustomProperty("dataPipeline:transparentRendering")||t.is("element")&&t.getCustomProperty("dataPipeline:transparentRendering")?"":`

`:""}var ClipboardMarkersUtils=class extends Plugin{_markersToCopy=new Map;static get pluginName(){return"ClipboardMarkersUtils"}static get isOfficialPlugin(){return!0}_registerMarkerToCopy(e,t){this._markersToCopy.set(e,t)}_copySelectedFragmentWithMarkers(e,t,i=r=>r.model.getSelectedContent(r.model.document.selection)){return this.editor.model.change(r=>{const o=r.model.document.selection;r.setSelection(t);const a=this._insertFakeMarkersIntoSelection(r,r.model.document.selection,e),c=i(r),u=this._removeFakeMarkersInsideElement(r,c);for(const[h,d]of Object.entries(a)){u[h]||=r.createRangeIn(c);for(const f of d)r.remove(f)}c.markers.clear();for(const[h,d]of Object.entries(u))c.markers.set(h,d);return r.setSelection(o),c})}_pasteMarkersIntoTransformedElement(e,t){const i=this._getPasteMarkersFromRangeMap(e);return this.editor.model.change(r=>{const o=this._insertFakeMarkersElements(r,i),a=t(r),c=this._removeFakeMarkersInsideElement(r,a);for(const u of Object.values(o).flat())r.remove(u);for(const[u,h]of Object.entries(c))r.model.markers.has(u)||r.addMarker(u,{usingOperation:!0,affectsData:!0,range:h});return a})}_pasteFragmentWithMarkers(e){const t=this._getPasteMarkersFromRangeMap(e.markers);e.markers.clear();for(const i of t)e.markers.set(i.name,i.range);return this.editor.model.insertContent(e)}_forceMarkersCopy(e,t,i={allowedActions:"all",copyPartiallySelected:!0,duplicateOnPaste:!0}){const r=this._markersToCopy.get(e);this._markersToCopy.set(e,i),t(),r?this._markersToCopy.set(e,r):this._markersToCopy.delete(e)}_isMarkerCopyable(e,t){const i=this._getMarkerClipboardConfig(e);if(!i)return!1;if(!t)return!0;const{allowedActions:r}=i;return r==="all"||r.includes(t)}_hasMarkerConfiguration(e){return!!this._getMarkerClipboardConfig(e)}_getMarkerClipboardConfig(e){const[t]=e.split(":");return this._markersToCopy.get(t)||null}_insertFakeMarkersIntoSelection(e,t,i){const r=this._getCopyableMarkersFromSelection(e,t,i);return this._insertFakeMarkersElements(e,r)}_getCopyableMarkersFromSelection(e,t,i){const r=Array.from(t.getRanges()),o=new Set(r.flatMap(c=>Array.from(e.model.markers.getMarkersIntersectingRange(c)))),a=c=>{if(!this._isMarkerCopyable(c.name,i))return!1;const{copyPartiallySelected:h}=this._getMarkerClipboardConfig(c.name);if(!h){const d=c.getRange();return r.some(f=>f.containsRange(d,!0))}return!0};return Array.from(o).filter(a).map(c=>({name:i==="dragstart"?this._getUniqueMarkerName(c.name):c.name,range:c.getRange()}))}_getPasteMarkersFromRangeMap(e,t=null){const{model:i}=this.editor;return(e instanceof Map?Array.from(e.entries()):Object.entries(e)).flatMap(([o,a])=>{if(!this._hasMarkerConfiguration(o))return[{name:o,range:a}];if(this._isMarkerCopyable(o,t)){const c=this._getMarkerClipboardConfig(o),u=i.markers.has(o)&&i.markers.get(o).getRange().root.rootName==="$graveyard";return(c.duplicateOnPaste||u)&&(o=this._getUniqueMarkerName(o)),[{name:o,range:a}]}return[]})}_insertFakeMarkersElements(e,t){const i={},r=t.flatMap(o=>{const{start:a,end:c}=o.range;return[{position:a,marker:o,type:"start"},{position:c,marker:o,type:"end"}]}).sort(({position:o},{position:a})=>o.isBefore(a)?1:-1);for(const{position:o,marker:a,type:c}of r){const u=e.createElement("$marker",{"data-name":a.name,"data-type":c});i[a.name]||(i[a.name]=[]),i[a.name].push(u),e.insert(u,o)}return i}_removeFakeMarkersInsideElement(e,t){const r=this._getAllFakeMarkersFromElement(e,t).reduce((o,a)=>{const c=a.markerElement&&e.createPositionBefore(a.markerElement);let u=o[a.name],h=!1;return u&&u.start&&u.end&&(this._getMarkerClipboardConfig(a.name).duplicateOnPaste?o[this._getUniqueMarkerName(a.name)]=o[a.name]:h=!0,u=null),h||(o[a.name]={...u,[a.type]:c}),a.markerElement&&e.remove(a.markerElement),o},{});return mapValues_default(r,o=>new Range(o.start||e.createPositionFromPath(t,[0]),o.end||e.createPositionAt(t,"end")))}_getAllFakeMarkersFromElement(e,t){const i=Array.from(e.createRangeIn(t)).flatMap(({item:a})=>{if(!a.is("element","$marker"))return[];const c=a.getAttribute("data-name"),u=a.getAttribute("data-type");return[{markerElement:a,name:c,type:u}]}),r=[],o=[];for(const a of i)a.type==="end"&&(i.some(u=>u.name===a.name&&u.type==="start")||r.push({markerElement:null,name:a.name,type:"start"})),a.type==="start"&&(i.some(u=>u.name===a.name&&u.type==="end")||o.unshift({markerElement:null,name:a.name,type:"end"}));return[...r,...i,...o]}_getUniqueMarkerName(e){const t=e.split(":"),i=uid().substring(1,6);return t.length===3?`${t.slice(0,2).join(":")}:${i}`:`${t.join(":")}:${i}`}},ClipboardPipeline=class extends Plugin{static get pluginName(){return"ClipboardPipeline"}static get isOfficialPlugin(){return!0}static get requires(){return[ClipboardMarkersUtils]}init(){this.editor.editing.view.addObserver(ClipboardObserver),this._setupPasteDrop(),this._setupCopyCut()}_fireOutputTransformationEvent(e,t,i){const r=this.editor.plugins.get("ClipboardMarkersUtils");this.editor.model.enqueueChange({isUndoable:i==="cut"},()=>{const o=r._copySelectedFragmentWithMarkers(i,t);this.fire("outputTransformation",{dataTransfer:e,content:o,method:i})})}_setupPasteDrop(){const e=this.editor,t=e.model,i=e.editing.view,r=i.document,o=this.editor.plugins.get("ClipboardMarkersUtils");this.listenTo(r,"clipboardInput",(a,c)=>{c.method=="paste"&&!e.model.canEditAt(e.model.document.selection)&&a.stop()},{priority:"highest"}),this.listenTo(r,"clipboardInput",(a,c)=>{const u=c.dataTransfer;let h;if(c.content)h=c.content;else{let f="";u.getData("text/html")?f=normalizeClipboardData(u.getData("text/html")):u.getData("text/plain")&&(f=plainTextToHtml(u.getData("text/plain"))),h=this.editor.data.htmlProcessor.toView(f)}const d=new EventInfo(this,"inputTransformation");this.fire(d,{content:h,dataTransfer:u,targetRanges:c.targetRanges,method:c.method}),d.stop.called&&a.stop(),i.scrollToTheSelection()},{priority:"low"}),this.listenTo(this,"inputTransformation",(a,c)=>{if(c.content.isEmpty)return;const h=this.editor.data.toModel(c.content,"$clipboardHolder");h.childCount!=0&&(a.stop(),t.change(()=>{this.fire("contentInsertion",{content:h,method:c.method,dataTransfer:c.dataTransfer,targetRanges:c.targetRanges})}))},{priority:"low"}),this.listenTo(this,"contentInsertion",(a,c)=>{c.resultRange=o._pasteFragmentWithMarkers(c.content)},{priority:"low"})}_setupCopyCut(){const e=this.editor,t=e.model.document,r=e.editing.view.document,o=(a,c)=>{const u=c.dataTransfer;c.preventDefault(),this._fireOutputTransformationEvent(u,t.selection,a.name)};this.listenTo(r,"copy",o,{priority:"low"}),this.listenTo(r,"cut",(a,c)=>{e.model.canEditAt(e.model.document.selection)?o(a,c):c.preventDefault()},{priority:"low"}),this.listenTo(this,"outputTransformation",(a,c)=>{const u=e.data.toView(c.content);r.fire("clipboardOutput",{dataTransfer:c.dataTransfer,content:u,method:c.method})},{priority:"low"}),this.listenTo(r,"clipboardOutput",(a,c)=>{c.content.isEmpty||(c.dataTransfer.setData("text/html",this.editor.data.htmlProcessor.toData(c.content)),c.dataTransfer.setData("text/plain",viewToPlainText(c.content))),c.method=="cut"&&e.model.deleteContent(t.selection)},{priority:"low"})}};const toPx=toUnit("px");var LineView=class extends View{constructor(){super();const e=this.bindTemplate;this.set({isVisible:!1,left:null,top:null,width:null}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-clipboard-drop-target-line",e.if("isVisible","ck-hidden",t=>!t)],style:{left:e.to("left",t=>toPx(t)),top:e.to("top",t=>toPx(t)),width:e.to("width",t=>toPx(t))}}})}},DragDropTarget=class extends Plugin{removeDropMarkerDelayed=delay(()=>this.removeDropMarker(),40);_updateDropMarkerThrottled=throttle_default(e=>this._updateDropMarker(e),40);_reconvertMarkerThrottled=throttle_default(()=>{this.editor.model.markers.has("drop-target")&&this.editor.editing.reconvertMarker("drop-target")},0);_dropTargetLineView=new LineView;_domEmitter=new(DomEmitterMixin());_scrollables=new Map;static get pluginName(){return"DragDropTarget"}static get isOfficialPlugin(){return!0}init(){this._setupDropMarker()}destroy(){this._domEmitter.stopListening();for(const{resizeObserver:e}of this._scrollables.values())e.destroy();return this._updateDropMarkerThrottled.cancel(),this.removeDropMarkerDelayed.cancel(),this._reconvertMarkerThrottled.cancel(),super.destroy()}updateDropMarker(e,t,i,r,o,a){this.removeDropMarkerDelayed.cancel();const c=findDropTargetRange(this.editor,e,t,i,r,o,a);/* istanbul ignore next -- @preserve */if(c){if(a&&a.containsRange(c))return this.removeDropMarker();this._updateDropMarkerThrottled(c)}}getFinalDropRange(e,t,i,r,o,a){const c=findDropTargetRange(this.editor,e,t,i,r,o,a);return this.removeDropMarker(),c}removeDropMarker(){const e=this.editor.model;this.removeDropMarkerDelayed.cancel(),this._updateDropMarkerThrottled.cancel(),this._dropTargetLineView.isVisible=!1,e.markers.has("drop-target")&&e.change(t=>{t.removeMarker("drop-target")})}_setupDropMarker(){const e=this.editor;e.ui.view.body.add(this._dropTargetLineView),e.conversion.for("editingDowncast").markerToHighlight({model:"drop-target",view:{classes:["ck-clipboard-drop-target-range"]}}),e.conversion.for("editingDowncast").markerToElement({model:"drop-target",view:(t,{writer:i})=>{if(e.model.schema.checkChild(t.markerRange.start,"$text"))return this._dropTargetLineView.isVisible=!1,this._createDropTargetPosition(i);t.markerRange.isCollapsed?this._updateDropTargetLine(t.markerRange):this._dropTargetLineView.isVisible=!1}})}_updateDropMarker(e){const t=this.editor,i=t.model.markers;t.model.change(r=>{i.has("drop-target")?i.get("drop-target").getRange().isEqual(e)||r.updateMarker("drop-target",{range:e}):r.addMarker("drop-target",{range:e,usingOperation:!1,affectsData:!1})})}_createDropTargetPosition(e){return e.createUIElement("span",{class:"ck ck-clipboard-drop-target-position"},function(t){const i=this.toDomElement(t);return i.append("\u2060",t.createElement("span"),"\u2060"),i})}_updateDropTargetLine(e){const t=this.editor.editing,i=e.start.nodeBefore,r=e.start.nodeAfter,o=e.start.parent,a=i?t.mapper.toViewElement(i):null,c=a?t.view.domConverter.mapViewToDom(a):null,u=r?t.mapper.toViewElement(r):null,h=u?t.view.domConverter.mapViewToDom(u):null,d=t.mapper.toViewElement(o);if(!d)return;const f=t.view.domConverter.mapViewToDom(d),m=this._getScrollableRect(d),{scrollX:g,scrollY:v}=global$1.window,_=c?new Rect(c):null,b=h?new Rect(h):null,S=new Rect(f).excludeScrollbarsAndBorders(),T=_?_.bottom:S.top,A=b?b.top:S.bottom,I=global$1.window.getComputedStyle(f),R=T<=A?(T+A)/2:A;if(m.top<R&&R<m.bottom){const O=S.left+parseFloat(I.paddingLeft),P=S.right-parseFloat(I.paddingRight),L=Math.max(O+g,m.left),V=Math.min(P+g,m.right);this._dropTargetLineView.set({isVisible:!0,left:L,top:R+v,width:V-L})}else this._dropTargetLineView.isVisible=!1}_getScrollableRect(e){const t=e.root.rootName;let i;if(this._scrollables.has(t))i=this._scrollables.get(t).domElement;else{const r=this.editor.editing.view.domConverter.mapViewToDom(e);i=findScrollableElement(r),this._domEmitter.listenTo(i,"scroll",this._reconvertMarkerThrottled,{usePassive:!0});const o=new ResizeObserver$1(i,this._reconvertMarkerThrottled);this._scrollables.set(t,{domElement:i,resizeObserver:o})}return new Rect(i).excludeScrollbarsAndBorders()}};function findDropTargetRange(e,t,i,r,o,a,c){const u=e.model,h=e.editing.mapper;let f=getClosestMappedModelElement(e,t);for(;f;){if(!a){if(u.schema.checkChild(f,"$text")){if(i){const m=i[0].start,g=h.toModelPosition(m);if(!c||Array.from(c.getItems({shallow:!0})).every(_=>u.schema.checkChild(g,_))){if(u.schema.checkChild(g,"$text"))return u.createRange(g);if(m)return findDropTargetRangeForElement(e,getClosestMappedModelElement(e,m.parent),r,o)}}}else if(u.schema.isInline(f))return findDropTargetRangeForElement(e,f,r,o)}if(u.schema.isBlock(f))return findDropTargetRangeForElement(e,f,r,o);if(u.schema.checkChild(f,"$block")){const m=Array.from(f.getChildren()).filter(_=>_.is("element")&&!shouldIgnoreElement(e,_));let g=0,v=m.length;if(v==0)return u.createRange(u.createPositionAt(f,"end"));for(;g<v-1;){const _=Math.floor((g+v)/2);findElementSide(e,m[_],r,o)=="before"?v=_:g=_}return findDropTargetRangeForElement(e,m[g],r,o)}f=f.parent}return null}function shouldIgnoreElement(e,t){const i=e.editing.mapper,r=e.editing.view.domConverter,o=i.toViewElement(t);if(!o)return!0;const a=r.mapViewToDom(o);return global$1.window.getComputedStyle(a).float!="none"}function findDropTargetRangeForElement(e,t,i,r){const o=e.model;return o.createRange(o.createPositionAt(t,findElementSide(e,t,i,r)))}function findElementSide(e,t,i,r){const o=e.editing.mapper,a=e.editing.view.domConverter,c=o.toViewElement(t),u=a.mapViewToDom(c),h=new Rect(u);return e.model.schema.isInline(t)?i<(h.left+h.right)/2?"before":"after":r<(h.top+h.bottom)/2?"before":"after"}function getClosestMappedModelElement(e,t){const i=e.editing.mapper,r=e.editing.view,o=i.toModelElement(t);if(o)return o;const a=r.createPositionBefore(t),c=i.findMappedViewAncestor(a);return i.toModelElement(c)}function findScrollableElement(e){let t=e;do{t=t.parentElement;const i=global$1.window.getComputedStyle(t).overflowY;if(i=="auto"||i=="scroll")break}while(t.tagName!="BODY");return t}var DragDropBlockToolbar=class extends Plugin{_isBlockDragging=!1;_domEmitter=new(DomEmitterMixin());static get pluginName(){return"DragDropBlockToolbar"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;if(this.listenTo(e,"change:isReadOnly",(t,i,r)=>{r?(this.forceDisabled("readOnlyMode"),this._isBlockDragging=!1):this.clearForceDisabled("readOnlyMode")}),env.isAndroid&&this.forceDisabled("noAndroidSupport"),e.plugins.has("BlockToolbar")){const i=e.plugins.get("BlockToolbar").buttonView.element;this._domEmitter.listenTo(i,"dragstart",(r,o)=>this._handleBlockDragStart(o)),this._domEmitter.listenTo(global$1.document,"dragover",(r,o)=>this._handleBlockDragging(o)),this._domEmitter.listenTo(global$1.document,"drop",(r,o)=>this._handleBlockDragging(o)),this._domEmitter.listenTo(global$1.document,"dragend",()=>this._handleBlockDragEnd(),{useCapture:!0}),this.isEnabled&&i.setAttribute("draggable","true"),this.on("change:isEnabled",(r,o,a)=>{i.setAttribute("draggable",a?"true":"false")})}}destroy(){return this._domEmitter.stopListening(),super.destroy()}_handleBlockDragStart(e){if(!this.isEnabled)return;const t=this.editor.model,i=t.document.selection,r=this.editor.editing.view,o=Array.from(i.getSelectedBlocks()),a=t.createRange(t.createPositionBefore(o[0]),t.createPositionAfter(o[o.length-1]));t.change(c=>c.setSelection(a)),this._isBlockDragging=!0,r.focus(),r.getObserver(ClipboardObserver).onDomEvent(e)}_handleBlockDragging(e){if(!this.isEnabled||!this._isBlockDragging)return;const t=e.clientX+(this.editor.locale.contentLanguageDirection=="ltr"?100:-100),i=e.clientY,r=document.elementFromPoint(t,i),o=this.editor.editing.view;!r||!r.closest(".ck-editor__editable")||o.getObserver(ClipboardObserver).onDomEvent({...e,type:e.type,dataTransfer:e.dataTransfer,target:r,clientX:t,clientY:i,preventDefault:()=>e.preventDefault(),stopPropagation:()=>e.stopPropagation()})}_handleBlockDragEnd(){this._isBlockDragging=!1}},DragDrop=class extends Plugin{_draggedRange;_draggingUid;_draggableElement;_clearDraggableAttributesDelayed=delay(()=>this._clearDraggableAttributes(),40);_blockMode=!1;_domEmitter=new(DomEmitterMixin());_previewContainer;static get pluginName(){return"DragDrop"}static get isOfficialPlugin(){return!0}static get requires(){return[ClipboardPipeline,Widget,DragDropTarget,DragDropBlockToolbar]}init(){const e=this.editor,t=e.editing.view;this._draggedRange=null,this._draggingUid="",this._draggableElement=null,t.addObserver(ClipboardObserver),t.addObserver(MouseObserver),this._setupDragging(),this._setupContentInsertionIntegration(),this._setupClipboardInputIntegration(),this._setupDraggableAttributeHandling(),this.listenTo(e,"change:isReadOnly",(i,r,o)=>{o?this.forceDisabled("readOnlyMode"):this.clearForceDisabled("readOnlyMode")}),this.on("change:isEnabled",(i,r,o)=>{o||this._finalizeDragging(!1)}),env.isAndroid&&this.forceDisabled("noAndroidSupport")}destroy(){return this._draggedRange&&(this._draggedRange.detach(),this._draggedRange=null),this._previewContainer&&this._previewContainer.remove(),this._domEmitter.stopListening(),this._clearDraggableAttributesDelayed.cancel(),super.destroy()}_setupDragging(){const e=this.editor,t=e.model,i=e.editing.view,r=i.document,o=e.plugins.get(DragDropTarget);this.listenTo(r,"dragstart",(a,c)=>{if(c.target&&c.target.is("editableElement")){c.preventDefault();return}if(this._prepareDraggedRange(c.target),!this._draggedRange){c.preventDefault();return}this._draggingUid=uid(),c.dataTransfer.effectAllowed=this.isEnabled?"copyMove":"copy",c.dataTransfer.setData("application/ckeditor5-dragging-uid",this._draggingUid);const u=t.createSelection(this._draggedRange.toRange());this.editor.plugins.get("ClipboardPipeline")._fireOutputTransformationEvent(c.dataTransfer,u,"dragstart");const{dataTransfer:d,domTarget:f,domEvent:m}=c,{clientX:g}=m;this._updatePreview({dataTransfer:d,domTarget:f,clientX:g}),c.stopPropagation(),this.isEnabled||(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid="")},{priority:"low"}),this.listenTo(r,"dragend",(a,c)=>{this._finalizeDragging(!c.dataTransfer.isCanceled&&c.dataTransfer.dropEffect=="move")},{priority:"low"}),this._domEmitter.listenTo(global$1.document,"dragend",()=>{this._blockMode=!1},{useCapture:!0}),this.listenTo(r,"dragenter",()=>{this.isEnabled&&i.focus()}),this.listenTo(r,"dragleave",()=>{o.removeDropMarkerDelayed()}),this.listenTo(r,"dragging",(a,c)=>{if(!this.isEnabled){c.dataTransfer.dropEffect="none";return}const{clientX:u,clientY:h}=c.domEvent;o.updateDropMarker(c.target,c.targetRanges,u,h,this._blockMode,this._draggedRange),this._draggedRange||(c.dataTransfer.dropEffect="copy"),env.isGecko||(c.dataTransfer.effectAllowed=="copy"?c.dataTransfer.dropEffect="copy":["all","copyMove"].includes(c.dataTransfer.effectAllowed)&&(c.dataTransfer.dropEffect="move")),a.stop()},{priority:"low"})}_setupClipboardInputIntegration(){const e=this.editor,i=e.editing.view.document,r=e.plugins.get(DragDropTarget);this.listenTo(i,"clipboardInput",(o,a)=>{if(a.method!="drop")return;const{clientX:c,clientY:u}=a.domEvent,h=r.getFinalDropRange(a.target,a.targetRanges,c,u,this._blockMode,this._draggedRange);if(!h){this._finalizeDragging(!1),o.stop();return}if(this._draggedRange&&this._draggingUid!=a.dataTransfer.getData("application/ckeditor5-dragging-uid")&&(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid=""),getFinalDropEffect(a.dataTransfer)=="move"&&this._draggedRange&&this._draggedRange.containsRange(h,!0)){this._finalizeDragging(!1),o.stop();return}a.targetRanges=[e.editing.mapper.toViewRange(h)]},{priority:"high"})}_setupContentInsertionIntegration(){const e=this.editor.plugins.get(ClipboardPipeline);e.on("contentInsertion",(t,i)=>{if(!this.isEnabled||i.method!=="drop")return;const r=i.targetRanges.map(o=>this.editor.editing.mapper.toModelRange(o));this.editor.model.change(o=>o.setSelection(r))},{priority:"high"}),e.on("contentInsertion",(t,i)=>{if(!this.isEnabled||i.method!=="drop")return;const r=getFinalDropEffect(i.dataTransfer)=="move",o=!i.resultRange||!i.resultRange.isCollapsed;this._finalizeDragging(o&&r)},{priority:"lowest"})}_setupDraggableAttributeHandling(){const e=this.editor,t=e.editing.view,i=t.document;this.listenTo(i,"mousedown",(r,o)=>{if(env.isAndroid||!o)return;this._clearDraggableAttributesDelayed.cancel();let a=findDraggableWidget(o.target);if(env.isBlink&&!e.isReadOnly&&!a&&!i.selection.isCollapsed){const c=i.selection.getSelectedElement();(!c||!isWidget(c))&&(a=i.selection.editableElement)}a&&(t.change(c=>{c.setAttribute("draggable","true",a)}),this._draggableElement=e.editing.mapper.toModelElement(a))}),this.listenTo(i,"mouseup",()=>{env.isAndroid||this._clearDraggableAttributesDelayed()})}_clearDraggableAttributes(){const e=this.editor.editing;e.view.change(t=>{this._draggableElement&&this._draggableElement.root.rootName!="$graveyard"&&t.removeAttribute("draggable",e.mapper.toViewElement(this._draggableElement)),this._draggableElement=null})}_finalizeDragging(e){const t=this.editor,i=t.model;t.plugins.get(DragDropTarget).removeDropMarker(),this._clearDraggableAttributes(),t.plugins.has("WidgetToolbarRepository")&&t.plugins.get("WidgetToolbarRepository").clearForceDisabled("dragDrop"),this._draggingUid="",this._previewContainer&&(this._previewContainer.remove(),this._previewContainer=void 0),this._draggedRange&&(e&&this.isEnabled&&i.change(o=>{const a=i.createSelection(this._draggedRange);i.deleteContent(a,{doNotAutoparagraph:!0});const c=a.getFirstPosition().parent;c.isEmpty&&!i.schema.checkChild(c,"$text")&&i.schema.checkChild(c,"paragraph")&&o.insertElement("paragraph",c,0)}),this._draggedRange.detach(),this._draggedRange=null)}_prepareDraggedRange(e){const t=this.editor,i=t.model,r=i.document.selection,o=e?findDraggableWidget(e):null;if(o){const h=t.editing.mapper.toModelElement(o);this._draggedRange=LiveRange.fromRange(i.createRangeOn(h)),this._blockMode=i.schema.isBlock(h),t.plugins.has("WidgetToolbarRepository")&&t.plugins.get("WidgetToolbarRepository").forceDisabled("dragDrop");return}if(r.isCollapsed&&!r.getFirstPosition().parent.isEmpty)return;const a=Array.from(r.getSelectedBlocks()),c=r.getFirstRange();if(a.length==0){this._draggedRange=LiveRange.fromRange(c);return}const u=getRangeIncludingFullySelectedParents(i,a);if(a.length>1)this._draggedRange=LiveRange.fromRange(u),this._blockMode=!0;else if(a.length==1){const h=c.start.isTouching(u.start)&&c.end.isTouching(u.end);this._draggedRange=LiveRange.fromRange(h?u:c),this._blockMode=h}i.change(h=>h.setSelection(this._draggedRange.toRange()))}_updatePreview({dataTransfer:e,domTarget:t,clientX:i}){const r=this.editor.editing.view,o=r.document.selection.editableElement,a=r.domConverter.mapViewToDom(o),c=global$1.window.getComputedStyle(a);this._previewContainer?this._previewContainer.firstElementChild&&this._previewContainer.removeChild(this._previewContainer.firstElementChild):(this._previewContainer=createElement(global$1.document,"div",{style:"position: fixed; left: -999999px;"}),global$1.document.body.appendChild(this._previewContainer));const u=new Rect(a);if(a.contains(t))return;const h=parseFloat(c.paddingLeft),d=createElement(global$1.document,"div");d.className="ck ck-content",d.style.width=c.width,d.style.paddingLeft=`${u.left-i+h}px`,env.isiOS&&(d.style.backgroundColor="white"),r.domConverter.setContentOf(d,e.getData("text/html")),e.setDragImage(d,0,0),this._previewContainer.appendChild(d)}};function getFinalDropEffect(e){return env.isGecko?e.dropEffect:["all","copyMove"].includes(e.effectAllowed)?"move":"copy"}function findDraggableWidget(e){if(e.is("editableElement"))return null;if(e.hasClass("ck-widget__selection-handle"))return e.findAncestor(isWidget);if(isWidget(e))return e;const t=e.findAncestor(i=>isWidget(i)||i.is("editableElement"));return isWidget(t)?t:null}function getRangeIncludingFullySelectedParents(e,t){const i=t[0],r=t[t.length-1],o=i.getCommonAncestor(r),a=e.createPositionBefore(i),c=e.createPositionAfter(r);if(o&&o.is("element")&&!e.schema.isLimit(o)){const u=e.createRangeOn(o),h=a.isTouching(u.start),d=c.isTouching(u.end);if(h&&d)return getRangeIncludingFullySelectedParents(e,[o])}return e.createRange(a,c)}var PastePlainText=class extends Plugin{static get pluginName(){return"PastePlainText"}static get isOfficialPlugin(){return!0}static get requires(){return[ClipboardPipeline]}init(){const e=this.editor,t=e.model,i=e.editing.view,r=t.document.selection;i.addObserver(ClipboardObserver),e.plugins.get(ClipboardPipeline).on("contentInsertion",(o,a)=>{isUnformattedInlineContent(a.content,t)&&t.change(c=>{const u=Array.from(r.getAttributes()).filter(([d])=>t.schema.getAttributeProperties(d).isFormatting);r.isCollapsed||t.deleteContent(r,{doNotAutoparagraph:!0}),u.push(...r.getAttributes());const h=c.createRangeIn(a.content);for(const d of h.getItems())for(const f of u)t.schema.checkAttribute(d,f[0])&&c.setAttribute(f[0],f[1],d)})})}};function isUnformattedInlineContent(e,t){let i=t.createRangeIn(e);if(e.childCount==1){const r=e.getChild(0);r.is("element")&&t.schema.isBlock(r)&&!t.schema.isObject(r)&&!t.schema.isLimit(r)&&(i=t.createRangeIn(r))}for(const r of i.getItems())if(!t.schema.isInline(r)||Array.from(r.getAttributeKeys()).find(a=>t.schema.getAttributeProperties(a).isFormatting))return!1;return!0}var Clipboard=class extends Plugin{static get pluginName(){return"Clipboard"}static get isOfficialPlugin(){return!0}static get requires(){return[ClipboardMarkersUtils,ClipboardPipeline,DragDrop,PastePlainText]}init(){const e=this.editor,t=this.editor.t;e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Copy selected content"),keystroke:"CTRL+C"},{label:t("Paste content"),keystroke:"CTRL+V"},{label:t("Paste content as plain text"),keystroke:"CTRL+SHIFT+V"}]})}},ClassicEditorUI=class extends EditorUI{view;_toolbarConfig;_elementReplacer;constructor(e,t){super(e),this.view=t,this._toolbarConfig=normalizeToolbarConfig(e.config.get("toolbar")),this._elementReplacer=new ElementReplacer,this.listenTo(e.editing.view,"scrollToTheSelection",this._handleScrollToTheSelectionWithStickyPanel.bind(this))}get element(){return this.view.element}init(e){const t=this.editor,i=this.view,r=t.editing.view,o=i.editable,a=r.document.getRoot();o.name=a.rootName,i.render();const c=o.element;this.setEditableElement(o.name,c),i.editable.bind("isFocused").to(this.focusTracker),r.attachDomRoot(c),e&&this._elementReplacer.replace(e,this.element),this._initPlaceholder(),this._initToolbar(),i.menuBarView&&this._initMenuBar(i.menuBarView),this._initDialogPluginIntegration(),this._initContextualBalloonIntegration(),this.fire("ready")}destroy(){super.destroy();const e=this.view,t=this.editor.editing.view;this._elementReplacer.restore(),t.getDomRoot(e.editable.name)&&t.detachDomRoot(e.editable.name),e.destroy()}_initToolbar(){const e=this.view;e.stickyPanel.bind("isActive").to(this.focusTracker,"isFocused"),e.stickyPanel.limiterElement=e.element,e.stickyPanel.bind("viewportTopOffset").to(this,"viewportOffset",({top:t})=>t||0),e.toolbar.fillFromConfig(this._toolbarConfig,this.componentFactory),this.addToolbar(e.toolbar)}_initPlaceholder(){const e=this.editor,t=e.editing.view,i=t.document.getRoot(),r=e.sourceElement;let o;const a=e.config.get("placeholder");a&&(o=typeof a=="string"?a:a[this.view.editable.name]),!o&&r&&r.tagName.toLowerCase()==="textarea"&&(o=r.getAttribute("placeholder")),o&&(i.placeholder=o),enablePlaceholder({view:t,element:i,isDirectHost:!1,keepOnFocus:!0})}_initContextualBalloonIntegration(){if(!this.editor.plugins.has("ContextualBalloon"))return;const{stickyPanel:e}=this.view,t=this.editor.plugins.get("ContextualBalloon");t.on("getPositionOptions",r=>{const o=r.return;if(!o||!e.isSticky||!e.element)return;const a=new Rect(e.element).height,c=typeof o.target=="function"?o.target():o.target,u=typeof o.limiter=="function"?o.limiter():o.limiter;if(c&&u&&new Rect(c).height>=new Rect(u).height-a)return;const h={...o.viewportOffsetConfig},d=(h.top||0)+a;r.return={...o,viewportOffsetConfig:{...h,top:d}}},{priority:"low"});const i=()=>{t.visibleView&&t.updatePosition()};this.listenTo(e,"change:isSticky",i),this.listenTo(this.editor.ui,"change:viewportOffset",i)}_handleScrollToTheSelectionWithStickyPanel(e,t,i){const r=this.view.stickyPanel;if(r.isSticky){const o=new Rect(r.element).height;t.viewportOffset.top+=o}else{const o=()=>{this.editor.editing.view.scrollToTheSelection(i)};this.listenTo(r,"change:isSticky",o),setTimeout(()=>{this.stopListening(r,"change:isSticky",o)},20)}}_initDialogPluginIntegration(){if(!this.editor.plugins.has("Dialog"))return;const e=this.view.stickyPanel,t=this.editor.plugins.get("Dialog");t.on("show",()=>{const i=t.view;i.on("moveTo",(r,o)=>{if(!e.isSticky||i.wasMoved||i.isModal)return;const a=new Rect(e.contentPanelElement);o[1]<a.bottom+DialogView.defaultOffset&&(o[1]=a.bottom+DialogView.defaultOffset)},{priority:"high"})},{priority:"low"})}},ClassicEditorUIView=class extends BoxedEditorUIView{stickyPanel;toolbar;editable;constructor(e,t,i={}){super(e),this.stickyPanel=new StickyPanelView(e),this.toolbar=new ToolbarView(e,{shouldGroupWhenFull:i.shouldToolbarGroupWhenFull}),i.useMenuBar&&(this.menuBarView=new MenuBarView(e)),this.editable=new InlineEditableUIView(e,t,void 0,{label:i.label})}render(){super.render(),this.menuBarView?this.stickyPanel.content.addMany([this.menuBarView,this.toolbar]):this.stickyPanel.content.add(this.toolbar),this.top.add(this.stickyPanel),this.main.add(this.editable)}},ClassicEditor=class extends ElementApiMixin(Editor){static get editorName(){return"ClassicEditor"}ui;constructor(e,t={}){if(!isElement$2(e)&&t.initialData!==void 0)throw new CKEditorError("editor-create-initial-data",null);super(t),this.config.define("menuBar.isVisible",!1),this.config.get("initialData")===void 0&&this.config.set("initialData",getInitialData(e)),isElement$2(e)&&(this.sourceElement=e),this.model.document.createRoot();const i=!this.config.get("toolbar.shouldNotGroupWhenFull"),r=this.config.get("menuBar"),o=new ClassicEditorUIView(this.locale,this.editing.view,{shouldToolbarGroupWhenFull:i,useMenuBar:r.isVisible,label:this.config.get("label")});this.ui=new ClassicEditorUI(this,o),attachToForm(this)}destroy(){return this.sourceElement&&this.updateSourceElement(),this.ui.destroy(),super.destroy()}static create(e,t={}){return new Promise(i=>{const r=new this(e,t);i(r.initPlugins().then(()=>r.ui.init(isElement$2(e)?e:null)).then(()=>r.data.init(r.config.get("initialData"))).then(()=>r.fire("ready")).then(()=>r))})}};function getInitialData(e){return isElement$2(e)?getDataFromElement(e):e}function isElement$2(e){return isElement_default(e)}var SelectAllCommand=class extends Command{constructor(e){super(e),this.affectsData=!1}execute(){const e=this.editor.model,t=e.document.selection;let i=e.schema.getLimitElement(t);if(t.containsEntireContent(i)||!isSelectAllScope(e.schema,i))do if(i=i.parent,!i)return;while(!isSelectAllScope(e.schema,i));e.change(r=>{r.setSelection(i,"in")})}};function isSelectAllScope(e,t){return e.isLimit(t)&&(e.checkChild(t,"$text")||e.checkChild(t,"paragraph"))}const SELECT_ALL_KEYSTROKE=parseKeystroke("Ctrl+A");var SelectAllEditing=class extends Plugin{static get pluginName(){return"SelectAllEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.t,r=e.editing.view.document;e.commands.add("selectAll",new SelectAllCommand(e)),this.listenTo(r,"keydown",(o,a)=>{getCode(a)===SELECT_ALL_KEYSTROKE&&(e.execute("selectAll"),a.preventDefault())}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Select all"),keystroke:"CTRL+A"}]})}},selectAllIcon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M.75 15.5a.75.75 0 0 1 .75.75V18l.008.09A.5.5 0 0 0 2 18.5h1.75a.75.75 0 1 1 0 1.5H1.5l-.144-.007a1.5 1.5 0 0 1-1.35-1.349L0 18.5v-2.25a.75.75 0 0 1 .75-.75zm18.5 0a.75.75 0 0 1 .75.75v2.25l-.007.144a1.5 1.5 0 0 1-1.349 1.35L18.5 20h-2.25a.75.75 0 1 1 0-1.5H18a.5.5 0 0 0 .492-.41L18.5 18v-1.75a.75.75 0 0 1 .75-.75zm-10.45 3c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm.45-5.5a.75.75 0 1 1 0 1.5h-8.5a.75.75 0 1 1 0-1.5h8.5zM1.3 11c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM1.3 7c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5h-2.5a.75.75 0 1 1 0-1.5h2.5zm-5 0a.75.75 0 1 1 0 1.5h-5.5a.75.75 0 0 1 0-1.5h5.5zm-6.5-5a.75.75 0 0 1 0 1.5H2a.5.5 0 0 0-.492.41L1.5 2v1.75a.75.75 0 0 1-1.5 0V1.5l.007-.144A1.5 1.5 0 0 1 1.356.006L1.5 0h2.25zM18.5 0l.144.007a1.5 1.5 0 0 1 1.35 1.349L20 1.5v2.25a.75.75 0 1 1-1.5 0V2l-.008-.09A.5.5 0 0 0 18 1.5h-1.75a.75.75 0 1 1 0-1.5h2.25zM8.8 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6z"/></svg>',SelectAllUI=class extends Plugin{static get pluginName(){return"SelectAllUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;e.ui.componentFactory.add("selectAll",()=>{const t=this._createButton(ButtonView);return t.set({tooltip:!0}),t}),e.ui.componentFactory.add("menuBar:selectAll",()=>this._createButton(MenuBarMenuListItemButtonView))}_createButton(e){const t=this.editor,i=t.locale,r=t.commands.get("selectAll"),o=new e(t.locale),a=i.t;return o.set({label:a("Select all"),icon:selectAllIcon,keystroke:"Ctrl+A"}),o.bind("isEnabled").to(r,"isEnabled"),this.listenTo(o,"execute",()=>{t.execute("selectAll"),t.editing.view.focus()}),o}},SelectAll=class extends Plugin{static get requires(){return[SelectAllEditing,SelectAllUI]}static get pluginName(){return"SelectAll"}static get isOfficialPlugin(){return!0}},BaseCommand=class extends Command{_stack=[];_createdBatches=new WeakSet;constructor(e){super(e),this.refresh(),this._isEnabledBasedOnSelection=!1,this.listenTo(e.data,"set",(t,i)=>{i[1]={...i[1]};const r=i[1];r.batchType||(r.batchType={isUndoable:!1})},{priority:"high"}),this.listenTo(e.data,"set",(t,i)=>{i[1].batchType.isUndoable||this.clearStack()})}refresh(){this.isEnabled=this._stack.length>0}get createdBatches(){return this._createdBatches}addBatch(e){const t=this.editor.model.document.selection,i={ranges:t.hasOwnRange?Array.from(t.getRanges()):[],isBackward:t.isBackward};this._stack.push({batch:e,selection:i}),this.refresh()}clearStack(){this._stack=[],this.refresh()}_restoreSelection(e,t,i){const r=this.editor.model,o=r.document,a=[],c=e.map(h=>h.getTransformedByOperations(i)),u=c.flat();for(const h of c){const d=h.filter(f=>f.root!=o.graveyard).filter(f=>!isRangeContainedByAnyOtherRange(f,u));d.length&&(normalizeRanges(d),a.push(d[0]))}a.length&&r.change(h=>{h.setSelection(a,{backward:t})})}_undo(e,t){const i=this.editor.model,r=i.document;this._createdBatches.add(t);const o=e.operations.slice().filter(a=>a.isDocumentOperation);o.reverse();for(const a of o){const c=a.baseVersion+1,u=Array.from(r.history.getOperations(c)),d=transformSets([a.getReversed()],u,{useRelations:!0,document:this.editor.model.document,padWithNoOps:!1,forceWeakRemove:!0}).operationsA;for(let f of d){const m=f.affectedSelectable;m&&!i.canEditAt(m)&&(f=new NoOperation(f.baseVersion)),t.addOperation(f),i.applyOperation(f),r.history.setOperationAsUndone(a,f)}}}};function normalizeRanges(e){e.sort((t,i)=>t.start.isBefore(i.start)?-1:1);for(let t=1;t<e.length;t++){const r=e[t-1].getJoined(e[t],!0);r&&(t--,e.splice(t,2,r))}}function isRangeContainedByAnyOtherRange(e,t){return t.some(i=>i!==e&&i.containsRange(e,!0))}var UndoCommand=class extends BaseCommand{execute(e=null){const t=e?this._stack.findIndex(o=>o.batch==e):this._stack.length-1,i=this._stack.splice(t,1)[0],r=this.editor.model.createBatch({isUndo:!0});this.editor.model.enqueueChange(r,()=>{this._undo(i.batch,r);const o=this.editor.model.document.history.getOperations(i.batch.baseVersion);this._restoreSelection(i.selection.ranges,i.selection.isBackward,o)}),this.fire("revert",i.batch,r),this.refresh()}},RedoCommand=class extends BaseCommand{execute(){const e=this._stack.pop(),t=this.editor.model.createBatch({isUndo:!0});this.editor.model.enqueueChange(t,()=>{const r=e.batch.operations[e.batch.operations.length-1].baseVersion+1,o=this.editor.model.document.history.getOperations(r);this._restoreSelection(e.selection.ranges,e.selection.isBackward,o),this._undo(e.batch,t)}),this.refresh()}},UndoEditing=class extends Plugin{_undoCommand;_redoCommand;_batchRegistry=new WeakSet;static get pluginName(){return"UndoEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.t;this._undoCommand=new UndoCommand(e),this._redoCommand=new RedoCommand(e),e.commands.add("undo",this._undoCommand),e.commands.add("redo",this._redoCommand),this.listenTo(e.model,"applyOperation",(i,r)=>{const o=r[0];if(!o.isDocumentOperation)return;const a=o.batch,c=this._redoCommand.createdBatches.has(a),u=this._undoCommand.createdBatches.has(a);this._batchRegistry.has(a)||(this._batchRegistry.add(a),a.isUndoable&&(c?this._undoCommand.addBatch(a):u||(this._undoCommand.addBatch(a),this._redoCommand.clearStack())))},{priority:"highest"}),this.listenTo(this._undoCommand,"revert",(i,r,o)=>{this._redoCommand.addBatch(o)}),e.keystrokes.set("CTRL+Z","undo"),e.keystrokes.set("CTRL+Y","redo"),e.keystrokes.set("CTRL+SHIFT+Z","redo"),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Undo"),keystroke:"CTRL+Z"},{label:t("Redo"),keystroke:[["CTRL+Y"],["CTRL+SHIFT+Z"]]}]})}},UndoUI=class extends Plugin{static get pluginName(){return"UndoUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.locale,i=e.t,r=t.uiLanguageDirection=="ltr"?icons.undo:icons.redo,o=t.uiLanguageDirection=="ltr"?icons.redo:icons.undo;this._addButtonsToFactory("undo",i("Undo"),"CTRL+Z",r),this._addButtonsToFactory("redo",i("Redo"),"CTRL+Y",o)}_addButtonsToFactory(e,t,i,r){const o=this.editor;o.ui.componentFactory.add(e,()=>{const a=this._createButton(ButtonView,e,t,i,r);return a.set({tooltip:!0}),a}),o.ui.componentFactory.add("menuBar:"+e,()=>this._createButton(MenuBarMenuListItemButtonView,e,t,i,r))}_createButton(e,t,i,r,o){const a=this.editor,c=a.locale,u=a.commands.get(t),h=new e(c);return h.set({label:i,icon:o,keystroke:r}),h.bind("isEnabled").to(u,"isEnabled"),this.listenTo(h,"execute",()=>{a.execute(t),a.editing.view.focus()}),h}},Undo=class extends Plugin{static get requires(){return[UndoEditing,UndoUI]}static get pluginName(){return"Undo"}static get isOfficialPlugin(){return!0}},Essentials=class extends Plugin{static get requires(){return[AccessibilityHelp,Clipboard,Enter,SelectAll,ShiftEnter,Typing,Undo]}static get pluginName(){return"Essentials"}static get isOfficialPlugin(){return!0}},FontCommand=class extends Command{attributeKey;constructor(e,t){super(e),this.attributeKey=t}refresh(){const e=this.editor.model,t=e.document;this.value=t.selection.getAttribute(this.attributeKey),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,this.attributeKey)}execute(e={}){const t=this.editor.model,r=t.document.selection,o=e.value,a=e.batch,c=u=>{if(r.isCollapsed)o?u.setSelectionAttribute(this.attributeKey,o):u.removeSelectionAttribute(this.attributeKey);else{const h=t.schema.getValidRanges(r.getRanges(),this.attributeKey);for(const d of h)o?u.setAttribute(this.attributeKey,o,d):u.removeAttribute(this.attributeKey,d)}};a?t.enqueueChange(a,u=>{c(u)}):t.change(u=>{c(u)})}};const FONT_SIZE="fontSize",FONT_FAMILY="fontFamily",FONT_COLOR="fontColor",FONT_BACKGROUND_COLOR="fontBackgroundColor";function buildDefinition(e,t){const i={model:{key:e,values:[]},view:{},upcastAlso:{}};for(const r of t)i.model.values.push(r.model),i.view[r.model]=r.view,r.upcastAlso&&(i.upcastAlso[r.model]=r.upcastAlso);return i}function renderUpcastAttribute(e){return t=>normalizeColorCode(t.getStyle(e))}function renderDowncastElement(e){return(t,{writer:i})=>i.createAttributeElement("span",{style:`${e}:${t}`},{priority:7})}function addColorSelectorToDropdown({dropdownView:e,colors:t,columns:i,removeButtonLabel:r,colorPickerLabel:o,documentColorsLabel:a,documentColorsCount:c,colorPickerViewConfig:u}){const h=e.locale,d=new ColorSelectorView(h,{colors:t,columns:i,removeButtonLabel:r,colorPickerLabel:o,documentColorsLabel:a,documentColorsCount:c,colorPickerViewConfig:u});return e.colorSelectorView=d,e.panelView.children.add(d),d}function normalizeColorCode(e){return e.replace(/\s/g,"")}var FontFamilyCommand=class extends FontCommand{constructor(e){super(e,FONT_FAMILY)}};/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function normalizeOptions$1(e){return e.map(getOptionDefinition$1).filter(t=>t!==void 0)}function getOptionDefinition$1(e){if(typeof e=="object")return e;if(e==="default")return{title:"Default",model:void 0};if(typeof e=="string")return generateFontPreset(e)}function generateFontPreset(e){const t=e.replace(/"|'/g,"").split(","),i=t[0],r=t.map(normalizeFontNameForCSS).join(", ");return{title:i,model:r,view:{name:"span",styles:{"font-family":r},priority:7}}}function normalizeFontNameForCSS(e){return e=e.trim(),e.indexOf(" ")>0&&(e=`'${e}'`),e}var FontFamilyEditing=class extends Plugin{static get pluginName(){return"FontFamilyEditing"}static get isOfficialPlugin(){return!0}constructor(e){super(e),e.config.define(FONT_FAMILY,{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!1})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:FONT_FAMILY}),e.model.schema.setAttributeProperties(FONT_FAMILY,{isFormatting:!0,copyOnEnter:!0});const t=normalizeOptions$1(e.config.get("fontFamily.options")).filter(r=>r.model),i=buildDefinition(FONT_FAMILY,t);e.config.get("fontFamily.supportAllValues")?(this._prepareAnyValueConverters(),this._prepareCompatibilityConverter()):e.conversion.attributeToElement(i),e.commands.add(FONT_FAMILY,new FontFamilyCommand(e))}_prepareAnyValueConverters(){const e=this.editor;e.conversion.for("downcast").attributeToElement({model:FONT_FAMILY,view:(t,{writer:i})=>i.createAttributeElement("span",{style:"font-family:"+t},{priority:7})}),e.conversion.for("upcast").elementToAttribute({model:{key:FONT_FAMILY,value:t=>t.getStyle("font-family")},view:{name:"span",styles:{"font-family":/.*/}}})}_prepareCompatibilityConverter(){this.editor.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{face:/.*/}},model:{key:FONT_FAMILY,value:t=>t.getAttribute("face")}})}},fontFamilyIcon='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.03 3h6.149a.75.75 0 1 1 0 1.5h-5.514L11.03 3zm1.27 3h4.879a.75.75 0 1 1 0 1.5h-4.244L12.3 6zm1.27 3h3.609a.75.75 0 1 1 0 1.5h-2.973L13.57 9zm-2.754 2.5L8.038 4.785 5.261 11.5h5.555zm.62 1.5H4.641l-1.666 4.028H1.312l5.789-14h1.875l5.789 14h-1.663L11.436 13z"/></svg>',FontFamilyUI=class extends Plugin{static get pluginName(){return"FontFamilyUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.t,i=this._getLocalizedOptions(),r=e.commands.get(FONT_FAMILY),o=t("Font Family"),a=_prepareListOptions$1(i,r);e.ui.componentFactory.add(FONT_FAMILY,c=>{const u=createDropdown(c);return addListToDropdown(u,a,{role:"menu",ariaLabel:o}),u.buttonView.set({label:o,icon:fontFamilyIcon,tooltip:!0}),u.extendTemplate({attributes:{class:"ck-font-family-dropdown"}}),u.bind("isEnabled").to(r),this.listenTo(u,"execute",h=>{e.execute(h.source.commandName,{value:h.source.commandParam}),e.editing.view.focus()}),u}),e.ui.componentFactory.add(`menuBar:${FONT_FAMILY}`,c=>{const u=new MenuBarMenuView(c);u.buttonView.set({label:o,icon:fontFamilyIcon}),u.bind("isEnabled").to(r);const h=new MenuBarMenuListView(c);for(const d of a){const f=new MenuBarMenuListItemView(c,u),m=new MenuBarMenuListItemButtonView(c);m.set({role:"menuitemradio",isToggleable:!0}),m.bind(...Object.keys(d.model)).to(d.model),m.delegate("execute").to(u),m.on("execute",()=>{e.execute(d.model.commandName,{value:d.model.commandParam}),e.editing.view.focus()}),f.children.add(m),h.items.add(f)}return u.panelView.children.add(h),u})}_getLocalizedOptions(){const e=this.editor,t=e.t;return normalizeOptions$1(e.config.get(FONT_FAMILY).options).map(r=>(r.title==="Default"&&(r.title=t("Default")),r))}};function _prepareListOptions$1(e,t){const i=new Collection;for(const r of e){const o={type:"button",model:new Model({commandName:FONT_FAMILY,commandParam:r.model,label:r.title,role:"menuitemradio",withText:!0})};o.model.bind("isOn").to(t,"value",a=>a===r.model?!0:!a||!r.model?!1:a.split(",")[0].replace(/'/g,"").toLowerCase()===r.model.toLowerCase()),r.view&&typeof r.view!="string"&&r.view.styles&&o.model.set("labelStyle",`font-family: ${r.view.styles["font-family"]}`),i.add(o)}return i}var FontFamily=class extends Plugin{static get requires(){return[FontFamilyEditing,FontFamilyUI]}static get pluginName(){return"FontFamily"}static get isOfficialPlugin(){return!0}},FontSizeCommand=class extends FontCommand{constructor(e){super(e,FONT_SIZE)}};function normalizeOptions(e){return e.map(t=>getOptionDefinition(t)).filter(t=>t!==void 0)}const namedPresets={get tiny(){return{title:"Tiny",model:"tiny",view:{name:"span",classes:"text-tiny",priority:7}}},get small(){return{title:"Small",model:"small",view:{name:"span",classes:"text-small",priority:7}}},get big(){return{title:"Big",model:"big",view:{name:"span",classes:"text-big",priority:7}}},get huge(){return{title:"Huge",model:"huge",view:{name:"span",classes:"text-huge",priority:7}}}};function getOptionDefinition(e){if(typeof e=="number"&&(e=String(e)),typeof e=="object"&&isFullItemDefinition(e))return attachPriority(e);const t=findPreset(e);if(t)return attachPriority(t);if(e==="default")return{model:void 0,title:"Default"};if(!isNumericalDefinition(e))return generatePixelPreset(e)}function generatePixelPreset(e){return typeof e=="string"&&(e={title:e,model:`${parseFloat(e)}px`}),e.view={name:"span",styles:{"font-size":e.model}},attachPriority(e)}function attachPriority(e){return e.view&&typeof e.view!="string"&&!e.view.priority&&(e.view.priority=7),e}function findPreset(e){return typeof e=="string"?namedPresets[e]:namedPresets[e.model]}function isFullItemDefinition(e){return e.title&&e.model&&e.view}function isNumericalDefinition(e){let t;if(typeof e=="object")if(e.model)t=parseFloat(e.model);else throw new CKEditorError("font-size-invalid-definition",null,e);else t=parseFloat(e);return isNaN(t)}const styleFontSize=["x-small","x-small","small","medium","large","x-large","xx-large","xxx-large"];var FontSizeEditing=class extends Plugin{static get pluginName(){return"FontSizeEditing"}static get isOfficialPlugin(){return!0}constructor(e){super(e),e.config.define(FONT_SIZE,{options:["tiny","small","default","big","huge"],supportAllValues:!1})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:FONT_SIZE}),e.model.schema.setAttributeProperties(FONT_SIZE,{isFormatting:!0,copyOnEnter:!0});const t=e.config.get("fontSize.supportAllValues"),i=normalizeOptions(this.editor.config.get("fontSize.options")).filter(o=>o.model),r=buildDefinition(FONT_SIZE,i);t?(this._prepareAnyValueConverters(r),this._prepareCompatibilityConverter()):e.conversion.attributeToElement(r),e.commands.add(FONT_SIZE,new FontSizeCommand(e))}_prepareAnyValueConverters(e){const t=this.editor,i=e.model.values.filter(r=>!isLength(String(r))&&!isPercentage(String(r)));if(i.length)throw new CKEditorError("font-size-invalid-use-of-named-presets",null,{presets:i});t.conversion.for("downcast").attributeToElement({model:FONT_SIZE,view:(r,{writer:o})=>{if(r)return o.createAttributeElement("span",{style:"font-size:"+r},{priority:7})}}),t.conversion.for("upcast").elementToAttribute({model:{key:FONT_SIZE,value:r=>r.getStyle("font-size")},view:{name:"span",styles:{"font-size":/.*/}}})}_prepareCompatibilityConverter(){this.editor.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{size:/^[+-]?\d{1,3}$/}},model:{key:FONT_SIZE,value:t=>{const i=t.getAttribute("size"),r=i[0]==="-"||i[0]==="+";let o=parseInt(i,10);r&&(o=3+o);const a=styleFontSize.length-1,c=Math.min(Math.max(o,0),a);return styleFontSize[c]}}})}},fontSizeIcon='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.816 11.5 7.038 4.785 4.261 11.5h5.555zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663L10.436 13zm7.55 2.279.779-.779.707.707-2.265 2.265-2.193-2.265.707-.707.765.765V4.825c0-.042 0-.083.002-.123l-.77.77-.707-.707L17.207 2.5l2.265 2.265-.707.707-.782-.782c.002.043.003.089.003.135v10.454z"/></svg>',FontSizeUI=class extends Plugin{static get pluginName(){return"FontSizeUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.t,i=this._getLocalizedOptions(),r=e.commands.get(FONT_SIZE),o=t("Font Size"),a=_prepareListOptions(i,r);e.ui.componentFactory.add(FONT_SIZE,c=>{const u=createDropdown(c);return addListToDropdown(u,a,{role:"menu",ariaLabel:o}),u.buttonView.set({label:o,icon:fontSizeIcon,tooltip:!0}),u.extendTemplate({attributes:{class:["ck-font-size-dropdown"]}}),u.bind("isEnabled").to(r),this.listenTo(u,"execute",h=>{e.execute(h.source.commandName,{value:h.source.commandParam}),e.editing.view.focus()}),u}),e.ui.componentFactory.add(`menuBar:${FONT_SIZE}`,c=>{const u=new MenuBarMenuView(c);u.buttonView.set({label:o,icon:fontSizeIcon}),u.bind("isEnabled").to(r);const h=new MenuBarMenuListView(c);for(const d of a){const f=new MenuBarMenuListItemView(c,u),m=new MenuBarMenuListItemButtonView(c);m.set({role:"menuitemradio",isToggleable:!0}),m.bind(...Object.keys(d.model)).to(d.model),m.delegate("execute").to(u),m.on("execute",()=>{e.execute(d.model.commandName,{value:d.model.commandParam}),e.editing.view.focus()}),f.children.add(m),h.items.add(f)}return u.panelView.children.add(h),u})}_getLocalizedOptions(){const e=this.editor,t=e.t,i={Default:t("Default"),Tiny:t("Tiny"),Small:t("Small"),Big:t("Big"),Huge:t("Huge")};return normalizeOptions(e.config.get(FONT_SIZE).options).map(o=>{const a=i[o.title];return a&&a!=o.title&&(o=Object.assign({},o,{title:a})),o})}};function _prepareListOptions(e,t){const i=new Collection;for(const r of e){const o={type:"button",model:new Model({commandName:FONT_SIZE,commandParam:r.model,label:r.title,class:"ck-fontsize-option",role:"menuitemradio",withText:!0})};r.view&&typeof r.view!="string"&&(r.view.styles&&o.model.set("labelStyle",`font-size:${r.view.styles["font-size"]}`),r.view.classes&&o.model.set("class",`${o.model.class} ${r.view.classes}`)),o.model.bind("isOn").to(t,"value",a=>a===r.model),i.add(o)}return i}var FontSize=class extends Plugin{static get requires(){return[FontSizeEditing,FontSizeUI]}static get pluginName(){return"FontSize"}static get isOfficialPlugin(){return!0}normalizeSizeOptions(e){return normalizeOptions(e)}},FontColorCommand=class extends FontCommand{constructor(e){super(e,FONT_COLOR)}},FontColorEditing=class extends Plugin{static get pluginName(){return"FontColorEditing"}static get isOfficialPlugin(){return!0}constructor(e){super(e),e.config.define(FONT_COLOR,{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),e.conversion.for("upcast").elementToAttribute({view:{name:"span",styles:{color:/[\s\S]+/}},model:{key:FONT_COLOR,value:renderUpcastAttribute("color")}}),e.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{color:/^#?\w+$/}},model:{key:FONT_COLOR,value:t=>t.getAttribute("color")}}),e.conversion.for("downcast").attributeToElement({model:FONT_COLOR,view:renderDowncastElement("color")}),e.commands.add(FONT_COLOR,new FontColorCommand(e)),e.model.schema.extend("$text",{allowAttributes:FONT_COLOR}),e.model.schema.setAttributeProperties(FONT_COLOR,{isFormatting:!0,copyOnEnter:!0})}},ColorUI=class extends Plugin{commandName;componentName;icon;dropdownLabel;columns;constructor(e,{commandName:t,componentName:i,icon:r,dropdownLabel:o}){super(e),this.commandName=t,this.componentName=i,this.icon=r,this.dropdownLabel=o,this.columns=e.config.get(`${this.componentName}.columns`)}init(){const e=this.editor,t=e.locale,i=t.t,r=e.commands.get(this.commandName),o=e.config.get(this.componentName),a=normalizeColorOptions(o.colors),c=getLocalizedColorOptions(t,a),u=o.documentColors,h=o.colorPicker!==!1;e.ui.componentFactory.add(this.componentName,d=>{const f=createDropdown(d);let m=!1;const g=addColorSelectorToDropdown({dropdownView:f,colors:c.map(v=>({label:v.label,color:v.model,options:{hasBorder:v.hasBorder}})),columns:this.columns,removeButtonLabel:i("Remove color"),colorPickerLabel:i("Color picker"),documentColorsLabel:u!==0?i("Document colors"):"",documentColorsCount:u===void 0?this.columns:u,colorPickerViewConfig:h?o.colorPicker||{}:!1});return g.bind("selectedColor").to(r,"value"),f.buttonView.set({label:this.dropdownLabel,icon:this.icon,tooltip:!0}),f.extendTemplate({attributes:{class:"ck-color-ui-dropdown"}}),f.bind("isEnabled").to(r),g.on("execute",(v,_)=>{f.isOpen&&e.execute(this.commandName,{value:_.value,batch:this._undoStepBatch}),_.source!=="colorPicker"&&e.editing.view.focus(),_.source==="colorPickerSaveButton"&&(f.isOpen=!1)}),g.on("colorPicker:show",()=>{this._undoStepBatch=e.model.createBatch()}),g.on("colorPicker:cancel",()=>{this._undoStepBatch.operations.length&&(f.isOpen=!1,e.execute("undo",this._undoStepBatch)),e.editing.view.focus()}),f.on("change:isOpen",(v,_,b)=>{m||(m=!0,f.colorSelectorView.appendUI()),b&&(u!==0&&g.updateDocumentColors(e.model,this.componentName),g.updateSelectedColors(),g.showColorGridsFragment())}),focusChildOnDropdownOpen(f,()=>f.colorSelectorView.colorGridsFragmentView.staticColorsGrid.items.find(v=>v.isOn)),f}),e.ui.componentFactory.add(`menuBar:${this.componentName}`,d=>{const f=new MenuBarMenuView(d);f.buttonView.set({label:this.dropdownLabel,icon:this.icon}),f.bind("isEnabled").to(r);let m=!1;const g=new ColorSelectorView(d,{colors:c.map(v=>({label:v.label,color:v.model,options:{hasBorder:v.hasBorder}})),columns:this.columns,removeButtonLabel:i("Remove color"),colorPickerLabel:i("Color picker"),documentColorsLabel:u!==0?i("Document colors"):"",documentColorsCount:u===void 0?this.columns:u,colorPickerViewConfig:!1});return g.bind("selectedColor").to(r,"value"),g.delegate("execute").to(f),g.on("execute",(v,_)=>{e.execute(this.commandName,{value:_.value,batch:this._undoStepBatch}),e.editing.view.focus()}),f.on("change:isOpen",(v,_,b)=>{m||(m=!0,g.appendUI()),b&&(u!==0&&g.updateDocumentColors(e.model,this.componentName),g.updateSelectedColors(),g.showColorGridsFragment())}),f.panelView.children.add(g),f})}},fontColorIcon='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.4 10.3 10 4.5l-2.4 5.8h4.8zm.5 1.2H7.1L5.7 15H4.2l5-12h1.6l5 12h-1.5L13 11.5zm3.1 7H4a1 1 0 0 1 0-2h12a1 1 0 0 1 0 2z"/></svg>',FontColorUI=class extends ColorUI{constructor(e){const t=e.locale.t;super(e,{commandName:FONT_COLOR,componentName:FONT_COLOR,icon:fontColorIcon,dropdownLabel:t("Font Color")})}static get pluginName(){return"FontColorUI"}},FontColor=class extends Plugin{static get requires(){return[FontColorEditing,FontColorUI]}static get pluginName(){return"FontColor"}static get isOfficialPlugin(){return!0}},FontBackgroundColorCommand=class extends FontCommand{constructor(e){super(e,FONT_BACKGROUND_COLOR)}},FontBackgroundColorEditing=class extends Plugin{static get pluginName(){return"FontBackgroundColorEditing"}static get isOfficialPlugin(){return!0}constructor(e){super(e),e.config.define(FONT_BACKGROUND_COLOR,{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),e.data.addStyleProcessorRules(addBackgroundRules),e.conversion.for("upcast").elementToAttribute({view:{name:"span",styles:{"background-color":/[\s\S]+/}},model:{key:FONT_BACKGROUND_COLOR,value:renderUpcastAttribute("background-color")}}),e.conversion.for("downcast").attributeToElement({model:FONT_BACKGROUND_COLOR,view:renderDowncastElement("background-color")}),e.commands.add(FONT_BACKGROUND_COLOR,new FontBackgroundColorCommand(e)),e.model.schema.extend("$text",{allowAttributes:FONT_BACKGROUND_COLOR}),e.model.schema.setAttributeProperties(FONT_BACKGROUND_COLOR,{isFormatting:!0,copyOnEnter:!0})}},fontBackgroundColorIcon='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M4 2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2zm8.38 9.262H7.62L10 5.506l2.38 5.756zm.532 1.285L14.34 16h1.426L10.804 4H9.196L4.234 16H5.66l1.428-3.453h5.824z"/></svg>',FontBackgroundColorUI=class extends ColorUI{constructor(e){const t=e.locale.t;super(e,{commandName:FONT_BACKGROUND_COLOR,componentName:FONT_BACKGROUND_COLOR,icon:fontBackgroundColorIcon,dropdownLabel:t("Font Background Color")})}static get pluginName(){return"FontBackgroundColorUI"}},FontBackgroundColor=class extends Plugin{static get requires(){return[FontBackgroundColorEditing,FontBackgroundColorUI]}static get pluginName(){return"FontBackgroundColor"}static get isOfficialPlugin(){return!0}},Font=class extends Plugin{static get requires(){return[FontFamily,FontSize,FontColor,FontBackgroundColor]}static get pluginName(){return"Font"}static get isOfficialPlugin(){return!0}},ParagraphCommand=class extends Command{constructor(e){super(e),this._isEnabledBasedOnSelection=!1}refresh(){const e=this.editor.model,t=e.document,i=first(t.selection.getSelectedBlocks());this.value=!!i&&i.is("element","paragraph"),this.isEnabled=!!i&&checkCanBecomeParagraph(i,e.schema)}execute(e={}){const t=this.editor.model,i=t.document,r=e.selection||i.selection;t.canEditAt(r)&&t.change(o=>{const a=r.getSelectedBlocks();for(const c of a)!c.is("element","paragraph")&&checkCanBecomeParagraph(c,t.schema)&&o.rename(c,"paragraph")})}};function checkCanBecomeParagraph(e,t){return t.checkChild(e.parent,"paragraph")&&!t.isObject(e)}var InsertParagraphCommand=class extends Command{constructor(e){super(e),this._isEnabledBasedOnSelection=!1}execute(e){const t=this.editor.model,i=e.attributes;let r=e.position;return t.canEditAt(r)?t.change(o=>{if(r=this._findPositionToInsertParagraph(r,o),!r)return null;const a=o.createElement("paragraph");return i&&t.schema.setAllowedAttributes(a,i,o),t.insertContent(a,r),o.setSelection(a,"in"),o.createPositionAt(a,0)}):null}_findPositionToInsertParagraph(e,t){const i=this.editor.model;if(i.schema.checkChild(e,"paragraph"))return e;const r=i.schema.findAllowedParent(e,"paragraph");if(!r)return null;const o=e.parent,a=i.schema.checkChild(o,"$text");return o.isEmpty||a&&e.isAtEnd?i.createPositionAfter(o):!o.isEmpty&&a&&e.isAtStart?i.createPositionBefore(o):t.split(e,r).position}},Paragraph=class xs extends Plugin{static get pluginName(){return"Paragraph"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,i=t.model;t.commands.add("paragraph",new ParagraphCommand(t)),t.commands.add("insertParagraph",new InsertParagraphCommand(t)),i.schema.register("paragraph",{inheritAllFrom:"$block"}),t.conversion.elementToElement({model:"paragraph",view:"p"}),t.conversion.for("upcast").elementToElement({model:(r,{writer:o})=>!xs.paragraphLikeElements.has(r.name)||r.isEmpty?null:o.createElement("paragraph"),view:/.+/,converterPriority:"low"})}static paragraphLikeElements=new Set(["blockquote","dd","div","dt","h1","h2","h3","h4","h5","h6","li","p","td","th"])};const IMAGE_URL_REGEXP=new RegExp(String(/^(http(s)?:\/\/)?[\w-]+\.[\w.~:/[\]@!$&'()*+,;=%-]+/.source+/\.(jpg|jpeg|png|gif|ico|webp|JPG|JPEG|PNG|GIF|ICO|WEBP)/.source+/(\?[\w.~:/[\]@!$&'()*+,;=%-]*)?/.source+/(#[\w.~:/[\]@!$&'()*+,;=%-]*)?$/.source)),URL_REG_EXP=new RegExp("(^|\\s)(((?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(((?!www\\.)|(www\\.))(?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.)+(?:[a-z\\u00a1-\\uffff]{2,63})))(?::\\d{2,5})?(?:[/?#]\\S*)?)|((www.|(\\S+@))((?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.))+(?:[a-z\\u00a1-\\uffff]{2,63})))$","i");/**
* @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/const LIST_STYLE_TO_LIST_TYPE={},LIST_STYLE_TO_TYPE_ATTRIBUTE={},TYPE_ATTRIBUTE_TO_LIST_STYLE={},LIST_STYLE_TYPES=[{listStyle:"disc",typeAttribute:"disc",listType:"bulleted"},{listStyle:"circle",typeAttribute:"circle",listType:"bulleted"},{listStyle:"square",typeAttribute:"square",listType:"bulleted"},{listStyle:"decimal",typeAttribute:"1",listType:"numbered"},{listStyle:"decimal-leading-zero",typeAttribute:null,listType:"numbered"},{listStyle:"lower-roman",typeAttribute:"i",listType:"numbered"},{listStyle:"upper-roman",typeAttribute:"I",listType:"numbered"},{listStyle:"lower-alpha",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-alpha",typeAttribute:"A",listType:"numbered"},{listStyle:"lower-latin",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-latin",typeAttribute:"A",listType:"numbered"}];for(const{listStyle:e,typeAttribute:t,listType:i}of LIST_STYLE_TYPES)LIST_STYLE_TO_LIST_TYPE[e]=i,LIST_STYLE_TO_TYPE_ATTRIBUTE[e]=t,t&&(TYPE_ATTRIBUTE_TO_LIST_STYLE[t]=e);function getDefaults(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}let defaults=getDefaults();function changeDefaults(e){defaults=e}const escapeTest=/[&<>"']/,escapeReplace=/[&<>"']/g,escapeTestNoEncode=/[<>"']|&(?!#?\w+;)/,escapeReplaceNoEncode=/[<>"']|&(?!#?\w+;)/g,escapeReplacements={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},getEscapeReplacement=e=>escapeReplacements[e];function escape(e,t){if(t){if(escapeTest.test(e))return e.replace(escapeReplace,getEscapeReplacement)}else if(escapeTestNoEncode.test(e))return e.replace(escapeReplaceNoEncode,getEscapeReplacement);return e}const unescapeTest=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function unescape(e){return e.replace(unescapeTest,(t,i)=>(i=i.toLowerCase(),i==="colon"?":":i.charAt(0)==="#"?i.charAt(1)==="x"?String.fromCharCode(parseInt(i.substring(2),16)):String.fromCharCode(+i.substring(1)):""))}const caret=/(^|[^\[])\^/g;function edit(e,t){e=e.source||e,t=t||"";const i={replace:(r,o)=>(o=o.source||o,o=o.replace(caret,"$1"),e=e.replace(r,o),i),getRegex:()=>new RegExp(e,t)};return i}const nonWordAndColonTest=/[^\w:]/g,originIndependentUrl=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function cleanUrl(e,t,i){if(e){let r;try{r=decodeURIComponent(unescape(i)).replace(nonWordAndColonTest,"").toLowerCase()}catch{return null}if(r.indexOf("javascript:")===0||r.indexOf("vbscript:")===0||r.indexOf("data:")===0)return null}t&&!originIndependentUrl.test(i)&&(i=resolveUrl(t,i));try{i=encodeURI(i).replace(/%25/g,"%")}catch{return null}return i}const baseUrls={},justDomain=/^[^:]+:\/*[^/]*$/,protocol=/^([^:]+:)[\s\S]*$/,domain=/^([^:]+:\/*[^/]*)[\s\S]*$/;function resolveUrl(e,t){baseUrls[" "+e]||(justDomain.test(e)?baseUrls[" "+e]=e+"/":baseUrls[" "+e]=rtrim(e,"/",!0)),e=baseUrls[" "+e];const i=e.indexOf(":")===-1;return t.substring(0,2)==="//"?i?t:e.replace(protocol,"$1")+t:t.charAt(0)==="/"?i?t:e.replace(domain,"$1")+t:e+t}const noopTest={exec:function(){}};function merge(e){let t=1,i,r;for(;t<arguments.length;t++){i=arguments[t];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}function splitCells(e,t){const i=e.replace(/\|/g,(a,c,u)=>{let h=!1,d=c;for(;--d>=0&&u[d]==="\\";)h=!h;return h?"|":" |"}),r=i.split(/ \|/);let o=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;o<r.length;o++)r[o]=r[o].trim().replace(/\\\|/g,"|");return r}function rtrim(e,t,i){const r=e.length;if(r===0)return"";let o=0;for(;o<r;){const a=e.charAt(r-o-1);if(a===t&&!i)o++;else if(a!==t&&i)o++;else break}return e.substr(0,r-o)}function findClosingBracket(e,t){if(e.indexOf(t[1])===-1)return-1;const i=e.length;let r=0,o=0;for(;o<i;o++)if(e[o]==="\\")o++;else if(e[o]===t[0])r++;else if(e[o]===t[1]&&(r--,r<0))return o;return-1}function checkSanitizeDeprecation(e){e&&e.sanitize&&!e.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function repeatString(e,t){if(t<1)return"";let i="";for(;t>1;)t&1&&(i+=e),t>>=1,e+=e;return i+e}function outputLink(e,t,i,r){const o=t.href,a=t.title?escape(t.title):null,c=e[1].replace(/\\([\[\]])/g,"$1");if(e[0].charAt(0)!=="!"){r.state.inLink=!0;const u={type:"link",raw:i,href:o,title:a,text:c,tokens:r.inlineTokens(c,[])};return r.state.inLink=!1,u}else return{type:"image",raw:i,href:o,title:a,text:escape(c)}}function indentCodeCompensation(e,t){const i=e.match(/^(\s+)(?:```)/);if(i===null)return t;const r=i[1];return t.split(`
`).map(o=>{const a=o.match(/^\s+/);if(a===null)return o;const[c]=a;return c.length>=r.length?o.slice(r.length):o}).join(`
`)}var Tokenizer=class{constructor(e){this.options=e||defaults}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const i=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:rtrim(i,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const i=t[0],r=indentCodeCompensation(i,t[3]||"");return{type:"code",raw:i,lang:t[2]?t[2].trim():t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let i=t[2].trim();if(/#$/.test(i)){const o=rtrim(i,"#");(this.options.pedantic||!o||/ $/.test(o))&&(i=o.trim())}const r={type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:[]};return this.lexer.inline(r.text,r.tokens),r}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const i=t[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:t[0],tokens:this.lexer.blockTokens(i,[]),text:i}}}list(e){let t=this.rules.block.list.exec(e);if(t){let i,r,o,a,c,u,h,d,f,m,g,v,_=t[1].trim();const b=_.length>1,S={type:"list",raw:"",ordered:b,start:b?+_.slice(0,-1):"",loose:!1,items:[]};_=b?`\\d{1,9}\\${_.slice(-1)}`:`\\${_}`,this.options.pedantic&&(_=b?_:"[*+-]");const T=new RegExp(`^( {0,3}${_})((?: [^\\n]*)?(?:\\n|$))`);for(;e&&(v=!1,!(!(t=T.exec(e))||this.rules.block.hr.test(e)));){if(i=t[0],e=e.substring(i.length),d=t[2].split(`
`,1)[0],f=e.split(`
`,1)[0],this.options.pedantic?(a=2,g=d.trimLeft()):(a=t[2].search(/[^ ]/),a=a>4?1:a,g=d.slice(a),a+=t[1].length),u=!1,!d&&/^ *$/.test(f)&&(i+=f+`
`,e=e.substring(f.length+1),v=!0),!v){const I=new RegExp(`^ {0,${Math.min(3,a-1)}}(?:[*+-]|\\d{1,9}[.)])`);for(;e&&(m=e.split(`
`,1)[0],d=m,this.options.pedantic&&(d=d.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!I.test(d));){if(d.search(/[^ ]/)>=a||!d.trim())g+=`
`+d.slice(a);else if(!u)g+=`
`+d;else break;!u&&!d.trim()&&(u=!0),i+=m+`
`,e=e.substring(m.length+1)}}S.loose||(h?S.loose=!0:/\n *\n *$/.test(i)&&(h=!0)),this.options.gfm&&(r=/^\[[ xX]\] /.exec(g),r&&(o=r[0]!=="[ ] ",g=g.replace(/^\[[ xX]\] +/,""))),S.items.push({type:"list_item",raw:i,task:!!r,checked:o,loose:!1,text:g}),S.raw+=i}S.items[S.items.length-1].raw=i.trimRight(),S.items[S.items.length-1].text=g.trimRight(),S.raw=S.raw.trimRight();const A=S.items.length;for(c=0;c<A;c++){this.lexer.state.top=!1,S.items[c].tokens=this.lexer.blockTokens(S.items[c].text,[]);const I=S.items[c].tokens.filter(O=>O.type==="space"),R=I.every(O=>{const P=O.raw.split("");let L=0;for(const V of P)if(V===`
`&&(L+=1),L>1)return!0;return!1});!S.loose&&I.length&&R&&(S.loose=!0,S.items[c].loose=!0)}return S}}html(e){const t=this.rules.block.html.exec(e);if(t){const i={type:"html",raw:t[0],pre:!this.options.sanitizer&&(t[1]==="pre"||t[1]==="script"||t[1]==="style"),text:t[0]};return this.options.sanitize&&(i.type="paragraph",i.text=this.options.sanitizer?this.options.sanitizer(t[0]):escape(t[0]),i.tokens=[],this.lexer.inline(i.text,i.tokens)),i}}def(e){const t=this.rules.block.def.exec(e);if(t)return t[3]&&(t[3]=t[3].substring(1,t[3].length-1)),{type:"def",tag:t[1].toLowerCase().replace(/\s+/g," "),raw:t[0],href:t[2],title:t[3]}}table(e){const t=this.rules.block.table.exec(e);if(t){const i={type:"table",header:splitCells(t[1]).map(r=>({text:r})),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(i.header.length===i.align.length){i.raw=t[0];let r=i.align.length,o,a,c,u;for(o=0;o<r;o++)/^ *-+: *$/.test(i.align[o])?i.align[o]="right":/^ *:-+: *$/.test(i.align[o])?i.align[o]="center":/^ *:-+ *$/.test(i.align[o])?i.align[o]="left":i.align[o]=null;for(r=i.rows.length,o=0;o<r;o++)i.rows[o]=splitCells(i.rows[o],i.header.length).map(h=>({text:h}));for(r=i.header.length,a=0;a<r;a++)i.header[a].tokens=[],this.lexer.inlineTokens(i.header[a].text,i.header[a].tokens);for(r=i.rows.length,a=0;a<r;a++)for(u=i.rows[a],c=0;c<u.length;c++)u[c].tokens=[],this.lexer.inlineTokens(u[c].text,u[c].tokens);return i}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t){const i={type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const i={type:"paragraph",raw:t[0],text:t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1],tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}text(e){const t=this.rules.block.text.exec(e);if(t){const i={type:"text",raw:t[0],text:t[0],tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:escape(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):escape(t[0]):t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const i=t[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const a=rtrim(i.slice(0,-1),"\\");if((i.length-a.length)%2===0)return}else{const a=findClosingBracket(t[2],"()");if(a>-1){const u=(t[0].indexOf("!")===0?5:4)+t[1].length+a;t[2]=t[2].substring(0,a),t[0]=t[0].substring(0,u).trim(),t[3]=""}}let r=t[2],o="";if(this.options.pedantic){const a=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r);a&&(r=a[1],o=a[3])}else o=t[3]?t[3].slice(1,-1):"";return r=r.trim(),/^</.test(r)&&(this.options.pedantic&&!/>$/.test(i)?r=r.slice(1):r=r.slice(1,-1)),outputLink(t,{href:r&&r.replace(this.rules.inline._escapes,"$1"),title:o&&o.replace(this.rules.inline._escapes,"$1")},t[0],this.lexer)}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){let r=(i[2]||i[1]).replace(/\s+/g," ");if(r=t[r.toLowerCase()],!r||!r.href){const o=i[0].charAt(0);return{type:"text",raw:o,text:o}}return outputLink(i,r,i[0],this.lexer)}}emStrong(e,t,i=""){let r=this.rules.inline.emStrong.lDelim.exec(e);if(!r||r[3]&&i.match(/[\p{L}\p{N}]/u))return;const o=r[1]||r[2]||"";if(!o||o&&(i===""||this.rules.inline.punctuation.exec(i))){const a=r[0].length-1;let c,u,h=a,d=0;const f=r[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(f.lastIndex=0,t=t.slice(-1*e.length+a);(r=f.exec(t))!=null;){if(c=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!c)continue;if(u=c.length,r[3]||r[4]){h+=u;continue}else if((r[5]||r[6])&&a%3&&!((a+u)%3)){d+=u;continue}if(h-=u,h>0)continue;if(u=Math.min(u,u+h+d),Math.min(a,u)%2){const g=e.slice(1,a+r.index+u);return{type:"em",raw:e.slice(0,a+r.index+u+1),text:g,tokens:this.lexer.inlineTokens(g,[])}}const m=e.slice(2,a+r.index+u-1);return{type:"strong",raw:e.slice(0,a+r.index+u+1),text:m,tokens:this.lexer.inlineTokens(m,[])}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let i=t[2].replace(/\n/g," ");const r=/[^ ]/.test(i),o=/^ /.test(i)&&/ $/.test(i);return r&&o&&(i=i.substring(1,i.length-1)),i=escape(i,!0),{type:"codespan",raw:t[0],text:i}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2],[])}}autolink(e,t){const i=this.rules.inline.autolink.exec(e);if(i){let r,o;return i[2]==="@"?(r=escape(this.options.mangle?t(i[1]):i[1]),o="mailto:"+r):(r=escape(i[1]),o=r),{type:"link",raw:i[0],text:r,href:o,tokens:[{type:"text",raw:r,text:r}]}}}url(e,t){let i;if(i=this.rules.inline.url.exec(e)){let r,o;if(i[2]==="@")r=escape(this.options.mangle?t(i[0]):i[0]),o="mailto:"+r;else{let a;do a=i[0],i[0]=this.rules.inline._backpedal.exec(i[0])[0];while(a!==i[0]);r=escape(i[0]),i[1]==="www."?o="http://"+r:o=r}return{type:"link",raw:i[0],text:r,href:o,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e,t){const i=this.rules.inline.text.exec(e);if(i){let r;return this.lexer.state.inRawBlock?r=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):escape(i[0]):i[0]:r=escape(this.options.smartypants?t(i[0]):i[0]),{type:"text",raw:i[0],text:r}}}};const block={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)( [^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:noopTest,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};block._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/,block._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,block.def=edit(block.def).replace("label",block._label).replace("title",block._title).getRegex(),block.bullet=/(?:[*+-]|\d{1,9}[.)])/,block.listItemStart=edit(/^( *)(bull) */).replace("bull",block.bullet).getRegex(),block.list=edit(block.list).replace(/bull/g,block.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+block.def.source+")").getRegex(),block._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",block._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,block.html=edit(block.html,"i").replace("comment",block._comment).replace("tag",block._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),block.paragraph=edit(block._paragraph).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex(),block.blockquote=edit(block.blockquote).replace("paragraph",block.paragraph).getRegex(),block.normal=merge({},block),block.gfm=merge({},block.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),block.gfm.table=edit(block.gfm.table).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex(),block.gfm.paragraph=edit(block._paragraph).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",block.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex(),block.pedantic=merge({},block.normal,{html:edit(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",block._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:noopTest,paragraph:edit(block.normal._paragraph).replace("hr",block.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",block.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const inline={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:noopTest,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:noopTest,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};inline._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",inline.punctuation=edit(inline.punctuation).replace(/punctuation/g,inline._punctuation).getRegex(),inline.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,inline.escapedEmSt=/\\\*|\\_/g,inline._comment=edit(block._comment).replace("(?:-->|$)","-->").getRegex(),inline.emStrong.lDelim=edit(inline.emStrong.lDelim).replace(/punct/g,inline._punctuation).getRegex(),inline.emStrong.rDelimAst=edit(inline.emStrong.rDelimAst,"g").replace(/punct/g,inline._punctuation).getRegex(),inline.emStrong.rDelimUnd=edit(inline.emStrong.rDelimUnd,"g").replace(/punct/g,inline._punctuation).getRegex(),inline._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,inline._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,inline._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,inline.autolink=edit(inline.autolink).replace("scheme",inline._scheme).replace("email",inline._email).getRegex(),inline._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,inline.tag=edit(inline.tag).replace("comment",inline._comment).replace("attribute",inline._attribute).getRegex(),inline._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,inline._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,inline._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,inline.link=edit(inline.link).replace("label",inline._label).replace("href",inline._href).replace("title",inline._title).getRegex(),inline.reflink=edit(inline.reflink).replace("label",inline._label).replace("ref",block._label).getRegex(),inline.nolink=edit(inline.nolink).replace("ref",block._label).getRegex(),inline.reflinkSearch=edit(inline.reflinkSearch,"g").replace("reflink",inline.reflink).replace("nolink",inline.nolink).getRegex(),inline.normal=merge({},inline),inline.pedantic=merge({},inline.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:edit(/^!?\[(label)\]\((.*?)\)/).replace("label",inline._label).getRegex(),reflink:edit(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",inline._label).getRegex()}),inline.gfm=merge({},inline.normal,{escape:edit(inline.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),inline.gfm.url=edit(inline.gfm.url,"i").replace("email",inline.gfm._extended_email).getRegex(),inline.breaks=merge({},inline.gfm,{br:edit(inline.br).replace("{2,}","*").getRegex(),text:edit(inline.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});function smartypants(e){return e.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201C").replace(/"/g,"\u201D").replace(/\.{3}/g,"\u2026")}function mangle(e){let t="",i,r;const o=e.length;for(i=0;i<o;i++)r=e.charCodeAt(i),Math.random()>.5&&(r="x"+r.toString(16)),t+="&#"+r+";";return t}var Lexer=class vr{constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||defaults,this.options.tokenizer=this.options.tokenizer||new Tokenizer,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const i={block:block.normal,inline:inline.normal};this.options.pedantic?(i.block=block.pedantic,i.inline=inline.pedantic):this.options.gfm&&(i.block=block.gfm,this.options.breaks?i.inline=inline.breaks:i.inline=inline.gfm),this.tokenizer.rules=i}static get rules(){return{block,inline}}static lex(t,i){return new vr(i).lex(t)}static lexInline(t,i){return new vr(i).inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,`
`).replace(/\t/g,"    "),this.blockTokens(t,this.tokens);let i;for(;i=this.inlineQueue.shift();)this.inlineTokens(i.src,i.tokens);return this.tokens}blockTokens(t,i=[]){this.options.pedantic&&(t=t.replace(/^ +$/gm,""));let r,o,a,c;for(;t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(u=>(r=u.call({lexer:this},t,i))?(t=t.substring(r.raw.length),i.push(r),!0):!1))){if(r=this.tokenizer.space(t)){t=t.substring(r.raw.length),r.raw.length===1&&i.length>0?i[i.length-1].raw+=`
`:i.push(r);continue}if(r=this.tokenizer.code(t)){t=t.substring(r.raw.length),o=i[i.length-1],o&&(o.type==="paragraph"||o.type==="text")?(o.raw+=`
`+r.raw,o.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=o.text):i.push(r);continue}if(r=this.tokenizer.fences(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.heading(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.hr(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.blockquote(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.list(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.html(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.def(t)){t=t.substring(r.raw.length),o=i[i.length-1],o&&(o.type==="paragraph"||o.type==="text")?(o.raw+=`
`+r.raw,o.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=o.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.lheading(t)){t=t.substring(r.raw.length),i.push(r);continue}if(a=t,this.options.extensions&&this.options.extensions.startBlock){let u=1/0;const h=t.slice(1);let d;this.options.extensions.startBlock.forEach(function(f){d=f.call({lexer:this},h),typeof d=="number"&&d>=0&&(u=Math.min(u,d))}),u<1/0&&u>=0&&(a=t.substring(0,u+1))}if(this.state.top&&(r=this.tokenizer.paragraph(a))){o=i[i.length-1],c&&o.type==="paragraph"?(o.raw+=`
`+r.raw,o.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=o.text):i.push(r),c=a.length!==t.length,t=t.substring(r.raw.length);continue}if(r=this.tokenizer.text(t)){t=t.substring(r.raw.length),o=i[i.length-1],o&&o.type==="text"?(o.raw+=`
`+r.raw,o.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=o.text):i.push(r);continue}if(t){const u="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return this.state.top=!0,i}inline(t,i){this.inlineQueue.push({src:t,tokens:i})}inlineTokens(t,i=[]){let r,o,a,c=t,u,h,d;if(this.tokens.links){const f=Object.keys(this.tokens.links);if(f.length>0)for(;(u=this.tokenizer.rules.inline.reflinkSearch.exec(c))!=null;)f.includes(u[0].slice(u[0].lastIndexOf("[")+1,-1))&&(c=c.slice(0,u.index)+"["+repeatString("a",u[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(u=this.tokenizer.rules.inline.blockSkip.exec(c))!=null;)c=c.slice(0,u.index)+"["+repeatString("a",u[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(u=this.tokenizer.rules.inline.escapedEmSt.exec(c))!=null;)c=c.slice(0,u.index)+"++"+c.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;t;)if(h||(d=""),h=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(f=>(r=f.call({lexer:this},t,i))?(t=t.substring(r.raw.length),i.push(r),!0):!1))){if(r=this.tokenizer.escape(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.tag(t)){t=t.substring(r.raw.length),o=i[i.length-1],o&&r.type==="text"&&o.type==="text"?(o.raw+=r.raw,o.text+=r.text):i.push(r);continue}if(r=this.tokenizer.link(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(r.raw.length),o=i[i.length-1],o&&r.type==="text"&&o.type==="text"?(o.raw+=r.raw,o.text+=r.text):i.push(r);continue}if(r=this.tokenizer.emStrong(t,c,d)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.codespan(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.br(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.del(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.autolink(t,mangle)){t=t.substring(r.raw.length),i.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(t,mangle))){t=t.substring(r.raw.length),i.push(r);continue}if(a=t,this.options.extensions&&this.options.extensions.startInline){let f=1/0;const m=t.slice(1);let g;this.options.extensions.startInline.forEach(function(v){g=v.call({lexer:this},m),typeof g=="number"&&g>=0&&(f=Math.min(f,g))}),f<1/0&&f>=0&&(a=t.substring(0,f+1))}if(r=this.tokenizer.inlineText(a,smartypants)){t=t.substring(r.raw.length),r.raw.slice(-1)!=="_"&&(d=r.raw.slice(-1)),h=!0,o=i[i.length-1],o&&o.type==="text"?(o.raw+=r.raw,o.text+=r.text):i.push(r);continue}if(t){const f="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return i}},Renderer=class{constructor(e){this.options=e||defaults}code(e,t,i){const r=(t||"").match(/\S*/)[0];if(this.options.highlight){const o=this.options.highlight(e,r);o!=null&&o!==e&&(i=!0,e=o)}return e=e.replace(/\n$/,"")+`
`,r?'<pre><code class="'+this.options.langPrefix+escape(r,!0)+'">'+(i?e:escape(e,!0))+`</code></pre>
`:"<pre><code>"+(i?e:escape(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
`+e+`</blockquote>
`}html(e){return e}heading(e,t,i,r){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+r.slug(i)+'">'+e+"</h"+t+`>
`:"<h"+t+">"+e+"</h"+t+`>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(e,t,i){const r=t?"ol":"ul",o=t&&i!==1?' start="'+i+'"':"";return"<"+r+o+`>
`+e+"</"+r+`>
`}listitem(e){return"<li>"+e+`</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return"<p>"+e+`</p>
`}table(e,t){return t&&(t="<tbody>"+t+"</tbody>"),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
`+e+`</tr>
`}tablecell(e,t){const i=t.header?"th":"td";return(t.align?"<"+i+' align="'+t.align+'">':"<"+i+">")+e+"</"+i+`>
`}strong(e){return"<strong>"+e+"</strong>"}em(e){return"<em>"+e+"</em>"}codespan(e){return"<code>"+e+"</code>"}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return"<del>"+e+"</del>"}link(e,t,i){if(e=cleanUrl(this.options.sanitize,this.options.baseUrl,e),e===null)return i;let r='<a href="'+escape(e)+'"';return t&&(r+=' title="'+t+'"'),r+=">"+i+"</a>",r}image(e,t,i){if(e=cleanUrl(this.options.sanitize,this.options.baseUrl,e),e===null)return i;let r='<img src="'+e+'" alt="'+i+'"';return t&&(r+=' title="'+t+'"'),r+=this.options.xhtml?"/>":">",r}text(e){return e}},TextRenderer=class{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,i){return""+i}image(e,t,i){return""+i}br(){return""}},Slugger=class{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let i=e,r=0;if(this.seen.hasOwnProperty(i)){r=this.seen[e];do r++,i=e+"-"+r;while(this.seen.hasOwnProperty(i))}return t||(this.seen[e]=r,this.seen[i]=0),i}slug(e,t={}){const i=this.serialize(e);return this.getNextSafeSlug(i,t.dryrun)}},Parser=class wr{constructor(t){this.options=t||defaults,this.options.renderer=this.options.renderer||new Renderer,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new TextRenderer,this.slugger=new Slugger}static parse(t,i){return new wr(i).parse(t)}static parseInline(t,i){return new wr(i).parseInline(t)}parse(t,i=!0){let r="",o,a,c,u,h,d,f,m,g,v,_,b,S,T,A,I,R,O,P;const L=t.length;for(o=0;o<L;o++){if(v=t[o],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[v.type]&&(P=this.options.extensions.renderers[v.type].call({parser:this},v),P!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(v.type))){r+=P||"";continue}switch(v.type){case"space":continue;case"hr":{r+=this.renderer.hr();continue}case"heading":{r+=this.renderer.heading(this.parseInline(v.tokens),v.depth,unescape(this.parseInline(v.tokens,this.textRenderer)),this.slugger);continue}case"code":{r+=this.renderer.code(v.text,v.lang,v.escaped);continue}case"table":{for(m="",f="",u=v.header.length,a=0;a<u;a++)f+=this.renderer.tablecell(this.parseInline(v.header[a].tokens),{header:!0,align:v.align[a]});for(m+=this.renderer.tablerow(f),g="",u=v.rows.length,a=0;a<u;a++){for(d=v.rows[a],f="",h=d.length,c=0;c<h;c++)f+=this.renderer.tablecell(this.parseInline(d[c].tokens),{header:!1,align:v.align[c]});g+=this.renderer.tablerow(f)}r+=this.renderer.table(m,g);continue}case"blockquote":{g=this.parse(v.tokens),r+=this.renderer.blockquote(g);continue}case"list":{for(_=v.ordered,b=v.start,S=v.loose,u=v.items.length,g="",a=0;a<u;a++)A=v.items[a],I=A.checked,R=A.task,T="",A.task&&(O=this.renderer.checkbox(I),S?A.tokens.length>0&&A.tokens[0].type==="paragraph"?(A.tokens[0].text=O+" "+A.tokens[0].text,A.tokens[0].tokens&&A.tokens[0].tokens.length>0&&A.tokens[0].tokens[0].type==="text"&&(A.tokens[0].tokens[0].text=O+" "+A.tokens[0].tokens[0].text)):A.tokens.unshift({type:"text",text:O}):T+=O),T+=this.parse(A.tokens,S),g+=this.renderer.listitem(T,R,I);r+=this.renderer.list(g,_,b);continue}case"html":{r+=this.renderer.html(v.text);continue}case"paragraph":{r+=this.renderer.paragraph(this.parseInline(v.tokens));continue}case"text":{for(g=v.tokens?this.parseInline(v.tokens):v.text;o+1<L&&t[o+1].type==="text";)v=t[++o],g+=`
`+(v.tokens?this.parseInline(v.tokens):v.text);r+=i?this.renderer.paragraph(g):g;continue}default:{const V='Token with "'+v.type+'" type was not found.';if(this.options.silent){console.error(V);return}else throw new Error(V)}}}return r}parseInline(t,i){i=i||this.renderer;let r="",o,a,c;const u=t.length;for(o=0;o<u;o++){if(a=t[o],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]&&(c=this.options.extensions.renderers[a.type].call({parser:this},a),c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type))){r+=c||"";continue}switch(a.type){case"escape":{r+=i.text(a.text);break}case"html":{r+=i.html(a.text);break}case"link":{r+=i.link(a.href,a.title,this.parseInline(a.tokens,i));break}case"image":{r+=i.image(a.href,a.title,a.text);break}case"strong":{r+=i.strong(this.parseInline(a.tokens,i));break}case"em":{r+=i.em(this.parseInline(a.tokens,i));break}case"codespan":{r+=i.codespan(a.text);break}case"br":{r+=i.br();break}case"del":{r+=i.del(this.parseInline(a.tokens,i));break}case"text":{r+=i.text(a.text);break}default:{const h='Token with "'+a.type+'" type was not found.';if(this.options.silent){console.error(h);return}else throw new Error(h)}}}return r}};function marked(e,t,i){if(typeof e>"u"||e===null)throw new Error("marked(): input parameter is undefined or null");if(typeof e!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if(typeof t=="function"&&(i=t,t=null),t=merge({},marked.defaults,t||{}),checkSanitizeDeprecation(t),i){const r=t.highlight;let o;try{o=Lexer.lex(e,t)}catch(u){return i(u)}const a=function(u){let h;if(!u)try{t.walkTokens&&marked.walkTokens(o,t.walkTokens),h=Parser.parse(o,t)}catch(d){u=d}return t.highlight=r,u?i(u):i(null,h)};if(!r||r.length<3||(delete t.highlight,!o.length))return a();let c=0;marked.walkTokens(o,function(u){u.type==="code"&&(c++,setTimeout(()=>{r(u.text,u.lang,function(h,d){if(h)return a(h);d!=null&&d!==u.text&&(u.text=d,u.escaped=!0),c--,c===0&&a()})},0))}),c===0&&a();return}try{const r=Lexer.lex(e,t);return t.walkTokens&&marked.walkTokens(r,t.walkTokens),Parser.parse(r,t)}catch(r){if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t.silent)return"<p>An error occurred:</p><pre>"+escape(r.message+"",!0)+"</pre>";throw r}}marked.options=marked.setOptions=function(e){return merge(marked.defaults,e),changeDefaults(marked.defaults),marked},marked.getDefaults=getDefaults,marked.defaults=defaults,marked.use=function(...e){const t=merge({},...e),i=marked.defaults.extensions||{renderers:{},childTokens:{}};let r;e.forEach(o=>{if(o.extensions&&(r=!0,o.extensions.forEach(a=>{if(!a.name)throw new Error("extension name required");if(a.renderer){const c=i.renderers?i.renderers[a.name]:null;c?i.renderers[a.name]=function(...u){let h=a.renderer.apply(this,u);return h===!1&&(h=c.apply(this,u)),h}:i.renderers[a.name]=a.renderer}if(a.tokenizer){if(!a.level||a.level!=="block"&&a.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");i[a.level]?i[a.level].unshift(a.tokenizer):i[a.level]=[a.tokenizer],a.start&&(a.level==="block"?i.startBlock?i.startBlock.push(a.start):i.startBlock=[a.start]:a.level==="inline"&&(i.startInline?i.startInline.push(a.start):i.startInline=[a.start]))}a.childTokens&&(i.childTokens[a.name]=a.childTokens)})),o.renderer){const a=marked.defaults.renderer||new Renderer;for(const c in o.renderer){const u=a[c];a[c]=(...h)=>{let d=o.renderer[c].apply(a,h);return d===!1&&(d=u.apply(a,h)),d}}t.renderer=a}if(o.tokenizer){const a=marked.defaults.tokenizer||new Tokenizer;for(const c in o.tokenizer){const u=a[c];a[c]=(...h)=>{let d=o.tokenizer[c].apply(a,h);return d===!1&&(d=u.apply(a,h)),d}}t.tokenizer=a}if(o.walkTokens){const a=marked.defaults.walkTokens;t.walkTokens=function(c){o.walkTokens.call(this,c),a&&a.call(this,c)}}r&&(t.extensions=i),marked.setOptions(t)})},marked.walkTokens=function(e,t){for(const i of e)switch(t.call(marked,i),i.type){case"table":{for(const r of i.header)marked.walkTokens(r.tokens,t);for(const r of i.rows)for(const o of r)marked.walkTokens(o.tokens,t);break}case"list":{marked.walkTokens(i.items,t);break}default:marked.defaults.extensions&&marked.defaults.extensions.childTokens&&marked.defaults.extensions.childTokens[i.type]?marked.defaults.extensions.childTokens[i.type].forEach(function(r){marked.walkTokens(i[r],t)}):i.tokens&&marked.walkTokens(i.tokens,t)}},marked.parseInline=function(e,t){if(typeof e>"u"||e===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof e!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");t=merge({},marked.defaults,t||{}),checkSanitizeDeprecation(t);try{const i=Lexer.lexInline(e,t);return t.walkTokens&&marked.walkTokens(i,t.walkTokens),Parser.parseInline(i,t)}catch(i){if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,t.silent)return"<p>An error occurred:</p><pre>"+escape(i.message+"",!0)+"</pre>";throw i}},marked.Parser=Parser,marked.parser=Parser.parse,marked.Renderer=Renderer,marked.TextRenderer=TextRenderer,marked.Lexer=Lexer,marked.lexer=Lexer.lex,marked.Tokenizer=Tokenizer,marked.Slugger=Slugger,marked.parse=marked;const options=marked.options,setOptions=marked.setOptions,use=marked.use,walkTokens=marked.walkTokens,parseInline=marked.parseInline,parser=Parser.parse,lexer=Lexer.lex;function extend(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])}return e}function repeat(e,t){return Array(t+1).join(e)}function trimLeadingNewlines(e){return e.replace(/^\n*/,"")}function trimTrailingNewlines(e){for(var t=e.length;t>0&&e[t-1]===`
`;)t--;return e.substring(0,t)}var blockElements=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"];function isBlock(e){return is(e,blockElements)}var voidElements=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function isVoid(e){return is(e,voidElements)}function hasVoid(e){return has(e,voidElements)}var meaningfulWhenBlankElements=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function isMeaningfulWhenBlank(e){return is(e,meaningfulWhenBlankElements)}function hasMeaningfulWhenBlank(e){return has(e,meaningfulWhenBlankElements)}function is(e,t){return t.indexOf(e.nodeName)>=0}function has(e,t){return e.getElementsByTagName&&t.some(function(i){return e.getElementsByTagName(i).length})}var rules$1={};rules$1.paragraph={filter:"p",replacement:function(e){return`

`+e+`

`}},rules$1.lineBreak={filter:"br",replacement:function(e,t,i){return i.br+`
`}},rules$1.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(e,t,i){var r=Number(t.nodeName.charAt(1));if(i.headingStyle==="setext"&&r<3){var o=repeat(r===1?"=":"-",e.length);return`

`+e+`
`+o+`

`}else return`

`+repeat("#",r)+" "+e+`

`}},rules$1.blockquote={filter:"blockquote",replacement:function(e){return e=e.replace(/^\n+|\n+$/g,""),e=e.replace(/^/gm,"> "),`

`+e+`

`}},rules$1.list={filter:["ul","ol"],replacement:function(e,t){var i=t.parentNode;return i.nodeName==="LI"&&i.lastElementChild===t?`
`+e:`

`+e+`

`}},rules$1.listItem={filter:"li",replacement:function(e,t,i){e=e.replace(/^\n+/,"").replace(/\n+$/,`
`).replace(/\n/gm,`
    `);var r=i.bulletListMarker+"   ",o=t.parentNode;if(o.nodeName==="OL"){var a=o.getAttribute("start"),c=Array.prototype.indexOf.call(o.children,t);r=(a?Number(a)+c:c+1)+".  "}return r+e+(t.nextSibling&&!/\n$/.test(e)?`
`:"")}},rules$1.indentedCodeBlock={filter:function(e,t){return t.codeBlockStyle==="indented"&&e.nodeName==="PRE"&&e.firstChild&&e.firstChild.nodeName==="CODE"},replacement:function(e,t,i){return`

    `+t.firstChild.textContent.replace(/\n/g,`
    `)+`

`}},rules$1.fencedCodeBlock={filter:function(e,t){return t.codeBlockStyle==="fenced"&&e.nodeName==="PRE"&&e.firstChild&&e.firstChild.nodeName==="CODE"},replacement:function(e,t,i){for(var r=t.firstChild.getAttribute("class")||"",o=(r.match(/language-(\S+)/)||[null,""])[1],a=t.firstChild.textContent,c=i.fence.charAt(0),u=3,h=new RegExp("^"+c+"{3,}","gm"),d;d=h.exec(a);)d[0].length>=u&&(u=d[0].length+1);var f=repeat(c,u);return`

`+f+o+`
`+a.replace(/\n$/,"")+`
`+f+`

`}},rules$1.horizontalRule={filter:"hr",replacement:function(e,t,i){return`

`+i.hr+`

`}},rules$1.inlineLink={filter:function(e,t){return t.linkStyle==="inlined"&&e.nodeName==="A"&&e.getAttribute("href")},replacement:function(e,t){var i=t.getAttribute("href");i&&(i=i.replace(/([()])/g,"\\$1"));var r=cleanAttribute(t.getAttribute("title"));return r&&(r=' "'+r.replace(/"/g,'\\"')+'"'),"["+e+"]("+i+r+")"}},rules$1.referenceLink={filter:function(e,t){return t.linkStyle==="referenced"&&e.nodeName==="A"&&e.getAttribute("href")},replacement:function(e,t,i){var r=t.getAttribute("href"),o=cleanAttribute(t.getAttribute("title"));o&&(o=' "'+o+'"');var a,c;switch(i.linkReferenceStyle){case"collapsed":a="["+e+"][]",c="["+e+"]: "+r+o;break;case"shortcut":a="["+e+"]",c="["+e+"]: "+r+o;break;default:var u=this.references.length+1;a="["+e+"]["+u+"]",c="["+u+"]: "+r+o}return this.references.push(c),a},references:[],append:function(e){var t="";return this.references.length&&(t=`

`+this.references.join(`
`)+`

`,this.references=[]),t}},rules$1.emphasis={filter:["em","i"],replacement:function(e,t,i){return e.trim()?i.emDelimiter+e+i.emDelimiter:""}},rules$1.strong={filter:["strong","b"],replacement:function(e,t,i){return e.trim()?i.strongDelimiter+e+i.strongDelimiter:""}},rules$1.code={filter:function(e){var t=e.previousSibling||e.nextSibling,i=e.parentNode.nodeName==="PRE"&&!t;return e.nodeName==="CODE"&&!i},replacement:function(e){if(!e)return"";e=e.replace(/\r?\n|\r/g," ");for(var t=/^`|^ .*?[^ ].* $|`$/.test(e)?" ":"",i="`",r=e.match(/`+/gm)||[];r.indexOf(i)!==-1;)i=i+"`";return i+t+e+t+i}},rules$1.image={filter:"img",replacement:function(e,t){var i=cleanAttribute(t.getAttribute("alt")),r=t.getAttribute("src")||"",o=cleanAttribute(t.getAttribute("title")),a=o?' "'+o+'"':"";return r?"!["+i+"]("+r+a+")":""}};function cleanAttribute(e){return e?e.replace(/(\n+\s*)+/g,`
`):""}function Rules(e){this.options=e,this._keep=[],this._remove=[],this.blankRule={replacement:e.blankReplacement},this.keepReplacement=e.keepReplacement,this.defaultRule={replacement:e.defaultReplacement},this.array=[];for(var t in e.rules)this.array.push(e.rules[t])}Rules.prototype={add:function(e,t){this.array.unshift(t)},keep:function(e){this._keep.unshift({filter:e,replacement:this.keepReplacement})},remove:function(e){this._remove.unshift({filter:e,replacement:function(){return""}})},forNode:function(e){if(e.isBlank)return this.blankRule;var t;return(t=findRule(this.array,e,this.options))||(t=findRule(this._keep,e,this.options))||(t=findRule(this._remove,e,this.options))?t:this.defaultRule},forEach:function(e){for(var t=0;t<this.array.length;t++)e(this.array[t],t)}};function findRule(e,t,i){for(var r=0;r<e.length;r++){var o=e[r];if(filterValue(o,t,i))return o}}function filterValue(e,t,i){var r=e.filter;if(typeof r=="string"){if(r===t.nodeName.toLowerCase())return!0}else if(Array.isArray(r)){if(r.indexOf(t.nodeName.toLowerCase())>-1)return!0}else if(typeof r=="function"){if(r.call(e,t,i))return!0}else throw new TypeError("`filter` needs to be a string, array, or function")}function collapseWhitespace(e){var t=e.element,i=e.isBlock,r=e.isVoid,o=e.isPre||function(m){return m.nodeName==="PRE"};if(!(!t.firstChild||o(t))){for(var a=null,c=!1,u=null,h=next(u,t,o);h!==t;){if(h.nodeType===3||h.nodeType===4){var d=h.data.replace(/[ \r\n\t]+/g," ");if((!a||/ $/.test(a.data))&&!c&&d[0]===" "&&(d=d.substr(1)),!d){h=remove(h);continue}h.data=d,a=h}else if(h.nodeType===1)i(h)||h.nodeName==="BR"?(a&&(a.data=a.data.replace(/ $/,"")),a=null,c=!1):r(h)||o(h)?(a=null,c=!0):a&&(c=!1);else{h=remove(h);continue}var f=next(u,h,o);u=h,h=f}a&&(a.data=a.data.replace(/ $/,""),a.data||remove(a))}}function remove(e){var t=e.nextSibling||e.parentNode;return e.parentNode.removeChild(e),t}function next(e,t,i){return e&&e.parentNode===t||i(t)?t.nextSibling||t.parentNode:t.firstChild||t.nextSibling||t.parentNode}var root=typeof window<"u"?window:{};function canParseHTMLNatively(){var e=root.DOMParser,t=!1;try{new e().parseFromString("","text/html")&&(t=!0)}catch{}return t}function createHTMLParser(){var e=function(){};return shouldUseActiveX()?e.prototype.parseFromString=function(t){var i=new window.ActiveXObject("htmlfile");return i.designMode="on",i.open(),i.write(t),i.close(),i}:e.prototype.parseFromString=function(t){var i=document.implementation.createHTMLDocument("");return i.open(),i.write(t),i.close(),i},e}function shouldUseActiveX(){var e=!1;try{document.implementation.createHTMLDocument("").open()}catch{root.ActiveXObject&&(e=!0)}return e}var HTMLParser=canParseHTMLNatively()?root.DOMParser:createHTMLParser();function RootNode(e,t){var i;if(typeof e=="string"){var r=htmlParser().parseFromString('<x-turndown id="turndown-root">'+e+"</x-turndown>","text/html");i=r.getElementById("turndown-root")}else i=e.cloneNode(!0);return collapseWhitespace({element:i,isBlock,isVoid,isPre:t.preformattedCode?isPreOrCode:null}),i}var _htmlParser;function htmlParser(){return _htmlParser=_htmlParser||new HTMLParser,_htmlParser}function isPreOrCode(e){return e.nodeName==="PRE"||e.nodeName==="CODE"}function Node$1(e,t){return e.isBlock=isBlock(e),e.isCode=e.nodeName==="CODE"||e.parentNode.isCode,e.isBlank=isBlank(e),e.flankingWhitespace=flankingWhitespace(e,t),e}function isBlank(e){return!isVoid(e)&&!isMeaningfulWhenBlank(e)&&/^\s*$/i.test(e.textContent)&&!hasVoid(e)&&!hasMeaningfulWhenBlank(e)}function flankingWhitespace(e,t){if(e.isBlock||t.preformattedCode&&e.isCode)return{leading:"",trailing:""};var i=edgeWhitespace(e.textContent);return i.leadingAscii&&isFlankedByWhitespace("left",e,t)&&(i.leading=i.leadingNonAscii),i.trailingAscii&&isFlankedByWhitespace("right",e,t)&&(i.trailing=i.trailingNonAscii),{leading:i.leading,trailing:i.trailing}}function edgeWhitespace(e){var t=e.match(/^(([ \t\r\n]*)(\s*))(?:(?=\S)[\s\S]*\S)?((\s*?)([ \t\r\n]*))$/);return{leading:t[1],leadingAscii:t[2],leadingNonAscii:t[3],trailing:t[4],trailingNonAscii:t[5],trailingAscii:t[6]}}function isFlankedByWhitespace(e,t,i){var r,o,a;return e==="left"?(r=t.previousSibling,o=/ $/):(r=t.nextSibling,o=/^ /),r&&(r.nodeType===3?a=o.test(r.nodeValue):i.preformattedCode&&r.nodeName==="CODE"?a=!1:r.nodeType===1&&!isBlock(r)&&(a=o.test(r.textContent))),a}var reduce=Array.prototype.reduce,escapes=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function TurndownService(e){if(!(this instanceof TurndownService))return new TurndownService(e);var t={rules:rules$1,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function(i,r){return r.isBlock?`

`:""},keepReplacement:function(i,r){return r.isBlock?`

`+r.outerHTML+`

`:r.outerHTML},defaultReplacement:function(i,r){return r.isBlock?`

`+i+`

`:i}};this.options=extend({},t,e),this.rules=new Rules(this.options)}TurndownService.prototype={turndown:function(e){if(!canConvert(e))throw new TypeError(e+" is not a string, or an element/document/fragment node.");if(e==="")return"";var t=process$1.call(this,new RootNode(e,this.options));return postProcess.call(this,t)},use:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)this.use(e[t]);else if(typeof e=="function")e(this);else throw new TypeError("plugin must be a Function or an Array of Functions");return this},addRule:function(e,t){return this.rules.add(e,t),this},keep:function(e){return this.rules.keep(e),this},remove:function(e){return this.rules.remove(e),this},escape:function(e){return escapes.reduce(function(t,i){return t.replace(i[0],i[1])},e)}};function process$1(e){var t=this;return reduce.call(e.childNodes,function(i,r){r=new Node$1(r,t.options);var o="";return r.nodeType===3?o=r.isCode?r.nodeValue:t.escape(r.nodeValue):r.nodeType===1&&(o=replacementForNode.call(t,r)),join(i,o)},"")}function postProcess(e){var t=this;return this.rules.forEach(function(i){typeof i.append=="function"&&(e=join(e,i.append(t.options)))}),e.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function replacementForNode(e){var t=this.rules.forNode(e),i=process$1.call(this,e),r=e.flankingWhitespace;return(r.leading||r.trailing)&&(i=i.trim()),r.leading+t.replacement(i,e,this.options)+r.trailing}function join(e,t){var i=trimTrailingNewlines(e),r=trimLeadingNewlines(t),o=Math.max(e.length-i.length,t.length-r.length),a=`

`.substring(0,o);return i+a+r}function canConvert(e){return e!=null&&(typeof e=="string"||e.nodeType&&(e.nodeType===1||e.nodeType===9||e.nodeType===11))}var indexOf=Array.prototype.indexOf,every=Array.prototype.every,rules={};rules.tableCell={filter:["th","td"],replacement:function(e,t){return cell(e,t)}},rules.tableRow={filter:"tr",replacement:function(e,t){var i="",r={left:":--",right:"--:",center:":-:"};if(isHeadingRow(t))for(var o=0;o<t.childNodes.length;o++){var a="---",c=(t.childNodes[o].getAttribute("align")||"").toLowerCase();c&&(a=r[c]||a),i+=cell(a,t.childNodes[o])}return`
`+e+(i?`
`+i:"")}},rules.table={filter:function(e){return e.nodeName==="TABLE"&&isHeadingRow(e.rows[0])},replacement:function(e){return e=e.replace(`

`,`
`),`

`+e+`

`}},rules.tableSection={filter:["thead","tbody","tfoot"],replacement:function(e){return e}};function isHeadingRow(e){var t=e.parentNode;return t.nodeName==="THEAD"||t.firstChild===e&&(t.nodeName==="TABLE"||isFirstTbody(t))&&every.call(e.childNodes,function(i){return i.nodeName==="TH"})}function isFirstTbody(e){var t=e.previousSibling;return e.nodeName==="TBODY"&&(!t||t.nodeName==="THEAD"&&/^\s*$/i.test(t.textContent))}function cell(e,t){var i=indexOf.call(t.parentNode.childNodes,t),r=" ";return i===0&&(r="| "),r+e+" |"}const autolinkRegex=new RegExp(/\b(?:(?:https?|ftp):\/\/|www\.)/.source+/(?![-_])(?:[-_a-z0-9\u00a1-\uffff]{1,63}\.)+(?:[a-z\u00a1-\uffff]{2,63})/.source+/(?:[^\s<>]*)/.source,"gi"),defaultHandledKeyCodes=[keyCodes.arrowup,keyCodes.arrowdown,keyCodes.esc],defaultCommitKeyCodes=[keyCodes.enter,keyCodes.tab];var niceErrors={0:"Invalid value for configuration 'enforceActions', expected 'never', 'always' or 'observed'",1:function(t,i){return"Cannot apply '"+t+"' to '"+i.toString()+"': Field not found."},5:"'keys()' can only be used on observable objects, arrays, sets and maps",6:"'values()' can only be used on observable objects, arrays, sets and maps",7:"'entries()' can only be used on observable objects, arrays and maps",8:"'set()' can only be used on observable objects, arrays and maps",9:"'remove()' can only be used on observable objects, arrays and maps",10:"'has()' can only be used on observable objects, arrays and maps",11:"'get()' can only be used on observable objects, arrays and maps",12:"Invalid annotation",13:"Dynamic observable objects cannot be frozen. If you're passing observables to 3rd party component/function that calls Object.freeze, pass copy instead: toJS(observable)",14:"Intercept handlers should return nothing or a change object",15:"Observable arrays cannot be frozen. If you're passing observables to 3rd party component/function that calls Object.freeze, pass copy instead: toJS(observable)",16:"Modification exception: the internal structure of an observable array was changed.",17:function(t,i){return"[mobx.array] Index out of bounds, "+t+" is larger than "+i},18:"mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js",19:function(t){return"Cannot initialize from classes that inherit from Map: "+t.constructor.name},20:function(t){return"Cannot initialize map from "+t},21:function(t){return"Cannot convert to map from '"+t+"'"},22:"mobx.set requires Set polyfill for the current browser. Check babel-polyfill or core-js/es6/set.js",23:"It is not possible to get index atoms from arrays",24:function(t){return"Cannot obtain administration from "+t},25:function(t,i){return"the entry '"+t+"' does not exist in the observable map '"+i+"'"},26:"please specify a property",27:function(t,i){return"no observable property '"+t.toString()+"' found on the observable object '"+i+"'"},28:function(t){return"Cannot obtain atom from "+t},29:"Expecting some object",30:"invalid action stack. did you forget to finish an action?",31:"missing option for computed: get",32:function(t,i){return"Cycle detected in computation "+t+": "+i},33:function(t){return"The setter of computed value '"+t+"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?"},34:function(t){return"[ComputedValue '"+t+"'] It is not possible to assign a new value to a computed value."},35:"There are multiple, different versions of MobX active. Make sure MobX is loaded only once or use `configure({ isolateGlobalState: true })`",36:"isolateGlobalState should be called before MobX is running any reactions",37:function(t){return"[mobx] `observableArray."+t+"()` mutates the array in-place, which is not allowed inside a derivation. Use `array.slice()."+t+"()` instead"},38:"'ownKeys()' can only be used on observable objects",39:"'defineProperty()' can only be used on observable objects"},errors={};function die(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];if(0)var o;throw new Error(typeof e=="number"?"[MobX] minified error nr: "+e+(i.length?" "+i.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+e)}var mockGlobal={};function getGlobal(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:mockGlobal}var assign=Object.assign,getDescriptor=Object.getOwnPropertyDescriptor,defineProperty=Object.defineProperty,objectPrototype=Object.prototype,EMPTY_ARRAY=[];Object.freeze(EMPTY_ARRAY);var EMPTY_OBJECT={};Object.freeze(EMPTY_OBJECT);var hasProxy=typeof Proxy<"u",plainObjectString=Object.toString();function assertProxies(){hasProxy||die("Proxy not available")}function warnAboutProxyRequirement(e){}function getNextId(){return++globalState.mobxGuid}function once(e){var t=!1;return function(){if(!t)return t=!0,e.apply(this,arguments)}}var noop=function(){};function isFunction(e){return typeof e=="function"}function isStringish(e){var t=typeof e;switch(t){case"string":case"symbol":case"number":return!0}return!1}function isObject(e){return e!==null&&typeof e=="object"}function isPlainObject(e){if(!isObject(e))return!1;var t=Object.getPrototypeOf(e);if(t==null)return!0;var i=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return typeof i=="function"&&i.toString()===plainObjectString}function isGenerator(e){var t=e?.constructor;return t?t.name==="GeneratorFunction"||t.displayName==="GeneratorFunction":!1}function addHiddenProp(e,t,i){defineProperty(e,t,{enumerable:!1,writable:!0,configurable:!0,value:i})}function addHiddenFinalProp(e,t,i){defineProperty(e,t,{enumerable:!1,writable:!1,configurable:!0,value:i})}function createInstanceofPredicate(e,t){var i="isMobX"+e;return t.prototype[i]=!0,function(r){return isObject(r)&&r[i]===!0}}function isES6Map(e){return e!=null&&Object.prototype.toString.call(e)==="[object Map]"}function isPlainES6Map(e){var t=Object.getPrototypeOf(e),i=Object.getPrototypeOf(t),r=Object.getPrototypeOf(i);return r===null}function isES6Set(e){return e!=null&&Object.prototype.toString.call(e)==="[object Set]"}var hasGetOwnPropertySymbols=typeof Object.getOwnPropertySymbols<"u";function getPlainObjectKeys(e){var t=Object.keys(e);if(!hasGetOwnPropertySymbols)return t;var i=Object.getOwnPropertySymbols(e);return i.length?[].concat(t,i.filter(function(r){return objectPrototype.propertyIsEnumerable.call(e,r)})):t}var ownKeys=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:hasGetOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames;function stringifyKey(e){return typeof e=="string"?e:typeof e=="symbol"?e.toString():new String(e).toString()}function toPrimitive(e){return e===null?null:typeof e=="object"?""+e:e}function hasProp(e,t){return objectPrototype.hasOwnProperty.call(e,t)}var getOwnPropertyDescriptors=Object.getOwnPropertyDescriptors||function(t){var i={};return ownKeys(t).forEach(function(r){i[r]=getDescriptor(t,r)}),i};function getFlag(e,t){return!!(e&t)}function setFlag(e,t,i){return i?e|=t:e&=~t,e}function _arrayLikeToArray(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _createForOfIteratorHelperLoose(e,t){var i=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i)return(i=i.call(e)).next.bind(i);if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&typeof e.length=="number"){i&&(e=i);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)({}).hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},_extends.apply(null,arguments)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},_setPrototypeOf(e,t)}function _toPrimitive(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return typeof t=="symbol"?t:t+""}function _unsupportedIterableToArray(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray(e,t);var i={}.toString.call(e).slice(8,-1);return i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set"?Array.from(e):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}var storedAnnotationsSymbol=Symbol("mobx-stored-annotations");function createDecoratorAnnotation(e){function t(i,r){if(is20223Decorator(r))return e.decorate_20223_(i,r);storeAnnotation(i,r,e)}return Object.assign(t,e)}function storeAnnotation(e,t,i){if(hasProp(e,storedAnnotationsSymbol)||addHiddenProp(e,storedAnnotationsSymbol,_extends({},e[storedAnnotationsSymbol])),0)var r;assertNotDecorated(e,i,t),isOverride(i)||(e[storedAnnotationsSymbol][t]=i)}function assertNotDecorated(e,t,i){if(0)var r,o,a}function collectStoredAnnotations(e){return hasProp(e,storedAnnotationsSymbol)||addHiddenProp(e,storedAnnotationsSymbol,_extends({},e[storedAnnotationsSymbol])),e[storedAnnotationsSymbol]}function is20223Decorator(e){return typeof e=="object"&&typeof e.kind=="string"}function assert20223DecoratorType(e,t){}var $mobx=Symbol("mobx administration"),Atom=function(){function e(i){i===void 0&&(i="Atom"),this.name_=void 0,this.flags_=0,this.observers_=new Set,this.lastAccessedBy_=0,this.lowestObserverState_=IDerivationState_.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=i}var t=e.prototype;return t.onBO=function(){this.onBOL&&this.onBOL.forEach(function(r){return r()})},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(r){return r()})},t.reportObserved=function(){return reportObserved(this)},t.reportChanged=function(){startBatch(),propagateChanged(this),endBatch()},t.toString=function(){return this.name_},_createClass(e,[{key:"isBeingObserved",get:function(){return getFlag(this.flags_,e.isBeingObservedMask_)},set:function(r){this.flags_=setFlag(this.flags_,e.isBeingObservedMask_,r)}},{key:"isPendingUnobservation",get:function(){return getFlag(this.flags_,e.isPendingUnobservationMask_)},set:function(r){this.flags_=setFlag(this.flags_,e.isPendingUnobservationMask_,r)}},{key:"diffValue",get:function(){return getFlag(this.flags_,e.diffValueMask_)?1:0},set:function(r){this.flags_=setFlag(this.flags_,e.diffValueMask_,r===1)}}])}();Atom.isBeingObservedMask_=1,Atom.isPendingUnobservationMask_=2,Atom.diffValueMask_=4;var isAtom=createInstanceofPredicate("Atom",Atom);function createAtom(e,t,i){t===void 0&&(t=noop),i===void 0&&(i=noop);var r=new Atom(e);return t!==noop&&onBecomeObserved(r,t),i!==noop&&onBecomeUnobserved(r,i),r}function identityComparer(e,t){return e===t}function structuralComparer(e,t){return deepEqual(e,t)}function shallowComparer(e,t){return deepEqual(e,t,1)}function defaultComparer(e,t){return Object.is?Object.is(e,t):e===t?e!==0||1/e===1/t:e!==e&&t!==t}var comparer={identity:identityComparer,structural:structuralComparer,default:defaultComparer,shallow:shallowComparer};function deepEnhancer(e,t,i){return isObservable(e)?e:Array.isArray(e)?observable.array(e,{name:i}):isPlainObject(e)?observable.object(e,void 0,{name:i}):isES6Map(e)?observable.map(e,{name:i}):isES6Set(e)?observable.set(e,{name:i}):typeof e=="function"&&!isAction(e)&&!isFlow(e)?isGenerator(e)?flow(e):autoAction(i,e):e}function shallowEnhancer(e,t,i){if(e==null||isObservableObject(e)||isObservableArray(e)||isObservableMap(e)||isObservableSet(e))return e;if(Array.isArray(e))return observable.array(e,{name:i,deep:!1});if(isPlainObject(e))return observable.object(e,void 0,{name:i,deep:!1});if(isES6Map(e))return observable.map(e,{name:i,deep:!1});if(isES6Set(e))return observable.set(e,{name:i,deep:!1})}function referenceEnhancer(e){return e}function refStructEnhancer(e,t){return deepEqual(e,t)?t:e}var OVERRIDE="override";function isOverride(e){return e.annotationType_===OVERRIDE}function createActionAnnotation(e,t){return{annotationType_:e,options_:t,make_:make_$1,extend_:extend_$1,decorate_20223_:decorate_20223_$1}}function make_$1(e,t,i,r){var o;if((o=this.options_)!=null&&o.bound)return this.extend_(e,t,i,!1)===null?0:1;if(r===e.target_)return this.extend_(e,t,i,!1)===null?0:2;if(isAction(i.value))return 1;var a=createActionDescriptor(e,this,t,i,!1);return defineProperty(r,t,a),2}function extend_$1(e,t,i,r){var o=createActionDescriptor(e,this,t,i);return e.defineProperty_(t,o,r)}function decorate_20223_$1(e,t){var i=t.kind,r=t.name,o=t.addInitializer,a=this,c=function(d){var f,m,g,v;return createAction((f=(m=a.options_)==null?void 0:m.name)!=null?f:r.toString(),d,(g=(v=a.options_)==null?void 0:v.autoAction)!=null?g:!1)};if(i=="field")return function(h){var d,f=h;return isAction(f)||(f=c(f)),(d=a.options_)!=null&&d.bound&&(f=f.bind(this),f.isMobxAction=!0),f};if(i=="method"){var u;return isAction(e)||(e=c(e)),(u=this.options_)!=null&&u.bound&&o(function(){var h=this,d=h[r].bind(h);d.isMobxAction=!0,h[r]=d}),e}die("Cannot apply '"+a.annotationType_+"' to '"+String(r)+"' (kind: "+i+"):"+(`
'`+a.annotationType_+"' can only be used on properties with a function value."))}function assertActionDescriptor(e,t,i,r){var o=t.annotationType_,a=r.value}function createActionDescriptor(e,t,i,r,o){var a,c,u,h,d,f,m;o===void 0&&(o=globalState.safeDescriptors),assertActionDescriptor(e,t,i,r);var g=r.value;if((a=t.options_)!=null&&a.bound){var v;g=g.bind((v=e.proxy_)!=null?v:e.target_)}return{value:createAction((c=(u=t.options_)==null?void 0:u.name)!=null?c:i.toString(),g,(h=(d=t.options_)==null?void 0:d.autoAction)!=null?h:!1,(f=t.options_)!=null&&f.bound?(m=e.proxy_)!=null?m:e.target_:void 0),configurable:o?e.isPlainObject_:!0,enumerable:!1,writable:!o}}function createFlowAnnotation(e,t){return{annotationType_:e,options_:t,make_:make_$2,extend_:extend_$2,decorate_20223_:decorate_20223_$2}}function make_$2(e,t,i,r){var o;if(r===e.target_)return this.extend_(e,t,i,!1)===null?0:2;if((o=this.options_)!=null&&o.bound&&(!hasProp(e.target_,t)||!isFlow(e.target_[t]))&&this.extend_(e,t,i,!1)===null)return 0;if(isFlow(i.value))return 1;var a=createFlowDescriptor(e,this,t,i,!1,!1);return defineProperty(r,t,a),2}function extend_$2(e,t,i,r){var o,a=createFlowDescriptor(e,this,t,i,(o=this.options_)==null?void 0:o.bound);return e.defineProperty_(t,a,r)}function decorate_20223_$2(e,t){var i,r=t.name,o=t.addInitializer;return isFlow(e)||(e=flow(e)),(i=this.options_)!=null&&i.bound&&o(function(){var a=this,c=a[r].bind(a);c.isMobXFlow=!0,a[r]=c}),e}function assertFlowDescriptor(e,t,i,r){var o=t.annotationType_,a=r.value}function createFlowDescriptor(e,t,i,r,o,a){a===void 0&&(a=globalState.safeDescriptors),assertFlowDescriptor(e,t,i,r);var c=r.value;if(isFlow(c)||(c=flow(c)),o){var u;c=c.bind((u=e.proxy_)!=null?u:e.target_),c.isMobXFlow=!0}return{value:c,configurable:a?e.isPlainObject_:!0,enumerable:!1,writable:!a}}function createComputedAnnotation(e,t){return{annotationType_:e,options_:t,make_:make_$3,extend_:extend_$3,decorate_20223_:decorate_20223_$3}}function make_$3(e,t,i){return this.extend_(e,t,i,!1)===null?0:1}function extend_$3(e,t,i,r){return assertComputedDescriptor(e,this,t,i),e.defineComputedProperty_(t,_extends({},this.options_,{get:i.get,set:i.set}),r)}function decorate_20223_$3(e,t){var i=this,r=t.name,o=t.addInitializer;return o(function(){var a=asObservableObject(this)[$mobx],c=_extends({},i.options_,{get:e,context:this});c.name||(c.name="ObservableObject."+r.toString()),a.values_.set(r,new ComputedValue(c))}),function(){return this[$mobx].getObservablePropValue_(r)}}function assertComputedDescriptor(e,t,i,r){var o=t.annotationType_,a=r.get}function createObservableAnnotation(e,t){return{annotationType_:e,options_:t,make_:make_$4,extend_:extend_$4,decorate_20223_:decorate_20223_$4}}function make_$4(e,t,i){return this.extend_(e,t,i,!1)===null?0:1}function extend_$4(e,t,i,r){var o,a;return assertObservableDescriptor(e,this,t,i),e.defineObservableProperty_(t,i.value,(o=(a=this.options_)==null?void 0:a.enhancer)!=null?o:deepEnhancer,r)}function decorate_20223_$4(e,t){var i=this,r=t.kind,o=t.name,a=new WeakSet;function c(u,h){var d,f,m=asObservableObject(u)[$mobx],g=new ObservableValue(h,(d=(f=i.options_)==null?void 0:f.enhancer)!=null?d:deepEnhancer,"ObservableObject."+o.toString(),!1);m.values_.set(o,g),a.add(u)}if(r=="accessor")return{get:function(){return a.has(this)||c(this,e.get.call(this)),this[$mobx].getObservablePropValue_(o)},set:function(h){return a.has(this)||c(this,h),this[$mobx].setObservablePropValue_(o,h)},init:function(h){return a.has(this)||c(this,h),h}}}function assertObservableDescriptor(e,t,i,r){var o=t.annotationType_}var AUTO="true",autoAnnotation=createAutoAnnotation();function createAutoAnnotation(e){return{annotationType_:AUTO,options_:e,make_:make_$5,extend_:extend_$5,decorate_20223_:decorate_20223_$5}}function make_$5(e,t,i,r){var o,a;if(i.get)return computed.make_(e,t,i,r);if(i.set){var c=createAction(t.toString(),i.set);return r===e.target_?e.defineProperty_(t,{configurable:globalState.safeDescriptors?e.isPlainObject_:!0,set:c})===null?0:2:(defineProperty(r,t,{configurable:!0,set:c}),2)}if(r!==e.target_&&typeof i.value=="function"){var u;if(isGenerator(i.value)){var h,d=(h=this.options_)!=null&&h.autoBind?flow.bound:flow;return d.make_(e,t,i,r)}var f=(u=this.options_)!=null&&u.autoBind?autoAction.bound:autoAction;return f.make_(e,t,i,r)}var m=((o=this.options_)==null?void 0:o.deep)===!1?observable.ref:observable;if(typeof i.value=="function"&&(a=this.options_)!=null&&a.autoBind){var g;i.value=i.value.bind((g=e.proxy_)!=null?g:e.target_)}return m.make_(e,t,i,r)}function extend_$5(e,t,i,r){var o,a;if(i.get)return computed.extend_(e,t,i,r);if(i.set)return e.defineProperty_(t,{configurable:globalState.safeDescriptors?e.isPlainObject_:!0,set:createAction(t.toString(),i.set)},r);if(typeof i.value=="function"&&(o=this.options_)!=null&&o.autoBind){var c;i.value=i.value.bind((c=e.proxy_)!=null?c:e.target_)}var u=((a=this.options_)==null?void 0:a.deep)===!1?observable.ref:observable;return u.extend_(e,t,i,r)}function decorate_20223_$5(e,t){die("'"+this.annotationType_+"' cannot be used as a decorator")}var OBSERVABLE="observable",OBSERVABLE_REF="observable.ref",OBSERVABLE_SHALLOW="observable.shallow",OBSERVABLE_STRUCT="observable.struct",defaultCreateObservableOptions={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(defaultCreateObservableOptions);function asCreateObservableOptions(e){return e||defaultCreateObservableOptions}var observableAnnotation=createObservableAnnotation(OBSERVABLE),observableRefAnnotation=createObservableAnnotation(OBSERVABLE_REF,{enhancer:referenceEnhancer}),observableShallowAnnotation=createObservableAnnotation(OBSERVABLE_SHALLOW,{enhancer:shallowEnhancer}),observableStructAnnotation=createObservableAnnotation(OBSERVABLE_STRUCT,{enhancer:refStructEnhancer}),observableDecoratorAnnotation=createDecoratorAnnotation(observableAnnotation);function getEnhancerFromOptions(e){return e.deep===!0?deepEnhancer:e.deep===!1?referenceEnhancer:getEnhancerFromAnnotation(e.defaultDecorator)}function getAnnotationFromOptions(e){var t;return e?(t=e.defaultDecorator)!=null?t:createAutoAnnotation(e):void 0}function getEnhancerFromAnnotation(e){var t,i;return e&&(t=(i=e.options_)==null?void 0:i.enhancer)!=null?t:deepEnhancer}function createObservable(e,t,i){if(is20223Decorator(t))return observableAnnotation.decorate_20223_(e,t);if(isStringish(t)){storeAnnotation(e,t,observableAnnotation);return}return isObservable(e)?e:isPlainObject(e)?observable.object(e,t,i):Array.isArray(e)?observable.array(e,t):isES6Map(e)?observable.map(e,t):isES6Set(e)?observable.set(e,t):typeof e=="object"&&e!==null?e:observable.box(e,t)}assign(createObservable,observableDecoratorAnnotation);var observableFactories={box:function(t,i){var r=asCreateObservableOptions(i);return new ObservableValue(t,getEnhancerFromOptions(r),r.name,!0,r.equals)},array:function(t,i){var r=asCreateObservableOptions(i);return(globalState.useProxies===!1||r.proxy===!1?createLegacyArray:createObservableArray)(t,getEnhancerFromOptions(r),r.name)},map:function(t,i){var r=asCreateObservableOptions(i);return new ObservableMap(t,getEnhancerFromOptions(r),r.name)},set:function(t,i){var r=asCreateObservableOptions(i);return new ObservableSet(t,getEnhancerFromOptions(r),r.name)},object:function(t,i,r){return initObservable(function(){return extendObservable(globalState.useProxies===!1||r?.proxy===!1?asObservableObject({},r):asDynamicObservableObject({},r),t,i)})},ref:createDecoratorAnnotation(observableRefAnnotation),shallow:createDecoratorAnnotation(observableShallowAnnotation),deep:observableDecoratorAnnotation,struct:createDecoratorAnnotation(observableStructAnnotation)},observable=assign(createObservable,observableFactories),COMPUTED="computed",COMPUTED_STRUCT="computed.struct",computedAnnotation=createComputedAnnotation(COMPUTED),computedStructAnnotation=createComputedAnnotation(COMPUTED_STRUCT,{equals:comparer.structural}),computed=function(t,i){if(is20223Decorator(i))return computedAnnotation.decorate_20223_(t,i);if(isStringish(i))return storeAnnotation(t,i,computedAnnotation);if(isPlainObject(t))return createDecoratorAnnotation(createComputedAnnotation(COMPUTED,t));var r=isPlainObject(i)?i:{};return r.get=t,r.name||(r.name=t.name||""),new ComputedValue(r)};Object.assign(computed,computedAnnotation),computed.struct=createDecoratorAnnotation(computedStructAnnotation);var _getDescriptor$config,_getDescriptor,currentActionId=0,nextActionId=1,isFunctionNameConfigurable=(_getDescriptor$config=(_getDescriptor=getDescriptor(function(){},"name"))==null?void 0:_getDescriptor.configurable)!=null?_getDescriptor$config:!1,tmpNameDescriptor={value:"action",configurable:!0,writable:!1,enumerable:!1};function createAction(e,t,i,r){i===void 0&&(i=!1);function o(){return executeAction(e,i,t,r||this,arguments)}return o.isMobxAction=!0,o.toString=function(){return t.toString()},isFunctionNameConfigurable&&(tmpNameDescriptor.value=e,defineProperty(o,"name",tmpNameDescriptor)),o}function executeAction(e,t,i,r,o){var a=_startAction(e,t,r,o);try{return i.apply(r,o)}catch(c){throw a.error_=c,c}finally{_endAction(a)}}function _startAction(e,t,i,r){var o=!1,a=0;if(0)var c;var u=globalState.trackingDerivation,h=!t||!u;startBatch();var d=globalState.allowStateChanges;h&&(untrackedStart(),d=allowStateChangesStart(!0));var f=allowStateReadsStart(!0),m={runAsAction_:h,prevDerivation_:u,prevAllowStateChanges_:d,prevAllowStateReads_:f,notifySpy_:o,startTime_:a,actionId_:nextActionId++,parentActionId_:currentActionId};return currentActionId=m.actionId_,m}function _endAction(e){currentActionId!==e.actionId_&&die(30),currentActionId=e.parentActionId_,e.error_!==void 0&&(globalState.suppressReactionErrors=!0),allowStateChangesEnd(e.prevAllowStateChanges_),allowStateReadsEnd(e.prevAllowStateReads_),endBatch(),e.runAsAction_&&untrackedEnd(e.prevDerivation_),globalState.suppressReactionErrors=!1}function allowStateChangesStart(e){var t=globalState.allowStateChanges;return globalState.allowStateChanges=e,t}function allowStateChangesEnd(e){globalState.allowStateChanges=e}var CREATE="create",ObservableValue=function(e){function t(r,o,a,c,u){var h;return a===void 0&&(a="ObservableValue"),c===void 0&&(c=!0),u===void 0&&(u=comparer.default),h=e.call(this,a)||this,h.enhancer=void 0,h.name_=void 0,h.equals=void 0,h.hasUnreportedChange_=!1,h.interceptors_=void 0,h.changeListeners_=void 0,h.value_=void 0,h.dehancer=void 0,h.enhancer=o,h.name_=a,h.equals=u,h.value_=o(r,void 0,a),h}_inheritsLoose(t,e);var i=t.prototype;return i.dehanceValue=function(o){return this.dehancer!==void 0?this.dehancer(o):o},i.set=function(o){var a=this.value_;if(o=this.prepareNewValue_(o),o!==globalState.UNCHANGED){var c=isSpyEnabled();this.setNewValue_(o)}},i.prepareNewValue_=function(o){if(checkIfStateModificationsAreAllowed(this),hasInterceptors(this)){var a=interceptChange(this,{object:this,type:UPDATE,newValue:o});if(!a)return globalState.UNCHANGED;o=a.newValue}return o=this.enhancer(o,this.value_,this.name_),this.equals(this.value_,o)?globalState.UNCHANGED:o},i.setNewValue_=function(o){var a=this.value_;this.value_=o,this.reportChanged(),hasListeners(this)&&notifyListeners(this,{type:UPDATE,object:this,newValue:o,oldValue:a})},i.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},i.intercept_=function(o){return registerInterceptor(this,o)},i.observe_=function(o,a){return a&&o({observableKind:"value",debugObjectName:this.name_,object:this,type:UPDATE,newValue:this.value_,oldValue:void 0}),registerListener(this,o)},i.raw=function(){return this.value_},i.toJSON=function(){return this.get()},i.toString=function(){return this.name_+"["+this.value_+"]"},i.valueOf=function(){return toPrimitive(this.get())},i[Symbol.toPrimitive]=function(){return this.valueOf()},t}(Atom),ComputedValue=function(){function e(i){this.dependenciesState_=IDerivationState_.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.observers_=new Set,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=IDerivationState_.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new CaughtException(null),this.name_=void 0,this.triggeredBy_=void 0,this.flags_=0,this.derivation=void 0,this.setter_=void 0,this.isTracing_=TraceMode.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,i.get||die(31),this.derivation=i.get,this.name_=i.name||"ComputedValue",i.set&&(this.setter_=createAction("ComputedValue-setter",i.set)),this.equals_=i.equals||(i.compareStructural||i.struct?comparer.structural:comparer.default),this.scope_=i.context,this.requiresReaction_=i.requiresReaction,this.keepAlive_=!!i.keepAlive}var t=e.prototype;return t.onBecomeStale_=function(){propagateMaybeChanged(this)},t.onBO=function(){this.onBOL&&this.onBOL.forEach(function(r){return r()})},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(r){return r()})},t.get=function(){if(this.isComputing&&die(32,this.name_,this.derivation),globalState.inBatch===0&&this.observers_.size===0&&!this.keepAlive_)shouldCompute(this)&&(this.warnAboutUntrackedRead_(),startBatch(),this.value_=this.computeValue_(!1),endBatch());else if(reportObserved(this),shouldCompute(this)){var r=globalState.trackingContext;this.keepAlive_&&!r&&(globalState.trackingContext=this),this.trackAndCompute()&&propagateChangeConfirmed(this),globalState.trackingContext=r}var o=this.value_;if(isCaughtException(o))throw o.cause;return o},t.set=function(r){if(this.setter_){this.isRunningSetter&&die(33,this.name_),this.isRunningSetter=!0;try{this.setter_.call(this.scope_,r)}finally{this.isRunningSetter=!1}}else die(34,this.name_)},t.trackAndCompute=function(){var r=this.value_,o=this.dependenciesState_===IDerivationState_.NOT_TRACKING_,a=this.computeValue_(!0),c=o||isCaughtException(r)||isCaughtException(a)||!this.equals_(r,a);return c&&(this.value_=a),c},t.computeValue_=function(r){this.isComputing=!0;var o=allowStateChangesStart(!1),a;if(r)a=trackDerivedFunction(this,this.derivation,this.scope_);else if(globalState.disableErrorBoundaries===!0)a=this.derivation.call(this.scope_);else try{a=this.derivation.call(this.scope_)}catch(c){a=new CaughtException(c)}return allowStateChangesEnd(o),this.isComputing=!1,a},t.suspend_=function(){this.keepAlive_||(clearObserving(this),this.value_=void 0)},t.observe_=function(r,o){var a=this,c=!0,u=void 0;return autorun(function(){var h=a.get();if(!c||o){var d=untrackedStart();r({observableKind:"computed",debugObjectName:a.name_,type:UPDATE,object:a,newValue:h,oldValue:u}),untrackedEnd(d)}c=!1,u=h})},t.warnAboutUntrackedRead_=function(){},t.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},t.valueOf=function(){return toPrimitive(this.get())},t[Symbol.toPrimitive]=function(){return this.valueOf()},_createClass(e,[{key:"isComputing",get:function(){return getFlag(this.flags_,e.isComputingMask_)},set:function(r){this.flags_=setFlag(this.flags_,e.isComputingMask_,r)}},{key:"isRunningSetter",get:function(){return getFlag(this.flags_,e.isRunningSetterMask_)},set:function(r){this.flags_=setFlag(this.flags_,e.isRunningSetterMask_,r)}},{key:"isBeingObserved",get:function(){return getFlag(this.flags_,e.isBeingObservedMask_)},set:function(r){this.flags_=setFlag(this.flags_,e.isBeingObservedMask_,r)}},{key:"isPendingUnobservation",get:function(){return getFlag(this.flags_,e.isPendingUnobservationMask_)},set:function(r){this.flags_=setFlag(this.flags_,e.isPendingUnobservationMask_,r)}},{key:"diffValue",get:function(){return getFlag(this.flags_,e.diffValueMask_)?1:0},set:function(r){this.flags_=setFlag(this.flags_,e.diffValueMask_,r===1)}}])}();ComputedValue.isComputingMask_=1,ComputedValue.isRunningSetterMask_=2,ComputedValue.isBeingObservedMask_=4,ComputedValue.isPendingUnobservationMask_=8,ComputedValue.diffValueMask_=16;var isComputedValue=createInstanceofPredicate("ComputedValue",ComputedValue),IDerivationState_;(function(e){e[e.NOT_TRACKING_=-1]="NOT_TRACKING_",e[e.UP_TO_DATE_=0]="UP_TO_DATE_",e[e.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",e[e.STALE_=2]="STALE_"})(IDerivationState_||(IDerivationState_={}));var TraceMode;(function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.BREAK=2]="BREAK"})(TraceMode||(TraceMode={}));var CaughtException=function(t){this.cause=void 0,this.cause=t};function isCaughtException(e){return e instanceof CaughtException}function shouldCompute(e){switch(e.dependenciesState_){case IDerivationState_.UP_TO_DATE_:return!1;case IDerivationState_.NOT_TRACKING_:case IDerivationState_.STALE_:return!0;case IDerivationState_.POSSIBLY_STALE_:{for(var t=allowStateReadsStart(!0),i=untrackedStart(),r=e.observing_,o=r.length,a=0;a<o;a++){var c=r[a];if(isComputedValue(c)){if(globalState.disableErrorBoundaries)c.get();else try{c.get()}catch{return untrackedEnd(i),allowStateReadsEnd(t),!0}if(e.dependenciesState_===IDerivationState_.STALE_)return untrackedEnd(i),allowStateReadsEnd(t),!0}}return changeDependenciesStateTo0(e),untrackedEnd(i),allowStateReadsEnd(t),!1}}}function checkIfStateModificationsAreAllowed(e){return;var t}function checkIfStateReadsAreAllowed(e){}function trackDerivedFunction(e,t,i){var r=allowStateReadsStart(!0);changeDependenciesStateTo0(e),e.newObserving_=new Array(e.runId_===0?100:e.observing_.length),e.unboundDepsCount_=0,e.runId_=++globalState.runId;var o=globalState.trackingDerivation;globalState.trackingDerivation=e,globalState.inBatch++;var a;if(globalState.disableErrorBoundaries===!0)a=t.call(i);else try{a=t.call(i)}catch(c){a=new CaughtException(c)}return globalState.inBatch--,globalState.trackingDerivation=o,bindDependencies(e),allowStateReadsEnd(r),a}function warnAboutDerivationWithoutDependencies(e){}function bindDependencies(e){for(var t=e.observing_,i=e.observing_=e.newObserving_,r=IDerivationState_.UP_TO_DATE_,o=0,a=e.unboundDepsCount_,c=0;c<a;c++){var u=i[c];u.diffValue===0&&(u.diffValue=1,o!==c&&(i[o]=u),o++),u.dependenciesState_>r&&(r=u.dependenciesState_)}for(i.length=o,e.newObserving_=null,a=t.length;a--;){var h=t[a];h.diffValue===0&&removeObserver(h,e),h.diffValue=0}for(;o--;){var d=i[o];d.diffValue===1&&(d.diffValue=0,addObserver(d,e))}r!==IDerivationState_.UP_TO_DATE_&&(e.dependenciesState_=r,e.onBecomeStale_())}function clearObserving(e){var t=e.observing_;e.observing_=[];for(var i=t.length;i--;)removeObserver(t[i],e);e.dependenciesState_=IDerivationState_.NOT_TRACKING_}function untracked(e){var t=untrackedStart();try{return e()}finally{untrackedEnd(t)}}function untrackedStart(){var e=globalState.trackingDerivation;return globalState.trackingDerivation=null,e}function untrackedEnd(e){globalState.trackingDerivation=e}function allowStateReadsStart(e){var t=globalState.allowStateReads;return globalState.allowStateReads=e,t}function allowStateReadsEnd(e){globalState.allowStateReads=e}function changeDependenciesStateTo0(e){if(e.dependenciesState_!==IDerivationState_.UP_TO_DATE_){e.dependenciesState_=IDerivationState_.UP_TO_DATE_;for(var t=e.observing_,i=t.length;i--;)t[i].lowestObserverState_=IDerivationState_.UP_TO_DATE_}}var MobXGlobals=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0},canMergeGlobalState=!0,isolateCalled=!1,globalState=function(){var e=getGlobal();return e.__mobxInstanceCount>0&&!e.__mobxGlobals&&(canMergeGlobalState=!1),e.__mobxGlobals&&e.__mobxGlobals.version!==new MobXGlobals().version&&(canMergeGlobalState=!1),canMergeGlobalState?e.__mobxGlobals?(e.__mobxInstanceCount+=1,e.__mobxGlobals.UNCHANGED||(e.__mobxGlobals.UNCHANGED={}),e.__mobxGlobals):(e.__mobxInstanceCount=1,e.__mobxGlobals=new MobXGlobals):(setTimeout(function(){isolateCalled||die(35)},1),new MobXGlobals)}();function addObserver(e,t){e.observers_.add(t),e.lowestObserverState_>t.dependenciesState_&&(e.lowestObserverState_=t.dependenciesState_)}function removeObserver(e,t){e.observers_.delete(t),e.observers_.size===0&&queueForUnobservation(e)}function queueForUnobservation(e){e.isPendingUnobservation===!1&&(e.isPendingUnobservation=!0,globalState.pendingUnobservations.push(e))}function startBatch(){globalState.inBatch++}function endBatch(){if(--globalState.inBatch===0){runReactions();for(var e=globalState.pendingUnobservations,t=0;t<e.length;t++){var i=e[t];i.isPendingUnobservation=!1,i.observers_.size===0&&(i.isBeingObserved&&(i.isBeingObserved=!1,i.onBUO()),i instanceof ComputedValue&&i.suspend_())}globalState.pendingUnobservations=[]}}function reportObserved(e){var t=globalState.trackingDerivation;return t!==null?(t.runId_!==e.lastAccessedBy_&&(e.lastAccessedBy_=t.runId_,t.newObserving_[t.unboundDepsCount_++]=e,!e.isBeingObserved&&globalState.trackingContext&&(e.isBeingObserved=!0,e.onBO())),e.isBeingObserved):(e.observers_.size===0&&globalState.inBatch>0&&queueForUnobservation(e),!1)}function propagateChanged(e){e.lowestObserverState_!==IDerivationState_.STALE_&&(e.lowestObserverState_=IDerivationState_.STALE_,e.observers_.forEach(function(t){t.dependenciesState_===IDerivationState_.UP_TO_DATE_&&t.onBecomeStale_(),t.dependenciesState_=IDerivationState_.STALE_}))}function propagateChangeConfirmed(e){e.lowestObserverState_!==IDerivationState_.STALE_&&(e.lowestObserverState_=IDerivationState_.STALE_,e.observers_.forEach(function(t){t.dependenciesState_===IDerivationState_.POSSIBLY_STALE_?t.dependenciesState_=IDerivationState_.STALE_:t.dependenciesState_===IDerivationState_.UP_TO_DATE_&&(e.lowestObserverState_=IDerivationState_.UP_TO_DATE_)}))}function propagateMaybeChanged(e){e.lowestObserverState_===IDerivationState_.UP_TO_DATE_&&(e.lowestObserverState_=IDerivationState_.POSSIBLY_STALE_,e.observers_.forEach(function(t){t.dependenciesState_===IDerivationState_.UP_TO_DATE_&&(t.dependenciesState_=IDerivationState_.POSSIBLY_STALE_,t.onBecomeStale_())}))}function logTraceInfo(e,t){if(console.log("[mobx.trace] '"+e.name_+"' is invalidated due to a change in: '"+t.name_+"'"),e.isTracing_===TraceMode.BREAK){var i=[];printDepTree(getDependencyTree(e),i,1),new Function(`debugger;
/*
Tracing '`+e.name_+`'

You are entering this break point because derivation '`+e.name_+"' is being traced and '"+t.name_+`' is now forcing it to update.
Just follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update
The stackframe you are looking for is at least ~6-8 stack-frames up.

`+(e instanceof ComputedValue?e.derivation.toString().replace(/[*]\//g,"/"):"")+`

The dependencies for this derivation are:

`+i.join(`
`)+`
*/
    `)()}}function printDepTree(e,t,i){if(t.length>=1e3){t.push("(and many more)");return}t.push(""+"	".repeat(i-1)+e.name),e.dependencies&&e.dependencies.forEach(function(r){return printDepTree(r,t,i+1)})}var Reaction=function(){function e(i,r,o,a){i===void 0&&(i="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=IDerivationState_.NOT_TRACKING_,this.runId_=0,this.unboundDepsCount_=0,this.flags_=0,this.isTracing_=TraceMode.NONE,this.name_=i,this.onInvalidate_=r,this.errorHandler_=o,this.requiresObservable_=a}var t=e.prototype;return t.onBecomeStale_=function(){this.schedule_()},t.schedule_=function(){this.isScheduled||(this.isScheduled=!0,globalState.pendingReactions.push(this),runReactions())},t.runReaction_=function(){if(!this.isDisposed){startBatch(),this.isScheduled=!1;var r=globalState.trackingContext;if(globalState.trackingContext=this,shouldCompute(this)){this.isTrackPending=!0;try{this.onInvalidate_()}catch(o){this.reportExceptionInDerivation_(o)}}globalState.trackingContext=r,endBatch()}},t.track=function(r){if(!this.isDisposed){startBatch();var o=isSpyEnabled(),a;this.isRunning=!0;var c=globalState.trackingContext;globalState.trackingContext=this;var u=trackDerivedFunction(this,r,void 0);globalState.trackingContext=c,this.isRunning=!1,this.isTrackPending=!1,this.isDisposed&&clearObserving(this),isCaughtException(u)&&this.reportExceptionInDerivation_(u.cause),endBatch()}},t.reportExceptionInDerivation_=function(r){var o=this;if(this.errorHandler_){this.errorHandler_(r,this);return}if(globalState.disableErrorBoundaries)throw r;var a="[mobx] uncaught error in '"+this+"'";globalState.suppressReactionErrors||console.error(a,r),globalState.globalReactionErrorHandlers.forEach(function(c){return c(r,o)})},t.dispose=function(){this.isDisposed||(this.isDisposed=!0,this.isRunning||(startBatch(),clearObserving(this),endBatch()))},t.getDisposer_=function(r){var o=this,a=function c(){o.dispose(),r==null||r.removeEventListener==null||r.removeEventListener("abort",c)};return r==null||r.addEventListener==null||r.addEventListener("abort",a),a[$mobx]=this,a},t.toString=function(){return"Reaction["+this.name_+"]"},t.trace=function(r){r===void 0&&(r=!1),trace(this,r)},_createClass(e,[{key:"isDisposed",get:function(){return getFlag(this.flags_,e.isDisposedMask_)},set:function(r){this.flags_=setFlag(this.flags_,e.isDisposedMask_,r)}},{key:"isScheduled",get:function(){return getFlag(this.flags_,e.isScheduledMask_)},set:function(r){this.flags_=setFlag(this.flags_,e.isScheduledMask_,r)}},{key:"isTrackPending",get:function(){return getFlag(this.flags_,e.isTrackPendingMask_)},set:function(r){this.flags_=setFlag(this.flags_,e.isTrackPendingMask_,r)}},{key:"isRunning",get:function(){return getFlag(this.flags_,e.isRunningMask_)},set:function(r){this.flags_=setFlag(this.flags_,e.isRunningMask_,r)}},{key:"diffValue",get:function(){return getFlag(this.flags_,e.diffValueMask_)?1:0},set:function(r){this.flags_=setFlag(this.flags_,e.diffValueMask_,r===1)}}])}();Reaction.isDisposedMask_=1,Reaction.isScheduledMask_=2,Reaction.isTrackPendingMask_=4,Reaction.isRunningMask_=8,Reaction.diffValueMask_=16;var MAX_REACTION_ITERATIONS=100,reactionScheduler=function(t){return t()};function runReactions(){globalState.inBatch>0||globalState.isRunningReactions||reactionScheduler(runReactionsHelper)}function runReactionsHelper(){globalState.isRunningReactions=!0;for(var e=globalState.pendingReactions,t=0;e.length>0;){++t===MAX_REACTION_ITERATIONS&&(console.error("[mobx] cycle in reaction: "+e[0]),e.splice(0));for(var i=e.splice(0),r=0,o=i.length;r<o;r++)i[r].runReaction_()}globalState.isRunningReactions=!1}var isReaction=createInstanceofPredicate("Reaction",Reaction);function isSpyEnabled(){return!1}function spyReport(e){return;for(var t,i,r;i<r;i++)t[i](e)}function spyReportStart(e){return;var t}var END_EVENT={type:"report-end",spyReportEnd:!0};function spyReportEnd(e){}function spy(e){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}var ACTION="action",ACTION_BOUND="action.bound",AUTOACTION="autoAction",AUTOACTION_BOUND="autoAction.bound",DEFAULT_ACTION_NAME="<unnamed action>",actionAnnotation=createActionAnnotation(ACTION),actionBoundAnnotation=createActionAnnotation(ACTION_BOUND,{bound:!0}),autoActionAnnotation=createActionAnnotation(AUTOACTION,{autoAction:!0}),autoActionBoundAnnotation=createActionAnnotation(AUTOACTION_BOUND,{autoAction:!0,bound:!0});function createActionFactory(e){var t=function(r,o){if(isFunction(r))return createAction(r.name||DEFAULT_ACTION_NAME,r,e);if(isFunction(o))return createAction(r,o,e);if(is20223Decorator(o))return(e?autoActionAnnotation:actionAnnotation).decorate_20223_(r,o);if(isStringish(o))return storeAnnotation(r,o,e?autoActionAnnotation:actionAnnotation);if(isStringish(r))return createDecoratorAnnotation(createActionAnnotation(e?AUTOACTION:ACTION,{name:r,autoAction:e}))};return t}var action=createActionFactory(!1);Object.assign(action,actionAnnotation);var autoAction=createActionFactory(!0);Object.assign(autoAction,autoActionAnnotation),action.bound=createDecoratorAnnotation(actionBoundAnnotation),autoAction.bound=createDecoratorAnnotation(autoActionBoundAnnotation);function isAction(e){return isFunction(e)&&e.isMobxAction===!0}function autorun(e,t){var i,r,o,a;t===void 0&&(t=EMPTY_OBJECT);var c=(i=(r=t)==null?void 0:r.name)!=null?i:"Autorun",u=!t.scheduler&&!t.delay,h;if(u)h=new Reaction(c,function(){this.track(m)},t.onError,t.requiresObservable);else{var d=createSchedulerFromOptions(t),f=!1;h=new Reaction(c,function(){f||(f=!0,d(function(){f=!1,h.isDisposed||h.track(m)}))},t.onError,t.requiresObservable)}function m(){e(h)}return(o=t)!=null&&(o=o.signal)!=null&&o.aborted||h.schedule_(),h.getDisposer_((a=t)==null?void 0:a.signal)}var run=function(t){return t()};function createSchedulerFromOptions(e){return e.scheduler?e.scheduler:e.delay?function(t){return setTimeout(t,e.delay)}:run}var ON_BECOME_OBSERVED="onBO",ON_BECOME_UNOBSERVED="onBUO";function onBecomeObserved(e,t,i){return interceptHook(ON_BECOME_OBSERVED,e,t,i)}function onBecomeUnobserved(e,t,i){return interceptHook(ON_BECOME_UNOBSERVED,e,t,i)}function interceptHook(e,t,i,r){var o=typeof r=="function"?getAtom(t,i):getAtom(t),a=isFunction(r)?r:i,c=e+"L";return o[c]?o[c].add(a):o[c]=new Set([a]),function(){var u=o[c];u&&(u.delete(a),u.size===0&&delete o[c])}}function extendObservable(e,t,i,r){var o=getOwnPropertyDescriptors(t);return initObservable(function(){var a=asObservableObject(e,r)[$mobx];ownKeys(o).forEach(function(c){a.extend_(c,o[c],i&&c in i?i[c]:!0)})}),e}function getDependencyTree(e,t){return nodeToDependencyTree(getAtom(e,t))}function nodeToDependencyTree(e){var t={name:e.name_};return e.observing_&&e.observing_.length>0&&(t.dependencies=unique$1(e.observing_).map(nodeToDependencyTree)),t}function unique$1(e){return Array.from(new Set(e))}var generatorId=0;function FlowCancellationError(){this.message="FLOW_CANCELLED"}FlowCancellationError.prototype=Object.create(Error.prototype);var flowAnnotation=createFlowAnnotation("flow"),flowBoundAnnotation=createFlowAnnotation("flow.bound",{bound:!0}),flow=Object.assign(function(t,i){if(is20223Decorator(i))return flowAnnotation.decorate_20223_(t,i);if(isStringish(i))return storeAnnotation(t,i,flowAnnotation);var r=t,o=r.name||"<unnamed flow>",a=function(){var u=this,h=arguments,d=++generatorId,f=action(o+" - runid: "+d+" - init",r).apply(u,h),m,g=void 0,v=new Promise(function(_,b){var S=0;m=b;function T(R){g=void 0;var O;try{O=action(o+" - runid: "+d+" - yield "+S++,f.next).call(f,R)}catch(P){return b(P)}I(O)}function A(R){g=void 0;var O;try{O=action(o+" - runid: "+d+" - yield "+S++,f.throw).call(f,R)}catch(P){return b(P)}I(O)}function I(R){if(isFunction(R?.then)){R.then(I,b);return}return R.done?_(R.value):(g=Promise.resolve(R.value),g.then(T,A))}T(void 0)});return v.cancel=action(o+" - runid: "+d+" - cancel",function(){try{g&&cancelPromise(g);var _=f.return(void 0),b=Promise.resolve(_.value);b.then(noop,noop),cancelPromise(b),m(new FlowCancellationError)}catch(S){m(S)}}),v};return a.isMobXFlow=!0,a},flowAnnotation);flow.bound=createDecoratorAnnotation(flowBoundAnnotation);function cancelPromise(e){isFunction(e.cancel)&&e.cancel()}function isFlow(e){return e?.isMobXFlow===!0}function _isObservable(e,t){return e?t!==void 0?isObservableObject(e)?e[$mobx].values_.has(t):!1:isObservableObject(e)||!!e[$mobx]||isAtom(e)||isReaction(e)||isComputedValue(e):!1}function isObservable(e){return _isObservable(e)}function trace(){return;for(var e,t,i,r;r<t;r++)i[r]=arguments[r];var o}function getAtomFromArgs(e){switch(e.length){case 0:return globalState.trackingDerivation;case 1:return getAtom(e[0]);case 2:return getAtom(e[0],e[1])}}function transaction(e,t){t===void 0&&(t=void 0),startBatch();try{return e.apply(t)}finally{endBatch()}}function getAdm(e){return e[$mobx]}var objectProxyTraps={has:function(t,i){return getAdm(t).has_(i)},get:function(t,i){return getAdm(t).get_(i)},set:function(t,i,r){var o;return isStringish(i)?(o=getAdm(t).set_(i,r,!0))!=null?o:!0:!1},deleteProperty:function(t,i){var r;return isStringish(i)?(r=getAdm(t).delete_(i,!0))!=null?r:!0:!1},defineProperty:function(t,i,r){var o;return(o=getAdm(t).defineProperty_(i,r))!=null?o:!0},ownKeys:function(t){return getAdm(t).ownKeys_()},preventExtensions:function(t){die(13)}};function asDynamicObservableObject(e,t){var i,r;return assertProxies(),e=asObservableObject(e,t),(r=(i=e[$mobx]).proxy_)!=null?r:i.proxy_=new Proxy(e,objectProxyTraps)}function hasInterceptors(e){return e.interceptors_!==void 0&&e.interceptors_.length>0}function registerInterceptor(e,t){var i=e.interceptors_||(e.interceptors_=[]);return i.push(t),once(function(){var r=i.indexOf(t);r!==-1&&i.splice(r,1)})}function interceptChange(e,t){var i=untrackedStart();try{for(var r=[].concat(e.interceptors_||[]),o=0,a=r.length;o<a&&(t=r[o](t),t&&!t.type&&die(14),!!t);o++);return t}finally{untrackedEnd(i)}}function hasListeners(e){return e.changeListeners_!==void 0&&e.changeListeners_.length>0}function registerListener(e,t){var i=e.changeListeners_||(e.changeListeners_=[]);return i.push(t),once(function(){var r=i.indexOf(t);r!==-1&&i.splice(r,1)})}function notifyListeners(e,t){var i=untrackedStart(),r=e.changeListeners_;if(r){r=r.slice();for(var o=0,a=r.length;o<a;o++)r[o](t);untrackedEnd(i)}}function makeObservable(e,t,i){return initObservable(function(){var r,o=asObservableObject(e,i)[$mobx];(r=t)!=null||(t=collectStoredAnnotations(e)),ownKeys(t).forEach(function(a){return o.make_(a,t[a])})}),e}var SPLICE="splice",UPDATE="update",MAX_SPLICE_SIZE=1e4,arrayTraps={get:function(t,i){var r=t[$mobx];return i===$mobx?r:i==="length"?r.getArrayLength_():typeof i=="string"&&!isNaN(i)?r.get_(parseInt(i)):hasProp(arrayExtensions,i)?arrayExtensions[i]:t[i]},set:function(t,i,r){var o=t[$mobx];return i==="length"&&o.setArrayLength_(r),typeof i=="symbol"||isNaN(i)?t[i]=r:o.set_(parseInt(i),r),!0},preventExtensions:function(){die(15)}},ObservableArrayAdministration=function(){function e(i,r,o,a){i===void 0&&(i="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=o,this.legacyMode_=a,this.atom_=new Atom(i),this.enhancer_=function(c,u){return r(c,u,"ObservableArray[..]")}}var t=e.prototype;return t.dehanceValue_=function(r){return this.dehancer!==void 0?this.dehancer(r):r},t.dehanceValues_=function(r){return this.dehancer!==void 0&&r.length>0?r.map(this.dehancer):r},t.intercept_=function(r){return registerInterceptor(this,r)},t.observe_=function(r,o){return o===void 0&&(o=!1),o&&r({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),registerListener(this,r)},t.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},t.setArrayLength_=function(r){(typeof r!="number"||isNaN(r)||r<0)&&die("Out of range: "+r);var o=this.values_.length;if(r!==o)if(r>o){for(var a=new Array(r-o),c=0;c<r-o;c++)a[c]=void 0;this.spliceWithArray_(o,0,a)}else this.spliceWithArray_(r,o-r)},t.updateArrayLength_=function(r,o){r!==this.lastKnownLength_&&die(16),this.lastKnownLength_+=o,this.legacyMode_&&o>0&&reserveArrayBuffer(r+o+1)},t.spliceWithArray_=function(r,o,a){var c=this;checkIfStateModificationsAreAllowed(this.atom_);var u=this.values_.length;if(r===void 0?r=0:r>u?r=u:r<0&&(r=Math.max(0,u+r)),arguments.length===1?o=u-r:o==null?o=0:o=Math.max(0,Math.min(o,u-r)),a===void 0&&(a=EMPTY_ARRAY),hasInterceptors(this)){var h=interceptChange(this,{object:this.proxy_,type:SPLICE,index:r,removedCount:o,added:a});if(!h)return EMPTY_ARRAY;o=h.removedCount,a=h.added}if(a=a.length===0?a:a.map(function(m){return c.enhancer_(m,void 0)}),this.legacyMode_){var d=a.length-o;this.updateArrayLength_(u,d)}var f=this.spliceItemsIntoValues_(r,o,a);return(o!==0||a.length!==0)&&this.notifyArraySplice_(r,a,f),this.dehanceValues_(f)},t.spliceItemsIntoValues_=function(r,o,a){if(a.length<MAX_SPLICE_SIZE){var c;return(c=this.values_).splice.apply(c,[r,o].concat(a))}else{var u=this.values_.slice(r,r+o),h=this.values_.slice(r+o);this.values_.length+=a.length-o;for(var d=0;d<a.length;d++)this.values_[r+d]=a[d];for(var f=0;f<h.length;f++)this.values_[r+a.length+f]=h[f];return u}},t.notifyArrayChildUpdate_=function(r,o,a){var c=!this.owned_&&isSpyEnabled(),u=hasListeners(this),h=u||c?{observableKind:"array",object:this.proxy_,type:UPDATE,debugObjectName:this.atom_.name_,index:r,newValue:o,oldValue:a}:null;this.atom_.reportChanged(),u&&notifyListeners(this,h)},t.notifyArraySplice_=function(r,o,a){var c=!this.owned_&&isSpyEnabled(),u=hasListeners(this),h=u||c?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:SPLICE,index:r,removed:a,added:o,removedCount:a.length,addedCount:o.length}:null;this.atom_.reportChanged(),u&&notifyListeners(this,h)},t.get_=function(r){if(this.legacyMode_&&r>=this.values_.length){console.warn("[mobx] Out of bounds read: "+r);return}return this.atom_.reportObserved(),this.dehanceValue_(this.values_[r])},t.set_=function(r,o){var a=this.values_;if(this.legacyMode_&&r>a.length&&die(17,r,a.length),r<a.length){checkIfStateModificationsAreAllowed(this.atom_);var c=a[r];if(hasInterceptors(this)){var u=interceptChange(this,{type:UPDATE,object:this.proxy_,index:r,newValue:o});if(!u)return;o=u.newValue}o=this.enhancer_(o,c);var h=o!==c;h&&(a[r]=o,this.notifyArrayChildUpdate_(r,o,c))}else{for(var d=new Array(r+1-a.length),f=0;f<d.length-1;f++)d[f]=void 0;d[d.length-1]=o,this.spliceWithArray_(a.length,0,d)}},e}();function createObservableArray(e,t,i,r){return i===void 0&&(i="ObservableArray"),r===void 0&&(r=!1),assertProxies(),initObservable(function(){var o=new ObservableArrayAdministration(i,t,r,!1);addHiddenFinalProp(o.values_,$mobx,o);var a=new Proxy(o.values_,arrayTraps);return o.proxy_=a,e&&e.length&&o.spliceWithArray_(0,0,e),a})}var arrayExtensions={clear:function(){return this.splice(0)},replace:function(t){var i=this[$mobx];return i.spliceWithArray_(0,i.values_.length,t)},toJSON:function(){return this.slice()},splice:function(t,i){for(var r=arguments.length,o=new Array(r>2?r-2:0),a=2;a<r;a++)o[a-2]=arguments[a];var c=this[$mobx];switch(arguments.length){case 0:return[];case 1:return c.spliceWithArray_(t);case 2:return c.spliceWithArray_(t,i)}return c.spliceWithArray_(t,i,o)},spliceWithArray:function(t,i,r){return this[$mobx].spliceWithArray_(t,i,r)},push:function(){for(var t=this[$mobx],i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return t.spliceWithArray_(t.values_.length,0,r),t.values_.length},pop:function(){return this.splice(Math.max(this[$mobx].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var t=this[$mobx],i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return t.spliceWithArray_(0,0,r),t.values_.length},reverse:function(){return globalState.trackingDerivation&&die(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){globalState.trackingDerivation&&die(37,"sort");var t=this.slice();return t.sort.apply(t,arguments),this.replace(t),this},remove:function(t){var i=this[$mobx],r=i.dehanceValues_(i.values_).indexOf(t);return r>-1?(this.splice(r,1),!0):!1}};addArrayExtension("at",simpleFunc),addArrayExtension("concat",simpleFunc),addArrayExtension("flat",simpleFunc),addArrayExtension("includes",simpleFunc),addArrayExtension("indexOf",simpleFunc),addArrayExtension("join",simpleFunc),addArrayExtension("lastIndexOf",simpleFunc),addArrayExtension("slice",simpleFunc),addArrayExtension("toString",simpleFunc),addArrayExtension("toLocaleString",simpleFunc),addArrayExtension("toSorted",simpleFunc),addArrayExtension("toSpliced",simpleFunc),addArrayExtension("with",simpleFunc),addArrayExtension("every",mapLikeFunc),addArrayExtension("filter",mapLikeFunc),addArrayExtension("find",mapLikeFunc),addArrayExtension("findIndex",mapLikeFunc),addArrayExtension("findLast",mapLikeFunc),addArrayExtension("findLastIndex",mapLikeFunc),addArrayExtension("flatMap",mapLikeFunc),addArrayExtension("forEach",mapLikeFunc),addArrayExtension("map",mapLikeFunc),addArrayExtension("some",mapLikeFunc),addArrayExtension("toReversed",mapLikeFunc),addArrayExtension("reduce",reduceLikeFunc),addArrayExtension("reduceRight",reduceLikeFunc);function addArrayExtension(e,t){typeof Array.prototype[e]=="function"&&(arrayExtensions[e]=t(e))}function simpleFunc(e){return function(){var t=this[$mobx];t.atom_.reportObserved();var i=t.dehanceValues_(t.values_);return i[e].apply(i,arguments)}}function mapLikeFunc(e){return function(t,i){var r=this,o=this[$mobx];o.atom_.reportObserved();var a=o.dehanceValues_(o.values_);return a[e](function(c,u){return t.call(i,c,u,r)})}}function reduceLikeFunc(e){return function(){var t=this,i=this[$mobx];i.atom_.reportObserved();var r=i.dehanceValues_(i.values_),o=arguments[0];return arguments[0]=function(a,c,u){return o(a,c,u,t)},r[e].apply(r,arguments)}}var isObservableArrayAdministration=createInstanceofPredicate("ObservableArrayAdministration",ObservableArrayAdministration);function isObservableArray(e){return isObject(e)&&isObservableArrayAdministration(e[$mobx])}var ObservableMapMarker={},ADD="add",DELETE="delete",ObservableMap=function(){function e(i,r,o){var a=this;r===void 0&&(r=deepEnhancer),o===void 0&&(o="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[$mobx]=ObservableMapMarker,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=r,this.name_=o,isFunction(Map)||die(18),initObservable(function(){a.keysAtom_=createAtom("ObservableMap.keys()"),a.data_=new Map,a.hasMap_=new Map,i&&a.merge(i)})}var t=e.prototype;return t.has_=function(r){return this.data_.has(r)},t.has=function(r){var o=this;if(!globalState.trackingDerivation)return this.has_(r);var a=this.hasMap_.get(r);if(!a){var c=a=new ObservableValue(this.has_(r),referenceEnhancer,"ObservableMap.key?",!1);this.hasMap_.set(r,c),onBecomeUnobserved(c,function(){return o.hasMap_.delete(r)})}return a.get()},t.set=function(r,o){var a=this.has_(r);if(hasInterceptors(this)){var c=interceptChange(this,{type:a?UPDATE:ADD,object:this,newValue:o,name:r});if(!c)return this;o=c.newValue}return a?this.updateValue_(r,o):this.addValue_(r,o),this},t.delete=function(r){var o=this;if(checkIfStateModificationsAreAllowed(this.keysAtom_),hasInterceptors(this)){var a=interceptChange(this,{type:DELETE,object:this,name:r});if(!a)return!1}if(this.has_(r)){var c=isSpyEnabled(),u=hasListeners(this),h=u||c?{observableKind:"map",debugObjectName:this.name_,type:DELETE,object:this,oldValue:this.data_.get(r).value_,name:r}:null;return transaction(function(){var d;o.keysAtom_.reportChanged(),(d=o.hasMap_.get(r))==null||d.setNewValue_(!1);var f=o.data_.get(r);f.setNewValue_(void 0),o.data_.delete(r)}),u&&notifyListeners(this,h),!0}return!1},t.updateValue_=function(r,o){var a=this.data_.get(r);if(o=a.prepareNewValue_(o),o!==globalState.UNCHANGED){var c=isSpyEnabled(),u=hasListeners(this),h=u||c?{observableKind:"map",debugObjectName:this.name_,type:UPDATE,object:this,oldValue:a.value_,name:r,newValue:o}:null;a.setNewValue_(o),u&&notifyListeners(this,h)}},t.addValue_=function(r,o){var a=this;checkIfStateModificationsAreAllowed(this.keysAtom_),transaction(function(){var d,f=new ObservableValue(o,a.enhancer_,"ObservableMap.key",!1);a.data_.set(r,f),o=f.value_,(d=a.hasMap_.get(r))==null||d.setNewValue_(!0),a.keysAtom_.reportChanged()});var c=isSpyEnabled(),u=hasListeners(this),h=u||c?{observableKind:"map",debugObjectName:this.name_,type:ADD,object:this,name:r,newValue:o}:null;u&&notifyListeners(this,h)},t.get=function(r){return this.has(r)?this.dehanceValue_(this.data_.get(r).get()):this.dehanceValue_(void 0)},t.dehanceValue_=function(r){return this.dehancer!==void 0?this.dehancer(r):r},t.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},t.values=function(){var r=this,o=this.keys();return makeIterableForMap({next:function(){var c=o.next(),u=c.done,h=c.value;return{done:u,value:u?void 0:r.get(h)}}})},t.entries=function(){var r=this,o=this.keys();return makeIterableForMap({next:function(){var c=o.next(),u=c.done,h=c.value;return{done:u,value:u?void 0:[h,r.get(h)]}}})},t[Symbol.iterator]=function(){return this.entries()},t.forEach=function(r,o){for(var a=_createForOfIteratorHelperLoose(this),c;!(c=a()).done;){var u=c.value,h=u[0],d=u[1];r.call(o,d,h,this)}},t.merge=function(r){var o=this;return isObservableMap(r)&&(r=new Map(r)),transaction(function(){isPlainObject(r)?getPlainObjectKeys(r).forEach(function(a){return o.set(a,r[a])}):Array.isArray(r)?r.forEach(function(a){var c=a[0],u=a[1];return o.set(c,u)}):isES6Map(r)?(isPlainES6Map(r)||die(19,r),r.forEach(function(a,c){return o.set(c,a)})):r!=null&&die(20,r)}),this},t.clear=function(){var r=this;transaction(function(){untracked(function(){for(var o=_createForOfIteratorHelperLoose(r.keys()),a;!(a=o()).done;){var c=a.value;r.delete(c)}})})},t.replace=function(r){var o=this;return transaction(function(){for(var a=convertToMap(r),c=new Map,u=!1,h=_createForOfIteratorHelperLoose(o.data_.keys()),d;!(d=h()).done;){var f=d.value;if(!a.has(f)){var m=o.delete(f);if(m)u=!0;else{var g=o.data_.get(f);c.set(f,g)}}}for(var v=_createForOfIteratorHelperLoose(a.entries()),_;!(_=v()).done;){var b=_.value,S=b[0],T=b[1],A=o.data_.has(S);if(o.set(S,T),o.data_.has(S)){var I=o.data_.get(S);c.set(S,I),A||(u=!0)}}if(!u)if(o.data_.size!==c.size)o.keysAtom_.reportChanged();else for(var R=o.data_.keys(),O=c.keys(),P=R.next(),L=O.next();!P.done;){if(P.value!==L.value){o.keysAtom_.reportChanged();break}P=R.next(),L=O.next()}o.data_=c}),this},t.toString=function(){return"[object ObservableMap]"},t.toJSON=function(){return Array.from(this)},t.observe_=function(r,o){return registerListener(this,r)},t.intercept_=function(r){return registerInterceptor(this,r)},_createClass(e,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Map"}}])}(),isObservableMap=createInstanceofPredicate("ObservableMap",ObservableMap);function makeIterableForMap(e){return e[Symbol.toStringTag]="MapIterator",makeIterable(e)}function convertToMap(e){if(isES6Map(e)||isObservableMap(e))return e;if(Array.isArray(e))return new Map(e);if(isPlainObject(e)){var t=new Map;for(var i in e)t.set(i,e[i]);return t}else return die(21,e)}var ObservableSetMarker={},ObservableSet=function(){function e(i,r,o){var a=this;r===void 0&&(r=deepEnhancer),o===void 0&&(o="ObservableSet"),this.name_=void 0,this[$mobx]=ObservableSetMarker,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=o,isFunction(Set)||die(22),this.enhancer_=function(c,u){return r(c,u,o)},initObservable(function(){a.atom_=createAtom(a.name_),i&&a.replace(i)})}var t=e.prototype;return t.dehanceValue_=function(r){return this.dehancer!==void 0?this.dehancer(r):r},t.clear=function(){var r=this;transaction(function(){untracked(function(){for(var o=_createForOfIteratorHelperLoose(r.data_.values()),a;!(a=o()).done;){var c=a.value;r.delete(c)}})})},t.forEach=function(r,o){for(var a=_createForOfIteratorHelperLoose(this),c;!(c=a()).done;){var u=c.value;r.call(o,u,u,this)}},t.add=function(r){var o=this;if(checkIfStateModificationsAreAllowed(this.atom_),hasInterceptors(this)){var a=interceptChange(this,{type:ADD,object:this,newValue:r});if(!a)return this}if(!this.has(r)){transaction(function(){o.data_.add(o.enhancer_(r,void 0)),o.atom_.reportChanged()});var c=!1,u=hasListeners(this),h=u||c?{observableKind:"set",debugObjectName:this.name_,type:ADD,object:this,newValue:r}:null;u&&notifyListeners(this,h)}return this},t.delete=function(r){var o=this;if(hasInterceptors(this)){var a=interceptChange(this,{type:DELETE,object:this,oldValue:r});if(!a)return!1}if(this.has(r)){var c=!1,u=hasListeners(this),h=u||c?{observableKind:"set",debugObjectName:this.name_,type:DELETE,object:this,oldValue:r}:null;return transaction(function(){o.atom_.reportChanged(),o.data_.delete(r)}),u&&notifyListeners(this,h),!0}return!1},t.has=function(r){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(r))},t.entries=function(){var r=0,o=Array.from(this.keys()),a=Array.from(this.values());return makeIterableForSet({next:function(){var u=r;return r+=1,u<a.length?{value:[o[u],a[u]],done:!1}:{value:void 0,done:!0}}})},t.keys=function(){return this.values()},t.values=function(){this.atom_.reportObserved();var r=this,o=0,a=Array.from(this.data_.values());return makeIterableForSet({next:function(){return o<a.length?{value:r.dehanceValue_(a[o++]),done:!1}:{value:void 0,done:!0}}})},t.intersection=function(r){if(isES6Set(r)&&!isObservableSet(r))return r.intersection(this);var o=new Set(this);return o.intersection(r)},t.union=function(r){if(isES6Set(r)&&!isObservableSet(r))return r.union(this);var o=new Set(this);return o.union(r)},t.difference=function(r){return new Set(this).difference(r)},t.symmetricDifference=function(r){if(isES6Set(r)&&!isObservableSet(r))return r.symmetricDifference(this);var o=new Set(this);return o.symmetricDifference(r)},t.isSubsetOf=function(r){return new Set(this).isSubsetOf(r)},t.isSupersetOf=function(r){return new Set(this).isSupersetOf(r)},t.isDisjointFrom=function(r){if(isES6Set(r)&&!isObservableSet(r))return r.isDisjointFrom(this);var o=new Set(this);return o.isDisjointFrom(r)},t.replace=function(r){var o=this;return isObservableSet(r)&&(r=new Set(r)),transaction(function(){Array.isArray(r)?(o.clear(),r.forEach(function(a){return o.add(a)})):isES6Set(r)?(o.clear(),r.forEach(function(a){return o.add(a)})):r!=null&&die("Cannot initialize set from "+r)}),this},t.observe_=function(r,o){return registerListener(this,r)},t.intercept_=function(r){return registerInterceptor(this,r)},t.toJSON=function(){return Array.from(this)},t.toString=function(){return"[object ObservableSet]"},t[Symbol.iterator]=function(){return this.values()},_createClass(e,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Set"}}])}(),isObservableSet=createInstanceofPredicate("ObservableSet",ObservableSet);function makeIterableForSet(e){return e[Symbol.toStringTag]="SetIterator",makeIterable(e)}var descriptorCache=Object.create(null),REMOVE="remove",ObservableObjectAdministration=function(){function e(i,r,o,a){r===void 0&&(r=new Map),a===void 0&&(a=autoAnnotation),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=i,this.values_=r,this.name_=o,this.defaultAnnotation_=a,this.keysAtom_=new Atom("ObservableObject.keys"),this.isPlainObject_=isPlainObject(this.target_)}var t=e.prototype;return t.getObservablePropValue_=function(r){return this.values_.get(r).get()},t.setObservablePropValue_=function(r,o){var a=this.values_.get(r);if(a instanceof ComputedValue)return a.set(o),!0;if(hasInterceptors(this)){var c=interceptChange(this,{type:UPDATE,object:this.proxy_||this.target_,name:r,newValue:o});if(!c)return null;o=c.newValue}if(o=a.prepareNewValue_(o),o!==globalState.UNCHANGED){var u=hasListeners(this),h=!1,d=u||h?{type:UPDATE,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:a.value_,name:r,newValue:o}:null;a.setNewValue_(o),u&&notifyListeners(this,d)}return!0},t.get_=function(r){return globalState.trackingDerivation&&!hasProp(this.target_,r)&&this.has_(r),this.target_[r]},t.set_=function(r,o,a){return a===void 0&&(a=!1),hasProp(this.target_,r)?this.values_.has(r)?this.setObservablePropValue_(r,o):a?Reflect.set(this.target_,r,o):(this.target_[r]=o,!0):this.extend_(r,{value:o,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,a)},t.has_=function(r){if(!globalState.trackingDerivation)return r in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var o=this.pendingKeys_.get(r);return o||(o=new ObservableValue(r in this.target_,referenceEnhancer,"ObservableObject.key?",!1),this.pendingKeys_.set(r,o)),o.get()},t.make_=function(r,o){if(o===!0&&(o=this.defaultAnnotation_),o!==!1){if(assertAnnotable(this,o,r),!(r in this.target_)){var a;if((a=this.target_[storedAnnotationsSymbol])!=null&&a[r])return;die(1,o.annotationType_,this.name_+"."+r.toString())}for(var c=this.target_;c&&c!==objectPrototype;){var u=getDescriptor(c,r);if(u){var h=o.make_(this,r,u,c);if(h===0)return;if(h===1)break}c=Object.getPrototypeOf(c)}recordAnnotationApplied(this,o,r)}},t.extend_=function(r,o,a,c){if(c===void 0&&(c=!1),a===!0&&(a=this.defaultAnnotation_),a===!1)return this.defineProperty_(r,o,c);assertAnnotable(this,a,r);var u=a.extend_(this,r,o,c);return u&&recordAnnotationApplied(this,a,r),u},t.defineProperty_=function(r,o,a){a===void 0&&(a=!1),checkIfStateModificationsAreAllowed(this.keysAtom_);try{startBatch();var c=this.delete_(r);if(!c)return c;if(hasInterceptors(this)){var u=interceptChange(this,{object:this.proxy_||this.target_,name:r,type:ADD,newValue:o.value});if(!u)return null;var h=u.newValue;o.value!==h&&(o=_extends({},o,{value:h}))}if(a){if(!Reflect.defineProperty(this.target_,r,o))return!1}else defineProperty(this.target_,r,o);this.notifyPropertyAddition_(r,o.value)}finally{endBatch()}return!0},t.defineObservableProperty_=function(r,o,a,c){c===void 0&&(c=!1),checkIfStateModificationsAreAllowed(this.keysAtom_);try{startBatch();var u=this.delete_(r);if(!u)return u;if(hasInterceptors(this)){var h=interceptChange(this,{object:this.proxy_||this.target_,name:r,type:ADD,newValue:o});if(!h)return null;o=h.newValue}var d=getCachedObservablePropDescriptor(r),f={configurable:globalState.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:d.get,set:d.set};if(c){if(!Reflect.defineProperty(this.target_,r,f))return!1}else defineProperty(this.target_,r,f);var m=new ObservableValue(o,a,"ObservableObject.key",!1);this.values_.set(r,m),this.notifyPropertyAddition_(r,m.value_)}finally{endBatch()}return!0},t.defineComputedProperty_=function(r,o,a){a===void 0&&(a=!1),checkIfStateModificationsAreAllowed(this.keysAtom_);try{startBatch();var c=this.delete_(r);if(!c)return c;if(hasInterceptors(this)){var u=interceptChange(this,{object:this.proxy_||this.target_,name:r,type:ADD,newValue:void 0});if(!u)return null}o.name||(o.name="ObservableObject.key"),o.context=this.proxy_||this.target_;var h=getCachedObservablePropDescriptor(r),d={configurable:globalState.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:h.get,set:h.set};if(a){if(!Reflect.defineProperty(this.target_,r,d))return!1}else defineProperty(this.target_,r,d);this.values_.set(r,new ComputedValue(o)),this.notifyPropertyAddition_(r,void 0)}finally{endBatch()}return!0},t.delete_=function(r,o){if(o===void 0&&(o=!1),checkIfStateModificationsAreAllowed(this.keysAtom_),!hasProp(this.target_,r))return!0;if(hasInterceptors(this)){var a=interceptChange(this,{object:this.proxy_||this.target_,name:r,type:REMOVE});if(!a)return null}try{var c;startBatch();var u=hasListeners(this),h=!1,d=this.values_.get(r),f=void 0;if(!d&&(u||h)){var m;f=(m=getDescriptor(this.target_,r))==null?void 0:m.value}if(o){if(!Reflect.deleteProperty(this.target_,r))return!1}else delete this.target_[r];if(d&&(this.values_.delete(r),d instanceof ObservableValue&&(f=d.value_),propagateChanged(d)),this.keysAtom_.reportChanged(),(c=this.pendingKeys_)==null||(c=c.get(r))==null||c.set(r in this.target_),u||h){var g={type:REMOVE,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:f,name:r};u&&notifyListeners(this,g)}}finally{endBatch()}return!0},t.observe_=function(r,o){return registerListener(this,r)},t.intercept_=function(r){return registerInterceptor(this,r)},t.notifyPropertyAddition_=function(r,o){var a,c=hasListeners(this),u=!1;if(c||u){var h=c||u?{type:ADD,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:r,newValue:o}:null;c&&notifyListeners(this,h)}(a=this.pendingKeys_)==null||(a=a.get(r))==null||a.set(!0),this.keysAtom_.reportChanged()},t.ownKeys_=function(){return this.keysAtom_.reportObserved(),ownKeys(this.target_)},t.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},e}();function asObservableObject(e,t){var i;if(hasProp(e,$mobx))return e;var r=(i=t?.name)!=null?i:"ObservableObject",o=new ObservableObjectAdministration(e,new Map,String(r),getAnnotationFromOptions(t));return addHiddenProp(e,$mobx,o),e}var isObservableObjectAdministration=createInstanceofPredicate("ObservableObjectAdministration",ObservableObjectAdministration);function getCachedObservablePropDescriptor(e){return descriptorCache[e]||(descriptorCache[e]={get:function(){return this[$mobx].getObservablePropValue_(e)},set:function(i){return this[$mobx].setObservablePropValue_(e,i)}})}function isObservableObject(e){return isObject(e)?isObservableObjectAdministration(e[$mobx]):!1}function recordAnnotationApplied(e,t,i){var r;(r=e.target_[storedAnnotationsSymbol])==null||delete r[i]}function assertAnnotable(e,t,i){if(0)var r,o,a}var ENTRY_0=createArrayEntryDescriptor(0),safariPrototypeSetterInheritanceBug=function(){var e=!1,t={};return Object.defineProperty(t,"0",{set:function(){e=!0}}),Object.create(t)[0]=1,e===!1}(),OBSERVABLE_ARRAY_BUFFER_SIZE=0,StubArray=function(){};function inherit(e,t){Object.setPrototypeOf?Object.setPrototypeOf(e.prototype,t):e.prototype.__proto__!==void 0?e.prototype.__proto__=t:e.prototype=t}inherit(StubArray,Array.prototype);var LegacyObservableArray=function(e){function t(r,o,a,c){var u;return a===void 0&&(a="ObservableArray"),c===void 0&&(c=!1),u=e.call(this)||this,initObservable(function(){var h=new ObservableArrayAdministration(a,o,c,!0);h.proxy_=u,addHiddenFinalProp(u,$mobx,h),r&&r.length&&u.spliceWithArray(0,0,r),safariPrototypeSetterInheritanceBug&&Object.defineProperty(u,"0",ENTRY_0)}),u}_inheritsLoose(t,e);var i=t.prototype;return i.concat=function(){this[$mobx].atom_.reportObserved();for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return Array.prototype.concat.apply(this.slice(),a.map(function(u){return isObservableArray(u)?u.slice():u}))},i[Symbol.iterator]=function(){var r=this,o=0;return makeIterable({next:function(){return o<r.length?{value:r[o++],done:!1}:{done:!0,value:void 0}}})},_createClass(t,[{key:"length",get:function(){return this[$mobx].getArrayLength_()},set:function(o){this[$mobx].setArrayLength_(o)}},{key:Symbol.toStringTag,get:function(){return"Array"}}])}(StubArray);Object.entries(arrayExtensions).forEach(function(e){var t=e[0],i=e[1];t!=="concat"&&addHiddenProp(LegacyObservableArray.prototype,t,i)});function createArrayEntryDescriptor(e){return{enumerable:!1,configurable:!0,get:function(){return this[$mobx].get_(e)},set:function(i){this[$mobx].set_(e,i)}}}function createArrayBufferItem(e){defineProperty(LegacyObservableArray.prototype,""+e,createArrayEntryDescriptor(e))}function reserveArrayBuffer(e){if(e>OBSERVABLE_ARRAY_BUFFER_SIZE){for(var t=OBSERVABLE_ARRAY_BUFFER_SIZE;t<e+100;t++)createArrayBufferItem(t);OBSERVABLE_ARRAY_BUFFER_SIZE=e}}reserveArrayBuffer(1e3);function createLegacyArray(e,t,i){return new LegacyObservableArray(e,t,i)}function getAtom(e,t){if(typeof e=="object"&&e!==null){if(isObservableArray(e))return t!==void 0&&die(23),e[$mobx].atom_;if(isObservableSet(e))return e.atom_;if(isObservableMap(e)){if(t===void 0)return e.keysAtom_;var i=e.data_.get(t)||e.hasMap_.get(t);return i||die(25,t,getDebugName(e)),i}if(isObservableObject(e)){if(!t)return die(26);var r=e[$mobx].values_.get(t);return r||die(27,t,getDebugName(e)),r}if(isAtom(e)||isComputedValue(e)||isReaction(e))return e}else if(isFunction(e)&&isReaction(e[$mobx]))return e[$mobx];die(28)}function getAdministration(e,t){if(e||die(29),t!==void 0)return getAdministration(getAtom(e,t));if(isAtom(e)||isComputedValue(e)||isReaction(e)||isObservableMap(e)||isObservableSet(e))return e;if(e[$mobx])return e[$mobx];die(24,e)}function getDebugName(e,t){var i;if(t!==void 0)i=getAtom(e,t);else{if(isAction(e))return e.name;isObservableObject(e)||isObservableMap(e)||isObservableSet(e)?i=getAdministration(e):i=getAtom(e)}return i.name_}function initObservable(e){var t=untrackedStart(),i=allowStateChangesStart(!0);startBatch();try{return e()}finally{endBatch(),allowStateChangesEnd(i),untrackedEnd(t)}}var toString=objectPrototype.toString;function deepEqual(e,t,i){return i===void 0&&(i=-1),eq(e,t,i)}function eq(e,t,i,r,o){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var a=typeof e;if(a!=="function"&&a!=="object"&&typeof t!="object")return!1;var c=toString.call(e);if(c!==toString.call(t))return!1;switch(c){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return typeof Symbol<"u"&&Symbol.valueOf.call(e)===Symbol.valueOf.call(t);case"[object Map]":case"[object Set]":i>=0&&i++;break}e=unwrap(e),t=unwrap(t);var u=c==="[object Array]";if(!u){if(typeof e!="object"||typeof t!="object")return!1;var h=e.constructor,d=t.constructor;if(h!==d&&!(isFunction(h)&&h instanceof h&&isFunction(d)&&d instanceof d)&&"constructor"in e&&"constructor"in t)return!1}if(i===0)return!1;i<0&&(i=-1),r=r||[],o=o||[];for(var f=r.length;f--;)if(r[f]===e)return o[f]===t;if(r.push(e),o.push(t),u){if(f=e.length,f!==t.length)return!1;for(;f--;)if(!eq(e[f],t[f],i-1,r,o))return!1}else{var m=Object.keys(e),g;if(f=m.length,Object.keys(t).length!==f)return!1;for(;f--;)if(g=m[f],!(hasProp(t,g)&&eq(e[g],t[g],i-1,r,o)))return!1}return r.pop(),o.pop(),!0}function unwrap(e){return isObservableArray(e)?e.slice():isES6Map(e)||isObservableMap(e)||isES6Set(e)||isObservableSet(e)?Array.from(e.entries()):e}var _getGlobal$Iterator,maybeIteratorPrototype=((_getGlobal$Iterator=getGlobal().Iterator)==null?void 0:_getGlobal$Iterator.prototype)||{};function makeIterable(e){return e[Symbol.iterator]=getSelf,Object.assign(Object.create(maybeIteratorPrototype),e)}function getSelf(){return this}function isAnnotation(e){return e instanceof Object&&typeof e.annotationType_=="string"&&isFunction(e.make_)&&isFunction(e.extend_)}["Symbol","Map","Set"].forEach(function(e){var t=getGlobal();typeof t[e]>"u"&&die("MobX requires global '"+e+"' to be available or polyfilled")}),typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy,extras:{getDebugName},$mobx});var top="top",bottom="bottom",right="right",left="left",auto="auto",basePlacements=[top,bottom,right,left],start="start",end="end",clippingParents="clippingParents",viewport="viewport",popper="popper",reference="reference",variationPlacements=basePlacements.reduce(function(e,t){return e.concat([t+"-"+start,t+"-"+end])},[]),placements=[].concat(basePlacements,[auto]).reduce(function(e,t){return e.concat([t,t+"-"+start,t+"-"+end])},[]),beforeRead="beforeRead",read="read",afterRead="afterRead",beforeMain="beforeMain",main="main",afterMain="afterMain",beforeWrite="beforeWrite",write="write",afterWrite="afterWrite",modifierPhases=[beforeRead,read,afterRead,beforeMain,main,afterMain,beforeWrite,write,afterWrite];function getNodeName(e){return e?(e.nodeName||"").toLowerCase():null}function getWindow(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function isElement$1(e){var t=getWindow(e).Element;return e instanceof t||e instanceof Element}function isHTMLElement(e){var t=getWindow(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function isShadowRoot(e){if(typeof ShadowRoot>"u")return!1;var t=getWindow(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function applyStyles(e){var t=e.state;Object.keys(t.elements).forEach(function(i){var r=t.styles[i]||{},o=t.attributes[i]||{},a=t.elements[i];!isHTMLElement(a)||!getNodeName(a)||(Object.assign(a.style,r),Object.keys(o).forEach(function(c){var u=o[c];u===!1?a.removeAttribute(c):a.setAttribute(c,u===!0?"":u)}))})}function effect$2(e){var t=e.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow),function(){Object.keys(t.elements).forEach(function(r){var o=t.elements[r],a=t.attributes[r]||{},c=Object.keys(t.styles.hasOwnProperty(r)?t.styles[r]:i[r]),u=c.reduce(function(h,d){return h[d]="",h},{});!isHTMLElement(o)||!getNodeName(o)||(Object.assign(o.style,u),Object.keys(a).forEach(function(h){o.removeAttribute(h)}))})}}var applyStyles_default={name:"applyStyles",enabled:!0,phase:"write",fn:applyStyles,effect:effect$2,requires:["computeStyles"]};function getBasePlacement$1(e){return e.split("-")[0]}var max=Math.max,min=Math.min,round=Math.round;function getUAString(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function isLayoutViewport(){return!/^((?!chrome|android).)*safari/i.test(getUAString())}function getBoundingClientRect(e,t,i){t===void 0&&(t=!1),i===void 0&&(i=!1);var r=e.getBoundingClientRect(),o=1,a=1;t&&isHTMLElement(e)&&(o=e.offsetWidth>0&&round(r.width)/e.offsetWidth||1,a=e.offsetHeight>0&&round(r.height)/e.offsetHeight||1);var c=isElement$1(e)?getWindow(e):window,u=c.visualViewport,h=!isLayoutViewport()&&i,d=(r.left+(h&&u?u.offsetLeft:0))/o,f=(r.top+(h&&u?u.offsetTop:0))/a,m=r.width/o,g=r.height/a;return{width:m,height:g,top:f,right:d+m,bottom:f+g,left:d,x:d,y:f}}function getLayoutRect(e){var t=getBoundingClientRect(e),i=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-i)<=1&&(i=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:i,height:r}}function contains(e,t){var i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&isShadowRoot(i)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function getComputedStyle$1(e){return getWindow(e).getComputedStyle(e)}function isTableElement(e){return["table","td","th"].indexOf(getNodeName(e))>=0}function getDocumentElement(e){return((isElement$1(e)?e.ownerDocument:e.document)||window.document).documentElement}function getParentNode(e){return getNodeName(e)==="html"?e:e.assignedSlot||e.parentNode||(isShadowRoot(e)?e.host:null)||getDocumentElement(e)}function getTrueOffsetParent(e){return!isHTMLElement(e)||getComputedStyle$1(e).position==="fixed"?null:e.offsetParent}function getContainingBlock(e){var t=/firefox/i.test(getUAString()),i=/Trident/i.test(getUAString());if(i&&isHTMLElement(e)){var r=getComputedStyle$1(e);if(r.position==="fixed")return null}var o=getParentNode(e);for(isShadowRoot(o)&&(o=o.host);isHTMLElement(o)&&["html","body"].indexOf(getNodeName(o))<0;){var a=getComputedStyle$1(o);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||t&&a.willChange==="filter"||t&&a.filter&&a.filter!=="none")return o;o=o.parentNode}return null}function getOffsetParent(e){for(var t=getWindow(e),i=getTrueOffsetParent(e);i&&isTableElement(i)&&getComputedStyle$1(i).position==="static";)i=getTrueOffsetParent(i);return i&&(getNodeName(i)==="html"||getNodeName(i)==="body"&&getComputedStyle$1(i).position==="static")?t:i||getContainingBlock(e)||t}function getMainAxisFromPlacement(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function within(e,t,i){return max(e,min(t,i))}function withinMaxClamp(e,t,i){var r=within(e,t,i);return r>i?i:r}function getFreshSideObject(){return{top:0,right:0,bottom:0,left:0}}function mergePaddingObject(e){return Object.assign({},getFreshSideObject(),e)}function expandToHashMap(e,t){return t.reduce(function(i,r){return i[r]=e,i},{})}var toPaddingObject=function(t,i){return t=typeof t=="function"?t(Object.assign({},i.rects,{placement:i.placement})):t,mergePaddingObject(typeof t!="number"?t:expandToHashMap(t,basePlacements))};function arrow(e){var t,i=e.state,r=e.name,o=e.options,a=i.elements.arrow,c=i.modifiersData.popperOffsets,u=getBasePlacement$1(i.placement),h=getMainAxisFromPlacement(u),d=[left,right].indexOf(u)>=0,f=d?"height":"width";if(!(!a||!c)){var m=toPaddingObject(o.padding,i),g=getLayoutRect(a),v=h==="y"?top:left,_=h==="y"?bottom:right,b=i.rects.reference[f]+i.rects.reference[h]-c[h]-i.rects.popper[f],S=c[h]-i.rects.reference[h],T=getOffsetParent(a),A=T?h==="y"?T.clientHeight||0:T.clientWidth||0:0,I=b/2-S/2,R=m[v],O=A-g[f]-m[_],P=A/2-g[f]/2+I,L=within(R,P,O),V=h;i.modifiersData[r]=(t={},t[V]=L,t.centerOffset=L-P,t)}}function effect$1(e){var t=e.state,i=e.options,r=i.element,o=r===void 0?"[data-popper-arrow]":r;o!=null&&(typeof o=="string"&&(o=t.elements.popper.querySelector(o),!o)||contains(t.elements.popper,o)&&(t.elements.arrow=o))}var arrow_default={name:"arrow",enabled:!0,phase:"main",fn:arrow,effect:effect$1,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function getVariation(e){return e.split("-")[1]}var unsetSides={top:"auto",right:"auto",bottom:"auto",left:"auto"};function roundOffsetsByDPR(e,t){var i=e.x,r=e.y,o=t.devicePixelRatio||1;return{x:round(i*o)/o||0,y:round(r*o)/o||0}}function mapToStyles(e){var t,i=e.popper,r=e.popperRect,o=e.placement,a=e.variation,c=e.offsets,u=e.position,h=e.gpuAcceleration,d=e.adaptive,f=e.roundOffsets,m=e.isFixed,g=c.x,v=g===void 0?0:g,_=c.y,b=_===void 0?0:_,S=typeof f=="function"?f({x:v,y:b}):{x:v,y:b};v=S.x,b=S.y;var T=c.hasOwnProperty("x"),A=c.hasOwnProperty("y"),I=left,R=top,O=window;if(d){var P=getOffsetParent(i),L="clientHeight",V="clientWidth";if(P===getWindow(i)&&(P=getDocumentElement(i),getComputedStyle$1(P).position!=="static"&&u==="absolute"&&(L="scrollHeight",V="scrollWidth")),P=P,o===top||(o===left||o===right)&&a===end){R=bottom;var U=m&&P===O&&O.visualViewport?O.visualViewport.height:P[L];b-=U-r.height,b*=h?1:-1}if(o===left||(o===top||o===bottom)&&a===end){I=right;var $=m&&P===O&&O.visualViewport?O.visualViewport.width:P[V];v-=$-r.width,v*=h?1:-1}}var Z=Object.assign({position:u},d&&unsetSides),ie=f===!0?roundOffsetsByDPR({x:v,y:b},getWindow(i)):{x:v,y:b};if(v=ie.x,b=ie.y,h){var ue;return Object.assign({},Z,(ue={},ue[R]=A?"0":"",ue[I]=T?"0":"",ue.transform=(O.devicePixelRatio||1)<=1?"translate("+v+"px, "+b+"px)":"translate3d("+v+"px, "+b+"px, 0)",ue))}return Object.assign({},Z,(t={},t[R]=A?b+"px":"",t[I]=T?v+"px":"",t.transform="",t))}function computeStyles(e){var t=e.state,i=e.options,r=i.gpuAcceleration,o=r===void 0?!0:r,a=i.adaptive,c=a===void 0?!0:a,u=i.roundOffsets,h=u===void 0?!0:u,d={placement:getBasePlacement$1(t.placement),variation:getVariation(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,mapToStyles(Object.assign({},d,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:c,roundOffsets:h})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,mapToStyles(Object.assign({},d,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:h})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}var computeStyles_default={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:computeStyles,data:{}},passive={passive:!0};function effect(e){var t=e.state,i=e.instance,r=e.options,o=r.scroll,a=o===void 0?!0:o,c=r.resize,u=c===void 0?!0:c,h=getWindow(t.elements.popper),d=[].concat(t.scrollParents.reference,t.scrollParents.popper);return a&&d.forEach(function(f){f.addEventListener("scroll",i.update,passive)}),u&&h.addEventListener("resize",i.update,passive),function(){a&&d.forEach(function(f){f.removeEventListener("scroll",i.update,passive)}),u&&h.removeEventListener("resize",i.update,passive)}}var eventListeners_default={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect,data:{}},hash$1={left:"right",right:"left",bottom:"top",top:"bottom"};function getOppositePlacement(e){return e.replace(/left|right|bottom|top/g,function(t){return hash$1[t]})}var hash={start:"end",end:"start"};function getOppositeVariationPlacement(e){return e.replace(/start|end/g,function(t){return hash[t]})}function getWindowScroll(e){var t=getWindow(e),i=t.pageXOffset,r=t.pageYOffset;return{scrollLeft:i,scrollTop:r}}function getWindowScrollBarX(e){return getBoundingClientRect(getDocumentElement(e)).left+getWindowScroll(e).scrollLeft}function getViewportRect(e,t){var i=getWindow(e),r=getDocumentElement(e),o=i.visualViewport,a=r.clientWidth,c=r.clientHeight,u=0,h=0;if(o){a=o.width,c=o.height;var d=isLayoutViewport();(d||!d&&t==="fixed")&&(u=o.offsetLeft,h=o.offsetTop)}return{width:a,height:c,x:u+getWindowScrollBarX(e),y:h}}function getDocumentRect(e){var t,i=getDocumentElement(e),r=getWindowScroll(e),o=(t=e.ownerDocument)==null?void 0:t.body,a=max(i.scrollWidth,i.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),c=max(i.scrollHeight,i.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),u=-r.scrollLeft+getWindowScrollBarX(e),h=-r.scrollTop;return getComputedStyle$1(o||i).direction==="rtl"&&(u+=max(i.clientWidth,o?o.clientWidth:0)-a),{width:a,height:c,x:u,y:h}}function isScrollParent(e){var t=getComputedStyle$1(e),i=t.overflow,r=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(i+o+r)}function getScrollParent(e){return["html","body","#document"].indexOf(getNodeName(e))>=0?e.ownerDocument.body:isHTMLElement(e)&&isScrollParent(e)?e:getScrollParent(getParentNode(e))}function listScrollParents(e,t){var i;t===void 0&&(t=[]);var r=getScrollParent(e),o=r===((i=e.ownerDocument)==null?void 0:i.body),a=getWindow(r),c=o?[a].concat(a.visualViewport||[],isScrollParent(r)?r:[]):r,u=t.concat(c);return o?u:u.concat(listScrollParents(getParentNode(c)))}function rectToClientRect(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function getInnerBoundingClientRect(e,t){var i=getBoundingClientRect(e,!1,t==="fixed");return i.top=i.top+e.clientTop,i.left=i.left+e.clientLeft,i.bottom=i.top+e.clientHeight,i.right=i.left+e.clientWidth,i.width=e.clientWidth,i.height=e.clientHeight,i.x=i.left,i.y=i.top,i}function getClientRectFromMixedType(e,t,i){return t===viewport?rectToClientRect(getViewportRect(e,i)):isElement$1(t)?getInnerBoundingClientRect(t,i):rectToClientRect(getDocumentRect(getDocumentElement(e)))}function getClippingParents(e){var t=listScrollParents(getParentNode(e)),i=["absolute","fixed"].indexOf(getComputedStyle$1(e).position)>=0,r=i&&isHTMLElement(e)?getOffsetParent(e):e;return isElement$1(r)?t.filter(function(o){return isElement$1(o)&&contains(o,r)&&getNodeName(o)!=="body"}):[]}function getClippingRect(e,t,i,r){var o=t==="clippingParents"?getClippingParents(e):[].concat(t),a=[].concat(o,[i]),c=a[0],u=a.reduce(function(h,d){var f=getClientRectFromMixedType(e,d,r);return h.top=max(f.top,h.top),h.right=min(f.right,h.right),h.bottom=min(f.bottom,h.bottom),h.left=max(f.left,h.left),h},getClientRectFromMixedType(e,c,r));return u.width=u.right-u.left,u.height=u.bottom-u.top,u.x=u.left,u.y=u.top,u}function computeOffsets(e){var t=e.reference,i=e.element,r=e.placement,o=r?getBasePlacement$1(r):null,a=r?getVariation(r):null,c=t.x+t.width/2-i.width/2,u=t.y+t.height/2-i.height/2,h;switch(o){case top:h={x:c,y:t.y-i.height};break;case bottom:h={x:c,y:t.y+t.height};break;case right:h={x:t.x+t.width,y:u};break;case left:h={x:t.x-i.width,y:u};break;default:h={x:t.x,y:t.y}}var d=o?getMainAxisFromPlacement(o):null;if(d!=null){var f=d==="y"?"height":"width";switch(a){case start:h[d]=h[d]-(t[f]/2-i[f]/2);break;case end:h[d]=h[d]+(t[f]/2-i[f]/2);break;default:}}return h}function detectOverflow(e,t){t===void 0&&(t={});var i=t,r=i.placement,o=r===void 0?e.placement:r,a=i.strategy,c=a===void 0?e.strategy:a,u=i.boundary,h=u===void 0?clippingParents:u,d=i.rootBoundary,f=d===void 0?viewport:d,m=i.elementContext,g=m===void 0?popper:m,v=i.altBoundary,_=v===void 0?!1:v,b=i.padding,S=b===void 0?0:b,T=mergePaddingObject(typeof S!="number"?S:expandToHashMap(S,basePlacements)),A=g===popper?reference:popper,I=e.rects.popper,R=e.elements[_?A:g],O=getClippingRect(isElement$1(R)?R:R.contextElement||getDocumentElement(e.elements.popper),h,f,c),P=getBoundingClientRect(e.elements.reference),L=computeOffsets({reference:P,element:I,strategy:"absolute",placement:o}),V=rectToClientRect(Object.assign({},I,L)),U=g===popper?V:P,$={top:O.top-U.top+T.top,bottom:U.bottom-O.bottom+T.bottom,left:O.left-U.left+T.left,right:U.right-O.right+T.right},Z=e.modifiersData.offset;if(g===popper&&Z){var ie=Z[o];Object.keys($).forEach(function(ue){var _e=[right,bottom].indexOf(ue)>=0?1:-1,Ee=[top,bottom].indexOf(ue)>=0?"y":"x";$[ue]+=ie[Ee]*_e})}return $}function computeAutoPlacement(e,t){t===void 0&&(t={});var i=t,r=i.placement,o=i.boundary,a=i.rootBoundary,c=i.padding,u=i.flipVariations,h=i.allowedAutoPlacements,d=h===void 0?placements:h,f=getVariation(r),m=f?u?variationPlacements:variationPlacements.filter(function(_){return getVariation(_)===f}):basePlacements,g=m.filter(function(_){return d.indexOf(_)>=0});g.length===0&&(g=m);var v=g.reduce(function(_,b){return _[b]=detectOverflow(e,{placement:b,boundary:o,rootBoundary:a,padding:c})[getBasePlacement$1(b)],_},{});return Object.keys(v).sort(function(_,b){return v[_]-v[b]})}function getExpandedFallbackPlacements(e){if(getBasePlacement$1(e)===auto)return[];var t=getOppositePlacement(e);return[getOppositeVariationPlacement(e),t,getOppositeVariationPlacement(t)]}function flip(e){var t=e.state,i=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var o=i.mainAxis,a=o===void 0?!0:o,c=i.altAxis,u=c===void 0?!0:c,h=i.fallbackPlacements,d=i.padding,f=i.boundary,m=i.rootBoundary,g=i.altBoundary,v=i.flipVariations,_=v===void 0?!0:v,b=i.allowedAutoPlacements,S=t.options.placement,T=getBasePlacement$1(S),A=T===S,I=h||(A||!_?[getOppositePlacement(S)]:getExpandedFallbackPlacements(S)),R=[S].concat(I).reduce(function(q,B){return q.concat(getBasePlacement$1(B)===auto?computeAutoPlacement(t,{placement:B,boundary:f,rootBoundary:m,padding:d,flipVariations:_,allowedAutoPlacements:b}):B)},[]),O=t.rects.reference,P=t.rects.popper,L=new Map,V=!0,U=R[0],$=0;$<R.length;$++){var Z=R[$],ie=getBasePlacement$1(Z),ue=getVariation(Z)===start,_e=[top,bottom].indexOf(ie)>=0,Ee=_e?"width":"height",pe=detectOverflow(t,{placement:Z,boundary:f,rootBoundary:m,altBoundary:g,padding:d}),me=_e?ue?right:left:ue?bottom:top;O[Ee]>P[Ee]&&(me=getOppositePlacement(me));var Se=getOppositePlacement(me),Le=[];if(a&&Le.push(pe[ie]<=0),u&&Le.push(pe[me]<=0,pe[Se]<=0),Le.every(function(q){return q})){U=Z,V=!1;break}L.set(Z,Le)}if(V)for(var xe=_?3:1,E=function(B){var se=R.find(function(ye){var we=L.get(ye);if(we)return we.slice(0,B).every(function(de){return de})});if(se)return U=se,"break"},k=xe;k>0;k--){var D=E(k);if(D==="break")break}t.placement!==U&&(t.modifiersData[r]._skip=!0,t.placement=U,t.reset=!0)}}var flip_default={name:"flip",enabled:!0,phase:"main",fn:flip,requiresIfExists:["offset"],data:{_skip:!1}};function getSideOffsets(e,t,i){return i===void 0&&(i={x:0,y:0}),{top:e.top-t.height-i.y,right:e.right-t.width+i.x,bottom:e.bottom-t.height+i.y,left:e.left-t.width-i.x}}function isAnySideFullyClipped(e){return[top,right,bottom,left].some(function(t){return e[t]>=0})}function hide(e){var t=e.state,i=e.name,r=t.rects.reference,o=t.rects.popper,a=t.modifiersData.preventOverflow,c=detectOverflow(t,{elementContext:"reference"}),u=detectOverflow(t,{altBoundary:!0}),h=getSideOffsets(c,r),d=getSideOffsets(u,o,a),f=isAnySideFullyClipped(h),m=isAnySideFullyClipped(d);t.modifiersData[i]={referenceClippingOffsets:h,popperEscapeOffsets:d,isReferenceHidden:f,hasPopperEscaped:m},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":f,"data-popper-escaped":m})}var hide_default={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:hide};function distanceAndSkiddingToXY(e,t,i){var r=getBasePlacement$1(e),o=[left,top].indexOf(r)>=0?-1:1,a=typeof i=="function"?i(Object.assign({},t,{placement:e})):i,c=a[0],u=a[1];return c=c||0,u=(u||0)*o,[left,right].indexOf(r)>=0?{x:u,y:c}:{x:c,y:u}}function offset(e){var t=e.state,i=e.options,r=e.name,o=i.offset,a=o===void 0?[0,0]:o,c=placements.reduce(function(f,m){return f[m]=distanceAndSkiddingToXY(m,t.rects,a),f},{}),u=c[t.placement],h=u.x,d=u.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=h,t.modifiersData.popperOffsets.y+=d),t.modifiersData[r]=c}var offset_default={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:offset};function popperOffsets(e){var t=e.state,i=e.name;t.modifiersData[i]=computeOffsets({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}var popperOffsets_default={name:"popperOffsets",enabled:!0,phase:"read",fn:popperOffsets,data:{}};function getAltAxis(e){return e==="x"?"y":"x"}function preventOverflow(e){var t=e.state,i=e.options,r=e.name,o=i.mainAxis,a=o===void 0?!0:o,c=i.altAxis,u=c===void 0?!1:c,h=i.boundary,d=i.rootBoundary,f=i.altBoundary,m=i.padding,g=i.tether,v=g===void 0?!0:g,_=i.tetherOffset,b=_===void 0?0:_,S=detectOverflow(t,{boundary:h,rootBoundary:d,padding:m,altBoundary:f}),T=getBasePlacement$1(t.placement),A=getVariation(t.placement),I=!A,R=getMainAxisFromPlacement(T),O=getAltAxis(R),P=t.modifiersData.popperOffsets,L=t.rects.reference,V=t.rects.popper,U=typeof b=="function"?b(Object.assign({},t.rects,{placement:t.placement})):b,$=typeof U=="number"?{mainAxis:U,altAxis:U}:Object.assign({mainAxis:0,altAxis:0},U),Z=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,ie={x:0,y:0};if(P){if(a){var ue,_e=R==="y"?top:left,Ee=R==="y"?bottom:right,pe=R==="y"?"height":"width",me=P[R],Se=me+S[_e],Le=me-S[Ee],xe=v?-V[pe]/2:0,E=A===start?L[pe]:V[pe],k=A===start?-V[pe]:-L[pe],D=t.elements.arrow,q=v&&D?getLayoutRect(D):{width:0,height:0},B=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:getFreshSideObject(),se=B[_e],ye=B[Ee],we=within(0,L[pe],q[pe]),de=I?L[pe]/2-xe-we-se-$.mainAxis:E-we-se-$.mainAxis,be=I?-L[pe]/2+xe+we+ye+$.mainAxis:k+we+ye+$.mainAxis,fe=t.elements.arrow&&getOffsetParent(t.elements.arrow),he=fe?R==="y"?fe.clientTop||0:fe.clientLeft||0:0,Ne=(ue=Z?.[R])!=null?ue:0,le=me+de-Ne-he,Ve=me+be-Ne,Be=within(v?min(Se,le):Se,me,v?max(Le,Ve):Le);P[R]=Be,ie[R]=Be-me}if(u){var je,We=R==="x"?top:left,$e=R==="x"?bottom:right,H=P[O],F=O==="y"?"height":"width",G=H+S[We],oe=H-S[$e],Q=[top,left].indexOf(T)!==-1,ce=(je=Z?.[O])!=null?je:0,ee=Q?G:H-L[F]-V[F]-ce+$.altAxis,te=Q?H+L[F]+V[F]-ce-$.altAxis:oe,W=v&&Q?withinMaxClamp(ee,H,te):within(v?ee:G,H,v?te:oe);P[O]=W,ie[O]=W-H}t.modifiersData[r]=ie}}var preventOverflow_default={name:"preventOverflow",enabled:!0,phase:"main",fn:preventOverflow,requiresIfExists:["offset"]};function getHTMLElementScroll(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function getNodeScroll(e){return e===getWindow(e)||!isHTMLElement(e)?getWindowScroll(e):getHTMLElementScroll(e)}function isElementScaled(e){var t=e.getBoundingClientRect(),i=round(t.width)/e.offsetWidth||1,r=round(t.height)/e.offsetHeight||1;return i!==1||r!==1}function getCompositeRect(e,t,i){i===void 0&&(i=!1);var r=isHTMLElement(t),o=isHTMLElement(t)&&isElementScaled(t),a=getDocumentElement(t),c=getBoundingClientRect(e,o,i),u={scrollLeft:0,scrollTop:0},h={x:0,y:0};return(r||!r&&!i)&&((getNodeName(t)!=="body"||isScrollParent(a))&&(u=getNodeScroll(t)),isHTMLElement(t)?(h=getBoundingClientRect(t,!0),h.x+=t.clientLeft,h.y+=t.clientTop):a&&(h.x=getWindowScrollBarX(a))),{x:c.left+u.scrollLeft-h.x,y:c.top+u.scrollTop-h.y,width:c.width,height:c.height}}function order(e){var t=new Map,i=new Set,r=[];e.forEach(function(a){t.set(a.name,a)});function o(a){i.add(a.name);var c=[].concat(a.requires||[],a.requiresIfExists||[]);c.forEach(function(u){if(!i.has(u)){var h=t.get(u);h&&o(h)}}),r.push(a)}return e.forEach(function(a){i.has(a.name)||o(a)}),r}function orderModifiers(e){var t=order(e);return modifierPhases.reduce(function(i,r){return i.concat(t.filter(function(o){return o.phase===r}))},[])}function debounce$1(e){var t;return function(){return t||(t=new Promise(function(i){Promise.resolve().then(function(){t=void 0,i(e())})})),t}}function mergeByName(e){var t=e.reduce(function(i,r){var o=i[r.name];return i[r.name]=o?Object.assign({},o,r,{options:Object.assign({},o.options,r.options),data:Object.assign({},o.data,r.data)}):r,i},{});return Object.keys(t).map(function(i){return t[i]})}var DEFAULT_OPTIONS={placement:"bottom",modifiers:[],strategy:"absolute"};function areValidElements(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return!t.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function popperGenerator(e){e===void 0&&(e={});var t=e,i=t.defaultModifiers,r=i===void 0?[]:i,o=t.defaultOptions,a=o===void 0?DEFAULT_OPTIONS:o;return function(u,h,d){d===void 0&&(d=a);var f={placement:"bottom",orderedModifiers:[],options:Object.assign({},DEFAULT_OPTIONS,a),modifiersData:{},elements:{reference:u,popper:h},attributes:{},styles:{}},m=[],g=!1,v={state:f,setOptions:function(T){var A=typeof T=="function"?T(f.options):T;b(),f.options=Object.assign({},a,f.options,A),f.scrollParents={reference:isElement$1(u)?listScrollParents(u):u.contextElement?listScrollParents(u.contextElement):[],popper:listScrollParents(h)};var I=orderModifiers(mergeByName([].concat(r,f.options.modifiers)));return f.orderedModifiers=I.filter(function(R){return R.enabled}),_(),v.update()},forceUpdate:function(){if(!g){var T=f.elements,A=T.reference,I=T.popper;if(areValidElements(A,I)){f.rects={reference:getCompositeRect(A,getOffsetParent(I),f.options.strategy==="fixed"),popper:getLayoutRect(I)},f.reset=!1,f.placement=f.options.placement,f.orderedModifiers.forEach(function($){return f.modifiersData[$.name]=Object.assign({},$.data)});for(var R=0;R<f.orderedModifiers.length;R++){if(f.reset===!0){f.reset=!1,R=-1;continue}var O=f.orderedModifiers[R],P=O.fn,L=O.options,V=L===void 0?{}:L,U=O.name;typeof P=="function"&&(f=P({state:f,options:V,name:U,instance:v})||f)}}}},update:debounce$1(function(){return new Promise(function(S){v.forceUpdate(),S(f)})}),destroy:function(){b(),g=!0}};if(!areValidElements(u,h))return v;v.setOptions(d).then(function(S){!g&&d.onFirstUpdate&&d.onFirstUpdate(S)});function _(){f.orderedModifiers.forEach(function(S){var T=S.name,A=S.options,I=A===void 0?{}:A,R=S.effect;if(typeof R=="function"){var O=R({state:f,name:T,instance:v,options:I}),P=function(){};m.push(O||P)}})}function b(){m.forEach(function(S){return S()}),m=[]}return v}}var defaultModifiers=[eventListeners_default,popperOffsets_default,computeStyles_default,applyStyles_default,offset_default,flip_default,preventOverflow_default,arrow_default,hide_default],createPopper$1=popperGenerator({defaultModifiers}),BOX_CLASS="tippy-box",CONTENT_CLASS="tippy-content",BACKDROP_CLASS="tippy-backdrop",ARROW_CLASS="tippy-arrow",SVG_ARROW_CLASS="tippy-svg-arrow",TOUCH_OPTIONS={passive:!0,capture:!0},TIPPY_DEFAULT_APPEND_TO=function(){return document.body};function hasOwnProperty(e,t){return{}.hasOwnProperty.call(e,t)}function getValueAtIndexOrReturn(e,t,i){if(Array.isArray(e)){var r=e[t];return r??(Array.isArray(i)?i[t]:i)}return e}function isType(e,t){var i={}.toString.call(e);return i.indexOf("[object")===0&&i.indexOf(t+"]")>-1}function invokeWithArgsOrReturn(e,t){return typeof e=="function"?e.apply(void 0,t):e}function debounce(e,t){if(t===0)return e;var i;return function(r){clearTimeout(i),i=setTimeout(function(){e(r)},t)}}function removeProperties(e,t){var i=Object.assign({},e);return t.forEach(function(r){delete i[r]}),i}function splitBySpaces(e){return e.split(/\s+/).filter(Boolean)}function normalizeToArray(e){return[].concat(e)}function pushIfUnique(e,t){e.indexOf(t)===-1&&e.push(t)}function unique(e){return e.filter(function(t,i){return e.indexOf(t)===i})}function getBasePlacement(e){return e.split("-")[0]}function arrayFrom(e){return[].slice.call(e)}function removeUndefinedProps(e){return Object.keys(e).reduce(function(t,i){return e[i]!==void 0&&(t[i]=e[i]),t},{})}function div(){return document.createElement("div")}function isElement(e){return["Element","Fragment"].some(function(t){return isType(e,t)})}function isNodeList(e){return isType(e,"NodeList")}function isMouseEvent(e){return isType(e,"MouseEvent")}function isReferenceElement(e){return!!(e&&e._tippy&&e._tippy.reference===e)}function getArrayOfElements(e){return isElement(e)?[e]:isNodeList(e)?arrayFrom(e):Array.isArray(e)?e:arrayFrom(document.querySelectorAll(e))}function setTransitionDuration(e,t){e.forEach(function(i){i&&(i.style.transitionDuration=t+"ms")})}function setVisibilityState(e,t){e.forEach(function(i){i&&i.setAttribute("data-state",t)})}function getOwnerDocument(e){var t,i=normalizeToArray(e),r=i[0];return r!=null&&(t=r.ownerDocument)!=null&&t.body?r.ownerDocument:document}function isCursorOutsideInteractiveBorder(e,t){var i=t.clientX,r=t.clientY;return e.every(function(o){var a=o.popperRect,c=o.popperState,u=o.props,h=u.interactiveBorder,d=getBasePlacement(c.placement),f=c.modifiersData.offset;if(!f)return!0;var m=d==="bottom"?f.top.y:0,g=d==="top"?f.bottom.y:0,v=d==="right"?f.left.x:0,_=d==="left"?f.right.x:0,b=a.top-r+m>h,S=r-a.bottom-g>h,T=a.left-i+v>h,A=i-a.right-_>h;return b||S||T||A})}function updateTransitionEndListener(e,t,i){var r=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(o){e[r](o,i)})}function actualContains(e,t){for(var i=t;i;){var r;if(e.contains(i))return!0;i=i.getRootNode==null||(r=i.getRootNode())==null?void 0:r.host}return!1}var currentInput={isTouch:!1},lastMouseMoveTime=0;function onDocumentTouchStart(){currentInput.isTouch||(currentInput.isTouch=!0,window.performance&&document.addEventListener("mousemove",onDocumentMouseMove))}function onDocumentMouseMove(){var e=performance.now();e-lastMouseMoveTime<20&&(currentInput.isTouch=!1,document.removeEventListener("mousemove",onDocumentMouseMove)),lastMouseMoveTime=e}function onWindowBlur(){var e=document.activeElement;if(isReferenceElement(e)){var t=e._tippy;e.blur&&!t.state.isVisible&&e.blur()}}function bindGlobalEventListeners(){document.addEventListener("touchstart",onDocumentTouchStart,TOUCH_OPTIONS),window.addEventListener("blur",onWindowBlur)}var isBrowser=typeof window<"u"&&typeof document<"u",isIE11=isBrowser?!!window.msCrypto:!1;function createMemoryLeakWarning(e){var t=e==="destroy"?"n already-":" ";return[e+"() was called on a"+t+"destroyed instance. This is a no-op but","indicates a potential memory leak."].join(" ")}function clean(e){var t=/[ \t]{2,}/g,i=/^[ \t]*/gm;return e.replace(t," ").replace(i,"").trim()}function getDevMessage(e){return clean(`
  %ctippy.js

  %c`+clean(e)+`

  %c\u{1F477}\u200D This is a development-only message. It will be removed in production.
  `)}function getFormattedMessage(e){return[getDevMessage(e),"color: #00C584; font-size: 1.3em; font-weight: bold;","line-height: 1.5","color: #a6a095;"]}var visitedMessages;function resetVisitedMessages(){visitedMessages=new Set}function warnWhen(e,t){if(e&&!visitedMessages.has(t)){var i;visitedMessages.add(t),(i=console).warn.apply(i,getFormattedMessage(t))}}function errorWhen(e,t){if(e&&!visitedMessages.has(t)){var i;visitedMessages.add(t),(i=console).error.apply(i,getFormattedMessage(t))}}function validateTargets(e){var t=!e,i=Object.prototype.toString.call(e)==="[object Object]"&&!e.addEventListener;errorWhen(t,["tippy() was passed","`"+String(e)+"`","as its targets (first) argument. Valid types are: String, Element,","Element[], or NodeList."].join(" ")),errorWhen(i,["tippy() was passed a plain object which is not supported as an argument","for virtual positioning. Use props.getReferenceClientRect instead."].join(" "))}var pluginProps={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},renderProps={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},defaultProps=Object.assign({appendTo:TIPPY_DEFAULT_APPEND_TO,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},pluginProps,renderProps),defaultKeys=Object.keys(defaultProps),setDefaultProps=function(t){var i=Object.keys(t);i.forEach(function(r){defaultProps[r]=t[r]})};function getExtendedPassedProps(e){var t=e.plugins||[],i=t.reduce(function(r,o){var a=o.name,c=o.defaultValue;if(a){var u;r[a]=e[a]!==void 0?e[a]:(u=defaultProps[a])!=null?u:c}return r},{});return Object.assign({},e,i)}function getDataAttributeProps(e,t){var i=t?Object.keys(getExtendedPassedProps(Object.assign({},defaultProps,{plugins:t}))):defaultKeys,r=i.reduce(function(o,a){var c=(e.getAttribute("data-tippy-"+a)||"").trim();if(!c)return o;if(a==="content")o[a]=c;else try{o[a]=JSON.parse(c)}catch{o[a]=c}return o},{});return r}function evaluateProps(e,t){var i=Object.assign({},t,{content:invokeWithArgsOrReturn(t.content,[e])},t.ignoreAttributes?{}:getDataAttributeProps(e,t.plugins));return i.aria=Object.assign({},defaultProps.aria,i.aria),i.aria={expanded:i.aria.expanded==="auto"?t.interactive:i.aria.expanded,content:i.aria.content==="auto"?t.interactive?null:"describedby":i.aria.content},i}function validateProps(e,t){e===void 0&&(e={}),t===void 0&&(t=[]);var i=Object.keys(e);i.forEach(function(r){var o=removeProperties(defaultProps,Object.keys(pluginProps)),a=!hasOwnProperty(o,r);a&&(a=t.filter(function(c){return c.name===r}).length===0),warnWhen(a,["`"+r+"`","is not a valid prop. You may have spelled it incorrectly, or if it's","a plugin, forgot to pass it in an array as props.plugins.",`

`,`All props: https://atomiks.github.io/tippyjs/v6/all-props/
`,"Plugins: https://atomiks.github.io/tippyjs/v6/plugins/"].join(" "))})}var innerHTML=function(){return"innerHTML"};function dangerouslySetInnerHTML(e,t){e[innerHTML()]=t}function createArrowElement(e){var t=div();return e===!0?t.className=ARROW_CLASS:(t.className=SVG_ARROW_CLASS,isElement(e)?t.appendChild(e):dangerouslySetInnerHTML(t,e)),t}function setContent(e,t){isElement(t.content)?(dangerouslySetInnerHTML(e,""),e.appendChild(t.content)):typeof t.content!="function"&&(t.allowHTML?dangerouslySetInnerHTML(e,t.content):e.textContent=t.content)}function getChildren(e){var t=e.firstElementChild,i=arrayFrom(t.children);return{box:t,content:i.find(function(r){return r.classList.contains(CONTENT_CLASS)}),arrow:i.find(function(r){return r.classList.contains(ARROW_CLASS)||r.classList.contains(SVG_ARROW_CLASS)}),backdrop:i.find(function(r){return r.classList.contains(BACKDROP_CLASS)})}}function render(e){var t=div(),i=div();i.className=BOX_CLASS,i.setAttribute("data-state","hidden"),i.setAttribute("tabindex","-1");var r=div();r.className=CONTENT_CLASS,r.setAttribute("data-state","hidden"),setContent(r,e.props),t.appendChild(i),i.appendChild(r),o(e.props,e.props);function o(a,c){var u=getChildren(t),h=u.box,d=u.content,f=u.arrow;c.theme?h.setAttribute("data-theme",c.theme):h.removeAttribute("data-theme"),typeof c.animation=="string"?h.setAttribute("data-animation",c.animation):h.removeAttribute("data-animation"),c.inertia?h.setAttribute("data-inertia",""):h.removeAttribute("data-inertia"),h.style.maxWidth=typeof c.maxWidth=="number"?c.maxWidth+"px":c.maxWidth,c.role?h.setAttribute("role",c.role):h.removeAttribute("role"),(a.content!==c.content||a.allowHTML!==c.allowHTML)&&setContent(d,e.props),c.arrow?f?a.arrow!==c.arrow&&(h.removeChild(f),h.appendChild(createArrowElement(c.arrow))):h.appendChild(createArrowElement(c.arrow)):f&&h.removeChild(f)}return{popper:t,onUpdate:o}}render.$$tippy=!0;var idCounter=1,mouseMoveListeners=[],mountedInstances=[];function createTippy(e,t){var i=evaluateProps(e,Object.assign({},defaultProps,getExtendedPassedProps(removeUndefinedProps(t)))),r,o,a,c=!1,u=!1,h=!1,d=!1,f,m,g,v=[],_=debounce(le,i.interactiveDebounce),b,S=idCounter++,T=null,A=unique(i.plugins),I={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},R={id:S,reference:e,popper:div(),popperInstance:T,props:i,state:I,plugins:A,clearDelayTimeouts:ee,setProps:te,setContent:W,show:j,hide:K,hideWithInteractivity:ve,enable:Q,disable:ce,unmount:Re,destroy:Ie};if(!i.render)return R;var O=i.render(R),P=O.popper,L=O.onUpdate;P.setAttribute("data-tippy-root",""),P.id="tippy-"+R.id,R.popper=P,e._tippy=R,P._tippy=R;var V=A.map(function(ae){return ae.fn(R)}),U=e.hasAttribute("aria-expanded");return fe(),xe(),me(),Se("onCreate",[R]),i.showOnCreate&&G(),P.addEventListener("mouseenter",function(){R.props.interactive&&R.state.isVisible&&R.clearDelayTimeouts()}),P.addEventListener("mouseleave",function(){R.props.interactive&&R.props.trigger.indexOf("mouseenter")>=0&&_e().addEventListener("mousemove",_)}),R;function $(){var ae=R.props.touch;return Array.isArray(ae)?ae:[ae,0]}function Z(){return $()[0]==="hold"}function ie(){var ae;return!!((ae=R.props.render)!=null&&ae.$$tippy)}function ue(){return b||e}function _e(){var ae=ue().parentNode;return ae?getOwnerDocument(ae):document}function Ee(){return getChildren(P)}function pe(ae){return R.state.isMounted&&!R.state.isVisible||currentInput.isTouch||f&&f.type==="focus"?0:getValueAtIndexOrReturn(R.props.delay,ae?0:1,defaultProps.delay)}function me(ae){ae===void 0&&(ae=!1),P.style.pointerEvents=R.props.interactive&&!ae?"":"none",P.style.zIndex=""+R.props.zIndex}function Se(ae,Te,Me){if(Me===void 0&&(Me=!0),V.forEach(function(De){De[ae]&&De[ae].apply(De,Te)}),Me){var Pe;(Pe=R.props)[ae].apply(Pe,Te)}}function Le(){var ae=R.props.aria;if(ae.content){var Te="aria-"+ae.content,Me=P.id,Pe=normalizeToArray(R.props.triggerTarget||e);Pe.forEach(function(De){var ze=De.getAttribute(Te);if(R.state.isVisible)De.setAttribute(Te,ze?ze+" "+Me:Me);else{var ut=ze&&ze.replace(Me,"").trim();ut?De.setAttribute(Te,ut):De.removeAttribute(Te)}})}}function xe(){if(!(U||!R.props.aria.expanded)){var ae=normalizeToArray(R.props.triggerTarget||e);ae.forEach(function(Te){R.props.interactive?Te.setAttribute("aria-expanded",R.state.isVisible&&Te===ue()?"true":"false"):Te.removeAttribute("aria-expanded")})}}function E(){_e().removeEventListener("mousemove",_),mouseMoveListeners=mouseMoveListeners.filter(function(ae){return ae!==_})}function k(ae){if(!(currentInput.isTouch&&(h||ae.type==="mousedown"))){var Te=ae.composedPath&&ae.composedPath()[0]||ae.target;if(!(R.props.interactive&&actualContains(P,Te))){if(normalizeToArray(R.props.triggerTarget||e).some(function(Me){return actualContains(Me,Te)})){if(currentInput.isTouch||R.state.isVisible&&R.props.trigger.indexOf("click")>=0)return}else Se("onClickOutside",[R,ae]);R.props.hideOnClick===!0&&(R.clearDelayTimeouts(),R.hide(),u=!0,setTimeout(function(){u=!1}),R.state.isMounted||se())}}}function D(){h=!0}function q(){h=!1}function B(){var ae=_e();ae.addEventListener("mousedown",k,!0),ae.addEventListener("touchend",k,TOUCH_OPTIONS),ae.addEventListener("touchstart",q,TOUCH_OPTIONS),ae.addEventListener("touchmove",D,TOUCH_OPTIONS)}function se(){var ae=_e();ae.removeEventListener("mousedown",k,!0),ae.removeEventListener("touchend",k,TOUCH_OPTIONS),ae.removeEventListener("touchstart",q,TOUCH_OPTIONS),ae.removeEventListener("touchmove",D,TOUCH_OPTIONS)}function ye(ae,Te){de(ae,function(){!R.state.isVisible&&P.parentNode&&P.parentNode.contains(P)&&Te()})}function we(ae,Te){de(ae,Te)}function de(ae,Te){var Me=Ee().box;function Pe(De){De.target===Me&&(updateTransitionEndListener(Me,"remove",Pe),Te())}if(ae===0)return Te();updateTransitionEndListener(Me,"remove",m),updateTransitionEndListener(Me,"add",Pe),m=Pe}function be(ae,Te,Me){Me===void 0&&(Me=!1);var Pe=normalizeToArray(R.props.triggerTarget||e);Pe.forEach(function(De){De.addEventListener(ae,Te,Me),v.push({node:De,eventType:ae,handler:Te,options:Me})})}function fe(){Z()&&(be("touchstart",Ne,{passive:!0}),be("touchend",Ve,{passive:!0})),splitBySpaces(R.props.trigger).forEach(function(ae){if(ae!=="manual")switch(be(ae,Ne),ae){case"mouseenter":be("mouseleave",Ve);break;case"focus":be(isIE11?"focusout":"blur",Be);break;case"focusin":be("focusout",Be);break}})}function he(){v.forEach(function(ae){var Te=ae.node,Me=ae.eventType,Pe=ae.handler,De=ae.options;Te.removeEventListener(Me,Pe,De)}),v=[]}function Ne(ae){var Te,Me=!1;if(!(!R.state.isEnabled||je(ae)||u)){var Pe=((Te=f)==null?void 0:Te.type)==="focus";f=ae,b=ae.currentTarget,xe(),!R.state.isVisible&&isMouseEvent(ae)&&mouseMoveListeners.forEach(function(De){return De(ae)}),ae.type==="click"&&(R.props.trigger.indexOf("mouseenter")<0||c)&&R.props.hideOnClick!==!1&&R.state.isVisible?Me=!0:G(ae),ae.type==="click"&&(c=!Me),Me&&!Pe&&oe(ae)}}function le(ae){var Te=ae.target,Me=ue().contains(Te)||P.contains(Te);if(!(ae.type==="mousemove"&&Me)){var Pe=F().concat(P).map(function(De){var ze,ut=De._tippy,ht=(ze=ut.popperInstance)==null?void 0:ze.state;return ht?{popperRect:De.getBoundingClientRect(),popperState:ht,props:i}:null}).filter(Boolean);isCursorOutsideInteractiveBorder(Pe,ae)&&(E(),oe(ae))}}function Ve(ae){var Te=je(ae)||R.props.trigger.indexOf("click")>=0&&c;if(!Te){if(R.props.interactive){R.hideWithInteractivity(ae);return}oe(ae)}}function Be(ae){R.props.trigger.indexOf("focusin")<0&&ae.target!==ue()||R.props.interactive&&ae.relatedTarget&&P.contains(ae.relatedTarget)||oe(ae)}function je(ae){return currentInput.isTouch?Z()!==ae.type.indexOf("touch")>=0:!1}function We(){$e();var ae=R.props,Te=ae.popperOptions,Me=ae.placement,Pe=ae.offset,De=ae.getReferenceClientRect,ze=ae.moveTransition,ut=ie()?getChildren(P).arrow:null,ht=De?{getBoundingClientRect:De,contextElement:De.contextElement||ue()}:e,yt={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(Oe){var Qe=Oe.state;if(ie()){var Xe=Ee(),et=Xe.box;["placement","reference-hidden","escaped"].forEach(function(dt){dt==="placement"?et.setAttribute("data-placement",Qe.placement):Qe.attributes.popper["data-popper-"+dt]?et.setAttribute("data-"+dt,""):et.removeAttribute("data-"+dt)}),Qe.attributes.popper={}}}},nt=[{name:"offset",options:{offset:Pe}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!ze}},yt];ie()&&ut&&nt.push({name:"arrow",options:{element:ut,padding:3}}),nt.push.apply(nt,Te?.modifiers||[]),R.popperInstance=createPopper$1(ht,P,Object.assign({},Te,{placement:Me,onFirstUpdate:g,modifiers:nt}))}function $e(){R.popperInstance&&(R.popperInstance.destroy(),R.popperInstance=null)}function H(){var ae=R.props.appendTo,Te,Me=ue();R.props.interactive&&ae===TIPPY_DEFAULT_APPEND_TO||ae==="parent"?Te=Me.parentNode:Te=invokeWithArgsOrReturn(ae,[Me]),Te.contains(P)||Te.appendChild(P),R.state.isMounted=!0,We()}function F(){return arrayFrom(P.querySelectorAll("[data-tippy-root]"))}function G(ae){R.clearDelayTimeouts(),ae&&Se("onTrigger",[R,ae]),B();var Te=pe(!0),Me=$(),Pe=Me[0],De=Me[1];currentInput.isTouch&&Pe==="hold"&&De&&(Te=De),Te?r=setTimeout(function(){R.show()},Te):R.show()}function oe(ae){if(R.clearDelayTimeouts(),Se("onUntrigger",[R,ae]),!R.state.isVisible){se();return}if(!(R.props.trigger.indexOf("mouseenter")>=0&&R.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(ae.type)>=0&&c)){var Te=pe(!1);Te?o=setTimeout(function(){R.state.isVisible&&R.hide()},Te):a=requestAnimationFrame(function(){R.hide()})}}function Q(){R.state.isEnabled=!0}function ce(){R.hide(),R.state.isEnabled=!1}function ee(){clearTimeout(r),clearTimeout(o),cancelAnimationFrame(a)}function te(ae){if(!R.state.isDestroyed){Se("onBeforeUpdate",[R,ae]),he();var Te=R.props,Me=evaluateProps(e,Object.assign({},Te,removeUndefinedProps(ae),{ignoreAttributes:!0}));R.props=Me,fe(),Te.interactiveDebounce!==Me.interactiveDebounce&&(E(),_=debounce(le,Me.interactiveDebounce)),Te.triggerTarget&&!Me.triggerTarget?normalizeToArray(Te.triggerTarget).forEach(function(Pe){Pe.removeAttribute("aria-expanded")}):Me.triggerTarget&&e.removeAttribute("aria-expanded"),xe(),me(),L&&L(Te,Me),R.popperInstance&&(We(),F().forEach(function(Pe){requestAnimationFrame(Pe._tippy.popperInstance.forceUpdate)})),Se("onAfterUpdate",[R,ae])}}function W(ae){R.setProps({content:ae})}function j(){var ae=R.state.isVisible,Te=R.state.isDestroyed,Me=!R.state.isEnabled,Pe=currentInput.isTouch&&!R.props.touch,De=getValueAtIndexOrReturn(R.props.duration,0,defaultProps.duration);if(!(ae||Te||Me||Pe)&&!ue().hasAttribute("disabled")&&(Se("onShow",[R],!1),R.props.onShow(R)!==!1)){if(R.state.isVisible=!0,ie()&&(P.style.visibility="visible"),me(),B(),R.state.isMounted||(P.style.transition="none"),ie()){var ze=Ee(),ut=ze.box,ht=ze.content;setTransitionDuration([ut,ht],0)}g=function(){var nt;if(!(!R.state.isVisible||d)){if(d=!0,P.offsetHeight,P.style.transition=R.props.moveTransition,ie()&&R.props.animation){var St=Ee(),Oe=St.box,Qe=St.content;setTransitionDuration([Oe,Qe],De),setVisibilityState([Oe,Qe],"visible")}Le(),xe(),pushIfUnique(mountedInstances,R),(nt=R.popperInstance)==null||nt.forceUpdate(),Se("onMount",[R]),R.props.animation&&ie()&&we(De,function(){R.state.isShown=!0,Se("onShown",[R])})}},H()}}function K(){var ae=!R.state.isVisible,Te=R.state.isDestroyed,Me=!R.state.isEnabled,Pe=getValueAtIndexOrReturn(R.props.duration,1,defaultProps.duration);if(!(ae||Te||Me)&&(Se("onHide",[R],!1),R.props.onHide(R)!==!1)){if(R.state.isVisible=!1,R.state.isShown=!1,d=!1,c=!1,ie()&&(P.style.visibility="hidden"),E(),se(),me(!0),ie()){var De=Ee(),ze=De.box,ut=De.content;R.props.animation&&(setTransitionDuration([ze,ut],Pe),setVisibilityState([ze,ut],"hidden"))}Le(),xe(),R.props.animation?ie()&&ye(Pe,R.unmount):R.unmount()}}function ve(ae){_e().addEventListener("mousemove",_),pushIfUnique(mouseMoveListeners,_),_(ae)}function Re(){R.state.isVisible&&R.hide(),R.state.isMounted&&($e(),F().forEach(function(ae){ae._tippy.unmount()}),P.parentNode&&P.parentNode.removeChild(P),mountedInstances=mountedInstances.filter(function(ae){return ae!==R}),R.state.isMounted=!1,Se("onHidden",[R]))}function Ie(){R.state.isDestroyed||(R.clearDelayTimeouts(),R.unmount(),he(),delete e._tippy,R.state.isDestroyed=!0,Se("onDestroy",[R]))}}function tippy(e,t){t===void 0&&(t={});var i=defaultProps.plugins.concat(t.plugins||[]);bindGlobalEventListeners();var r=Object.assign({},t,{plugins:i}),o=getArrayOfElements(e);if(0)var a,c;var u=o.reduce(function(h,d){var f=d&&createTippy(d,r);return f&&h.push(f),h},[]);return isElement(e)?u[0]:u}tippy.defaultProps=defaultProps,tippy.setDefaultProps=setDefaultProps,tippy.currentInput=currentInput;var applyStylesModifier=Object.assign({},applyStyles_default,{effect:function(t){var i=t.state,r={popper:{position:i.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(i.elements.popper.style,r.popper),i.styles=r,i.elements.arrow&&Object.assign(i.elements.arrow.style,r.arrow)}});tippy.setDefaultProps({render});var tippy_esm_default=tippy,util;(function(e){e.assertEqual=o=>o;function t(o){}e.assertIs=t;function i(o){throw new Error}e.assertNever=i,e.arrayToEnum=o=>{const a={};for(const c of o)a[c]=c;return a},e.getValidEnumValues=o=>{const a=e.objectKeys(o).filter(u=>typeof o[o[u]]!="number"),c={};for(const u of a)c[u]=o[u];return e.objectValues(c)},e.objectValues=o=>e.objectKeys(o).map(function(a){return o[a]}),e.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{const a=[];for(const c in o)Object.prototype.hasOwnProperty.call(o,c)&&a.push(c);return a},e.find=(o,a)=>{for(const c of o)if(a(c))return c},e.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&isFinite(o)&&Math.floor(o)===o;function r(o,a=" | "){return o.map(c=>typeof c=="string"?`'${c}'`:c).join(a)}e.joinValues=r,e.jsonStringifyReplacer=(o,a)=>typeof a=="bigint"?a.toString():a})(util||(util={}));var objectUtil;(function(e){e.mergeShapes=(t,i)=>({...t,...i})})(objectUtil||(objectUtil={}));const ZodParsedType=util.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),getParsedType=e=>{switch(typeof e){case"undefined":return ZodParsedType.undefined;case"string":return ZodParsedType.string;case"number":return isNaN(e)?ZodParsedType.nan:ZodParsedType.number;case"boolean":return ZodParsedType.boolean;case"function":return ZodParsedType.function;case"bigint":return ZodParsedType.bigint;case"symbol":return ZodParsedType.symbol;case"object":return Array.isArray(e)?ZodParsedType.array:e===null?ZodParsedType.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?ZodParsedType.promise:typeof Map<"u"&&e instanceof Map?ZodParsedType.map:typeof Set<"u"&&e instanceof Set?ZodParsedType.set:typeof Date<"u"&&e instanceof Date?ZodParsedType.date:ZodParsedType.object;default:return ZodParsedType.unknown}},ZodIssueCode=util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),quotelessJson=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");var ZodError=class Rs extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const i=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,i):this.__proto__=i,this.name="ZodError",this.issues=t}format(t){const i=t||function(a){return a.message},r={_errors:[]},o=a=>{for(const c of a.issues)if(c.code==="invalid_union")c.unionErrors.map(o);else if(c.code==="invalid_return_type")o(c.returnTypeError);else if(c.code==="invalid_arguments")o(c.argumentsError);else if(c.path.length===0)r._errors.push(i(c));else{let u=r,h=0;for(;h<c.path.length;){const d=c.path[h];h===c.path.length-1?(u[d]=u[d]||{_errors:[]},u[d]._errors.push(i(c))):u[d]=u[d]||{_errors:[]},u=u[d],h++}}};return o(this),r}static assert(t){if(!(t instanceof Rs))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,util.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=i=>i.message){const i={},r=[];for(const o of this.issues)o.path.length>0?(i[o.path[0]]=i[o.path[0]]||[],i[o.path[0]].push(t(o))):r.push(t(o));return{formErrors:r,fieldErrors:i}}get formErrors(){return this.flatten()}};ZodError.create=e=>new ZodError(e);const errorMap=(e,t)=>{let i;switch(e.code){case ZodIssueCode.invalid_type:e.received===ZodParsedType.undefined?i="Required":i=`Expected ${e.expected}, received ${e.received}`;break;case ZodIssueCode.invalid_literal:i=`Invalid literal value, expected ${JSON.stringify(e.expected,util.jsonStringifyReplacer)}`;break;case ZodIssueCode.unrecognized_keys:i=`Unrecognized key(s) in object: ${util.joinValues(e.keys,", ")}`;break;case ZodIssueCode.invalid_union:i="Invalid input";break;case ZodIssueCode.invalid_union_discriminator:i=`Invalid discriminator value. Expected ${util.joinValues(e.options)}`;break;case ZodIssueCode.invalid_enum_value:i=`Invalid enum value. Expected ${util.joinValues(e.options)}, received '${e.received}'`;break;case ZodIssueCode.invalid_arguments:i="Invalid function arguments";break;case ZodIssueCode.invalid_return_type:i="Invalid function return type";break;case ZodIssueCode.invalid_date:i="Invalid date";break;case ZodIssueCode.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(i=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(i=`${i} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?i=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?i=`Invalid input: must end with "${e.validation.endsWith}"`:util.assertNever(e.validation):e.validation!=="regex"?i=`Invalid ${e.validation}`:i="Invalid";break;case ZodIssueCode.too_small:e.type==="array"?i=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?i=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?i=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?i=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:i="Invalid input";break;case ZodIssueCode.too_big:e.type==="array"?i=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?i=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?i=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?i=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?i=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:i="Invalid input";break;case ZodIssueCode.custom:i="Invalid input";break;case ZodIssueCode.invalid_intersection_types:i="Intersection results could not be merged";break;case ZodIssueCode.not_multiple_of:i=`Number must be a multiple of ${e.multipleOf}`;break;case ZodIssueCode.not_finite:i="Number must be finite";break;default:i=t.defaultError,util.assertNever(e)}return{message:i}};let overrideErrorMap=errorMap;function setErrorMap(e){overrideErrorMap=e}function getErrorMap(){return overrideErrorMap}const makeIssue=e=>{const{data:t,path:i,errorMaps:r,issueData:o}=e,a=[...i,...o.path||[]],c={...o,path:a};if(o.message!==void 0)return{...o,path:a,message:o.message};let u="";const h=r.filter(d=>!!d).slice().reverse();for(const d of h)u=d(c,{data:t,defaultError:u}).message;return{...o,path:a,message:u}},EMPTY_PATH=[];function addIssueToContext(e,t){const i=getErrorMap(),r=makeIssue({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,i,i===errorMap?void 0:errorMap].filter(o=>!!o)});e.common.issues.push(r)}var ParseStatus=class Ms{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,i){const r=[];for(const o of i){if(o.status==="aborted")return INVALID;o.status==="dirty"&&t.dirty(),r.push(o.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,i){const r=[];for(const o of i){const a=await o.key,c=await o.value;r.push({key:a,value:c})}return Ms.mergeObjectSync(t,r)}static mergeObjectSync(t,i){const r={};for(const o of i){const{key:a,value:c}=o;if(a.status==="aborted"||c.status==="aborted")return INVALID;a.status==="dirty"&&t.dirty(),c.status==="dirty"&&t.dirty(),a.value!=="__proto__"&&(typeof c.value<"u"||o.alwaysSet)&&(r[a.value]=c.value)}return{status:t.value,value:r}}};const INVALID=Object.freeze({status:"aborted"}),DIRTY=e=>({status:"dirty",value:e}),OK=e=>({status:"valid",value:e}),isAborted=e=>e.status==="aborted",isDirty=e=>e.status==="dirty",isValid=e=>e.status==="valid",isAsync=e=>typeof Promise<"u"&&e instanceof Promise;function __classPrivateFieldGet(e,t,i,r){if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return i==="m"?r:i==="a"?r.call(e):r?r.value:t.get(e)}function __classPrivateFieldSet(e,t,i,r,o){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?o.call(e,i):o?o.value=i:t.set(e,i),i}var errorUtil;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t?.message})(errorUtil||(errorUtil={}));var _ZodEnum_cache,_ZodNativeEnum_cache,ParseInputLazyPath=class{constructor(e,t,i,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=i,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}};const handleResult=(e,t)=>{if(isValid(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const i=new ZodError(e.common.issues);return this._error=i,this._error}}};function processCreateParams(e){if(!e)return{};const{errorMap:t,invalid_type_error:i,required_error:r,description:o}=e;if(t&&(i||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:o}:{errorMap:(c,u)=>{var h,d;const{message:f}=e;return c.code==="invalid_enum_value"?{message:f??u.defaultError}:typeof u.data>"u"?{message:(h=f??r)!==null&&h!==void 0?h:u.defaultError}:c.code!=="invalid_type"?{message:u.defaultError}:{message:(d=f??i)!==null&&d!==void 0?d:u.defaultError}},description:o}}var ZodType=class{get description(){return this._def.description}_getType(e){return getParsedType(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:getParsedType(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ParseStatus,ctx:{common:e.parent.common,data:e.data,parsedType:getParsedType(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(isAsync(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const i=this.safeParse(e,t);if(i.success)return i.data;throw i.error}safeParse(e,t){var i;const r={common:{issues:[],async:(i=t?.async)!==null&&i!==void 0?i:!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:getParsedType(e)},o=this._parseSync({data:e,path:r.path,parent:r});return handleResult(r,o)}"~validate"(e){var t,i;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:getParsedType(e)};if(!this["~standard"].async)try{const o=this._parseSync({data:e,path:[],parent:r});return isValid(o)?{value:o.value}:{issues:r.common.issues}}catch(o){!((i=(t=o?.message)===null||t===void 0?void 0:t.toLowerCase())===null||i===void 0)&&i.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(o=>isValid(o)?{value:o.value}:{issues:r.common.issues})}async parseAsync(e,t){const i=await this.safeParseAsync(e,t);if(i.success)return i.data;throw i.error}async safeParseAsync(e,t){const i={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:getParsedType(e)},r=this._parse({data:e,path:i.path,parent:i}),o=await(isAsync(r)?r:Promise.resolve(r));return handleResult(i,o)}refine(e,t){const i=r=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(r):t;return this._refinement((r,o)=>{const a=e(r),c=()=>o.addIssue({code:ZodIssueCode.custom,...i(r)});return typeof Promise<"u"&&a instanceof Promise?a.then(u=>u?!0:(c(),!1)):a?!0:(c(),!1)})}refinement(e,t){return this._refinement((i,r)=>e(i)?!0:(r.addIssue(typeof t=="function"?t(i,r):t),!1))}_refinement(e){return new ZodEffects({schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return ZodOptional.create(this,this._def)}nullable(){return ZodNullable.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ZodArray.create(this)}promise(){return ZodPromise.create(this,this._def)}or(e){return ZodUnion.create([this,e],this._def)}and(e){return ZodIntersection.create(this,e,this._def)}transform(e){return new ZodEffects({...processCreateParams(this._def),schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new ZodDefault({...processCreateParams(this._def),innerType:this,defaultValue:t,typeName:ZodFirstPartyTypeKind.ZodDefault})}brand(){return new ZodBranded({typeName:ZodFirstPartyTypeKind.ZodBranded,type:this,...processCreateParams(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new ZodCatch({...processCreateParams(this._def),innerType:this,catchValue:t,typeName:ZodFirstPartyTypeKind.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return ZodPipeline.create(this,e)}readonly(){return ZodReadonly.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}};const cuidRegex=/^c[^\s-]{8,}$/i,cuid2Regex=/^[0-9a-z]+$/,ulidRegex=/^[0-9A-HJKMNP-TV-Z]{26}$/i,uuidRegex=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,nanoidRegex=/^[a-z0-9_-]{21}$/i,jwtRegex=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,durationRegex=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,emailRegex=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,_emojiRegex="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let emojiRegex;const ipv4Regex=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4CidrRegex=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6Regex=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,ipv6CidrRegex=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64Regex=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64urlRegex=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,dateRegexSource="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",dateRegex=new RegExp(`^${dateRegexSource}$`);function timeRegexSource(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function timeRegex(e){return new RegExp(`^${timeRegexSource(e)}$`)}function datetimeRegex(e){let t=`${dateRegexSource}T${timeRegexSource(e)}`;const i=[];return i.push(e.local?"Z?":"Z"),e.offset&&i.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${i.join("|")})`,new RegExp(`^${t}$`)}function isValidIP(e,t){return!!((t==="v4"||!t)&&ipv4Regex.test(e)||(t==="v6"||!t)&&ipv6Regex.test(e))}function isValidJWT(e,t){if(!jwtRegex.test(e))return!1;try{const[i]=e.split("."),r=i.replace(/-/g,"+").replace(/_/g,"/").padEnd(i.length+(4-i.length%4)%4,"="),o=JSON.parse(atob(r));return!(typeof o!="object"||o===null||!o.typ||!o.alg||t&&o.alg!==t)}catch{return!1}}function isValidCidr(e,t){return!!((t==="v4"||!t)&&ipv4CidrRegex.test(e)||(t==="v6"||!t)&&ipv6CidrRegex.test(e))}var ZodString=class ii extends ZodType{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==ZodParsedType.string){const a=this._getOrReturnCtx(t);return addIssueToContext(a,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.string,received:a.parsedType}),INVALID}const r=new ParseStatus;let o;for(const a of this._def.checks)if(a.kind==="min")t.data.length<a.value&&(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{code:ZodIssueCode.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="max")t.data.length>a.value&&(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{code:ZodIssueCode.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="length"){const c=t.data.length>a.value,u=t.data.length<a.value;(c||u)&&(o=this._getOrReturnCtx(t,o),c?addIssueToContext(o,{code:ZodIssueCode.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):u&&addIssueToContext(o,{code:ZodIssueCode.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),r.dirty())}else if(a.kind==="email")emailRegex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"email",code:ZodIssueCode.invalid_string,message:a.message}),r.dirty());else if(a.kind==="emoji")emojiRegex||(emojiRegex=new RegExp(_emojiRegex,"u")),emojiRegex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"emoji",code:ZodIssueCode.invalid_string,message:a.message}),r.dirty());else if(a.kind==="uuid")uuidRegex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"uuid",code:ZodIssueCode.invalid_string,message:a.message}),r.dirty());else if(a.kind==="nanoid")nanoidRegex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"nanoid",code:ZodIssueCode.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid")cuidRegex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"cuid",code:ZodIssueCode.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid2")cuid2Regex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"cuid2",code:ZodIssueCode.invalid_string,message:a.message}),r.dirty());else if(a.kind==="ulid")ulidRegex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"ulid",code:ZodIssueCode.invalid_string,message:a.message}),r.dirty());else if(a.kind==="url")try{new URL(t.data)}catch{o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"url",code:ZodIssueCode.invalid_string,message:a.message}),r.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"regex",code:ZodIssueCode.invalid_string,message:a.message}),r.dirty())):a.kind==="trim"?t.data=t.data.trim():a.kind==="includes"?t.data.includes(a.value,a.position)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{code:ZodIssueCode.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),r.dirty()):a.kind==="toLowerCase"?t.data=t.data.toLowerCase():a.kind==="toUpperCase"?t.data=t.data.toUpperCase():a.kind==="startsWith"?t.data.startsWith(a.value)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{code:ZodIssueCode.invalid_string,validation:{startsWith:a.value},message:a.message}),r.dirty()):a.kind==="endsWith"?t.data.endsWith(a.value)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{code:ZodIssueCode.invalid_string,validation:{endsWith:a.value},message:a.message}),r.dirty()):a.kind==="datetime"?datetimeRegex(a).test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{code:ZodIssueCode.invalid_string,validation:"datetime",message:a.message}),r.dirty()):a.kind==="date"?dateRegex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{code:ZodIssueCode.invalid_string,validation:"date",message:a.message}),r.dirty()):a.kind==="time"?timeRegex(a).test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{code:ZodIssueCode.invalid_string,validation:"time",message:a.message}),r.dirty()):a.kind==="duration"?durationRegex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"duration",code:ZodIssueCode.invalid_string,message:a.message}),r.dirty()):a.kind==="ip"?isValidIP(t.data,a.version)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"ip",code:ZodIssueCode.invalid_string,message:a.message}),r.dirty()):a.kind==="jwt"?isValidJWT(t.data,a.alg)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"jwt",code:ZodIssueCode.invalid_string,message:a.message}),r.dirty()):a.kind==="cidr"?isValidCidr(t.data,a.version)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"cidr",code:ZodIssueCode.invalid_string,message:a.message}),r.dirty()):a.kind==="base64"?base64Regex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"base64",code:ZodIssueCode.invalid_string,message:a.message}),r.dirty()):a.kind==="base64url"?base64urlRegex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"base64url",code:ZodIssueCode.invalid_string,message:a.message}),r.dirty()):util.assertNever(a);return{status:r.value,value:t.data}}_regex(t,i,r){return this.refinement(o=>t.test(o),{validation:i,code:ZodIssueCode.invalid_string,...errorUtil.errToObj(r)})}_addCheck(t){return new ii({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...errorUtil.errToObj(t)})}url(t){return this._addCheck({kind:"url",...errorUtil.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...errorUtil.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...errorUtil.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...errorUtil.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...errorUtil.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...errorUtil.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...errorUtil.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...errorUtil.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...errorUtil.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...errorUtil.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...errorUtil.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...errorUtil.errToObj(t)})}datetime(t){var i,r;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof t?.precision>"u"?null:t?.precision,offset:(i=t?.offset)!==null&&i!==void 0?i:!1,local:(r=t?.local)!==null&&r!==void 0?r:!1,...errorUtil.errToObj(t?.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof t?.precision>"u"?null:t?.precision,...errorUtil.errToObj(t?.message)})}duration(t){return this._addCheck({kind:"duration",...errorUtil.errToObj(t)})}regex(t,i){return this._addCheck({kind:"regex",regex:t,...errorUtil.errToObj(i)})}includes(t,i){return this._addCheck({kind:"includes",value:t,position:i?.position,...errorUtil.errToObj(i?.message)})}startsWith(t,i){return this._addCheck({kind:"startsWith",value:t,...errorUtil.errToObj(i)})}endsWith(t,i){return this._addCheck({kind:"endsWith",value:t,...errorUtil.errToObj(i)})}min(t,i){return this._addCheck({kind:"min",value:t,...errorUtil.errToObj(i)})}max(t,i){return this._addCheck({kind:"max",value:t,...errorUtil.errToObj(i)})}length(t,i){return this._addCheck({kind:"length",value:t,...errorUtil.errToObj(i)})}nonempty(t){return this.min(1,errorUtil.errToObj(t))}trim(){return new ii({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ii({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ii({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const i of this._def.checks)i.kind==="min"&&(t===null||i.value>t)&&(t=i.value);return t}get maxLength(){let t=null;for(const i of this._def.checks)i.kind==="max"&&(t===null||i.value<t)&&(t=i.value);return t}};ZodString.create=e=>{var t;return new ZodString({checks:[],typeName:ZodFirstPartyTypeKind.ZodString,coerce:(t=e?.coerce)!==null&&t!==void 0?t:!1,...processCreateParams(e)})};function floatSafeRemainder(e,t){const i=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,o=i>r?i:r,a=parseInt(e.toFixed(o).replace(".","")),c=parseInt(t.toFixed(o).replace(".",""));return a%c/Math.pow(10,o)}var ZodNumber=class _r extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==ZodParsedType.number){const a=this._getOrReturnCtx(t);return addIssueToContext(a,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.number,received:a.parsedType}),INVALID}let r;const o=new ParseStatus;for(const a of this._def.checks)a.kind==="int"?util.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),addIssueToContext(r,{code:ZodIssueCode.invalid_type,expected:"integer",received:"float",message:a.message}),o.dirty()):a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(r=this._getOrReturnCtx(t,r),addIssueToContext(r,{code:ZodIssueCode.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),o.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(r=this._getOrReturnCtx(t,r),addIssueToContext(r,{code:ZodIssueCode.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),o.dirty()):a.kind==="multipleOf"?floatSafeRemainder(t.data,a.value)!==0&&(r=this._getOrReturnCtx(t,r),addIssueToContext(r,{code:ZodIssueCode.not_multiple_of,multipleOf:a.value,message:a.message}),o.dirty()):a.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),addIssueToContext(r,{code:ZodIssueCode.not_finite,message:a.message}),o.dirty()):util.assertNever(a);return{status:o.value,value:t.data}}gte(t,i){return this.setLimit("min",t,!0,errorUtil.toString(i))}gt(t,i){return this.setLimit("min",t,!1,errorUtil.toString(i))}lte(t,i){return this.setLimit("max",t,!0,errorUtil.toString(i))}lt(t,i){return this.setLimit("max",t,!1,errorUtil.toString(i))}setLimit(t,i,r,o){return new _r({...this._def,checks:[...this._def.checks,{kind:t,value:i,inclusive:r,message:errorUtil.toString(o)}]})}_addCheck(t){return new _r({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:errorUtil.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:errorUtil.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:errorUtil.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:errorUtil.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:errorUtil.toString(t)})}multipleOf(t,i){return this._addCheck({kind:"multipleOf",value:t,message:errorUtil.toString(i)})}finite(t){return this._addCheck({kind:"finite",message:errorUtil.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:errorUtil.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:errorUtil.toString(t)})}get minValue(){let t=null;for(const i of this._def.checks)i.kind==="min"&&(t===null||i.value>t)&&(t=i.value);return t}get maxValue(){let t=null;for(const i of this._def.checks)i.kind==="max"&&(t===null||i.value<t)&&(t=i.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&util.isInteger(t.value))}get isFinite(){let t=null,i=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(i===null||r.value>i)&&(i=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(i)&&Number.isFinite(t)}};ZodNumber.create=e=>new ZodNumber({checks:[],typeName:ZodFirstPartyTypeKind.ZodNumber,coerce:e?.coerce||!1,...processCreateParams(e)});var ZodBigInt=class yr extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==ZodParsedType.bigint)return this._getInvalidInput(t);let r;const o=new ParseStatus;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(r=this._getOrReturnCtx(t,r),addIssueToContext(r,{code:ZodIssueCode.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),o.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(r=this._getOrReturnCtx(t,r),addIssueToContext(r,{code:ZodIssueCode.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),o.dirty()):a.kind==="multipleOf"?t.data%a.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),addIssueToContext(r,{code:ZodIssueCode.not_multiple_of,multipleOf:a.value,message:a.message}),o.dirty()):util.assertNever(a);return{status:o.value,value:t.data}}_getInvalidInput(t){const i=this._getOrReturnCtx(t);return addIssueToContext(i,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.bigint,received:i.parsedType}),INVALID}gte(t,i){return this.setLimit("min",t,!0,errorUtil.toString(i))}gt(t,i){return this.setLimit("min",t,!1,errorUtil.toString(i))}lte(t,i){return this.setLimit("max",t,!0,errorUtil.toString(i))}lt(t,i){return this.setLimit("max",t,!1,errorUtil.toString(i))}setLimit(t,i,r,o){return new yr({...this._def,checks:[...this._def.checks,{kind:t,value:i,inclusive:r,message:errorUtil.toString(o)}]})}_addCheck(t){return new yr({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:errorUtil.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:errorUtil.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:errorUtil.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:errorUtil.toString(t)})}multipleOf(t,i){return this._addCheck({kind:"multipleOf",value:t,message:errorUtil.toString(i)})}get minValue(){let t=null;for(const i of this._def.checks)i.kind==="min"&&(t===null||i.value>t)&&(t=i.value);return t}get maxValue(){let t=null;for(const i of this._def.checks)i.kind==="max"&&(t===null||i.value<t)&&(t=i.value);return t}};ZodBigInt.create=e=>{var t;return new ZodBigInt({checks:[],typeName:ZodFirstPartyTypeKind.ZodBigInt,coerce:(t=e?.coerce)!==null&&t!==void 0?t:!1,...processCreateParams(e)})};var ZodBoolean=class extends ZodType{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ZodParsedType.boolean){const i=this._getOrReturnCtx(e);return addIssueToContext(i,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.boolean,received:i.parsedType}),INVALID}return OK(e.data)}};ZodBoolean.create=e=>new ZodBoolean({typeName:ZodFirstPartyTypeKind.ZodBoolean,coerce:e?.coerce||!1,...processCreateParams(e)});var ZodDate=class ks extends ZodType{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==ZodParsedType.date){const a=this._getOrReturnCtx(t);return addIssueToContext(a,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.date,received:a.parsedType}),INVALID}if(isNaN(t.data.getTime())){const a=this._getOrReturnCtx(t);return addIssueToContext(a,{code:ZodIssueCode.invalid_date}),INVALID}const r=new ParseStatus;let o;for(const a of this._def.checks)a.kind==="min"?t.data.getTime()<a.value&&(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{code:ZodIssueCode.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):a.kind==="max"?t.data.getTime()>a.value&&(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{code:ZodIssueCode.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):util.assertNever(a);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new ks({...this._def,checks:[...this._def.checks,t]})}min(t,i){return this._addCheck({kind:"min",value:t.getTime(),message:errorUtil.toString(i)})}max(t,i){return this._addCheck({kind:"max",value:t.getTime(),message:errorUtil.toString(i)})}get minDate(){let t=null;for(const i of this._def.checks)i.kind==="min"&&(t===null||i.value>t)&&(t=i.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const i of this._def.checks)i.kind==="max"&&(t===null||i.value<t)&&(t=i.value);return t!=null?new Date(t):null}};ZodDate.create=e=>new ZodDate({checks:[],coerce:e?.coerce||!1,typeName:ZodFirstPartyTypeKind.ZodDate,...processCreateParams(e)});var ZodSymbol=class extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.symbol){const i=this._getOrReturnCtx(e);return addIssueToContext(i,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.symbol,received:i.parsedType}),INVALID}return OK(e.data)}};ZodSymbol.create=e=>new ZodSymbol({typeName:ZodFirstPartyTypeKind.ZodSymbol,...processCreateParams(e)});var ZodUndefined=class extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.undefined){const i=this._getOrReturnCtx(e);return addIssueToContext(i,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.undefined,received:i.parsedType}),INVALID}return OK(e.data)}};ZodUndefined.create=e=>new ZodUndefined({typeName:ZodFirstPartyTypeKind.ZodUndefined,...processCreateParams(e)});var ZodNull=class extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.null){const i=this._getOrReturnCtx(e);return addIssueToContext(i,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.null,received:i.parsedType}),INVALID}return OK(e.data)}};ZodNull.create=e=>new ZodNull({typeName:ZodFirstPartyTypeKind.ZodNull,...processCreateParams(e)});var ZodAny=class extends ZodType{constructor(){super(...arguments),this._any=!0}_parse(e){return OK(e.data)}};ZodAny.create=e=>new ZodAny({typeName:ZodFirstPartyTypeKind.ZodAny,...processCreateParams(e)});var ZodUnknown=class extends ZodType{constructor(){super(...arguments),this._unknown=!0}_parse(e){return OK(e.data)}};ZodUnknown.create=e=>new ZodUnknown({typeName:ZodFirstPartyTypeKind.ZodUnknown,...processCreateParams(e)});var ZodNever=class extends ZodType{_parse(e){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.never,received:t.parsedType}),INVALID}};ZodNever.create=e=>new ZodNever({typeName:ZodFirstPartyTypeKind.ZodNever,...processCreateParams(e)});var ZodVoid=class extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.undefined){const i=this._getOrReturnCtx(e);return addIssueToContext(i,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.void,received:i.parsedType}),INVALID}return OK(e.data)}};ZodVoid.create=e=>new ZodVoid({typeName:ZodFirstPartyTypeKind.ZodVoid,...processCreateParams(e)});var ZodArray=class Di extends ZodType{_parse(t){const{ctx:i,status:r}=this._processInputParams(t),o=this._def;if(i.parsedType!==ZodParsedType.array)return addIssueToContext(i,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:i.parsedType}),INVALID;if(o.exactLength!==null){const c=i.data.length>o.exactLength.value,u=i.data.length<o.exactLength.value;(c||u)&&(addIssueToContext(i,{code:c?ZodIssueCode.too_big:ZodIssueCode.too_small,minimum:u?o.exactLength.value:void 0,maximum:c?o.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:o.exactLength.message}),r.dirty())}if(o.minLength!==null&&i.data.length<o.minLength.value&&(addIssueToContext(i,{code:ZodIssueCode.too_small,minimum:o.minLength.value,type:"array",inclusive:!0,exact:!1,message:o.minLength.message}),r.dirty()),o.maxLength!==null&&i.data.length>o.maxLength.value&&(addIssueToContext(i,{code:ZodIssueCode.too_big,maximum:o.maxLength.value,type:"array",inclusive:!0,exact:!1,message:o.maxLength.message}),r.dirty()),i.common.async)return Promise.all([...i.data].map((c,u)=>o.type._parseAsync(new ParseInputLazyPath(i,c,i.path,u)))).then(c=>ParseStatus.mergeArray(r,c));const a=[...i.data].map((c,u)=>o.type._parseSync(new ParseInputLazyPath(i,c,i.path,u)));return ParseStatus.mergeArray(r,a)}get element(){return this._def.type}min(t,i){return new Di({...this._def,minLength:{value:t,message:errorUtil.toString(i)}})}max(t,i){return new Di({...this._def,maxLength:{value:t,message:errorUtil.toString(i)}})}length(t,i){return new Di({...this._def,exactLength:{value:t,message:errorUtil.toString(i)}})}nonempty(t){return this.min(1,t)}};ZodArray.create=(e,t)=>new ZodArray({type:e,minLength:null,maxLength:null,exactLength:null,typeName:ZodFirstPartyTypeKind.ZodArray,...processCreateParams(t)});function deepPartialify(e){if(e instanceof ZodObject){const t={};for(const i in e.shape){const r=e.shape[i];t[i]=ZodOptional.create(deepPartialify(r))}return new ZodObject({...e._def,shape:()=>t})}else return e instanceof ZodArray?new ZodArray({...e._def,type:deepPartialify(e.element)}):e instanceof ZodOptional?ZodOptional.create(deepPartialify(e.unwrap())):e instanceof ZodNullable?ZodNullable.create(deepPartialify(e.unwrap())):e instanceof ZodTuple?ZodTuple.create(e.items.map(t=>deepPartialify(t))):e}var ZodObject=class Ft extends ZodType{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),i=util.objectKeys(t);return this._cached={shape:t,keys:i}}_parse(t){if(this._getType(t)!==ZodParsedType.object){const d=this._getOrReturnCtx(t);return addIssueToContext(d,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:d.parsedType}),INVALID}const{status:r,ctx:o}=this._processInputParams(t),{shape:a,keys:c}=this._getCached(),u=[];if(!(this._def.catchall instanceof ZodNever&&this._def.unknownKeys==="strip"))for(const d in o.data)c.includes(d)||u.push(d);const h=[];for(const d of c){const f=a[d],m=o.data[d];h.push({key:{status:"valid",value:d},value:f._parse(new ParseInputLazyPath(o,m,o.path,d)),alwaysSet:d in o.data})}if(this._def.catchall instanceof ZodNever){const d=this._def.unknownKeys;if(d==="passthrough")for(const f of u)h.push({key:{status:"valid",value:f},value:{status:"valid",value:o.data[f]}});else if(d==="strict")u.length>0&&(addIssueToContext(o,{code:ZodIssueCode.unrecognized_keys,keys:u}),r.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const f of u){const m=o.data[f];h.push({key:{status:"valid",value:f},value:d._parse(new ParseInputLazyPath(o,m,o.path,f)),alwaysSet:f in o.data})}}return o.common.async?Promise.resolve().then(async()=>{const d=[];for(const f of h){const m=await f.key,g=await f.value;d.push({key:m,value:g,alwaysSet:f.alwaysSet})}return d}).then(d=>ParseStatus.mergeObjectSync(r,d)):ParseStatus.mergeObjectSync(r,h)}get shape(){return this._def.shape()}strict(t){return errorUtil.errToObj,new Ft({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(i,r)=>{var o,a,c,u;const h=(c=(a=(o=this._def).errorMap)===null||a===void 0?void 0:a.call(o,i,r).message)!==null&&c!==void 0?c:r.defaultError;return i.code==="unrecognized_keys"?{message:(u=errorUtil.errToObj(t).message)!==null&&u!==void 0?u:h}:{message:h}}}:{}})}strip(){return new Ft({...this._def,unknownKeys:"strip"})}passthrough(){return new Ft({...this._def,unknownKeys:"passthrough"})}extend(t){return new Ft({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Ft({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:ZodFirstPartyTypeKind.ZodObject})}setKey(t,i){return this.augment({[t]:i})}catchall(t){return new Ft({...this._def,catchall:t})}pick(t){const i={};return util.objectKeys(t).forEach(r=>{t[r]&&this.shape[r]&&(i[r]=this.shape[r])}),new Ft({...this._def,shape:()=>i})}omit(t){const i={};return util.objectKeys(this.shape).forEach(r=>{t[r]||(i[r]=this.shape[r])}),new Ft({...this._def,shape:()=>i})}deepPartial(){return deepPartialify(this)}partial(t){const i={};return util.objectKeys(this.shape).forEach(r=>{const o=this.shape[r];t&&!t[r]?i[r]=o:i[r]=o.optional()}),new Ft({...this._def,shape:()=>i})}required(t){const i={};return util.objectKeys(this.shape).forEach(r=>{if(t&&!t[r])i[r]=this.shape[r];else{let a=this.shape[r];for(;a instanceof ZodOptional;)a=a._def.innerType;i[r]=a}}),new Ft({...this._def,shape:()=>i})}keyof(){return createZodEnum(util.objectKeys(this.shape))}};ZodObject.create=(e,t)=>new ZodObject({shape:()=>e,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(t)}),ZodObject.strictCreate=(e,t)=>new ZodObject({shape:()=>e,unknownKeys:"strict",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(t)}),ZodObject.lazycreate=(e,t)=>new ZodObject({shape:e,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(t)});var ZodUnion=class extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),i=this._def.options;function r(o){for(const c of o)if(c.result.status==="valid")return c.result;for(const c of o)if(c.result.status==="dirty")return t.common.issues.push(...c.ctx.common.issues),c.result;const a=o.map(c=>new ZodError(c.ctx.common.issues));return addIssueToContext(t,{code:ZodIssueCode.invalid_union,unionErrors:a}),INVALID}if(t.common.async)return Promise.all(i.map(async o=>{const a={...t,common:{...t.common,issues:[]},parent:null};return{result:await o._parseAsync({data:t.data,path:t.path,parent:a}),ctx:a}})).then(r);{let o;const a=[];for(const u of i){const h={...t,common:{...t.common,issues:[]},parent:null},d=u._parseSync({data:t.data,path:t.path,parent:h});if(d.status==="valid")return d;d.status==="dirty"&&!o&&(o={result:d,ctx:h}),h.common.issues.length&&a.push(h.common.issues)}if(o)return t.common.issues.push(...o.ctx.common.issues),o.result;const c=a.map(u=>new ZodError(u));return addIssueToContext(t,{code:ZodIssueCode.invalid_union,unionErrors:c}),INVALID}}get options(){return this._def.options}};ZodUnion.create=(e,t)=>new ZodUnion({options:e,typeName:ZodFirstPartyTypeKind.ZodUnion,...processCreateParams(t)});const getDiscriminator=e=>e instanceof ZodLazy?getDiscriminator(e.schema):e instanceof ZodEffects?getDiscriminator(e.innerType()):e instanceof ZodLiteral?[e.value]:e instanceof ZodEnum?e.options:e instanceof ZodNativeEnum?util.objectValues(e.enum):e instanceof ZodDefault?getDiscriminator(e._def.innerType):e instanceof ZodUndefined?[void 0]:e instanceof ZodNull?[null]:e instanceof ZodOptional?[void 0,...getDiscriminator(e.unwrap())]:e instanceof ZodNullable?[null,...getDiscriminator(e.unwrap())]:e instanceof ZodBranded||e instanceof ZodReadonly?getDiscriminator(e.unwrap()):e instanceof ZodCatch?getDiscriminator(e._def.innerType):[];var ZodDiscriminatedUnion=class Os extends ZodType{_parse(t){const{ctx:i}=this._processInputParams(t);if(i.parsedType!==ZodParsedType.object)return addIssueToContext(i,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:i.parsedType}),INVALID;const r=this.discriminator,o=i.data[r],a=this.optionsMap.get(o);return a?i.common.async?a._parseAsync({data:i.data,path:i.path,parent:i}):a._parseSync({data:i.data,path:i.path,parent:i}):(addIssueToContext(i,{code:ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,i,r){const o=new Map;for(const a of i){const c=getDiscriminator(a.shape[t]);if(!c.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const u of c){if(o.has(u))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(u)}`);o.set(u,a)}}return new Os({typeName:ZodFirstPartyTypeKind.ZodDiscriminatedUnion,discriminator:t,options:i,optionsMap:o,...processCreateParams(r)})}};function mergeValues(e,t){const i=getParsedType(e),r=getParsedType(t);if(e===t)return{valid:!0,data:e};if(i===ZodParsedType.object&&r===ZodParsedType.object){const o=util.objectKeys(t),a=util.objectKeys(e).filter(u=>o.indexOf(u)!==-1),c={...e,...t};for(const u of a){const h=mergeValues(e[u],t[u]);if(!h.valid)return{valid:!1};c[u]=h.data}return{valid:!0,data:c}}else if(i===ZodParsedType.array&&r===ZodParsedType.array){if(e.length!==t.length)return{valid:!1};const o=[];for(let a=0;a<e.length;a++){const c=e[a],u=t[a],h=mergeValues(c,u);if(!h.valid)return{valid:!1};o.push(h.data)}return{valid:!0,data:o}}else return i===ZodParsedType.date&&r===ZodParsedType.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}var ZodIntersection=class extends ZodType{_parse(e){const{status:t,ctx:i}=this._processInputParams(e),r=(o,a)=>{if(isAborted(o)||isAborted(a))return INVALID;const c=mergeValues(o.value,a.value);return c.valid?((isDirty(o)||isDirty(a))&&t.dirty(),{status:t.value,value:c.data}):(addIssueToContext(i,{code:ZodIssueCode.invalid_intersection_types}),INVALID)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([o,a])=>r(o,a)):r(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}};ZodIntersection.create=(e,t,i)=>new ZodIntersection({left:e,right:t,typeName:ZodFirstPartyTypeKind.ZodIntersection,...processCreateParams(i)});var ZodTuple=class Ps extends ZodType{_parse(t){const{status:i,ctx:r}=this._processInputParams(t);if(r.parsedType!==ZodParsedType.array)return addIssueToContext(r,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:r.parsedType}),INVALID;if(r.data.length<this._def.items.length)return addIssueToContext(r,{code:ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),INVALID;!this._def.rest&&r.data.length>this._def.items.length&&(addIssueToContext(r,{code:ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),i.dirty());const a=[...r.data].map((c,u)=>{const h=this._def.items[u]||this._def.rest;return h?h._parse(new ParseInputLazyPath(r,c,r.path,u)):null}).filter(c=>!!c);return r.common.async?Promise.all(a).then(c=>ParseStatus.mergeArray(i,c)):ParseStatus.mergeArray(i,a)}get items(){return this._def.items}rest(t){return new Ps({...this._def,rest:t})}};ZodTuple.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ZodTuple({items:e,typeName:ZodFirstPartyTypeKind.ZodTuple,rest:null,...processCreateParams(t)})};var ZodRecord=class br extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:i,ctx:r}=this._processInputParams(t);if(r.parsedType!==ZodParsedType.object)return addIssueToContext(r,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:r.parsedType}),INVALID;const o=[],a=this._def.keyType,c=this._def.valueType;for(const u in r.data)o.push({key:a._parse(new ParseInputLazyPath(r,u,r.path,u)),value:c._parse(new ParseInputLazyPath(r,r.data[u],r.path,u)),alwaysSet:u in r.data});return r.common.async?ParseStatus.mergeObjectAsync(i,o):ParseStatus.mergeObjectSync(i,o)}get element(){return this._def.valueType}static create(t,i,r){return i instanceof ZodType?new br({keyType:t,valueType:i,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(r)}):new br({keyType:ZodString.create(),valueType:t,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(i)})}},ZodMap=class extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:i}=this._processInputParams(e);if(i.parsedType!==ZodParsedType.map)return addIssueToContext(i,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.map,received:i.parsedType}),INVALID;const r=this._def.keyType,o=this._def.valueType,a=[...i.data.entries()].map(([c,u],h)=>({key:r._parse(new ParseInputLazyPath(i,c,i.path,[h,"key"])),value:o._parse(new ParseInputLazyPath(i,u,i.path,[h,"value"]))}));if(i.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const u of a){const h=await u.key,d=await u.value;if(h.status==="aborted"||d.status==="aborted")return INVALID;(h.status==="dirty"||d.status==="dirty")&&t.dirty(),c.set(h.value,d.value)}return{status:t.value,value:c}})}else{const c=new Map;for(const u of a){const h=u.key,d=u.value;if(h.status==="aborted"||d.status==="aborted")return INVALID;(h.status==="dirty"||d.status==="dirty")&&t.dirty(),c.set(h.value,d.value)}return{status:t.value,value:c}}}};ZodMap.create=(e,t,i)=>new ZodMap({valueType:t,keyType:e,typeName:ZodFirstPartyTypeKind.ZodMap,...processCreateParams(i)});var ZodSet=class Cr extends ZodType{_parse(t){const{status:i,ctx:r}=this._processInputParams(t);if(r.parsedType!==ZodParsedType.set)return addIssueToContext(r,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.set,received:r.parsedType}),INVALID;const o=this._def;o.minSize!==null&&r.data.size<o.minSize.value&&(addIssueToContext(r,{code:ZodIssueCode.too_small,minimum:o.minSize.value,type:"set",inclusive:!0,exact:!1,message:o.minSize.message}),i.dirty()),o.maxSize!==null&&r.data.size>o.maxSize.value&&(addIssueToContext(r,{code:ZodIssueCode.too_big,maximum:o.maxSize.value,type:"set",inclusive:!0,exact:!1,message:o.maxSize.message}),i.dirty());const a=this._def.valueType;function c(h){const d=new Set;for(const f of h){if(f.status==="aborted")return INVALID;f.status==="dirty"&&i.dirty(),d.add(f.value)}return{status:i.value,value:d}}const u=[...r.data.values()].map((h,d)=>a._parse(new ParseInputLazyPath(r,h,r.path,d)));return r.common.async?Promise.all(u).then(h=>c(h)):c(u)}min(t,i){return new Cr({...this._def,minSize:{value:t,message:errorUtil.toString(i)}})}max(t,i){return new Cr({...this._def,maxSize:{value:t,message:errorUtil.toString(i)}})}size(t,i){return this.min(t,i).max(t,i)}nonempty(t){return this.min(1,t)}};ZodSet.create=(e,t)=>new ZodSet({valueType:e,minSize:null,maxSize:null,typeName:ZodFirstPartyTypeKind.ZodSet,...processCreateParams(t)});var ZodFunction=class Li extends ZodType{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:i}=this._processInputParams(t);if(i.parsedType!==ZodParsedType.function)return addIssueToContext(i,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.function,received:i.parsedType}),INVALID;function r(u,h){return makeIssue({data:u,path:i.path,errorMaps:[i.common.contextualErrorMap,i.schemaErrorMap,getErrorMap(),errorMap].filter(d=>!!d),issueData:{code:ZodIssueCode.invalid_arguments,argumentsError:h}})}function o(u,h){return makeIssue({data:u,path:i.path,errorMaps:[i.common.contextualErrorMap,i.schemaErrorMap,getErrorMap(),errorMap].filter(d=>!!d),issueData:{code:ZodIssueCode.invalid_return_type,returnTypeError:h}})}const a={errorMap:i.common.contextualErrorMap},c=i.data;if(this._def.returns instanceof ZodPromise){const u=this;return OK(async function(...h){const d=new ZodError([]),f=await u._def.args.parseAsync(h,a).catch(v=>{throw d.addIssue(r(h,v)),d}),m=await Reflect.apply(c,this,f);return await u._def.returns._def.type.parseAsync(m,a).catch(v=>{throw d.addIssue(o(m,v)),d})})}else{const u=this;return OK(function(...h){const d=u._def.args.safeParse(h,a);if(!d.success)throw new ZodError([r(h,d.error)]);const f=Reflect.apply(c,this,d.data),m=u._def.returns.safeParse(f,a);if(!m.success)throw new ZodError([o(f,m.error)]);return m.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new Li({...this._def,args:ZodTuple.create(t).rest(ZodUnknown.create())})}returns(t){return new Li({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,i,r){return new Li({args:t||ZodTuple.create([]).rest(ZodUnknown.create()),returns:i||ZodUnknown.create(),typeName:ZodFirstPartyTypeKind.ZodFunction,...processCreateParams(r)})}},ZodLazy=class extends ZodType{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};ZodLazy.create=(e,t)=>new ZodLazy({getter:e,typeName:ZodFirstPartyTypeKind.ZodLazy,...processCreateParams(t)});var ZodLiteral=class extends ZodType{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{received:t.data,code:ZodIssueCode.invalid_literal,expected:this._def.value}),INVALID}return{status:"valid",value:e.data}}get value(){return this._def.value}};ZodLiteral.create=(e,t)=>new ZodLiteral({value:e,typeName:ZodFirstPartyTypeKind.ZodLiteral,...processCreateParams(t)});function createZodEnum(e,t){return new ZodEnum({values:e,typeName:ZodFirstPartyTypeKind.ZodEnum,...processCreateParams(t)})}var ZodEnum=class Sr extends ZodType{constructor(){super(...arguments),_ZodEnum_cache.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const i=this._getOrReturnCtx(t),r=this._def.values;return addIssueToContext(i,{expected:util.joinValues(r),received:i.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(__classPrivateFieldGet(this,_ZodEnum_cache,"f")||__classPrivateFieldSet(this,_ZodEnum_cache,new Set(this._def.values),"f"),!__classPrivateFieldGet(this,_ZodEnum_cache,"f").has(t.data)){const i=this._getOrReturnCtx(t),r=this._def.values;return addIssueToContext(i,{received:i.data,code:ZodIssueCode.invalid_enum_value,options:r}),INVALID}return OK(t.data)}get options(){return this._def.values}get enum(){const t={};for(const i of this._def.values)t[i]=i;return t}get Values(){const t={};for(const i of this._def.values)t[i]=i;return t}get Enum(){const t={};for(const i of this._def.values)t[i]=i;return t}extract(t,i=this._def){return Sr.create(t,{...this._def,...i})}exclude(t,i=this._def){return Sr.create(this.options.filter(r=>!t.includes(r)),{...this._def,...i})}};_ZodEnum_cache=new WeakMap,ZodEnum.create=createZodEnum;var ZodNativeEnum=class extends ZodType{constructor(){super(...arguments),_ZodNativeEnum_cache.set(this,void 0)}_parse(e){const t=util.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(e);if(i.parsedType!==ZodParsedType.string&&i.parsedType!==ZodParsedType.number){const r=util.objectValues(t);return addIssueToContext(i,{expected:util.joinValues(r),received:i.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(__classPrivateFieldGet(this,_ZodNativeEnum_cache,"f")||__classPrivateFieldSet(this,_ZodNativeEnum_cache,new Set(util.getValidEnumValues(this._def.values)),"f"),!__classPrivateFieldGet(this,_ZodNativeEnum_cache,"f").has(e.data)){const r=util.objectValues(t);return addIssueToContext(i,{received:i.data,code:ZodIssueCode.invalid_enum_value,options:r}),INVALID}return OK(e.data)}get enum(){return this._def.values}};_ZodNativeEnum_cache=new WeakMap,ZodNativeEnum.create=(e,t)=>new ZodNativeEnum({values:e,typeName:ZodFirstPartyTypeKind.ZodNativeEnum,...processCreateParams(t)});var ZodPromise=class extends ZodType{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ZodParsedType.promise&&t.common.async===!1)return addIssueToContext(t,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.promise,received:t.parsedType}),INVALID;const i=t.parsedType===ZodParsedType.promise?t.data:Promise.resolve(t.data);return OK(i.then(r=>this._def.type.parseAsync(r,{path:t.path,errorMap:t.common.contextualErrorMap})))}};ZodPromise.create=(e,t)=>new ZodPromise({type:e,typeName:ZodFirstPartyTypeKind.ZodPromise,...processCreateParams(t)});var ZodEffects=class extends ZodType{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ZodFirstPartyTypeKind.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:i}=this._processInputParams(e),r=this._def.effect||null,o={addIssue:a=>{addIssueToContext(i,a),a.fatal?t.abort():t.dirty()},get path(){return i.path}};if(o.addIssue=o.addIssue.bind(o),r.type==="preprocess"){const a=r.transform(i.data,o);if(i.common.async)return Promise.resolve(a).then(async c=>{if(t.value==="aborted")return INVALID;const u=await this._def.schema._parseAsync({data:c,path:i.path,parent:i});return u.status==="aborted"?INVALID:u.status==="dirty"||t.value==="dirty"?DIRTY(u.value):u});{if(t.value==="aborted")return INVALID;const c=this._def.schema._parseSync({data:a,path:i.path,parent:i});return c.status==="aborted"?INVALID:c.status==="dirty"||t.value==="dirty"?DIRTY(c.value):c}}if(r.type==="refinement"){const a=c=>{const u=r.refinement(c,o);if(i.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(i.common.async===!1){const c=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return c.status==="aborted"?INVALID:(c.status==="dirty"&&t.dirty(),a(c.value),{status:t.value,value:c.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(c=>c.status==="aborted"?INVALID:(c.status==="dirty"&&t.dirty(),a(c.value).then(()=>({status:t.value,value:c.value}))))}if(r.type==="transform")if(i.common.async===!1){const a=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!isValid(a))return a;const c=r.transform(a.value,o);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:c}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(a=>isValid(a)?Promise.resolve(r.transform(a.value,o)).then(c=>({status:t.value,value:c})):a);util.assertNever(r)}};ZodEffects.create=(e,t,i)=>new ZodEffects({schema:e,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:t,...processCreateParams(i)}),ZodEffects.createWithPreprocess=(e,t,i)=>new ZodEffects({schema:t,effect:{type:"preprocess",transform:e},typeName:ZodFirstPartyTypeKind.ZodEffects,...processCreateParams(i)});var ZodOptional=class extends ZodType{_parse(e){return this._getType(e)===ZodParsedType.undefined?OK(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};ZodOptional.create=(e,t)=>new ZodOptional({innerType:e,typeName:ZodFirstPartyTypeKind.ZodOptional,...processCreateParams(t)});var ZodNullable=class extends ZodType{_parse(e){return this._getType(e)===ZodParsedType.null?OK(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};ZodNullable.create=(e,t)=>new ZodNullable({innerType:e,typeName:ZodFirstPartyTypeKind.ZodNullable,...processCreateParams(t)});var ZodDefault=class extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e);let i=t.data;return t.parsedType===ZodParsedType.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};ZodDefault.create=(e,t)=>new ZodDefault({innerType:e,typeName:ZodFirstPartyTypeKind.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...processCreateParams(t)});var ZodCatch=class extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),i={...t,common:{...t.common,issues:[]}},r=this._def.innerType._parse({data:i.data,path:i.path,parent:{...i}});return isAsync(r)?r.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new ZodError(i.common.issues)},input:i.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new ZodError(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}};ZodCatch.create=(e,t)=>new ZodCatch({innerType:e,typeName:ZodFirstPartyTypeKind.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...processCreateParams(t)});var ZodNaN=class extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.nan){const i=this._getOrReturnCtx(e);return addIssueToContext(i,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.nan,received:i.parsedType}),INVALID}return{status:"valid",value:e.data}}};ZodNaN.create=e=>new ZodNaN({typeName:ZodFirstPartyTypeKind.ZodNaN,...processCreateParams(e)});const BRAND=Symbol("zod_brand");var ZodBranded=class extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),i=t.data;return this._def.type._parse({data:i,path:t.path,parent:t})}unwrap(){return this._def.type}},ZodPipeline=class As extends ZodType{_parse(t){const{status:i,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?INVALID:a.status==="dirty"?(i.dirty(),DIRTY(a.value)):this._def.out._parseAsync({data:a.value,path:r.path,parent:r})})();{const o=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?INVALID:o.status==="dirty"?(i.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:r.path,parent:r})}}static create(t,i){return new As({in:t,out:i,typeName:ZodFirstPartyTypeKind.ZodPipeline})}},ZodReadonly=class extends ZodType{_parse(e){const t=this._def.innerType._parse(e),i=r=>(isValid(r)&&(r.value=Object.freeze(r.value)),r);return isAsync(t)?t.then(r=>i(r)):i(t)}unwrap(){return this._def.innerType}};ZodReadonly.create=(e,t)=>new ZodReadonly({innerType:e,typeName:ZodFirstPartyTypeKind.ZodReadonly,...processCreateParams(t)});function custom(e,t={},i){return e?ZodAny.create().superRefine((r,o)=>{var a,c;if(!e(r)){const u=typeof t=="function"?t(r):typeof t=="string"?{message:t}:t,h=(c=(a=u.fatal)!==null&&a!==void 0?a:i)!==null&&c!==void 0?c:!0,d=typeof u=="string"?{message:u}:u;o.addIssue({code:"custom",...d,fatal:h})}}):ZodAny.create()}const late={object:ZodObject.lazycreate};var ZodFirstPartyTypeKind;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(ZodFirstPartyTypeKind||(ZodFirstPartyTypeKind={}));const instanceOfType=(e,t={message:`Input not instance of ${e.name}`})=>custom(i=>i instanceof e,t),stringType=ZodString.create,numberType=ZodNumber.create,nanType=ZodNaN.create,bigIntType=ZodBigInt.create,booleanType=ZodBoolean.create,dateType=ZodDate.create,symbolType=ZodSymbol.create,undefinedType=ZodUndefined.create,nullType=ZodNull.create,anyType=ZodAny.create,unknownType=ZodUnknown.create,neverType=ZodNever.create,voidType=ZodVoid.create,arrayType=ZodArray.create,objectType=ZodObject.create,strictObjectType=ZodObject.strictCreate,unionType=ZodUnion.create,discriminatedUnionType=ZodDiscriminatedUnion.create,intersectionType=ZodIntersection.create,tupleType=ZodTuple.create,recordType=ZodRecord.create,mapType=ZodMap.create,setType=ZodSet.create,functionType=ZodFunction.create,lazyType=ZodLazy.create,literalType=ZodLiteral.create,enumType=ZodEnum.create,nativeEnumType=ZodNativeEnum.create,promiseType=ZodPromise.create,effectsType=ZodEffects.create,optionalType=ZodOptional.create,nullableType=ZodNullable.create,preprocessType=ZodEffects.createWithPreprocess,pipelineType=ZodPipeline.create,ostring=()=>stringType().optional(),onumber=()=>numberType().optional(),oboolean=()=>booleanType().optional(),coerce={string:e=>ZodString.create({...e,coerce:!0}),number:e=>ZodNumber.create({...e,coerce:!0}),boolean:e=>ZodBoolean.create({...e,coerce:!0}),bigint:e=>ZodBigInt.create({...e,coerce:!0}),date:e=>ZodDate.create({...e,coerce:!0})},NEVER=INVALID;var z=Object.freeze({__proto__:null,defaultErrorMap:errorMap,setErrorMap,getErrorMap,makeIssue,EMPTY_PATH,addIssueToContext,ParseStatus,INVALID,DIRTY,OK,isAborted,isDirty,isValid,isAsync,get util(){return util},get objectUtil(){return objectUtil},ZodParsedType,getParsedType,ZodType,datetimeRegex,ZodString,ZodNumber,ZodBigInt,ZodBoolean,ZodDate,ZodSymbol,ZodUndefined,ZodNull,ZodAny,ZodUnknown,ZodNever,ZodVoid,ZodArray,ZodObject,ZodUnion,ZodDiscriminatedUnion,ZodIntersection,ZodTuple,ZodRecord,ZodMap,ZodSet,ZodFunction,ZodLazy,ZodLiteral,ZodEnum,ZodNativeEnum,ZodPromise,ZodEffects,ZodTransformer:ZodEffects,ZodOptional,ZodNullable,ZodDefault,ZodCatch,ZodNaN,BRAND,ZodBranded,ZodPipeline,ZodReadonly,custom,Schema:ZodType,ZodSchema:ZodType,late,get ZodFirstPartyTypeKind(){return ZodFirstPartyTypeKind},coerce,any:anyType,array:arrayType,bigint:bigIntType,boolean:booleanType,date:dateType,discriminatedUnion:discriminatedUnionType,effect:effectsType,enum:enumType,function:functionType,instanceof:instanceOfType,intersection:intersectionType,lazy:lazyType,literal:literalType,map:mapType,nan:nanType,nativeEnum:nativeEnumType,never:neverType,null:nullType,nullable:nullableType,number:numberType,object:objectType,oboolean,onumber,optional:optionalType,ostring,pipeline:pipelineType,preprocess:preprocessType,promise:promiseType,record:recordType,set:setType,strictObject:strictObjectType,string:stringType,symbol:symbolType,transformer:effectsType,tuple:tupleType,undefined:undefinedType,union:unionType,unknown:unknownType,void:voidType,NEVER,ZodIssueCode,quotelessJson,ZodError});new Chart(ctx,{type:"bar",data:{labels:["Red","Blue","Yellow","Green","Purple","Orange"],datasets:[{label:"# of Votes",data:[12,19,3,5,2,3],borderWidth:1}]},options:{scales:{y:{beginAtZero:!0}}}});const width=640,height=400,marginTop=20,marginRight=20,marginBottom=30,marginLeft=40,x=utcTime().domain([new Date("2023-01-01"),new Date("2024-01-01")]).range([marginLeft,width-marginRight]),y=linear().domain([0,100]).range([height-marginBottom,marginTop]),svg=create_default("svg").attr("width",width).attr("height",height);svg.append("g").attr("transform",`translate(0,${height-marginBottom})`).call(axisBottom(x)),svg.append("g").attr("transform",`translate(${marginLeft},0)`).call(axisLeft(y)),container.append(svg.node());const container=document.querySelector("#example");new handsontable_default(container,{data:[["","Tesla","Volvo","Toyota","Ford"],["2019",10,11,12,13],["2020",20,11,14,13],["2021",30,15,12,13]],rowHeaders:!0,colHeaders:!0,height:"auto",autoWrapRow:!0,autoWrapCol:!0,licenseKey:"non-commercial-and-evaluation"}),DateTime.now().toString(),ClassicEditor.create(document.querySelector("#editor"),{licenseKey:"GPL",plugins:[Essentials,Bold,Italic,Font,Paragraph],toolbar:["undo","redo","|","bold","italic","|","fontSize","fontFamily","fontColor","fontBackgroundColor"]});var Todo=class{id=Math.random();title="";finished=!1;constructor(e){makeObservable(this,{title:observable,finished:observable,toggle:action}),this.title=e}toggle(){this.finished=!this.finished}};new Todo("title"),tippy_esm_default("#myButton",{content:"My tooltip!"});const mySchema=z.string();mySchema.parse("tuna");
