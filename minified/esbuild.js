var __create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__require=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),__commonJS=(e,t)=>function(){return t||(0,e[__getOwnPropNames(e)[0]])((t={exports:{}}).exports,t),t.exports},__export=(e,t)=>{for(var r in t)__defProp(e,r,{get:t[r],enumerable:!0})},__copyProps=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of __getOwnPropNames(t))!__hasOwnProp.call(e,o)&&o!==r&&__defProp(e,o,{get:()=>t[o],enumerable:!(i=__getOwnPropDesc(t,o))||i.enumerable});return e},__toESM=(e,t,r)=>(r=e!=null?__create(__getProtoOf(e)):{},__copyProps(t||!e||!e.__esModule?__defProp(r,"default",{value:e,enumerable:!0}):r,e)),require_global_this=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/global-this.js"(e,t){"use strict";var r=function(i){return i&&i.Math===Math&&i};t.exports=r(typeof globalThis=="object"&&globalThis)||r(typeof window=="object"&&window)||r(typeof self=="object"&&self)||r(typeof global=="object"&&global)||r(typeof e=="object"&&e)||function(){return this}()||Function("return this")()}}),require_fails=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/fails.js"(e,t){"use strict";t.exports=function(r){try{return!!r()}catch{return!0}}}}),require_descriptors=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/descriptors.js"(e,t){"use strict";var r=require_fails();t.exports=!r(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})}}),require_function_bind_native=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/function-bind-native.js"(e,t){"use strict";var r=require_fails();t.exports=!r(function(){var i=function(){}.bind();return typeof i!="function"||i.hasOwnProperty("prototype")})}}),require_function_call=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/function-call.js"(e,t){"use strict";var r=require_function_bind_native(),i=Function.prototype.call;t.exports=r?i.bind(i):function(){return i.apply(i,arguments)}}}),require_object_property_is_enumerable=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-property-is-enumerable.js"(e){"use strict";var t={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!t.call({1:2},1);e.f=i?function(a){var c=r(this,a);return!!c&&c.enumerable}:t}}),require_create_property_descriptor=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/create-property-descriptor.js"(e,t){"use strict";t.exports=function(r,i){return{enumerable:!(r&1),configurable:!(r&2),writable:!(r&4),value:i}}}}),require_function_uncurry_this=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/function-uncurry-this.js"(e,t){"use strict";var r=require_function_bind_native(),i=Function.prototype,o=i.call,a=r&&i.bind.bind(o,o);t.exports=r?a:function(c){return function(){return o.apply(c,arguments)}}}}),require_classof_raw=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/classof-raw.js"(e,t){"use strict";var r=require_function_uncurry_this(),i=r({}.toString),o=r("".slice);t.exports=function(a){return o(i(a),8,-1)}}}),require_indexed_object=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/indexed-object.js"(e,t){"use strict";var r=require_function_uncurry_this(),i=require_fails(),o=require_classof_raw(),a=Object,c=r("".split);t.exports=i(function(){return!a("z").propertyIsEnumerable(0)})?function(u){return o(u)==="String"?c(u,""):a(u)}:a}}),require_is_null_or_undefined=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/is-null-or-undefined.js"(e,t){"use strict";t.exports=function(r){return r==null}}}),require_require_object_coercible=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/require-object-coercible.js"(e,t){"use strict";var r=require_is_null_or_undefined(),i=TypeError;t.exports=function(o){if(r(o))throw new i("Can't call method on "+o);return o}}}),require_to_indexed_object=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/to-indexed-object.js"(e,t){"use strict";var r=require_indexed_object(),i=require_require_object_coercible();t.exports=function(o){return r(i(o))}}}),require_is_callable=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/is-callable.js"(e,t){"use strict";var r=typeof document=="object"&&document.all;t.exports=typeof r>"u"&&r!==void 0?function(i){return typeof i=="function"||i===r}:function(i){return typeof i=="function"}}}),require_is_object=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/is-object.js"(e,t){"use strict";var r=require_is_callable();t.exports=function(i){return typeof i=="object"?i!==null:r(i)}}}),require_get_built_in=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/get-built-in.js"(e,t){"use strict";var r=require_global_this(),i=require_is_callable(),o=function(a){return i(a)?a:void 0};t.exports=function(a,c){return arguments.length<2?o(r[a]):r[a]&&r[a][c]}}}),require_object_is_prototype_of=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-is-prototype-of.js"(e,t){"use strict";var r=require_function_uncurry_this();t.exports=r({}.isPrototypeOf)}}),require_environment_user_agent=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/environment-user-agent.js"(e,t){"use strict";var r=require_global_this(),i=r.navigator,o=i&&i.userAgent;t.exports=o?String(o):""}}),require_environment_v8_version=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/environment-v8-version.js"(e,t){"use strict";var r=require_global_this(),i=require_environment_user_agent(),o=r.process,a=r.Deno,c=o&&o.versions||a&&a.version,u=c&&c.v8,h,d;u&&(h=u.split("."),d=h[0]>0&&h[0]<4?1:+(h[0]+h[1])),!d&&i&&(h=i.match(/Edge\/(\d+)/),(!h||h[1]>=74)&&(h=i.match(/Chrome\/(\d+)/),h&&(d=+h[1]))),t.exports=d}}),require_symbol_constructor_detection=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/symbol-constructor-detection.js"(e,t){"use strict";var r=require_environment_v8_version(),i=require_fails(),o=require_global_this(),a=o.String;t.exports=!!Object.getOwnPropertySymbols&&!i(function(){var c=Symbol("symbol detection");return!a(c)||!(Object(c)instanceof Symbol)||!Symbol.sham&&r&&r<41})}}),require_use_symbol_as_uid=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/use-symbol-as-uid.js"(e,t){"use strict";var r=require_symbol_constructor_detection();t.exports=r&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}}),require_is_symbol=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/is-symbol.js"(e,t){"use strict";var r=require_get_built_in(),i=require_is_callable(),o=require_object_is_prototype_of(),a=require_use_symbol_as_uid(),c=Object;t.exports=a?function(u){return typeof u=="symbol"}:function(u){var h=r("Symbol");return i(h)&&o(h.prototype,c(u))}}}),require_try_to_string=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/try-to-string.js"(e,t){"use strict";var r=String;t.exports=function(i){try{return r(i)}catch{return"Object"}}}}),require_a_callable=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/a-callable.js"(e,t){"use strict";var r=require_is_callable(),i=require_try_to_string(),o=TypeError;t.exports=function(a){if(r(a))return a;throw new o(i(a)+" is not a function")}}}),require_get_method=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/get-method.js"(e,t){"use strict";var r=require_a_callable(),i=require_is_null_or_undefined();t.exports=function(o,a){var c=o[a];return i(c)?void 0:r(c)}}}),require_ordinary_to_primitive=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/ordinary-to-primitive.js"(e,t){"use strict";var r=require_function_call(),i=require_is_callable(),o=require_is_object(),a=TypeError;t.exports=function(c,u){var h,d;if(u==="string"&&i(h=c.toString)&&!o(d=r(h,c))||i(h=c.valueOf)&&!o(d=r(h,c))||u!=="string"&&i(h=c.toString)&&!o(d=r(h,c)))return d;throw new a("Can't convert object to primitive value")}}}),require_is_pure=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/is-pure.js"(e,t){"use strict";t.exports=!1}}),require_define_global_property=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/define-global-property.js"(e,t){"use strict";var r=require_global_this(),i=Object.defineProperty;t.exports=function(o,a){try{i(r,o,{value:a,configurable:!0,writable:!0})}catch{r[o]=a}return a}}}),require_shared_store=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/shared-store.js"(e,t){"use strict";var r=require_is_pure(),i=require_global_this(),o=require_define_global_property(),a="__core-js_shared__",c=t.exports=i[a]||o(a,{});(c.versions||(c.versions=[])).push({version:"3.39.0",mode:r?"pure":"global",copyright:"\xA9 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"})}}),require_shared=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/shared.js"(e,t){"use strict";var r=require_shared_store();t.exports=function(i,o){return r[i]||(r[i]=o||{})}}}),require_to_object=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/to-object.js"(e,t){"use strict";var r=require_require_object_coercible(),i=Object;t.exports=function(o){return i(r(o))}}}),require_has_own_property=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/has-own-property.js"(e,t){"use strict";var r=require_function_uncurry_this(),i=require_to_object(),o=r({}.hasOwnProperty);t.exports=Object.hasOwn||function(c,u){return o(i(c),u)}}}),require_uid=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/uid.js"(e,t){"use strict";var r=require_function_uncurry_this(),i=0,o=Math.random(),a=r(1 .toString);t.exports=function(c){return"Symbol("+(c===void 0?"":c)+")_"+a(++i+o,36)}}}),require_well_known_symbol=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/well-known-symbol.js"(e,t){"use strict";var r=require_global_this(),i=require_shared(),o=require_has_own_property(),a=require_uid(),c=require_symbol_constructor_detection(),u=require_use_symbol_as_uid(),h=r.Symbol,d=i("wks"),f=u?h.for||h:h&&h.withoutSetter||a;t.exports=function(m){return o(d,m)||(d[m]=c&&o(h,m)?h[m]:f("Symbol."+m)),d[m]}}}),require_to_primitive=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/to-primitive.js"(e,t){"use strict";var r=require_function_call(),i=require_is_object(),o=require_is_symbol(),a=require_get_method(),c=require_ordinary_to_primitive(),u=require_well_known_symbol(),h=TypeError,d=u("toPrimitive");t.exports=function(f,m){if(!i(f)||o(f))return f;var g=a(f,d),v;if(g){if(m===void 0&&(m="default"),v=r(g,f,m),!i(v)||o(v))return v;throw new h("Can't convert object to primitive value")}return m===void 0&&(m="number"),c(f,m)}}}),require_to_property_key=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/to-property-key.js"(e,t){"use strict";var r=require_to_primitive(),i=require_is_symbol();t.exports=function(o){var a=r(o,"string");return i(a)?a:a+""}}}),require_document_create_element=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/document-create-element.js"(e,t){"use strict";var r=require_global_this(),i=require_is_object(),o=r.document,a=i(o)&&i(o.createElement);t.exports=function(c){return a?o.createElement(c):{}}}}),require_ie8_dom_define=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/ie8-dom-define.js"(e,t){"use strict";var r=require_descriptors(),i=require_fails(),o=require_document_create_element();t.exports=!r&&!i(function(){return Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a!==7})}}),require_object_get_own_property_descriptor=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-get-own-property-descriptor.js"(e){"use strict";var t=require_descriptors(),r=require_function_call(),i=require_object_property_is_enumerable(),o=require_create_property_descriptor(),a=require_to_indexed_object(),c=require_to_property_key(),u=require_has_own_property(),h=require_ie8_dom_define(),d=Object.getOwnPropertyDescriptor;e.f=t?d:function(m,g){if(m=a(m),g=c(g),h)try{return d(m,g)}catch{}if(u(m,g))return o(!r(i.f,m,g),m[g])}}}),require_v8_prototype_define_bug=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/v8-prototype-define-bug.js"(e,t){"use strict";var r=require_descriptors(),i=require_fails();t.exports=r&&i(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})}}),require_an_object=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/an-object.js"(e,t){"use strict";var r=require_is_object(),i=String,o=TypeError;t.exports=function(a){if(r(a))return a;throw new o(i(a)+" is not an object")}}}),require_object_define_property=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-define-property.js"(e){"use strict";var t=require_descriptors(),r=require_ie8_dom_define(),i=require_v8_prototype_define_bug(),o=require_an_object(),a=require_to_property_key(),c=TypeError,u=Object.defineProperty,h=Object.getOwnPropertyDescriptor,d="enumerable",f="configurable",m="writable";e.f=t?i?function(v,_,b){if(o(v),_=a(_),o(b),typeof v=="function"&&_==="prototype"&&"value"in b&&m in b&&!b[m]){var S=h(v,_);S&&S[m]&&(v[_]=b.value,b={configurable:f in b?b[f]:S[f],enumerable:d in b?b[d]:S[d],writable:!1})}return u(v,_,b)}:u:function(v,_,b){if(o(v),_=a(_),o(b),r)try{return u(v,_,b)}catch{}if("get"in b||"set"in b)throw new c("Accessors not supported");return"value"in b&&(v[_]=b.value),v}}}),require_create_non_enumerable_property=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/create-non-enumerable-property.js"(e,t){"use strict";var r=require_descriptors(),i=require_object_define_property(),o=require_create_property_descriptor();t.exports=r?function(a,c,u){return i.f(a,c,o(1,u))}:function(a,c,u){return a[c]=u,a}}}),require_function_name=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/function-name.js"(e,t){"use strict";var r=require_descriptors(),i=require_has_own_property(),o=Function.prototype,a=r&&Object.getOwnPropertyDescriptor,c=i(o,"name"),u=c&&function(){}.name==="something",h=c&&(!r||r&&a(o,"name").configurable);t.exports={EXISTS:c,PROPER:u,CONFIGURABLE:h}}}),require_inspect_source=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/inspect-source.js"(e,t){"use strict";var r=require_function_uncurry_this(),i=require_is_callable(),o=require_shared_store(),a=r(Function.toString);i(o.inspectSource)||(o.inspectSource=function(c){return a(c)}),t.exports=o.inspectSource}}),require_weak_map_basic_detection=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/weak-map-basic-detection.js"(e,t){"use strict";var r=require_global_this(),i=require_is_callable(),o=r.WeakMap;t.exports=i(o)&&/native code/.test(String(o))}}),require_shared_key=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/shared-key.js"(e,t){"use strict";var r=require_shared(),i=require_uid(),o=r("keys");t.exports=function(a){return o[a]||(o[a]=i(a))}}}),require_hidden_keys=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/hidden-keys.js"(e,t){"use strict";t.exports={}}}),require_internal_state=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/internal-state.js"(e,t){"use strict";var r=require_weak_map_basic_detection(),i=require_global_this(),o=require_is_object(),a=require_create_non_enumerable_property(),c=require_has_own_property(),u=require_shared_store(),h=require_shared_key(),d=require_hidden_keys(),f="Object already initialized",m=i.TypeError,g=i.WeakMap,v,_,b,S=function(E){return b(E)?_(E):v(E,{})},R=function(E){return function(O){var P;if(!o(O)||(P=_(O)).type!==E)throw new m("Incompatible receiver, "+E+" required");return P}};r||u.state?(A=u.state||(u.state=new g),A.get=A.get,A.has=A.has,A.set=A.set,v=function(E,O){if(A.has(E))throw new m(f);return O.facade=E,A.set(E,O),O},_=function(E){return A.get(E)||{}},b=function(E){return A.has(E)}):(I=h("state"),d[I]=!0,v=function(E,O){if(c(E,I))throw new m(f);return O.facade=E,a(E,I,O),O},_=function(E){return c(E,I)?E[I]:{}},b=function(E){return c(E,I)});var A,I;t.exports={set:v,get:_,has:b,enforce:S,getterFor:R}}}),require_make_built_in=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/make-built-in.js"(e,t){"use strict";var r=require_function_uncurry_this(),i=require_fails(),o=require_is_callable(),a=require_has_own_property(),c=require_descriptors(),u=require_function_name().CONFIGURABLE,h=require_inspect_source(),d=require_internal_state(),f=d.enforce,m=d.get,g=String,v=Object.defineProperty,_=r("".slice),b=r("".replace),S=r([].join),R=c&&!i(function(){return v(function(){},"length",{value:8}).length!==8}),A=String(String).split("String"),I=t.exports=function(E,O,P){_(g(O),0,7)==="Symbol("&&(O="["+b(g(O),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),P&&P.getter&&(O="get "+O),P&&P.setter&&(O="set "+O),(!a(E,"name")||u&&E.name!==O)&&(c?v(E,"name",{value:O,configurable:!0}):E.name=O),R&&P&&a(P,"arity")&&E.length!==P.arity&&v(E,"length",{value:P.arity});try{P&&a(P,"constructor")&&P.constructor?c&&v(E,"prototype",{writable:!1}):E.prototype&&(E.prototype=void 0)}catch{}var L=f(E);return a(L,"source")||(L.source=S(A,typeof O=="string"?O:"")),E};Function.prototype.toString=I(function(){return o(this)&&m(this).source||h(this)},"toString")}}),require_define_built_in=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/define-built-in.js"(e,t){"use strict";var r=require_is_callable(),i=require_object_define_property(),o=require_make_built_in(),a=require_define_global_property();t.exports=function(c,u,h,d){d||(d={});var f=d.enumerable,m=d.name!==void 0?d.name:u;if(r(h)&&o(h,m,d),d.global)f?c[u]=h:a(u,h);else{try{d.unsafe?c[u]&&(f=!0):delete c[u]}catch{}f?c[u]=h:i.f(c,u,{value:h,enumerable:!1,configurable:!d.nonConfigurable,writable:!d.nonWritable})}return c}}}),require_math_trunc=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/math-trunc.js"(e,t){"use strict";var r=Math.ceil,i=Math.floor;t.exports=Math.trunc||function(a){var c=+a;return(c>0?i:r)(c)}}}),require_to_integer_or_infinity=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/to-integer-or-infinity.js"(e,t){"use strict";var r=require_math_trunc();t.exports=function(i){var o=+i;return o!==o||o===0?0:r(o)}}}),require_to_absolute_index=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/to-absolute-index.js"(e,t){"use strict";var r=require_to_integer_or_infinity(),i=Math.max,o=Math.min;t.exports=function(a,c){var u=r(a);return u<0?i(u+c,0):o(u,c)}}}),require_to_length=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/to-length.js"(e,t){"use strict";var r=require_to_integer_or_infinity(),i=Math.min;t.exports=function(o){var a=r(o);return a>0?i(a,9007199254740991):0}}}),require_length_of_array_like=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/length-of-array-like.js"(e,t){"use strict";var r=require_to_length();t.exports=function(i){return r(i.length)}}}),require_array_includes=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/array-includes.js"(e,t){"use strict";var r=require_to_indexed_object(),i=require_to_absolute_index(),o=require_length_of_array_like(),a=function(c){return function(u,h,d){var f=r(u),m=o(f);if(m===0)return!c&&-1;var g=i(d,m),v;if(c&&h!==h){for(;m>g;)if(v=f[g++],v!==v)return!0}else for(;m>g;g++)if((c||g in f)&&f[g]===h)return c||g||0;return!c&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}}}),require_object_keys_internal=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-keys-internal.js"(e,t){"use strict";var r=require_function_uncurry_this(),i=require_has_own_property(),o=require_to_indexed_object(),a=require_array_includes().indexOf,c=require_hidden_keys(),u=r([].push);t.exports=function(h,d){var f=o(h),m=0,g=[],v;for(v in f)!i(c,v)&&i(f,v)&&u(g,v);for(;d.length>m;)i(f,v=d[m++])&&(~a(g,v)||u(g,v));return g}}}),require_enum_bug_keys=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/enum-bug-keys.js"(e,t){"use strict";t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]}}),require_object_get_own_property_names=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-get-own-property-names.js"(e){"use strict";var t=require_object_keys_internal(),r=require_enum_bug_keys(),i=r.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(a){return t(a,i)}}}),require_object_get_own_property_symbols=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-get-own-property-symbols.js"(e){"use strict";e.f=Object.getOwnPropertySymbols}}),require_own_keys=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/own-keys.js"(e,t){"use strict";var r=require_get_built_in(),i=require_function_uncurry_this(),o=require_object_get_own_property_names(),a=require_object_get_own_property_symbols(),c=require_an_object(),u=i([].concat);t.exports=r("Reflect","ownKeys")||function(d){var f=o.f(c(d)),m=a.f;return m?u(f,m(d)):f}}}),require_copy_constructor_properties=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/copy-constructor-properties.js"(e,t){"use strict";var r=require_has_own_property(),i=require_own_keys(),o=require_object_get_own_property_descriptor(),a=require_object_define_property();t.exports=function(c,u,h){for(var d=i(u),f=a.f,m=o.f,g=0;g<d.length;g++){var v=d[g];!r(c,v)&&!(h&&r(h,v))&&f(c,v,m(u,v))}}}}),require_is_forced=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/is-forced.js"(e,t){"use strict";var r=require_fails(),i=require_is_callable(),o=/#|\.prototype\./,a=function(f,m){var g=u[c(f)];return g===d?!0:g===h?!1:i(m)?r(m):!!m},c=a.normalize=function(f){return String(f).replace(o,".").toLowerCase()},u=a.data={},h=a.NATIVE="N",d=a.POLYFILL="P";t.exports=a}}),require_export=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/export.js"(e,t){"use strict";var r=require_global_this(),i=require_object_get_own_property_descriptor().f,o=require_create_non_enumerable_property(),a=require_define_built_in(),c=require_define_global_property(),u=require_copy_constructor_properties(),h=require_is_forced();t.exports=function(d,f){var m=d.target,g=d.global,v=d.stat,_,b,S,R,A,I;if(g?b=r:v?b=r[m]||c(m,{}):b=r[m]&&r[m].prototype,b)for(S in f){if(A=f[S],d.dontCallGetSet?(I=i(b,S),R=I&&I.value):R=b[S],_=h(g?S:m+(v?".":"#")+S,d.forced),!_&&R!==void 0){if(typeof A==typeof R)continue;u(A,R)}(d.sham||R&&R.sham)&&o(A,"sham",!0),a(b,S,A,d)}}}}),require_function_apply=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/function-apply.js"(e,t){"use strict";var r=require_function_bind_native(),i=Function.prototype,o=i.apply,a=i.call;t.exports=typeof Reflect=="object"&&Reflect.apply||(r?a.bind(o):function(){return a.apply(o,arguments)})}}),require_function_uncurry_this_accessor=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/function-uncurry-this-accessor.js"(e,t){"use strict";var r=require_function_uncurry_this(),i=require_a_callable();t.exports=function(o,a,c){try{return r(i(Object.getOwnPropertyDescriptor(o,a)[c]))}catch{}}}}),require_is_possible_prototype=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/is-possible-prototype.js"(e,t){"use strict";var r=require_is_object();t.exports=function(i){return r(i)||i===null}}}),require_a_possible_prototype=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/a-possible-prototype.js"(e,t){"use strict";var r=require_is_possible_prototype(),i=String,o=TypeError;t.exports=function(a){if(r(a))return a;throw new o("Can't set "+i(a)+" as a prototype")}}}),require_object_set_prototype_of=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-set-prototype-of.js"(e,t){"use strict";var r=require_function_uncurry_this_accessor(),i=require_is_object(),o=require_require_object_coercible(),a=require_a_possible_prototype();t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var c=!1,u={},h;try{h=r(Object.prototype,"__proto__","set"),h(u,[]),c=u instanceof Array}catch{}return function(f,m){return o(f),a(m),i(f)&&(c?h(f,m):f.__proto__=m),f}}():void 0)}}),require_proxy_accessor=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/proxy-accessor.js"(e,t){"use strict";var r=require_object_define_property().f;t.exports=function(i,o,a){a in i||r(i,a,{configurable:!0,get:function(){return o[a]},set:function(c){o[a]=c}})}}}),require_inherit_if_required=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/inherit-if-required.js"(e,t){"use strict";var r=require_is_callable(),i=require_is_object(),o=require_object_set_prototype_of();t.exports=function(a,c,u){var h,d;return o&&r(h=c.constructor)&&h!==u&&i(d=h.prototype)&&d!==u.prototype&&o(a,d),a}}}),require_to_string_tag_support=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/to-string-tag-support.js"(e,t){"use strict";var r=require_well_known_symbol(),i=r("toStringTag"),o={};o[i]="z",t.exports=String(o)==="[object z]"}}),require_classof=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/classof.js"(e,t){"use strict";var r=require_to_string_tag_support(),i=require_is_callable(),o=require_classof_raw(),a=require_well_known_symbol(),c=a("toStringTag"),u=Object,h=o(function(){return arguments}())==="Arguments",d=function(f,m){try{return f[m]}catch{}};t.exports=r?o:function(f){var m,g,v;return f===void 0?"Undefined":f===null?"Null":typeof(g=d(m=u(f),c))=="string"?g:h?o(m):(v=o(m))==="Object"&&i(m.callee)?"Arguments":v}}}),require_to_string=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/to-string.js"(e,t){"use strict";var r=require_classof(),i=String;t.exports=function(o){if(r(o)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return i(o)}}}),require_normalize_string_argument=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/normalize-string-argument.js"(e,t){"use strict";var r=require_to_string();t.exports=function(i,o){return i===void 0?arguments.length<2?"":o:r(i)}}}),require_install_error_cause=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/install-error-cause.js"(e,t){"use strict";var r=require_is_object(),i=require_create_non_enumerable_property();t.exports=function(o,a){r(a)&&"cause"in a&&i(o,"cause",a.cause)}}}),require_error_stack_clear=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/error-stack-clear.js"(e,t){"use strict";var r=require_function_uncurry_this(),i=Error,o=r("".replace),a=function(h){return String(new i(h).stack)}("zxcasd"),c=/\n\s*at [^:]*:[^\n]*/,u=c.test(a);t.exports=function(h,d){if(u&&typeof h=="string"&&!i.prepareStackTrace)for(;d--;)h=o(h,c,"");return h}}}),require_error_stack_installable=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/error-stack-installable.js"(e,t){"use strict";var r=require_fails(),i=require_create_property_descriptor();t.exports=!r(function(){var o=new Error("a");return"stack"in o?(Object.defineProperty(o,"stack",i(1,7)),o.stack!==7):!0})}}),require_error_stack_install=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/error-stack-install.js"(e,t){"use strict";var r=require_create_non_enumerable_property(),i=require_error_stack_clear(),o=require_error_stack_installable(),a=Error.captureStackTrace;t.exports=function(c,u,h,d){o&&(a?a(c,u):r(c,"stack",i(h,d)))}}}),require_wrap_error_constructor_with_cause=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/wrap-error-constructor-with-cause.js"(e,t){"use strict";var r=require_get_built_in(),i=require_has_own_property(),o=require_create_non_enumerable_property(),a=require_object_is_prototype_of(),c=require_object_set_prototype_of(),u=require_copy_constructor_properties(),h=require_proxy_accessor(),d=require_inherit_if_required(),f=require_normalize_string_argument(),m=require_install_error_cause(),g=require_error_stack_install(),v=require_descriptors(),_=require_is_pure();t.exports=function(b,S,R,A){var I="stackTraceLimit",E=A?2:1,O=b.split("."),P=O[O.length-1],L=r.apply(null,O);if(L){var V=L.prototype;if(!_&&i(V,"cause")&&delete V.cause,!R)return L;var $=r("Error"),W=S(function(Z,ie){var ue=f(A?ie:Z,void 0),_e=A?new L(Z):new L;return ue!==void 0&&o(_e,"message",ue),g(_e,W,_e.stack,2),this&&a(V,this)&&d(_e,this,W),arguments.length>E&&m(_e,arguments[E]),_e});if(W.prototype=V,P!=="Error"?c?c(W,$):u(W,$,{name:!0}):v&&I in L&&(h(W,L,I),h(W,L,"prepareStackTrace")),u(W,L),!_)try{V.name!==P&&o(V,"name",P),V.constructor=W}catch{}return W}}}}),require_es_error_cause=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.error.cause.js"(){"use strict";var e=require_export(),t=require_global_this(),r=require_function_apply(),i=require_wrap_error_constructor_with_cause(),o="WebAssembly",a=t[o],c=new Error("e",{cause:7}).cause!==7,u=function(d,f){var m={};m[d]=i(d,f,c),e({global:!0,constructor:!0,arity:1,forced:c},m)},h=function(d,f){if(a&&a[d]){var m={};m[d]=i(o+"."+d,f,c),e({target:o,stat:!0,constructor:!0,arity:1,forced:c},m)}};u("Error",function(d){return function(m){return r(d,this,arguments)}}),u("EvalError",function(d){return function(m){return r(d,this,arguments)}}),u("RangeError",function(d){return function(m){return r(d,this,arguments)}}),u("ReferenceError",function(d){return function(m){return r(d,this,arguments)}}),u("SyntaxError",function(d){return function(m){return r(d,this,arguments)}}),u("TypeError",function(d){return function(m){return r(d,this,arguments)}}),u("URIError",function(d){return function(m){return r(d,this,arguments)}}),h("CompileError",function(d){return function(m){return r(d,this,arguments)}}),h("LinkError",function(d){return function(m){return r(d,this,arguments)}}),h("RuntimeError",function(d){return function(m){return r(d,this,arguments)}})}}),require_is_array=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/is-array.js"(e,t){"use strict";var r=require_classof_raw();t.exports=Array.isArray||function(o){return r(o)==="Array"}}}),require_array_set_length=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/array-set-length.js"(e,t){"use strict";var r=require_descriptors(),i=require_is_array(),o=TypeError,a=Object.getOwnPropertyDescriptor,c=r&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(u){return u instanceof TypeError}}();t.exports=c?function(u,h){if(i(u)&&!a(u,"length").writable)throw new o("Cannot set read only .length");return u.length=h}:function(u,h){return u.length=h}}}),require_does_not_exceed_safe_integer=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/does-not-exceed-safe-integer.js"(e,t){"use strict";var r=TypeError,i=9007199254740991;t.exports=function(o){if(o>i)throw r("Maximum allowed index exceeded");return o}}}),require_es_array_push=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.array.push.js"(){"use strict";var e=require_export(),t=require_to_object(),r=require_length_of_array_like(),i=require_array_set_length(),o=require_does_not_exceed_safe_integer(),a=require_fails(),c=a(function(){return[].push.call({length:4294967296},1)!==4294967297}),u=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(d){return d instanceof TypeError}},h=c||!u();e({target:"Array",proto:!0,arity:1,forced:h},{push:function(f){var m=t(this),g=r(m),v=arguments.length;o(g+v);for(var _=0;_<v;_++)m[g]=arguments[_],g++;return i(m,g),g}})}}),require_set_helpers=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-helpers.js"(e,t){"use strict";var r=require_function_uncurry_this(),i=Set.prototype;t.exports={Set,add:r(i.add),has:r(i.has),remove:r(i.delete),proto:i}}}),require_a_set=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/a-set.js"(e,t){"use strict";var r=require_set_helpers().has;t.exports=function(i){return r(i),i}}}),require_iterate_simple=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/iterate-simple.js"(e,t){"use strict";var r=require_function_call();t.exports=function(i,o,a){for(var c=a?i:i.iterator,u=i.next,h,d;!(h=r(u,c)).done;)if(d=o(h.value),d!==void 0)return d}}}),require_set_iterate=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-iterate.js"(e,t){"use strict";var r=require_function_uncurry_this(),i=require_iterate_simple(),o=require_set_helpers(),a=o.Set,c=o.proto,u=r(c.forEach),h=r(c.keys),d=h(new a).next;t.exports=function(f,m,g){return g?i({iterator:h(f),next:d},m):u(f,m)}}}),require_set_clone=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-clone.js"(e,t){"use strict";var r=require_set_helpers(),i=require_set_iterate(),o=r.Set,a=r.add;t.exports=function(c){var u=new o;return i(c,function(h){a(u,h)}),u}}}),require_set_size=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-size.js"(e,t){"use strict";var r=require_function_uncurry_this_accessor(),i=require_set_helpers();t.exports=r(i.proto,"size","get")||function(o){return o.size}}}),require_get_iterator_direct=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/get-iterator-direct.js"(e,t){"use strict";t.exports=function(r){return{iterator:r,next:r.next,done:!1}}}}),require_get_set_record=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/get-set-record.js"(e,t){"use strict";var r=require_a_callable(),i=require_an_object(),o=require_function_call(),a=require_to_integer_or_infinity(),c=require_get_iterator_direct(),u="Invalid size",h=RangeError,d=TypeError,f=Math.max,m=function(g,v){this.set=g,this.size=f(v,0),this.has=r(g.has),this.keys=r(g.keys)};m.prototype={getIterator:function(){return c(i(o(this.keys,this.set)))},includes:function(g){return o(this.has,this.set,g)}},t.exports=function(g){i(g);var v=+g.size;if(v!==v)throw new d(u);var _=a(v);if(_<0)throw new h(u);return new m(g,_)}}}),require_set_difference=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-difference.js"(e,t){"use strict";var r=require_a_set(),i=require_set_helpers(),o=require_set_clone(),a=require_set_size(),c=require_get_set_record(),u=require_set_iterate(),h=require_iterate_simple(),d=i.has,f=i.remove;t.exports=function(g){var v=r(this),_=c(g),b=o(v);return a(v)<=_.size?u(v,function(S){_.includes(S)&&f(b,S)}):h(_.getIterator(),function(S){d(v,S)&&f(b,S)}),b}}}),require_set_method_accept_set_like=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-method-accept-set-like.js"(e,t){"use strict";var r=require_get_built_in(),i=function(o){return{size:o,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}};t.exports=function(o){var a=r("Set");try{new a()[o](i(0));try{return new a()[o](i(-1)),!1}catch{return!0}}catch{return!1}}}}),require_es_set_difference_v2=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.set.difference.v2.js"(){"use strict";var e=require_export(),t=require_set_difference(),r=require_set_method_accept_set_like();e({target:"Set",proto:!0,real:!0,forced:!r("difference")},{difference:t})}}),require_set_intersection=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-intersection.js"(e,t){"use strict";var r=require_a_set(),i=require_set_helpers(),o=require_set_size(),a=require_get_set_record(),c=require_set_iterate(),u=require_iterate_simple(),h=i.Set,d=i.add,f=i.has;t.exports=function(g){var v=r(this),_=a(g),b=new h;return o(v)>_.size?u(_.getIterator(),function(S){f(v,S)&&d(b,S)}):c(v,function(S){_.includes(S)&&d(b,S)}),b}}}),require_es_set_intersection_v2=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.set.intersection.v2.js"(){"use strict";var e=require_export(),t=require_fails(),r=require_set_intersection(),i=require_set_method_accept_set_like(),o=!i("intersection")||t(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});e({target:"Set",proto:!0,real:!0,forced:o},{intersection:r})}}),require_iterator_close=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/iterator-close.js"(e,t){"use strict";var r=require_function_call(),i=require_an_object(),o=require_get_method();t.exports=function(a,c,u){var h,d;i(a);try{if(h=o(a,"return"),!h){if(c==="throw")throw u;return u}h=r(h,a)}catch(f){d=!0,h=f}if(c==="throw")throw u;if(d)throw h;return i(h),u}}}),require_set_is_disjoint_from=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-is-disjoint-from.js"(e,t){"use strict";var r=require_a_set(),i=require_set_helpers().has,o=require_set_size(),a=require_get_set_record(),c=require_set_iterate(),u=require_iterate_simple(),h=require_iterator_close();t.exports=function(f){var m=r(this),g=a(f);if(o(m)<=g.size)return c(m,function(_){if(g.includes(_))return!1},!0)!==!1;var v=g.getIterator();return u(v,function(_){if(i(m,_))return h(v,"normal",!1)})!==!1}}}),require_es_set_is_disjoint_from_v2=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.set.is-disjoint-from.v2.js"(){"use strict";var e=require_export(),t=require_set_is_disjoint_from(),r=require_set_method_accept_set_like();e({target:"Set",proto:!0,real:!0,forced:!r("isDisjointFrom")},{isDisjointFrom:t})}}),require_set_is_subset_of=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-is-subset-of.js"(e,t){"use strict";var r=require_a_set(),i=require_set_size(),o=require_set_iterate(),a=require_get_set_record();t.exports=function(u){var h=r(this),d=a(u);return i(h)>d.size?!1:o(h,function(f){if(!d.includes(f))return!1},!0)!==!1}}}),require_es_set_is_subset_of_v2=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.set.is-subset-of.v2.js"(){"use strict";var e=require_export(),t=require_set_is_subset_of(),r=require_set_method_accept_set_like();e({target:"Set",proto:!0,real:!0,forced:!r("isSubsetOf")},{isSubsetOf:t})}}),require_set_is_superset_of=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-is-superset-of.js"(e,t){"use strict";var r=require_a_set(),i=require_set_helpers().has,o=require_set_size(),a=require_get_set_record(),c=require_iterate_simple(),u=require_iterator_close();t.exports=function(d){var f=r(this),m=a(d);if(o(f)<m.size)return!1;var g=m.getIterator();return c(g,function(v){if(!i(f,v))return u(g,"normal",!1)})!==!1}}}),require_es_set_is_superset_of_v2=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.set.is-superset-of.v2.js"(){"use strict";var e=require_export(),t=require_set_is_superset_of(),r=require_set_method_accept_set_like();e({target:"Set",proto:!0,real:!0,forced:!r("isSupersetOf")},{isSupersetOf:t})}}),require_set_symmetric_difference=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-symmetric-difference.js"(e,t){"use strict";var r=require_a_set(),i=require_set_helpers(),o=require_set_clone(),a=require_get_set_record(),c=require_iterate_simple(),u=i.add,h=i.has,d=i.remove;t.exports=function(m){var g=r(this),v=a(m).getIterator(),_=o(g);return c(v,function(b){h(g,b)?d(_,b):u(_,b)}),_}}}),require_es_set_symmetric_difference_v2=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.set.symmetric-difference.v2.js"(){"use strict";var e=require_export(),t=require_set_symmetric_difference(),r=require_set_method_accept_set_like();e({target:"Set",proto:!0,real:!0,forced:!r("symmetricDifference")},{symmetricDifference:t})}}),require_set_union=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/set-union.js"(e,t){"use strict";var r=require_a_set(),i=require_set_helpers().add,o=require_set_clone(),a=require_get_set_record(),c=require_iterate_simple();t.exports=function(h){var d=r(this),f=a(h).getIterator(),m=o(d);return c(f,function(g){i(m,g)}),m}}}),require_es_set_union_v2=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.set.union.v2.js"(){"use strict";var e=require_export(),t=require_set_union(),r=require_set_method_accept_set_like();e({target:"Set",proto:!0,real:!0,forced:!r("union")},{union:t})}}),require_function_uncurry_this_clause=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/function-uncurry-this-clause.js"(e,t){"use strict";var r=require_classof_raw(),i=require_function_uncurry_this();t.exports=function(o){if(r(o)==="Function")return i(o)}}}),require_function_bind_context=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/function-bind-context.js"(e,t){"use strict";var r=require_function_uncurry_this_clause(),i=require_a_callable(),o=require_function_bind_native(),a=r(r.bind);t.exports=function(c,u){return i(c),u===void 0?c:o?a(c,u):function(){return c.apply(u,arguments)}}}}),require_html=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/html.js"(e,t){"use strict";var r=require_get_built_in();t.exports=r("document","documentElement")}}),require_array_slice=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/array-slice.js"(e,t){"use strict";var r=require_function_uncurry_this();t.exports=r([].slice)}}),require_validate_arguments_length=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/validate-arguments-length.js"(e,t){"use strict";var r=TypeError;t.exports=function(i,o){if(i<o)throw new r("Not enough arguments");return i}}}),require_environment_is_ios=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/environment-is-ios.js"(e,t){"use strict";var r=require_environment_user_agent();t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)}}),require_environment=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/environment.js"(e,t){"use strict";var r=require_global_this(),i=require_environment_user_agent(),o=require_classof_raw(),a=function(c){return i.slice(0,c.length)===c};t.exports=function(){return a("Bun/")?"BUN":a("Cloudflare-Workers")?"CLOUDFLARE":a("Deno/")?"DENO":a("Node.js/")?"NODE":r.Bun&&typeof Bun.version=="string"?"BUN":r.Deno&&typeof Deno.version=="object"?"DENO":o(r.process)==="process"?"NODE":r.window&&r.document?"BROWSER":"REST"}()}}),require_environment_is_node=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/environment-is-node.js"(e,t){"use strict";var r=require_environment();t.exports=r==="NODE"}}),require_task=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/task.js"(e,t){"use strict";var r=require_global_this(),i=require_function_apply(),o=require_function_bind_context(),a=require_is_callable(),c=require_has_own_property(),u=require_fails(),h=require_html(),d=require_array_slice(),f=require_document_create_element(),m=require_validate_arguments_length(),g=require_environment_is_ios(),v=require_environment_is_node(),_=r.setImmediate,b=r.clearImmediate,S=r.process,R=r.Dispatch,A=r.Function,I=r.MessageChannel,E=r.String,O=0,P={},L="onreadystatechange",V,$,W,Z;u(function(){V=r.location});var ie=function(pe){if(c(P,pe)){var me=P[pe];delete P[pe],me()}},ue=function(pe){return function(){ie(pe)}},_e=function(pe){ie(pe.data)},Te=function(pe){r.postMessage(E(pe),V.protocol+"//"+V.host)};(!_||!b)&&(_=function(me){m(arguments.length,1);var Se=a(me)?me:A(me),Le=d(arguments,1);return P[++O]=function(){i(Se,void 0,Le)},$(O),O},b=function(me){delete P[me]},v?$=function(pe){S.nextTick(ue(pe))}:R&&R.now?$=function(pe){R.now(ue(pe))}:I&&!g?(W=new I,Z=W.port2,W.port1.onmessage=_e,$=o(Z.postMessage,Z)):r.addEventListener&&a(r.postMessage)&&!r.importScripts&&V&&V.protocol!=="file:"&&!u(Te)?($=Te,r.addEventListener("message",_e,!1)):L in f("script")?$=function(pe){h.appendChild(f("script"))[L]=function(){h.removeChild(this),ie(pe)}}:$=function(pe){setTimeout(ue(pe),0)}),t.exports={set:_,clear:b}}}),require_web_clear_immediate=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/web.clear-immediate.js"(){"use strict";var e=require_export(),t=require_global_this(),r=require_task().clear;e({global:!0,bind:!0,enumerable:!0,forced:t.clearImmediate!==r},{clearImmediate:r})}}),require_schedulers_fix=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/schedulers-fix.js"(e,t){"use strict";var r=require_global_this(),i=require_function_apply(),o=require_is_callable(),a=require_environment(),c=require_environment_user_agent(),u=require_array_slice(),h=require_validate_arguments_length(),d=r.Function,f=/MSIE .\./.test(c)||a==="BUN"&&function(){var m=r.Bun.version.split(".");return m.length<3||m[0]==="0"&&(m[1]<3||m[1]==="3"&&m[2]==="0")}();t.exports=function(m,g){var v=g?2:1;return f?function(_,b){var S=h(arguments.length,1)>v,R=o(_)?_:d(_),A=S?u(arguments,v):[],I=S?function(){i(R,this,A)}:R;return g?m(I,b):m(I)}:m}}}),require_web_set_immediate=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/web.set-immediate.js"(){"use strict";var e=require_export(),t=require_global_this(),r=require_task().set,i=require_schedulers_fix(),o=t.setImmediate?i(r,!1):r;e({global:!0,bind:!0,enumerable:!0,forced:t.setImmediate!==o},{setImmediate:o})}}),require_web_immediate=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/web.immediate.js"(){"use strict";require_web_clear_immediate(),require_web_set_immediate()}}),require_purify=__commonJS({"node_modules/.pnpm/dompurify@2.5.8/node_modules/dompurify/dist/purify.js"(e,t){(function(r,i){typeof e=="object"&&typeof t<"u"?t.exports=i():typeof define=="function"&&define.amd?define(i):(r=typeof globalThis<"u"?globalThis:r||self,r.DOMPurify=i())})(e,function(){"use strict";function r(j){"@babel/helpers - typeof";return r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(U){return typeof U}:function(U){return U&&typeof Symbol=="function"&&U.constructor===Symbol&&U!==Symbol.prototype?"symbol":typeof U},r(j)}function i(j,U){return i=Object.setPrototypeOf||function(ve,Re){return ve.__proto__=Re,ve},i(j,U)}function o(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function a(j,U,K){return o()?a=Reflect.construct:a=function(Re,Ie,ae){var Ee=[null];Ee.push.apply(Ee,Ie);var Me=Function.bind.apply(Re,Ee),Pe=new Me;return ae&&i(Pe,ae.prototype),Pe},a.apply(null,arguments)}function c(j){return u(j)||h(j)||d(j)||m()}function u(j){if(Array.isArray(j))return f(j)}function h(j){if(typeof Symbol<"u"&&j[Symbol.iterator]!=null||j["@@iterator"]!=null)return Array.from(j)}function d(j,U){if(j){if(typeof j=="string")return f(j,U);var K=Object.prototype.toString.call(j).slice(8,-1);if(K==="Object"&&j.constructor&&(K=j.constructor.name),K==="Map"||K==="Set")return Array.from(j);if(K==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(K))return f(j,U)}}function f(j,U){(U==null||U>j.length)&&(U=j.length);for(var K=0,ve=new Array(U);K<U;K++)ve[K]=j[K];return ve}function m(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g=Object.hasOwnProperty,v=Object.setPrototypeOf,_=Object.isFrozen,b=Object.getPrototypeOf,S=Object.getOwnPropertyDescriptor,R=Object.freeze,A=Object.seal,I=Object.create,E=typeof Reflect<"u"&&Reflect,O=E.apply,P=E.construct;O||(O=function(U,K,ve){return U.apply(K,ve)}),R||(R=function(U){return U}),A||(A=function(U){return U}),P||(P=function(U,K){return a(U,c(K))});var L=Se(Array.prototype.forEach),V=Se(Array.prototype.pop),$=Se(Array.prototype.push),W=Se(String.prototype.toLowerCase),Z=Se(String.prototype.toString),ie=Se(String.prototype.match),ue=Se(String.prototype.replace),_e=Se(String.prototype.indexOf),Te=Se(String.prototype.trim),pe=Se(RegExp.prototype.test),me=Le(TypeError);function Se(j){return function(U){for(var K=arguments.length,ve=new Array(K>1?K-1:0),Re=1;Re<K;Re++)ve[Re-1]=arguments[Re];return O(j,U,ve)}}function Le(j){return function(){for(var U=arguments.length,K=new Array(U),ve=0;ve<U;ve++)K[ve]=arguments[ve];return P(j,K)}}function xe(j,U,K){var ve;K=(ve=K)!==null&&ve!==void 0?ve:W,v&&v(j,null);for(var Re=U.length;Re--;){var Ie=U[Re];if(typeof Ie=="string"){var ae=K(Ie);ae!==Ie&&(_(U)||(U[Re]=ae),Ie=ae)}j[Ie]=!0}return j}function T(j){var U=I(null),K;for(K in j)O(g,j,[K])===!0&&(U[K]=j[K]);return U}function k(j,U){for(;j!==null;){var K=S(j,U);if(K){if(K.get)return Se(K.get);if(typeof K.value=="function")return Se(K.value)}j=b(j)}function ve(Re){return console.warn("fallback value for",Re),null}return ve}var D=R(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),q=R(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),B=R(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),se=R(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ye=R(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),we=R(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),de=R(["#text"]),be=R(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),fe=R(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),he=R(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ne=R(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),le=A(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ve=A(/<%[\w\W]*|[\w\W]*%>/gm),Be=A(/\${[\w\W]*}/gm),Ue=A(/^data-[\-\w.\u00B7-\uFFFF]+$/),je=A(/^aria-[\-\w]+$/),We=A(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),H=A(/^(?:\w+script|data):/i),F=A(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),G=A(/^html$/i),oe=A(/^[a-z][.\w]*(-[.\w]+)+$/i),Q=function(){return typeof window>"u"?null:window},ce=function(U,K){if(r(U)!=="object"||typeof U.createPolicy!="function")return null;var ve=null,Re="data-tt-policy-suffix";K.currentScript&&K.currentScript.hasAttribute(Re)&&(ve=K.currentScript.getAttribute(Re));var Ie="dompurify"+(ve?"#"+ve:"");try{return U.createPolicy(Ie,{createHTML:function(Ee){return Ee},createScriptURL:function(Ee){return Ee}})}catch{return console.warn("TrustedTypes policy "+Ie+" could not be created."),null}};function ee(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Q(),U=function(ne){return ee(ne)};if(U.version="2.5.8",U.removed=[],!j||!j.document||j.document.nodeType!==9)return U.isSupported=!1,U;var K=j.document,ve=j.document,Re=j.DocumentFragment,Ie=j.HTMLTemplateElement,ae=j.Node,Ee=j.Element,Me=j.NodeFilter,Pe=j.NamedNodeMap,De=Pe===void 0?j.NamedNodeMap||j.MozNamedAttrMap:Pe,$e=j.HTMLFormElement,ut=j.DOMParser,ht=j.trustedTypes,yt=Ee.prototype,rt=k(yt,"cloneNode"),St=k(yt,"nextSibling"),Oe=k(yt,"childNodes"),Qe=k(yt,"parentNode");if(typeof Ie=="function"){var Xe=ve.createElement("template");Xe.content&&Xe.content.ownerDocument&&(ve=Xe.content.ownerDocument)}var et=ce(ht,K),dt=et?et.createHTML(""):"",Ye=ve,hr=Ye.implementation,Je=Ye.createNodeIterator,dr=Ye.createDocumentFragment,Hn=Ye.getElementsByTagName,Cr=K.importNode,vt={};try{vt=T(ve).documentMode?ve.documentMode:{}}catch{}var mt={};U.isSupported=typeof Qe=="function"&&hr&&hr.createHTMLDocument!==void 0&&vt!==9;var Rt=le,lt=Ve,Et=Be,It=Ue,Wt=je,Fn=H,nn=F,fr=oe,Sr=We,gt=null,jt=xe({},[].concat(c(D),c(q),c(B),c(ye),c(de))),nt=null,Dr=xe({},[].concat(c(be),c(fe),c(he),c(Ne))),ct=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),mr=null,Lr=null,it=!0,gr=!0,sn=!1,Hr=!0,Ut=!1,Fr=!0,zt=!1,Vr=!1,Br=!1,er=!1,Tr=!1,pr=!1,Wr=!0,on=!1,Vn="user-content-",jr=!0,tr=!1,rr={},Pt=null,vr=xe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ur=null,nr=xe({},["audio","video","img","source","image","track"]),Ot=null,an=xe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Er="http://www.w3.org/1998/Math/MathML",xr="http://www.w3.org/2000/svg",Nt="http://www.w3.org/1999/xhtml",ir=Nt,zr=!1,$r=null,Bn=xe({},[Er,xr,Nt],Z),Dt,Wn=["application/xhtml+xml","text/html"],ln="text/html",pt,sr=null,jn=ve.createElement("form"),cn=function(ne){return ne instanceof RegExp||ne instanceof Function},Yr=function(ne){sr&&sr===ne||((!ne||r(ne)!=="object")&&(ne={}),ne=T(ne),Dt=Wn.indexOf(ne.PARSER_MEDIA_TYPE)===-1?Dt=ln:Dt=ne.PARSER_MEDIA_TYPE,pt=Dt==="application/xhtml+xml"?Z:W,gt="ALLOWED_TAGS"in ne?xe({},ne.ALLOWED_TAGS,pt):jt,nt="ALLOWED_ATTR"in ne?xe({},ne.ALLOWED_ATTR,pt):Dr,$r="ALLOWED_NAMESPACES"in ne?xe({},ne.ALLOWED_NAMESPACES,Z):Bn,Ot="ADD_URI_SAFE_ATTR"in ne?xe(T(an),ne.ADD_URI_SAFE_ATTR,pt):an,Ur="ADD_DATA_URI_TAGS"in ne?xe(T(nr),ne.ADD_DATA_URI_TAGS,pt):nr,Pt="FORBID_CONTENTS"in ne?xe({},ne.FORBID_CONTENTS,pt):vr,mr="FORBID_TAGS"in ne?xe({},ne.FORBID_TAGS,pt):{},Lr="FORBID_ATTR"in ne?xe({},ne.FORBID_ATTR,pt):{},rr="USE_PROFILES"in ne?ne.USE_PROFILES:!1,it=ne.ALLOW_ARIA_ATTR!==!1,gr=ne.ALLOW_DATA_ATTR!==!1,sn=ne.ALLOW_UNKNOWN_PROTOCOLS||!1,Hr=ne.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ut=ne.SAFE_FOR_TEMPLATES||!1,Fr=ne.SAFE_FOR_XML!==!1,zt=ne.WHOLE_DOCUMENT||!1,er=ne.RETURN_DOM||!1,Tr=ne.RETURN_DOM_FRAGMENT||!1,pr=ne.RETURN_TRUSTED_TYPE||!1,Br=ne.FORCE_BODY||!1,Wr=ne.SANITIZE_DOM!==!1,on=ne.SANITIZE_NAMED_PROPS||!1,jr=ne.KEEP_CONTENT!==!1,tr=ne.IN_PLACE||!1,Sr=ne.ALLOWED_URI_REGEXP||Sr,ir=ne.NAMESPACE||Nt,ct=ne.CUSTOM_ELEMENT_HANDLING||{},ne.CUSTOM_ELEMENT_HANDLING&&cn(ne.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ct.tagNameCheck=ne.CUSTOM_ELEMENT_HANDLING.tagNameCheck),ne.CUSTOM_ELEMENT_HANDLING&&cn(ne.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ct.attributeNameCheck=ne.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),ne.CUSTOM_ELEMENT_HANDLING&&typeof ne.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ct.allowCustomizedBuiltInElements=ne.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ut&&(gr=!1),Tr&&(er=!0),rr&&(gt=xe({},c(de)),nt=[],rr.html===!0&&(xe(gt,D),xe(nt,be)),rr.svg===!0&&(xe(gt,q),xe(nt,fe),xe(nt,Ne)),rr.svgFilters===!0&&(xe(gt,B),xe(nt,fe),xe(nt,Ne)),rr.mathMl===!0&&(xe(gt,ye),xe(nt,he),xe(nt,Ne))),ne.ADD_TAGS&&(gt===jt&&(gt=T(gt)),xe(gt,ne.ADD_TAGS,pt)),ne.ADD_ATTR&&(nt===Dr&&(nt=T(nt)),xe(nt,ne.ADD_ATTR,pt)),ne.ADD_URI_SAFE_ATTR&&xe(Ot,ne.ADD_URI_SAFE_ATTR,pt),ne.FORBID_CONTENTS&&(Pt===vr&&(Pt=T(Pt)),xe(Pt,ne.FORBID_CONTENTS,pt)),jr&&(gt["#text"]=!0),zt&&xe(gt,["html","head","body"]),gt.table&&(xe(gt,["tbody"]),delete mr.tbody),R&&R(ne),sr=ne)},un=xe({},["mi","mo","mn","ms","mtext"]),hn=xe({},["annotation-xml"]),Un=xe({},["title","style","font","a","script"]),Rr=xe({},q);xe(Rr,B),xe(Rr,se);var Gr=xe({},ye);xe(Gr,we);var zn=function(ne){var Ce=Qe(ne);(!Ce||!Ce.tagName)&&(Ce={namespaceURI:ir,tagName:"template"});var Ae=W(ne.tagName),Ge=W(Ce.tagName);return $r[ne.namespaceURI]?ne.namespaceURI===xr?Ce.namespaceURI===Nt?Ae==="svg":Ce.namespaceURI===Er?Ae==="svg"&&(Ge==="annotation-xml"||un[Ge]):!!Rr[Ae]:ne.namespaceURI===Er?Ce.namespaceURI===Nt?Ae==="math":Ce.namespaceURI===xr?Ae==="math"&&hn[Ge]:!!Gr[Ae]:ne.namespaceURI===Nt?Ce.namespaceURI===xr&&!hn[Ge]||Ce.namespaceURI===Er&&!un[Ge]?!1:!Gr[Ae]&&(Un[Ae]||!Rr[Ae]):!!(Dt==="application/xhtml+xml"&&$r[ne.namespaceURI]):!1},Mt=function(ne){$(U.removed,{element:ne});try{ne.parentNode.removeChild(ne)}catch{try{ne.outerHTML=dt}catch{ne.remove()}}},Mr=function(ne,Ce){try{$(U.removed,{attribute:Ce.getAttributeNode(ne),from:Ce})}catch{$(U.removed,{attribute:null,from:Ce})}if(Ce.removeAttribute(ne),ne==="is"&&!nt[ne])if(er||Tr)try{Mt(Ce)}catch{}else try{Ce.setAttribute(ne,"")}catch{}},dn=function(ne){var Ce,Ae;if(Br)ne="<remove></remove>"+ne;else{var Ge=ie(ne,/^[\r\n\t ]+/);Ae=Ge&&Ge[0]}Dt==="application/xhtml+xml"&&ir===Nt&&(ne='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+ne+"</body></html>");var Tt=et?et.createHTML(ne):ne;if(ir===Nt)try{Ce=new ut().parseFromString(Tt,Dt)}catch{}if(!Ce||!Ce.documentElement){Ce=hr.createDocument(ir,"template",null);try{Ce.documentElement.innerHTML=zr?dt:Tt}catch{}}var wt=Ce.body||Ce.documentElement;return ne&&Ae&&wt.insertBefore(ve.createTextNode(Ae),wt.childNodes[0]||null),ir===Nt?Hn.call(Ce,zt?"html":"body")[0]:zt?Ce.documentElement:wt},fn=function(ne){return Je.call(ne.ownerDocument||ne,ne,Me.SHOW_ELEMENT|Me.SHOW_COMMENT|Me.SHOW_TEXT|Me.SHOW_PROCESSING_INSTRUCTION|Me.SHOW_CDATA_SECTION,null,!1)},wr=function(ne){return ne instanceof $e&&(typeof ne.nodeName!="string"||typeof ne.textContent!="string"||typeof ne.removeChild!="function"||!(ne.attributes instanceof De)||typeof ne.removeAttribute!="function"||typeof ne.setAttribute!="function"||typeof ne.namespaceURI!="string"||typeof ne.insertBefore!="function"||typeof ne.hasChildNodes!="function")},$t=function(ne){return r(ae)==="object"?ne instanceof ae:ne&&r(ne)==="object"&&typeof ne.nodeType=="number"&&typeof ne.nodeName=="string"},Lt=function(ne,Ce,Ae){mt[ne]&&L(mt[ne],function(Ge){Ge.call(U,Ce,Ae,sr)})},qr=function(ne){var Ce;if(Lt("beforeSanitizeElements",ne,null),wr(ne)||pe(/[\u0080-\uFFFF]/,ne.nodeName))return Mt(ne),!0;var Ae=pt(ne.nodeName);if(Lt("uponSanitizeElement",ne,{tagName:Ae,allowedTags:gt}),ne.hasChildNodes()&&!$t(ne.firstElementChild)&&(!$t(ne.content)||!$t(ne.content.firstElementChild))&&pe(/<[/\w]/g,ne.innerHTML)&&pe(/<[/\w]/g,ne.textContent)||Ae==="select"&&pe(/<template/i,ne.innerHTML)||ne.nodeType===7||Fr&&ne.nodeType===8&&pe(/<[/\w]/g,ne.data))return Mt(ne),!0;if(!gt[Ae]||mr[Ae]){if(!mr[Ae]&&mn(Ae)&&(ct.tagNameCheck instanceof RegExp&&pe(ct.tagNameCheck,Ae)||ct.tagNameCheck instanceof Function&&ct.tagNameCheck(Ae)))return!1;if(jr&&!Pt[Ae]){var Ge=Qe(ne)||ne.parentNode,Tt=Oe(ne)||ne.childNodes;if(Tt&&Ge)for(var wt=Tt.length,_t=wt-1;_t>=0;--_t){var Yt=rt(Tt[_t],!0);Yt.__removalCount=(ne.__removalCount||0)+1,Ge.insertBefore(Yt,St(ne))}}return Mt(ne),!0}return ne instanceof Ee&&!zn(ne)||(Ae==="noscript"||Ae==="noembed"||Ae==="noframes")&&pe(/<\/no(script|embed|frames)/i,ne.innerHTML)?(Mt(ne),!0):(Ut&&ne.nodeType===3&&(Ce=ne.textContent,Ce=ue(Ce,Rt," "),Ce=ue(Ce,lt," "),Ce=ue(Ce,Et," "),ne.textContent!==Ce&&($(U.removed,{element:ne.cloneNode()}),ne.textContent=Ce)),Lt("afterSanitizeElements",ne,null),!1)},Kr=function(ne,Ce,Ae){if(Wr&&(Ce==="id"||Ce==="name")&&(Ae in ve||Ae in jn))return!1;if(!(gr&&!Lr[Ce]&&pe(It,Ce))){if(!(it&&pe(Wt,Ce))){if(!nt[Ce]||Lr[Ce]){if(!(mn(ne)&&(ct.tagNameCheck instanceof RegExp&&pe(ct.tagNameCheck,ne)||ct.tagNameCheck instanceof Function&&ct.tagNameCheck(ne))&&(ct.attributeNameCheck instanceof RegExp&&pe(ct.attributeNameCheck,Ce)||ct.attributeNameCheck instanceof Function&&ct.attributeNameCheck(Ce))||Ce==="is"&&ct.allowCustomizedBuiltInElements&&(ct.tagNameCheck instanceof RegExp&&pe(ct.tagNameCheck,Ae)||ct.tagNameCheck instanceof Function&&ct.tagNameCheck(Ae))))return!1}else if(!Ot[Ce]){if(!pe(Sr,ue(Ae,nn,""))){if(!((Ce==="src"||Ce==="xlink:href"||Ce==="href")&&ne!=="script"&&_e(Ae,"data:")===0&&Ur[ne])){if(!(sn&&!pe(Fn,ue(Ae,nn,"")))){if(Ae)return!1}}}}}}return!0},mn=function(ne){return ne!=="annotation-xml"&&ie(ne,fr)},gn=function(ne){var Ce,Ae,Ge,Tt;Lt("beforeSanitizeAttributes",ne,null);var wt=ne.attributes;if(!(!wt||wr(ne))){var _t={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:nt};for(Tt=wt.length;Tt--;){Ce=wt[Tt];var Yt=Ce,st=Yt.name,At=Yt.namespaceURI;if(Ae=st==="value"?Ce.value:Te(Ce.value),Ge=pt(st),_t.attrName=Ge,_t.attrValue=Ae,_t.keepAttr=!0,_t.forceKeepAttr=void 0,Lt("uponSanitizeAttribute",ne,_t),Ae=_t.attrValue,!_t.forceKeepAttr&&(Mr(st,ne),!!_t.keepAttr)){if(!Hr&&pe(/\/>/i,Ae)){Mr(st,ne);continue}Ut&&(Ae=ue(Ae,Rt," "),Ae=ue(Ae,lt," "),Ae=ue(Ae,Et," "));var kr=pt(ne.nodeName);if(Kr(kr,Ge,Ae)){if(on&&(Ge==="id"||Ge==="name")&&(Mr(st,ne),Ae=Vn+Ae),Fr&&pe(/((--!?|])>)|<\/(style|title)/i,Ae)){Mr(st,ne);continue}if(et&&r(ht)==="object"&&typeof ht.getAttributeType=="function"&&!At)switch(ht.getAttributeType(kr,Ge)){case"TrustedHTML":{Ae=et.createHTML(Ae);break}case"TrustedScriptURL":{Ae=et.createScriptURL(Ae);break}}try{At?ne.setAttributeNS(At,st,Ae):ne.setAttribute(st,Ae),wr(ne)?Mt(ne):V(U.removed)}catch{}}}}Lt("afterSanitizeAttributes",ne,null)}},$n=function Fe(ne){var Ce,Ae=fn(ne);for(Lt("beforeSanitizeShadowDOM",ne,null);Ce=Ae.nextNode();)Lt("uponSanitizeShadowNode",Ce,null),qr(Ce),gn(Ce),Ce.content instanceof Re&&Fe(Ce.content);Lt("afterSanitizeShadowDOM",ne,null)};return U.sanitize=function(Fe){var ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ce,Ae,Ge,Tt,wt;if(zr=!Fe,zr&&(Fe="<!-->"),typeof Fe!="string"&&!$t(Fe))if(typeof Fe.toString=="function"){if(Fe=Fe.toString(),typeof Fe!="string")throw me("dirty is not a string, aborting")}else throw me("toString is not a function");if(!U.isSupported){if(r(j.toStaticHTML)==="object"||typeof j.toStaticHTML=="function"){if(typeof Fe=="string")return j.toStaticHTML(Fe);if($t(Fe))return j.toStaticHTML(Fe.outerHTML)}return Fe}if(Vr||Yr(ne),U.removed=[],typeof Fe=="string"&&(tr=!1),tr){if(Fe.nodeName){var _t=pt(Fe.nodeName);if(!gt[_t]||mr[_t])throw me("root node is forbidden and cannot be sanitized in-place")}}else if(Fe instanceof ae)Ce=dn("<!---->"),Ae=Ce.ownerDocument.importNode(Fe,!0),Ae.nodeType===1&&Ae.nodeName==="BODY"||Ae.nodeName==="HTML"?Ce=Ae:Ce.appendChild(Ae);else{if(!er&&!Ut&&!zt&&Fe.indexOf("<")===-1)return et&&pr?et.createHTML(Fe):Fe;if(Ce=dn(Fe),!Ce)return er?null:pr?dt:""}Ce&&Br&&Mt(Ce.firstChild);for(var Yt=fn(tr?Fe:Ce);Ge=Yt.nextNode();)Ge.nodeType===3&&Ge===Tt||(qr(Ge),gn(Ge),Ge.content instanceof Re&&$n(Ge.content),Tt=Ge);if(Tt=null,tr)return Fe;if(er){if(Tr)for(wt=dr.call(Ce.ownerDocument);Ce.firstChild;)wt.appendChild(Ce.firstChild);else wt=Ce;return(nt.shadowroot||nt.shadowrootmod)&&(wt=Cr.call(K,wt,!0)),wt}var st=zt?Ce.outerHTML:Ce.innerHTML;return zt&&gt["!doctype"]&&Ce.ownerDocument&&Ce.ownerDocument.doctype&&Ce.ownerDocument.doctype.name&&pe(G,Ce.ownerDocument.doctype.name)&&(st="<!DOCTYPE "+Ce.ownerDocument.doctype.name+`>
`+st),Ut&&(st=ue(st,Rt," "),st=ue(st,lt," "),st=ue(st,Et," ")),et&&pr?et.createHTML(st):st},U.setConfig=function(Fe){Yr(Fe),Vr=!0},U.clearConfig=function(){sr=null,Vr=!1},U.isValidAttribute=function(Fe,ne,Ce){sr||Yr({});var Ae=pt(Fe),Ge=pt(ne);return Kr(Ae,Ge,Ce)},U.addHook=function(Fe,ne){typeof ne=="function"&&(mt[Fe]=mt[Fe]||[],$(mt[Fe],ne))},U.removeHook=function(Fe){if(mt[Fe])return V(mt[Fe])},U.removeHooks=function(Fe){mt[Fe]&&(mt[Fe]=[])},U.removeAllHooks=function(){mt={}},U}var te=ee();return te})}}),require_moment=__commonJS({"node_modules/.pnpm/moment@2.30.1/node_modules/moment/moment.js"(e,t){(function(r,i){typeof e=="object"&&typeof t<"u"?t.exports=i():typeof define=="function"&&define.amd?define(i):r.moment=i()})(e,function(){"use strict";var r;function i(){return r.apply(null,arguments)}function o(p){r=p}function a(p){return p instanceof Array||Object.prototype.toString.call(p)==="[object Array]"}function c(p){return p!=null&&Object.prototype.toString.call(p)==="[object Object]"}function u(p,w){return Object.prototype.hasOwnProperty.call(p,w)}function h(p){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(p).length===0;var w;for(w in p)if(u(p,w))return!1;return!0}function d(p){return p===void 0}function f(p){return typeof p=="number"||Object.prototype.toString.call(p)==="[object Number]"}function m(p){return p instanceof Date||Object.prototype.toString.call(p)==="[object Date]"}function g(p,w){var C=[],M,N=p.length;for(M=0;M<N;++M)C.push(w(p[M],M));return C}function v(p,w){for(var C in w)u(w,C)&&(p[C]=w[C]);return u(w,"toString")&&(p.toString=w.toString),u(w,"valueOf")&&(p.valueOf=w.valueOf),p}function _(p,w,C,M){return Mi(p,w,C,M,!0).utc()}function b(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function S(p){return p._pf==null&&(p._pf=b()),p._pf}var R;Array.prototype.some?R=Array.prototype.some:R=function(p){var w=Object(this),C=w.length>>>0,M;for(M=0;M<C;M++)if(M in w&&p.call(this,w[M],M,w))return!0;return!1};function A(p){var w=null,C=!1,M=p._d&&!isNaN(p._d.getTime());if(M&&(w=S(p),C=R.call(w.parsedDateParts,function(N){return N!=null}),M=w.overflow<0&&!w.empty&&!w.invalidEra&&!w.invalidMonth&&!w.invalidWeekday&&!w.weekdayMismatch&&!w.nullInput&&!w.invalidFormat&&!w.userInvalidated&&(!w.meridiem||w.meridiem&&C),p._strict&&(M=M&&w.charsLeftOver===0&&w.unusedTokens.length===0&&w.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(p))p._isValid=M;else return M;return p._isValid}function I(p){var w=_(NaN);return p!=null?v(S(w),p):S(w).userInvalidated=!0,w}var E=i.momentProperties=[],O=!1;function P(p,w){var C,M,N,J=E.length;if(d(w._isAMomentObject)||(p._isAMomentObject=w._isAMomentObject),d(w._i)||(p._i=w._i),d(w._f)||(p._f=w._f),d(w._l)||(p._l=w._l),d(w._strict)||(p._strict=w._strict),d(w._tzm)||(p._tzm=w._tzm),d(w._isUTC)||(p._isUTC=w._isUTC),d(w._offset)||(p._offset=w._offset),d(w._pf)||(p._pf=S(w)),d(w._locale)||(p._locale=w._locale),J>0)for(C=0;C<J;C++)M=E[C],N=w[M],d(N)||(p[M]=N);return p}function L(p){P(this,p),this._d=new Date(p._d!=null?p._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),O===!1&&(O=!0,i.updateOffset(this),O=!1)}function V(p){return p instanceof L||p!=null&&p._isAMomentObject!=null}function $(p){i.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+p)}function W(p,w){var C=!0;return v(function(){if(i.deprecationHandler!=null&&i.deprecationHandler(null,p),C){var M=[],N,J,ge,He=arguments.length;for(J=0;J<He;J++){if(N="",typeof arguments[J]=="object"){N+=`
[`+J+"] ";for(ge in arguments[0])u(arguments[0],ge)&&(N+=ge+": "+arguments[0][ge]+", ");N=N.slice(0,-2)}else N=arguments[J];M.push(N)}$(p+`
Arguments: `+Array.prototype.slice.call(M).join("")+`
`+new Error().stack),C=!1}return w.apply(this,arguments)},w)}var Z={};function ie(p,w){i.deprecationHandler!=null&&i.deprecationHandler(p,w),Z[p]||($(w),Z[p]=!0)}i.suppressDeprecationWarnings=!1,i.deprecationHandler=null;function ue(p){return typeof Function<"u"&&p instanceof Function||Object.prototype.toString.call(p)==="[object Function]"}function _e(p){var w,C;for(C in p)u(p,C)&&(w=p[C],ue(w)?this[C]=w:this["_"+C]=w);this._config=p,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Te(p,w){var C=v({},p),M;for(M in w)u(w,M)&&(c(p[M])&&c(w[M])?(C[M]={},v(C[M],p[M]),v(C[M],w[M])):w[M]!=null?C[M]=w[M]:delete C[M]);for(M in p)u(p,M)&&!u(w,M)&&c(p[M])&&(C[M]=v({},C[M]));return C}function pe(p){p!=null&&this.set(p)}var me;Object.keys?me=Object.keys:me=function(p){var w,C=[];for(w in p)u(p,w)&&C.push(w);return C};var Se={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Le(p,w,C){var M=this._calendar[p]||this._calendar.sameElse;return ue(M)?M.call(w,C):M}function xe(p,w,C){var M=""+Math.abs(p),N=w-M.length,J=p>=0;return(J?C?"+":"":"-")+Math.pow(10,Math.max(0,N)).toString().substr(1)+M}var T=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,k=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,D={},q={};function B(p,w,C,M){var N=M;typeof M=="string"&&(N=function(){return this[M]()}),p&&(q[p]=N),w&&(q[w[0]]=function(){return xe(N.apply(this,arguments),w[1],w[2])}),C&&(q[C]=function(){return this.localeData().ordinal(N.apply(this,arguments),p)})}function se(p){return p.match(/\[[\s\S]/)?p.replace(/^\[|\]$/g,""):p.replace(/\\/g,"")}function ye(p){var w=p.match(T),C,M;for(C=0,M=w.length;C<M;C++)q[w[C]]?w[C]=q[w[C]]:w[C]=se(w[C]);return function(N){var J="",ge;for(ge=0;ge<M;ge++)J+=ue(w[ge])?w[ge].call(N,p):w[ge];return J}}function we(p,w){return p.isValid()?(w=de(w,p.localeData()),D[w]=D[w]||ye(w),D[w](p)):p.localeData().invalidDate()}function de(p,w){var C=5;function M(N){return w.longDateFormat(N)||N}for(k.lastIndex=0;C>=0&&k.test(p);)p=p.replace(k,M),k.lastIndex=0,C-=1;return p}var be={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function fe(p){var w=this._longDateFormat[p],C=this._longDateFormat[p.toUpperCase()];return w||!C?w:(this._longDateFormat[p]=C.match(T).map(function(M){return M==="MMMM"||M==="MM"||M==="DD"||M==="dddd"?M.slice(1):M}).join(""),this._longDateFormat[p])}var he="Invalid date";function Ne(){return this._invalidDate}var le="%d",Ve=/\d{1,2}/;function Be(p){return this._ordinal.replace("%d",p)}var Ue={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function je(p,w,C,M){var N=this._relativeTime[C];return ue(N)?N(p,w,C,M):N.replace(/%d/i,p)}function We(p,w){var C=this._relativeTime[p>0?"future":"past"];return ue(C)?C(w):C.replace(/%s/i,w)}var H={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function F(p){return typeof p=="string"?H[p]||H[p.toLowerCase()]:void 0}function G(p){var w={},C,M;for(M in p)u(p,M)&&(C=F(M),C&&(w[C]=p[M]));return w}var oe={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function Q(p){var w=[],C;for(C in p)u(p,C)&&w.push({unit:C,priority:oe[C]});return w.sort(function(M,N){return M.priority-N.priority}),w}var ce=/\d/,ee=/\d\d/,te=/\d{3}/,j=/\d{4}/,U=/[+-]?\d{6}/,K=/\d\d?/,ve=/\d\d\d\d?/,Re=/\d\d\d\d\d\d?/,Ie=/\d{1,3}/,ae=/\d{1,4}/,Ee=/[+-]?\d{1,6}/,Me=/\d+/,Pe=/[+-]?\d+/,De=/Z|[+-]\d\d:?\d\d/gi,$e=/Z|[+-]\d\d(?::?\d\d)?/gi,ut=/[+-]?\d+(\.\d{1,3})?/,ht=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,yt=/^[1-9]\d?/,rt=/^([1-9]\d|\d)/,St;St={};function Oe(p,w,C){St[p]=ue(w)?w:function(M,N){return M&&C?C:w}}function Qe(p,w){return u(St,p)?St[p](w._strict,w._locale):new RegExp(Xe(p))}function Xe(p){return et(p.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(w,C,M,N,J){return C||M||N||J}))}function et(p){return p.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function dt(p){return p<0?Math.ceil(p)||0:Math.floor(p)}function Ye(p){var w=+p,C=0;return w!==0&&isFinite(w)&&(C=dt(w)),C}var hr={};function Je(p,w){var C,M=w,N;for(typeof p=="string"&&(p=[p]),f(w)&&(M=function(J,ge){ge[w]=Ye(J)}),N=p.length,C=0;C<N;C++)hr[p[C]]=M}function dr(p,w){Je(p,function(C,M,N,J){N._w=N._w||{},w(C,N._w,N,J)})}function Hn(p,w,C){w!=null&&u(hr,p)&&hr[p](w,C._a,C,p)}function Cr(p){return p%4===0&&p%100!==0||p%400===0}var vt=0,mt=1,Rt=2,lt=3,Et=4,It=5,Wt=6,Fn=7,nn=8;B("Y",0,0,function(){var p=this.year();return p<=9999?xe(p,4):"+"+p}),B(0,["YY",2],0,function(){return this.year()%100}),B(0,["YYYY",4],0,"year"),B(0,["YYYYY",5],0,"year"),B(0,["YYYYYY",6,!0],0,"year"),Oe("Y",Pe),Oe("YY",K,ee),Oe("YYYY",ae,j),Oe("YYYYY",Ee,U),Oe("YYYYYY",Ee,U),Je(["YYYYY","YYYYYY"],vt),Je("YYYY",function(p,w){w[vt]=p.length===2?i.parseTwoDigitYear(p):Ye(p)}),Je("YY",function(p,w){w[vt]=i.parseTwoDigitYear(p)}),Je("Y",function(p,w){w[vt]=parseInt(p,10)});function fr(p){return Cr(p)?366:365}i.parseTwoDigitYear=function(p){return Ye(p)+(Ye(p)>68?1900:2e3)};var Sr=jt("FullYear",!0);function gt(){return Cr(this.year())}function jt(p,w){return function(C){return C!=null?(Dr(this,p,C),i.updateOffset(this,w),this):nt(this,p)}}function nt(p,w){if(!p.isValid())return NaN;var C=p._d,M=p._isUTC;switch(w){case"Milliseconds":return M?C.getUTCMilliseconds():C.getMilliseconds();case"Seconds":return M?C.getUTCSeconds():C.getSeconds();case"Minutes":return M?C.getUTCMinutes():C.getMinutes();case"Hours":return M?C.getUTCHours():C.getHours();case"Date":return M?C.getUTCDate():C.getDate();case"Day":return M?C.getUTCDay():C.getDay();case"Month":return M?C.getUTCMonth():C.getMonth();case"FullYear":return M?C.getUTCFullYear():C.getFullYear();default:return NaN}}function Dr(p,w,C){var M,N,J,ge,He;if(!(!p.isValid()||isNaN(C))){switch(M=p._d,N=p._isUTC,w){case"Milliseconds":return void(N?M.setUTCMilliseconds(C):M.setMilliseconds(C));case"Seconds":return void(N?M.setUTCSeconds(C):M.setSeconds(C));case"Minutes":return void(N?M.setUTCMinutes(C):M.setMinutes(C));case"Hours":return void(N?M.setUTCHours(C):M.setHours(C));case"Date":return void(N?M.setUTCDate(C):M.setDate(C));case"FullYear":break;default:return}J=C,ge=p.month(),He=p.date(),He=He===29&&ge===1&&!Cr(J)?28:He,N?M.setUTCFullYear(J,ge,He):M.setFullYear(J,ge,He)}}function ct(p){return p=F(p),ue(this[p])?this[p]():this}function mr(p,w){if(typeof p=="object"){p=G(p);var C=Q(p),M,N=C.length;for(M=0;M<N;M++)this[C[M].unit](p[C[M].unit])}else if(p=F(p),ue(this[p]))return this[p](w);return this}function Lr(p,w){return(p%w+w)%w}var it;Array.prototype.indexOf?it=Array.prototype.indexOf:it=function(p){var w;for(w=0;w<this.length;++w)if(this[w]===p)return w;return-1};function gr(p,w){if(isNaN(p)||isNaN(w))return NaN;var C=Lr(w,12);return p+=(w-C)/12,C===1?Cr(p)?29:28:31-C%7%2}B("M",["MM",2],"Mo",function(){return this.month()+1}),B("MMM",0,0,function(p){return this.localeData().monthsShort(this,p)}),B("MMMM",0,0,function(p){return this.localeData().months(this,p)}),Oe("M",K,yt),Oe("MM",K,ee),Oe("MMM",function(p,w){return w.monthsShortRegex(p)}),Oe("MMMM",function(p,w){return w.monthsRegex(p)}),Je(["M","MM"],function(p,w){w[mt]=Ye(p)-1}),Je(["MMM","MMMM"],function(p,w,C,M){var N=C._locale.monthsParse(p,M,C._strict);N!=null?w[mt]=N:S(C).invalidMonth=p});var sn="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Hr="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Ut=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Fr=ht,zt=ht;function Vr(p,w){return p?a(this._months)?this._months[p.month()]:this._months[(this._months.isFormat||Ut).test(w)?"format":"standalone"][p.month()]:a(this._months)?this._months:this._months.standalone}function Br(p,w){return p?a(this._monthsShort)?this._monthsShort[p.month()]:this._monthsShort[Ut.test(w)?"format":"standalone"][p.month()]:a(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function er(p,w,C){var M,N,J,ge=p.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],M=0;M<12;++M)J=_([2e3,M]),this._shortMonthsParse[M]=this.monthsShort(J,"").toLocaleLowerCase(),this._longMonthsParse[M]=this.months(J,"").toLocaleLowerCase();return C?w==="MMM"?(N=it.call(this._shortMonthsParse,ge),N!==-1?N:null):(N=it.call(this._longMonthsParse,ge),N!==-1?N:null):w==="MMM"?(N=it.call(this._shortMonthsParse,ge),N!==-1?N:(N=it.call(this._longMonthsParse,ge),N!==-1?N:null)):(N=it.call(this._longMonthsParse,ge),N!==-1?N:(N=it.call(this._shortMonthsParse,ge),N!==-1?N:null))}function Tr(p,w,C){var M,N,J;if(this._monthsParseExact)return er.call(this,p,w,C);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),M=0;M<12;M++){if(N=_([2e3,M]),C&&!this._longMonthsParse[M]&&(this._longMonthsParse[M]=new RegExp("^"+this.months(N,"").replace(".","")+"$","i"),this._shortMonthsParse[M]=new RegExp("^"+this.monthsShort(N,"").replace(".","")+"$","i")),!C&&!this._monthsParse[M]&&(J="^"+this.months(N,"")+"|^"+this.monthsShort(N,""),this._monthsParse[M]=new RegExp(J.replace(".",""),"i")),C&&w==="MMMM"&&this._longMonthsParse[M].test(p))return M;if(C&&w==="MMM"&&this._shortMonthsParse[M].test(p))return M;if(!C&&this._monthsParse[M].test(p))return M}}function pr(p,w){if(!p.isValid())return p;if(typeof w=="string"){if(/^\d+$/.test(w))w=Ye(w);else if(w=p.localeData().monthsParse(w),!f(w))return p}var C=w,M=p.date();return M=M<29?M:Math.min(M,gr(p.year(),C)),p._isUTC?p._d.setUTCMonth(C,M):p._d.setMonth(C,M),p}function Wr(p){return p!=null?(pr(this,p),i.updateOffset(this,!0),this):nt(this,"Month")}function on(){return gr(this.year(),this.month())}function Vn(p){return this._monthsParseExact?(u(this,"_monthsRegex")||tr.call(this),p?this._monthsShortStrictRegex:this._monthsShortRegex):(u(this,"_monthsShortRegex")||(this._monthsShortRegex=Fr),this._monthsShortStrictRegex&&p?this._monthsShortStrictRegex:this._monthsShortRegex)}function jr(p){return this._monthsParseExact?(u(this,"_monthsRegex")||tr.call(this),p?this._monthsStrictRegex:this._monthsRegex):(u(this,"_monthsRegex")||(this._monthsRegex=zt),this._monthsStrictRegex&&p?this._monthsStrictRegex:this._monthsRegex)}function tr(){function p(ze,qe){return qe.length-ze.length}var w=[],C=[],M=[],N,J,ge,He;for(N=0;N<12;N++)J=_([2e3,N]),ge=et(this.monthsShort(J,"")),He=et(this.months(J,"")),w.push(ge),C.push(He),M.push(He),M.push(ge);w.sort(p),C.sort(p),M.sort(p),this._monthsRegex=new RegExp("^("+M.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+C.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+w.join("|")+")","i")}function rr(p,w,C,M,N,J,ge){var He;return p<100&&p>=0?(He=new Date(p+400,w,C,M,N,J,ge),isFinite(He.getFullYear())&&He.setFullYear(p)):He=new Date(p,w,C,M,N,J,ge),He}function Pt(p){var w,C;return p<100&&p>=0?(C=Array.prototype.slice.call(arguments),C[0]=p+400,w=new Date(Date.UTC.apply(null,C)),isFinite(w.getUTCFullYear())&&w.setUTCFullYear(p)):w=new Date(Date.UTC.apply(null,arguments)),w}function vr(p,w,C){var M=7+w-C,N=(7+Pt(p,0,M).getUTCDay()-w)%7;return-N+M-1}function Ur(p,w,C,M,N){var J=(7+C-M)%7,ge=vr(p,M,N),He=1+7*(w-1)+J+ge,ze,qe;return He<=0?(ze=p-1,qe=fr(ze)+He):He>fr(p)?(ze=p+1,qe=He-fr(p)):(ze=p,qe=He),{year:ze,dayOfYear:qe}}function nr(p,w,C){var M=vr(p.year(),w,C),N=Math.floor((p.dayOfYear()-M-1)/7)+1,J,ge;return N<1?(ge=p.year()-1,J=N+Ot(ge,w,C)):N>Ot(p.year(),w,C)?(J=N-Ot(p.year(),w,C),ge=p.year()+1):(ge=p.year(),J=N),{week:J,year:ge}}function Ot(p,w,C){var M=vr(p,w,C),N=vr(p+1,w,C);return(fr(p)-M+N)/7}B("w",["ww",2],"wo","week"),B("W",["WW",2],"Wo","isoWeek"),Oe("w",K,yt),Oe("ww",K,ee),Oe("W",K,yt),Oe("WW",K,ee),dr(["w","ww","W","WW"],function(p,w,C,M){w[M.substr(0,1)]=Ye(p)});function an(p){return nr(p,this._week.dow,this._week.doy).week}var Er={dow:0,doy:6};function xr(){return this._week.dow}function Nt(){return this._week.doy}function ir(p){var w=this.localeData().week(this);return p==null?w:this.add((p-w)*7,"d")}function zr(p){var w=nr(this,1,4).week;return p==null?w:this.add((p-w)*7,"d")}B("d",0,"do","day"),B("dd",0,0,function(p){return this.localeData().weekdaysMin(this,p)}),B("ddd",0,0,function(p){return this.localeData().weekdaysShort(this,p)}),B("dddd",0,0,function(p){return this.localeData().weekdays(this,p)}),B("e",0,0,"weekday"),B("E",0,0,"isoWeekday"),Oe("d",K),Oe("e",K),Oe("E",K),Oe("dd",function(p,w){return w.weekdaysMinRegex(p)}),Oe("ddd",function(p,w){return w.weekdaysShortRegex(p)}),Oe("dddd",function(p,w){return w.weekdaysRegex(p)}),dr(["dd","ddd","dddd"],function(p,w,C,M){var N=C._locale.weekdaysParse(p,M,C._strict);N!=null?w.d=N:S(C).invalidWeekday=p}),dr(["d","e","E"],function(p,w,C,M){w[M]=Ye(p)});function $r(p,w){return typeof p!="string"?p:isNaN(p)?(p=w.weekdaysParse(p),typeof p=="number"?p:null):parseInt(p,10)}function Bn(p,w){return typeof p=="string"?w.weekdaysParse(p)%7||7:isNaN(p)?null:p}function Dt(p,w){return p.slice(w,7).concat(p.slice(0,w))}var Wn="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),ln="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),pt="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),sr=ht,jn=ht,cn=ht;function Yr(p,w){var C=a(this._weekdays)?this._weekdays:this._weekdays[p&&p!==!0&&this._weekdays.isFormat.test(w)?"format":"standalone"];return p===!0?Dt(C,this._week.dow):p?C[p.day()]:C}function un(p){return p===!0?Dt(this._weekdaysShort,this._week.dow):p?this._weekdaysShort[p.day()]:this._weekdaysShort}function hn(p){return p===!0?Dt(this._weekdaysMin,this._week.dow):p?this._weekdaysMin[p.day()]:this._weekdaysMin}function Un(p,w,C){var M,N,J,ge=p.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],M=0;M<7;++M)J=_([2e3,1]).day(M),this._minWeekdaysParse[M]=this.weekdaysMin(J,"").toLocaleLowerCase(),this._shortWeekdaysParse[M]=this.weekdaysShort(J,"").toLocaleLowerCase(),this._weekdaysParse[M]=this.weekdays(J,"").toLocaleLowerCase();return C?w==="dddd"?(N=it.call(this._weekdaysParse,ge),N!==-1?N:null):w==="ddd"?(N=it.call(this._shortWeekdaysParse,ge),N!==-1?N:null):(N=it.call(this._minWeekdaysParse,ge),N!==-1?N:null):w==="dddd"?(N=it.call(this._weekdaysParse,ge),N!==-1||(N=it.call(this._shortWeekdaysParse,ge),N!==-1)?N:(N=it.call(this._minWeekdaysParse,ge),N!==-1?N:null)):w==="ddd"?(N=it.call(this._shortWeekdaysParse,ge),N!==-1||(N=it.call(this._weekdaysParse,ge),N!==-1)?N:(N=it.call(this._minWeekdaysParse,ge),N!==-1?N:null)):(N=it.call(this._minWeekdaysParse,ge),N!==-1||(N=it.call(this._weekdaysParse,ge),N!==-1)?N:(N=it.call(this._shortWeekdaysParse,ge),N!==-1?N:null))}function Rr(p,w,C){var M,N,J;if(this._weekdaysParseExact)return Un.call(this,p,w,C);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),M=0;M<7;M++){if(N=_([2e3,1]).day(M),C&&!this._fullWeekdaysParse[M]&&(this._fullWeekdaysParse[M]=new RegExp("^"+this.weekdays(N,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[M]=new RegExp("^"+this.weekdaysShort(N,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[M]=new RegExp("^"+this.weekdaysMin(N,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[M]||(J="^"+this.weekdays(N,"")+"|^"+this.weekdaysShort(N,"")+"|^"+this.weekdaysMin(N,""),this._weekdaysParse[M]=new RegExp(J.replace(".",""),"i")),C&&w==="dddd"&&this._fullWeekdaysParse[M].test(p))return M;if(C&&w==="ddd"&&this._shortWeekdaysParse[M].test(p))return M;if(C&&w==="dd"&&this._minWeekdaysParse[M].test(p))return M;if(!C&&this._weekdaysParse[M].test(p))return M}}function Gr(p){if(!this.isValid())return p!=null?this:NaN;var w=nt(this,"Day");return p!=null?(p=$r(p,this.localeData()),this.add(p-w,"d")):w}function zn(p){if(!this.isValid())return p!=null?this:NaN;var w=(this.day()+7-this.localeData()._week.dow)%7;return p==null?w:this.add(p-w,"d")}function Mt(p){if(!this.isValid())return p!=null?this:NaN;if(p!=null){var w=Bn(p,this.localeData());return this.day(this.day()%7?w:w-7)}else return this.day()||7}function Mr(p){return this._weekdaysParseExact?(u(this,"_weekdaysRegex")||wr.call(this),p?this._weekdaysStrictRegex:this._weekdaysRegex):(u(this,"_weekdaysRegex")||(this._weekdaysRegex=sr),this._weekdaysStrictRegex&&p?this._weekdaysStrictRegex:this._weekdaysRegex)}function dn(p){return this._weekdaysParseExact?(u(this,"_weekdaysRegex")||wr.call(this),p?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(u(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=jn),this._weekdaysShortStrictRegex&&p?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function fn(p){return this._weekdaysParseExact?(u(this,"_weekdaysRegex")||wr.call(this),p?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(u(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=cn),this._weekdaysMinStrictRegex&&p?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function wr(){function p(xt,Xt){return Xt.length-xt.length}var w=[],C=[],M=[],N=[],J,ge,He,ze,qe;for(J=0;J<7;J++)ge=_([2e3,1]).day(J),He=et(this.weekdaysMin(ge,"")),ze=et(this.weekdaysShort(ge,"")),qe=et(this.weekdays(ge,"")),w.push(He),C.push(ze),M.push(qe),N.push(He),N.push(ze),N.push(qe);w.sort(p),C.sort(p),M.sort(p),N.sort(p),this._weekdaysRegex=new RegExp("^("+N.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+M.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+C.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+w.join("|")+")","i")}function $t(){return this.hours()%12||12}function Lt(){return this.hours()||24}B("H",["HH",2],0,"hour"),B("h",["hh",2],0,$t),B("k",["kk",2],0,Lt),B("hmm",0,0,function(){return""+$t.apply(this)+xe(this.minutes(),2)}),B("hmmss",0,0,function(){return""+$t.apply(this)+xe(this.minutes(),2)+xe(this.seconds(),2)}),B("Hmm",0,0,function(){return""+this.hours()+xe(this.minutes(),2)}),B("Hmmss",0,0,function(){return""+this.hours()+xe(this.minutes(),2)+xe(this.seconds(),2)});function qr(p,w){B(p,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),w)})}qr("a",!0),qr("A",!1);function Kr(p,w){return w._meridiemParse}Oe("a",Kr),Oe("A",Kr),Oe("H",K,rt),Oe("h",K,yt),Oe("k",K,yt),Oe("HH",K,ee),Oe("hh",K,ee),Oe("kk",K,ee),Oe("hmm",ve),Oe("hmmss",Re),Oe("Hmm",ve),Oe("Hmmss",Re),Je(["H","HH"],lt),Je(["k","kk"],function(p,w,C){var M=Ye(p);w[lt]=M===24?0:M}),Je(["a","A"],function(p,w,C){C._isPm=C._locale.isPM(p),C._meridiem=p}),Je(["h","hh"],function(p,w,C){w[lt]=Ye(p),S(C).bigHour=!0}),Je("hmm",function(p,w,C){var M=p.length-2;w[lt]=Ye(p.substr(0,M)),w[Et]=Ye(p.substr(M)),S(C).bigHour=!0}),Je("hmmss",function(p,w,C){var M=p.length-4,N=p.length-2;w[lt]=Ye(p.substr(0,M)),w[Et]=Ye(p.substr(M,2)),w[It]=Ye(p.substr(N)),S(C).bigHour=!0}),Je("Hmm",function(p,w,C){var M=p.length-2;w[lt]=Ye(p.substr(0,M)),w[Et]=Ye(p.substr(M))}),Je("Hmmss",function(p,w,C){var M=p.length-4,N=p.length-2;w[lt]=Ye(p.substr(0,M)),w[Et]=Ye(p.substr(M,2)),w[It]=Ye(p.substr(N))});function mn(p){return(p+"").toLowerCase().charAt(0)==="p"}var gn=/[ap]\.?m?\.?/i,$n=jt("Hours",!0);function Fe(p,w,C){return p>11?C?"pm":"PM":C?"am":"AM"}var ne={calendar:Se,longDateFormat:be,invalidDate:he,ordinal:le,dayOfMonthOrdinalParse:Ve,relativeTime:Ue,months:sn,monthsShort:Hr,week:Er,weekdays:Wn,weekdaysMin:pt,weekdaysShort:ln,meridiemParse:gn},Ce={},Ae={},Ge;function Tt(p,w){var C,M=Math.min(p.length,w.length);for(C=0;C<M;C+=1)if(p[C]!==w[C])return C;return M}function wt(p){return p&&p.toLowerCase().replace("_","-")}function _t(p){for(var w=0,C,M,N,J;w<p.length;){for(J=wt(p[w]).split("-"),C=J.length,M=wt(p[w+1]),M=M?M.split("-"):null;C>0;){if(N=st(J.slice(0,C).join("-")),N)return N;if(M&&M.length>=C&&Tt(J,M)>=C-1)break;C--}w++}return Ge}function Yt(p){return!!(p&&p.match("^[^/\\\\]*$"))}function st(p){var w=null,C;if(Ce[p]===void 0&&typeof t<"u"&&t&&t.exports&&Yt(p))try{w=Ge._abbr,C=__require,C("./locale/"+p),At(w)}catch{Ce[p]=null}return Ce[p]}function At(p,w){var C;return p&&(d(w)?C=Gt(p):C=kr(p,w),C?Ge=C:typeof console<"u"&&console.warn&&console.warn("Locale "+p+" not found. Did you forget to load it?")),Ge._abbr}function kr(p,w){if(w!==null){var C,M=ne;if(w.abbr=p,Ce[p]!=null)ie("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),M=Ce[p]._config;else if(w.parentLocale!=null)if(Ce[w.parentLocale]!=null)M=Ce[w.parentLocale]._config;else if(C=st(w.parentLocale),C!=null)M=C._config;else return Ae[w.parentLocale]||(Ae[w.parentLocale]=[]),Ae[w.parentLocale].push({name:p,config:w}),null;return Ce[p]=new pe(Te(M,w)),Ae[p]&&Ae[p].forEach(function(N){kr(N.name,N.config)}),At(p),Ce[p]}else return delete Ce[p],null}function Ti(p,w){if(w!=null){var C,M,N=ne;Ce[p]!=null&&Ce[p].parentLocale!=null?Ce[p].set(Te(Ce[p]._config,w)):(M=st(p),M!=null&&(N=M._config),w=Te(N,w),M==null&&(w.abbr=p),C=new pe(w),C.parentLocale=Ce[p],Ce[p]=C),At(p)}else Ce[p]!=null&&(Ce[p].parentLocale!=null?(Ce[p]=Ce[p].parentLocale,p===At()&&At(p)):Ce[p]!=null&&delete Ce[p]);return Ce[p]}function Gt(p){var w;if(p&&p._locale&&p._locale._abbr&&(p=p._locale._abbr),!p)return Ge;if(!a(p)){if(w=st(p),w)return w;p=[p]}return _t(p)}function Is(){return me(Ce)}function Yn(p){var w,C=p._a;return C&&S(p).overflow===-2&&(w=C[mt]<0||C[mt]>11?mt:C[Rt]<1||C[Rt]>gr(C[vt],C[mt])?Rt:C[lt]<0||C[lt]>24||C[lt]===24&&(C[Et]!==0||C[It]!==0||C[Wt]!==0)?lt:C[Et]<0||C[Et]>59?Et:C[It]<0||C[It]>59?It:C[Wt]<0||C[Wt]>999?Wt:-1,S(p)._overflowDayOfYear&&(w<vt||w>Rt)&&(w=Rt),S(p)._overflowWeeks&&w===-1&&(w=Fn),S(p)._overflowWeekday&&w===-1&&(w=nn),S(p).overflow=w),p}var Ns=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ds=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ls=/Z|[+-]\d\d(?::?\d\d)?/,pn=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Gn=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Hs=/^\/?Date\((-?\d+)/i,Fs=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Vs={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Ei(p){var w,C,M=p._i,N=Ns.exec(M)||Ds.exec(M),J,ge,He,ze,qe=pn.length,xt=Gn.length;if(N){for(S(p).iso=!0,w=0,C=qe;w<C;w++)if(pn[w][1].exec(N[1])){ge=pn[w][0],J=pn[w][2]!==!1;break}if(ge==null){p._isValid=!1;return}if(N[3]){for(w=0,C=xt;w<C;w++)if(Gn[w][1].exec(N[3])){He=(N[2]||" ")+Gn[w][0];break}if(He==null){p._isValid=!1;return}}if(!J&&He!=null){p._isValid=!1;return}if(N[4])if(Ls.exec(N[4]))ze="Z";else{p._isValid=!1;return}p._f=ge+(He||"")+(ze||""),Kn(p)}else p._isValid=!1}function Bs(p,w,C,M,N,J){var ge=[Ws(p),Hr.indexOf(w),parseInt(C,10),parseInt(M,10),parseInt(N,10)];return J&&ge.push(parseInt(J,10)),ge}function Ws(p){var w=parseInt(p,10);return w<=49?2e3+w:w<=999?1900+w:w}function js(p){return p.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Us(p,w,C){if(p){var M=ln.indexOf(p),N=new Date(w[0],w[1],w[2]).getDay();if(M!==N)return S(C).weekdayMismatch=!0,C._isValid=!1,!1}return!0}function zs(p,w,C){if(p)return Vs[p];if(w)return 0;var M=parseInt(C,10),N=M%100,J=(M-N)/100;return J*60+N}function xi(p){var w=Fs.exec(js(p._i)),C;if(w){if(C=Bs(w[4],w[3],w[2],w[5],w[6],w[7]),!Us(w[1],C,p))return;p._a=C,p._tzm=zs(w[8],w[9],w[10]),p._d=Pt.apply(null,p._a),p._d.setUTCMinutes(p._d.getUTCMinutes()-p._tzm),S(p).rfc2822=!0}else p._isValid=!1}function $s(p){var w=Hs.exec(p._i);if(w!==null){p._d=new Date(+w[1]);return}if(Ei(p),p._isValid===!1)delete p._isValid;else return;if(xi(p),p._isValid===!1)delete p._isValid;else return;p._strict?p._isValid=!1:i.createFromInputFallback(p)}i.createFromInputFallback=W("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(p){p._d=new Date(p._i+(p._useUTC?" UTC":""))});function Or(p,w,C){return p??w??C}function Ys(p){var w=new Date(i.now());return p._useUTC?[w.getUTCFullYear(),w.getUTCMonth(),w.getUTCDate()]:[w.getFullYear(),w.getMonth(),w.getDate()]}function qn(p){var w,C,M=[],N,J,ge;if(!p._d){for(N=Ys(p),p._w&&p._a[Rt]==null&&p._a[mt]==null&&Gs(p),p._dayOfYear!=null&&(ge=Or(p._a[vt],N[vt]),(p._dayOfYear>fr(ge)||p._dayOfYear===0)&&(S(p)._overflowDayOfYear=!0),C=Pt(ge,0,p._dayOfYear),p._a[mt]=C.getUTCMonth(),p._a[Rt]=C.getUTCDate()),w=0;w<3&&p._a[w]==null;++w)p._a[w]=M[w]=N[w];for(;w<7;w++)p._a[w]=M[w]=p._a[w]==null?w===2?1:0:p._a[w];p._a[lt]===24&&p._a[Et]===0&&p._a[It]===0&&p._a[Wt]===0&&(p._nextDay=!0,p._a[lt]=0),p._d=(p._useUTC?Pt:rr).apply(null,M),J=p._useUTC?p._d.getUTCDay():p._d.getDay(),p._tzm!=null&&p._d.setUTCMinutes(p._d.getUTCMinutes()-p._tzm),p._nextDay&&(p._a[lt]=24),p._w&&typeof p._w.d<"u"&&p._w.d!==J&&(S(p).weekdayMismatch=!0)}}function Gs(p){var w,C,M,N,J,ge,He,ze,qe;w=p._w,w.GG!=null||w.W!=null||w.E!=null?(J=1,ge=4,C=Or(w.GG,p._a[vt],nr(tt(),1,4).year),M=Or(w.W,1),N=Or(w.E,1),(N<1||N>7)&&(ze=!0)):(J=p._locale._week.dow,ge=p._locale._week.doy,qe=nr(tt(),J,ge),C=Or(w.gg,p._a[vt],qe.year),M=Or(w.w,qe.week),w.d!=null?(N=w.d,(N<0||N>6)&&(ze=!0)):w.e!=null?(N=w.e+J,(w.e<0||w.e>6)&&(ze=!0)):N=J),M<1||M>Ot(C,J,ge)?S(p)._overflowWeeks=!0:ze!=null?S(p)._overflowWeekday=!0:(He=Ur(C,M,N,J,ge),p._a[vt]=He.year,p._dayOfYear=He.dayOfYear)}i.ISO_8601=function(){},i.RFC_2822=function(){};function Kn(p){if(p._f===i.ISO_8601){Ei(p);return}if(p._f===i.RFC_2822){xi(p);return}p._a=[],S(p).empty=!0;var w=""+p._i,C,M,N,J,ge,He=w.length,ze=0,qe,xt;for(N=de(p._f,p._locale).match(T)||[],xt=N.length,C=0;C<xt;C++)J=N[C],M=(w.match(Qe(J,p))||[])[0],M&&(ge=w.substr(0,w.indexOf(M)),ge.length>0&&S(p).unusedInput.push(ge),w=w.slice(w.indexOf(M)+M.length),ze+=M.length),q[J]?(M?S(p).empty=!1:S(p).unusedTokens.push(J),Hn(J,M,p)):p._strict&&!M&&S(p).unusedTokens.push(J);S(p).charsLeftOver=He-ze,w.length>0&&S(p).unusedInput.push(w),p._a[lt]<=12&&S(p).bigHour===!0&&p._a[lt]>0&&(S(p).bigHour=void 0),S(p).parsedDateParts=p._a.slice(0),S(p).meridiem=p._meridiem,p._a[lt]=qs(p._locale,p._a[lt],p._meridiem),qe=S(p).era,qe!==null&&(p._a[vt]=p._locale.erasConvertYear(qe,p._a[vt])),qn(p),Yn(p)}function qs(p,w,C){var M;return C==null?w:p.meridiemHour!=null?p.meridiemHour(w,C):(p.isPM!=null&&(M=p.isPM(C),M&&w<12&&(w+=12),!M&&w===12&&(w=0)),w)}function Ks(p){var w,C,M,N,J,ge,He=!1,ze=p._f.length;if(ze===0){S(p).invalidFormat=!0,p._d=new Date(NaN);return}for(N=0;N<ze;N++)J=0,ge=!1,w=P({},p),p._useUTC!=null&&(w._useUTC=p._useUTC),w._f=p._f[N],Kn(w),A(w)&&(ge=!0),J+=S(w).charsLeftOver,J+=S(w).unusedTokens.length*10,S(w).score=J,He?J<M&&(M=J,C=w):(M==null||J<M||ge)&&(M=J,C=w,ge&&(He=!0));v(p,C||w)}function Zs(p){if(!p._d){var w=G(p._i),C=w.day===void 0?w.date:w.day;p._a=g([w.year,w.month,C,w.hour,w.minute,w.second,w.millisecond],function(M){return M&&parseInt(M,10)}),qn(p)}}function Xs(p){var w=new L(Yn(Ri(p)));return w._nextDay&&(w.add(1,"d"),w._nextDay=void 0),w}function Ri(p){var w=p._i,C=p._f;return p._locale=p._locale||Gt(p._l),w===null||C===void 0&&w===""?I({nullInput:!0}):(typeof w=="string"&&(p._i=w=p._locale.preparse(w)),V(w)?new L(Yn(w)):(m(w)?p._d=w:a(C)?Ks(p):C?Kn(p):Js(p),A(p)||(p._d=null),p))}function Js(p){var w=p._i;d(w)?p._d=new Date(i.now()):m(w)?p._d=new Date(w.valueOf()):typeof w=="string"?$s(p):a(w)?(p._a=g(w.slice(0),function(C){return parseInt(C,10)}),qn(p)):c(w)?Zs(p):f(w)?p._d=new Date(w):i.createFromInputFallback(p)}function Mi(p,w,C,M,N){var J={};return(w===!0||w===!1)&&(M=w,w=void 0),(C===!0||C===!1)&&(M=C,C=void 0),(c(p)&&h(p)||a(p)&&p.length===0)&&(p=void 0),J._isAMomentObject=!0,J._useUTC=J._isUTC=N,J._l=C,J._i=p,J._f=w,J._strict=M,Xs(J)}function tt(p,w,C,M){return Mi(p,w,C,M,!1)}var Qs=W("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var p=tt.apply(null,arguments);return this.isValid()&&p.isValid()?p<this?this:p:I()}),eo=W("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var p=tt.apply(null,arguments);return this.isValid()&&p.isValid()?p>this?this:p:I()});function ki(p,w){var C,M;if(w.length===1&&a(w[0])&&(w=w[0]),!w.length)return tt();for(C=w[0],M=1;M<w.length;++M)(!w[M].isValid()||w[M][p](C))&&(C=w[M]);return C}function ro(){var p=[].slice.call(arguments,0);return ki("isBefore",p)}function no(){var p=[].slice.call(arguments,0);return ki("isAfter",p)}var io=function(){return Date.now?Date.now():+new Date},Zr=["year","quarter","month","week","day","hour","minute","second","millisecond"];function so(p){var w,C=!1,M,N=Zr.length;for(w in p)if(u(p,w)&&!(it.call(Zr,w)!==-1&&(p[w]==null||!isNaN(p[w]))))return!1;for(M=0;M<N;++M)if(p[Zr[M]]){if(C)return!1;parseFloat(p[Zr[M]])!==Ye(p[Zr[M]])&&(C=!0)}return!0}function oo(){return this._isValid}function ao(){return Ht(NaN)}function vn(p){var w=G(p),C=w.year||0,M=w.quarter||0,N=w.month||0,J=w.week||w.isoWeek||0,ge=w.day||0,He=w.hour||0,ze=w.minute||0,qe=w.second||0,xt=w.millisecond||0;this._isValid=so(w),this._milliseconds=+xt+qe*1e3+ze*6e4+He*1e3*60*60,this._days=+ge+J*7,this._months=+N+M*3+C*12,this._data={},this._locale=Gt(),this._bubble()}function wn(p){return p instanceof vn}function Zn(p){return p<0?Math.round(-1*p)*-1:Math.round(p)}function lo(p,w,C){var M=Math.min(p.length,w.length),N=Math.abs(p.length-w.length),J=0,ge;for(ge=0;ge<M;ge++)(C&&p[ge]!==w[ge]||!C&&Ye(p[ge])!==Ye(w[ge]))&&J++;return J+N}function Oi(p,w){B(p,0,0,function(){var C=this.utcOffset(),M="+";return C<0&&(C=-C,M="-"),M+xe(~~(C/60),2)+w+xe(~~C%60,2)})}Oi("Z",":"),Oi("ZZ",""),Oe("Z",$e),Oe("ZZ",$e),Je(["Z","ZZ"],function(p,w,C){C._useUTC=!0,C._tzm=Xn($e,p)});var co=/([\+\-]|\d\d)/gi;function Xn(p,w){var C=(w||"").match(p),M,N,J;return C===null?null:(M=C[C.length-1]||[],N=(M+"").match(co)||["-",0,0],J=+(N[1]*60)+Ye(N[2]),J===0?0:N[0]==="+"?J:-J)}function Jn(p,w){var C,M;return w._isUTC?(C=w.clone(),M=(V(p)||m(p)?p.valueOf():tt(p).valueOf())-C.valueOf(),C._d.setTime(C._d.valueOf()+M),i.updateOffset(C,!1),C):tt(p).local()}function Qn(p){return-Math.round(p._d.getTimezoneOffset())}i.updateOffset=function(){};function uo(p,w,C){var M=this._offset||0,N;if(!this.isValid())return p!=null?this:NaN;if(p!=null){if(typeof p=="string"){if(p=Xn($e,p),p===null)return this}else Math.abs(p)<16&&!C&&(p=p*60);return!this._isUTC&&w&&(N=Qn(this)),this._offset=p,this._isUTC=!0,N!=null&&this.add(N,"m"),M!==p&&(!w||this._changeInProgress?Ni(this,Ht(p-M,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,i.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?M:Qn(this)}function ho(p,w){return p!=null?(typeof p!="string"&&(p=-p),this.utcOffset(p,w),this):-this.utcOffset()}function fo(p){return this.utcOffset(0,p)}function mo(p){return this._isUTC&&(this.utcOffset(0,p),this._isUTC=!1,p&&this.subtract(Qn(this),"m")),this}function go(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var p=Xn(De,this._i);p!=null?this.utcOffset(p):this.utcOffset(0,!0)}return this}function po(p){return this.isValid()?(p=p?tt(p).utcOffset():0,(this.utcOffset()-p)%60===0):!1}function vo(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function wo(){if(!d(this._isDSTShifted))return this._isDSTShifted;var p={},w;return P(p,this),p=Ri(p),p._a?(w=p._isUTC?_(p._a):tt(p._a),this._isDSTShifted=this.isValid()&&lo(p._a,w.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function _o(){return this.isValid()?!this._isUTC:!1}function yo(){return this.isValid()?this._isUTC:!1}function Pi(){return this.isValid()?this._isUTC&&this._offset===0:!1}var bo=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Co=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ht(p,w){var C=p,M=null,N,J,ge;return wn(p)?C={ms:p._milliseconds,d:p._days,M:p._months}:f(p)||!isNaN(+p)?(C={},w?C[w]=+p:C.milliseconds=+p):(M=bo.exec(p))?(N=M[1]==="-"?-1:1,C={y:0,d:Ye(M[Rt])*N,h:Ye(M[lt])*N,m:Ye(M[Et])*N,s:Ye(M[It])*N,ms:Ye(Zn(M[Wt]*1e3))*N}):(M=Co.exec(p))?(N=M[1]==="-"?-1:1,C={y:_r(M[2],N),M:_r(M[3],N),w:_r(M[4],N),d:_r(M[5],N),h:_r(M[6],N),m:_r(M[7],N),s:_r(M[8],N)}):C==null?C={}:typeof C=="object"&&("from"in C||"to"in C)&&(ge=So(tt(C.from),tt(C.to)),C={},C.ms=ge.milliseconds,C.M=ge.months),J=new vn(C),wn(p)&&u(p,"_locale")&&(J._locale=p._locale),wn(p)&&u(p,"_isValid")&&(J._isValid=p._isValid),J}Ht.fn=vn.prototype,Ht.invalid=ao;function _r(p,w){var C=p&&parseFloat(p.replace(",","."));return(isNaN(C)?0:C)*w}function Ai(p,w){var C={};return C.months=w.month()-p.month()+(w.year()-p.year())*12,p.clone().add(C.months,"M").isAfter(w)&&--C.months,C.milliseconds=+w-+p.clone().add(C.months,"M"),C}function So(p,w){var C;return p.isValid()&&w.isValid()?(w=Jn(w,p),p.isBefore(w)?C=Ai(p,w):(C=Ai(w,p),C.milliseconds=-C.milliseconds,C.months=-C.months),C):{milliseconds:0,months:0}}function Ii(p,w){return function(C,M){var N,J;return M!==null&&!isNaN(+M)&&(ie(w,"moment()."+w+"(period, number) is deprecated. Please use moment()."+w+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),J=C,C=M,M=J),N=Ht(C,M),Ni(this,N,p),this}}function Ni(p,w,C,M){var N=w._milliseconds,J=Zn(w._days),ge=Zn(w._months);p.isValid()&&(M=M??!0,ge&&pr(p,nt(p,"Month")+ge*C),J&&Dr(p,"Date",nt(p,"Date")+J*C),N&&p._d.setTime(p._d.valueOf()+N*C),M&&i.updateOffset(p,J||ge))}var To=Ii(1,"add"),Eo=Ii(-1,"subtract");function Di(p){return typeof p=="string"||p instanceof String}function xo(p){return V(p)||m(p)||Di(p)||f(p)||Mo(p)||Ro(p)||p===null||p===void 0}function Ro(p){var w=c(p)&&!h(p),C=!1,M=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],N,J,ge=M.length;for(N=0;N<ge;N+=1)J=M[N],C=C||u(p,J);return w&&C}function Mo(p){var w=a(p),C=!1;return w&&(C=p.filter(function(M){return!f(M)&&Di(p)}).length===0),w&&C}function ko(p){var w=c(p)&&!h(p),C=!1,M=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],N,J;for(N=0;N<M.length;N+=1)J=M[N],C=C||u(p,J);return w&&C}function Oo(p,w){var C=p.diff(w,"days",!0);return C<-6?"sameElse":C<-1?"lastWeek":C<0?"lastDay":C<1?"sameDay":C<2?"nextDay":C<7?"nextWeek":"sameElse"}function Po(p,w){arguments.length===1&&(arguments[0]?xo(arguments[0])?(p=arguments[0],w=void 0):ko(arguments[0])&&(w=arguments[0],p=void 0):(p=void 0,w=void 0));var C=p||tt(),M=Jn(C,this).startOf("day"),N=i.calendarFormat(this,M)||"sameElse",J=w&&(ue(w[N])?w[N].call(this,C):w[N]);return this.format(J||this.localeData().calendar(N,this,tt(C)))}function Ao(){return new L(this)}function Io(p,w){var C=V(p)?p:tt(p);return this.isValid()&&C.isValid()?(w=F(w)||"millisecond",w==="millisecond"?this.valueOf()>C.valueOf():C.valueOf()<this.clone().startOf(w).valueOf()):!1}function No(p,w){var C=V(p)?p:tt(p);return this.isValid()&&C.isValid()?(w=F(w)||"millisecond",w==="millisecond"?this.valueOf()<C.valueOf():this.clone().endOf(w).valueOf()<C.valueOf()):!1}function Do(p,w,C,M){var N=V(p)?p:tt(p),J=V(w)?w:tt(w);return this.isValid()&&N.isValid()&&J.isValid()?(M=M||"()",(M[0]==="("?this.isAfter(N,C):!this.isBefore(N,C))&&(M[1]===")"?this.isBefore(J,C):!this.isAfter(J,C))):!1}function Lo(p,w){var C=V(p)?p:tt(p),M;return this.isValid()&&C.isValid()?(w=F(w)||"millisecond",w==="millisecond"?this.valueOf()===C.valueOf():(M=C.valueOf(),this.clone().startOf(w).valueOf()<=M&&M<=this.clone().endOf(w).valueOf())):!1}function Ho(p,w){return this.isSame(p,w)||this.isAfter(p,w)}function Fo(p,w){return this.isSame(p,w)||this.isBefore(p,w)}function Vo(p,w,C){var M,N,J;if(!this.isValid())return NaN;if(M=Jn(p,this),!M.isValid())return NaN;switch(N=(M.utcOffset()-this.utcOffset())*6e4,w=F(w),w){case"year":J=_n(this,M)/12;break;case"month":J=_n(this,M);break;case"quarter":J=_n(this,M)/3;break;case"second":J=(this-M)/1e3;break;case"minute":J=(this-M)/6e4;break;case"hour":J=(this-M)/36e5;break;case"day":J=(this-M-N)/864e5;break;case"week":J=(this-M-N)/6048e5;break;default:J=this-M}return C?J:dt(J)}function _n(p,w){if(p.date()<w.date())return-_n(w,p);var C=(w.year()-p.year())*12+(w.month()-p.month()),M=p.clone().add(C,"months"),N,J;return w-M<0?(N=p.clone().add(C-1,"months"),J=(w-M)/(M-N)):(N=p.clone().add(C+1,"months"),J=(w-M)/(N-M)),-(C+J)||0}i.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",i.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Bo(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Wo(p){if(!this.isValid())return null;var w=p!==!0,C=w?this.clone().utc():this;return C.year()<0||C.year()>9999?we(C,w?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):ue(Date.prototype.toISOString)?w?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",we(C,"Z")):we(C,w?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function jo(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var p="moment",w="",C,M,N,J;return this.isLocal()||(p=this.utcOffset()===0?"moment.utc":"moment.parseZone",w="Z"),C="["+p+'("]',M=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",N="-MM-DD[T]HH:mm:ss.SSS",J=w+'[")]',this.format(C+M+N+J)}function Uo(p){p||(p=this.isUtc()?i.defaultFormatUtc:i.defaultFormat);var w=we(this,p);return this.localeData().postformat(w)}function zo(p,w){return this.isValid()&&(V(p)&&p.isValid()||tt(p).isValid())?Ht({to:this,from:p}).locale(this.locale()).humanize(!w):this.localeData().invalidDate()}function $o(p){return this.from(tt(),p)}function Yo(p,w){return this.isValid()&&(V(p)&&p.isValid()||tt(p).isValid())?Ht({from:this,to:p}).locale(this.locale()).humanize(!w):this.localeData().invalidDate()}function Go(p){return this.to(tt(),p)}function Li(p){var w;return p===void 0?this._locale._abbr:(w=Gt(p),w!=null&&(this._locale=w),this)}var Hi=W("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(p){return p===void 0?this.localeData():this.locale(p)});function Fi(){return this._locale}var yn=1e3,Pr=60*yn,bn=60*Pr,Vi=(365*400+97)*24*bn;function Ar(p,w){return(p%w+w)%w}function Bi(p,w,C){return p<100&&p>=0?new Date(p+400,w,C)-Vi:new Date(p,w,C).valueOf()}function Wi(p,w,C){return p<100&&p>=0?Date.UTC(p+400,w,C)-Vi:Date.UTC(p,w,C)}function qo(p){var w,C;if(p=F(p),p===void 0||p==="millisecond"||!this.isValid())return this;switch(C=this._isUTC?Wi:Bi,p){case"year":w=C(this.year(),0,1);break;case"quarter":w=C(this.year(),this.month()-this.month()%3,1);break;case"month":w=C(this.year(),this.month(),1);break;case"week":w=C(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":w=C(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":w=C(this.year(),this.month(),this.date());break;case"hour":w=this._d.valueOf(),w-=Ar(w+(this._isUTC?0:this.utcOffset()*Pr),bn);break;case"minute":w=this._d.valueOf(),w-=Ar(w,Pr);break;case"second":w=this._d.valueOf(),w-=Ar(w,yn);break}return this._d.setTime(w),i.updateOffset(this,!0),this}function Ko(p){var w,C;if(p=F(p),p===void 0||p==="millisecond"||!this.isValid())return this;switch(C=this._isUTC?Wi:Bi,p){case"year":w=C(this.year()+1,0,1)-1;break;case"quarter":w=C(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":w=C(this.year(),this.month()+1,1)-1;break;case"week":w=C(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":w=C(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":w=C(this.year(),this.month(),this.date()+1)-1;break;case"hour":w=this._d.valueOf(),w+=bn-Ar(w+(this._isUTC?0:this.utcOffset()*Pr),bn)-1;break;case"minute":w=this._d.valueOf(),w+=Pr-Ar(w,Pr)-1;break;case"second":w=this._d.valueOf(),w+=yn-Ar(w,yn)-1;break}return this._d.setTime(w),i.updateOffset(this,!0),this}function Zo(){return this._d.valueOf()-(this._offset||0)*6e4}function Xo(){return Math.floor(this.valueOf()/1e3)}function Jo(){return new Date(this.valueOf())}function Qo(){var p=this;return[p.year(),p.month(),p.date(),p.hour(),p.minute(),p.second(),p.millisecond()]}function ea(){var p=this;return{years:p.year(),months:p.month(),date:p.date(),hours:p.hours(),minutes:p.minutes(),seconds:p.seconds(),milliseconds:p.milliseconds()}}function ta(){return this.isValid()?this.toISOString():null}function ra(){return A(this)}function na(){return v({},S(this))}function ia(){return S(this).overflow}function sa(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}B("N",0,0,"eraAbbr"),B("NN",0,0,"eraAbbr"),B("NNN",0,0,"eraAbbr"),B("NNNN",0,0,"eraName"),B("NNNNN",0,0,"eraNarrow"),B("y",["y",1],"yo","eraYear"),B("y",["yy",2],0,"eraYear"),B("y",["yyy",3],0,"eraYear"),B("y",["yyyy",4],0,"eraYear"),Oe("N",ei),Oe("NN",ei),Oe("NNN",ei),Oe("NNNN",pa),Oe("NNNNN",va),Je(["N","NN","NNN","NNNN","NNNNN"],function(p,w,C,M){var N=C._locale.erasParse(p,M,C._strict);N?S(C).era=N:S(C).invalidEra=p}),Oe("y",Me),Oe("yy",Me),Oe("yyy",Me),Oe("yyyy",Me),Oe("yo",wa),Je(["y","yy","yyy","yyyy"],vt),Je(["yo"],function(p,w,C,M){var N;C._locale._eraYearOrdinalRegex&&(N=p.match(C._locale._eraYearOrdinalRegex)),C._locale.eraYearOrdinalParse?w[vt]=C._locale.eraYearOrdinalParse(p,N):w[vt]=parseInt(p,10)});function oa(p,w){var C,M,N,J=this._eras||Gt("en")._eras;for(C=0,M=J.length;C<M;++C){switch(typeof J[C].since){case"string":N=i(J[C].since).startOf("day"),J[C].since=N.valueOf();break}switch(typeof J[C].until){case"undefined":J[C].until=1/0;break;case"string":N=i(J[C].until).startOf("day").valueOf(),J[C].until=N.valueOf();break}}return J}function aa(p,w,C){var M,N,J=this.eras(),ge,He,ze;for(p=p.toUpperCase(),M=0,N=J.length;M<N;++M)if(ge=J[M].name.toUpperCase(),He=J[M].abbr.toUpperCase(),ze=J[M].narrow.toUpperCase(),C)switch(w){case"N":case"NN":case"NNN":if(He===p)return J[M];break;case"NNNN":if(ge===p)return J[M];break;case"NNNNN":if(ze===p)return J[M];break}else if([ge,He,ze].indexOf(p)>=0)return J[M]}function la(p,w){var C=p.since<=p.until?1:-1;return w===void 0?i(p.since).year():i(p.since).year()+(w-p.offset)*C}function ca(){var p,w,C,M=this.localeData().eras();for(p=0,w=M.length;p<w;++p)if(C=this.clone().startOf("day").valueOf(),M[p].since<=C&&C<=M[p].until||M[p].until<=C&&C<=M[p].since)return M[p].name;return""}function ua(){var p,w,C,M=this.localeData().eras();for(p=0,w=M.length;p<w;++p)if(C=this.clone().startOf("day").valueOf(),M[p].since<=C&&C<=M[p].until||M[p].until<=C&&C<=M[p].since)return M[p].narrow;return""}function ha(){var p,w,C,M=this.localeData().eras();for(p=0,w=M.length;p<w;++p)if(C=this.clone().startOf("day").valueOf(),M[p].since<=C&&C<=M[p].until||M[p].until<=C&&C<=M[p].since)return M[p].abbr;return""}function da(){var p,w,C,M,N=this.localeData().eras();for(p=0,w=N.length;p<w;++p)if(C=N[p].since<=N[p].until?1:-1,M=this.clone().startOf("day").valueOf(),N[p].since<=M&&M<=N[p].until||N[p].until<=M&&M<=N[p].since)return(this.year()-i(N[p].since).year())*C+N[p].offset;return this.year()}function fa(p){return u(this,"_erasNameRegex")||ti.call(this),p?this._erasNameRegex:this._erasRegex}function ma(p){return u(this,"_erasAbbrRegex")||ti.call(this),p?this._erasAbbrRegex:this._erasRegex}function ga(p){return u(this,"_erasNarrowRegex")||ti.call(this),p?this._erasNarrowRegex:this._erasRegex}function ei(p,w){return w.erasAbbrRegex(p)}function pa(p,w){return w.erasNameRegex(p)}function va(p,w){return w.erasNarrowRegex(p)}function wa(p,w){return w._eraYearOrdinalRegex||Me}function ti(){var p=[],w=[],C=[],M=[],N,J,ge,He,ze,qe=this.eras();for(N=0,J=qe.length;N<J;++N)ge=et(qe[N].name),He=et(qe[N].abbr),ze=et(qe[N].narrow),w.push(ge),p.push(He),C.push(ze),M.push(ge),M.push(He),M.push(ze);this._erasRegex=new RegExp("^("+M.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+w.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+p.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+C.join("|")+")","i")}B(0,["gg",2],0,function(){return this.weekYear()%100}),B(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Cn(p,w){B(0,[p,p.length],0,w)}Cn("gggg","weekYear"),Cn("ggggg","weekYear"),Cn("GGGG","isoWeekYear"),Cn("GGGGG","isoWeekYear"),Oe("G",Pe),Oe("g",Pe),Oe("GG",K,ee),Oe("gg",K,ee),Oe("GGGG",ae,j),Oe("gggg",ae,j),Oe("GGGGG",Ee,U),Oe("ggggg",Ee,U),dr(["gggg","ggggg","GGGG","GGGGG"],function(p,w,C,M){w[M.substr(0,2)]=Ye(p)}),dr(["gg","GG"],function(p,w,C,M){w[M]=i.parseTwoDigitYear(p)});function _a(p){return ji.call(this,p,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function ya(p){return ji.call(this,p,this.isoWeek(),this.isoWeekday(),1,4)}function ba(){return Ot(this.year(),1,4)}function Ca(){return Ot(this.isoWeekYear(),1,4)}function Sa(){var p=this.localeData()._week;return Ot(this.year(),p.dow,p.doy)}function Ta(){var p=this.localeData()._week;return Ot(this.weekYear(),p.dow,p.doy)}function ji(p,w,C,M,N){var J;return p==null?nr(this,M,N).year:(J=Ot(p,M,N),w>J&&(w=J),Ea.call(this,p,w,C,M,N))}function Ea(p,w,C,M,N){var J=Ur(p,w,C,M,N),ge=Pt(J.year,0,J.dayOfYear);return this.year(ge.getUTCFullYear()),this.month(ge.getUTCMonth()),this.date(ge.getUTCDate()),this}B("Q",0,"Qo","quarter"),Oe("Q",ce),Je("Q",function(p,w){w[mt]=(Ye(p)-1)*3});function xa(p){return p==null?Math.ceil((this.month()+1)/3):this.month((p-1)*3+this.month()%3)}B("D",["DD",2],"Do","date"),Oe("D",K,yt),Oe("DD",K,ee),Oe("Do",function(p,w){return p?w._dayOfMonthOrdinalParse||w._ordinalParse:w._dayOfMonthOrdinalParseLenient}),Je(["D","DD"],Rt),Je("Do",function(p,w){w[Rt]=Ye(p.match(K)[0])});var Ui=jt("Date",!0);B("DDD",["DDDD",3],"DDDo","dayOfYear"),Oe("DDD",Ie),Oe("DDDD",te),Je(["DDD","DDDD"],function(p,w,C){C._dayOfYear=Ye(p)});function Ra(p){var w=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return p==null?w:this.add(p-w,"d")}B("m",["mm",2],0,"minute"),Oe("m",K,rt),Oe("mm",K,ee),Je(["m","mm"],Et);var Ma=jt("Minutes",!1);B("s",["ss",2],0,"second"),Oe("s",K,rt),Oe("ss",K,ee),Je(["s","ss"],It);var ka=jt("Seconds",!1);B("S",0,0,function(){return~~(this.millisecond()/100)}),B(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),B(0,["SSS",3],0,"millisecond"),B(0,["SSSS",4],0,function(){return this.millisecond()*10}),B(0,["SSSSS",5],0,function(){return this.millisecond()*100}),B(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),B(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),B(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),B(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),Oe("S",Ie,ce),Oe("SS",Ie,ee),Oe("SSS",Ie,te);var or,zi;for(or="SSSS";or.length<=9;or+="S")Oe(or,Me);function Oa(p,w){w[Wt]=Ye(("0."+p)*1e3)}for(or="S";or.length<=9;or+="S")Je(or,Oa);zi=jt("Milliseconds",!1),B("z",0,0,"zoneAbbr"),B("zz",0,0,"zoneName");function Pa(){return this._isUTC?"UTC":""}function Aa(){return this._isUTC?"Coordinated Universal Time":""}var ke=L.prototype;ke.add=To,ke.calendar=Po,ke.clone=Ao,ke.diff=Vo,ke.endOf=Ko,ke.format=Uo,ke.from=zo,ke.fromNow=$o,ke.to=Yo,ke.toNow=Go,ke.get=ct,ke.invalidAt=ia,ke.isAfter=Io,ke.isBefore=No,ke.isBetween=Do,ke.isSame=Lo,ke.isSameOrAfter=Ho,ke.isSameOrBefore=Fo,ke.isValid=ra,ke.lang=Hi,ke.locale=Li,ke.localeData=Fi,ke.max=eo,ke.min=Qs,ke.parsingFlags=na,ke.set=mr,ke.startOf=qo,ke.subtract=Eo,ke.toArray=Qo,ke.toObject=ea,ke.toDate=Jo,ke.toISOString=Wo,ke.inspect=jo,typeof Symbol<"u"&&Symbol.for!=null&&(ke[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),ke.toJSON=ta,ke.toString=Bo,ke.unix=Xo,ke.valueOf=Zo,ke.creationData=sa,ke.eraName=ca,ke.eraNarrow=ua,ke.eraAbbr=ha,ke.eraYear=da,ke.year=Sr,ke.isLeapYear=gt,ke.weekYear=_a,ke.isoWeekYear=ya,ke.quarter=ke.quarters=xa,ke.month=Wr,ke.daysInMonth=on,ke.week=ke.weeks=ir,ke.isoWeek=ke.isoWeeks=zr,ke.weeksInYear=Sa,ke.weeksInWeekYear=Ta,ke.isoWeeksInYear=ba,ke.isoWeeksInISOWeekYear=Ca,ke.date=Ui,ke.day=ke.days=Gr,ke.weekday=zn,ke.isoWeekday=Mt,ke.dayOfYear=Ra,ke.hour=ke.hours=$n,ke.minute=ke.minutes=Ma,ke.second=ke.seconds=ka,ke.millisecond=ke.milliseconds=zi,ke.utcOffset=uo,ke.utc=fo,ke.local=mo,ke.parseZone=go,ke.hasAlignedHourOffset=po,ke.isDST=vo,ke.isLocal=_o,ke.isUtcOffset=yo,ke.isUtc=Pi,ke.isUTC=Pi,ke.zoneAbbr=Pa,ke.zoneName=Aa,ke.dates=W("dates accessor is deprecated. Use date instead.",Ui),ke.months=W("months accessor is deprecated. Use month instead",Wr),ke.years=W("years accessor is deprecated. Use year instead",Sr),ke.zone=W("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",ho),ke.isDSTShifted=W("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",wo);function Ia(p){return tt(p*1e3)}function Na(){return tt.apply(null,arguments).parseZone()}function $i(p){return p}var Ze=pe.prototype;Ze.calendar=Le,Ze.longDateFormat=fe,Ze.invalidDate=Ne,Ze.ordinal=Be,Ze.preparse=$i,Ze.postformat=$i,Ze.relativeTime=je,Ze.pastFuture=We,Ze.set=_e,Ze.eras=oa,Ze.erasParse=aa,Ze.erasConvertYear=la,Ze.erasAbbrRegex=ma,Ze.erasNameRegex=fa,Ze.erasNarrowRegex=ga,Ze.months=Vr,Ze.monthsShort=Br,Ze.monthsParse=Tr,Ze.monthsRegex=jr,Ze.monthsShortRegex=Vn,Ze.week=an,Ze.firstDayOfYear=Nt,Ze.firstDayOfWeek=xr,Ze.weekdays=Yr,Ze.weekdaysMin=hn,Ze.weekdaysShort=un,Ze.weekdaysParse=Rr,Ze.weekdaysRegex=Mr,Ze.weekdaysShortRegex=dn,Ze.weekdaysMinRegex=fn,Ze.isPM=mn,Ze.meridiem=Fe;function Sn(p,w,C,M){var N=Gt(),J=_().set(M,w);return N[C](J,p)}function Yi(p,w,C){if(f(p)&&(w=p,p=void 0),p=p||"",w!=null)return Sn(p,w,C,"month");var M,N=[];for(M=0;M<12;M++)N[M]=Sn(p,M,C,"month");return N}function ri(p,w,C,M){typeof p=="boolean"?(f(w)&&(C=w,w=void 0),w=w||""):(w=p,C=w,p=!1,f(w)&&(C=w,w=void 0),w=w||"");var N=Gt(),J=p?N._week.dow:0,ge,He=[];if(C!=null)return Sn(w,(C+J)%7,M,"day");for(ge=0;ge<7;ge++)He[ge]=Sn(w,(ge+J)%7,M,"day");return He}function Da(p,w){return Yi(p,w,"months")}function La(p,w){return Yi(p,w,"monthsShort")}function Ha(p,w,C){return ri(p,w,C,"weekdays")}function Fa(p,w,C){return ri(p,w,C,"weekdaysShort")}function Va(p,w,C){return ri(p,w,C,"weekdaysMin")}At("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(p){var w=p%10,C=Ye(p%100/10)===1?"th":w===1?"st":w===2?"nd":w===3?"rd":"th";return p+C}}),i.lang=W("moment.lang is deprecated. Use moment.locale instead.",At),i.langData=W("moment.langData is deprecated. Use moment.localeData instead.",Gt);var qt=Math.abs;function Ba(){var p=this._data;return this._milliseconds=qt(this._milliseconds),this._days=qt(this._days),this._months=qt(this._months),p.milliseconds=qt(p.milliseconds),p.seconds=qt(p.seconds),p.minutes=qt(p.minutes),p.hours=qt(p.hours),p.months=qt(p.months),p.years=qt(p.years),this}function Gi(p,w,C,M){var N=Ht(w,C);return p._milliseconds+=M*N._milliseconds,p._days+=M*N._days,p._months+=M*N._months,p._bubble()}function Wa(p,w){return Gi(this,p,w,1)}function ja(p,w){return Gi(this,p,w,-1)}function qi(p){return p<0?Math.floor(p):Math.ceil(p)}function Ua(){var p=this._milliseconds,w=this._days,C=this._months,M=this._data,N,J,ge,He,ze;return p>=0&&w>=0&&C>=0||p<=0&&w<=0&&C<=0||(p+=qi(ni(C)+w)*864e5,w=0,C=0),M.milliseconds=p%1e3,N=dt(p/1e3),M.seconds=N%60,J=dt(N/60),M.minutes=J%60,ge=dt(J/60),M.hours=ge%24,w+=dt(ge/24),ze=dt(Ki(w)),C+=ze,w-=qi(ni(ze)),He=dt(C/12),C%=12,M.days=w,M.months=C,M.years=He,this}function Ki(p){return p*4800/146097}function ni(p){return p*146097/4800}function za(p){if(!this.isValid())return NaN;var w,C,M=this._milliseconds;if(p=F(p),p==="month"||p==="quarter"||p==="year")switch(w=this._days+M/864e5,C=this._months+Ki(w),p){case"month":return C;case"quarter":return C/3;case"year":return C/12}else switch(w=this._days+Math.round(ni(this._months)),p){case"week":return w/7+M/6048e5;case"day":return w+M/864e5;case"hour":return w*24+M/36e5;case"minute":return w*1440+M/6e4;case"second":return w*86400+M/1e3;case"millisecond":return Math.floor(w*864e5)+M;default:throw new Error("Unknown unit "+p)}}function Kt(p){return function(){return this.as(p)}}var Zi=Kt("ms"),$a=Kt("s"),Ya=Kt("m"),Ga=Kt("h"),qa=Kt("d"),Ka=Kt("w"),Za=Kt("M"),Xa=Kt("Q"),Ja=Kt("y"),Qa=Zi;function el(){return Ht(this)}function tl(p){return p=F(p),this.isValid()?this[p+"s"]():NaN}function yr(p){return function(){return this.isValid()?this._data[p]:NaN}}var rl=yr("milliseconds"),nl=yr("seconds"),il=yr("minutes"),sl=yr("hours"),ol=yr("days"),al=yr("months"),ll=yr("years");function cl(){return dt(this.days()/7)}var Zt=Math.round,Ir={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function ul(p,w,C,M,N){return N.relativeTime(w||1,!!C,p,M)}function hl(p,w,C,M){var N=Ht(p).abs(),J=Zt(N.as("s")),ge=Zt(N.as("m")),He=Zt(N.as("h")),ze=Zt(N.as("d")),qe=Zt(N.as("M")),xt=Zt(N.as("w")),Xt=Zt(N.as("y")),ar=J<=C.ss&&["s",J]||J<C.s&&["ss",J]||ge<=1&&["m"]||ge<C.m&&["mm",ge]||He<=1&&["h"]||He<C.h&&["hh",He]||ze<=1&&["d"]||ze<C.d&&["dd",ze];return C.w!=null&&(ar=ar||xt<=1&&["w"]||xt<C.w&&["ww",xt]),ar=ar||qe<=1&&["M"]||qe<C.M&&["MM",qe]||Xt<=1&&["y"]||["yy",Xt],ar[2]=w,ar[3]=+p>0,ar[4]=M,ul.apply(null,ar)}function dl(p){return p===void 0?Zt:typeof p=="function"?(Zt=p,!0):!1}function fl(p,w){return Ir[p]===void 0?!1:w===void 0?Ir[p]:(Ir[p]=w,p==="s"&&(Ir.ss=w-1),!0)}function ml(p,w){if(!this.isValid())return this.localeData().invalidDate();var C=!1,M=Ir,N,J;return typeof p=="object"&&(w=p,p=!1),typeof p=="boolean"&&(C=p),typeof w=="object"&&(M=Object.assign({},Ir,w),w.s!=null&&w.ss==null&&(M.ss=w.s-1)),N=this.localeData(),J=hl(this,!C,M,N),C&&(J=N.pastFuture(+this,J)),N.postformat(J)}var ii=Math.abs;function Nr(p){return(p>0)-(p<0)||+p}function Tn(){if(!this.isValid())return this.localeData().invalidDate();var p=ii(this._milliseconds)/1e3,w=ii(this._days),C=ii(this._months),M,N,J,ge,He=this.asSeconds(),ze,qe,xt,Xt;return He?(M=dt(p/60),N=dt(M/60),p%=60,M%=60,J=dt(C/12),C%=12,ge=p?p.toFixed(3).replace(/\.?0+$/,""):"",ze=He<0?"-":"",qe=Nr(this._months)!==Nr(He)?"-":"",xt=Nr(this._days)!==Nr(He)?"-":"",Xt=Nr(this._milliseconds)!==Nr(He)?"-":"",ze+"P"+(J?qe+J+"Y":"")+(C?qe+C+"M":"")+(w?xt+w+"D":"")+(N||M||p?"T":"")+(N?Xt+N+"H":"")+(M?Xt+M+"M":"")+(p?Xt+ge+"S":"")):"P0D"}var Ke=vn.prototype;return Ke.isValid=oo,Ke.abs=Ba,Ke.add=Wa,Ke.subtract=ja,Ke.as=za,Ke.asMilliseconds=Zi,Ke.asSeconds=$a,Ke.asMinutes=Ya,Ke.asHours=Ga,Ke.asDays=qa,Ke.asWeeks=Ka,Ke.asMonths=Za,Ke.asQuarters=Xa,Ke.asYears=Ja,Ke.valueOf=Qa,Ke._bubble=Ua,Ke.clone=el,Ke.get=tl,Ke.milliseconds=rl,Ke.seconds=nl,Ke.minutes=il,Ke.hours=sl,Ke.days=ol,Ke.weeks=cl,Ke.months=al,Ke.years=ll,Ke.humanize=ml,Ke.toISOString=Tn,Ke.toString=Tn,Ke.toJSON=Tn,Ke.locale=Li,Ke.localeData=Fi,Ke.toIsoString=W("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Tn),Ke.lang=Hi,B("X",0,0,"unix"),B("x",0,0,"valueOf"),Oe("x",Pe),Oe("X",ut),Je("X",function(p,w,C){C._d=new Date(parseFloat(p)*1e3)}),Je("x",function(p,w,C){C._d=new Date(Ye(p))}),i.version="2.30.1",o(tt),i.fn=ke,i.min=ro,i.max=no,i.now=io,i.utc=_,i.unix=Ia,i.months=Da,i.isDate=m,i.locale=At,i.invalid=I,i.duration=Ht,i.isMoment=V,i.weekdays=Ha,i.parseZone=Na,i.localeData=Gt,i.isDuration=wn,i.monthsShort=La,i.weekdaysMin=Va,i.defineLocale=kr,i.updateLocale=Ti,i.locales=Is,i.weekdaysShort=Fa,i.normalizeUnits=F,i.relativeTimeRounding=dl,i.relativeTimeThreshold=fl,i.calendarFormat=Oo,i.prototype=ke,i.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},i})}}),require_get_json_replacer_function=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/get-json-replacer-function.js"(e,t){"use strict";var r=require_function_uncurry_this(),i=require_is_array(),o=require_is_callable(),a=require_classof_raw(),c=require_to_string(),u=r([].push);t.exports=function(h){if(o(h))return h;if(i(h)){for(var d=h.length,f=[],m=0;m<d;m++){var g=h[m];typeof g=="string"?u(f,g):(typeof g=="number"||a(g)==="Number"||a(g)==="String")&&u(f,c(g))}var v=f.length,_=!0;return function(b,S){if(_)return _=!1,S;if(i(this))return S;for(var R=0;R<v;R++)if(f[R]===b)return S}}}}}),require_es_json_stringify=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.json.stringify.js"(){"use strict";var e=require_export(),t=require_get_built_in(),r=require_function_apply(),i=require_function_call(),o=require_function_uncurry_this(),a=require_fails(),c=require_is_callable(),u=require_is_symbol(),h=require_array_slice(),d=require_get_json_replacer_function(),f=require_symbol_constructor_detection(),m=String,g=t("JSON","stringify"),v=o(/./.exec),_=o("".charAt),b=o("".charCodeAt),S=o("".replace),R=o(1 .toString),A=/[\uD800-\uDFFF]/g,I=/^[\uD800-\uDBFF]$/,E=/^[\uDC00-\uDFFF]$/,O=!f||a(function(){var $=t("Symbol")("stringify detection");return g([$])!=="[null]"||g({a:$})!=="{}"||g(Object($))!=="{}"}),P=a(function(){return g("\uDF06\uD834")!=='"\\udf06\\ud834"'||g("\uDEAD")!=='"\\udead"'}),L=function($,W){var Z=h(arguments),ie=d(W);if(!(!c(ie)&&($===void 0||u($))))return Z[1]=function(ue,_e){if(c(ie)&&(_e=i(ie,this,m(ue),_e)),!u(_e))return _e},r(g,null,Z)},V=function($,W,Z){var ie=_(Z,W-1),ue=_(Z,W+1);return v(I,$)&&!v(E,ue)||v(E,$)&&!v(I,ie)?"\\u"+R(b($,0),16):$};g&&e({target:"JSON",stat:!0,arity:3,forced:O||P},{stringify:function(W,Z,ie){var ue=h(arguments),_e=r(O?L:g,null,ue);return P&&typeof _e=="string"?S(_e,A,V):_e}})}}),require_object_keys=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-keys.js"(e,t){"use strict";var r=require_object_keys_internal(),i=require_enum_bug_keys();t.exports=Object.keys||function(a){return r(a,i)}}}),require_object_define_properties=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-define-properties.js"(e){"use strict";var t=require_descriptors(),r=require_v8_prototype_define_bug(),i=require_object_define_property(),o=require_an_object(),a=require_to_indexed_object(),c=require_object_keys();e.f=t&&!r?Object.defineProperties:function(h,d){o(h);for(var f=a(d),m=c(d),g=m.length,v=0,_;g>v;)i.f(h,_=m[v++],f[_]);return h}}}),require_object_create=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/object-create.js"(e,t){"use strict";var r=require_an_object(),i=require_object_define_properties(),o=require_enum_bug_keys(),a=require_hidden_keys(),c=require_html(),u=require_document_create_element(),h=require_shared_key(),d=">",f="<",m="prototype",g="script",v=h("IE_PROTO"),_=function(){},b=function(E){return f+g+d+E+f+"/"+g+d},S=function(E){E.write(b("")),E.close();var O=E.parentWindow.Object;return E=null,O},R=function(){var E=u("iframe"),O="java"+g+":",P;return E.style.display="none",c.appendChild(E),E.src=String(O),P=E.contentWindow.document,P.open(),P.write(b("document.F=Object")),P.close(),P.F},A,I=function(){try{A=new ActiveXObject("htmlfile")}catch{}I=typeof document<"u"?document.domain&&A?S(A):R():S(A);for(var E=o.length;E--;)delete I[m][o[E]];return I()};a[v]=!0,t.exports=Object.create||function(O,P){var L;return O!==null?(_[m]=r(O),L=new _,_[m]=null,L[v]=O):L=I(),P===void 0?L:i.f(L,P)}}}),require_add_to_unscopables=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/add-to-unscopables.js"(e,t){"use strict";var r=require_well_known_symbol(),i=require_object_create(),o=require_object_define_property().f,a=r("unscopables"),c=Array.prototype;c[a]===void 0&&o(c,a,{configurable:!0,value:i(null)}),t.exports=function(u){c[a][u]=!0}}}),require_es_array_unscopables_flat_map=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.array.unscopables.flat-map.js"(){"use strict";var e=require_add_to_unscopables();e("flatMap")}}),require_is_regexp=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/is-regexp.js"(e,t){"use strict";var r=require_is_object(),i=require_classof_raw(),o=require_well_known_symbol(),a=o("match");t.exports=function(c){var u;return r(c)&&((u=c[a])!==void 0?!!u:i(c)==="RegExp")}}}),require_regexp_flags=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/regexp-flags.js"(e,t){"use strict";var r=require_an_object();t.exports=function(){var i=r(this),o="";return i.hasIndices&&(o+="d"),i.global&&(o+="g"),i.ignoreCase&&(o+="i"),i.multiline&&(o+="m"),i.dotAll&&(o+="s"),i.unicode&&(o+="u"),i.unicodeSets&&(o+="v"),i.sticky&&(o+="y"),o}}}),require_regexp_get_flags=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/regexp-get-flags.js"(e,t){"use strict";var r=require_function_call(),i=require_has_own_property(),o=require_object_is_prototype_of(),a=require_regexp_flags(),c=RegExp.prototype;t.exports=function(u){var h=u.flags;return h===void 0&&!("flags"in c)&&!i(u,"flags")&&o(c,u)?r(a,u):h}}}),require_get_substitution=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/get-substitution.js"(e,t){"use strict";var r=require_function_uncurry_this(),i=require_to_object(),o=Math.floor,a=r("".charAt),c=r("".replace),u=r("".slice),h=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,d=/\$([$&'`]|\d{1,2})/g;t.exports=function(f,m,g,v,_,b){var S=g+f.length,R=v.length,A=d;return _!==void 0&&(_=i(_),A=h),c(b,A,function(I,E){var O;switch(a(E,0)){case"$":return"$";case"&":return f;case"`":return u(m,0,g);case"'":return u(m,S);case"<":O=_[u(E,1,-1)];break;default:var P=+E;if(P===0)return I;if(P>R){var L=o(P/10);return L===0?I:L<=R?v[L-1]===void 0?a(E,1):v[L-1]+a(E,1):I}O=v[P-1]}return O===void 0?"":O})}}}),require_es_string_replace_all=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.string.replace-all.js"(){"use strict";var e=require_export(),t=require_function_call(),r=require_function_uncurry_this(),i=require_require_object_coercible(),o=require_is_callable(),a=require_is_null_or_undefined(),c=require_is_regexp(),u=require_to_string(),h=require_get_method(),d=require_regexp_get_flags(),f=require_get_substitution(),m=require_well_known_symbol(),g=require_is_pure(),v=m("replace"),_=TypeError,b=r("".indexOf),S=r("".replace),R=r("".slice),A=Math.max;e({target:"String",proto:!0},{replaceAll:function(E,O){var P=i(this),L,V,$,W,Z,ie,ue,_e,Te,pe,me=0,Se="";if(!a(E)){if(L=c(E),L&&(V=u(i(d(E))),!~b(V,"g")))throw new _("`.replaceAll` does not allow non-global regexes");if($=h(E,v),$)return t($,E,P,O);if(g&&L)return S(u(P),E,O)}for(W=u(P),Z=u(E),ie=o(O),ie||(O=u(O)),ue=Z.length,_e=A(1,ue),Te=b(W,Z);Te!==-1;)pe=ie?u(O(Z,Te,W)):f(Z,W,Te,[],void 0,O),Se+=R(W,me,Te)+pe,me=Te+ue,Te=Te+_e>W.length?-1:b(W,Z,Te+_e);return me<W.length&&(Se+=R(W,me)),Se}})}}),require_es_array_at=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.array.at.js"(){"use strict";var e=require_export(),t=require_to_object(),r=require_length_of_array_like(),i=require_to_integer_or_infinity(),o=require_add_to_unscopables();e({target:"Array",proto:!0},{at:function(c){var u=t(this),h=r(u),d=i(c),f=d>=0?d:h+d;return f<0||f>=h?void 0:u[f]}}),o("at")}}),require_es_string_at_alternative=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.string.at-alternative.js"(){"use strict";var e=require_export(),t=require_function_uncurry_this(),r=require_require_object_coercible(),i=require_to_integer_or_infinity(),o=require_to_string(),a=require_fails(),c=t("".charAt),u=a(function(){return"\u{20BB7}".at(-2)!=="\uD842"});e({target:"String",proto:!0,forced:u},{at:function(d){var f=o(r(this)),m=f.length,g=i(d),v=g>=0?g:m+g;return v<0||v>=m?void 0:c(f,v)}})}}),require_es_array_unscopables_flat=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.array.unscopables.flat.js"(){"use strict";var e=require_add_to_unscopables();e("flat")}}),require_numbro_min=__commonJS({"node_modules/.pnpm/numbro@2.1.2/node_modules/numbro/dist/numbro.min.js"(e,t){(function(r){typeof e=="object"&&typeof t<"u"?t.exports=r():typeof define=="function"&&define.amd?define([],r):(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this).numbro=r()})(function(){return function r(i,o,a){function c(d,f){if(!o[d]){if(!i[d]){var m=typeof __require=="function"&&__require;if(!f&&m)return m(d,!0);if(u)return u(d,!0);var g=new Error("Cannot find module '"+d+"'");throw g.code="MODULE_NOT_FOUND",g}var v=o[d]={exports:{}};i[d][0].call(v.exports,function(_){return c(i[d][1][_]||_)},v,v.exports,r,i,o,a)}return o[d].exports}for(var u=typeof __require=="function"&&__require,h=0;h<a.length;h++)c(a[h]);return c}({1:[function(r,i,o){(function(a){"use strict";var c,u=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,h=Math.ceil,d=Math.floor,f="[BigNumber Error] ",m=f+"Number primitive has more than 15 significant digits: ",g=1e14,v=14,_=9007199254740991,b=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],S=1e7,R=1e9;function A($){var W=0|$;return 0<$||$===W?W:W-1}function I($){for(var W,Z,ie=1,ue=$.length,_e=$[0]+"";ie<ue;){for(W=$[ie++]+"",Z=v-W.length;Z--;W="0"+W);_e+=W}for(ue=_e.length;_e.charCodeAt(--ue)===48;);return _e.slice(0,ue+1||1)}function E($,W){var Z,ie,ue=$.c,_e=W.c,Te=$.s,pe=W.s,me=$.e,Se=W.e;if(!Te||!pe)return null;if(Z=ue&&!ue[0],ie=_e&&!_e[0],Z||ie)return Z?ie?0:-pe:Te;if(Te!=pe)return Te;if(Z=Te<0,ie=me==Se,!ue||!_e)return ie?0:!ue^Z?1:-1;if(!ie)return Se<me^Z?1:-1;for(pe=(me=ue.length)<(Se=_e.length)?me:Se,Te=0;Te<pe;Te++)if(ue[Te]!=_e[Te])return ue[Te]>_e[Te]^Z?1:-1;return me==Se?0:Se<me^Z?1:-1}function O($,W,Z,ie){if($<W||Z<$||$!==($<0?h($):d($)))throw Error(f+(ie||"Argument")+(typeof $=="number"?$<W||Z<$?" out of range: ":" not an integer: ":" not a primitive number: ")+String($))}function P($){var W=$.c.length-1;return A($.e/v)==W&&$.c[W]%2!=0}function L($,W){return(1<$.length?$.charAt(0)+"."+$.slice(1):$)+(W<0?"e":"e+")+W}function V($,W,Z){var ie,ue;if(W<0){for(ue=Z+".";++W;ue+=Z);$=ue+$}else if(++W>(ie=$.length)){for(ue=Z,W-=ie;--W;ue+=Z);$+=ue}else W<ie&&($=$.slice(0,W)+"."+$.slice(W));return $}(c=function $(W){var Z,ie,ue,_e,Te,pe,me,Se,Le,xe,T=le.prototype={constructor:le,toString:null,valueOf:null},k=new le(1),D=20,q=4,B=-7,se=21,ye=-1e7,we=1e7,de=!1,be=1,fe=0,he={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},Ne="0123456789abcdefghijklmnopqrstuvwxyz";function le(H,F){var G,oe,Q,ce,ee,te,j,U,K=this;if(!(K instanceof le))return new le(H,F);if(F==null){if(H instanceof le)return K.s=H.s,K.e=H.e,void(K.c=(H=H.c)?H.slice():H);if((te=typeof H=="number")&&0*H==0){if(K.s=1/H<0?(H=-H,-1):1,H===~~H){for(ce=0,ee=H;10<=ee;ee/=10,ce++);return K.e=ce,void(K.c=[H])}U=String(H)}else{if(U=String(H),!u.test(U))return ue(K,U,te);K.s=U.charCodeAt(0)==45?(U=U.slice(1),-1):1}-1<(ce=U.indexOf("."))&&(U=U.replace(".","")),0<(ee=U.search(/e/i))?(ce<0&&(ce=ee),ce+=+U.slice(ee+1),U=U.substring(0,ee)):ce<0&&(ce=U.length)}else{if(O(F,2,Ne.length,"Base"),U=String(H),F==10)return je(K=new le(H instanceof le?H:U),D+K.e+1,q);if(te=typeof H=="number"){if(0*H!=0)return ue(K,U,te,F);if(K.s=1/H<0?(U=U.slice(1),-1):1,le.DEBUG&&15<U.replace(/^0\.0*|\./,"").length)throw Error(m+H);te=!1}else K.s=U.charCodeAt(0)===45?(U=U.slice(1),-1):1;for(G=Ne.slice(0,F),ce=ee=0,j=U.length;ee<j;ee++)if(G.indexOf(oe=U.charAt(ee))<0){if(oe=="."){if(ce<ee){ce=j;continue}}else if(!Q&&(U==U.toUpperCase()&&(U=U.toLowerCase())||U==U.toLowerCase()&&(U=U.toUpperCase()))){Q=!0,ee=-1,ce=0;continue}return ue(K,String(H),te,F)}-1<(ce=(U=ie(U,F,10,K.s)).indexOf("."))?U=U.replace(".",""):ce=U.length}for(ee=0;U.charCodeAt(ee)===48;ee++);for(j=U.length;U.charCodeAt(--j)===48;);if(U=U.slice(ee,++j)){if(j-=ee,te&&le.DEBUG&&15<j&&(_<H||H!==d(H)))throw Error(m+K.s*H);if(we<(ce=ce-ee-1))K.c=K.e=null;else if(ce<ye)K.c=[K.e=0];else{if(K.e=ce,K.c=[],ee=(ce+1)%v,ce<0&&(ee+=v),ee<j){for(ee&&K.c.push(+U.slice(0,ee)),j-=v;ee<j;)K.c.push(+U.slice(ee,ee+=v));U=U.slice(ee),ee=v-U.length}else ee-=j;for(;ee--;U+="0");K.c.push(+U)}}else K.c=[K.e=0]}function Ve(H,F,G,oe){var Q,ce,ee,te,j;if(G==null?G=q:O(G,0,8),!H.c)return H.toString();if(Q=H.c[0],ee=H.e,F==null)j=I(H.c),j=oe==1||oe==2&&(ee<=B||se<=ee)?L(j,ee):V(j,ee,"0");else if(ce=(H=je(new le(H),F,G)).e,te=(j=I(H.c)).length,oe==1||oe==2&&(F<=ce||ce<=B)){for(;te<F;j+="0",te++);j=L(j,ce)}else if(F-=ee,j=V(j,ce,"0"),te<ce+1){if(0<--F)for(j+=".";F--;j+="0");}else if(0<(F+=ce-te))for(ce+1==te&&(j+=".");F--;j+="0");return H.s<0&&Q?"-"+j:j}function Be(H,F){for(var G,oe=1,Q=new le(H[0]);oe<H.length;oe++){if(!(G=new le(H[oe])).s){Q=G;break}F.call(Q,G)&&(Q=G)}return Q}function Ue(H,F,G){for(var oe=1,Q=F.length;!F[--Q];F.pop());for(Q=F[0];10<=Q;Q/=10,oe++);return(G=oe+G*v-1)>we?H.c=H.e=null:H.c=G<ye?[H.e=0]:(H.e=G,F),H}function je(H,F,G,oe){var Q,ce,ee,te,j,U,K,ve=H.c,Re=b;if(ve){e:{for(Q=1,te=ve[0];10<=te;te/=10,Q++);if((ce=F-Q)<0)ce+=v,ee=F,K=(j=ve[U=0])/Re[Q-ee-1]%10|0;else if((U=h((ce+1)/v))>=ve.length){if(!oe)break e;for(;ve.length<=U;ve.push(0));j=K=0,ee=(ce%=v)-v+(Q=1)}else{for(j=te=ve[U],Q=1;10<=te;te/=10,Q++);K=(ee=(ce%=v)-v+Q)<0?0:j/Re[Q-ee-1]%10|0}if(oe=oe||F<0||ve[U+1]!=null||(ee<0?j:j%Re[Q-ee-1]),oe=G<4?(K||oe)&&(G==0||G==(H.s<0?3:2)):5<K||K==5&&(G==4||oe||G==6&&(0<ce?0<ee?j/Re[Q-ee]:0:ve[U-1])%10&1||G==(H.s<0?8:7)),F<1||!ve[0])return ve.length=0,oe?(F-=H.e+1,ve[0]=Re[(v-F%v)%v],H.e=-F||0):ve[0]=H.e=0,H;if(ce==0?(ve.length=U,te=1,U--):(ve.length=U+1,te=Re[v-ce],ve[U]=0<ee?d(j/Re[Q-ee]%Re[ee])*te:0),oe)for(;;){if(U==0){for(ce=1,ee=ve[0];10<=ee;ee/=10,ce++);for(ee=ve[0]+=te,te=1;10<=ee;ee/=10,te++);ce!=te&&(H.e++,ve[0]==g&&(ve[0]=1));break}if(ve[U]+=te,ve[U]!=g)break;ve[U--]=0,te=1}for(ce=ve.length;ve[--ce]===0;ve.pop());}H.e>we?H.c=H.e=null:H.e<ye&&(H.c=[H.e=0])}return H}function We(H){var F,G=H.e;return G===null?H.toString():(F=I(H.c),F=G<=B||se<=G?L(F,G):V(F,G,"0"),H.s<0?"-"+F:F)}return le.clone=$,le.ROUND_UP=0,le.ROUND_DOWN=1,le.ROUND_CEIL=2,le.ROUND_FLOOR=3,le.ROUND_HALF_UP=4,le.ROUND_HALF_DOWN=5,le.ROUND_HALF_EVEN=6,le.ROUND_HALF_CEIL=7,le.ROUND_HALF_FLOOR=8,le.EUCLID=9,le.config=le.set=function(H){var F,G;if(H!=null){if(typeof H!="object")throw Error(f+"Object expected: "+H);if(H.hasOwnProperty(F="DECIMAL_PLACES")&&(O(G=H[F],0,R,F),D=G),H.hasOwnProperty(F="ROUNDING_MODE")&&(O(G=H[F],0,8,F),q=G),H.hasOwnProperty(F="EXPONENTIAL_AT")&&((G=H[F])&&G.pop?(O(G[0],-R,0,F),O(G[1],0,R,F),B=G[0],se=G[1]):(O(G,-R,R,F),B=-(se=G<0?-G:G))),H.hasOwnProperty(F="RANGE"))if((G=H[F])&&G.pop)O(G[0],-R,-1,F),O(G[1],1,R,F),ye=G[0],we=G[1];else{if(O(G,-R,R,F),!G)throw Error(f+F+" cannot be zero: "+G);ye=-(we=G<0?-G:G)}if(H.hasOwnProperty(F="CRYPTO")){if((G=H[F])!==!!G)throw Error(f+F+" not true or false: "+G);if(G){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw de=!G,Error(f+"crypto unavailable");de=G}else de=G}if(H.hasOwnProperty(F="MODULO_MODE")&&(O(G=H[F],0,9,F),be=G),H.hasOwnProperty(F="POW_PRECISION")&&(O(G=H[F],0,R,F),fe=G),H.hasOwnProperty(F="FORMAT")){if(typeof(G=H[F])!="object")throw Error(f+F+" not an object: "+G);he=G}if(H.hasOwnProperty(F="ALPHABET")){if(typeof(G=H[F])!="string"||/^.$|[+-.\s]|(.).*\1/.test(G))throw Error(f+F+" invalid: "+G);Ne=G}}return{DECIMAL_PLACES:D,ROUNDING_MODE:q,EXPONENTIAL_AT:[B,se],RANGE:[ye,we],CRYPTO:de,MODULO_MODE:be,POW_PRECISION:fe,FORMAT:he,ALPHABET:Ne}},le.isBigNumber=function(H){return H instanceof le||H&&H._isBigNumber===!0||!1},le.maximum=le.max=function(){return Be(arguments,T.lt)},le.minimum=le.min=function(){return Be(arguments,T.gt)},le.random=(_e=9007199254740992,Te=Math.random()*_e&2097151?function(){return d(Math.random()*_e)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(H){var F,G,oe,Q,ce,ee=0,te=[],j=new le(k);if(H==null?H=D:O(H,0,R),Q=h(H/v),de)if(crypto.getRandomValues){for(F=crypto.getRandomValues(new Uint32Array(Q*=2));ee<Q;)9e15<=(ce=131072*F[ee]+(F[ee+1]>>>11))?(G=crypto.getRandomValues(new Uint32Array(2)),F[ee]=G[0],F[ee+1]=G[1]):(te.push(ce%1e14),ee+=2);ee=Q/2}else{if(!crypto.randomBytes)throw de=!1,Error(f+"crypto unavailable");for(F=crypto.randomBytes(Q*=7);ee<Q;)9e15<=(ce=281474976710656*(31&F[ee])+1099511627776*F[ee+1]+4294967296*F[ee+2]+16777216*F[ee+3]+(F[ee+4]<<16)+(F[ee+5]<<8)+F[ee+6])?crypto.randomBytes(7).copy(F,ee):(te.push(ce%1e14),ee+=7);ee=Q/7}if(!de)for(;ee<Q;)(ce=Te())<9e15&&(te[ee++]=ce%1e14);for(Q=te[--ee],H%=v,Q&&H&&(ce=b[v-H],te[ee]=d(Q/ce)*ce);te[ee]===0;te.pop(),ee--);if(ee<0)te=[oe=0];else{for(oe=-1;te[0]===0;te.splice(0,1),oe-=v);for(ee=1,ce=te[0];10<=ce;ce/=10,ee++);ee<v&&(oe-=v-ee)}return j.e=oe,j.c=te,j}),le.sum=function(){for(var H=1,F=arguments,G=new le(F[0]);H<F.length;)G=G.plus(F[H++]);return G},ie=function(){var H="0123456789";function F(G,oe,Q,ce){for(var ee,te,j=[0],U=0,K=G.length;U<K;){for(te=j.length;te--;j[te]*=oe);for(j[0]+=ce.indexOf(G.charAt(U++)),ee=0;ee<j.length;ee++)j[ee]>Q-1&&(j[ee+1]==null&&(j[ee+1]=0),j[ee+1]+=j[ee]/Q|0,j[ee]%=Q)}return j.reverse()}return function(G,oe,Q,ce,ee){var te,j,U,K,ve,Re,Ie,ae,Ee=G.indexOf("."),Me=D,Pe=q;for(0<=Ee&&(K=fe,fe=0,G=G.replace(".",""),Re=(ae=new le(oe)).pow(G.length-Ee),fe=K,ae.c=F(V(I(Re.c),Re.e,"0"),10,Q,H),ae.e=ae.c.length),U=K=(Ie=F(G,oe,Q,ee?(te=Ne,H):(te=H,Ne))).length;Ie[--K]==0;Ie.pop());if(!Ie[0])return te.charAt(0);if(Ee<0?--U:(Re.c=Ie,Re.e=U,Re.s=ce,Ie=(Re=Z(Re,ae,Me,Pe,Q)).c,ve=Re.r,U=Re.e),Ee=Ie[j=U+Me+1],K=Q/2,ve=ve||j<0||Ie[j+1]!=null,ve=Pe<4?(Ee!=null||ve)&&(Pe==0||Pe==(Re.s<0?3:2)):K<Ee||Ee==K&&(Pe==4||ve||Pe==6&&1&Ie[j-1]||Pe==(Re.s<0?8:7)),j<1||!Ie[0])G=ve?V(te.charAt(1),-Me,te.charAt(0)):te.charAt(0);else{if(Ie.length=j,ve)for(--Q;++Ie[--j]>Q;)Ie[j]=0,j||(++U,Ie=[1].concat(Ie));for(K=Ie.length;!Ie[--K];);for(Ee=0,G="";Ee<=K;G+=te.charAt(Ie[Ee++]));G=V(G,U,te.charAt(0))}return G}}(),Z=function(){function H(oe,Q,ce){var ee,te,j,U,K=0,ve=oe.length,Re=Q%S,Ie=Q/S|0;for(oe=oe.slice();ve--;)K=((te=Re*(j=oe[ve]%S)+(ee=Ie*j+(U=oe[ve]/S|0)*Re)%S*S+K)/ce|0)+(ee/S|0)+Ie*U,oe[ve]=te%ce;return K&&(oe=[K].concat(oe)),oe}function F(oe,Q,ce,ee){var te,j;if(ce!=ee)j=ee<ce?1:-1;else for(te=j=0;te<ce;te++)if(oe[te]!=Q[te]){j=oe[te]>Q[te]?1:-1;break}return j}function G(oe,Q,ce,ee){for(var te=0;ce--;)oe[ce]-=te,te=oe[ce]<Q[ce]?1:0,oe[ce]=te*ee+oe[ce]-Q[ce];for(;!oe[0]&&1<oe.length;oe.splice(0,1));}return function(oe,Q,ce,ee,te){var j,U,K,ve,Re,Ie,ae,Ee,Me,Pe,De,$e,ut,ht,yt,rt,St,Oe=oe.s==Q.s?1:-1,Qe=oe.c,Xe=Q.c;if(!(Qe&&Qe[0]&&Xe&&Xe[0]))return new le(oe.s&&Q.s&&(Qe?!Xe||Qe[0]!=Xe[0]:Xe)?Qe&&Qe[0]==0||!Xe?0*Oe:Oe/0:NaN);for(Me=(Ee=new le(Oe)).c=[],Oe=ce+(U=oe.e-Q.e)+1,te||(te=g,U=A(oe.e/v)-A(Q.e/v),Oe=Oe/v|0),K=0;Xe[K]==(Qe[K]||0);K++);if(Xe[K]>(Qe[K]||0)&&U--,Oe<0)Me.push(1),ve=!0;else{for(ht=Qe.length,rt=Xe.length,Oe+=2,1<(Re=d(te/(Xe[K=0]+1)))&&(Xe=H(Xe,Re,te),Qe=H(Qe,Re,te),rt=Xe.length,ht=Qe.length),ut=rt,De=(Pe=Qe.slice(0,rt)).length;De<rt;Pe[De++]=0);St=Xe.slice(),St=[0].concat(St),yt=Xe[0],Xe[1]>=te/2&&yt++;do{if(Re=0,(j=F(Xe,Pe,rt,De))<0){if($e=Pe[0],rt!=De&&($e=$e*te+(Pe[1]||0)),1<(Re=d($e/yt)))for(te<=Re&&(Re=te-1),ae=(Ie=H(Xe,Re,te)).length,De=Pe.length;F(Ie,Pe,ae,De)==1;)Re--,G(Ie,rt<ae?St:Xe,ae,te),ae=Ie.length,j=1;else Re==0&&(j=Re=1),ae=(Ie=Xe.slice()).length;if(ae<De&&(Ie=[0].concat(Ie)),G(Pe,Ie,De,te),De=Pe.length,j==-1)for(;F(Xe,Pe,rt,De)<1;)Re++,G(Pe,rt<De?St:Xe,De,te),De=Pe.length}else j===0&&(Re++,Pe=[0]);Me[K++]=Re,Pe[0]?Pe[De++]=Qe[ut]||0:(Pe=[Qe[ut]],De=1)}while((ut++<ht||Pe[0]!=null)&&Oe--);ve=Pe[0]!=null,Me[0]||Me.splice(0,1)}if(te==g){for(K=1,Oe=Me[0];10<=Oe;Oe/=10,K++);je(Ee,ce+(Ee.e=K+U*v-1)+1,ee,ve)}else Ee.e=U,Ee.r=+ve;return Ee}}(),pe=/^(-?)0([xbo])(?=\w[\w.]*$)/i,me=/^([^.]+)\.$/,Se=/^\.([^.]+)$/,Le=/^-?(Infinity|NaN)$/,xe=/^\s*\+(?=[\w.])|^\s+|\s+$/g,ue=function(H,F,G,oe){var Q,ce=G?F:F.replace(xe,"");if(Le.test(ce))H.s=isNaN(ce)?null:ce<0?-1:1,H.c=H.e=null;else{if(!G&&(ce=ce.replace(pe,function(ee,te,j){return Q=(j=j.toLowerCase())=="x"?16:j=="b"?2:8,oe&&oe!=Q?ee:te}),oe&&(Q=oe,ce=ce.replace(me,"$1").replace(Se,"0.$1")),F!=ce))return new le(ce,Q);if(le.DEBUG)throw Error(f+"Not a"+(oe?" base "+oe:"")+" number: "+F);H.c=H.e=H.s=null}},T.absoluteValue=T.abs=function(){var H=new le(this);return H.s<0&&(H.s=1),H},T.comparedTo=function(H,F){return E(this,new le(H,F))},T.decimalPlaces=T.dp=function(H,F){var G,oe,Q;if(H!=null)return O(H,0,R),F==null?F=q:O(F,0,8),je(new le(this),H+this.e+1,F);if(!(G=this.c))return null;if(oe=((Q=G.length-1)-A(this.e/v))*v,Q=G[Q])for(;Q%10==0;Q/=10,oe--);return oe<0&&(oe=0),oe},T.dividedBy=T.div=function(H,F){return Z(this,new le(H,F),D,q)},T.dividedToIntegerBy=T.idiv=function(H,F){return Z(this,new le(H,F),0,1)},T.exponentiatedBy=T.pow=function(H,F){var G,oe,Q,ce,ee,te,j,U,K=this;if((H=new le(H)).c&&!H.isInteger())throw Error(f+"Exponent not an integer: "+We(H));if(F!=null&&(F=new le(F)),ee=14<H.e,!K.c||!K.c[0]||K.c[0]==1&&!K.e&&K.c.length==1||!H.c||!H.c[0])return U=new le(Math.pow(+We(K),ee?2-P(H):+We(H))),F?U.mod(F):U;if(te=H.s<0,F){if(F.c?!F.c[0]:!F.s)return new le(NaN);(oe=!te&&K.isInteger()&&F.isInteger())&&(K=K.mod(F))}else{if(9<H.e&&(0<K.e||K.e<-1||(K.e==0?1<K.c[0]||ee&&24e7<=K.c[1]:K.c[0]<8e13||ee&&K.c[0]<=9999975e7)))return ce=K.s<0&&P(H)?-0:0,-1<K.e&&(ce=1/ce),new le(te?1/ce:ce);fe&&(ce=h(fe/v+2))}for(j=ee?(G=new le(.5),te&&(H.s=1),P(H)):(Q=Math.abs(+We(H)))%2,U=new le(k);;){if(j){if(!(U=U.times(K)).c)break;ce?U.c.length>ce&&(U.c.length=ce):oe&&(U=U.mod(F))}if(Q){if((Q=d(Q/2))===0)break;j=Q%2}else if(je(H=H.times(G),H.e+1,1),14<H.e)j=P(H);else{if((Q=+We(H))==0)break;j=Q%2}K=K.times(K),ce?K.c&&K.c.length>ce&&(K.c.length=ce):oe&&(K=K.mod(F))}return oe?U:(te&&(U=k.div(U)),F?U.mod(F):ce?je(U,fe,q,void 0):U)},T.integerValue=function(H){var F=new le(this);return H==null?H=q:O(H,0,8),je(F,F.e+1,H)},T.isEqualTo=T.eq=function(H,F){return E(this,new le(H,F))===0},T.isFinite=function(){return!!this.c},T.isGreaterThan=T.gt=function(H,F){return 0<E(this,new le(H,F))},T.isGreaterThanOrEqualTo=T.gte=function(H,F){return(F=E(this,new le(H,F)))===1||F===0},T.isInteger=function(){return!!this.c&&A(this.e/v)>this.c.length-2},T.isLessThan=T.lt=function(H,F){return E(this,new le(H,F))<0},T.isLessThanOrEqualTo=T.lte=function(H,F){return(F=E(this,new le(H,F)))===-1||F===0},T.isNaN=function(){return!this.s},T.isNegative=function(){return this.s<0},T.isPositive=function(){return 0<this.s},T.isZero=function(){return!!this.c&&this.c[0]==0},T.minus=function(H,F){var G,oe,Q,ce,ee=this,te=ee.s;if(F=(H=new le(H,F)).s,!te||!F)return new le(NaN);if(te!=F)return H.s=-F,ee.plus(H);var j=ee.e/v,U=H.e/v,K=ee.c,ve=H.c;if(!j||!U){if(!K||!ve)return K?(H.s=-F,H):new le(ve?ee:NaN);if(!K[0]||!ve[0])return ve[0]?(H.s=-F,H):new le(K[0]?ee:q==3?-0:0)}if(j=A(j),U=A(U),K=K.slice(),te=j-U){for((Q=(ce=te<0)?(te=-te,K):(U=j,ve)).reverse(),F=te;F--;Q.push(0));Q.reverse()}else for(oe=(ce=(te=K.length)<(F=ve.length))?te:F,te=F=0;F<oe;F++)if(K[F]!=ve[F]){ce=K[F]<ve[F];break}if(ce&&(Q=K,K=ve,ve=Q,H.s=-H.s),0<(F=(oe=ve.length)-(G=K.length)))for(;F--;K[G++]=0);for(F=g-1;te<oe;){if(K[--oe]<ve[oe]){for(G=oe;G&&!K[--G];K[G]=F);--K[G],K[oe]+=g}K[oe]-=ve[oe]}for(;K[0]==0;K.splice(0,1),--U);return K[0]?Ue(H,K,U):(H.s=q==3?-1:1,H.c=[H.e=0],H)},T.modulo=T.mod=function(H,F){var G,oe,Q=this;return H=new le(H,F),!Q.c||!H.s||H.c&&!H.c[0]?new le(NaN):!H.c||Q.c&&!Q.c[0]?new le(Q):(be==9?(oe=H.s,H.s=1,G=Z(Q,H,0,3),H.s=oe,G.s*=oe):G=Z(Q,H,0,be),(H=Q.minus(G.times(H))).c[0]||be!=1||(H.s=Q.s),H)},T.multipliedBy=T.times=function(H,F){var G,oe,Q,ce,ee,te,j,U,K,ve,Re,Ie,ae,Ee,Me,Pe=this,De=Pe.c,$e=(H=new le(H,F)).c;if(!(De&&$e&&De[0]&&$e[0]))return!Pe.s||!H.s||De&&!De[0]&&!$e||$e&&!$e[0]&&!De?H.c=H.e=H.s=null:(H.s*=Pe.s,De&&$e?(H.c=[0],H.e=0):H.c=H.e=null),H;for(oe=A(Pe.e/v)+A(H.e/v),H.s*=Pe.s,(j=De.length)<(ve=$e.length)&&(ae=De,De=$e,$e=ae,Q=j,j=ve,ve=Q),Q=j+ve,ae=[];Q--;ae.push(0));for(Ee=g,Me=S,Q=ve;0<=--Q;){for(G=0,Re=$e[Q]%Me,Ie=$e[Q]/Me|0,ce=Q+(ee=j);Q<ce;)G=((U=Re*(U=De[--ee]%Me)+(te=Ie*U+(K=De[ee]/Me|0)*Re)%Me*Me+ae[ce]+G)/Ee|0)+(te/Me|0)+Ie*K,ae[ce--]=U%Ee;ae[ce]=G}return G?++oe:ae.splice(0,1),Ue(H,ae,oe)},T.negated=function(){var H=new le(this);return H.s=-H.s||null,H},T.plus=function(H,F){var G,oe=this,Q=oe.s;if(F=(H=new le(H,F)).s,!Q||!F)return new le(NaN);if(Q!=F)return H.s=-F,oe.minus(H);var ce=oe.e/v,ee=H.e/v,te=oe.c,j=H.c;if(!ce||!ee){if(!te||!j)return new le(Q/0);if(!te[0]||!j[0])return j[0]?H:new le(te[0]?oe:0*Q)}if(ce=A(ce),ee=A(ee),te=te.slice(),Q=ce-ee){for((G=0<Q?(ee=ce,j):(Q=-Q,te)).reverse();Q--;G.push(0));G.reverse()}for((Q=te.length)-(F=j.length)<0&&(G=j,j=te,te=G,F=Q),Q=0;F;)Q=(te[--F]=te[F]+j[F]+Q)/g|0,te[F]=g===te[F]?0:te[F]%g;return Q&&(te=[Q].concat(te),++ee),Ue(H,te,ee)},T.precision=T.sd=function(H,F){var G,oe,Q;if(H!=null&&H!==!!H)return O(H,1,R),F==null?F=q:O(F,0,8),je(new le(this),H,F);if(!(G=this.c))return null;if(oe=(Q=G.length-1)*v+1,Q=G[Q]){for(;Q%10==0;Q/=10,oe--);for(Q=G[0];10<=Q;Q/=10,oe++);}return H&&this.e+1>oe&&(oe=this.e+1),oe},T.shiftedBy=function(H){return O(H,-_,_),this.times("1e"+H)},T.squareRoot=T.sqrt=function(){var H,F,G,oe,Q,ce=this,ee=ce.c,te=ce.s,j=ce.e,U=D+4,K=new le("0.5");if(te!==1||!ee||!ee[0])return new le(!te||te<0&&(!ee||ee[0])?NaN:ee?ce:1/0);if((G=(te=Math.sqrt(+We(ce)))==0||te==1/0?(((F=I(ee)).length+j)%2==0&&(F+="0"),te=Math.sqrt(+F),j=A((j+1)/2)-(j<0||j%2),new le(F=te==1/0?"1e"+j:(F=te.toExponential()).slice(0,F.indexOf("e")+1)+j)):new le(te+"")).c[0]){for((te=(j=G.e)+U)<3&&(te=0);;)if(Q=G,G=K.times(Q.plus(Z(ce,Q,U,1))),I(Q.c).slice(0,te)===(F=I(G.c)).slice(0,te)){if(G.e<j&&--te,(F=F.slice(te-3,te+1))!="9999"&&(oe||F!="4999")){+F&&(+F.slice(1)||F.charAt(0)!="5")||(je(G,G.e+D+2,1),H=!G.times(G).eq(ce));break}if(!oe&&(je(Q,Q.e+D+2,0),Q.times(Q).eq(ce))){G=Q;break}U+=4,te+=4,oe=1}}return je(G,G.e+D+1,q,H)},T.toExponential=function(H,F){return H!=null&&(O(H,0,R),H++),Ve(this,H,F,1)},T.toFixed=function(H,F){return H!=null&&(O(H,0,R),H=H+this.e+1),Ve(this,H,F)},T.toFormat=function(H,F,G){var oe;if(G==null)H!=null&&F&&typeof F=="object"?(G=F,F=null):H&&typeof H=="object"?(G=H,H=F=null):G=he;else if(typeof G!="object")throw Error(f+"Argument not an object: "+G);if(oe=this.toFixed(H,F),this.c){var Q,ce=oe.split("."),ee=+G.groupSize,te=+G.secondaryGroupSize,j=G.groupSeparator||"",U=ce[0],K=ce[1],ve=this.s<0,Re=ve?U.slice(1):U,Ie=Re.length;if(te&&(Q=ee,ee=te,Ie-=te=Q),0<ee&&0<Ie){for(Q=Ie%ee||ee,U=Re.substr(0,Q);Q<Ie;Q+=ee)U+=j+Re.substr(Q,ee);0<te&&(U+=j+Re.slice(Q)),ve&&(U="-"+U)}oe=K?U+(G.decimalSeparator||"")+((te=+G.fractionGroupSize)?K.replace(new RegExp("\\d{"+te+"}\\B","g"),"$&"+(G.fractionGroupSeparator||"")):K):U}return(G.prefix||"")+oe+(G.suffix||"")},T.toFraction=function(H){var F,G,oe,Q,ce,ee,te,j,U,K,ve,Re,Ie=this,ae=Ie.c;if(H!=null&&(!(te=new le(H)).isInteger()&&(te.c||te.s!==1)||te.lt(k)))throw Error(f+"Argument "+(te.isInteger()?"out of range: ":"not an integer: ")+We(te));if(!ae)return new le(Ie);for(F=new le(k),U=G=new le(k),oe=j=new le(k),Re=I(ae),ce=F.e=Re.length-Ie.e-1,F.c[0]=b[(ee=ce%v)<0?v+ee:ee],H=!H||0<te.comparedTo(F)?0<ce?F:U:te,ee=we,we=1/0,te=new le(Re),j.c[0]=0;K=Z(te,F,0,1),(Q=G.plus(K.times(oe))).comparedTo(H)!=1;)G=oe,oe=Q,U=j.plus(K.times(Q=U)),j=Q,F=te.minus(K.times(Q=F)),te=Q;return Q=Z(H.minus(G),oe,0,1),j=j.plus(Q.times(U)),G=G.plus(Q.times(oe)),j.s=U.s=Ie.s,ve=Z(U,oe,ce*=2,q).minus(Ie).abs().comparedTo(Z(j,G,ce,q).minus(Ie).abs())<1?[U,oe]:[j,G],we=ee,ve},T.toNumber=function(){return+We(this)},T.toPrecision=function(H,F){return H!=null&&O(H,1,R),Ve(this,H,F,2)},T.toString=function(H){var F,G=this,oe=G.s,Q=G.e;return Q===null?oe?(F="Infinity",oe<0&&(F="-"+F)):F="NaN":(F=H==null?Q<=B||se<=Q?L(I(G.c),Q):V(I(G.c),Q,"0"):H===10?V(I((G=je(new le(G),D+Q+1,q)).c),G.e,"0"):(O(H,2,Ne.length,"Base"),ie(V(I(G.c),Q,"0"),10,H,oe,!0)),oe<0&&G.c[0]&&(F="-"+F)),F},T.valueOf=T.toJSON=function(){return We(this)},T._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(T[Symbol.toStringTag]="BigNumber",T[Symbol.for("nodejs.util.inspect.custom")]=T.valueOf),W!=null&&le.set(W),le}()).default=c.BigNumber=c,i!==void 0&&i.exports?i.exports=c:(a||(a=typeof self<"u"&&self?self:window),a.BigNumber=c)})(this)},{}],2:[function(r,i,o){"use strict";i.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(a){var c=a%10;return~~(a%100/10)==1?"th":c===1?"st":c===2?"nd":c===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,i,o){"use strict";function a(A,I){return function(E){if(Array.isArray(E))return E}(A)||function(E,O){var P=[],L=!0,V=!1,$=void 0;try{for(var W,Z=E[Symbol.iterator]();!(L=(W=Z.next()).done)&&(P.push(W.value),!O||P.length!==O);L=!0);}catch(ie){V=!0,$=ie}finally{try{L||Z.return==null||Z.return()}finally{if(V)throw $}}return P}(A,I)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var c=r("./globalState"),u=r("./validating"),h=r("./parsing"),d=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],f={general:{scale:1024,suffixes:d,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:d,marker:"d"}},m={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function g(A){var I=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},E=2<arguments.length?arguments[2]:void 0;if(typeof I=="string"&&(I=h.parseFormat(I)),!u.validateFormat(I))return"ERROR: invalid format";var O=I.prefix||"",P=I.postfix||"",L=function(V,$,W){switch($.output){case"currency":return $=R($,c.currentCurrencyDefaultFormat()),function(Ne,le,Ve){var Be=Ve.currentCurrency(),Ue=Object.assign({},m,le),je=void 0,We="",H=!!Ue.totalLength||!!Ue.forceAverage||Ue.average,F=le.currencyPosition||Be.position,G=le.currencySymbol||Be.symbol;Ue.spaceSeparated&&(We=" "),F==="infix"&&(je=We+G+We);var oe=S({instance:Ne,providedFormat:le,state:Ve,decimalSeparator:je});return F==="prefix"&&(oe=Ne._value<0&&Ue.negative==="sign"?"-".concat(We).concat(G).concat(oe.slice(1)):G+We+oe),F&&F!=="postfix"||(oe=oe+(We=H?"":We)+G),oe}(V,$,c);case"percent":return $=R($,c.currentPercentageDefaultFormat()),function(Ne,le,Ve,Be){var Ue=le.prefixSymbol,je=S({instance:Be(100*Ne._value),providedFormat:le,state:Ve}),We=Object.assign({},m,le);return Ue?"%".concat(We.spaceSeparated?" ":"").concat(je):"".concat(je).concat(We.spaceSeparated?" ":"","%")}(V,$,c,W);case"byte":return $=R($,c.currentByteDefaultFormat()),k=V,q=c,B=W,se=(D=$).base||"binary",ye=f[se],we=v(k._value,ye.suffixes,ye.scale),de=we.value,be=we.suffix,fe=S({instance:B(de),providedFormat:D,state:q,defaults:q.currentByteDefaultFormat()}),he=q.currentAbbreviations(),"".concat(fe).concat(he.spaced?" ":"").concat(be);case"time":return $=R($,c.currentTimeDefaultFormat()),Se=V,Le=Math.floor(Se._value/60/60),xe=Math.floor((Se._value-60*Le*60)/60),T=Math.round(Se._value-60*Le*60-60*xe),"".concat(Le,":").concat(xe<10?"0":"").concat(xe,":").concat(T<10?"0":"").concat(T);case"ordinal":return $=R($,c.currentOrdinalDefaultFormat()),Z=V,ie=$,_e=(ue=c).currentOrdinal(),Te=Object.assign({},m,ie),pe=S({instance:Z,providedFormat:ie,state:ue}),me=_e(Z._value),"".concat(pe).concat(Te.spaceSeparated?" ":"").concat(me);case"number":default:return S({instance:V,providedFormat:$,numbro:W})}var Z,ie,ue,_e,Te,pe,me,Se,Le,xe,T,k,D,q,B,se,ye,we,de,be,fe,he}(A,I,E);return L=(L=O+L)+P}function v(A,I,E){var O=I[0],P=Math.abs(A);if(E<=P){for(var L=1;L<I.length;++L){var V=Math.pow(E,L),$=Math.pow(E,L+1);if(V<=P&&P<$){O=I[L],A/=V;break}}O===I[0]&&(A/=Math.pow(E,I.length-1),O=I[I.length-1])}return{value:A,suffix:O}}function _(A){for(var I="",E=0;E<A;E++)I+="0";return I}function b(A,I){return A.toString().indexOf("e")!==-1?function(E,O){var P=E.toString(),L=a(P.split("e"),2),V=L[0],$=L[1],W=a(V.split("."),2),Z=W[0],ie=W[1],ue=ie===void 0?"":ie;if(0<+$)P=Z+ue+_($-ue.length);else{var _e=".";_e=+Z<0?"-0".concat(_e):"0".concat(_e);var Te=(_(-$-1)+Math.abs(Z)+ue).substr(0,O);Te.length<O&&(Te+=_(O-Te.length)),P=_e+Te}return 0<+$&&0<O&&(P+=".".concat(_(O))),P}(A,I):(Math.round(+"".concat(A,"e+").concat(I))/Math.pow(10,I)).toFixed(I)}function S(A){var I=A.instance,E=A.providedFormat,O=A.state,P=O===void 0?c:O,L=A.decimalSeparator,V=A.defaults,$=V===void 0?P.currentDefaults():V,W=I._value;if(W===0&&P.hasZeroFormat())return P.getZeroFormat();if(!isFinite(W))return W.toString();var Z,ie,ue,_e,Te,pe,me,Se,Le=Object.assign({},m,$,E),xe=Le.totalLength,T=xe?0:Le.characteristic,k=Le.optionalCharacteristic,D=Le.forceAverage,q=!!xe||!!D||Le.average,B=xe?-1:q&&E.mantissa===void 0?0:Le.mantissa,se=!xe&&(E.optionalMantissa===void 0?B===-1:Le.optionalMantissa),ye=Le.trimMantissa,we=Le.thousandSeparated,de=Le.spaceSeparated,be=Le.negative,fe=Le.forceSign,he=Le.exponential,Ne="";if(q){var le=function(H){var F=H.value,G=H.forceAverage,oe=H.abbreviations,Q=H.spaceSeparated,ce=Q!==void 0&&Q,ee=H.totalLength,te=ee===void 0?0:ee,j="",U=Math.abs(F),K=-1;if(U>=Math.pow(10,12)&&!G||G==="trillion"?(j=oe.trillion,F/=Math.pow(10,12)):U<Math.pow(10,12)&&U>=Math.pow(10,9)&&!G||G==="billion"?(j=oe.billion,F/=Math.pow(10,9)):U<Math.pow(10,9)&&U>=Math.pow(10,6)&&!G||G==="million"?(j=oe.million,F/=Math.pow(10,6)):(U<Math.pow(10,6)&&U>=Math.pow(10,3)&&!G||G==="thousand")&&(j=oe.thousand,F/=Math.pow(10,3)),j&&(j=(ce?" ":"")+j),te){var ve=F.toString().split(".")[0];K=Math.max(te-ve.length,0)}return{value:F,abbreviation:j,mantissaPrecision:K}}({value:W,forceAverage:D,abbreviations:P.currentAbbreviations(),spaceSeparated:de,totalLength:xe});W=le.value,Ne+=le.abbreviation,xe&&(B=le.mantissaPrecision)}if(he){var Ve=(ie=(Z={value:W,characteristicPrecision:T}).value,ue=Z.characteristicPrecision,_e=ue===void 0?0:ue,Te=a(ie.toExponential().split("e"),2),pe=Te[0],me=Te[1],Se=+pe,_e&&1<_e&&(Se*=Math.pow(10,_e-1),me=0<=(me=+me-(_e-1))?"+".concat(me):me),{value:Se,abbreviation:"e".concat(me)});W=Ve.value,Ne=Ve.abbreviation+Ne}var Be,Ue,je,We=function(H,F,G,oe,Q){if(oe===-1)return H;var ce=b(F,oe),ee=a(ce.toString().split("."),2),te=ee[0],j=ee[1],U=j===void 0?"":j;if(U.match(/^0+$/)&&(G||Q))return te;var K=U.match(/0+$/);return Q&&K?"".concat(te,".").concat(U.toString().slice(0,K.index)):ce.toString()}(W.toString(),W,se,B,ye);return We=function(H,F,G,oe,Q){var ce=oe.currentDelimiters(),ee=ce.thousands;Q=Q||ce.decimal;var te=ce.thousandsSize||3,j=H.toString(),U=j.split(".")[0],K=j.split(".")[1];return G&&(F<0&&(U=U.slice(1)),function(ve,Re){for(var Ie=[],ae=0,Ee=ve;0<Ee;Ee--)ae===Re&&(Ie.unshift(Ee),ae=0),ae++;return Ie}(U.length,te).forEach(function(ve,Re){U=U.slice(0,ve+Re)+ee+U.slice(ve+Re)}),F<0&&(U="-".concat(U))),j=K?U+Q+K:U}(We=function(H,F,G,oe){var Q=H,ce=a(Q.toString().split("."),2),ee=ce[0],te=ce[1];if(ee.match(/^-?0$/)&&G)return te?"".concat(ee.replace("0",""),".").concat(te):ee.replace("0","");if(ee.length<oe)for(var j=oe-ee.length,U=0;U<j;U++)Q="0".concat(Q);return Q.toString()}(We,0,k,T),W,we,P,L),(q||he)&&(We=We+Ne),(fe||W<0)&&(Be=We,je=be,We=(Ue=W)===0?Be:+Be==0?Be.replace("-",""):0<Ue?"+".concat(Be):je==="sign"?Be:"(".concat(Be.replace("-",""),")")),We}function R(A,I){if(!A)return I;var E=Object.keys(A);return E.length===1&&E[0]==="output"?I:A}i.exports=function(A){return{format:function(){for(var I=arguments.length,E=new Array(I),O=0;O<I;O++)E[O]=arguments[O];return g.apply(void 0,E.concat([A]))},getByteUnit:function(){for(var I=arguments.length,E=new Array(I),O=0;O<I;O++)E[O]=arguments[O];return function(P){var L=f.general;return v(P._value,L.suffixes,L.scale).suffix}.apply(void 0,E.concat([A]))},getBinaryByteUnit:function(){for(var I=arguments.length,E=new Array(I),O=0;O<I;O++)E[O]=arguments[O];return function(P){var L=f.binary;return v(P._value,L.suffixes,L.scale).suffix}.apply(void 0,E.concat([A]))},getDecimalByteUnit:function(){for(var I=arguments.length,E=new Array(I),O=0;O<I;O++)E[O]=arguments[O];return function(P){var L=f.decimal;return v(P._value,L.suffixes,L.scale).suffix}.apply(void 0,E.concat([A]))},formatOrDefault:R}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,i,o){"use strict";var a=r("./en-US"),c=r("./validating"),u=r("./parsing"),h={},d=void 0,f={},m=null,g={};function v(b){d=b}function _(){return f[d]}h.languages=function(){return Object.assign({},f)},h.currentLanguage=function(){return d},h.currentCurrency=function(){return _().currency},h.currentAbbreviations=function(){return _().abbreviations},h.currentDelimiters=function(){return _().delimiters},h.currentOrdinal=function(){return _().ordinal},h.currentDefaults=function(){return Object.assign({},_().defaults,g)},h.currentOrdinalDefaultFormat=function(){return Object.assign({},h.currentDefaults(),_().ordinalFormat)},h.currentByteDefaultFormat=function(){return Object.assign({},h.currentDefaults(),_().byteFormat)},h.currentPercentageDefaultFormat=function(){return Object.assign({},h.currentDefaults(),_().percentageFormat)},h.currentCurrencyDefaultFormat=function(){return Object.assign({},h.currentDefaults(),_().currencyFormat)},h.currentTimeDefaultFormat=function(){return Object.assign({},h.currentDefaults(),_().timeFormat)},h.setDefaults=function(b){b=u.parseFormat(b),c.validateFormat(b)&&(g=b)},h.getZeroFormat=function(){return m},h.setZeroFormat=function(b){return m=typeof b=="string"?b:null},h.hasZeroFormat=function(){return m!==null},h.languageData=function(b){if(b){if(f[b])return f[b];throw new Error('Unknown tag "'.concat(b,'"'))}return _()},h.registerLanguage=function(b){var S=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!c.validateLanguage(b))throw new Error("Invalid language data");f[b.languageTag]=b,S&&v(b.languageTag)},h.setLanguage=function(b){var S=1<arguments.length&&arguments[1]!==void 0?arguments[1]:a.languageTag;if(!f[b]){var R=b.split("-")[0],A=Object.keys(f).find(function(I){return I.split("-")[0]===R});return f[A]?void v(A):void v(S)}v(b)},h.registerLanguage(a),d=a.languageTag,i.exports=h},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,i,o){"use strict";i.exports=function(a){return{loadLanguagesInNode:function(c){return u=a,void c.forEach(function(h){var d=void 0;try{d=r("../languages/".concat(h))}catch{console.error('Unable to load "'.concat(h,'". No matching language file found.'))}d&&u.registerLanguage(d)});var u}}}},{}],6:[function(r,i,o){"use strict";var a=r("bignumber.js");function c(u,h,d){var f=new a(u._value),m=h;return d.isNumbro(h)&&(m=h._value),m=new a(m),u._value=f.minus(m).toNumber(),u}i.exports=function(u){return{add:function(h,d){return m=d,g=u,v=new a((f=h)._value),_=m,g.isNumbro(m)&&(_=m._value),_=new a(_),f._value=v.plus(_).toNumber(),f;var f,m,g,v,_},subtract:function(h,d){return c(h,d,u)},multiply:function(h,d){return m=d,g=u,v=new a((f=h)._value),_=m,g.isNumbro(m)&&(_=m._value),_=new a(_),f._value=v.times(_).toNumber(),f;var f,m,g,v,_},divide:function(h,d){return m=d,g=u,v=new a((f=h)._value),_=m,g.isNumbro(m)&&(_=m._value),_=new a(_),f._value=v.dividedBy(_).toNumber(),f;var f,m,g,v,_},set:function(h,d){return f=h,g=m=d,u.isNumbro(m)&&(g=m._value),f._value=g,f;var f,m,g},difference:function(h,d){return f=d,c(g=(m=u)(h._value),f,m),Math.abs(g._value);var f,m,g}}}},{"bignumber.js":1}],7:[function(r,i,o){"use strict";function a(S,R){for(var A=0;A<R.length;A++){var I=R[A];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(S,I.key,I)}}var c=r("./globalState"),u=r("./validating"),h=r("./loading")(b),d=r("./unformatting"),f=r("./formatting")(b),m=r("./manipulating")(b),g=r("./parsing"),v=function(){function S(E){(function(O,P){if(!(O instanceof P))throw new TypeError("Cannot call a class as a function")})(this,S),this._value=E}var R,A,I;return R=S,(A=[{key:"clone",value:function(){return b(this._value)}},{key:"format",value:function(){var E=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return f.format(this,E)}},{key:"formatCurrency",value:function(E){return typeof E=="string"&&(E=g.parseFormat(E)),(E=f.formatOrDefault(E,c.currentCurrencyDefaultFormat())).output="currency",f.format(this,E)}},{key:"formatTime",value:function(){var E=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return E.output="time",f.format(this,E)}},{key:"binaryByteUnits",value:function(){return f.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return f.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return f.getByteUnit(this)}},{key:"difference",value:function(E){return m.difference(this,E)}},{key:"add",value:function(E){return m.add(this,E)}},{key:"subtract",value:function(E){return m.subtract(this,E)}},{key:"multiply",value:function(E){return m.multiply(this,E)}},{key:"divide",value:function(E){return m.divide(this,E)}},{key:"set",value:function(E){return m.set(this,_(E))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&a(R.prototype,A),I&&a(R,I),S}();function _(S){var R=S;return b.isNumbro(S)?R=S._value:typeof S=="string"?R=b.unformat(S):isNaN(S)&&(R=NaN),R}function b(S){return new v(_(S))}b.version="2.1.2",b.isNumbro=function(S){return S instanceof v},b.language=c.currentLanguage,b.registerLanguage=c.registerLanguage,b.setLanguage=c.setLanguage,b.languages=c.languages,b.languageData=c.languageData,b.zeroFormat=c.setZeroFormat,b.defaultFormat=c.currentDefaults,b.setDefaults=c.setDefaults,b.defaultCurrencyFormat=c.currentCurrencyDefaultFormat,b.validate=u.validate,b.loadLanguagesInNode=h.loadLanguagesInNode,b.unformat=d.unformat,i.exports=b},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,i,o){"use strict";i.exports={parseFormat:function(a){var c,u,h,d,f,m,g,v,_,b,S,R,A,I,E,O,P,L,V,$,W=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof a!="string"?a:(u=W,a=(h=(c=a).match(/^{([^}]*)}/))?(u.prefix=h[1],c.slice(h[0].length)):c,f=W,function(Z,ie){if(Z.indexOf("$")===-1){if(Z.indexOf("%")===-1)return Z.indexOf("bd")!==-1?(ie.output="byte",ie.base="general"):Z.indexOf("b")!==-1?(ie.output="byte",ie.base="binary"):Z.indexOf("d")!==-1?(ie.output="byte",ie.base="decimal"):Z.indexOf(":")===-1?Z.indexOf("o")!==-1&&(ie.output="ordinal"):ie.output="time";ie.output="percent"}else ie.output="currency"}(a=(m=(d=a).match(/{([^}]*)}$/))?(f.postfix=m[1],d.slice(0,-m[0].length)):d,W),g=W,(v=a.match(/[1-9]+[0-9]*/))&&(g.totalLength=+v[0]),_=W,(b=a.split(".")[0].match(/0+/))&&(_.characteristic=b[0].length),function(Z,ie){if(Z.indexOf(".")!==-1){var ue=Z.split(".")[0];ie.optionalCharacteristic=ue.indexOf("0")===-1}}(a,W),S=W,a.indexOf("a")!==-1&&(S.average=!0),A=W,(R=a).indexOf("K")!==-1?A.forceAverage="thousand":R.indexOf("M")!==-1?A.forceAverage="million":R.indexOf("B")!==-1?A.forceAverage="billion":R.indexOf("T")!==-1&&(A.forceAverage="trillion"),function(Z,ie){var ue=Z.split(".")[1];if(ue){var _e=ue.match(/0+/);_e&&(ie.mantissa=_e[0].length)}}(a,W),E=W,(I=a).match(/\[\.]/)?E.optionalMantissa=!0:I.match(/\./)&&(E.optionalMantissa=!1),O=W,a.indexOf(",")!==-1&&(O.thousandSeparated=!0),P=W,a.indexOf(" ")!==-1&&(P.spaceSeparated=!0),V=W,(L=a).match(/^\+?\([^)]*\)$/)&&(V.negative="parenthesis"),L.match(/^\+?-/)&&(V.negative="sign"),$=W,a.match(/^\+/)&&($.forceSign=!0),W)}}},{}],9:[function(r,i,o){"use strict";var a=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function c(h){return h.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function u(h,d){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",m=3<arguments.length?arguments[3]:void 0,g=4<arguments.length?arguments[4]:void 0,v=5<arguments.length?arguments[5]:void 0,_=6<arguments.length?arguments[6]:void 0;if(h!=="")return h===g?0:function b(S,R){var A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",I=3<arguments.length?arguments[3]:void 0,E=4<arguments.length?arguments[4]:void 0,O=5<arguments.length?arguments[5]:void 0,P=6<arguments.length?arguments[6]:void 0;if(!isNaN(+S))return+S;var L="",V=S.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(V!==S)return-1*b(V,R,A,I,E,O,P);for(var $=0;$<a.length;$++){var W=a[$];if((L=S.replace(W.key,""))!==S)return b(L,R,A,I,E,O,P)*W.factor}if((L=S.replace("%",""))!==S)return b(L,R,A,I,E,O,P)/100;var Z=parseFloat(S);if(!isNaN(Z)){var ie=I(Z);if(ie&&ie!=="."&&(L=S.replace(new RegExp("".concat(c(ie),"$")),""))!==S)return b(L,R,A,I,E,O,P);var ue={};Object.keys(O).forEach(function(xe){ue[O[xe]]=xe});for(var _e=Object.keys(ue).sort().reverse(),Te=_e.length,pe=0;pe<Te;pe++){var me=_e[pe],Se=ue[me];if((L=S.replace(me,""))!==S){var Le=void 0;switch(Se){case"thousand":Le=Math.pow(10,3);break;case"million":Le=Math.pow(10,6);break;case"billion":Le=Math.pow(10,9);break;case"trillion":Le=Math.pow(10,12)}return b(L,R,A,I,E,O,P)*Le}}}}(function(b,S){var R=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",A=b.replace(R,"");return A=(A=A.replace(new RegExp("([0-9])".concat(c(S.thousands),"([0-9])"),"g"),"$1$2")).replace(S.decimal,".")}(h,d,f),d,f,m,g,v,_)}i.exports={unformat:function(h,d){var f,m,g,v=r("./globalState"),_=v.currentDelimiters(),b=v.currentCurrency().symbol,S=v.currentOrdinal(),R=v.getZeroFormat(),A=v.currentAbbreviations(),I=void 0;if(typeof h=="string")I=function(E,O){if(!E.indexOf(":")||O.thousands===":")return!1;var P=E.split(":");if(P.length!==3)return!1;var L=+P[0],V=+P[1],$=+P[2];return!isNaN(L)&&!isNaN(V)&&!isNaN($)}(h,_)?(f=h.split(":"),m=+f[0],g=+f[1],+f[2]+60*g+3600*m):u(h,_,b,S,R,A,d);else{if(typeof h!="number")return;I=h}if(I!==void 0)return I}}},{"./globalState":4}],10:[function(r,i,o){"use strict";function a(_){return function(b){if(Array.isArray(b)){for(var S=0,R=new Array(b.length);S<b.length;S++)R[S]=b[S];return R}}(_)||function(b){if(Symbol.iterator in Object(b)||Object.prototype.toString.call(b)==="[object Arguments]")return Array.from(b)}(_)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(_){return(c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b})(_)}var u=r("./unformatting"),h=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,d={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(_,b){return b.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(_){return _.output==="byte"}},characteristic:{type:"number",restriction:function(_){return 0<=_},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(_){return 0<=_},message:"value must be positive"},{restriction:function(_,b){return!b.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(_){return 0<=_},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(_,b){return b.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},f={languageTag:{type:"string",mandatory:!0,restriction:function(_){return _.match(h)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function m(_){return!!u.unformat(_)}function g(_,b,S){var R=3<arguments.length&&arguments[3]!==void 0&&arguments[3],A=Object.keys(_).map(function(I){if(!b[I])return console.error("".concat(S," Invalid key: ").concat(I)),!1;var E=_[I],O=b[I];if(typeof O=="string"&&(O={type:O}),O.type==="format"){if(!g(E,d,"[Validate ".concat(I,"]"),!0))return!1}else if(c(E)!==O.type)return console.error("".concat(S," ").concat(I,' type mismatched: "').concat(O.type,'" expected, "').concat(c(E),'" provided')),!1;if(O.restrictions&&O.restrictions.length)for(var P=O.restrictions.length,L=0;L<P;L++){var V=O.restrictions[L],$=V.restriction,W=V.message;if(!$(E,_))return console.error("".concat(S," ").concat(I," invalid value: ").concat(W)),!1}return O.restriction&&!O.restriction(E,_)?(console.error("".concat(S," ").concat(I," invalid value: ").concat(O.message)),!1):O.validValues&&O.validValues.indexOf(E)===-1?(console.error("".concat(S," ").concat(I," invalid value: must be among ").concat(JSON.stringify(O.validValues),', "').concat(E,'" provided')),!1):!(O.children&&!g(E,O.children,"[Validate ".concat(I,"]")))});return R||A.push.apply(A,a(Object.keys(b).map(function(I){var E=b[I];if(typeof E=="string"&&(E={type:E}),E.mandatory){var O=E.mandatory;if(typeof O=="function"&&(O=O(_)),O&&_[I]===void 0)return console.error("".concat(S,' Missing mandatory key "').concat(I,'"')),!1}return!0}))),A.reduce(function(I,E){return I&&E},!0)}function v(_){return g(_,d,"[Validate format]")}i.exports={validate:function(_,b){var S=m(_),R=v(b);return S&&R},validateFormat:v,validateInput:m,validateLanguage:function(_){return g(_,f,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})}}),require_delete_property_or_throw=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/delete-property-or-throw.js"(e,t){"use strict";var r=require_try_to_string(),i=TypeError;t.exports=function(o,a){if(!delete o[a])throw new i("Cannot delete property "+r(a)+" of "+r(o))}}}),require_es_array_unshift=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.array.unshift.js"(){"use strict";var e=require_export(),t=require_to_object(),r=require_length_of_array_like(),i=require_array_set_length(),o=require_delete_property_or_throw(),a=require_does_not_exceed_safe_integer(),c=[].unshift(0)!==1,u=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(d){return d instanceof TypeError}},h=c||!u();e({target:"Array",proto:!0,arity:1,forced:h},{unshift:function(f){var m=t(this),g=r(m),v=arguments.length;if(v){a(g+v);for(var _=g;_--;){var b=_+v;_ in m?m[b]=m[_]:o(m,b)}for(var S=0;S<v;S++)m[S]=arguments[S]}return i(m,g+v)}})}}),require_iterators=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/iterators.js"(e,t){"use strict";t.exports={}}}),require_is_array_iterator_method=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/is-array-iterator-method.js"(e,t){"use strict";var r=require_well_known_symbol(),i=require_iterators(),o=r("iterator"),a=Array.prototype;t.exports=function(c){return c!==void 0&&(i.Array===c||a[o]===c)}}}),require_get_iterator_method=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/get-iterator-method.js"(e,t){"use strict";var r=require_classof(),i=require_get_method(),o=require_is_null_or_undefined(),a=require_iterators(),c=require_well_known_symbol(),u=c("iterator");t.exports=function(h){if(!o(h))return i(h,u)||i(h,"@@iterator")||a[r(h)]}}}),require_get_iterator=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/get-iterator.js"(e,t){"use strict";var r=require_function_call(),i=require_a_callable(),o=require_an_object(),a=require_try_to_string(),c=require_get_iterator_method(),u=TypeError;t.exports=function(h,d){var f=arguments.length<2?c(h):d;if(i(f))return o(r(f,h));throw new u(a(h)+" is not iterable")}}}),require_iterate=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/iterate.js"(e,t){"use strict";var r=require_function_bind_context(),i=require_function_call(),o=require_an_object(),a=require_try_to_string(),c=require_is_array_iterator_method(),u=require_length_of_array_like(),h=require_object_is_prototype_of(),d=require_get_iterator(),f=require_get_iterator_method(),m=require_iterator_close(),g=TypeError,v=function(b,S){this.stopped=b,this.result=S},_=v.prototype;t.exports=function(b,S,R){var A=R&&R.that,I=!!(R&&R.AS_ENTRIES),E=!!(R&&R.IS_RECORD),O=!!(R&&R.IS_ITERATOR),P=!!(R&&R.INTERRUPTED),L=r(S,A),V,$,W,Z,ie,ue,_e,Te=function(me){return V&&m(V,"normal",me),new v(!0,me)},pe=function(me){return I?(o(me),P?L(me[0],me[1],Te):L(me[0],me[1])):P?L(me,Te):L(me)};if(E)V=b.iterator;else if(O)V=b;else{if($=f(b),!$)throw new g(a(b)+" is not iterable");if(c($)){for(W=0,Z=u(b);Z>W;W++)if(ie=pe(b[W]),ie&&h(_,ie))return ie;return new v(!1)}V=d(b,$)}for(ue=E?b.next:V.next;!(_e=i(ue,V)).done;){try{ie=pe(_e.value)}catch(me){m(V,"throw",me)}if(typeof ie=="object"&&ie&&h(_,ie))return ie}return new v(!1)}}}),require_create_property=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/internals/create-property.js"(e,t){"use strict";var r=require_descriptors(),i=require_object_define_property(),o=require_create_property_descriptor();t.exports=function(a,c,u){r?i.f(a,c,o(0,u)):a[c]=u}}}),require_es_object_from_entries=__commonJS({"node_modules/.pnpm/core-js@3.39.0/node_modules/core-js/modules/es.object.from-entries.js"(){"use strict";var e=require_export(),t=require_iterate(),r=require_create_property();e({target:"Object",stat:!0},{fromEntries:function(o){var a={};return t(o,function(c,u){r(a,c,u)},{AS_ENTRIES:!0}),a}})}}),require_color_name=__commonJS({"node_modules/.pnpm/color-name@1.1.4/node_modules/color-name/index.js"(e,t){"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}}}),require_conversions=__commonJS({"node_modules/.pnpm/color-convert@2.0.1/node_modules/color-convert/conversions.js"(e,t){var r=require_color_name(),i={};for(const c of Object.keys(r))i[r[c]]=c;var o={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};t.exports=o;for(const c of Object.keys(o)){if(!("channels"in o[c]))throw new Error("missing channels property: "+c);if(!("labels"in o[c]))throw new Error("missing channel labels property: "+c);if(o[c].labels.length!==o[c].channels)throw new Error("channel and label counts mismatch: "+c);const{channels:u,labels:h}=o[c];delete o[c].channels,delete o[c].labels,Object.defineProperty(o[c],"channels",{value:u}),Object.defineProperty(o[c],"labels",{value:h})}o.rgb.hsl=function(c){const u=c[0]/255,h=c[1]/255,d=c[2]/255,f=Math.min(u,h,d),m=Math.max(u,h,d),g=m-f;let v,_;m===f?v=0:u===m?v=(h-d)/g:h===m?v=2+(d-u)/g:d===m&&(v=4+(u-h)/g),v=Math.min(v*60,360),v<0&&(v+=360);const b=(f+m)/2;return m===f?_=0:b<=.5?_=g/(m+f):_=g/(2-m-f),[v,_*100,b*100]},o.rgb.hsv=function(c){let u,h,d,f,m;const g=c[0]/255,v=c[1]/255,_=c[2]/255,b=Math.max(g,v,_),S=b-Math.min(g,v,_),R=function(A){return(b-A)/6/S+1/2};return S===0?(f=0,m=0):(m=S/b,u=R(g),h=R(v),d=R(_),g===b?f=d-h:v===b?f=1/3+u-d:_===b&&(f=2/3+h-u),f<0?f+=1:f>1&&(f-=1)),[f*360,m*100,b*100]},o.rgb.hwb=function(c){const u=c[0],h=c[1];let d=c[2];const f=o.rgb.hsl(c)[0],m=1/255*Math.min(u,Math.min(h,d));return d=1-1/255*Math.max(u,Math.max(h,d)),[f,m*100,d*100]},o.rgb.cmyk=function(c){const u=c[0]/255,h=c[1]/255,d=c[2]/255,f=Math.min(1-u,1-h,1-d),m=(1-u-f)/(1-f)||0,g=(1-h-f)/(1-f)||0,v=(1-d-f)/(1-f)||0;return[m*100,g*100,v*100,f*100]};function a(c,u){return(c[0]-u[0])**2+(c[1]-u[1])**2+(c[2]-u[2])**2}o.rgb.keyword=function(c){const u=i[c];if(u)return u;let h=1/0,d;for(const f of Object.keys(r)){const m=r[f],g=a(c,m);g<h&&(h=g,d=f)}return d},o.keyword.rgb=function(c){return r[c]},o.rgb.xyz=function(c){let u=c[0]/255,h=c[1]/255,d=c[2]/255;u=u>.04045?((u+.055)/1.055)**2.4:u/12.92,h=h>.04045?((h+.055)/1.055)**2.4:h/12.92,d=d>.04045?((d+.055)/1.055)**2.4:d/12.92;const f=u*.4124+h*.3576+d*.1805,m=u*.2126+h*.7152+d*.0722,g=u*.0193+h*.1192+d*.9505;return[f*100,m*100,g*100]},o.rgb.lab=function(c){const u=o.rgb.xyz(c);let h=u[0],d=u[1],f=u[2];h/=95.047,d/=100,f/=108.883,h=h>.008856?h**(1/3):7.787*h+16/116,d=d>.008856?d**(1/3):7.787*d+16/116,f=f>.008856?f**(1/3):7.787*f+16/116;const m=116*d-16,g=500*(h-d),v=200*(d-f);return[m,g,v]},o.hsl.rgb=function(c){const u=c[0]/360,h=c[1]/100,d=c[2]/100;let f,m,g;if(h===0)return g=d*255,[g,g,g];d<.5?f=d*(1+h):f=d+h-d*h;const v=2*d-f,_=[0,0,0];for(let b=0;b<3;b++)m=u+1/3*-(b-1),m<0&&m++,m>1&&m--,6*m<1?g=v+(f-v)*6*m:2*m<1?g=f:3*m<2?g=v+(f-v)*(2/3-m)*6:g=v,_[b]=g*255;return _},o.hsl.hsv=function(c){const u=c[0];let h=c[1]/100,d=c[2]/100,f=h;const m=Math.max(d,.01);d*=2,h*=d<=1?d:2-d,f*=m<=1?m:2-m;const g=(d+h)/2,v=d===0?2*f/(m+f):2*h/(d+h);return[u,v*100,g*100]},o.hsv.rgb=function(c){const u=c[0]/60,h=c[1]/100;let d=c[2]/100;const f=Math.floor(u)%6,m=u-Math.floor(u),g=255*d*(1-h),v=255*d*(1-h*m),_=255*d*(1-h*(1-m));switch(d*=255,f){case 0:return[d,_,g];case 1:return[v,d,g];case 2:return[g,d,_];case 3:return[g,v,d];case 4:return[_,g,d];case 5:return[d,g,v]}},o.hsv.hsl=function(c){const u=c[0],h=c[1]/100,d=c[2]/100,f=Math.max(d,.01);let m,g;g=(2-h)*d;const v=(2-h)*f;return m=h*f,m/=v<=1?v:2-v,m=m||0,g/=2,[u,m*100,g*100]},o.hwb.rgb=function(c){const u=c[0]/360;let h=c[1]/100,d=c[2]/100;const f=h+d;let m;f>1&&(h/=f,d/=f);const g=Math.floor(6*u),v=1-d;m=6*u-g,g&1&&(m=1-m);const _=h+m*(v-h);let b,S,R;switch(g){default:case 6:case 0:b=v,S=_,R=h;break;case 1:b=_,S=v,R=h;break;case 2:b=h,S=v,R=_;break;case 3:b=h,S=_,R=v;break;case 4:b=_,S=h,R=v;break;case 5:b=v,S=h,R=_;break}return[b*255,S*255,R*255]},o.cmyk.rgb=function(c){const u=c[0]/100,h=c[1]/100,d=c[2]/100,f=c[3]/100,m=1-Math.min(1,u*(1-f)+f),g=1-Math.min(1,h*(1-f)+f),v=1-Math.min(1,d*(1-f)+f);return[m*255,g*255,v*255]},o.xyz.rgb=function(c){const u=c[0]/100,h=c[1]/100,d=c[2]/100;let f,m,g;return f=u*3.2406+h*-1.5372+d*-.4986,m=u*-.9689+h*1.8758+d*.0415,g=u*.0557+h*-.204+d*1.057,f=f>.0031308?1.055*f**(1/2.4)-.055:f*12.92,m=m>.0031308?1.055*m**(1/2.4)-.055:m*12.92,g=g>.0031308?1.055*g**(1/2.4)-.055:g*12.92,f=Math.min(Math.max(0,f),1),m=Math.min(Math.max(0,m),1),g=Math.min(Math.max(0,g),1),[f*255,m*255,g*255]},o.xyz.lab=function(c){let u=c[0],h=c[1],d=c[2];u/=95.047,h/=100,d/=108.883,u=u>.008856?u**(1/3):7.787*u+16/116,h=h>.008856?h**(1/3):7.787*h+16/116,d=d>.008856?d**(1/3):7.787*d+16/116;const f=116*h-16,m=500*(u-h),g=200*(h-d);return[f,m,g]},o.lab.xyz=function(c){const u=c[0],h=c[1],d=c[2];let f,m,g;m=(u+16)/116,f=h/500+m,g=m-d/200;const v=m**3,_=f**3,b=g**3;return m=v>.008856?v:(m-16/116)/7.787,f=_>.008856?_:(f-16/116)/7.787,g=b>.008856?b:(g-16/116)/7.787,f*=95.047,m*=100,g*=108.883,[f,m,g]},o.lab.lch=function(c){const u=c[0],h=c[1],d=c[2];let f;f=Math.atan2(d,h)*360/2/Math.PI,f<0&&(f+=360);const g=Math.sqrt(h*h+d*d);return[u,g,f]},o.lch.lab=function(c){const u=c[0],h=c[1],f=c[2]/360*2*Math.PI,m=h*Math.cos(f),g=h*Math.sin(f);return[u,m,g]},o.rgb.ansi16=function(c,u=null){const[h,d,f]=c;let m=u===null?o.rgb.hsv(c)[2]:u;if(m=Math.round(m/50),m===0)return 30;let g=30+(Math.round(f/255)<<2|Math.round(d/255)<<1|Math.round(h/255));return m===2&&(g+=60),g},o.hsv.ansi16=function(c){return o.rgb.ansi16(o.hsv.rgb(c),c[2])},o.rgb.ansi256=function(c){const u=c[0],h=c[1],d=c[2];return u===h&&h===d?u<8?16:u>248?231:Math.round((u-8)/247*24)+232:16+36*Math.round(u/255*5)+6*Math.round(h/255*5)+Math.round(d/255*5)},o.ansi16.rgb=function(c){let u=c%10;if(u===0||u===7)return c>50&&(u+=3.5),u=u/10.5*255,[u,u,u];const h=(~~(c>50)+1)*.5,d=(u&1)*h*255,f=(u>>1&1)*h*255,m=(u>>2&1)*h*255;return[d,f,m]},o.ansi256.rgb=function(c){if(c>=232){const m=(c-232)*10+8;return[m,m,m]}c-=16;let u;const h=Math.floor(c/36)/5*255,d=Math.floor((u=c%36)/6)/5*255,f=u%6/5*255;return[h,d,f]},o.rgb.hex=function(c){const h=(((Math.round(c[0])&255)<<16)+((Math.round(c[1])&255)<<8)+(Math.round(c[2])&255)).toString(16).toUpperCase();return"000000".substring(h.length)+h},o.hex.rgb=function(c){const u=c.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!u)return[0,0,0];let h=u[0];u[0].length===3&&(h=h.split("").map(v=>v+v).join(""));const d=parseInt(h,16),f=d>>16&255,m=d>>8&255,g=d&255;return[f,m,g]},o.rgb.hcg=function(c){const u=c[0]/255,h=c[1]/255,d=c[2]/255,f=Math.max(Math.max(u,h),d),m=Math.min(Math.min(u,h),d),g=f-m;let v,_;return g<1?v=m/(1-g):v=0,g<=0?_=0:f===u?_=(h-d)/g%6:f===h?_=2+(d-u)/g:_=4+(u-h)/g,_/=6,_%=1,[_*360,g*100,v*100]},o.hsl.hcg=function(c){const u=c[1]/100,h=c[2]/100,d=h<.5?2*u*h:2*u*(1-h);let f=0;return d<1&&(f=(h-.5*d)/(1-d)),[c[0],d*100,f*100]},o.hsv.hcg=function(c){const u=c[1]/100,h=c[2]/100,d=u*h;let f=0;return d<1&&(f=(h-d)/(1-d)),[c[0],d*100,f*100]},o.hcg.rgb=function(c){const u=c[0]/360,h=c[1]/100,d=c[2]/100;if(h===0)return[d*255,d*255,d*255];const f=[0,0,0],m=u%1*6,g=m%1,v=1-g;let _=0;switch(Math.floor(m)){case 0:f[0]=1,f[1]=g,f[2]=0;break;case 1:f[0]=v,f[1]=1,f[2]=0;break;case 2:f[0]=0,f[1]=1,f[2]=g;break;case 3:f[0]=0,f[1]=v,f[2]=1;break;case 4:f[0]=g,f[1]=0,f[2]=1;break;default:f[0]=1,f[1]=0,f[2]=v}return _=(1-h)*d,[(h*f[0]+_)*255,(h*f[1]+_)*255,(h*f[2]+_)*255]},o.hcg.hsv=function(c){const u=c[1]/100,h=c[2]/100,d=u+h*(1-u);let f=0;return d>0&&(f=u/d),[c[0],f*100,d*100]},o.hcg.hsl=function(c){const u=c[1]/100,d=c[2]/100*(1-u)+.5*u;let f=0;return d>0&&d<.5?f=u/(2*d):d>=.5&&d<1&&(f=u/(2*(1-d))),[c[0],f*100,d*100]},o.hcg.hwb=function(c){const u=c[1]/100,h=c[2]/100,d=u+h*(1-u);return[c[0],(d-u)*100,(1-d)*100]},o.hwb.hcg=function(c){const u=c[1]/100,d=1-c[2]/100,f=d-u;let m=0;return f<1&&(m=(d-f)/(1-f)),[c[0],f*100,m*100]},o.apple.rgb=function(c){return[c[0]/65535*255,c[1]/65535*255,c[2]/65535*255]},o.rgb.apple=function(c){return[c[0]/255*65535,c[1]/255*65535,c[2]/255*65535]},o.gray.rgb=function(c){return[c[0]/100*255,c[0]/100*255,c[0]/100*255]},o.gray.hsl=function(c){return[0,0,c[0]]},o.gray.hsv=o.gray.hsl,o.gray.hwb=function(c){return[0,100,c[0]]},o.gray.cmyk=function(c){return[0,0,0,c[0]]},o.gray.lab=function(c){return[c[0],0,0]},o.gray.hex=function(c){const u=Math.round(c[0]/100*255)&255,d=((u<<16)+(u<<8)+u).toString(16).toUpperCase();return"000000".substring(d.length)+d},o.rgb.gray=function(c){return[(c[0]+c[1]+c[2])/3/255*100]}}}),require_route=__commonJS({"node_modules/.pnpm/color-convert@2.0.1/node_modules/color-convert/route.js"(e,t){var r=require_conversions();function i(){const u={},h=Object.keys(r);for(let d=h.length,f=0;f<d;f++)u[h[f]]={distance:-1,parent:null};return u}function o(u){const h=i(),d=[u];for(h[u].distance=0;d.length;){const f=d.pop(),m=Object.keys(r[f]);for(let g=m.length,v=0;v<g;v++){const _=m[v],b=h[_];b.distance===-1&&(b.distance=h[f].distance+1,b.parent=f,d.unshift(_))}}return h}function a(u,h){return function(d){return h(u(d))}}function c(u,h){const d=[h[u].parent,u];let f=r[h[u].parent][u],m=h[u].parent;for(;h[m].parent;)d.unshift(h[m].parent),f=a(r[h[m].parent][m],f),m=h[m].parent;return f.conversion=d,f}t.exports=function(u){const h=o(u),d={},f=Object.keys(h);for(let m=f.length,g=0;g<m;g++){const v=f[g];h[v].parent!==null&&(d[v]=c(v,h))}return d}}}),require_color_convert=__commonJS({"node_modules/.pnpm/color-convert@2.0.1/node_modules/color-convert/index.js"(e,t){var r=require_conversions(),i=require_route(),o={},a=Object.keys(r);function c(h){const d=function(...f){const m=f[0];return m==null?m:(m.length>1&&(f=m),h(f))};return"conversion"in h&&(d.conversion=h.conversion),d}function u(h){const d=function(...f){const m=f[0];if(m==null)return m;m.length>1&&(f=m);const g=h(f);if(typeof g=="object")for(let v=g.length,_=0;_<v;_++)g[_]=Math.round(g[_]);return g};return"conversion"in h&&(d.conversion=h.conversion),d}a.forEach(h=>{o[h]={},Object.defineProperty(o[h],"channels",{value:r[h].channels}),Object.defineProperty(o[h],"labels",{value:r[h].labels});const d=i(h);Object.keys(d).forEach(m=>{const g=d[m];o[h][m]=u(g),o[h][m].raw=c(g)})}),t.exports=o}});function round(e){return e+.5|0}var lim=(e,t,r)=>Math.max(Math.min(e,r),t);function p2b(e){return lim(round(e*2.55),0,255)}function n2b(e){return lim(round(e*255),0,255)}function b2n(e){return lim(round(e/2.55)/100,0,1)}function n2p(e){return lim(round(e*100),0,100)}var map$1={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},hex=[..."0123456789ABCDEF"],h1=e=>hex[e&15],h2=e=>hex[(e&240)>>4]+hex[e&15],eq=e=>(e&240)>>4===(e&15),isShort=e=>eq(e.r)&&eq(e.g)&&eq(e.b)&&eq(e.a);function hexParse(e){var t=e.length,r;return e[0]==="#"&&(t===4||t===5?r={r:255&map$1[e[1]]*17,g:255&map$1[e[2]]*17,b:255&map$1[e[3]]*17,a:t===5?map$1[e[4]]*17:255}:(t===7||t===9)&&(r={r:map$1[e[1]]<<4|map$1[e[2]],g:map$1[e[3]]<<4|map$1[e[4]],b:map$1[e[5]]<<4|map$1[e[6]],a:t===9?map$1[e[7]]<<4|map$1[e[8]]:255})),r}var alpha=(e,t)=>e<255?t(e):"";function hexString(e){var t=isShort(e)?h1:h2;return e?"#"+t(e.r)+t(e.g)+t(e.b)+alpha(e.a,t):void 0}var HUE_RE=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function hsl2rgbn(e,t,r){const i=t*Math.min(r,1-r),o=(a,c=(a+e/30)%12)=>r-i*Math.max(Math.min(c-3,9-c,1),-1);return[o(0),o(8),o(4)]}function hsv2rgbn(e,t,r){const i=(o,a=(o+e/60)%6)=>r-r*t*Math.max(Math.min(a,4-a,1),0);return[i(5),i(3),i(1)]}function hwb2rgbn(e,t,r){const i=hsl2rgbn(e,1,.5);let o;for(t+r>1&&(o=1/(t+r),t*=o,r*=o),o=0;o<3;o++)i[o]*=1-t-r,i[o]+=t;return i}function hueValue(e,t,r,i,o){return e===o?(t-r)/i+(t<r?6:0):t===o?(r-e)/i+2:(e-t)/i+4}function rgb2hsl(e){const r=e.r/255,i=e.g/255,o=e.b/255,a=Math.max(r,i,o),c=Math.min(r,i,o),u=(a+c)/2;let h,d,f;return a!==c&&(f=a-c,d=u>.5?f/(2-a-c):f/(a+c),h=hueValue(r,i,o,f,a),h=h*60+.5),[h|0,d||0,u]}function calln(e,t,r,i){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,r,i)).map(n2b)}function hsl2rgb(e,t,r){return calln(hsl2rgbn,e,t,r)}function hwb2rgb(e,t,r){return calln(hwb2rgbn,e,t,r)}function hsv2rgb(e,t,r){return calln(hsv2rgbn,e,t,r)}function hue(e){return(e%360+360)%360}function hueParse(e){const t=HUE_RE.exec(e);let r=255,i;if(!t)return;t[5]!==i&&(r=t[6]?p2b(+t[5]):n2b(+t[5]));const o=hue(+t[2]),a=+t[3]/100,c=+t[4]/100;return t[1]==="hwb"?i=hwb2rgb(o,a,c):t[1]==="hsv"?i=hsv2rgb(o,a,c):i=hsl2rgb(o,a,c),{r:i[0],g:i[1],b:i[2],a:r}}function rotate(e,t){var r=rgb2hsl(e);r[0]=hue(r[0]+t),r=hsl2rgb(r),e.r=r[0],e.g=r[1],e.b=r[2]}function hslString(e){if(!e)return;const t=rgb2hsl(e),r=t[0],i=n2p(t[1]),o=n2p(t[2]);return e.a<255?`hsla(${r}, ${i}%, ${o}%, ${b2n(e.a)})`:`hsl(${r}, ${i}%, ${o}%)`}var map={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},names$1={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function unpack(){const e={},t=Object.keys(names$1),r=Object.keys(map);let i,o,a,c,u;for(i=0;i<t.length;i++){for(c=u=t[i],o=0;o<r.length;o++)a=r[o],u=u.replace(a,map[a]);a=parseInt(names$1[c],16),e[u]=[a>>16&255,a>>8&255,a&255]}return e}var names;function nameParse(e){names||(names=unpack(),names.transparent=[0,0,0,0]);const t=names[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}var RGB_RE=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function rgbParse(e){const t=RGB_RE.exec(e);let r=255,i,o,a;if(t){if(t[7]!==i){const c=+t[7];r=t[8]?p2b(c):lim(c*255,0,255)}return i=+t[1],o=+t[3],a=+t[5],i=255&(t[2]?p2b(i):lim(i,0,255)),o=255&(t[4]?p2b(o):lim(o,0,255)),a=255&(t[6]?p2b(a):lim(a,0,255)),{r:i,g:o,b:a,a:r}}}function rgbString(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${b2n(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}var to=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,from=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function interpolate(e,t,r){const i=from(b2n(e.r)),o=from(b2n(e.g)),a=from(b2n(e.b));return{r:n2b(to(i+r*(from(b2n(t.r))-i))),g:n2b(to(o+r*(from(b2n(t.g))-o))),b:n2b(to(a+r*(from(b2n(t.b))-a))),a:e.a+r*(t.a-e.a)}}function modHSL(e,t,r){if(e){let i=rgb2hsl(e);i[t]=Math.max(0,Math.min(i[t]+i[t]*r,t===0?360:1)),i=hsl2rgb(i),e.r=i[0],e.g=i[1],e.b=i[2]}}function clone(e,t){return e&&Object.assign(t||{},e)}function fromObject(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=n2b(e[3]))):(t=clone(e,{r:0,g:0,b:0,a:1}),t.a=n2b(t.a)),t}function functionParse(e){return e.charAt(0)==="r"?rgbParse(e):hueParse(e)}var Color=class si{constructor(t){if(t instanceof si)return t;const r=typeof t;let i;r==="object"?i=fromObject(t):r==="string"&&(i=hexParse(t)||nameParse(t)||functionParse(t)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var t=clone(this._rgb);return t&&(t.a=b2n(t.a)),t}set rgb(t){this._rgb=fromObject(t)}rgbString(){return this._valid?rgbString(this._rgb):void 0}hexString(){return this._valid?hexString(this._rgb):void 0}hslString(){return this._valid?hslString(this._rgb):void 0}mix(t,r){if(t){const i=this.rgb,o=t.rgb;let a;const c=r===a?.5:r,u=2*c-1,h=i.a-o.a,d=((u*h===-1?u:(u+h)/(1+u*h))+1)/2;a=1-d,i.r=255&d*i.r+a*o.r+.5,i.g=255&d*i.g+a*o.g+.5,i.b=255&d*i.b+a*o.b+.5,i.a=c*i.a+(1-c)*o.a,this.rgb=i}return this}interpolate(t,r){return t&&(this._rgb=interpolate(this._rgb,t._rgb,r)),this}clone(){return new si(this.rgb)}alpha(t){return this._rgb.a=n2b(t),this}clearer(t){const r=this._rgb;return r.a*=1-t,this}greyscale(){const t=this._rgb,r=round(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=r,this}opaquer(t){const r=this._rgb;return r.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return modHSL(this._rgb,2,t),this}darken(t){return modHSL(this._rgb,2,-t),this}saturate(t){return modHSL(this._rgb,1,t),this}desaturate(t){return modHSL(this._rgb,1,-t),this}rotate(t){return rotate(this._rgb,t),this}},uid=(()=>{let e=0;return()=>e++})();function isNullOrUndef(e){return e==null}function isArray(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function isObject(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function isNumberFinite(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function finiteOrDefault(e,t){return isNumberFinite(e)?e:t}function valueOrDefault(e,t){return typeof e>"u"?t:e}var toDimension=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function callback(e,t,r){if(e&&typeof e.call=="function")return e.apply(r,t)}function each(e,t,r,i){let o,a,c;if(isArray(e))if(a=e.length,i)for(o=a-1;o>=0;o--)t.call(r,e[o],o);else for(o=0;o<a;o++)t.call(r,e[o],o);else if(isObject(e))for(c=Object.keys(e),a=c.length,o=0;o<a;o++)t.call(r,e[c[o]],c[o])}function _elementsEqual(e,t){let r,i,o,a;if(!e||!t||e.length!==t.length)return!1;for(r=0,i=e.length;r<i;++r)if(o=e[r],a=t[r],o.datasetIndex!==a.datasetIndex||o.index!==a.index)return!1;return!0}function clone2(e){if(isArray(e))return e.map(clone2);if(isObject(e)){const t=Object.create(null),r=Object.keys(e),i=r.length;let o=0;for(;o<i;++o)t[r[o]]=clone2(e[r[o]]);return t}return e}function isValidKey(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function _merger(e,t,r,i){if(!isValidKey(e))return;const o=t[e],a=r[e];isObject(o)&&isObject(a)?merge(o,a,i):t[e]=clone2(a)}function merge(e,t,r){const i=isArray(t)?t:[t],o=i.length;if(!isObject(e))return e;r=r||{};const a=r.merger||_merger;let c;for(let u=0;u<o;++u){if(c=i[u],!isObject(c))continue;const h=Object.keys(c);for(let d=0,f=h.length;d<f;++d)a(h[d],e,c,r)}return e}function mergeIf(e,t){return merge(e,t,{merger:_mergerIf})}function _mergerIf(e,t,r){if(!isValidKey(e))return;const i=t[e],o=r[e];isObject(i)&&isObject(o)?mergeIf(i,o):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=clone2(o))}var keyResolvers={"":e=>e,x:e=>e.x,y:e=>e.y};function _splitKey(e){const t=e.split("."),r=[];let i="";for(const o of t)i+=o,i.endsWith("\\")?i=i.slice(0,-1)+".":(r.push(i),i="");return r}function _getKeyResolver(e){const t=_splitKey(e);return r=>{for(const i of t){if(i==="")break;r=r&&r[i]}return r}}function resolveObjectKey(e,t){return(keyResolvers[t]||(keyResolvers[t]=_getKeyResolver(t)))(e)}function _capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}var defined=e=>typeof e<"u",isFunction=e=>typeof e=="function",setsEqual=(e,t)=>{if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0};function _isClickEvent(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}var PI=Math.PI,TAU=2*PI,PITAU=TAU+PI,INFINITY=Number.POSITIVE_INFINITY,RAD_PER_DEG=PI/180,HALF_PI=PI/2,QUARTER_PI=PI/4,TWO_THIRDS_PI=PI*2/3,log10=Math.log10,sign=Math.sign;function almostEquals(e,t,r){return Math.abs(e-t)<r}function niceNum(e){const t=Math.round(e);e=almostEquals(e,t,e/1e3)?t:e;const r=Math.pow(10,Math.floor(log10(e))),i=e/r;return(i<=1?1:i<=2?2:i<=5?5:10)*r}function _factorize(e){const t=[],r=Math.sqrt(e);let i;for(i=1;i<r;i++)e%i===0&&(t.push(i),t.push(e/i));return r===(r|0)&&t.push(r),t.sort((o,a)=>o-a).pop(),t}function isNumber(e){return!isNaN(parseFloat(e))&&isFinite(e)}function almostWhole(e,t){const r=Math.round(e);return r-t<=e&&r+t>=e}function _setMinAndMaxByKey(e,t,r){let i,o,a;for(i=0,o=e.length;i<o;i++)a=e[i][r],isNaN(a)||(t.min=Math.min(t.min,a),t.max=Math.max(t.max,a))}function toRadians(e){return e*(PI/180)}function toDegrees(e){return e*(180/PI)}function _decimalPlaces(e){if(!isNumberFinite(e))return;let t=1,r=0;for(;Math.round(e*t)/t!==e;)t*=10,r++;return r}function getAngleFromPoint(e,t){const r=t.x-e.x,i=t.y-e.y,o=Math.sqrt(r*r+i*i);let a=Math.atan2(i,r);return a<-.5*PI&&(a+=TAU),{angle:a,distance:o}}function _normalizeAngle(e){return(e%TAU+TAU)%TAU}function _angleBetween(e,t,r,i){const o=_normalizeAngle(e),a=_normalizeAngle(t),c=_normalizeAngle(r),u=_normalizeAngle(a-o),h=_normalizeAngle(c-o),d=_normalizeAngle(o-a),f=_normalizeAngle(o-c);return o===a||o===c||i&&a===c||u>h&&d<f}function _limitValue(e,t,r){return Math.max(t,Math.min(r,e))}function _int16Range(e){return _limitValue(e,-32768,32767)}function _lookup(e,t,r){r=r||(c=>e[c]<t);let i=e.length-1,o=0,a;for(;i-o>1;)a=o+i>>1,r(a)?o=a:i=a;return{lo:o,hi:i}}var _lookupByKey=(e,t,r,i)=>_lookup(e,r,i?o=>{const a=e[o][t];return a<r||a===r&&e[o+1][t]===r}:o=>e[o][t]<r),_rlookupByKey=(e,t,r)=>_lookup(e,r,i=>e[i][t]>=r);function _filterBetween(e,t,r){let i=0,o=e.length;for(;i<o&&e[i]<t;)i++;for(;o>i&&e[o-1]>r;)o--;return i>0||o<e.length?e.slice(i,o):e}var arrayEvents=["push","pop","shift","splice","unshift"];function listenArrayEvents(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),arrayEvents.forEach(r=>{const i="_onData"+_capitalize(r),o=e[r];Object.defineProperty(e,r,{configurable:!0,enumerable:!1,value(...a){const c=o.apply(this,a);return e._chartjs.listeners.forEach(u=>{typeof u[i]=="function"&&u[i](...a)}),c}})})}function unlistenArrayEvents(e,t){const r=e._chartjs;if(!r)return;const i=r.listeners,o=i.indexOf(t);o!==-1&&i.splice(o,1),!(i.length>0)&&(arrayEvents.forEach(a=>{delete e[a]}),delete e._chartjs)}function _arrayUnique(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}var requestAnimFrame=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function throttled(e,t){let r=[],i=!1;return function(...o){r=o,i||(i=!0,requestAnimFrame.call(window,()=>{i=!1,e.apply(t,r)}))}}function debounce(e,t){let r;return function(...i){return t?(clearTimeout(r),r=setTimeout(e,t,i)):e.apply(this,i),t}}var _toLeftRightCenter=e=>e==="start"?"left":e==="end"?"right":"center",_alignStartEnd=(e,t,r)=>e==="start"?t:e==="end"?r:(t+r)/2,atEdge=e=>e===0||e===1,elasticIn=(e,t,r)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*TAU/r)),elasticOut=(e,t,r)=>Math.pow(2,-10*e)*Math.sin((e-t)*TAU/r)+1,effects={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*HALF_PI)+1,easeOutSine:e=>Math.sin(e*HALF_PI),easeInOutSine:e=>-.5*(Math.cos(PI*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>atEdge(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>atEdge(e)?e:elasticIn(e,.075,.3),easeOutElastic:e=>atEdge(e)?e:elasticOut(e,.075,.3),easeInOutElastic(e){return atEdge(e)?e:e<.5?.5*elasticIn(e*2,.1125,.45):.5+.5*elasticOut(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-effects.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?effects.easeInBounce(e*2)*.5:effects.easeOutBounce(e*2-1)*.5+.5};function isPatternOrGradient(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function color(e){return isPatternOrGradient(e)?e:new Color(e)}function getHoverColor(e){return isPatternOrGradient(e)?e:new Color(e).saturate(.5).darken(.1).hexString()}var numbers=["x","y","borderWidth","radius","tension"],colors=["color","borderColor","backgroundColor"];function applyAnimationsDefaults(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:colors},numbers:{type:"number",properties:numbers}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function applyLayoutsDefaults(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}var intlCache=new Map;function getNumberFormat(e,t){t=t||{};const r=e+JSON.stringify(t);let i=intlCache.get(r);return i||(i=new Intl.NumberFormat(e,t),intlCache.set(r,i)),i}function formatNumber(e,t,r){return getNumberFormat(t,r).format(e)}var formatters={values(e){return isArray(e)?e:""+e},numeric(e,t,r){if(e===0)return"0";const i=this.chart.options.locale;let o,a=e;if(r.length>1){const d=Math.max(Math.abs(r[0].value),Math.abs(r[r.length-1].value));(d<1e-4||d>1e15)&&(o="scientific"),a=calculateDelta(e,r)}const c=log10(Math.abs(a)),u=isNaN(c)?1:Math.max(Math.min(-1*Math.floor(c),20),0),h={notation:o,minimumFractionDigits:u,maximumFractionDigits:u};return Object.assign(h,this.options.ticks.format),formatNumber(e,i,h)},logarithmic(e,t,r){if(e===0)return"0";const i=r[t].significand||e/Math.pow(10,Math.floor(log10(e)));return[1,2,3,5,10,15].includes(i)||t>.8*r.length?formatters.numeric.call(this,e,t,r):""}};function calculateDelta(e,t){let r=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(r)>=1&&e!==Math.floor(e)&&(r=e-Math.floor(e)),r}var Ticks={formatters};function applyScaleDefaults(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,r)=>r.lineWidth,tickColor:(t,r)=>r.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Ticks.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}var overrides=Object.create(null),descriptors=Object.create(null);function getScope$1(e,t){if(!t)return e;const r=t.split(".");for(let i=0,o=r.length;i<o;++i){const a=r[i];e=e[a]||(e[a]=Object.create(null))}return e}function set(e,t,r){return typeof t=="string"?merge(getScope$1(e,t),r):merge(getScope$1(e,""),t)}var Defaults=class{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,i)=>getHoverColor(i.backgroundColor),this.hoverBorderColor=(r,i)=>getHoverColor(i.borderColor),this.hoverColor=(r,i)=>getHoverColor(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return set(this,e,t)}get(e){return getScope$1(this,e)}describe(e,t){return set(descriptors,e,t)}override(e,t){return set(overrides,e,t)}route(e,t,r,i){const o=getScope$1(this,e),a=getScope$1(this,r),c="_"+t;Object.defineProperties(o,{[c]:{value:o[t],writable:!0},[t]:{enumerable:!0,get(){const u=this[c],h=a[i];return isObject(u)?Object.assign({},h,u):valueOrDefault(u,h)},set(u){this[c]=u}}})}apply(e){e.forEach(t=>t(this))}},defaults=new Defaults({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[applyAnimationsDefaults,applyLayoutsDefaults,applyScaleDefaults]);function toFontString(e){return!e||isNullOrUndef(e.size)||isNullOrUndef(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function _measureText(e,t,r,i,o){let a=t[o];return a||(a=t[o]=e.measureText(o).width,r.push(o)),a>i&&(i=a),i}function _longestText(e,t,r,i){i=i||{};let o=i.data=i.data||{},a=i.garbageCollect=i.garbageCollect||[];i.font!==t&&(o=i.data={},a=i.garbageCollect=[],i.font=t),e.save(),e.font=t;let c=0;const u=r.length;let h,d,f,m,g;for(h=0;h<u;h++)if(m=r[h],m!=null&&!isArray(m))c=_measureText(e,o,a,c,m);else if(isArray(m))for(d=0,f=m.length;d<f;d++)g=m[d],g!=null&&!isArray(g)&&(c=_measureText(e,o,a,c,g));e.restore();const v=a.length/2;if(v>r.length){for(h=0;h<v;h++)delete o[a[h]];a.splice(0,v)}return c}function _alignPixel(e,t,r){const i=e.currentDevicePixelRatio,o=r!==0?Math.max(r/2,.5):0;return Math.round((t-o)*i)/i+o}function clearCanvas(e,t){!t&&!e||(t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function _isPointInArea(e,t,r){return r=r||.5,!t||e&&e.x>t.left-r&&e.x<t.right+r&&e.y>t.top-r&&e.y<t.bottom+r}function clipArea(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function unclipArea(e){e.restore()}function setRenderOpts(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),isNullOrUndef(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function decorateText(e,t,r,i,o){if(o.strikethrough||o.underline){const a=e.measureText(i),c=t-a.actualBoundingBoxLeft,u=t+a.actualBoundingBoxRight,h=r-a.actualBoundingBoxAscent,d=r+a.actualBoundingBoxDescent,f=o.strikethrough?(h+d)/2:d;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=o.decorationWidth||2,e.moveTo(c,f),e.lineTo(u,f),e.stroke()}}function drawBackdrop(e,t){const r=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=r}function renderText(e,t,r,i,o,a={}){const c=isArray(t)?t:[t],u=a.strokeWidth>0&&a.strokeColor!=="";let h,d;for(e.save(),e.font=o.string,setRenderOpts(e,a),h=0;h<c.length;++h)d=c[h],a.backdrop&&drawBackdrop(e,a.backdrop),u&&(a.strokeColor&&(e.strokeStyle=a.strokeColor),isNullOrUndef(a.strokeWidth)||(e.lineWidth=a.strokeWidth),e.strokeText(d,r,i,a.maxWidth)),e.fillText(d,r,i,a.maxWidth),decorateText(e,r,i,d,a),i+=Number(o.lineHeight);e.restore()}function addRoundedRectPath(e,t){const{x:r,y:i,w:o,h:a,radius:c}=t;e.arc(r+c.topLeft,i+c.topLeft,c.topLeft,1.5*PI,PI,!0),e.lineTo(r,i+a-c.bottomLeft),e.arc(r+c.bottomLeft,i+a-c.bottomLeft,c.bottomLeft,PI,HALF_PI,!0),e.lineTo(r+o-c.bottomRight,i+a),e.arc(r+o-c.bottomRight,i+a-c.bottomRight,c.bottomRight,HALF_PI,0,!0),e.lineTo(r+o,i+c.topRight),e.arc(r+o-c.topRight,i+c.topRight,c.topRight,0,-HALF_PI,!0),e.lineTo(r+c.topLeft,i)}var LINE_HEIGHT=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,FONT_STYLE=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function toLineHeight(e,t){const r=(""+e).match(LINE_HEIGHT);if(!r||r[1]==="normal")return t*1.2;switch(e=+r[2],r[3]){case"px":return e;case"%":e/=100;break}return t*e}var numberOrZero=e=>+e||0;function _readValueToProps(e,t){const r={},i=isObject(t),o=i?Object.keys(t):t,a=isObject(e)?i?c=>valueOrDefault(e[c],e[t[c]]):c=>e[c]:()=>e;for(const c of o)r[c]=numberOrZero(a(c));return r}function toTRBL(e){return _readValueToProps(e,{top:"y",right:"x",bottom:"y",left:"x"})}function toTRBLCorners(e){return _readValueToProps(e,["topLeft","topRight","bottomLeft","bottomRight"])}function toPadding(e){const t=toTRBL(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function toFont(e,t){e=e||{},t=t||defaults.font;let r=valueOrDefault(e.size,t.size);typeof r=="string"&&(r=parseInt(r,10));let i=valueOrDefault(e.style,t.style);i&&!(""+i).match(FONT_STYLE)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const o={family:valueOrDefault(e.family,t.family),lineHeight:toLineHeight(valueOrDefault(e.lineHeight,t.lineHeight),r),size:r,style:i,weight:valueOrDefault(e.weight,t.weight),string:""};return o.string=toFontString(o),o}function resolve(e,t,r,i){let o=!0,a,c,u;for(a=0,c=e.length;a<c;++a)if(u=e[a],u!==void 0&&(t!==void 0&&typeof u=="function"&&(u=u(t),o=!1),r!==void 0&&isArray(u)&&(u=u[r%u.length],o=!1),u!==void 0))return i&&!o&&(i.cacheable=!1),u}function _addGrace(e,t,r){const{min:i,max:o}=e,a=toDimension(t,(o-i)/2),c=(u,h)=>r&&u===0?0:u+h;return{min:c(i,-Math.abs(a)),max:c(o,a)}}function createContext(e,t){return Object.assign(Object.create(e),t)}function _createResolver(e,t=[""],r,i,o=()=>e[0]){const a=r||e;typeof i>"u"&&(i=_resolve("_fallback",e));const c={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:a,_fallback:i,_getTarget:o,override:u=>_createResolver([u,...e],t,a,i)};return new Proxy(c,{deleteProperty(u,h){return delete u[h],delete u._keys,delete e[0][h],!0},get(u,h){return _cached(u,h,()=>_resolveWithPrefixes(h,t,e,u))},getOwnPropertyDescriptor(u,h){return Reflect.getOwnPropertyDescriptor(u._scopes[0],h)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(u,h){return getKeysFromAllScopes(u).includes(h)},ownKeys(u){return getKeysFromAllScopes(u)},set(u,h,d){const f=u._storage||(u._storage=o());return u[h]=f[h]=d,delete u._keys,!0}})}function _attachContext(e,t,r,i){const o={_cacheable:!1,_proxy:e,_context:t,_subProxy:r,_stack:new Set,_descriptors:_descriptors(e,i),setContext:a=>_attachContext(e,a,r,i),override:a=>_attachContext(e.override(a),t,r,i)};return new Proxy(o,{deleteProperty(a,c){return delete a[c],delete e[c],!0},get(a,c,u){return _cached(a,c,()=>_resolveWithContext(a,c,u))},getOwnPropertyDescriptor(a,c){return a._descriptors.allKeys?Reflect.has(e,c)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,c)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(a,c){return Reflect.has(e,c)},ownKeys(){return Reflect.ownKeys(e)},set(a,c,u){return e[c]=u,delete a[c],!0}})}function _descriptors(e,t={scriptable:!0,indexable:!0}){const{_scriptable:r=t.scriptable,_indexable:i=t.indexable,_allKeys:o=t.allKeys}=e;return{allKeys:o,scriptable:r,indexable:i,isScriptable:isFunction(r)?r:()=>r,isIndexable:isFunction(i)?i:()=>i}}var readKey=(e,t)=>e?e+_capitalize(t):t,needsSubResolver=(e,t)=>isObject(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function _cached(e,t,r){if(Object.prototype.hasOwnProperty.call(e,t)||t==="constructor")return e[t];const i=r();return e[t]=i,i}function _resolveWithContext(e,t,r){const{_proxy:i,_context:o,_subProxy:a,_descriptors:c}=e;let u=i[t];return isFunction(u)&&c.isScriptable(t)&&(u=_resolveScriptable(t,u,e,r)),isArray(u)&&u.length&&(u=_resolveArray(t,u,e,c.isIndexable)),needsSubResolver(t,u)&&(u=_attachContext(u,o,a&&a[t],c)),u}function _resolveScriptable(e,t,r,i){const{_proxy:o,_context:a,_subProxy:c,_stack:u}=r;if(u.has(e))throw new Error("Recursion detected: "+Array.from(u).join("->")+"->"+e);u.add(e);let h=t(a,c||i);return u.delete(e),needsSubResolver(e,h)&&(h=createSubResolver(o._scopes,o,e,h)),h}function _resolveArray(e,t,r,i){const{_proxy:o,_context:a,_subProxy:c,_descriptors:u}=r;if(typeof a.index<"u"&&i(e))return t[a.index%t.length];if(isObject(t[0])){const h=t,d=o._scopes.filter(f=>f!==h);t=[];for(const f of h){const m=createSubResolver(d,o,e,f);t.push(_attachContext(m,a,c&&c[e],u))}}return t}function resolveFallback(e,t,r){return isFunction(e)?e(t,r):e}var getScope=(e,t)=>e===!0?t:typeof e=="string"?resolveObjectKey(t,e):void 0;function addScopes(e,t,r,i,o){for(const a of t){const c=getScope(r,a);if(c){e.add(c);const u=resolveFallback(c._fallback,r,o);if(typeof u<"u"&&u!==r&&u!==i)return u}else if(c===!1&&typeof i<"u"&&r!==i)return null}return!1}function createSubResolver(e,t,r,i){const o=t._rootScopes,a=resolveFallback(t._fallback,r,i),c=[...e,...o],u=new Set;u.add(i);let h=addScopesFromKey(u,c,r,a||r,i);return h===null||typeof a<"u"&&a!==r&&(h=addScopesFromKey(u,c,a,h,i),h===null)?!1:_createResolver(Array.from(u),[""],o,a,()=>subGetTarget(t,r,i))}function addScopesFromKey(e,t,r,i,o){for(;r;)r=addScopes(e,t,r,i,o);return r}function subGetTarget(e,t,r){const i=e._getTarget();t in i||(i[t]={});const o=i[t];return isArray(o)&&isObject(r)?r:o||{}}function _resolveWithPrefixes(e,t,r,i){let o;for(const a of t)if(o=_resolve(readKey(a,e),r),typeof o<"u")return needsSubResolver(e,o)?createSubResolver(r,i,e,o):o}function _resolve(e,t){for(const r of t){if(!r)continue;const i=r[e];if(typeof i<"u")return i}}function getKeysFromAllScopes(e){let t=e._keys;return t||(t=e._keys=resolveKeysFromAllScopes(e._scopes)),t}function resolveKeysFromAllScopes(e){const t=new Set;for(const r of e)for(const i of Object.keys(r).filter(o=>!o.startsWith("_")))t.add(i);return Array.from(t)}var EPSILON=Number.EPSILON||1e-14;function _isDomSupported(){return typeof window<"u"&&typeof document<"u"}function _getParentNode(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function parseMaxStyle(e,t,r){let i;return typeof e=="string"?(i=parseInt(e,10),e.indexOf("%")!==-1&&(i=i/100*t.parentNode[r])):i=e,i}var getComputedStyle2=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function getStyle(e,t){return getComputedStyle2(e).getPropertyValue(t)}var positions=["top","right","bottom","left"];function getPositionedStyle(e,t,r){const i={};r=r?"-"+r:"";for(let o=0;o<4;o++){const a=positions[o];i[a]=parseFloat(e[t+"-"+a+r])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}var useOffsetPos=(e,t,r)=>(e>0||t>0)&&(!r||!r.shadowRoot);function getCanvasPosition(e,t){const r=e.touches,i=r&&r.length?r[0]:e,{offsetX:o,offsetY:a}=i;let c=!1,u,h;if(useOffsetPos(o,a,e.target))u=o,h=a;else{const d=t.getBoundingClientRect();u=i.clientX-d.left,h=i.clientY-d.top,c=!0}return{x:u,y:h,box:c}}function getRelativePosition(e,t){if("native"in e)return e;const{canvas:r,currentDevicePixelRatio:i}=t,o=getComputedStyle2(r),a=o.boxSizing==="border-box",c=getPositionedStyle(o,"padding"),u=getPositionedStyle(o,"border","width"),{x:h,y:d,box:f}=getCanvasPosition(e,r),m=c.left+(f&&u.left),g=c.top+(f&&u.top);let{width:v,height:_}=t;return a&&(v-=c.width+u.width,_-=c.height+u.height),{x:Math.round((h-m)/v*r.width/i),y:Math.round((d-g)/_*r.height/i)}}function getContainerSize(e,t,r){let i,o;if(t===void 0||r===void 0){const a=e&&_getParentNode(e);if(!a)t=e.clientWidth,r=e.clientHeight;else{const c=a.getBoundingClientRect(),u=getComputedStyle2(a),h=getPositionedStyle(u,"border","width"),d=getPositionedStyle(u,"padding");t=c.width-d.width-h.width,r=c.height-d.height-h.height,i=parseMaxStyle(u.maxWidth,a,"clientWidth"),o=parseMaxStyle(u.maxHeight,a,"clientHeight")}}return{width:t,height:r,maxWidth:i||INFINITY,maxHeight:o||INFINITY}}var round1=e=>Math.round(e*10)/10;function getMaximumSize(e,t,r,i){const o=getComputedStyle2(e),a=getPositionedStyle(o,"margin"),c=parseMaxStyle(o.maxWidth,e,"clientWidth")||INFINITY,u=parseMaxStyle(o.maxHeight,e,"clientHeight")||INFINITY,h=getContainerSize(e,t,r);let{width:d,height:f}=h;if(o.boxSizing==="content-box"){const g=getPositionedStyle(o,"border","width"),v=getPositionedStyle(o,"padding");d-=v.width+g.width,f-=v.height+g.height}return d=Math.max(0,d-a.width),f=Math.max(0,i?d/i:f-a.height),d=round1(Math.min(d,c,h.maxWidth)),f=round1(Math.min(f,u,h.maxHeight)),d&&!f&&(f=round1(d/2)),(t!==void 0||r!==void 0)&&i&&h.height&&f>h.height&&(f=h.height,d=round1(Math.floor(f*i))),{width:d,height:f}}function retinaScale(e,t,r){const i=t||1,o=Math.floor(e.height*i),a=Math.floor(e.width*i);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const c=e.canvas;return c.style&&(r||!c.style.height&&!c.style.width)&&(c.style.height=`${e.height}px`,c.style.width=`${e.width}px`),e.currentDevicePixelRatio!==i||c.height!==o||c.width!==a?(e.currentDevicePixelRatio=i,c.height=o,c.width=a,e.ctx.setTransform(i,0,0,i,0,0),!0):!1}var supportsEventListenerOptions=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};_isDomSupported()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e}();function readUsedSize(e,t){const r=getStyle(e,t),i=r&&r.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}var Animator=class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,r,i){const o=t.listeners[i],a=t.duration;o.forEach(c=>c({chart:e,initial:t.initial,numSteps:a,currentStep:Math.min(r-t.start,a)}))}_refresh(){this._request||(this._running=!0,this._request=requestAnimFrame.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((r,i)=>{if(!r.running||!r.items.length)return;const o=r.items;let a=o.length-1,c=!1,u;for(;a>=0;--a)u=o[a],u._active?(u._total>r.duration&&(r.duration=u._total),u.tick(e),c=!0):(o[a]=o[o.length-1],o.pop());c&&(i.draw(),this._notify(i,r,e,"progress")),o.length||(r.running=!1,this._notify(i,r,e,"complete"),r.initial=!1),t+=o.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let r=t.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,r)),r}listen(e,t,r){this._getAnims(e).listeners[t].push(r)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((r,i)=>Math.max(r,i._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const r=t.items;let i=r.length-1;for(;i>=0;--i)r[i].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}},animator=new Animator,transparent="transparent",interpolators={boolean(e,t,r){return r>.5?t:e},color(e,t,r){const i=color(e||transparent),o=i.valid&&color(t||transparent);return o&&o.valid?o.mix(i,r).hexString():t},number(e,t,r){return e+(t-e)*r}},Animation=class{constructor(e,t,r,i){const o=t[r];i=resolve([e.to,i,o,e.from]);const a=resolve([e.from,o,i]);this._active=!0,this._fn=e.fn||interpolators[e.type||typeof a],this._easing=effects[e.easing]||effects.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=r,this._from=a,this._to=i,this._promises=void 0}active(){return this._active}update(e,t,r){if(this._active){this._notify(!1);const i=this._target[this._prop],o=r-this._start,a=this._duration-o;this._start=r,this._duration=Math.floor(Math.max(a,e.duration)),this._total+=o,this._loop=!!e.loop,this._to=resolve([e.to,t,i,e.from]),this._from=resolve([e.from,i,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,r=this._duration,i=this._prop,o=this._from,a=this._loop,c=this._to;let u;if(this._active=o!==c&&(a||t<r),!this._active){this._target[i]=c,this._notify(!0);return}if(t<0){this._target[i]=o;return}u=t/r%2,u=a&&u>1?2-u:u,u=this._easing(Math.min(1,Math.max(0,u))),this._target[i]=this._fn(o,c,u)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,r)=>{e.push({res:t,rej:r})})}_notify(e){const t=e?"res":"rej",r=this._promises||[];for(let i=0;i<r.length;i++)r[i][t]()}},Animations=class{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!isObject(e))return;const t=Object.keys(defaults.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(i=>{const o=e[i];if(!isObject(o))return;const a={};for(const c of t)a[c]=o[c];(isArray(o.properties)&&o.properties||[i]).forEach(c=>{(c===i||!r.has(c))&&r.set(c,a)})})}_animateOptions(e,t){const r=t.options,i=resolveTargetOptions(e,r);if(!i)return[];const o=this._createAnimations(i,r);return r.$shared&&awaitAll(e.options.$animations,r).then(()=>{e.options=r},()=>{}),o}_createAnimations(e,t){const r=this._properties,i=[],o=e.$animations||(e.$animations={}),a=Object.keys(t),c=Date.now();let u;for(u=a.length-1;u>=0;--u){const h=a[u];if(h.charAt(0)==="$")continue;if(h==="options"){i.push(...this._animateOptions(e,t));continue}const d=t[h];let f=o[h];const m=r.get(h);if(f)if(m&&f.active()){f.update(m,d,c);continue}else f.cancel();if(!m||!m.duration){e[h]=d;continue}o[h]=f=new Animation(m,e,h,d),i.push(f)}return i}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const r=this._createAnimations(e,t);if(r.length)return animator.add(this._chart,r),!0}};function awaitAll(e,t){const r=[],i=Object.keys(t);for(let o=0;o<i.length;o++){const a=e[i[o]];a&&a.active()&&r.push(a.wait())}return Promise.all(r)}function resolveTargetOptions(e,t){if(!t)return;let r=e.options;if(!r){e.options=t;return}return r.$shared&&(e.options=r=Object.assign({},r,{$shared:!1,$animations:{}})),r}function scaleClip(e,t){const r=e&&e.options||{},i=r.reverse,o=r.min===void 0?t:0,a=r.max===void 0?t:0;return{start:i?a:o,end:i?o:a}}function defaultClip(e,t,r){if(r===!1)return!1;const i=scaleClip(e,r),o=scaleClip(t,r);return{top:o.end,right:i.end,bottom:o.start,left:i.start}}function toClip(e){let t,r,i,o;return isObject(e)?(t=e.top,r=e.right,i=e.bottom,o=e.left):t=r=i=o=e,{top:t,right:r,bottom:i,left:o,disabled:e===!1}}function getSortedDatasetIndices(e,t){const r=[],i=e._getSortedDatasetMetas(t);let o,a;for(o=0,a=i.length;o<a;++o)r.push(i[o].index);return r}function applyStack(e,t,r,i={}){const o=e.keys,a=i.mode==="single";let c,u,h,d;if(t===null)return;let f=!1;for(c=0,u=o.length;c<u;++c){if(h=+o[c],h===r){if(f=!0,i.all)continue;break}d=e.values[h],isNumberFinite(d)&&(a||t===0||sign(t)===sign(d))&&(t+=d)}return!f&&!i.all?0:t}function convertObjectDataToArray(e,t){const{iScale:r,vScale:i}=t,o=r.axis==="x"?"x":"y",a=i.axis==="x"?"x":"y",c=Object.keys(e),u=new Array(c.length);let h,d,f;for(h=0,d=c.length;h<d;++h)f=c[h],u[h]={[o]:f,[a]:e[f]};return u}function isStacked(e,t){const r=e&&e.options.stacked;return r||r===void 0&&t.stack!==void 0}function getStackKey(e,t,r){return`${e.id}.${t.id}.${r.stack||r.type}`}function getUserBounds(e){const{min:t,max:r,minDefined:i,maxDefined:o}=e.getUserBounds();return{min:i?t:Number.NEGATIVE_INFINITY,max:o?r:Number.POSITIVE_INFINITY}}function getOrCreateStack(e,t,r){const i=e[t]||(e[t]={});return i[r]||(i[r]={})}function getLastIndexInStack(e,t,r,i){for(const o of t.getMatchingVisibleMetas(i).reverse()){const a=e[o.index];if(r&&a>0||!r&&a<0)return o.index}return null}function updateStacks(e,t){const{chart:r,_cachedMeta:i}=e,o=r._stacks||(r._stacks={}),{iScale:a,vScale:c,index:u}=i,h=a.axis,d=c.axis,f=getStackKey(a,c,i),m=t.length;let g;for(let v=0;v<m;++v){const _=t[v],{[h]:b,[d]:S}=_,R=_._stacks||(_._stacks={});g=R[d]=getOrCreateStack(o,f,b),g[u]=S,g._top=getLastIndexInStack(g,c,!0,i.type),g._bottom=getLastIndexInStack(g,c,!1,i.type);const A=g._visualValues||(g._visualValues={});A[u]=S}}function getFirstScaleId(e,t){const r=e.scales;return Object.keys(r).filter(i=>r[i].axis===t).shift()}function createDatasetContext(e,t){return createContext(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function createDataContext(e,t,r){return createContext(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:r,index:t,mode:"default",type:"data"})}function clearStacks(e,t){const r=e.controller.index,i=e.vScale&&e.vScale.axis;if(i){t=t||e._parsed;for(const o of t){const a=o._stacks;if(!a||a[i]===void 0||a[i][r]===void 0)return;delete a[i][r],a[i]._visualValues!==void 0&&a[i]._visualValues[r]!==void 0&&delete a[i]._visualValues[r]}}}var isDirectUpdateMode=e=>e==="reset"||e==="none",cloneIfNotShared=(e,t)=>t?e:Object.assign({},e),createStack=(e,t,r)=>e&&!t.hidden&&t._stacked&&{keys:getSortedDatasetIndices(r,!0),values:null},DatasetController=class{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=isStacked(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&clearStacks(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,r=this.getDataset(),i=(f,m,g,v)=>f==="x"?m:f==="r"?v:g,o=t.xAxisID=valueOrDefault(r.xAxisID,getFirstScaleId(e,"x")),a=t.yAxisID=valueOrDefault(r.yAxisID,getFirstScaleId(e,"y")),c=t.rAxisID=valueOrDefault(r.rAxisID,getFirstScaleId(e,"r")),u=t.indexAxis,h=t.iAxisID=i(u,o,a,c),d=t.vAxisID=i(u,a,o,c);t.xScale=this.getScaleForId(o),t.yScale=this.getScaleForId(a),t.rScale=this.getScaleForId(c),t.iScale=this.getScaleForId(h),t.vScale=this.getScaleForId(d)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&unlistenArrayEvents(this._data,this),e._stacked&&clearStacks(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),r=this._data;if(isObject(t)){const i=this._cachedMeta;this._data=convertObjectDataToArray(t,i)}else if(r!==t){if(r){unlistenArrayEvents(r,this);const i=this._cachedMeta;clearStacks(i),i._parsed=[]}t&&Object.isExtensible(t)&&listenArrayEvents(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,r=this.getDataset();let i=!1;this._dataCheck();const o=t._stacked;t._stacked=isStacked(t.vScale,t),t.stack!==r.stack&&(i=!0,clearStacks(t),t.stack=r.stack),this._resyncElements(e),(i||o!==t._stacked)&&(updateStacks(this,t._parsed),t._stacked=isStacked(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:r,_data:i}=this,{iScale:o,_stacked:a}=r,c=o.axis;let u=e===0&&t===i.length?!0:r._sorted,h=e>0&&r._parsed[e-1],d,f,m;if(this._parsing===!1)r._parsed=i,r._sorted=!0,m=i;else{isArray(i[e])?m=this.parseArrayData(r,i,e,t):isObject(i[e])?m=this.parseObjectData(r,i,e,t):m=this.parsePrimitiveData(r,i,e,t);const g=()=>f[c]===null||h&&f[c]<h[c];for(d=0;d<t;++d)r._parsed[d+e]=f=m[d],u&&(g()&&(u=!1),h=f);r._sorted=u}a&&updateStacks(this,m)}parsePrimitiveData(e,t,r,i){const{iScale:o,vScale:a}=e,c=o.axis,u=a.axis,h=o.getLabels(),d=o===a,f=new Array(i);let m,g,v;for(m=0,g=i;m<g;++m)v=m+r,f[m]={[c]:d||o.parse(h[v],v),[u]:a.parse(t[v],v)};return f}parseArrayData(e,t,r,i){const{xScale:o,yScale:a}=e,c=new Array(i);let u,h,d,f;for(u=0,h=i;u<h;++u)d=u+r,f=t[d],c[u]={x:o.parse(f[0],d),y:a.parse(f[1],d)};return c}parseObjectData(e,t,r,i){const{xScale:o,yScale:a}=e,{xAxisKey:c="x",yAxisKey:u="y"}=this._parsing,h=new Array(i);let d,f,m,g;for(d=0,f=i;d<f;++d)m=d+r,g=t[m],h[d]={x:o.parse(resolveObjectKey(g,c),m),y:a.parse(resolveObjectKey(g,u),m)};return h}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,r){const i=this.chart,o=this._cachedMeta,a=t[e.axis],c={keys:getSortedDatasetIndices(i,!0),values:t._stacks[e.axis]._visualValues};return applyStack(c,a,o.index,{mode:r})}updateRangeFromParsed(e,t,r,i){const o=r[t.axis];let a=o===null?NaN:o;const c=i&&r._stacks[t.axis];i&&c&&(i.values=c,a=applyStack(i,o,this._cachedMeta.index)),e.min=Math.min(e.min,a),e.max=Math.max(e.max,a)}getMinMax(e,t){const r=this._cachedMeta,i=r._parsed,o=r._sorted&&e===r.iScale,a=i.length,c=this._getOtherScale(e),u=createStack(t,r,this.chart),h={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:d,max:f}=getUserBounds(c);let m,g;function v(){g=i[m];const _=g[c.axis];return!isNumberFinite(g[e.axis])||d>_||f<_}for(m=0;m<a&&!(!v()&&(this.updateRangeFromParsed(h,e,g,u),o));++m);if(o){for(m=a-1;m>=0;--m)if(!v()){this.updateRangeFromParsed(h,e,g,u);break}}return h}getAllParsedValues(e){const t=this._cachedMeta._parsed,r=[];let i,o,a;for(i=0,o=t.length;i<o;++i)a=t[i][e.axis],isNumberFinite(a)&&r.push(a);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,r=t.iScale,i=t.vScale,o=this.getParsed(e);return{label:r?""+r.getLabelForValue(o[r.axis]):"",value:i?""+i.getLabelForValue(o[i.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=toClip(valueOrDefault(this.options.clip,defaultClip(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,r=this._cachedMeta,i=r.data||[],o=t.chartArea,a=[],c=this._drawStart||0,u=this._drawCount||i.length-c,h=this.options.drawActiveElementsOnTop;let d;for(r.dataset&&r.dataset.draw(e,o,c,u),d=c;d<c+u;++d){const f=i[d];f.hidden||(f.active&&h?a.push(f):f.draw(e,o))}for(d=0;d<a.length;++d)a[d].draw(e,o)}getStyle(e,t){const r=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,t,r){const i=this.getDataset();let o;if(e>=0&&e<this._cachedMeta.data.length){const a=this._cachedMeta.data[e];o=a.$context||(a.$context=createDataContext(this.getContext(),e,a)),o.parsed=this.getParsed(e),o.raw=i.data[e],o.index=o.dataIndex=e}else o=this.$context||(this.$context=createDatasetContext(this.chart.getContext(),this.index)),o.dataset=i,o.index=o.datasetIndex=this.index;return o.active=!!t,o.mode=r,o}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",r){const i=t==="active",o=this._cachedDataOpts,a=e+"-"+t,c=o[a],u=this.enableOptionSharing&&defined(r);if(c)return cloneIfNotShared(c,u);const h=this.chart.config,d=h.datasetElementScopeKeys(this._type,e),f=i?[`${e}Hover`,"hover",e,""]:[e,""],m=h.getOptionScopes(this.getDataset(),d),g=Object.keys(defaults.elements[e]),v=()=>this.getContext(r,i,t),_=h.resolveNamedOptions(m,g,v,f);return _.$shared&&(_.$shared=u,o[a]=Object.freeze(cloneIfNotShared(_,u))),_}_resolveAnimations(e,t,r){const i=this.chart,o=this._cachedDataOpts,a=`animation-${t}`,c=o[a];if(c)return c;let u;if(i.options.animation!==!1){const d=this.chart.config,f=d.datasetAnimationScopeKeys(this._type,t),m=d.getOptionScopes(this.getDataset(),f);u=d.createResolver(m,this.getContext(e,r,t))}const h=new Animations(i,u&&u.animations);return u&&u._cacheable&&(o[a]=Object.freeze(h)),h}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||isDirectUpdateMode(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const r=this.resolveDataElementOptions(e,t),i=this._sharedOptions,o=this.getSharedOptions(r),a=this.includeOptions(t,o)||o!==i;return this.updateSharedOptions(o,t,r),{sharedOptions:o,includeOptions:a}}updateElement(e,t,r,i){isDirectUpdateMode(i)?Object.assign(e,r):this._resolveAnimations(t,i).update(e,r)}updateSharedOptions(e,t,r){e&&!isDirectUpdateMode(t)&&this._resolveAnimations(void 0,t).update(e,r)}_setStyle(e,t,r,i){e.active=i;const o=this.getStyle(t,i);this._resolveAnimations(t,r,i).update(e,{options:!i&&this.getSharedOptions(o)||o})}removeHoverStyle(e,t,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,t,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,r=this._cachedMeta.data;for(const[c,u,h]of this._syncList)this[c](u,h);this._syncList=[];const i=r.length,o=t.length,a=Math.min(o,i);a&&this.parse(0,a),o>i?this._insertElements(i,o-i,e):o<i&&this._removeElements(o,i-o)}_insertElements(e,t,r=!0){const i=this._cachedMeta,o=i.data,a=e+t;let c;const u=h=>{for(h.length+=t,c=h.length-1;c>=a;c--)h[c]=h[c-t]};for(u(o),c=e;c<a;++c)o[c]=new this.dataElementType;this._parsing&&u(i._parsed),this.parse(e,t),r&&this.updateElements(o,e,t,"reset")}updateElements(e,t,r,i){}_removeElements(e,t){const r=this._cachedMeta;if(this._parsing){const i=r._parsed.splice(e,t);r._stacked&&clearStacks(r,i)}r.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,r,i]=e;this[t](r,i)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}};function abstract(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}var DateAdapterBase=class Xi{static override(t){Object.assign(Xi.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return abstract()}parse(){return abstract()}format(){return abstract()}add(){return abstract()}diff(){return abstract()}startOf(){return abstract()}endOf(){return abstract()}},adapters={_date:DateAdapterBase};function binarySearch(e,t,r,i){const{controller:o,data:a,_sorted:c}=e,u=o._cachedMeta.iScale;if(u&&t===u.axis&&t!=="r"&&c&&a.length){const h=u._reversePixels?_rlookupByKey:_lookupByKey;if(i){if(o._sharedOptions){const d=a[0],f=typeof d.getRange=="function"&&d.getRange(t);if(f){const m=h(a,t,r-f),g=h(a,t,r+f);return{lo:m.lo,hi:g.hi}}}}else return h(a,t,r)}return{lo:0,hi:a.length-1}}function evaluateInteractionItems(e,t,r,i,o){const a=e.getSortedVisibleDatasetMetas(),c=r[t];for(let u=0,h=a.length;u<h;++u){const{index:d,data:f}=a[u],{lo:m,hi:g}=binarySearch(a[u],t,c,o);for(let v=m;v<=g;++v){const _=f[v];_.skip||i(_,d,v)}}}function getDistanceMetricForAxis(e){const t=e.indexOf("x")!==-1,r=e.indexOf("y")!==-1;return function(i,o){const a=t?Math.abs(i.x-o.x):0,c=r?Math.abs(i.y-o.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(c,2))}}function getIntersectItems(e,t,r,i,o){const a=[];return!o&&!e.isPointInArea(t)||evaluateInteractionItems(e,r,t,function(u,h,d){!o&&!_isPointInArea(u,e.chartArea,0)||u.inRange(t.x,t.y,i)&&a.push({element:u,datasetIndex:h,index:d})},!0),a}function getNearestRadialItems(e,t,r,i){let o=[];function a(c,u,h){const{startAngle:d,endAngle:f}=c.getProps(["startAngle","endAngle"],i),{angle:m}=getAngleFromPoint(c,{x:t.x,y:t.y});_angleBetween(m,d,f)&&o.push({element:c,datasetIndex:u,index:h})}return evaluateInteractionItems(e,r,t,a),o}function getNearestCartesianItems(e,t,r,i,o,a){let c=[];const u=getDistanceMetricForAxis(r);let h=Number.POSITIVE_INFINITY;function d(f,m,g){const v=f.inRange(t.x,t.y,o);if(i&&!v)return;const _=f.getCenterPoint(o);if(!(!!a||e.isPointInArea(_))&&!v)return;const S=u(t,_);S<h?(c=[{element:f,datasetIndex:m,index:g}],h=S):S===h&&c.push({element:f,datasetIndex:m,index:g})}return evaluateInteractionItems(e,r,t,d),c}function getNearestItems(e,t,r,i,o,a){return!a&&!e.isPointInArea(t)?[]:r==="r"&&!i?getNearestRadialItems(e,t,r,o):getNearestCartesianItems(e,t,r,i,o,a)}function getAxisItems(e,t,r,i,o){const a=[],c=r==="x"?"inXRange":"inYRange";let u=!1;return evaluateInteractionItems(e,r,t,(h,d,f)=>{h[c]&&h[c](t[r],o)&&(a.push({element:h,datasetIndex:d,index:f}),u=u||h.inRange(t.x,t.y,o))}),i&&!u?[]:a}var Interaction={evaluateInteractionItems,modes:{index(e,t,r,i){const o=getRelativePosition(t,e),a=r.axis||"x",c=r.includeInvisible||!1,u=r.intersect?getIntersectItems(e,o,a,i,c):getNearestItems(e,o,a,!1,i,c),h=[];return u.length?(e.getSortedVisibleDatasetMetas().forEach(d=>{const f=u[0].index,m=d.data[f];m&&!m.skip&&h.push({element:m,datasetIndex:d.index,index:f})}),h):[]},dataset(e,t,r,i){const o=getRelativePosition(t,e),a=r.axis||"xy",c=r.includeInvisible||!1;let u=r.intersect?getIntersectItems(e,o,a,i,c):getNearestItems(e,o,a,!1,i,c);if(u.length>0){const h=u[0].datasetIndex,d=e.getDatasetMeta(h).data;u=[];for(let f=0;f<d.length;++f)u.push({element:d[f],datasetIndex:h,index:f})}return u},point(e,t,r,i){const o=getRelativePosition(t,e),a=r.axis||"xy",c=r.includeInvisible||!1;return getIntersectItems(e,o,a,i,c)},nearest(e,t,r,i){const o=getRelativePosition(t,e),a=r.axis||"xy",c=r.includeInvisible||!1;return getNearestItems(e,o,a,r.intersect,i,c)},x(e,t,r,i){const o=getRelativePosition(t,e);return getAxisItems(e,o,"x",r.intersect,i)},y(e,t,r,i){const o=getRelativePosition(t,e);return getAxisItems(e,o,"y",r.intersect,i)}}},STATIC_POSITIONS=["left","top","right","bottom"];function filterByPosition(e,t){return e.filter(r=>r.pos===t)}function filterDynamicPositionByAxis(e,t){return e.filter(r=>STATIC_POSITIONS.indexOf(r.pos)===-1&&r.box.axis===t)}function sortByWeight(e,t){return e.sort((r,i)=>{const o=t?i:r,a=t?r:i;return o.weight===a.weight?o.index-a.index:o.weight-a.weight})}function wrapBoxes(e){const t=[];let r,i,o,a,c,u;for(r=0,i=(e||[]).length;r<i;++r)o=e[r],{position:a,options:{stack:c,stackWeight:u=1}}=o,t.push({index:r,box:o,pos:a,horizontal:o.isHorizontal(),weight:o.weight,stack:c&&a+c,stackWeight:u});return t}function buildStacks(e){const t={};for(const r of e){const{stack:i,pos:o,stackWeight:a}=r;if(!i||!STATIC_POSITIONS.includes(o))continue;const c=t[i]||(t[i]={count:0,placed:0,weight:0,size:0});c.count++,c.weight+=a}return t}function setLayoutDims(e,t){const r=buildStacks(e),{vBoxMaxWidth:i,hBoxMaxHeight:o}=t;let a,c,u;for(a=0,c=e.length;a<c;++a){u=e[a];const{fullSize:h}=u.box,d=r[u.stack],f=d&&u.stackWeight/d.weight;u.horizontal?(u.width=f?f*i:h&&t.availableWidth,u.height=o):(u.width=i,u.height=f?f*o:h&&t.availableHeight)}return r}function buildLayoutBoxes(e){const t=wrapBoxes(e),r=sortByWeight(t.filter(d=>d.box.fullSize),!0),i=sortByWeight(filterByPosition(t,"left"),!0),o=sortByWeight(filterByPosition(t,"right")),a=sortByWeight(filterByPosition(t,"top"),!0),c=sortByWeight(filterByPosition(t,"bottom")),u=filterDynamicPositionByAxis(t,"x"),h=filterDynamicPositionByAxis(t,"y");return{fullSize:r,leftAndTop:i.concat(a),rightAndBottom:o.concat(h).concat(c).concat(u),chartArea:filterByPosition(t,"chartArea"),vertical:i.concat(o).concat(h),horizontal:a.concat(c).concat(u)}}function getCombinedMax(e,t,r,i){return Math.max(e[r],t[r])+Math.max(e[i],t[i])}function updateMaxPadding(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function updateDims(e,t,r,i){const{pos:o,box:a}=r,c=e.maxPadding;if(!isObject(o)){r.size&&(e[o]-=r.size);const m=i[r.stack]||{size:0,count:1};m.size=Math.max(m.size,r.horizontal?a.height:a.width),r.size=m.size/m.count,e[o]+=r.size}a.getPadding&&updateMaxPadding(c,a.getPadding());const u=Math.max(0,t.outerWidth-getCombinedMax(c,e,"left","right")),h=Math.max(0,t.outerHeight-getCombinedMax(c,e,"top","bottom")),d=u!==e.w,f=h!==e.h;return e.w=u,e.h=h,r.horizontal?{same:d,other:f}:{same:f,other:d}}function handleMaxPadding(e){const t=e.maxPadding;function r(i){const o=Math.max(t[i]-e[i],0);return e[i]+=o,o}e.y+=r("top"),e.x+=r("left"),r("right"),r("bottom")}function getMargins(e,t){const r=t.maxPadding;function i(o){const a={left:0,top:0,right:0,bottom:0};return o.forEach(c=>{a[c]=Math.max(t[c],r[c])}),a}return i(e?["left","right"]:["top","bottom"])}function fitBoxes(e,t,r,i){const o=[];let a,c,u,h,d,f;for(a=0,c=e.length,d=0;a<c;++a){u=e[a],h=u.box,h.update(u.width||t.w,u.height||t.h,getMargins(u.horizontal,t));const{same:m,other:g}=updateDims(t,r,u,i);d|=m&&o.length,f=f||g,h.fullSize||o.push(u)}return d&&fitBoxes(o,t,r,i)||f}function setBoxDims(e,t,r,i,o){e.top=r,e.left=t,e.right=t+i,e.bottom=r+o,e.width=i,e.height=o}function placeBoxes(e,t,r,i){const o=r.padding;let{x:a,y:c}=t;for(const u of e){const h=u.box,d=i[u.stack]||{count:1,placed:0,weight:1},f=u.stackWeight/d.weight||1;if(u.horizontal){const m=t.w*f,g=d.size||h.height;defined(d.start)&&(c=d.start),h.fullSize?setBoxDims(h,o.left,c,r.outerWidth-o.right-o.left,g):setBoxDims(h,t.left+d.placed,c,m,g),d.start=c,d.placed+=m,c=h.bottom}else{const m=t.h*f,g=d.size||h.width;defined(d.start)&&(a=d.start),h.fullSize?setBoxDims(h,a,o.top,g,r.outerHeight-o.bottom-o.top):setBoxDims(h,a,t.top+d.placed,g,m),d.start=a,d.placed+=m,a=h.right}}t.x=a,t.y=c}var layouts={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(r){t.draw(r)}}]},e.boxes.push(t)},removeBox(e,t){const r=e.boxes?e.boxes.indexOf(t):-1;r!==-1&&e.boxes.splice(r,1)},configure(e,t,r){t.fullSize=r.fullSize,t.position=r.position,t.weight=r.weight},update(e,t,r,i){if(!e)return;const o=toPadding(e.options.layout.padding),a=Math.max(t-o.width,0),c=Math.max(r-o.height,0),u=buildLayoutBoxes(e.boxes),h=u.vertical,d=u.horizontal;each(e.boxes,b=>{typeof b.beforeLayout=="function"&&b.beforeLayout()});const f=h.reduce((b,S)=>S.box.options&&S.box.options.display===!1?b:b+1,0)||1,m=Object.freeze({outerWidth:t,outerHeight:r,padding:o,availableWidth:a,availableHeight:c,vBoxMaxWidth:a/2/f,hBoxMaxHeight:c/2}),g=Object.assign({},o);updateMaxPadding(g,toPadding(i));const v=Object.assign({maxPadding:g,w:a,h:c,x:o.left,y:o.top},o),_=setLayoutDims(h.concat(d),m);fitBoxes(u.fullSize,v,m,_),fitBoxes(h,v,m,_),fitBoxes(d,v,m,_)&&fitBoxes(h,v,m,_),handleMaxPadding(v),placeBoxes(u.leftAndTop,v,m,_),v.x+=v.w,v.y+=v.h,placeBoxes(u.rightAndBottom,v,m,_),e.chartArea={left:v.left,top:v.top,right:v.left+v.w,bottom:v.top+v.h,height:v.h,width:v.w},each(u.chartArea,b=>{const S=b.box;Object.assign(S,e.chartArea),S.update(v.w,v.h,{left:0,top:0,right:0,bottom:0})})}},BasePlatform=class{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,r){}removeEventListener(e,t,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,r,i){return t=Math.max(0,t||e.width),r=r||e.height,{width:t,height:Math.max(0,i?Math.floor(t/i):r)}}isAttached(e){return!0}updateConfig(e){}},BasicPlatform=class extends BasePlatform{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}},EXPANDO_KEY="$chartjs",EVENT_TYPES={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},isNullOrEmpty=e=>e===null||e==="";function initCanvas(e,t){const r=e.style,i=e.getAttribute("height"),o=e.getAttribute("width");if(e[EXPANDO_KEY]={initial:{height:i,width:o,style:{display:r.display,height:r.height,width:r.width}}},r.display=r.display||"block",r.boxSizing=r.boxSizing||"border-box",isNullOrEmpty(o)){const a=readUsedSize(e,"width");a!==void 0&&(e.width=a)}if(isNullOrEmpty(i))if(e.style.height==="")e.height=e.width/(t||2);else{const a=readUsedSize(e,"height");a!==void 0&&(e.height=a)}return e}var eventListenerOptions=supportsEventListenerOptions?{passive:!0}:!1;function addListener(e,t,r){e&&e.addEventListener(t,r,eventListenerOptions)}function removeListener(e,t,r){e&&e.canvas&&e.canvas.removeEventListener(t,r,eventListenerOptions)}function fromNativeEvent(e,t){const r=EVENT_TYPES[e.type]||e.type,{x:i,y:o}=getRelativePosition(e,t);return{type:r,chart:t,native:e,x:i!==void 0?i:null,y:o!==void 0?o:null}}function nodeListContains(e,t){for(const r of e)if(r===t||r.contains(t))return!0}function createAttachObserver(e,t,r){const i=e.canvas,o=new MutationObserver(a=>{let c=!1;for(const u of a)c=c||nodeListContains(u.addedNodes,i),c=c&&!nodeListContains(u.removedNodes,i);c&&r()});return o.observe(document,{childList:!0,subtree:!0}),o}function createDetachObserver(e,t,r){const i=e.canvas,o=new MutationObserver(a=>{let c=!1;for(const u of a)c=c||nodeListContains(u.removedNodes,i),c=c&&!nodeListContains(u.addedNodes,i);c&&r()});return o.observe(document,{childList:!0,subtree:!0}),o}var drpListeningCharts=new Map,oldDevicePixelRatio=0;function onWindowResize(){const e=window.devicePixelRatio;e!==oldDevicePixelRatio&&(oldDevicePixelRatio=e,drpListeningCharts.forEach((t,r)=>{r.currentDevicePixelRatio!==e&&t()}))}function listenDevicePixelRatioChanges(e,t){drpListeningCharts.size||window.addEventListener("resize",onWindowResize),drpListeningCharts.set(e,t)}function unlistenDevicePixelRatioChanges(e){drpListeningCharts.delete(e),drpListeningCharts.size||window.removeEventListener("resize",onWindowResize)}function createResizeObserver(e,t,r){const i=e.canvas,o=i&&_getParentNode(i);if(!o)return;const a=throttled((u,h)=>{const d=o.clientWidth;r(u,h),d<o.clientWidth&&r()},window),c=new ResizeObserver(u=>{const h=u[0],d=h.contentRect.width,f=h.contentRect.height;d===0&&f===0||a(d,f)});return c.observe(o),listenDevicePixelRatioChanges(e,a),c}function releaseObserver(e,t,r){r&&r.disconnect(),t==="resize"&&unlistenDevicePixelRatioChanges(e)}function createProxyAndListen(e,t,r){const i=e.canvas,o=throttled(a=>{e.ctx!==null&&r(fromNativeEvent(a,e))},e);return addListener(i,t,o),o}var DomPlatform=class extends BasePlatform{acquireContext(e,t){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(initCanvas(e,t),r):null}releaseContext(e){const t=e.canvas;if(!t[EXPANDO_KEY])return!1;const r=t[EXPANDO_KEY].initial;["height","width"].forEach(o=>{const a=r[o];isNullOrUndef(a)?t.removeAttribute(o):t.setAttribute(o,a)});const i=r.style||{};return Object.keys(i).forEach(o=>{t.style[o]=i[o]}),t.width=t.width,delete t[EXPANDO_KEY],!0}addEventListener(e,t,r){this.removeEventListener(e,t);const i=e.$proxies||(e.$proxies={}),a={attach:createAttachObserver,detach:createDetachObserver,resize:createResizeObserver}[t]||createProxyAndListen;i[t]=a(e,t,r)}removeEventListener(e,t){const r=e.$proxies||(e.$proxies={}),i=r[t];if(!i)return;({attach:releaseObserver,detach:releaseObserver,resize:releaseObserver}[t]||removeListener)(e,t,i),r[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,r,i){return getMaximumSize(e,t,r,i)}isAttached(e){const t=e&&_getParentNode(e);return!!(t&&t.isConnected)}};function _detectPlatform(e){return!_isDomSupported()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?BasicPlatform:DomPlatform}var Element2=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}hasValue(){return isNumber(this.x)&&isNumber(this.y)}getProps(e,t){const r=this.$animations;if(!t||!r)return this;const i={};return e.forEach(o=>{i[o]=r[o]&&r[o].active()?r[o]._to:this[o]}),i}};function autoSkip(e,t){const r=e.options.ticks,i=determineMaxTicks(e),o=Math.min(r.maxTicksLimit||i,i),a=r.major.enabled?getMajorIndices(t):[],c=a.length,u=a[0],h=a[c-1],d=[];if(c>o)return skipMajors(t,d,a,c/o),d;const f=calculateSpacing(a,t,o);if(c>0){let m,g;const v=c>1?Math.round((h-u)/(c-1)):null;for(skip(t,d,f,isNullOrUndef(v)?0:u-v,u),m=0,g=c-1;m<g;m++)skip(t,d,f,a[m],a[m+1]);return skip(t,d,f,h,isNullOrUndef(v)?t.length:h+v),d}return skip(t,d,f),d}function determineMaxTicks(e){const t=e.options.offset,r=e._tickSize(),i=e._length/r+(t?0:1),o=e._maxLength/r;return Math.floor(Math.min(i,o))}function calculateSpacing(e,t,r){const i=getEvenSpacing(e),o=t.length/r;if(!i)return Math.max(o,1);const a=_factorize(i);for(let c=0,u=a.length-1;c<u;c++){const h=a[c];if(h>o)return h}return Math.max(o,1)}function getMajorIndices(e){const t=[];let r,i;for(r=0,i=e.length;r<i;r++)e[r].major&&t.push(r);return t}function skipMajors(e,t,r,i){let o=0,a=r[0],c;for(i=Math.ceil(i),c=0;c<e.length;c++)c===a&&(t.push(e[c]),o++,a=r[o*i])}function skip(e,t,r,i,o){const a=valueOrDefault(i,0),c=Math.min(valueOrDefault(o,e.length),e.length);let u=0,h,d,f;for(r=Math.ceil(r),o&&(h=o-i,r=h/Math.floor(h/r)),f=a;f<0;)u++,f=Math.round(a+u*r);for(d=Math.max(a,0);d<c;d++)d===f&&(t.push(e[d]),u++,f=Math.round(a+u*r))}function getEvenSpacing(e){const t=e.length;let r,i;if(t<2)return!1;for(i=e[0],r=1;r<t;++r)if(e[r]-e[r-1]!==i)return!1;return i}var reverseAlign=e=>e==="left"?"right":e==="right"?"left":e,offsetFromEdge=(e,t,r)=>t==="top"||t==="left"?e[t]+r:e[t]-r,getTicksLimit=(e,t)=>Math.min(t||e,e);function sample(e,t){const r=[],i=e.length/t,o=e.length;let a=0;for(;a<o;a+=i)r.push(e[Math.floor(a)]);return r}function getPixelForGridLine(e,t,r){const i=e.ticks.length,o=Math.min(t,i-1),a=e._startPixel,c=e._endPixel,u=1e-6;let h=e.getPixelForTick(o),d;if(!(r&&(i===1?d=Math.max(h-a,c-h):t===0?d=(e.getPixelForTick(1)-h)/2:d=(h-e.getPixelForTick(o-1))/2,h+=o<t?d:-d,h<a-u||h>c+u)))return h}function garbageCollect(e,t){each(e,r=>{const i=r.gc,o=i.length/2;let a;if(o>t){for(a=0;a<o;++a)delete r.data[i[a]];i.splice(0,o)}})}function getTickMarkLength(e){return e.drawTicks?e.tickLength:0}function getTitleHeight(e,t){if(!e.display)return 0;const r=toFont(e.font,t),i=toPadding(e.padding);return(isArray(e.text)?e.text.length:1)*r.lineHeight+i.height}function createScaleContext(e,t){return createContext(e,{scale:t,type:"scale"})}function createTickContext(e,t,r){return createContext(e,{tick:r,index:t,type:"tick"})}function titleAlign(e,t,r){let i=_toLeftRightCenter(e);return(r&&t!=="right"||!r&&t==="right")&&(i=reverseAlign(i)),i}function titleArgs(e,t,r,i){const{top:o,left:a,bottom:c,right:u,chart:h}=e,{chartArea:d,scales:f}=h;let m=0,g,v,_;const b=c-o,S=u-a;if(e.isHorizontal()){if(v=_alignStartEnd(i,a,u),isObject(r)){const R=Object.keys(r)[0],A=r[R];_=f[R].getPixelForValue(A)+b-t}else r==="center"?_=(d.bottom+d.top)/2+b-t:_=offsetFromEdge(e,r,t);g=u-a}else{if(isObject(r)){const R=Object.keys(r)[0],A=r[R];v=f[R].getPixelForValue(A)-S+t}else r==="center"?v=(d.left+d.right)/2-S+t:v=offsetFromEdge(e,r,t);_=_alignStartEnd(i,c,o),m=r==="left"?-HALF_PI:HALF_PI}return{titleX:v,titleY:_,maxWidth:g,rotation:m}}var Scale=class Ji extends Element2{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,r){return t}getUserBounds(){let{_userMin:t,_userMax:r,_suggestedMin:i,_suggestedMax:o}=this;return t=finiteOrDefault(t,Number.POSITIVE_INFINITY),r=finiteOrDefault(r,Number.NEGATIVE_INFINITY),i=finiteOrDefault(i,Number.POSITIVE_INFINITY),o=finiteOrDefault(o,Number.NEGATIVE_INFINITY),{min:finiteOrDefault(t,i),max:finiteOrDefault(r,o),minDefined:isNumberFinite(t),maxDefined:isNumberFinite(r)}}getMinMax(t){let{min:r,max:i,minDefined:o,maxDefined:a}=this.getUserBounds(),c;if(o&&a)return{min:r,max:i};const u=this.getMatchingVisibleMetas();for(let h=0,d=u.length;h<d;++h)c=u[h].controller.getMinMax(this,t),o||(r=Math.min(r,c.min)),a||(i=Math.max(i,c.max));return r=a&&r>i?i:r,i=o&&r>i?r:i,{min:finiteOrDefault(r,finiteOrDefault(i,r)),max:finiteOrDefault(i,finiteOrDefault(r,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){callback(this.options.beforeUpdate,[this])}update(t,r,i){const{beginAtZero:o,grace:a,ticks:c}=this.options,u=c.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=r,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=_addGrace(this,a,o),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const h=u<this.ticks.length;this._convertTicksToLabels(h?sample(this.ticks,u):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),c.display&&(c.autoSkip||c.source==="auto")&&(this.ticks=autoSkip(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),h&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,r,i;this.isHorizontal()?(r=this.left,i=this.right):(r=this.top,i=this.bottom,t=!t),this._startPixel=r,this._endPixel=i,this._reversePixels=t,this._length=i-r,this._alignToPixels=this.options.alignToPixels}afterUpdate(){callback(this.options.afterUpdate,[this])}beforeSetDimensions(){callback(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){callback(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),callback(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){callback(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const r=this.options.ticks;let i,o,a;for(i=0,o=t.length;i<o;i++)a=t[i],a.label=callback(r.callback,[a.value,i,t],this)}afterTickToLabelConversion(){callback(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){callback(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,r=t.ticks,i=getTicksLimit(this.ticks.length,t.ticks.maxTicksLimit),o=r.minRotation||0,a=r.maxRotation;let c=o,u,h,d;if(!this._isVisible()||!r.display||o>=a||i<=1||!this.isHorizontal()){this.labelRotation=o;return}const f=this._getLabelSizes(),m=f.widest.width,g=f.highest.height,v=_limitValue(this.chart.width-m,0,this.maxWidth);u=t.offset?this.maxWidth/i:v/(i-1),m+6>u&&(u=v/(i-(t.offset?.5:1)),h=this.maxHeight-getTickMarkLength(t.grid)-r.padding-getTitleHeight(t.title,this.chart.options.font),d=Math.sqrt(m*m+g*g),c=toDegrees(Math.min(Math.asin(_limitValue((f.highest.height+6)/u,-1,1)),Math.asin(_limitValue(h/d,-1,1))-Math.asin(_limitValue(g/d,-1,1)))),c=Math.max(o,Math.min(a,c))),this.labelRotation=c}afterCalculateLabelRotation(){callback(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){callback(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:r,options:{ticks:i,title:o,grid:a}}=this,c=this._isVisible(),u=this.isHorizontal();if(c){const h=getTitleHeight(o,r.options.font);if(u?(t.width=this.maxWidth,t.height=getTickMarkLength(a)+h):(t.height=this.maxHeight,t.width=getTickMarkLength(a)+h),i.display&&this.ticks.length){const{first:d,last:f,widest:m,highest:g}=this._getLabelSizes(),v=i.padding*2,_=toRadians(this.labelRotation),b=Math.cos(_),S=Math.sin(_);if(u){const R=i.mirror?0:S*m.width+b*g.height;t.height=Math.min(this.maxHeight,t.height+R+v)}else{const R=i.mirror?0:b*m.width+S*g.height;t.width=Math.min(this.maxWidth,t.width+R+v)}this._calculatePadding(d,f,S,b)}}this._handleMargins(),u?(this.width=this._length=r.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=r.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,r,i,o){const{ticks:{align:a,padding:c},position:u}=this.options,h=this.labelRotation!==0,d=u!=="top"&&this.axis==="x";if(this.isHorizontal()){const f=this.getPixelForTick(0)-this.left,m=this.right-this.getPixelForTick(this.ticks.length-1);let g=0,v=0;h?d?(g=o*t.width,v=i*r.height):(g=i*t.height,v=o*r.width):a==="start"?v=r.width:a==="end"?g=t.width:a!=="inner"&&(g=t.width/2,v=r.width/2),this.paddingLeft=Math.max((g-f+c)*this.width/(this.width-f),0),this.paddingRight=Math.max((v-m+c)*this.width/(this.width-m),0)}else{let f=r.height/2,m=t.height/2;a==="start"?(f=0,m=t.height):a==="end"&&(f=r.height,m=0),this.paddingTop=f+c,this.paddingBottom=m+c}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){callback(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:r}=this.options;return r==="top"||r==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let r,i;for(r=0,i=t.length;r<i;r++)isNullOrUndef(t[r].label)&&(t.splice(r,1),i--,r--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const r=this.options.ticks.sampleSize;let i=this.ticks;r<i.length&&(i=sample(i,r)),this._labelSizes=t=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,r,i){const{ctx:o,_longestTextCache:a}=this,c=[],u=[],h=Math.floor(r/getTicksLimit(r,i));let d=0,f=0,m,g,v,_,b,S,R,A,I,E,O;for(m=0;m<r;m+=h){if(_=t[m].label,b=this._resolveTickFontOptions(m),o.font=S=b.string,R=a[S]=a[S]||{data:{},gc:[]},A=b.lineHeight,I=E=0,!isNullOrUndef(_)&&!isArray(_))I=_measureText(o,R.data,R.gc,I,_),E=A;else if(isArray(_))for(g=0,v=_.length;g<v;++g)O=_[g],!isNullOrUndef(O)&&!isArray(O)&&(I=_measureText(o,R.data,R.gc,I,O),E+=A);c.push(I),u.push(E),d=Math.max(I,d),f=Math.max(E,f)}garbageCollect(a,r);const P=c.indexOf(d),L=u.indexOf(f),V=$=>({width:c[$]||0,height:u[$]||0});return{first:V(0),last:V(r-1),widest:V(P),highest:V(L),widths:c,heights:u}}getLabelForValue(t){return t}getPixelForValue(t,r){return NaN}getValueForPixel(t){}getPixelForTick(t){const r=this.ticks;return t<0||t>r.length-1?null:this.getPixelForValue(r[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const r=this._startPixel+t*this._length;return _int16Range(this._alignToPixels?_alignPixel(this.chart,r,0):r)}getDecimalForPixel(t){const r=(t-this._startPixel)/this._length;return this._reversePixels?1-r:r}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:r}=this;return t<0&&r<0?r:t>0&&r>0?t:0}getContext(t){const r=this.ticks||[];if(t>=0&&t<r.length){const i=r[t];return i.$context||(i.$context=createTickContext(this.getContext(),t,i))}return this.$context||(this.$context=createScaleContext(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,r=toRadians(this.labelRotation),i=Math.abs(Math.cos(r)),o=Math.abs(Math.sin(r)),a=this._getLabelSizes(),c=t.autoSkipPadding||0,u=a?a.widest.width+c:0,h=a?a.highest.height+c:0;return this.isHorizontal()?h*i>u*o?u/i:h/o:h*o<u*i?h/i:u/o}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const r=this.axis,i=this.chart,o=this.options,{grid:a,position:c,border:u}=o,h=a.offset,d=this.isHorizontal(),m=this.ticks.length+(h?1:0),g=getTickMarkLength(a),v=[],_=u.setContext(this.getContext()),b=_.display?_.width:0,S=b/2,R=function(pe){return _alignPixel(i,pe,b)};let A,I,E,O,P,L,V,$,W,Z,ie,ue;if(c==="top")A=R(this.bottom),L=this.bottom-g,$=A-S,Z=R(t.top)+S,ue=t.bottom;else if(c==="bottom")A=R(this.top),Z=t.top,ue=R(t.bottom)-S,L=A+S,$=this.top+g;else if(c==="left")A=R(this.right),P=this.right-g,V=A-S,W=R(t.left)+S,ie=t.right;else if(c==="right")A=R(this.left),W=t.left,ie=R(t.right)-S,P=A+S,V=this.left+g;else if(r==="x"){if(c==="center")A=R((t.top+t.bottom)/2+.5);else if(isObject(c)){const pe=Object.keys(c)[0],me=c[pe];A=R(this.chart.scales[pe].getPixelForValue(me))}Z=t.top,ue=t.bottom,L=A+S,$=L+g}else if(r==="y"){if(c==="center")A=R((t.left+t.right)/2);else if(isObject(c)){const pe=Object.keys(c)[0],me=c[pe];A=R(this.chart.scales[pe].getPixelForValue(me))}P=A-S,V=P-g,W=t.left,ie=t.right}const _e=valueOrDefault(o.ticks.maxTicksLimit,m),Te=Math.max(1,Math.ceil(m/_e));for(I=0;I<m;I+=Te){const pe=this.getContext(I),me=a.setContext(pe),Se=u.setContext(pe),Le=me.lineWidth,xe=me.color,T=Se.dash||[],k=Se.dashOffset,D=me.tickWidth,q=me.tickColor,B=me.tickBorderDash||[],se=me.tickBorderDashOffset;E=getPixelForGridLine(this,I,h),E!==void 0&&(O=_alignPixel(i,E,Le),d?P=V=W=ie=O:L=$=Z=ue=O,v.push({tx1:P,ty1:L,tx2:V,ty2:$,x1:W,y1:Z,x2:ie,y2:ue,width:Le,color:xe,borderDash:T,borderDashOffset:k,tickWidth:D,tickColor:q,tickBorderDash:B,tickBorderDashOffset:se}))}return this._ticksLength=m,this._borderValue=A,v}_computeLabelItems(t){const r=this.axis,i=this.options,{position:o,ticks:a}=i,c=this.isHorizontal(),u=this.ticks,{align:h,crossAlign:d,padding:f,mirror:m}=a,g=getTickMarkLength(i.grid),v=g+f,_=m?-f:v,b=-toRadians(this.labelRotation),S=[];let R,A,I,E,O,P,L,V,$,W,Z,ie,ue="middle";if(o==="top")P=this.bottom-_,L=this._getXAxisLabelAlignment();else if(o==="bottom")P=this.top+_,L=this._getXAxisLabelAlignment();else if(o==="left"){const Te=this._getYAxisLabelAlignment(g);L=Te.textAlign,O=Te.x}else if(o==="right"){const Te=this._getYAxisLabelAlignment(g);L=Te.textAlign,O=Te.x}else if(r==="x"){if(o==="center")P=(t.top+t.bottom)/2+v;else if(isObject(o)){const Te=Object.keys(o)[0],pe=o[Te];P=this.chart.scales[Te].getPixelForValue(pe)+v}L=this._getXAxisLabelAlignment()}else if(r==="y"){if(o==="center")O=(t.left+t.right)/2-v;else if(isObject(o)){const Te=Object.keys(o)[0],pe=o[Te];O=this.chart.scales[Te].getPixelForValue(pe)}L=this._getYAxisLabelAlignment(g).textAlign}r==="y"&&(h==="start"?ue="top":h==="end"&&(ue="bottom"));const _e=this._getLabelSizes();for(R=0,A=u.length;R<A;++R){I=u[R],E=I.label;const Te=a.setContext(this.getContext(R));V=this.getPixelForTick(R)+a.labelOffset,$=this._resolveTickFontOptions(R),W=$.lineHeight,Z=isArray(E)?E.length:1;const pe=Z/2,me=Te.color,Se=Te.textStrokeColor,Le=Te.textStrokeWidth;let xe=L;c?(O=V,L==="inner"&&(R===A-1?xe=this.options.reverse?"left":"right":R===0?xe=this.options.reverse?"right":"left":xe="center"),o==="top"?d==="near"||b!==0?ie=-Z*W+W/2:d==="center"?ie=-_e.highest.height/2-pe*W+W:ie=-_e.highest.height+W/2:d==="near"||b!==0?ie=W/2:d==="center"?ie=_e.highest.height/2-pe*W:ie=_e.highest.height-Z*W,m&&(ie*=-1),b!==0&&!Te.showLabelBackdrop&&(O+=W/2*Math.sin(b))):(P=V,ie=(1-Z)*W/2);let T;if(Te.showLabelBackdrop){const k=toPadding(Te.backdropPadding),D=_e.heights[R],q=_e.widths[R];let B=ie-k.top,se=0-k.left;switch(ue){case"middle":B-=D/2;break;case"bottom":B-=D;break}switch(L){case"center":se-=q/2;break;case"right":se-=q;break;case"inner":R===A-1?se-=q:R>0&&(se-=q/2);break}T={left:se,top:B,width:q+k.width,height:D+k.height,color:Te.backdropColor}}S.push({label:E,font:$,textOffset:ie,options:{rotation:b,color:me,strokeColor:Se,strokeWidth:Le,textAlign:xe,textBaseline:ue,translation:[O,P],backdrop:T}})}return S}_getXAxisLabelAlignment(){const{position:t,ticks:r}=this.options;if(-toRadians(this.labelRotation))return t==="top"?"left":"right";let o="center";return r.align==="start"?o="left":r.align==="end"?o="right":r.align==="inner"&&(o="inner"),o}_getYAxisLabelAlignment(t){const{position:r,ticks:{crossAlign:i,mirror:o,padding:a}}=this.options,c=this._getLabelSizes(),u=t+a,h=c.widest.width;let d,f;return r==="left"?o?(f=this.right+a,i==="near"?d="left":i==="center"?(d="center",f+=h/2):(d="right",f+=h)):(f=this.right-u,i==="near"?d="right":i==="center"?(d="center",f-=h/2):(d="left",f=this.left)):r==="right"?o?(f=this.left+a,i==="near"?d="right":i==="center"?(d="center",f-=h/2):(d="left",f-=h)):(f=this.left+u,i==="near"?d="left":i==="center"?(d="center",f+=h/2):(d="right",f=this.right)):d="right",{textAlign:d,x:f}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,r=this.options.position;if(r==="left"||r==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(r==="top"||r==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:r},left:i,top:o,width:a,height:c}=this;r&&(t.save(),t.fillStyle=r,t.fillRect(i,o,a,c),t.restore())}getLineWidthForValue(t){const r=this.options.grid;if(!this._isVisible()||!r.display)return 0;const o=this.ticks.findIndex(a=>a.value===t);return o>=0?r.setContext(this.getContext(o)).lineWidth:0}drawGrid(t){const r=this.options.grid,i=this.ctx,o=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let a,c;const u=(h,d,f)=>{!f.width||!f.color||(i.save(),i.lineWidth=f.width,i.strokeStyle=f.color,i.setLineDash(f.borderDash||[]),i.lineDashOffset=f.borderDashOffset,i.beginPath(),i.moveTo(h.x,h.y),i.lineTo(d.x,d.y),i.stroke(),i.restore())};if(r.display)for(a=0,c=o.length;a<c;++a){const h=o[a];r.drawOnChartArea&&u({x:h.x1,y:h.y1},{x:h.x2,y:h.y2},h),r.drawTicks&&u({x:h.tx1,y:h.ty1},{x:h.tx2,y:h.ty2},{color:h.tickColor,width:h.tickWidth,borderDash:h.tickBorderDash,borderDashOffset:h.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:r,options:{border:i,grid:o}}=this,a=i.setContext(this.getContext()),c=i.display?a.width:0;if(!c)return;const u=o.setContext(this.getContext(0)).lineWidth,h=this._borderValue;let d,f,m,g;this.isHorizontal()?(d=_alignPixel(t,this.left,c)-c/2,f=_alignPixel(t,this.right,u)+u/2,m=g=h):(m=_alignPixel(t,this.top,c)-c/2,g=_alignPixel(t,this.bottom,u)+u/2,d=f=h),r.save(),r.lineWidth=a.width,r.strokeStyle=a.color,r.beginPath(),r.moveTo(d,m),r.lineTo(f,g),r.stroke(),r.restore()}drawLabels(t){if(!this.options.ticks.display)return;const i=this.ctx,o=this._computeLabelArea();o&&clipArea(i,o);const a=this.getLabelItems(t);for(const c of a){const u=c.options,h=c.font,d=c.label,f=c.textOffset;renderText(i,d,0,f,h,u)}o&&unclipArea(i)}drawTitle(){const{ctx:t,options:{position:r,title:i,reverse:o}}=this;if(!i.display)return;const a=toFont(i.font),c=toPadding(i.padding),u=i.align;let h=a.lineHeight/2;r==="bottom"||r==="center"||isObject(r)?(h+=c.bottom,isArray(i.text)&&(h+=a.lineHeight*(i.text.length-1))):h+=c.top;const{titleX:d,titleY:f,maxWidth:m,rotation:g}=titleArgs(this,h,r,u);renderText(t,i.text,0,0,a,{color:i.color,maxWidth:m,rotation:g,textAlign:titleAlign(u,r,o),textBaseline:"middle",translation:[d,f]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,r=t.ticks&&t.ticks.z||0,i=valueOrDefault(t.grid&&t.grid.z,-1),o=valueOrDefault(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Ji.prototype.draw?[{z:r,draw:a=>{this.draw(a)}}]:[{z:i,draw:a=>{this.drawBackground(),this.drawGrid(a),this.drawTitle()}},{z:o,draw:()=>{this.drawBorder()}},{z:r,draw:a=>{this.drawLabels(a)}}]}getMatchingVisibleMetas(t){const r=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",o=[];let a,c;for(a=0,c=r.length;a<c;++a){const u=r[a];u[i]===this.id&&(!t||u.type===t)&&o.push(u)}return o}_resolveTickFontOptions(t){const r=this.options.ticks.setContext(this.getContext(t));return toFont(r.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}},TypedRegistry=class{constructor(e,t,r){this.type=e,this.scope=t,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let r;isIChartComponent(t)&&(r=this.register(t));const i=this.items,o=e.id,a=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+e);return o in i||(i[o]=e,registerDefaults(e,a,r),this.override&&defaults.override(e.id,e.overrides)),a}get(e){return this.items[e]}unregister(e){const t=this.items,r=e.id,i=this.scope;r in t&&delete t[r],i&&r in defaults[i]&&(delete defaults[i][r],this.override&&delete overrides[r])}};function registerDefaults(e,t,r){const i=merge(Object.create(null),[r?defaults.get(r):{},defaults.get(t),e.defaults]);defaults.set(t,i),e.defaultRoutes&&routeDefaults(t,e.defaultRoutes),e.descriptors&&defaults.describe(t,e.descriptors)}function routeDefaults(e,t){Object.keys(t).forEach(r=>{const i=r.split("."),o=i.pop(),a=[e].concat(i).join("."),c=t[r].split("."),u=c.pop(),h=c.join(".");defaults.route(a,o,h,u)})}function isIChartComponent(e){return"id"in e&&"defaults"in e}var Registry=class{constructor(){this.controllers=new TypedRegistry(DatasetController,"datasets",!0),this.elements=new TypedRegistry(Element2,"elements"),this.plugins=new TypedRegistry(Object,"plugins"),this.scales=new TypedRegistry(Scale,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,r){[...t].forEach(i=>{const o=r||this._getRegistryForType(i);r||o.isForType(i)||o===this.plugins&&i.id?this._exec(e,o,i):each(i,a=>{const c=r||this._getRegistryForType(a);this._exec(e,c,a)})})}_exec(e,t,r){const i=_capitalize(e);callback(r["before"+i],[],r),t[e](r),callback(r["after"+i],[],r)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const r=this._typedRegistries[t];if(r.isForType(e))return r}return this.plugins}_get(e,t,r){const i=t.get(e);if(i===void 0)throw new Error('"'+e+'" is not a registered '+r+".");return i}},registry=new Registry,PluginService=class{constructor(){this._init=[]}notify(e,t,r,i){t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const o=i?this._descriptors(e).filter(i):this._descriptors(e),a=this._notify(o,e,t,r);return t==="afterDestroy"&&(this._notify(o,e,"stop"),this._notify(this._init,e,"uninstall")),a}_notify(e,t,r,i){i=i||{};for(const o of e){const a=o.plugin,c=a[r],u=[t,i,o.options];if(callback(c,u,a)===!1&&i.cancelable)return!1}return!0}invalidate(){isNullOrUndef(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const r=e&&e.config,i=valueOrDefault(r.options&&r.options.plugins,{}),o=allPlugins(r);return i===!1&&!t?[]:createDescriptors(e,o,i,t)}_notifyStateChanges(e){const t=this._oldCache||[],r=this._cache,i=(o,a)=>o.filter(c=>!a.some(u=>c.plugin.id===u.plugin.id));this._notify(i(t,r),e,"stop"),this._notify(i(r,t),e,"start")}};function allPlugins(e){const t={},r=[],i=Object.keys(registry.plugins.items);for(let a=0;a<i.length;a++)r.push(registry.getPlugin(i[a]));const o=e.plugins||[];for(let a=0;a<o.length;a++){const c=o[a];r.indexOf(c)===-1&&(r.push(c),t[c.id]=!0)}return{plugins:r,localIds:t}}function getOpts(e,t){return!t&&e===!1?null:e===!0?{}:e}function createDescriptors(e,{plugins:t,localIds:r},i,o){const a=[],c=e.getContext();for(const u of t){const h=u.id,d=getOpts(i[h],o);d!==null&&a.push({plugin:u,options:pluginOpts(e.config,{plugin:u,local:r[h]},d,c)})}return a}function pluginOpts(e,{plugin:t,local:r},i,o){const a=e.pluginScopeKeys(t),c=e.getOptionScopes(i,a);return r&&t.defaults&&c.push(t.defaults),e.createResolver(c,o,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function getIndexAxis(e,t){const r=defaults.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||r.indexAxis||"x"}function getAxisFromDefaultScaleID(e,t){let r=e;return e==="_index_"?r=t:e==="_value_"&&(r=t==="x"?"y":"x"),r}function getDefaultScaleIDFromAxis(e,t){return e===t?"_index_":"_value_"}function idMatchesAxis(e){if(e==="x"||e==="y"||e==="r")return e}function axisFromPosition(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function determineAxis(e,...t){if(idMatchesAxis(e))return e;for(const r of t){const i=r.axis||axisFromPosition(r.position)||e.length>1&&idMatchesAxis(e[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function getAxisFromDataset(e,t,r){if(r[t+"AxisID"]===e)return{axis:t}}function retrieveAxisFromDatasets(e,t){if(t.data&&t.data.datasets){const r=t.data.datasets.filter(i=>i.xAxisID===e||i.yAxisID===e);if(r.length)return getAxisFromDataset(e,"x",r[0])||getAxisFromDataset(e,"y",r[0])}return{}}function mergeScaleConfig(e,t){const r=overrides[e.type]||{scales:{}},i=t.scales||{},o=getIndexAxis(e.type,t),a=Object.create(null);return Object.keys(i).forEach(c=>{const u=i[c];if(!isObject(u))return console.error(`Invalid scale configuration for scale: ${c}`);if(u._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${c}`);const h=determineAxis(c,u,retrieveAxisFromDatasets(c,e),defaults.scales[u.type]),d=getDefaultScaleIDFromAxis(h,o),f=r.scales||{};a[c]=mergeIf(Object.create(null),[{axis:h},u,f[h],f[d]])}),e.data.datasets.forEach(c=>{const u=c.type||e.type,h=c.indexAxis||getIndexAxis(u,t),f=(overrides[u]||{}).scales||{};Object.keys(f).forEach(m=>{const g=getAxisFromDefaultScaleID(m,h),v=c[g+"AxisID"]||g;a[v]=a[v]||Object.create(null),mergeIf(a[v],[{axis:g},i[v],f[m]])})}),Object.keys(a).forEach(c=>{const u=a[c];mergeIf(u,[defaults.scales[u.type],defaults.scale])}),a}function initOptions(e){const t=e.options||(e.options={});t.plugins=valueOrDefault(t.plugins,{}),t.scales=mergeScaleConfig(e,t)}function initData(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function initConfig(e){return e=e||{},e.data=initData(e.data),initOptions(e),e}var keyCache=new Map,keysCached=new Set;function cachedKeys(e,t){let r=keyCache.get(e);return r||(r=t(),keyCache.set(e,r),keysCached.add(r)),r}var addIfFound=(e,t,r)=>{const i=resolveObjectKey(t,r);i!==void 0&&e.add(i)},Config=class{constructor(e){this._config=initConfig(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=initData(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),initOptions(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return cachedKeys(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return cachedKeys(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return cachedKeys(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,r=this.type;return cachedKeys(`${r}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const r=this._scopeCache;let i=r.get(e);return(!i||t)&&(i=new Map,r.set(e,i)),i}getOptionScopes(e,t,r){const{options:i,type:o}=this,a=this._cachedScopes(e,r),c=a.get(t);if(c)return c;const u=new Set;t.forEach(d=>{e&&(u.add(e),d.forEach(f=>addIfFound(u,e,f))),d.forEach(f=>addIfFound(u,i,f)),d.forEach(f=>addIfFound(u,overrides[o]||{},f)),d.forEach(f=>addIfFound(u,defaults,f)),d.forEach(f=>addIfFound(u,descriptors,f))});const h=Array.from(u);return h.length===0&&h.push(Object.create(null)),keysCached.has(t)&&a.set(t,h),h}chartOptionScopes(){const{options:e,type:t}=this;return[e,overrides[t]||{},defaults.datasets[t]||{},{type:t},defaults,descriptors]}resolveNamedOptions(e,t,r,i=[""]){const o={$shared:!0},{resolver:a,subPrefixes:c}=getResolver(this._resolverCache,e,i);let u=a;if(needContext(a,t)){o.$shared=!1,r=isFunction(r)?r():r;const h=this.createResolver(e,r,c);u=_attachContext(a,r,h)}for(const h of t)o[h]=u[h];return o}createResolver(e,t,r=[""],i){const{resolver:o}=getResolver(this._resolverCache,e,r);return isObject(t)?_attachContext(o,t,void 0,i):o}};function getResolver(e,t,r){let i=e.get(t);i||(i=new Map,e.set(t,i));const o=r.join();let a=i.get(o);return a||(a={resolver:_createResolver(t,r),subPrefixes:r.filter(u=>!u.toLowerCase().includes("hover"))},i.set(o,a)),a}var hasFunction=e=>isObject(e)&&Object.getOwnPropertyNames(e).some(t=>isFunction(e[t]));function needContext(e,t){const{isScriptable:r,isIndexable:i}=_descriptors(e);for(const o of t){const a=r(o),c=i(o),u=(c||a)&&e[o];if(a&&(isFunction(u)||hasFunction(u))||c&&isArray(u))return!0}return!1}var version="4.4.7",KNOWN_POSITIONS=["top","bottom","left","right","chartArea"];function positionIsHorizontal(e,t){return e==="top"||e==="bottom"||KNOWN_POSITIONS.indexOf(e)===-1&&t==="x"}function compare2Level(e,t){return function(r,i){return r[e]===i[e]?r[t]-i[t]:r[e]-i[e]}}function onAnimationsComplete(e){const t=e.chart,r=t.options.animation;t.notifyPlugins("afterRender"),callback(r&&r.onComplete,[e],t)}function onAnimationProgress(e){const t=e.chart,r=t.options.animation;callback(r&&r.onProgress,[e],t)}function getCanvas(e){return _isDomSupported()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}var instances={},getChart=e=>{const t=getCanvas(e);return Object.values(instances).filter(r=>r.canvas===t).pop()};function moveNumericKeys(e,t,r){const i=Object.keys(e);for(const o of i){const a=+o;if(a>=t){const c=e[o];delete e[o],(r>0||a>t)&&(e[a+r]=c)}}}function determineLastEvent(e,t,r,i){return!r||e.type==="mouseout"?null:i?t:e}function getSizeForArea(e,t,r){return e.options.clip?e[r]:t[r]}function getDatasetArea(e,t){const{xScale:r,yScale:i}=e;return r&&i?{left:getSizeForArea(r,t,"left"),right:getSizeForArea(r,t,"right"),top:getSizeForArea(i,t,"top"),bottom:getSizeForArea(i,t,"bottom")}:t}var Chart=class{static defaults=defaults;static instances=instances;static overrides=overrides;static registry=registry;static version=version;static getChart=getChart;static register(...e){registry.add(...e),invalidatePlugins()}static unregister(...e){registry.remove(...e),invalidatePlugins()}constructor(e,t){const r=this.config=new Config(t),i=getCanvas(e),o=getChart(i);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");const a=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||_detectPlatform(i)),this.platform.updateConfig(r);const c=this.platform.acquireContext(i,a.aspectRatio),u=c&&c.canvas,h=u&&u.height,d=u&&u.width;if(this.id=uid(),this.ctx=c,this.canvas=u,this.width=d,this.height=h,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new PluginService,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=debounce(f=>this.update(f),a.resizeDelay||0),this._dataChanges=[],instances[this.id]=this,!c||!u){console.error("Failed to create chart: can't acquire context from the given item");return}animator.listen(this,"complete",onAnimationsComplete),animator.listen(this,"progress",onAnimationProgress),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:r,height:i,_aspectRatio:o}=this;return isNullOrUndef(e)?t&&o?o:i?r/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return registry}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():retinaScale(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return clearCanvas(this.canvas,this.ctx),this}stop(){return animator.stop(this),this}resize(e,t){animator.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const r=this.options,i=this.canvas,o=r.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(i,e,t,o),c=r.devicePixelRatio||this.platform.getDevicePixelRatio(),u=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,retinaScale(this,c,!0)&&(this.notifyPlugins("resize",{size:a}),callback(r.onResize,[this,a],this),this.attached&&this._doResize(u)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};each(t,(r,i)=>{r.id=i})}buildOrUpdateScales(){const e=this.options,t=e.scales,r=this.scales,i=Object.keys(r).reduce((a,c)=>(a[c]=!1,a),{});let o=[];t&&(o=o.concat(Object.keys(t).map(a=>{const c=t[a],u=determineAxis(a,c),h=u==="r",d=u==="x";return{options:c,dposition:h?"chartArea":d?"bottom":"left",dtype:h?"radialLinear":d?"category":"linear"}}))),each(o,a=>{const c=a.options,u=c.id,h=determineAxis(u,c),d=valueOrDefault(c.type,a.dtype);(c.position===void 0||positionIsHorizontal(c.position,h)!==positionIsHorizontal(a.dposition))&&(c.position=a.dposition),i[u]=!0;let f=null;if(u in r&&r[u].type===d)f=r[u];else{const m=registry.getScale(d);f=new m({id:u,type:d,ctx:this.ctx,chart:this}),r[f.id]=f}f.init(c,e)}),each(i,(a,c)=>{a||delete r[c]}),each(r,a=>{layouts.configure(this,a,a.options),layouts.addBox(this,a)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,r=e.length;if(e.sort((i,o)=>i.index-o.index),r>t){for(let i=t;i<r;++i)this._destroyDatasetMeta(i);e.splice(t,r-t)}this._sortedMetasets=e.slice(0).sort(compare2Level("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((r,i)=>{t.filter(o=>o===r._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let r,i;for(this._removeUnreferencedMetasets(),r=0,i=t.length;r<i;r++){const o=t[r];let a=this.getDatasetMeta(r);const c=o.type||this.config.type;if(a.type&&a.type!==c&&(this._destroyDatasetMeta(r),a=this.getDatasetMeta(r)),a.type=c,a.indexAxis=o.indexAxis||getIndexAxis(c,this.options),a.order=o.order||0,a.index=r,a.label=""+o.label,a.visible=this.isDatasetVisible(r),a.controller)a.controller.updateIndex(r),a.controller.linkScales();else{const u=registry.getController(c),{datasetElementType:h,dataElementType:d}=defaults.datasets[c];Object.assign(u,{dataElementType:registry.getElement(d),datasetElementType:h&&registry.getElement(h)}),a.controller=new u(this,r),e.push(a.controller)}}return this._updateMetasets(),e}_resetElements(){each(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const r=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let h=0,d=this.data.datasets.length;h<d;h++){const{controller:f}=this.getDatasetMeta(h),m=!i&&o.indexOf(f)===-1;f.buildOrUpdateElements(m),a=Math.max(+f.getMaxOverflow(),a)}a=this._minPadding=r.layout.autoPadding?a:0,this._updateLayout(a),i||each(o,h=>{h.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(compare2Level("z","_idx"));const{_active:c,_lastEvent:u}=this;u?this._eventHandler(u,!0):c.length&&this._updateHoverStyles(c,c,!0),this.render()}_updateScales(){each(this.scales,e=>{layouts.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!setsEqual(t,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:r,start:i,count:o}of t){const a=r==="_removeElements"?-o:o;moveNumericKeys(e,i,a)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,r=o=>new Set(e.filter(a=>a[0]===o).map((a,c)=>c+","+a.splice(1).join(","))),i=r(0);for(let o=1;o<t;o++)if(!setsEqual(i,r(o)))return;return Array.from(i).map(o=>o.split(",")).map(o=>({method:o[1],start:+o[2],count:+o[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;layouts.update(this,this.width,this.height,e);const t=this.chartArea,r=t.width<=0||t.height<=0;this._layers=[],each(this.boxes,i=>{r&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,o)=>{i._idx=o}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,r=this.data.datasets.length;t<r;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,r=this.data.datasets.length;t<r;++t)this._updateDataset(t,isFunction(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const r=this.getDatasetMeta(e),i={meta:r,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(r.controller._update(t),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(animator.has(this)?this.attached&&!animator.running(this)&&animator.start(this):(this.draw(),onAnimationsComplete({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,r=[];let i,o;for(i=0,o=t.length;i<o;++i){const a=t[i];(!e||a.visible)&&r.push(a)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,r=e._clip,i=!r.disabled,o=getDatasetArea(e,this.chartArea),a={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",a)!==!1&&(i&&clipArea(t,{left:r.left===!1?0:o.left-r.left,right:r.right===!1?this.width:o.right+r.right,top:r.top===!1?0:o.top-r.top,bottom:r.bottom===!1?this.height:o.bottom+r.bottom}),e.controller.draw(),i&&unclipArea(t),a.cancelable=!1,this.notifyPlugins("afterDatasetDraw",a))}isPointInArea(e){return _isPointInArea(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,r,i){const o=Interaction.modes[t];return typeof o=="function"?o(this,e,r,i):[]}getDatasetMeta(e){const t=this.data.datasets[e],r=this._metasets;let i=r.filter(o=>o&&o._dataset===t).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},r.push(i)),i}getContext(){return this.$context||(this.$context=createContext(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!t.hidden}setDatasetVisibility(e,t){const r=this.getDatasetMeta(e);r.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,r){const i=r?"show":"hide",o=this.getDatasetMeta(e),a=o.controller._resolveAnimations(void 0,i);defined(t)?(o.data[t].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),a.update(o,{visible:r}),this.update(c=>c.datasetIndex===e?i:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),animator.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),clearCanvas(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete instances[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,r=(o,a)=>{t.addEventListener(this,o,a),e[o]=a},i=(o,a,c)=>{o.offsetX=a,o.offsetY=c,this._eventHandler(o)};each(this.options.events,o=>r(o,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,r=(u,h)=>{t.addEventListener(this,u,h),e[u]=h},i=(u,h)=>{e[u]&&(t.removeEventListener(this,u,h),delete e[u])},o=(u,h)=>{this.canvas&&this.resize(u,h)};let a;const c=()=>{i("attach",c),this.attached=!0,this.resize(),r("resize",o),r("detach",a)};a=()=>{this.attached=!1,i("resize",o),this._stop(),this._resize(0,0),r("attach",c)},t.isAttached(this.canvas)?c():a()}unbindEvents(){each(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},each(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,r){const i=r?"set":"remove";let o,a,c,u;for(t==="dataset"&&(o=this.getDatasetMeta(e[0].datasetIndex),o.controller["_"+i+"DatasetHoverStyle"]()),c=0,u=e.length;c<u;++c){a=e[c];const h=a&&this.getDatasetMeta(a.datasetIndex).controller;h&&h[i+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],r=e.map(({datasetIndex:o,index:a})=>{const c=this.getDatasetMeta(o);if(!c)throw new Error("No dataset found at index "+o);return{datasetIndex:o,element:c.data[a],index:a}});!_elementsEqual(r,t)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,t))}notifyPlugins(e,t,r){return this._plugins.notify(this,e,t,r)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,r){const i=this.options.hover,o=(u,h)=>u.filter(d=>!h.some(f=>d.datasetIndex===f.datasetIndex&&d.index===f.index)),a=o(t,e),c=r?e:o(e,t);a.length&&this.updateHoverStyle(a,i.mode,!1),c.length&&i.mode&&this.updateHoverStyle(c,i.mode,!0)}_eventHandler(e,t){const r={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},i=a=>(a.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,i)===!1)return;const o=this._handleEvent(e,t,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,i),(o||r.changed)&&this.render(),this}_handleEvent(e,t,r){const{_active:i=[],options:o}=this,a=t,c=this._getActiveElements(e,i,r,a),u=_isClickEvent(e),h=determineLastEvent(e,this._lastEvent,r,u);r&&(this._lastEvent=null,callback(o.onHover,[e,c,this],this),u&&callback(o.onClick,[e,c,this],this));const d=!_elementsEqual(c,i);return(d||t)&&(this._active=c,this._updateHoverStyles(c,i,t)),this._lastEvent=h,d}_getActiveElements(e,t,r,i){if(e.type==="mouseout")return[];if(!r)return t;const o=this.options.hover;return this.getElementsAtEventForMode(e,o.mode,o,i)}};function invalidatePlugins(){return each(Chart.instances,e=>e._plugins.invalidate())}function generateTicks$1(e,t){const r=[],{bounds:o,step:a,min:c,max:u,precision:h,count:d,maxTicks:f,maxDigits:m,includeBounds:g}=e,v=a||1,_=f-1,{min:b,max:S}=t,R=!isNullOrUndef(c),A=!isNullOrUndef(u),I=!isNullOrUndef(d),E=(S-b)/(m+1);let O=niceNum((S-b)/_/v)*v,P,L,V,$;if(O<1e-14&&!R&&!A)return[{value:b},{value:S}];$=Math.ceil(S/O)-Math.floor(b/O),$>_&&(O=niceNum($*O/_/v)*v),isNullOrUndef(h)||(P=Math.pow(10,h),O=Math.ceil(O*P)/P),o==="ticks"?(L=Math.floor(b/O)*O,V=Math.ceil(S/O)*O):(L=b,V=S),R&&A&&a&&almostWhole((u-c)/a,O/1e3)?($=Math.round(Math.min((u-c)/O,f)),O=(u-c)/$,L=c,V=u):I?(L=R?c:L,V=A?u:V,$=d-1,O=(V-L)/$):($=(V-L)/O,almostEquals($,Math.round($),O/1e3)?$=Math.round($):$=Math.ceil($));const W=Math.max(_decimalPlaces(O),_decimalPlaces(L));P=Math.pow(10,isNullOrUndef(h)?W:h),L=Math.round(L*P)/P,V=Math.round(V*P)/P;let Z=0;for(R&&(g&&L!==c?(r.push({value:c}),L<c&&Z++,almostEquals(Math.round((L+Z*O)*P)/P,c,relativeLabelSize(c,E,e))&&Z++):L<c&&Z++);Z<$;++Z){const ie=Math.round((L+Z*O)*P)/P;if(A&&ie>u)break;r.push({value:ie})}return A&&g&&V!==u?r.length&&almostEquals(r[r.length-1].value,u,relativeLabelSize(u,E,e))?r[r.length-1].value=u:r.push({value:u}):(!A||V===u)&&r.push({value:V}),r}function relativeLabelSize(e,t,{horizontal:r,minRotation:i}){const o=toRadians(i),a=(r?Math.sin(o):Math.cos(o))||.001,c=.75*t*(""+e).length;return Math.min(t/a,c)}var LinearScaleBase=class extends Scale{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return isNullOrUndef(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:r}=this.getUserBounds();let{min:i,max:o}=this;const a=u=>i=t?i:u,c=u=>o=r?o:u;if(e){const u=sign(i),h=sign(o);u<0&&h<0?c(0):u>0&&h>0&&a(0)}if(i===o){let u=o===0?1:Math.abs(o*.05);c(o+u),e||a(i-u)}this.min=i,this.max=o}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:r}=e,i;return r?(i=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),t=t||11),t&&(i=Math.min(t,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const i={maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},o=this._range||this,a=generateTicks$1(i,o);return e.bounds==="ticks"&&_setMinAndMaxByKey(a,this,"value"),e.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){const e=this.ticks;let t=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const i=(r-t)/Math.max(e.length-1,1)/2;t-=i,r+=i}this._startValue=t,this._endValue=r,this._valueRange=r-t}getLabelForValue(e){return formatNumber(e,this.chart.options.locale,this.options.ticks.format)}},LinearScale=class extends LinearScaleBase{static id="linear";static defaults={ticks:{callback:Ticks.formatters.numeric}};determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=isNumberFinite(e)?e:0,this.max=isNumberFinite(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,r=toRadians(this.options.ticks.minRotation),i=(e?Math.sin(r):Math.cos(r))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,o.lineHeight/i))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}},log10Floor=e=>Math.floor(log10(e)),changeExponent=(e,t)=>Math.pow(10,log10Floor(e)+t);function isMajor(e){return e/Math.pow(10,log10Floor(e))===1}function steps(e,t,r){const i=Math.pow(10,r),o=Math.floor(e/i);return Math.ceil(t/i)-o}function startExp(e,t){const r=t-e;let i=log10Floor(r);for(;steps(e,t,i)>10;)i++;for(;steps(e,t,i)<10;)i--;return Math.min(i,log10Floor(e))}function generateTicks(e,{min:t,max:r}){t=finiteOrDefault(e.min,t);const i=[],o=log10Floor(t);let a=startExp(t,r),c=a<0?Math.pow(10,Math.abs(a)):1;const u=Math.pow(10,a),h=o>a?Math.pow(10,o):0,d=Math.round((t-h)*c)/c,f=Math.floor((t-h)/u/10)*u*10;let m=Math.floor((d-f)/Math.pow(10,a)),g=finiteOrDefault(e.min,Math.round((h+f+m*Math.pow(10,a))*c)/c);for(;g<r;)i.push({value:g,major:isMajor(g),significand:m}),m>=10?m=m<15?15:20:m++,m>=20&&(a++,m=2,c=a>=0?1:c),g=Math.round((h+f+m*Math.pow(10,a))*c)/c;const v=finiteOrDefault(e.max,g);return i.push({value:v,major:isMajor(v),significand:m}),i}var LogarithmicScale=class extends Scale{static id="logarithmic";static defaults={ticks:{callback:Ticks.formatters.logarithmic,major:{enabled:!0}}};constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const r=LinearScaleBase.prototype.parse.apply(this,[e,t]);if(r===0){this._zero=!0;return}return isNumberFinite(r)&&r>0?r:null}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=isNumberFinite(e)?Math.max(0,e):null,this.max=isNumberFinite(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!isNumberFinite(this._userMin)&&(this.min=e===changeExponent(this.min,0)?changeExponent(this.min,-1):changeExponent(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let r=this.min,i=this.max;const o=c=>r=e?r:c,a=c=>i=t?i:c;r===i&&(r<=0?(o(1),a(10)):(o(changeExponent(r,-1)),a(changeExponent(i,1)))),r<=0&&o(changeExponent(i,-1)),i<=0&&a(changeExponent(r,1)),this.min=r,this.max=i}buildTicks(){const e=this.options,t={min:this._userMin,max:this._userMax},r=generateTicks(t,this);return e.bounds==="ticks"&&_setMinAndMaxByKey(r,this,"value"),e.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}getLabelForValue(e){return e===void 0?"0":formatNumber(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=log10(e),this._valueRange=log10(this.max)-log10(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(log10(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}};function getTickBackdropHeight(e){const t=e.ticks;if(t.display&&e.display){const r=toPadding(t.backdropPadding);return valueOrDefault(t.font&&t.font.size,defaults.font.size)+r.height}return 0}function measureLabelSize(e,t,r){return r=isArray(r)?r:[r],{w:_longestText(e,t.string,r),h:r.length*t.lineHeight}}function determineLimits(e,t,r,i,o){return e===i||e===o?{start:t-r/2,end:t+r/2}:e<i||e>o?{start:t-r,end:t}:{start:t,end:t+r}}function fitWithPointLabels(e){const t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},r=Object.assign({},t),i=[],o=[],a=e._pointLabels.length,c=e.options.pointLabels,u=c.centerPointLabels?PI/a:0;for(let h=0;h<a;h++){const d=c.setContext(e.getPointLabelContext(h));o[h]=d.padding;const f=e.getPointPosition(h,e.drawingArea+o[h],u),m=toFont(d.font),g=measureLabelSize(e.ctx,m,e._pointLabels[h]);i[h]=g;const v=_normalizeAngle(e.getIndexAngle(h)+u),_=Math.round(toDegrees(v)),b=determineLimits(_,f.x,g.w,0,180),S=determineLimits(_,f.y,g.h,90,270);updateLimits(r,t,v,b,S)}e.setCenterPoint(t.l-r.l,r.r-t.r,t.t-r.t,r.b-t.b),e._pointLabelItems=buildPointLabelItems(e,i,o)}function updateLimits(e,t,r,i,o){const a=Math.abs(Math.sin(r)),c=Math.abs(Math.cos(r));let u=0,h=0;i.start<t.l?(u=(t.l-i.start)/a,e.l=Math.min(e.l,t.l-u)):i.end>t.r&&(u=(i.end-t.r)/a,e.r=Math.max(e.r,t.r+u)),o.start<t.t?(h=(t.t-o.start)/c,e.t=Math.min(e.t,t.t-h)):o.end>t.b&&(h=(o.end-t.b)/c,e.b=Math.max(e.b,t.b+h))}function createPointLabelItem(e,t,r){const i=e.drawingArea,{extra:o,additionalAngle:a,padding:c,size:u}=r,h=e.getPointPosition(t,i+o+c,a),d=Math.round(toDegrees(_normalizeAngle(h.angle+HALF_PI))),f=yForAngle(h.y,u.h,d),m=getTextAlignForAngle(d),g=leftForTextAlign(h.x,u.w,m);return{visible:!0,x:h.x,y:f,textAlign:m,left:g,top:f,right:g+u.w,bottom:f+u.h}}function isNotOverlapped(e,t){if(!t)return!0;const{left:r,top:i,right:o,bottom:a}=e;return!(_isPointInArea({x:r,y:i},t)||_isPointInArea({x:r,y:a},t)||_isPointInArea({x:o,y:i},t)||_isPointInArea({x:o,y:a},t))}function buildPointLabelItems(e,t,r){const i=[],o=e._pointLabels.length,a=e.options,{centerPointLabels:c,display:u}=a.pointLabels,h={extra:getTickBackdropHeight(a)/2,additionalAngle:c?PI/o:0};let d;for(let f=0;f<o;f++){h.padding=r[f],h.size=t[f];const m=createPointLabelItem(e,f,h);i.push(m),u==="auto"&&(m.visible=isNotOverlapped(m,d),m.visible&&(d=m))}return i}function getTextAlignForAngle(e){return e===0||e===180?"center":e<180?"left":"right"}function leftForTextAlign(e,t,r){return r==="right"?e-=t:r==="center"&&(e-=t/2),e}function yForAngle(e,t,r){return r===90||r===270?e-=t/2:(r>270||r<90)&&(e-=t),e}function drawPointLabelBox(e,t,r){const{left:i,top:o,right:a,bottom:c}=r,{backdropColor:u}=t;if(!isNullOrUndef(u)){const h=toTRBLCorners(t.borderRadius),d=toPadding(t.backdropPadding);e.fillStyle=u;const f=i-d.left,m=o-d.top,g=a-i+d.width,v=c-o+d.height;Object.values(h).some(_=>_!==0)?(e.beginPath(),addRoundedRectPath(e,{x:f,y:m,w:g,h:v,radius:h}),e.fill()):e.fillRect(f,m,g,v)}}function drawPointLabels(e,t){const{ctx:r,options:{pointLabels:i}}=e;for(let o=t-1;o>=0;o--){const a=e._pointLabelItems[o];if(!a.visible)continue;const c=i.setContext(e.getPointLabelContext(o));drawPointLabelBox(r,c,a);const u=toFont(c.font),{x:h,y:d,textAlign:f}=a;renderText(r,e._pointLabels[o],h,d+u.lineHeight/2,u,{color:c.color,textAlign:f,textBaseline:"middle"})}}function pathRadiusLine(e,t,r,i){const{ctx:o}=e;if(r)o.arc(e.xCenter,e.yCenter,t,0,TAU);else{let a=e.getPointPosition(0,t);o.moveTo(a.x,a.y);for(let c=1;c<i;c++)a=e.getPointPosition(c,t),o.lineTo(a.x,a.y)}}function drawRadiusLine(e,t,r,i,o){const a=e.ctx,c=t.circular,{color:u,lineWidth:h}=t;!c&&!i||!u||!h||r<0||(a.save(),a.strokeStyle=u,a.lineWidth=h,a.setLineDash(o.dash||[]),a.lineDashOffset=o.dashOffset,a.beginPath(),pathRadiusLine(e,r,c,i),a.closePath(),a.stroke(),a.restore())}function createPointLabelContext(e,t,r){return createContext(e,{label:r,index:t,type:"pointLabel"})}var RadialLinearScale=class extends LinearScaleBase{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Ticks.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=toPadding(getTickBackdropHeight(this.options)/2),t=this.width=this.maxWidth-e.width,r=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+r/2+e.top),this.drawingArea=Math.floor(Math.min(t,r)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=isNumberFinite(e)&&!isNaN(e)?e:0,this.max=isNumberFinite(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/getTickBackdropHeight(this.options))}generateTickLabels(e){LinearScaleBase.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((t,r)=>{const i=callback(this.options.pointLabels.callback,[t,r],this);return i||i===0?i:""}).filter((t,r)=>this.chart.getDataVisibility(r))}fit(){const e=this.options;e.display&&e.pointLabels.display?fitWithPointLabels(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,r,i){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((r-i)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,r,i))}getIndexAngle(e){const t=TAU/(this._pointLabels.length||1),r=this.options.startAngle||0;return _normalizeAngle(e*t+toRadians(r))}getDistanceFromCenterForValue(e){if(isNullOrUndef(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(isNullOrUndef(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const r=t[e];return createPointLabelContext(this.getContext(),e,r)}}getPointPosition(e,t,r=0){const i=this.getIndexAngle(e)-HALF_PI+r;return{x:Math.cos(i)*t+this.xCenter,y:Math.sin(i)*t+this.yCenter,angle:i}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:r,right:i,bottom:o}=this._pointLabelItems[e];return{left:t,top:r,right:i,bottom:o}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const r=this.ctx;r.save(),r.beginPath(),pathRadiusLine(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),r.closePath(),r.fillStyle=e,r.fill(),r.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:r,grid:i,border:o}=t,a=this._pointLabels.length;let c,u,h;if(t.pointLabels.display&&drawPointLabels(this,a),i.display&&this.ticks.forEach((d,f)=>{if(f!==0||f===0&&this.min<0){u=this.getDistanceFromCenterForValue(d.value);const m=this.getContext(f),g=i.setContext(m),v=o.setContext(m);drawRadiusLine(this,g,u,a,v)}}),r.display){for(e.save(),c=a-1;c>=0;c--){const d=r.setContext(this.getPointLabelContext(c)),{color:f,lineWidth:m}=d;!m||!f||(e.lineWidth=m,e.strokeStyle=f,e.setLineDash(d.borderDash),e.lineDashOffset=d.borderDashOffset,u=this.getDistanceFromCenterForValue(t.reverse?this.min:this.max),h=this.getPointPosition(c,u),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(h.x,h.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,r=t.ticks;if(!r.display)return;const i=this.getIndexAngle(0);let o,a;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(i),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((c,u)=>{if(u===0&&this.min>=0&&!t.reverse)return;const h=r.setContext(this.getContext(u)),d=toFont(h.font);if(o=this.getDistanceFromCenterForValue(this.ticks[u].value),h.showLabelBackdrop){e.font=d.string,a=e.measureText(c.label).width,e.fillStyle=h.backdropColor;const f=toPadding(h.backdropPadding);e.fillRect(-a/2-f.left,-o-d.size/2-f.top,a+f.width,d.size+f.height)}renderText(e,c.label,0,-o,d,{color:h.color,strokeColor:h.textStrokeColor,strokeWidth:h.textStrokeWidth})}),e.restore()}drawTitle(){}},INTERVALS={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},UNITS=Object.keys(INTERVALS);function sorter(e,t){return e-t}function parse(e,t){if(isNullOrUndef(t))return null;const r=e._adapter,{parser:i,round:o,isoWeekday:a}=e._parseOpts;let c=t;return typeof i=="function"&&(c=i(c)),isNumberFinite(c)||(c=typeof i=="string"?r.parse(c,i):r.parse(c)),c===null?null:(o&&(c=o==="week"&&(isNumber(a)||a===!0)?r.startOf(c,"isoWeek",a):r.startOf(c,o)),+c)}function determineUnitForAutoTicks(e,t,r,i){const o=UNITS.length;for(let a=UNITS.indexOf(e);a<o-1;++a){const c=INTERVALS[UNITS[a]],u=c.steps?c.steps:Number.MAX_SAFE_INTEGER;if(c.common&&Math.ceil((r-t)/(u*c.size))<=i)return UNITS[a]}return UNITS[o-1]}function determineUnitForFormatting(e,t,r,i,o){for(let a=UNITS.length-1;a>=UNITS.indexOf(r);a--){const c=UNITS[a];if(INTERVALS[c].common&&e._adapter.diff(o,i,c)>=t-1)return c}return UNITS[r?UNITS.indexOf(r):0]}function determineMajorUnit(e){for(let t=UNITS.indexOf(e)+1,r=UNITS.length;t<r;++t)if(INTERVALS[UNITS[t]].common)return UNITS[t]}function addTick(e,t,r){if(!r)e[t]=!0;else if(r.length){const{lo:i,hi:o}=_lookup(r,t),a=r[i]>=t?r[i]:r[o];e[a]=!0}}function setMajorTicks(e,t,r,i){const o=e._adapter,a=+o.startOf(t[0].value,i),c=t[t.length-1].value;let u,h;for(u=a;u<=c;u=+o.add(u,1,i))h=r[u],h>=0&&(t[h].major=!0);return t}function ticksFromTimestamps(e,t,r){const i=[],o={},a=t.length;let c,u;for(c=0;c<a;++c)u=t[c],o[u]=c,i.push({value:u,major:!1});return a===0||!r?i:setMajorTicks(e,i,o,r)}var TimeScale=class extends Scale{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const r=e.time||(e.time={}),i=this._adapter=new adapters._date(e.adapters.date);i.init(t),mergeIf(r.displayFormats,i.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:parse(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,r=e.time.unit||"day";let{min:i,max:o,minDefined:a,maxDefined:c}=this.getUserBounds();function u(h){!a&&!isNaN(h.min)&&(i=Math.min(i,h.min)),!c&&!isNaN(h.max)&&(o=Math.max(o,h.max))}(!a||!c)&&(u(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&u(this.getMinMax(!1))),i=isNumberFinite(i)&&!isNaN(i)?i:+t.startOf(Date.now(),r),o=isNumberFinite(o)&&!isNaN(o)?o:+t.endOf(Date.now(),r)+1,this.min=Math.min(i,o-1),this.max=Math.max(i+1,o)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],r=e[e.length-1]),{min:t,max:r}}buildTicks(){const e=this.options,t=e.time,r=e.ticks,i=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const o=this.min,a=this.max,c=_filterBetween(i,o,a);return this._unit=t.unit||(r.autoSkip?determineUnitForAutoTicks(t.minUnit,this.min,this.max,this._getLabelCapacity(o)):determineUnitForFormatting(this,c.length,t.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:determineMajorUnit(this._unit),this.initOffsets(i),e.reverse&&c.reverse(),ticksFromTimestamps(this,c,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,r=0,i,o;this.options.offset&&e.length&&(i=this.getDecimalForValue(e[0]),e.length===1?t=1-i:t=(this.getDecimalForValue(e[1])-i)/2,o=this.getDecimalForValue(e[e.length-1]),e.length===1?r=o:r=(o-this.getDecimalForValue(e[e.length-2]))/2);const a=e.length<3?.5:.25;t=_limitValue(t,0,a),r=_limitValue(r,0,a),this._offsets={start:t,end:r,factor:1/(t+1+r)}}_generate(){const e=this._adapter,t=this.min,r=this.max,i=this.options,o=i.time,a=o.unit||determineUnitForAutoTicks(o.minUnit,t,r,this._getLabelCapacity(t)),c=valueOrDefault(i.ticks.stepSize,1),u=a==="week"?o.isoWeekday:!1,h=isNumber(u)||u===!0,d={};let f=t,m,g;if(h&&(f=+e.startOf(f,"isoWeek",u)),f=+e.startOf(f,h?"day":a),e.diff(r,t,a)>1e5*c)throw new Error(t+" and "+r+" are too far apart with stepSize of "+c+" "+a);const v=i.ticks.source==="data"&&this.getDataTimestamps();for(m=f,g=0;m<r;m=+e.add(m,c,a),g++)addTick(d,m,v);return(m===r||i.bounds==="ticks"||g===1)&&addTick(d,m,v),Object.keys(d).sort(sorter).map(_=>+_)}getLabelForValue(e){const t=this._adapter,r=this.options.time;return r.tooltipFormat?t.format(e,r.tooltipFormat):t.format(e,r.displayFormats.datetime)}format(e,t){const i=this.options.time.displayFormats,o=this._unit,a=t||i[o];return this._adapter.format(e,a)}_tickFormatFunction(e,t,r,i){const o=this.options,a=o.ticks.callback;if(a)return callback(a,[e,t,r],this);const c=o.time.displayFormats,u=this._unit,h=this._majorUnit,d=u&&c[u],f=h&&c[h],m=r[t],g=h&&f&&m&&m.major;return this._adapter.format(e,i||(g?f:d))}generateTickLabels(e){let t,r,i;for(t=0,r=e.length;t<r;++t)i=e[t],i.label=this._tickFormatFunction(i.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+r)*t.factor)}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,r=this.ctx.measureText(e).width,i=toRadians(this.isHorizontal()?t.maxRotation:t.minRotation),o=Math.cos(i),a=Math.sin(i),c=this._resolveTickFontOptions(0).size;return{w:r*o+c*a,h:r*a+c*o}}_getLabelCapacity(e){const t=this.options.time,r=t.displayFormats,i=r[t.unit]||r.millisecond,o=this._tickFormatFunction(e,0,ticksFromTimestamps(this,[e],this._majorUnit),i),a=this._getLabelSize(o),c=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return c>0?c:1}getDataTimestamps(){let e=this._cache.data||[],t,r;if(e.length)return e;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(t=0,r=i.length;t<r;++t)e=e.concat(i[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,r;if(e.length)return e;const i=this.getLabels();for(t=0,r=i.length;t<r;++t)e.push(parse(this,i[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return _arrayUnique(e.sort(sorter))}};function interpolate2(e,t,r){let i=0,o=e.length-1,a,c,u,h;r?(t>=e[i].pos&&t<=e[o].pos&&({lo:i,hi:o}=_lookupByKey(e,"pos",t)),{pos:a,time:u}=e[i],{pos:c,time:h}=e[o]):(t>=e[i].time&&t<=e[o].time&&({lo:i,hi:o}=_lookupByKey(e,"time",t)),{time:a,pos:u}=e[i],{time:c,pos:h}=e[o]);const d=c-a;return d?u+(h-u)*(t-a)/d:u}var TimeSeriesScale=class extends TimeScale{static id="timeseries";static defaults=TimeScale.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=interpolate2(t,this.min),this._tableRange=interpolate2(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:r}=this,i=[],o=[];let a,c,u,h,d;for(a=0,c=e.length;a<c;++a)h=e[a],h>=t&&h<=r&&i.push(h);if(i.length<2)return[{time:t,pos:0},{time:r,pos:1}];for(a=0,c=i.length;a<c;++a)d=i[a+1],u=i[a-1],h=i[a],Math.round((d+u)/2)!==h&&o.push({time:h,pos:a/(c-1)});return o}_generate(){const e=this.min,t=this.max;let r=super.getDataTimestamps();return(!r.includes(e)||!r.length)&&r.splice(0,0,e),(!r.includes(t)||r.length===1)&&r.push(t),r.sort((i,o)=>i-o)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),r=this.getLabelTimestamps();return t.length&&r.length?e=this.normalize(t.concat(r)):e=t.length?t:r,e=this._cache.all=e,e}getDecimalForValue(e){return(interpolate2(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return interpolate2(this._table,r*this._tableRange+this._minPos,!0)}};function ascending(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function descending(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function bisector(e){let t,r,i;e.length!==2?(t=ascending,r=(u,h)=>ascending(e(u),h),i=(u,h)=>e(u)-h):(t=e===ascending||e===descending?e:zero,r=e,i=e);function o(u,h,d=0,f=u.length){if(d<f){if(t(h,h)!==0)return f;do{const m=d+f>>>1;r(u[m],h)<0?d=m+1:f=m}while(d<f)}return d}function a(u,h,d=0,f=u.length){if(d<f){if(t(h,h)!==0)return f;do{const m=d+f>>>1;r(u[m],h)<=0?d=m+1:f=m}while(d<f)}return d}function c(u,h,d=0,f=u.length){const m=o(u,h,d,f-1);return m>d&&i(u[m-1],h)>-i(u[m],h)?m-1:m}return{left:o,center:c,right:a}}function zero(){return 0}function number(e){return e===null?NaN:+e}var ascendingBisect=bisector(ascending),bisectRight=ascendingBisect.right,bisectLeft=ascendingBisect.left,bisectCenter=bisector(number).center,bisect_default=bisectRight,e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2);function tickSpec(e,t,r){const i=(t-e)/Math.max(0,r),o=Math.floor(Math.log10(i)),a=i/Math.pow(10,o),c=a>=e10?10:a>=e5?5:a>=e2?2:1;let u,h,d;return o<0?(d=Math.pow(10,-o)/c,u=Math.round(e*d),h=Math.round(t*d),u/d<e&&++u,h/d>t&&--h,d=-d):(d=Math.pow(10,o)*c,u=Math.round(e/d),h=Math.round(t/d),u*d<e&&++u,h*d>t&&--h),h<u&&.5<=r&&r<2?tickSpec(e,t,r*2):[u,h,d]}function ticks(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const i=t<e,[o,a,c]=i?tickSpec(t,e,r):tickSpec(e,t,r);if(!(a>=o))return[];const u=a-o+1,h=new Array(u);if(i)if(c<0)for(let d=0;d<u;++d)h[d]=(a-d)/-c;else for(let d=0;d<u;++d)h[d]=(a-d)*c;else if(c<0)for(let d=0;d<u;++d)h[d]=(o+d)/-c;else for(let d=0;d<u;++d)h[d]=(o+d)*c;return h}function tickIncrement(e,t,r){return t=+t,e=+e,r=+r,tickSpec(e,t,r)[2]}function tickStep(e,t,r){t=+t,e=+e,r=+r;const i=t<e,o=i?tickIncrement(t,e,r):tickIncrement(e,t,r);return(i?-1:1)*(o<0?1/-o:o)}function identity_default(e){return e}var top=1,right=2,bottom=3,left=4,epsilon=1e-6;function translateX(e){return"translate("+e+",0)"}function translateY(e){return"translate(0,"+e+")"}function number2(e){return t=>+e(t)}function center(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),r=>+e(r)+t}function entering(){return!this.__axis}function axis(e,t){var r=[],i=null,o=null,a=6,c=6,u=3,h=typeof window<"u"&&window.devicePixelRatio>1?0:.5,d=e===top||e===left?-1:1,f=e===left||e===right?"x":"y",m=e===top||e===bottom?translateX:translateY;function g(v){var _=i??(t.ticks?t.ticks.apply(t,r):t.domain()),b=o??(t.tickFormat?t.tickFormat.apply(t,r):identity_default),S=Math.max(a,0)+u,R=t.range(),A=+R[0]+h,I=+R[R.length-1]+h,E=(t.bandwidth?center:number2)(t.copy(),h),O=v.selection?v.selection():v,P=O.selectAll(".domain").data([null]),L=O.selectAll(".tick").data(_,t).order(),V=L.exit(),$=L.enter().append("g").attr("class","tick"),W=L.select("line"),Z=L.select("text");P=P.merge(P.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),L=L.merge($),W=W.merge($.append("line").attr("stroke","currentColor").attr(f+"2",d*a)),Z=Z.merge($.append("text").attr("fill","currentColor").attr(f,d*S).attr("dy",e===top?"0em":e===bottom?"0.71em":"0.32em")),v!==O&&(P=P.transition(v),L=L.transition(v),W=W.transition(v),Z=Z.transition(v),V=V.transition(v).attr("opacity",epsilon).attr("transform",function(ie){return isFinite(ie=E(ie))?m(ie+h):this.getAttribute("transform")}),$.attr("opacity",epsilon).attr("transform",function(ie){var ue=this.parentNode.__axis;return m((ue&&isFinite(ue=ue(ie))?ue:E(ie))+h)})),V.remove(),P.attr("d",e===left||e===right?c?"M"+d*c+","+A+"H"+h+"V"+I+"H"+d*c:"M"+h+","+A+"V"+I:c?"M"+A+","+d*c+"V"+h+"H"+I+"V"+d*c:"M"+A+","+h+"H"+I),L.attr("opacity",1).attr("transform",function(ie){return m(E(ie)+h)}),W.attr(f+"2",d*a),Z.attr(f,d*S).text(b),O.filter(entering).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===right?"start":e===left?"end":"middle"),O.each(function(){this.__axis=E})}return g.scale=function(v){return arguments.length?(t=v,g):t},g.ticks=function(){return r=Array.from(arguments),g},g.tickArguments=function(v){return arguments.length?(r=v==null?[]:Array.from(v),g):r.slice()},g.tickValues=function(v){return arguments.length?(i=v==null?null:Array.from(v),g):i&&i.slice()},g.tickFormat=function(v){return arguments.length?(o=v,g):o},g.tickSize=function(v){return arguments.length?(a=c=+v,g):a},g.tickSizeInner=function(v){return arguments.length?(a=+v,g):a},g.tickSizeOuter=function(v){return arguments.length?(c=+v,g):c},g.tickPadding=function(v){return arguments.length?(u=+v,g):u},g.offset=function(v){return arguments.length?(h=+v,g):h},g}function axisBottom(e){return axis(bottom,e)}function axisLeft(e){return axis(left,e)}var noop2={value:()=>{}};function dispatch(){for(var e=0,t=arguments.length,r={},i;e<t;++e){if(!(i=arguments[e]+"")||i in r||/[\s.]/.test(i))throw new Error("illegal type: "+i);r[i]=[]}return new Dispatch(r)}function Dispatch(e){this._=e}function parseTypenames(e,t){return e.trim().split(/^|\s+/).map(function(r){var i="",o=r.indexOf(".");if(o>=0&&(i=r.slice(o+1),r=r.slice(0,o)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:i}})}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(e,t){var r=this._,i=parseTypenames(e+"",r),o,a=-1,c=i.length;if(arguments.length<2){for(;++a<c;)if((o=(e=i[a]).type)&&(o=get(r[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<c;)if(o=(e=i[a]).type)r[o]=set2(r[o],e.name,t);else if(t==null)for(o in r)r[o]=set2(r[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new Dispatch(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var r=new Array(o),i=0,o,a;i<o;++i)r[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],i=0,o=a.length;i<o;++i)a[i].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],o=0,a=i.length;o<a;++o)i[o].value.apply(t,r)}};function get(e,t){for(var r=0,i=e.length,o;r<i;++r)if((o=e[r]).name===t)return o.value}function set2(e,t,r){for(var i=0,o=e.length;i<o;++i)if(e[i].name===t){e[i]=noop2,e=e.slice(0,i).concat(e.slice(i+1));break}return r!=null&&e.push({name:t,value:r}),e}var dispatch_default=dispatch,xhtml="http://www.w3.org/1999/xhtml",namespaces_default={svg:"http://www.w3.org/2000/svg",xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace_default(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),namespaces_default.hasOwnProperty(t)?{space:namespaces_default[t],local:e}:e}function creatorInherit(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===xhtml&&t.documentElement.namespaceURI===xhtml?t.createElement(e):t.createElementNS(r,e)}}function creatorFixed(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function creator_default(e){var t=namespace_default(e);return(t.local?creatorFixed:creatorInherit)(t)}function none(){}function selector_default(e){return e==null?none:function(){return this.querySelector(e)}}function select_default(e){typeof e!="function"&&(e=selector_default(e));for(var t=this._groups,r=t.length,i=new Array(r),o=0;o<r;++o)for(var a=t[o],c=a.length,u=i[o]=new Array(c),h,d,f=0;f<c;++f)(h=a[f])&&(d=e.call(h,h.__data__,f,a))&&("__data__"in h&&(d.__data__=h.__data__),u[f]=d);return new Selection(i,this._parents)}function array(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function empty(){return[]}function selectorAll_default(e){return e==null?empty:function(){return this.querySelectorAll(e)}}function arrayAll(e){return function(){return array(e.apply(this,arguments))}}function selectAll_default(e){typeof e=="function"?e=arrayAll(e):e=selectorAll_default(e);for(var t=this._groups,r=t.length,i=[],o=[],a=0;a<r;++a)for(var c=t[a],u=c.length,h,d=0;d<u;++d)(h=c[d])&&(i.push(e.call(h,h.__data__,d,c)),o.push(h));return new Selection(i,o)}function matcher_default(e){return function(){return this.matches(e)}}function childMatcher(e){return function(t){return t.matches(e)}}var find=Array.prototype.find;function childFind(e){return function(){return find.call(this.children,e)}}function childFirst(){return this.firstElementChild}function selectChild_default(e){return this.select(e==null?childFirst:childFind(typeof e=="function"?e:childMatcher(e)))}var filter=Array.prototype.filter;function children(){return Array.from(this.children)}function childrenFilter(e){return function(){return filter.call(this.children,e)}}function selectChildren_default(e){return this.selectAll(e==null?children:childrenFilter(typeof e=="function"?e:childMatcher(e)))}function filter_default(e){typeof e!="function"&&(e=matcher_default(e));for(var t=this._groups,r=t.length,i=new Array(r),o=0;o<r;++o)for(var a=t[o],c=a.length,u=i[o]=[],h,d=0;d<c;++d)(h=a[d])&&e.call(h,h.__data__,d,a)&&u.push(h);return new Selection(i,this._parents)}function sparse_default(e){return new Array(e.length)}function enter_default(){return new Selection(this._enter||this._groups.map(sparse_default),this._parents)}function EnterNode(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}EnterNode.prototype={constructor:EnterNode,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function constant_default(e){return function(){return e}}function bindIndex(e,t,r,i,o,a){for(var c=0,u,h=t.length,d=a.length;c<d;++c)(u=t[c])?(u.__data__=a[c],i[c]=u):r[c]=new EnterNode(e,a[c]);for(;c<h;++c)(u=t[c])&&(o[c]=u)}function bindKey(e,t,r,i,o,a,c){var u,h,d=new Map,f=t.length,m=a.length,g=new Array(f),v;for(u=0;u<f;++u)(h=t[u])&&(g[u]=v=c.call(h,h.__data__,u,t)+"",d.has(v)?o[u]=h:d.set(v,h));for(u=0;u<m;++u)v=c.call(e,a[u],u,a)+"",(h=d.get(v))?(i[u]=h,h.__data__=a[u],d.delete(v)):r[u]=new EnterNode(e,a[u]);for(u=0;u<f;++u)(h=t[u])&&d.get(g[u])===h&&(o[u]=h)}function datum(e){return e.__data__}function data_default(e,t){if(!arguments.length)return Array.from(this,datum);var r=t?bindKey:bindIndex,i=this._parents,o=this._groups;typeof e!="function"&&(e=constant_default(e));for(var a=o.length,c=new Array(a),u=new Array(a),h=new Array(a),d=0;d<a;++d){var f=i[d],m=o[d],g=m.length,v=arraylike(e.call(f,f&&f.__data__,d,i)),_=v.length,b=u[d]=new Array(_),S=c[d]=new Array(_),R=h[d]=new Array(g);r(f,m,b,S,R,v,t);for(var A=0,I=0,E,O;A<_;++A)if(E=b[A]){for(A>=I&&(I=A+1);!(O=S[I])&&++I<_;);E._next=O||null}}return c=new Selection(c,i),c._enter=u,c._exit=h,c}function arraylike(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function exit_default(){return new Selection(this._exit||this._groups.map(sparse_default),this._parents)}function join_default(e,t,r){var i=this.enter(),o=this,a=this.exit();return typeof e=="function"?(i=e(i),i&&(i=i.selection())):i=i.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),r==null?a.remove():r(a),i&&o?i.merge(o).order():o}function merge_default(e){for(var t=e.selection?e.selection():e,r=this._groups,i=t._groups,o=r.length,a=i.length,c=Math.min(o,a),u=new Array(o),h=0;h<c;++h)for(var d=r[h],f=i[h],m=d.length,g=u[h]=new Array(m),v,_=0;_<m;++_)(v=d[_]||f[_])&&(g[_]=v);for(;h<o;++h)u[h]=r[h];return new Selection(u,this._parents)}function order_default(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var i=e[t],o=i.length-1,a=i[o],c;--o>=0;)(c=i[o])&&(a&&c.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(c,a),a=c);return this}function sort_default(e){e||(e=ascending2);function t(m,g){return m&&g?e(m.__data__,g.__data__):!m-!g}for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a){for(var c=r[a],u=c.length,h=o[a]=new Array(u),d,f=0;f<u;++f)(d=c[f])&&(h[f]=d);h.sort(t)}return new Selection(o,this._parents).order()}function ascending2(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function call_default(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function nodes_default(){return Array.from(this)}function node_default(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var i=e[t],o=0,a=i.length;o<a;++o){var c=i[o];if(c)return c}return null}function size_default(){let e=0;for(const t of this)++e;return e}function empty_default(){return!this.node()}function each_default(e){for(var t=this._groups,r=0,i=t.length;r<i;++r)for(var o=t[r],a=0,c=o.length,u;a<c;++a)(u=o[a])&&e.call(u,u.__data__,a,o);return this}function attrRemove(e){return function(){this.removeAttribute(e)}}function attrRemoveNS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function attrConstant(e,t){return function(){this.setAttribute(e,t)}}function attrConstantNS(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function attrFunction(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function attrFunctionNS(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function attr_default(e,t){var r=namespace_default(e);if(arguments.length<2){var i=this.node();return r.local?i.getAttributeNS(r.space,r.local):i.getAttribute(r)}return this.each((t==null?r.local?attrRemoveNS:attrRemove:typeof t=="function"?r.local?attrFunctionNS:attrFunction:r.local?attrConstantNS:attrConstant)(r,t))}function window_default(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function styleRemove(e){return function(){this.style.removeProperty(e)}}function styleConstant(e,t,r){return function(){this.style.setProperty(e,t,r)}}function styleFunction(e,t,r){return function(){var i=t.apply(this,arguments);i==null?this.style.removeProperty(e):this.style.setProperty(e,i,r)}}function style_default(e,t,r){return arguments.length>1?this.each((t==null?styleRemove:typeof t=="function"?styleFunction:styleConstant)(e,t,r??"")):styleValue(this.node(),e)}function styleValue(e,t){return e.style.getPropertyValue(t)||window_default(e).getComputedStyle(e,null).getPropertyValue(t)}function propertyRemove(e){return function(){delete this[e]}}function propertyConstant(e,t){return function(){this[e]=t}}function propertyFunction(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function property_default(e,t){return arguments.length>1?this.each((t==null?propertyRemove:typeof t=="function"?propertyFunction:propertyConstant)(e,t)):this.node()[e]}function classArray(e){return e.trim().split(/^|\s+/)}function classList(e){return e.classList||new ClassList(e)}function ClassList(e){this._node=e,this._names=classArray(e.getAttribute("class")||"")}ClassList.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function classedAdd(e,t){for(var r=classList(e),i=-1,o=t.length;++i<o;)r.add(t[i])}function classedRemove(e,t){for(var r=classList(e),i=-1,o=t.length;++i<o;)r.remove(t[i])}function classedTrue(e){return function(){classedAdd(this,e)}}function classedFalse(e){return function(){classedRemove(this,e)}}function classedFunction(e,t){return function(){(t.apply(this,arguments)?classedAdd:classedRemove)(this,e)}}function classed_default(e,t){var r=classArray(e+"");if(arguments.length<2){for(var i=classList(this.node()),o=-1,a=r.length;++o<a;)if(!i.contains(r[o]))return!1;return!0}return this.each((typeof t=="function"?classedFunction:t?classedTrue:classedFalse)(r,t))}function textRemove(){this.textContent=""}function textConstant(e){return function(){this.textContent=e}}function textFunction(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function text_default(e){return arguments.length?this.each(e==null?textRemove:(typeof e=="function"?textFunction:textConstant)(e)):this.node().textContent}function htmlRemove(){this.innerHTML=""}function htmlConstant(e){return function(){this.innerHTML=e}}function htmlFunction(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function html_default(e){return arguments.length?this.each(e==null?htmlRemove:(typeof e=="function"?htmlFunction:htmlConstant)(e)):this.node().innerHTML}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function raise_default(){return this.each(raise)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function lower_default(){return this.each(lower)}function append_default(e){var t=typeof e=="function"?e:creator_default(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function constantNull(){return null}function insert_default(e,t){var r=typeof e=="function"?e:creator_default(e),i=t==null?constantNull:typeof t=="function"?t:selector_default(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),i.apply(this,arguments)||null)})}function remove(){var e=this.parentNode;e&&e.removeChild(this)}function remove_default(){return this.each(remove)}function selection_cloneShallow(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function selection_cloneDeep(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function clone_default(e){return this.select(e?selection_cloneDeep:selection_cloneShallow)}function datum_default(e){return arguments.length?this.property("__data__",e):this.node().__data__}function contextListener(e){return function(t){e.call(this,t,this.__data__)}}function parseTypenames2(e){return e.trim().split(/^|\s+/).map(function(t){var r="",i=t.indexOf(".");return i>=0&&(r=t.slice(i+1),t=t.slice(0,i)),{type:t,name:r}})}function onRemove(e){return function(){var t=this.__on;if(t){for(var r=0,i=-1,o=t.length,a;r<o;++r)a=t[r],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++i]=a;++i?t.length=i:delete this.__on}}}function onAdd(e,t,r){return function(){var i=this.__on,o,a=contextListener(t);if(i){for(var c=0,u=i.length;c<u;++c)if((o=i[c]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=a,o.options=r),o.value=t;return}}this.addEventListener(e.type,a,r),o={type:e.type,name:e.name,value:t,listener:a,options:r},i?i.push(o):this.__on=[o]}}function on_default(e,t,r){var i=parseTypenames2(e+""),o,a=i.length,c;if(arguments.length<2){var u=this.node().__on;if(u){for(var h=0,d=u.length,f;h<d;++h)for(o=0,f=u[h];o<a;++o)if((c=i[o]).type===f.type&&c.name===f.name)return f.value}return}for(u=t?onAdd:onRemove,o=0;o<a;++o)this.each(u(i[o],t,r));return this}function dispatchEvent(e,t,r){var i=window_default(e),o=i.CustomEvent;typeof o=="function"?o=new o(t,r):(o=i.document.createEvent("Event"),r?(o.initEvent(t,r.bubbles,r.cancelable),o.detail=r.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function dispatchConstant(e,t){return function(){return dispatchEvent(this,e,t)}}function dispatchFunction(e,t){return function(){return dispatchEvent(this,e,t.apply(this,arguments))}}function dispatch_default2(e,t){return this.each((typeof t=="function"?dispatchFunction:dispatchConstant)(e,t))}function*iterator_default(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var i=e[t],o=0,a=i.length,c;o<a;++o)(c=i[o])&&(yield c)}var root=[null];function Selection(e,t){this._groups=e,this._parents=t}function selection(){return new Selection([[document.documentElement]],root)}function selection_selection(){return this}Selection.prototype=selection.prototype={constructor:Selection,select:select_default,selectAll:selectAll_default,selectChild:selectChild_default,selectChildren:selectChildren_default,filter:filter_default,data:data_default,enter:enter_default,exit:exit_default,join:join_default,merge:merge_default,selection:selection_selection,order:order_default,sort:sort_default,call:call_default,nodes:nodes_default,node:node_default,size:size_default,empty:empty_default,each:each_default,attr:attr_default,style:style_default,property:property_default,classed:classed_default,text:text_default,html:html_default,raise:raise_default,lower:lower_default,append:append_default,insert:insert_default,remove:remove_default,clone:clone_default,datum:datum_default,on:on_default,dispatch:dispatch_default2,[Symbol.iterator]:iterator_default};var selection_default=selection;function select_default2(e){return typeof e=="string"?new Selection([[document.querySelector(e)]],[document.documentElement]):new Selection([[e]],root)}function create_default(e){return select_default2(creator_default(e).call(document.documentElement))}function define_default(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function extend(e,t){var r=Object.create(e.prototype);for(var i in t)r[i]=t[i];return r}function Color2(){}var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define_default(Color2,color2,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:color_formatHex8,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb});function color_formatHex(){return this.rgb().formatHex()}function color_formatHex8(){return this.rgb().formatHex8()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color2(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=reHex.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?rgbn(t):r===3?new Rgb(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?rgba(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?rgba(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=reRgbInteger.exec(e))?new Rgb(t[1],t[2],t[3],1):(t=reRgbPercent.exec(e))?new Rgb(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=reRgbaInteger.exec(e))?rgba(t[1],t[2],t[3],t[4]):(t=reRgbaPercent.exec(e))?rgba(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=reHslPercent.exec(e))?hsla(t[1],t[2]/100,t[3]/100,1):(t=reHslaPercent.exec(e))?hsla(t[1],t[2]/100,t[3]/100,t[4]):named.hasOwnProperty(e)?rgbn(named[e]):e==="transparent"?new Rgb(NaN,NaN,NaN,0):null}function rgbn(e){return new Rgb(e>>16&255,e>>8&255,e&255,1)}function rgba(e,t,r,i){return i<=0&&(e=t=r=NaN),new Rgb(e,t,r,i)}function rgbConvert(e){return e instanceof Color2||(e=color2(e)),e?(e=e.rgb(),new Rgb(e.r,e.g,e.b,e.opacity)):new Rgb}function rgb(e,t,r,i){return arguments.length===1?rgbConvert(e):new Rgb(e,t,r,i??1)}function Rgb(e,t,r,i){this.r=+e,this.g=+t,this.b=+r,this.opacity=+i}define_default(Rgb,rgb,extend(Color2,{brighter(e){return e=e==null?brighter:Math.pow(brighter,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?darker:Math.pow(darker,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:rgb_formatHex8,formatRgb:rgb_formatRgb,toString:rgb_formatRgb}));function rgb_formatHex(){return`#${hex2(this.r)}${hex2(this.g)}${hex2(this.b)}`}function rgb_formatHex8(){return`#${hex2(this.r)}${hex2(this.g)}${hex2(this.b)}${hex2((isNaN(this.opacity)?1:this.opacity)*255)}`}function rgb_formatRgb(){const e=clampa(this.opacity);return`${e===1?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${e===1?")":`, ${e})`}`}function clampa(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function clampi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function hex2(e){return e=clampi(e),(e<16?"0":"")+e.toString(16)}function hsla(e,t,r,i){return i<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Hsl(e,t,r,i)}function hslConvert(e){if(e instanceof Hsl)return new Hsl(e.h,e.s,e.l,e.opacity);if(e instanceof Color2||(e=color2(e)),!e)return new Hsl;if(e instanceof Hsl)return e;e=e.rgb();var t=e.r/255,r=e.g/255,i=e.b/255,o=Math.min(t,r,i),a=Math.max(t,r,i),c=NaN,u=a-o,h=(a+o)/2;return u?(t===a?c=(r-i)/u+(r<i)*6:r===a?c=(i-t)/u+2:c=(t-r)/u+4,u/=h<.5?a+o:2-a-o,c*=60):u=h>0&&h<1?0:c,new Hsl(c,u,h,e.opacity)}function hsl(e,t,r,i){return arguments.length===1?hslConvert(e):new Hsl(e,t,r,i??1)}function Hsl(e,t,r,i){this.h=+e,this.s=+t,this.l=+r,this.opacity=+i}define_default(Hsl,hsl,extend(Color2,{brighter(e){return e=e==null?brighter:Math.pow(brighter,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?darker:Math.pow(darker,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,i=r+(r<.5?r:1-r)*t,o=2*r-i;return new Rgb(hsl2rgb2(e>=240?e-240:e+120,o,i),hsl2rgb2(e,o,i),hsl2rgb2(e<120?e+240:e-120,o,i),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=clampa(this.opacity);return`${e===1?"hsl(":"hsla("}${clamph(this.h)}, ${clampt(this.s)*100}%, ${clampt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function clamph(e){return e=(e||0)%360,e<0?e+360:e}function clampt(e){return Math.max(0,Math.min(1,e||0))}function hsl2rgb2(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}function basis(e,t,r,i,o){var a=e*e,c=a*e;return((1-3*e+3*a-c)*t+(4-6*a+3*c)*r+(1+3*e+3*a-3*c)*i+c*o)/6}function basis_default(e){var t=e.length-1;return function(r){var i=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),o=e[i],a=e[i+1],c=i>0?e[i-1]:2*o-a,u=i<t-1?e[i+2]:2*a-o;return basis((r-i/t)*t,c,o,a,u)}}function basisClosed_default(e){var t=e.length;return function(r){var i=Math.floor(((r%=1)<0?++r:r)*t),o=e[(i+t-1)%t],a=e[i%t],c=e[(i+1)%t],u=e[(i+2)%t];return basis((r-i/t)*t,o,a,c,u)}}var constant_default2=e=>()=>e;function linear(e,t){return function(r){return e+r*t}}function exponential(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(i){return Math.pow(e+i*t,r)}}function gamma(e){return(e=+e)==1?nogamma:function(t,r){return r-t?exponential(t,r,e):constant_default2(isNaN(t)?r:t)}}function nogamma(e,t){var r=t-e;return r?linear(e,r):constant_default2(isNaN(e)?t:e)}var rgb_default=function e(t){var r=gamma(t);function i(o,a){var c=r((o=rgb(o)).r,(a=rgb(a)).r),u=r(o.g,a.g),h=r(o.b,a.b),d=nogamma(o.opacity,a.opacity);return function(f){return o.r=c(f),o.g=u(f),o.b=h(f),o.opacity=d(f),o+""}}return i.gamma=e,i}(1);function rgbSpline(e){return function(t){var r=t.length,i=new Array(r),o=new Array(r),a=new Array(r),c,u;for(c=0;c<r;++c)u=rgb(t[c]),i[c]=u.r||0,o[c]=u.g||0,a[c]=u.b||0;return i=e(i),o=e(o),a=e(a),u.opacity=1,function(h){return u.r=i(h),u.g=o(h),u.b=a(h),u+""}}}var rgbBasis=rgbSpline(basis_default),rgbBasisClosed=rgbSpline(basisClosed_default);function numberArray_default(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,i=t.slice(),o;return function(a){for(o=0;o<r;++o)i[o]=e[o]*(1-a)+t[o]*a;return i}}function isNumberArray(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function genericArray(e,t){var r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),a=new Array(r),c;for(c=0;c<i;++c)o[c]=value_default(e[c],t[c]);for(;c<r;++c)a[c]=t[c];return function(u){for(c=0;c<i;++c)a[c]=o[c](u);return a}}function date_default(e,t){var r=new Date;return e=+e,t=+t,function(i){return r.setTime(e*(1-i)+t*i),r}}function number_default(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function object_default(e,t){var r={},i={},o;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(o in t)o in e?r[o]=value_default(e[o],t[o]):i[o]=t[o];return function(a){for(o in r)i[o]=r[o](a);return i}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero2(e){return function(){return e}}function one(e){return function(t){return e(t)+""}}function string_default(e,t){var r=reA.lastIndex=reB.lastIndex=0,i,o,a,c=-1,u=[],h=[];for(e=e+"",t=t+"";(i=reA.exec(e))&&(o=reB.exec(t));)(a=o.index)>r&&(a=t.slice(r,a),u[c]?u[c]+=a:u[++c]=a),(i=i[0])===(o=o[0])?u[c]?u[c]+=o:u[++c]=o:(u[++c]=null,h.push({i:c,x:number_default(i,o)})),r=reB.lastIndex;return r<t.length&&(a=t.slice(r),u[c]?u[c]+=a:u[++c]=a),u.length<2?h[0]?one(h[0].x):zero2(t):(t=h.length,function(d){for(var f=0,m;f<t;++f)u[(m=h[f]).i]=m.x(d);return u.join("")})}function value_default(e,t){var r=typeof t,i;return t==null||r==="boolean"?constant_default2(t):(r==="number"?number_default:r==="string"?(i=color2(t))?(t=i,rgb_default):string_default:t instanceof color2?rgb_default:t instanceof Date?date_default:isNumberArray(t)?numberArray_default:Array.isArray(t)?genericArray:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?object_default:number_default)(e,t)}function round_default(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}var degrees=180/Math.PI,identity={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function decompose_default(e,t,r,i,o,a){var c,u,h;return(c=Math.sqrt(e*e+t*t))&&(e/=c,t/=c),(h=e*r+t*i)&&(r-=e*h,i-=t*h),(u=Math.sqrt(r*r+i*i))&&(r/=u,i/=u,h/=u),e*i<t*r&&(e=-e,t=-t,h=-h,c=-c),{translateX:o,translateY:a,rotate:Math.atan2(t,e)*degrees,skewX:Math.atan(h)*degrees,scaleX:c,scaleY:u}}var svgNode;function parseCss(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?identity:decompose_default(t.a,t.b,t.c,t.d,t.e,t.f)}function parseSvg(e){return e==null||(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",e),!(e=svgNode.transform.baseVal.consolidate()))?identity:(e=e.matrix,decompose_default(e.a,e.b,e.c,e.d,e.e,e.f))}function interpolateTransform(e,t,r,i){function o(d){return d.length?d.pop()+" ":""}function a(d,f,m,g,v,_){if(d!==m||f!==g){var b=v.push("translate(",null,t,null,r);_.push({i:b-4,x:number_default(d,m)},{i:b-2,x:number_default(f,g)})}else(m||g)&&v.push("translate("+m+t+g+r)}function c(d,f,m,g){d!==f?(d-f>180?f+=360:f-d>180&&(d+=360),g.push({i:m.push(o(m)+"rotate(",null,i)-2,x:number_default(d,f)})):f&&m.push(o(m)+"rotate("+f+i)}function u(d,f,m,g){d!==f?g.push({i:m.push(o(m)+"skewX(",null,i)-2,x:number_default(d,f)}):f&&m.push(o(m)+"skewX("+f+i)}function h(d,f,m,g,v,_){if(d!==m||f!==g){var b=v.push(o(v)+"scale(",null,",",null,")");_.push({i:b-4,x:number_default(d,m)},{i:b-2,x:number_default(f,g)})}else(m!==1||g!==1)&&v.push(o(v)+"scale("+m+","+g+")")}return function(d,f){var m=[],g=[];return d=e(d),f=e(f),a(d.translateX,d.translateY,f.translateX,f.translateY,m,g),c(d.rotate,f.rotate,m,g),u(d.skewX,f.skewX,m,g),h(d.scaleX,d.scaleY,f.scaleX,f.scaleY,m,g),d=f=null,function(v){for(var _=-1,b=g.length,S;++_<b;)m[(S=g[_]).i]=S.x(v);return m.join("")}}}var interpolateTransformCss=interpolateTransform(parseCss,"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(parseSvg,", ",")",")"),frame=0,timeout=0,interval=0,pokeDelay=1e3,taskHead,taskTail,clockLast=0,clockNow=0,clockSkew=0,clock=typeof performance=="object"&&performance.now?performance:Date,setFrame=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}Timer.prototype=timer.prototype={constructor:Timer,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?now():+r)+(t==null?0:+t),!this._next&&taskTail!==this&&(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=e,this._time=r,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};function timer(e,t,r){var i=new Timer;return i.restart(e,t,r),i}function timerFlush(){now(),++frame;for(var e=taskHead,t;e;)(t=clockNow-e._time)>=0&&e._call.call(void 0,t),e=e._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var e=clock.now(),t=e-clockLast;t>pokeDelay&&(clockSkew-=t,clockLast=e)}function nap(){for(var e,t=taskHead,r,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:taskHead=r);taskTail=e,sleep(i)}function sleep(e){if(!frame){timeout&&(timeout=clearTimeout(timeout));var t=e-clockNow;t>24?(e<1/0&&(timeout=setTimeout(wake,e-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake))}}function timeout_default(e,t,r){var i=new Timer;return t=t==null?0:+t,i.restart(o=>{i.stop(),e(o+t)},t,r),i}var emptyOn=dispatch_default("start","end","cancel","interrupt"),emptyTween=[],CREATED=0,SCHEDULED=1,STARTING=2,STARTED=3,RUNNING=4,ENDING=5,ENDED=6;function schedule_default(e,t,r,i,o,a){var c=e.__transition;if(!c)e.__transition={};else if(r in c)return;create(e,r,{name:t,index:i,group:o,on:emptyOn,tween:emptyTween,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:CREATED})}function init(e,t){var r=get2(e,t);if(r.state>CREATED)throw new Error("too late; already scheduled");return r}function set3(e,t){var r=get2(e,t);if(r.state>STARTED)throw new Error("too late; already running");return r}function get2(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function create(e,t,r){var i=e.__transition,o;i[t]=r,r.timer=timer(a,0,r.time);function a(d){r.state=SCHEDULED,r.timer.restart(c,r.delay,r.time),r.delay<=d&&c(d-r.delay)}function c(d){var f,m,g,v;if(r.state!==SCHEDULED)return h();for(f in i)if(v=i[f],v.name===r.name){if(v.state===STARTED)return timeout_default(c);v.state===RUNNING?(v.state=ENDED,v.timer.stop(),v.on.call("interrupt",e,e.__data__,v.index,v.group),delete i[f]):+f<t&&(v.state=ENDED,v.timer.stop(),v.on.call("cancel",e,e.__data__,v.index,v.group),delete i[f])}if(timeout_default(function(){r.state===STARTED&&(r.state=RUNNING,r.timer.restart(u,r.delay,r.time),u(d))}),r.state=STARTING,r.on.call("start",e,e.__data__,r.index,r.group),r.state===STARTING){for(r.state=STARTED,o=new Array(g=r.tween.length),f=0,m=-1;f<g;++f)(v=r.tween[f].value.call(e,e.__data__,r.index,r.group))&&(o[++m]=v);o.length=m+1}}function u(d){for(var f=d<r.duration?r.ease.call(null,d/r.duration):(r.timer.restart(h),r.state=ENDING,1),m=-1,g=o.length;++m<g;)o[m].call(e,f);r.state===ENDING&&(r.on.call("end",e,e.__data__,r.index,r.group),h())}function h(){r.state=ENDED,r.timer.stop(),delete i[t];for(var d in i)return;delete e.__transition}}function interrupt_default(e,t){var r=e.__transition,i,o,a=!0,c;if(r){t=t==null?null:t+"";for(c in r){if((i=r[c]).name!==t){a=!1;continue}o=i.state>STARTING&&i.state<ENDING,i.state=ENDED,i.timer.stop(),i.on.call(o?"interrupt":"cancel",e,e.__data__,i.index,i.group),delete r[c]}a&&delete e.__transition}}function interrupt_default2(e){return this.each(function(){interrupt_default(this,e)})}function tweenRemove(e,t){var r,i;return function(){var o=set3(this,e),a=o.tween;if(a!==r){i=r=a;for(var c=0,u=i.length;c<u;++c)if(i[c].name===t){i=i.slice(),i.splice(c,1);break}}o.tween=i}}function tweenFunction(e,t,r){var i,o;if(typeof r!="function")throw new Error;return function(){var a=set3(this,e),c=a.tween;if(c!==i){o=(i=c).slice();for(var u={name:t,value:r},h=0,d=o.length;h<d;++h)if(o[h].name===t){o[h]=u;break}h===d&&o.push(u)}a.tween=o}}function tween_default(e,t){var r=this._id;if(e+="",arguments.length<2){for(var i=get2(this.node(),r).tween,o=0,a=i.length,c;o<a;++o)if((c=i[o]).name===e)return c.value;return null}return this.each((t==null?tweenRemove:tweenFunction)(r,e,t))}function tweenValue(e,t,r){var i=e._id;return e.each(function(){var o=set3(this,i);(o.value||(o.value={}))[t]=r.apply(this,arguments)}),function(o){return get2(o,i).value[t]}}function interpolate_default(e,t){var r;return(typeof t=="number"?number_default:t instanceof color2?rgb_default:(r=color2(t))?(t=r,rgb_default):string_default)(e,t)}function attrRemove2(e){return function(){this.removeAttribute(e)}}function attrRemoveNS2(e){return function(){this.removeAttributeNS(e.space,e.local)}}function attrConstant2(e,t,r){var i,o=r+"",a;return function(){var c=this.getAttribute(e);return c===o?null:c===i?a:a=t(i=c,r)}}function attrConstantNS2(e,t,r){var i,o=r+"",a;return function(){var c=this.getAttributeNS(e.space,e.local);return c===o?null:c===i?a:a=t(i=c,r)}}function attrFunction2(e,t,r){var i,o,a;return function(){var c,u=r(this),h;return u==null?void this.removeAttribute(e):(c=this.getAttribute(e),h=u+"",c===h?null:c===i&&h===o?a:(o=h,a=t(i=c,u)))}}function attrFunctionNS2(e,t,r){var i,o,a;return function(){var c,u=r(this),h;return u==null?void this.removeAttributeNS(e.space,e.local):(c=this.getAttributeNS(e.space,e.local),h=u+"",c===h?null:c===i&&h===o?a:(o=h,a=t(i=c,u)))}}function attr_default2(e,t){var r=namespace_default(e),i=r==="transform"?interpolateTransformSvg:interpolate_default;return this.attrTween(e,typeof t=="function"?(r.local?attrFunctionNS2:attrFunction2)(r,i,tweenValue(this,"attr."+e,t)):t==null?(r.local?attrRemoveNS2:attrRemove2)(r):(r.local?attrConstantNS2:attrConstant2)(r,i,t))}function attrInterpolate(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function attrInterpolateNS(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function attrTweenNS(e,t){var r,i;function o(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&attrInterpolateNS(e,a)),r}return o._value=t,o}function attrTween(e,t){var r,i;function o(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&attrInterpolate(e,a)),r}return o._value=t,o}function attrTween_default(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var i=namespace_default(e);return this.tween(r,(i.local?attrTweenNS:attrTween)(i,t))}function delayFunction(e,t){return function(){init(this,e).delay=+t.apply(this,arguments)}}function delayConstant(e,t){return t=+t,function(){init(this,e).delay=t}}function delay_default(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?delayFunction:delayConstant)(t,e)):get2(this.node(),t).delay}function durationFunction(e,t){return function(){set3(this,e).duration=+t.apply(this,arguments)}}function durationConstant(e,t){return t=+t,function(){set3(this,e).duration=t}}function duration_default(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?durationFunction:durationConstant)(t,e)):get2(this.node(),t).duration}function easeConstant(e,t){if(typeof t!="function")throw new Error;return function(){set3(this,e).ease=t}}function ease_default(e){var t=this._id;return arguments.length?this.each(easeConstant(t,e)):get2(this.node(),t).ease}function easeVarying(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;set3(this,e).ease=r}}function easeVarying_default(e){if(typeof e!="function")throw new Error;return this.each(easeVarying(this._id,e))}function filter_default2(e){typeof e!="function"&&(e=matcher_default(e));for(var t=this._groups,r=t.length,i=new Array(r),o=0;o<r;++o)for(var a=t[o],c=a.length,u=i[o]=[],h,d=0;d<c;++d)(h=a[d])&&e.call(h,h.__data__,d,a)&&u.push(h);return new Transition(i,this._parents,this._name,this._id)}function merge_default2(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,i=t.length,o=r.length,a=Math.min(i,o),c=new Array(i),u=0;u<a;++u)for(var h=t[u],d=r[u],f=h.length,m=c[u]=new Array(f),g,v=0;v<f;++v)(g=h[v]||d[v])&&(m[v]=g);for(;u<i;++u)c[u]=t[u];return new Transition(c,this._parents,this._name,this._id)}function start(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function onFunction(e,t,r){var i,o,a=start(t)?init:set3;return function(){var c=a(this,e),u=c.on;u!==i&&(o=(i=u).copy()).on(t,r),c.on=o}}function on_default2(e,t){var r=this._id;return arguments.length<2?get2(this.node(),r).on.on(e):this.each(onFunction(r,e,t))}function removeFunction(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function remove_default2(){return this.on("end.remove",removeFunction(this._id))}function select_default3(e){var t=this._name,r=this._id;typeof e!="function"&&(e=selector_default(e));for(var i=this._groups,o=i.length,a=new Array(o),c=0;c<o;++c)for(var u=i[c],h=u.length,d=a[c]=new Array(h),f,m,g=0;g<h;++g)(f=u[g])&&(m=e.call(f,f.__data__,g,u))&&("__data__"in f&&(m.__data__=f.__data__),d[g]=m,schedule_default(d[g],t,r,g,d,get2(f,r)));return new Transition(a,this._parents,t,r)}function selectAll_default2(e){var t=this._name,r=this._id;typeof e!="function"&&(e=selectorAll_default(e));for(var i=this._groups,o=i.length,a=[],c=[],u=0;u<o;++u)for(var h=i[u],d=h.length,f,m=0;m<d;++m)if(f=h[m]){for(var g=e.call(f,f.__data__,m,h),v,_=get2(f,r),b=0,S=g.length;b<S;++b)(v=g[b])&&schedule_default(v,t,r,b,g,_);a.push(g),c.push(f)}return new Transition(a,c,t,r)}var Selection2=selection_default.prototype.constructor;function selection_default2(){return new Selection2(this._groups,this._parents)}function styleNull(e,t){var r,i,o;return function(){var a=styleValue(this,e),c=(this.style.removeProperty(e),styleValue(this,e));return a===c?null:a===r&&c===i?o:o=t(r=a,i=c)}}function styleRemove2(e){return function(){this.style.removeProperty(e)}}function styleConstant2(e,t,r){var i,o=r+"",a;return function(){var c=styleValue(this,e);return c===o?null:c===i?a:a=t(i=c,r)}}function styleFunction2(e,t,r){var i,o,a;return function(){var c=styleValue(this,e),u=r(this),h=u+"";return u==null&&(h=u=(this.style.removeProperty(e),styleValue(this,e))),c===h?null:c===i&&h===o?a:(o=h,a=t(i=c,u))}}function styleMaybeRemove(e,t){var r,i,o,a="style."+t,c="end."+a,u;return function(){var h=set3(this,e),d=h.on,f=h.value[a]==null?u||(u=styleRemove2(t)):void 0;(d!==r||o!==f)&&(i=(r=d).copy()).on(c,o=f),h.on=i}}function style_default2(e,t,r){var i=(e+="")=="transform"?interpolateTransformCss:interpolate_default;return t==null?this.styleTween(e,styleNull(e,i)).on("end.style."+e,styleRemove2(e)):typeof t=="function"?this.styleTween(e,styleFunction2(e,i,tweenValue(this,"style."+e,t))).each(styleMaybeRemove(this._id,e)):this.styleTween(e,styleConstant2(e,i,t),r).on("end.style."+e,null)}function styleInterpolate(e,t,r){return function(i){this.style.setProperty(e,t.call(this,i),r)}}function styleTween(e,t,r){var i,o;function a(){var c=t.apply(this,arguments);return c!==o&&(i=(o=c)&&styleInterpolate(e,c,r)),i}return a._value=t,a}function styleTween_default(e,t,r){var i="style."+(e+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(t==null)return this.tween(i,null);if(typeof t!="function")throw new Error;return this.tween(i,styleTween(e,t,r??""))}function textConstant2(e){return function(){this.textContent=e}}function textFunction2(e){return function(){var t=e(this);this.textContent=t??""}}function text_default2(e){return this.tween("text",typeof e=="function"?textFunction2(tweenValue(this,"text",e)):textConstant2(e==null?"":e+""))}function textInterpolate(e){return function(t){this.textContent=e.call(this,t)}}function textTween(e){var t,r;function i(){var o=e.apply(this,arguments);return o!==r&&(t=(r=o)&&textInterpolate(o)),t}return i._value=e,i}function textTween_default(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,textTween(e))}function transition_default(){for(var e=this._name,t=this._id,r=newId(),i=this._groups,o=i.length,a=0;a<o;++a)for(var c=i[a],u=c.length,h,d=0;d<u;++d)if(h=c[d]){var f=get2(h,t);schedule_default(h,e,r,d,c,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new Transition(i,this._parents,e,r)}function end_default(){var e,t,r=this,i=r._id,o=r.size();return new Promise(function(a,c){var u={value:c},h={value:function(){--o===0&&a()}};r.each(function(){var d=set3(this,i),f=d.on;f!==e&&(t=(e=f).copy(),t._.cancel.push(u),t._.interrupt.push(u),t._.end.push(h)),d.on=t}),o===0&&a()})}var id=0;function Transition(e,t,r,i){this._groups=e,this._parents=t,this._name=r,this._id=i}function transition(e){return selection_default().transition(e)}function newId(){return++id}var selection_prototype=selection_default.prototype;Transition.prototype=transition.prototype={constructor:Transition,select:select_default3,selectAll:selectAll_default2,selectChild:selection_prototype.selectChild,selectChildren:selection_prototype.selectChildren,filter:filter_default2,merge:merge_default2,selection:selection_default2,transition:transition_default,call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:on_default2,attr:attr_default2,attrTween:attrTween_default,style:style_default2,styleTween:styleTween_default,text:text_default2,textTween:textTween_default,remove:remove_default2,tween:tween_default,delay:delay_default,duration:duration_default,ease:ease_default,easeVarying:easeVarying_default,end:end_default,[Symbol.iterator]:selection_prototype[Symbol.iterator]};function cubicInOut(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var defaultTiming={time:null,delay:0,duration:250,ease:cubicInOut};function inherit(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function transition_default2(e){var t,r;e instanceof Transition?(t=e._id,e=e._name):(t=newId(),(r=defaultTiming).time=now(),e=e==null?null:e+"");for(var i=this._groups,o=i.length,a=0;a<o;++a)for(var c=i[a],u=c.length,h,d=0;d<u;++d)(h=c[d])&&schedule_default(h,e,t,d,c,r||inherit(h,t));return new Transition(i,this._parents,e,t)}selection_default.prototype.interrupt=interrupt_default2,selection_default.prototype.transition=transition_default2;var{abs,max,min}=Math;function number1(e){return[+e[0],+e[1]]}function number22(e){return[number1(e[0]),number1(e[1])]}var X={name:"x",handles:["w","e"].map(type),input:function(e,t){return e==null?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},Y={name:"y",handles:["n","s"].map(type),input:function(e,t){return e==null?null:[[t[0][0],+e[0]],[t[1][0],+e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},XY={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(type),input:function(e){return e==null?null:number22(e)},output:function(e){return e}};function type(e){return{type:e}}function formatDecimal_default(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function formatDecimalParts(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,i=e.slice(0,r);return[i.length>1?i[0]+i.slice(2):i,+e.slice(r+1)]}function exponent_default(e){return e=formatDecimalParts(Math.abs(e)),e?e[1]:NaN}function formatGroup_default(e,t){return function(r,i){for(var o=r.length,a=[],c=0,u=e[0],h=0;o>0&&u>0&&(h+u+1>i&&(u=Math.max(1,i-h)),a.push(r.substring(o-=u,o+u)),!((h+=u+1)>i));)u=e[c=(c+1)%e.length];return a.reverse().join(t)}}function formatNumerals_default(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var re=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function formatSpecifier(e){if(!(t=re.exec(e)))throw new Error("invalid format: "+e);var t;return new FormatSpecifier({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}formatSpecifier.prototype=FormatSpecifier.prototype;function FormatSpecifier(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function formatTrim_default(e){e:for(var t=e.length,r=1,i=-1,o;r<t;++r)switch(e[r]){case".":i=o=r;break;case"0":i===0&&(i=r),o=r;break;default:if(!+e[r])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(o+1):e}var prefixExponent;function formatPrefixAuto_default(e,t){var r=formatDecimalParts(e,t);if(!r)return e+"";var i=r[0],o=r[1],a=o-(prefixExponent=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,c=i.length;return a===c?i:a>c?i+new Array(a-c+1).join("0"):a>0?i.slice(0,a)+"."+i.slice(a):"0."+new Array(1-a).join("0")+formatDecimalParts(e,Math.max(0,t+a-1))[0]}function formatRounded_default(e,t){var r=formatDecimalParts(e,t);if(!r)return e+"";var i=r[0],o=r[1];return o<0?"0."+new Array(-o).join("0")+i:i.length>o+1?i.slice(0,o+1)+"."+i.slice(o+1):i+new Array(o-i.length+2).join("0")}var formatTypes_default={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:formatDecimal_default,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>formatRounded_default(e*100,t),r:formatRounded_default,s:formatPrefixAuto_default,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function identity_default2(e){return e}var map2=Array.prototype.map,prefixes=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function locale_default(e){var t=e.grouping===void 0||e.thousands===void 0?identity_default2:formatGroup_default(map2.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",o=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?identity_default2:formatNumerals_default(map2.call(e.numerals,String)),c=e.percent===void 0?"%":e.percent+"",u=e.minus===void 0?"\u2212":e.minus+"",h=e.nan===void 0?"NaN":e.nan+"";function d(m){m=formatSpecifier(m);var g=m.fill,v=m.align,_=m.sign,b=m.symbol,S=m.zero,R=m.width,A=m.comma,I=m.precision,E=m.trim,O=m.type;O==="n"?(A=!0,O="g"):formatTypes_default[O]||(I===void 0&&(I=12),E=!0,O="g"),(S||g==="0"&&v==="=")&&(S=!0,g="0",v="=");var P=b==="$"?r:b==="#"&&/[boxX]/.test(O)?"0"+O.toLowerCase():"",L=b==="$"?i:/[%p]/.test(O)?c:"",V=formatTypes_default[O],$=/[defgprs%]/.test(O);I=I===void 0?6:/[gprs]/.test(O)?Math.max(1,Math.min(21,I)):Math.max(0,Math.min(20,I));function W(Z){var ie=P,ue=L,_e,Te,pe;if(O==="c")ue=V(Z)+ue,Z="";else{Z=+Z;var me=Z<0||1/Z<0;if(Z=isNaN(Z)?h:V(Math.abs(Z),I),E&&(Z=formatTrim_default(Z)),me&&+Z==0&&_!=="+"&&(me=!1),ie=(me?_==="("?_:u:_==="-"||_==="("?"":_)+ie,ue=(O==="s"?prefixes[8+prefixExponent/3]:"")+ue+(me&&_==="("?")":""),$){for(_e=-1,Te=Z.length;++_e<Te;)if(pe=Z.charCodeAt(_e),48>pe||pe>57){ue=(pe===46?o+Z.slice(_e+1):Z.slice(_e))+ue,Z=Z.slice(0,_e);break}}}A&&!S&&(Z=t(Z,1/0));var Se=ie.length+Z.length+ue.length,Le=Se<R?new Array(R-Se+1).join(g):"";switch(A&&S&&(Z=t(Le+Z,Le.length?R-ue.length:1/0),Le=""),v){case"<":Z=ie+Z+ue+Le;break;case"=":Z=ie+Le+Z+ue;break;case"^":Z=Le.slice(0,Se=Le.length>>1)+ie+Z+ue+Le.slice(Se);break;default:Z=Le+ie+Z+ue;break}return a(Z)}return W.toString=function(){return m+""},W}function f(m,g){var v=d((m=formatSpecifier(m),m.type="f",m)),_=Math.max(-8,Math.min(8,Math.floor(exponent_default(g)/3)))*3,b=Math.pow(10,-_),S=prefixes[8+_/3];return function(R){return v(b*R)+S}}return{format:d,formatPrefix:f}}var locale,format,formatPrefix;defaultLocale({thousands:",",grouping:[3],currency:["$",""]});function defaultLocale(e){return locale=locale_default(e),format=locale.format,formatPrefix=locale.formatPrefix,locale}function precisionFixed_default(e){return Math.max(0,-exponent_default(Math.abs(e)))}function precisionPrefix_default(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(exponent_default(t)/3)))*3-exponent_default(Math.abs(e)))}function precisionRound_default(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,exponent_default(t)-exponent_default(e))+1}function initRange(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function constants(e){return function(){return e}}function number3(e){return+e}var unit=[0,1];function identity2(e){return e}function normalize(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:constants(isNaN(t)?NaN:.5)}function clamper(e,t){var r;return e>t&&(r=e,e=t,t=r),function(i){return Math.max(e,Math.min(t,i))}}function bimap(e,t,r){var i=e[0],o=e[1],a=t[0],c=t[1];return o<i?(i=normalize(o,i),a=r(c,a)):(i=normalize(i,o),a=r(a,c)),function(u){return a(i(u))}}function polymap(e,t,r){var i=Math.min(e.length,t.length)-1,o=new Array(i),a=new Array(i),c=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++c<i;)o[c]=normalize(e[c],e[c+1]),a[c]=r(t[c],t[c+1]);return function(u){var h=bisect_default(e,u,1,i)-1;return a[h](o[h](u))}}function copy(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function transformer(){var e=unit,t=unit,r=value_default,i,o,a,c=identity2,u,h,d;function f(){var g=Math.min(e.length,t.length);return c!==identity2&&(c=clamper(e[0],e[g-1])),u=g>2?polymap:bimap,h=d=null,m}function m(g){return g==null||isNaN(g=+g)?a:(h||(h=u(e.map(i),t,r)))(i(c(g)))}return m.invert=function(g){return c(o((d||(d=u(t,e.map(i),number_default)))(g)))},m.domain=function(g){return arguments.length?(e=Array.from(g,number3),f()):e.slice()},m.range=function(g){return arguments.length?(t=Array.from(g),f()):t.slice()},m.rangeRound=function(g){return t=Array.from(g),r=round_default,f()},m.clamp=function(g){return arguments.length?(c=g?!0:identity2,f()):c!==identity2},m.interpolate=function(g){return arguments.length?(r=g,f()):r},m.unknown=function(g){return arguments.length?(a=g,m):a},function(g,v){return i=g,o=v,f()}}function continuous(){return transformer()(identity2,identity2)}function tickFormat(e,t,r,i){var o=tickStep(e,t,r),a;switch(i=formatSpecifier(i??",f"),i.type){case"s":{var c=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(a=precisionPrefix_default(o,c))&&(i.precision=a),formatPrefix(i,c)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(a=precisionRound_default(o,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=a-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(a=precisionFixed_default(o))&&(i.precision=a-(i.type==="%")*2);break}}return format(i)}function linearish(e){var t=e.domain;return e.ticks=function(r){var i=t();return ticks(i[0],i[i.length-1],r??10)},e.tickFormat=function(r,i){var o=t();return tickFormat(o[0],o[o.length-1],r??10,i)},e.nice=function(r){r==null&&(r=10);var i=t(),o=0,a=i.length-1,c=i[o],u=i[a],h,d,f=10;for(u<c&&(d=c,c=u,u=d,d=o,o=a,a=d);f-- >0;){if(d=tickIncrement(c,u,r),d===h)return i[o]=c,i[a]=u,t(i);if(d>0)c=Math.floor(c/d)*d,u=Math.ceil(u/d)*d;else if(d<0)c=Math.ceil(c*d)/d,u=Math.floor(u*d)/d;else break;h=d}return e},e}function linear2(){var e=continuous();return e.copy=function(){return copy(e,linear2())},initRange.apply(e,arguments),linearish(e)}function nice(e,t){e=e.slice();var r=0,i=e.length-1,o=e[r],a=e[i],c;return a<o&&(c=r,r=i,i=c,c=o,o=a,a=c),e[r]=t.floor(o),e[i]=t.ceil(a),e}var t0=new Date,t1=new Date;function timeInterval(e,t,r,i){function o(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return o.floor=a=>(e(a=new Date(+a)),a),o.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),o.round=a=>{const c=o(a),u=o.ceil(a);return a-c<u-a?c:u},o.offset=(a,c)=>(t(a=new Date(+a),c==null?1:Math.floor(c)),a),o.range=(a,c,u)=>{const h=[];if(a=o.ceil(a),u=u==null?1:Math.floor(u),!(a<c)||!(u>0))return h;let d;do h.push(d=new Date(+a)),t(a,u),e(a);while(d<a&&a<c);return h},o.filter=a=>timeInterval(c=>{if(c>=c)for(;e(c),!a(c);)c.setTime(c-1)},(c,u)=>{if(c>=c)if(u<0)for(;++u<=0;)for(;t(c,-1),!a(c););else for(;--u>=0;)for(;t(c,1),!a(c););}),r&&(o.count=(a,c)=>(t0.setTime(+a),t1.setTime(+c),e(t0),e(t1),Math.floor(r(t0,t1))),o.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?o.filter(i?c=>i(c)%a===0:c=>o.count(0,c)%a===0):o)),o}var millisecond=timeInterval(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);millisecond.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?timeInterval(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):millisecond);var milliseconds=millisecond.range,durationSecond=1e3,durationMinute=durationSecond*60,durationHour=durationMinute*60,durationDay=durationHour*24,durationWeek=durationDay*7,durationMonth=durationDay*30,durationYear=durationDay*365,second=timeInterval(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*durationSecond)},(e,t)=>(t-e)/durationSecond,e=>e.getUTCSeconds()),seconds=second.range,timeMinute=timeInterval(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*durationSecond)},(e,t)=>{e.setTime(+e+t*durationMinute)},(e,t)=>(t-e)/durationMinute,e=>e.getMinutes()),timeMinutes=timeMinute.range,utcMinute=timeInterval(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*durationMinute)},(e,t)=>(t-e)/durationMinute,e=>e.getUTCMinutes()),utcMinutes=utcMinute.range,timeHour=timeInterval(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*durationSecond-e.getMinutes()*durationMinute)},(e,t)=>{e.setTime(+e+t*durationHour)},(e,t)=>(t-e)/durationHour,e=>e.getHours()),timeHours=timeHour.range,utcHour=timeInterval(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*durationHour)},(e,t)=>(t-e)/durationHour,e=>e.getUTCHours()),utcHours=utcHour.range,timeDay=timeInterval(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*durationMinute)/durationDay,e=>e.getDate()-1),timeDays=timeDay.range,utcDay=timeInterval(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/durationDay,e=>e.getUTCDate()-1),utcDays=utcDay.range,unixDay=timeInterval(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/durationDay,e=>Math.floor(e/durationDay)),unixDays=unixDay.range;function timeWeekday(e){return timeInterval(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*durationMinute)/durationWeek)}var timeSunday=timeWeekday(0),timeMonday=timeWeekday(1),timeTuesday=timeWeekday(2),timeWednesday=timeWeekday(3),timeThursday=timeWeekday(4),timeFriday=timeWeekday(5),timeSaturday=timeWeekday(6),timeSundays=timeSunday.range,timeMondays=timeMonday.range,timeTuesdays=timeTuesday.range,timeWednesdays=timeWednesday.range,timeThursdays=timeThursday.range,timeFridays=timeFriday.range,timeSaturdays=timeSaturday.range;function utcWeekday(e){return timeInterval(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/durationWeek)}var utcSunday=utcWeekday(0),utcMonday=utcWeekday(1),utcTuesday=utcWeekday(2),utcWednesday=utcWeekday(3),utcThursday=utcWeekday(4),utcFriday=utcWeekday(5),utcSaturday=utcWeekday(6),utcSundays=utcSunday.range,utcMondays=utcMonday.range,utcTuesdays=utcTuesday.range,utcWednesdays=utcWednesday.range,utcThursdays=utcThursday.range,utcFridays=utcFriday.range,utcSaturdays=utcSaturday.range,timeMonth=timeInterval(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth()),timeMonths=timeMonth.range,utcMonth=timeInterval(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth()),utcMonths=utcMonth.range,timeYear=timeInterval(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());timeYear.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:timeInterval(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});var timeYears=timeYear.range,utcYear=timeInterval(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());utcYear.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:timeInterval(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});var utcYears=utcYear.range;function ticker(e,t,r,i,o,a){const c=[[second,1,durationSecond],[second,5,5*durationSecond],[second,15,15*durationSecond],[second,30,30*durationSecond],[a,1,durationMinute],[a,5,5*durationMinute],[a,15,15*durationMinute],[a,30,30*durationMinute],[o,1,durationHour],[o,3,3*durationHour],[o,6,6*durationHour],[o,12,12*durationHour],[i,1,durationDay],[i,2,2*durationDay],[r,1,durationWeek],[t,1,durationMonth],[t,3,3*durationMonth],[e,1,durationYear]];function u(d,f,m){const g=f<d;g&&([d,f]=[f,d]);const v=m&&typeof m.range=="function"?m:h(d,f,m),_=v?v.range(d,+f+1):[];return g?_.reverse():_}function h(d,f,m){const g=Math.abs(f-d)/m,v=bisector(([,,S])=>S).right(c,g);if(v===c.length)return e.every(tickStep(d/durationYear,f/durationYear,m));if(v===0)return millisecond.every(Math.max(tickStep(d,f,m),1));const[_,b]=c[g/c[v-1][2]<c[v][2]/g?v-1:v];return _.every(b)}return[u,h]}var[utcTicks,utcTickInterval]=ticker(utcYear,utcMonth,utcSunday,unixDay,utcHour,utcMinute),[timeTicks,timeTickInterval]=ticker(timeYear,timeMonth,timeSunday,timeDay,timeHour,timeMinute);function localDate(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function utcDate(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function newDate(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function formatLocale(e){var t=e.dateTime,r=e.date,i=e.time,o=e.periods,a=e.days,c=e.shortDays,u=e.months,h=e.shortMonths,d=formatRe(o),f=formatLookup(o),m=formatRe(a),g=formatLookup(a),v=formatRe(c),_=formatLookup(c),b=formatRe(u),S=formatLookup(u),R=formatRe(h),A=formatLookup(h),I={a:me,A:Se,b:Le,B:xe,c:null,d:formatDayOfMonth,e:formatDayOfMonth,f:formatMicroseconds,g:formatYearISO,G:formatFullYearISO,H:formatHour24,I:formatHour12,j:formatDayOfYear,L:formatMilliseconds,m:formatMonthNumber,M:formatMinutes,p:T,q:k,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatSeconds,u:formatWeekdayNumberMonday,U:formatWeekNumberSunday,V:formatWeekNumberISO,w:formatWeekdayNumberSunday,W:formatWeekNumberMonday,x:null,X:null,y:formatYear,Y:formatFullYear,Z:formatZone,"%":formatLiteralPercent},E={a:D,A:q,b:B,B:se,c:null,d:formatUTCDayOfMonth,e:formatUTCDayOfMonth,f:formatUTCMicroseconds,g:formatUTCYearISO,G:formatUTCFullYearISO,H:formatUTCHour24,I:formatUTCHour12,j:formatUTCDayOfYear,L:formatUTCMilliseconds,m:formatUTCMonthNumber,M:formatUTCMinutes,p:ye,q:we,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatUTCSeconds,u:formatUTCWeekdayNumberMonday,U:formatUTCWeekNumberSunday,V:formatUTCWeekNumberISO,w:formatUTCWeekdayNumberSunday,W:formatUTCWeekNumberMonday,x:null,X:null,y:formatUTCYear,Y:formatUTCFullYear,Z:formatUTCZone,"%":formatLiteralPercent},O={a:W,A:Z,b:ie,B:ue,c:_e,d:parseDayOfMonth,e:parseDayOfMonth,f:parseMicroseconds,g:parseYear,G:parseFullYear,H:parseHour24,I:parseHour24,j:parseDayOfYear,L:parseMilliseconds,m:parseMonthNumber,M:parseMinutes,p:$,q:parseQuarter,Q:parseUnixTimestamp,s:parseUnixTimestampSeconds,S:parseSeconds,u:parseWeekdayNumberMonday,U:parseWeekNumberSunday,V:parseWeekNumberISO,w:parseWeekdayNumberSunday,W:parseWeekNumberMonday,x:Te,X:pe,y:parseYear,Y:parseFullYear,Z:parseZone,"%":parseLiteralPercent};I.x=P(r,I),I.X=P(i,I),I.c=P(t,I),E.x=P(r,E),E.X=P(i,E),E.c=P(t,E);function P(de,be){return function(fe){var he=[],Ne=-1,le=0,Ve=de.length,Be,Ue,je;for(fe instanceof Date||(fe=new Date(+fe));++Ne<Ve;)de.charCodeAt(Ne)===37&&(he.push(de.slice(le,Ne)),(Ue=pads[Be=de.charAt(++Ne)])!=null?Be=de.charAt(++Ne):Ue=Be==="e"?" ":"0",(je=be[Be])&&(Be=je(fe,Ue)),he.push(Be),le=Ne+1);return he.push(de.slice(le,Ne)),he.join("")}}function L(de,be){return function(fe){var he=newDate(1900,void 0,1),Ne=V(he,de,fe+="",0),le,Ve;if(Ne!=fe.length)return null;if("Q"in he)return new Date(he.Q);if("s"in he)return new Date(he.s*1e3+("L"in he?he.L:0));if(be&&!("Z"in he)&&(he.Z=0),"p"in he&&(he.H=he.H%12+he.p*12),he.m===void 0&&(he.m="q"in he?he.q:0),"V"in he){if(he.V<1||he.V>53)return null;"w"in he||(he.w=1),"Z"in he?(le=utcDate(newDate(he.y,0,1)),Ve=le.getUTCDay(),le=Ve>4||Ve===0?utcMonday.ceil(le):utcMonday(le),le=utcDay.offset(le,(he.V-1)*7),he.y=le.getUTCFullYear(),he.m=le.getUTCMonth(),he.d=le.getUTCDate()+(he.w+6)%7):(le=localDate(newDate(he.y,0,1)),Ve=le.getDay(),le=Ve>4||Ve===0?timeMonday.ceil(le):timeMonday(le),le=timeDay.offset(le,(he.V-1)*7),he.y=le.getFullYear(),he.m=le.getMonth(),he.d=le.getDate()+(he.w+6)%7)}else("W"in he||"U"in he)&&("w"in he||(he.w="u"in he?he.u%7:"W"in he?1:0),Ve="Z"in he?utcDate(newDate(he.y,0,1)).getUTCDay():localDate(newDate(he.y,0,1)).getDay(),he.m=0,he.d="W"in he?(he.w+6)%7+he.W*7-(Ve+5)%7:he.w+he.U*7-(Ve+6)%7);return"Z"in he?(he.H+=he.Z/100|0,he.M+=he.Z%100,utcDate(he)):localDate(he)}}function V(de,be,fe,he){for(var Ne=0,le=be.length,Ve=fe.length,Be,Ue;Ne<le;){if(he>=Ve)return-1;if(Be=be.charCodeAt(Ne++),Be===37){if(Be=be.charAt(Ne++),Ue=O[Be in pads?be.charAt(Ne++):Be],!Ue||(he=Ue(de,fe,he))<0)return-1}else if(Be!=fe.charCodeAt(he++))return-1}return he}function $(de,be,fe){var he=d.exec(be.slice(fe));return he?(de.p=f.get(he[0].toLowerCase()),fe+he[0].length):-1}function W(de,be,fe){var he=v.exec(be.slice(fe));return he?(de.w=_.get(he[0].toLowerCase()),fe+he[0].length):-1}function Z(de,be,fe){var he=m.exec(be.slice(fe));return he?(de.w=g.get(he[0].toLowerCase()),fe+he[0].length):-1}function ie(de,be,fe){var he=R.exec(be.slice(fe));return he?(de.m=A.get(he[0].toLowerCase()),fe+he[0].length):-1}function ue(de,be,fe){var he=b.exec(be.slice(fe));return he?(de.m=S.get(he[0].toLowerCase()),fe+he[0].length):-1}function _e(de,be,fe){return V(de,t,be,fe)}function Te(de,be,fe){return V(de,r,be,fe)}function pe(de,be,fe){return V(de,i,be,fe)}function me(de){return c[de.getDay()]}function Se(de){return a[de.getDay()]}function Le(de){return h[de.getMonth()]}function xe(de){return u[de.getMonth()]}function T(de){return o[+(de.getHours()>=12)]}function k(de){return 1+~~(de.getMonth()/3)}function D(de){return c[de.getUTCDay()]}function q(de){return a[de.getUTCDay()]}function B(de){return h[de.getUTCMonth()]}function se(de){return u[de.getUTCMonth()]}function ye(de){return o[+(de.getUTCHours()>=12)]}function we(de){return 1+~~(de.getUTCMonth()/3)}return{format:function(de){var be=P(de+="",I);return be.toString=function(){return de},be},parse:function(de){var be=L(de+="",!1);return be.toString=function(){return de},be},utcFormat:function(de){var be=P(de+="",E);return be.toString=function(){return de},be},utcParse:function(de){var be=L(de+="",!0);return be.toString=function(){return de},be}}}var pads={"-":"",_:" ",0:"0"},numberRe=/^\s*\d+/,percentRe=/^%/,requoteRe=/[\\^$*+?|[\]().{}]/g;function pad(e,t,r){var i=e<0?"-":"",o=(i?-e:e)+"",a=o.length;return i+(a<r?new Array(r-a+1).join(t)+o:o)}function requote(e){return e.replace(requoteRe,"\\$&")}function formatRe(e){return new RegExp("^(?:"+e.map(requote).join("|")+")","i")}function formatLookup(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function parseWeekdayNumberSunday(e,t,r){var i=numberRe.exec(t.slice(r,r+1));return i?(e.w=+i[0],r+i[0].length):-1}function parseWeekdayNumberMonday(e,t,r){var i=numberRe.exec(t.slice(r,r+1));return i?(e.u=+i[0],r+i[0].length):-1}function parseWeekNumberSunday(e,t,r){var i=numberRe.exec(t.slice(r,r+2));return i?(e.U=+i[0],r+i[0].length):-1}function parseWeekNumberISO(e,t,r){var i=numberRe.exec(t.slice(r,r+2));return i?(e.V=+i[0],r+i[0].length):-1}function parseWeekNumberMonday(e,t,r){var i=numberRe.exec(t.slice(r,r+2));return i?(e.W=+i[0],r+i[0].length):-1}function parseFullYear(e,t,r){var i=numberRe.exec(t.slice(r,r+4));return i?(e.y=+i[0],r+i[0].length):-1}function parseYear(e,t,r){var i=numberRe.exec(t.slice(r,r+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),r+i[0].length):-1}function parseZone(e,t,r){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),r+i[0].length):-1}function parseQuarter(e,t,r){var i=numberRe.exec(t.slice(r,r+1));return i?(e.q=i[0]*3-3,r+i[0].length):-1}function parseMonthNumber(e,t,r){var i=numberRe.exec(t.slice(r,r+2));return i?(e.m=i[0]-1,r+i[0].length):-1}function parseDayOfMonth(e,t,r){var i=numberRe.exec(t.slice(r,r+2));return i?(e.d=+i[0],r+i[0].length):-1}function parseDayOfYear(e,t,r){var i=numberRe.exec(t.slice(r,r+3));return i?(e.m=0,e.d=+i[0],r+i[0].length):-1}function parseHour24(e,t,r){var i=numberRe.exec(t.slice(r,r+2));return i?(e.H=+i[0],r+i[0].length):-1}function parseMinutes(e,t,r){var i=numberRe.exec(t.slice(r,r+2));return i?(e.M=+i[0],r+i[0].length):-1}function parseSeconds(e,t,r){var i=numberRe.exec(t.slice(r,r+2));return i?(e.S=+i[0],r+i[0].length):-1}function parseMilliseconds(e,t,r){var i=numberRe.exec(t.slice(r,r+3));return i?(e.L=+i[0],r+i[0].length):-1}function parseMicroseconds(e,t,r){var i=numberRe.exec(t.slice(r,r+6));return i?(e.L=Math.floor(i[0]/1e3),r+i[0].length):-1}function parseLiteralPercent(e,t,r){var i=percentRe.exec(t.slice(r,r+1));return i?r+i[0].length:-1}function parseUnixTimestamp(e,t,r){var i=numberRe.exec(t.slice(r));return i?(e.Q=+i[0],r+i[0].length):-1}function parseUnixTimestampSeconds(e,t,r){var i=numberRe.exec(t.slice(r));return i?(e.s=+i[0],r+i[0].length):-1}function formatDayOfMonth(e,t){return pad(e.getDate(),t,2)}function formatHour24(e,t){return pad(e.getHours(),t,2)}function formatHour12(e,t){return pad(e.getHours()%12||12,t,2)}function formatDayOfYear(e,t){return pad(1+timeDay.count(timeYear(e),e),t,3)}function formatMilliseconds(e,t){return pad(e.getMilliseconds(),t,3)}function formatMicroseconds(e,t){return formatMilliseconds(e,t)+"000"}function formatMonthNumber(e,t){return pad(e.getMonth()+1,t,2)}function formatMinutes(e,t){return pad(e.getMinutes(),t,2)}function formatSeconds(e,t){return pad(e.getSeconds(),t,2)}function formatWeekdayNumberMonday(e){var t=e.getDay();return t===0?7:t}function formatWeekNumberSunday(e,t){return pad(timeSunday.count(timeYear(e)-1,e),t,2)}function dISO(e){var t=e.getDay();return t>=4||t===0?timeThursday(e):timeThursday.ceil(e)}function formatWeekNumberISO(e,t){return e=dISO(e),pad(timeThursday.count(timeYear(e),e)+(timeYear(e).getDay()===4),t,2)}function formatWeekdayNumberSunday(e){return e.getDay()}function formatWeekNumberMonday(e,t){return pad(timeMonday.count(timeYear(e)-1,e),t,2)}function formatYear(e,t){return pad(e.getFullYear()%100,t,2)}function formatYearISO(e,t){return e=dISO(e),pad(e.getFullYear()%100,t,2)}function formatFullYear(e,t){return pad(e.getFullYear()%1e4,t,4)}function formatFullYearISO(e,t){var r=e.getDay();return e=r>=4||r===0?timeThursday(e):timeThursday.ceil(e),pad(e.getFullYear()%1e4,t,4)}function formatZone(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+pad(t/60|0,"0",2)+pad(t%60,"0",2)}function formatUTCDayOfMonth(e,t){return pad(e.getUTCDate(),t,2)}function formatUTCHour24(e,t){return pad(e.getUTCHours(),t,2)}function formatUTCHour12(e,t){return pad(e.getUTCHours()%12||12,t,2)}function formatUTCDayOfYear(e,t){return pad(1+utcDay.count(utcYear(e),e),t,3)}function formatUTCMilliseconds(e,t){return pad(e.getUTCMilliseconds(),t,3)}function formatUTCMicroseconds(e,t){return formatUTCMilliseconds(e,t)+"000"}function formatUTCMonthNumber(e,t){return pad(e.getUTCMonth()+1,t,2)}function formatUTCMinutes(e,t){return pad(e.getUTCMinutes(),t,2)}function formatUTCSeconds(e,t){return pad(e.getUTCSeconds(),t,2)}function formatUTCWeekdayNumberMonday(e){var t=e.getUTCDay();return t===0?7:t}function formatUTCWeekNumberSunday(e,t){return pad(utcSunday.count(utcYear(e)-1,e),t,2)}function UTCdISO(e){var t=e.getUTCDay();return t>=4||t===0?utcThursday(e):utcThursday.ceil(e)}function formatUTCWeekNumberISO(e,t){return e=UTCdISO(e),pad(utcThursday.count(utcYear(e),e)+(utcYear(e).getUTCDay()===4),t,2)}function formatUTCWeekdayNumberSunday(e){return e.getUTCDay()}function formatUTCWeekNumberMonday(e,t){return pad(utcMonday.count(utcYear(e)-1,e),t,2)}function formatUTCYear(e,t){return pad(e.getUTCFullYear()%100,t,2)}function formatUTCYearISO(e,t){return e=UTCdISO(e),pad(e.getUTCFullYear()%100,t,2)}function formatUTCFullYear(e,t){return pad(e.getUTCFullYear()%1e4,t,4)}function formatUTCFullYearISO(e,t){var r=e.getUTCDay();return e=r>=4||r===0?utcThursday(e):utcThursday.ceil(e),pad(e.getUTCFullYear()%1e4,t,4)}function formatUTCZone(){return"+0000"}function formatLiteralPercent(){return"%"}function formatUnixTimestamp(e){return+e}function formatUnixTimestampSeconds(e){return Math.floor(+e/1e3)}var locale2,timeFormat,timeParse,utcFormat,utcParse;defaultLocale2({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function defaultLocale2(e){return locale2=formatLocale(e),timeFormat=locale2.format,timeParse=locale2.parse,utcFormat=locale2.utcFormat,utcParse=locale2.utcParse,locale2}function date(e){return new Date(e)}function number4(e){return e instanceof Date?+e:+new Date(+e)}function calendar(e,t,r,i,o,a,c,u,h,d){var f=continuous(),m=f.invert,g=f.domain,v=d(".%L"),_=d(":%S"),b=d("%I:%M"),S=d("%I %p"),R=d("%a %d"),A=d("%b %d"),I=d("%B"),E=d("%Y");function O(P){return(h(P)<P?v:u(P)<P?_:c(P)<P?b:a(P)<P?S:i(P)<P?o(P)<P?R:A:r(P)<P?I:E)(P)}return f.invert=function(P){return new Date(m(P))},f.domain=function(P){return arguments.length?g(Array.from(P,number4)):g().map(date)},f.ticks=function(P){var L=g();return e(L[0],L[L.length-1],P??10)},f.tickFormat=function(P,L){return L==null?O:d(L)},f.nice=function(P){var L=g();return(!P||typeof P.range!="function")&&(P=t(L[0],L[L.length-1],P??10)),P?g(nice(L,P)):f},f.copy=function(){return copy(f,calendar(e,t,r,i,o,a,c,u,h,d))},f}function utcTime(){return initRange.apply(calendar(utcTicks,utcTickInterval,utcYear,utcMonth,utcSunday,utcDay,utcHour,utcMinute,second,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Transform(e,t,r){this.k=e,this.x=t,this.y=r}Transform.prototype={constructor:Transform,scale:function(e){return e===1?this:new Transform(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Transform(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var identity3=new Transform(1,0,0);transform.prototype=Transform.prototype;function transform(e){for(;!e.__zoom;)if(!(e=e.parentNode))return identity3;return e.__zoom}var import_es_error_cause85=__toESM(require_es_error_cause(),1),import_es_array_push39=__toESM(require_es_array_push(),1),import_es_set_difference_v215=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v215=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v215=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v215=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v215=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v215=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v215=__toESM(require_es_set_union_v2(),1),import_web_immediate=__toESM(require_web_immediate(),1),element_exports={};__export(element_exports,{HTML_CHARACTERS:()=>HTML_CHARACTERS,addClass:()=>addClass,addEvent:()=>addEvent,clearTextSelection:()=>clearTextSelection,closest:()=>closest,closestDown:()=>closestDown,empty:()=>empty2,fastInnerHTML:()=>fastInnerHTML,fastInnerText:()=>fastInnerText,getCaretPosition:()=>getCaretPosition,getComputedStyle:()=>getComputedStyle3,getCssTransform:()=>getCssTransform,getFrameElement:()=>getFrameElement,getMaximumScrollLeft:()=>getMaximumScrollLeft,getMaximumScrollTop:()=>getMaximumScrollTop,getParent:()=>getParent,getParentWindow:()=>getParentWindow,getScrollLeft:()=>getScrollLeft,getScrollTop:()=>getScrollTop,getScrollableElement:()=>getScrollableElement,getScrollbarWidth:()=>getScrollbarWidth,getSelectionEndPosition:()=>getSelectionEndPosition,getSelectionText:()=>getSelectionText,getStyle:()=>getStyle2,getTrimmingContainer:()=>getTrimmingContainer,getWindowScrollLeft:()=>getWindowScrollLeft,getWindowScrollTop:()=>getWindowScrollTop,hasAccessToParentWindow:()=>hasAccessToParentWindow,hasClass:()=>hasClass,hasHorizontalScrollbar:()=>hasHorizontalScrollbar,hasVerticalScrollbar:()=>hasVerticalScrollbar,index:()=>index,innerHeight:()=>innerHeight,innerWidth:()=>innerWidth,isChildOf:()=>isChildOf,isDetached:()=>isDetached,isInput:()=>isInput,isOutsideInput:()=>isOutsideInput,isThisHotChild:()=>isThisHotChild,isVisible:()=>isVisible,makeElementContentEditableAndSelectItsContent:()=>makeElementContentEditableAndSelectItsContent,matchesCSSRules:()=>matchesCSSRules,observeVisibilityChangeOnce:()=>observeVisibilityChangeOnce,offset:()=>offset,outerHeight:()=>outerHeight,outerWidth:()=>outerWidth,overlayContainsElement:()=>overlayContainsElement,removeAttribute:()=>removeAttribute,removeClass:()=>removeClass,removeContentEditableFromElementAndDeselect:()=>removeContentEditableFromElementAndDeselect,removeEvent:()=>removeEvent,removeTextNodes:()=>removeTextNodes,resetCssTransform:()=>resetCssTransform,runWithSelectedContendEditableElement:()=>runWithSelectedContendEditableElement,selectElementIfAllowed:()=>selectElementIfAllowed,setAttribute:()=>setAttribute,setCaretPosition:()=>setCaretPosition,setOverlayPosition:()=>setOverlayPosition});var import_es_error_cause=__toESM(require_es_error_cause(),1),import_es_array_push3=__toESM(require_es_array_push(),1),string_exports={};__export(string_exports,{equalsIgnoreCase:()=>equalsIgnoreCase,isPercentValue:()=>isPercentValue,randomString:()=>randomString,sanitize:()=>sanitize,stripTags:()=>stripTags,substitute:()=>substitute,toUpperCaseFirst:()=>toUpperCaseFirst});var import_es_array_push2=__toESM(require_es_array_push(),1),import_dompurify=__toESM(require_purify(),1),mixed_exports={};__export(mixed_exports,{_injectProductInfo:()=>_injectProductInfo,isDefined:()=>isDefined,isEmpty:()=>isEmpty,isRegExp:()=>isRegExp,isUndefined:()=>isUndefined,stringify:()=>stringify});var import_moment=__toESM(require_moment(),1),array_exports={};__export(array_exports,{arrayAvg:()=>arrayAvg,arrayEach:()=>arrayEach,arrayFilter:()=>arrayFilter,arrayFlatten:()=>arrayFlatten,arrayMap:()=>arrayMap,arrayMax:()=>arrayMax,arrayMin:()=>arrayMin,arrayReduce:()=>arrayReduce,arraySum:()=>arraySum,arrayUnique:()=>arrayUnique,extendArray:()=>extendArray,getDifferenceOfArrays:()=>getDifferenceOfArrays,getIntersectionOfArrays:()=>getIntersectionOfArrays,getUnionOfArrays:()=>getUnionOfArrays,pivot:()=>pivot,stringToArray:()=>stringToArray,to2dArray:()=>to2dArray});var import_es_array_push=__toESM(require_es_array_push(),1),import_es_set_difference_v2=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v2=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v2=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v2=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v2=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v2=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v2=__toESM(require_es_set_union_v2(),1);function to2dArray(e){const t=e.length;let r=0;for(;r<t;)e[r]=[e[r]],r+=1}function extendArray(e,t){const r=t.length;let i=0;for(;i<r;)e.push(t[i]),i+=1}function pivot(e){const t=[];if(!e||e.length===0||!e[0]||e[0].length===0)return t;const r=e.length,i=e[0].length;for(let o=0;o<r;o++)for(let a=0;a<i;a++)t[a]||(t[a]=[]),t[a][o]=e[o][a];return t}function arrayReduce(e,t,r,i){let o=-1,a=e,c=r;Array.isArray(e)||(a=Array.from(e));const u=a.length;for(i&&u&&(o+=1,c=a[o]),o+=1;o<u;)c=t(c,a[o],o,a),o+=1;return c}function arrayFilter(e,t){let r=0,i=e;Array.isArray(e)||(i=Array.from(e));const o=i.length,a=[];let c=-1;for(;r<o;){const u=i[r];t(u,r,i)&&(c+=1,a[c]=u),r+=1}return a}function arrayMap(e,t){let r=0,i=e;Array.isArray(e)||(i=Array.from(e));const o=i.length,a=[];let c=-1;for(;r<o;){const u=i[r];c+=1,a[c]=t(u,r,i),r+=1}return a}function arrayEach(e,t){let r=0,i=e;Array.isArray(e)||(i=Array.from(e));const o=i.length;for(;r<o&&t(i[r],r,i)!==!1;)r+=1;return e}function arraySum(e){return arrayReduce(e,(t,r)=>t+r,0)}function arrayMax(e){return arrayReduce(e,(t,r)=>t>r?t:r,Array.isArray(e)?e[0]:void 0)}function arrayMin(e){return arrayReduce(e,(t,r)=>t<r?t:r,Array.isArray(e)?e[0]:void 0)}function arrayAvg(e){return e.length?arraySum(e)/e.length:0}function arrayFlatten(e){return arrayReduce(e,(t,r)=>t.concat(Array.isArray(r)?arrayFlatten(r):r),[])}function arrayUnique(e){const t=[];return arrayEach(e,r=>{t.indexOf(r)===-1&&t.push(r)}),t}function getDifferenceOfArrays(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[i,...o]=[...t];let a=i;return arrayEach(o,c=>{a=a.filter(u=>!c.includes(u))}),a}function getIntersectionOfArrays(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[i,...o]=[...t];let a=i;return arrayEach(o,c=>{a=a.filter(u=>c.includes(u))}),a}function getUnionOfArrays(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[i,...o]=[...t],a=new Set(i);return arrayEach(o,c=>{arrayEach(c,u=>{a.has(u)||a.add(u)})}),Array.from(a)}function stringToArray(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return e.split(t)}function toSingleLine(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return arrayReduce(e,(a,c,u)=>{const h=c.replace(/\r?\n\s*/g,""),d=r[u]?r[u]:"";return a+h+d},"").trim()}function stringify(e){let t;switch(typeof e){case"string":case"number":t=`${e}`;break;case"object":t=e===null?"":e.toString();break;case"undefined":t="";break;default:t=e.toString();break}return t}function isDefined(e){return typeof e<"u"}function isUndefined(e){return typeof e>"u"}function isEmpty(e){return e===null||e===""||isUndefined(e)}function isRegExp(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var _m="length",_hd=e=>parseInt(e,16),_pi=e=>parseInt(e,10),_ss=(e,t,r)=>e.substr(t,r),_cp=e=>e.codePointAt(0)-65,_norm=e=>`${e}`.replace(/\-/g,""),_extractTime=e=>_hd(_ss(_norm(e),_hd("12"),_cp("F")))/(_hd(_ss(_norm(e),_cp("B"),~~![][_m]))||9),_ignored=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host),_notified=!1,consoleMessages={invalid:()=>toSingleLine`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:e=>{let{keyValidityDate:t,hotVersion:r}=e;return toSingleLine`
    The license key for Handsontable expired on ${t}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${t}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>toSingleLine`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},domMessages={invalid:()=>toSingleLine`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:e=>{let{keyValidityDate:t,hotVersion:r}=e;return toSingleLine`
    The license key for Handsontable expired on ${t}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${t}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>toSingleLine`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function _injectProductInfo(e,t){const r=!isEmpty(e),i=typeof e=="string"&&e.toLowerCase()==="non-commercial-and-evaluation",o="14.6.1";let a,c="invalid",u="invalid";e=_norm(e||"");const h=_checkKeySchema(e);if(r||i||h)if(h){const d=(0,import_moment.default)("17/10/2024","DD/MM/YYYY"),f=Math.floor(d.toDate().getTime()/864e5),m=_extractTime(e);a=(0,import_moment.default)((m+1)*864e5,"x").format("MMMM DD, YYYY"),f>m?(c="expired",u="expired"):(c="valid",u="valid")}else i?(c="non_commercial",u="valid"):(c="invalid",u="invalid");else c="missing",u="missing";if(_ignored()&&(c="valid",u="valid"),!_notified&&c!=="valid"&&(consoleMessages[c]({keyValidityDate:a,hotVersion:o})&&console[c==="non_commercial"?"info":"warn"](consoleMessages[c]({keyValidityDate:a,hotVersion:o})),_notified=!0),u!=="valid"&&t.parentNode&&domMessages[u]({keyValidityDate:a,hotVersion:o})){const f=document.createElement("div");f.className="hot-display-license-info",f.innerHTML=domMessages[u]({keyValidityDate:a,hotVersion:o}),t.parentNode.insertBefore(f,t.nextSibling)}}function _checkKeySchema(e){let t=[][_m],r=t;if(e[_m]!==_cp("Z"))return!1;for(let i="",o="B<H4P+".split(""),a=_cp(o.shift());a;a=_cp(o.shift()||"A"))--a<""[_m]?r=r|(_pi(`${_pi(_hd(i)+(_hd(_ss(e,Math.abs(a),2))+[]).padStart(2,"0"))}`)%97||2)>>1:i=_ss(e,a,a?o[_m]===1?9:8:6);return r===t}function toUpperCaseFirst(e){return e[0].toUpperCase()+e.substr(1)}function equalsIgnoreCase(){const e=[];for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];let o=r.length;for(;o;){o-=1;const a=stringify(r[o]).toLowerCase();e.indexOf(a)===-1&&e.push(a)}return e.length===1}function randomString(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function isPercentValue(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function substitute(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${e}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,i)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):t[i]===void 0?"":t[i])}function stripTags(e){return sanitize(`${e}`,{ALLOWED_TAGS:[]})}function sanitize(e,t){return import_dompurify.default.sanitize(e,t)}var A11Y_TABINDEX=e=>["tabindex",e],A11Y_TREEGRID=()=>["role","treegrid"],A11Y_PRESENTATION=()=>["role","presentation"],A11Y_GRIDCELL=()=>["role","gridcell"],A11Y_ROWHEADER=()=>["role","rowheader"],A11Y_ROWGROUP=()=>["role","rowgroup"],A11Y_COLUMNHEADER=()=>["role","columnheader"],A11Y_ROW=()=>["role","row"],A11Y_MENU=()=>["role","menu"],A11Y_MENU_ITEM=()=>["role","menuitem"],A11Y_MENU_ITEM_CHECKBOX=()=>["role","menuitemcheckbox"],A11Y_COMBOBOX=()=>["role","combobox"],A11Y_LISTBOX=()=>["role","listbox"],A11Y_OPTION=()=>["role","option"],A11Y_CHECKBOX=()=>["role","checkbox"],A11Y_SCOPE_COL=()=>["scope","col"],A11Y_SCOPE_ROW=()=>["scope","row"],A11Y_TEXT=()=>["type","text"],A11Y_LABEL=e=>["aria-label",e],A11Y_HIDDEN=()=>["aria-hidden","true"],A11Y_DISABLED=()=>["aria-disabled","true"],A11Y_MULTISELECTABLE=()=>["aria-multiselectable","true"],A11Y_HASPOPUP=e=>["aria-haspopup",e],A11Y_ROWCOUNT=e=>["aria-rowcount",e],A11Y_COLCOUNT=e=>["aria-colcount",e],A11Y_ROWINDEX=e=>["aria-rowindex",e],A11Y_COLINDEX=e=>["aria-colindex",e],A11Y_EXPANDED=e=>["aria-expanded",e],A11Y_SORT=e=>["aria-sort",e],A11Y_READONLY=()=>["aria-readonly","true"],A11Y_INVALID=()=>["aria-invalid","true"],A11Y_CHECKED=e=>["aria-checked",e],A11Y_SELECTED=()=>["aria-selected","true"],A11Y_AUTOCOMPLETE=()=>["aria-autocomplete","list"],A11Y_CONTROLS=e=>["aria-controls",e],A11Y_ACTIVEDESCENDANT=e=>["aria-activedescendant",e],A11Y_LIVE=e=>["aria-live",e],A11Y_RELEVANT=e=>["aria-relevant",e],A11Y_SETSIZE=e=>["aria-setsize",e],A11Y_POSINSET=e=>["aria-posinset",e];function getParent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,i=null,o=e;for(;o!==null;){if(r===t){i=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(r+=1,o=o.parentNode)}return i}function isThisHotChild(e,t){const r=e.closest(".handsontable");return!!r&&(r.parentNode===t||r===t)}function getFrameElement(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function getParentWindow(e){return getFrameElement(e)&&e.parent}function hasAccessToParentWindow(e){return!!Object.getPrototypeOf(e.parent)}function closest(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:i,DOCUMENT_FRAGMENT_NODE:o}=Node;let a=e;for(;a!=null&&a!==r;){const{nodeType:c,nodeName:u}=a;if(c===i&&(t.includes(u)||t.includes(a)))return a;const{host:h}=a;h&&c===o?a=h:a=a.parentNode}return null}function closestDown(e,t,r){const i=[];let o=e;for(;o&&(o=closest(o,t,r),!(!o||r&&!r.contains(o)));)i.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;const a=i.length;return a?i[a-1]:null}function isChildOf(e,t){let r=e.parentNode,i=[];for(typeof t=="string"?e.defaultView?i=Array.prototype.slice.call(e.querySelectorAll(t),0):i=Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):i.push(t);r!==null;){if(i.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function index(e){let t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function overlayContainsElement(e,t,r){const i=r.parentElement.querySelector(`.ht_clone_${e}`);return i?i.contains(t):null}function filterEmptyClassNames(e){return!e||!e.length?[]:e.filter(t=>!!t)}function filterRegexes(e,t){if(!e||!e.length)return t?{regexFree:[],regexes:[]}:[];const r=[],i=[];return i.push(...e.filter(o=>{const a=o instanceof RegExp;return a&&t&&r.push(o),!a})),t?{regexFree:i,regexes:r}:i}function hasClass(e,t){return e.classList===void 0||typeof t!="string"||t===""?!1:e.classList.contains(t)}function addClass(e,t){typeof t=="string"&&(t=t.split(" ")),t=filterEmptyClassNames(t),t.length>0&&e.classList.add(...t)}function removeClass(e,t){typeof t=="string"?t=t.split(" "):t instanceof RegExp&&(t=[t]);let{regexFree:r,regexes:i}=filterRegexes(t,!0);r=filterEmptyClassNames(r),r.length>0&&e.classList.remove(...r),i.forEach(o=>{e.classList.forEach(a=>{o.test(a)&&e.classList.remove(a)})})}function setAttribute(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(t)||(t=[[t,r]]),t.forEach(i=>{Array.isArray(i)&&i[0]!==""&&e.setAttribute(...i)})}function removeAttribute(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof t=="string"?t=t.split(" "):t instanceof RegExp&&(t=[t]);const{regexFree:r,regexes:i}=filterRegexes(t,!0);r.forEach(o=>{o!==""&&e.removeAttribute(o)}),i.forEach(o=>{e.getAttributeNames().forEach(a=>{o.test(a)&&e.removeAttribute(a)})})}function removeTextNodes(e){if(e.nodeType===3)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1){const t=e.childNodes;for(let r=t.length-1;r>=0;r--)removeTextNodes(t[r])}}function empty2(e){let t;for(;t=e.lastChild;)e.removeChild(t)}var HTML_CHARACTERS=/(<(.*)>|&(.*);)/;function fastInnerHTML(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;HTML_CHARACTERS.test(t)?e.innerHTML=r?sanitize(t):t:fastInnerText(e,t)}function fastInnerText(e,t){const r=e.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=t:(empty2(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function isVisible(e){const t=e.ownerDocument.documentElement;let r=e;for(;r!==t;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return isVisible(r.host.impl);if(r.host)return isVisible(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(getComputedStyle3(r).display==="none")return!1;r=r.parentNode}return!0}function offset(e){const t=e.ownerDocument,r=t.defaultView,i=t.documentElement;let o=e,a,c,u;for(a=o.offsetLeft,c=o.offsetTop,u=o;(o=o.offsetParent)&&!(o===t.body||!("offsetLeft"in o));)a+=o.offsetLeft,c+=o.offsetTop,u=o;return u&&u.style.position==="fixed"&&(a+=r.pageXOffset||i.scrollLeft,c+=r.pageYOffset||i.scrollTop),{left:a,top:c}}function getWindowScrollTop(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function getWindowScrollLeft(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function getScrollTop(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?getWindowScrollTop(t):e.scrollTop}function getScrollLeft(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e===t?getWindowScrollLeft(t):e.scrollLeft}function getScrollableElement(e){let t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);const i=["auto","scroll"];let o=e.parentNode;for(;o&&o.style&&t.body!==o;){let{overflow:a,overflowX:c,overflowY:u}=o.style;if([a,c,u].includes("scroll"))return o;if({overflow:a,overflowX:c,overflowY:u}=r.getComputedStyle(o),i.includes(a)||i.includes(c)||i.includes(u)||o.clientHeight<=o.scrollHeight+1&&(i.includes(u)||i.includes(a))||o.clientWidth<=o.scrollWidth+1&&(i.includes(c)||i.includes(a)))return o;o=o.parentNode}return r}function getMaximumScrollTop(e){return e.scrollHeight-e.clientHeight}function getMaximumScrollLeft(e){return e.scrollWidth-e.clientWidth}function getTrimmingContainer(e){const t=e.ownerDocument,r=t.defaultView;let i=e.parentNode;for(;i&&i.style&&t.body!==i;){if(i.style.overflow!=="visible"&&i.style.overflow!=="")return i;const o=getComputedStyle3(i,r),a=["scroll","hidden","auto"],c=o.getPropertyValue("overflow"),u=o.getPropertyValue("overflow-y"),h=o.getPropertyValue("overflow-x");if(a.includes(c)||a.includes(u)||a.includes(h))return i;i=i.parentNode}return r}function getStyle2(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(e){if(e===r)return t==="width"?`${r.innerWidth}px`:t==="height"?`${r.innerHeight}px`:void 0}else return;const i=e.style[t];if(i!==""&&i!==void 0)return i;const o=getComputedStyle3(e,r);if(o[t]!==""&&o[t]!==void 0)return o[t]}function matchesCSSRules(e,t){const{selectorText:r}=t;let i=!1;return t.type===CSSRule.STYLE_RULE&&r&&(e.msMatchesSelector?i=e.msMatchesSelector(r):e.matches&&(i=e.matches(r))),i}function getComputedStyle3(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function outerWidth(e){return e.offsetWidth}function outerHeight(e){return e.offsetHeight}function innerHeight(e){return e.clientHeight||e.innerHeight}function innerWidth(e){return e.clientWidth||e.innerWidth}function addEvent(e,t,r){e.addEventListener(t,r,!1)}function removeEvent(e,t,r){e.removeEventListener(t,r,!1)}function getCaretPosition(e){return e.selectionStart?e.selectionStart:0}function getSelectionEndPosition(e){return e.selectionEnd?e.selectionEnd:0}function getSelectionText(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const t=e.document;let r="";return e.getSelection?r=e.getSelection().toString():t.selection&&t.selection.type!=="Control"&&(r=t.selection.createRange().text),r}function clearTextSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;e.getSelection&&(e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges())}function setCaretPosition(e,t,r){if(r===void 0&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch{const o=e.parentNode,a=o.style.display;o.style.display="block",e.setSelectionRange(t,r),o.style.display=a}}}var cachedScrollbarWidth;function walkontableCalculateScrollbarWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const t=e.createElement("div");t.style.height="200px",t.style.width="100%";const r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);const i=t.offsetWidth;r.style.overflow="scroll";let o=t.offsetWidth;return i===o&&(o=r.clientWidth),(e.body||e.documentElement).removeChild(r),i-o}function getScrollbarWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return cachedScrollbarWidth===void 0&&(cachedScrollbarWidth=walkontableCalculateScrollbarWidth(e)),cachedScrollbarWidth}function hasVerticalScrollbar(e){return e.offsetWidth!==e.clientWidth}function hasHorizontalScrollbar(e){return e.offsetHeight!==e.clientHeight}function setOverlayPosition(e,t,r){e.style.transform=`translate3d(${t},${r},0)`}function getCssTransform(e){let t;return e.style.transform&&(t=e.style.transform)!==""?["transform",t]:-1}function resetCssTransform(e){e.style.transform&&e.style.transform!==""&&(e.style.transform="")}function isInput(e){return e&&(["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)>-1||e.contentEditable==="true")}function isOutsideInput(e){return isInput(e)&&e.hasAttribute("data-hot-input")===!1}function selectElementIfAllowed(e){const t=e.ownerDocument.activeElement;isOutsideInput(t)||e.select()}function isDetached(e){return!e.parentNode}function observeVisibilityChangeOnce(e,t){new IntersectionObserver((i,o)=>{i.forEach(a=>{a.isIntersecting&&e.offsetParent!==null&&(t(),o.unobserve(e))})},{root:e.ownerDocument.body}).observe(e)}function makeElementContentEditableAndSelectItsContent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=e.ownerDocument,o=i.createRange(),a=i.defaultView.getSelection();setAttribute(e,"contenteditable",!0),r&&setAttribute(e,...A11Y_HIDDEN()),t&&addClass(e,"invisibleSelection"),o.selectNodeContents(e),a.removeAllRanges(),a.addRange(o)}function removeContentEditableFromElementAndDeselect(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.ownerDocument.defaultView.getSelection();e.hasAttribute("aria-hidden")&&e.removeAttribute("aria-hidden"),r.removeAllRanges(),t&&removeClass(e,"invisibleSelection"),e.removeAttribute("contenteditable")}function runWithSelectedContendEditableElement(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;makeElementContentEditableAndSelectItsContent(e,r),t(),removeContentEditableFromElementAndDeselect(e,r)}var function_exports={};__export(function_exports,{curry:()=>curry,curryRight:()=>curryRight,debounce:()=>debounce2,fastCall:()=>fastCall,isFunction:()=>isFunction2,partial:()=>partial,pipe:()=>pipe,throttle:()=>throttle,throttleAfterHits:()=>throttleAfterHits});function isFunction2(e){return typeof e=="function"}function throttle(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=0;const i={lastCallThrottled:!0};let o=null;function a(){for(var c=arguments.length,u=new Array(c),h=0;h<c;h++)u[h]=arguments[h];const d=Date.now();let f=!1;i.lastCallThrottled=!0,r||(r=d,f=!0);const m=t-(d-r);return f?(i.lastCallThrottled=!1,e.apply(this,u)):(o&&clearTimeout(o),o=setTimeout(()=>{i.lastCallThrottled=!1,e.apply(this,u),r=0,o=void 0},m)),i}return a}function throttleAfterHits(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const i=throttle(e,t);let o=r;function a(){o=r}function c(){for(var u=arguments.length,h=new Array(u),d=0;d<u;d++)h[d]=arguments[d];return o?(o-=1,e.apply(this,h)):i.apply(this,h)}return c.clearHits=a,c}function debounce2(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,i;function o(){for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return r&&clearTimeout(r),r=setTimeout(()=>{i=e.apply(this,c)},t),i}return o}function pipe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[i,...o]=t;return function(){for(var c=arguments.length,u=new Array(c),h=0;h<c;h++)u[h]=arguments[h];return arrayReduce(o,(d,f)=>f(d),i.apply(this,u))}}function partial(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return function(){for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return e.apply(this,r.concat(c))}}function curry(e){const t=e.length;function r(i){return function(){for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];const h=i.concat(c);let d;return h.length>=t?d=e.apply(this,h):d=r(h),d}}return r([])}function curryRight(e){const t=e.length;function r(i){return function(){for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];const h=i.concat(c.reverse());let d;return h.length>=t?d=e.apply(this,h):d=r(h),d}}return r([])}function fastCall(e,t,r,i,o,a,c,u){return isDefined(u)?e.call(t,r,i,o,a,c,u):isDefined(c)?e.call(t,r,i,o,a,c):isDefined(a)?e.call(t,r,i,o,a):isDefined(o)?e.call(t,r,i,o):isDefined(i)?e.call(t,r,i):isDefined(r)?e.call(t,r):e.call(t)}var browser_exports={};__export(browser_exports,{isChrome:()=>isChrome,isChromeWebKit:()=>isChromeWebKit,isEdge:()=>isEdge,isEdgeWebKit:()=>isEdgeWebKit,isFirefox:()=>isFirefox,isFirefoxWebKit:()=>isFirefoxWebKit,isIOS:()=>isIOS,isIpadOS:()=>isIpadOS,isLinuxOS:()=>isLinuxOS,isMacOS:()=>isMacOS,isMobileBrowser:()=>isMobileBrowser,isSafari:()=>isSafari,isWindowsOS:()=>isWindowsOS,setBrowserMeta:()=>setBrowserMeta,setPlatformMeta:()=>setPlatformMeta});var object_exports={};__export(object_exports,{clone:()=>clone3,createObjectPropListener:()=>createObjectPropListener,deepClone:()=>deepClone,deepExtend:()=>deepExtend,deepObjectSize:()=>deepObjectSize,defineGetter:()=>defineGetter,duckSchema:()=>duckSchema,extend:()=>extend2,getProperty:()=>getProperty,hasOwnProperty:()=>hasOwnProperty,inherit:()=>inherit2,isObject:()=>isObject2,isObjectEqual:()=>isObjectEqual,mixin:()=>mixin,objectEach:()=>objectEach,setProperty:()=>setProperty});var import_es_error_cause2=__toESM(require_es_error_cause(),1),import_es_array_push4=__toESM(require_es_array_push(),1),import_es_json_stringify=__toESM(require_es_json_stringify(),1);function duckSchema(e){let t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},objectEach(e,(r,i)=>{i!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?t[i]=duckSchema(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?t[i]=[duckSchema(r[0])]:t[i]=[]:t[i]=null)})),t}function inherit2(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function extend2(e,t,r){const i=Array.isArray(r);return objectEach(t,(o,a)=>{(i===!1||r.includes(a))&&(e[a]=o)}),e}function deepExtend(e,t){objectEach(t,(r,i)=>{t[i]&&typeof t[i]=="object"?(e[i]||(Array.isArray(t[i])?e[i]=[]:Object.prototype.toString.call(t[i])==="[object Date]"?e[i]=t[i]:e[i]={}),deepExtend(e[i],t[i])):e[i]=t[i]})}function deepClone(e){return typeof e=="object"?JSON.parse(JSON.stringify(e)):e}function clone3(e){const t={};return objectEach(e,(r,i)=>{t[i]=r}),t}function mixin(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return arrayEach(r,o=>{e.MIXINS.push(o.MIXIN_NAME),objectEach(o,(a,c)=>{if(e.prototype[c]!==void 0)throw new Error(`Mixin conflict. Property '${c}' already exist and cannot be overwritten.`);if(typeof a=="function")e.prototype[c]=a;else{const u=function(f,m){const g=`_${f}`,v=_=>{let b=_;return(Array.isArray(b)||isObject2(b))&&(b=deepClone(b)),b};return function(){return this[g]===void 0&&(this[g]=v(m)),this[g]}},h=function(f){const m=`_${f}`;return function(g){this[m]=g}};Object.defineProperty(e.prototype,c,{get:u(c,a),set:h(c),configurable:!0})}})}),e}function isObjectEqual(e,t){return JSON.stringify(e)===JSON.stringify(t)}function isObject2(e){return Object.prototype.toString.call(e)==="[object Object]"}function defineGetter(e,t,r,i){i.value=r,i.writable=i.writable!==!1,i.enumerable=i.enumerable!==!1,i.configurable=i.configurable!==!1,Object.defineProperty(e,t,i)}function objectEach(e,t){for(const r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&t(e[r],r,e)===!1)break;return e}function getProperty(e,t){const r=t.split(".");let i=e;return objectEach(r,o=>{if(i=i[o],i===void 0)return i=void 0,!1}),i}function setProperty(e,t,r){const i=t.split(".");let o=e;i.forEach((a,c)=>{c!==i.length-1?(hasOwnProperty(o,a)||(o[a]={}),o=o[a]):o[a]=r})}function deepObjectSize(e){if(!isObject2(e))return 0;const t=function(r){let i=0;return isObject2(r)?objectEach(r,(o,a)=>{a!=="__children"&&(i+=t(o))}):i+=1,i};return t(e)}function createObjectPropListener(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${t}`,i={_touched:!1,[r]:e,isTouched(){return this._touched}};return Object.defineProperty(i,t,{get(){return this[r]},set(o){this._touched=!0,this[r]=o},enumerable:!0,configurable:!0}),i}function hasOwnProperty(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var feature_exports={};__export(feature_exports,{cancelAnimationFrame:()=>cancelAnimationFrame2,getComparisonFunction:()=>getComparisonFunction,isCSR:()=>isCSR,isTouchSupported:()=>isTouchSupported,requestAnimationFrame:()=>requestAnimationFrame2});function requestAnimationFrame2(e){return window.requestAnimationFrame(e)}function cancelAnimationFrame2(e){window.cancelAnimationFrame(e)}function isTouchSupported(){return"ontouchstart"in window}function isCSR(){return typeof window<"u"}var comparisonFunction;function getComparisonFunction(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return comparisonFunction||(typeof Intl=="object"?comparisonFunction=new Intl.Collator(e,t).compare:typeof String.prototype.localeCompare=="function"?comparisonFunction=(r,i)=>`${r}`.localeCompare(i):comparisonFunction=(r,i)=>r===i?0:r>i?-1:1,comparisonFunction)}var tester=e=>{const t={value:!1};return t.test=(r,i)=>{t.value=e(r,i)},t},browsers={chrome:tester((e,t)=>/Chrome/.test(e)&&/Google/.test(t)),chromeWebKit:tester(e=>/CriOS/.test(e)),edge:tester(e=>/Edge/.test(e)),edgeWebKit:tester(e=>/EdgiOS/.test(e)),firefox:tester(e=>/Firefox/.test(e)),firefoxWebKit:tester(e=>/FxiOS/.test(e)),mobile:tester(e=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)),safari:tester((e,t)=>/Safari/.test(e)&&/Apple Computer/.test(t))},platforms={mac:tester(e=>/^Mac/.test(e)),win:tester(e=>/^Win/.test(e)),linux:tester(e=>/^Linux/.test(e)),ios:tester(e=>/iPhone|iPad|iPod/i.test(e))};function setBrowserMeta(){let{userAgent:e=navigator.userAgent,vendor:t=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};objectEach(browsers,r=>{let{test:i}=r;return void i(e,t)})}function setPlatformMeta(){let{platform:e=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};objectEach(platforms,t=>{let{test:r}=t;return void r(e)})}isCSR()&&(setBrowserMeta(),setPlatformMeta());function isChrome(){return browsers.chrome.value}function isChromeWebKit(){return browsers.chromeWebKit.value}function isFirefox(){return browsers.firefox.value}function isFirefoxWebKit(){return browsers.firefoxWebKit.value}function isSafari(){return browsers.safari.value}function isEdge(){return browsers.edge.value}function isEdgeWebKit(){return browsers.edgeWebKit.value}function isMobileBrowser(){return browsers.mobile.value}function isIOS(){return platforms.ios.value}function isIpadOS(){let{maxTouchPoints:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return e>2&&platforms.mac.value}function isWindowsOS(){return platforms.win.value}function isMacOS(){return platforms.mac.value}function isLinuxOS(){return platforms.linux.value}var import_es_error_cause6=__toESM(require_es_error_cause(),1),unicode_exports={};__export(unicode_exports,{KEY_CODES:()=>KEY_CODES,isCtrlKey:()=>isCtrlKey,isCtrlMetaKey:()=>isCtrlMetaKey,isFunctionKey:()=>isFunctionKey,isKey:()=>isKey,isPrintableChar:()=>isPrintableChar});var import_es_array_push5=__toESM(require_es_array_push(),1),KEY_CODES={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:isFirefox()?182:174,AUDIO_MUTE:isFirefox()?181:173,AUDIO_UP:isFirefox()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},FUNCTION_KEYS=[KEY_CODES.ALT,KEY_CODES.ARROW_DOWN,KEY_CODES.ARROW_LEFT,KEY_CODES.ARROW_RIGHT,KEY_CODES.ARROW_UP,KEY_CODES.AUDIO_DOWN,KEY_CODES.AUDIO_MUTE,KEY_CODES.AUDIO_UP,KEY_CODES.BACKSPACE,KEY_CODES.CAPS_LOCK,KEY_CODES.DELETE,KEY_CODES.END,KEY_CODES.ENTER,KEY_CODES.ESCAPE,KEY_CODES.F1,KEY_CODES.F2,KEY_CODES.F3,KEY_CODES.F4,KEY_CODES.F5,KEY_CODES.F6,KEY_CODES.F7,KEY_CODES.F8,KEY_CODES.F9,KEY_CODES.F10,KEY_CODES.F11,KEY_CODES.F12,KEY_CODES.F13,KEY_CODES.F14,KEY_CODES.F15,KEY_CODES.F16,KEY_CODES.F17,KEY_CODES.F18,KEY_CODES.F19,KEY_CODES.HOME,KEY_CODES.INSERT,KEY_CODES.MEDIA_NEXT,KEY_CODES.MEDIA_PLAY_PAUSE,KEY_CODES.MEDIA_PREV,KEY_CODES.MEDIA_STOP,KEY_CODES.NULL,KEY_CODES.NUM_LOCK,KEY_CODES.PAGE_DOWN,KEY_CODES.PAGE_UP,KEY_CODES.PAUSE,KEY_CODES.SCROLL_LOCK,KEY_CODES.SHIFT,KEY_CODES.TAB];function isPrintableChar(e){return e===32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function isFunctionKey(e){return FUNCTION_KEYS.includes(e)}function isCtrlKey(e){const t=[];return isMacOS()?t.push(KEY_CODES.COMMAND_LEFT,KEY_CODES.COMMAND_RIGHT,KEY_CODES.COMMAND_FIREFOX):t.push(KEY_CODES.CONTROL),t.includes(e)}function isCtrlMetaKey(e){return[KEY_CODES.CONTROL,KEY_CODES.COMMAND_LEFT,KEY_CODES.COMMAND_RIGHT,KEY_CODES.COMMAND_FIREFOX].includes(e)}function isKey(e,t){const r=t.split("|");let i=!1;return arrayEach(r,o=>{if(e===KEY_CODES[o])return i=!0,!1}),i}var event_exports={};__export(event_exports,{isImmediatePropagationStopped:()=>isImmediatePropagationStopped,isLeftClick:()=>isLeftClick,isRightClick:()=>isRightClick,isTouchEvent:()=>isTouchEvent,offsetRelativeTo:()=>offsetRelativeTo,stopImmediatePropagation:()=>stopImmediatePropagation});function stopImmediatePropagation(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function isImmediatePropagationStopped(e){return e.isImmediatePropagationEnabled===!1}function isRightClick(e){return e.button===2}function isLeftClick(e){return e.button===0}function isTouchEvent(e){return e instanceof TouchEvent}function offsetRelativeTo(e,t){const r={x:e.offsetX,y:e.offsetY};let i=e.target;if(!(t instanceof HTMLElement)||i!==t&&i.contains(t))return r;for(;i!==t;)r.x+=i.offsetLeft,r.y+=i.offsetTop,i=i.offsetParent;return r}var import_es_error_cause4=__toESM(require_es_error_cause(),1),import_es_error_cause3=__toESM(require_es_error_cause(),1),import_es_array_push6=__toESM(require_es_array_push(),1),import_es_array_unscopables_flat_map=__toESM(require_es_array_unscopables_flat_map(),1);function warn(){isDefined(console)&&console.warn(...arguments)}function error(){isDefined(console)&&console.error(...arguments)}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var REGISTERED_HOOKS=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],REMOVED_MESSAGE=toSingleLine`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,REMOVED_HOOKS=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),DEPRECATED_HOOKS=new Map([[]]),callbackOrder=new WeakMap,Hooks=class{static getSingleton(){return getGlobalSingleton()}constructor(){_defineProperty(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return arrayEach(REGISTERED_HOOKS,t=>{e[t]=[],this.initOrderMap(e,t)}),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;if(Array.isArray(t))arrayEach(t,o=>this.add(e,o,r));else{REMOVED_HOOKS.has(e)&&warn(substitute(REMOVED_MESSAGE,{hookName:e,removedInVersion:REMOVED_HOOKS.get(e)})),DEPRECATED_HOOKS.has(e)&&warn(DEPRECATED_HOOKS.get(e));const o=this.getBucket(r);if(typeof o[e]>"u"&&(this.register(e),o[e]=[],this.initOrderMap(o,e)),t.skip=!1,o[e].indexOf(t)===-1){let a=!1;t.initialHook&&arrayEach(o[e],(c,u)=>{if(c.initialHook)return o[e][u]=t,a=!0,!1}),a||o[e].push(t)}this.setCallbackOrderIndex(o,e,t,i),this.orderBucketByOrderIndex(o,e)}return this}once(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;Array.isArray(t)?arrayEach(t,o=>this.once(e,o,r)):(t.runOnce=!0,this.add(e,t,r,i))}remove(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(r);return typeof i[e]<"u"&&i[e].indexOf(t)>=0?(t.skip=!0,!0):!1}has(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(t);return!!(r[e]!==void 0&&r[e].length)}run(e,t,r,i,o,a,c,u){{const h=this.globalBucket[t],d=h?h.length:0;let f=0;if(d)for(;f<d;){if(!h[f]||h[f].skip){f+=1;continue}const m=fastCall(h[f],e,r,i,o,a,c,u);m!==void 0&&(r=m),h[f]&&h[f].runOnce&&this.remove(t,h[f]),f+=1}}{const h=this.getBucket(e)[t],d=h?h.length:0;let f=0;if(d)for(;f<d;){if(!h[f]||h[f].skip){f+=1;continue}const m=fastCall(h[f],e,r,i,o,a,c,u);m!==void 0&&(r=m),h[f]&&h[f].runOnce&&this.remove(t,h[f],e),f+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;objectEach(this.getBucket(e),(t,r,i)=>i[r].length=0)}register(e){this.isRegistered(e)||REGISTERED_HOOKS.push(e)}deregister(e){this.isRegistered(e)&&REGISTERED_HOOKS.splice(REGISTERED_HOOKS.indexOf(e),1)}isDeprecated(e){return DEPRECATED_HOOKS.has(e)||REMOVED_HOOKS.has(e)}isRegistered(e){return REGISTERED_HOOKS.indexOf(e)>=0}getRegistered(){return REGISTERED_HOOKS}setCallbackOrderIndex(e,t,r,i){const o=Number.isInteger(i)?i:0,a=this.getCallbackOrderMap(e,t);a.set(o,[...a.get(o)||[],r])}orderBucketByOrderIndex(e,t){const r=this.getCallbackOrderMap(e,t);r===void 0||r.size===0||r.size===1&&r.has(0)||(e[t]=[...r].sort((i,o)=>i[0]-o[0]).flatMap(i=>{let[,o]=i;return o}))}initOrderMap(e,t){callbackOrder.has(e)||callbackOrder.set(e,[]),callbackOrder.get(e)[t]=new Map}getCallbackOrderMap(e,t){return callbackOrder.get(e)[t]}},globalSingleton=new Hooks;function getGlobalSingleton(){return globalSingleton}var pluginHooks_default=Hooks,collection=new Map;function staticRegister(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";collection.has(e)||collection.set(e,new Map);const t=collection.get(e);function r(u,h){t.set(u,h)}function i(u){return t.get(u)}function o(u){return t.has(u)}function a(){return[...t.keys()]}function c(){return[...t.values()]}return{register:r,getItem:i,hasItem:o,getNames:a,getValues:c}}var registeredEditorClasses=new WeakMap,{register,getItem,hasItem,getNames,getValues}=staticRegister("editors");function RegisteredEditor(e){const t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(i){return i.guid in t||(t[i.guid]=new r(i)),t[i.guid]},pluginHooks_default.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function _getEditorInstance(e,t){let r;if(typeof e=="function")registeredEditorClasses.get(e)||_register(null,e),r=registeredEditorClasses.get(e);else if(typeof e=="string")r=getItem(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${e}"`);return r.getInstance(t)}function _getItem(e){if(typeof e=="function")return e;if(!hasItem(e))throw Error(`No registered editor found under "${e}" name`);return getItem(e).getConstructor()}function _register(e,t){e&&typeof e!="string"&&(t=e,e=t.EDITOR_TYPE);const r=new RegisteredEditor(t);typeof e=="string"&&register(e,r),registeredEditorClasses.set(t,r)}var import_es_error_cause5=__toESM(require_es_error_cause(),1),import_es_array_push7=__toESM(require_es_array_push(),1);function _defineProperty2(e,t,r){return(t=_toPropertyKey2(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey2(e){var t=_toPrimitive2(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive2(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var listenersCounter=0,EventManager=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;_defineProperty2(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(a){r.call(this,extendEvent(a))}return this.context.eventListeners.push({element:e,event:t,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(t,o,i),listenersCounter+=1,()=>{this.removeEventListener(e,t,r)}}removeEventListener(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,a;for(;o;)if(o-=1,a=this.context.eventListeners[o],a.event===t&&a.element===e){if(r&&r!==a.callback||i&&a.eventManager!==this)continue;this.context.eventListeners.splice(o,1),a.element.removeEventListener(a.event,a.callbackProxy,a.options),listenersCounter-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const r=this.context.eventListeners[t];e&&r.eventManager!==this||(this.context.eventListeners.splice(t,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),listenersCounter-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:t!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let a;r.createEvent?(a=r.createEvent("MouseEvents"),a.initMouseEvent(t,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget||r.body.parentNode)):a=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(a):e.fireEvent(`on${t}`,a)}};function extendEvent(e){const t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),stopImmediatePropagation(this)},e}var eventManager_default=EventManager;function getListenersCounter(){return listenersCounter}function _classPrivateMethodInitSpec(e,t){_checkPrivateRedeclaration(e,t),t.add(e)}function _checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty3(e,t,r){return(t=_toPropertyKey3(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey3(e){var t=_toPrimitive3(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive3(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _EditorManager_brand=new WeakSet,EditorManager=class{constructor(e,t,r){_classPrivateMethodInitSpec(this,_EditorManager_brand),_defineProperty3(this,"hot",void 0),_defineProperty3(this,"tableMeta",void 0),_defineProperty3(this,"selection",void 0),_defineProperty3(this,"eventManager",void 0),_defineProperty3(this,"destroyed",!1),_defineProperty3(this,"activeEditor",void 0),_defineProperty3(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=r,this.eventManager=new eventManager_default(e),this.hot.addHook("afterDocumentKeyDown",i=>_assertClassBrand(_EditorManager_brand,this,_onAfterDocumentKeyDown).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,o,a)=>_assertClassBrand(_EditorManager_brand,this,_onCellDblClick).call(this,i,o,a))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,h=>{h&&this.prepareEditor()});return}const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!t||t.isHeader())return;const{row:r,col:i}=t,o=this.hot.runHooks("modifyGetCellCoords",r,i);let a=r,c=i;if(Array.isArray(o)&&([a,c]=o),this.cellProperties=this.hot.getCellMeta(a,c),!this.isCellEditable()){this.clearActiveEditor();return}const u=this.hot.getCell(r,i,!0);if(u){const h=this.hot.getCellEditor(this.cellProperties),d=this.hot.colToProp(c),f=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(a),c);this.activeEditor=_getEditorInstance(h,this.hot),this.activeEditor.prepare(r,i,d,u,f,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,t,r);if(t instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}closeEditor(e,t,r){this.activeEditor?this.activeEditor.finishEditing(e,t,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const t=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:a}=this.hot,c=o.isHidden(this.hot.toPhysicalRow(r))||a.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!t||c)}moveSelectionAfterEnter(e){const t={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(t.row=-t.row,t.col=-t.col),this.hot.selection.isMultiple()?this.selection.transformFocus(t.row,t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}};function _onAfterDocumentKeyDown(e){const t=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!t||t.highlight.isHeader()||isImmediatePropagationStopped(e))return;const{keyCode:r}=e,i=(e.ctrlKey||e.metaKey)&&!e.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!isFunctionKey(r)&&!isCtrlMetaKey(r)&&!i&&!this.isEditorOpened()&&this.openEditor("",e)}function _onCellDblClick(e,t){t.isCell()&&this.openEditor(null,e,!0)}var instances2=new WeakMap;EditorManager.getInstance=function(e,t,r){let i=instances2.get(e);return i||(i=new EditorManager(e,t,r),instances2.set(e,i)),i};var editorManager_default=EditorManager,import_es_error_cause7=__toESM(require_es_error_cause(),1);function _classPrivateMethodInitSpec2(e,t){_checkPrivateRedeclaration2(e,t),t.add(e)}function _classPrivateFieldInitSpec(e,t,r){_checkPrivateRedeclaration2(e,t),t.set(e,r)}function _checkPrivateRedeclaration2(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet(e,t){return e.get(_assertClassBrand2(e,t))}function _classPrivateFieldSet(e,t,r){return e.set(_assertClassBrand2(e,t),r),r}function _assertClassBrand2(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var FOCUS_MODES=Object.freeze({CELL:"cell",MIXED:"mixed"}),_hot=new WeakMap,_focusMode=new WeakMap,_refocusDelay=new WeakMap,_refocusElementGetter=new WeakMap,_debouncedSelect=new WeakMap,_FocusManager_brand=new WeakSet,FocusManager=class{constructor(e){var t=this;_classPrivateMethodInitSpec2(this,_FocusManager_brand),_classPrivateFieldInitSpec(this,_hot,void 0),_classPrivateFieldInitSpec(this,_focusMode,void 0),_classPrivateFieldInitSpec(this,_refocusDelay,1),_classPrivateFieldInitSpec(this,_refocusElementGetter,null),_classPrivateFieldInitSpec(this,_debouncedSelect,new Map);const r=e.getSettings();_classPrivateFieldSet(_hot,this,e),_classPrivateFieldSet(_focusMode,this,r.imeFastEdit?FOCUS_MODES.MIXED:FOCUS_MODES.CELL),_classPrivateFieldGet(_hot,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _assertClassBrand2(_FocusManager_brand,t,_onUpdateSettings).call(t,...o)}),_classPrivateFieldGet(_hot,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _assertClassBrand2(_FocusManager_brand,t,_focusCell).call(t,...o)}),_classPrivateFieldGet(_hot,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _assertClassBrand2(_FocusManager_brand,t,_focusCell).call(t,...o)}),_classPrivateFieldGet(_hot,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _assertClassBrand2(_FocusManager_brand,t,_focusEditorElement).call(t,...o)})}getFocusMode(){return _classPrivateFieldGet(_focusMode,this)}setFocusMode(e){Object.values(FOCUS_MODES).includes(e)?_classPrivateFieldSet(_focusMode,this,e):warn(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return _classPrivateFieldGet(_refocusDelay,this)}setRefocusDelay(e){_classPrivateFieldSet(_refocusDelay,this,e)}setRefocusElementGetter(e){_classPrivateFieldSet(_refocusElementGetter,this,e)}getRefocusElement(){if(typeof _classPrivateFieldGet(_refocusElementGetter,this)=="function")return _classPrivateFieldGet(_refocusElementGetter,this).call(this);var e;return(e=_classPrivateFieldGet(_hot,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const t=r=>{var i,o;const a=(i=_classPrivateFieldGet(_hot,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!a)return;let c=_classPrivateFieldGet(_hot,this).runHooks("modifyFocusedElement",a.row,a.col,r);c instanceof HTMLElement||(c=r),c&&!((o=_classPrivateFieldGet(_hot,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&c.focus({preventScroll:!0})};e?t(e):_assertClassBrand2(_FocusManager_brand,this,_getSelectedCell).call(this,r=>t(r))}refocusToEditorTextarea(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_classPrivateFieldGet(_refocusDelay,this);const r=this.getRefocusElement();_classPrivateFieldGet(_hot,this).getSettings().imeFastEdit&&!((e=_classPrivateFieldGet(_hot,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&r&&(_classPrivateFieldGet(_debouncedSelect,this).has(t)||_classPrivateFieldGet(_debouncedSelect,this).set(t,debounce2(()=>{r.select()},t)),_classPrivateFieldGet(_debouncedSelect,this).get(t)())}};function _getSelectedCell(e){var t;const r=(t=_classPrivateFieldGet(_hot,this).getSelectedRangeLast())===null||t===void 0?void 0:t.highlight;if(!r||!_classPrivateFieldGet(_hot,this).selection.isCellVisible(r)){e(null);return}const i=_classPrivateFieldGet(_hot,this).getCell(r.row,r.col,!0);i===null?_classPrivateFieldGet(_hot,this).addHookOnce("afterScroll",()=>{e(_classPrivateFieldGet(_hot,this).getCell(r.row,r.col,!0))}):e(i)}function _focusCell(){_assertClassBrand2(_FocusManager_brand,this,_getSelectedCell).call(this,e=>{const{activeElement:t}=_classPrivateFieldGet(_hot,this).rootDocument;t&&isOutsideInput(t)&&t.blur(),this.focusOnHighlightedCell(e)})}function _focusEditorElement(){_assertClassBrand2(_FocusManager_brand,this,_getSelectedCell).call(this,e=>{this.getFocusMode()===FOCUS_MODES.MIXED&&e.nodeName==="TD"&&this.refocusToEditorTextarea()})}function _onUpdateSettings(e){typeof e.imeFastEdit=="boolean"&&this.setFocusMode(e.imeFastEdit?FOCUS_MODES.MIXED:FOCUS_MODES.CELL)}var parseTable_exports={};__export(parseTable_exports,{_dataToHTML:()=>_dataToHTML,htmlToGridSettings:()=>htmlToGridSettings,instanceToHTML:()=>instanceToHTML});var import_es_array_push8=__toESM(require_es_array_push(),1),import_es_string_replace_all=__toESM(require_es_string_replace_all(),1),ESCAPED_HTML_CHARS={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},regEscapedChars=new RegExp(Object.keys(ESCAPED_HTML_CHARS).map(e=>`(${e})`).join("|"),"gi");function isHTMLTable(e){return(e&&e.nodeName||"")==="TABLE"}function instanceToHTML(e){const t=e.hasColHeaders(),r=e.hasRowHeaders(),i=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData(...i),a=o.length,c=a>0?o[0].length:0,u=["<table>","</table>"],h=t?["<thead>","</thead>"]:[],d=["<tbody>","</tbody>"],f=r?1:0,m=t?1:0;for(let g=0;g<a;g+=1){const v=t&&g===0,_=[];for(let S=0;S<c;S+=1){const R=!v&&r&&S===0;let A="";if(v)A=`<th>${e.getColHeader(S-f)}</th>`;else if(R)A=`<th>${e.getRowHeader(g-m)}</th>`;else{const I=o[g][S],{hidden:E,rowspan:O,colspan:P}=e.getCellMeta(g-m,S-f);if(!E){const L=[];if(O&&L.push(`rowspan="${O}"`),P&&L.push(`colspan="${P}"`),isEmpty(I))A=`<td ${L.join(" ")}></td>`;else{const V=I.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");A=`<td ${L.join(" ")}>${V}</td>`}}}_.push(A)}const b=["<tr>",..._,"</tr>"].join("");v?h.splice(1,0,b):d.splice(-1,0,b)}return u.splice(1,0,h.join(""),d.join("")),u.join("")}function _dataToHTML(e){const t=e.length,r=["<table>"];for(let i=0;i<t;i+=1){const o=e[i],a=o.length,c=[];i===0&&r.push("<tbody>");for(let u=0;u<a;u+=1){const h=o[u],d=isEmpty(h)?"":h.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,f=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(f.length-1)} </span>`).replace(/\t/gi,"&#9;");c.push(`<td>${d}</td>`)}r.push("<tr>",...c,"</tr>"),i+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function htmlToGridSettings(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},i=t.createDocumentFragment(),o=t.createElement("div");i.appendChild(o);let a=e;if(typeof a=="string"){const I=a.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,E=>{const O=E.match(/<td\b[^>]*?>/g)[0],P=/<p.*?>/g,L=E.substring(O.length,E.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(P,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${O}${L}</td>`});o.insertAdjacentHTML("afterbegin",`${I}`),a=o.querySelector("table")}if(!a||!isHTMLTable(a))return;const c=o.querySelector('meta[name$="enerator"]'),u=a.querySelector("tbody th")!==null,h=a.querySelector("tr"),d=h?Array.from(h.cells).reduce((I,E)=>I+E.colSpan,0)-(u?1:0):0,f=a.tFoot&&Array.from(a.tFoot.rows)||[],m=[];let g=!1,v=0,_=0;if(a.tHead){const I=Array.from(a.tHead.rows).filter(E=>{const O=E.querySelector("td")!==null;return O&&m.push(E),!O});v=I.length,g=v>0,v>1?r.nestedHeaders=Array.from(I).reduce((E,O)=>{const P=Array.from(O.cells).reduce((L,V,$)=>{if(u&&$===0)return L;const{colSpan:W,innerHTML:Z}=V,ie=W>1?{label:Z,colspan:W}:Z;return L.push(ie),L},[]);return E.push(P),E},[]):g&&(r.colHeaders=Array.from(I[0].children).reduce((E,O,P)=>(u&&P===0||E.push(O.innerHTML),E),[]))}m.length&&(r.fixedRowsTop=m.length),f.length&&(r.fixedRowsBottom=f.length);const b=[...m,...Array.from(a.tBodies).reduce((I,E)=>(I.push(...Array.from(E.rows)),I),[]),...f];_=b.length;const S=new Array(_);for(let I=0;I<_;I++)S[I]=new Array(d);const R=[],A=[];for(let I=0;I<_;I++){const E=b[I],O=Array.from(E.cells),P=O.length;for(let L=0;L<P;L++){const V=O[L],{nodeName:$,innerHTML:W,rowSpan:Z,colSpan:ie}=V,ue=S[I].findIndex(_e=>_e===void 0);if($==="TD"){if(Z>1||ie>1){for(let me=I;me<I+Z;me++)if(me<_)for(let Se=ue;Se<ue+ie;Se++)S[me][Se]=null;const Te=V.getAttribute("style");Te&&Te.includes("mso-ignore:colspan")||R.push({col:ue,row:I,rowspan:Z,colspan:ie})}let _e="";c&&/excel/gi.test(c.content)?_e=W.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):_e=W.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[I][ue]=_e.replace(regEscapedChars,Te=>ESCAPED_HTML_CHARS[Te])}else A.push(W)}}return R.length&&(r.mergeCells=R),A.length&&(r.rowHeaders=A),S.length&&(r.data=S),r}var import_es_error_cause11=__toESM(require_es_error_cause(),1),import_es_error_cause8=__toESM(require_es_error_cause(),1),number_exports={};__export(number_exports,{clamp:()=>clamp,isNumeric:()=>isNumeric,isNumericLike:()=>isNumericLike,rangeEach:()=>rangeEach,rangeEachReverse:()=>rangeEachReverse,valueAccordingPercent:()=>valueAccordingPercent});var import_es_set_difference_v22=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v22=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v22=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v22=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v22=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v22=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v22=__toESM(require_es_set_union_v2(),1);function isNumeric(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof e;if(r==="number")return!isNaN(e)&&isFinite(e);if(r==="string"){if(e.length===0)return!1;if(e.length===1)return/\d/.test(e);const i=Array.from(new Set([".",...t])).map(o=>`\\${o}`).join("|");return new RegExp(`^[+-]?(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(e.trim())}else if(r==="object")return!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date);return!1}function isNumericLike(e){return isNumeric(e,[","])}function rangeEach(e,t,r){let i=-1;for(typeof t=="function"?(r=t,t=e):i=e-1;++i<=t&&r(i)!==!1;);}function rangeEachReverse(e,t,r){let i=e+1;for(typeof t=="function"&&(r=t,t=0);--i>=t&&r(i)!==!1;);}function valueAccordingPercent(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}function clamp(e,t,r){return Math.min(e,t)===e?t:Math.max(e,r)===e?r:e}var ASC="asc",DESC="desc",ORDER_MAP=new Map([[ASC,[-1,1]],[DESC,[1,-1]]]),DEFAULT_ERROR_PRIORITY_EXISTS=e=>`The priority '${e}' is already declared in a map.`,DEFAULT_ERROR_PRIORITY_NAN=e=>`The priority '${e}' is not a number.`;function createPriorityMap(){let{errorPriorityExists:e,errorPriorityNaN:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;e=isFunction2(e)?e:DEFAULT_ERROR_PRIORITY_EXISTS,t=isFunction2(t)?t:DEFAULT_ERROR_PRIORITY_NAN;function i(a,c){if(!isNumeric(a))throw new Error(t(a));if(r.has(a))throw new Error(e(a));r.set(a,c)}function o(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ASC;const[c,u]=ORDER_MAP.get(a)||ORDER_MAP.get(ASC);return[...r].sort((h,d)=>h[0]<d[0]?c:u).map(h=>h[1])}return{addItem:i,getItems:o}}var import_es_error_cause9=__toESM(require_es_error_cause(),1),DEFAULT_ERROR_ID_EXISTS=e=>`The id '${e}' is already declared in a map.`;function createUniqueMap(){let{errorIdExists:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=new Map;e=isFunction2(e)?e:DEFAULT_ERROR_ID_EXISTS;function r(d,f){if(h(d))throw new Error(e(d));t.set(d,f)}function i(d){return t.delete(d)}function o(){t.clear()}function a(d){const[f]=u().find(m=>{let[g,v]=m;return d===v?g:!1})||[null];return f}function c(d){return t.get(d)}function u(){return[...t]}function h(d){return t.has(d)}return{addItem:r,clear:o,getId:a,getItem:c,getItems:u,hasItem:h,removeItem:i}}var import_es_error_cause10=__toESM(require_es_error_cause(),1),import_es_set_difference_v23=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v23=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v23=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v23=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v23=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v23=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v23=__toESM(require_es_set_union_v2(),1),DEFAULT_ERROR_ITEM_EXISTS=e=>`'${e}' value is already declared in a unique set.`;function createUniqueSet(){let{errorItemExists:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=new Set;e=isFunction2(e)?e:DEFAULT_ERROR_ITEM_EXISTS;function r(a){if(t.has(a))throw new Error(e(a));t.add(a)}function i(){return[...t]}function o(){t.clear()}return{addItem:r,clear:o,getItems:i}}var ERROR_PLUGIN_REGISTERED=e=>`There is already registered "${e}" plugin.`,ERROR_PRIORITY_REGISTERED=e=>`There is already registered plugin on priority "${e}".`,ERROR_PRIORITY_NAN=e=>`The priority "${e}" is not a number.`,priorityPluginsQueue=createPriorityMap({errorPriorityExists:ERROR_PRIORITY_REGISTERED,errorPriorityNaN:ERROR_PRIORITY_NAN}),uniquePluginsQueue=createUniqueSet({errorItemExists:ERROR_PLUGIN_REGISTERED}),uniquePluginsList=createUniqueMap({errorIdExists:ERROR_PLUGIN_REGISTERED});function getPluginsNames(){return[...priorityPluginsQueue.getItems(),...uniquePluginsQueue.getItems()]}function getPlugin(e){const t=toUpperCaseFirst(e);return uniquePluginsList.getItem(t)}function hasPlugin(e){return!!getPlugin(e)}function registerPlugin(e,t,r){[e,t,r]=unifyPluginArguments(e,t,r),getPlugin(e)===void 0&&_registerPlugin(e,t,r)}function _registerPlugin(e,t,r){const i=toUpperCaseFirst(e);if(uniquePluginsList.hasItem(i))throw new Error(ERROR_PLUGIN_REGISTERED(i));r===void 0?uniquePluginsQueue.addItem(i):priorityPluginsQueue.addItem(r,i),uniquePluginsList.addItem(i,t)}function unifyPluginArguments(e,t,r){return typeof e=="function"&&(t=e,e=t.PLUGIN_KEY,r=t.PLUGIN_PRIORITY),[e,t,r]}var import_es_error_cause12=__toESM(require_es_error_cause(),1),{register:register2,getItem:getItem2,hasItem:hasItem2,getNames:getNames2,getValues:getValues2}=staticRegister("renderers");function _getItem2(e){if(typeof e=="function")return e;if(!hasItem2(e))throw Error(`No registered renderer found under "${e}" name`);return getItem2(e)}function _register2(e,t){typeof e!="string"&&(t=e,e=t.RENDERER_TYPE),register2(e,t)}var import_es_error_cause13=__toESM(require_es_error_cause(),1),{register:register3,getItem:getItem3,hasItem:hasItem3,getNames:getNames3,getValues:getValues3}=staticRegister("validators");function _getItem3(e){if(typeof e=="function")return e;if(!hasItem3(e))throw Error(`No registered validator found under "${e}" name`);return getItem3(e)}function _register3(e,t){typeof e!="string"&&(t=e,e=t.VALIDATOR_TYPE),register3(e,t)}var import_es_error_cause53=__toESM(require_es_error_cause(),1),import_es_array_push19=__toESM(require_es_array_push(),1),import_es_error_cause14=__toESM(require_es_error_cause(),1),import_es_array_at=__toESM(require_es_array_at(),1),import_es_string_at_alternative=__toESM(require_es_string_at_alternative(),1);function _defineProperty4(e,t,r){return(t=_toPropertyKey4(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey4(e){var t=_toPrimitive4(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive4(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FullyVisibleColumnsCalculationType=class{constructor(){_defineProperty4(this,"count",0),_defineProperty4(this,"startColumn",null),_defineProperty4(this,"endColumn",null),_defineProperty4(this,"startPosition",null),_defineProperty4(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:a}=t,c=i>0?o+1:o;r>=i&&r+a<=i+c&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var t;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:a,totalColumns:c,needReverse:u,startPositions:h,columnWidth:d}=e;if(this.endColumn===c-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const v=h[this.endColumn]+d-h[this.startColumn-1];if(v<=i&&(this.startColumn-=1),v>=i)break}this.startPosition=(t=h[this.startColumn])!==null&&t!==void 0?t:null;const f=a>0?i+1:i,m=r+i-f,g=this.startColumn===null?0:e.getColumnWidth(this.startColumn);m<-1*o||r>h.at(-1)||-1*r-i>-1*g?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,c<this.endColumn&&(this.endColumn=c-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},import_es_error_cause15=__toESM(require_es_error_cause(),1),import_es_array_at2=__toESM(require_es_array_at(),1),import_es_string_at_alternative2=__toESM(require_es_string_at_alternative(),1);function _defineProperty5(e,t,r){return(t=_toPropertyKey5(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey5(e){var t=_toPrimitive5(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive5(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FullyVisibleRowsCalculationType=class{constructor(){_defineProperty5(this,"count",0),_defineProperty5(this,"startRow",null),_defineProperty5(this,"endRow",null),_defineProperty5(this,"startPosition",null),_defineProperty5(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:a}=t;r>=i&&r+a<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var t;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:a,needReverse:c,startPositions:u,rowHeight:h}=e;if(this.endRow===a-1&&c)for(this.startRow=this.endRow;this.startRow>0;){const m=u[this.endRow]+h-u[this.startRow-1];if(m<=i-o&&(this.startRow-=1),m>=i-o)break}this.startPosition=(t=u[this.startRow])!==null&&t!==void 0?t:null;const d=r+i-o,f=this.startRow===null?0:e.getRowHeight(this.startRow);d<f||r>u.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}},import_es_error_cause16=__toESM(require_es_error_cause(),1),import_es_array_at3=__toESM(require_es_array_at(),1),import_es_string_at_alternative3=__toESM(require_es_string_at_alternative(),1);function _defineProperty6(e,t,r){return(t=_toPropertyKey6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey6(e){var t=_toPrimitive6(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive6(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PartiallyVisibleColumnsCalculationType=class{constructor(){_defineProperty6(this,"count",0),_defineProperty6(this,"startColumn",null),_defineProperty6(this,"endColumn",null),_defineProperty6(this,"startPosition",null),_defineProperty6(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o}=t;r<=i&&(this.startColumn=e);const a=i>0?o+1:o;r>=i&&r<=i+a&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var t;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:a,totalColumns:c,needReverse:u,startPositions:h,columnWidth:d}=e;if(this.endColumn===c-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=h[this.endColumn]+d-h[this.startColumn-1];if(this.startColumn-=1,g>i)break}this.startPosition=(t=h[this.startColumn])!==null&&t!==void 0?t:null;const f=a>0?i+1:i;r+i-f<-1*o||r>h.at(-1)+d||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,c<this.endColumn&&(this.endColumn=c-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},import_es_error_cause17=__toESM(require_es_error_cause(),1),import_es_array_at4=__toESM(require_es_array_at(),1),import_es_string_at_alternative4=__toESM(require_es_string_at_alternative(),1);function _defineProperty7(e,t,r){return(t=_toPropertyKey7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey7(e){var t=_toPrimitive7(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PartiallyVisibleRowsCalculationType=class{constructor(){_defineProperty7(this,"count",0),_defineProperty7(this,"startRow",null),_defineProperty7(this,"endRow",null),_defineProperty7(this,"startPosition",null),_defineProperty7(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o}=t;r<=i&&(this.startRow=e),r>=i&&r<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var t;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:a,needReverse:c,startPositions:u,rowHeight:h}=e;if(this.endRow===a-1&&c)for(this.startRow=this.endRow;this.startRow>0;){const f=u[this.endRow]+h-u[this.startRow-1];if(this.startRow-=1,f>=i-o)break}this.startPosition=(t=u[this.startRow])!==null&&t!==void 0?t:null,r+i-o<0||r>u.at(-1)+h?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}},import_es_error_cause18=__toESM(require_es_error_cause(),1);function _defineProperty8(e,t,r){return(t=_toPropertyKey8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey8(e){var t=_toPrimitive8(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RenderedAllColumnsCalculationType=class{constructor(){_defineProperty8(this,"count",0),_defineProperty8(this,"startColumn",0),_defineProperty8(this,"endColumn",0),_defineProperty8(this,"startPosition",0),_defineProperty8(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:t}=e;this.count=t,this.endColumn=this.count-1}process(){}finalize(){}},import_es_error_cause19=__toESM(require_es_error_cause(),1);function _defineProperty9(e,t,r){return(t=_toPropertyKey9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey9(e){var t=_toPrimitive9(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RenderedAllRowsCalculationType=class{constructor(){_defineProperty9(this,"count",0),_defineProperty9(this,"startRow",0),_defineProperty9(this,"endRow",0),_defineProperty9(this,"startPosition",0),_defineProperty9(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:t}=e;this.count=t,this.endRow=this.count-1}process(){}finalize(){}},RenderedColumnsCalculationType=class extends PartiallyVisibleColumnsCalculationType{finalize(e){var t;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:o}=e;this.startColumn!==null&&typeof r=="function"&&r(this),this.startColumn<0&&(this.startColumn=0),this.startPosition=(t=o[this.startColumn])!==null&&t!==void 0?t:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},RenderedRowsCalculationType=class extends PartiallyVisibleRowsCalculationType{finalize(e){var t;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:o}=e;this.startRow!==null&&typeof r=="function"&&r(this),this.startRow<0&&(this.startRow=0),this.startPosition=(t=o[this.startRow])!==null&&t!==void 0?t:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}},import_es_error_cause21=__toESM(require_es_error_cause(),1),import_es_array_push9=__toESM(require_es_array_push(),1),import_es_error_cause20=__toESM(require_es_error_cause(),1);function _defineProperty10(e,t,r){return(t=_toPropertyKey10(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey10(e){var t=_toPrimitive10(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive10(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ViewportBaseCalculator=class{constructor(e){_defineProperty10(this,"calculationTypes",[]),_defineProperty10(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(t=>{let[r,i]=t;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,t){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,t)})}_finalize(e){this.calculationTypes.forEach(t=>{let[,r]=t;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}};function _defineProperty11(e,t,r){return(t=_toPropertyKey11(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey11(e){var t=_toPrimitive11(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive11(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DEFAULT_WIDTH=50,ViewportColumnsCalculator=class extends ViewportBaseCalculator{constructor(e){let{calculationTypes:t,viewportWidth:r,scrollOffset:i,totalColumns:o,columnWidthFn:a,overrideFn:c,inlineStartOffset:u}=e;super(t),_defineProperty11(this,"viewportWidth",0),_defineProperty11(this,"scrollOffset",0),_defineProperty11(this,"zeroBasedScrollOffset",0),_defineProperty11(this,"totalColumns",0),_defineProperty11(this,"columnWidthFn",null),_defineProperty11(this,"columnWidth",0),_defineProperty11(this,"overrideFn",null),_defineProperty11(this,"inlineStartOffset",0),_defineProperty11(this,"totalCalculatedWidth",0),_defineProperty11(this,"startPositions",[]),_defineProperty11(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=a,this.overrideFn=c,this.inlineStartOffset=u,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const t=this.columnWidthFn(e);return isNaN(t)?DEFAULT_WIDTH:t}},import_es_error_cause22=__toESM(require_es_error_cause(),1),import_es_array_push10=__toESM(require_es_array_push(),1);function _defineProperty12(e,t,r){return(t=_toPropertyKey12(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey12(e){var t=_toPrimitive12(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive12(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DEFAULT_HEIGHT=23,ViewportRowsCalculator=class extends ViewportBaseCalculator{constructor(e){let{calculationTypes:t,viewportHeight:r,scrollOffset:i,totalRows:o,rowHeightFn:a,overrideFn:c,horizontalScrollbarHeight:u}=e;super(t),_defineProperty12(this,"viewportHeight",0),_defineProperty12(this,"scrollOffset",0),_defineProperty12(this,"zeroBasedScrollOffset",0),_defineProperty12(this,"totalRows",0),_defineProperty12(this,"rowHeightFn",null),_defineProperty12(this,"rowHeight",0),_defineProperty12(this,"overrideFn",null),_defineProperty12(this,"horizontalScrollbarHeight",0),_defineProperty12(this,"innerViewportHeight",0),_defineProperty12(this,"totalCalculatedHeight",0),_defineProperty12(this,"startPositions",[]),_defineProperty12(this,"needReverse",!0),this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=c,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const t=this.rowHeightFn(e);return isNaN(t)?DEFAULT_HEIGHT:t}},import_es_error_cause23=__toESM(require_es_error_cause(),1);function _classPrivateFieldInitSpec2(e,t,r){_checkPrivateRedeclaration3(e,t),t.set(e,r)}function _checkPrivateRedeclaration3(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty13(e,t,r){return(t=_toPropertyKey13(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey13(e){var t=_toPrimitive13(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive13(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet2(e,t){return e.get(_assertClassBrand3(e,t))}function _classPrivateFieldSet2(e,t,r){return e.set(_assertClassBrand3(e,t),r),r}function _assertClassBrand3(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _isRtl=new WeakMap,CellCoords=class oi{constructor(t,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;_defineProperty13(this,"row",null),_defineProperty13(this,"col",null),_classPrivateFieldInitSpec2(this,_isRtl,!1),_classPrivateFieldSet2(_isRtl,this,i),typeof t<"u"&&typeof r<"u"&&(this.row=t,this.col=r)}isValid(t){const{countRows:r,countCols:i,countRowHeaders:o,countColHeaders:a}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...t};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-a||this.col<-o||this.row>=r||this.col>=i)}isEqual(t){return t===this?!0:this.row===t.row&&this.col===t.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return _classPrivateFieldGet2(_isRtl,this)}isSouthEastOf(t){return this.row>=t.row&&(_classPrivateFieldGet2(_isRtl,this)?this.col<=t.col:this.col>=t.col)}isNorthWestOf(t){return this.row<=t.row&&(_classPrivateFieldGet2(_isRtl,this)?this.col>=t.col:this.col<=t.col)}isSouthWestOf(t){return this.row>=t.row&&(_classPrivateFieldGet2(_isRtl,this)?this.col>=t.col:this.col<=t.col)}isNorthEastOf(t){return this.row<=t.row&&(_classPrivateFieldGet2(_isRtl,this)?this.col<=t.col:this.col>=t.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(t){return Number.isInteger(t?.row)&&(this.row=t.row),Number.isInteger(t?.col)&&(this.col=t.col),t instanceof oi&&_classPrivateFieldSet2(_isRtl,this,t.isRtl()),this}clone(){return new oi(this.row,this.col,_classPrivateFieldGet2(_isRtl,this))}toObject(){return{row:this.row,col:this.col}}},coords_default=CellCoords,import_es_error_cause24=__toESM(require_es_error_cause(),1),import_es_array_push11=__toESM(require_es_array_push(),1);function _classPrivateFieldInitSpec3(e,t,r){_checkPrivateRedeclaration4(e,t),t.set(e,r)}function _checkPrivateRedeclaration4(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty14(e,t,r){return(t=_toPropertyKey14(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey14(e){var t=_toPrimitive14(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive14(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet3(e,t){return e.get(_assertClassBrand4(e,t))}function _classPrivateFieldSet3(e,t,r){return e.set(_assertClassBrand4(e,t),r),r}function _assertClassBrand4(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _isRtl2=new WeakMap,CellRange=class Qi{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;_defineProperty14(this,"highlight",null),_defineProperty14(this,"from",null),_defineProperty14(this,"to",null),_classPrivateFieldInitSpec3(this,_isRtl2,!1),this.highlight=t.clone(),this.from=r.clone(),this.to=i.clone(),_classPrivateFieldSet3(_isRtl2,this,o)}setHighlight(t){return this.highlight=t.clone(),this}setFrom(t){return this.from=t.clone(),this}setTo(t){return this.to=t.clone(),this}isValid(t){return this.from.isValid(t)&&this.to.isValid(t)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const t=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(t,r)-Math.min(t,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const t=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(t,r)-Math.min(t,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(t){const{row:r,col:i}=t,o=this.getOuterTopStartCorner(),a=this.getOuterBottomEndCorner();return o.row<=r&&a.row>=r&&o.col<=i&&a.col>=i}includesRange(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}isEqual(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}overlaps(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}isNorthWestOf(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}isOverlappingHorizontally(t){return this.getOuterTopEndCorner().col>=t.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=t.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=t.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=t.getOuterTopStartCorner().col}isOverlappingVertically(t){return this.getOuterBottomStartCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=t.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=t.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=t.getOuterTopRightCorner().row}expand(t){const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return t.row<r.row||t.col<r.col||t.row>i.row||t.col>i.col?(this.from=this._createCellCoords(Math.min(r.row,t.row),Math.min(r.col,t.col)),this.to=this._createCellCoords(Math.max(i.row,t.row),Math.max(i.col,t.col)),!0):!1}expandByRange(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(t)||!this.overlaps(t))return!1;const i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),a=this.getDirection(),c=t.getOuterTopStartCorner(),u=t.getOuterBottomEndCorner(),h=Math.min(i.row,c.row),d=Math.min(i.col,c.col),f=Math.max(o.row,u.row),m=Math.max(o.col,u.col),g=this._createCellCoords(h,d),v=this._createCellCoords(f,m);return this.from=g,this.to=v,this.setDirection(a),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(t){switch(t){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break;default:break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break;default:break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break;default:break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return _classPrivateFieldGet3(_isRtl2,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return _classPrivateFieldGet3(_isRtl2,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return _classPrivateFieldGet3(_isRtl2,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return _classPrivateFieldGet3(_isRtl2,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return _classPrivateFieldGet3(_isRtl2,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return _classPrivateFieldGet3(_isRtl2,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return _classPrivateFieldGet3(_isRtl2,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return _classPrivateFieldGet3(_isRtl2,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(t){return t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(t){if(!(t instanceof coords_default))return!1;if(t.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(t.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(t.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(t.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(t){if(!this.includesRange(t))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(t.from.row,t.to.row),bottom:Math.max(t.from.row,t.to.row),left:Math.min(t.from.col,t.to.col),right:Math.max(t.from.col,t.to.col)},o=[];return r.top===i.top&&o.push("top"),r.right===i.right&&o.push(_classPrivateFieldGet3(_isRtl2,this)?"left":"right"),r.bottom===i.bottom&&o.push("bottom"),r.left===i.left&&o.push(_classPrivateFieldGet3(_isRtl2,this)?"right":"left"),o}getInner(){const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=[];for(let o=t.row;o<=r.row;o++)for(let a=t.col;a<=r.col;a++)!(this.from.row===o&&this.from.col===a)&&!(this.to.row===o&&this.to.col===a)&&i.push(this._createCellCoords(o,a));return i}getAll(){const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=[];for(let o=t.row;o<=r.row;o++)for(let a=t.col;a<=r.col;a++)t.row===o&&t.col===a?i.push(t):r.row===o&&r.col===a?i.push(r):i.push(this._createCellCoords(o,a));return i}forAll(t){const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let o=r.row;o<=i.row;o++)for(let a=r.col;a<=i.col;a++)if(t(o,a)===!1)return}clone(){return new Qi(this.highlight,this.from,this.to,_classPrivateFieldGet3(_isRtl2,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(t,r){return new coords_default(t,r,_classPrivateFieldGet3(_isRtl2,this))}},range_default=CellRange,import_es_array_push18=__toESM(require_es_array_push(),1),import_es_error_cause25=__toESM(require_es_error_cause(),1);function _classPrivateFieldInitSpec4(e,t,r){_checkPrivateRedeclaration5(e,t),t.set(e,r)}function _checkPrivateRedeclaration5(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet4(e,t){return e.get(_assertClassBrand5(e,t))}function _classPrivateFieldSet4(e,t,r){return e.set(_assertClassBrand5(e,t),r),r}function _assertClassBrand5(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _wtSettings=new WeakMap,_domBindings=new WeakMap,_wtTable=new WeakMap,_selectionManager=new WeakMap,_parent=new WeakMap,_eventManager=new WeakMap,_facadeGetter=new WeakMap,_selectedCellBeforeTouchEnd=new WeakMap,_dblClickTimeout=new WeakMap,_dblClickOrigin=new WeakMap,Event2=class{constructor(e,t,r,i,o,a){let c=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;_classPrivateFieldInitSpec4(this,_wtSettings,void 0),_classPrivateFieldInitSpec4(this,_domBindings,void 0),_classPrivateFieldInitSpec4(this,_wtTable,void 0),_classPrivateFieldInitSpec4(this,_selectionManager,void 0),_classPrivateFieldInitSpec4(this,_parent,void 0),_classPrivateFieldInitSpec4(this,_eventManager,void 0),_classPrivateFieldInitSpec4(this,_facadeGetter,void 0),_classPrivateFieldInitSpec4(this,_selectedCellBeforeTouchEnd,void 0),_classPrivateFieldInitSpec4(this,_dblClickTimeout,[null,null]),_classPrivateFieldInitSpec4(this,_dblClickOrigin,[null,null]),_classPrivateFieldSet4(_wtSettings,this,r),_classPrivateFieldSet4(_domBindings,this,t),_classPrivateFieldSet4(_wtTable,this,o),_classPrivateFieldSet4(_selectionManager,this,a),_classPrivateFieldSet4(_parent,this,c),_classPrivateFieldSet4(_eventManager,this,i),_classPrivateFieldSet4(_facadeGetter,this,e),this.registerEvents()}registerEvents(){_classPrivateFieldGet4(_eventManager,this).addEventListener(_classPrivateFieldGet4(_wtTable,this).holder,"contextmenu",r=>this.onContextMenu(r)),_classPrivateFieldGet4(_eventManager,this).addEventListener(_classPrivateFieldGet4(_wtTable,this).TABLE,"mouseover",r=>this.onMouseOver(r)),_classPrivateFieldGet4(_eventManager,this).addEventListener(_classPrivateFieldGet4(_wtTable,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{_classPrivateFieldGet4(_eventManager,this).addEventListener(_classPrivateFieldGet4(_wtTable,this).holder,"touchstart",r=>this.onTouchStart(r)),_classPrivateFieldGet4(_eventManager,this).addEventListener(_classPrivateFieldGet4(_wtTable,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),_classPrivateFieldGet4(_eventManager,this).addEventListener(_classPrivateFieldGet4(_wtTable,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||_classPrivateFieldGet4(_wtSettings,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,_classPrivateFieldGet4(_wtSettings,this).getSetting("onAfterMomentumScroll"))},200)})},t=()=>{_classPrivateFieldGet4(_eventManager,this).addEventListener(_classPrivateFieldGet4(_wtTable,this).holder,"mouseup",r=>this.onMouseUp(r)),_classPrivateFieldGet4(_eventManager,this).addEventListener(_classPrivateFieldGet4(_wtTable,this).holder,"mousedown",r=>this.onMouseDown(r))};isMobileBrowser()?e():(isTouchSupported()&&e(),t())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(_classPrivateFieldGet4(_selectedCellBeforeTouchEnd,this)&&r){const[i,o]=[r.row,_classPrivateFieldGet4(_selectedCellBeforeTouchEnd,this).from.row],[a,c]=[r.col,_classPrivateFieldGet4(_selectedCellBeforeTouchEnd,this).from.col];return i===o&&a===c}return!1}parentCell(e){const t={},r=_classPrivateFieldGet4(_wtTable,this).TABLE,i=closestDown(e,["TD","TH"],r);return i?(t.coords=_classPrivateFieldGet4(_wtTable,this).getCoords(i),t.TD=i):hasClass(e,"wtBorder")&&hasClass(e,"current")?(t.coords=_classPrivateFieldGet4(_selectionManager,this).getFocusSelection().cellRange.highlight,t.TD=_classPrivateFieldGet4(_wtTable,this).getCell(t.coords)):hasClass(e,"wtBorder")&&hasClass(e,"area")&&_classPrivateFieldGet4(_selectionManager,this).getAreaSelection().cellRange&&(t.coords=_classPrivateFieldGet4(_selectionManager,this).getAreaSelection().cellRange.to,t.TD=_classPrivateFieldGet4(_wtTable,this).getCell(t.coords)),t}onMouseDown(e){const t=_classPrivateFieldGet4(_domBindings,this).rootDocument.activeElement,r=partial(getParent,e.target),i=e.target;if(!["TD","TH"].includes(t.nodeName)&&(i===t||r(0)===t||r(1)===t))return;const o=this.parentCell(i);hasClass(i,"corner")?_classPrivateFieldGet4(_wtSettings,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&_classPrivateFieldGet4(_wtSettings,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(_classPrivateFieldGet4(_dblClickOrigin,this)[0]=o.TD,clearTimeout(_classPrivateFieldGet4(_dblClickTimeout,this)[0]),_classPrivateFieldGet4(_dblClickTimeout,this)[0]=setTimeout(()=>{_classPrivateFieldGet4(_dblClickOrigin,this)[0]=null},1e3))}onContextMenu(e){if(_classPrivateFieldGet4(_wtSettings,this).has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!_classPrivateFieldGet4(_wtSettings,this).has("onCellMouseOver"))return;const t=_classPrivateFieldGet4(_wtTable,this).TABLE,r=closestDown(e.target,["TD","TH"],t),i=_classPrivateFieldGet4(_parent,this)||this;r&&r!==i.lastMouseOver&&isChildOf(r,t)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,_classPrivateFieldGet4(_wtTable,this).getCoords(r),r))}onMouseOut(e){if(!_classPrivateFieldGet4(_wtSettings,this).has("onCellMouseOut"))return;const t=_classPrivateFieldGet4(_wtTable,this).TABLE,r=closestDown(e.target,["TD","TH"],t),i=closestDown(e.relatedTarget,["TD","TH"],t),o=_classPrivateFieldGet4(_parent,this)||this;r&&r!==i&&isChildOf(r,t)&&(this.callListener("onCellMouseOut",e,_classPrivateFieldGet4(_wtTable,this).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const t=this.parentCell(e.target);t.TD&&_classPrivateFieldGet4(_wtSettings,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),!(e.button!==0&&!this.touchApplied)&&(t.TD===_classPrivateFieldGet4(_dblClickOrigin,this)[0]&&t.TD===_classPrivateFieldGet4(_dblClickOrigin,this)[1]?(hasClass(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),_classPrivateFieldGet4(_dblClickOrigin,this)[0]=null,_classPrivateFieldGet4(_dblClickOrigin,this)[1]=null):t.TD===_classPrivateFieldGet4(_dblClickOrigin,this)[0]&&(_classPrivateFieldGet4(_dblClickOrigin,this)[1]=t.TD,clearTimeout(_classPrivateFieldGet4(_dblClickTimeout,this)[1]),_classPrivateFieldGet4(_dblClickTimeout,this)[1]=setTimeout(()=>{_classPrivateFieldGet4(_dblClickOrigin,this)[1]=null},500)))}onTouchStart(e){_classPrivateFieldSet4(_selectedCellBeforeTouchEnd,this,_classPrivateFieldGet4(_selectionManager,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const r=e.target,i=(t=this.parentCell(r))===null||t===void 0?void 0:t.coords,o=isDefined(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&_classPrivateFieldGet4(_wtSettings,this).getSetting("isDataViewInstance")){const c=["A","BUTTON","INPUT"];isIOS()&&(isChromeWebKit()||isFirefoxWebKit())&&this.selectedCellWasTouched(r)&&!c.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,r,i){const o=_classPrivateFieldGet4(_wtSettings,this).getSettingPure(e);o&&o(t,r,i,_classPrivateFieldGet4(_facadeGetter,this).call(this))}destroy(){clearTimeout(_classPrivateFieldGet4(_dblClickTimeout,this)[0]),clearTimeout(_classPrivateFieldGet4(_dblClickTimeout,this)[1]),_classPrivateFieldGet4(_eventManager,this).destroy()}},event_default=Event2,import_es_error_cause51=__toESM(require_es_error_cause(),1),import_es_array_push17=__toESM(require_es_array_push(),1),import_es_error_cause40=__toESM(require_es_error_cause(),1),import_es_array_push13=__toESM(require_es_array_push(),1),import_es_error_cause26=__toESM(require_es_error_cause(),1);function _defineProperty15(e,t,r){return(t=_toPropertyKey15(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey15(e){var t=_toPrimitive15(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive15(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ColumnFilter=class{constructor(e,t,r){_defineProperty15(this,"offset",void 0),_defineProperty15(this,"total",void 0),_defineProperty15(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}},column_default=ColumnFilter,import_es_error_cause27=__toESM(require_es_error_cause(),1);function _defineProperty16(e,t,r){return(t=_toPropertyKey16(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey16(e){var t=_toPrimitive16(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive16(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RowFilter=class{constructor(e,t,r){_defineProperty16(this,"offset",void 0),_defineProperty16(this,"total",void 0),_defineProperty16(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}},row_default=RowFilter,import_es_error_cause33=__toESM(require_es_error_cause(),1),import_es_error_cause30=__toESM(require_es_error_cause(),1),import_es_array_push12=__toESM(require_es_array_push(),1),WORKING_SPACE_ALL=0,WORKING_SPACE_TOP=1,WORKING_SPACE_BOTTOM=2,import_es_error_cause29=__toESM(require_es_error_cause(),1),import_es_error_cause28=__toESM(require_es_error_cause(),1);function _defineProperty17(e,t,r){return(t=_toPropertyKey17(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey17(e){var t=_toPrimitive17(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive17(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ViewSize=class{constructor(){_defineProperty17(this,"currentSize",0),_defineProperty17(this,"nextSize",0),_defineProperty17(this,"currentOffset",0),_defineProperty17(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}};function _defineProperty18(e,t,r){return(t=_toPropertyKey18(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey18(e){var t=_toPrimitive18(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive18(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ViewSizeSet=class{constructor(){_defineProperty18(this,"size",new ViewSize),_defineProperty18(this,"workingSpace",WORKING_SPACE_ALL),_defineProperty18(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof ViewSize}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=WORKING_SPACE_TOP,e.workingSpace=WORKING_SPACE_BOTTOM,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=WORKING_SPACE_BOTTOM,e.workingSpace=WORKING_SPACE_TOP,this.sharedSize=e.getViewSize()}};function _defineProperty19(e,t,r){return(t=_toPropertyKey19(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey19(e){var t=_toPrimitive19(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive19(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OrderView=class{constructor(e,t,r){_defineProperty19(this,"rootNode",void 0),_defineProperty19(this,"nodesPool",void 0),_defineProperty19(this,"sizeSet",new ViewSizeSet),_defineProperty19(this,"childNodeType",void 0),_defineProperty19(this,"visualIndex",0),_defineProperty19(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=t,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:t}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(t.isPlaceOn(WORKING_SPACE_TOP))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:t}=this,r=this.isSharedViewSet(),{nextSize:i}=t.getViewSize();let o=this.getRenderedChildCount();for(;o<i;){const c=this.nodesPool();!r||r&&t.isPlaceOn(WORKING_SPACE_BOTTOM)?e.appendChild(c):e.insertBefore(c,e.firstChild),o+=1}const a=r&&t.isPlaceOn(WORKING_SPACE_TOP);for(;o>i;)e.removeChild(a?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:t}=this;let r=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(WORKING_SPACE_BOTTOM)&&(r+=t.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,i),i=o}this.collectedNodes.push(i),this.visualIndex+=1}end(){}},SharedOrderView=class extends OrderView{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}},import_es_error_cause32=__toESM(require_es_error_cause(),1),import_es_error_cause31=__toESM(require_es_error_cause(),1);function _defineProperty20(e,t,r){return(t=_toPropertyKey20(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey20(e){var t=_toPrimitive20(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive20(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NodesPool=class{constructor(e){_defineProperty20(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}};function _defineProperty21(e,t,r){return(t=_toPropertyKey21(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey21(e){var t=_toPrimitive21(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive21(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BaseRenderer=class{constructor(e,t){_defineProperty21(this,"nodesPool",null),_defineProperty21(this,"nodeType",void 0),_defineProperty21(this,"rootNode",void 0),_defineProperty21(this,"table",null),_defineProperty21(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new NodesPool(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}};function _defineProperty22(e,t,r){return(t=_toPropertyKey22(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey22(e){var t=_toPrimitive22(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive22(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RowHeadersRenderer=class extends BaseRenderer{constructor(){super("TH"),_defineProperty22(this,"orderViews",new WeakMap),_defineProperty22(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new SharedOrderView(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let a=0;a<e;a++){const c=this.table.renderedRowToSource(a),u=i.getRenderedNode(a);this.sourceRowIndex=c;const h=this.obtainOrderView(u),d=o.obtainOrderView(u);h.appendView(d).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let f=0;f<r;f++){h.render();const m=h.getCurrentNode();m.className="",m.removeAttribute("style"),removeAttribute(m,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&setAttribute(m,[A11Y_ROWHEADER(),A11Y_SCOPE_ROW(),A11Y_COLINDEX(f+1),A11Y_TABINDEX(-1)]),t[f](c,m,f)}h.end()}}},ColumnHeadersRenderer=class extends BaseRenderer{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+t;for(let c=0,u=e;c<u;c++){for(r=this.rootNode.childNodes[c],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const a=this.rootNode.childNodes.length;if(a>e)for(let c=e;c<a;c++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&empty2(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&setAttribute(this.rootNode,[A11Y_ROWGROUP()]);for(let t=0;t<e;t+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,a=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&setAttribute(a,[A11Y_ROW(),A11Y_ROWINDEX(t+1)]);for(let c=-1*o;c<i;c+=1){const u=this.table.renderedColumnToSource(c),h=a.childNodes[c+o];h.className="",h.removeAttribute("style"),removeAttribute(h,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&setAttribute(h,[A11Y_COLINDEX(c+1+this.table.rowHeadersCount),A11Y_TABINDEX(-1),A11Y_COLUMNHEADER(),...c>=0?[A11Y_SCOPE_COL()]:[A11Y_ROW()]]),r[t](u,h,t)}}}},performanceWarningAppeared=!1,ColGroupRenderer=class extends BaseRenderer{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,r=e+t;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;!performanceWarningAppeared&&e>1e3&&(performanceWarningAppeared=!0,warn(toSingleLine`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<t;i++){const o=this.table.renderedColumnToSource(i),a=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${a}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),a=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[i+t].style.width=`${a}px`}const r=this.rootNode.firstChild;r&&addClass(r,"rowHeader")}},import_es_error_cause34=__toESM(require_es_error_cause(),1);function _defineProperty23(e,t,r){return(t=_toPropertyKey23(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey23(e){var t=_toPrimitive23(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive23(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ROW_CLASSNAMES={rowEven:"ht__row_even",rowOdd:"ht__row_odd"},performanceWarningAppeared2=!1,RowsRenderer=class extends BaseRenderer{constructor(e){super("TR",e),_defineProperty23(this,"orderView",void 0),this.orderView=new OrderView(e,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!performanceWarningAppeared2&&e>1e3&&(performanceWarningAppeared2=!0,warn(toSingleLine`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&setAttribute(this.rootNode,[A11Y_ROWGROUP()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),a=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var t,r;setAttribute(o,[A11Y_ROW(),A11Y_ROWINDEX(a+((t=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&t!==void 0?t:0)+1)])}removeClass(o,[ROW_CLASSNAMES.rowEven,ROW_CLASSNAMES.rowOdd]),(a+1)%2===0?addClass(o,ROW_CLASSNAMES.rowEven):addClass(o,ROW_CLASSNAMES.rowOdd)}this.orderView.end()}},import_es_error_cause35=__toESM(require_es_error_cause(),1);function _defineProperty24(e,t,r){return(t=_toPropertyKey24(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey24(e){var t=_toPrimitive24(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive24(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CellsRenderer=class extends BaseRenderer{constructor(){super("TD"),_defineProperty24(this,"orderViews",new WeakMap),_defineProperty24(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new SharedOrderView(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:r,rowHeaders:i}=this.table;for(let c=0;c<e;c++){const u=this.table.renderedRowToSource(c),h=r.getRenderedNode(c);this.sourceRowIndex=u;const d=this.obtainOrderView(h),f=i.obtainOrderView(h);d.prependView(f).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let m=0;m<t;m++){d.render();const g=d.getCurrentNode(),v=this.table.renderedColumnToSource(m);if(hasClass(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),removeAttribute(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(u,v,g),this.table.isAriaEnabled()){var o,a;setAttribute(g,[...g.hasAttribute("role")?[]:[A11Y_GRIDCELL()],A11Y_TABINDEX(-1),A11Y_COLINDEX(v+((o=(a=this.table.rowUtils)===null||a===void 0||(a=a.dataAccessObject)===null||a===void 0?void 0:a.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}d.end()}}},import_es_error_cause36=__toESM(require_es_error_cause(),1);function _defineProperty25(e,t,r){return(t=_toPropertyKey25(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey25(e){var t=_toPrimitive25(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive25(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TableRenderer=class{constructor(e){let{cellRenderer:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};_defineProperty25(this,"rootNode",void 0),_defineProperty25(this,"rootDocument",void 0),_defineProperty25(this,"rowHeaders",null),_defineProperty25(this,"columnHeaders",null),_defineProperty25(this,"colGroup",null),_defineProperty25(this,"rows",null),_defineProperty25(this,"cells",null),_defineProperty25(this,"rowFilter",null),_defineProperty25(this,"columnFilter",null),_defineProperty25(this,"rowUtils",null),_defineProperty25(this,"columnUtils",null),_defineProperty25(this,"rowsToRender",0),_defineProperty25(this,"columnsToRender",0),_defineProperty25(this,"rowHeaderFunctions",[]),_defineProperty25(this,"rowHeadersCount",0),_defineProperty25(this,"columnHeaderFunctions",[]),_defineProperty25(this,"columnHeadersCount",0),_defineProperty25(this,"cellRenderer",void 0),_defineProperty25(this,"activeOverlayName",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),t.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let r=0;r<e;r++){const i=t.getRenderedNode(r);if(i.firstChild){const o=this.renderedRowToSource(r),a=this.rowUtils.getHeightByOverlayName(o,this.activeOverlayName);a?i.firstChild.style.height=`${a-1}px`:i.firstChild.style.height=""}}}},Renderer=class{constructor(){let{TABLE:e,THEAD:t,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:a,cellRenderer:c}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new TableRenderer(e,{cellRenderer:c}),this.renderer.setRenderers({rowHeaders:new RowHeadersRenderer,columnHeaders:new ColumnHeadersRenderer(t),colGroup:new ColGroupRenderer(r),rows:new RowsRenderer(i),cells:new CellsRenderer}),this.renderer.setAxisUtils(o,a)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}},import_es_error_cause38=__toESM(require_es_error_cause(),1),import_es_error_cause37=__toESM(require_es_error_cause(),1);function _classPrivateFieldInitSpec5(e,t,r){_checkPrivateRedeclaration6(e,t),t.set(e,r)}function _checkPrivateRedeclaration6(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty26(e,t,r){return(t=_toPropertyKey26(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey26(e){var t=_toPrimitive26(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive26(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet5(e,t){return e.get(_assertClassBrand6(e,t))}function _classPrivateFieldSet5(e,t,r){return e.set(_assertClassBrand6(e,t),r),r}function _assertClassBrand6(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _totalTargetWidth=new WeakMap,_totalColumns=new WeakMap,_stretchingColumnWidthFn=new WeakMap,_columnWidthFn=new WeakMap,_stretchMode=new WeakMap,ColumnStretching=class{constructor(e){let{totalColumns:t,stretchMode:r,stretchingColumnWidthFn:i,columnWidthFn:o}=e;_defineProperty26(this,"stretchAllRatio",0),_defineProperty26(this,"stretchLastWidth",0),_defineProperty26(this,"stretchAllColumnsWidth",[]),_classPrivateFieldInitSpec5(this,_totalTargetWidth,0),_defineProperty26(this,"needVerifyLastColumnWidth",!0),_classPrivateFieldInitSpec5(this,_totalColumns,()=>0),_classPrivateFieldInitSpec5(this,_stretchingColumnWidthFn,a=>a),_classPrivateFieldInitSpec5(this,_columnWidthFn,a=>a),_classPrivateFieldInitSpec5(this,_stretchMode,()=>"none"),_classPrivateFieldSet5(_totalColumns,this,t),_classPrivateFieldSet5(_stretchMode,this,r),_classPrivateFieldSet5(_stretchingColumnWidthFn,this,i??_classPrivateFieldGet5(_stretchingColumnWidthFn,this)),_classPrivateFieldSet5(_columnWidthFn,this,o??_classPrivateFieldGet5(_columnWidthFn,this))}refreshStretching(e){if(_classPrivateFieldGet5(_stretchMode,this).call(this)==="none")return;this.stretchAllRatio=0,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0,this.stretchLastWidth=0,_classPrivateFieldSet5(_totalTargetWidth,this,e);let t=0;for(let i=0;i<_classPrivateFieldGet5(_totalColumns,this).call(this);i++){const o=this._getColumnWidth(i),a=_classPrivateFieldGet5(_stretchingColumnWidthFn,this).call(this,void 0,i);typeof a=="number"?e-=a:t+=o}const r=e-t;if(_classPrivateFieldGet5(_stretchMode,this).call(this)==="all"&&r>0)this.stretchAllRatio=e/t,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(_classPrivateFieldGet5(_stretchMode,this).call(this)==="last"&&e!==1/0){const i=this._getColumnWidth(_classPrivateFieldGet5(_totalColumns,this).call(this)-1),o=r+i;this.stretchLastWidth=o>=0?o:i}}getStretchedColumnWidth(e,t){let r=null;return _classPrivateFieldGet5(_stretchMode,this).call(this)==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,t):_classPrivateFieldGet5(_stretchMode,this).call(this)==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,t){let r=0;if(!this.stretchAllColumnsWidth[e]){const i=Math.round(t*this.stretchAllRatio),o=_classPrivateFieldGet5(_stretchingColumnWidthFn,this).call(this,i,e);o===void 0?this.stretchAllColumnsWidth[e]=i:this.stretchAllColumnsWidth[e]=isNaN(o)?this._getColumnWidth(e):o}if(this.stretchAllColumnsWidth.length===_classPrivateFieldGet5(_totalColumns,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let i=0;i<this.stretchAllColumnsWidth.length;i++)r+=this.stretchAllColumnsWidth[i];r!==_classPrivateFieldGet5(_totalTargetWidth,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=_classPrivateFieldGet5(_totalTargetWidth,this)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===_classPrivateFieldGet5(_totalColumns,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let t=_classPrivateFieldGet5(_columnWidthFn,this).call(this,e);return isNaN(t)&&(t=DEFAULT_WIDTH),t}};function _defineProperty27(e,t,r){return(t=_toPropertyKey27(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey27(e){var t=_toPrimitive27(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive27(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ColumnUtils=class{constructor(e,t){_defineProperty27(this,"dataAccessObject",void 0),_defineProperty27(this,"wtSettings",void 0),_defineProperty27(this,"headerWidths",new Map),_defineProperty27(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=t,this.stretching=new ColumnStretching({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(r,i)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",r,i),columnWidthFn:r=>this.dataAccessObject.wtTable.getColumnWidth(r)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let t=this.getWidth(e);const r=this.stretching.getStretchedColumnWidth(e,t);return r&&(t=r),t}getHeaderHeight(e){let t=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(t=t?Math.max(t,r):r),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){const{wtTable:e,wtViewport:t,cloneSource:r}=this.dataAccessObject,i=r?r.wtTable.holder:e.holder,o=i.offsetHeight<i.scrollHeight?getScrollbarWidth():0;this.stretching.refreshStretching(t.getViewportWidth()-o)}calculateWidths(){const{wtSettings:e}=this;let t=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),t=e.getSetting("onModifyRowHeaderWidth",t),t!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let a=Array.isArray(t)?t[o]:t;a=a??i,this.headerWidths.set(o,a)}}}},import_es_error_cause39=__toESM(require_es_error_cause(),1);function _defineProperty28(e,t,r){return(t=_toPropertyKey28(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey28(e){var t=_toPrimitive28(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive28(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RowUtils=class{constructor(e,t){_defineProperty28(this,"dataAccessObject",void 0),_defineProperty28(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(t=t===void 0?r:Math.max(t,r)),t}getHeightByOverlayName(e,t){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,t);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}};function _defineProperty29(e,t,r){return(t=_toPropertyKey29(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey29(e){var t=_toPrimitive29(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive29(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Table=class{constructor(e,t,r,i,o){_defineProperty29(this,"wtSettings",null),_defineProperty29(this,"domBindings",void 0),_defineProperty29(this,"TBODY",null),_defineProperty29(this,"THEAD",null),_defineProperty29(this,"COLGROUP",null),_defineProperty29(this,"hasTableHeight",!0),_defineProperty29(this,"hasTableWidth",!0),_defineProperty29(this,"isTableVisible",!1),_defineProperty29(this,"tableOffset",0),_defineProperty29(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,removeTextNodes(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const a=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(a)),this.rowUtils=new RowUtils(this.dataAccessObject,this.wtSettings),this.columnUtils=new ColumnUtils(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Renderer({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let r;return(!t||t.nodeType!==Node.ELEMENT_NODE||!hasClass(t,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",t&&t.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&setAttribute(r,[A11Y_PRESENTATION()]),r}createHider(e){const t=e.parentNode;let r;return(!t||t.nodeType!==Node.ELEMENT_NODE||!hasClass(t,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",t&&t.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&setAttribute(r,[A11Y_PRESENTATION()]),r}createHolder(e){const t=e.parentNode;let r;return(!t||t.nodeType!==Node.ELEMENT_NODE||!hasClass(t,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",t&&t.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&setAttribute(r.parentNode,[A11Y_PRESENTATION()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&setAttribute(r,[A11Y_PRESENTATION()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=t.getSetting("totalRows"),a=t.getSetting("totalColumns"),c=t.getSetting("rowHeaders"),u=c.length,h=t.getSetting("columnHeaders"),d=h.length;let f=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=offset(this.holder),f=i.createCalculators(f),u&&!t.getSetting("fixedColumnsStart"))){const g=r.inlineStartOverlay.getScrollPosition(),v=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,v!==this.correctHeaderWidth&&(f=!1)}if(f)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=offset(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const g=o>0?this.getFirstRenderedRow():0,v=a>0?this.getFirstRenderedColumn():0;this.rowFilter=new row_default(g,o,d),this.columnFilter=new column_default(v,a,u);let _=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const b={};this.wtSettings.getSetting("beforeDraw",!0,b),_=b.skipRender!==!0}if(_){this.tableRenderer.setHeaderContentRenderers(c,h),(this.is(CLONE_BOTTOM)||this.is(CLONE_BOTTOM_INLINE_START_CORNER))&&this.tableRenderer.setHeaderContentRenderers(c,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let b;if(this.isMaster&&(b=this.dataAccessObject.workspaceWidth,i.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(CLONE_BOTTOM))&&this.markOversizedRows(),this.isMaster){this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM();const S=outerWidth(this.hider),R=outerWidth(this.TABLE);S!==0&&R!==S&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),b!==i.getWorkspaceWidth()&&(i.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(CLONE_BOTTOM)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let m=!1;return this.isMaster&&(m=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(m=r.bottomOverlay.resetFixedPosition()||m),m=r.inlineStartOverlay.resetFixedPosition()||m,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),m?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(f),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let o,a,c;const u=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),a=this.getColumnHeader(t,r),a&&(c=innerHeight(a),(!o&&i<c||o<c)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=c),Array.isArray(u)?u[r]!==null&&u[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=u[r]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(u[r]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=u[r]||u))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,a=i.length;o<a;o++)if(r[o]){if(!t[o]||t[o].childNodes.length===0)return;t[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(CLONE_BOTTOM))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);t.oversizedRows&&t.oversizedRows[o]&&(t.oversizedRows[o]=void 0)}}}getCell(e){let t=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",t,r);if(i&&Array.isArray(i)&&([t,r]=i),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(t);if(!o&&t>=0)throw new Error("TR was expected to be rendered but is not");const a=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!a&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return a}getRow(e){let t=null,r=null;if(e<0){var i;t=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;t=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return t!==void 0&&r!==void 0?r.childNodes.length<t+1?!1:r.childNodes[t]:!1}getColumnHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[t];return r?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&t.push(o)}),t}getRowHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(t>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,c=(i<0?this.THEAD:this.TBODY).childNodes[o];return c?.childNodes[t]}getRowHeaders(e){const t=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],a=o?.childNodes[i];a&&t.push(a)}return t}getCoords(e){let t=e;if(t.nodeName!=="TD"&&t.nodeName!=="TH"&&(t=closest(t,["TD","TH"])),t===null)return null;const r=t.parentNode,i=r.parentNode;let o=index(r),a=t.cellIndex;return overlayContainsElement(CLONE_TOP_INLINE_START_CORNER,t,this.wtRootElement)||overlayContainsElement(CLONE_TOP,t,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):overlayContainsElement(CLONE_BOTTOM_INLINE_START_CORNER,t,this.wtRootElement)||overlayContainsElement(CLONE_BOTTOM,t,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),overlayContainsElement(CLONE_TOP_INLINE_START_CORNER,t,this.wtRootElement)||overlayContainsElement(CLONE_INLINE_START,t,this.wtRootElement)||overlayContainsElement(CLONE_BOTTOM_INLINE_START_CORNER,t,this.wtRootElement)?a=this.columnFilter.offsettedTH(a):a=this.columnFilter.visibleRowHeadedColumnToSourceColumn(a),this.wot.createCellCoords(o,a)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=e*this.wtSettings.getSetting("defaultRowHeight"),r=innerHeight(this.TBODY)-1;let i,o,a,c,u;if(!(t===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,a=this.rowFilter.renderedToSource(e),i=this.getRowHeight(a),c=this.getTrForRow(a),u=c.querySelector("th"),u?o=innerHeight(u):o=innerHeight(c)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<o||i<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[a]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return outerWidth(this.TABLE)}getHeight(){return outerHeight(this.TABLE)}getTotalWidth(){const e=outerWidth(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=outerHeight(this.hider);return e!==0?e:this.getHeight()}isVisible(){return isVisible(this.TABLE)}_modifyRowHeaderWidth(e){let t=isFunction2(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return typeof e!="number"&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}},table_default=Table,MIXIN_NAME="stickyRowsBottom",stickyRowsBottom={getFirstRenderedRow(){const e=this.wtSettings.getSetting("totalRows"),t=this.wtSettings.getSetting("fixedRowsBottom"),r=e-t;return e===0||t===0?-1:r<0?0:r},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};defineGetter(stickyRowsBottom,"MIXIN_NAME",MIXIN_NAME,{writable:!1,enumerable:!1});var stickyRowsBottom_default=stickyRowsBottom,MIXIN_NAME2="stickyColumnsStart",stickyColumnsStart={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const e=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),e)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};defineGetter(stickyColumnsStart,"MIXIN_NAME",MIXIN_NAME2,{writable:!1,enumerable:!1});var stickyColumnsStart_default=stickyColumnsStart,BottomInlineStartCornerOverlayTable=class extends table_default{constructor(e,t,r,i){super(e,t,r,i,CLONE_BOTTOM_INLINE_START_CORNER)}};mixin(BottomInlineStartCornerOverlayTable,stickyRowsBottom_default),mixin(BottomInlineStartCornerOverlayTable,stickyColumnsStart_default);var bottomInlineStartCorner_default=BottomInlineStartCornerOverlayTable,import_es_error_cause44=__toESM(require_es_error_cause(),1),CLONE_TOP="top",CLONE_BOTTOM="bottom",CLONE_INLINE_START="inline_start",CLONE_TOP_INLINE_START_CORNER="top_inline_start_corner",CLONE_BOTTOM_INLINE_START_CORNER="bottom_inline_start_corner",CLONE_TYPES=[CLONE_TOP,CLONE_BOTTOM,CLONE_INLINE_START,CLONE_TOP_INLINE_START_CORNER,CLONE_BOTTOM_INLINE_START_CORNER],CLONE_CLASS_NAMES=new Map([[CLONE_TOP,`ht_clone_${CLONE_TOP}`],[CLONE_BOTTOM,`ht_clone_${CLONE_BOTTOM}`],[CLONE_INLINE_START,`ht_clone_${CLONE_INLINE_START} ht_clone_left`],[CLONE_TOP_INLINE_START_CORNER,`ht_clone_${CLONE_TOP_INLINE_START_CORNER} ht_clone_top_left_corner`],[CLONE_BOTTOM_INLINE_START_CORNER,`ht_clone_${CLONE_BOTTOM_INLINE_START_CORNER} ht_clone_bottom_left_corner`]]),import_es_error_cause43=__toESM(require_es_error_cause(),1),import_es_error_cause42=__toESM(require_es_error_cause(),1),import_es_array_push14=__toESM(require_es_array_push(),1),import_es_error_cause41=__toESM(require_es_error_cause(),1);function _classPrivateMethodInitSpec3(e,t){_checkPrivateRedeclaration7(e,t),t.add(e)}function _checkPrivateRedeclaration7(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty30(e,t,r){return(t=_toPropertyKey30(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey30(e){var t=_toPrimitive30(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive30(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand7(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _Scroll_brand=new WeakSet,Scroll=class{constructor(e){_classPrivateMethodInitSpec3(this,_Scroll_brand),_defineProperty30(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,t,r,i,o){const a=this.scrollViewportHorizontally(e.col,r,o),c=this.scrollViewportVertically(e.row,t,i);return a||c}scrollViewportHorizontally(e,t,r){const{drawn:i,totalColumns:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const a=t===void 0&&r===void 0,{fixedColumnsStart:c,inlineStartOverlay:u}=this.dataAccessObject;if(a&&e<c||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),!Number.isInteger(e)||e<0||e>o))return!1;const h=this.getFirstVisibleColumn(),d=this.getLastVisibleColumn();let f=!1;return(a&&(e<h||e>d)||!a)&&(f=u.scrollTo(e,a?e>=this.getLastPartiallyVisibleColumn():t)),f}scrollViewportVertically(e,t,r){const{drawn:i,totalRows:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const a=t===void 0&&r===void 0,{fixedRowsBottom:c,fixedRowsTop:u,topOverlay:h}=this.dataAccessObject;if(a&&(e<u||e>o-c-1)||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),!Number.isInteger(e)||e<0||e>o))return!1;const d=this.getFirstVisibleRow(),f=this.getLastVisibleRow();let m=!1;return(a&&(e<d||e>f)||!a)&&(m=h.scrollTo(e,a?e>=this.getLastPartiallyVisibleRow():r)),m}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return _assertClassBrand7(_Scroll_brand,this,_getLastRowIndex).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return _assertClassBrand7(_Scroll_brand,this,_getLastRowIndex).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return _assertClassBrand7(_Scroll_brand,this,_getLastColumnIndex).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return _assertClassBrand7(_Scroll_brand,this,_getLastColumnIndex).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}};function _getLastColumnIndex(e){const{wtSettings:t,inlineStartOverlay:r,wtTable:i,wtViewport:o,totalColumns:a,rootWindow:c}=this.dataAccessObject;if(r.mainTableScrollableElement===c){const u=t.getSetting("rtlMode");let h=null;if(u){const f=i.TABLE.getBoundingClientRect(),g=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;h=Math.abs(f.right-g)}else h=offset(i.wtRootElement).left;const d=Math.abs(getScrollLeft(c,c));if(h>d){const f=innerWidth(c);let m=o.getRowHeaderWidth();for(let g=1;g<=a;g++)if(m+=r.sumCellSizes(g-1,g),h+m-d>=f){e=g-2;break}}}return e}function _getLastRowIndex(e){const{topOverlay:t,wtTable:r,wtViewport:i,totalRows:o,rootWindow:a}=this.dataAccessObject;if(t.mainTableScrollableElement===a){const c=offset(r.wtRootElement),u=getScrollTop(a,a);if(c.top>u){const h=innerHeight(a);let d=i.getColumnHeaderHeight();for(let f=1;f<=o;f++)if(d+=t.sumCellSizes(f-1,f),c.top+d-u>=h){e=f-2;break}}}return e}var scroll_default=Scroll;function _defineProperty31(e,t,r){return(t=_toPropertyKey31(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey31(e){var t=_toPrimitive31(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive31(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CoreAbstract=class{get eventManager(){return new eventManager_default(this)}constructor(e,t){_defineProperty31(this,"wtTable",void 0),_defineProperty31(this,"wtScroll",void 0),_defineProperty31(this,"wtViewport",void 0),_defineProperty31(this,"wtOverlays",void 0),_defineProperty31(this,"selectionManager",void 0),_defineProperty31(this,"wtEvent",void 0),_defineProperty31(this,"guid",`wt_${randomString()}`),_defineProperty31(this,"drawInterrupted",!1),_defineProperty31(this,"drawn",!1),_defineProperty31(this,"domBindings",void 0),_defineProperty31(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new scroll_default(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;t<r;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,r){fastInnerText(r,e[t])}])}}createCellCoords(e,t){return new coords_default(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,r){return new range_default(e,t,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),a=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<a)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<a&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<a)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,r,i,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,t,r,i,o)}scrollViewportHorizontally(e,t,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,t,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}};function _defineProperty32(e,t,r){return(t=_toPropertyKey32(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey32(e){var t=_toPrimitive32(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive32(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Clone=class extends CoreAbstract{constructor(e,t,r){super(e,t),_defineProperty32(this,"cloneSource",void 0),_defineProperty32(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new event_default(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}};function _defineProperty33(e,t,r){return(t=_toPropertyKey33(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey33(e){var t=_toPrimitive33(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive33(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Overlay=class{constructor(e,t,r,i,o){_defineProperty33(this,"wtSettings",null),defineGetter(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=t,this.wtSettings=i;const{TABLE:a,hider:c,spreader:u,holder:h,wtRootElement:d}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=a,this.hider=c,this.spreader=u,this.holder=h,this.wtRootElement=d,this.trimmingContainer=getTrimmingContainer(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=getTrimmingContainer(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=getScrollableElement(e.TABLE)}getRelativeCellPosition(e,t,r){if(this.clone.wtTable.holder.contains(e)===!1){warn(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),a=t<this.wtSettings.getSetting("fixedRowsTop"),c=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,h={start:this.getRelativeStartPosition(u),top:u.offsetTop},d={start:this.getRelativeStartPosition(e),top:e.offsetTop};let f=null;return i?f=this.getRelativeCellPositionWithinWindow(a,o,d,h):f=this.getRelativeCellPositionWithinHolder(a,c,o,d,h),f}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let a=0,c=0;if(!t)a=i.start;else{let u=o.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(o.left+o.width+getScrollbarWidth())),a=u<=0?-1*u:0}return e?c=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:c=i.top,{start:r.start+a,top:r.top+c}}getRelativeCellPositionWithinHolder(e,t,r,i,o){const a={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let c=0,u=0;if(r||(c=a.horizontal-o.start),t){const h=this.wot.wtTable.wtRootElement.getBoundingClientRect();u=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+h.top}else e||(u=a.vertical-o.top);return{start:i.start-c,top:i.top-u}}makeClone(){if(CLONE_TYPES.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:t}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),a=r.createElement("table"),c=e.wtRootElement.parentNode;o.className=`${CLONE_CLASS_NAMES.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,t.getSetting("ariaTags")&&setAttribute(o,[A11Y_PRESENTATION()]),a.className=e.TABLE.className,e.TABLE.getAttribute("role")&&a.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(a),c.appendChild(o);const h=this.wtSettings.getSetting("preventOverflow");return h===!0||h==="horizontal"&&this.type===CLONE_TOP||h==="vertical"&&this.type===CLONE_INLINE_START?this.mainTableScrollableElement=i:i.getComputedStyle(c).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=getScrollableElement(e.TABLE),new Clone(a,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.needFullRender&&this.clone.draw(e)}reset(){const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,r=e.style,i=t.style,o=e.parentNode.style;[r,i,o].forEach(a=>{a.width="",a.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}},BottomInlineStartCornerOverlay=class extends Overlay{constructor(e,t,r,i,o,a){super(e,t,CLONE_BOTTOM_INLINE_START_CORNER,r,i),this.bottomOverlay=o,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new bottomInlineStartCorner_default(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),a=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${o}px`,t.style.bottom=`${a}px`}else resetCssTransform(t),this.repositionOverlay();let r=outerHeight(this.clone.wtTable.TABLE);const i=outerWidth(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),t.style.height=`${r}px`,t.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;t.hasVerticalScroll()||(o+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(o+=getScrollbarWidth(r)),i.style.bottom=`${o}px`}},import_es_error_cause45=__toESM(require_es_error_cause(),1),MIXIN_NAME3="calculatedColumns",calculatedColumns={getFirstRenderedColumn(){const e=this.dataAccessObject.startColumnRendered;return e===null?-1:e},getFirstVisibleColumn(){const e=this.dataAccessObject.startColumnVisible;return e===null?-1:e},getFirstPartiallyVisibleColumn(){const e=this.dataAccessObject.startColumnPartiallyVisible;return e===null?-1:e},getLastRenderedColumn(){const e=this.dataAccessObject.endColumnRendered;return e===null?-1:e},getLastVisibleColumn(){const e=this.dataAccessObject.endColumnVisible;return e===null?-1:e},getLastPartiallyVisibleColumn(){const e=this.dataAccessObject.endColumnPartiallyVisible;return e===null?-1:e},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};defineGetter(calculatedColumns,"MIXIN_NAME",MIXIN_NAME3,{writable:!1,enumerable:!1});var calculatedColumns_default=calculatedColumns,BottomOverlayTable=class extends table_default{constructor(e,t,r,i){super(e,t,r,i,CLONE_BOTTOM)}};mixin(BottomOverlayTable,stickyRowsBottom_default),mixin(BottomOverlayTable,calculatedColumns_default);var bottom_default=BottomOverlayTable;function _defineProperty34(e,t,r){return(t=_toPropertyKey34(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey34(e){var t=_toPrimitive34(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive34(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BottomOverlay=class extends Overlay{constructor(e,t,r,i){super(e,t,CLONE_BOTTOM,r,i),_defineProperty34(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new bottom_default(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),t.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;t.hasVerticalScroll()||(o+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(o+=getScrollbarWidth(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let r=!1;return this.mainTableScrollableElement===t?(t.scrollTo(getWindowScrollLeft(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("defaultRowHeight");let a=e,c=0;for(;a<t;){const u=r.getRowHeight(a);c+=u===void 0?o:u,a+=1}return c}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=getScrollbarWidth(r),c=this.clone.wtTable.holder.parentNode.style,u=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||u==="horizontal"){let d=t.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(d-=o),d=Math.min(d,e.wtRootElement.scrollWidth),c.width=`${d}px`}else c.width="";this.clone.wtTable.holder.style.width=c.width;let h=outerHeight(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(h=0),c.height=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let a=0;t&&o.offsetHeight!==o.clientHeight&&(a=getScrollbarWidth(this.domBindings.rootDocument)),t?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=a,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return getScrollTop(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),a=i-o,c=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-c+i,0),r>a&&(r=0)}return r}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==t,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||t===0)&&i.length>0){const a=this.wot.wtTable.holder.parentNode,c=hasClass(a,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(addClass(a,"innerBorderBottom"),o=!c):(removeClass(a,"innerBorderBottom"),o=c)}return o}},import_es_error_cause48=__toESM(require_es_error_cause(),1),MIXIN_NAME4="calculatedRows",calculatedRows={getFirstRenderedRow(){const e=this.dataAccessObject.startRowRendered;return e===null?-1:e},getFirstVisibleRow(){const e=this.dataAccessObject.startRowVisible;return e===null?-1:e},getFirstPartiallyVisibleRow(){const e=this.dataAccessObject.startRowPartiallyVisible;return e===null?-1:e},getLastRenderedRow(){const e=this.dataAccessObject.endRowRendered;return e===null?-1:e},getLastVisibleRow(){const e=this.dataAccessObject.endRowVisible;return e===null?-1:e},getLastPartiallyVisibleRow(){const e=this.dataAccessObject.endRowPartiallyVisible;return e===null?-1:e},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};defineGetter(calculatedRows,"MIXIN_NAME",MIXIN_NAME4,{writable:!1,enumerable:!1});var calculatedRows_default=calculatedRows,InlineStartOverlayTable=class extends table_default{constructor(e,t,r,i){super(e,t,r,i,CLONE_INLINE_START)}};mixin(InlineStartOverlayTable,calculatedRows_default),mixin(InlineStartOverlayTable,stickyColumnsStart_default);var inlineStart_default=InlineStartOverlayTable,import_es_array_push15=__toESM(require_es_array_push(),1),MIXIN_NAME5="localHooks",localHooks={_localHooks:Object.create(null),addLocalHook(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks(e,t,r,i,o,a,c){if(this._localHooks[e]){const u=this._localHooks[e].length;for(let h=0;h<u;h++)fastCall(this._localHooks[e][h],this,t,r,i,o,a,c)}},clearLocalHooks(){return this._localHooks={},this}};defineGetter(localHooks,"MIXIN_NAME",MIXIN_NAME5,{writable:!1,enumerable:!1});var localHooks_default=localHooks,Selection3=class{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}};mixin(Selection3,localHooks_default);var selection_default3=Selection3,ACTIVE_HEADER_TYPE="active-header",HEADER_TYPE="header",AREA_TYPE="area",FOCUS_TYPE="focus",FILL_TYPE="fill",ROW_TYPE="row",COLUMN_TYPE="column",CUSTOM_SELECTION_TYPE="custom-selection",CORNER_DEFAULT_STYLE=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"}),import_es_error_cause47=__toESM(require_es_error_cause(),1),import_es_array_push16=__toESM(require_es_array_push(),1),import_es_array_unscopables_flat=__toESM(require_es_array_unscopables_flat(),1),import_es_set_difference_v25=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v25=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v25=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v25=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v25=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v25=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v25=__toESM(require_es_set_union_v2(),1),import_es_error_cause46=__toESM(require_es_error_cause(),1),import_es_set_difference_v24=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v24=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v24=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v24=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v24=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v24=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v24=__toESM(require_es_set_union_v2(),1);function _classPrivateMethodInitSpec4(e,t){_checkPrivateRedeclaration8(e,t),t.add(e)}function _classPrivateFieldInitSpec6(e,t,r){_checkPrivateRedeclaration8(e,t),t.set(e,r)}function _checkPrivateRedeclaration8(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet6(e,t){return e.get(_assertClassBrand8(e,t))}function _classPrivateFieldSet6(e,t,r){return e.set(_assertClassBrand8(e,t),r),r}function _assertClassBrand8(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _selection=new WeakMap,_activeOverlaysWot=new WeakMap,_SelectionScanner_brand=new WeakSet,SelectionScanner=class{constructor(){_classPrivateMethodInitSpec4(this,_SelectionScanner_brand),_classPrivateFieldInitSpec6(this,_selection,void 0),_classPrivateFieldInitSpec6(this,_activeOverlaysWot,void 0)}setActiveOverlay(e){return _classPrivateFieldSet6(_activeOverlaysWot,this,e),this}setActiveSelection(e){return _classPrivateFieldSet6(_selection,this,e),this}scan(){const e=_classPrivateFieldGet6(_selection,this).settings.selectionType,t=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>t.add(r)),this.scanRowsInHeadersRange(r=>t.add(r))):e==="area"?this.scanCellsRange(r=>t.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>t.add(r)),this.scanRowsInHeadersRange(r=>t.add(r)),this.scanCellsRange(r=>t.add(r))):e==="fill"?this.scanCellsRange(r=>t.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>t.add(r)),this.scanRowsInHeadersRange(r=>t.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>t.add(r)),this.scanRowsInCellsRange(r=>t.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>t.add(r)),this.scanColumnsInCellsRange(r=>t.add(r))),t}scanColumnsInHeadersRange(e){const[t,r,i,o]=_classPrivateFieldGet6(_selection,this).getCorners(),{wtTable:a}=_classPrivateFieldGet6(_activeOverlaysWot,this),c=a.getRenderedColumnsCount(),u=a.getColumnHeadersCount();let h=0;for(let d=-a.getRowHeadersCount();d<c;d++){const f=a.columnFilter.renderedToSource(d);if(!(f<r||f>o)){for(let m=-u;m<0;m++){if(m<t||m>i)continue;const g=m+u;let v=a.getColumnHeader(f,g);const _=_classPrivateFieldGet6(_activeOverlaysWot,this).getSetting("onBeforeHighlightingColumnHeader",f,g,{selectionType:_classPrivateFieldGet6(_selection,this).settings.selectionType,columnCursor:h,selectionWidth:o-r+1});_!==null&&(_!==f&&(v=a.getColumnHeader(_,g)),e(v))}h+=1}}}scanRowsInHeadersRange(e){const[t,r,i,o]=_classPrivateFieldGet6(_selection,this).getCorners(),{wtTable:a}=_classPrivateFieldGet6(_activeOverlaysWot,this),c=a.getRenderedRowsCount(),u=a.getRowHeadersCount();let h=0;for(let d=-a.getColumnHeadersCount();d<c;d++){const f=a.rowFilter.renderedToSource(d);if(!(f<t||f>i)){for(let m=-u;m<0;m++){if(m<r||m>o)continue;const g=m+u;let v=a.getRowHeader(f,g);const _=_classPrivateFieldGet6(_activeOverlaysWot,this).getSetting("onBeforeHighlightingRowHeader",f,g,{selectionType:_classPrivateFieldGet6(_selection,this).settings.selectionType,rowCursor:h,selectionHeight:i-t+1});_!==null&&(_!==f&&(v=a.getRowHeader(_,g)),e(v))}h+=1}}}scanCellsRange(e){const[t,r,i,o]=_classPrivateFieldGet6(_selection,this).getCorners(),{wtTable:a}=_classPrivateFieldGet6(_activeOverlaysWot,this);_assertClassBrand8(_SelectionScanner_brand,this,_scanCellsRange).call(this,(c,u)=>{if(c>=t&&c<=i&&u>=r&&u<=o){const h=a.getCell(_classPrivateFieldGet6(_activeOverlaysWot,this).createCellCoords(c,u)),d=_classPrivateFieldGet6(_activeOverlaysWot,this).getSetting("onAfterDrawSelection",c,u,_classPrivateFieldGet6(_selection,this).settings.layerLevel);typeof d=="string"&&addClass(h,d),e(h)}})}scanRowsInCellsRange(e){const[t,,r]=_classPrivateFieldGet6(_selection,this).getCorners(),{wtTable:i}=_classPrivateFieldGet6(_activeOverlaysWot,this);_assertClassBrand8(_SelectionScanner_brand,this,_scanCellsRange).call(this,(o,a)=>{if(o>=t&&o<=r){const c=i.getCell(_classPrivateFieldGet6(_activeOverlaysWot,this).createCellCoords(o,a));e(c)}})}scanColumnsInCellsRange(e){const[,t,,r]=_classPrivateFieldGet6(_selection,this).getCorners(),{wtTable:i}=_classPrivateFieldGet6(_activeOverlaysWot,this);_assertClassBrand8(_SelectionScanner_brand,this,_scanCellsRange).call(this,(o,a)=>{if(a>=t&&a<=r){const c=i.getCell(_classPrivateFieldGet6(_activeOverlaysWot,this).createCellCoords(o,a));e(c)}})}};function _scanCellsRange(e){const{wtTable:t}=_classPrivateFieldGet6(_activeOverlaysWot,this),r=t.getRenderedRowsCount(),i=t.getRenderedColumnsCount();for(let o=0;o<r;o+=1){const a=t.rowFilter.renderedToSource(o);for(let c=0;c<i;c+=1)e(a,t.columnFilter.renderedToSource(c))}}var Border=class{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=CORNER_DEFAULT_STYLE,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,r=this.main.childNodes.length;t<r;t++){const i=this.main.childNodes[t];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),stopImmediatePropagation(e);const r=this,i=this.wot.rootDocument.body,o=t.getBoundingClientRect();t.style.display="none";function a(u){if(u.clientY<Math.floor(o.top)||u.clientY>Math.ceil(o.top+o.height)||u.clientX<Math.floor(o.left)||u.clientX>Math.ceil(o.left+o.width))return!0}function c(u){a(u)&&(r.eventManager.removeEventListener(i,"mousemove",c),t.style.display="block")}this.eventManager.addEventListener(i,"mousemove",c)}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let c=0;c<5;c++){const u=r[c],h=t.createElement("div");h.className=`wtBorder ${this.settings.className||""}`,this.settings[u]&&this.settings[u].hide&&(h.className+=" hidden"),i=h.style,i.backgroundColor=this.settings[u]&&this.settings[u].color?this.settings[u].color:e.border.color,i.height=this.settings[u]&&this.settings[u].width?`${this.settings[u].width}px`:`${e.border.width}px`,i.width=this.settings[u]&&this.settings[u].width?`${this.settings[u].width}px`:`${e.border.width}px`,this.main.appendChild(h)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),isMobileBrowser()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let a=o.bordersHolder;a||(a=t.createElement("div"),a.className="htBorders",o.bordersHolder=a,o.spreader.appendChild(a)),a.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const t=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};objectEach(i,(a,c)=>{this.selectionHandles.styles.bottomHitArea[c]=a,this.selectionHandles.styles.topHitArea[c]=a});const o={position:"absolute",height:`${t}px`,width:`${t}px`,"border-radius":`${parseInt(t/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};objectEach(o,(a,c)=>{this.selectionHandles.styles.bottom[c]=a,this.selectionHandles.styles.top[c]=a}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||t!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,t,r,i,o,a){const u=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:h,topHitArea:d,bottom:f,bottomHitArea:m}=this.selectionHandles.styles,g=parseInt(h.borderWidth,10),v=parseInt(h.width,10),_=parseInt(d.width,10),b=this.wot.wtTable.getWidth(),S=this.wot.wtTable.getHeight();h.top=`${parseInt(r-v-1,10)}px`,h[u]=`${parseInt(i-v-1,10)}px`,d.top=`${parseInt(r-_/4*3,10)}px`,d[u]=`${parseInt(i-_/4*3,10)}px`;const R=Math.min(parseInt(i+o,10),b-v-g*2),A=Math.min(parseInt(i+o-_/4,10),b-_-g*2);f[u]=`${R}px`,m[u]=`${A}px`;const I=Math.min(parseInt(r+a,10),S-v-g*2),E=Math.min(parseInt(r+a-_/4,10),S-_-g*2);f.top=`${I}px`,m.top=`${E}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(h.display="block",d.display="block",this.isPartRange(e,t)?(f.display="none",m.display="none"):(f.display="block",m.display="block")):(h.display="none",f.display="none",d.display="none",m.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(h.zIndex="9999",d.zIndex="9999"):(h.zIndex="",d.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:t,rootDocument:r,rootWindow:i}=this.wot;let o,a,c,u,h,d;const f=t.getRenderedRowsCount();for(let me=0;me<f;me+=1){const Se=t.rowFilter.renderedToSource(me);if(Se>=e[0]&&Se<=e[2]){o=Se,h=e[0];break}}for(let me=f-1;me>=0;me-=1){const Se=t.rowFilter.renderedToSource(me);if(Se>=e[0]&&Se<=e[2]){a=Se;break}}const m=t.getRenderedColumnsCount();for(let me=0;me<m;me+=1){const Se=t.columnFilter.renderedToSource(me);if(Se>=e[1]&&Se<=e[3]){c=Se,d=e[1];break}}for(let me=m-1;me>=0;me-=1){const Se=t.columnFilter.renderedToSource(me);if(Se>=e[1]&&Se<=e[3]){u=Se;break}}if(o===void 0||c===void 0){this.disappear();return}let g=t.getCell(this.wot.createCellCoords(o,c));const v=o!==a||c!==u,_=v?t.getCell(this.wot.createCellCoords(a,u)):g,b=offset(g),S=v?offset(_):b,R=offset(t.TABLE),A=outerWidth(t.TABLE),I=b.top,E=b.left,O=this.wot.wtSettings.getSetting("rtlMode");let P=0,L=0;if(O){const me=outerWidth(g),Se=i.innerWidth-R.left-A;L=E+me-S.left,P=i.innerWidth-E-me-Se-1}else L=S.left+outerWidth(_)-E,P=E-R.left-1;if(this.isEntireColumnSelected(o,a)){const me=this.getDimensionsFromHeader("columns",c,u,h,R);let Se=null;me&&([Se,P,L]=me),Se&&(g=Se)}let V=I-R.top-1,$=S.top+outerHeight(_)-I;if(this.isEntireRowSelected(c,u)){const me=this.getDimensionsFromHeader("rows",o,a,d,R);let Se=null;me&&([Se,V,$]=me),Se&&(g=Se)}const W=getComputedStyle3(g,i);parseInt(W.borderTopWidth,10)>0&&(V+=1,$=$>0?$-1:0),parseInt(W[O?"borderRightWidth":"borderLeftWidth"],10)>0&&(P+=1,L=L>0?L-1:0);const Z=O?"right":"left";this.topStyle.top=`${V}px`,this.topStyle[Z]=`${P}px`,this.topStyle.width=`${L}px`,this.topStyle.display="block",this.startStyle.top=`${V}px`,this.startStyle[Z]=`${P}px`,this.startStyle.height=`${$}px`,this.startStyle.display="block";const ie=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${V+$-ie}px`,this.bottomStyle[Z]=`${P}px`,this.bottomStyle.width=`${L}px`,this.bottomStyle.display="block",this.endStyle.top=`${V}px`,this.endStyle[Z]=`${P+L-ie}px`,this.endStyle.height=`${$+1}px`,this.endStyle.display="block";let ue=this.settings.border.cornerVisible;ue=typeof ue=="function"?ue(this.settings.layerLevel):ue;const _e=this.wot.getSetting("onModifyGetCellCoords",a,u);let[Te,pe]=[a,u];if(_e&&Array.isArray(_e)&&([,,Te,pe]=_e),isMobileBrowser()||!ue||this.isPartRange(Te,pe))this.cornerStyle.display="none";else{this.cornerStyle.top=`${V+$+this.cornerCenterPointOffset-1}px`,this.cornerStyle[Z]=`${P+L+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let me=getTrimmingContainer(t.TABLE);const Se=me===i;Se&&(me=r.documentElement);const Le=parseInt(this.cornerDefaultStyle.width,10)/2,xe=parseInt(this.cornerDefaultStyle.height,10)/2;if(u===this.wot.getSetting("totalColumns")-1){const T=Se?_.getBoundingClientRect().left:_.offsetLeft;let k=!1,D=0;O?(D=T-parseInt(this.cornerDefaultStyle.width,10)/2,k=D<0):(D=T+outerWidth(_)+parseInt(this.cornerDefaultStyle.width,10)/2,k=D>=innerWidth(me)),k&&(this.cornerStyle[Z]=`${Math.floor(P+L+this.cornerCenterPointOffset-Le)}px`,this.cornerStyle[O?"borderLeftWidth":"borderRightWidth"]=0)}a===this.wot.getSetting("totalRows")-1&&(Se?_.getBoundingClientRect().top:_.offsetTop)+outerHeight(_)+parseInt(this.cornerDefaultStyle.height,10)/2>=innerHeight(me)&&(this.cornerStyle.top=`${Math.floor(V+$+this.cornerCenterPointOffset-xe)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}isMobileBrowser()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(a,u,V,P,L,$)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,r,i,o){const{wtTable:a}=this.wot,c=a.wtRootElement.parentNode;let u=null,h=null,d=null,f=null,m=null,g=null,v=null,_=null;switch(e){case"rows":u=function(){return a.getRowHeader(...arguments)},h=function(){return outerHeight(...arguments)},d="ht__selection--rows",g="top";break;case"columns":u=function(){return a.getColumnHeader(...arguments)},h=function(){return outerWidth(...arguments)},d="ht__selection--columns",g="left";break;default:}if(c.classList.contains(d)){const b=this.wot.getSetting("columnHeaders").length;if(v=u(t,b-i),_=u(r,b-i),!v||!_)return!1;const S=offset(v),R=offset(_);return v&&_&&(f=S[g]-o[g]-1,m=R[g]+h(_)-S[g]),[v,f,m]}return!1}changeBorderStyle(e,t){const r=this[e].style,i=t[e];!i||i.hide?addClass(this[e],"hidden"):(hasClass(this[e],"hidden")&&removeClass(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const t={width:1,color:"#000"},r=this[e].style;r.backgroundColor=t.color,r.width=`${t.width}px`,r.height=`${t.width}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?addClass(this[e],"hidden"):removeClass(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",isMobileBrowser()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}},border_default=Border;function _classPrivateMethodInitSpec5(e,t){_checkPrivateRedeclaration9(e,t),t.add(e)}function _classPrivateFieldInitSpec7(e,t,r){_checkPrivateRedeclaration9(e,t),t.set(e,r)}function _checkPrivateRedeclaration9(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet7(e,t){return e.get(_assertClassBrand9(e,t))}function _classPrivateFieldSet7(e,t,r){return e.set(_assertClassBrand9(e,t),r),r}function _assertClassBrand9(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _activeOverlaysWot2=new WeakMap,_selections=new WeakMap,_scanner=new WeakMap,_appliedClasses=new WeakMap,_destroyListeners=new WeakMap,_selectionBorders=new WeakMap,_SelectionManager_brand=new WeakSet,SelectionManager=class{constructor(e){_classPrivateMethodInitSpec5(this,_SelectionManager_brand),_classPrivateFieldInitSpec7(this,_activeOverlaysWot2,void 0),_classPrivateFieldInitSpec7(this,_selections,void 0),_classPrivateFieldInitSpec7(this,_scanner,new SelectionScanner),_classPrivateFieldInitSpec7(this,_appliedClasses,new WeakMap),_classPrivateFieldInitSpec7(this,_destroyListeners,new WeakSet),_classPrivateFieldInitSpec7(this,_selectionBorders,new Map),_classPrivateFieldSet7(_selections,this,e)}setActiveOverlay(e){return _classPrivateFieldSet7(_activeOverlaysWot2,this,e),_classPrivateFieldGet7(_scanner,this).setActiveOverlay(_classPrivateFieldGet7(_activeOverlaysWot2,this)),_classPrivateFieldGet7(_appliedClasses,this).has(_classPrivateFieldGet7(_activeOverlaysWot2,this))||_classPrivateFieldGet7(_appliedClasses,this).set(_classPrivateFieldGet7(_activeOverlaysWot2,this),new Set),this}getFocusSelection(){return _classPrivateFieldGet7(_selections,this)!==null?_classPrivateFieldGet7(_selections,this).getFocus():null}getAreaSelection(){return _classPrivateFieldGet7(_selections,this)!==null?_classPrivateFieldGet7(_selections,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(_classPrivateFieldGet7(_selectionBorders,this).has(e)){const r=_classPrivateFieldGet7(_selectionBorders,this).get(e);if(r.has(_classPrivateFieldGet7(_activeOverlaysWot2,this)))return r.get(_classPrivateFieldGet7(_activeOverlaysWot2,this));const i=new border_default(_classPrivateFieldGet7(_activeOverlaysWot2,this),e.settings);return r.set(_classPrivateFieldGet7(_activeOverlaysWot2,this),i),i}const t=new border_default(_classPrivateFieldGet7(_activeOverlaysWot2,this),e.settings);return _classPrivateFieldGet7(_selectionBorders,this).set(e,new Map([[_classPrivateFieldGet7(_activeOverlaysWot2,this),t]])),t}getBorderInstances(e){var t,r;return Array.from((t=(r=_classPrivateFieldGet7(_selectionBorders,this).get(e))===null||r===void 0?void 0:r.values())!==null&&t!==void 0?t:[])}destroyBorders(e){_classPrivateFieldGet7(_selectionBorders,this).get(e).forEach(t=>t.destroy()),_classPrivateFieldGet7(_selectionBorders,this).delete(e)}render(e){if(_classPrivateFieldGet7(_selections,this)===null)return;e&&_assertClassBrand9(_SelectionManager_brand,this,_resetCells).call(this);const t=Array.from(_classPrivateFieldGet7(_selections,this)),r=new Map,i=new Map;for(let o=0;o<t.length;o++){const a=t[o],{className:c,headerAttributes:u,createLayers:h,selectionType:d}=a.settings;_classPrivateFieldGet7(_destroyListeners,this).has(a)||(_classPrivateFieldGet7(_destroyListeners,this).add(a),a.addLocalHook("destroy",()=>this.destroyBorders(a)));const f=this.getBorderInstance(a);if(a.isEmpty()){f?.disappear();continue}c&&_classPrivateFieldGet7(_scanner,this).setActiveSelection(a).scan().forEach(v=>{if(r.has(v)){const _=r.get(v);_.has(c)&&h===!0?_.set(c,_.get(c)+1):_.set(c,1)}else r.set(v,new Map([[c,1]]));u&&(i.has(v)||i.set(v,[]),v.nodeName==="TH"&&i.get(v).push(...u))});const m=a.getCorners();_classPrivateFieldGet7(_activeOverlaysWot2,this).getSetting("onBeforeDrawBorders",m,d),f?.appear(m)}r.forEach((o,a)=>{var c;const u=Array.from(o).map(h=>{let[d,f]=h;return f===1?d:[d,...Array.from({length:f-1},(m,g)=>`${d}-${g+1}`)]}).flat();u.forEach(h=>_classPrivateFieldGet7(_appliedClasses,this).get(_classPrivateFieldGet7(_activeOverlaysWot2,this)).add(h)),addClass(a,u),a.nodeName==="TD"&&Array.isArray((c=_classPrivateFieldGet7(_selections,this).options)===null||c===void 0?void 0:c.cellAttributes)&&setAttribute(a,_classPrivateFieldGet7(_selections,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{setAttribute(o,[...i.get(o)])})}};function _resetCells(){const e=_classPrivateFieldGet7(_appliedClasses,this).get(_classPrivateFieldGet7(_activeOverlaysWot2,this)),t=_classPrivateFieldGet7(_activeOverlaysWot2,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(t))for(let r=0;r<t.length;r++)e.add(t[r]);e.forEach(r=>{var i,o;const a=_classPrivateFieldGet7(_activeOverlaysWot2,this).wtTable.TABLE.querySelectorAll(`.${r}`);let c=[];Array.isArray((i=_classPrivateFieldGet7(_selections,this).options)===null||i===void 0?void 0:i.cellAttributes)&&(c=_classPrivateFieldGet7(_selections,this).options.cellAttributes.map(u=>u[0])),Array.isArray((o=_classPrivateFieldGet7(_selections,this).options)===null||o===void 0?void 0:o.headerAttributes)&&(c=[...c,..._classPrivateFieldGet7(_selections,this).options.headerAttributes.map(u=>u[0])]);for(let u=0,h=a.length;u<h;u++)removeClass(a[u],r),removeAttribute(a[u],c)}),e.clear()}var InlineStartOverlay=class extends Overlay{constructor(e,t,r,i){super(e,t,CLONE_INLINE_START,r,i)}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new inlineStart_default(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===t&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),setOverlayPosition(r,`${o}px`,"0px")):(o=this.getScrollPosition(),resetCssTransform(r));const a=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),a}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,getWindowScrollTop(t)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<t;)o+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:r}=this.domBindings,i=getScrollbarWidth(t),a=this.clone.wtTable.holder.parentNode.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||c==="vertical"){let h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=i),h=Math.min(h,e.wtRootElement.scrollHeight),a.height=`${h}px`}else a.height="";this.clone.wtTable.holder.style.height=a.height;const u=outerWidth(this.clone.wtTable.TABLE);a.width=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(CORNER_DEFAULT_STYLE.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[t]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),c=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,u=o===0&&i.length>0&&!hasClass(c.parentNode,"innerBorderInlineStart")?1:0;let h=this.getTableParentOffset(),d=0;if(t){const f=this.wot.wtTable.getColumnWidth(e),m=this.wot.wtViewport.getViewportWidth();f>m&&(t=!1)}return t&&c.offsetWidth!==c.clientWidth&&(d=getScrollbarWidth(this.domBindings.rootDocument)),t?(h+=this.sumCellSizes(0,e+1),h-=this.wot.wtViewport.getViewportWidth(),h+=u):h+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),h+=d,getMaximumScrollLeft(this.mainTableScrollableElement)===h-u&&u>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(u),this.setScrollPosition(h)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let t=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(getScrollLeft(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||t!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),a=i-o;r>a&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:t}=this,r=this.wot.wtTable.holder.parentNode,i=t.getSetting("rowHeaders"),o=t.getSetting("fixedColumnsStart"),a=t.getSetting("totalRows"),c=t.getSetting("preventOverflow")==="vertical";a?removeClass(r,"emptyRows"):addClass(r,"emptyRows");let u=!1;if(!c){if(o&&!i.length)addClass(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const h=hasClass(r,"innerBorderInlineStart");e?(addClass(r,"innerBorderLeft innerBorderInlineStart"),u=!h):(removeClass(r,"innerBorderLeft innerBorderInlineStart"),u=h)}}return u}},import_es_error_cause49=__toESM(require_es_error_cause(),1),MIXIN_NAME6="stickyRowsTop",stickyRowsTop={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),e)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};defineGetter(stickyRowsTop,"MIXIN_NAME",MIXIN_NAME6,{writable:!1,enumerable:!1});var stickyRowsTop_default=stickyRowsTop,TopInlineStartCornerOverlayTable=class extends table_default{constructor(e,t,r,i){super(e,t,r,i,CLONE_TOP_INLINE_START_CORNER)}};mixin(TopInlineStartCornerOverlayTable,stickyRowsTop_default),mixin(TopInlineStartCornerOverlayTable,stickyColumnsStart_default);var topInlineStartCorner_default=TopInlineStartCornerOverlayTable;function _defineProperty35(e,t,r){return(t=_toPropertyKey35(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey35(e){var t=_toPrimitive35(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive35(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TopInlineStartCornerOverlay=class extends Overlay{constructor(e,t,r,i,o,a){super(e,t,CLONE_TOP_INLINE_START_CORNER,r,i),_defineProperty35(this,"topOverlay",void 0),_defineProperty35(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new topInlineStartCorner_default(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();setOverlayPosition(e,`${i}px`,`${o}px`)}else resetCssTransform(e);let t=outerHeight(this.clone.wtTable.TABLE);const r=outerWidth(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${r}px`,!1}},import_es_error_cause50=__toESM(require_es_error_cause(),1),TopOverlayTable=class extends table_default{constructor(e,t,r,i){super(e,t,r,i,CLONE_TOP)}};mixin(TopOverlayTable,stickyRowsTop_default),mixin(TopOverlayTable,calculatedColumns_default);var top_default=TopOverlayTable;function _defineProperty36(e,t,r){return(t=_toPropertyKey36(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey36(e){var t=_toPrimitive36(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive36(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TopOverlay=class extends Overlay{constructor(e,t,r,i){super(e,t,CLONE_TOP,r,i),_defineProperty36(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new top_default(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===t&&(!r||r!=="vertical")){const{wtTable:c}=this.wot,u=c.hider.getBoundingClientRect(),h=Math.ceil(u.bottom),d=e.offsetHeight;o=h===d,i=this.getOverlayOffset(),setOverlayPosition(e,"0px",`${i}px`)}else i=this.getScrollPosition(),resetCssTransform(e);const a=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),a}setScrollPosition(e){const t=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(getWindowScrollLeft(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const r=this.wtSettings.getSetting("defaultRowHeight");let i=e,o=0;for(;i<t;){const a=this.wot.wtTable.getRowHeight(i);o+=a===void 0?r:a,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:r}=this.domBindings,i=getScrollbarWidth(t),a=this.clone.wtTable.holder.parentNode.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||c==="horizontal"){let h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=i),h=Math.min(h,e.wtRootElement.scrollWidth),a.width=`${h}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=outerHeight(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(CORNER_DEFAULT_STYLE.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:r,wtSettings:i}=this,a=(r.cloneSource?r.cloneSource:r).wtTable.holder,c=i.getSetting("columnHeaders"),h=i.getSetting("fixedRowsTop")===0&&c.length>0&&!hasClass(a.parentNode,"innerBorderTop")?1:0;let d=this.getTableParentOffset(),f=0;if(t){const m=this.wot.wtTable.getRowHeight(e),g=this.wot.wtViewport.getViewportHeight();m>g&&(t=!1)}if(t&&a.offsetHeight!==a.clientHeight&&(f=getScrollbarWidth(this.domBindings.rootDocument)),t){const m=i.getSetting("fixedRowsBottom"),g=i.getSetting("totalRows");d+=this.sumCellSizes(0,e+1),d-=r.wtViewport.getViewportHeight()-this.sumCellSizes(g-m,g),d+=1,d+=h}else d+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return d+=f,getMaximumScrollTop(this.mainTableScrollableElement)===d-h&&h>0&&this.wot.wtOverlays.expandHiderVerticallyBy(h),this.setScrollPosition(d)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return getScrollTop(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),a=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>a&&(r=0)}return r}adjustHeaderBordersPosition(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),a=r.getSetting("preventOverflow")==="horizontal";o?removeClass(i,"emptyColumns"):addClass(i,"emptyColumns");let c=!1;if(!t&&!a){const u=r.getSetting("fixedRowsTop"),h=this.cachedFixedRowsTop!==u,d=r.getSetting("columnHeaders");if((h||u===0)&&d.length>0){const f=hasClass(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(addClass(i,"innerBorderTop"),c=!f):(removeClass(i,"innerBorderTop"),c=f)}}return c}};function _classPrivateFieldInitSpec8(e,t,r){_checkPrivateRedeclaration10(e,t),t.set(e,r)}function _checkPrivateRedeclaration10(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty37(e,t,r){return(t=_toPropertyKey37(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey37(e){var t=_toPrimitive37(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive37(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldSet8(e,t,r){return e.set(_assertClassBrand10(e,t),r),r}function _classPrivateFieldGet8(e,t){return e.get(_assertClassBrand10(e,t))}function _assertClassBrand10(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _overlays=new WeakMap,_hasRenderingStateChanged=new WeakMap,_containerDomResizeCount=new WeakMap,_containerDomResizeCountTimeout=new WeakMap,Overlays=class{constructor(e,t,r,i,o,a){_defineProperty37(this,"wot",null),_classPrivateFieldInitSpec8(this,_overlays,[]),_defineProperty37(this,"topOverlay",null),_defineProperty37(this,"bottomOverlay",null),_defineProperty37(this,"inlineStartOverlay",null),_defineProperty37(this,"topInlineStartCornerOverlay",null),_defineProperty37(this,"bottomInlineStartCornerOverlay",null),_defineProperty37(this,"browserLineHeight",void 0),_defineProperty37(this,"wtSettings",null),_classPrivateFieldInitSpec8(this,_hasRenderingStateChanged,!1),_classPrivateFieldInitSpec8(this,_containerDomResizeCount,0),_classPrivateFieldInitSpec8(this,_containerDomResizeCountTimeout,null),_defineProperty37(this,"resizeObserver",new ResizeObserver(d=>{requestAnimationFrame2(()=>{!Array.isArray(d)||!d.length||(_classPrivateFieldSet8(_containerDomResizeCount,this,_classPrivateFieldGet8(_containerDomResizeCount,this)+1),_classPrivateFieldGet8(_containerDomResizeCount,this)===100&&(warn("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),_classPrivateFieldGet8(_containerDomResizeCountTimeout,this)!==null&&clearTimeout(_classPrivateFieldGet8(_containerDomResizeCountTimeout,this)),_classPrivateFieldSet8(_containerDomResizeCountTimeout,this,setTimeout(()=>{_classPrivateFieldSet8(_containerDomResizeCount,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=t,this.wtTable=a;const{rootDocument:c,rootWindow:u}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=getScrollbarWidth(c);const h=u.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=h?a.holder:getScrollableElement(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=u.scrollX,this.lastScrollY=u.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=[..._classPrivateFieldGet8(_overlays,this)];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,r=e.getComputedStyle(t.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new TopOverlay(...e),this.bottomOverlay=new BottomOverlay(...e),this.inlineStartOverlay=new InlineStartOverlay(...e),this.topInlineStartCornerOverlay=new TopInlineStartCornerOverlay(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new BottomInlineStartCornerOverlay(...e,this.bottomOverlay,this.inlineStartOverlay),_classPrivateFieldSet8(_overlays,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){_classPrivateFieldSet8(_hasRenderingStateChanged,this,_classPrivateFieldGet8(_overlays,this).reduce((e,t)=>t.hasRenderingStateChanged()||e,!1)),_classPrivateFieldGet8(_overlays,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),_classPrivateFieldGet8(_overlays,this).forEach(e=>{const t=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),t&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",f=>this.onKeyDown(f)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",f=>this.onTableScroll(f),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",f=>this.onTableScroll(f),{passive:!0});const o=t.devicePixelRatio&&t.devicePixelRatio>1,a=this.scrollableElement===t,c=this.wtSettings.getSetting("preventWheel"),u={passive:a};(c||o||!isChrome())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",f=>this.onCloneWheel(f,c),u),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(f=>{if(f&&f.needFullRender){const{holder:m}=f.clone.wtTable;this.eventManager.addEventListener(m,"wheel",g=>this.onCloneWheel(g,c),u)}});let d;this.eventManager.addEventListener(t,"resize",()=>{clearTimeout(d),d=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize"),_classPrivateFieldSet8(_containerDomResizeCount,this,0)},200)}),a||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const t=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==t&&o!==t&&!e.target.contains(i)||r!==t&&o!==t&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,a=e.target,c=o!==r&&a!==r&&!a.contains(o),u=i!==r&&a!==r&&!a.contains(i);if(this.keyPressed&&(c||u)||this.scrollableElement===r)return;const h=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==r&&h)&&e.preventDefault()}onKeyDown(e){this.keyPressed=isKey(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,t+=t*this.browserLineHeight);const i=this.scrollVertically(t),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=i;const a=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;a&&(a.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){if(!_classPrivateFieldGet8(_hasRenderingStateChanged,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),_classPrivateFieldSet8(_hasRenderingStateChanged,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=getScrollableElement(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,r=e.clientHeight,i=t!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:t}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),c=e.getRowHeaderWidth(),h=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,a)+1,d=c+this.inlineStartOverlay.sumCellSizes(0,o),m=t.hider.style,g=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,h-t.holder.clientHeight),v=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,d-t.holder.clientWidth),_=g()?1:0,b=v()?1:0;if(m.width=`${d+b}px`,m.height=`${h+_}px`,this.scrollbarSize>0){const{scrollHeight:S,scrollWidth:R}=t.wtRootElement,{scrollHeight:A,scrollWidth:I}=t.holder;this.hasScrollbarRight=S<A,this.hasScrollbarBottom=R<I,this.hasScrollbarRight&&t.hider.scrollWidth+this.scrollbarSize>R?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&t.hider.scrollHeight+this.scrollbarSize>S&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:t}=this;t.hider.style.height=`${parseInt(t.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:t}=this;t.hider.style.width=`${parseInt(t.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return arrayEach(t,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];arrayEach(t,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}},overlays_default=Overlays,import_es_error_cause52=__toESM(require_es_error_cause(),1);function _defineProperty38(e,t,r){return(t=_toPropertyKey38(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey38(e){var t=_toPrimitive38(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive38(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Settings=class{constructor(e){_defineProperty38(this,"settings",{}),_defineProperty38(this,"defaults",Object.freeze(this.getDefaults())),objectEach(this.defaults,(t,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(t===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,r)=>{const i=this.getSetting("data",e,t);fastInnerText(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return t===void 0?objectEach(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=t,this}getSetting(e,t,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](t,r,i,o):t!==void 0&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}},MasterTable=class extends table_default{constructor(e,t,r,i){super(e,t,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=getTrimmingContainer(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=getStyle2(e,"height",t),o=getStyle2(e,"overflow",t),a=this.holder.style,{scrollWidth:c,scrollHeight:u}=e;let h=e.offsetWidth,d=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const m=e.cloneNode(!1);m.style.overflow="auto",m.style.position="absolute",e.nextElementSibling?r.insertBefore(m,e.nextElementSibling):r.appendChild(m);const g=parseInt(getComputedStyle3(m,t).height,10);r.removeChild(m),g===0&&(d=0)}d=Math.min(d,u),a.height=i==="auto"?"auto":`${d}px`,h=Math.min(h,c),a.width=`${h}px`,a.overflow="",this.hasTableHeight=a.height==="auto"?!0:d>0,this.hasTableWidth=h>0}this.isTableVisible=isVisible(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!t.hasOversizedColumnHeadersMarked[r]){const c=e.getSetting("rowHeaders").length,u=this.getRenderedColumnsCount();for(let h=0;h<o;h++)for(let d=-1*c;d<u;d++)this.markIfOversizedColumnHeader(d);t.hasOversizedColumnHeadersMarked[r]=!0}}};mixin(MasterTable,calculatedRows_default),mixin(MasterTable,calculatedColumns_default);var master_default=MasterTable,Viewport=class{constructor(e,t,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new RenderedAllRowsCalculationType:new RenderedRowsCalculationType],["fullyVisible",()=>new FullyVisibleRowsCalculationType],["partiallyVisible",()=>new PartiallyVisibleRowsCalculationType]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new RenderedAllColumnsCalculationType:new RenderedColumnsCalculationType],["fullyVisible",()=>new FullyVisibleColumnsCalculationType],["partiallyVisible",()=>new PartiallyVisibleColumnsCalculationType]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return t===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=outerHeight(t)>0&&t.clientHeight>0?t.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:t,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=t.documentElement.offsetWidth,a=e.getSetting("totalColumns"),c=e.getSetting("preventOverflow"),u=e.getSetting("rtlMode"),h=this.wtTable.TABLE.getBoundingClientRect(),d=u?h.right-o:h.left,f=o-d;let m,g;if(c)return outerWidth(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?m=Math.min(f,o):m=Math.min(this.getContainerFillWidth(),f,o),i===r&&a>0&&this.sumColumnWidths(0,a-1)>m)return t.documentElement.clientWidth;if(i!==r&&(g=getStyle2(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),g==="scroll"||g==="hidden"||g==="auto"))return Math.max(m,i.clientWidth);const v=e.getSetting("stretchH");return v==="none"||!v?Math.max(m,outerWidth(this.wtTable.TABLE)):m}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,t){let r=0,i=e;for(;i<t;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);const r=t.offsetWidth;return this.containerWidth=r,e.removeChild(t),r}getWorkspaceOffset(){return offset(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=outerHeight(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=t.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=t.length;i<o;i++)r?(this.rowHeaderWidth+=outerWidth(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:r}=this;let i=this.getViewportHeight(),o,a;this.rowHeaderWidth=NaN;let c=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const u=t.getSetting("fixedRowsTop"),h=t.getSetting("fixedRowsBottom"),d=t.getSetting("totalRows");return u&&c>=0&&(a=this.dataAccessObject.topOverlay.sumCellSizes(0,u),c+=a,i-=a),h&&this.dataAccessObject.bottomOverlay.clone&&(a=this.dataAccessObject.bottomOverlay.sumCellSizes(d-h,d),i-=a),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=getScrollbarWidth(this.domBindings.rootDocument),new ViewportRowsCalculator({calculationTypes:e.map(f=>[f,this.rowsCalculatorTypes.get(f)()]),viewportHeight:i,scrollOffset:c,totalRows:t.getSetting("totalRows"),rowHeightFn:f=>r.getRowHeight(f),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const a=t.getSetting("fixedColumnsStart");if(a&&o>=0){const c=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,a);o+=c,i-=c}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=getScrollbarWidth(this.domBindings.rootDocument)),new ViewportColumnsCalculator({calculationTypes:e.map(c=>[c,this.columnsCalculatorTypes.get(c)()]),viewportWidth:i,scrollOffset:o,totalColumns:t.getSetting("totalColumns"),columnWidthFn:c=>r.getColumnWidth(c),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!t.getSetting("renderAllRows")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!t.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),t=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=t.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:t,endRow:r}=e;if(t===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o}=this.rowsRenderCalculator;return t<i||t===i&&t>0?!1:!(r>o||r===o&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:t,endColumn:r}=e;if(t===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o}=this.columnsRenderCalculator;return t<i||t===i&&t>0?!1:!(r>o||r===o&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){objectEach(this.hasOversizedColumnHeadersMarked,(e,t,r)=>{r[t]=void 0})}},viewport_default=Viewport,Walkontable=class extends CoreAbstract{constructor(e,t){super(e,new Settings(t));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new master_default(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new viewport_default(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new SelectionManager(this.wtSettings.getSetting("selections")),this.wtEvent=new event_default(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new overlays_default(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},t=[],r=[];objectEach(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),t.push(i)}),removeClass(this.wtTable.wtRootElement.parentNode,t),addClass(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var t;if(!CLONE_TYPES.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(t=this.wtOverlays[`${r}Overlay`])!==null&&t!==void 0?t:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}},WalkontableFacade=class es{constructor(t){t instanceof CoreAbstract?this._wot=t:this._initFromSettings(t)}_initFromSettings(t){t.facade=r=>{const i=new es(r);return()=>i},this._wot=new Walkontable(t.table,t)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(t){this._wot.drawn=t}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(t){this._wot.drawInterrupted=t}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(t){this._wot.lastMouseOver=t}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(t){this._wot.momentumScrolling=t}get touchApplied(){return this._wot.touchApplied}set touchApplied(t){this._wot.touchApplied=t}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(t){this._wot.eventListeners=t}get eventManager(){return this._wot.eventManager}createCellCoords(t,r){return this._wot.createCellCoords(t,r)}createCellRange(t,r,i){return this._wot.createCellRange(t,r,i)}draw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(t),this}getCell(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(t,r)}scrollViewport(t,r,i,o,a){return this._wot.scrollViewport(t,r,i,o,a)}scrollViewportHorizontally(t,r,i){return this._wot.scrollViewportHorizontally(t,r,i)}scrollViewportVertically(t,r,i){return this._wot.scrollViewportVertically(t,r,i)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(t){return this._wot.getOverlayByName(t)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(t,r){return this._wot.wtSettings.update(t,r),this}getSetting(t,r,i,o,a){return this._wot.wtSettings.getSetting(t,r,i,o,a)}hasSetting(t){return this._wot.wtSettings.hasSetting(t)}destroy(){this._wot.destroy()}};function mouseDown(e){let{isShiftKey:t,isLeftClick:r,isRightClick:i,coords:o,selection:a,controller:c,cellCoordsFactory:u}=e;const h=a.isSelected()?a.getSelectedRange().current():null,d=a.isSelectedByCorner(),f=a.isSelectedByRowHeader();if(a.markSource("mouse"),t&&h)o.row>=0&&o.col>=0&&!c.cell?a.setRangeEnd(o):(d||f)&&o.row>=0&&o.col>=0&&!c.cell?a.setRangeEnd(u(o.row,o.col)):d&&o.row<0&&!c.column?a.setRangeEnd(u(h.to.row,o.col)):f&&o.col<0&&!c.row?a.setRangeEnd(u(o.row,h.to.col)):(!d&&!f&&o.col<0||d&&o.col<0)&&!c.row?a.selectRows(Math.max(h.from.row,0),o.row,o.col):(!d&&!f&&o.row<0||f&&o.row<0)&&!c.column&&a.selectColumns(Math.max(h.from.col,0),o.col,o.row);else{const m=!a.inInSelection(o),g=r||i&&m;o.row<0&&o.col>=0&&!c.column?g&&a.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!c.row?g&&a.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!c.cell?g&&a.setRangeStart(o):o.col<0&&o.row<0&&a.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}a.markEndSource()}function mouseOver(e){let{isLeftClick:t,coords:r,selection:i,controller:o,cellCoordsFactory:a}=e;if(!t)return;const c=i.isSelectedByRowHeader(),u=i.isSelectedByColumnHeader(),h=i.tableProps.countCols(),d=i.tableProps.countRows();i.markSource("mouse"),u&&!o.column?i.setRangeEnd(a(d-1,r.col)):c&&!o.row?i.setRangeEnd(a(r.row,h-1)):o.cell||i.setRangeEnd(r),i.markEndSource()}var handlers=new Map([["mousedown",mouseDown],["mouseover",mouseOver],["touchstart",mouseDown]]);function handleMouseEvent(e,t){let{coords:r,selection:i,controller:o,cellCoordsFactory:a}=t;handlers.get(e.type)({coords:r,selection:i,controller:o,cellCoordsFactory:a,isShiftKey:e.shiftKey,isLeftClick:isLeftClick(e)||e.type==="touchstart",isRightClick:isRightClick(e)})}var holder=new WeakMap,rootInstanceSymbol=Symbol("rootInstance");function registerAsRootInstance(e){holder.set(e,!0)}function hasValidParameter(e){return e===rootInstanceSymbol}function isRootInstance(e){return holder.has(e)}function _classPrivateMethodInitSpec6(e,t){_checkPrivateRedeclaration11(e,t),t.add(e)}function _classPrivateFieldInitSpec9(e,t,r){_checkPrivateRedeclaration11(e,t),t.set(e,r)}function _checkPrivateRedeclaration11(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty39(e,t,r){return(t=_toPropertyKey39(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey39(e){var t=_toPrimitive39(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive39(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet9(e,t){return e.get(_assertClassBrand11(e,t))}function _classPrivateFieldSet9(e,t,r){return e.set(_assertClassBrand11(e,t),r),r}function _assertClassBrand11(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _columnHeadersCount=new WeakMap,_rowHeadersCount=new WeakMap,_selectionMouseDown=new WeakMap,_mouseDown=new WeakMap,_table=new WeakMap,_lastWidth=new WeakMap,_lastHeight=new WeakMap,_TableView_brand=new WeakSet,TableView=class{constructor(e){_classPrivateMethodInitSpec6(this,_TableView_brand),_defineProperty39(this,"hot",void 0),_defineProperty39(this,"eventManager",void 0),_defineProperty39(this,"settings",void 0),_defineProperty39(this,"THEAD",void 0),_defineProperty39(this,"TBODY",void 0),_defineProperty39(this,"_wt",void 0),_defineProperty39(this,"activeWt",void 0),_classPrivateFieldInitSpec9(this,_columnHeadersCount,0),_classPrivateFieldInitSpec9(this,_rowHeadersCount,0),_defineProperty39(this,"postponedAdjustElementsSize",!1),_classPrivateFieldInitSpec9(this,_selectionMouseDown,!1),_classPrivateFieldInitSpec9(this,_mouseDown,void 0),_classPrivateFieldInitSpec9(this,_table,void 0),_classPrivateFieldInitSpec9(this,_lastWidth,0),_classPrivateFieldInitSpec9(this,_lastHeight,0),this.hot=e,this.eventManager=new eventManager_default(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,t){const r=this._wt.getCell(e,t);return r<0?null:r}scrollViewport(e,t,r,i,o){return this._wt.scrollViewport(e,t,r,i,o)}scrollViewportHorizontally(e,t,r){return this._wt.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return this._wt.scrollViewportVertically(e,t,r)}createElements(){const{rootElement:e,rootDocument:t}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),addClass(e,"handsontable"),_classPrivateFieldSet9(_table,this,t.createElement("TABLE")),addClass(_classPrivateFieldGet9(_table,this),"htCore"),this.hot.getSettings().tableClassName&&addClass(_classPrivateFieldGet9(_table,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(setAttribute(_classPrivateFieldGet9(_table,this),[A11Y_PRESENTATION()]),setAttribute(e,[A11Y_TREEGRID(),A11Y_ROWCOUNT(-1),A11Y_COLCOUNT(this.hot.countCols()),A11Y_MULTISELECTABLE()])),this.THEAD=t.createElement("THEAD"),_classPrivateFieldGet9(_table,this).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),_classPrivateFieldGet9(_table,this).appendChild(this.TBODY),this.hot.table=_classPrivateFieldGet9(_table,this),this.hot.container.insertBefore(_classPrivateFieldGet9(_table,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:t,selection:r,rootWindow:i}=this.hot,o=t.documentElement;this.eventManager.addEventListener(e,"mousedown",c=>{_classPrivateFieldSet9(_selectionMouseDown,this,!0),this.isTextSelectionAllowed(c.target)||(clearTextSelection(i),c.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{_classPrivateFieldSet9(_selectionMouseDown,this,!1)}),this.eventManager.addEventListener(e,"mousemove",c=>{_classPrivateFieldGet9(_selectionMouseDown,this)&&!this.isTextSelectionAllowed(c.target)&&(this.settings.fragmentSelection&&clearTextSelection(i),c.preventDefault())}),this.eventManager.addEventListener(o,"keyup",c=>{r.isInProgress()&&!c.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",c=>{r.isInProgress()&&isLeftClick(c)&&r.finish(),_classPrivateFieldSet9(_mouseDown,this,!1);const u=isOutsideInput(t.activeElement);isInput(t.activeElement)&&!u||(u||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(c.target)&&!isRightClick(c))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",c=>{r.isInProgress()&&isRightClick(c)&&(r.finish(),_classPrivateFieldSet9(_mouseDown,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),_classPrivateFieldSet9(_mouseDown,this,!1)}),this.eventManager.addEventListener(o,"mousedown",c=>{const u=c.target,h=c.x||c.clientX,d=c.y||c.clientY;let f=c.target;if(_classPrivateFieldGet9(_mouseDown,this)||!e||!this.hot.view)return;const{holder:m}=this._wt.wtTable;if(f===m){const v=getScrollbarWidth(t);if(t.elementFromPoint(h+v,d)!==m||t.elementFromPoint(h,d+v)!==m)return}else for(;f!==o;){if(f===null){if(c.isTargetWebComponent)break;return}if(f===e)return;f=f.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(u):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=getParentWindow(i);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=getParentWindow(a);this.eventManager.addEventListener(_classPrivateFieldGet9(_table,this),"selectstart",c=>{this.settings.fragmentSelection||isInput(c.target)||c.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,r))}translateFromRenderableToVisualIndex(e,t){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return r===null&&(r=e),i===null&&(i=t),[r,i]}countRenderableIndexes(e,t){const r=Math.min(e.getNotTrimmedIndexesLength(),t),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,t),a=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(a))return 0;let c=0;return t<0?c=a+1:t>0&&(c=i-a),c}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let r=0;for(let i=e;i<=t;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,t){let r=0;for(let i=e;i<=t;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:_classPrivateFieldGet9(_table,this),isDataViewInstance:()=>isRootInstance(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,a)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,a)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((a,c)=>{const u=a>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(a):a;this.appendRowHeader(u,c)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),_classPrivateFieldSet9(_rowHeadersCount,this,o.length),this.hot.getSettings().ariaTags&&_assertClassBrand11(_TableView_brand,this,_getAriaColcount).call(this)===this.hot.countCols()&&_assertClassBrand11(_TableView_brand,this,_updateAriaColcount).call(this,_classPrivateFieldGet9(_rowHeadersCount,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((a,c)=>{const u=a>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(a):a;this.appendColHeader(u,c)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),_classPrivateFieldSet9(_columnHeadersCount,this,o.length),o},columnWidth:o=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(a===null?o:a)},rowHeight:o=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(a===null?o:a)},rowHeightByOverlayName:(o,a)=>{const c=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),u=c===null?o:c;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(u),u,a)},cellRenderer:(o,a,c)=>{const[u,h]=this.translateFromRenderableToVisualIndex(o,a),d=this.hot.runHooks("modifyGetCellCoords",u,h);let f=u,m=h;Array.isArray(d)&&([f,m]=d);const g=this.hot.getCellMeta(f,m),v=this.hot.colToProp(m);let _=this.hot.getDataAtRowProp(f,v);this.hot.hasHook("beforeValueRender")&&(_=this.hot.runHooks("beforeValueRender",_,g)),this.hot.runHooks("beforeRenderer",c,u,h,v,_,g),this.hot.getCellRenderer(g)(this.hot,c,u,h,v,_,g),this.hot.runHooks("afterRenderer",c,u,h,v,_,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&isVisible(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,a,c,u)=>{const h=this.translateFromRenderableToVisualCoords(a),d={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=u,_classPrivateFieldSet9(_mouseDown,this,!0),this.hot.runHooks("beforeOnCellMouseDown",o,h,c,d),!isImmediatePropagationStopped(o)&&(handleMouseEvent(o,{coords:h,selection:this.hot.selection,controller:d,cellCoordsFactory:(f,m)=>this.hot._createCellCoords(f,m)}),this.hot.runHooks("afterOnCellMouseDown",o,h,c),this.activeWt=this._wt)},onCellContextMenu:(o,a,c,u)=>{const h=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,_classPrivateFieldSet9(_mouseDown,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,h,c),!isImmediatePropagationStopped(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,h,c),this.activeWt=this._wt)},onCellMouseOut:(o,a,c,u)=>{const h=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,this.hot.runHooks("beforeOnCellMouseOut",o,h,c),!isImmediatePropagationStopped(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,h,c),this.activeWt=this._wt)},onCellMouseOver:(o,a,c,u)=>{const h=this.translateFromRenderableToVisualCoords(a),d={row:!1,column:!1,cell:!1};this.activeWt=u,this.hot.runHooks("beforeOnCellMouseOver",o,h,c,d),!isImmediatePropagationStopped(o)&&(_classPrivateFieldGet9(_mouseDown,this)&&handleMouseEvent(o,{coords:h,selection:this.hot.selection,controller:d,cellCoordsFactory:(f,m)=>this.hot._createCellCoords(f,m)}),this.hot.runHooks("afterOnCellMouseOver",o,h,c),this.activeWt=this._wt)},onCellMouseUp:(o,a,c,u)=>{const h=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,this.hot.runHooks("beforeOnCellMouseUp",o,h,c),!(isImmediatePropagationStopped(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,h,c),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,a)=>this.beforeRender(o,a),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:o=>{const a=this.hot.rowIndexMapper,c=o<0;let u=o;return!c&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u),this.hot.runHooks("beforeViewportScroll"),c?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:o=>{const a=this.hot.columnIndexMapper,c=o<0;let u=o;return!c&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u),this.hot.runHooks("beforeViewportScroll"),c?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,a,c)=>{const u=this.hot.rowIndexMapper,h=o<0;let d=o;h||(d=u.getVisualFromRenderableIndex(o));const f=this.hot.runHooks("beforeHighlightingRowHeader",d,a,c);return h?f:u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(f,1))},onBeforeHighlightingColumnHeader:(o,a,c)=>{const u=this.hot.columnIndexMapper,h=o<0;let d=o;h||(d=u.getVisualFromRenderableIndex(o));const f=this.hot.runHooks("beforeHighlightingColumnHeader",d,a,c);return h?f:u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(f,1))},onAfterDrawSelection:(o,a,c)=>{let u;const[h,d]=this.translateFromRenderableToVisualIndex(o,a),f=this.hot.selection.getSelectedRange();if(f.size()>0){const g=f.peekByIndex(c??0);u=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",h,d,u,c)},onBeforeDrawBorders:(o,a)=>{const[c,u,h,d]=o,f=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(c),this.hot.columnIndexMapper.getVisualFromRenderableIndex(u),this.hot.rowIndexMapper.getVisualFromRenderableIndex(h),this.hot.columnIndexMapper.getVisualFromRenderableIndex(d)];return this.hot.runHooks("beforeDrawBorders",f,a)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,a)=>{const c=this.hot.columnIndexMapper.getVisualFromRenderableIndex(a);return this.hot.runHooks("beforeStretchingColumnWidth",o,c)},onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,a,c)=>{const u=this.hot.rowIndexMapper,h=this.hot.columnIndexMapper,d=a>=0?h.getVisualFromRenderableIndex(a):a,f=o>=0?u.getVisualFromRenderableIndex(o):o,m=this.hot.runHooks("modifyGetCellCoords",f,d,c);if(Array.isArray(m)){const[g,v,_,b]=m;return[g>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1)):g,v>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(v,1)):v,_>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(_,-1)):_,b>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(b,-1)):b]}},viewportRowCalculatorOverride:o=>{let a=this.settings.viewportRowRenderingOffset;if(a==="auto"&&this.settings.fixedRowsTop&&(a=10),a>0||a==="auto"){const c=this.countRenderableRows(),u=o.startRow,h=o.endRow;if(typeof a=="number")o.startRow=Math.max(u-a,0),o.endRow=Math.min(h+a,c-1);else if(a==="auto"){const d=Math.ceil(h/c*12);o.startRow=Math.max(u-d,0),o.endRow=Math.min(h+d,c-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let a=this.settings.viewportColumnRenderingOffset;if(a==="auto"&&this.settings.fixedColumnsStart&&(a=10),a>0||a==="auto"){const c=this.countRenderableColumns(),u=o.startColumn,h=o.endColumn;if(typeof a=="number"&&(o.startColumn=Math.max(u-a,0),o.endColumn=Math.min(h+a,c-1)),a==="auto"){const d=Math.ceil(h/c*6);o.startColumn=Math.max(u-d,0),o.endColumn=Math.min(h+d,c-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new WalkontableFacade(e),this.activeWt=this._wt;const t=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(t,"mousedown",o=>{o.target===t&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(t,"contextmenu",o=>{o.target===t&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(isInput(e))return!0;const t=isChildOf(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&t||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&t||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return _classPrivateFieldGet9(_mouseDown,this)}isSelectedOnlyCell(){var e,t;return(e=(t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const r=t.firstChild;if(!hasClass(r,"relative")){empty2(t),this.appendRowHeader(e,t);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),a=r.createElement("span");o.className="relative",a.className="rowHeader",this.updateCellHeader(a,e,i),o.appendChild(a),t.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const a=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return a?a.split(" "):[]};if(t.firstChild){const a=t.firstChild;hasClass(a,"relative")?(this.updateCellHeader(a.querySelector(".colHeader"),e,r,i),a.className="",addClass(a,["relative",...o()])):(empty2(t),this.appendColHeader(e,t,r,i))}else{const{rootDocument:a}=this.hot,c=a.createElement("div"),u=a.createElement("span"),h=o();c.classList.add("relative",...h),u.className="colHeader",this.settings.ariaTags&&(setAttribute(c,...A11Y_PRESENTATION()),setAttribute(u,...A11Y_PRESENTATION())),this.updateCellHeader(u,e,r,i),c.appendChild(u),t.appendChild(c)}this.hot.runHooks("afterGetColHeader",e,t,i)}updateCellHeader(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=t;const a=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(hasClass(e,"colHeader")?o=a.wtTable.columnFilter.sourceToRendered(t):hasClass(e,"rowHeader")&&(o=a.wtTable.rowFilter.sourceToRendered(t))),o>-1?fastInnerHTML(e,r(t,i)):(fastInnerText(e,"\xA0"),addClass(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,t){_classPrivateFieldSet9(_lastWidth,this,e),_classPrivateFieldSet9(_lastHeight,this,t)}getLastSize(){return{width:_classPrivateFieldGet9(_lastWidth,this),height:_classPrivateFieldGet9(_lastHeight,this)}}getFirstRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedRow(),1):null}getLastRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedRow(),-1):null}getFirstRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedColumn(),1):null}getLastRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedColumn(),-1):null}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return _classPrivateFieldGet9(_columnHeadersCount,this)}getRowHeadersCount(){return _classPrivateFieldGet9(_rowHeadersCount,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var t;return((t=this._wt.wtOverlays.getParentOverlay(e))!==null&&t!==void 0?t:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}isVisible(){return this._wt.wtTable.isVisible()}destroy(){this._wt.destroy(),this.eventManager.destroy()}};function _getAriaColcount(){return parseInt(this.hot.rootElement.getAttribute(A11Y_COLCOUNT()[0]),10)}function _updateAriaColcount(e){const t=_assertClassBrand11(_TableView_brand,this,_getAriaColcount).call(this)+e;setAttribute(this.hot.rootElement,...A11Y_COLCOUNT(t))}var tableView_default=TableView,import_es_error_cause54=__toESM(require_es_error_cause(),1),import_es_array_push21=__toESM(require_es_array_push(),1),data_exports={};__export(data_exports,{countFirstRowKeys:()=>countFirstRowKeys,createEmptySpreadsheetData:()=>createEmptySpreadsheetData,createSpreadsheetData:()=>createSpreadsheetData,createSpreadsheetObjectData:()=>createSpreadsheetObjectData,dataRowToChangesArray:()=>dataRowToChangesArray,isArrayOfArrays:()=>isArrayOfArrays,isArrayOfObjects:()=>isArrayOfObjects,spreadsheetColumnIndex:()=>spreadsheetColumnIndex,spreadsheetColumnLabel:()=>spreadsheetColumnLabel});var import_es_array_push20=__toESM(require_es_array_push(),1),COLUMN_LABEL_BASE="ABCDEFGHIJKLMNOPQRSTUVWXYZ",COLUMN_LABEL_BASE_LENGTH=COLUMN_LABEL_BASE.length;function spreadsheetColumnLabel(e){let t=e+1,r="",i;for(;t>0;)i=(t-1)%COLUMN_LABEL_BASE_LENGTH,r=String.fromCharCode(65+i)+r,t=parseInt((t-i)/COLUMN_LABEL_BASE_LENGTH,10);return r}function spreadsheetColumnIndex(e){let t=0;if(e)for(let r=0,i=e.length-1;r<e.length;r+=1,i-=1)t+=COLUMN_LABEL_BASE_LENGTH**i*(COLUMN_LABEL_BASE.indexOf(e[r])+1);return t-=1,t}function createSpreadsheetData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const r=[];let i,o;for(i=0;i<e;i++){const a=[];for(o=0;o<t;o++)a.push(spreadsheetColumnLabel(o)+(i+1));r.push(a)}return r}function createSpreadsheetObjectData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const r=[];let i,o;for(i=0;i<e;i++){const a={};for(o=0;o<t;o++)a[`prop${o}`]=spreadsheetColumnLabel(o)+(i+1);r.push(a)}return r}function createEmptySpreadsheetData(e,t){const r=[];let i;for(let o=0;o<e;o++){i=[];for(let a=0;a<t;a++)i.push("");r.push(i)}return r}function dataRowToChangesArray(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e;const i=[];return(!Array.isArray(e)||!Array.isArray(e[0]))&&(r=[e]),r.forEach((o,a)=>{Array.isArray(o)?o.forEach((c,u)=>{i.push([a+t,u,c])}):Object.keys(o).forEach(c=>{i.push([a+t,c,o[c]])})}),i}function countFirstRowKeys(e){let t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&isObject2(e[0])&&(t=deepObjectSize(e[0]))),t}function isArrayOfArrays(e){return!!(Array.isArray(e)&&e.length&&e.every(t=>Array.isArray(t)))}function isArrayOfObjects(e){return!!(Array.isArray(e)&&e.length&&e.every(t=>typeof t=="object"&&!Array.isArray(t)&&t!==null))}function _defineProperty40(e,t,r){return(t=_toPropertyKey40(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey40(e){var t=_toPrimitive40(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive40(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DataSource=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];_defineProperty40(this,"hot",void 0),_defineProperty40(this,"data",void 0),_defineProperty40(this,"dataType","array"),_defineProperty40(this,"colToProp",()=>{}),_defineProperty40(this,"propToCol",()=>{}),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),t!==void 0&&!Number.isInteger(t)?t:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const t=[];return arrayEach(this.data,(r,i)=>{const o=this.getAtCell(i,e);t.push(o)}),t}getAtRow(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=t===void 0&&r===void 0,{dataDotNotation:a}=this.hot.getSettings();let c=null,u=null;if(c=this.modifyRowData(e),Array.isArray(c))u=[],o?c.forEach((h,d)=>{u[d]=this.getAtPhysicalCell(e,d,c)}):rangeEach(t,r,h=>{u[h-t]=this.getAtPhysicalCell(e,h,c)});else if(isObject2(c)||isFunction2(c))if(i?u=[]:u={},!o||i){const d=this.countFirstRowKeys()-1;rangeEach(0,d,f=>{const m=this.colToProp(f);if(f>=(t||0)&&f<=(r||d)&&!Number.isInteger(m)){const g=this.getAtPhysicalCell(e,m,c);i?u.push(g):a?setProperty(u,m,g):u[m]=g}})}else objectEach(c,(h,d)=>{const f=this.getAtPhysicalCell(e,d,c);a?setProperty(u,d,f):u[d]=f});return u}setAtCell(e,t,r){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=createObjectPropListener(r);this.hot.runHooks("modifySourceData",e,t,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(t)?this.data[e][t]=r:setProperty(this.data[e],t,r)}}getAtPhysicalCell(e,t,r){let i=null;if(r)if(typeof t=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?getProperty(r,t):r[t]}else typeof t=="function"?i=t(r):i=r[t];if(this.hot.hasHook("modifySourceData")){const o=createObjectPropListener(i);this.hot.runHooks("modifySourceData",e,t,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,t){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,a=null,c=null,u=null;e===null||t===null?(i=!0,o=0,c=this.countRows()-1):(o=Math.min(e.row,t.row),a=Math.min(e.col,t.col),c=Math.max(e.row,t.row),u=Math.max(e.col,t.col));const h=[];return rangeEach(o,c,d=>{h.push(i?this.getAtRow(d,void 0,void 0,r):this.getAtRow(d,a,u,r))}),h}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return countFirstRowKeys(this.data)}destroy(){this.data=null,this.hot=null}},dataSource_default=DataSource,import_es_error_cause63=__toESM(require_es_error_cause(),1),import_es_set_difference_v27=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v27=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v27=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v27=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v27=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v27=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v27=__toESM(require_es_set_union_v2(),1),import_es_error_cause58=__toESM(require_es_error_cause(),1),import_es_array_push23=__toESM(require_es_array_push(),1),import_es_error_cause55=__toESM(require_es_error_cause(),1),import_es_array_push22=__toESM(require_es_array_push(),1);function _defineProperty41(e,t,r){return(t=_toPropertyKey41(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey41(e){var t=_toPrimitive41(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive41(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IndexMap=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;_defineProperty41(this,"indexedValues",[]),_defineProperty41(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length?(this.indexedValues[e]=t,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,isFunction2(this.initValueOrFn)?rangeEach(e-1,t=>this.indexedValues.push(this.initValueOrFn(t))):rangeEach(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}};mixin(IndexMap,localHooks_default);function getListWithInsertedItems(e,t,r,i){const o=r.length?r[0]:void 0;return[...e.slice(0,o),...r.map((a,c)=>isFunction2(i)?i(a,c):i),...o===void 0?[]:e.slice(o)]}function getListWithRemovedItems(e,t){return arrayFilter(e,(r,i)=>t.includes(i)===!1)}var PhysicalIndexToValueMap=class extends IndexMap{insert(e,t){this.indexedValues=getListWithInsertedItems(this.indexedValues,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=getListWithRemovedItems(this.indexedValues,e),super.remove(e)}},HidingMap=class extends PhysicalIndexToValueMap{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return arrayReduce(this.getValues(),(e,t,r)=>(t&&e.push(r),e),[])}},import_es_error_cause56=__toESM(require_es_error_cause(),1);function getListWithInsertedItems2(e,t,r){return[...e.slice(0,t),...r,...e.slice(t)]}function getListWithRemovedItems2(e,t){return arrayFilter(e,r=>t.includes(r)===!1)}function getDecreasedIndexes(e,t){return arrayMap(e,r=>r-t.filter(i=>i<r).length)}function getIncreasedIndexes(e,t){const r=t[0],i=t.length;return arrayMap(e,o=>o>=r?o+i:o)}function _defineProperty42(e,t,r){return(t=_toPropertyKey42(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey42(e){var t=_toPrimitive42(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive42(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LinkedPhysicalIndexToValueMap=class extends IndexMap{constructor(){super(...arguments),_defineProperty42(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=t,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=getListWithRemovedItems2(this.orderOfIndexes,[e]),isFunction2(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=getListWithInsertedItems(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=getIncreasedIndexes(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=getListWithRemovedItems(this.indexedValues,e),this.orderOfIndexes=getListWithRemovedItems2(this.orderOfIndexes,e),this.orderOfIndexes=getDecreasedIndexes(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}},import_es_array_push24=__toESM(require_es_array_push(),1),TrimmingMap=class extends PhysicalIndexToValueMap{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return arrayReduce(this.getValues(),(e,t,r)=>(t&&e.push(r),e),[])}},import_es_error_cause57=__toESM(require_es_error_cause(),1),alterStrategies=new Map([["indexesSequence",{getListWithInsertedItems:getListWithInsertedItems2,getListWithRemovedItems:getListWithRemovedItems2}],["physicallyIndexed",{getListWithInsertedItems,getListWithRemovedItems}]]),alterUtilsFactory=e=>{if(alterStrategies.has(e)===!1)throw new Error(`Alter strategy with ID '${e}' does not exist.`);return alterStrategies.get(e)},IndexesSequence=class extends IndexMap{constructor(){super(e=>e)}insert(e,t){const r=getIncreasedIndexes(this.indexedValues,t);this.indexedValues=getListWithInsertedItems2(r,e,t),super.insert(e,t)}remove(e){const t=getListWithRemovedItems2(this.indexedValues,e);this.indexedValues=getDecreasedIndexes(t,e),super.remove(e)}},availableIndexMapTypes=new Map([["hiding",HidingMap],["index",IndexMap],["linkedPhysicalIndexToValue",LinkedPhysicalIndexToValueMap],["physicalIndexToValue",PhysicalIndexToValueMap],["trimming",TrimmingMap]]);function createIndexMap(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!availableIndexMapTypes.has(e))throw new Error(`The provided map type ("${e}") does not exist.`);return new(availableIndexMapTypes.get(e))(t)}var import_es_error_cause60=__toESM(require_es_error_cause(),1),import_es_array_push25=__toESM(require_es_array_push(),1),import_es_error_cause59=__toESM(require_es_error_cause(),1);function _defineProperty43(e,t,r){return(t=_toPropertyKey43(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey43(e){var t=_toPrimitive43(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive43(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var registeredMaps=0,MapCollection=class{constructor(){_defineProperty43(this,"collection",new Map)}register(e,t){this.collection.has(e)===!1&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)),registeredMaps+=1)}unregister(e){const t=this.collection.get(e);isDefined(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),registeredMaps-=1)}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return isUndefined(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(r=>{r.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}};mixin(MapCollection,localHooks_default);function getRegisteredMapsCounter(){return registeredMaps}function _defineProperty44(e,t,r){return(t=_toPropertyKey44(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey44(e){var t=_toPrimitive44(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive44(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AggregatedCollection=class extends MapCollection{constructor(e,t){super(),_defineProperty44(this,"mergedValuesCache",[]),_defineProperty44(this,"aggregationFunction",void 0),_defineProperty44(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const t=arrayMap(this.get(),o=>o.getValues()),r=[],i=isDefined(t[0])&&t[0].length||0;for(let o=0;o<i;o+=1){const a=[];for(let c=0;c<this.getLength();c+=1)a.push(t[c][o]);r.push(a)}return arrayMap(r,this.aggregationFunction)}getMergedValueAtIndex(e,t){const r=this.getMergedValues(t)[e];return isDefined(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}},import_es_error_cause62=__toESM(require_es_error_cause(),1),import_es_set_difference_v26=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v26=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v26=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v26=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v26=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v26=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v26=__toESM(require_es_set_union_v2(),1),import_es_error_cause61=__toESM(require_es_error_cause(),1);function _classPrivateFieldInitSpec10(e,t,r){_checkPrivateRedeclaration12(e,t),t.set(e,r)}function _checkPrivateRedeclaration12(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet10(e,t,r){return e.set(_assertClassBrand12(e,t),r),r}function _classPrivateFieldGet10(e,t){return e.get(_assertClassBrand12(e,t))}function _assertClassBrand12(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _currentInitialChanges=new WeakMap,ChangesObserver=class{constructor(){_classPrivateFieldInitSpec10(this,_currentInitialChanges,[])}subscribe(e){return this.addLocalHook("change",e),this._write(_classPrivateFieldGet10(_currentInitialChanges,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){_classPrivateFieldSet10(_currentInitialChanges,this,e)}};mixin(ChangesObserver,localHooks_default);var import_es_array_push26=__toESM(require_es_array_push(),1);function arrayDiff(e,t){const r=[];let i=0,o=0;for(;i<e.length&&o<t.length;i++,o++)e[i]!==t[o]&&r.push({op:"replace",index:o,oldValue:e[i],newValue:t[o]});for(;i<t.length;i++)r.push({op:"insert",index:i,oldValue:void 0,newValue:t[i]});for(;o<e.length;o++)r.push({op:"remove",index:o,oldValue:e[o],newValue:void 0});return r}function _classPrivateFieldInitSpec11(e,t,r){_checkPrivateRedeclaration13(e,t),t.set(e,r)}function _checkPrivateRedeclaration13(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet11(e,t){return e.get(_assertClassBrand13(e,t))}function _classPrivateFieldSet11(e,t,r){return e.set(_assertClassBrand13(e,t),r),r}function _assertClassBrand13(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _observers=new WeakMap,_indexMatrix=new WeakMap,_currentIndexState=new WeakMap,_isMatrixIndexesInitialized=new WeakMap,_initialIndexValue=new WeakMap,ChangesObservable=class{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_classPrivateFieldInitSpec11(this,_observers,new Set),_classPrivateFieldInitSpec11(this,_indexMatrix,[]),_classPrivateFieldInitSpec11(this,_currentIndexState,[]),_classPrivateFieldInitSpec11(this,_isMatrixIndexesInitialized,!1),_classPrivateFieldInitSpec11(this,_initialIndexValue,!1),_classPrivateFieldSet11(_initialIndexValue,this,e??!1)}createObserver(){const e=new ChangesObserver;return _classPrivateFieldGet11(_observers,this).add(e),e.addLocalHook("unsubscribe",()=>{_classPrivateFieldGet11(_observers,this).delete(e)}),e._writeInitialChanges(arrayDiff(_classPrivateFieldGet11(_indexMatrix,this),_classPrivateFieldGet11(_currentIndexState,this))),e}emit(e){let t=_classPrivateFieldGet11(_currentIndexState,this);(!_classPrivateFieldGet11(_isMatrixIndexesInitialized,this)||_classPrivateFieldGet11(_indexMatrix,this).length!==e.length)&&(e.length===0?e=new Array(t.length).fill(_classPrivateFieldGet11(_initialIndexValue,this)):_classPrivateFieldSet11(_indexMatrix,this,new Array(e.length).fill(_classPrivateFieldGet11(_initialIndexValue,this))),_classPrivateFieldGet11(_isMatrixIndexesInitialized,this)||(_classPrivateFieldSet11(_isMatrixIndexesInitialized,this,!0),t=_classPrivateFieldGet11(_indexMatrix,this)));const r=arrayDiff(t,e);_classPrivateFieldGet11(_observers,this).forEach(i=>i._write(r)),_classPrivateFieldSet11(_currentIndexState,this,e)}};function _defineProperty45(e,t,r){return(t=_toPropertyKey45(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey45(e){var t=_toPrimitive45(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive45(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IndexMapper=class{constructor(){_defineProperty45(this,"indexesSequence",new IndexesSequence),_defineProperty45(this,"trimmingMapsCollection",new AggregatedCollection(e=>e.some(t=>t===!0),!1)),_defineProperty45(this,"hidingMapsCollection",new AggregatedCollection(e=>e.some(t=>t===!0),!1)),_defineProperty45(this,"variousMapsCollection",new MapCollection),_defineProperty45(this,"hidingChangesObservable",new ChangesObservable({initialIndexValue:!1})),_defineProperty45(this,"notTrimmedIndexesCache",[]),_defineProperty45(this,"notHiddenIndexesCache",[]),_defineProperty45(this,"isBatched",!1),_defineProperty45(this,"indexesSequenceChanged",!1),_defineProperty45(this,"indexesChangeSource",void 0),_defineProperty45(this,"trimmedIndexesChanged",!1),_defineProperty45(this,"hiddenIndexesChanged",!1),_defineProperty45(this,"renderablePhysicalIndexesCache",[]),_defineProperty45(this,"fromPhysicalToVisualIndexesCache",new Map),_defineProperty45(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,r){return this.registerMap(e,createIndexMap(t,r))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof TrimmingMap?this.trimmingMapsCollection.register(e,t):t instanceof HidingMap?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const r=this.getNumberOfIndexes();return r>0&&t.init(r),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return isDefined(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return isDefined(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return isDefined(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return isDefined(t)?t:null}getNearestNotHiddenIndex(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let a=-1;return t>0?a=o.findIndex(c=>c>e):a=o.reverse().findIndex(c=>c<e),a===-1?r?this.getNearestNotHiddenIndex(e,-t,!1):null:o[a]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){typeof e=="number"&&(e=[e]);const r=arrayMap(e,h=>this.getPhysicalFromVisualIndex(h)),i=this.getNotTrimmedIndexesLength(),o=e.length,a=getListWithRemovedItems2(this.getIndexesSequence(),r),c=a.filter(h=>this.isTrimmed(h)===!1);let u=a.indexOf(c[c.length-1])+1;if(t+o<i){const h=c[t];u=a.indexOf(h)}this.indexesChangeSource="move",this.setIndexesSequence(getListWithInsertedItems2(a,u,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const r=this.getNotTrimmedIndexes()[e],i=isDefined(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),a=arrayMap(new Array(t).fill(i),(c,u)=>c+u);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,a),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,a),this.hidingMapsCollection.insertToEvery(o,a),this.variousMapsCollection.insertToEvery(o,a),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&t===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const r=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(r,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const r=this.getPhysicalFromRenderableIndex(t),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,t)}}};mixin(IndexMapper,localHooks_default);function extendNotExistingKeys(e,t){return objectEach(t,(r,i)=>{isUndefined(e[i])&&(e[i]=r)}),e}function normalizeLanguageCode(e){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(e);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:e}function warnUserAboutLanguageRegistration(e){isDefined(e)&&error(toSingleLine`Language with code "${e}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function pluralize(e,t){return Array.isArray(e)&&Number.isInteger(t)?e[t]:e}var{register:registerGloballyPhraseFormatter,getValues:getGlobalPhraseFormatters}=staticRegister("phraseFormatters");function register4(e,t){registerGloballyPhraseFormatter(e,t)}function getAll(){return getGlobalPhraseFormatters()}register4("pluralize",pluralize);var constants_exports={};__export(constants_exports,{CHECKBOX_CHECKED:()=>CHECKBOX_CHECKED,CHECKBOX_RENDERER_NAMESPACE:()=>CHECKBOX_RENDERER_NAMESPACE,CHECKBOX_UNCHECKED:()=>CHECKBOX_UNCHECKED,CONTEXTMENU_ITEMS_ADD_COMMENT:()=>CONTEXTMENU_ITEMS_ADD_COMMENT,CONTEXTMENU_ITEMS_ALIGNMENT:()=>CONTEXTMENU_ITEMS_ALIGNMENT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:()=>CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:()=>CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:()=>CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:()=>CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:()=>CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:()=>CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:()=>CONTEXTMENU_ITEMS_ALIGNMENT_TOP,CONTEXTMENU_ITEMS_BORDERS:()=>CONTEXTMENU_ITEMS_BORDERS,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:()=>CONTEXTMENU_ITEMS_BORDERS_BOTTOM,CONTEXTMENU_ITEMS_BORDERS_LEFT:()=>CONTEXTMENU_ITEMS_BORDERS_LEFT,CONTEXTMENU_ITEMS_BORDERS_RIGHT:()=>CONTEXTMENU_ITEMS_BORDERS_RIGHT,CONTEXTMENU_ITEMS_BORDERS_TOP:()=>CONTEXTMENU_ITEMS_BORDERS_TOP,CONTEXTMENU_ITEMS_CLEAR_COLUMN:()=>CONTEXTMENU_ITEMS_CLEAR_COLUMN,CONTEXTMENU_ITEMS_COPY:()=>CONTEXTMENU_ITEMS_COPY,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:()=>CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:()=>CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:()=>CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,CONTEXTMENU_ITEMS_CUT:()=>CONTEXTMENU_ITEMS_CUT,CONTEXTMENU_ITEMS_EDIT_COMMENT:()=>CONTEXTMENU_ITEMS_EDIT_COMMENT,CONTEXTMENU_ITEMS_FREEZE_COLUMN:()=>CONTEXTMENU_ITEMS_FREEZE_COLUMN,CONTEXTMENU_ITEMS_HIDE_COLUMN:()=>CONTEXTMENU_ITEMS_HIDE_COLUMN,CONTEXTMENU_ITEMS_HIDE_ROW:()=>CONTEXTMENU_ITEMS_HIDE_ROW,CONTEXTMENU_ITEMS_INSERT_LEFT:()=>CONTEXTMENU_ITEMS_INSERT_LEFT,CONTEXTMENU_ITEMS_INSERT_RIGHT:()=>CONTEXTMENU_ITEMS_INSERT_RIGHT,CONTEXTMENU_ITEMS_MERGE_CELLS:()=>CONTEXTMENU_ITEMS_MERGE_CELLS,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:()=>CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:()=>CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,CONTEXTMENU_ITEMS_NO_ITEMS:()=>CONTEXTMENU_ITEMS_NO_ITEMS,CONTEXTMENU_ITEMS_READ_ONLY:()=>CONTEXTMENU_ITEMS_READ_ONLY,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:()=>CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,CONTEXTMENU_ITEMS_REDO:()=>CONTEXTMENU_ITEMS_REDO,CONTEXTMENU_ITEMS_REMOVE_BORDERS:()=>CONTEXTMENU_ITEMS_REMOVE_BORDERS,CONTEXTMENU_ITEMS_REMOVE_COLUMN:()=>CONTEXTMENU_ITEMS_REMOVE_COLUMN,CONTEXTMENU_ITEMS_REMOVE_COMMENT:()=>CONTEXTMENU_ITEMS_REMOVE_COMMENT,CONTEXTMENU_ITEMS_REMOVE_ROW:()=>CONTEXTMENU_ITEMS_REMOVE_ROW,CONTEXTMENU_ITEMS_ROW_ABOVE:()=>CONTEXTMENU_ITEMS_ROW_ABOVE,CONTEXTMENU_ITEMS_ROW_BELOW:()=>CONTEXTMENU_ITEMS_ROW_BELOW,CONTEXTMENU_ITEMS_SHOW_COLUMN:()=>CONTEXTMENU_ITEMS_SHOW_COLUMN,CONTEXTMENU_ITEMS_SHOW_ROW:()=>CONTEXTMENU_ITEMS_SHOW_ROW,CONTEXTMENU_ITEMS_UNDO:()=>CONTEXTMENU_ITEMS_UNDO,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:()=>CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,CONTEXTMENU_ITEMS_UNMERGE_CELLS:()=>CONTEXTMENU_ITEMS_UNMERGE_CELLS,CONTEXT_MENU_ITEMS_NAMESPACE:()=>CONTEXT_MENU_ITEMS_NAMESPACE,FILTERS_BUTTONS_CANCEL:()=>FILTERS_BUTTONS_CANCEL,FILTERS_BUTTONS_CLEAR:()=>FILTERS_BUTTONS_CLEAR,FILTERS_BUTTONS_OK:()=>FILTERS_BUTTONS_OK,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:()=>FILTERS_BUTTONS_PLACEHOLDER_SEARCH,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:()=>FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,FILTERS_BUTTONS_PLACEHOLDER_VALUE:()=>FILTERS_BUTTONS_PLACEHOLDER_VALUE,FILTERS_BUTTONS_SELECT_ALL:()=>FILTERS_BUTTONS_SELECT_ALL,FILTERS_CONDITIONS_AFTER:()=>FILTERS_CONDITIONS_AFTER,FILTERS_CONDITIONS_BEFORE:()=>FILTERS_CONDITIONS_BEFORE,FILTERS_CONDITIONS_BEGINS_WITH:()=>FILTERS_CONDITIONS_BEGINS_WITH,FILTERS_CONDITIONS_BETWEEN:()=>FILTERS_CONDITIONS_BETWEEN,FILTERS_CONDITIONS_BY_VALUE:()=>FILTERS_CONDITIONS_BY_VALUE,FILTERS_CONDITIONS_CONTAINS:()=>FILTERS_CONDITIONS_CONTAINS,FILTERS_CONDITIONS_EMPTY:()=>FILTERS_CONDITIONS_EMPTY,FILTERS_CONDITIONS_ENDS_WITH:()=>FILTERS_CONDITIONS_ENDS_WITH,FILTERS_CONDITIONS_EQUAL:()=>FILTERS_CONDITIONS_EQUAL,FILTERS_CONDITIONS_GREATER_THAN:()=>FILTERS_CONDITIONS_GREATER_THAN,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:()=>FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,FILTERS_CONDITIONS_LESS_THAN:()=>FILTERS_CONDITIONS_LESS_THAN,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:()=>FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,FILTERS_CONDITIONS_NAMESPACE:()=>FILTERS_CONDITIONS_NAMESPACE,FILTERS_CONDITIONS_NONE:()=>FILTERS_CONDITIONS_NONE,FILTERS_CONDITIONS_NOT_BETWEEN:()=>FILTERS_CONDITIONS_NOT_BETWEEN,FILTERS_CONDITIONS_NOT_CONTAIN:()=>FILTERS_CONDITIONS_NOT_CONTAIN,FILTERS_CONDITIONS_NOT_EMPTY:()=>FILTERS_CONDITIONS_NOT_EMPTY,FILTERS_CONDITIONS_NOT_EQUAL:()=>FILTERS_CONDITIONS_NOT_EQUAL,FILTERS_CONDITIONS_TODAY:()=>FILTERS_CONDITIONS_TODAY,FILTERS_CONDITIONS_TOMORROW:()=>FILTERS_CONDITIONS_TOMORROW,FILTERS_CONDITIONS_YESTERDAY:()=>FILTERS_CONDITIONS_YESTERDAY,FILTERS_DIVS_FILTER_BY_CONDITION:()=>FILTERS_DIVS_FILTER_BY_CONDITION,FILTERS_DIVS_FILTER_BY_VALUE:()=>FILTERS_DIVS_FILTER_BY_VALUE,FILTERS_LABELS_CONJUNCTION:()=>FILTERS_LABELS_CONJUNCTION,FILTERS_LABELS_DISJUNCTION:()=>FILTERS_LABELS_DISJUNCTION,FILTERS_NAMESPACE:()=>FILTERS_NAMESPACE,FILTERS_VALUES_BLANK_CELLS:()=>FILTERS_VALUES_BLANK_CELLS});var CONTEXT_MENU_ITEMS_NAMESPACE="ContextMenu:items",CM_ALIAS=CONTEXT_MENU_ITEMS_NAMESPACE,CONTEXTMENU_ITEMS_NO_ITEMS=`${CM_ALIAS}.noItems`,CONTEXTMENU_ITEMS_ROW_ABOVE=`${CM_ALIAS}.insertRowAbove`,CONTEXTMENU_ITEMS_ROW_BELOW=`${CM_ALIAS}.insertRowBelow`,CONTEXTMENU_ITEMS_INSERT_LEFT=`${CM_ALIAS}.insertColumnOnTheLeft`,CONTEXTMENU_ITEMS_INSERT_RIGHT=`${CM_ALIAS}.insertColumnOnTheRight`,CONTEXTMENU_ITEMS_REMOVE_ROW=`${CM_ALIAS}.removeRow`,CONTEXTMENU_ITEMS_REMOVE_COLUMN=`${CM_ALIAS}.removeColumn`,CONTEXTMENU_ITEMS_UNDO=`${CM_ALIAS}.undo`,CONTEXTMENU_ITEMS_REDO=`${CM_ALIAS}.redo`,CONTEXTMENU_ITEMS_READ_ONLY=`${CM_ALIAS}.readOnly`,CONTEXTMENU_ITEMS_CLEAR_COLUMN=`${CM_ALIAS}.clearColumn`,CONTEXTMENU_ITEMS_COPY=`${CM_ALIAS}.copy`,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS=`${CM_ALIAS}.copyWithHeaders`,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS=`${CM_ALIAS}.copyWithGroupHeaders`,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY=`${CM_ALIAS}.copyHeadersOnly`,CONTEXTMENU_ITEMS_CUT=`${CM_ALIAS}.cut`,CONTEXTMENU_ITEMS_FREEZE_COLUMN=`${CM_ALIAS}.freezeColumn`,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN=`${CM_ALIAS}.unfreezeColumn`,CONTEXTMENU_ITEMS_MERGE_CELLS=`${CM_ALIAS}.mergeCells`,CONTEXTMENU_ITEMS_UNMERGE_CELLS=`${CM_ALIAS}.unmergeCells`,CONTEXTMENU_ITEMS_ADD_COMMENT=`${CM_ALIAS}.addComment`,CONTEXTMENU_ITEMS_EDIT_COMMENT=`${CM_ALIAS}.editComment`,CONTEXTMENU_ITEMS_REMOVE_COMMENT=`${CM_ALIAS}.removeComment`,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT=`${CM_ALIAS}.readOnlyComment`,CONTEXTMENU_ITEMS_ALIGNMENT=`${CM_ALIAS}.align`,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT=`${CM_ALIAS}.align.left`,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER=`${CM_ALIAS}.align.center`,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT=`${CM_ALIAS}.align.right`,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY=`${CM_ALIAS}.align.justify`,CONTEXTMENU_ITEMS_ALIGNMENT_TOP=`${CM_ALIAS}.align.top`,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE=`${CM_ALIAS}.align.middle`,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM=`${CM_ALIAS}.align.bottom`,CONTEXTMENU_ITEMS_BORDERS=`${CM_ALIAS}.borders`,CONTEXTMENU_ITEMS_BORDERS_TOP=`${CM_ALIAS}.borders.top`,CONTEXTMENU_ITEMS_BORDERS_RIGHT=`${CM_ALIAS}.borders.right`,CONTEXTMENU_ITEMS_BORDERS_BOTTOM=`${CM_ALIAS}.borders.bottom`,CONTEXTMENU_ITEMS_BORDERS_LEFT=`${CM_ALIAS}.borders.left`,CONTEXTMENU_ITEMS_REMOVE_BORDERS=`${CM_ALIAS}.borders.remove`,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD=`${CM_ALIAS}.nestedHeaders.insertChildRow`,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD=`${CM_ALIAS}.nestedHeaders.detachFromParent`,CONTEXTMENU_ITEMS_HIDE_COLUMN=`${CM_ALIAS}.hideColumn`,CONTEXTMENU_ITEMS_SHOW_COLUMN=`${CM_ALIAS}.showColumn`,CONTEXTMENU_ITEMS_HIDE_ROW=`${CM_ALIAS}.hideRow`,CONTEXTMENU_ITEMS_SHOW_ROW=`${CM_ALIAS}.showRow`,FILTERS_NAMESPACE="Filters:",FILTERS_CONDITIONS_NAMESPACE=`${FILTERS_NAMESPACE}conditions`,FILTERS_CONDITIONS_NONE=`${FILTERS_CONDITIONS_NAMESPACE}.none`,FILTERS_CONDITIONS_EMPTY=`${FILTERS_CONDITIONS_NAMESPACE}.isEmpty`,FILTERS_CONDITIONS_NOT_EMPTY=`${FILTERS_CONDITIONS_NAMESPACE}.isNotEmpty`,FILTERS_CONDITIONS_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.isEqualTo`,FILTERS_CONDITIONS_NOT_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.isNotEqualTo`,FILTERS_CONDITIONS_BEGINS_WITH=`${FILTERS_CONDITIONS_NAMESPACE}.beginsWith`,FILTERS_CONDITIONS_ENDS_WITH=`${FILTERS_CONDITIONS_NAMESPACE}.endsWith`,FILTERS_CONDITIONS_CONTAINS=`${FILTERS_CONDITIONS_NAMESPACE}.contains`,FILTERS_CONDITIONS_NOT_CONTAIN=`${FILTERS_CONDITIONS_NAMESPACE}.doesNotContain`,FILTERS_CONDITIONS_BY_VALUE=`${FILTERS_CONDITIONS_NAMESPACE}.byValue`,FILTERS_CONDITIONS_GREATER_THAN=`${FILTERS_CONDITIONS_NAMESPACE}.greaterThan`,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.greaterThanOrEqualTo`,FILTERS_CONDITIONS_LESS_THAN=`${FILTERS_CONDITIONS_NAMESPACE}.lessThan`,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.lessThanOrEqualTo`,FILTERS_CONDITIONS_BETWEEN=`${FILTERS_CONDITIONS_NAMESPACE}.isBetween`,FILTERS_CONDITIONS_NOT_BETWEEN=`${FILTERS_CONDITIONS_NAMESPACE}.isNotBetween`,FILTERS_CONDITIONS_AFTER=`${FILTERS_CONDITIONS_NAMESPACE}.after`,FILTERS_CONDITIONS_BEFORE=`${FILTERS_CONDITIONS_NAMESPACE}.before`,FILTERS_CONDITIONS_TODAY=`${FILTERS_CONDITIONS_NAMESPACE}.today`,FILTERS_CONDITIONS_TOMORROW=`${FILTERS_CONDITIONS_NAMESPACE}.tomorrow`,FILTERS_CONDITIONS_YESTERDAY=`${FILTERS_CONDITIONS_NAMESPACE}.yesterday`,FILTERS_DIVS_FILTER_BY_CONDITION=`${FILTERS_NAMESPACE}labels.filterByCondition`,FILTERS_DIVS_FILTER_BY_VALUE=`${FILTERS_NAMESPACE}labels.filterByValue`,FILTERS_LABELS_CONJUNCTION=`${FILTERS_NAMESPACE}labels.conjunction`,FILTERS_LABELS_DISJUNCTION=`${FILTERS_NAMESPACE}labels.disjunction`,FILTERS_VALUES_BLANK_CELLS=`${FILTERS_NAMESPACE}values.blankCells`,FILTERS_BUTTONS_SELECT_ALL=`${FILTERS_NAMESPACE}buttons.selectAll`,FILTERS_BUTTONS_CLEAR=`${FILTERS_NAMESPACE}buttons.clear`,FILTERS_BUTTONS_OK=`${FILTERS_NAMESPACE}buttons.ok`,FILTERS_BUTTONS_CANCEL=`${FILTERS_NAMESPACE}buttons.cancel`,FILTERS_BUTTONS_PLACEHOLDER_SEARCH=`${FILTERS_NAMESPACE}buttons.placeholder.search`,FILTERS_BUTTONS_PLACEHOLDER_VALUE=`${FILTERS_NAMESPACE}buttons.placeholder.value`,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE=`${FILTERS_NAMESPACE}buttons.placeholder.secondValue`,CHECKBOX_RENDERER_NAMESPACE="CheckboxRenderer:",CHECKBOX_CHECKED=`${CHECKBOX_RENDERER_NAMESPACE}checked`,CHECKBOX_UNCHECKED=`${CHECKBOX_RENDERER_NAMESPACE}unchecked`,dictionary={languageCode:"en-US",[CONTEXTMENU_ITEMS_NO_ITEMS]:"No available options",[CONTEXTMENU_ITEMS_ROW_ABOVE]:"Insert row above",[CONTEXTMENU_ITEMS_ROW_BELOW]:"Insert row below",[CONTEXTMENU_ITEMS_INSERT_LEFT]:"Insert column left",[CONTEXTMENU_ITEMS_INSERT_RIGHT]:"Insert column right",[CONTEXTMENU_ITEMS_REMOVE_ROW]:["Remove row","Remove rows"],[CONTEXTMENU_ITEMS_REMOVE_COLUMN]:["Remove column","Remove columns"],[CONTEXTMENU_ITEMS_UNDO]:"Undo",[CONTEXTMENU_ITEMS_REDO]:"Redo",[CONTEXTMENU_ITEMS_READ_ONLY]:"Read only",[CONTEXTMENU_ITEMS_CLEAR_COLUMN]:"Clear column",[CONTEXTMENU_ITEMS_ALIGNMENT]:"Alignment",[CONTEXTMENU_ITEMS_ALIGNMENT_LEFT]:"Left",[CONTEXTMENU_ITEMS_ALIGNMENT_CENTER]:"Center",[CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT]:"Right",[CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY]:"Justify",[CONTEXTMENU_ITEMS_ALIGNMENT_TOP]:"Top",[CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE]:"Middle",[CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM]:"Bottom",[CONTEXTMENU_ITEMS_FREEZE_COLUMN]:"Freeze column",[CONTEXTMENU_ITEMS_UNFREEZE_COLUMN]:"Unfreeze column",[CONTEXTMENU_ITEMS_BORDERS]:"Borders",[CONTEXTMENU_ITEMS_BORDERS_TOP]:"Top",[CONTEXTMENU_ITEMS_BORDERS_RIGHT]:"Right",[CONTEXTMENU_ITEMS_BORDERS_BOTTOM]:"Bottom",[CONTEXTMENU_ITEMS_BORDERS_LEFT]:"Left",[CONTEXTMENU_ITEMS_REMOVE_BORDERS]:"Remove border(s)",[CONTEXTMENU_ITEMS_ADD_COMMENT]:"Add comment",[CONTEXTMENU_ITEMS_EDIT_COMMENT]:"Edit comment",[CONTEXTMENU_ITEMS_REMOVE_COMMENT]:"Delete comment",[CONTEXTMENU_ITEMS_READ_ONLY_COMMENT]:"Read-only comment",[CONTEXTMENU_ITEMS_MERGE_CELLS]:"Merge cells",[CONTEXTMENU_ITEMS_UNMERGE_CELLS]:"Unmerge cells",[CONTEXTMENU_ITEMS_COPY]:"Copy",[CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS]:["Copy with header","Copy with headers"],[CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS]:["Copy with group header","Copy with group headers"],[CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY]:["Copy header only","Copy headers only"],[CONTEXTMENU_ITEMS_CUT]:"Cut",[CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD]:"Insert child row",[CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD]:"Detach from parent",[CONTEXTMENU_ITEMS_HIDE_COLUMN]:["Hide column","Hide columns"],[CONTEXTMENU_ITEMS_SHOW_COLUMN]:["Show column","Show columns"],[CONTEXTMENU_ITEMS_HIDE_ROW]:["Hide row","Hide rows"],[CONTEXTMENU_ITEMS_SHOW_ROW]:["Show row","Show rows"],[FILTERS_CONDITIONS_NONE]:"None",[FILTERS_CONDITIONS_EMPTY]:"Is empty",[FILTERS_CONDITIONS_NOT_EMPTY]:"Is not empty",[FILTERS_CONDITIONS_EQUAL]:"Is equal to",[FILTERS_CONDITIONS_NOT_EQUAL]:"Is not equal to",[FILTERS_CONDITIONS_BEGINS_WITH]:"Begins with",[FILTERS_CONDITIONS_ENDS_WITH]:"Ends with",[FILTERS_CONDITIONS_CONTAINS]:"Contains",[FILTERS_CONDITIONS_NOT_CONTAIN]:"Does not contain",[FILTERS_CONDITIONS_GREATER_THAN]:"Greater than",[FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL]:"Greater than or equal to",[FILTERS_CONDITIONS_LESS_THAN]:"Less than",[FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL]:"Less than or equal to",[FILTERS_CONDITIONS_BETWEEN]:"Is between",[FILTERS_CONDITIONS_NOT_BETWEEN]:"Is not between",[FILTERS_CONDITIONS_AFTER]:"After",[FILTERS_CONDITIONS_BEFORE]:"Before",[FILTERS_CONDITIONS_TODAY]:"Today",[FILTERS_CONDITIONS_TOMORROW]:"Tomorrow",[FILTERS_CONDITIONS_YESTERDAY]:"Yesterday",[FILTERS_VALUES_BLANK_CELLS]:"Blank cells",[FILTERS_DIVS_FILTER_BY_CONDITION]:"Filter by condition",[FILTERS_DIVS_FILTER_BY_VALUE]:"Filter by value",[FILTERS_LABELS_CONJUNCTION]:"And",[FILTERS_LABELS_DISJUNCTION]:"Or",[FILTERS_BUTTONS_SELECT_ALL]:"Select all",[FILTERS_BUTTONS_CLEAR]:"Clear",[FILTERS_BUTTONS_OK]:"OK",[FILTERS_BUTTONS_CANCEL]:"Cancel",[FILTERS_BUTTONS_PLACEHOLDER_SEARCH]:"Search",[FILTERS_BUTTONS_PLACEHOLDER_VALUE]:"Value",[FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE]:"Second value",[CHECKBOX_CHECKED]:"Checked",[CHECKBOX_UNCHECKED]:"Unchecked"},en_US_default=dictionary,dictionaryKeys=constants_exports,DEFAULT_LANGUAGE_CODE=en_US_default.languageCode,{register:registerGloballyLanguageDictionary,getItem:getGlobalLanguageDictionary,hasItem:hasGlobalLanguageDictionary,getValues:getGlobalLanguagesDictionaries}=staticRegister("languagesDictionaries");registerLanguageDictionary(en_US_default);function registerLanguageDictionary(e,t){let r=e,i=t;return isObject2(e)&&(i=e,r=i.languageCode),extendLanguageDictionary(r,i),registerGloballyLanguageDictionary(r,deepClone(i)),deepClone(i)}function extendLanguageDictionary(e,t){e!==DEFAULT_LANGUAGE_CODE&&extendNotExistingKeys(t,getGlobalLanguageDictionary(DEFAULT_LANGUAGE_CODE))}function getLanguageDictionary(e){return hasLanguageDictionary(e)?deepClone(getGlobalLanguageDictionary(e)):null}function hasLanguageDictionary(e){return hasGlobalLanguageDictionary(e)}function getLanguagesDictionaries(){return getGlobalLanguagesDictionaries()}function getTranslatedPhrase(e,t,r){const i=getLanguageDictionary(e);if(i===null)return null;const o=i[t];if(isUndefined(o))return null;const a=getFormattedPhrase(o,r);return Array.isArray(a)?a[0]:a}function getFormattedPhrase(e,t){let r=e;return arrayEach(getAll(),i=>{r=i(e,t)}),r}function getValidLanguageCode(e){let t=normalizeLanguageCode(e);return hasLanguageDictionary(t)||(t=DEFAULT_LANGUAGE_CODE,warnUserAboutLanguageRegistration(e)),t}var import_es_error_cause69=__toESM(require_es_error_cause(),1),import_es_array_push30=__toESM(require_es_array_push(),1),import_es_set_difference_v29=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v29=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v29=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v29=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v29=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v29=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v29=__toESM(require_es_set_union_v2(),1),import_es_error_cause65=__toESM(require_es_error_cause(),1),import_es_array_push27=__toESM(require_es_array_push(),1),import_es_error_cause64=__toESM(require_es_error_cause(),1);function _defineProperty46(e,t,r){return(t=_toPropertyKey46(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey46(e){var t=_toPrimitive46(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive46(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var VisualSelection=class extends selection_default3{constructor(e,t){super(e,null),_defineProperty46(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:r}=e,i=this.getNearestNotHiddenCoords(t,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=t,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,t,r){return t<0?t:e.getNearestNotHiddenIndex(t,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let a=null;if((o===null||o.col===null||o.row===null)&&(a=this.getNearestNotHiddenCoords(t,r,i)),a!==null&&e.overlaps(a)){const c=e.highlight.clone();if(c.row>=0&&(c.row=a.row),c.col>=0&&(c.col=a.col),this.cellRange===null){const u=this.settings.visualToRenderableCoords(c);this.cellRange=this.settings.createCellRange(u)}e.setHighlight(c)}return this.settings.selectionType==="focus"&&o!==null&&a===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(t);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}},visualSelection_default=VisualSelection;function createHighlight(e){let{activeHeaderClassName:t,...r}=e;return new visualSelection_default({className:t,...r,selectionType:ACTIVE_HEADER_TYPE})}function createHighlight2(e){let{areaCornerVisible:t,...r}=e;return new visualSelection_default({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:t},...r,selectionType:AREA_TYPE})}function createHighlight3(e){let{...t}=e;return new visualSelection_default({className:"highlight",...t,selectionType:AREA_TYPE})}function createHighlight4(e){let{columnClassName:t,...r}=e;return new visualSelection_default({className:t,...r,selectionType:COLUMN_TYPE})}function createHighlight5(e){let{cellCornerVisible:t,...r}=e;return new visualSelection_default({className:"current",headerAttributes:[A11Y_SELECTED()],border:{width:2,color:"#4b89ff",cornerVisible:t},...r,selectionType:FOCUS_TYPE})}function createHighlight6(e){let{border:t,visualCellRange:r,...i}=e;return new visualSelection_default({...t,...i,selectionType:CUSTOM_SELECTION_TYPE},r)}function createHighlight7(e){let{...t}=e;return new visualSelection_default({className:"fill",border:{width:1,color:"#ff0000"},...t,selectionType:FILL_TYPE})}function createHighlight8(e){let{headerClassName:t,...r}=e;return new visualSelection_default({className:t,...r,selectionType:HEADER_TYPE})}function createHighlight9(e){let{rowClassName:t,...r}=e;return new visualSelection_default({className:t,...r,selectionType:ROW_TYPE})}function _classPrivateMethodInitSpec7(e,t){_checkPrivateRedeclaration14(e,t),t.add(e)}function _checkPrivateRedeclaration14(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty47(e,t,r){return(t=_toPropertyKey47(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey47(e){var t=_toPrimitive47(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive47(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand14(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _Highlight_brand=new WeakSet,Highlight=class{constructor(e){_classPrivateMethodInitSpec7(this,_Highlight_brand),_defineProperty47(this,"options",void 0),_defineProperty47(this,"layerLevel",0),_defineProperty47(this,"focus",void 0),_defineProperty47(this,"fill",void 0),_defineProperty47(this,"layeredAreas",new Map),_defineProperty47(this,"areas",new Map),_defineProperty47(this,"rowHeaders",new Map),_defineProperty47(this,"columnHeaders",new Map),_defineProperty47(this,"activeRowHeaders",new Map),_defineProperty47(this,"activeColumnHeaders",new Map),_defineProperty47(this,"activeCornerHeaders",new Map),_defineProperty47(this,"rowHighlights",new Map),_defineProperty47(this,"columnHighlights",new Map),_defineProperty47(this,"customSelections",[]),this.options=e,this.focus=createHighlight5(e),this.fill=createHighlight7(e)}isEnabledFor(e,t){let r=e;e===FOCUS_TYPE&&(r="current");let i=this.options.disabledCellSelection(t.row,t.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return _assertClassBrand14(_Highlight_brand,this,_createHighlight).call(this,this.layeredAreas,createHighlight2)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return _assertClassBrand14(_Highlight_brand,this,_createHighlight).call(this,this.areas,createHighlight3)}getAreas(){return[...this.areas.values()]}createRowHeader(){return _assertClassBrand14(_Highlight_brand,this,_createHighlight).call(this,this.rowHeaders,createHighlight8)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return _assertClassBrand14(_Highlight_brand,this,_createHighlight).call(this,this.columnHeaders,createHighlight8)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return _assertClassBrand14(_Highlight_brand,this,_createHighlight).call(this,this.activeRowHeaders,createHighlight)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return _assertClassBrand14(_Highlight_brand,this,_createHighlight).call(this,this.activeColumnHeaders,createHighlight)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return _assertClassBrand14(_Highlight_brand,this,_createHighlight).call(this,this.activeCornerHeaders,createHighlight)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return _assertClassBrand14(_Highlight_brand,this,_createHighlight).call(this,this.rowHighlights,createHighlight9)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return _assertClassBrand14(_Highlight_brand,this,_createHighlight).call(this,this.columnHighlights,createHighlight4)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(createHighlight6({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),arrayEach(this.areas.values(),e=>void e.clear()),arrayEach(this.layeredAreas.values(),e=>void e.clear()),arrayEach(this.rowHeaders.values(),e=>void e.clear()),arrayEach(this.columnHeaders.values(),e=>void e.clear()),arrayEach(this.activeRowHeaders.values(),e=>void e.clear()),arrayEach(this.activeColumnHeaders.values(),e=>void e.clear()),arrayEach(this.activeCornerHeaders.values(),e=>void e.clear()),arrayEach(this.rowHighlights.values(),e=>void e.clear()),arrayEach(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}};function _createHighlight(e,t){const r=this.layerLevel;if(e.has(r))return e.get(r);const i=t({layerLevel:r,...this.options});return e.set(r,i),i}var highlight_default=Highlight,import_es_error_cause66=__toESM(require_es_error_cause(),1),import_es_array_push28=__toESM(require_es_array_push(),1);function _defineProperty48(e,t,r){return(t=_toPropertyKey48(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey48(e){var t=_toPrimitive48(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive48(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SelectionRange=class{constructor(e){_defineProperty48(this,"ranges",[]),_defineProperty48(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(t=>t.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}},range_default2=SelectionRange,import_es_error_cause67=__toESM(require_es_error_cause(),1);function _classPrivateMethodInitSpec8(e,t){_checkPrivateRedeclaration15(e,t),t.add(e)}function _classPrivateFieldInitSpec12(e,t,r){_checkPrivateRedeclaration15(e,t),t.set(e,r)}function _checkPrivateRedeclaration15(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet12(e,t){return e.get(_assertClassBrand15(e,t))}function _classPrivateFieldSet12(e,t,r){return e.set(_assertClassBrand15(e,t),r),r}function _assertClassBrand15(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _range=new WeakMap,_options=new WeakMap,_offset=new WeakMap,_Transformation_brand=new WeakSet,Transformation=class{constructor(e,t){_classPrivateMethodInitSpec8(this,_Transformation_brand),_classPrivateFieldInitSpec12(this,_range,void 0),_classPrivateFieldInitSpec12(this,_options,void 0),_classPrivateFieldInitSpec12(this,_offset,{x:0,y:0}),_classPrivateFieldSet12(_range,this,e),_classPrivateFieldSet12(_options,this,t)}transformStart(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=_classPrivateFieldGet12(_options,this).createCellCoords(e,t);let o=_classPrivateFieldGet12(_range,this).current().highlight;const a=_classPrivateFieldGet12(_options,this).visualToRenderableCoords(o);let c=0,u=0;if(this.runLocalHooks("beforeTransformStart",i),a.row!==null&&a.col!==null){const{width:h,height:d}=_assertClassBrand15(_Transformation_brand,this,_getTableSize).call(this),{row:f,col:m}=_assertClassBrand15(_Transformation_brand,this,_visualToZeroBasedCoords).call(this,o),g=_classPrivateFieldGet12(_options,this).fixedRowsBottom(),v=_classPrivateFieldGet12(_options,this).minSpareRows(),_=_classPrivateFieldGet12(_options,this).minSpareCols(),b=_classPrivateFieldGet12(_options,this).autoWrapRow(),S=_classPrivateFieldGet12(_options,this).autoWrapCol(),R=_classPrivateFieldGet12(_options,this).createCellCoords(f+i.row,m+i.col);if(R.row>=d){const E=createObjectPropListener(r&&v>0&&g===0),O=R.col+1,P=_classPrivateFieldGet12(_options,this).createCellCoords(R.row-d,O>=h?O-h:O);this.runLocalHooks("beforeColumnWrap",E,_assertClassBrand15(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,P),O>=h),E.value?this.runLocalHooks("insertRowRequire",_classPrivateFieldGet12(_options,this).countRenderableRows()):S&&R.assign(P)}else if(R.row<0){const E=createObjectPropListener(S),O=R.col-1,P=_classPrivateFieldGet12(_options,this).createCellCoords(d+R.row,O<0?h+O:O);this.runLocalHooks("beforeColumnWrap",E,_assertClassBrand15(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,P),O<0),S&&R.assign(P)}if(R.col>=h){const E=createObjectPropListener(r&&_>0),O=R.row+1,P=_classPrivateFieldGet12(_options,this).createCellCoords(O>=d?O-d:O,R.col-h);this.runLocalHooks("beforeRowWrap",E,_assertClassBrand15(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,P),O>=d),E.value?this.runLocalHooks("insertColRequire",_classPrivateFieldGet12(_options,this).countRenderableColumns()):b&&R.assign(P)}else if(R.col<0){const E=createObjectPropListener(b),O=R.row-1,P=_classPrivateFieldGet12(_options,this).createCellCoords(O<0?d+O:O,h+R.col);this.runLocalHooks("beforeRowWrap",E,_assertClassBrand15(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,P),O<0),b&&R.assign(P)}const{rowDir:A,colDir:I}=_assertClassBrand15(_Transformation_brand,this,_clampCoords).call(this,R);c=A,u=I,o=_assertClassBrand15(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,R)}return this.runLocalHooks("afterTransformStart",o,c,u),o}transformEnd(e,t){const r=_classPrivateFieldGet12(_options,this).createCellCoords(e,t),i=_classPrivateFieldGet12(_range,this).current(),o=_classPrivateFieldGet12(_options,this).visualToRenderableCoords(i.highlight),a=_assertClassBrand15(_Transformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,i.to.row,i.from.row),c=_assertClassBrand15(_Transformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,i.to.col,i.from.col),u=i.to.clone();let h=0,d=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&a!==null&&c!==null){const{row:f,col:m}=_assertClassBrand15(_Transformation_brand,this,_visualToZeroBasedCoords).call(this,i.highlight),g=_classPrivateFieldGet12(_options,this).createCellCoords(a+r.row,c+r.col),v=i.getTopStartCorner(),_=i.getTopEndCorner(),b=i.getBottomEndCorner();if(r.col<0&&c>=m&&g.col<m){const I=g.col-m;g.col=_assertClassBrand15(_Transformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,v.col,_.col)+I}else if(r.col>0&&c<=m&&g.col>m){const I=_assertClassBrand15(_Transformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,_.col,v.col),E=Math.max(g.col-I,1);g.col=I+E}if(r.row<0&&a>=f&&g.row<f){const I=g.row-f;g.row=_assertClassBrand15(_Transformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,v.row,b.row)+I}else if(r.row>0&&a<=f&&g.row>f){const I=_assertClassBrand15(_Transformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,b.row,v.row),E=Math.max(g.row-I,1);g.row=I+E}const{rowDir:S,colDir:R}=_assertClassBrand15(_Transformation_brand,this,_clampCoords).call(this,g);h=S,d=R;const A=_assertClassBrand15(_Transformation_brand,this,_zeroBasedToVisualCoords).call(this,g);r.row===0&&r.col!==0?u.col=A.col:r.row!==0&&r.col===0?u.row=A.row:(u.row=A.row,u.col=A.col)}return this.runLocalHooks("afterTransformEnd",u,h,d),u}setOffsetSize(e){let{x:t,y:r}=e;_classPrivateFieldSet12(_offset,this,{x:t,y:r})}resetOffsetSize(){_classPrivateFieldSet12(_offset,this,{x:0,y:0})}};function _clampCoords(e){const{width:t,height:r}=_assertClassBrand15(_Transformation_brand,this,_getTableSize).call(this);let i=0,o=0;return e.row<0?(i=-1,e.row=0):e.row>0&&e.row>=r&&(i=1,e.row=r-1),e.col<0?(o=-1,e.col=0):e.col>0&&e.col>=t&&(o=1,e.col=t-1),{rowDir:i,colDir:o}}function _getTableSize(){return{width:_classPrivateFieldGet12(_offset,this).x+_classPrivateFieldGet12(_options,this).countRenderableColumns(),height:_classPrivateFieldGet12(_offset,this).y+_classPrivateFieldGet12(_options,this).countRenderableRows()}}function _findFirstNonHiddenZeroBasedRow(e,t){const r=_classPrivateFieldGet12(_options,this).findFirstNonHiddenRenderableRow(e,t);return r===null?null:_classPrivateFieldGet12(_offset,this).y+r}function _findFirstNonHiddenZeroBasedColumn(e,t){const r=_classPrivateFieldGet12(_options,this).findFirstNonHiddenRenderableColumn(e,t);return r===null?null:_classPrivateFieldGet12(_offset,this).x+r}function _visualToZeroBasedCoords(e){const{row:t,col:r}=_classPrivateFieldGet12(_options,this).visualToRenderableCoords(e);if(t===null||r===null)throw new Error("Renderable coords are not visible.");return _classPrivateFieldGet12(_options,this).createCellCoords(_classPrivateFieldGet12(_offset,this).y+t,_classPrivateFieldGet12(_offset,this).x+r)}function _zeroBasedToVisualCoords(e){const t=e.clone();return t.col=e.col-_classPrivateFieldGet12(_offset,this).x,t.row=e.row-_classPrivateFieldGet12(_offset,this).y,_classPrivateFieldGet12(_options,this).renderableToVisualCoords(t)}mixin(Transformation,localHooks_default);var transformation_default=Transformation,import_es_error_cause68=__toESM(require_es_error_cause(),1),import_es_array_push29=__toESM(require_es_array_push(),1),import_es_set_difference_v28=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v28=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v28=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v28=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v28=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v28=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v28=__toESM(require_es_set_union_v2(),1),SELECTION_TYPE_UNRECOGNIZED=0,SELECTION_TYPE_EMPTY=1,SELECTION_TYPE_ARRAY=2,SELECTION_TYPE_OBJECT=3,SELECTION_TYPES=[SELECTION_TYPE_OBJECT,SELECTION_TYPE_ARRAY],ARRAY_TYPE_PATTERN=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],rootCall=Symbol("root"),childCall=Symbol("child");function detectSelectionType(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rootCall;if(t!==rootCall&&t!==childCall)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(e),i=t===rootCall;let o=SELECTION_TYPE_UNRECOGNIZED;if(r){const a=e[0];e.length===0?o=SELECTION_TYPE_EMPTY:i&&a instanceof range_default?o=SELECTION_TYPE_OBJECT:i&&Array.isArray(a)?o=detectSelectionType(a,childCall):e.length>=2&&e.length<=4&&!e.some((u,h)=>!ARRAY_TYPE_PATTERN[h].includes(typeof u))&&(o=SELECTION_TYPE_ARRAY)}return o}function normalizeSelectionFactory(e){let{createCellCoords:t,createCellRange:r,keepDirection:i=!1,propToCol:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!SELECTION_TYPES.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(a){const c=e===SELECTION_TYPE_OBJECT;let u=c?a.from.row:a[0],h=c?a.from.col:a[1],d=c?a.to.row:a[2],f=c?a.to.col:a[3];if(typeof o=="function"&&(typeof h=="string"&&(h=o(h)),typeof f=="string"&&(f=o(f))),isUndefined(d)&&(d=u),isUndefined(f)&&(f=h),!i){const v=u,_=h,b=d,S=f;u=Math.min(v,b),h=Math.min(_,S),d=Math.max(v,b),f=Math.max(_,S)}const m=t(u,h),g=t(d,f);return r(m,m,g)}}function transformSelectionToColumnDistance(e){const t=detectSelectionType(e.getSelected());if(t===SELECTION_TYPE_UNRECOGNIZED||t===SELECTION_TYPE_EMPTY)return[];const r=normalizeSelectionFactory(t,{createCellCoords:e._createCellCoords.bind(e),createCellRange:e._createCellRange.bind(e)}),i=new Set;arrayEach(e.getSelected(),c=>{const{from:u,to:h}=r(c),d=Math.max(u.col,0),f=h.col-d+1;arrayEach(Array.from(new Array(f),(m,g)=>d+g),m=>{i.has(m)||i.add(m)})});const o=Array.from(i).sort((c,u)=>c-u);return arrayReduce(o,(c,u,h,d)=>(h!==0&&u===d[h-1]+1?c[c.length-1][1]+=1:c.push([u,1]),c),[])}function transformSelectionToRowDistance(e){const t=detectSelectionType(e.getSelected());if(t===SELECTION_TYPE_UNRECOGNIZED||t===SELECTION_TYPE_EMPTY)return[];const r=normalizeSelectionFactory(t,{createCellCoords:e._createCellCoords.bind(e),createCellRange:e._createCellRange.bind(e)}),i=new Set;arrayEach(e.getSelected(),c=>{const{from:u,to:h}=r(c),d=Math.max(u.row,0),f=h.row-d+1;arrayEach(Array.from(new Array(f),(m,g)=>d+g),m=>{i.has(m)||i.add(m)})});const o=Array.from(i).sort((c,u)=>c-u);return arrayReduce(o,(c,u,h,d)=>(h!==0&&u===d[h-1]+1?c[c.length-1][1]+=1:c.push([u,1]),c),[])}function _classPrivateFieldInitSpec13(e,t,r){_checkPrivateRedeclaration16(e,t),t.set(e,r)}function _checkPrivateRedeclaration16(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty49(e,t,r){return(t=_toPropertyKey49(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey49(e){var t=_toPrimitive49(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive49(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet13(e,t){return e.get(_assertClassBrand16(e,t))}function _classPrivateFieldSet13(e,t,r){return e.set(_assertClassBrand16(e,t),r),r}function _assertClassBrand16(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _transformation=new WeakMap,_focusTransformation=new WeakMap,_isFocusSelectionChanged=new WeakMap,_disableHeadersHighlight=new WeakMap,_selectionSource=new WeakMap,_expectedLayersCount=new WeakMap,Selection4=class{constructor(e,t){var r=this;_defineProperty49(this,"settings",void 0),_defineProperty49(this,"tableProps",void 0),_defineProperty49(this,"inProgress",!1),_defineProperty49(this,"selectedRange",new range_default2((i,o,a)=>this.tableProps.createCellRange(i,o,a))),_defineProperty49(this,"highlight",void 0),_classPrivateFieldInitSpec13(this,_transformation,void 0),_classPrivateFieldInitSpec13(this,_focusTransformation,void 0),_defineProperty49(this,"selectedByRowHeader",new Set),_defineProperty49(this,"selectedByColumnHeader",new Set),_classPrivateFieldInitSpec13(this,_isFocusSelectionChanged,!1),_classPrivateFieldInitSpec13(this,_disableHeadersHighlight,!1),_classPrivateFieldInitSpec13(this,_selectionSource,"unknown"),_classPrivateFieldInitSpec13(this,_expectedLayersCount,-1),this.settings=e,this.tableProps=t,this.highlight=new highlight_default({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[A11Y_SELECTED()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,a)=>this.tableProps.createCellRange(i,o,a)}),_classPrivateFieldSet13(_transformation,this,new transformation_default(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),_classPrivateFieldSet13(_focusTransformation,this,new transformation_default(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),_classPrivateFieldGet13(_transformation,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r.runLocalHooks("beforeModifyTransformStart",...o)}),_classPrivateFieldGet13(_transformation,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r.runLocalHooks("afterModifyTransformStart",...o)}),_classPrivateFieldGet13(_transformation,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),_classPrivateFieldGet13(_transformation,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r.runLocalHooks("afterModifyTransformEnd",...o)}),_classPrivateFieldGet13(_transformation,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r.runLocalHooks("insertRowRequire",...o)}),_classPrivateFieldGet13(_transformation,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r.runLocalHooks("insertColRequire",...o)}),_classPrivateFieldGet13(_transformation,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r.runLocalHooks("beforeRowWrap",...o)}),_classPrivateFieldGet13(_transformation,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r.runLocalHooks("beforeColumnWrap",...o)}),_classPrivateFieldGet13(_focusTransformation,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),_classPrivateFieldGet13(_focusTransformation,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){_classPrivateFieldSet13(_selectionSource,this,e)}markEndSource(){_classPrivateFieldSet13(_selectionSource,this,"unknown")}getSelectionSource(){return _classPrivateFieldGet13(_selectionSource,this)}setExpectedLayers(e){_classPrivateFieldSet13(_expectedLayersCount,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,_classPrivateFieldSet13(_expectedLayersCount,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",a=isUndefined(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,c=e.clone();_classPrivateFieldSet13(_isFocusSelectionChanged,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,c),(!o||o&&!a&&isUndefined(t))&&this.selectedRange.clear(),this.selectedRange.add(c).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,t,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&t.col<0&&!o||i===0&&t.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const a=this.selectedRange.current();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{const u=a.getHorizontalDirection(),h=a.getVerticalDirection(),d=this.isMultiple();a.setTo(t),d&&(u!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),d&&(h!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const c=_classPrivateFieldGet13(_expectedLayersCount,this)===-1||this.selectedRange.size()===_classPrivateFieldGet13(_expectedLayersCount,this);this.runLocalHooks("afterSetRangeEnd",e,c)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();t<this.highlight.layerLevel&&(arrayEach(this.highlight.getAreas(),v=>void v.clear()),arrayEach(this.highlight.getLayeredAreas(),v=>void v.clear()),arrayEach(this.highlight.getRowHeaders(),v=>void v.clear()),arrayEach(this.highlight.getColumnHeaders(),v=>void v.clear()),arrayEach(this.highlight.getActiveRowHeaders(),v=>void v.clear()),arrayEach(this.highlight.getActiveColumnHeaders(),v=>void v.clear()),arrayEach(this.highlight.getActiveCornerHeaders(),v=>void v.clear()),arrayEach(this.highlight.getRowHighlights(),v=>void v.clear()),arrayEach(this.highlight.getColumnHighlights(),v=>void v.clear())),this.highlight.useLayerLevel(t);const o=this.highlight.createArea(),a=this.highlight.createLayeredArea(),c=this.highlight.createRowHeader(),u=this.highlight.createColumnHeader(),h=this.highlight.createActiveRowHeader(),d=this.highlight.createActiveColumnHeader(),f=this.highlight.createActiveCornerHeader(),m=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();if(o.clear(),a.clear(),c.clear(),u.clear(),h.clear(),d.clear(),f.clear(),m.clear(),g.clear(),this.highlight.isEnabledFor(AREA_TYPE,e.highlight)&&(this.isMultiple()||t>=1)&&(o.add(e.from).add(e.to).commit(),a.add(e.from).add(e.to).commit(),t===1)){const v=this.selectedRange.previous();this.highlight.useLayerLevel(t-1),this.highlight.createArea().add(v.from).commit().syncWith(v),this.highlight.createLayeredArea().add(v.from).commit().syncWith(v),this.highlight.useLayerLevel(t)}if(this.highlight.isEnabledFor(HEADER_TYPE,e.highlight)){if(!e.isSingleHeader()){const b=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),S=this.tableProps.createCellCoords(e.to.row,-1),R=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),A=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(c.add(b).commit(),u.add(R).commit(),m.add(b).commit(),g.add(R).commit()):(c.add(b).add(S).commit(),u.add(R).add(A).commit(),m.add(b).add(S).commit(),g.add(R).add(A).commit())}const v=!_classPrivateFieldGet13(_disableHeadersHighlight,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),_=!_classPrivateFieldGet13(_disableHeadersHighlight,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());v&&h.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),_&&d.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),v&&_&&f.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const t=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),t.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(FOCUS_TYPE,t.highlight)&&r.add(t.highlight).commit().syncWith(t),this.inProgress||(_classPrivateFieldSet13(_isFocusSelectionChanged,this,!0),this.runLocalHooks("afterSetFocus",t.highlight))}transformStart(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?_classPrivateFieldGet13(_transformation,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):_classPrivateFieldGet13(_transformation,this).resetOffsetSize(),this.setRangeStart(_classPrivateFieldGet13(_transformation,this).transformStart(e,t,r))}transformEnd(e,t){this.settings.navigableHeaders?_classPrivateFieldGet13(_transformation,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):_classPrivateFieldGet13(_transformation,this).resetOffsetSize(),this.setRangeEnd(_classPrivateFieldGet13(_transformation,this).transformEnd(e,t))}transformFocus(e,t){const r=this.selectedRange.current(),{row:i,col:o}=r.getOuterTopStartCorner(),a=this.tableProps.countRenderableColumnsInRange(0,o-1),c=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?_classPrivateFieldGet13(_focusTransformation,this).setOffsetSize({x:o<0?Math.abs(o):-a,y:i<0?Math.abs(i):-c}):_classPrivateFieldGet13(_focusTransformation,this).setOffsetSize({x:o<0?0:-a,y:i<0?0:-c});const u=_classPrivateFieldGet13(_focusTransformation,this).transformStart(e,t);this.setRangeFocus(u.normalize())}shiftRows(e,t){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:a}=r,c=this.tableProps.countRows(),u=this.isSelectedByRowHeader(),h=this.isSelectedByColumnHeader(),d=h?-1:0,f=h?0:t;this.getSelectedRange().pop();const m=this.tableProps.createCellCoords(clamp(i.row+f,d,c-1),i.col),g=this.tableProps.createCellCoords(clamp(o.row+t,d,c-1),o.col);this.markSource("shift"),a.row>=e?this.setRangeStartOnly(m,!0,this.tableProps.createCellCoords(clamp(a.row+t,0,c-1),a.col)):this.setRangeStartOnly(m,!0),u&&this.selectedByRowHeader.add(this.getLayerLevel()),h&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}shiftColumns(e,t){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:a}=r,c=this.tableProps.countCols(),u=this.isSelectedByRowHeader(),h=this.isSelectedByColumnHeader(),d=u?-1:0,f=u?0:t;this.getSelectedRange().pop();const m=this.tableProps.createCellCoords(i.row,clamp(i.col+f,d,c-1)),g=this.tableProps.createCellCoords(o.row,clamp(o.col+t,d,c-1));this.markSource("shift"),a.col>=e?this.setRangeStartOnly(m,!0,this.tableProps.createCellCoords(a.row,clamp(a.col+t,0,c-1))):this.setRangeStartOnly(m,!0),u&&this.selectedByRowHeader.add(this.getLayerLevel()),h&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=createObjectPropListener(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&_classPrivateFieldGet13(_isFocusSelectionChanged,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=i=>{const{col:o}=i.getOuterTopStartCorner(),a=this.tableProps.countRowHeaders(),c=this.tableProps.countCols();return(a>0&&o<0||a===0)&&i.getWidth()===c};if(e===-1)return Array.from(this.selectedRange).some(i=>t(i));const r=this.selectedRange.peekByIndex(e);return r?t(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=i=>{const{row:o}=i.getOuterTopStartCorner(),a=this.tableProps.countColHeaders(),c=this.tableProps.countRows();return(a>0&&o<0||a===0)&&i.getHeight()===c};if(e===-1)return Array.from(this.selectedRange).some(i=>t(i));const r=this.selectedRange.peekByIndex(e);return r?t(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const t=this.tableProps.visualToRenderableCoords(e);return t.row!==null&&t.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),a=this.tableProps.countCols(),c=this.tableProps.countRowHeaders(),u=this.tableProps.countColHeaders(),h=r?-u:0,d=t?-c:0;if(h===0&&d===0&&(o===0||a===0))return;let f=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:m,disableHeadersHighlight:g}=i;_classPrivateFieldSet13(_disableHeadersHighlight,this,g),m&&Number.isInteger(m?.row)&&Number.isInteger(m?.col)&&(f=this.tableProps.createCellCoords(clamp(m.row,h,o-1),clamp(m.col,d,a-1)));const v=this.tableProps.createCellCoords(h,d),_=this.tableProps.createCellCoords(o-1,a-1);this.clear(),this.setRangeStartOnly(v,void 0,f),d<0&&this.selectedByRowHeader.add(this.getLayerLevel()),h<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(_),this.finish(),_classPrivateFieldSet13(_disableHeadersHighlight,this,!1)}selectCells(e){var t=this;const r=detectSelectionType(e);if(r===SELECTION_TYPE_EMPTY)return!1;if(r===SELECTION_TYPE_UNRECOGNIZED)throw new Error(toSingleLine`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=normalizeSelectionFactory(r,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:u=>this.tableProps.propToCol(u),keepDirection:!0}),o=this.settings.navigableHeaders,a={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},c=!e.some(u=>{const h=i(u),d=h.isValid(a);return!(d&&!h.containsHeaders()||d&&h.containsHeaders()&&h.isSingleHeader())});return c&&(this.clear(),this.setExpectedLayers(e.length),arrayEach(e,u=>{const{from:h,to:d}=i(u);this.setRangeStartOnly(h.clone(),!1),this.setRangeEnd(d.clone())}),this.finish()),c}selectColumns(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof t=="string"?this.tableProps.propToCol(t):t,a=this.tableProps.countRows(),c=this.tableProps.countCols(),u=this.tableProps.countColHeaders(),h=u===0?0:-u,d=this.tableProps.createCellCoords(h,i),f=this.tableProps.createCellCoords(a-1,o),m=this.tableProps.createCellRange(d,d,f).isValid({countRows:a,countCols:c,countRowHeaders:0,countColHeaders:u});if(m){let g=0,v=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(g=clamp(r.row,h,a-1),v=clamp(r.col,Math.min(i,o),Math.max(i,o))):(g=clamp(r,h,a-1),v=i);const _=this.tableProps.createCellCoords(g,v),b=u===0?0:clamp(_.row,h,-1),S=a-1,R=this.tableProps.createCellCoords(b,i),A=this.tableProps.createCellCoords(S,o);this.runLocalHooks("beforeSelectColumns",R,A,_),R.row=b,A.row=S,this.setRangeStartOnly(R,void 0,_),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(A),this.runLocalHooks("afterSelectColumns",R,A,_),this.finish()}return m}selectRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),c=a===0?0:-a,u=this.tableProps.createCellCoords(e,c),h=this.tableProps.createCellCoords(t,o-1),d=this.tableProps.createCellRange(u,u,h).isValid({countRows:i,countCols:o,countRowHeaders:a,countColHeaders:0});if(d){let f=0,m=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(f=clamp(r.row,Math.min(e,t),Math.max(e,t)),m=clamp(r.col,c,o-1)):(f=e,m=clamp(r,c,o-1));const g=this.tableProps.createCellCoords(f,m),v=a===0?0:clamp(g.col,c,-1),_=o-1,b=this.tableProps.createCellCoords(e,v),S=this.tableProps.createCellCoords(t,_);this.runLocalHooks("beforeSelectRows",b,S,g),b.col=v,S.col=_,this.setRangeStartOnly(b,void 0,g),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(S),this.runLocalHooks("afterSelectRows",b,S,g),this.finish()}return d}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),t=this.tableProps.countCols();if(e===0||t===0){this.deselect();return}const r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:o,highlight:a}=r;this.clear(),a.assign({row:clamp(a.row,-1/0,e-1),col:clamp(a.col,-1/0,t-1)}),i.assign({row:clamp(i.row,-1/0,e-1),col:clamp(i.col,-1/0,t-1)}),o.assign({row:clamp(o.row,0,e-1),col:clamp(o.col,0,t-1)}),this.selectedRange.ranges.push(r),this.highlight.getFocus().add(a).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const t=this.highlight.getFocus(),r=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),a=this.highlight.createLayeredArea(),c=this.highlight.createRowHeader(),u=this.highlight.createColumnHeader(),h=this.highlight.createActiveRowHeader(),d=this.highlight.createActiveColumnHeader(),f=this.highlight.createActiveCornerHeader(),m=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();o.commit(),a.commit(),c.commit(),u.commit(),h.commit(),d.commit(),f.commit(),m.commit(),g.commit()}this.highlight.useLayerLevel(r)}};mixin(Selection4,localHooks_default);var selection_default4=Selection4,import_es_error_cause70=__toESM(require_es_error_cause(),1),import_es_array_push31=__toESM(require_es_array_push(),1),regUniversalNewLine=/^(\r\n|\n\r|\r|\n)/,regNextCellNoQuotes=/^[^\t\r\n]+/,regNextEmptyCell=/^\t/;function parse2(e){const t=[[""]];if(e.length===0)return t;let r=0,i=0,o;for(;e.length>0&&o!==e.length;)if(o=e.length,e.match(regNextEmptyCell))e=e.replace(regNextEmptyCell,""),r+=1,t[i][r]="";else if(e.match(regUniversalNewLine))e=e.replace(regUniversalNewLine,""),r=0,i+=1,t[i]=[""];else{let a="";if(e.startsWith('"')){let c=0,u=!0;for(;u;){const h=e.slice(0,1);h==='"'&&(c+=1),a+=h,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&c%2===0)&&(u=!1)}a=a.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,h=>new Array(Math.floor(h.length/2)).fill('"').join(""))}else{const c=e.match(regNextCellNoQuotes);a=c?c[0]:"",e=e.slice(a.length)}t[i][r]=a}return t}function stringify2(e){let t,r,i,o,a="",c;for(t=0,r=e.length;t<r;t+=1){for(o=e[t].length,i=0;i<o;i+=1)i>0&&(a+="	"),c=e[t][i],typeof c=="string"?c.indexOf(`
`)>-1?a+=`"${c.replace(/"/g,'""')}"`:a+=c:c==null?a+="":a+=c;t!==r-1&&(a+=`
`)}return a}function _defineProperty50(e,t,r){return(t=_toPropertyKey50(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey50(e){var t=_toPrimitive50(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive50(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DataMap=class Xr{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(t,r,i){_defineProperty50(this,"hot",void 0),_defineProperty50(this,"metaManager",void 0),_defineProperty50(this,"tableMeta",void 0),_defineProperty50(this,"dataSource",void 0),_defineProperty50(this,"duckSchema",void 0),_defineProperty50(this,"colToPropCache",void 0),_defineProperty50(this,"propToColCache",void 0),this.hot=t,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const t=this.getSchema();if(typeof t>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let i;if(this.colToPropCache=[],this.propToColCache=new Map,r){let o=0,a=0,c=!1;if(typeof r=="function"){const u=deepObjectSize(t);o=u>0?u:this.countFirstRowKeys(),c=!0}else{const u=this.tableMeta.maxCols;o=Math.min(u,r.length)}for(i=0;i<o;i++){const u=c?r(i):r[i];if(isObject2(u)){if(typeof u.data<"u"){const h=c?a:i;this.colToPropCache[h]=u.data,this.propToColCache.set(u.data,h)}a+=1}}}else this.recursiveDuckColumns(t)}countFirstRowKeys(){return countFirstRowKeys(this.dataSource)}recursiveDuckColumns(t,r,i){let o=r,a=i,c;return typeof o>"u"&&(o=0,a=""),typeof t=="object"&&!Array.isArray(t)&&objectEach(t,(u,h)=>{u===null?(c=a+h,this.colToPropCache.push(c),this.propToColCache.set(c,o),o+=1):o=this.recursiveDuckColumns(u,o,`${h}.`)}),o}colToProp(t){if(Number.isInteger(t)===!1)return t;const r=this.hot.toPhysicalColumn(t);return r===null?t:this.colToPropCache&&isDefined(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(t){const r=this.propToColCache.get(t);if(isDefined(r))return this.hot.toVisualColumn(r);const i=this.hot.toVisualColumn(t);return i===null?t:i}getSchema(){const t=this.tableMeta.dataSchema;return t?typeof t=="function"?t():t:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?duckSchema(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:o="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const a=this.hot.countSourceRows();let c=a,u=0,h=t;if((typeof h!="number"||h>=a)&&(h=a),h<this.hot.countRows()&&(c=this.hot.toPhysicalRow(h)),this.hot.runHooks("beforeCreateRow",h,r,i)===!1||c===null)return{delta:0};const f=this.tableMeta.maxRows,m=this.getSchema().length,g=[];for(;u<r&&a+u<f;){let _=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?_=deepClone(this.getSchema()):(_=[],rangeEach(m-1,()=>_.push(null))):this.hot.dataType==="function"?_=this.tableMeta.dataSchema(h+u):(_={},deepExtend(_,this.getSchema())),g.push(_),u+=1}this.hot.rowIndexMapper.insertIndexes(h,u),o==="below"&&(c=Math.min(c+1,a)),this.spliceData(c,0,g);const v=this.hot.toVisualRow(c);return this.hot.countSourceRows()===g.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),u>0&&(t==null?this.metaManager.createRow(null,u):i!=="auto"&&this.metaManager.createRow(c,r)),this.hot.runHooks("afterCreateRow",v,u,i),this.hot.forceFullRender=!0,{delta:u,startPhysicalIndex:c}}createCol(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:o="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const a=this.dataSource,c=this.tableMeta.maxCols,u=this.hot.countSourceCols();let h=t;if((typeof h!="number"||h>=u)&&(h=u),this.hot.runHooks("beforeCreateCol",h,r,i)===!1)return{delta:0};let f=u;h<this.hot.countCols()&&(f=this.hot.toPhysicalColumn(h));const m=this.hot.countSourceRows();let g=this.hot.countCols(),v=0,_=f;o==="end"&&(_=Math.min(_+1,u));const b=_;for(;v<r&&g<c;){if(typeof h!="number"||h>=g)if(m>0)for(let R=0;R<m;R+=1)typeof a[R]>"u"&&(a[R]=[]),a[R].push(null);else a.push([null]);else for(let R=0;R<m;R++)a[R].splice(_,0,null);v+=1,_+=1,g+=1}this.hot.columnIndexMapper.insertIndexes(h,v),v>0&&(t==null?this.metaManager.createColumn(null,v):i!=="auto"&&this.metaManager.createColumn(b,r));const S=this.hot.toVisualColumn(b);return this.hot.runHooks("afterCreateCol",S,v,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:v,startPhysicalIndex:b}}removeRow(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(t)?t:-r;const a=this.visualRowsToPhysical(o,r),c=this.hot.countSourceRows();if(o=(c+o)%c,this.hot.runHooks("beforeRemoveRow",o,a.length,a,i)===!1)return!1;const h=a.length;if(this.filterData(o,h,a),o<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(a);const f=isDefined(this.tableMeta.columns)||isDefined(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&f===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return a.slice(0).sort((f,m)=>m-f).forEach(f=>{this.metaManager.removeRow(f,1)}),this.hot.runHooks("afterRemoveRow",o,h,a,i),this.hot.forceFullRender=!0,!0}removeCol(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let o=typeof t!="number"?-r:t;o=(this.hot.countCols()+o)%this.hot.countCols();const a=this.visualColumnsToPhysical(o,r),c=a.slice(0).sort((m,g)=>g-m);if(this.hot.runHooks("beforeRemoveCol",o,r,a,i)===!1)return!1;let h=!0;const d=c.length,f=this.dataSource;for(let m=0;m<d;m++)h&&a[0]!==a[m]-m&&(h=!1);if(h)for(let m=0,g=this.hot.countSourceRows();m<g;m++)f[m].splice(a[0],r),m===0&&this.metaManager.removeColumn(a[0],r);else for(let m=0,g=this.hot.countSourceRows();m<g;m++)for(let v=0;v<d;v++)f[m].splice(c[v],1),m===0&&this.metaManager.removeColumn(c[v],1);return o<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(a),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",o,r,a,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(t,r,i){const o=this.hot.getDataAtCol(t),a=o.slice(r,r+i),c=o.slice(r+i);for(var u=arguments.length,h=new Array(u>3?u-3:0),d=3;d<u;d++)h[d-3]=arguments[d];extendArray(h,c);let f=0;for(;f<i;)h.push(null),f+=1;return to2dArray(h),this.hot.populateFromArray(r,t,h,null,null,"spliceCol"),a}spliceRow(t,r,i){const o=this.hot.getSourceDataAtRow(t),a=o.slice(r,r+i),c=o.slice(r+i);for(var u=arguments.length,h=new Array(u>3?u-3:0),d=3;d<u;d++)h[d-3]=arguments[d];extendArray(h,c);let f=0;for(;f<i;)h.push(null),f+=1;return this.hot.populateFromArray(t,r,[h],null,null,"spliceRow"),a}spliceData(t,r,i){if(this.hot.runHooks("beforeDataSplice",t,r,i)!==!1){const a=[...this.dataSource.slice(0,t),...i,...this.dataSource.slice(t)];this.dataSource.length=0,a.forEach(c=>this.dataSource.push(c))}}filterData(t,r,i){let o=this.hot.runHooks("filterData",t,r,i);Array.isArray(o)===!1&&(o=this.dataSource.filter((a,c)=>i.indexOf(c)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}get(t,r){const i=this.hot.toPhysicalRow(t);let o=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);o=isNaN(a)?a:o;const{dataDotNotation:c}=this.hot.getSettings();let u=null;if(o&&o.hasOwnProperty&&hasOwnProperty(o,r))u=o[r];else if(c&&typeof r=="string"&&r.indexOf(".")>-1){let h=o;if(!h)return null;const d=r.split(".");for(let f=0,m=d.length;f<m;f++)if(h=h[d[f]],typeof h>"u")return null;u=h}else typeof r=="function"&&(u=r(this.dataSource.slice(i,i+1)[0]));if(this.hot.hasHook("modifyData")){const h=createObjectPropListener(u);this.hot.runHooks("modifyData",i,this.propToCol(r),h,"get"),h.isTouched()&&(u=h.value)}return u}getCopyable(t,r){return this.hot.getCellMeta(t,this.propToCol(r)).copyable?this.get(t,r):""}set(t,r,i){const o=this.hot.toPhysicalRow(t);let a=i,c=this.dataSource[o];const u=this.hot.runHooks("modifyRowData",o);if(c=isNaN(u)?u:c,this.hot.hasHook("modifyData")){const d=createObjectPropListener(a);this.hot.runHooks("modifyData",o,this.propToCol(r),d,"set"),d.isTouched()&&(a=d.value)}const{dataDotNotation:h}=this.hot.getSettings();if(c&&c.hasOwnProperty&&hasOwnProperty(c,r))c[r]=a;else if(h&&typeof r=="string"&&r.indexOf(".")>-1){let d=c,f=0,m;const g=r.split(".");for(f=0,m=g.length-1;f<m;f++)typeof d[g[f]]>"u"&&(d[g[f]]={}),d=d[g[f]];d[g[f]]=a}else typeof r=="function"?r(this.dataSource.slice(o,o+1)[0],a):c[r]=a}visualRowsToPhysical(t,r){const i=this.hot.countSourceRows(),o=[];let a=(i+t)%i,c=r,u;for(;a<i&&c;)u=this.hot.toPhysicalRow(a),o.push(u),c-=1,a+=1;return o}visualColumnsToPhysical(t,r){const i=this.hot.countCols(),o=[];let a=(i+t)%i,c=r;for(;a<i&&c;){const u=this.hot.toPhysicalColumn(a);o.push(u),c-=1,a+=1}return o}clear(){for(let t=0;t<this.hot.countSourceRows();t++)for(let r=0;r<this.hot.countCols();r++)this.set(t,this.colToProp(r),"")}getLength(){const t=this.tableMeta.maxRows;let r;t<0||t===0?r=0:r=t||1/0;const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,r)}getAll(){const t={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return t.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(t,r,Xr.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(t,r,i){const o=[];let a,c,u;const h=this.tableMeta.maxRows,d=this.tableMeta.maxCols;if(h===0||d===0)return[];const f=i===Xr.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,m=Math.min(Math.max(h-1,0),Math.max(t.row,r.row)),g=Math.min(Math.max(d-1,0),Math.max(t.col,r.col));for(a=Math.min(t.row,r.row);a<=m;a++){u=[];const v=a>=0?this.hot.toPhysicalRow(a):a;for(c=Math.min(t.col,r.col);c<=g&&v!==null;c++)u.push(f.call(this,a,this.colToProp(c)));v!==null&&o.push(u)}return o}getText(t,r){return stringify2(this.getRange(t,r,Xr.DESTINATION_RENDERER))}getCopyableText(t,r){return stringify2(this.getRange(t,r,Xr.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}},dataMap_default=DataMap,import_es_error_cause78=__toESM(require_es_error_cause(),1),import_es_error_cause73=__toESM(require_es_error_cause(),1),import_es_error_cause72=__toESM(require_es_error_cause(),1),import_es_set_difference_v210=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v210=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v210=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v210=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v210=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v210=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v210=__toESM(require_es_set_union_v2(),1),import_es_error_cause71=__toESM(require_es_error_cause(),1),{register:register5,getItem:getItem4,hasItem:hasItem4,getNames:getNames4,getValues:getValues4}=staticRegister("cellTypes");function _getItem4(e){if(!hasItem4(e))throw Error(`You declared cell type "${e}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return getItem4(e)}function _register4(e,t){typeof e!="string"&&(t=e,e=t.CELL_TYPE);const{editor:r,renderer:i,validator:o}=t;r&&_register(e,r),i&&_register2(e,i),o&&_register3(e,o),register5(e,t)}function canBeOverwritten(e,t){var r;return e==="CELL_TYPE"?!1:((r=t._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(e))||!hasOwnProperty(t,e)}function extendByMetaType(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const i=typeof t.type=="string"?_getItem4(t.type):t.type;if(e._automaticallyAssignedMetaProps&&objectEach(t,(a,c)=>void e._automaticallyAssignedMetaProps.delete(c)),!isObject2(i))return;r===e&&!e._automaticallyAssignedMetaProps&&(e._automaticallyAssignedMetaProps=new Set);const o={};objectEach(i,(a,c)=>{if(canBeOverwritten(c,r)){var u;o[c]=a,(u=e._automaticallyAssignedMetaProps)===null||u===void 0||u.add(c)}}),extend2(e,o)}function columnFactory(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}inherit2(r,e);for(let i=0;i<t.length;i++)r.prototype[t[i]]=void 0;return r}function isUnsignedNumber(e){return Number.isInteger(e)&&e>=0}function assert(e,t){if(!e())throw new Error(`Assertion failed: ${t}`)}function isNullish(e){return e==null}var metaSchema_default=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(e){let t,r,i;for(t=0,r=this.countRows();t<r;t++)if(i=this.getDataAtCell(t,e),isEmpty(i)===!1)return!1;return!0},isEmptyRow(e){let t,r,i,o;for(t=0,r=this.countCols();t<r;t++)if(i=this.getDataAtCell(e,t),isEmpty(i)===!1)return typeof i=="object"?(o=this.getCellMeta(e,t),isObjectEqual(this.getSchema()[o.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function _defineProperty51(e,t,r){return(t=_toPropertyKey51(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey51(e){var t=_toPrimitive51(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive51(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function createTableMetaEmptyClass(){return class{}}var GlobalMeta=class{constructor(e){_defineProperty51(this,"metaCtor",createTableMetaEmptyClass()),_defineProperty51(this,"meta",void 0),this.meta=this.metaCtor.prototype,extend2(this.meta,metaSchema_default()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;extend2(this.meta,e),extendByMetaType(this.meta,{...e,type:(t=e.type)!==null&&t!==void 0?t:this.meta.type},e)}},import_es_error_cause74=__toESM(require_es_error_cause(),1);function _defineProperty52(e,t,r){return(t=_toPropertyKey52(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey52(e){var t=_toPrimitive52(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive52(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TableMeta=class{constructor(e){_defineProperty52(this,"meta",void 0);const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){extend2(this.meta,e),extendByMetaType(this.meta,e,e)}},import_es_error_cause76=__toESM(require_es_error_cause(),1),import_es_error_cause75=__toESM(require_es_error_cause(),1),import_es_array_push32=__toESM(require_es_array_push(),1),import_es_set_difference_v211=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v211=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v211=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v211=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v211=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v211=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v211=__toESM(require_es_set_union_v2(),1);function _defineProperty53(e,t,r){return(t=_toPropertyKey53(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey53(e){var t=_toPrimitive53(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive53(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LazyFactoryMap=class{constructor(e){_defineProperty53(this,"valueFactory",void 0),_defineProperty53(this,"data",[]),_defineProperty53(this,"index",[]),_defineProperty53(this,"holes",new Set),this.valueFactory=e}obtain(e){assert(()=>isUnsignedNumber(e),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let r;if(t>=0)r=this.data[t],r===void 0&&(r=this.valueFactory(e),this.data[t]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;assert(()=>isUnsignedNumber(e)||isNullish(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let a=0;a<t;a++)r.push(i+a),this.data.push(void 0);const o=isNullish(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;assert(()=>isUnsignedNumber(e)||isNullish(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(isNullish(e)?this.index.length-t:e,t);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return arrayFilter(this.data,(e,t)=>!this.holes.has(t))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let t=0;return{next:()=>{if(t<e.length){const r=e[t];return t+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}};function _defineProperty54(e,t,r){return(t=_toPropertyKey54(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey54(e){var t=_toPrimitive54(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive54(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var COLUMNS_PROPS_CONFLICTS=["data","width"],ColumnMeta=class{constructor(e){_defineProperty54(this,"globalMeta",void 0),_defineProperty54(this,"metas",new LazyFactoryMap(()=>this._createMeta())),this.globalMeta=e,this.metas=new LazyFactoryMap(()=>this._createMeta())}updateMeta(e,t){const r=this.getMeta(e);extend2(r,t),extendByMetaType(r,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return columnFactory(this.globalMeta.getMetaConstructor(),COLUMNS_PROPS_CONFLICTS).prototype}},import_es_error_cause77=__toESM(require_es_error_cause(),1),import_es_array_push33=__toESM(require_es_array_push(),1);function _defineProperty55(e,t,r){return(t=_toPropertyKey55(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey55(e){var t=_toPrimitive55(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive55(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CellMeta=class{constructor(e){_defineProperty55(this,"columnMeta",void 0),_defineProperty55(this,"metas",new LazyFactoryMap(()=>this._createRow())),this.columnMeta=e}updateMeta(e,t,r){const i=this.getMeta(e,t);extend2(i,r),extendByMetaType(i,r)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,t)}getMeta(e,t,r){const i=this.metas.obtain(e).obtain(t);return r===void 0?i:i[r]}setMeta(e,t,r,i){var o;const a=this.metas.obtain(e).obtain(t);(o=a._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),a[r]=i}removeMeta(e,t,r){const i=this.metas.obtain(e).obtain(t);delete i[r]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let r=0;r<t.length;r++)isDefined(t[r])&&e.push(...t[r].values());return e}getMetasAtRow(e){assert(()=>isUnsignedNumber(e),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new LazyFactoryMap(e=>this._createMeta(e))}_createMeta(e){const t=this.columnMeta.getMetaConstructor(e);return new t}},MetaManager=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new GlobalMeta(e),this.tableMeta=new TableMeta(this.globalMeta),this.columnMeta=new ColumnMeta(this.globalMeta),this.cellMeta=new CellMeta(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,r){let{visualRow:i,visualColumn:o}=r;const a=this.cellMeta.getMeta(e,t);return a.visualRow=i,a.visualCol=o,a.row=e,a.col=t,this.runLocalHooks("afterGetCellMeta",a),a}getCellMetaKeyValue(e,t,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,r)}setCellMeta(e,t,r,i){this.cellMeta.setMeta(e,t,r,i)}updateCellMeta(e,t,r){this.cellMeta.updateMeta(e,t,r)}removeCellMeta(e,t,r){this.cellMeta.removeMeta(e,t,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}};mixin(MetaManager,localHooks_default);var import_es_error_cause79=__toESM(require_es_error_cause(),1),import_es_array_push34=__toESM(require_es_array_push(),1);function replaceData(e,t,r,i){const{hotInstance:o,dataMap:a,dataSource:c,internalSource:u,source:h,metaManager:d,firstRun:f}=i,m=toUpperCaseFirst(u),g=o.getSettings();Array.isArray(g.dataSchema)?o.dataType="array":isFunction2(g.dataSchema)?o.dataType="function":o.dataType="object",a&&a.destroy(),e=o.runHooks(`before${m}`,e,f,h);const v=new dataMap_default(o,e,d);if(t(v),typeof e=="object"&&e!==null)e.push&&e.splice||(e=[e]);else if(e===null){const _=v.getSchema();e=[];let b,S=0,R=0;for(S=0,R=g.startRows;S<R;S++)if((o.dataType==="object"||o.dataType==="function")&&g.dataSchema)b=deepClone(_),e.push(b);else if(o.dataType==="array")b=deepClone(_[0]),e.push(b);else{b=[];for(let A=0,I=g.startCols;A<I;A++)b.push(null);e.push(b)}}else throw new Error(`${u} only accepts array of objects or array of arrays (${typeof e} given)`);Array.isArray(e[0])&&(o.dataType="array"),g.data=e,v.dataSource=e,c.data=e,c.dataType=o.dataType,c.colToProp=v.colToProp.bind(v),c.propToCol=v.propToCol.bind(v),c.countCachedColumns=v.countCachedColumns.bind(v),r(v),o.runHooks(`after${m}`,e,f,h),f||(o.runHooks("afterChange",null,u),o.render()),o.getSettings().ariaTags&&setAttribute(o.rootElement,[A11Y_ROWCOUNT(-1),A11Y_COLCOUNT(o.countCols()+(o.view?o.countRowHeaders():0))])}var import_es_error_cause80=__toESM(require_es_error_cause(),1),import_es_set_difference_v212=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v212=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v212=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v212=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v212=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v212=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v212=__toESM(require_es_set_union_v2(),1);function _defineProperty56(e,t,r){return(t=_toPropertyKey56(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey56(e){var t=_toPrimitive56(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive56(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DynamicCellMetaMod=class{constructor(e){_defineProperty56(this,"metaManager",void 0),_defineProperty56(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),pluginHooks_default.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;const{row:r,col:i}=e;if((t=this.metaSyncMemo.get(r))!==null&&t!==void 0&&t.has(i))return;const{visualRow:o,visualCol:a}=e,c=this.metaManager.hot,u=c.colToProp(a);e.prop=u,c.runHooks("beforeGetCellMeta",o,a,e);const h=hasOwnProperty(e,"type")?e.type:null;let d=isFunction2(e.cells)?e.cells(r,i,u):null;if(h)if(d){var f;d.type=(f=d.type)!==null&&f!==void 0?f:h}else d={type:h};d&&this.metaManager.updateCellMeta(r,i,d),c.runHooks("afterGetCellMeta",o,a,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}},import_es_error_cause81=__toESM(require_es_error_cause(),1),import_es_array_push35=__toESM(require_es_array_push(),1),import_es_set_difference_v213=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v213=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v213=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v213=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v213=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v213=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v213=__toESM(require_es_set_union_v2(),1);function _classPrivateFieldInitSpec14(e,t,r){_checkPrivateRedeclaration17(e,t),t.set(e,r)}function _checkPrivateRedeclaration17(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty57(e,t,r){return(t=_toPropertyKey57(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey57(e){var t=_toPrimitive57(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive57(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet14(e,t){return e.get(_assertClassBrand17(e,t))}function _assertClassBrand17(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _initOnlyCallback=new WeakMap,ExtendMetaPropertiesMod=class{constructor(e){_defineProperty57(this,"metaManager",void 0),_defineProperty57(this,"usageTracker",new Set),_defineProperty57(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&t==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),_classPrivateFieldInitSpec14(this,_initOnlyCallback,(t,r,i)=>{if(!i)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{const{initOnly:r,target:i,onChange:o}=e,a=typeof i=="string",c=a?i:t,u=`_${c}`;this.metaManager.globalMeta.meta[u]=this.metaManager.globalMeta.meta[c],o?(this.installPropWatcher(t,u,o),a&&this.installPropWatcher(i,u,o)):r&&(this.installPropWatcher(t,u,_classPrivateFieldGet14(_initOnlyCallback,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(t))})}installPropWatcher(e,t,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(o){const a=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,a),this[t]=o},enumerable:!0,configurable:!0})}},GRID_GROUP="gridDefault",EDITOR_EDIT_GROUP="editorManager.handlingEditor",command={name:"editorCloseAndSave",callback(e){e._getEditorManager().closeEditorAndSaveChanges()}},import_es_error_cause82=__toESM(require_es_error_cause(),1),import_es_array_push36=__toESM(require_es_array_push(),1),MIXIN_NAME7="hooksRefRegisterer",hooksRefRegisterer={_hooksStorage:Object.create(null),addHook(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey(e){arrayEach(this._hooksStorage[e]||[],t=>{this.hot.removeHook(e,t)})},clearHooks(){objectEach(this._hooksStorage,(e,t)=>this.removeHooksByKey(t)),this._hooksStorage={}}};defineGetter(hooksRefRegisterer,"MIXIN_NAME",MIXIN_NAME7,{writable:!1,enumerable:!1});var hooksRefRegisterer_default=hooksRefRegisterer;function _defineProperty58(e,t,r){return(t=_toPropertyKey58(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey58(e){var t=_toPrimitive58(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive58(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EDITOR_TYPE="base",EDITOR_STATE=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),BaseEditor=class{static get EDITOR_TYPE(){return EDITOR_TYPE}constructor(e){_defineProperty58(this,"hot",void 0),_defineProperty58(this,"state",EDITOR_STATE.VIRGIN),_defineProperty58(this,"_opened",!1),_defineProperty58(this,"_fullEditMode",!1),_defineProperty58(this,"_closeCallback",null),_defineProperty58(this,"TD",null),_defineProperty58(this,"row",null),_defineProperty58(this,"col",null),_defineProperty58(this,"prop",null),_defineProperty58(this,"originalValue",null),_defineProperty58(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,r,i,o,a){this.TD=i,this.row=e,this.col=t,this.prop=r,this.originalValue=o,this.cellProperties=a,this.state=this.isOpened()?this.state:EDITOR_STATE.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let r,i,o,a;if(t){const u=this.hot.getSelectedLast();r=Math.max(Math.min(u[0],u[2]),0),i=Math.max(Math.min(u[1],u[3]),0),o=Math.max(u[0],u[2]),a=Math.max(u[1],u[3])}else[r,i,o,a]=[this.row,this.col,null,null];const c=this.hot.runHooks("modifyGetCellCoords",r,i);Array.isArray(c)&&([r,i]=c),this.hot.populateFromArray(r,i,e,o,a,"edit")}beginEditing(e,t){if(this.state!==EDITOR_STATE.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(i,o)),this.state=EDITOR_STATE.EDITING,this.isInFullEditMode()){const a=typeof e=="string"?e:stringify(this.originalValue);this.setValue(a)}this.open(t),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,t,r){let i;if(r){const o=this._closeCallback;this._closeCallback=a=>{o&&o(a),r(a),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===EDITOR_STATE.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===EDITOR_STATE.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=EDITOR_STATE.WAITING,this.saveValue(i,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",a=>{this.state=EDITOR_STATE.FINISHED,this.discardEditor(a)}):(this.state=EDITOR_STATE.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=EDITOR_STATE.FINISHED,this.discardEditor()}discardEditor(e){this.state===EDITOR_STATE.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=EDITOR_STATE.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=EDITOR_STATE.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===EDITOR_STATE.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,a=offset(t),c=outerWidth(t),u=offset(this.hot.rootElement),h=outerWidth(this.hot.rootElement),d=r.topOverlay.holder,f=r.inlineStartOverlay.holder,m=d!==o?d.scrollTop:0,g=f!==o?f.scrollLeft:0,v=o.innerWidth-u.left-h,{wtTable:_}=(e=r.getParentOverlay(t))!==null&&e!==void 0?e:this.hot.view._wt,b=_.name,S=["master","inline_start"].includes(b)?m:0,R=["master","top","bottom"].includes(b)?g:0,A=a.top===u.top?0:1;let I=a.top-u.top-A-S,E=0;this.hot.isRtl()?E=o.innerWidth-a.left-c-v-1+R:E=a.left-u.left-1-R,["top","top_inline_start_corner"].includes(b)&&(I+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(E+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const O=this.hot.hasColHeaders(),P=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),L=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),$=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(O&&P<=0||P===$)&&(I+=1),L<=0&&(E+=1);const W=i.rowsRenderCalculator.startPosition,Z=i.columnsRenderCalculator.startPosition,ie=Math.abs(r.inlineStartOverlay.getScrollPosition()),ue=r.topOverlay.getScrollPosition(),_e=getScrollbarWidth(this.hot.rootDocument);let Te=t.offsetTop;if(["inline_start","master"].includes(b)&&(Te+=W-ue),["bottom","bottom_inline_start_corner"].includes(b)){const{wtViewport:ye,wtTable:we}=r.bottomOverlay.clone;Te+=ye.getWorkspaceHeight()-we.getHeight()-_e}let pe=t.offsetLeft;this.hot.isRtl()?(pe>=0?pe=_.getWidth()-t.offsetLeft:pe=Math.abs(pe),pe+=Z-ie-c):["top","master","bottom"].includes(b)&&(pe+=Z-ie);const me=getComputedStyle3(this.TD,this.hot.rootWindow),Se=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Le=parseInt(me[Se],10)>0?0:1,xe=parseInt(me.borderTopWidth,10)>0?0:1,T=outerWidth(t)+Le,k=outerHeight(t)+xe,D=hasVerticalScrollbar(d)?_e:0,q=hasHorizontalScrollbar(f)?_e:0,B=this.hot.view.maximumVisibleElementWidth(pe)-D+Le,se=Math.max(this.hot.view.maximumVisibleElementHeight(Te)-q+xe,23);return{top:I,start:E,height:k,maxHeight:se,width:T,maxWidth:B}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?t="top-inline-start-corner":t="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?t="bottom-inline-start-corner":t="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}};mixin(BaseEditor,hooksRefRegisterer_default);var command2={name:"editorCloseAndSaveByArrowKeys",callback(e,t,r){const i=e._getEditorManager(),o=i.getActiveEditor();o.isInFullEditMode()&&o.state===EDITOR_STATE.EDITING||(i.closeEditorAndSaveChanges(),e.getSelected()&&(r.includes("arrowdown")?e.selection.transformStart(1,0):r.includes("arrowup")?e.selection.transformStart(-1,0):r.includes("arrowleft")?e.selection.transformStart(0,-1*e.getDirectionFactor()):r.includes("arrowright")&&e.selection.transformStart(0,e.getDirectionFactor())),t.preventDefault())}},command3={name:"editorCloseAndSaveByEnter",callback(e,t){const r=e._getEditorManager();r.closeEditorAndSaveChanges(t.ctrlKey||t.metaKey),r.moveSelectionAfterEnter(t)}},command4={name:"editorCloseWithoutSaving",callback(e){const t=e._getEditorManager();t.closeEditorAndRestoreOriginalValue(e.getShortcutManager().isCtrlPressed()),t.activeEditor.focus()}},command5={name:"editorFastOpen",callback(e,t){const{highlight:r}=e.getSelectedRangeLast();r.isHeader()||e._getEditorManager().openEditor(null,t,!0)}},command6={name:"editorOpen",callback(e,t,r){const i=e._getEditorManager(),o=e.getSelectedRangeLast(),{highlight:a}=o;if(e.selection.isMultiple()&&!o.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0){const c=e.getSettings(),u=typeof c.enterMoves=="function"?c.enterMoves(t):c.enterMoves;r.includes("shift")?e.selection.transformFocus(-u.row,-u.col):e.selection.transformFocus(u.row,u.col);return}a.isHeader()||(e.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(t):i.openEditor(null,t,!0):i.moveSelectionAfterEnter(t),stopImmediatePropagation(t))}};function getAllCommands(){return[command,command2,command3,command4,command5,command6]}var command7={name:"extendCellsSelectionDown",callback(e){const{highlight:t}=e.getSelectedRangeLast();!e.selection.isSelectedByColumnHeader()&&!e.selection.isSelectedByCorner()&&(t.isCell()||t.isHeader()&&e.selection.isSelectedByRowHeader())&&e.selection.transformEnd(1,0)}},command8={name:"extendCellsSelectionDownByViewportHeight",callback(e){const{to:t}=e.getSelectedRangeLast(),r=Math.min(t.row+e.countVisibleRows(),e.countRows()-1),i=e.rowIndexMapper.getNearestNotHiddenIndex(r,-1);if(i!==null){const o=e._createCellCoords(i,t.col),a=t.row-e.view.getFirstFullyVisibleRow(),c=Math.min(o.row-a,e.countRows()-1);e.selection.setRangeEnd(o),e.scrollViewportTo({row:c,verticalSnap:"top",horizontalSnap:"start"})}}},command9={name:"extendCellsSelectionLeft",callback(e){const{highlight:t}=e.getSelectedRangeLast();!e.selection.isSelectedByRowHeader()&&!e.selection.isSelectedByCorner()&&(t.isCell()||t.isHeader()&&e.selection.isSelectedByColumnHeader())&&e.selection.transformEnd(0,-1*e.getDirectionFactor())}},command10={name:"extendCellsSelectionRight",callback(e){const{highlight:t}=e.getSelectedRangeLast();!e.selection.isSelectedByRowHeader()&&!e.selection.isSelectedByCorner()&&(t.isCell()||t.isHeader()&&e.selection.isSelectedByColumnHeader())&&e.selection.transformEnd(0,e.getDirectionFactor())}},command11={name:"extendCellsSelectionToColumns",callback(e){const{highlight:t,from:r,to:i}=e.getSelectedRangeLast();e.selection.isSelectedByRowHeader()?e.selection.selectAll(!0,!0):e.selectColumns(r.col,i.col,t)}},command12={name:"extendCellsSelectionToMostBottom",callback(e){const{selection:t,rowIndexMapper:r}=e,{highlight:i,from:o,to:a}=e.getSelectedRangeLast(),c=i.isHeader()&&e.selection.isSelectedByRowHeader();if(i.isCell()||c){const u=r.getNearestNotHiddenIndex(e.countRows()-1,-1),h=o.clone();h.row=i.row,t.setRangeStart(h,void 0,!1,i.clone()),c&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(u,a.col))}}},command13={name:"extendCellsSelectionToMostInlineEnd",callback(e){const{selection:t,columnIndexMapper:r}=e,{highlight:i,from:o,to:a}=e.getSelectedRangeLast();if(!e.selection.isSelectedByRowHeader()&&!e.selection.isSelectedByCorner()&&i.isCell()){const c=r.getNearestNotHiddenIndex(e.countCols()-1,-1),u=o.clone();u.col=i.col,t.setRangeStart(u,void 0,!1,i.clone()),t.setRangeEnd(e._createCellCoords(a.row,c))}}},command14={name:"extendCellsSelectionToMostInlineStart",callback(e){const{selection:t,columnIndexMapper:r}=e,{highlight:i,from:o,to:a}=e.getSelectedRangeLast();if(!e.selection.isSelectedByRowHeader()&&!e.selection.isSelectedByCorner()&&i.isCell()){const c=parseInt(e.getSettings().fixedColumnsStart,10),u=r.getNearestNotHiddenIndex(c,1),h=o.clone();h.col=i.col,t.setRangeStart(h,void 0,!1,i.clone()),t.setRangeEnd(e._createCellCoords(a.row,u))}}},command15={name:"extendCellsSelectionToMostLeft",callback(e){const{selection:t,columnIndexMapper:r}=e,{highlight:i,from:o,to:a}=e.getSelectedRangeLast(),c=i.isHeader()&&e.selection.isSelectedByColumnHeader();if(i.isCell()||c){const u=r.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]),h=o.clone();h.col=i.col,t.setRangeStart(h,void 0,!1,i.clone()),c&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(a.row,u))}}},command16={name:"extendCellsSelectionToMostRight",callback(e){const{selection:t,columnIndexMapper:r}=e,{highlight:i,from:o,to:a}=e.getSelectedRangeLast(),c=i.isHeader()&&e.selection.isSelectedByColumnHeader();if(i.isCell()||c){const u=r.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]),h=o.clone();h.col=i.col,t.setRangeStart(h,void 0,!1,i.clone()),c&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(a.row,u))}}},command17={name:"extendCellsSelectionToMostTop",callback(e){const{selection:t,rowIndexMapper:r}=e,{highlight:i,from:o,to:a}=e.getSelectedRangeLast(),c=i.isHeader()&&e.selection.isSelectedByRowHeader();if(i.isCell()||c){const u=r.getNearestNotHiddenIndex(0,1),h=o.clone();h.row=i.row,t.setRangeStart(h,void 0,!1,i.clone()),c&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(u,a.col))}}},command18={name:"extendCellsSelectionToRows",callback(e){const{highlight:t,from:r,to:i}=e.getSelectedRangeLast();e.selection.isSelectedByColumnHeader()?e.selection.selectAll(!0,!0):e.selectRows(r.row,i.row,t)}},command19={name:"extendCellsSelectionUp",callback(e){const{highlight:t}=e.getSelectedRangeLast();!e.selection.isSelectedByColumnHeader()&&!e.selection.isSelectedByCorner()&&(t.isCell()||t.isHeader()&&e.selection.isSelectedByRowHeader())&&e.selection.transformEnd(-1,0)}},command20={name:"extendCellsSelectionUpByViewportHeight",callback(e){const{to:t}=e.getSelectedRangeLast(),r=Math.max(t.row-e.countVisibleRows(),0),i=e.rowIndexMapper.getNearestNotHiddenIndex(r,1);if(i!==null){const o=e._createCellCoords(i,t.col),a=t.row-e.view.getFirstFullyVisibleRow(),c=Math.max(o.row-a,0);e.selection.setRangeEnd(o),e.scrollViewportTo({row:c,verticalSnap:"top",horizontalSnap:"start"})}}};function getAllCommands2(){return[command7,command8,command9,command10,command11,command12,command13,command14,command15,command16,command17,command18,command19,command20]}var command21={name:"moveCellSelectionDown",callback(e){let{selection:t}=e;t.transformStart(1,0)}},command22={name:"moveCellSelectionDownByViewportHeight",callback(e){const{navigableHeaders:t}=e.getSettings(),r=t?e.countColHeaders():0,{row:i}=e.getSelectedRangeLast().highlight;let o=e.countVisibleRows()+r;i===e.countRows()-1?o=1:i+o>e.countRows()&&(o=e.countRows()-i-1),e.selection.transformStart(o,0),e.getSelectedRangeLast().highlight.row<0&&e.scrollViewportTo({row:0})}},command23={name:"moveCellSelectionInlineEnd",callback(e,t){const r=e.getSettings(),i=e.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(t):r.tabMoves;e.selection.isMultiple()&&!i.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0?e.selection.transformFocus(-o.row,-o.col):e.selection.transformStart(-o.row,-o.col)}},command24={name:"moveCellSelectionInlineStart",callback(e,t){const r=e.getSettings(),i=e.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(t):r.tabMoves;e.selection.isMultiple()&&!i.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0?e.selection.transformFocus(o.row,o.col):e.selection.transformStart(o.row,o.col)}},command25={name:"moveCellSelectionLeft",callback(e){e.selection.transformStart(0,-1*e.getDirectionFactor())}},command26={name:"moveCellSelectionRight",callback(e){e.selection.transformStart(0,e.getDirectionFactor())}},command27={name:"moveCellSelectionToMostBottom",callback(e){const{col:t}=e.getSelectedRangeLast().highlight;let r=e.rowIndexMapper.getNearestNotHiddenIndex(e.countRows()-1,-1);r===null&&(r=-1),e.selection.setRangeStart(e._createCellCoords(r,t))}},command28={name:"moveCellSelectionToMostBottomInlineEnd",callback(e){const{selection:t,rowIndexMapper:r,columnIndexMapper:i}=e,o=parseInt(e.getSettings().fixedRowsBottom,10),a=r.getNearestNotHiddenIndex(e.countRows()-o-1,-1),c=i.getNearestNotHiddenIndex(e.countCols()-1,-1);t.setRangeStart(e._createCellCoords(a,c))}},command29={name:"moveCellSelectionToMostInlineEnd",callback(e){const{selection:t,columnIndexMapper:r}=e;t.setRangeStart(e._createCellCoords(e.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(e.countCols()-1,-1)))}},command30={name:"moveCellSelectionToMostInlineStart",callback(e){const{selection:t,columnIndexMapper:r}=e,i=parseInt(e.getSettings().fixedColumnsStart,10),o=e.getSelectedRangeLast().highlight.row,a=r.getNearestNotHiddenIndex(i,1);t.setRangeStart(e._createCellCoords(o,a))}},command31={name:"moveCellSelectionToMostLeft",callback(e){const{selection:t,columnIndexMapper:r}=e,i=e.getSelectedRangeLast().highlight.row;let o=r.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]);o===null&&(o=e.isRtl()?-1:-e.countRowHeaders()),t.setRangeStart(e._createCellCoords(i,o))}},command32={name:"moveCellSelectionToMostRight",callback(e){const{selection:t,columnIndexMapper:r}=e,{row:i}=e.getSelectedRangeLast().highlight;let o=r.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]);o===null&&(o=e.isRtl()?-e.countRowHeaders():-1),t.setRangeStart(e._createCellCoords(i,o))}},command33={name:"moveCellSelectionToMostTop",callback(e){const{col:t}=e.getSelectedRangeLast().highlight;let r=e.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-e.countColHeaders()),e.selection.setRangeStart(e._createCellCoords(r,t))}},command34={name:"moveCellSelectionToMostTopInlineStart",callback(e){const{selection:t,rowIndexMapper:r,columnIndexMapper:i}=e,o=parseInt(e.getSettings().fixedRowsTop,10),a=parseInt(e.getSettings().fixedColumnsStart,10),c=r.getNearestNotHiddenIndex(o,1),u=i.getNearestNotHiddenIndex(a,1);t.setRangeStart(e._createCellCoords(c,u))}},command35={name:"moveCellSelectionUp",callback(e){let{selection:t}=e;t.transformStart(-1,0)}},command36={name:"moveCellSelectionUpByViewportHight",callback(e){const{navigableHeaders:t}=e.getSettings(),r=t?e.countColHeaders():0,{row:i}=e.getSelectedRangeLast().highlight;let o=-(e.countVisibleRows()+r);i===-r?o=-1:i+o<r&&(o=-(i+r)),e.selection.transformStart(o,0),e.getSelectedRangeLast().highlight.row<0&&e.scrollViewportTo({row:0})}};function getAllCommands3(){return[command21,command22,command23,command24,command25,command26,command27,command28,command29,command30,command31,command32,command33,command34,command35,command36]}var command37={name:"emptySelectedCells",callback(e){e.emptySelectedCells(),e._getEditorManager().prepareEditor()}},command38={name:"scrollToFocusedCell",callback(e){const{highlight:t}=e.getSelectedRangeLast(),r=e.view.getFirstFullyVisibleRow()-1,i=e.view.getFirstFullyVisibleColumn()-1,o=e.view.getLastFullyVisibleRow()+1,a=e.view.getLastFullyVisibleColumn()+1,c=e._createCellCoords(r,i),u=e._createCellCoords(o,a);if(!e._createCellRange(c,c,u).includes(t)&&(t.row>=0||t.col>=0)){const d={};if(t.col>=0){const f=Math.floor(e.countVisibleCols()/2);d.col=Math.max(t.col-f,0)}if(t.row>=0){const f=Math.floor(e.countVisibleRows()/2);d.row=Math.max(t.row-f,0)}e.scrollViewportTo({...d,verticalSnap:"top",horizontalSnap:"start"})}}},command39={name:"selectAllCells",callback(e){e.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},command40={name:"selectAllCellsAndHeaders",callback(e){e.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},command41={name:"populateSelectedCellsData",callback(e){const t=e.getSelectedRange(),{row:r,col:i}=t[t.length-1].highlight.normalize(),o=e.getDataAtCell(r,i),a=new Map;for(let c=0;c<t.length;c++)t[c].forAll((u,h)=>{if(u>=0&&h>=0&&(u!==r||h!==i)){const{readOnly:d}=e.getCellMeta(u,h);d||a.set(`${u}x${h}`,[u,h,o])}});e.setDataAtCell(Array.from(a.values()))}},allCommands=[...getAllCommands(),...getAllCommands2(),...getAllCommands3(),command37,command38,command39,command40,command41];function createKeyboardShortcutCommandsPool(e){const t={};return allCommands.forEach(r=>{let{name:i,callback:o}=r;t[i]=function(){for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return o(e,...c)}}),t}function shortcutsEditorContext(e){const t=e.getShortcutManager().addContext("editor"),r=createKeyboardShortcutCommandsPool(e),i={group:EDITOR_EDIT_GROUP};t.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(o,a)=>r.editorCloseAndSaveByEnter(o,a)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(o,a)=>r.editorCloseAndSaveByEnter(o,a)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:(o,a)=>r.editorCloseAndSave(o,a)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(o,a)=>r.editorCloseAndSaveByArrowKeys(o,a)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],i)}function shortcutsGridContext(e){const t=e.getShortcutManager().addContext("grid"),r=createKeyboardShortcutCommandsPool(e),i={runOnlyIf:()=>{const{navigableHeaders:o}=e.getSettings();return isDefined(e.getSelected())&&(o||!o&&e.countRenderedRows()>0&&e.countRenderedCols()>0)},group:GRID_GROUP};t.addShortcuts([{keys:[["F2"]],callback:o=>r.editorFastOpen(o)},{keys:[["Enter"],["Enter","Shift"]],callback:(o,a)=>r.editorOpen(o,a)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:EDITOR_EDIT_GROUP,runOnlyIf:()=>isDefined(e.getSelected())}),t.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var o;return!((o=e.getSelectedRangeLast())!==null&&o!==void 0&&o.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var o;return(o=e.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var o,a;return!((o=e.getSelectedRangeLast())!==null&&o!==void 0&&o.highlight.isHeader())&&((a=e.getSelectedRangeLast())===null||a===void 0?void 0:a.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:o=>r.moveCellSelectionInlineStart(o)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:o=>r.moveCellSelectionInlineEnd(o)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],i)}function registerAllShortcutContexts(e){[shortcutsGridContext,shortcutsEditorContext].forEach(t=>t(e))}function installFocusDetector(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=e.rootElement,i=createInputElement(e),o=createInputElement(e);return i.addEventListener("focus",()=>t?.onFocusFromTop()),o.addEventListener("focus",()=>t?.onFocusFromBottom()),r.firstChild.before(i),r.lastChild.after(o),{activate(){e._registerTimeout(()=>{i.tabIndex=0,o.tabIndex=0},10)},deactivate(){e._registerTimeout(()=>{i.tabIndex=-1,o.tabIndex=-1},10)}}}function createInputElement(e){const r=e.rootDocument.createElement("input");return r.type="text",r.classList.add("htFocusCatcher"),e.getSettings().ariaTags&&setAttribute(r,[A11Y_PRESENTATION(),A11Y_HIDDEN()]),r}function installFocusCatcher(e){const t=normalizeCoordsIfNeeded(e);let r;const{activate:i,deactivate:o}=installFocusDetector(e,{onFocusFromTop(){var m;const g=(m=t(r))!==null&&m!==void 0?m:getMostTopStartPosition(e);g&&(e.runHooks("modifyFocusOnTabNavigation","from_above",g),e.selectCell(g.row,g.col)),e.listen()},onFocusFromBottom(){var m;const g=(m=t(r))!==null&&m!==void 0?m:getMostBottomEndPosition(e);g&&(e.runHooks("modifyFocusOnTabNavigation","from_below",g),e.selectCell(g.row,g.col)),e.listen()}}),a={wrapped:!1,flipped:!1};let c=!0,u=!1,h=!1;e.addHook("afterListen",()=>o()),e.addHook("afterUnlisten",()=>i()),e.addHook("afterSelection",(m,g,v,_,b)=>{if(u&&(a.wrapped&&a.flipped||h)&&(h=!1,b.value=!0),c){var S;r=(S=e.getSelectedRangeLast())===null||S===void 0?void 0:S.highlight}}),e.addHook("beforeRowWrap",(m,g,v)=>{a.wrapped=!0,a.flipped=v});function d(){a.wrapped=!1,a.flipped=!1,e.deselectCell(),e.unlisten()}const f={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:GRID_GROUP,group:"focusCatcher"};e.getShortcutManager().getContext("grid").addShortcuts([{...f,callback:()=>{const{tabNavigation:m}=e.getSettings();u=!0,e.getSelectedRangeLast()&&!m&&(c=!1),m||(h=!0)},position:"before"},{...f,callback:m=>{const{tabNavigation:g,autoWrapRow:v}=e.getSettings();if(u=!1,c=!0,!g||!e.selection.isSelected()||v&&a.wrapped&&a.flipped||!v&&a.wrapped)return v&&a.wrapped&&a.flipped&&(r=m.shiftKey?getMostTopStartPosition(e):getMostBottomEndPosition(e)),d(),!1;m.preventDefault()},position:"after"}])}function getMostTopStartPosition(e){const{rowIndexMapper:t,columnIndexMapper:r}=e,{navigableHeaders:i}=e.getSettings();let o=i&&e.countColHeaders()>0?-e.countColHeaders():0,a=i&&e.countRowHeaders()>0?-e.countRowHeaders():0;return o===0&&(o=t.getVisualFromRenderableIndex(o)),a===0&&(a=r.getVisualFromRenderableIndex(a)),o===null||a===null?null:e._createCellCoords(o,a)}function getMostBottomEndPosition(e){var t,r;const{rowIndexMapper:i,columnIndexMapper:o}=e,{navigableHeaders:a}=e.getSettings();let c=i.getRenderableIndexesLength()-1,u=o.getRenderableIndexesLength()-1;if(c<0){if(!a||e.countColHeaders()===0)return null;c=-1}if(u<0){if(!a||e.countColHeaders()===0)return null;u=-1}return e._createCellCoords((t=i.getVisualFromRenderableIndex(c))!==null&&t!==void 0?t:c,(r=o.getVisualFromRenderableIndex(u))!==null&&r!==void 0?r:u)}function normalizeCoordsIfNeeded(e){return t=>{if(!t)return null;const r=getMostTopStartPosition(e),i=getMostBottomEndPosition(e);return t.col<r.col&&(t.col=r.col),t.col>i.col&&(t.col=i.col),t.row<r.row&&(t.row=r.row),t.row>i.row&&(t.row=i.row),t}}function columnHeaderScrollStrategy(e){return t=>{let{col:r}=t;e.scrollViewportTo({col:r})}}function cornerHeaderScrollStrategy(){return()=>{}}function focusScrollStrategy(e){return t=>{e.scrollViewportTo(t.toObject())}}function multipleScrollStrategy(e){return t=>{e.scrollViewportTo(t.toObject())}}function noncontiguousScrollStrategy(e){return t=>{e.scrollViewportTo(t.toObject())}}function rowHeaderScrollStrategy(e){return t=>{let{row:r}=t;e.scrollViewportTo({row:r})}}function singleScrollStrategy(e){return t=>{const r=e.selection.getSelectionSource(),{row:i,col:o}=t;if(i<0&&o>=0)e.scrollViewportTo({col:o});else if(o<0&&i>=0)e.scrollViewportTo({row:i});else{if(r==="mouse"&&(o===e.view.getLastPartiallyVisibleColumn()||i===e.view.getLastPartiallyVisibleRow()))return;e.scrollViewportTo({row:i,col:o})}}}function createViewportScroller(e){const{selection:t}=e;let r=!1,i=!1;return{resume(){i=!1},suspend(){i=!0},skipNextScrollCycle(){r=!0},scrollTo(o){var a;if(r||i){r=!1;return}let c;t.isFocusSelectionChanged()?c=focusScrollStrategy(e):t.isSelectedByCorner()?c=cornerHeaderScrollStrategy(e):t.isSelectedByRowHeader()?c=rowHeaderScrollStrategy(e):t.isSelectedByColumnHeader()?c=columnHeaderScrollStrategy(e):t.getSelectedRange().size()===1&&t.isMultiple()?c=multipleScrollStrategy(e):t.getSelectedRange().size()===1&&!t.isMultiple()?c=singleScrollStrategy(e):t.getSelectedRange().size()>1&&(c=noncontiguousScrollStrategy(e)),(a=c)===null||a===void 0||a(o)}}}var import_es_error_cause84=__toESM(require_es_error_cause(),1),import_es_error_cause83=__toESM(require_es_error_cause(),1),import_es_array_push37=__toESM(require_es_array_push(),1),mappings=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),normalizeKeys=e=>e.map(t=>{const r=t.toLowerCase();return mappings.has(r)?mappings.get(r):r}).sort().join("+"),getKeysList=e=>e.split("+"),specialCharactersSet=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),normalizeEventKey=e=>{let{which:t,key:r}=e;if(specialCharactersSet.has(t))return specialCharactersSet.get(t);const i=String.fromCharCode(t).toLowerCase();return/^[a-z0-9]$/.test(i)?i:r.toLowerCase()},__kindOf=Symbol("shortcut-context");function isContextObject(e){return isObject2(e)&&e.__kindOf===__kindOf}var createContext2=e=>{const t=createUniqueMap({errorIdExists:h=>`The "${h}" shortcut is already registered in the "${e}" context.`}),r=function(){let{keys:h,callback:d,group:f,runOnlyIf:m=()=>!0,captureCtrl:g=!1,preventDefault:v=!0,stopPropagation:_=!1,relativeToGroup:b,position:S,forwardToContext:R}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(isUndefined(f))throw new Error("You need to define the shortcut's group.");if(isFunction2(d)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(h)===!1)throw new Error(toSingleLine`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const A={callback:d,group:f,runOnlyIf:m,captureCtrl:g,preventDefault:v,stopPropagation:_};isDefined(b)&&(A.relativeToGroup=b,A.position=S),isContextObject(R)&&(A.forwardToContext=R),h.forEach(I=>{const E=normalizeKeys(I);if(t.hasItem(E)){const P=t.getItem(E);let L=P.findIndex(V=>V.group===b);L!==-1?S==="before"?L-=1:L+=1:L=P.length,P.splice(L,0,A)}else t.addItem(E,[A])})},i=function(h){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};h.forEach(f=>{objectEach(d,(m,g)=>{Object.prototype.hasOwnProperty.call(f,g)===!1&&(f[g]=d[g])}),r(f)})},o=h=>{const d=normalizeKeys(h);t.removeItem(d)};return{__kindOf,addShortcut:r,addShortcuts:i,getShortcuts:h=>{const d=normalizeKeys(h),f=t.getItem(d);return isDefined(f)?f.slice():[]},hasShortcut:h=>{const d=normalizeKeys(h);return t.hasItem(d)},removeShortcutsByKeys:o,removeShortcutsByGroup:h=>{t.getItems().forEach(f=>{let[m,g]=f;const v=g.filter(_=>_.group!==h);v.length===0?o(getKeysList(m)):(g.length=0,g.push(...v))})}}},import_es_array_push38=__toESM(require_es_array_push(),1),import_es_set_difference_v214=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v214=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v214=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v214=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v214=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v214=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v214=__toESM(require_es_set_union_v2(),1);function createKeysObserver(){const e=new Set;return{press(t){e.add(t)},release(t){e.delete(t)},releaseAll(){e.clear()},isPressed(t){return e.has(t)}}}var MODIFIER_KEYS=["meta","alt","shift","control"],modifierKeysObserver=createKeysObserver(),modKeyListeners=[],instanceCounter=0;function useRecorder(e,t,r,i,o){const a=v=>MODIFIER_KEYS.includes(v),c=function(v){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const b=[];return v.altKey&&b.push("alt"),_&&(v.ctrlKey||v.metaKey)?b.push("control/meta"):(v.ctrlKey&&b.push("control"),v.metaKey&&b.push("meta")),v.shiftKey&&b.push("shift"),b},u=v=>{if(t(v)===!1)return;const _=r(v);if(v.keyCode===229||_===!1||isImmediatePropagationStopped(v))return;const b=normalizeEventKey(v);let S=[];a(b)||(S=c(v));const R=[b].concat(S);!o(v,R)&&(isMacOS()&&S.includes("meta")||!isMacOS()&&S.includes("control"))&&o(v,[b].concat(c(v,!0))),i(v)},h=v=>{if(v.key){const _=normalizeEventKey(v);a(_)&&modifierKeysObserver.press(_)}},d=v=>{if(v.key){const _=normalizeEventKey(v);a(_)&&modifierKeysObserver.release(_)}},f=()=>{modifierKeysObserver.releaseAll()};return{mount:()=>{let v=e;for(instanceCounter+=1;v;)instanceCounter===1&&(v.document.documentElement.addEventListener("keydown",h),modKeyListeners.push({event:"keydown",listener:h}),v.document.documentElement.addEventListener("keyup",d),modKeyListeners.push({event:"keyup",listener:d})),v.document.documentElement.addEventListener("keydown",u),v.document.documentElement.addEventListener("blur",f),v=getParentWindow(v)},unmount:()=>{let v=e;for(instanceCounter-=1;v;){if(instanceCounter===0){for(let _=0;_<modKeyListeners.length;_++){const{event:b,listener:S}=modKeyListeners[_];v.document.documentElement.removeEventListener(b,S)}modKeyListeners.length=0}v.document.documentElement.removeEventListener("keydown",u),v.document.documentElement.removeEventListener("blur",f),v=getParentWindow(v)}},isPressed:v=>modifierKeysObserver.isPressed(v),releasePressedKeys:()=>modifierKeysObserver.releaseAll()}}var createShortcutManager=e=>{let{ownerWindow:t,handleEvent:r,beforeKeyDown:i,afterKeyDown:o}=e;const a=createUniqueMap({errorIdExists:_=>`The "${_}" context name is already registered.`});let c="grid";const u=_=>{const b=createContext2(_);return a.addItem(_,b),b},h=()=>c,d=_=>a.getItem(_),f=_=>{if(!a.hasItem(_))throw new Error(toSingleLine`You've tried to activate the "${_}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);c=_};let m=!1;const g=function(_,b){let S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:h();const R=isContextObject(S)?S:d(S);let A=!1;if(!R.hasShortcut(b))return A;const I=R.getShortcuts(b);for(let E=0;E<I.length;E++){const{callback:O,runOnlyIf:P,preventDefault:L,stopPropagation:V,captureCtrl:$,forwardToContext:W}=I[E];if(P(_)===!0){if(m=$,A=O(_,b)===!1,m=!1,L&&_.preventDefault(),V&&(stopImmediatePropagation(_),_.stopPropagation()),A)break;W&&g(_,b,W)}}return A},v=useRecorder(t,r,i,o,g);return v.mount(),{addContext:u,getActiveContextName:h,getContext:d,setActiveContextName:f,isCtrlPressed:()=>!m&&(v.isPressed("control")||v.isPressed("meta")),releasePressedKeys:()=>v.releasePressedKeys(),destroy:()=>v.unmount()}},activeGuid=null,foreignHotInstances=new Map;function Core(e,t){var r,i=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this;const c=new eventManager_default(a);let u,h,d,f,m,g,v=!0;hasValidParameter(o)&&registerAsRootInstance(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const _=(r=t?.layoutDirection)!==null&&r!==void 0?r:"inherit",b=["rtl","ltr"].includes(_)?_:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",b),this.isRtl=function(){return b==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},t.language=getValidLanguageCode(t.language);const S=new MetaManager(a,t,[DynamicCellMetaMod,ExtendMetaPropertiesMod]),R=S.getTableMeta(),A=S.getGlobalMeta(),I=createUniqueMap();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),isRootInstance(this)&&_injectProductInfo(t.licenseKey,e),this.guid=`ht_${randomString()}`,foreignHotInstances.set(this.guid,this),this.columnIndexMapper=new IndexMapper,this.rowIndexMapper=new IndexMapper,this.columnIndexMapper.addLocalHook("indexesSequenceChange",T=>{a.runHooks("afterColumnSequenceChange",T)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",T=>{a.runHooks("afterRowSequenceChange",T)}),h=new dataSource_default(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const E=T=>{const{row:k,col:D}=T;return a._createCellCoords(k>=0?a.rowIndexMapper.getRenderableFromVisualIndex(k):k,D>=0?a.columnIndexMapper.getRenderableFromVisualIndex(D):D)},O=T=>{const{row:k,col:D}=T;return a._createCellCoords(k>=0?a.rowIndexMapper.getVisualFromRenderableIndex(k):k,D>=0?a.columnIndexMapper.getVisualFromRenderableIndex(D):D)},P=(T,k)=>{const D=k>T?1:-1,q=Math.min(T,k),B=Math.max(T,k),se=a.rowIndexMapper.getNearestNotHiddenIndex(T,D);return se===null||D===1&&se>B||D===-1&&se<q?null:se>=0?a.rowIndexMapper.getRenderableFromVisualIndex(se):se},L=(T,k)=>{const D=k>T?1:-1,q=Math.min(T,k),B=Math.max(T,k),se=a.columnIndexMapper.getNearestNotHiddenIndex(T,D);return se===null||D===1&&se>B||D===-1&&se<q?null:se>=0?a.columnIndexMapper.getRenderableFromVisualIndex(se):se};let V=new selection_default4(R,{rowIndexMapper:a.rowIndexMapper,columnIndexMapper:a.columnIndexMapper,countCols:()=>a.countCols(),countRows:()=>a.countRows(),propToCol:T=>u.propToCol(T),isEditorOpened:()=>a.getActiveEditor()?a.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>a.getShortcutManager(),createCellCoords:(T,k)=>a._createCellCoords(T,k),createCellRange:(T,k,D)=>a._createCellRange(T,k,D),visualToRenderableCoords:E,renderableToVisualCoords:O,findFirstNonHiddenRenderableRow:P,findFirstNonHiddenRenderableColumn:L,isDisabledCellSelection:(T,k)=>T<0||k<0?a.getSettings().disableVisualSelection:a.getCellMeta(T,k).disableVisualSelection});this.selection=V;const $=T=>{let{hiddenIndexesChanged:k}=T;k&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",$),this.rowIndexMapper.addLocalHook("cacheUpdated",$),this.selection.addLocalHook("afterSetRangeEnd",(T,k)=>{const D=createObjectPropListener(!1),q=this.selection.getSelectedRange(),{from:B,to:se}=q.current(),ye=q.size()-1;this.runHooks("afterSelection",B.row,B.col,se.row,se.col,D,ye),this.runHooks("afterSelectionByProp",B.row,a.colToProp(B.col),se.row,a.colToProp(se.col),D,ye),k&&(!D.isTouched()||D.isTouched()&&!D.value)&&g.scrollTo(T);const we=V.isSelectedByRowHeader(),de=V.isSelectedByColumnHeader();we&&de?addClass(this.rootElement,["ht__selection--rows","ht__selection--columns"]):we?(removeClass(this.rootElement,"ht__selection--columns"),addClass(this.rootElement,"ht__selection--rows")):de?(removeClass(this.rootElement,"ht__selection--rows"),addClass(this.rootElement,"ht__selection--columns")):removeClass(this.rootElement,["ht__selection--rows","ht__selection--columns"]),V.getSelectionSource()!=="shift"&&f.closeEditor(null),a.view.render(),f.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",T=>{this.runHooks("beforeSelectionFocusSet",T.row,T.col)}),this.selection.addLocalHook("afterSetFocus",T=>{const k=createObjectPropListener(!1);this.runHooks("afterSelectionFocusSet",T.row,T.col,k),(!k.isTouched()||k.isTouched()&&!k.value)&&g.scrollTo(T),f.closeEditor(),a.view.render(),f.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",T=>{const k=T.length-1,{from:D,to:q}=T[k];this.runHooks("afterSelectionEnd",D.row,D.col,q.row,q.col,k),this.runHooks("afterSelectionEndByProp",D.row,a.colToProp(D.col),q.row,a.colToProp(q.col),k)}),this.selection.addLocalHook("afterIsMultipleSelection",T=>{const k=this.runHooks("afterIsMultipleSelection",T.value);T.value&&(T.value=k)}),this.selection.addLocalHook("afterDeselect",()=>{f.closeEditor(),a.view.render(),removeClass(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var T=arguments.length,k=new Array(T),D=0;D<T;D++)k[D]=arguments[D];return i.runHooks("beforeSetRangeStart",...k)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var T=arguments.length,k=new Array(T),D=0;D<T;D++)k[D]=arguments[D];return i.runHooks("beforeSetRangeStartOnly",...k)}).addLocalHook("beforeSetRangeEnd",function(){for(var T=arguments.length,k=new Array(T),D=0;D<T;D++)k[D]=arguments[D];return i.runHooks("beforeSetRangeEnd",...k)}).addLocalHook("beforeSelectColumns",function(){for(var T=arguments.length,k=new Array(T),D=0;D<T;D++)k[D]=arguments[D];return i.runHooks("beforeSelectColumns",...k)}).addLocalHook("afterSelectColumns",function(){for(var T=arguments.length,k=new Array(T),D=0;D<T;D++)k[D]=arguments[D];return i.runHooks("afterSelectColumns",...k)}).addLocalHook("beforeSelectRows",function(){for(var T=arguments.length,k=new Array(T),D=0;D<T;D++)k[D]=arguments[D];return i.runHooks("beforeSelectRows",...k)}).addLocalHook("afterSelectRows",function(){for(var T=arguments.length,k=new Array(T),D=0;D<T;D++)k[D]=arguments[D];return i.runHooks("afterSelectRows",...k)}).addLocalHook("beforeModifyTransformStart",function(){for(var T=arguments.length,k=new Array(T),D=0;D<T;D++)k[D]=arguments[D];return i.runHooks("modifyTransformStart",...k)}).addLocalHook("afterModifyTransformStart",function(){for(var T=arguments.length,k=new Array(T),D=0;D<T;D++)k[D]=arguments[D];return i.runHooks("afterModifyTransformStart",...k)}).addLocalHook("beforeModifyTransformFocus",function(){for(var T=arguments.length,k=new Array(T),D=0;D<T;D++)k[D]=arguments[D];return i.runHooks("modifyTransformFocus",...k)}).addLocalHook("afterModifyTransformFocus",function(){for(var T=arguments.length,k=new Array(T),D=0;D<T;D++)k[D]=arguments[D];return i.runHooks("afterModifyTransformFocus",...k)}).addLocalHook("beforeModifyTransformEnd",function(){for(var T=arguments.length,k=new Array(T),D=0;D<T;D++)k[D]=arguments[D];return i.runHooks("modifyTransformEnd",...k)}).addLocalHook("afterModifyTransformEnd",function(){for(var T=arguments.length,k=new Array(T),D=0;D<T;D++)k[D]=arguments[D];return i.runHooks("afterModifyTransformEnd",...k)}).addLocalHook("beforeRowWrap",function(){for(var T=arguments.length,k=new Array(T),D=0;D<T;D++)k[D]=arguments[D];return i.runHooks("beforeRowWrap",...k)}).addLocalHook("beforeColumnWrap",function(){for(var T=arguments.length,k=new Array(T),D=0;D<T;D++)k[D]=arguments[D];return i.runHooks("beforeColumnWrap",...k)}).addLocalHook("insertRowRequire",T=>this.alter("insert_row_above",T,1,"auto")).addLocalHook("insertColRequire",T=>this.alter("insert_col_start",T,1,"auto")),d={alter(T,k){var D,q;let B=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,se=arguments.length>3?arguments[3]:void 0,ye=arguments.length>4?arguments[4]:void 0;const we=de=>{if(de.length===0)return[];const be=[...de];return be.sort((he,Ne)=>{let[le]=he,[Ve]=Ne;return le===Ve?0:le>Ve?1:-1}),arrayReduce(be,(he,Ne)=>{let[le,Ve]=Ne;const Be=he[he.length-1],[Ue,je]=Be,We=Ue+je;if(le<=We){const H=Math.max(Ve-(We-le),0);Be[1]+=H}else he.push([le,Ve]);return he},[be[0]])};switch(T){case"insert_row_below":case"insert_row_above":const de=a.countSourceRows();if(R.maxRows===de)return;const be=T==="insert_row_below"?"below":"above";k=(D=k)!==null&&D!==void 0?D:be==="below"?de:0;const{delta:fe,startPhysicalIndex:he}=u.createRow(k,B,{source:se,mode:be});V.shiftRows(a.toVisualRow(he),fe);break;case"insert_col_start":case"insert_col_end":const Ne=T==="insert_col_end"?"end":"start";k=(q=k)!==null&&q!==void 0?q:Ne==="end"?a.countSourceCols():0;const{delta:le,startPhysicalIndex:Ve}=u.createCol(k,B,{source:se,mode:Ne});if(le){if(Array.isArray(R.colHeaders)){const je=[a.toVisualColumn(Ve),0];je.length+=le,Array.prototype.splice.apply(R.colHeaders,je)}V.shiftColumns(a.toVisualColumn(Ve),le)}break;case"remove_row":const Be=je=>{let We=0;arrayEach(je,H=>{let[F,G]=H;const oe=isEmpty(F)?a.countRows()-1:Math.max(F-We,0);if(Number.isInteger(F)&&(F=Math.max(F-We,0)),!u.removeRow(F,G,se))return;if(V.isSelected()){const{row:j}=a.getSelectedRangeLast().highlight;j>=F&&j<=F+G-1&&f.closeEditor(!0)}const ce=a.countRows();ce===0?V.deselect():se==="ContextMenu.removeRow"?V.refresh():V.shiftRows(F,-G);const ee=R.fixedRowsTop;ee>=oe+1&&(R.fixedRowsTop-=Math.min(G,ee-oe));const te=R.fixedRowsBottom;te&&oe>=ce-te&&(R.fixedRowsBottom-=Math.min(G,te)),We+=G})};Array.isArray(k)?Be(we(k)):Be([[k,B]]);break;case"remove_col":const Ue=je=>{let We=0;arrayEach(je,H=>{let[F,G]=H;const oe=isEmpty(F)?a.countCols()-1:Math.max(F-We,0);let Q=a.toPhysicalColumn(oe);if(Number.isInteger(F)&&(F=Math.max(F-We,0)),!u.removeCol(F,G,se))return;if(V.isSelected()){const{col:j}=a.getSelectedRangeLast().highlight;j>=F&&j<=F+G-1&&f.closeEditor(!0)}a.countCols()===0?V.deselect():se==="ContextMenu.removeColumn"?V.refresh():V.shiftColumns(F,-G);const te=R.fixedColumnsStart;te>=oe+1&&(R.fixedColumnsStart-=Math.min(G,te-oe)),Array.isArray(R.colHeaders)&&(typeof Q>"u"&&(Q=-1),R.colHeaders.splice(Q,G)),We+=G})};Array.isArray(k)?Ue(we(k)):Ue([[k,B]]);break;default:throw new Error(`There is no such action "${T}"`)}a.view.render(),ye||d.adjustRowsAndCols()},adjustRowsAndCols(){const T=R.minRows,k=R.minSpareRows,D=R.minCols,q=R.minSpareCols;if(T){const B=a.countRows();B<T&&u.createRow(B,T-B,{source:"auto"})}if(k){const B=a.countEmptyRows(!0);if(B<k){const se=k-B,ye=Math.min(se,R.maxRows-a.countSourceRows());u.createRow(a.countRows(),ye,{source:"auto"})}}{let B;(D||q)&&(B=a.countEmptyCols(!0));let se=a.countCols();if(D&&!R.columns&&se<D){const ye=D-se;B+=ye,u.createCol(se,ye,{source:"auto"})}if(q&&!R.columns&&a.dataType==="array"&&B<q){se=a.countCols();const ye=q-B,we=Math.min(ye,R.maxCols-se);u.createCol(se,we,{source:"auto"})}}a.view&&a.view.adjustElementsSize()},populateFromArray(T,k,D,q,B){let se,ye,we,de;const be=[],fe={},he=[],Ne=T.row,le=T.col;if(ye=k.length,ye===0)return!1;let Ve=0,Be=0;switch(isObject2(D)&&(Ve=D.col-le+1,Be=D.row-Ne+1),B){case"shift_down":const Ue=pivot(k),je=Ue.length,We=Math.max(je,Ve),H=a.getData().slice(Ne),F=pivot(H).slice(le,le+We);for(we=0;we<We;we+=1)if(we<je){for(se=0,ye=Ue[we].length;se<Be-ye;se+=1)Ue[we].push(Ue[we][se%ye]);we<F.length?he.push(Ue[we].concat(F[we])):he.push(Ue[we].concat(new Array(H.length).fill(null)))}else he.push(Ue[we%je].concat(F[we]));a.populateFromArray(Ne,le,pivot(he));break;case"shift_right":const G=k.length,oe=Math.max(G,Be),Q=a.getData().slice(Ne).map(Re=>Re.slice(le));for(se=0;se<oe;se+=1)if(se<G){for(we=0,de=k[se].length;we<Ve-de;we+=1)k[se].push(k[se][we%de]);if(se<Q.length)for(let Re=0;Re<Q[se].length;Re+=1)k[se].push(Q[se][Re]);else k[se].push(...new Array(Q[0].length).fill(null))}else k.push(k[se%ye].slice(0,oe).concat(Q[se]));a.populateFromArray(Ne,le,k);break;case"overwrite":default:fe.row=T.row,fe.col=T.col;let ce=0,ee=0,te=!0,j;const U=function(Ie){let ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Ee=k[Ie%k.length];return ae!==null?Ee[ae%Ee.length]:Ee},K=k.length,ve=D?D.row-T.row+1:0;for(D?ye=ve:ye=Math.max(K,ve),se=0;se<ye&&!(D&&fe.row>D.row&&ve>K||!R.allowInsertRow&&fe.row>a.countRows()-1||fe.row>=R.maxRows);se++){const Re=se-ce,Ie=U(Re).length,ae=D?D.col-T.col+1:0;if(D?de=ae:de=Math.max(Ie,ae),fe.col=T.col,j=a.getCellMeta(fe.row,fe.col),(q==="CopyPaste.paste"||q==="Autofill.fill")&&j.skipRowOnPaste){ce+=1,fe.row+=1,ye+=1;continue}for(ee=0,we=0;we<de&&!(D&&fe.col>D.col&&ae>Ie||!R.allowInsertColumn&&fe.col>a.countCols()-1||fe.col>=R.maxCols);we++){if(j=a.getCellMeta(fe.row,fe.col),(q==="CopyPaste.paste"||q==="Autofill.fill")&&j.skipColumnOnPaste){ee+=1,fe.col+=1,de+=1;continue}if(j.readOnly&&q!=="UndoRedo.undo"){fe.col+=1;continue}const Ee=we-ee;let Me=U(Re,Ee),Pe=a.getDataAtCell(fe.row,fe.col);if(Me!==null&&typeof Me=="object")if(Array.isArray(Me)&&Pe===null&&(Pe=[]),Pe===null||typeof Pe!="object")te=!1;else{const De=duckSchema(Array.isArray(Pe)?Pe:Pe[0]||Pe),$e=duckSchema(Array.isArray(Me)?Me:Me[0]||Me);isObjectEqual(De,$e)||Array.isArray(De)&&Array.isArray($e)?Me=deepClone(Me):te=!1}else Pe!==null&&typeof Pe=="object"&&(te=!1);te&&be.push([fe.row,fe.col,Me]),te=!0,fe.col+=1}fe.row+=1}a.setDataAtCell(be,null,null,q||"populateFromArray");break}}};function W(T){const k=normalizeLanguageCode(T);hasLanguageDictionary(k)?(a.runHooks("beforeLanguageChange",k),A.language=k,a.runHooks("afterLanguageChange",k)):warnUserAboutLanguageRegistration(T)}function Z(T,k){const D=T==="className"?a.rootElement:a.table;if(v)addClass(D,k);else{let q=[],B=[];A[T]&&(q=Array.isArray(A[T])?A[T]:stringToArray(A[T])),k&&(B=Array.isArray(k)?k:stringToArray(k));const se=getDifferenceOfArrays(q,B),ye=getDifferenceOfArrays(B,q);se.length&&removeClass(D,se),ye.length&&addClass(D,ye)}A[T]=k}this.init=function(){h.setData(R.data),a.runHooks("beforeInit"),(isMobileBrowser()||isIpadOS())&&addClass(a.rootElement,"mobile"),this.updateSettings(R,!0),this.view=new tableView_default(this),f=editorManager_default.getInstance(a,R,V),g=createViewportScroller(a),m=new FocusManager(a),isRootInstance(this)&&installFocusCatcher(a),a.runHooks("init"),this.forceFullRender=!0,this.view.render(),v&&a.rootElement.offsetParent===null&&observeVisibilityChangeOnce(a.rootElement,()=>{a.view._wt.wtOverlays.updateLastSpreaderSize(),a.render(),a.view.adjustElementsSize()}),typeof v=="object"&&(a.runHooks("afterChange",v[0],v[1]),v=!1),a.runHooks("afterInit")};function ie(){let T=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,T=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&T===!1&&(T=!0,this.onQueueEmpty(this.valid))}}}function ue(T){const k=T.replace(",",".");return isNaN(parseFloat(k))===!1?parseFloat(k):T}function _e(T,k,D){if(!T.length){D();return}const q=a.getActiveEditor(),B=new ie;let se=!0;B.onQueueEmpty=()=>{q&&se&&q.cancelChanges(),D()};for(let ye=T.length-1;ye>=0;ye--){const[we,de,,be]=T[ye],fe=u.propToCol(de);let he;Number.isInteger(fe)?he=a.getCellMeta(we,fe):he={...Object.getPrototypeOf(R),...R},he.type==="numeric"&&typeof be=="string"&&isNumericLike(be)&&(T[ye][3]=ue(be)),a.getCellValidator(he)&&(B.addValidatorToQueue(),a.validateCell(T[ye][3],he,function(Ne,le){return function(Ve){if(typeof Ve!="boolean")throw new Error("Validation error: result is not boolean");Ve===!1&&le.allowInvalid===!1&&(se=!1,T.splice(Ne,1),le.valid=!0),B.removeValidatorFormQueue()}}(ye,he),k))}B.checkIfQueueIsEmpty()}function Te(T,k){for(let q=T.length-1;q>=0;q--){let B=!1;if(T[q]===null){T.splice(q,1);continue}if(!((T[q][2]===null||T[q][2]===void 0)&&(T[q][3]===null||T[q][3]===void 0))){if(R.allowInsertRow)for(;T[q][0]>a.countRows()-1;){const{delta:se}=u.createRow(void 0,void 0,{source:k});if(se===0){B=!0;break}}if(a.dataType==="array"&&(!R.columns||R.columns.length===0)&&R.allowInsertColumn)for(;u.propToCol(T[q][1])>a.countCols()-1;){const{delta:se}=u.createCol(void 0,void 0,{source:k});if(se===0){B=!0;break}}B||u.set(T[q][0],T[q][1],T[q][3])}}const D=T.length>0;if(a.forceFullRender=!0,D){d.adjustRowsAndCols(),a.runHooks("beforeChangeRender",T,k),f.closeEditor(),a.view.render(),f.prepareEditor(),a.view.adjustElementsSize(),a.runHooks("afterChange",T,k||"edit");const q=a.getActiveEditor();q&&isDefined(q.refreshValue)&&q.refreshValue()}else a.view.render()}this._createCellCoords=function(T,k){return a.view._wt.createCellCoords(T,k)},this._createCellRange=function(T,k,D){return a.view._wt.createCellRange(T,k,D)},this.validateCell=function(T,k,D,q){let B=a.getCellValidator(k);function se(ye){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||k.hidden===!0){D(ye);return}const de=k.visualCol,be=k.visualRow,fe=a.getCell(be,de,!0);if(fe&&fe.nodeName!=="TH"){const he=a.rowIndexMapper.getRenderableFromVisualIndex(be),Ne=a.columnIndexMapper.getRenderableFromVisualIndex(de);a.view._wt.getSetting("cellRenderer",he,Ne,fe)}D(ye)}isRegExp(B)&&(B=function(ye){return function(we,de){de(ye.test(we))}}(B)),isFunction2(B)?(T=a.runHooks("beforeValidate",T,k.visualRow,k.prop,q),a._registerImmediate(()=>{B.call(k,T,ye=>{a&&(ye=a.runHooks("afterValidate",ye,T,k.visualRow,k.prop,q),k.valid=ye,se(ye),a.runHooks("postAfterValidate",ye,T,k.visualRow,k.prop,q))})})):a._registerImmediate(()=>{k.valid=!0,se(k.valid,!1)})};function pe(T,k,D){return Array.isArray(T)?T:[[T,k,D]]}function me(T,k){const D=a.getActiveEditor(),q=a.runHooks("beforeChange",T,k||"edit"),B=T.filter(se=>se!==null);return q===!1||B.length===0?(D&&D.cancelChanges(),[]):B}this.setDataAtCell=function(T,k,D,q){const B=pe(T,k,D),se=[];let ye=q,we,de,be;for(we=0,de=B.length;we<de;we++){if(typeof B[we]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof B[we][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");B[we][1]>=this.countCols()?be=B[we][1]:be=u.colToProp(B[we][1]),se.push([B[we][0],be,h.getAtCell(this.toPhysicalRow(B[we][0]),B[we][1]),B[we][2]])}!ye&&typeof T=="object"&&(ye=k);const fe=me(se,q);a.runHooks("afterSetDataAtCell",fe,ye),_e(fe,ye,()=>{Te(fe,ye)})},this.setDataAtRowProp=function(T,k,D,q){const B=pe(T,k,D),se=[];let ye=q,we,de;for(we=0,de=B.length;we<de;we++)se.push([B[we][0],B[we][1],h.getAtCell(this.toPhysicalRow(B[we][0]),B[we][1]),B[we][2]]);!ye&&typeof T=="object"&&(ye=k);const be=me(se,q);a.runHooks("afterSetDataAtRowProp",be,ye),_e(be,ye,()=>{Te(be,ye)})},this.listen=function(){a&&!a.isListening()&&(foreignHotInstances.forEach(T=>{a!==T&&T.unlisten()}),activeGuid=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(activeGuid=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return activeGuid===a.guid},this.destroyEditor=function(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;f.closeEditor(T),a.view.render(),k&&V.isSelected()&&f.prepareEditor()},this.populateFromArray=function(T,k,D,q,B,se,ye){if(!(typeof D=="object"&&typeof D[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const we=typeof q=="number"?a._createCellCoords(q,B):null;return d.populateFromArray(a._createCellCoords(T,k),D,we,se,ye)},this.spliceCol=function(T,k,D){for(var q=arguments.length,B=new Array(q>3?q-3:0),se=3;se<q;se++)B[se-3]=arguments[se];return u.spliceCol(T,k,D,...B)},this.spliceRow=function(T,k,D){for(var q=arguments.length,B=new Array(q>3?q-3:0),se=3;se<q;se++)B[se-3]=arguments[se];return u.spliceRow(T,k,D,...B)},this.getSelected=function(){if(V.isSelected())return arrayMap(V.getSelectedRange(),T=>{let{from:k,to:D}=T;return[k.row,k.col,D.row,D.col]})},this.getSelectedLast=function(){const T=this.getSelected();let k;return T&&T.length>0&&(k=T[T.length-1]),k},this.getSelectedRange=function(){if(V.isSelected())return Array.from(V.getSelectedRange())},this.getSelectedRangeLast=function(){const T=this.getSelectedRange();let k;return T&&T.length>0&&(k=T[T.length-1]),k},this.emptySelectedCells=function(T){if(!V.isSelected()||this.countRows()===0||this.countCols()===0)return;const k=[];arrayEach(V.getSelectedRange(),D=>{if(D.isSingleHeader())return;const q=D.getTopStartCorner(),B=D.getBottomEndCorner();rangeEach(q.row,B.row,se=>{rangeEach(q.col,B.col,ye=>{this.getCellMeta(se,ye).readOnly||k.push([se,ye,null])})})}),k.length>0&&this.setDataAtCell(k,T)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const T=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(T,0),!this.isRenderSuspended()&&T===this.renderSuspendedCounter&&(this.renderCall?this.render():a.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||a.view.render())},this.batchRender=function(T){this.suspendRender();const k=T();return this.resumeRender(),k},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const k=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(k,0),(!this.isExecutionSuspended()&&k===this.executionSuspendedCounter||T)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(T){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const D=T();return this.resumeExecution(k),D},this.batch=function(T){this.suspendRender(),this.suspendExecution();const k=T();return this.resumeExecution(),this.resumeRender(),k},this.refreshDimensions=function(){if(!a.view)return;const{width:T,height:k}=a.view.getLastSize(),{width:D,height:q}=a.rootElement.getBoundingClientRect(),B=D!==T||q!==k;a.runHooks("beforeRefreshDimensions",{width:T,height:k},{width:D,height:q},B)!==!1&&((B||a.view._wt.wtOverlays.scrollableElement===a.rootWindow)&&(a.view.setLastSize(D,q),a.render()),a.runHooks("afterRefreshDimensions",{width:T,height:k},{width:D,height:q},B))},this.updateData=function(T,k){replaceData(T,D=>{u=D},D=>{u=D,a.columnIndexMapper.fitToLength(this.getInitialColumnCount()),a.rowIndexMapper.fitToLength(this.countSourceRows()),d.adjustRowsAndCols(),V.refresh()},{hotInstance:a,dataMap:u,dataSource:h,internalSource:"updateData",source:k,metaManager:S,firstRun:v})},this.loadData=function(T,k){replaceData(T,D=>{u=D},()=>{S.clearCellsCache(),a.initIndexMappers(),d.adjustRowsAndCols(),V.refresh(),v&&(v=[null,"loadData"])},{hotInstance:a,dataMap:u,dataSource:h,internalSource:"loadData",source:k,metaManager:S,firstRun:v})},this.getInitialColumnCount=function(){const T=R.columns;let k=0;if(Array.isArray(T))k=T.length;else if(isFunction2(T))if(a.dataType==="array"){const D=this.countSourceCols();for(let q=0;q<D;q+=1)T(q)&&(k+=1)}else(a.dataType==="object"||a.dataType==="function")&&(k=u.colToPropCache.length);else if(isDefined(R.dataSchema)){const D=u.getSchema();k=Array.isArray(D)?D.length:deepObjectSize(D)}else k=this.countSourceCols();return k},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(T,k,D,q){return isUndefined(T)?u.getAll():u.getRange(a._createCellCoords(T,k),a._createCellCoords(D,q),u.DESTINATION_RENDERER)},this.getCopyableText=function(T,k,D,q){return u.getCopyableText(a._createCellCoords(T,k),a._createCellCoords(D,q))},this.getCopyableData=function(T,k){return u.getCopyable(T,u.colToProp(k))},this.getSchema=function(){return u.getSchema()},this.updateSettings=function(T){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const D=(v?a.loadData:a.updateData).bind(this);let q=!1,B,se;if(isDefined(T.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(isDefined(T.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(isDefined(T.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(B in T)B==="data"||(B==="language"?W(T.language):B==="className"?Z("className",T.className):B==="tableClassName"&&a.table?(Z("tableClassName",T.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames()):pluginHooks_default.getSingleton().isRegistered(B)||pluginHooks_default.getSingleton().isDeprecated(B)?(isFunction2(T[B])||Array.isArray(T[B]))&&(T[B].initialHook=!0,a.addHook(B,T[B])):!k&&hasOwnProperty(T,B)&&(A[B]=T[B]));T.data===void 0&&R.data===void 0?D(null,"updateSettings"):T.data!==void 0?D(T.data,"updateSettings"):T.columns!==void 0&&(u.createMap(),a.initIndexMappers());const ye=a.countCols(),we=R.columns;if(we&&isFunction2(we)&&(q=!0),(T.cell!==void 0||T.cells!==void 0||T.columns!==void 0)&&S.clearCache(),ye>0)for(B=0,se=0;B<ye;B++){if(we){const fe=q?we(B):we[se];fe&&S.updateColumnMeta(se,fe)}se+=1}isDefined(T.cell)&&objectEach(T.cell,fe=>{a.setCellMetaObject(fe.row,fe.col,fe)}),a.runHooks("afterCellMetaReset");let de=a.rootElement.style.height;de!==""&&(de=parseInt(a.rootElement.style.height,10));let be=T.height;if(isFunction2(be)&&(be=be()),k&&a.rootElement.getAttribute("style")&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style")),be===null){const fe=a.rootElement.getAttribute("data-initialstyle");fe&&(fe.indexOf("height")>-1||fe.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",fe):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else be!==void 0&&(a.rootElement.style.height=isNaN(be)?`${be}`:`${be}px`,a.rootElement.style.overflow="hidden");if(typeof T.width<"u"){let fe=T.width;isFunction2(fe)&&(fe=fe()),a.rootElement.style.width=isNaN(fe)?`${fe}`:`${fe}px`}k||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",T)),d.adjustRowsAndCols(),a.view&&!v&&(a.forceFullRender=!0,a.view.render(),a.view._wt.wtOverlays.adjustElementsSize()),!k&&a.view&&(de===""||be===""||be===void 0)&&de!==be&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const T=a.getSelectedLast();if(R.getValue){if(isFunction2(R.getValue))return R.getValue.call(a);if(T)return a.getData()[T[0][0]][R.getValue]}else if(T)return a.getDataAtCell(T[0],T[1])},this.getSettings=function(){return R},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(T,k,D,q,B){d.alter(T,k,D,q,B)},this.getCell=function(T,k){let D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,q=k,B=T;if(k>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(k)))return null;q=this.columnIndexMapper.getRenderableFromVisualIndex(k)}if(T>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(T)))return null;B=this.rowIndexMapper.getRenderableFromVisualIndex(T)}return B===null||q===null||B===void 0||q===void 0?null:a.view.getCellAtCoords(a._createCellCoords(B,q),D)},this.getCoords=function(T){const k=this.view._wt.wtTable.getCoords(T);if(k===null)return null;const{row:D,col:q}=k;let B=D,se=q;return D>=0&&(B=this.rowIndexMapper.getVisualFromRenderableIndex(D)),q>=0&&(se=this.columnIndexMapper.getVisualFromRenderableIndex(q)),a._createCellCoords(B,se)},this.colToProp=function(T){return u.colToProp(T)},this.propToCol=function(T){return u.propToCol(T)},this.toVisualRow=T=>this.rowIndexMapper.getVisualFromPhysicalIndex(T),this.toVisualColumn=T=>this.columnIndexMapper.getVisualFromPhysicalIndex(T),this.toPhysicalRow=T=>this.rowIndexMapper.getPhysicalFromVisualIndex(T),this.toPhysicalColumn=T=>this.columnIndexMapper.getPhysicalFromVisualIndex(T),this.getDataAtCell=function(T,k){return u.get(T,u.colToProp(k))},this.getDataAtRowProp=function(T,k){return u.get(T,k)},this.getDataAtCol=function(T){const k=[],D=u.getRange(a._createCellCoords(0,T),a._createCellCoords(R.data.length-1,T),u.DESTINATION_RENDERER);for(let q=0;q<D.length;q+=1)for(let B=0;B<D[q].length;B+=1)k.push(D[q][B]);return k},this.getDataAtProp=function(T){const k=[],D=u.getRange(a._createCellCoords(0,u.propToCol(T)),a._createCellCoords(R.data.length-1,u.propToCol(T)),u.DESTINATION_RENDERER);for(let q=0;q<D.length;q+=1)for(let B=0;B<D[q].length;B+=1)k.push(D[q][B]);return k},this.getSourceData=function(T,k,D,q){let B;return T===void 0?B=h.getData():B=h.getByRange(a._createCellCoords(T,k),a._createCellCoords(D,q)),B},this.getSourceDataArray=function(T,k,D,q){let B;return T===void 0?B=h.getData(!0):B=h.getByRange(a._createCellCoords(T,k),a._createCellCoords(D,q),!0),B},this.getSourceDataAtCol=function(T){return h.getAtColumn(T)},this.setSourceDataAtCell=function(T,k,D,q){const B=pe(T,k,D),se=this.hasHook("afterSetSourceDataAtCell"),ye=[];se&&arrayEach(B,de=>{let[be,fe,he]=de;ye.push([be,fe,h.getAtCell(be,fe),he])}),arrayEach(B,de=>{let[be,fe,he]=de;h.setAtCell(be,fe,he)}),se&&this.runHooks("afterSetSourceDataAtCell",ye,q),this.render();const we=a.getActiveEditor();we&&isDefined(we.refreshValue)&&we.refreshValue()},this.getSourceDataAtRow=function(T){return h.getAtRow(T)},this.getSourceDataAtCell=function(T,k){return h.getAtCell(T,k)},this.getDataAtRow=function(T){return u.getRange(a._createCellCoords(T,0),a._createCellCoords(T,this.countCols()-1),u.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(T,k,D,q){const B=T===void 0?[0,0,this.countRows(),this.countCols()]:[T,k,D,q],[se,ye]=B;let[,,we,de]=B,be=null,fe=null;we===void 0&&(we=se),de===void 0&&(de=ye);let he="mixed";return rangeEach(Math.max(Math.min(se,we),0),Math.max(se,we),Ne=>{let le=!0;return rangeEach(Math.max(Math.min(ye,de),0),Math.max(ye,de),Ve=>(fe=this.getCellMeta(Ne,Ve).type,be?le=be===fe:be=fe,le)),he=le?fe:"mixed",le}),he},this.removeCellMeta=function(T,k,D){const[q,B]=[this.toPhysicalRow(T),this.toPhysicalColumn(k)];let se=S.getCellMetaKeyValue(q,B,D);a.runHooks("beforeRemoveCellMeta",T,k,D,se)!==!1&&(S.removeCellMeta(q,B,D),a.runHooks("afterRemoveCellMeta",T,k,D,se)),se=null},this.spliceCellsMeta=function(T){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var D=arguments.length,q=new Array(D>2?D-2:0),B=2;B<D;B++)q[B-2]=arguments[B];if(q.length>0&&!Array.isArray(q[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");k>0&&S.removeRow(this.toPhysicalRow(T),k),q.length>0&&arrayEach(q.reverse(),se=>{S.createRow(this.toPhysicalRow(T)),arrayEach(se,(ye,we)=>this.setCellMetaObject(T,we,ye))}),a.render()},this.setCellMetaObject=function(T,k,D){typeof D=="object"&&objectEach(D,(q,B)=>{this.setCellMeta(T,k,B,q)})},this.setCellMeta=function(T,k,D,q){if(a.runHooks("beforeSetCellMeta",T,k,D,q)===!1)return;let se=T,ye=k;T<this.countRows()&&(se=this.toPhysicalRow(T)),k<this.countCols()&&(ye=this.toPhysicalColumn(k)),S.setCellMeta(se,ye,D,q),a.runHooks("afterSetCellMeta",T,k,D,q)},this.getCellsMeta=function(){return S.getCellsMeta()},this.getCellMeta=function(T,k){let D=this.toPhysicalRow(T),q=this.toPhysicalColumn(k);return D===null&&(D=T),q===null&&(q=k),S.getCellMeta(D,q,{visualRow:T,visualColumn:k})},this.getColumnMeta=function(T){return S.getColumnMeta(this.toPhysicalColumn(T))},this.getCellMetaAtRow=function(T){return S.getCellsMetaAtRow(T)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||R.columns)},this.getCellRenderer=function(T,k){const D=typeof T=="number"?a.getCellMeta(T,k).renderer:T.renderer;return typeof D=="string"?_getItem2(D):isUndefined(D)?_getItem2("text"):D},this.getCellEditor=function(T,k){const D=typeof T=="number"?a.getCellMeta(T,k).editor:T.editor;return typeof D=="string"?_getItem(D):isUndefined(D)?_getItem("text"):D},this.getCellValidator=function(T,k){const D=typeof T=="number"?a.getCellMeta(T,k).validator:T.validator;return typeof D=="string"?_getItem3(D):D},this.validateCells=function(T){this._validateCells(T)},this.validateRows=function(T,k){if(!Array.isArray(T))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(k,T)},this.validateColumns=function(T,k){if(!Array.isArray(T))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(k,void 0,T)},this._validateCells=function(T,k,D){const q=new ie;T&&(q.onQueueEmpty=T);let B=a.countRows()-1;for(;B>=0;){if(k!==void 0&&k.indexOf(B)===-1){B-=1;continue}let se=a.countCols()-1;for(;se>=0;){if(D!==void 0&&D.indexOf(se)===-1){se-=1;continue}q.addValidatorToQueue(),a.validateCell(a.getDataAtCell(B,se),a.getCellMeta(B,se),ye=>{if(typeof ye!="boolean")throw new Error("Validation error: result is not boolean");ye===!1&&(q.valid=!1),q.removeValidatorFormQueue()},"validateCells"),se-=1}B-=1}q.checkIfQueueIsEmpty()},this.getRowHeader=function(T){let k=R.rowHeaders,D=T;return D!==void 0&&(D=a.runHooks("modifyRowHeader",D)),D===void 0?(k=[],rangeEach(a.countRows()-1,q=>{k.push(a.getRowHeader(q))})):Array.isArray(k)&&k[D]!==void 0?k=k[D]:isFunction2(k)?k=k(D):k&&typeof k!="string"&&typeof k!="number"&&(k=D+1),k},this.hasRowHeaders=function(){return!!R.rowHeaders},this.hasColHeaders=function(){if(R.colHeaders!==void 0&&R.colHeaders!==null)return!!R.colHeaders;for(let T=0,k=a.countCols();T<k;T++)if(a.getColHeader(T))return!0;return!1},this.getColHeader=function(T){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const D=a.runHooks("modifyColHeader",T);if(D===void 0){const we=[],de=a.countCols();for(let be=0;be<de;be++)we.push(a.getColHeader(be));return we}let q=R.colHeaders;const B=function(we){const de=[],be=a.countCols();let fe=0;for(;fe<be;fe++)isFunction2(R.columns)&&R.columns(fe)&&de.push(fe);return de[we]},se=a.toPhysicalColumn(D),ye=B(se);return R.colHeaders===!1?q=null:R.columns&&isFunction2(R.columns)&&R.columns(ye)&&R.columns(ye).title?q=R.columns(ye).title:R.columns&&R.columns[se]&&R.columns[se].title?q=R.columns[se].title:Array.isArray(R.colHeaders)&&R.colHeaders[se]!==void 0?q=R.colHeaders[se]:isFunction2(R.colHeaders)?q=R.colHeaders(se):R.colHeaders&&typeof R.colHeaders!="string"&&typeof R.colHeaders!="number"&&(q=spreadsheetColumnLabel(D)),q=a.runHooks("modifyColumnHeaderValue",q,T,k),q},this._getColWidthFromSettings=function(T){let k;if(T>=0&&(k=a.getCellMeta(0,T).width),(k===void 0||k===R.width)&&(k=R.colWidths),k!=null){switch(typeof k){case"object":k=k[T];break;case"function":k=k(T);break;default:break}typeof k=="string"&&(k=parseInt(k,10))}return k},this.getColWidth=function(T){let k=a._getColWidthFromSettings(T);return k=a.runHooks("modifyColWidth",k,T),k===void 0&&(k=DEFAULT_WIDTH),k},this._getRowHeightFromSettings=function(T){let k=R.rowHeights;if(k!=null){switch(typeof k){case"object":k=k[T];break;case"function":k=k(T);break;default:break}typeof k=="string"&&(k=parseInt(k,10))}return k},this.getRowHeight=function(T){let k=a._getRowHeightFromSettings(T);return k=a.runHooks("modifyRowHeight",k,T),k},this.countSourceRows=function(){return h.countRows()},this.countSourceCols=function(){return h.countFirstRowKeys()},this.countRows=function(){return u.getLength()},this.countCols=function(){const T=R.maxCols,k=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(T,k)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,k=0;return rangeEachReverse(a.countRows()-1,D=>{if(a.isEmptyRow(D))k+=1;else if(T===!0)return!1}),k},this.countEmptyCols=function(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,k=0;return rangeEachReverse(a.countCols()-1,D=>{if(a.isEmptyCol(D))k+=1;else if(T===!0)return!1}),k},this.isEmptyRow=function(T){return R.isEmptyRow.call(a,T)},this.isEmptyCol=function(T){return R.isEmptyCol.call(a,T)},this.selectCell=function(T,k,D,q){let B=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,se=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return isUndefined(T)||isUndefined(k)?!1:this.selectCells([[T,k,D,q]],B,se)},this.selectCells=function(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;k===!1&&g.suspend();const q=V.selectCells(T);return q&&D&&a.listen(),g.resume(),q},this.selectColumns=function(T){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:T,D=arguments.length>2?arguments[2]:void 0;return V.selectColumns(T,k,D)},this.selectRows=function(T){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:T,D=arguments.length>2?arguments[2]:void 0;return V.selectRows(T,k,D)},this.deselectCell=function(){V.deselect()},this.selectAll=function(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:T,D=arguments.length>2?arguments[2]:void 0;g.skipNextScrollCycle(),V.selectAll(T,k,D)};const Se=(T,k)=>T.getNearestNotHiddenIndex(k,1,!0);this.scrollViewportTo=function(T){var k;if(typeof T=="number"){var D;T={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(D=arguments[4])!==null&&D!==void 0?D:!0}}const{row:q,col:B,verticalSnap:se,horizontalSnap:ye,considerHiddenIndexes:we}=(k=T)!==null&&k!==void 0?k:{};let de,be,fe,he;se!==void 0&&(de=se==="top",be=!de),ye!==void 0&&(fe=ye==="start",he=!fe);let Ne=q,le=B;if(we===void 0||we){const Ue=Number.isInteger(q)&&q>=0,je=Number.isInteger(B)&&B>=0,We=Ue?Se(this.rowIndexMapper,q):void 0,H=je?Se(this.columnIndexMapper,B):void 0;if(We===null||H===null)return!1;Ne=Ue?a.rowIndexMapper.getRenderableFromVisualIndex(We):q,le=je?a.columnIndexMapper.getRenderableFromVisualIndex(H):B}const Ve=Number.isInteger(Ne),Be=Number.isInteger(le);return Ve&&Ne>=0&&Be&&le>=0?a.view.scrollViewport(a._createCellCoords(Ne,le),de,he,be,fe):Ve&&Ne>=0&&(Be&&le<0||!Be)?a.view.scrollViewportVertically(Ne,de,be):Be&&le>=0&&(Ve&&Ne<0||!Ve)?a.view.scrollViewportHorizontally(le,he,fe):!1},this.scrollToFocusedCell=function(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",T);const{highlight:k}=this.getSelectedRangeLast();this.scrollViewportTo(k.toObject())?this.view.render():(this.removeHook("afterScroll",T),this._registerImmediate(()=>T()))},this.destroy=function(){if(a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),h&&h.destroy(),h=null,this.getShortcutManager().destroy(),S.clearCache(),foreignHotInstances.delete(this.guid),isRootInstance(a)){const T=this.rootDocument.querySelector(".hot-display-license-info");T&&T.parentNode.removeChild(T)}empty2(a.rootElement),c.destroy(),f&&f.destroy(),a.batchExecution(()=>{a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),I.getItems().forEach(T=>{let[,k]=T;k.destroy()}),I.clear(),a.runHooks("afterDestroy")},!0),pluginHooks_default.getSingleton().destroy(a),objectEach(a,(T,k,D)=>{isFunction2(T)?D[k]=Le(k):k!=="guid"&&(D[k]=null)}),a.isDestroyed=!0,u&&u.destroy(),u=null,d=null,V=null,f=null,a=null};function Le(T){return()=>{throw new Error(`The "${T}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return f.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return a.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return a.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return a.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return a.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return a.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return a.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return a.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return a.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return a.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return a.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return a.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return a.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(T){const k=toUpperCaseFirst(T);return k==="UndoRedo"?this.undoRedo:I.getItem(k)},this.getPluginName=function(T){return T===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:I.getId(T)},this.getInstance=function(){return a},this.addHook=function(T,k,D){pluginHooks_default.getSingleton().add(T,k,a,D)},this.hasHook=function(T){return pluginHooks_default.getSingleton().has(T,a)||pluginHooks_default.getSingleton().has(T)},this.addHookOnce=function(T,k,D){pluginHooks_default.getSingleton().once(T,k,a,D)},this.removeHook=function(T,k){pluginHooks_default.getSingleton().remove(T,k,a)},this.runHooks=function(T,k,D,q,B,se,ye){return pluginHooks_default.getSingleton().run(a,T,k,D,q,B,se,ye)},this.getTranslatedPhrase=function(T,k){return getTranslatedPhrase(R.language,T,k)},this.toHTML=()=>instanceToHTML(this),this.toTableElement=()=>{const T=this.rootDocument.createElement("div");return T.insertAdjacentHTML("afterbegin",instanceToHTML(this)),T.firstElementChild},this.timeouts=[],this._registerTimeout=function(T){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,D=T;typeof D=="function"&&(D=setTimeout(D,k)),this.timeouts.push(D)},this._clearTimeouts=function(){arrayEach(this.timeouts,T=>{clearTimeout(T)})},this.immediates=[],this._registerImmediate=function(T){this.immediates.push(setImmediate(T))},this._clearImmediates=function(){arrayEach(this.immediates,T=>{clearImmediate(T)})},this._getEditorManager=function(){return f},this.isRtl=function(){return a.rootWindow.getComputedStyle(a.rootElement).direction==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1};const xe=createShortcutManager({handleEvent(){return a.isListening()},beforeKeyDown:T=>this.runHooks("beforeKeyDown",T),afterKeyDown:T=>{this.isDestroyed||a.runHooks("afterDocumentKeyDown",T)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",T=>{T.ctrlKey===!1&&T.metaKey===!1&&xe.releasePressedKeys()}),this.getShortcutManager=function(){return xe},this.getFocusManager=function(){return m},getPluginsNames().forEach(T=>{const k=getPlugin(T);I.addItem(T,new k(this))}),registerAllShortcutContexts(a),xe.setActiveContextName("grid"),pluginHooks_default.getSingleton().run(a,"construct")}var import_es_error_cause86=__toESM(require_es_error_cause(),1);function observe(e,t,r){e.addEventListener(t,r,!1)}function unObserve(e,t,r){e.removeEventListener(t,r,!1)}function getComputedStyle4(e){return e.ownerDocument.defaultView.getComputedStyle(e)}function createInputElementResizer(e){const t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},r=e.body,i=e.createTextNode(""),o=e.createElement("span");let a;function c(){i.textContent=a.value,o.style.position="absolute",o.style.fontSize=getComputedStyle4(a).fontSize,o.style.fontFamily=getComputedStyle4(a).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);const f=o.clientWidth+2;r.removeChild(o);const m=a.style;m.height=`${t.minHeight}px`,t.minWidth>f?m.width=`${t.minWidth}px`:f>t.maxWidth?m.width=`${t.maxWidth}px`:m.width=`${f}px`;const g=a.scrollHeight?a.scrollHeight-1:0;t.minHeight>g?m.height=`${t.minHeight}px`:t.maxHeight<g?(m.height=`${t.maxHeight}px`,m.overflowY="visible"):m.height=`${g}px`}function u(){e.defaultView.setTimeout(c,0)}function h(f){if(f&&f.minHeight)if(f.minHeight==="inherit")t.minHeight=a.clientHeight;else{const m=parseInt(f.minHeight,10);isNaN(m)||(t.minHeight=m)}if(f&&f.maxHeight)if(f.maxHeight==="inherit")t.maxHeight=a.clientHeight;else{const m=parseInt(f.maxHeight,10);isNaN(m)||(t.maxHeight=m)}if(f&&f.minWidth)if(f.minWidth==="inherit")t.minWidth=a.clientWidth;else{const m=parseInt(f.minWidth,10);isNaN(m)||(t.minWidth=m)}if(f&&f.maxWidth)if(f.maxWidth==="inherit")t.maxWidth=a.clientWidth;else{const m=parseInt(f.maxWidth,10);isNaN(m)||(t.maxWidth=m)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function d(f,m){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;a=f,h(m),a.nodeName==="TEXTAREA"&&(a.style.resize="none",a.style.height=`${t.minHeight}px`,a.style.minWidth=`${t.minWidth}px`,a.style.maxWidth=`${t.maxWidth}px`,a.style.overflowY="hidden"),g&&(observe(a,"input",c),observe(a,"keydown",u)),c()}return{init:d,resize:c,unObserve(){unObserve(a,"input",c),unObserve(a,"keydown",u)}}}function updateCaretPosition(e,t){const r=getCaretPosition(t),i=t.value.split(`
`);let o=r,a=0;for(let c=0;c<i.length;c++){const u=i[c];c!==0&&(a+=i[c-1].length+1);const h=a+u.length;if(e==="home"?o=a:e==="end"&&(o=h),r<=h)break}setCaretPosition(t,o)}function _defineProperty59(e,t,r){return(t=_toPropertyKey59(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey59(e){var t=_toPrimitive59(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive59(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EDITOR_VISIBLE_CLASS_NAME="ht_editor_visible",EDITOR_HIDDEN_CLASS_NAME="ht_editor_hidden",SHORTCUTS_GROUP="textEditor",EDITOR_TYPE2="text",TextEditor=class extends BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE2}constructor(e){super(e),_defineProperty59(this,"eventManager",new eventManager_default(this)),_defineProperty59(this,"autoResize",createInputElementResizer(this.hot.rootDocument)),_defineProperty59(this,"TEXTAREA",void 0),_defineProperty59(this,"textareaStyle",void 0),_defineProperty59(this,"TEXTAREA_PARENT",void 0),_defineProperty59(this,"textareaParentStyle",void 0),_defineProperty59(this,"layerClass",void 0),this.eventManager=new eventManager_default(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),isThisHotChild(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,r,i,o,a){const c=this.state;if(super.prepare(e,t,r,i,o,a),!a.readOnly){this.refreshDimensions(!0);const{allowInvalid:u}=a;u&&!this.isOpened()&&(this.TEXTAREA.value=""),c!==EDITOR_STATE.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,t){this.state===EDITOR_STATE.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),setAttribute(this.TEXTAREA,[["data-hot-input",""],A11Y_TABINDEX(-1)]),addClass(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),addClass(this.TEXTAREA_PARENT,"handsontableInputHolder"),hasClass(this.TEXTAREA_PARENT,this.layerClass)&&removeClass(this.TEXTAREA_PARENT,this.layerClass),addClass(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){isEdge()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",removeClass(this.TEXTAREA_PARENT,this.layerClass),addClass(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;rangeEach(e.length-1,r=>{const i=e[r];if(hasClass(i,"handsontableEditor"))return t=!0,!1}),hasClass(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME)&&removeClass(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME),t?(this.layerClass=EDITOR_VISIBLE_CLASS_NAME,addClass(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),addClass(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==EDITOR_STATE.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:t,start:r,width:i,maxWidth:o,height:a,maxHeight:c}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const u=getComputedStyle3(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=u.fontSize,this.TEXTAREA.style.fontFamily=u.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const h=getComputedStyle3(this.TEXTAREA),d=parseInt(h.paddingLeft,10)+parseInt(h.paddingRight,10),f=parseInt(h.paddingTop,10)+parseInt(h.paddingBottom,10),m=i-d,g=a-f,v=o-d,_=c-f;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(m,v),minHeight:Math.min(g,_),maxWidth:v,maxHeight:_},!0)}bindEvents(){isIOS()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===EDITOR_STATE.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===EDITOR_STATE.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>isDefined(this.hot.getSelected()),group:SHORTCUTS_GROUP},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};t.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,a)=>{let[c]=a;updateCaretPosition(c,this.TEXTAREA)}},{keys:[["End"]],callback:(o,a)=>{let[c]=a;updateCaretPosition(c,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP)}},import_es_array_push40=__toESM(require_es_array_push(),1),RENDERER_TYPE="base";function baseRenderer(e,t,r,i,o,a,c){const u=c.ariaTags,h=[],d=[],f=[],m=[];c.className&&addClass(t,c.className),c.readOnly?(h.push(c.readOnlyCellClassName),u&&m.push(A11Y_READONLY())):u&&f.push(A11Y_READONLY()[0]),c.valid===!1&&c.invalidCellClassName?(h.push(c.invalidCellClassName),u&&m.push(A11Y_INVALID())):(d.push(c.invalidCellClassName),u&&f.push(A11Y_INVALID()[0])),c.wordWrap===!1&&c.noWordWrapClassName&&h.push(c.noWordWrapClassName),!a&&c.placeholder&&h.push(c.placeholderCellClassName),removeClass(t,d),addClass(t,h),removeAttribute(t,f),setAttribute(t,m)}baseRenderer.RENDERER_TYPE=RENDERER_TYPE;var RENDERER_TYPE2="text";function textRenderer(e,t,r,i,o,a,c){baseRenderer.apply(this,[e,t,r,i,o,a,c]);let u=a;if(!u&&c.placeholder&&(u=c.placeholder),u=stringify(u),c.trimWhitespace&&(u=u.trim()),c.rendererTemplate){empty2(t);const h=e.rootDocument.createElement("TEMPLATE");h.setAttribute("bind","{{}}"),h.innerHTML=c.rendererTemplate,HTMLTemplateElement.decorate(h),h.model=e.getSourceDataAtRow(r),t.appendChild(h)}else fastInnerText(t,u)}textRenderer.RENDERER_TYPE=RENDERER_TYPE2;var CELL_TYPE="text",TextCellType={CELL_TYPE,editor:TextEditor,renderer:textRenderer};_register4(TextCellType),Handsontable.editors={BaseEditor};function Handsontable(e,t){const r=new Core(e,t||{},rootInstanceSymbol);return r.init(),r}Handsontable.Core=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Core(e,t,rootInstanceSymbol)},Handsontable.DefaultSettings=metaSchema_default(),Handsontable.hooks=pluginHooks_default.getSingleton(),Handsontable.CellCoords=coords_default,Handsontable.CellRange=range_default,Handsontable.packageName="handsontable",Handsontable.buildDate="17/10/2024 09:16:16",Handsontable.version="14.6.1",Handsontable.languages={dictionaryKeys,getLanguageDictionary,getLanguagesDictionaries,registerLanguageDictionary,getTranslatedPhrase};var base_default=Handsontable,import_es_error_cause87=__toESM(require_es_error_cause(),1),import_es_array_push41=__toESM(require_es_array_push(),1),SHORTCUTS_GROUP2="handsontableEditor",EDITOR_TYPE3="handsontable",HandsontableEditor=class extends TextEditor{static get EDITOR_TYPE(){return EDITOR_TYPE3}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,r,i,o,a){super.prepare(e,t,r,i,o,a);const c=this,u={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(h,d){const f=this.getSourceData(d.row,d.col);f!==void 0&&c.setValue(f),c.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&extend2(u,a.handsontable),this.htOptions=u}beginEditing(e,t){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,t,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:SHORTCUTS_GROUP2,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"},i=(o,a)=>{const c=this.htEditor;if(o!==void 0&&(o<0||c.flipped&&o>c.countRows()-1?c.deselectCell():c.selectCell(o,0),c.getData().length))return a.preventDefault(),stopImmediatePropagation(a),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const a=this.htEditor;let c,u;return!a.getSelectedLast()&&a.flipped?c=a.countRows()-1:a.getSelectedLast()&&(a.flipped?(u=a.getSelectedLast()[0],c=Math.max(0,u-1)):(u=a.getSelectedLast()[0],c=u-1)),i(c,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const a=this.htEditor;let c,u;if(!a.getSelectedLast()&&!a.flipped)c=0;else if(a.getSelectedLast()){if(a.flipped)c=a.getSelectedLast()[0]+1;else if(!a.flipped){const h=a.countRows()-1;u=a.getSelectedLast()[0],c=Math.min(h,u+1)}}return i(c,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP2)}};function _classPrivateFieldInitSpec15(e,t,r){_checkPrivateRedeclaration18(e,t),t.set(e,r)}function _checkPrivateRedeclaration18(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty60(e,t,r){return(t=_toPropertyKey60(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey60(e){var t=_toPrimitive60(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive60(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet15(e,t){return e.get(_assertClassBrand18(e,t))}function _assertClassBrand18(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var EDITOR_TYPE4="autocomplete",_idPrefix=new WeakMap,AutocompleteEditor=class extends HandsontableEditor{constructor(){super(...arguments),_defineProperty60(this,"query",null),_defineProperty60(this,"strippedChoices",[]),_defineProperty60(this,"rawChoices",[]),_classPrivateFieldInitSpec15(this,_idPrefix,this.hot.guid.slice(0,9)),_defineProperty60(this,"sortByRelevance",function(e,t,r){const i=[],o=[],a=e.length;let c=t.length,u,h,d,f;if(a===0){for(d=0;d<c;d++)o.push(d);return o}for(d=0;d<c;d++){if(h=stripTags(stringify(t[d])),r)f=h.indexOf(e);else{const m=this.cellProperties.locale;f=h.toLocaleLowerCase(m).indexOf(e.toLocaleLowerCase(m))}f!==-1&&(u=h.length-f-a,i.push({baseIndex:d,index:f,charsLeft:u,value:h}))}for(i.sort((m,g)=>{if(g.index===-1)return-1;if(m.index===-1)return 1;if(m.index<g.index)return-1;if(g.index<m.index)return 1;if(m.index===g.index){if(m.charsLeft<g.charsLeft)return-1;if(m.charsLeft>g.charsLeft)return 1}return 0}),d=0,c=i.length;d<c;d++)o.push(i[d].baseIndex);return o})}static get EDITOR_TYPE(){return EDITOR_TYPE4}getValue(){const e=this.rawChoices.find(t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value);return isDefined(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),addClass(this.htContainer,"autocompleteEditor"),addClass(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&setAttribute(this.TEXTAREA,[A11Y_TEXT(),A11Y_COMBOBOX(),A11Y_HASPOPUP("listbox"),A11Y_AUTOCOMPLETE()])}prepare(e,t,r,i,o,a){super.prepare(e,t,r,i,o,a),this.hot.getSettings().ariaTags&&setAttribute(this.TEXTAREA,[A11Y_EXPANDED("false"),A11Y_CONTROLS(`${_classPrivateFieldGet15(_idPrefix,this)}-listbox-${e}-${t}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,t=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r?.length,{row:o,col:a}=this;this.showEditableElement(),this.focus();let c=getScrollbarWidth();c===0&&isMacOS()&&(c+=15),this.addHook("beforeKeyDown",u=>this.onBeforeKeyDown(u)),this.htEditor.updateSettings({colWidths:e?[outerWidth(this.TEXTAREA)-2]:void 0,width:e?outerWidth(this.TEXTAREA)+c:void 0,autoColumnSize:!0,renderer:(u,h,d,f,m,g,v)=>{textRenderer(u,h,d,f,m,g,v);const{filteringCaseSensitive:_,allowHtml:b,locale:S}=this.cellProperties,R=this.query;let A=stringify(g),I,E;A&&!b&&(I=_===!0?A.indexOf(R):A.toLocaleLowerCase(S).indexOf(R.toLocaleLowerCase(S)),I!==-1&&(E=A.substr(I,R.length),A=A.replace(E,`<strong>${E}</strong>`))),t&&setAttribute(h,[A11Y_OPTION(),...r?[A11Y_SETSIZE(i)]:[],...r?[A11Y_POSINSET(r.indexOf(g)+1)]:[],["id",`${this.htEditor.rootElement.id}_${d}-${f}`]]),h.innerHTML=A},afterSelectionEnd:(u,h)=>{if(t){const d=this.htEditor.getCell(u,h,!0);setAttribute(d,[A11Y_SELECTED()]),setAttribute(this.TEXTAREA,...A11Y_ACTIVEDESCENDANT(d.id))}}}),t&&(setAttribute(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...A11Y_PRESENTATION()),setAttribute(this.htEditor.rootElement,[A11Y_LISTBOX(),A11Y_LIVE("polite"),A11Y_RELEVANT("text"),["id",`${_classPrivateFieldGet15(_idPrefix,this)}-listbox-${o}-${a}`]]),setAttribute(this.TEXTAREA,...A11Y_EXPANDED("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&setAttribute(this.TEXTAREA,[A11Y_EXPANDED("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,typeof t=="function"?t.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=getCaretPosition(this.TEXTAREA),r=getSelectionEndPosition(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let a=null,c=null,u=e;i&&(a=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),u,this.cellProperties.filteringCaseSensitive));const h=Array.isArray(a)?a.length:0;if(o===!1)h&&(c=a[0]);else{const d=[];for(let f=0,m=u.length;f<m&&!(i&&h<=f);f++)h?d.push(u[a[f]]):d.push(u[f]);c=0,u=d}this.strippedChoices=u,u.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(pivot([u])),u.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(c)),this.hot.listen(),setCaretPosition(this.TEXTAREA,t,t===r?void 0:r)}flipDropdownIfNeeded(){const e=getTrimmingContainer(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(t||!t&&(r||r==="horizontal"))return!1;const i=offset(this.TEXTAREA),o=outerHeight(this.TEXTAREA),a=this.getDropdownHeight(),c=e.scrollTop,u=outerHeight(this.hot.view._wt.wtTable.THEAD),h=offset(e),d=i.top-h.top-u+c,f=e.scrollHeight-d-u-o,m=a>f&&d>f;return m?this.flipDropdown(a):this.unflipDropdown(),this.limitDropdownIfNeeded(m?d:f,a),m}limitDropdownIfNeeded(e,t){if(t>e){let r=0,i=0,o=0,a=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=o,i+=1;while(r<e);a=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+t-a}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){const e=this.htEditor.getColWidth(0)+getScrollbarWidth(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,r=arrayMap(e,o=>stringify(o));return arrayMap(r,o=>t?o:stripTags(o))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),r={row:t?t.from.row:-1};let i=!1;return e===KEY_CODES.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===KEY_CODES.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(isPrintableChar(e.keyCode)||e.keyCode===KEY_CODES.BACKSPACE||e.keyCode===KEY_CODES.DELETE||e.keyCode===KEY_CODES.INSERT){let t=10;if(e.keyCode===KEY_CODES.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(t+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},t)}}},EDITOR_TYPE5="checkbox",CheckboxEditor=class extends BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE5}beginEditing(e,t){if(t&&t.type==="mouseup"&&t.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');hasClass(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}},import_es_error_cause88=__toESM(require_es_error_cause(),1),import_moment2=__toESM(require_moment(),1),getWindow=()=>window,getDocument=()=>window.document,sto=(e,t)=>window.setTimeout(e,t),addEvent2=function(e,t,r,i){e.addEventListener(t,r,!!i)},removeEvent2=function(e,t,r,i){e.removeEventListener(t,r,!!i)},trim=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},hasClass2=function(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")!==-1},addClass2=function(e,t){hasClass2(e,t)||(e.className=e.className===""?t:e.className+" "+t)},removeClass2=function(e,t){e.className=trim((" "+e.className+" ").replace(" "+t+" "," "))},isArray2=function(e){return/Array/.test(Object.prototype.toString.call(e))},isDate=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},isWeekend=function(e){let t=e.getDay();return t===0||t===6},isLeapYear=function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth=function(e,t){return[31,isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},setToStartOfDay=function(e){isDate(e)&&e.setHours(0,0,0,0)},compareDates=function(e,t){return e.getTime()===t.getTime()},extend3=function(e,t,r){let i,o;for(i in t)o=e[i]!==void 0,o&&typeof t[i]=="object"&&t[i]!==null&&t[i].nodeName===void 0?isDate(t[i])?r&&(e[i]=new Date(t[i].getTime())):isArray2(t[i])?r&&(e[i]=t[i].slice(0)):e[i]=extend3({},t[i],r):(r||!o)&&(e[i]=t[i]);return e},fireEvent=function(e,t,r){let i=getDocument().createEvent("HTMLEvents");i.initEvent(t,!0,!1),i=extend3(i,r),e.dispatchEvent(i)},adjustCalendar=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e},defaults2={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},renderDayName=function(e,t,r){for(t+=e.firstDay;t>=7;)t-=7;return r?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},renderDay=function(e){let t=[],r="false";if(e.isEmpty)if(e.showDaysInNextAndPreviousMonths)t.push("is-outside-current-month"),e.enableSelectionDaysInNextAndPreviousMonths||t.push("is-selection-disabled");else return'<td class="is-empty"></td>';return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),r="true"),e.hasEvent&&t.push("has-event"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+r+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"},isoWeek=function(e,t){e.setHours(0,0,0,0);let r=e.getDate(),i=e.getDay(),o=t,a=o-1,c=7,u=function(g){return(g+c-1)%c};e.setDate(r+a-u(i));let h=new Date(e.getFullYear(),0,o),d=24*60*60*1e3,f=(e.getTime()-h.getTime())/d;return 1+Math.round((f-a+u(h.getDay()))/c)},renderWeek=function(e,t,r,i,o){let a=new Date(i,r,t);return'<td class="pika-week">'+(e.hasMoment?e.moment(a).isoWeek():isoWeek(a,o))+"</td>"},renderRow=function(e,t,r,i){return'<tr class="pika-row'+(r?" pick-whole-week":"")+(i?" is-selected":"")+'">'+(t?e.reverse():e).join("")+"</tr>"},renderBody=function(e){return"<tbody>"+e.join("")+"</tbody>"},renderHead=function(e){let t,r=[];for(e.showWeekNumber&&r.push("<th></th>"),t=0;t<7;t++)r.push('<th scope="col"><abbr title="'+renderDayName(e,t)+'">'+renderDayName(e,t,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?r.reverse():r).join("")+"</tr></thead>"},renderTitle=function(e,t,r,i,o,a){let c,u,h,d=e._o,f=r===d.minYear,m=r===d.maxYear,g='<div id="'+a+'" class="pika-title" role="heading" aria-live="polite">',v,_,b=!0,S=!0;for(h=[],c=0;c<12;c++)h.push('<option value="'+(r===o?c-t:12+c-t)+'"'+(c===i?' selected="selected"':"")+(f&&c<d.minMonth||m&&c>d.maxMonth?' disabled="disabled"':"")+">"+d.i18n.months[c]+"</option>");for(v='<div class="pika-label">'+d.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+h.join("")+"</select></div>",isArray2(d.yearRange)?(c=d.yearRange[0],u=d.yearRange[1]+1):(c=r-d.yearRange,u=1+r+d.yearRange),h=[];c<u&&c<=d.maxYear;c++)c>=d.minYear&&h.push('<option value="'+c+'"'+(c===r?' selected="selected"':"")+">"+c+"</option>");return _='<div class="pika-label">'+r+d.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+h.join("")+"</select></div>",d.showMonthAfterYear?g+=_+v:g+=v+_,f&&(i===0||d.minMonth>=i)&&(b=!1),m&&(i===11||d.maxMonth<=i)&&(S=!1),t===0&&(g+='<button class="pika-prev'+(b?"":" is-disabled")+'" type="button">'+d.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(g+='<button class="pika-next'+(S?"":" is-disabled")+'" type="button">'+d.i18n.nextMonth+"</button>"),g+="</div>"},renderTable=function(e,t,r){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+r+'">'+renderHead(e)+renderBody(t)+"</table>"};function Pikaday(e){let t=this,r=t.config(e);t._onMouseDown=function(o){if(!t._v)return;o=o||getWindow().event;let a=o.target||o.srcElement;if(a)if(hasClass2(a,"is-disabled")||(hasClass2(a,"pika-button")&&!hasClass2(a,"is-empty")&&!hasClass2(a.parentNode,"is-disabled")?(t.setDate(new Date(a.getAttribute("data-pika-year"),a.getAttribute("data-pika-month"),a.getAttribute("data-pika-day"))),r.bound&&sto(function(){t.hide(),r.blurFieldOnSelect&&r.field&&r.field.blur()},100)):hasClass2(a,"pika-prev")?t.prevMonth():hasClass2(a,"pika-next")&&t.nextMonth()),hasClass2(a,"pika-select"))t._c=!0;else if(o.preventDefault)o.preventDefault();else return o.returnValue=!1,!1},t._onChange=function(o){o=o||getWindow().event;let a=o.target||o.srcElement;a&&(hasClass2(a,"pika-select-month")?t.gotoMonth(a.value):hasClass2(a,"pika-select-year")&&t.gotoYear(a.value))},t._onKeyChange=function(o){if(o=o||getWindow().event,t.isVisible())switch(o.keyCode){case 13:case 27:r.field&&r.field.blur();break;case 37:t.adjustDate("subtract",1);break;case 38:t.adjustDate("subtract",7);break;case 39:t.adjustDate("add",1);break;case 40:t.adjustDate("add",7);break;case 8:case 46:t.setDate(null);break}},t._parseFieldValue=function(){if(r.parse)return r.parse(r.field.value,r.format);if(this.hasMoment){let o=this.moment(r.field.value,r.format,r.formatStrict);return o&&o.isValid()?o.toDate():null}else return new Date(Date.parse(r.field.value))},t._onInputChange=function(o){let a;o.firedBy!==t&&(a=t._parseFieldValue(),isDate(a)&&t.setDate(a),t._v||t.show())},t._onInputFocus=function(){t.show()},t._onInputClick=function(){t.show()},t._onInputBlur=function(){let o=getDocument().activeElement;do if(hasClass2(o,"pika-single"))return;while(o=o.parentNode);t._c||(t._b=sto(function(){t.hide()},50)),t._c=!1},t._onClick=function(o){o=o||getWindow().event;let a=o.target||o.srcElement,c=a;if(a){!hasEventListeners&&hasClass2(a,"pika-select")&&(a.onchange||(a.setAttribute("onchange","return;"),addEvent2(a,"change",t._onChange)));do if(hasClass2(c,"pika-single")||c===r.trigger)return;while(c=c.parentNode);t._v&&a!==r.trigger&&c!==r.trigger&&t.hide()}},t.el=getDocument().createElement("div"),t.el.className="pika-single"+(r.isRTL?" is-rtl":"")+(r.theme?" "+r.theme:""),addEvent2(t.el,"mousedown",t._onMouseDown,!0),addEvent2(t.el,"touchend",t._onMouseDown,!0),addEvent2(t.el,"change",t._onChange),r.keyboardInput&&addEvent2(getDocument(),"keydown",t._onKeyChange),r.field&&(r.container?r.container.appendChild(t.el):r.bound?getDocument().body.appendChild(t.el):r.field.parentNode.insertBefore(t.el,r.field.nextSibling),addEvent2(r.field,"change",t._onInputChange),r.defaultDate||(r.defaultDate=t._parseFieldValue(),r.setDefaultDate=!0));let i=r.defaultDate;isDate(i)?r.setDefaultDate?t.setDate(i,!0):t.gotoDate(i):t.gotoDate(new Date),r.bound?(this.hide(),t.el.className+=" is-bound",addEvent2(r.trigger,"click",t._onInputClick),addEvent2(r.trigger,"focus",t._onInputFocus),addEvent2(r.trigger,"blur",t._onInputBlur)):this.show()}Pikaday.prototype={config:function(e){this._o||(this._o=extend3({},defaults2,!0));let t=extend3(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme=typeof t.theme=="string"&&t.theme?t.theme:null,t.bound=!!(t.bound!==void 0?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn=typeof t.disableDayFn=="function"?t.disableDayFn:null;let r=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=r>4?4:r,isDate(t.minDate)||(t.minDate=!1),isDate(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),isArray2(t.yearRange)){let i=new Date().getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||i,t.yearRange[1]=parseInt(t.yearRange[1],10)||i}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||defaults2.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(e){return e=e||this._o.format,isDate(this._d)?this._o.toString?this._o.toString(this._d,e):this.hasMoment?this.moment(this._d).format(e):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(e,t){this.hasMoment&&this.moment.isMoment(e)&&this.setDate(e.toDate(),t)},useMoment:function(e){this.hasMoment=!0,this.moment=e},getDate:function(){return isDate(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",fireEvent(this._o.field,"change",{firedBy:this})),this.draw();if(typeof e=="string"&&(e=new Date(Date.parse(e))),!isDate(e))return;let r=this._o.minDate,i=this._o.maxDate;isDate(r)&&e<r?e=r:isDate(i)&&e>i&&(e=i),this._d=new Date(e.getTime()),setToStartOfDay(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),fireEvent(this._o.field,"change",{firedBy:this})),!t&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(e){let t=!0;if(isDate(e)){if(this.calendars){let r=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),o=e.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),t=o<r.getTime()||i.getTime()<o}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(e,t){let r=this.getDate()||new Date,i=parseInt(t)*24*60*60*1e3,o;e==="add"?o=new Date(r.valueOf()+i):e==="subtract"&&(o=new Date(r.valueOf()-i)),this.setDate(o)},adjustCalendars:function(){this.calendars[0]=adjustCalendar(this.calendars[0]);for(let e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=adjustCalendar({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(setToStartOfDay(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=defaults2.minDate,this._o.minYear=defaults2.minYear,this._o.minMonth=defaults2.minMonth,this._o.startRange=defaults2.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(setToStartOfDay(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=defaults2.maxDate,this._o.maxYear=defaults2.maxYear,this._o.maxMonth=defaults2.maxMonth,this._o.endRange=defaults2.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(!this._v&&!e)return;let t=this._o,r=t.minYear,i=t.maxYear,o=t.minMonth,a=t.maxMonth,c="",u;this._y<=r&&(this._y=r,!isNaN(o)&&this._m<o&&(this._m=o)),this._y>=i&&(this._y=i,!isNaN(a)&&this._m>a&&(this._m=a));for(let h=0;h<t.numberOfMonths;h++)u="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),c+='<div class="pika-lendar">'+renderTitle(this,h,this.calendars[h].year,this.calendars[h].month,this.calendars[0].year,u)+this.render(this.calendars[h].year,this.calendars[h].month,u)+"</div>";this.el.innerHTML=c,t.bound&&t.field.type!=="hidden"&&sto(function(){t.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),t.bound&&t.field.setAttribute("aria-label",t.ariaLabel)},adjustPosition:function(){let e,t,r,i,o,a,c,u,h,d,f;this._o.container||(this.el.style.position="absolute",e=this._o.trigger,t=this.el.offsetWidth,r=this.el.offsetHeight,i=getWindow().innerWidth||getDocument().documentElement.clientWidth,o=getWindow().innerHeight||getDocument().documentElement.clientHeight,a=getDocument().body.scrollTop||getDocument().documentElement.scrollTop,d=!0,f=!0,h=e.getBoundingClientRect(),c=h.left+getWindow().pageXOffset,u=h.bottom+getWindow().pageYOffset,(this._o.reposition&&c+t>i||this._o.position.indexOf("right")>-1&&c-t+e.offsetWidth>0)&&(c=c-t+e.offsetWidth,d=!1),(this._o.reposition&&u+r>o+a||this._o.position.indexOf("top")>-1&&u-r-e.offsetHeight>0)&&(u=u-r-e.offsetHeight,f=!1),c<0&&(c=0),u<0&&(u=0),this.el.style.left=c+"px",this.el.style.top=u+"px",addClass2(this.el,d?"left-aligned":"right-aligned"),addClass2(this.el,f?"bottom-aligned":"top-aligned"),removeClass2(this.el,d?"right-aligned":"left-aligned"),removeClass2(this.el,f?"top-aligned":"bottom-aligned"))},render:function(e,t,r){let i=this._o,o=new Date,a=getDaysInMonth(e,t),c=new Date(e,t,1).getDay(),u=[],h=[];setToStartOfDay(o),i.firstDay>0&&(c-=i.firstDay,c<0&&(c+=7));let d=t===0?11:t-1,f=t===11?0:t+1,m=t===0?e-1:e,g=t===11?e+1:e,v=getDaysInMonth(m,d),_=a+c,b=_;for(;b>7;)b-=7;_+=7-b;let S=!1;for(let R=0,A=0;R<_;R++){let I=new Date(e,t,1+(R-c)),E=isDate(this._d)?compareDates(I,this._d):!1,O=compareDates(I,o),P=i.events.indexOf(I.toDateString())!==-1,L=R<c||R>=a+c,V=1+(R-c),$=t,W=e,Z=i.startRange&&compareDates(i.startRange,I),ie=i.endRange&&compareDates(i.endRange,I),ue=i.startRange&&i.endRange&&i.startRange<I&&I<i.endRange,_e=i.minDate&&I<i.minDate||i.maxDate&&I>i.maxDate||i.disableWeekends&&isWeekend(I)||i.disableDayFn&&i.disableDayFn(I);L&&(R<c?(V=v+V,$=d,W=m):(V=V-a,$=f,W=g));let Te={day:V,month:$,year:W,hasEvent:P,isSelected:E,isToday:O,isDisabled:_e,isEmpty:L,isStartRange:Z,isEndRange:ie,isInRange:ue,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&E&&(S=!0),h.push(renderDay(Te)),++A===7&&(i.showWeekNumber&&h.unshift(renderWeek(this,R-c,t,e,i.firstWeekOfYearMinDays)),u.push(renderRow(h,i.isRTL,i.pickWholeWeek,S)),h=[],A=0,S=!1)}return renderTable(i,u,r)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),removeClass2(this.el,"is-hidden"),this._o.bound&&(addEvent2(getDocument(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let e=this._v;e!==!1&&(this._o.bound&&removeEvent2(getDocument(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),addClass2(this.el,"is-hidden"),this._v=!1,e!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let e=this._o;this.hide(),removeEvent2(this.el,"mousedown",this._onMouseDown,!0),removeEvent2(this.el,"touchend",this._onMouseDown,!0),removeEvent2(this.el,"change",this._onChange),e.keyboardInput&&removeEvent2(getDocument(),"keydown",this._onKeyChange),e.field&&(removeEvent2(e.field,"change",this._onInputChange),e.bound&&(removeEvent2(e.trigger,"click",this._onInputClick),removeEvent2(e.trigger,"focus",this._onInputFocus),removeEvent2(e.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function _defineProperty61(e,t,r){return(t=_toPropertyKey61(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey61(e){var t=_toPrimitive61(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive61(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EDITOR_TYPE6="date",SHORTCUTS_GROUP_EDITOR="dateEditor",DateEditor=class extends TextEditor{constructor(){super(...arguments),_defineProperty61(this,"defaultDateFormat","DD/MM/YYYY"),_defineProperty61(this,"parentDestroyed",!1),_defineProperty61(this,"$datePicker",null)}static get EDITOR_TYPE(){return EDITOR_TYPE6}init(){if(typeof import_moment2.default!="function")throw new Error("You need to include moment.js to your project.");if(typeof Pikaday!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),addClass(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{hasClass(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,r,i,o,a){super.prepare(e,t,r,i,o,a)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:SHORTCUTS_GROUP_EDITOR})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP_EDITOR),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,t)}showDatepicker(e){const t=this.cellProperties.dateFormat||this.defaultDateFormat,r=this.hot.view.isMouseDown(),i=e?isFunctionKey(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new Pikaday(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(import_moment2.default),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,(0,import_moment2.default)(o,t,!0).isValid()&&this.$datePicker.setMoment((0,import_moment2.default)(o,t),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,(0,import_moment2.default)(o,t,!0).isValid()&&this.$datePicker.setMoment((0,import_moment2.default)(o,t),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,t={};this.cellProperties&&this.cellProperties.datePickerConfig&&deepExtend(t,this.cellProperties.datePickerConfig);const r=t.onSelect,i=t.onClose;return t.field=e,t.trigger=e,t.container=this.datePicker,t.bound=!1,t.keyboardInput=!1,t.format=t.format||this.defaultDateFormat,t.reposition=t.reposition||!1,t.isRTL=!1,t.onSelect=o=>{let a=o;isNaN(a.getTime())||(a=(0,import_moment2.default)(a).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(a),r&&r()},t.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},t}refreshDimensions(e){var t;if(super.refreshDimensions(e),this.state!==EDITOR_STATE.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:a}=(t=o.getParentOverlay(this.TD))!==null&&t!==void 0?t:this.hot.view._wt,c=r.getVisualFromRenderableIndex(a.getFirstPartiallyVisibleRow()),u=r.getVisualFromRenderableIndex(a.getLastPartiallyVisibleRow()),h=i.getVisualFromRenderableIndex(a.getFirstPartiallyVisibleColumn()),d=i.getVisualFromRenderableIndex(a.getLastPartiallyVisibleColumn());if(this.row>=c&&this.row<=u&&this.col>=h&&this.col<=d){const f=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+f.top+outerHeight(this.TD)}px`;let m=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?m+=f.right-outerWidth(this.datePicker):m+=f.left,this.datePickerStyle.left=`${m}px`}else this.hideDatepicker()}},EDITOR_TYPE7="dropdown",DropdownEditor=class extends AutocompleteEditor{static get EDITOR_TYPE(){return EDITOR_TYPE7}prepare(e,t,r,i,o,a){super.prepare(e,t,r,i,o,a),this.cellProperties.filter=!1,this.cellProperties.strict=!0}};pluginHooks_default.getSingleton().add("beforeValidate",function(e,t,r){const i=this.propToCol(r);if(Number.isInteger(i)){const o=this.getCellMeta(t,i);o.editor===DropdownEditor&&o.strict===void 0&&(o.filter=!1,o.strict=!0)}});var EDITOR_TYPE8="numeric",NumericEditor=class extends TextEditor{static get EDITOR_TYPE(){return EDITOR_TYPE8}},EDITOR_TYPE9="password",PasswordEditor=class extends TextEditor{static get EDITOR_TYPE(){return EDITOR_TYPE9}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,empty2(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}},EDITOR_VISIBLE_CLASS_NAME2="ht_editor_visible",SHORTCUTS_GROUP3="selectEditor",EDITOR_TYPE10="select",SelectEditor=class extends BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE10}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",addClass(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",hasClass(this.select,EDITOR_VISIBLE_CLASS_NAME2)&&removeClass(this.select,EDITOR_VISIBLE_CLASS_NAME2),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,r,i,o,a){super.prepare(e,t,r,i,o,a);const c=this.cellProperties.selectOptions;let u;typeof c=="function"?u=this.prepareOptions(c(this.row,this.col,this.prop)):u=this.prepareOptions(c),empty2(this.select),objectEach(u,(h,d)=>{const f=this.hot.rootDocument.createElement("OPTION");f.value=d,fastInnerHTML(f,h),this.select.appendChild(f)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)t[e[r]]=e[r];else typeof e=="object"&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==EDITOR_STATE.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:t,width:r,height:i}=this.getEditedCellRect(),o=this.select.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${t}px`,o.margin="0px",addClass(this.select,EDITOR_VISIBLE_CLASS_NAME2)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),r={group:SHORTCUTS_GROUP3};this.isInFullEditMode()&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP3)}},EDITOR_TYPE11="time",TimeEditor=class extends TextEditor{static get EDITOR_TYPE(){return EDITOR_TYPE11}prepare(e,t,r,i,o,a){super.prepare(e,t,r,i,o,a),this.TEXTAREA.dir="ltr"}};function registerAllEditors(){_register(BaseEditor),_register(AutocompleteEditor),_register(CheckboxEditor),_register(DateEditor),_register(DropdownEditor),_register(HandsontableEditor),_register(NumericEditor),_register(PasswordEditor),_register(SelectEditor),_register(TextEditor),_register(TimeEditor)}var RENDERER_TYPE3="html";function htmlRenderer(e,t,r,i,o,a,c){baseRenderer.apply(this,[e,t,r,i,o,a,c]),fastInnerHTML(t,a??"",!1)}htmlRenderer.RENDERER_TYPE=RENDERER_TYPE3;var RENDERER_TYPE4="autocomplete";function autocompleteRenderer(e,t,r,i,o,a,c){const{rootDocument:u}=e,h=c.allowHtml?htmlRenderer:textRenderer,d=u.createElement("DIV"),f=e.getSettings().ariaTags;if(d.className="htAutocompleteArrow",f&&d.setAttribute(...A11Y_HIDDEN()),d.appendChild(u.createTextNode("\u25BC")),h.apply(this,[e,t,r,i,o,a,c]),t.firstChild||t.appendChild(u.createTextNode("\xA0")),t.insertBefore(d,t.firstChild),addClass(t,"htAutocomplete"),!e.acArrowListener){const m=new eventManager_default(e);e.acArrowListener=function(g){hasClass(g.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(r,i),t)},m.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",()=>{m.destroy()})}}autocompleteRenderer.RENDERER_TYPE=RENDERER_TYPE4;var RENDERER_TYPE5="dropdown";function dropdownRenderer(e,t,r,i,o,a,c){autocompleteRenderer.apply(this,[e,t,r,i,o,a,c])}dropdownRenderer.RENDERER_TYPE=RENDERER_TYPE5;var import_es_array_push42=__toESM(require_es_array_push(),1),isListeningKeyDownEvent=new WeakMap,isCheckboxListenerAdded=new WeakMap,BAD_VALUE_CLASS="htBadValue",ATTR_ROW="data-row",ATTR_COLUMN="data-col",SHORTCUTS_GROUP4="checkboxRenderer",RENDERER_TYPE6="checkbox";pluginHooks_default.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,r){const{label:i,type:o,row:a,column:c,prop:u}=t;if(o===RENDERER_TYPE6){if(i){const{value:h,property:d}=i;let f=r;if(h)f=typeof h=="function"?h(a,c,u,r):h;else if(d){const m=this.getDataAtRowProp(a,d);f=m!==null?m:r}e=f}return e}});function checkboxRenderer(e,t,r,i,o,a,c){const{rootDocument:u}=e,h=e.getSettings().ariaTags;baseRenderer.apply(this,[e,t,r,i,o,a,c]),registerEvents(e);let d=createInput(u);const f=c.label;let m=!1;if(typeof c.checkedTemplate>"u"&&(c.checkedTemplate=!0),typeof c.uncheckedTemplate>"u"&&(c.uncheckedTemplate=!1),empty2(t),a===c.checkedTemplate||stringify(a).toLocaleLowerCase(c.locale)===stringify(c.checkedTemplate).toLocaleLowerCase(c.locale)?d.checked=!0:a===c.uncheckedTemplate||stringify(a).toLocaleLowerCase(c.locale)===stringify(c.uncheckedTemplate).toLocaleLowerCase(c.locale)?d.checked=!1:isEmpty(a)?addClass(d,"noValue"):(d.style.display="none",addClass(d,BAD_VALUE_CLASS),m=!0),setAttribute(d,[[ATTR_ROW,r],[ATTR_COLUMN,i]]),h&&setAttribute(d,[A11Y_LABEL(d.checked?e.getTranslatedPhrase(CHECKBOX_CHECKED):e.getTranslatedPhrase(CHECKBOX_UNCHECKED)),A11Y_CHECKED(d.checked),A11Y_CHECKBOX()]),!m&&f){let b="";if(f.value)b=typeof f.value=="function"?f.value.call(this,r,i,o,a):f.value;else if(f.property){const R=e.getDataAtRowProp(r,f.property);b=R!==null?R:""}const S=createLabel(u,b,f.separated!==!0);f.position==="before"?f.separated?(t.appendChild(S),t.appendChild(d)):(S.appendChild(d),d=S):(!f.position||f.position==="after")&&(f.separated?(t.appendChild(d),t.appendChild(S)):(S.insertBefore(d,S.firstChild),d=S))}(!f||f&&!f.separated)&&t.appendChild(d),m&&t.appendChild(u.createTextNode("#bad-value#")),isListeningKeyDownEvent.has(e)||(isListeningKeyDownEvent.set(e,!0),g());function g(){const S=e.getShortcutManager().getContext("grid"),R={group:SHORTCUTS_GROUP4,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"};S.addShortcuts([{keys:[["space"]],callback:()=>(v(),!_()),runOnlyIf:()=>{var A;return(A=e.getSelectedRangeLast())===null||A===void 0?void 0:A.highlight.isCell()}},{keys:[["enter"]],callback:()=>(v(),!_()),runOnlyIf:()=>{const A=e.getSelectedRangeLast();return e.getSettings().enterBeginsEditing&&A?.isSingle()&&A.highlight.isCell()}},{keys:[["delete"],["backspace"]],callback:()=>(v(!0),!_()),runOnlyIf:()=>{var A;return(A=e.getSelectedRangeLast())===null||A===void 0?void 0:A.highlight.isCell()}}],R)}function v(){let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const S=e.getSelectedRange(),R=[],A=new Map;let I=[],E=0;if(S){for(let O=0;O<S.length;O++){const{row:P,col:L}=S[O].getTopStartCorner(),{row:V,col:$}=S[O].getBottomEndCorner();for(let W=P;W<=V;W+=1)for(let Z=L;Z<=$;Z+=1){const ie=e.getCellMeta(W,Z),ue={checkedTemplate:ie.checkedTemplate,uncheckedTemplate:ie.uncheckedTemplate};if(ie.type!=="checkbox"){b===!0&&!ie.readOnly&&(A.has(R.length)?A.set(R.length,[...A.get(R.length),[W,Z,null]]):A.set(R.length,[[W,Z,null]]));continue}if(ie.readOnly===!0)continue;typeof ie.checkedTemplate>"u"&&(ie.checkedTemplate=!0),typeof ie.uncheckedTemplate>"u"&&(ie.uncheckedTemplate=!1);const _e=e.getDataAtCell(W,Z);b===!1?[ie.checkedTemplate,ie.checkedTemplate.toString()].includes(_e)?I.push([W,Z,ie.uncheckedTemplate,ue]):[ie.uncheckedTemplate,ie.uncheckedTemplate.toString(),null,void 0].includes(_e)&&I.push([W,Z,ie.checkedTemplate,ue]):I.push([W,Z,ie.uncheckedTemplate,ue]),E+=1}R.push(E),E=0}I.every(O=>{let[,,P]=O;return P===I[0][2]})?I=I.map(O=>{let[P,L,V]=O;return[P,L,V]}):I=I.map(O=>{let[P,L,,V]=O;return[P,L,V.checkedTemplate]}),I.length>0&&R.forEach((O,P)=>{let L=I.splice(0,O);A.size&&A.has(P)&&(L=[...L,...A.get(P)]),e.setDataAtCell(L)})}}function _(){const b=e.getSelectedRange();if(b){for(let S=0;S<b.length;S++){const R=b[S].getTopStartCorner(),A=b[S].getBottomEndCorner();for(let I=R.row;I<=A.row;I++)for(let E=R.col;E<=A.col;E++){const O=e.getCellMeta(I,E),P=e.getCell(I,E);if(P==null)return!0;if(P.querySelectorAll("input[type=checkbox]").length>0&&!O.readOnly)return!0}}return!1}}}checkboxRenderer.RENDERER_TYPE=RENDERER_TYPE6;function registerEvents(e){let t=isCheckboxListenerAdded.get(e);if(!t){const{rootElement:r}=e;t=new eventManager_default(e),t.addEventListener(r,"click",i=>onClick(i,e)),t.addEventListener(r,"mouseup",i=>onMouseUp(i,e)),t.addEventListener(r,"change",i=>onChange(i,e)),isCheckboxListenerAdded.set(e,t)}return t}function createInput(e){const t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function createLabel(e,t,r){const i=e.createElement("label");return i.className=`htCheckboxRendererLabel ${r?"fullWidth":""}`,i.appendChild(e.createTextNode(t)),i.cloneNode(!0)}function onMouseUp(e,t){const{target:r}=e;isCheckboxInput(r)&&(!r.hasAttribute(ATTR_ROW)||!r.hasAttribute(ATTR_COLUMN)||setTimeout(t.listen,10))}function onClick(e,t){const{target:r}=e;if(!isCheckboxInput(r)||!r.hasAttribute(ATTR_ROW)||!r.hasAttribute(ATTR_COLUMN))return;const i=parseInt(r.getAttribute(ATTR_ROW),10),o=parseInt(r.getAttribute(ATTR_COLUMN),10);t.getCellMeta(i,o).readOnly&&e.preventDefault()}function onChange(e,t){const{target:r}=e;if(!isCheckboxInput(r)||!r.hasAttribute(ATTR_ROW)||!r.hasAttribute(ATTR_COLUMN))return;const i=parseInt(r.getAttribute(ATTR_ROW),10),o=parseInt(r.getAttribute(ATTR_COLUMN),10),a=t.getCellMeta(i,o);if(!a.readOnly){let c=null;e.target.checked?c=a.uncheckedTemplate===void 0?!0:a.checkedTemplate:c=a.uncheckedTemplate===void 0?!1:a.uncheckedTemplate,t.setDataAtCell(i,o,c)}}function isCheckboxInput(e){return e.tagName==="INPUT"&&e.getAttribute("type")==="checkbox"}var RENDERER_TYPE7="handsontable";function handsontableRenderer(e,t,r,i,o,a,c){autocompleteRenderer.apply(this,[e,t,r,i,o,a,c])}handsontableRenderer.RENDERER_TYPE=RENDERER_TYPE7;var import_es_array_push43=__toESM(require_es_array_push(),1),import_numbro=__toESM(require_numbro_min(),1),RENDERER_TYPE8="numeric";function getRenderedValue(e,t){if(isNumeric(e)){const r=t.numericFormat,i=r&&r.culture||"-",o=r&&r.pattern;if(typeof i<"u"&&!import_numbro.default.languages()[i]){const a=i.replace("-",""),c=import_numbro.default.allLanguages?import_numbro.default.allLanguages[i]:import_numbro.default[a];c&&import_numbro.default.registerLanguage(c)}import_numbro.default.setLanguage(i),e=(0,import_numbro.default)(e).format(o||"0")}return e}function numericRenderer(e,t,r,i,o,a,c){let u=a;if(isNumeric(u)){const h=c.className||"",d=h.length?h.split(" "):[];u=getRenderedValue(u,c),d.indexOf("htLeft")<0&&d.indexOf("htCenter")<0&&d.indexOf("htRight")<0&&d.indexOf("htJustify")<0&&d.push("htRight"),d.indexOf("htNumeric")<0&&d.push("htNumeric"),c.className=d.join(" "),t.dir="ltr"}textRenderer(e,t,r,i,o,u,c)}numericRenderer.RENDERER_TYPE=RENDERER_TYPE8;var RENDERER_TYPE9="password";function passwordRenderer(e,t,r,i,o,a,c){textRenderer.apply(this,[e,t,r,i,o,a,c]);const u=c.hashLength||t.innerHTML.length,h=c.hashSymbol||"*";let d="";rangeEach(u-1,()=>{d+=h}),fastInnerHTML(t,d)}passwordRenderer.RENDERER_TYPE=RENDERER_TYPE9;var RENDERER_TYPE10="select";function selectRenderer(e,t,r,i,o,a,c){textRenderer.apply(this,[e,t,r,i,o,a,c])}selectRenderer.RENDERER_TYPE=RENDERER_TYPE10;var RENDERER_TYPE11="time";function timeRenderer(e,t,r,i,o,a,c){textRenderer.apply(this,[e,t,r,i,o,a,c]),t.dir="ltr"}timeRenderer.RENDERER_TYPE=RENDERER_TYPE11;function registerAllRenderers(){_register2(autocompleteRenderer),_register2(baseRenderer),_register2(checkboxRenderer),_register2(dropdownRenderer),_register2(handsontableRenderer),_register2(htmlRenderer),_register2(numericRenderer),_register2(passwordRenderer),_register2(selectRenderer),_register2(textRenderer),_register2(timeRenderer)}var VALIDATOR_TYPE="autocomplete";function autocompleteValidator(e,t){let r=e;if(r==null&&(r=""),this.allowEmpty&&r===""){t(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,process2(r,t)):process2(r,t)(this.source):t(!0)}autocompleteValidator.VALIDATOR_TYPE=VALIDATOR_TYPE;function process2(e,t){const r=e;return function(i){let o=!1;for(let a=0,c=i.length;a<c;a++)if(r===i[a]){o=!0;break}t(o)}}var import_moment3=__toESM(require_moment(),1),date_exports={};__export(date_exports,{getNormalizedDate:()=>getNormalizedDate});function getNormalizedDate(e){const t=new Date(e);return isNaN(new Date(`${e}T00:00`).getDate())?t:new Date(t.getTime()+t.getTimezoneOffset()*6e4)}var VALIDATOR_TYPE2="date";function dateValidator(e,t){const r=_getEditorInstance(EDITOR_TYPE6,this.instance);let i=e,o=!0;i==null&&(i="");let a=(0,import_moment3.default)(i,this.dateFormat||r.defaultDateFormat,!0).isValid(),c=(0,import_moment3.default)(new Date(i)).isValid()||a;if(this.allowEmpty&&i===""&&(c=!0,a=!0),c||(o=!1),!c&&a&&(o=!0),c&&!a)if(this.correctFormat===!0){const u=correctFormat(i,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"dateValidator"),o=!0}else o=!1;t(o)}dateValidator.VALIDATOR_TYPE=VALIDATOR_TYPE2;function correctFormat(e,t){const r=(0,import_moment3.default)(getNormalizedDate(e)),i=(0,import_moment3.default)(e,t),o=e.search(/[A-z]/g)>-1;let a;return r.isValid()&&r.format("x")===i.format("x")||!i.isValid()||o?a=r:a=i,a.format(t)}var VALIDATOR_TYPE3="dropdown";function dropdownValidator(e,t){autocompleteValidator.apply(this,[e,t])}dropdownValidator.VALIDATOR_TYPE=VALIDATOR_TYPE3;var VALIDATOR_TYPE4="numeric";function numericValidator(e,t){let r=e;r==null&&(r=""),this.allowEmpty&&r===""?t(!0):t(r===""?!1:isNumeric(e))}numericValidator.VALIDATOR_TYPE=VALIDATOR_TYPE4;var import_moment4=__toESM(require_moment(),1),STRICT_FORMATS=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],VALIDATOR_TYPE5="time";function timeValidator(e,t){const r=this.timeFormat||"h:mm:ss a";let i=!0,o=e;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;const a=/^\d{1,2}$/.test(o);a&&(o+=":00");const c=(0,import_moment4.default)(o,STRICT_FORMATS,!0).isValid()?(0,import_moment4.default)(o):(0,import_moment4.default)(o,r);let u=c.isValid(),h=(0,import_moment4.default)(o,r,!0).isValid()&&!a;if(this.allowEmpty&&o===""&&(u=!0,h=!0),u||(i=!1),!u&&h&&(i=!0),u&&!h)if(this.correctFormat===!0){const d=c.format(r);this.instance.setDataAtCell(this.visualRow,this.visualCol,d,"timeValidator"),i=!0}else i=!1;t(i)}timeValidator.VALIDATOR_TYPE=VALIDATOR_TYPE5;function registerAllValidators(){_register3(autocompleteValidator),_register3(dropdownValidator),_register3(dateValidator),_register3(numericValidator),_register3(timeValidator)}var CELL_TYPE2="autocomplete",AutocompleteCellType={CELL_TYPE:CELL_TYPE2,editor:AutocompleteEditor,renderer:autocompleteRenderer,validator:autocompleteValidator},CELL_TYPE3="checkbox",CheckboxCellType={CELL_TYPE:CELL_TYPE3,editor:CheckboxEditor,renderer:checkboxRenderer},RENDERER_TYPE12="date";function dateRenderer(e,t,r,i,o,a,c){autocompleteRenderer.apply(this,[e,t,r,i,o,a,c])}dateRenderer.RENDERER_TYPE=RENDERER_TYPE12;var CELL_TYPE4="date",DateCellType={CELL_TYPE:CELL_TYPE4,editor:DateEditor,renderer:dateRenderer,validator:dateValidator},CELL_TYPE5="dropdown",DropdownCellType={CELL_TYPE:CELL_TYPE5,editor:DropdownEditor,renderer:dropdownRenderer,validator:dropdownValidator},CELL_TYPE6="handsontable",HandsontableCellType={CELL_TYPE:CELL_TYPE6,editor:HandsontableEditor,renderer:handsontableRenderer},CELL_TYPE7="numeric",NumericCellType={CELL_TYPE:CELL_TYPE7,editor:NumericEditor,renderer:numericRenderer,validator:numericValidator,dataType:"number"},CELL_TYPE8="password",PasswordCellType={CELL_TYPE:CELL_TYPE8,editor:PasswordEditor,renderer:passwordRenderer,copyable:!1},CELL_TYPE9="select",SelectCellType={CELL_TYPE:CELL_TYPE9,editor:SelectEditor,renderer:selectRenderer},CELL_TYPE10="time",TimeCellType={CELL_TYPE:CELL_TYPE10,editor:TimeEditor,renderer:timeRenderer,validator:timeValidator};function registerAllCellTypes(){_register4(AutocompleteCellType),_register4(CheckboxCellType),_register4(DateCellType),_register4(DropdownCellType),_register4(HandsontableCellType),_register4(NumericCellType),_register4(PasswordCellType),_register4(SelectCellType),_register4(TextCellType),_register4(TimeCellType)}var import_es_error_cause92=__toESM(require_es_error_cause(),1),import_es_array_push47=__toESM(require_es_array_push(),1),import_es_error_cause89=__toESM(require_es_error_cause(),1),import_es_array_push44=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec9(e,t){_checkPrivateRedeclaration19(e,t),t.add(e)}function _classPrivateFieldInitSpec16(e,t,r){_checkPrivateRedeclaration19(e,t),t.set(e,r)}function _checkPrivateRedeclaration19(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty62(e,t,r){return(t=_toPropertyKey62(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey62(e){var t=_toPrimitive62(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive62(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet16(e,t){return e.get(_assertClassBrand19(e,t))}function _assertClassBrand19(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var DEPS_TYPE_CHECKERS=new Map([["plugin",hasPlugin],["cell-type",hasItem4],["editor",hasItem],["renderer",hasItem2],["validator",hasItem3]]),PLUGIN_KEY="base",missingDepsMsgs=[],initializedPlugins=null,_hooks=new WeakMap,_BasePlugin_brand=new WeakSet,BasePlugin=class{static get PLUGIN_KEY(){return PLUGIN_KEY}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){_classPrivateMethodInitSpec9(this,_BasePlugin_brand),_defineProperty62(this,"eventManager",new eventManager_default(this)),_defineProperty62(this,"pluginName",null),_defineProperty62(this,"pluginsInitializedCallbacks",[]),_defineProperty62(this,"isPluginsReady",!1),_defineProperty62(this,"enabled",!1),_defineProperty62(this,"initialized",!1),_classPrivateFieldInitSpec16(this,_hooks,{}),defineGetter(this,"hot",e,{writable:!1}),initializedPlugins=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const i=[];if(t.forEach(o=>{const[a,c]=o.split(":");if(!DEPS_TYPE_CHECKERS.has(a))throw new Error(`Unknown plugin dependency type "${a}" was found.`);DEPS_TYPE_CHECKERS.get(a)(c)||i.push(` - ${c} (${a})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");missingDepsMsgs.push(o)}}if(initializedPlugins||(initializedPlugins=getPluginsNames()),initializedPlugins.indexOf("UndoRedo")>=0&&initializedPlugins.splice(initializedPlugins.indexOf("UndoRedo"),1),initializedPlugins.indexOf(this.pluginName)>=0&&initializedPlugins.splice(initializedPlugins.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),initializedPlugins.length===0){if(missingDepsMsgs.length>0){const i=[`${missingDepsMsgs.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,t,r){_classPrivateFieldGet16(_hooks,this)[e]=_classPrivateFieldGet16(_hooks,this)[e]||[];const i=_classPrivateFieldGet16(_hooks,this)[e];this.hot.addHook(e,t,r),i.push(t),_classPrivateFieldGet16(_hooks,this)[e]=i}removeHooks(e){arrayEach(_classPrivateFieldGet16(_hooks,this)[e]||[],t=>{this.hot.removeHook(e,t)})}clearHooks(){const e=_classPrivateFieldGet16(_hooks,this);objectEach(e,(t,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){arrayEach(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=_assertClassBrand19(_BasePlugin_brand,this,_isRelevantToSettings).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),objectEach(this,(t,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}};function _isRelevantToSettings(e){if(!e)return!1;const t=this.constructor.SETTING_KEYS;if(typeof t=="boolean")return t;for(let r=0;r<t.length;r++)if(e[t[r]]!==void 0)return!0;return!1}var import_es_error_cause90=__toESM(require_es_error_cause(),1),import_es_array_push45=__toESM(require_es_array_push(),1);function _defineProperty63(e,t,r){return(t=_toPropertyKey63(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey63(e){var t=_toPrimitive63(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive63(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GhostTable=class{constructor(e){_defineProperty63(this,"hot",null),_defineProperty63(this,"container",null),_defineProperty63(this,"injected",!1),_defineProperty63(this,"rows",[]),_defineProperty63(this,"columns",[]),_defineProperty63(this,"samples",null),_defineProperty63(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(t!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),arrayEach(this.rows,t=>{const{height:r}=t.table.getBoundingClientRect();e(t.row,Math.ceil(r)-1)})}getWidths(e){this.injected||this.injectTable(),arrayEach(this.columns,t=>{const{width:r}=t.table.getBoundingClientRect();e(t.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{arrayEach(r.strings,i=>{t.appendChild(this.createColElement(i.col,e))})}),t}createRow(e){const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),i=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{arrayEach(o.strings,a=>{const c=a.col,u=this.hot.getCellMeta(e,c),h=this.hot.getCellRenderer(u),d=t.createElement("td");d.setAttribute("ghost-table",1),h(this.hot,d,e,c,this.hot.colToProp(c),a.value,u),r.appendChild(d)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),t.appendChild(i)}this.samples.forEach(i=>{arrayEach(i.strings,o=>{const a=o.col,c=e.createElement("th");r.push([a,c]),t.appendChild(c)})}),this.table.tHead.appendChild(t),arrayEach(r,i=>{const[o,a]=i;this.hot.view.appendColHeader(o,a)})}createCol(e){const{rootDocument:t}=this.hot,r=t.createDocumentFragment();return this.samples.forEach(i=>{arrayEach(i.strings,o=>{const a=o.row,c=this.hot.getCellMeta(a,e),u=this.hot.getCellRenderer(c),h=t.createElement("td"),d=t.createElement("tr");h.setAttribute("ghost-table",1),u(this.hot,h,a,e,this.hot.colToProp(e),o.value,c),d.appendChild(h),r.appendChild(d)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,t){const r=this.hot.rootDocument.createElement("col");let i=0;t>=0&&e>=0&&(i=this.hot.getCellMeta(t,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let a=e+1;a<e+i;a++)o+=this.hot.getColWidth(a);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),i=t.createElement("table"),o=t.createElement("thead"),a=t.createElement("tbody"),c=t.createElement("colgroup"),u=t.createElement("tr"),h=t.createElement("th");return this.isVertical()&&i.appendChild(c),this.isHorizontal()&&(u.appendChild(h),o.appendChild(u),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&a.appendChild(u),i.appendChild(a),addClass(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:a,colGroup:c,tr:u,th:h}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),i=t.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return addClass(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}},ghostTable_default=GhostTable,import_es_error_cause91=__toESM(require_es_error_cause(),1),import_es_array_push46=__toESM(require_es_array_push(),1);function _defineProperty64(e,t,r){return(t=_toPropertyKey64(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey64(e){var t=_toPrimitive64(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive64(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SamplesGenerator=class ts{static get SAMPLE_COUNT(){return 3}constructor(t){_defineProperty64(this,"samples",null),_defineProperty64(this,"dataFactory",null),_defineProperty64(this,"customSampleCount",null),_defineProperty64(this,"allowDuplicates",!1),this.dataFactory=t}getSampleCount(){return this.customSampleCount?this.customSampleCount:ts.SAMPLE_COUNT}setSampleCount(t){this.customSampleCount=t}setAllowDuplicates(t){this.allowDuplicates=t}generateRowSamples(t,r){return this.generateSamples("row",r,t)}generateColumnSamples(t,r){return this.generateSamples("col",r,t)}generateSamples(t,r,i){const o=new Map,{from:a,to:c}=typeof i=="number"?{from:i,to:i}:i;return rangeEach(a,c,u=>{const h=this.generateSample(t,r,u);o.set(u,h)}),o}generateSample(t,r,i){if(t!=="row"&&t!=="col")throw new Error("Unsupported sample type");const o=new Map,a=t==="row"?"col":"row",c=[];return rangeEach(r.from,r.to,u=>{const h=t==="row"?this.dataFactory(i,u):this.dataFactory(u,i);if(h===!1)return;const{value:d,bundleSeed:f}=h,m=typeof f=="string"&&f.length>0;let g;m?g=f:isObject2(d)?g=`${Object.keys(d).length}`:Array.isArray(d)?g=`${d.length}`:g=`${stringify(d).length}`,o.has(g)||o.set(g,{needed:this.getSampleCount(),strings:[]});const v=o.get(g);v.needed&&(!(c.indexOf(d)>-1)||this.allowDuplicates||m)&&(v.strings.push({value:d,[a]:u}),c.push(d),v.needed-=1)}),o}},samplesGenerator_default=SamplesGenerator;function _classPrivateMethodInitSpec10(e,t){_checkPrivateRedeclaration20(e,t),t.add(e)}function _classPrivateFieldInitSpec17(e,t,r){_checkPrivateRedeclaration20(e,t),t.set(e,r)}function _checkPrivateRedeclaration20(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty65(e,t,r){return(t=_toPropertyKey65(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey65(e){var t=_toPrimitive65(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive65(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet17(e,t){return e.get(_assertClassBrand20(e,t))}function _classPrivateFieldSet14(e,t,r){return e.set(_assertClassBrand20(e,t),r),r}function _assertClassBrand20(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}pluginHooks_default.getSingleton().register("modifyAutoColumnSizeSeed");var PLUGIN_KEY2="autoColumnSize",PLUGIN_PRIORITY=10,COLUMN_SIZE_MAP_NAME="autoColumnSize",_cachedColumnHeaders=new WeakMap,_visualColumnsToRefresh=new WeakMap,_AutoColumnSize_brand=new WeakSet,AutoColumnSize=class En extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY2}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(t){super(t),_classPrivateMethodInitSpec10(this,_AutoColumnSize_brand),_defineProperty65(this,"ghostTable",new ghostTable_default(this.hot)),_defineProperty65(this,"samplesGenerator",new samplesGenerator_default((r,i)=>{const o=this.hot.toPhysicalRow(r),a=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(o)||this.hot.columnIndexMapper.isHidden(a))return!1;const c=this.hot.getCellMeta(r,i);let u="";c.spanned||(u=this.hot.getDataAtCell(r,i));let h="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(h=this.hot.runHooks("modifyAutoColumnSizeSeed",h,c,u)),{value:u,bundleSeed:h}})),_defineProperty65(this,"inProgress",!1),_defineProperty65(this,"measuredColumns",0),_defineProperty65(this,"columnWidthsMap",new PhysicalIndexToValueMap),_classPrivateFieldInitSpec17(this,_cachedColumnHeaders,[]),_classPrivateFieldInitSpec17(this,_visualColumnsToRefresh,[]),this.hot.columnIndexMapper.registerMap(COLUMN_SIZE_MAP_NAME,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,i,o)=>_assertClassBrand20(_AutoColumnSize_brand,this,_onBeforeColumnResize).call(this,r,i,o))}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY2]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var t=this;if(this.enabled)return;const r=this.hot.getSettings()[PLUGIN_KEY2];r&&r.useHeaders!==null&&r.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",r.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _assertClassBrand20(_AutoColumnSize_brand,t,_onAfterLoadData).call(t,...o)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _assertClassBrand20(_AutoColumnSize_brand,t,_onBeforeChange).call(t,...o)}),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _assertClassBrand20(_AutoColumnSize_brand,t,_onAfterFormulasValuesUpdate).call(t,...o)}),this.addHook("beforeRender",()=>_assertClassBrand20(_AutoColumnSize_brand,this,_onBeforeRender).call(this)),this.addHook("modifyColWidth",(i,o)=>this.getColumnWidth(o,i)),this.addHook("init",()=>_assertClassBrand20(_AutoColumnSize_brand,this,_onInit).call(this)),super.enablePlugin()}updatePlugin(){_classPrivateFieldSet14(_visualColumnsToRefresh,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(t,r,i)=>_assertClassBrand20(_AutoColumnSize_brand,this,_onBeforeColumnResize).call(this,t,r,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const t=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();if(t===-1||r===-1)return;const i=this.hot.renderCall;this.calculateColumnsWidth({from:t,to:r},void 0,i)}calculateColumnsWidth(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=typeof t=="number"?{from:t,to:t}:t,a=typeof r=="number"?{from:r,to:r}:r;rangeEach(o.from,o.to,c=>{let u=this.hot.toPhysicalColumn(c);u===null&&(u=c),(i||this.columnWidthsMap.getValueAtIndex(u)===null&&!this.hot._getColWidthFromSettings(u))&&this.samplesGenerator.generateColumnSamples(c,a).forEach((d,f)=>this.ghostTable.addColumn(f,d))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((c,u)=>{const h=this.hot.toPhysicalColumn(c);this.columnWidthsMap.setValueAtIndex(h,u)})},!0),this.measuredColumns=o.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const o=this.hot.countCols()-1;let a=null;this.inProgress=!0;const c=()=>{if(!this.hot){cancelAnimationFrame2(a),this.inProgress=!1;return}this.calculateColumnsWidth({from:i,to:Math.min(i+En.CALCULATION_STEP,o)},t,r),i=i+En.CALCULATION_STEP+1,i<o?a=requestAnimationFrame2(c):(cancelAnimationFrame2(a),this.inProgress=!1,this.hot.view.adjustElementsSize())},u=this.getSyncCalculationLimit();u>=0&&(this.calculateColumnsWidth({from:0,to:u},t,r),i=u+1),i<o?c():this.inProgress=!1}setSamplingOptions(){const t=this.hot.getSettings()[PLUGIN_KEY2],r=t&&hasOwnProperty(t,"samplingRatio")?t.samplingRatio:void 0,i=t&&hasOwnProperty(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),i&&this.samplesGenerator.setAllowDuplicates(i)}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const t=this.hot.getSettings()[PLUGIN_KEY2];let r=En.SYNC_CALCULATION_LIMIT;const i=this.hot.countCols()-1;return isObject2(t)&&(r=t.syncLimit,isPercentValue(r)?r=valueAccordingPercent(i,r):r>>=0),Math.min(r,i)}getColumnWidth(t,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=r;return o===void 0&&(o=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t)),i&&typeof o=="number"&&(o=Math.max(o,DEFAULT_WIDTH))),o}getFirstVisibleColumn(){var t;return(t=this.hot.view.getFirstRenderedVisibleColumn())!==null&&t!==void 0?t:-1}getLastVisibleColumn(){var t;return(t=this.hot.view.getLastRenderedVisibleColumn())!==null&&t!==void 0?t:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((i,o,a)=>{const c=_classPrivateFieldGet17(_cachedColumnHeaders,this).length;return(c-1<a||_classPrivateFieldGet17(_cachedColumnHeaders,this)[a]!==o)&&i.push(this.hot.toVisualColumn(a)),c-1<a?_classPrivateFieldGet17(_cachedColumnHeaders,this).push(o):_classPrivateFieldGet17(_cachedColumnHeaders,this)[a]=o,i},[])}clearCache(t){Array.isArray(t)?this.hot.batchExecution(()=>{t.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(t=>t===null).length}destroy(){this.ghostTable.clean(),super.destroy()}};function _calculateSpecificColumnsWidth(e){const t={from:0,to:this.hot.countRows()-1};e.forEach(r=>{const i=this.hot.toPhysicalColumn(r);i!==null&&(this.hot._getColWidthFromSettings(i)||this.samplesGenerator.generateColumnSamples(r,t).forEach((a,c)=>this.ghostTable.addColumn(c,a)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((r,i)=>{const o=this.hot.toPhysicalColumn(r);this.columnWidthsMap.setValueAtIndex(o,i)})},!0),this.ghostTable.clean())}function _onBeforeRender(){this.calculateVisibleColumnsWidth(),this.inProgress||(_assertClassBrand20(_AutoColumnSize_brand,this,_calculateSpecificColumnsWidth).call(this,_classPrivateFieldGet17(_visualColumnsToRefresh,this)),_classPrivateFieldSet14(_visualColumnsToRefresh,this,[]))}function _onAfterLoadData(e,t){t||this.recalculateAllColumnsWidth()}function _onBeforeChange(e){const t=e.reduce((r,i)=>{let[,o]=i;const a=this.hot.propToCol(o);return Number.isInteger(a)&&r.indexOf(a)===-1&&r.push(a),r},[]);_classPrivateFieldGet17(_visualColumnsToRefresh,this).push(...t)}function _onBeforeColumnResize(e,t,r){let i=e;return r&&(this.calculateColumnsWidth(t,void 0,!0),i=this.getColumnWidth(t,void 0,!1)),i}function _onInit(){_classPrivateFieldSet14(_cachedColumnHeaders,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function _onAfterFormulasValuesUpdate(e){const t=e.reduce((r,i)=>{var o;const a=(o=i.address)===null||o===void 0?void 0:o.col;if(Number.isInteger(a)){const c=this.hot.toVisualColumn(a);r.indexOf(c)===-1&&r.push(c)}return r},[]);_classPrivateFieldGet17(_visualColumnsToRefresh,this).push(...t)}var import_es_error_cause93=__toESM(require_es_error_cause(),1),import_es_array_push48=__toESM(require_es_array_push(),1),DIRECTIONS={horizontal:"horizontal",vertical:"vertical"};function getDragDirectionAndRange(e,t,r){let i,o,a;return t[0]===e[0]&&t[1]<e[1]?(a="left",i=r(t[0],t[1]),o=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(a="right",i=r(t[0],e[3]+1),o=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(a="up",i=r(t[0],t[1]),o=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(a="down",i=r(e[2]+1,t[1]),o=r(t[2],t[3])),i&&i.normalize(),o&&o.normalize(),{directionOfDrag:a,startOfDragCoords:i,endOfDragCoords:o}}function getMappedFillHandleSetting(e){const t={};return e===!0?(t.directions=Object.keys(DIRECTIONS),t.autoInsertRow=!0):isObject2(e)?(isDefined(e.autoInsertRow)?e.direction===DIRECTIONS.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,isDefined(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(DIRECTIONS)):typeof e=="string"?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function _classPrivateMethodInitSpec11(e,t){_checkPrivateRedeclaration21(e,t),t.add(e)}function _checkPrivateRedeclaration21(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty66(e,t,r){return(t=_toPropertyKey66(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey66(e){var t=_toPrimitive66(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive66(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand21(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}pluginHooks_default.getSingleton().register("modifyAutofillRange"),pluginHooks_default.getSingleton().register("beforeAutofill"),pluginHooks_default.getSingleton().register("afterAutofill");var PLUGIN_KEY3="autofill",PLUGIN_PRIORITY2=20,SETTING_KEYS=["fillHandle"],INSERT_ROW_ALTER_ACTION_NAME="insert_row_below",INTERVAL_FOR_ADDING_ROW=200,_Autofill_brand=new WeakSet,Autofill=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec11(this,_Autofill_brand),_defineProperty66(this,"addingStarted",!1),_defineProperty66(this,"mouseDownOnCellCorner",!1),_defineProperty66(this,"mouseDragOutside",!1),_defineProperty66(this,"handleDraggedCells",0),_defineProperty66(this,"directions",[]),_defineProperty66(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY3}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY2}static get SETTING_KEYS(){return[PLUGIN_KEY3,...SETTING_KEYS]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>_assertClassBrand21(_Autofill_brand,this,_onAfterCellCornerMouseDown).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>_assertClassBrand21(_Autofill_brand,this,_onCellCornerDblClick).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,t)=>_assertClassBrand21(_Autofill_brand,this,_onBeforeCellMouseOver).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),a=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:r,endRow:i,endCol:o}]),c=[],u=[],h=[];return arrayEach(a,d=>{for(let f=d.startRow;f<=d.endRow;f+=1)c.indexOf(f)===-1&&c.push(f);for(let f=d.startCol;f<=d.endCol;f+=1)u.indexOf(f)===-1&&u.push(f)}),arrayEach(c,d=>{const f=[];arrayEach(u,m=>{f.push(this.hot.getCopyableData(d,m))}),h.push(f)}),h}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),a=o.getTopStartCorner(),c=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const u=[a.row,a.col,c.row,c.col],h=this.hot.runHooks("modifyAutofillRange",[Math.min(a.row,e),Math.min(a.col,t),Math.max(c.row,r),Math.max(c.col,i)],u),{directionOfDrag:d,startOfDragCoords:f,endOfDragCoords:m}=getDragDirectionAndRange(u,h,(g,v)=>this.hot._createCellCoords(g,v));if(f&&f.row>-1&&f.col>-1){const g=this.getSelectionData(),v=o.clone(),_=this.hot._createCellRange(f,f,m),b=this.hot.runHooks("beforeAutofill",g,v,_,d);if(b===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let S=b;const R=b;if(["up","left"].indexOf(d)>-1&&!(R.length===1&&R[0].length===0))if(S=[],d==="up"){const A=m.row-f.row+1,I=A%R.length;for(let E=0;E<A;E++)S.push(R[(E+(R.length-I))%R.length])}else{const A=m.col-f.col+1,I=A%R[0].length;for(let E=0;E<R.length;E++){S.push([]);for(let O=0;O<A;O++)S[E].push(R[E][(O+(R[E].length-I))%R[E].length])}}this.hot.populateFromArray(f.row,f.col,S,m.row,m.col,`${this.pluginName}.fill`,null),this.setSelection(h),this.hot.runHooks("afterAutofill",S,v,_,d),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),r=t.getBottomEndCorner();let i=e;if(this.directions.includes(DIRECTIONS.vertical)&&this.directions.includes(DIRECTIONS.horizontal)){const o=t.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(DIRECTIONS.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(DIRECTIONS.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(INSERT_ROW_ALTER_ACTION_NAME,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},INTERVAL_FOR_ADDING_ROW)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&t[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let u=e[1];u<=e[3];u++){const h=t[o][u];if(!isEmpty(h))return-1}const a=t[o][e[1]-1],c=t[o][e[3]+1];(!isEmpty(a)||!isEmpty(c))&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...arrayMap(e,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return t===-1||t===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,r=offset(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+outerHeight(this.hot.table),i=offset(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+outerWidth(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand21(_Autofill_brand,this,_onMouseUp).call(this)),this.eventManager.addEventListener(e,"mousemove",t=>_assertClassBrand21(_Autofill_brand,this,_onMouseMove).call(this,t))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=getMappedFillHandleSetting(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}};function _onCellCornerDblClick(){this.selectAdjacent()&&this.fillIn()}function _onAfterCellCornerMouseDown(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function _onBeforeCellMouseOver(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}function _onMouseUp(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function _onMouseMove(e){const t=this.getIfMouseWasDraggedOutside(e);this.addingStarted===!1&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}var import_es_error_cause94=__toESM(require_es_error_cause(),1),import_es_array_push49=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec12(e,t){_checkPrivateRedeclaration22(e,t),t.add(e)}function _classPrivateFieldInitSpec18(e,t,r){_checkPrivateRedeclaration22(e,t),t.set(e,r)}function _checkPrivateRedeclaration22(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty67(e,t,r){return(t=_toPropertyKey67(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey67(e){var t=_toPrimitive67(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive67(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldSet15(e,t,r){return e.set(_assertClassBrand22(e,t),r),r}function _classPrivateFieldGet18(e,t){return e.get(_assertClassBrand22(e,t))}function _assertClassBrand22(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var PLUGIN_KEY4="autoRowSize",PLUGIN_PRIORITY3=40,ROW_WIDTHS_MAP_NAME="autoRowSize",_visualRowsToRefresh=new WeakMap,_AutoRowSize_brand=new WeakSet,AutoRowSize=class xn extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY4}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY3}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(t){super(t),_classPrivateMethodInitSpec12(this,_AutoRowSize_brand),_defineProperty67(this,"headerHeight",null),_defineProperty67(this,"ghostTable",new ghostTable_default(this.hot)),_defineProperty67(this,"samplesGenerator",new samplesGenerator_default((r,i)=>{const o=this.hot.toPhysicalRow(r),a=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(o)||this.hot.columnIndexMapper.isHidden(a)||r>=0&&i>=0&&this.hot.getCellMeta(r,i).hidden)return!1;let c;return r>=0?c=this.hot.getDataAtCell(r,i):r===-1&&(c=this.hot.getColHeader(i)),{value:c}})),_defineProperty67(this,"inProgress",!1),_defineProperty67(this,"measuredRows",0),_defineProperty67(this,"rowHeightsMap",new PhysicalIndexToValueMap),_classPrivateFieldInitSpec18(this,_visualRowsToRefresh,[]),this.hot.rowIndexMapper.registerMap(ROW_WIDTHS_MAP_NAME,this.rowHeightsMap),this.addHook("beforeRowResize",(r,i,o)=>_assertClassBrand22(_AutoRowSize_brand,this,_onBeforeRowResize).call(this,r,i,o))}isEnabled(){const t=this.hot.getSettings()[PLUGIN_KEY4];return t===!0||isObject2(t)}enablePlugin(){var t=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand22(_AutoRowSize_brand,t,_onAfterLoadData2).call(t,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand22(_AutoRowSize_brand,t,_onBeforeChange2).call(t,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand22(_AutoRowSize_brand,t,_onAfterFormulasValuesUpdate2).call(t,...i)}),this.addHook("beforeRender",()=>_assertClassBrand22(_AutoRowSize_brand,this,_onBeforeRender2).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>_assertClassBrand22(_AutoRowSize_brand,this,_onInit2).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(t,r,i)=>_assertClassBrand22(_AutoRowSize_brand,this,_onBeforeRowResize).call(this,t,r,i))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const t=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(t===-1||r===-1)return;const i=this.hot.renderCall;this.calculateRowsHeight({from:t,to:r},void 0,i)}calculateRowsHeight(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=typeof t=="number"?{from:t,to:t}:t,a=typeof r=="number"?{from:r,to:r}:r;if(this.hot.getColHeader(0)!==null){const c=this.samplesGenerator.generateRowSamples(-1,a);this.ghostTable.addColumnHeadersRow(c.get(-1))}rangeEach(o.from,o.to,c=>{let u=this.hot.toPhysicalRow(c);u===null&&(u=c),(i||this.rowHeightsMap.getValueAtIndex(u)===null)&&this.samplesGenerator.generateRowSamples(c,a).forEach((d,f)=>this.ghostTable.addRow(f,d))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((c,u)=>{c<0?this.headerHeight=u:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(c),u)})},!0),this.measuredRows=o.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const o=this.hot.countRows()-1;let a=null;this.inProgress=!0;const c=()=>{if(!this.hot){cancelAnimationFrame2(a),this.inProgress=!1;return}this.calculateRowsHeight({from:i,to:Math.min(i+xn.CALCULATION_STEP,o)},t,r),i=i+xn.CALCULATION_STEP+1,i<o?a=requestAnimationFrame2(c):(cancelAnimationFrame2(a),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},u=this.getSyncCalculationLimit();u>=0&&(this.calculateRowsHeight({from:0,to:u},t,r),i=u+1),i<o?c():(this.inProgress=!1,this.hot.view.adjustElementsSize())}setSamplingOptions(){const t=this.hot.getSettings()[PLUGIN_KEY4],r=t&&hasOwnProperty(t,"samplingRatio")?t.samplingRatio:void 0,i=t&&hasOwnProperty(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),i&&this.samplesGenerator.setAllowDuplicates(i)}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const t=this.hot.getSettings()[PLUGIN_KEY4];let r=xn.SYNC_CALCULATION_LIMIT;const i=this.hot.countRows()-1;return isObject2(t)&&(r=t.syncLimit,isPercentValue(r)?r=valueAccordingPercent(i,r):r>>=0),Math.min(r,i)}getRowHeight(t,r){const i=t<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(t));let o=r;return i!==null&&i>(r||0)&&(o=i),o}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var t;return(t=this.hot.view.getFirstRenderedVisibleRow())!==null&&t!==void 0?t:-1}getLastVisibleRow(){var t;return(t=this.hot.view.getLastRenderedVisibleRow())!==null&&t!==void 0?t:-1}clearCache(t){this.headerHeight=null,Array.isArray(t)?this.hot.batchExecution(()=>{t.forEach(r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(t){const{from:r,to:i}=typeof t=="number"?{from:t,to:t}:t;this.hot.batchExecution(()=>{rangeEach(Math.min(r,i),Math.max(r,i),o=>{this.rowHeightsMap.setValueAtIndex(o,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(t=>t===null).length}destroy(){this.ghostTable.clean(),super.destroy()}};function _calculateSpecificRowsHeight(e){const t={from:0,to:this.hot.countCols()-1};e.forEach(r=>{this.samplesGenerator.generateRowSamples(r,t).forEach((o,a)=>this.ghostTable.addRow(a,o))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((r,i)=>{const o=this.hot.toPhysicalRow(r);this.rowHeightsMap.setValueAtIndex(o,i)})},!0),this.ghostTable.clean())}function _onBeforeRender2(){this.calculateVisibleRowsHeight(),this.inProgress||(_assertClassBrand22(_AutoRowSize_brand,this,_calculateSpecificRowsHeight).call(this,_classPrivateFieldGet18(_visualRowsToRefresh,this)),_classPrivateFieldSet15(_visualRowsToRefresh,this,[]))}function _onBeforeRowResize(e,t,r){let i=e;return r&&(this.calculateRowsHeight(t,void 0,!0),i=this.getRowHeight(t)),i}function _onAfterLoadData2(e,t){t||this.recalculateAllRowsHeight()}function _onBeforeChange2(e){const t=e.reduce((r,i)=>{let[o]=i;return r.indexOf(o)===-1&&r.push(o),r},[]);_classPrivateFieldGet18(_visualRowsToRefresh,this).push(...t)}function _onInit2(){this.recalculateAllRowsHeight()}function _onAfterFormulasValuesUpdate2(e){const t=e.reduce((r,i)=>{var o;const a=(o=i.address)===null||o===void 0?void 0:o.row;if(Number.isInteger(a)){const c=this.hot.toVisualRow(a);r.indexOf(c)===-1&&r.push(c)}return r},[]);_classPrivateFieldGet18(_visualRowsToRefresh,this).push(...t)}var import_es_error_cause95=__toESM(require_es_error_cause(),1),{getListWithInsertedItems:getListWithInsertedItems3,getListWithRemovedItems:getListWithRemovedItems3}=alterUtilsFactory("physicallyIndexed"),LooseBindsMap=class extends IndexMap{constructor(){super(e=>e)}insert(e,t){const r=getIncreasedIndexes(this.indexedValues,t);this.indexedValues=getListWithInsertedItems3(r,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=getListWithRemovedItems3(this.indexedValues,e);this.indexedValues=getDecreasedIndexes(t,e),super.remove(e)}},looseBindsMap_default=LooseBindsMap,{getListWithInsertedItems:getListWithInsertedItems4,getListWithRemovedItems:getListWithRemovedItems4}=alterUtilsFactory("physicallyIndexed"),StrictBindsMap=class extends IndexMap{constructor(){super(e=>e)}insert(e,t){this.indexedValues=getListWithInsertedItems4(this.indexedValues,e,t,(r,i)=>this.getNextValue(i)),super.insert(e,t)}remove(e){this.indexedValues=getListWithRemovedItems4(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}},strictBindsMap_default=StrictBindsMap;function _classPrivateMethodInitSpec13(e,t){_checkPrivateRedeclaration23(e,t),t.add(e)}function _checkPrivateRedeclaration23(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty68(e,t,r){return(t=_toPropertyKey68(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey68(e){var t=_toPrimitive68(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive68(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand23(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var PLUGIN_KEY5="bindRowsWithHeaders",PLUGIN_PRIORITY4=210,DEFAULT_BIND="loose",bindTypeToMapStrategy=new Map([["loose",looseBindsMap_default],["strict",strictBindsMap_default]]),_BindRowsWithHeaders_brand=new WeakSet,BindRowsWithHeaders=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec13(this,_BindRowsWithHeaders_brand),_defineProperty68(this,"headerIndexes",null)}static get PLUGIN_KEY(){return PLUGIN_KEY5}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY4}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY5]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[PLUGIN_KEY5];typeof e!="string"&&(e=DEFAULT_BIND);const t=bindTypeToMapStrategy.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",r=>_assertClassBrand23(_BindRowsWithHeaders_brand,this,_onModifyRowHeader).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}};function _onModifyRowHeader(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}var import_es_error_cause96=__toESM(require_es_error_cause(),1),import_es_array_push50=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec14(e,t){_checkPrivateRedeclaration24(e,t),t.add(e)}function _classPrivateFieldInitSpec19(e,t,r){_checkPrivateRedeclaration24(e,t),t.set(e,r)}function _checkPrivateRedeclaration24(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty69(e,t,r){return(t=_toPropertyKey69(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey69(e){var t=_toPrimitive69(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive69(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet19(e,t){return e.get(_assertClassBrand24(e,t))}function _classPrivateFieldSet16(e,t,r){return e.set(_assertClassBrand24(e,t),r),r}function _assertClassBrand24(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var PLUGIN_KEY6="collapsibleColumns",PLUGIN_PRIORITY5=290,SETTING_KEYS2=["nestedHeaders"],COLLAPSIBLE_ELEMENT_CLASS="collapsibleIndicator",SHORTCUTS_GROUP5=PLUGIN_KEY6,actionDictionary=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),_collapsedColumnsMap=new WeakMap,_CollapsibleColumns_brand=new WeakSet,CollapsibleColumns=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec14(this,_CollapsibleColumns_brand),_defineProperty69(this,"nestedHeadersPlugin",null),_defineProperty69(this,"headerStateManager",null),_classPrivateFieldInitSpec19(this,_collapsedColumnsMap,null)}static get PLUGIN_KEY(){return PLUGIN_KEY6}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY5}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[PLUGIN_KEY6,...SETTING_KEYS2]}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY6]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||warn("You need to configure the Nested Headers plugin in order to use collapsible headers."),_classPrivateFieldSet16(_collapsedColumnsMap,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>_assertClassBrand24(_CollapsibleColumns_brand,this,_onInit3).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand24(_CollapsibleColumns_brand,e,_onAfterLoadData3).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand24(_CollapsibleColumns_brand,e,_onAfterGetColHeader).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>_assertClassBrand24(_CollapsibleColumns_brand,this,_onBeforeOnCellMouseDown).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),_classPrivateFieldSet16(_collapsedColumnsMap,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:t,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:a}=(e=this.headerStateManager.getHeaderTreeNodeData(t,r))!==null&&e!==void 0?e:{};if(i)return o?this.expandSection({row:t,col:a}):this.collapseSection({row:t,col:a}),!1},runOnlyIf:()=>{var e,t;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.highlight.isHeader())},group:SHORTCUTS_GROUP5,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP5)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(a){a&&a.parentNode.removeChild(a)};rangeEach(0,e-1,a=>{const c=t.childNodes[a],u=r.childNodes[a],h=i?i.childNodes[a]:null;rangeEach(0,c.childNodes.length-1,d=>{let f=c.childNodes[d].querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`);o(f),u&&u.childNodes[d]&&(f=u.childNodes[d].querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`),o(f)),i&&h&&h.childNodes[d]&&(f=h.childNodes[d].querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`),o(f))})},!0)}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:a,columnIndex:c,isCollapsed:u}=r;if(i===!0&&o>1&&(u&&e==="expand"||!u&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(a),col:c}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!actionDictionary.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const r=arrayFilter(e,g=>{let{row:v}=g;return v<0});let i=r.length>0;arrayEach(r,g=>{var v;let{row:_,col:b}=g;const{collapsible:S,isCollapsed:R}=(v=this.headerStateManager.getHeaderSettings(_,b))!==null&&v!==void 0?v:{};if(!S||R&&t==="collapse"||!R&&t==="expand")return i=!1,!1});const o=[],a=[];i&&arrayEach(r,g=>{let{row:v,col:_}=g;const{colspanCompensation:b,affectedColumns:S,rollbackModification:R}=this.headerStateManager.triggerNodeModification(t,v,_);b>0&&(a.push(...S),o.push(R))});const c=this.getCollapsedColumns();let u=[];t==="collapse"?u=arrayUnique([...c,...a]):t==="expand"&&(u=arrayFilter(c,g=>!a.includes(g)));const h=actionDictionary.get(t);if(this.hot.runHooks(h.beforeHook,c,u,i)===!1){arrayEach(o,g=>{g()});return}this.hot.batchExecution(()=>{arrayEach(a,g=>{_classPrivateFieldGet19(_collapsedColumnsMap,this).setValueAtIndex(this.hot.toPhysicalColumn(g),h.hideColumn)})},!0);const f=this.getCollapsedColumns().length!==c.length,m=this.hot.getSelectedRangeLast();if(t==="collapse"&&f&&m){const{row:g,col:v}=m.highlight;if((this.hot.rowIndexMapper.isHidden(g)||this.hot.columnIndexMapper.isHidden(v))&&a.includes(v)){const b=g>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(g,1,!0):g,S=v>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(v,1,!0):v;b!==null&&S!==null&&this.hot.selectCell(b,S)}}this.hot.runHooks(h.afterHook,c,u,i,f),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return _classPrivateFieldGet19(_collapsedColumnsMap,this).getHiddenIndexes()}destroy(){_classPrivateFieldSet16(_collapsedColumnsMap,this,null),super.destroy()}};function _onAfterGetColHeader(e,t,r){var i;const{collapsible:o,origColspan:a,isCollapsed:c}=(i=this.headerStateManager.getHeaderSettings(r,e))!==null&&i!==void 0?i:{},u=o&&a>1&&e>=this.hot.getSettings().fixedColumnsStart,h=this.hot.getSettings().ariaTags;let d=t.querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`);if(removeAttribute(t,[A11Y_EXPANDED("")[0]]),u)d||(d=this.hot.rootDocument.createElement("div"),addClass(d,COLLAPSIBLE_ELEMENT_CLASS),t.querySelector("div:first-child").appendChild(d)),removeClass(d,["collapsed","expanded"]),c?(addClass(d,"collapsed"),fastInnerText(d,"+"),h&&setAttribute(t,...A11Y_EXPANDED(!1))):(addClass(d,"expanded"),fastInnerText(d,"-"),h&&setAttribute(t,...A11Y_EXPANDED(!0))),h&&setAttribute(d,...A11Y_HIDDEN());else{var f;(f=d)===null||f===void 0||f.remove()}}function _onBeforeOnCellMouseDown(e,t){hasClass(e.target,COLLAPSIBLE_ELEMENT_CLASS)&&(hasClass(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):hasClass(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),stopImmediatePropagation(e))}function _onInit3(){this.updatePlugin()}function _onAfterLoadData3(e,t){t||this.updatePlugin()}var import_es_error_cause98=__toESM(require_es_error_cause(),1),import_es_array_push52=__toESM(require_es_array_push(),1),import_es_error_cause97=__toESM(require_es_error_cause(),1);function _defineProperty70(e,t,r){return(t=_toPropertyKey70(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey70(e){var t=_toPrimitive70(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive70(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var inheritedColumnProperties=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],SORT_EMPTY_CELLS_DEFAULT=!1,SHOW_SORT_INDICATOR_DEFAULT=!0,HEADER_ACTION_DEFAULT=!0,ColumnStatesManager=class{constructor(e,t){_defineProperty70(this,"hot",void 0),_defineProperty70(this,"sortingStates",new LinkedPhysicalIndexToValueMap),_defineProperty70(this,"sortEmptyCells",SORT_EMPTY_CELLS_DEFAULT),_defineProperty70(this,"indicator",SHOW_SORT_INDICATOR_DEFAULT),_defineProperty70(this,"headerAction",HEADER_ACTION_DEFAULT),_defineProperty70(this,"compareFunctionFactory",void 0),_defineProperty70(this,"mapName",void 0),this.hot=e,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){isObject2(e)&&objectEach(e,(t,r)=>{inheritedColumnProperties.includes(r)&&(this[r]=t)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||t===void 0?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[r]=t;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return isObject2(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(t=>{let[r,i]=t;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(isDefined(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}},import_es_set_difference_v216=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v216=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v216=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v216=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v216=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v216=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v216=__toESM(require_es_set_union_v2(),1),import_moment5=__toESM(require_moment(),1);function compareFunctionFactory(e,t,r){const i=t.locale;return function(o,a){const{sortEmptyCells:c}=r;return typeof o=="string"&&(o=o.toLocaleLowerCase(i)),typeof a=="string"&&(a=a.toLocaleLowerCase(i)),o===a?DO_NOT_SWAP:isEmpty(o)?isEmpty(a)?DO_NOT_SWAP:c&&e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:isEmpty(a)?c&&e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:isNaN(o)&&!isNaN(a)?e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:!isNaN(o)&&isNaN(a)||(isNaN(o)||isNaN(a)||(o=parseFloat(o),a=parseFloat(a)),o<a)?e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:o>a?e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}var COLUMN_DATA_TYPE="default";function compareFunctionFactory2(e,t,r){return function(i,o){const a=parseFloat(i),c=parseFloat(o),{sortEmptyCells:u}=r;if(a===c||isNaN(a)&&isNaN(c))return DO_NOT_SWAP;if(u){if(isEmpty(i))return e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND;if(isEmpty(o))return e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND}return isNaN(a)?FIRST_AFTER_SECOND:isNaN(c)?FIRST_BEFORE_SECOND:a<c?e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:a>c?e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}var COLUMN_DATA_TYPE2="numeric";function compareFunctionFactory3(e,t,r){const i=t.checkedTemplate,o=t.uncheckedTemplate,{sortEmptyCells:a}=r;return function(c,u){const h=isEmpty(c),d=isEmpty(u),f=h?o:c,m=d?o:u,g=f===o||f===i,v=m===o||m===i;if(a===!1){if(h&&d===!1)return FIRST_AFTER_SECOND;if(h===!1&&d)return FIRST_BEFORE_SECOND}return g===!1&&v?e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:g&&v===!1?e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:g===!1&&v===!1?compareFunctionFactory(e,t,r)(c,u):f===o&&m===i?e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:f===i&&m===o?e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}var COLUMN_DATA_TYPE3="checkbox";function compareFunctionFactory4(e,t,r){return createDateTimeCompareFunction(e,t.dateFormat,r)}var COLUMN_DATA_TYPE4="date";function compareFunctionFactory5(e,t,r){return createDateTimeCompareFunction(e,t.timeFormat,r)}var COLUMN_DATA_TYPE5="time",{register:registerCompareFunctionFactory,getItem:getGloballyCompareFunctionFactory,hasItem:hasGloballyCompareFunctionFactory}=staticRegister("sorting.compareFunctionFactory"),{register:registerRootComparator,getItem:getRootComparator}=staticRegister("sorting.mainSortComparator");function getCompareFunctionFactory(e){return hasGloballyCompareFunctionFactory(e)?getGloballyCompareFunctionFactory(e):getGloballyCompareFunctionFactory(COLUMN_DATA_TYPE)}registerCompareFunctionFactory(COLUMN_DATA_TYPE3,compareFunctionFactory3),registerCompareFunctionFactory(COLUMN_DATA_TYPE4,compareFunctionFactory4),registerCompareFunctionFactory(COLUMN_DATA_TYPE,compareFunctionFactory),registerCompareFunctionFactory(COLUMN_DATA_TYPE2,compareFunctionFactory2),registerCompareFunctionFactory(COLUMN_DATA_TYPE5,compareFunctionFactory5);var DO_NOT_SWAP=0,FIRST_BEFORE_SECOND=-1,FIRST_AFTER_SECOND=1;function sort(e,t){const r=getRootComparator(t);for(var i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];e.sort(r(...o))}var ASC_SORT_STATE="asc",DESC_SORT_STATE="desc",HEADER_SPAN_CLASS="colHeader";function isValidColumnState(e){if(isObject2(e)===!1)return!1;const{column:t,sortOrder:r}=e;return Number.isInteger(t)&&[ASC_SORT_STATE,DESC_SORT_STATE].includes(r)}function areValidSortStates(e){if(e.some(r=>isValidColumnState(r)===!1))return!1;const t=e.map(r=>{let{column:i}=r;return i});return new Set(t).size===t.length}function getNextSortOrder(e){if(e!==DESC_SORT_STATE)return e===ASC_SORT_STATE?DESC_SORT_STATE:ASC_SORT_STATE}function getHeaderSpanElement(e){return e.querySelector(`.${HEADER_SPAN_CLASS}`)}function isFirstLevelColumnHeader(e,t){if(e<0||!t.parentNode)return!1;const r=t.parentNode.parentNode.childNodes;return Array.from(r).indexOf(t.parentNode)-r.length===-1}function wasHeaderClickedProperly(e,t,r){return e===-1&&t>=0&&isRightClick(r)===!1}function createDateTimeCompareFunction(e,t,r){return function(i,o){const{sortEmptyCells:a}=r;if(i===o)return DO_NOT_SWAP;if(isEmpty(i))return isEmpty(o)?DO_NOT_SWAP:a&&e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND;if(isEmpty(o))return a&&e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND;const c=(0,import_moment5.default)(i,t),u=(0,import_moment5.default)(o,t);return c.isValid()?u.isValid()?u.isAfter(c)?e==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:u.isBefore(c)?e==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP:FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND}}var import_es_array_push51=__toESM(require_es_array_push(),1),HEADER_CLASS_ASC_SORT="ascending",HEADER_CLASS_DESC_SORT="descending",HEADER_CLASS_INDICATOR_DISABLED="indicatorDisabled",HEADER_SORT_CLASS="columnSorting",HEADER_ACTION_CLASS="sortAction",orderToCssClass=new Map([[ASC_SORT_STATE,HEADER_CLASS_ASC_SORT],[DESC_SORT_STATE,HEADER_CLASS_DESC_SORT]]);function getClassesToAdd(e,t,r,i){const o=[HEADER_SORT_CLASS];if(i&&o.push(HEADER_ACTION_CLASS),r===!1)return o.push(HEADER_CLASS_INDICATOR_DISABLED),o;const a=e.getSortOrderOfColumn(t);return isDefined(a)&&o.push(orderToCssClass.get(a)),o}function getClassesToRemove(){return Array.from(orderToCssClass.values()).concat(HEADER_ACTION_CLASS,HEADER_CLASS_INDICATOR_DISABLED,HEADER_SORT_CLASS)}function rootComparator(e,t){return function(r,i){const[,...o]=r,[,...a]=i;return function(u){const h=e[u],d=t[u],f=o[u],m=a[u],g=d.columnSorting;return(g.compareFunctionFactory?g.compareFunctionFactory:getCompareFunctionFactory(d.type))(h,d,g)(f,m)}(0)}}function _classPrivateMethodInitSpec15(e,t){_checkPrivateRedeclaration25(e,t),t.add(e)}function _checkPrivateRedeclaration25(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty71(e,t,r){return(t=_toPropertyKey71(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey71(e){var t=_toPrimitive71(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive71(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand25(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var PLUGIN_KEY7="columnSorting",PLUGIN_PRIORITY6=50,APPEND_COLUMN_CONFIG_STRATEGY="append",REPLACE_COLUMN_CONFIG_STRATEGY="replace",SHORTCUTS_GROUP6=PLUGIN_KEY7;registerRootComparator(PLUGIN_KEY7,rootComparator),pluginHooks_default.getSingleton().register("beforeColumnSort"),pluginHooks_default.getSingleton().register("afterColumnSort");var _ColumnSorting_brand=new WeakSet,ColumnSorting=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec15(this,_ColumnSorting_brand),_defineProperty71(this,"columnStatesManager",null),_defineProperty71(this,"columnMetaCache",null),_defineProperty71(this,"pluginKey",PLUGIN_KEY7),_defineProperty71(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return PLUGIN_KEY7}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY6}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new ColumnStatesManager(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new PhysicalIndexToValueMap(t=>{let r=this.hot.toVisualColumn(t);return r===null&&(r=t),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,r)=>_assertClassBrand25(_ColumnSorting_brand,this,_onAfterGetColHeader2).call(this,t,r)),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand25(_ColumnSorting_brand,e,_onBeforeOnCellMouseDown2).call(e,...r)}),this.addHook("afterOnCellMouseDown",(t,r)=>this.onAfterOnCellMouseDown(t,r)),this.addHook("afterInit",()=>_assertClassBrand25(_ColumnSorting_brand,this,_loadOrSortBySettings).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand25(_ColumnSorting_brand,e,_onAfterLoadData4).call(e,...r)}),this.hot.view&&_assertClassBrand25(_ColumnSorting_brand,this,_loadOrSortBySettings).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(t,r)=>{const i=getHeaderSpanElement(r);isFirstLevelColumnHeader(t,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,t;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:EDITOR_EDIT_GROUP,position:"before",group:SHORTCUTS_GROUP6})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP6)}sort(e){const t=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",t,r,i)!==!1&&(t.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new IndexesSequence),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",t,i?r:t,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return isDefined(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return areValidSortStates(e)&&e.every(r=>{let{column:i}=r;return i<=t&&i>=0})}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...a}=i;return{column:this.hot.toPhysicalColumn(o),...a}};t.initialConfig=arrayMap(e,r),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,r=i=>{let{column:o,...a}=i;return{column:this.hot.toVisualColumn(o),...a}};return isDefined(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=arrayMap(t.initialConfig,r)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(isDefined(t)){const i=getNextSortOrder(t);return isDefined(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:getNextSortOrder()}}getNextSortConfig(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:APPEND_COLUMN_CONFIG_STRATEGY;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),a=this.getColumnNextConfig(e);if(i){if(isUndefined(a))return[...o.slice(0,r),...o.slice(r+1)];if(t===APPEND_COLUMN_CONFIG_STRATEGY)return[...o.slice(0,r),...o.slice(r+1),a];if(t===REPLACE_COLUMN_CONFIG_STRATEGY)return[...o.slice(0,r),a,...o.slice(r+1)]}return isDefined(a)?o.concat(a):o}getPluginColumnConfig(e){if(isObject2(e)){const t=e[this.pluginKey];if(isObject2(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,t,this.getPluginColumnConfig(o.columns[e])):isFunction2(o.columns)?Object.assign(r,t,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),r=Object.create(t);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const t=[],r=this.hot.countRows(),i=h=>arrayMap(e,d=>this.hot.getDataAtCell(h,d.column));for(let h=0;h<this.getNumberOfRowsToSort(r);h+=1)t.push([this.hot.toPhysicalRow(h)].concat(i(h)));const o=arrayMap(t,h=>h[0]);sort(t,this.pluginKey,arrayMap(e,h=>h.sortOrder),arrayMap(e,h=>this.getFirstCellSettings(h.column)));for(let h=t.length;h<r;h+=1)t.push([h].concat(i(h)));const a=arrayMap(t,h=>h[0]),c=new Map(arrayMap(o,(h,d)=>[h,a[d]])),u=arrayMap(this.hot.rowIndexMapper.getIndexesSequence(),h=>c.has(h)?c.get(h):h);this.hot.rowIndexMapper.setIndexesSequence(u)}sortBySettings(e){if(isObject2(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||isObject2(t))&&this.sort(t)}else this.hot.render()}updateHeaderClasses(e){if(removeClass(e,getClassesToRemove(e)),this.enabled!==!1){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];addClass(e,getClassesToAdd(...r))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),isDefined(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&hasClass(e.target,HEADER_SPAN_CLASS)}onAfterOnCellMouseDown(e,t){if(wasHeaderClickedProperly(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(t.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}};function _loadOrSortBySettings(){const e=this.getAllSavedSortSettings();if(isObject2(e))this.sortBySettings(e);else{const t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}function _onAfterGetColHeader2(e,t){const r=getHeaderSpanElement(t);if(isFirstLevelColumnHeader(e,t)===!1||r===null)return;const i=this.getFirstCellSettings(e)[this.pluginKey],o=i.indicator,a=i.headerAction;if(this.updateHeaderClasses(r,this.columnStatesManager,e,o,a),this.hot.getSettings().ariaTags){const c=this.columnStatesManager.getSortOrderOfColumn(e);setAttribute(t,...A11Y_SORT(c?`${c}ending`:"none"))}}function _onAfterLoadData4(e){e===!0&&this.hot.view&&_assertClassBrand25(_ColumnSorting_brand,this,_loadOrSortBySettings).call(this)}function _onBeforeOnCellMouseDown2(e,t,r,i){wasHeaderClickedProperly(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(i.column=!0)}var import_es_error_cause100=__toESM(require_es_error_cause(),1),import_es_error_cause99=__toESM(require_es_error_cause(),1),import_es_array_push53=__toESM(require_es_array_push(),1);function _defineProperty72(e,t,r){return(t=_toPropertyKey72(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey72(e){var t=_toPrimitive72(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive72(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Endpoints=class{constructor(e,t){_defineProperty72(this,"plugin",void 0),_defineProperty72(this,"hot",void 0),_defineProperty72(this,"endpoints",[]),_defineProperty72(this,"settings",void 0),_defineProperty72(this,"settingsType","array"),_defineProperty72(this,"currentEndpoint",null),_defineProperty72(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=t}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),arrayEach(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),t.push(o)}),t}assignSetting(e,t,r,i){if(r==="ranges"&&e[r]===void 0){t[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;t[r]=i}else r==="destinationRow"&&t.reversedRowCoords?t[r]=this.hot.countRows()-e[r]-1:t[r]=e[r]}resetSetupBeforeStructureAlteration(e,t,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();arrayEach(o,a=>{i==="row"&&a.destinationRow>=t&&(e==="insert_row"?a.alterRowOffset=r:e==="remove_row"&&(a.alterRowOffset=-1*r)),i==="col"&&a.destinationColumn>=t&&(e==="insert_col"?a.alterColumnOffset=r:e==="remove_col"&&(a.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,t,r,i,o){let a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const m=()=>(this.hot.removeHook("beforeViewRender",m),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",m);return}const c=e.indexOf("row")>-1?"row":"col",u=e.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),d=e.indexOf("move_row")===0,f=t;arrayEach(h,m=>{c==="row"&&m.destinationRow>=f&&(m.alterRowOffset=u*r),c==="col"&&m.destinationColumn>=f&&(m.alterColumnOffset=u*r)}),this.resetAllEndpoints(h,!d),d?arrayEach(h,m=>{this.extendEndpointRanges(m,f,i[0],i.length),this.recreatePhysicalRanges(m),this.clearOffsetInformation(m)}):arrayEach(h,m=>{this.shiftEndpointCoordinates(m,f)}),a&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,r,i){arrayEach(e.ranges,o=>{o[1]&&(t>=o[0]&&t<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,t<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const t=e.ranges,r=[],i=[];arrayEach(t,o=>{const a=[];if(o[1])for(let c=o[0];c<=o[1];c++)a.push(this.hot.toPhysicalRow(c));else a.push(this.hot.toPhysicalRow(o[0]));i.push(a)}),arrayEach(i,o=>{let a=[];arrayEach(o,(c,u)=>{u===0?a.push(c):o[u]!==o[u-1]+1&&(a.push(o[u-1]),r.push(a),a=[],a.push(c)),u===o.length-1&&(a.push(c),r.push(a))})}),e.ranges=r}shiftEndpointCoordinates(e,t){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,arrayEach(e.ranges,r=>{arrayEach(r,(i,o)=>{i>=t&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,a=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+a>=this.hot.countCols()})||(this.cellsToSetCache=[],arrayEach(e,i=>{this.resetEndpointValue(i,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],arrayEach(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],arrayEach(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&arrayEach(this.getAllEndpoints(),(a,c)=>{this.hot.propToCol(o[i][1])===a.sourceColumn&&t.indexOf(c)===-1&&t.push(c)})}),arrayEach(t,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const t=this.hot.toVisualRow(e.destinationRow);if(t!==null){const r=this.hot.getCellMeta(t,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?r:0)),this.hot.toVisualColumn(e.destinationColumn+(t?i:0)),""])}setEndpointValue(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const a=this.hot.getCellMeta(o,e.destinationColumn);(t==="init"||a.readOnly!==e.readOnly)&&(a.readOnly=e.readOnly,a.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const a=e.roundFloat;let c=0;Number.isInteger(a)&&(c=Math.min(Math.max(0,a),100)),e.result=e.result.toFixed(c)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){warn("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}},endpoints_default=Endpoints;function isNullishOrNaN(e){return e==null||isNaN(e)}function _classPrivateMethodInitSpec16(e,t){_checkPrivateRedeclaration26(e,t),t.add(e)}function _checkPrivateRedeclaration26(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty73(e,t,r){return(t=_toPropertyKey73(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey73(e){var t=_toPrimitive73(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive73(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand26(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var PLUGIN_KEY8="columnSummary",PLUGIN_PRIORITY7=220,_ColumnSummary_brand=new WeakSet,ColumnSummary=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec16(this,_ColumnSummary_brand),_defineProperty73(this,"endpoints",null)}static get PLUGIN_KEY(){return PLUGIN_KEY8}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY7}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY8]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[PLUGIN_KEY8],this.endpoints=new endpoints_default(this,this.settings),this.addHook("afterInit",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand26(_ColumnSummary_brand,e,_onAfterInit).call(e,...r)}),this.addHook("afterChange",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand26(_ColumnSummary_brand,e,_onAfterChange).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand26(_ColumnSummary_brand,e,_onAfterUpdateSettings).call(e,...r)}),this.addHook("beforeCreateRow",(t,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,r,null,i)),this.addHook("beforeCreateCol",(t,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(t,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,r,null,i)),this.addHook("afterCreateCol",(t,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,r,null,i)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand26(_ColumnSummary_brand,e,_onAfterRowMove).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break;default:break}}calculateSum(e){let t=0;return objectEach(e.ranges,r=>{t+=this.getPartialSum(r,e.sourceColumn)}),t}getPartialSum(e,t){let r=0,i=e[1]||e[0],o=null,a=0;do{if(o=this.getCellValue(i,t),o=isNullishOrNaN(o)?null:o,o!==null){const c=(`${o}`.split(".")[1]||[]).length||1;c>a&&(a=c)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**a)/10**a}calculateMinMax(e,t){let r=null;return objectEach(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,t);if(r===null&&o!==null&&(r=o),o!==null)switch(t){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break;default:break}}),r===null?"Not enough data":r}getPartialMinMax(e,t,r){let i=null,o=e[1]||e[0],a;do{if(a=this.getCellValue(o,t),a=isNullishOrNaN(a)?null:a,i===null)i=a;else if(a!==null)switch(r){case"min":i=Math.min(i,a);break;case"max":i=Math.max(i,a);break;default:break}o-=1}while(o>=e[0]);return i}countEmpty(e,t){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,t),r=isNullishOrNaN(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let t=0;const r=e.ranges;return objectEach(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,a=this.countEmpty(i,e.sourceColumn);t+=o,t-=a}),t}calculateAverage(e){const t=this.calculateSum(e),r=this.countEntries(e);return t/r}getCellValue(e,t){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(t);let o=this.hot.getSourceDataAtCell(e,t),a="";if(r!==null&&i!==null&&(a=this.hot.getCellMeta(r,i).className||""),a.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(toSingleLine`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}};function _onAfterInit(){this.endpoints.initEndpoints()}function _onAfterUpdateSettings(e){e.columns!==void 0&&this.endpoints.refreshCellMetas()}function _onAfterChange(e,t){e&&t!=="ColumnSummary.reset"&&t!=="ColumnSummary.set"&&t!=="loadData"&&this.endpoints.refreshChangedEndpoints(e)}function _onAfterRowMove(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}var import_es_error_cause104=__toESM(require_es_error_cause(),1),import_es_array_push54=__toESM(require_es_array_push(),1),import_es_error_cause102=__toESM(require_es_error_cause(),1),import_es_error_cause101=__toESM(require_es_error_cause(),1);function _classPrivateMethodInitSpec17(e,t){_checkPrivateRedeclaration27(e,t),t.add(e)}function _classPrivateFieldInitSpec20(e,t,r){_checkPrivateRedeclaration27(e,t),t.set(e,r)}function _checkPrivateRedeclaration27(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet20(e,t){return e.get(_assertClassBrand27(e,t))}function _classPrivateFieldSet17(e,t,r){return e.set(_assertClassBrand27(e,t),r),r}function _assertClassBrand27(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _ignoreInitialCall=new WeakMap,_observedElement=new WeakMap,_observer=new WeakMap,_EditorResizeObserver_brand=new WeakSet,EditorResizeObserver=class{constructor(){_classPrivateMethodInitSpec17(this,_EditorResizeObserver_brand),_classPrivateFieldInitSpec20(this,_ignoreInitialCall,!0),_classPrivateFieldInitSpec20(this,_observedElement,null),_classPrivateFieldInitSpec20(this,_observer,new ResizeObserver(e=>_assertClassBrand27(_EditorResizeObserver_brand,this,_onResize).call(this,e)))}setObservedElement(e){_classPrivateFieldSet17(_observedElement,this,e)}unobserve(){_classPrivateFieldGet20(_observer,this).unobserve(_classPrivateFieldGet20(_observedElement,this))}observe(){_classPrivateFieldSet17(_ignoreInitialCall,this,!0),_classPrivateFieldGet20(_observer,this).observe(_classPrivateFieldGet20(_observedElement,this))}destroy(){_classPrivateFieldGet20(_observer,this).disconnect()}};function _onResize(e){if(_classPrivateFieldGet20(_ignoreInitialCall,this)||!Array.isArray(e)||!e.length){_classPrivateFieldSet17(_ignoreInitialCall,this,!1);return}e.forEach(t=>{let{borderBoxSize:r}=t;const{inlineSize:i,blockSize:o}=r[0];this.runLocalHooks("resize",i,o)})}mixin(EditorResizeObserver,localHooks_default);function _classPrivateFieldInitSpec21(e,t,r){_checkPrivateRedeclaration28(e,t),t.set(e,r)}function _checkPrivateRedeclaration28(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet21(e,t){return e.get(_assertClassBrand28(e,t))}function _classPrivateFieldSet18(e,t,r){return e.set(_assertClassBrand28(e,t),r),r}function _assertClassBrand28(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _rootDocument=new WeakMap,_isRtl3=new WeakMap,_container=new WeakMap,_editor=new WeakMap,_editorStyle=new WeakMap,_hidden=new WeakMap,_resizeObserver=new WeakMap,CommentEditor=class Jr{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(t,r){var i=this;_classPrivateFieldInitSpec21(this,_rootDocument,void 0),_classPrivateFieldInitSpec21(this,_isRtl3,!1),_classPrivateFieldInitSpec21(this,_container,null),_classPrivateFieldInitSpec21(this,_editor,void 0),_classPrivateFieldInitSpec21(this,_editorStyle,void 0),_classPrivateFieldInitSpec21(this,_hidden,!0),_classPrivateFieldInitSpec21(this,_resizeObserver,new EditorResizeObserver),_classPrivateFieldSet18(_rootDocument,this,t),_classPrivateFieldSet18(_isRtl3,this,r),_classPrivateFieldSet18(_editor,this,this.createEditor()),_classPrivateFieldSet18(_editorStyle,this,_classPrivateFieldGet21(_editor,this).style),_classPrivateFieldGet21(_resizeObserver,this).setObservedElement(this.getInputElement()),_classPrivateFieldGet21(_resizeObserver,this).addLocalHook("resize",function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return i.runLocalHooks("resize",...a)}),this.hide()}setPosition(t,r){_classPrivateFieldGet21(_editorStyle,this).left=`${t}px`,_classPrivateFieldGet21(_editorStyle,this).top=`${r}px`}setSize(t,r){if(t&&r){const i=this.getInputElement();i.style.width=`${t}px`,i.style.height=`${r}px`}}getSize(){return{width:outerWidth(this.getInputElement()),height:outerHeight(this.getInputElement())}}observeSize(){_classPrivateFieldGet21(_resizeObserver,this).observe()}resetSize(){const t=this.getInputElement();t.style.width="",t.style.height=""}setReadOnlyState(t){const r=this.getInputElement();r.readOnly=t}show(){_classPrivateFieldGet21(_editorStyle,this).display="block",_classPrivateFieldSet18(_hidden,this,!1)}hide(){_classPrivateFieldGet21(_resizeObserver,this).unobserve(),_classPrivateFieldGet21(_hidden,this)||(_classPrivateFieldGet21(_editorStyle,this).display="none"),_classPrivateFieldSet18(_hidden,this,!0)}isVisible(){return _classPrivateFieldGet21(_editorStyle,this).display==="block"}setValue(){const r=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=r}getValue(){return this.getInputElement().value}isFocused(){return _classPrivateFieldGet21(_rootDocument,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const t=_classPrivateFieldGet21(_rootDocument,this).createElement("div"),r=_classPrivateFieldGet21(_rootDocument,this).createElement("textarea");return t.style.display="none",_classPrivateFieldSet18(_container,this,_classPrivateFieldGet21(_rootDocument,this).createElement("div")),_classPrivateFieldGet21(_container,this).setAttribute("dir",_classPrivateFieldGet21(_isRtl3,this)?"rtl":"ltr"),addClass(_classPrivateFieldGet21(_container,this),Jr.CLASS_EDITOR_CONTAINER),_classPrivateFieldGet21(_rootDocument,this).body.appendChild(_classPrivateFieldGet21(_container,this)),addClass(t,Jr.CLASS_EDITOR),addClass(r,Jr.CLASS_INPUT),r.setAttribute("data-hot-input",!0),t.appendChild(r),_classPrivateFieldGet21(_container,this).appendChild(t),t}getInputElement(){return _classPrivateFieldGet21(_editor,this).querySelector(`.${Jr.CLASS_INPUT}`)}destroy(){const t=_classPrivateFieldGet21(_container,this)?_classPrivateFieldGet21(_container,this).parentNode:null;_classPrivateFieldGet21(_editor,this).parentNode.removeChild(_classPrivateFieldGet21(_editor,this)),_classPrivateFieldSet18(_editor,this,null),_classPrivateFieldSet18(_editorStyle,this,null),_classPrivateFieldGet21(_resizeObserver,this).destroy(),t&&t.removeChild(_classPrivateFieldGet21(_container,this))}};mixin(CommentEditor,localHooks_default);var commentEditor_default=CommentEditor,import_es_error_cause103=__toESM(require_es_error_cause(),1);function _defineProperty74(e,t,r){return(t=_toPropertyKey74(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey74(e){var t=_toPrimitive74(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive74(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DEFAULT_DISPLAY_DELAY=250,DEFAULT_HIDE_DELAY=250,DisplaySwitch=class{constructor(e){_defineProperty74(this,"wasLastActionShow",!0),_defineProperty74(this,"showDebounced",null),_defineProperty74(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},DEFAULT_HIDE_DELAY)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:DEFAULT_DISPLAY_DELAY;this.showDebounced=debounce2(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},e)}destroy(){this.clearLocalHooks()}};mixin(DisplaySwitch,localHooks_default);var displaySwitch_default=DisplaySwitch;function prepareVerticalAlignClass(e,t){return e.indexOf(t)!==-1?e:`${e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${t}`}function prepareHorizontalAlignClass(e,t){return e.indexOf(t)!==-1?e:`${e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${t}`}function getAlignmentClasses(e,t){const r={};return arrayEach(e,i=>{i.forAll((o,a)=>{o>=0&&a>=0&&(r[o]||(r[o]=[]),r[o][a]=t(o,a))})}),r}function align(e,t,r,i,o){arrayEach(e,a=>{a.forAll((c,u)=>{c>=0&&u>=0&&applyAlignClassName(c,u,t,r,i,o)})})}function applyAlignClassName(e,t,r,i,o,a){const c=o(e,t);let u=i;c.className&&(r==="vertical"?u=prepareVerticalAlignClass(c.className,i):u=prepareHorizontalAlignClass(c.className,i)),a(e,t,"className",u)}function markLabelAsSelected(e){return`<span class="selected">\u2713</span>${e}`}function checkSelectionConsistency(e,t){let r=!1;return Array.isArray(e)&&arrayEach(e,i=>(i.forAll((o,a)=>{if(o>=0&&a>=0&&t(o,a))return r=!0,!1}),r)),r}function getDocumentOffsetByElement(e,t){const r={top:0,left:0};if(t!==e.ownerDocument){const{frameElement:i}=t.defaultView,{top:o,left:a}=i.getBoundingClientRect();r.top=o,r.left=a}return r}function getAlignmentComparatorByClass(e){return function(t,r){const i=this.getCellMeta(t,r).className;return i&&i.indexOf(e)!==-1}}function hasSelectionAClass(e,t){return checkSelectionConsistency(e.getSelectedRange(),getAlignmentComparatorByClass(t).bind(e))}var KEY="---------";function separatorItem(){return{name:KEY}}var KEY2="alignment";function alignmentItem(){return{key:KEY2,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${KEY2}:left`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_LEFT)},ariaChecked(){return hasSelectionAClass(this,"htLeft")},name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_LEFT);return hasSelectionAClass(this,"htLeft")&&(e=markLabelAsSelected(e)),e},callback(){const e=this.getSelectedRange(),t=getAlignmentClasses(e,(o,a)=>this.getCellMeta(o,a).className),r="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",t,e,r,i),align(e,r,i,(o,a)=>this.getCellMeta(o,a),(o,a,c,u)=>this.setCellMeta(o,a,c,u)),this.render()},disabled:!1},{key:`${KEY2}:center`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_CENTER)},ariaChecked(){return hasSelectionAClass(this,"htCenter")},name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_CENTER);return hasSelectionAClass(this,"htCenter")&&(e=markLabelAsSelected(e)),e},callback(){const e=this.getSelectedRange(),t=getAlignmentClasses(e,(o,a)=>this.getCellMeta(o,a).className),r="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",t,e,r,i),align(e,r,i,(o,a)=>this.getCellMeta(o,a),(o,a,c,u)=>this.setCellMeta(o,a,c,u)),this.render()},disabled:!1},{key:`${KEY2}:right`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT)},ariaChecked(){return hasSelectionAClass(this,"htRight")},name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT);return hasSelectionAClass(this,"htRight")&&(e=markLabelAsSelected(e)),e},callback(){const e=this.getSelectedRange(),t=getAlignmentClasses(e,(o,a)=>this.getCellMeta(o,a).className),r="horizontal",i="htRight";this.runHooks("beforeCellAlignment",t,e,r,i),align(e,r,i,(o,a)=>this.getCellMeta(o,a),(o,a,c,u)=>this.setCellMeta(o,a,c,u)),this.render()},disabled:!1},{key:`${KEY2}:justify`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY)},ariaChecked(){return hasSelectionAClass(this,"htJustify")},name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY);return hasSelectionAClass(this,"htJustify")&&(e=markLabelAsSelected(e)),e},callback(){const e=this.getSelectedRange(),t=getAlignmentClasses(e,(o,a)=>this.getCellMeta(o,a).className),r="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",t,e,r,i),align(e,r,i,(o,a)=>this.getCellMeta(o,a),(o,a,c,u)=>this.setCellMeta(o,a,c,u)),this.render()},disabled:!1},{name:KEY},{key:`${KEY2}:top`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_TOP)},ariaChecked(){return hasSelectionAClass(this,"htTop")},name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_TOP);return hasSelectionAClass(this,"htTop")&&(e=markLabelAsSelected(e)),e},callback(){const e=this.getSelectedRange(),t=getAlignmentClasses(e,(o,a)=>this.getCellMeta(o,a).className),r="vertical",i="htTop";this.runHooks("beforeCellAlignment",t,e,r,i),align(e,r,i,(o,a)=>this.getCellMeta(o,a),(o,a,c,u)=>this.setCellMeta(o,a,c,u)),this.render()},disabled:!1},{key:`${KEY2}:middle`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE)},ariaChecked(){return hasSelectionAClass(this,"htMiddle")},name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE);return hasSelectionAClass(this,"htMiddle")&&(e=markLabelAsSelected(e)),e},callback(){const e=this.getSelectedRange(),t=getAlignmentClasses(e,(o,a)=>this.getCellMeta(o,a).className),r="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",t,e,r,i),align(e,r,i,(o,a)=>this.getCellMeta(o,a),(o,a,c,u)=>this.setCellMeta(o,a,c,u)),this.render()},disabled:!1},{key:`${KEY2}:bottom`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM)},ariaChecked(){return hasSelectionAClass(this,"htBottom")},name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM);return hasSelectionAClass(this,"htBottom")&&(e=markLabelAsSelected(e)),e},callback(){const e=this.getSelectedRange(),t=getAlignmentClasses(e,(o,a)=>this.getCellMeta(o,a).className),r="vertical",i="htBottom";this.runHooks("beforeCellAlignment",t,e,r,i),align(e,r,i,(o,a)=>this.getCellMeta(o,a),(o,a,c,u)=>this.setCellMeta(o,a,c,u)),this.render()},disabled:!1}]}}}var KEY3="clear_column";function clearColumnItem(){return{key:KEY3,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback(e,t){const r=t[0].start.col,i=t[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(t[0].start.row,t[0].end.row),i,"ContextMenu.clearColumn")},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()&&e.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}var KEY4="col_left";function columnLeftItem(){return{key:KEY4,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_INSERT_LEFT)},callback(){const e=this.getSelectedRangeLast().getTopLeftCorner(),t=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(t,e.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()&&e.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}var KEY5="col_right";function columnRightItem(){return{key:KEY5,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback(){const e=this.getSelectedRangeLast().getTopRightCorner(),t=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(t,e.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()&&e.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}var KEY6="make_read_only";function readOnlyItem(){return{key:KEY6,checkable:!0,ariaChecked(){return checkSelectionConsistency(this.getSelectedRange(),(t,r)=>this.getCellMeta(t,r).readOnly)},ariaLabel(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY)},name(){let e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY);return checkSelectionConsistency(this.getSelectedRange(),(r,i)=>this.getCellMeta(r,i).readOnly)&&(e=markLabelAsSelected(e)),e},callback(){const e=this.getSelectedRange(),t=checkSelectionConsistency(e,(r,i)=>this.getCellMeta(r,i).readOnly);arrayEach(e,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&this.setCellMeta(i,o,"readOnly",!t)})}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var KEY7="redo";function redoItem(){return{key:KEY7,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REDO)},callback(){this.redo()},hidden(){const e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}var KEY8="remove_col";function removeColumnItem(){return{key:KEY8,name(){const e=this.getSelected();let t=0;if(e)if(e.length>1)t=1;else{const[,r,,i]=e[0];r-i!==0&&(t=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_COLUMN,t)},callback(){this.alter("remove_col",transformSelectionToColumnDistance(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader()&&e.highlight.col<0)return!0;const t=this.countCols();return this.selection.isSelectedByCorner()?t===0:this.selection.isSelectedByRowHeader()||t===0},hidden(){return!this.getSettings().allowRemoveColumn}}}var KEY9="remove_row";function removeRowItem(){return{key:KEY9,name(){const e=this.getSelected();let t=0;if(e)if(e.length>1)t=1;else{const[r,,i]=e[0];r-i!==0&&(t=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_ROW,t)},callback(){this.alter("remove_row",transformSelectionToRowDistance(this),1,"ContextMenu.removeRow")},disabled(){const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader()&&e.highlight.row<0)return!0;const t=this.countRows();return this.selection.isSelectedByCorner()?t===0:this.selection.isSelectedByColumnHeader()||t===0},hidden(){return!this.getSettings().allowRemoveRow}}}var KEY10="row_above";function rowAboveItem(){return{key:KEY10,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ROW_ABOVE)},callback(){const e=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",e.row,1,"ContextMenu.rowAbove")},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()&&e.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}var KEY11="row_below";function rowBelowItem(){return{key:KEY11,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ROW_BELOW)},callback(){const e=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",e.row,1,"ContextMenu.rowBelow")},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()&&e.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}var KEY12="no_items";function noItemsItem(){return{key:KEY12,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}}var KEY13="undo";function undoItem(){return{key:KEY13,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNDO)},callback(){this.undo()},hidden(){const e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}var ITEMS=[KEY10,KEY11,KEY4,KEY5,KEY3,KEY9,KEY8,KEY13,KEY7,KEY6,KEY2,KEY,KEY12],_predefinedItems={[KEY]:separatorItem,[KEY12]:noItemsItem,[KEY10]:rowAboveItem,[KEY11]:rowBelowItem,[KEY4]:columnLeftItem,[KEY5]:columnRightItem,[KEY3]:clearColumnItem,[KEY9]:removeRowItem,[KEY8]:removeColumnItem,[KEY13]:undoItem,[KEY7]:redoItem,[KEY6]:readOnlyItem,[KEY2]:alignmentItem};function predefinedItems(){const e={};return objectEach(_predefinedItems,(t,r)=>{e[r]=t()}),e}function addEditCommentItem(e){return{key:"commentsAddEdit",name(){var t;const r=(t=this.getSelectedRangeLast())===null||t===void 0?void 0:t.highlight;return r!=null&&r.isCell()&&e.getCommentAtCell(r.row,r.col)?this.getTranslatedPhrase(CONTEXTMENU_ITEMS_EDIT_COMMENT):this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ADD_COMMENT)},callback(){const t=this.getSelectedRangeLast();e.setRange(t),e.show(),e.focusEditor()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function removeCommentItem(e){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback(){this.getSelectedRangeLast().forAll((r,i)=>{r>=0&&i>=0&&e.removeCommentAtCell(r,i,!1)}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function readOnlyCommentItem(e){return{key:"commentsReadOnly",name(){const t=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);return checkSelectionConsistency(this.getSelectedRange(),(i,o)=>e.getCommentMeta(i,o,META_READONLY))?markLabelAsSelected(t):t},callback(){this.getSelectedRangeLast().forAll((r,i)=>{if(r>=0&&i>=0){const o=!!e.getCommentMeta(r,i,META_READONLY);e.updateCommentMeta(r,i,{[META_READONLY]:!o})}})},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||!e.getCommentAtCell(t.highlight.row,t.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function _classPrivateMethodInitSpec18(e,t){_checkPrivateRedeclaration29(e,t),t.add(e)}function _classPrivateFieldInitSpec22(e,t,r){_checkPrivateRedeclaration29(e,t),t.set(e,r)}function _checkPrivateRedeclaration29(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty75(e,t,r){return(t=_toPropertyKey75(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey75(e){var t=_toPrimitive75(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive75(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldSet19(e,t,r){return e.set(_assertClassBrand29(e,t),r),r}function _classPrivateFieldGet22(e,t){return e.get(_assertClassBrand29(e,t))}function _assertClassBrand29(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var PLUGIN_KEY9="comments",PLUGIN_PRIORITY8=60,META_COMMENT="comment",META_COMMENT_VALUE="value",META_STYLE="style",META_READONLY="readOnly",SHORTCUTS_GROUP7=PLUGIN_KEY9,SHORTCUTS_CONTEXT_NAME=`plugin:${PLUGIN_KEY9}`,_editor2=new WeakMap,_displaySwitch=new WeakMap,_preventEditorAutoSwitch=new WeakMap,_preventEditorHiding=new WeakMap,_cellBelowCursor=new WeakMap,_commentValueBeforeSave=new WeakMap,_Comments_brand=new WeakSet,Comments=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec18(this,_Comments_brand),_defineProperty75(this,"range",{}),_classPrivateFieldInitSpec22(this,_editor2,null),_classPrivateFieldInitSpec22(this,_displaySwitch,null),_classPrivateFieldInitSpec22(this,_preventEditorAutoSwitch,!1),_classPrivateFieldInitSpec22(this,_preventEditorHiding,!1),_classPrivateFieldInitSpec22(this,_cellBelowCursor,null),_classPrivateFieldInitSpec22(this,_commentValueBeforeSave,"")}static get PLUGIN_KEY(){return PLUGIN_KEY9}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY8}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY9]}enablePlugin(){var e=this;this.enabled||(_classPrivateFieldGet22(_editor2,this)||(_classPrivateFieldSet19(_editor2,this,new commentEditor_default(this.hot.rootDocument,this.hot.isRtl())),_classPrivateFieldGet22(_editor2,this).addLocalHook("resize",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand29(_Comments_brand,e,_onEditorResize).call(e,...r)})),_classPrivateFieldGet22(_displaySwitch,this)||_classPrivateFieldSet19(_displaySwitch,this,new displaySwitch_default(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",t=>this.addToContextMenu(t)),this.addHook("afterRenderer",(t,r,i,o,a,c)=>_assertClassBrand29(_Comments_brand,this,_onAfterRenderer).call(this,t,c)),this.addHook("afterScroll",()=>_assertClassBrand29(_Comments_brand,this,_onAfterScroll).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",t=>_assertClassBrand29(_Comments_brand,this,_onAfterDocumentKeyDown2).call(this,t)),_classPrivateFieldGet22(_displaySwitch,this).addLocalHook("hide",()=>this.hide()),_classPrivateFieldGet22(_displaySwitch,this).addLocalHook("show",(t,r)=>this.showAtCell(t,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){_classPrivateFieldGet22(_displaySwitch,this).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),t=e.getContext("grid"),r=e.addContext(SHORTCUTS_CONTEXT_NAME);t.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();_classPrivateFieldSet19(_preventEditorHiding,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(SHORTCUTS_CONTEXT_NAME),this.hot._registerTimeout(()=>{_classPrivateFieldSet19(_preventEditorHiding,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&!_classPrivateFieldGet22(_editor2,this).isVisible()},group:SHORTCUTS_GROUP7}),r.addShortcut({keys:[["Escape"]],callback:()=>{_classPrivateFieldGet22(_editor2,this).setValue(_classPrivateFieldGet22(_commentValueBeforeSave,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>_classPrivateFieldGet22(_editor2,this).isVisible()&&_classPrivateFieldGet22(_editor2,this).isFocused(),group:SHORTCUTS_GROUP7}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>_classPrivateFieldGet22(_editor2,this).isVisible()&&_classPrivateFieldGet22(_editor2,this).isFocused(),group:SHORTCUTS_GROUP7})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP7)}registerListeners(){const{rootDocument:e}=this.hot,t=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>_assertClassBrand29(_Comments_brand,this,_onMouseOver).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>_assertClassBrand29(_Comments_brand,this,_onMouseDown).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand29(_Comments_brand,this,_onMouseUp2).call(this)),this.eventManager.addEventListener(t,"focus",()=>_assertClassBrand29(_Comments_brand,this,_onEditorFocus).call(this)),this.eventManager.addEventListener(t,"blur",()=>_assertClassBrand29(_Comments_brand,this,_onEditorBlur).call(this))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=closest(e.target,"TD","TBODY");return!!(t&&hasClass(t,"htCommentCell")&&closest(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=_classPrivateFieldGet22(_editor2,this).getValue();let r="";e!=null?r=e:t!=null&&(r=t);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[META_COMMENT_VALUE]:r}),this.hot.render()}setCommentAtCell(e,t,r){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,META_COMMENT),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(r)}getComment(){const e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,META_COMMENT_VALUE)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,META_COMMENT_VALUE)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:t,col:r}}=this.range;if(t<0||t>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return _classPrivateFieldGet22(_displaySwitch,this).cancelHiding(),_classPrivateFieldGet22(_editor2,this).setValue((e=i[META_COMMENT]?i[META_COMMENT][META_COMMENT_VALUE]:null)!==null&&e!==void 0?e:""),_classPrivateFieldGet22(_editor2,this).show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){_classPrivateFieldGet22(_editor2,this).hide()}refreshEditor(){var e,t;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!_classPrivateFieldGet22(_editor2,this).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:o}=this.hot,{row:a,col:c}=this.range.from;let u=i.getRenderableFromVisualIndex(a),h=o.getRenderableFromVisualIndex(c);const d=u===null;_classPrivateFieldGet22(_editor2,this).setPosition(0,0),u===null&&(u=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1))),h===null&&(h=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(c,-1)));const f=u===null,m=h===null;u=(e=u)!==null&&e!==void 0?e:0,h=(t=h)!==null&&t!==void 0?t:0;const{rootWindow:g,view:{_wt:v}}=this.hot,{wtTable:_}=v,b=v.getCell({row:u,col:h},!0),S=this.getCommentMeta(a,c,META_STYLE);S?_classPrivateFieldGet22(_editor2,this).setSize(S.width,S.height):_classPrivateFieldGet22(_editor2,this).resetSize();const R=m?0:_.getStretchedColumnWidth(h),A=d&&!f?outerHeight(b):0,{left:I,top:E,width:O,height:P}=b.getBoundingClientRect(),{width:L,height:V}=_classPrivateFieldGet22(_editor2,this).getSize(),{innerWidth:$,innerHeight:W}=this.hot.rootWindow,Z=this.hot.rootDocument.documentElement;let ie=I+g.scrollX+R,ue=E+g.scrollY+A;this.hot.isRtl()&&(ie-=L+R),this.hot.isLtr()&&I+O+L>$?ie=I+g.scrollX-L-1:this.hot.isRtl()&&ie<-(Z.scrollWidth-Z.clientWidth)&&(ie=I+g.scrollX+R+1),E+V>W&&(ue-=V-P+1),_classPrivateFieldGet22(_editor2,this).setPosition(ie,ue),_classPrivateFieldGet22(_editor2,this).setReadOnlyState(this.getCommentMeta(a,c,META_READONLY)),_classPrivateFieldGet22(_editor2,this).observeSize()}focusEditor(){_classPrivateFieldGet22(_editor2,this).focus()}updateCommentMeta(e,t,r){const i=this.hot.getCellMeta(e,t)[META_COMMENT];let o;i?(o=deepClone(i),deepExtend(o,r)):o=r,this.hot.setCellMeta(e,t,META_COMMENT,o)}getCommentMeta(e,t,r){const i=this.hot.getCellMeta(e,t);if(i[META_COMMENT])return i[META_COMMENT][r]}addToContextMenu(e){e.items.push({name:KEY},addEditCommentItem(this),removeCommentItem(this),readOnlyCommentItem(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[PLUGIN_KEY9];if(isObject2(e))return e.displayDelay}getEditorInputElement(){return _classPrivateFieldGet22(_editor2,this).getInputElement()}destroy(){var e,t;(e=_classPrivateFieldGet22(_editor2,this))===null||e===void 0||e.destroy(),(t=_classPrivateFieldGet22(_displaySwitch,this))===null||t===void 0||t.destroy(),super.destroy()}};function _onMouseDown(e){if(!(!this.hot.view||!this.hot.view._wt)&&!_classPrivateFieldGet22(_preventEditorAutoSwitch,this)&&!this.targetIsCommentTextArea(e)){const t=closest(e.target,"TD","TBODY");let r=null;t&&(r=this.hot.getCoords(t)),(!t||this.range.from&&r&&(this.range.from.row!==r.row||this.range.from.col!==r.col))&&this.hide()}}function _onMouseOver(e){const{rootDocument:t}=this.hot;if(!(_classPrivateFieldGet22(_preventEditorAutoSwitch,this)||_classPrivateFieldGet22(_editor2,this).isFocused()||hasClass(e.target,"wtBorder")||_classPrivateFieldGet22(_cellBelowCursor,this)===e.target||!_classPrivateFieldGet22(_editor2,this)))if(_classPrivateFieldSet19(_cellBelowCursor,this,t.elementFromPoint(e.clientX,e.clientY)),this.targetIsCellWithComment(e)){const r=this.hot._createCellRange(this.hot.getCoords(e.target));_classPrivateFieldGet22(_displaySwitch,this).show(r)}else isChildOf(e.target,t)&&!this.targetIsCommentTextArea(e)&&_classPrivateFieldGet22(_displaySwitch,this).hide()}function _onMouseUp2(){_classPrivateFieldSet19(_preventEditorAutoSwitch,this,!1)}function _onAfterRenderer(e,t){t[META_COMMENT]&&t[META_COMMENT][META_COMMENT_VALUE]&&addClass(e,t.commentedCellClassName)}function _onEditorBlur(){_classPrivateFieldSet19(_commentValueBeforeSave,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function _onEditorFocus(){_classPrivateFieldSet19(_commentValueBeforeSave,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(SHORTCUTS_CONTEXT_NAME)}function _onEditorResize(e,t){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[META_STYLE]:{width:e,height:t}})}function _onAfterDocumentKeyDown2(e){_classPrivateFieldGet22(_editor2,this).isVisible()&&stopImmediatePropagation(e)}function _onAfterScroll(){_classPrivateFieldGet22(_preventEditorHiding,this)||this.hide()}var import_es_error_cause110=__toESM(require_es_error_cause(),1),import_es_error_cause105=__toESM(require_es_error_cause(),1),import_es_array_push55=__toESM(require_es_array_push(),1),import_es_array_unshift=__toESM(require_es_array_unshift(),1);function _defineProperty76(e,t,r){return(t=_toPropertyKey76(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey76(e){var t=_toPrimitive76(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive76(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CommandExecutor=class{constructor(e){_defineProperty76(this,"hot",void 0),_defineProperty76(this,"commands",{}),_defineProperty76(this,"commonCallback",null),this.hot=e}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];const o=e.split(":"),a=o[0],c=o.length===2?o[1]:null;let u=this.commands[a];if(!u)throw new Error(`Menu command '${a}' not exists.`);if(c&&u.submenu&&(u=findSubCommand(c,u.submenu.items)),u.disabled===!0||typeof u.disabled=="function"&&u.disabled.call(this.hot)===!0||hasOwnProperty(u,"submenu"))return;const h=[];typeof u.callback=="function"&&h.push(u.callback),typeof this.commonCallback=="function"&&h.push(this.commonCallback),r.unshift(o.join(":")),arrayEach(h,d=>d.apply(this.hot,r))}};function findSubCommand(e,t){let r;return arrayEach(t,i=>{const o=i.key?i.key.split(":"):null;if(Array.isArray(o)&&o[1]===e)return r=i,!1}),r}var import_es_error_cause106=__toESM(require_es_error_cause(),1),import_es_array_push56=__toESM(require_es_array_push(),1);function _defineProperty77(e,t,r){return(t=_toPropertyKey77(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey77(e){var t=_toPrimitive77(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive77(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ItemsFactory=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;_defineProperty77(this,"hot",void 0),_defineProperty77(this,"predefinedItems",predefinedItems()),_defineProperty77(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,objectEach(e,(r,i)=>{let o="";r.name===KEY?(t[KEY]=r,o=KEY):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,t[i]=r,o=r.key):(t[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=t}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return getItems(e,this.defaultOrderPattern,this.predefinedItems)}};function getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=[];let o=e;return o&&o.items?o=o.items:Array.isArray(o)||(o=t),isObject2(o)?objectEach(o,(a,c)=>{let u=r[typeof a=="string"?a:c];u||(u=a),isObject2(a)?extend2(u,a):typeof u=="string"&&(u={name:u}),u.key===void 0&&(u.key=c),i.push(u)}):arrayEach(o,(a,c)=>{let u=r[a];!u&&ITEMS.indexOf(a)>=0||(u||(u={name:a,key:`${c}`}),isObject2(a)&&extend2(u,a),u.key===void 0&&(u.key=c),i.push(u))}),i}var import_es_error_cause109=__toESM(require_es_error_cause(),1),import_es_array_push59=__toESM(require_es_array_push(),1),import_es_error_cause108=__toESM(require_es_error_cause(),1),import_es_error_cause107=__toESM(require_es_error_cause(),1);function _defineProperty78(e,t,r){return(t=_toPropertyKey78(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey78(e){var t=_toPrimitive78(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive78(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cursor=class{constructor(e,t){_defineProperty78(this,"top",void 0),_defineProperty78(this,"topRelative",void 0),_defineProperty78(this,"left",void 0),_defineProperty78(this,"leftRelative",void 0),_defineProperty78(this,"scrollTop",void 0),_defineProperty78(this,"scrollLeft",void 0),_defineProperty78(this,"cellHeight",void 0),_defineProperty78(this,"cellWidth",void 0);const r=t.scrollY,i=t.scrollX;let o,a,c,u,h,d;this.rootWindow=t,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),c=parseInt(e.left,10),h=e.height||0,d=e.width||0,a=o,u=c,o+=r,c+=i):this.type==="event"&&(o=parseInt(e.pageY,10),c=parseInt(e.pageX,10),h=e.target.clientHeight,d=e.target.clientWidth,a=o-r,u=c-i),this.top=o,this.topRelative=a,this.left=c,this.leftRelative=u,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=h,this.cellWidth=d}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}};function _classPrivateFieldInitSpec23(e,t,r){_checkPrivateRedeclaration30(e,t),t.set(e,r)}function _checkPrivateRedeclaration30(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet23(e,t){return e.get(_assertClassBrand30(e,t))}function _classPrivateFieldSet20(e,t,r){return e.set(_assertClassBrand30(e,t),r),r}function _assertClassBrand30(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _container2=new WeakMap,_parentContainer=new WeakMap,_cursor=new WeakMap,_keepInViewport=new WeakMap,_offset2=new WeakMap,Positioner=class{constructor(e){_classPrivateFieldInitSpec23(this,_container2,void 0),_classPrivateFieldInitSpec23(this,_parentContainer,void 0),_classPrivateFieldInitSpec23(this,_cursor,void 0),_classPrivateFieldInitSpec23(this,_keepInViewport,!1),_classPrivateFieldInitSpec23(this,_offset2,{above:0,below:0,left:0,right:0}),_classPrivateFieldSet20(_keepInViewport,this,e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return _classPrivateFieldGet23(_offset2,this)[e]=t,this}setElement(e){return _classPrivateFieldSet20(_container2,this,e),this}setParentElement(e){return _classPrivateFieldSet20(_parentContainer,this,e),this}updatePosition(e){_classPrivateFieldSet20(_cursor,this,new Cursor(e,_classPrivateFieldGet23(_container2,this).ownerDocument.defaultView)),_classPrivateFieldGet23(_keepInViewport,this)?(_classPrivateFieldGet23(_cursor,this).fitsBelow(_classPrivateFieldGet23(_container2,this))?this.setPositionBelowCursor():_classPrivateFieldGet23(_cursor,this).fitsAbove(_classPrivateFieldGet23(_container2,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){_classPrivateFieldGet23(_container2,this).dir==="rtl"?_classPrivateFieldGet23(_cursor,this).fitsOnLeft(_classPrivateFieldGet23(_container2,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():_classPrivateFieldGet23(_cursor,this).fitsOnRight(_classPrivateFieldGet23(_container2,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=_classPrivateFieldGet23(_offset2,this).above+_classPrivateFieldGet23(_cursor,this).top-_classPrivateFieldGet23(_container2,this).offsetHeight;_classPrivateFieldGet23(_parentContainer,this)&&(e=_classPrivateFieldGet23(_cursor,this).top+_classPrivateFieldGet23(_cursor,this).cellHeight-_classPrivateFieldGet23(_container2,this).offsetHeight+3),_classPrivateFieldGet23(_container2,this).style.top=`${e}px`}setPositionBelowCursor(){let e=_classPrivateFieldGet23(_offset2,this).below+_classPrivateFieldGet23(_cursor,this).top+1;_classPrivateFieldGet23(_parentContainer,this)&&(e=_classPrivateFieldGet23(_cursor,this).top-1),_classPrivateFieldGet23(_container2,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=_classPrivateFieldGet23(_cursor,this).left;if(_classPrivateFieldGet23(_parentContainer,this)){const t=Number.parseInt(getComputedStyle(_classPrivateFieldGet23(_parentContainer,this).querySelector(".htCore")).borderRightWidth,10);e+=_classPrivateFieldGet23(_cursor,this).cellWidth+t}else e+=_classPrivateFieldGet23(_offset2,this).right;_classPrivateFieldGet23(_container2,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=_classPrivateFieldGet23(_offset2,this).left+_classPrivateFieldGet23(_cursor,this).left-_classPrivateFieldGet23(_container2,this).offsetWidth;if(_classPrivateFieldGet23(_parentContainer,this)){const t=Number.parseInt(getComputedStyle(_classPrivateFieldGet23(_parentContainer,this).querySelector(".htCore")).borderLeftWidth,10);e-=t}_classPrivateFieldGet23(_container2,this).style.left=`${e}px`}},import_es_set_difference_v217=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v217=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v217=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v217=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v217=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v217=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v217=__toESM(require_es_set_union_v2(),1);function createPaginator(e){let{initialPage:t=-1,size:r=()=>0,onItemSelect:i=()=>{},onClear:o=()=>{}}=e;const a=new Set;let c=clamp(t,-1,_()-1);function u(S,R){const A=_()-1;return S<0&&(S=A),S>A&&(S=0),a.has(S)?-1:(a.add(S),i(S,!1)===!1&&(S=u(R===1?++S:--S,R)),S)}function h(S){S>-1&&S<_()&&i(S,!0)!==!1&&(c=S)}function d(){return c}function f(){_()>0&&(a.clear(),c=u(0,1))}function m(){_()>0&&(a.clear(),c=u(_()-1,-1))}function g(){_()>0&&(a.clear(),c=u(++c,1))}function v(){_()>0&&(a.clear(),c=u(--c,-1))}function _(){return Math.max(r(),0)}function b(){a.clear(),c=t,o()}return{setCurrentPage:h,getCurrentPage:d,toFirstItem:f,toLastItem:m,toNextItem:g,toPreviousItem:v,getSize:_,clear:b}}var import_es_array_push57=__toESM(require_es_array_push(),1);function normalizeSelection(e){return arrayMap(e,t=>({start:t.getTopStartCorner(),end:t.getBottomEndCorner()}))}function isItemSubMenu(e){return hasOwnProperty(e,"submenu")}function isItemSeparator(e){return new RegExp(KEY,"i").test(e.name)}function isItemDisabled(e,t){return e.disabled===!0||typeof e.disabled=="function"&&e.disabled.call(t)===!0}function isItemSelectionDisabled(e){return hasOwnProperty(e,"disableSelection")}function isSeparator(e){return hasClass(e,"htSeparator")}function hasSubMenu(e){return hasClass(e,"htSubmenu")}function isDisabled(e){return hasClass(e,"htDisabled")}function isSelectionDisabled(e){return hasClass(e,"htSelectionDisabled")}function isItemHidden(e,t){return!e.hidden||!(typeof e.hidden=="function"&&e.hidden.call(t))}function shiftSeparators(e,t){const r=e.slice(0);for(let i=0;i<r.length&&r[i].name===t;)r.shift();return r}function popSeparators(e,t){let r=e.slice(0);return r.reverse(),r=shiftSeparators(r,t),r.reverse(),r}function removeDuplicatedSeparators(e){const t=[];return arrayEach(e,(r,i)=>{i>0?t[t.length-1].name!==r.name&&t.push(r):t.push(r)}),t}function filterSeparators(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:KEY,r=e.slice(0);return r=shiftSeparators(r,t),r=popSeparators(r,t),r=removeDuplicatedSeparators(r),r}function isItemCheckable(e){return e.checkable===!0}function createMenuNavigator(e){return createPaginator({size:()=>e.countRows(),onItemSelect(t,r){const i=e.getCell(t,0);if(!i||isSeparator(i)||isDisabled(i)||isSelectionDisabled(i))return!1;e.selectCell(t,0,...r?[t,0,!1,!1]:[])},onClear(){e.deselectCell()}})}var import_es_array_push58=__toESM(require_es_array_push(),1);function createDefaultShortcutsList(e){const{hot:t,hotMenu:r}=e;return[{keys:[["Control/Meta","A"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:()=>e.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(i,o)=>{const a=t.getSettings(),c=typeof a.tabMoves=="function"?a.tabMoves(i):a.tabMoves;o.includes("shift")?t.selection.transformStart(-c.row,-c.col):t.selection.transformStart(c.row,c.col),e.close(!0)}},{keys:[["Escape"]],callback:()=>e.close()},{keys:[["ArrowDown"]],callback:()=>e.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>e.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const i=r.getSelectedLast();if(i){const o=e.openSubMenu(i[0]);o&&o.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{r.getSelectedLast()&&e.isSubMenu()&&(e.close(),e.isSubMenu()&&e.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>e.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>e.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:i=>{const o=r.getSelectedLast();o&&(r.getSourceDataAtRow(o[0]).submenu?e.openSubMenu(o[0]).getNavigator().toFirstItem():(e.executeCommand(i),e.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(-r.countVisibleRows(),0):e.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(r.countVisibleRows(),0):e.getNavigator().toLastItem()}}]}var SHORTCUTS_CONTEXT="menu",SHORTCUTS_GROUP8=SHORTCUTS_CONTEXT;function createKeyboardShortcutsCtrl(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];i(createDefaultShortcutsList(e)),t.forEach(d=>{let{shortcuts:f,contextName:m}=d;o(f,m)});function i(d,f){u(f).addShortcuts(d,{group:SHORTCUTS_CONTEXT})}function o(d,f){const m=u(f);d.forEach(g=>{let{keys:v}=g;v.forEach(_=>m.removeShortcutsByKeys(_))}),r.push({shortcuts:d,contextName:f}),i(d,f)}function a(){return[...r]}function c(d){return d?`${SHORTCUTS_GROUP8}:${d}`:SHORTCUTS_GROUP8}function u(d){var f;const m=e.hotMenu.getShortcutManager(),g=c(d);return(f=m.getContext(g))!==null&&f!==void 0?f:m.addContext(g)}function h(d){e.hotMenu.getShortcutManager().setActiveContextName(c(d))}return{addCustomShortcuts:o,getCustomShortcuts:a,getContext:u,listen:h}}function createMenuItemRenderer(e){return(t,r,i,o,a,c)=>{const u=t.getSourceDataAtRow(i),h=e.rootDocument.createElement("div"),d=typeof c=="function"?c.call(e):c,f=typeof u.ariaLabel=="function"?u.ariaLabel.call(e):u.ariaLabel,m=typeof u.ariaChecked=="function"?u.ariaChecked.call(e):u.ariaChecked;if(empty2(r),addClass(h,"htItemWrapper"),e.getSettings().ariaTags){const g=!isItemDisabled(u,e)&&!isItemSelectionDisabled(u)&&!isItemSeparator(u);setAttribute(r,[...isItemCheckable(u)?[A11Y_MENU_ITEM_CHECKBOX(),A11Y_LABEL(f),A11Y_CHECKED(m)]:[A11Y_MENU_ITEM(),A11Y_LABEL(d)],...g?[A11Y_TABINDEX(-1)]:[],...isItemDisabled(u,e)?[A11Y_DISABLED()]:[],...isItemSubMenu(u)?[A11Y_EXPANDED(!1)]:[]])}r.className="",r.appendChild(h),isItemSeparator(u)?addClass(r,"htSeparator"):typeof u.renderer=="function"?(addClass(r,"htCustomMenuRenderer"),r.appendChild(u.renderer(t,h,i,o,a,d))):fastInnerHTML(h,d),isItemDisabled(u,e)?addClass(r,"htDisabled"):isItemSelectionDisabled(u)?addClass(r,"htSelectionDisabled"):isItemSubMenu(u)&&addClass(r,"htSubmenu")}}function _classPrivateFieldInitSpec24(e,t,r){_checkPrivateRedeclaration31(e,t),t.set(e,r)}function _checkPrivateRedeclaration31(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty79(e,t,r){return(t=_toPropertyKey79(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey79(e){var t=_toPrimitive79(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive79(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldSet21(e,t,r){return e.set(_assertClassBrand31(e,t),r),r}function _classPrivateFieldGet24(e,t){return e.get(_assertClassBrand31(e,t))}function _assertClassBrand31(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var MIN_WIDTH=215,_navigator=new WeakMap,_shortcutsCtrl=new WeakMap,_tableBorderWidth=new WeakMap,Menu=class rs{get tableBorderWidth(){return _classPrivateFieldGet24(_tableBorderWidth,this)===void 0&&this.hotMenu&&_classPrivateFieldSet21(_tableBorderWidth,this,parseInt(getComputedStyle3(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),_classPrivateFieldGet24(_tableBorderWidth,this)}constructor(t,r){var i=this;_defineProperty79(this,"hot",void 0),_defineProperty79(this,"options",void 0),_defineProperty79(this,"eventManager",new eventManager_default(this)),_defineProperty79(this,"container",void 0),_defineProperty79(this,"positioner",void 0),_defineProperty79(this,"hotMenu",null),_defineProperty79(this,"hotSubMenus",{}),_defineProperty79(this,"parentMenu",void 0),_defineProperty79(this,"menuItems",null),_defineProperty79(this,"origOutsideClickDeselects",null),_classPrivateFieldInitSpec24(this,_navigator,void 0),_classPrivateFieldInitSpec24(this,_shortcutsCtrl,void 0),_classPrivateFieldInitSpec24(this,_tableBorderWidth,void 0),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:MIN_WIDTH,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Positioner(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return i.parentMenu.runLocalHooks("afterSelectionChange",...a)})}registerEvents(){let t=this.hot.rootWindow;for(;t;)this.eventManager.addEventListener(t.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(t.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(t.document,"contextmenu",r=>this.onDocumentContextMenu(r)),t=getParentWindow(t)}setMenuItems(t){this.menuItems=t}getNavigator(){return _classPrivateFieldGet24(_navigator,this)}getKeyboardShortcutsCtrl(){return _classPrivateFieldGet24(_shortcutsCtrl,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const t=debounce2(u=>this.openSubMenu(u),300),r=this.options.minWidth||MIN_WIDTH;let i=!1,o=arrayFilter(this.menuItems,u=>(u.key===KEY12&&(i=!0),isItemHidden(u,this.hot)));if(o.length<1&&!i)o.push(predefinedItems()[KEY12]);else if(o.length===0)return;o=filterSeparators(o,KEY);let a=!1;const c={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(u){return isDefined(u)&&u<r?r:u},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:createMenuItemRenderer(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(u,h)=>{_classPrivateFieldGet24(_navigator,this).setCurrentPage(h.row)},afterOnCellMouseOver:(u,h)=>{this.isAllSubMenusClosed()?t(h.row):this.openSubMenu(h.row)},rowHeights:u=>o[u].name===KEY?1:void 0,afterOnCellContextMenu:u=>{u.preventDefault(),isWindowsOS()&&a&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(u,h,d,f,m)=>{this.hotMenu.view.isMouseDown()&&(m.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:u=>{this.hasSelectedItem()&&(a=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(u))},afterOnCellMouseUp:u=>{(!isWindowsOS()||!isRightClick(u))&&a&&this.hasSelectedItem()&&(isMobileBrowser()||isIpadOS()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,c),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),_classPrivateFieldSet21(_navigator,this,createMenuNavigator(this.hotMenu)),_classPrivateFieldSet21(_shortcutsCtrl,this,createKeyboardShortcutsCtrl(this)),_classPrivateFieldGet24(_shortcutsCtrl,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(t&&this.isSubMenu())this.parentMenu.close();else if(_classPrivateFieldGet24(_navigator,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const r=this.parentMenu.hotMenu.getSelectedLast();if(r){const i=this.parentMenu.hotMenu.getCell(r[0],0);setAttribute(i,[A11Y_EXPANDED(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(t){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!r||!hasSubMenu(r))return!1;const i=this.hotMenu.getSourceDataAtRow(t),o=new rs(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(i.submenu.items),o.open(),o.setPosition(r.getBoundingClientRect()),this.hotSubMenus[i.key]=o,this.hot.getSettings().ariaTags&&setAttribute(r,[A11Y_EXPANDED(!0)]),o}closeSubMenu(t){const r=this.hotMenu.getSourceDataAtRow(t),i=this.hotSubMenus[r.key];if(i){i.destroy(),delete this.hotSubMenus[r.key];const o=this.hotMenu.getCell(t,0);this.hot.getSettings().ariaTags&&setAttribute(o,[A11Y_EXPANDED(!1)])}}closeAllSubMenus(){arrayEach(this.hotMenu.getData(),(t,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(t){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,t),this.isCommandPassive(r))return;const i=this.hot.getSelectedRange(),o=i?normalizeSelection(i):[];this.runLocalHooks("executeCommand",r.key,o,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,o,t)}isCommandPassive(t){return t.isCommand===!1||isItemSeparator(t)||isItemDisabled(t,this.hot)||isItemSubMenu(t)}setOffset(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(t,r)}setPosition(t){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(t)}updateMenuDimensions(){const{wtTable:t}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,i=t.hider.style,o=t.holder.style,a=parseInt(i.width,10),c=arrayReduce(r,(u,h,d)=>{const m=this.hotMenu.getCell(d,0)?outerHeight(this.hotMenu.getCell(d,0)):0;return u+(h.name===KEY?1:m)},0);o.width=`${a+3}px`,o.height=`${c+3}px`,i.height=o.height}createContainer(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let i=t,o;return i&&(isFunction2(i)&&(i=i.call(this.hot),i===null||isUndefined(i)?i="":i=i.toString()),i=i.replace(/[^A-z0-9]/g,"_"),i=`${this.options.className}Sub_${i}`,o=r.querySelector(`.${this.options.className}.${i}`)),o||(o=r.createElement("div"),addClass(o,`htMenu ${this.options.className}`),i&&addClass(o,i),this.options.container.appendChild(o)),o}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&setAttribute(this.hotMenu.rootElement,[A11Y_MENU(),A11Y_TABINDEX(-1)])}onDocumentMouseDown(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!isChildOf(t.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!isChildOf(t.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(t){this.isOpened()&&hasClass(t.target,"htCore")&&isChildOf(t.target,this.hotMenu.rootElement)&&t.preventDefault()}};mixin(Menu,localHooks_default);function _classPrivateMethodInitSpec19(e,t){_checkPrivateRedeclaration32(e,t),t.add(e)}function _checkPrivateRedeclaration32(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty80(e,t,r){return(t=_toPropertyKey80(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey80(e){var t=_toPrimitive80(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive80(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand32(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var PLUGIN_KEY10="contextMenu",PLUGIN_PRIORITY9=70,SHORTCUTS_GROUP9=PLUGIN_KEY10;pluginHooks_default.getSingleton().register("afterContextMenuDefaultOptions"),pluginHooks_default.getSingleton().register("beforeContextMenuShow"),pluginHooks_default.getSingleton().register("afterContextMenuShow"),pluginHooks_default.getSingleton().register("afterContextMenuHide"),pluginHooks_default.getSingleton().register("afterContextMenuExecute");var _ContextMenu_brand=new WeakSet,ContextMenu=class ns extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec19(this,_ContextMenu_brand),_defineProperty80(this,"commandExecutor",new CommandExecutor(this.hot)),_defineProperty80(this,"itemsFactory",null),_defineProperty80(this,"menu",null)}static get PLUGIN_KEY(){return PLUGIN_KEY10}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY9}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[KEY10,KEY11,KEY,KEY4,KEY5,KEY,KEY9,KEY8,KEY,KEY13,KEY7,KEY,KEY6,KEY,KEY2]}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY10]}enablePlugin(){var t=this;if(this.enabled)return;const r=this.hot.getSettings()[PLUGIN_KEY10];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new Menu(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>_assertClassBrand32(_ContextMenu_brand,this,_onMenuBeforeOpen).call(this)),this.menu.addLocalHook("afterOpen",()=>_assertClassBrand32(_ContextMenu_brand,this,_onMenuAfterOpen).call(this)),this.menu.addLocalHook("afterClose",()=>_assertClassBrand32(_ContextMenu_brand,this,_onMenuAfterClose).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t.executeCommand.call(t,...o)}),this.addHook("afterOnCellContextMenu",i=>_assertClassBrand32(_ContextMenu_brand,this,_onAfterOnCellContextMenu).call(this,i)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const r=this.hot.getCell(t.row,t.col,!0).getBoundingClientRect(),i=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument);this.open({left:r.left+i.left,top:r.top+i.top-1+r.height},{left:r.width,above:-r.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var t;const r=(t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.highlight;return r&&this.hot.selection.isCellVisible(r)&&!this.menu.isOpened()},group:SHORTCUTS_GROUP9})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP9)}open(t){var r;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((r=this.menu)!==null&&r!==void 0&&r.isOpened())return;this.prepareMenuItems(),this.menu.open(),this.menu.tableBorderWidth>0||(i.below+=1,i.right+=1,i.above-=1,i.left-=1),objectEach(i,(a,c)=>{this.menu.setOffset(c,a)}),this.menu.setPosition(t)}close(){var t;(t=this.menu)===null||t===void 0||t.close(),this.itemsFactory=null}executeCommand(t){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];this.commandExecutor.execute(t,...i)}prepareMenuItems(){this.itemsFactory=new ItemsFactory(this.hot,ns.DEFAULT_ITEMS);const t=this.hot.getSettings()[PLUGIN_KEY10],r={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),arrayEach(i,o=>this.commandExecutor.registerCommand(o.key,o))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}};function _onAfterOnCellContextMenu(e){const t=this.hot.getSettings(),r=t.rowHeaders,i=t.colHeaders;function o(u){return u.nodeName==="TD"||u.parentNode.nodeName==="TD"}const a=e.target;if(this.close(),hasClass(a,"handsontableInput")||(e.preventDefault(),e.stopPropagation(),!(r||i)&&!o(a)&&!(hasClass(a,"current")&&hasClass(a,"wtBorder"))))return;const c=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument);this.open({top:e.clientY+c.top,left:e.clientX+c.left})}function _onMenuBeforeOpen(){this.hot.runHooks("beforeContextMenuShow",this)}function _onMenuAfterOpen(){this.hot.runHooks("afterContextMenuShow",this)}function _onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}ContextMenu.SEPARATOR={name:KEY};var import_es_error_cause112=__toESM(require_es_error_cause(),1),import_es_array_push61=__toESM(require_es_array_push(),1);function copyItem(e){return{key:"copy",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY)},callback(){e.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function copyColumnHeadersOnlyItem(e){return{key:"copy_column_headers_only",name(){const t=this.getSelectedRangeLast(),r=t?clamp(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,r)},callback(){e.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function copyWithColumnGroupHeadersItem(e){return{key:"copy_with_column_group_headers",name(){const t=this.getSelectedRangeLast(),r=t?clamp(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,r)},callback(){e.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function copyWithColumnHeadersItem(e){return{key:"copy_with_column_headers",name(){const t=this.getSelectedRangeLast(),r=t?clamp(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,r)},callback(){e.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function cutItem(e){return{key:"cut",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_CUT)},callback(){e.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}var ClipboardData=class{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}},PasteEvent=class{constructor(){this.clipboardData=new ClipboardData}preventDefault(){}},import_es_error_cause111=__toESM(require_es_error_cause(),1),import_es_array_push60=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec20(e,t){_checkPrivateRedeclaration33(e,t),t.add(e)}function _classPrivateFieldInitSpec25(e,t,r){_checkPrivateRedeclaration33(e,t),t.set(e,r)}function _checkPrivateRedeclaration33(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet25(e,t){return e.get(_assertClassBrand33(e,t))}function _classPrivateFieldSet22(e,t,r){return e.set(_assertClassBrand33(e,t),r),r}function _assertClassBrand33(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _selectedRange=new WeakMap,_countRows=new WeakMap,_countColumns=new WeakMap,_rowsLimit=new WeakMap,_columnsLimit=new WeakMap,_countColumnHeaders=new WeakMap,_CopyableRangesFactory_brand=new WeakSet,CopyableRangesFactory=class{constructor(e){let{countRows:t,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:a}=e;_classPrivateMethodInitSpec20(this,_CopyableRangesFactory_brand),_classPrivateFieldInitSpec25(this,_selectedRange,void 0),_classPrivateFieldInitSpec25(this,_countRows,void 0),_classPrivateFieldInitSpec25(this,_countColumns,void 0),_classPrivateFieldInitSpec25(this,_rowsLimit,void 0),_classPrivateFieldInitSpec25(this,_columnsLimit,void 0),_classPrivateFieldInitSpec25(this,_countColumnHeaders,void 0),_classPrivateFieldSet22(_countRows,this,t),_classPrivateFieldSet22(_countColumns,this,r),_classPrivateFieldSet22(_rowsLimit,this,i),_classPrivateFieldSet22(_columnsLimit,this,o),_classPrivateFieldSet22(_countColumnHeaders,this,a)}setSelectedRange(e){_classPrivateFieldSet22(_selectedRange,this,e)}getCellsRange(){if(_classPrivateFieldGet25(_countRows,this).call(this)===0||_classPrivateFieldGet25(_countColumns,this).call(this)===0)return null;const{row:e,col:t}=_classPrivateFieldGet25(_selectedRange,this).getTopStartCorner(),{row:r,col:i}=_classPrivateFieldGet25(_selectedRange,this).getBottomEndCorner(),o=_assertClassBrand33(_CopyableRangesFactory_brand,this,_trimRowsRange).call(this,e,r),a=_assertClassBrand33(_CopyableRangesFactory_brand,this,_trimColumnsRange).call(this,t,i);return{isRangeTrimmed:r!==o||i!==a,startRow:e,startCol:t,endRow:o,endCol:a}}getMostBottomColumnHeadersRange(){if(_classPrivateFieldGet25(_countColumns,this).call(this)===0||_classPrivateFieldGet25(_countColumnHeaders,this).call(this)===0)return null;const{col:e}=_classPrivateFieldGet25(_selectedRange,this).getTopStartCorner(),{col:t}=_classPrivateFieldGet25(_selectedRange,this).getBottomEndCorner(),r=_assertClassBrand33(_CopyableRangesFactory_brand,this,_trimColumnsRange).call(this,e,t);return{isRangeTrimmed:t!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(_classPrivateFieldGet25(_countColumns,this).call(this)===0||_classPrivateFieldGet25(_countColumnHeaders,this).call(this)===0)return null;const{col:e}=_classPrivateFieldGet25(_selectedRange,this).getTopStartCorner(),{col:t}=_classPrivateFieldGet25(_selectedRange,this).getBottomEndCorner(),r=_assertClassBrand33(_CopyableRangesFactory_brand,this,_trimColumnsRange).call(this,e,t);return{isRangeTrimmed:t!==r,startRow:-_classPrivateFieldGet25(_countColumnHeaders,this).call(this),startCol:e,endRow:-1,endCol:r}}};function _trimColumnsRange(e,t){return Math.min(t,Math.max(e+_classPrivateFieldGet25(_columnsLimit,this).call(this)-1,e))}function _trimRowsRange(e,t){return Math.min(t,Math.max(e+_classPrivateFieldGet25(_rowsLimit,this).call(this)-1,e))}function normalizeRanges(e){const t=[],r=[];return arrayEach(e,i=>{const o=Math.min(i.startRow,i.endRow),a=Math.max(i.startRow,i.endRow);rangeEach(o,a,h=>{t.indexOf(h)===-1&&t.push(h)});const c=Math.min(i.startCol,i.endCol),u=Math.max(i.startCol,i.endCol);rangeEach(c,u,h=>{r.indexOf(h)===-1&&r.push(h)})}),{rows:t,columns:r}}function _classPrivateMethodInitSpec21(e,t){_checkPrivateRedeclaration34(e,t),t.add(e)}function _classPrivateFieldInitSpec26(e,t,r){_checkPrivateRedeclaration34(e,t),t.set(e,r)}function _checkPrivateRedeclaration34(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty81(e,t,r){return(t=_toPropertyKey81(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey81(e){var t=_toPrimitive81(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive81(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet26(e,t){return e.get(_assertClassBrand34(e,t))}function _classPrivateFieldSet23(e,t,r){return e.set(_assertClassBrand34(e,t),r),r}function _assertClassBrand34(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}pluginHooks_default.getSingleton().register("afterCopyLimit"),pluginHooks_default.getSingleton().register("modifyCopyableRange"),pluginHooks_default.getSingleton().register("beforeCut"),pluginHooks_default.getSingleton().register("afterCut"),pluginHooks_default.getSingleton().register("beforePaste"),pluginHooks_default.getSingleton().register("afterPaste"),pluginHooks_default.getSingleton().register("beforeCopy"),pluginHooks_default.getSingleton().register("afterCopy");var PLUGIN_KEY11="copyPaste",PLUGIN_PRIORITY10=80,SETTING_KEYS3=["fragmentSelection"],META_HEAD=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),_enableCopyColumnHeaders=new WeakMap,_enableCopyColumnGroupHeaders=new WeakMap,_enableCopyColumnHeadersOnly=new WeakMap,_copyMode=new WeakMap,_isTriggeredByCopy=new WeakMap,_isTriggeredByCut=new WeakMap,_copyableRangesFactory=new WeakMap,_preventViewportScrollOnPaste=new WeakMap,_CopyPaste_brand=new WeakSet,CopyPaste=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec21(this,_CopyPaste_brand),_defineProperty81(this,"columnsLimit",1/0),_defineProperty81(this,"rowsLimit",1/0),_defineProperty81(this,"pasteMode","overwrite"),_defineProperty81(this,"uiContainer",this.hot.rootDocument.body),_classPrivateFieldInitSpec26(this,_enableCopyColumnHeaders,!1),_classPrivateFieldInitSpec26(this,_enableCopyColumnGroupHeaders,!1),_classPrivateFieldInitSpec26(this,_enableCopyColumnHeadersOnly,!1),_classPrivateFieldInitSpec26(this,_copyMode,"cells-only"),_classPrivateFieldInitSpec26(this,_isTriggeredByCopy,!1),_classPrivateFieldInitSpec26(this,_isTriggeredByCut,!1),_classPrivateFieldInitSpec26(this,_copyableRangesFactory,new CopyableRangesFactory({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),_classPrivateFieldInitSpec26(this,_preventViewportScrollOnPaste,!1),_defineProperty81(this,"copyableRanges",[])}static get PLUGIN_KEY(){return PLUGIN_KEY11}static get SETTING_KEYS(){return[PLUGIN_KEY11,...SETTING_KEYS3]}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY10}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY11]}enablePlugin(){var e=this;if(this.enabled)return;const{[PLUGIN_KEY11]:t}=this.hot.getSettings();if(typeof t=="object"){var r,i;this.pasteMode=(r=t.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(t.rowsLimit)?this.rowsLimit:t.rowsLimit,this.columnsLimit=isNaN(t.columnsLimit)?this.columnsLimit:t.columnsLimit,_classPrivateFieldSet23(_enableCopyColumnHeaders,this,!!t.copyColumnHeaders),_classPrivateFieldSet23(_enableCopyColumnGroupHeaders,this,!!t.copyColumnGroupHeaders),_classPrivateFieldSet23(_enableCopyColumnHeadersOnly,this,!!t.copyColumnHeadersOnly),this.uiContainer=(i=t.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>_assertClassBrand34(_CopyPaste_brand,this,_onAfterContextMenuDefaultOptions).call(this,o)),this.addHook("afterSelection",function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return _assertClassBrand34(_CopyPaste_brand,e,_onAfterSelection).call(e,...a)}),this.addHook("afterSelectionEnd",()=>_assertClassBrand34(_CopyPaste_brand,this,_onAfterSelectionEnd).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),isSafari()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return _assertClassBrand34(_CopyPaste_brand,e,_onSafariMouseEnter).call(e,...a)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return _assertClassBrand34(_CopyPaste_brand,e,_onSafariMouseLeave).call(e,...a)}),this.addHook("afterSelection",()=>_assertClassBrand34(_CopyPaste_brand,this,_onSafariAfterSelection).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";_classPrivateFieldSet23(_copyMode,this,e),_classPrivateFieldSet23(_isTriggeredByCopy,this,!0),_assertClassBrand34(_CopyPaste_brand,this,_ensureClipboardEventsGetTriggered).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){_classPrivateFieldSet23(_isTriggeredByCut,this,!0),_assertClassBrand34(_CopyPaste_brand,this,_ensureClipboardEventsGetTriggered).call(this,"cut")}getRangedCopyableData(e){return stringify2(this.getRangedData(e))}getRangedData(e){const t=[],{rows:r,columns:i}=normalizeRanges(e);return arrayEach(r,o=>{const a=[];arrayEach(i,c=>{o<0?a.push(this.hot.getColHeader(c,o)):a.push(this.hot.getCopyableData(o,c))}),t.push(a)}),t}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!t)return;const r=new PasteEvent;e&&r.clipboardData.setData("text/plain",e),t&&r.clipboardData.setData("text/html",t),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}_classPrivateFieldGet26(_copyableRangesFactory,this).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);_classPrivateFieldGet26(_copyMode,this)==="column-headers-only"?t.set("headers",_classPrivateFieldGet26(_copyableRangesFactory,this).getMostBottomColumnHeadersRange()):(_classPrivateFieldGet26(_copyMode,this)==="with-column-headers"?t.set("headers",_classPrivateFieldGet26(_copyableRangesFactory,this).getMostBottomColumnHeadersRange()):_classPrivateFieldGet26(_copyMode,this)==="with-column-group-headers"&&t.set("headers",_classPrivateFieldGet26(_copyableRangesFactory,this).getAllColumnHeadersRange()),t.set("cells",_classPrivateFieldGet26(_copyableRangesFactory,this).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:a,endRow:c,endCol:u}=i;return{startRow:o,startCol:a,endRow:c,endCol:u}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=t.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:a,endCol:c}=r;this.hot.runHooks("afterCopyLimit",a-i+1,c-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:a,col:c}=t.getTopStartCorner(),{row:u,col:h}=t.getBottomEndCorner();let d=a,f=c,m=a,g=c;for(;o.length<r||d<=u;){const{skipRowOnPaste:v,visualRow:_}=this.hot.getCellMeta(d,c);if(d=_+1,v===!0)continue;m=_,f=c;const b=[],S=o.length%r;for(;b.length<i||f<=h;){const{skipColumnOnPaste:R,visualCol:A}=this.hot.getCellMeta(a,f);if(f=A+1,R===!0)continue;g=A;const I=b.length%i;b.push(e[S][I])}o.push(b)}return _classPrivateFieldSet23(_preventViewportScrollOnPaste,this,!0),this.hot.populateFromArray(a,c,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,c,m,g]}onCopy(e){var t;const r=this.hot.getFocusManager().getRefocusElement(),i=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!_classPrivateFieldGet26(_isTriggeredByCopy,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(i&&e.target!==r||!i&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),_classPrivateFieldSet23(_isTriggeredByCopy,this,!1);const o=this.getRangedData(this.copyableRanges),a=_assertClassBrand34(_CopyPaste_brand,this,_countCopiedHeaders).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,a)){const u=stringify2(o);if(e&&e.clipboardData){const h=_dataToHTML(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",u),e.clipboardData.setData("text/html",[META_HEAD,h].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",u);this.hot.runHooks("afterCopy",o,this.copyableRanges,a)}_classPrivateFieldSet23(_copyMode,this,"cells-only")}onCut(e){var t;const r=this.hot.getFocusManager().getRefocusElement(),i=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!_classPrivateFieldGet26(_isTriggeredByCut,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(i&&e.target!==r||!i&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),_classPrivateFieldSet23(_isTriggeredByCut,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const c=stringify2(o);if(e&&e.clipboardData){const u=_dataToHTML(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",c),e.clipboardData.setData("text/html",[META_HEAD,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",c);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){var t;const r=this.hot.getFocusManager().getRefocusElement(),i=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||e.target instanceof HTMLElement&&(i&&e.target!==r||!i&&e.target!==this.hot.rootDocument.body))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const d=sanitize(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});d&&/(<table)|(<TABLE)/g.test(d)?o=htmlToGridSettings(d,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=parse2(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[a,c,u,h]=this.populateValues(o);this.hot.selectCell(a,c,Math.min(this.hot.countRows()-1,u),Math.min(this.hot.countCols()-1,h)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}};function _ensureClipboardEventsGetTriggered(e){if(isSafari()){const t=this.hot.getSelectedRangeLast();if(t){const{row:r,col:i}=t.highlight,o=this.hot.getCell(r,i,!0);o&&runWithSelectedContendEditableElement(o,()=>{this.hot.rootDocument.execCommand(e)})}}else this.hot.rootDocument.execCommand(e)}function _countCopiedHeaders(e){const{rows:t}=normalizeRanges(e);let r=0;for(let i=0;i<t.length&&!(t[i]>=0);i++)r+=1;return{columnHeadersCount:r}}function _addContentEditableToHighlightedCell(){if(this.hot.isListening()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:r}=e.highlight,i=this.hot.getCell(t,r,!0);i&&makeElementContentEditableAndSelectItsContent(i)}}}function _removeContentEditableFromHighlightedCell(){if(this.hot.isListening()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:r}=e.highlight,i=this.hot.getCell(t,r,!0);i!=null&&i.hasAttribute("contenteditable")&&removeContentEditableFromElementAndDeselect(i)}}}function _onAfterContextMenuDefaultOptions(e){e.items.push({name:"---------"},copyItem(this)),_classPrivateFieldGet26(_enableCopyColumnHeaders,this)&&e.items.push(copyWithColumnHeadersItem(this)),_classPrivateFieldGet26(_enableCopyColumnGroupHeaders,this)&&e.items.push(copyWithColumnGroupHeadersItem(this)),_classPrivateFieldGet26(_enableCopyColumnHeadersOnly,this)&&e.items.push(copyColumnHeadersOnlyItem(this)),e.items.push(cutItem(this))}function _onAfterSelection(e,t,r,i,o){_classPrivateFieldGet26(_preventViewportScrollOnPaste,this)&&(o.value=!0),_classPrivateFieldSet23(_preventViewportScrollOnPaste,this,!1)}function _onAfterSelectionEnd(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function _onSafariMouseEnter(){_assertClassBrand34(_CopyPaste_brand,this,_removeContentEditableFromHighlightedCell).call(this)}function _onSafariMouseLeave(){_assertClassBrand34(_CopyPaste_brand,this,_addContentEditableToHighlightedCell).call(this)}function _onSafariAfterSelection(){_assertClassBrand34(_CopyPaste_brand,this,_removeContentEditableFromHighlightedCell).call(this)}var import_es_error_cause113=__toESM(require_es_error_cause(),1),import_es_array_push62=__toESM(require_es_array_push(),1);function createId(e,t){return`border_row${e}col${t}`}function createDefaultCustomBorder(){return{width:1,color:"#000"}}function createSingleEmptyBorder(){return{hide:!0}}function createDefaultHtBorder(){return{width:1,color:"#000",cornerVisible:!1}}function normalizeBorder(e){if(isDefined(e.start)||isDefined(e.left)){var t;e.start=(t=e.start)!==null&&t!==void 0?t:e.left}if(isDefined(e.end)||isDefined(e.right)){var r;e.end=(r=e.end)!==null&&r!==void 0?r:e.right}return delete e.left,delete e.right,e}function denormalizeBorder(e){return isDefined(e.start)&&(e.left=e.start),isDefined(e.end)&&(e.right=e.end),e}function createEmptyBorders(e,t){return{id:createId(e,t),border:createDefaultHtBorder(),row:e,col:t,top:createSingleEmptyBorder(),bottom:createSingleEmptyBorder(),start:createSingleEmptyBorder(),end:createSingleEmptyBorder()}}function extendDefaultBorder(e,t){return hasOwnProperty(t,"border")&&t.border&&(e.border=t.border),hasOwnProperty(t,"top")&&isDefined(t.top)&&(t.top?(isObject2(t.top)||(t.top=createDefaultCustomBorder()),e.top=t.top):(t.top=createSingleEmptyBorder(),e.top=t.top)),hasOwnProperty(t,"bottom")&&isDefined(t.bottom)&&(t.bottom?(isObject2(t.bottom)||(t.bottom=createDefaultCustomBorder()),e.bottom=t.bottom):(t.bottom=createSingleEmptyBorder(),e.bottom=t.bottom)),hasOwnProperty(t,"start")&&isDefined(t.start)&&(t.start?(isObject2(t.start)||(t.start=createDefaultCustomBorder()),e.start=t.start):(t.start=createSingleEmptyBorder(),e.start=t.start)),hasOwnProperty(t,"end")&&isDefined(t.end)&&(t.end?(isObject2(t.end)||(t.end=createDefaultCustomBorder()),e.end=t.end):(t.end=createSingleEmptyBorder(),e.end=t.end)),e}function checkSelectionBorders(e,t){let r=!1;return arrayEach(e.getSelectedRange(),i=>{i.forAll((o,a)=>{if(o<0||a<0)return;const c=e.getCellMeta(o,a).borders;if(c)if(t){if(!hasOwnProperty(c[t],"hide")||c[t].hide===!1)return r=!0,!1}else return r=!0,!1})}),r}function markSelected(e){return`<span class="selected">\u2713</span>${e}`}function hasLeftRightTypeOptions(e){return e.some(t=>isDefined(t.left)||isDefined(t.right))}function hasStartEndTypeOptions(e){return e.some(t=>isDefined(t.start)||isDefined(t.end))}var physicalToInlinePropNames=new Map([["left","start"],["right","end"]]);function toInlinePropName(e){var t;return(t=physicalToInlinePropNames.get(e))!==null&&t!==void 0?t:e}function bottom2(e){return{key:"borders:bottom",name(){let t=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_BOTTOM);return checkSelectionBorders(this,"bottom")&&(t=markSelected(t)),t},callback(t,r){const i=checkSelectionBorders(this,"bottom");e.prepareBorder(r,"bottom",i)}}}function left2(e){const t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let r=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_LEFT);return checkSelectionBorders(this,t)&&(r=markSelected(r)),r},callback(r,i){const o=checkSelectionBorders(this,t);e.prepareBorder(i,t,o)}}}function noBorders(e){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback(t,r){e.prepareBorder(r,"noBorders")},disabled(){return!checkSelectionBorders(this)}}}function right2(e){const t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let r=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_RIGHT);return checkSelectionBorders(this,t)&&(r=markSelected(r)),r},callback(r,i){const o=checkSelectionBorders(this,t);e.prepareBorder(i,t,o)}}}function top2(e){return{key:"borders:top",name(){let t=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_TOP);return checkSelectionBorders(this,"top")&&(t=markSelected(t)),t},callback(t,r){const i=checkSelectionBorders(this,"top");e.prepareBorder(r,"top",i)}}}function _classPrivateMethodInitSpec22(e,t){_checkPrivateRedeclaration35(e,t),t.add(e)}function _checkPrivateRedeclaration35(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty82(e,t,r){return(t=_toPropertyKey82(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey82(e){var t=_toPrimitive82(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive82(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand35(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var PLUGIN_KEY12="customBorders",PLUGIN_PRIORITY11=90,_CustomBorders_brand=new WeakSet,CustomBorders=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec22(this,_CustomBorders_brand),_defineProperty82(this,"savedBorders",[])}static get PLUGIN_KEY(){return PLUGIN_KEY12}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY11}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY12]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>_assertClassBrand35(_CustomBorders_brand,this,_onAfterContextMenuDefaultOptions2).call(this,e)),this.addHook("init",()=>_assertClassBrand35(_CustomBorders_brand,this,_onAfterInit2).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let r=["top","bottom","start","end"],i=null;t&&(this.checkSettingsCohesion([t]),r=Object.keys(t),i=normalizeBorder(t));const o=detectSelectionType(e),a=normalizeSelectionFactory(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});arrayEach(e,c=>{a(c).forAll((u,h)=>{arrayEach(r,d=>{this.prepareBorderFromCustomAdded(u,h,i,toInlinePropName(d))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=detectSelectionType(e),r=normalizeSelectionFactory(t,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return arrayEach(e,o=>{r(o).forAll((a,c)=>{arrayEach(this.savedBorders,u=>{u.row===a&&u.col===c&&i.push(denormalizeBorder(u))})})}),i}clearBorders(e){e?this.setBorders(e):(arrayEach(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,t,r,i){const o=this.hot.countRows(),a=this.hot.countCols();if(e>=o||t>=a)return;let c=createEmptyBorders(e,t);r&&(c=extendDefaultBorder(c,r),arrayEach(this.hot.selection.highlight.customSelections,u=>{if(c.id===u.settings.id)return Object.assign(u.settings,r),c.id=u.settings.id,c.top=u.settings.top,c.bottom=u.settings.bottom,c.start=u.settings.start,c.end=u.settings.end,!1})),this.hot.setCellMeta(e,t,"borders",denormalizeBorder(c)),this.insertBorderIntoSettings(c,i)}prepareBorderFromCustomAddedRange(e,t){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);rangeEach(e.from.row,r,o=>{rangeEach(e.from.col,i,a=>{const c=createEmptyBorders(o,a);let u=0;o===e.from.row&&hasOwnProperty(t,"top")&&(u+=1,c.top=t.top),o===e.to.row&&hasOwnProperty(t,"bottom")&&(u+=1,c.bottom=t.bottom),a===e.from.col&&hasOwnProperty(t,"start")&&(u+=1,c.start=t.start),a===e.to.col&&hasOwnProperty(t,"end")&&(u+=1,c.end=t.end),u>0&&(this.hot.setCellMeta(o,a,"borders",denormalizeBorder(c)),this.insertBorderIntoSettings(c))})})}removeAllBorders(e,t){const r=createId(e,t);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,r,i){let o=this.hot.getCellMeta(e,t).borders;!o||o.border===void 0?o=createEmptyBorders(e,t):o=normalizeBorder(o),i?(o[r]=createSingleEmptyBorder(),this.countHide(o)===4?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",denormalizeBorder(o)))):(o[r]=createDefaultCustomBorder(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",denormalizeBorder(o)))}prepareBorder(e,t,r){arrayEach(e,i=>{let{start:o,end:a}=i;if(o.row===a.row&&o.col===a.col)t==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,t,r);else switch(t){case"noBorders":rangeEach(o.col,a.col,c=>{rangeEach(o.row,a.row,u=>{this.removeAllBorders(u,c)})});break;case"top":rangeEach(o.col,a.col,c=>{this.setBorder(o.row,c,t,r)});break;case"bottom":rangeEach(o.col,a.col,c=>{this.setBorder(a.row,c,t,r)});break;case"start":rangeEach(o.row,a.row,c=>{this.setBorder(c,o.col,t,r)});break;case"end":rangeEach(o.row,a.row,c=>{this.setBorder(c,a.col,t,r)});break;default:break}})}createCustomBorders(e){arrayEach(e,t=>{const r=normalizeBorder(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,r):this.prepareBorderFromCustomAdded(t.row,t.col,r)})}countHide(e){const{top:t,bottom:r,start:i,end:o}=e;return arrayReduce([t,r,i,o],(c,u)=>{let h=c;return u&&u.hide&&(h+=1),h},0)}clearBordersFromSelectionSettings(e){const t=arrayMap(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){arrayEach(this.hot.selection.highlight.customSelections,(e,t)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){arrayEach(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const t=arrayMap(this.savedBorders,r=>r.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),t=!0):arrayEach(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,r){let i=!1;return arrayEach(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const a=this.hot.view._wt.selectionManager.getBorderInstances(o);return arrayEach(a,c=>{c.toggleHiddenClass(t,r)}),i=!0,!1}}),i}checkCustomSelections(e,t,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):arrayEach(this.hot.selection.highlight.customSelections,a=>{if(e.id===a.settings.id){if(a.visualCellRange=t,a.commit(),r){const c=this.hot.view._wt.selectionManager.getBorderInstances(a);arrayEach(c,u=>{u.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[PLUGIN_KEY12];if(Array.isArray(e)){const t=deepClone(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=hasLeftRightTypeOptions(e),r=hasStartEndTypeOptions(e);if(t&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}};function _onAfterContextMenuDefaultOptions2(e){this.hot.getSettings()[PLUGIN_KEY12]&&e.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS)},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[top2(this),right2(this),bottom2(this),left2(this),noBorders(this)]}})}function _onAfterInit2(){this.changeBorderSettings()}var import_es_error_cause114=__toESM(require_es_error_cause(),1);function _classPrivateMethodInitSpec23(e,t){_checkPrivateRedeclaration36(e,t),t.add(e)}function _checkPrivateRedeclaration36(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty83(e,t,r){return(t=_toPropertyKey83(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey83(e){var t=_toPrimitive83(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive83(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand36(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var PLUGIN_KEY13="dragToScroll",PLUGIN_PRIORITY12=100,_DragToScroll_brand=new WeakSet,DragToScroll=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec23(this,_DragToScroll_brand),_defineProperty83(this,"boundaries",null),_defineProperty83(this,"callback",null),_defineProperty83(this,"listening",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY13}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY12}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY13]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>_assertClassBrand36(_DragToScroll_brand,this,_setupListening).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>_assertClassBrand36(_DragToScroll_brand,this,_setupListening).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let r=0,i=0;t<this.boundaries.top?i=t-this.boundaries.top:t>this.boundaries.bottom&&(i=t-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",r=>this.onMouseMove(r)),t=getParentWindow(t)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}};function _setupListening(e){if(isRightClick(e))return;const t=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(t!==this.hot.rootWindow?t.getBoundingClientRect():void 0),this.setCallback((r,i)=>{var o,a;const c=(o=t.scrollLeft)!==null&&o!==void 0?o:t.scrollX,u=(a=t.scrollTop)!==null&&a!==void 0?a:t.scrollY;t.scroll(c+Math.sign(r)*50,u+Math.sign(i)*20)}),this.listen()}var import_es_error_cause115=__toESM(require_es_error_cause(),1);function _classPrivateMethodInitSpec24(e,t){_checkPrivateRedeclaration37(e,t),t.add(e)}function _classPrivateFieldInitSpec27(e,t,r){_checkPrivateRedeclaration37(e,t),t.set(e,r)}function _checkPrivateRedeclaration37(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty84(e,t,r){return(t=_toPropertyKey84(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey84(e){var t=_toPrimitive84(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive84(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet27(e,t){return e.get(_assertClassBrand37(e,t))}function _classPrivateFieldSet24(e,t,r){return e.set(_assertClassBrand37(e,t),r),r}function _assertClassBrand37(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}pluginHooks_default.getSingleton().register("afterDropdownMenuDefaultOptions"),pluginHooks_default.getSingleton().register("beforeDropdownMenuShow"),pluginHooks_default.getSingleton().register("afterDropdownMenuShow"),pluginHooks_default.getSingleton().register("afterDropdownMenuHide"),pluginHooks_default.getSingleton().register("afterDropdownMenuExecute");var PLUGIN_KEY14="dropdownMenu",PLUGIN_PRIORITY13=230,BUTTON_CLASS_NAME="changeType",SHORTCUTS_GROUP10=PLUGIN_KEY14,_isButtonClicked=new WeakMap,_DropdownMenu_brand=new WeakSet,DropdownMenu=class ss extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY14}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY13}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[KEY4,KEY5,KEY,KEY8,KEY,KEY3,KEY,KEY6,KEY,KEY2]}constructor(t){super(t),_classPrivateMethodInitSpec24(this,_DropdownMenu_brand),_defineProperty84(this,"commandExecutor",new CommandExecutor(this.hot)),_defineProperty84(this,"itemsFactory",null),_defineProperty84(this,"menu",null),_classPrivateFieldInitSpec27(this,_isButtonClicked,!1),this.hot.addHook("afterGetColHeader",(r,i)=>_assertClassBrand37(_DropdownMenu_brand,this,_onAfterGetColHeader3).call(this,r,i))}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY14]}enablePlugin(){var t=this;if(this.enabled)return;this.itemsFactory=new ItemsFactory(this.hot,ss.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return _assertClassBrand37(_DropdownMenu_brand,t,_onBeforeOnCellMouseDown3).call(t,...a)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return _assertClassBrand37(_DropdownMenu_brand,t,_onBeforeViewportScrollHorizontally).call(t,...a)});const r=this.hot.getSettings()[PLUGIN_KEY14],i={items:this.itemsFactory.getItems(r)};this.registerEvents(),typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);const o=this.itemsFactory.getItems(r);this.menu&&this.menu.destroy(),this.menu=new Menu(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",o),this.menu.setMenuItems(o),this.menu.addLocalHook("beforeOpen",()=>_assertClassBrand37(_DropdownMenu_brand,this,_onMenuBeforeOpen2).call(this)),this.menu.addLocalHook("afterOpen",()=>_assertClassBrand37(_DropdownMenu_brand,this,_onMenuAfterOpen2).call(this)),this.menu.addLocalHook("afterSubmenuOpen",a=>_assertClassBrand37(_DropdownMenu_brand,this,_onSubMenuAfterOpen).call(this,a)),this.menu.addLocalHook("afterClose",()=>_assertClassBrand37(_DropdownMenu_brand,this,_onMenuAfterClose2).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return t.executeCommand.call(t,...c)}),arrayEach(o,a=>this.commandExecutor.registerCommand(a.key,a))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("grid"),r=()=>{const{highlight:i}=this.hot.getSelectedRangeLast();if((i.isHeader()&&i.row===-1||i.isCell())&&i.col>=0){this.hot.selectColumns(i.col,i.col,-1);const{from:o}=this.hot.getSelectedRangeLast(),a=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument),c=this.hot.getCell(-1,o.col,!0).querySelector(`.${BUTTON_CLASS_NAME}`),u=c.getBoundingClientRect();this.open({left:u.left+a.left,top:u.top+c.offsetHeight+a.top},{left:u.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};t.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:r,runOnlyIf:()=>{var i;const o=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return o&&this.hot.selection.isCellVisible(o)&&o.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:SHORTCUTS_GROUP10},{keys:[["Shift","Alt","ArrowDown"]],callback:r,runOnlyIf:()=>{var i;const o=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return o&&this.hot.selection.isCellVisible(o)&&o.isCell()&&!this.menu.isOpened()},group:SHORTCUTS_GROUP10}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP10)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",t=>_assertClassBrand37(_DropdownMenu_brand,this,_onTableClick).call(this,t))}open(t){var r;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(r=this.menu)!==null&&r!==void 0&&r.isOpened()||(this.menu.open(),objectEach(i,(o,a)=>{this.menu.setOffset(a,o)}),this.menu.setPosition(t))}close(){var t;(t=this.menu)===null||t===void 0||t.close()}executeCommand(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];this.commandExecutor.execute(t,...i)}setListening(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}};function _addCustomShortcuts(e){e.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function _onTableClick(e){if(hasClass(e.target,BUTTON_CLASS_NAME)){const t=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument),r=e.target.getBoundingClientRect();e.stopPropagation(),_classPrivateFieldSet24(_isButtonClicked,this,!1),this.open({left:r.left+t.left,top:r.top+e.target.offsetHeight+t.top},{left:r.width,right:0,above:0,below:3})}}function _onAfterGetColHeader3(e,t){const r=t.parentNode;if(!r)return;const i=r.parentNode.childNodes,o=Array.prototype.indexOf.call(i,r);if(e<0||o!==i.length-1)return;const a=t.querySelector(`.${BUTTON_CLASS_NAME}`);if(this.enabled&&a)return;if(!this.enabled){a&&a.parentNode.removeChild(a);return}const c=this.hot.rootDocument.createElement("button");c.className=BUTTON_CLASS_NAME,c.type="button",c.tabIndex=-1,this.hot.getSettings().ariaTags&&(setAttribute(c,[A11Y_HIDDEN(),A11Y_LABEL(" ")]),setAttribute(t,[A11Y_HASPOPUP("menu")])),c.onclick=function(){return!1},t.firstChild.insertBefore(c,t.firstChild.firstChild)}function _onMenuBeforeOpen2(){this.hot.runHooks("beforeDropdownMenuShow",this)}function _onMenuAfterOpen2(){this.hot.runHooks("afterDropdownMenuShow",this),_assertClassBrand37(_DropdownMenu_brand,this,_addCustomShortcuts).call(this,this.menu)}function _onSubMenuAfterOpen(e){_assertClassBrand37(_DropdownMenu_brand,this,_addCustomShortcuts).call(this,e)}function _onMenuAfterClose2(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function _onBeforeViewportScrollHorizontally(e){return _classPrivateFieldGet27(_isButtonClicked,this)?null:e}function _onBeforeOnCellMouseDown3(e){hasClass(e.target,BUTTON_CLASS_NAME)&&_classPrivateFieldSet24(_isButtonClicked,this,!0)}DropdownMenu.SEPARATOR={name:KEY};var import_es_error_cause118=__toESM(require_es_error_cause(),1),import_es_error_cause116=__toESM(require_es_error_cause(),1),import_es_array_push63=__toESM(require_es_array_push(),1);function _defineProperty85(e,t,r){return(t=_toPropertyKey85(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey85(e){var t=_toPrimitive85(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive85(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DataProvider=class{constructor(e){_defineProperty85(this,"hot",void 0),_defineProperty85(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:r,endCol:i}=this._getDataRange(),o=this.options,a=[];return rangeEach(e,r,c=>{const u=[];!o.exportHiddenRows&&this._isHiddenRow(c)||(rangeEach(t,i,h=>{!o.exportHiddenColumns&&this._isHiddenColumn(h)||u.push(this.hot.getDataAtCell(c,h))}),a.push(u))}),a}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();rangeEach(t,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();rangeEach(t,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[r=0,i=0,o=t,a=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,t),a=Math.min(a,e),{startRow:r,startCol:i,endRow:o,endCol:a}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}},dataProvider_default=DataProvider,import_es_error_cause117=__toESM(require_es_error_cause(),1);function _defineProperty86(e,t,r){return(t=_toPropertyKey86(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey86(e){var t=_toPrimitive86(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive86(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BaseType=class os{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(t,r){_defineProperty86(this,"dataProvider",void 0),_defineProperty86(this,"options",void 0),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}_mergeOptions(t){let r=clone3(this.constructor.DEFAULT_OPTIONS);const i=new Date;return r=extend2(clone3(os.DEFAULT_OPTIONS),r),r=extend2(r,t),r.filename=substitute(r.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),r}},base_default2=BaseType,CHAR_CARRIAGE_RETURN="\r",CHAR_DOUBLE_QUOTES='"',CHAR_LINE_FEED=`
`,Csv=class extends base_default2{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,t=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),a=o.length>0;let c=e.bom?"\uFEFF":"";return i&&(r=arrayMap(r,u=>this._escapeCell(u,!0)),a&&(c+=e.columnDelimiter),c+=r.join(e.columnDelimiter),c+=e.rowDelimiter),arrayEach(t,(u,h)=>{h>0&&(c+=e.rowDelimiter),a&&(c+=this._escapeCell(o[h])+e.columnDelimiter),c+=u.map(d=>this._escapeCell(d)).join(e.columnDelimiter)}),c}_escapeCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=stringify(e);return r!==""&&(t||r.indexOf(CHAR_CARRIAGE_RETURN)>=0||r.indexOf(CHAR_DOUBLE_QUOTES)>=0||r.indexOf(CHAR_LINE_FEED)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}},csv_default=Csv,TYPE_CSV="csv",EXPORT_TYPES={[TYPE_CSV]:csv_default};function typeFactory(e,t,r){return typeof EXPORT_TYPES[e]=="function"?new EXPORT_TYPES[e](t,r):null}var PLUGIN_KEY15="exportFile",PLUGIN_PRIORITY14=240,ExportFile=class extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY15}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY14}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,t),a=this._createBlob(o),c=i.URL||i.webkitURL,u=r.createElement("a"),h=`${o.options.filename}.${o.options.fileExtension}`;if(u.download!==void 0){const d=c.createObjectURL(a);u.style.display="none",u.setAttribute("href",d),u.setAttribute("download",h),r.body.appendChild(u),u.dispatchEvent(new MouseEvent("click")),r.body.removeChild(u),setTimeout(()=>{c.revokeObjectURL(d)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(a,h)}_createTypeFormatter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!EXPORT_TYPES[e])throw new Error(`Export format type "${e}" is not supported.`);return typeFactory(e,new dataProvider_default(this.hot),t)}_createBlob(e){let t=null;return typeof Blob<"u"&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}},import_es_error_cause136=__toESM(require_es_error_cause(),1),import_es_array_push74=__toESM(require_es_array_push(),1),import_es_array_unscopables_flat2=__toESM(require_es_array_unscopables_flat(),1),import_es_error_cause126=__toESM(require_es_error_cause(),1),import_es_array_push66=__toESM(require_es_array_push(),1),import_es_error_cause119=__toESM(require_es_error_cause(),1);function _defineProperty87(e,t,r){return(t=_toPropertyKey87(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey87(e){var t=_toPrimitive87(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive87(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BaseComponent=class{constructor(e,t){let{id:r,stateless:i=!0}=t;_defineProperty87(this,"hot",void 0),_defineProperty87(this,"id",void 0),_defineProperty87(this,"elements",[]),_defineProperty87(this,"hidden",!1),_defineProperty87(this,"stateId",""),_defineProperty87(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new LinkedPhysicalIndexToValueMap)}getElements(){return this.elements}reset(){arrayEach(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),arrayEach(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}};mixin(BaseComponent,localHooks_default);var import_es_array_push65=__toESM(require_es_array_push(),1),import_es_error_cause120=__toESM(require_es_error_cause(),1),conditions={};function getCondition(e,t){if(!conditions[e])throw Error(`Filter condition "${e}" does not exist.`);const{condition:r,descriptor:i}=conditions[e];let o=t;return i.inputValuesDecorator&&(o=i.inputValuesDecorator(o)),function(a){return r.apply(a.meta.instance,[].concat([a],[o]))}}function getConditionDescriptor(e){if(!conditions[e])throw Error(`Filter condition "${e}" does not exist.`);return conditions[e].descriptor}function registerCondition(e,t,r){r.key=e,conditions[e]={condition:t,descriptor:r}}var CONDITION_NAME="none";function condition(){return!0}registerCondition(CONDITION_NAME,condition,{name:FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1});var CONDITION_NAME2="empty";function condition2(e){return isEmpty(e.value)}registerCondition(CONDITION_NAME2,condition2,{name:FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0});var CONDITION_NAME3="not_empty";function condition3(e,t){return!getCondition(CONDITION_NAME2,t)(e)}registerCondition(CONDITION_NAME3,condition3,{name:FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0});var CONDITION_NAME4="eq";function condition4(e,t){let[r]=t;return stringify(e.value).toLocaleLowerCase(e.meta.locale)===stringify(r)}registerCondition(CONDITION_NAME4,condition4,{name:FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0});var CONDITION_NAME5="neq";function condition5(e,t){return!getCondition(CONDITION_NAME4,t)(e)}registerCondition(CONDITION_NAME5,condition5,{name:FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0});var CONDITION_NAME6="gt";function condition6(e,t){let[r]=t,i=r;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value>i}registerCondition(CONDITION_NAME6,condition6,{name:FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0});var CONDITION_NAME7="gte";function condition7(e,t){let[r]=t,i=r;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value>=i}registerCondition(CONDITION_NAME7,condition7,{name:FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});var CONDITION_NAME8="lt";function condition8(e,t){let[r]=t,i=r;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value<i}registerCondition(CONDITION_NAME8,condition8,{name:FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0});var CONDITION_NAME9="lte";function condition9(e,t){let[r]=t,i=r;return e.meta.type==="numeric"&&(i=parseFloat(i,10)),e.value<=i}registerCondition(CONDITION_NAME9,condition9,{name:FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});var import_moment6=__toESM(require_moment(),1),CONDITION_NAME10="date_after";function condition10(e,t){let[r]=t;const i=(0,import_moment6.default)(e.value,e.meta.dateFormat),o=(0,import_moment6.default)(r,e.meta.dateFormat);return!i.isValid()||!o.isValid()?!1:i.diff(o)>=0}registerCondition(CONDITION_NAME10,condition10,{name:FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0});var import_moment7=__toESM(require_moment(),1),CONDITION_NAME11="date_before";function condition11(e,t){let[r]=t;const i=(0,import_moment7.default)(e.value,e.meta.dateFormat),o=(0,import_moment7.default)(r,e.meta.dateFormat);return!i.isValid()||!o.isValid()?!1:i.diff(o)<=0}registerCondition(CONDITION_NAME11,condition11,{name:FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0});var CONDITION_NAME12="between";function condition12(e,t){let[r,i]=t,o=r,a=i;if(e.meta.type==="numeric"){const c=parseFloat(o,10),u=parseFloat(a,10);o=Math.min(c,u),a=Math.max(c,u)}else if(e.meta.type==="date"){const c=getCondition(CONDITION_NAME11,[a]),u=getCondition(CONDITION_NAME10,[o]);return c(e)&&u(e)}return e.value>=o&&e.value<=a}registerCondition(CONDITION_NAME12,condition12,{name:FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0});var CONDITION_NAME13="not_between";function condition13(e,t){return!getCondition(CONDITION_NAME12,t)(e)}registerCondition(CONDITION_NAME13,condition13,{name:FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0});var CONDITION_NAME14="begins_with";function condition14(e,t){let[r]=t;return stringify(e.value).toLocaleLowerCase(e.meta.locale).startsWith(stringify(r))}registerCondition(CONDITION_NAME14,condition14,{name:FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0});var CONDITION_NAME15="ends_with";function condition15(e,t){let[r]=t;return stringify(e.value).toLocaleLowerCase(e.meta.locale).endsWith(stringify(r))}registerCondition(CONDITION_NAME15,condition15,{name:FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0});var CONDITION_NAME16="contains";function condition16(e,t){let[r]=t;return stringify(e.value).toLocaleLowerCase(e.meta.locale).indexOf(stringify(r))>=0}registerCondition(CONDITION_NAME16,condition16,{name:FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0});var CONDITION_NAME17="not_contains";function condition17(e,t){return!getCondition(CONDITION_NAME16,t)(e)}registerCondition(CONDITION_NAME17,condition17,{name:FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0});var import_moment8=__toESM(require_moment(),1),CONDITION_NAME18="date_tomorrow";function condition18(e){const t=(0,import_moment8.default)(e.value,e.meta.dateFormat);return t.isValid()?t.isSame((0,import_moment8.default)().subtract(-1,"days").startOf("day"),"d"):!1}registerCondition(CONDITION_NAME18,condition18,{name:FILTERS_CONDITIONS_TOMORROW,inputsCount:0});var import_moment9=__toESM(require_moment(),1),CONDITION_NAME19="date_today";function condition19(e){const t=(0,import_moment9.default)(e.value,e.meta.dateFormat);return t.isValid()?t.isSame((0,import_moment9.default)().startOf("day"),"d"):!1}registerCondition(CONDITION_NAME19,condition19,{name:FILTERS_CONDITIONS_TODAY,inputsCount:0});var import_moment10=__toESM(require_moment(),1),CONDITION_NAME20="date_yesterday";function condition20(e){const t=(0,import_moment10.default)(e.value,e.meta.dateFormat);return t.isValid()?t.isSame((0,import_moment10.default)().subtract(1,"days").startOf("day"),"d"):!1}registerCondition(CONDITION_NAME20,condition20,{name:FILTERS_CONDITIONS_YESTERDAY,inputsCount:0});var import_es_array_push64=__toESM(require_es_array_push(),1),import_es_set_difference_v218=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v218=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v218=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v218=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v218=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v218=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v218=__toESM(require_es_set_union_v2(),1),sortCompare=getComparisonFunction();function toVisualValue(e,t){let r=e;return r===""&&(r=`(${t})`),r}var SUPPORT_SET_CONSTRUCTOR=new Set([1]).has(1),SUPPORT_FAST_DEDUPE=SUPPORT_SET_CONSTRUCTOR&&typeof Array.from=="function";function createArrayAssertion(e){let t=e;return SUPPORT_SET_CONSTRUCTOR&&(t=new Set(t)),function(r){let i;return SUPPORT_SET_CONSTRUCTOR?i=t.has(r):i=!!~t.indexOf(r),i}}function toEmptyString(e){return e??""}function unifyColumnValues(e){let t=e;return SUPPORT_FAST_DEDUPE?t=Array.from(new Set(t)):t=arrayUnique(t),t=t.sort((r,i)=>typeof r=="number"&&typeof i=="number"?r-i:r===i?0:r>i?1:-1),t}function intersectValues(e,t,r,i){const o=[],a=e===t;let c;return a||(c=createArrayAssertion(t)),arrayEach(e,u=>{let h=!1;(a||c(u))&&(h=!0);const d={checked:h,value:u,visualValue:toVisualValue(u,r)};i&&i(d),o.push(d)}),o}var CONDITION_NAME21="by_value";function condition21(e,t){let[r]=t;return r(e.value)}registerCondition(CONDITION_NAME21,condition21,{name:"By value",inputsCount:0,inputValuesDecorator(e){let[t]=e;return[createArrayAssertion(t)]},showOperators:!1});var import_es_error_cause121=__toESM(require_es_error_cause(),1),operations={};function getOperationFunc(e){if(!operations[e])throw Error(`Operation with id "${e}" does not exist.`);const t=operations[e].func;return function(r,i){return t(r,i)}}function getOperationName(e){return operations[e].name}function registerOperation(e,t,r){operations[e]={name:t,func:r}}var OPERATION_ID="conjunction",SHORT_NAME_FOR_COMPONENT=FILTERS_LABELS_CONJUNCTION;function operationResult(e,t){return e.every(r=>r.func(t))}registerOperation(OPERATION_ID,SHORT_NAME_FOR_COMPONENT,operationResult);var OPERATION_ID2="disjunction",SHORT_NAME_FOR_COMPONENT2=FILTERS_LABELS_DISJUNCTION;function operationResult2(e,t){return e.some(r=>r.func(t))}registerOperation(OPERATION_ID2,SHORT_NAME_FOR_COMPONENT2,operationResult2);var import_es_error_cause122=__toESM(require_es_error_cause(),1),OPERATION_ID3="disjunctionWithExtraCondition",SHORT_NAME_FOR_COMPONENT3=FILTERS_LABELS_DISJUNCTION;function operationResult3(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(r=>r.func(t))&&e[e.length-1].func(t)}registerOperation(OPERATION_ID3,SHORT_NAME_FOR_COMPONENT3,operationResult3);var TYPE_NUMERIC="numeric",TYPE_TEXT="text",TYPE_DATE="date",TYPES={[TYPE_NUMERIC]:[CONDITION_NAME,KEY,CONDITION_NAME2,CONDITION_NAME3,KEY,CONDITION_NAME4,CONDITION_NAME5,KEY,CONDITION_NAME6,CONDITION_NAME7,CONDITION_NAME8,CONDITION_NAME9,CONDITION_NAME12,CONDITION_NAME13],[TYPE_TEXT]:[CONDITION_NAME,KEY,CONDITION_NAME2,CONDITION_NAME3,KEY,CONDITION_NAME4,CONDITION_NAME5,KEY,CONDITION_NAME14,CONDITION_NAME15,KEY,CONDITION_NAME16,CONDITION_NAME17],[TYPE_DATE]:[CONDITION_NAME,KEY,CONDITION_NAME2,CONDITION_NAME3,KEY,CONDITION_NAME4,CONDITION_NAME5,KEY,CONDITION_NAME11,CONDITION_NAME10,CONDITION_NAME12,KEY,CONDITION_NAME18,CONDITION_NAME19,CONDITION_NAME20]};function getOptionsList(e){const t=[];let r=e;return TYPES[r]||(r=TYPE_TEXT),arrayEach(TYPES[r],i=>{let o;i===KEY?o={name:KEY}:o=clone3(getConditionDescriptor(i)),t.push(o)}),t}var import_es_error_cause124=__toESM(require_es_error_cause(),1),import_es_error_cause123=__toESM(require_es_error_cause(),1);function _defineProperty88(e,t,r){return(t=_toPropertyKey88(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey88(e){var t=_toPrimitive88(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive88(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var STATE_BUILT="built",STATE_BUILDING="building",EVENTS_TO_REGISTER=["click","input","keydown","keypress","keyup","focus","blur","change"],BaseUI=class as{static get DEFAULTS(){return clone3({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(t,r){_defineProperty88(this,"hot",void 0),_defineProperty88(this,"eventManager",new eventManager_default(this)),_defineProperty88(this,"options",void 0),_defineProperty88(this,"_element",void 0),_defineProperty88(this,"buildState",void 0),this.hot=t,this.options=extend2(as.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(t){this.options.value=t,this.update()}getValue(){return this.options.value}get element(){return this.buildState===STATE_BUILDING?this._element:this.buildState===STATE_BUILT?(this.update(),this._element):(this.buildState=STATE_BUILDING,this.build(),this.buildState=STATE_BUILT,this._element)}isBuilt(){return this.buildState===STATE_BUILT}translateIfPossible(t){return typeof t=="string"&&t.startsWith(FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(t):t}build(){const t=(r,i)=>{this.eventManager.addEventListener(r,i,o=>this.runLocalHooks(i,o,this))};if(this.buildState||(this.buildState=STATE_BUILDING),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&addClass(this._element,this.options.className),this.options.children.length)arrayEach(this.options.children,r=>this._element.appendChild(r.element));else if(this.options.wrapIt){const r=this.hot.rootDocument.createElement(this.options.tagName);r.setAttribute("data-hot-input",!0),objectEach(this.options,(i,o)=>{r[o]!==void 0&&o!=="className"&&o!=="tagName"&&o!=="children"&&(r[o]=this.translateIfPossible(i))}),this._element.appendChild(r),arrayEach(EVENTS_TO_REGISTER,i=>t(r,i))}else arrayEach(EVENTS_TO_REGISTER,r=>t(this._element,r))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};mixin(BaseUI,localHooks_default);function _classPrivateMethodInitSpec25(e,t){_checkPrivateRedeclaration38(e,t),t.add(e)}function _classPrivateFieldInitSpec28(e,t,r){_checkPrivateRedeclaration38(e,t),t.set(e,r)}function _checkPrivateRedeclaration38(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet28(e,t){return e.get(_assertClassBrand38(e,t))}function _classPrivateFieldSet25(e,t,r){return e.set(_assertClassBrand38(e,t),r),r}function _assertClassBrand38(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _input=new WeakMap,_InputUI_brand=new WeakSet,InputUI=class ls extends BaseUI{static get DEFAULTS(){return clone3({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(t,r){super(t,extend2(ls.DEFAULTS,r)),_classPrivateMethodInitSpec25(this,_InputUI_brand),_classPrivateFieldInitSpec28(this,_input,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",t=>_assertClassBrand38(_InputUI_brand,this,_onKeyup).call(this,t))}build(){super.build();const t=this.hot.rootDocument.createElement("div");_classPrivateFieldSet25(_input,this,this._element.firstChild),addClass(this._element,"htUIInput"),addClass(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(_classPrivateFieldGet28(_input,this).type=this.options.type,_classPrivateFieldGet28(_input,this).placeholder=this.translateIfPossible(this.options.placeholder),_classPrivateFieldGet28(_input,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&_classPrivateFieldGet28(_input,this).focus()}};function _onKeyup(e){this.options.value=e.target.value}var import_es_error_cause125=__toESM(require_es_error_cause(),1);function _classPrivateMethodInitSpec26(e,t){_checkPrivateRedeclaration39(e,t),t.add(e)}function _classPrivateFieldInitSpec29(e,t,r){_checkPrivateRedeclaration39(e,t),t.set(e,r)}function _checkPrivateRedeclaration39(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet26(e,t,r){return e.set(_assertClassBrand39(e,t),r),r}function _classPrivateFieldGet29(e,t){return e.get(_assertClassBrand39(e,t))}function _assertClassBrand39(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _menu=new WeakMap,_items=new WeakMap,_caption=new WeakMap,_captionElement=new WeakMap,_dropdown=new WeakMap,_SelectUI_brand=new WeakSet,SelectUI=class cs extends BaseUI{static get DEFAULTS(){return clone3({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(t,r){super(t,extend2(cs.DEFAULTS,r)),_classPrivateMethodInitSpec26(this,_SelectUI_brand),_classPrivateFieldInitSpec29(this,_menu,null),_classPrivateFieldInitSpec29(this,_items,[]),_classPrivateFieldInitSpec29(this,_caption,void 0),_classPrivateFieldInitSpec29(this,_captionElement,void 0),_classPrivateFieldInitSpec29(this,_dropdown,void 0),this.registerHooks()}getMenu(){return _classPrivateFieldGet29(_menu,this)}registerHooks(){this.addLocalHook("click",()=>_assertClassBrand39(_SelectUI_brand,this,_onClick).call(this))}setItems(t){_classPrivateFieldSet26(_items,this,this.translateNames(t)),_classPrivateFieldGet29(_menu,this)&&_classPrivateFieldGet29(_menu,this).setMenuItems(_classPrivateFieldGet29(_items,this))}translateNames(t){return arrayEach(t,r=>{r.name=this.translateIfPossible(r.name)}),t}build(){super.build(),_classPrivateFieldSet26(_menu,this,new Menu(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),_classPrivateFieldGet29(_menu,this).setMenuItems(_classPrivateFieldGet29(_items,this));const t=new BaseUI(this.hot,{className:"htUISelectCaption"}),r=new BaseUI(this.hot,{className:"htUISelectDropdown"});_classPrivateFieldSet26(_caption,this,t),_classPrivateFieldSet26(_captionElement,this,t.element),_classPrivateFieldSet26(_dropdown,this,r),this.hot.getSettings().ariaTags&&(setAttribute(r.element,[A11Y_HIDDEN()]),setAttribute(this._element,[A11Y_LISTBOX()])),arrayEach([t,r],i=>this._element.appendChild(i.element)),_classPrivateFieldGet29(_menu,this).addLocalHook("select",i=>_assertClassBrand39(_SelectUI_brand,this,_onMenuSelect).call(this,i)),_classPrivateFieldGet29(_menu,this).addLocalHook("afterClose",()=>_assertClassBrand39(_SelectUI_brand,this,_onMenuClosed).call(this)),this.update()}update(){if(!this.isBuilt())return;let t;this.options.value?t=this.options.value.name:t=_classPrivateFieldGet29(_menu,this).hot.getTranslatedPhrase(FILTERS_CONDITIONS_NONE),_classPrivateFieldGet29(_captionElement,this).textContent=t,super.update()}openOptions(){const t=this.element.getBoundingClientRect();_classPrivateFieldGet29(_menu,this)&&(_classPrivateFieldGet29(_menu,this).open(),_classPrivateFieldGet29(_menu,this).setPosition({left:this.hot.isLtr()?t.left-5:t.left-31,top:t.top-1,width:t.width,height:t.height}),_classPrivateFieldGet29(_menu,this).getNavigator().toFirstItem(),_classPrivateFieldGet29(_menu,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:r=>{this.closeOptions(),this.runLocalHooks("tabKeydown",r)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){_classPrivateFieldGet29(_menu,this)&&_classPrivateFieldGet29(_menu,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){_classPrivateFieldGet29(_menu,this)&&(_classPrivateFieldGet29(_menu,this).destroy(),_classPrivateFieldSet26(_menu,this,null)),_classPrivateFieldGet29(_caption,this)&&_classPrivateFieldGet29(_caption,this).destroy(),_classPrivateFieldGet29(_dropdown,this)&&_classPrivateFieldGet29(_dropdown,this).destroy(),super.destroy()}};function _onMenuSelect(e){e.name!==KEY&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}function _onMenuClosed(){this.runLocalHooks("afterClose")}function _onClick(){this.openOptions()}function _classPrivateMethodInitSpec27(e,t){_checkPrivateRedeclaration40(e,t),t.add(e)}function _checkPrivateRedeclaration40(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty89(e,t,r){return(t=_toPropertyKey89(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey89(e){var t=_toPrimitive89(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive89(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand40(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _ConditionComponent_brand=new WeakSet,ConditionComponent=class extends BaseComponent{constructor(e,t){super(e,{id:t.id,stateless:!1}),_classPrivateMethodInitSpec27(this,_ConditionComponent_brand),_defineProperty89(this,"name",""),_defineProperty89(this,"addSeparator",!1),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new SelectUI(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new InputUI(this.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_VALUE})),this.elements.push(new InputUI(this.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>_assertClassBrand40(_ConditionComponent_brand,this,_onConditionSelect).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),arrayEach(this.getInputElements(),e=>{e.addLocalHook("keydown",t=>_assertClassBrand40(_ConditionComponent_brand,this,_onInputKeyDown).call(this,t))})}setState(e){if(this.reset(),!e)return;const t=clone3(e.command);t.name.startsWith(FILTERS_CONDITIONS_NAMESPACE)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),arrayEach(e.args,(r,i)=>{if(i>t.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[t.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||getConditionDescriptor(CONDITION_NAME),t=[];return arrayEach(this.getInputElements(),(r,i)=>{e.inputsCount>i&&t.push(r.getValue())}),{command:e,args:t}}updateState(e,t){const r=getConditionDescriptor(e?e.name:CONDITION_NAME);this.state.setValueAtIndex(t,{command:r,args:e?e.args:[]}),e||arrayEach(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof SelectUI)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof InputUI)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,r,i,o,a)=>{addClass(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&addClass(t.parentNode,"border");const c=this.hot.rootDocument.createElement("div");return addClass(c,"htFiltersMenuLabel"),c.textContent=a,t.appendChild(c),t.parentElement.hasAttribute("ghost-table")||arrayEach(this.elements,u=>t.appendChild(u.element)),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[getConditionDescriptor(CONDITION_NAME)];if(e!==null){const{visualIndex:r}=e;t=getOptionsList(this.hot.getDataType(0,r,this.hot.countRows(),r))}arrayEach(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}};function _onConditionSelect(e){arrayEach(this.getInputElements(),(t,r)=>{t[e.inputsCount>r?"show":"hide"](),r===0&&this.hot._registerTimeout(()=>t.focus(),10)}),this.runLocalHooks("change",e)}function _onInputKeyDown(e){isKey(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),stopImmediatePropagation(e))}var import_es_error_cause128=__toESM(require_es_error_cause(),1),import_es_array_push67=__toESM(require_es_array_push(),1),import_es_error_cause127=__toESM(require_es_error_cause(),1);function _classPrivateFieldInitSpec30(e,t,r){_checkPrivateRedeclaration41(e,t),t.set(e,r)}function _checkPrivateRedeclaration41(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet30(e,t){return e.get(_assertClassBrand41(e,t))}function _classPrivateFieldSet27(e,t,r){return e.set(_assertClassBrand41(e,t),r),r}function _assertClassBrand41(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _input2=new WeakMap,_label=new WeakMap,RadioInputUI=class us extends BaseUI{static get DEFAULTS(){return clone3({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(t,r){super(t,extend2(us.DEFAULTS,r)),_classPrivateFieldInitSpec30(this,_input2,void 0),_classPrivateFieldInitSpec30(this,_label,void 0)}build(){super.build();const t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),_classPrivateFieldSet27(_label,this,t),_classPrivateFieldSet27(_input2,this,this._element.firstChild),_classPrivateFieldGet30(_input2,this).checked=this.options.checked,this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(_classPrivateFieldGet30(_label,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?_classPrivateFieldGet30(_input2,this).checked:!1}setChecked(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(_classPrivateFieldGet30(_input2,this).checked=t)}focus(){this.isBuilt()&&_classPrivateFieldGet30(_input2,this).focus()}};function _classPrivateMethodInitSpec28(e,t){_checkPrivateRedeclaration42(e,t),t.add(e)}function _checkPrivateRedeclaration42(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty90(e,t,r){return(t=_toPropertyKey90(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey90(e){var t=_toPrimitive90(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive90(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand42(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var SELECTED_AT_START_ELEMENT_INDEX=0,_OperatorsComponent_brand=new WeakSet,OperatorsComponent=class extends BaseComponent{constructor(e,t){super(e,{id:t.id,stateless:!1}),_classPrivateMethodInitSpec28(this,_OperatorsComponent_brand),_defineProperty90(this,"name",""),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(addClass(t.parentNode,"htFiltersMenuOperators"),arrayEach(this.elements,r=>t.appendChild(r.element)),t)}}buildOperatorsElement(){const e=[OPERATION_ID,OPERATION_ID2];arrayEach(e,t=>{const r=new RadioInputUI(this.hot,{name:"operator",label:{htmlFor:t,textContent:getOperationName(t)},value:t,checked:t===e[SELECTED_AT_START_ELEMENT_INDEX],id:t});r.addLocalHook("change",i=>_assertClassBrand42(_OperatorsComponent_brand,this,_onRadioInputChange).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(toSingleLine`Radio button with index ${e} doesn't exist.`);arrayEach(this.elements,(t,r)=>{t.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(t=>t instanceof RadioInputUI&&t.isChecked());return e?e.getValue():OPERATION_ID}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&arrayEach(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:OPERATION_ID,t=arguments.length>1?arguments[1]:void 0,r=e;r===OPERATION_ID3&&(r=OPERATION_ID2),this.state.setValueAtIndex(t,r)}reset(){this.setChecked(SELECTED_AT_START_ELEMENT_INDEX)}};function _onRadioInputChange(e){this.setState(e.target.value)}var import_es_error_cause131=__toESM(require_es_error_cause(),1),import_es_array_push69=__toESM(require_es_array_push(),1),import_es_error_cause130=__toESM(require_es_error_cause(),1),import_es_array_push68=__toESM(require_es_array_push(),1),import_es_error_cause129=__toESM(require_es_error_cause(),1);function _classPrivateFieldInitSpec31(e,t,r){_checkPrivateRedeclaration43(e,t),t.set(e,r)}function _checkPrivateRedeclaration43(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet31(e,t){return e.get(_assertClassBrand43(e,t))}function _classPrivateFieldSet28(e,t,r){return e.set(_assertClassBrand43(e,t),r),r}function _assertClassBrand43(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _link=new WeakMap,LinkUI=class hs extends BaseUI{static get DEFAULTS(){return clone3({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(t,r){super(t,extend2(hs.DEFAULTS,r)),_classPrivateFieldInitSpec31(this,_link,void 0)}build(){super.build(),_classPrivateFieldSet28(_link,this,this._element.firstChild)}update(){this.isBuilt()&&(_classPrivateFieldGet31(_link,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&_classPrivateFieldGet31(_link,this).focus()}activate(){_classPrivateFieldGet31(_link,this).click()}};function _classPrivateMethodInitSpec29(e,t){_checkPrivateRedeclaration44(e,t),t.add(e)}function _classPrivateFieldInitSpec32(e,t,r){_checkPrivateRedeclaration44(e,t),t.set(e,r)}function _checkPrivateRedeclaration44(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet32(e,t){return e.get(_assertClassBrand44(e,t))}function _classPrivateFieldSet29(e,t,r){return e.set(_assertClassBrand44(e,t),r),r}function _assertClassBrand44(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var SHORTCUTS_GROUP11="multipleSelect.itemBox",_items2=new WeakMap,_itemsBox=new WeakMap,_locale=new WeakMap,_searchInput=new WeakMap,_selectAllUI=new WeakMap,_clearAllUI=new WeakMap,_MultipleSelectUI_brand=new WeakSet,MultipleSelectUI=class ds extends BaseUI{static get DEFAULTS(){return clone3({className:"htUIMultipleSelect",value:[]})}constructor(t,r){super(t,extend2(ds.DEFAULTS,r)),_classPrivateMethodInitSpec29(this,_MultipleSelectUI_brand),_classPrivateFieldInitSpec32(this,_items2,[]),_classPrivateFieldInitSpec32(this,_itemsBox,void 0),_classPrivateFieldInitSpec32(this,_locale,void 0),_classPrivateFieldInitSpec32(this,_searchInput,void 0),_classPrivateFieldInitSpec32(this,_selectAllUI,void 0),_classPrivateFieldInitSpec32(this,_clearAllUI,void 0),_classPrivateFieldSet29(_searchInput,this,new InputUI(this.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"})),_classPrivateFieldSet29(_selectAllUI,this,new LinkUI(this.hot,{textContent:FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"})),_classPrivateFieldSet29(_clearAllUI,this,new LinkUI(this.hot,{textContent:FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return _classPrivateFieldGet32(_itemsBox,this)}registerHooks(){_classPrivateFieldGet32(_searchInput,this).addLocalHook("keydown",t=>_assertClassBrand44(_MultipleSelectUI_brand,this,_onInputKeyDown2).call(this,t)),_classPrivateFieldGet32(_searchInput,this).addLocalHook("input",t=>_assertClassBrand44(_MultipleSelectUI_brand,this,_onInput).call(this,t)),_classPrivateFieldGet32(_selectAllUI,this).addLocalHook("click",t=>_assertClassBrand44(_MultipleSelectUI_brand,this,_onSelectAllClick).call(this,t)),_classPrivateFieldGet32(_clearAllUI,this).addLocalHook("click",t=>_assertClassBrand44(_MultipleSelectUI_brand,this,_onClearAllClick).call(this,t))}setItems(t){var r;_classPrivateFieldSet29(_items2,this,t),(r=_classPrivateFieldGet32(_itemsBox,this))===null||r===void 0||r.loadData(_classPrivateFieldGet32(_items2,this))}setLocale(t){_classPrivateFieldSet29(_locale,this,t)}getLocale(){return _classPrivateFieldGet32(_locale,this)}getItems(){return[..._classPrivateFieldGet32(_items2,this)]}getValue(){return itemsToValue(_classPrivateFieldGet32(_items2,this))}getSearchInputElement(){return _classPrivateFieldGet32(_searchInput,this)}getSelectAllElement(){return _classPrivateFieldGet32(_selectAllUI,this)}getClearAllElement(){return _classPrivateFieldGet32(_clearAllUI,this)}isSelectedAllValues(){return _classPrivateFieldGet32(_items2,this).length===this.getValue().length}build(){super.build();const{rootDocument:t}=this.hot,r=t.createElement("div"),i=new BaseUI(this.hot,{className:"htUISelectionControls",children:[_classPrivateFieldGet32(_selectAllUI,this),_classPrivateFieldGet32(_clearAllUI,this)]});this._element.appendChild(_classPrivateFieldGet32(_searchInput,this).element),this._element.appendChild(i.element),this._element.appendChild(r);const o=a=>{var c;if(!this._element)return;(c=_classPrivateFieldGet32(_itemsBox,this))===null||c===void 0||c.destroy(),addClass(a,"htUIMultipleSelectHot"),_classPrivateFieldSet29(_itemsBox,this,new this.hot.constructor(a,{data:_classPrivateFieldGet32(_items2,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(d,f,m,g,v,_)=>{d.title=_.instance.getDataAtRowProp(f,_.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{_classPrivateFieldGet32(_itemsBox,this).listen()},colWidths:()=>_classPrivateFieldGet32(_itemsBox,this).container.scrollWidth-getScrollbarWidth(t),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),_classPrivateFieldGet32(_itemsBox,this).init();const h=_classPrivateFieldGet32(_itemsBox,this).getShortcutManager().getContext("grid");h.removeShortcutsByKeys(["Tab"]),h.removeShortcutsByKeys(["Shift","Tab"]),h.addShortcut({keys:[["Escape"]],callback:d=>{this.runLocalHooks("keydown",d,this)},group:SHORTCUTS_GROUP11}),h.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:d=>{_classPrivateFieldGet32(_itemsBox,this).deselectCell(),this.runLocalHooks("keydown",d,this),this.runLocalHooks("listTabKeydown",d,this)},group:SHORTCUTS_GROUP11})};o(r),this.hot._registerTimeout(()=>o(r),100)}focus(){this.isBuilt()&&_classPrivateFieldGet32(_itemsBox,this).listen()}reset(){_classPrivateFieldGet32(_searchInput,this).reset(),_classPrivateFieldGet32(_selectAllUI,this).reset(),_classPrivateFieldGet32(_clearAllUI,this).reset()}update(){this.isBuilt()&&(_classPrivateFieldGet32(_itemsBox,this).loadData(valueToItems(_classPrivateFieldGet32(_items2,this),this.options.value)),super.update())}destroy(){var t;(t=_classPrivateFieldGet32(_itemsBox,this))===null||t===void 0||t.destroy(),_classPrivateFieldGet32(_searchInput,this).destroy(),_classPrivateFieldGet32(_clearAllUI,this).destroy(),_classPrivateFieldGet32(_selectAllUI,this).destroy(),_classPrivateFieldSet29(_searchInput,this,null),_classPrivateFieldSet29(_clearAllUI,this,null),_classPrivateFieldSet29(_selectAllUI,this,null),_classPrivateFieldSet29(_itemsBox,this,null),_classPrivateFieldSet29(_items2,this,null),super.destroy()}};function _onInput(e){const t=e.target.value.toLocaleLowerCase(this.getLocale());let r;t===""?r=[..._classPrivateFieldGet32(_items2,this)]:r=_classPrivateFieldGet32(_items2,this).filter(i=>`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(t)>=0),_classPrivateFieldGet32(_itemsBox,this).loadData(r)}function _onInputKeyDown2(e){this.runLocalHooks("keydown",e,this),partial(isKey,e.keyCode)("ARROW_DOWN")&&(e.preventDefault(),stopImmediatePropagation(e),_classPrivateFieldGet32(_itemsBox,this).listen(),_classPrivateFieldGet32(_itemsBox,this).selectCell(0,0))}function _onSelectAllClick(e){const t=[];e.preventDefault(),_classPrivateFieldGet32(_itemsBox,this).getSourceData().forEach((r,i)=>{r.checked=!0,t.push(dataRowToChangesArray(r,i)[0])}),_classPrivateFieldGet32(_itemsBox,this).setSourceDataAtCell(t)}function _onClearAllClick(e){const t=[];e.preventDefault(),_classPrivateFieldGet32(_itemsBox,this).getSourceData().forEach((r,i)=>{r.checked=!1,t.push(dataRowToChangesArray(r,i)[0])}),_classPrivateFieldGet32(_itemsBox,this).setSourceDataAtCell(t)}function valueToItems(e,t){const r=createArrayAssertion(t);return e.map(i=>(i.checked=r(i.value),i))}function itemsToValue(e){const t=[];return e.forEach(r=>{r.checked&&t.push(r.value)}),t}function _classPrivateMethodInitSpec30(e,t){_checkPrivateRedeclaration45(e,t),t.add(e)}function _checkPrivateRedeclaration45(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty91(e,t,r){return(t=_toPropertyKey91(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey91(e){var t=_toPrimitive91(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive91(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand45(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _ValueComponent_brand=new WeakSet,ValueComponent=class extends BaseComponent{constructor(e,t){super(e,{id:t.id,stateless:!1}),_classPrivateMethodInitSpec30(this,_ValueComponent_brand),_defineProperty91(this,"name",""),this.name=t.name,this.elements.push(new MultipleSelectUI(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>_assertClassBrand45(_ValueComponent_brand,this,_onInputKeyDown3).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,t)=>_assertClassBrand45(_ValueComponent_brand,this,_onModifyDisplayedValue).call(this,e,t))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===CONDITION_NAME21){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?CONDITION_NAME:CONDITION_NAME21},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(r,i,o,a,c)=>{const[u]=arrayFilter(i,f=>f.name===CONDITION_NAME21),h={},d=this.hot.getTranslatedPhrase(FILTERS_VALUES_BLANK_CELLS);if(u){const f=a(r,c),m=arrayMap(f,R=>R.value),g=new Map(f.map(R=>[R.value,this.hot.getCellMeta(R.meta.visualRow,R.meta.visualCol)])),v=unifyColumnValues(m);o&&(u.args[0]=o);const _=[],b=intersectValues(v,u.args[0],d,R=>{R.checked&&_.push(R.value),_assertClassBrand45(_ValueComponent_brand,this,_triggerModifyMultipleSelectionValueHook).call(this,R,g)}),S=e.editedConditionStack.column;h.locale=this.hot.getCellMeta(0,S).locale,h.args=[_],h.command=getConditionDescriptor(CONDITION_NAME21),h.itemsSnapshot=b}else h.args=[],h.command=getConditionDescriptor(CONDITION_NAME);this.state.setValueAtIndex(r,h)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof MultipleSelectUI)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,r,i,o,a)=>{addClass(t.parentNode,"htFiltersMenuValue");const c=this.hot.rootDocument.createElement("div");return addClass(c,"htFiltersMenuLabel"),c.textContent=a,t.appendChild(c),t.parentElement.hasAttribute("ghost-table")||arrayEach(this.elements,u=>t.appendChild(u.element)),t}}}reset(){const e=this.hot.getTranslatedPhrase(FILTERS_VALUES_BLANK_CELLS),t=this._getColumnVisibleValues(),r=t.map(u=>u.value),i=new Map(t.map(u=>[u.value,u.meta])),o=unifyColumnValues(r),a=intersectValues(o,o,e,u=>{_assertClassBrand45(_ValueComponent_brand,this,_triggerModifyMultipleSelectionValueHook).call(this,u,i)});this.getMultipleSelectElement().setItems(a),super.reset(),this.getMultipleSelectElement().setValue(o);const c=this.hot.getPlugin("filters").getSelectedColumn();c!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,c.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:arrayMap(this.hot.getDataAtCol(e.visualIndex),(t,r)=>({value:toEmptyString(t),meta:this.hot.getCellMeta(r,e.visualIndex)}))}};function _onInputKeyDown3(e){isKey(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),stopImmediatePropagation(e))}function _triggerModifyMultipleSelectionValueHook(e,t){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(e.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",e.visualValue,t.get(e.value)))}function _onModifyDisplayedValue(e,t){switch(t.type){case"numeric":return getRenderedValue(e,t);default:return e}}var import_es_error_cause132=__toESM(require_es_error_cause(),1),import_es_array_push70=__toESM(require_es_array_push(),1),_ActionBarComponent;function _classPrivateMethodInitSpec31(e,t){_checkPrivateRedeclaration46(e,t),t.add(e)}function _checkPrivateRedeclaration46(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty92(e,t,r){return(t=_toPropertyKey92(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey92(e){var t=_toPrimitive92(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive92(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand46(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _ActionBarComponent_brand=new WeakSet,ActionBarComponent=class ai extends BaseComponent{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(t,r){super(t,{id:r.id,stateless:!0}),_classPrivateMethodInitSpec31(this,_ActionBarComponent_brand),_defineProperty92(this,"name",""),this.name=r.name,this.elements.push(new InputUI(this.hot,{type:"button",value:FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:ai.BUTTON_OK})),this.elements.push(new InputUI(this.hot,{type:"button",value:FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:ai.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){arrayEach(this.elements,t=>{t.addLocalHook("click",(r,i)=>_assertClassBrand46(_ActionBarComponent_brand,this,_onButtonClick).call(this,r,i))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,r)=>(addClass(r.parentNode,"htFiltersMenuActionBar"),arrayEach(this.elements,i=>r.appendChild(i.element)),r)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}};_ActionBarComponent=ActionBarComponent;function _onButtonClick(e,t){t.options.identifier===_ActionBarComponent.BUTTON_OK?this.accept():this.cancel()}var import_es_error_cause133=__toESM(require_es_error_cause(),1),import_es_array_push71=__toESM(require_es_array_push(),1);function _defineProperty93(e,t,r){return(t=_toPropertyKey93(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey93(e){var t=_toPrimitive93(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive93(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var MAP_NAME="ConditionCollection.filteringStates",ConditionCollection=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;_defineProperty93(this,"hot",void 0),_defineProperty93(this,"isMapRegistrable",void 0),_defineProperty93(this,"filteringStates",new LinkedPhysicalIndexToValueMap),_defineProperty93(this,"previousConditionStack",null),this.hot=e,this.isMapRegistrable=t,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(MAP_NAME,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,t){var r;const i=this.filteringStates.getValueAtIndex(t),o=(r=i?.conditions)!==null&&r!==void 0?r:[],a=i?.operation;return this.isMatchInConditions(o,e,a)}isMatchInConditions(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:OPERATION_ID;return e.length?getOperationFunc(r)(e,t):!0}addCondition(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:OPERATION_ID,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,a=arrayMap(t.args,d=>typeof d=="string"?d.toLocaleLowerCase(o):d),c=t.name||t.command.key;this.previousConditionStack===null&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",e);const u=this.getOperation(e);if(u){if(u!==r)throw Error(toSingleLine`The column of index ${e} has been already applied with a \`${u}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(isUndefined(operations[r]))throw new Error(toSingleLine`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const h=this.getConditions(e);h.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:c,args:a,func:getCondition(c,a)}]},i):h.push({name:c,args:a,func:getCondition(c,a)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,r;return(t=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&t!==void 0?t:[]}getOperation(e){var t;return(t=this.filteringStates.getValueAtIndex(e))===null||t===void 0?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return arrayReduce(this.filteringStates.getEntries(),(e,t)=>{let[r,{operation:i,conditions:o}]=t;return e.push({column:r,operation:i,conditions:arrayMap(o,a=>{let{name:c,args:u}=a;return{name:c,args:u}})}),e},[])}importAllConditions(e){this.clean(),arrayEach(e,t=>{arrayEach(t.conditions,r=>this.addCondition(t.column,r))})}removeConditions(e){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const r=this.getConditions(e);return t?r.some(i=>i.name===t):r.length>0}setPreviousConditionStack(e){this.previousConditionStack=e}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(MAP_NAME),this.filteringStates=null,this.clearLocalHooks()}};mixin(ConditionCollection,localHooks_default);var conditionCollection_default=ConditionCollection,import_es_error_cause134=__toESM(require_es_error_cause(),1),import_es_array_push72=__toESM(require_es_array_push(),1);function _defineProperty94(e,t,r){return(t=_toPropertyKey94(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey94(e){var t=_toPrimitive94(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive94(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DataFilter=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];_defineProperty94(this,"conditionCollection",void 0),_defineProperty94(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return arrayEach(this.conditionCollection.getFilteredColumns(),(t,r)=>{let i=this.columnDataFactory(t);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(t,i)}),e}filterByColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return arrayEach(t,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,t){const r=[];return arrayEach(t,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}},dataFilter_default=DataFilter,import_es_error_cause135=__toESM(require_es_error_cause(),1),import_es_array_push73=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec32(e,t){_checkPrivateRedeclaration47(e,t),t.add(e)}function _checkPrivateRedeclaration47(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty95(e,t,r){return(t=_toPropertyKey95(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey95(e){var t=_toPrimitive95(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive95(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand47(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _ConditionUpdateObserver_brand=new WeakSet,ConditionUpdateObserver=class{constructor(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];_classPrivateMethodInitSpec32(this,_ConditionUpdateObserver_brand),_defineProperty95(this,"hot",void 0),_defineProperty95(this,"conditionCollection",void 0),_defineProperty95(this,"columnDataFactory",void 0),_defineProperty95(this,"changes",[]),_defineProperty95(this,"grouping",!1),_defineProperty95(this,"latestEditedColumnPosition",-1),_defineProperty95(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=t,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>_assertClassBrand47(_ConditionUpdateObserver_brand,this,_onConditionBeforeModify).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>_assertClassBrand47(_ConditionUpdateObserver_brand,this,_onConditionBeforeClean).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>_assertClassBrand47(_ConditionUpdateObserver_brand,this,_onConditionAfterClean).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,arrayEach(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,t){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const a=i.slice(0,o),c=i.slice(o);c.length&&c[0].column===e&&c.shift();const u=curry(function(d,f){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const g=new conditionCollection_default(r.hot,!1),v=[].concat(d,m);g.importAllConditions(v);const _=r.columnDataFactory(f);let b;g.isEmpty()?b=_:b=new dataFilter_default(g,R=>r.columnDataFactory(R)).filter(),b=arrayMap(b,R=>R.meta.visualRow);const S=createArrayAssertion(b);return g.destroy(),arrayFilter(_,R=>S(R.meta.visualRow))})(a),h=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:h},dependentConditionStacks:c,filteredRowsFactory:u,conditionArgsChange:t})}destroy(){this.clearLocalHooks(),objectEach(this,(e,t)=>{this[t]=null})}};function _onConditionBeforeModify(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}function _onConditionBeforeClean(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function _onConditionAfterClean(){arrayEach(this.latestOrderStack,e=>{this.updateStatesAtColumn(e)})}mixin(ConditionUpdateObserver,localHooks_default);var conditionUpdateObserver_default=ConditionUpdateObserver;function createFocusNavigator(e){return createPaginator({initialPage:0,size:()=>e.length,onItemSelect:(r,i)=>{const o=e[r];if(o instanceof MultipleSelectUI)return i;if(o.element&&!isVisible(o.element))return!1;o.focus()}})}var SHORTCUTS_MENU_CONTEXT="filters";function createMenuFocusController(e,t){let r=-1;const i=createFocusNavigator(t),o=h=>()=>{e.isOpened()&&e.getKeyboardShortcutsCtrl().listen(SHORTCUTS_MENU_CONTEXT),i.setCurrentPage(t.indexOf(h))};t.forEach(h=>{h instanceof BaseUI&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),e.addLocalHook("afterSelectionChange",h=>{h.key.startsWith("filter_")||i.clear()});function a(h){const d=e.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(SHORTCUTS_MENU_CONTEXT),callback:()=>{h.isSubMenu()&&h.close(),d.listen(SHORTCUTS_MENU_CONTEXT)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:m=>{const g=e.getNavigator();g.getCurrentPage()>-1&&(r=g.getCurrentPage()),g.clear(),m.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{e.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:m=>{const g=t[i.getCurrentPage()];g instanceof SelectUI&&(g.openOptions(),m.preventDefault()),g instanceof LinkUI&&(g.activate(),m.preventDefault()),g instanceof BaseUI||m.preventDefault()}}],SHORTCUTS_MENU_CONTEXT)}e.addLocalHook("afterSubmenuOpen",a),e.addLocalHook("afterOpen",a);function c(){e.focus(),e.getKeyboardShortcutsCtrl().listen(SHORTCUTS_MENU_CONTEXT)}function u(){return r}return{...i,listen:c,getLastMenuPage:u}}function _classPrivateMethodInitSpec33(e,t){_checkPrivateRedeclaration48(e,t),t.add(e)}function _classPrivateFieldInitSpec33(e,t,r){_checkPrivateRedeclaration48(e,t),t.set(e,r)}function _checkPrivateRedeclaration48(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty96(e,t,r){return(t=_toPropertyKey96(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey96(e){var t=_toPrimitive96(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive96(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldSet30(e,t,r){return e.set(_assertClassBrand48(e,t),r),r}function _classPrivateFieldGet33(e,t){return e.get(_assertClassBrand48(e,t))}function _assertClassBrand48(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var PLUGIN_KEY16="filters",PLUGIN_PRIORITY15=250,SHORTCUTS_GROUP12=PLUGIN_KEY16,_menuFocusNavigator=new WeakMap,_Filters_brand=new WeakSet,Filters=class extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY16}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY15}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),_classPrivateMethodInitSpec33(this,_Filters_brand),_defineProperty96(this,"dropdownMenuPlugin",null),_defineProperty96(this,"conditionCollection",null),_defineProperty96(this,"conditionUpdateObserver",null),_defineProperty96(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),_defineProperty96(this,"filtersRowsMap",null),_classPrivateFieldInitSpec33(this,_menuFocusNavigator,void 0),this.hot.addHook("afterGetColHeader",(t,r)=>_assertClassBrand48(_Filters_brand,this,_onAfterGetColHeader4).call(this,t,r))}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY16]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new TrimmingMap),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,t=e&&e.uiContainer||this.hot.rootDocument.body,r=a=>(a.addLocalHook("accept",()=>_assertClassBrand48(_Filters_brand,this,_onActionBarSubmit).call(this,"accept")),a.addLocalHook("cancel",()=>_assertClassBrand48(_Filters_brand,this,_onActionBarSubmit).call(this,"cancel")),a.addLocalHook("change",c=>_assertClassBrand48(_Filters_brand,this,_onComponentChange).call(this,a,c)),a),i=()=>`${this.hot.getTranslatedPhrase(FILTERS_DIVS_FILTER_BY_CONDITION)}:`,o=()=>`${this.hot.getTranslatedPhrase(FILTERS_DIVS_FILTER_BY_VALUE)}:`;if(!this.components.get("filter_by_condition")){const a=new ConditionComponent(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:t});a.addLocalHook("afterClose",()=>_assertClassBrand48(_Filters_brand,this,_onSelectUIClosed).call(this)),this.components.set("filter_by_condition",r(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new OperatorsComponent(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new ConditionComponent(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:t});a.addLocalHook("afterClose",()=>_assertClassBrand48(_Filters_brand,this,_onSelectUIClosed).call(this)),this.components.set("filter_by_condition2",r(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new ValueComponent(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new ActionBarComponent(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new conditionCollection_default(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new conditionUpdateObserver_default(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>_assertClassBrand48(_Filters_brand,this,_updateComponents).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",a=>_assertClassBrand48(_Filters_brand,this,_onAfterDropdownMenuDefaultOptions).call(this,a)),this.addHook("afterDropdownMenuShow",()=>_assertClassBrand48(_Filters_brand,this,_onAfterDropdownMenuShow).call(this)),this.addHook("afterDropdownMenuHide",()=>_assertClassBrand48(_Filters_brand,this,_onAfterDropdownMenuHide).call(this)),this.addHook("afterChange",a=>_assertClassBrand48(_Filters_brand,this,_onAfterChange2).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!_classPrivateFieldGet33(_menuFocusNavigator,this)&&this.dropdownMenuPlugin.enabled){const a=this.dropdownMenuPlugin.menu,c=[{focus:()=>{const h=a.getNavigator(),d=_classPrivateFieldGet33(_menuFocusNavigator,this).getLastMenuPage();a.focus(),d>0?h.setCurrentPage(d):h.toFirstItem()}},...Array.from(this.components).map(h=>{let[,d]=h;return d.getElements()}).flat()];_classPrivateFieldSet30(_menuFocusNavigator,this,createMenuFocusController(a,c));const u=h=>{_classPrivateFieldGet33(_menuFocusNavigator,this).listen(),h.preventDefault(),isKey(h.keyCode,"TAB")&&(h.shiftKey?_classPrivateFieldGet33(_menuFocusNavigator,this).toPreviousItem():_classPrivateFieldGet33(_menuFocusNavigator,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",u),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",u)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,r)=>{t.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:SHORTCUTS_GROUP12})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP12)}addCondition(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:OPERATION_ID;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:t},args:r},i)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),t=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o,this.conditionCollection.previousConditionStack)!==!1)if(r){const c=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=arrayMap(t.filter(),h=>h.meta.visualRow);const u=createArrayAssertion(i);rangeEach(this.hot.countSourceRows()-1,h=>{u(h)||c.push(h)}),arrayEach(c,h=>{this.filtersRowsMap.setValueAtIndex(h,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),r=[];return arrayEach(this.hot.getSourceDataAtCol(t),(i,o)=>{var a;const{row:c,col:u,visualCol:h,visualRow:d,type:f,instance:m,dateFormat:g,locale:v}=this.hot.getCellMeta(o,t),_=(a=this.hot.getDataAtCell(this.hot.toVisualRow(o),t))!==null&&a!==void 0?a:i;r.push({meta:{row:c,col:u,visualCol:h,visualRow:d,type:f,instance:m,dateFormat:g,locale:v},value:toEmptyString(_)})}),r}updateValueComponentCondition(e){const t=this.hot.getDataAtCol(e),r=unifyColumnValues(t);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var t;const r=(t=this.getSelectedColumn())===null||t===void 0?void 0:t.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,t,r,i){let o=e;return o===OPERATION_ID2&&t.command.key!==CONDITION_NAME&&r.command.key!==CONDITION_NAME&&i.command.key!==CONDITION_NAME?o=OPERATION_ID3:i.command.key!==CONDITION_NAME&&(t.command.key===CONDITION_NAME||r.command.key===CONDITION_NAME)&&(o=OPERATION_ID),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new dataFilter_default(e,t=>this.getDataMapAtColumn(t))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return arrayEach(i,a=>{arrayEach(t.menuItems,(c,u)=>{c.key===a.getMenuItemDescriptor().key&&e.push(u)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,a=new Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];const u=this.getIndexesOfComponents(...a);e?i.showRows(u):i.hideRows(u),r.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{e!==null&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}};function _onAfterChange2(e){e&&arrayEach(e,t=>{const[,r]=t,i=this.hot.propToCol(r);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function _onAfterDropdownMenuShow(){const e=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),e.updateMenuDimensions()}function _onAfterDropdownMenuHide(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function _onAfterDropdownMenuDefaultOptions(e){e.items.push({name:KEY}),this.components.forEach(t=>{e.items.push(t.getMenuItemDescriptor())})}function _onActionBarSubmit(e){var t;if(e==="accept"){const i=this.getSelectedColumn();if(i===null){var r;(r=this.dropdownMenuPlugin)===null||r===void 0||r.close();return}const{physicalIndex:o}=i,a=this.components.get("filter_by_condition").getState(),c=this.components.get("filter_by_condition2").getState(),u=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),a,c,u);this.conditionUpdateObserver.groupChanges();let d=this.conditionCollection.getColumnStackPosition(o);d===-1&&(d=void 0),this.conditionCollection.removeConditions(o),a.command.key!==CONDITION_NAME&&(this.conditionCollection.addCondition(o,a,h,d),c.command.key!==CONDITION_NAME&&this.conditionCollection.addCondition(o,c,h,d)),u.command.key!==CONDITION_NAME&&this.conditionCollection.addCondition(o,u,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(f=>f.saveState(o)),this.filtersRowsMap.clear(),this.filter()}(t=this.dropdownMenuPlugin)===null||t===void 0||t.close()}function _onComponentChange(e,t){this.updateDependentComponentsVisibility(),e.constructor===ConditionComponent&&!t.inputsCount&&this.setListeningDropdownMenu()}function _onSelectUIClosed(){this.setListeningDropdownMenu()}function _onAfterGetColHeader4(e,t){const r=this.hot.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(r)?addClass(t,"htFiltersActive"):removeClass(t,"htFiltersActive")}function _updateComponents(e){var t;if(!((t=this.dropdownMenuPlugin)!==null&&t!==void 0&&t.enabled))return;const{editedConditionStack:{conditions:r,column:i}}=e,o=r.filter(c=>c.name===CONDITION_NAME21),a=r.filter(c=>c.name!==CONDITION_NAME21);if(o.length>=2||a.length>=3)warn(toSingleLine`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const c=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(a[0],i),this.components.get("filter_by_condition2").updateState(a[1],i),this.components.get("filter_operators").updateState(c,i),this.components.get("filter_by_value").updateState(e)}}var import_es_error_cause139=__toESM(require_es_error_cause(),1),import_es_array_push78=__toESM(require_es_array_push(),1),import_es_json_stringify2=__toESM(require_es_json_stringify(),1),import_es_set_difference_v219=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v219=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v219=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v219=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v219=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v219=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v219=__toESM(require_es_set_union_v2(),1),import_es_array_push75=__toESM(require_es_array_push(),1),DEFAULT_LICENSE_KEY="internal-use-in-handsontable",DEFAULT_SETTINGS={licenseKey:DEFAULT_LICENSE_KEY,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function getEngineSettingsOverrides(e){var t;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:(t=e[PLUGIN_KEY17])===null||t===void 0||(t=t.language)===null||t===void 0?void 0:t.langCode}}function cleanEngineSettings(e){return Object.keys(e).reduce((t,r)=>(r!=="hyperformula"&&(t[r]=e[r]),t),{})}function getEngineSettingsWithDefaultsAndOverrides(e){var t;const r=e[PLUGIN_KEY17],i=cleanEngineSettings(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=getEngineSettingsOverrides(e);return{...DEFAULT_SETTINGS,...i,...o}}function getEngineSettingsWithOverrides(e){var t;const r=e[PLUGIN_KEY17],i=cleanEngineSettings(r!=null&&(t=r.engine)!==null&&t!==void 0&&t.hyperformula?r.engine:{}),o=getEngineSettingsOverrides(e);return{...i,...o}}function haveEngineSettingsChanged(e,t){return Object.keys(t).some(r=>t[r]!==void 0&&t[r]!==e[r])}function getEngineRelationshipRegistry(){const e="engine_relationship",t=staticRegister(PLUGIN_KEY17);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function getSharedEngineUsageRegistry(){const e="shared_engine_usage",t=staticRegister(PLUGIN_KEY17);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function setupEngine(e){const t=e.getSettings(),r=t[PLUGIN_KEY17],i=r?.engine;if(r===!0||isUndefined(i))return null;if(typeof i.hyperformula=="function"||typeof i=="function"){var o;return registerEngine((o=i.hyperformula)!==null&&o!==void 0?o:i,t,e)}else if(typeof i=="object"&&isUndefined(i.hyperformula)){const a=getEngineRelationshipRegistry(),c=getSharedEngineUsageRegistry().get(i);return a.has(i)||a.set(i,[]),a.get(i).push(e),c&&c.push(e.guid),i.getConfig().licenseKey||i.updateConfig({licenseKey:DEFAULT_LICENSE_KEY}),(i.getConfig().leapYear1900!==DEFAULT_SETTINGS.leapYear1900||isObjectEqual(i.getConfig().nullDate,DEFAULT_SETTINGS.nullDate)===!1)&&warn(toSingleLine`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),i}return null}function registerEngine(e,t,r){const i=t[PLUGIN_KEY17],o=getEngineSettingsWithDefaultsAndOverrides(t),a=getEngineRelationshipRegistry(),c=getSharedEngineUsageRegistry();registerCustomFunctions(e,i.functions),registerLanguage(e,i.language);const u=e.buildEmpty(o);return a.set(u,[r]),c.set(u,[r.guid]),registerNamedExpressions(u,i.namedExpressions),u.on("sheetAdded",()=>{u.rebuildAndRecalculate()}),u.on("sheetRemoved",()=>{u.rebuildAndRecalculate()}),u}function getRegisteredHotInstances(e){var t;const r=getEngineRelationshipRegistry(),i=r.size===0?[]:Array.from((t=r.get(e))!==null&&t!==void 0?t:[]);return new Map(i.map(o=>[o.getPlugin("formulas").sheetId,o]))}function unregisterEngine(e,t){if(e){const r=getEngineRelationshipRegistry(),i=r.get(e),o=getSharedEngineUsageRegistry(),a=o.get(e);i&&i.includes(t)&&(i.splice(i.indexOf(t),1),i.length===0&&r.delete(e)),a&&a.includes(t.guid)&&(a.splice(a.indexOf(t.guid),1),a.length===0&&(o.delete(e),e.destroy()))}}function registerCustomFunctions(e,t){t&&t.forEach(r=>{const{name:i,plugin:o,translations:a}=r;try{e.registerFunction(i,o,a)}catch(c){warn(c.message)}})}function registerLanguage(e,t){if(t){const{langCode:r}=t;try{e.registerLanguage(r,t)}catch(i){warn(i.message)}}}function registerNamedExpressions(e,t){t&&(e.suspendEvaluation(),t.forEach(r=>{const{name:i,expression:o,scope:a,options:c}=r;try{e.addNamedExpression(i,o,a,c)}catch(u){warn(u.message)}}),e.resumeEvaluation())}function setupSheet(e,t){return(isUndefined(t)||!e.doesSheetExist(t))&&(t=e.addSheet(t)),t}var import_moment11=__toESM(require_moment(),1),DEFAULT_DATE_FORMAT_HYPERFORMULA="DD/MM/YYYY";function isEscapedFormulaExpression(e){return typeof e=="string"&&e.charAt(0)==="'"&&e.charAt(1)==="="}function unescapeFormulaExpression(e){return isEscapedFormulaExpression(e)?e.substr(1):e}function isFormula(e){return typeof e=="string"&&e.startsWith("=")}function isDate2(e,t){return typeof e=="string"&&t==="date"}function isDateValid(e,t){return(0,import_moment11.default)(e,t,!0).isValid()}function getDateInHfFormat(e,t){return(0,import_moment11.default)(e,t,!0).format(DEFAULT_DATE_FORMAT_HYPERFORMULA)}function getDateInHotFormat(e,t){return(0,import_moment11.default)(e,DEFAULT_DATE_FORMAT_HYPERFORMULA,!0).format(t)}function getDateFromExcelDate(e,t){const i=new Date(Date.UTC(0,0,e+-1));return(0,import_moment11.default)(i).format(t)}var import_es_error_cause138=__toESM(require_es_error_cause(),1),import_es_error_cause137=__toESM(require_es_error_cause(),1),import_es_array_push77=__toESM(require_es_array_push(),1),import_es_array_push76=__toESM(require_es_array_push(),1);function getMoveLine(e,t,r){const i=Array.from(Array(r).keys()).filter(a=>e.includes(a)===!1);if(t===0){var o;return(o=i[t])!==null&&o!==void 0?o:0}return i[t-1]+1}function getInitiallyCalculatedMoves(e,t){const r=[];return e.forEach(i=>{const o={from:i,to:t};r.forEach(a=>{const c=a.from>a.to,u=a.to<=o.from;a.from>o.from&&u&&c&&(o.from+=1)}),o.from>=t&&(t+=1),r.push(o)}),r}function adjustedCalculatedMoves(e){return e.forEach((t,r)=>{e.slice(r+1).forEach(o=>{const a=o.from<o.to;o.from>t.from&&a&&(o.from-=1)})}),e}function getMoves(e,t,r){const i=getInitiallyCalculatedMoves(e,getMoveLine(e,t,r));return adjustedCalculatedMoves(i)}function _classPrivateFieldInitSpec34(e,t,r){_checkPrivateRedeclaration49(e,t),t.set(e,r)}function _checkPrivateRedeclaration49(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet34(e,t){return e.get(_assertClassBrand49(e,t))}function _classPrivateFieldSet31(e,t,r){return e.set(_assertClassBrand49(e,t),r),r}function _assertClassBrand49(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _axis=new WeakMap,_indexMapper=new WeakMap,_indexSyncer=new WeakMap,_indexesSequence=new WeakMap,_movedIndexes=new WeakMap,_finalIndex=new WeakMap,_removedIndexes=new WeakMap,AxisSyncer=class{constructor(e,t,r){_classPrivateFieldInitSpec34(this,_axis,void 0),_classPrivateFieldInitSpec34(this,_indexMapper,void 0),_classPrivateFieldInitSpec34(this,_indexSyncer,void 0),_classPrivateFieldInitSpec34(this,_indexesSequence,[]),_classPrivateFieldInitSpec34(this,_movedIndexes,[]),_classPrivateFieldInitSpec34(this,_finalIndex,void 0),_classPrivateFieldInitSpec34(this,_removedIndexes,[]),_classPrivateFieldSet31(_axis,this,e),_classPrivateFieldSet31(_indexMapper,this,t),_classPrivateFieldSet31(_indexSyncer,this,r)}setRemovedHfIndexes(e){return _classPrivateFieldSet31(_removedIndexes,this,e.map(t=>{const r=_classPrivateFieldGet34(_indexMapper,this).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(r)})),_classPrivateFieldGet34(_removedIndexes,this)}getRemovedHfIndexes(){return _classPrivateFieldGet34(_removedIndexes,this)}getHfIndexFromVisualIndex(e){const t=_classPrivateFieldGet34(_indexMapper,this).getIndexesSequence(),r=_classPrivateFieldGet34(_indexMapper,this).getNotTrimmedIndexes();return t.indexOf(r[e])}syncMoves(e){const r=`move${toUpperCaseFirst(_classPrivateFieldGet34(_axis,this))}s`;_classPrivateFieldGet34(_indexSyncer,this).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,a=i.from+1!==i.to;o&&a&&_classPrivateFieldGet34(_indexSyncer,this).getEngine()[r](_classPrivateFieldGet34(_indexSyncer,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,t,r){r!==!1&&(_classPrivateFieldSet31(_movedIndexes,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),_classPrivateFieldSet31(_finalIndex,this,this.getHfIndexFromVisualIndex(t)))}calculateAndSyncMoves(e,t){if(_classPrivateFieldGet34(_indexSyncer,this).isPerformingUndoRedo()||e===!1||t===!1)return;const r=getMoves(_classPrivateFieldGet34(_movedIndexes,this),_classPrivateFieldGet34(_finalIndex,this),_classPrivateFieldGet34(_indexMapper,this).getNumberOfIndexes());_classPrivateFieldGet34(_indexSyncer,this).getSheetId()===null?_classPrivateFieldGet34(_indexSyncer,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${toUpperCaseFirst(_classPrivateFieldGet34(_axis,this))}Order`;return t=>{if(_classPrivateFieldGet34(_indexSyncer,this).isPerformingUndoRedo())return;const r=_classPrivateFieldGet34(_indexMapper,this).getIndexesSequence();if(t==="update"&&r.length>0){const i=_classPrivateFieldGet34(_indexesSequence,this).map(u=>r.indexOf(u)),o=_classPrivateFieldGet34(_indexSyncer,this).getEngine().getSheetDimensions(_classPrivateFieldGet34(_indexSyncer,this).getSheetId());let a;_classPrivateFieldGet34(_axis,this)==="row"?a=o.height:a=o.width;const c=i.length;for(let u=c;u<a;u+=1)i.push(u);_classPrivateFieldGet34(_indexSyncer,this).getEngine()[e](_classPrivateFieldGet34(_indexSyncer,this).getSheetId(),i)}_classPrivateFieldSet31(_indexesSequence,this,r)}}init(){_classPrivateFieldSet31(_indexesSequence,this,_classPrivateFieldGet34(_indexMapper,this).getIndexesSequence())}},axisSyncer_default=AxisSyncer;function _classPrivateFieldInitSpec35(e,t,r){_checkPrivateRedeclaration50(e,t),t.set(e,r)}function _checkPrivateRedeclaration50(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet35(e,t){return e.get(_assertClassBrand50(e,t))}function _classPrivateFieldSet32(e,t,r){return e.set(_assertClassBrand50(e,t),r),r}function _assertClassBrand50(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _rowIndexSyncer=new WeakMap,_columnIndexSyncer=new WeakMap,_postponeAction=new WeakMap,_isPerformingUndo=new WeakMap,_isPerformingRedo=new WeakMap,_engine=new WeakMap,_sheetId=new WeakMap,IndexSyncer=class{constructor(e,t,r){_classPrivateFieldInitSpec35(this,_rowIndexSyncer,void 0),_classPrivateFieldInitSpec35(this,_columnIndexSyncer,void 0),_classPrivateFieldInitSpec35(this,_postponeAction,void 0),_classPrivateFieldInitSpec35(this,_isPerformingUndo,!1),_classPrivateFieldInitSpec35(this,_isPerformingRedo,!1),_classPrivateFieldInitSpec35(this,_engine,null),_classPrivateFieldInitSpec35(this,_sheetId,null),_classPrivateFieldSet32(_rowIndexSyncer,this,new axisSyncer_default("row",e,this)),_classPrivateFieldSet32(_columnIndexSyncer,this,new axisSyncer_default("column",t,this)),_classPrivateFieldSet32(_postponeAction,this,r)}getForAxis(e){return e==="row"?_classPrivateFieldGet35(_rowIndexSyncer,this):_classPrivateFieldGet35(_columnIndexSyncer,this)}setPerformUndo(e){_classPrivateFieldSet32(_isPerformingUndo,this,e)}setPerformRedo(e){_classPrivateFieldSet32(_isPerformingRedo,this,e)}isPerformingUndoRedo(){return _classPrivateFieldGet35(_isPerformingUndo,this)||_classPrivateFieldGet35(_isPerformingRedo,this)}getSheetId(){return _classPrivateFieldGet35(_sheetId,this)}getEngine(){return _classPrivateFieldGet35(_engine,this)}getPostponeAction(){return _classPrivateFieldGet35(_postponeAction,this)}setupSyncEndpoint(e,t){_classPrivateFieldSet32(_engine,this,e),_classPrivateFieldSet32(_sheetId,this,t),_classPrivateFieldGet35(_rowIndexSyncer,this).init(),_classPrivateFieldGet35(_columnIndexSyncer,this).init()}},indexSyncer_default=IndexSyncer;function _classPrivateMethodInitSpec34(e,t){_checkPrivateRedeclaration51(e,t),t.add(e)}function _defineProperty97(e,t,r){return(t=_toPropertyKey97(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey97(e){var t=_toPrimitive97(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive97(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldInitSpec36(e,t,r){_checkPrivateRedeclaration51(e,t),t.set(e,r)}function _checkPrivateRedeclaration51(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet33(e,t,r){return e.set(_assertClassBrand51(e,t),r),r}function _classPrivateFieldGet36(e,t){return e.get(_assertClassBrand51(e,t))}function _assertClassBrand51(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var PLUGIN_KEY17="formulas",SETTING_KEYS4=["maxRows","maxColumns","language"],PLUGIN_PRIORITY16=260;pluginHooks_default.getSingleton().register("afterNamedExpressionAdded"),pluginHooks_default.getSingleton().register("afterNamedExpressionRemoved"),pluginHooks_default.getSingleton().register("afterSheetAdded"),pluginHooks_default.getSingleton().register("afterSheetRemoved"),pluginHooks_default.getSingleton().register("afterSheetRenamed"),pluginHooks_default.getSingleton().register("afterFormulasValuesUpdate");var isBlockedSource=e=>e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto",_internalOperationPending=new WeakMap,_hotWasInitializedWithEmptyData=new WeakMap,_engineListeners=new WeakMap,_Formulas_brand=new WeakSet,Formulas=class extends BasePlugin{constructor(){var e;super(...arguments),e=this,_classPrivateMethodInitSpec34(this,_Formulas_brand),_classPrivateFieldInitSpec36(this,_internalOperationPending,!1),_classPrivateFieldInitSpec36(this,_hotWasInitializedWithEmptyData,!1),_classPrivateFieldInitSpec36(this,_engineListeners,[["valuesUpdated",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand51(_Formulas_brand,e,_onEngineValuesUpdated).call(e,...r)}],["namedExpressionAdded",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand51(_Formulas_brand,e,_onEngineNamedExpressionsAdded).call(e,...r)}],["namedExpressionRemoved",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand51(_Formulas_brand,e,_onEngineNamedExpressionsRemoved).call(e,...r)}],["sheetAdded",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand51(_Formulas_brand,e,_onEngineSheetAdded).call(e,...r)}],["sheetRenamed",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand51(_Formulas_brand,e,_onEngineSheetRenamed).call(e,...r)}],["sheetRemoved",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand51(_Formulas_brand,e,_onEngineSheetRemoved).call(e,...r)}]]),_defineProperty97(this,"staticRegister",staticRegister("formulas")),_defineProperty97(this,"engine",null),_defineProperty97(this,"sheetName",null),_defineProperty97(this,"indexSyncer",null),_defineProperty97(this,"rowAxisSyncer",null),_defineProperty97(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return PLUGIN_KEY17}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY16}static get SETTING_KEYS(){return[PLUGIN_KEY17,...SETTING_KEYS4]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY17]}enablePlugin(){var e,t=this;if(!this.enabled){if(this.engine=(e=setupEngine(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){warn("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand51(_Formulas_brand,t,_onBeforeLoadData).call(t,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand51(_Formulas_brand,t,_onAfterLoadData5).call(t,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand51(_Formulas_brand,t,_onBeforeLoadData).call(t,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand51(_Formulas_brand,t,_onAfterLoadData5).call(t,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand51(_Formulas_brand,t,_onModifyData).call(t,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand51(_Formulas_brand,t,_onModifySourceData).call(t,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand51(_Formulas_brand,t,_onBeforeValidate).call(t,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand51(_Formulas_brand,t,_onAfterSetSourceDataAtCell).call(t,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand51(_Formulas_brand,t,_onAfterSetDataAtCell).call(t,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand51(_Formulas_brand,t,_onAfterSetDataAtCell).call(t,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand51(_Formulas_brand,t,_onBeforeCreateRow).call(t,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand51(_Formulas_brand,t,_onBeforeCreateCol).call(t,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand51(_Formulas_brand,t,_onAfterCreateRow).call(t,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand51(_Formulas_brand,t,_onAfterCreateCol).call(t,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand51(_Formulas_brand,t,_onBeforeRemoveRow).call(t,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand51(_Formulas_brand,t,_onBeforeRemoveCol).call(t,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand51(_Formulas_brand,t,_onAfterRemoveRow).call(t,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand51(_Formulas_brand,t,_onAfterRemoveCol).call(t,...i)}),this.indexSyncer=new indexSyncer_default(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,a)=>{this.rowAxisSyncer.storeMovesInformation(r,i,a)}),this.hot.addHook("beforeColumnMove",(r,i,o,a)=>{this.columnAxisSyncer.storeMovesInformation(r,i,a)}),this.hot.addHook("afterRowMove",(r,i,o,a,c)=>{this.rowAxisSyncer.calculateAndSyncMoves(a,c)}),this.hot.addHook("afterColumnMove",(r,i,o,a,c)=>{this.columnAxisSyncer.calculateAndSyncMoves(a,c)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand51(_Formulas_brand,t,_onAfterCellMetaReset).call(t,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand51(_Formulas_brand,t,_onAfterDetachChild).call(t,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand51(_Formulas_brand,t,_onBeforeAutofill).call(t,...i)}),_classPrivateFieldGet36(_engineListeners,this).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){_classPrivateFieldGet36(_engineListeners,this).forEach(e=>{let[t,r]=e;return this.engine.off(t,r)}),unregisterEngine(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=getEngineSettingsWithOverrides(this.hot.getSettings());haveEngineSettingsChanged(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const r=this.hot.getSettings()[PLUGIN_KEY17];if(isDefined(r)&&isDefined(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[PLUGIN_KEY17].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){_classPrivateFieldGet36(_engineListeners,this).forEach(e=>{var t;let[r,i]=e;return(t=this.engine)===null||t===void 0?void 0:t.off(r,i)}),_classPrivateFieldSet33(_engineListeners,this,null),unregisterEngine(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(isDefined(t)&&!isArrayOfArrays(t))return warn("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return warn("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(r),t),r}catch(r){return warn(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){error(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${toUpperCaseFirst(PLUGIN_KEY17)}.switchSheet`)}getCellType(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(t);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const a=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;a!==void 0&&(r.has(a)||r.add(a))}),getRegisteredHotInstances(this.engine).forEach((i,o)=>{if((t||o!==this.sheetId)&&r.has(o)){var a;i.render(),(a=i.view)===null||a===void 0||a.adjustElementsSize()}})}validateDependentCells(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var a;const{row:c,col:u,sheet:h}=(a=o?.address)!==null&&a!==void 0?a:{};return isDefined(h)?`${h}:${c}x${u}`:""},i=new Set(t.map(o=>r(o)));e.forEach(o=>{var a,c;const{row:u,col:h}=(a=o.address)!==null&&a!==void 0?a:{};if(isDefined(u)===!1||isDefined(h)===!1||u>=this.hot.countRows()||h>=this.hot.countCols())return;const d=o==null||(c=o.address)===null||c===void 0?void 0:c.sheet,f=r(o);if(d!==void 0&&!i.has(f)){const m=getRegisteredHotInstances(this.engine).get(d);if(!m)return;m.validateCell(m.getDataAtCell(u,h),m.getCellMeta(u,h),()=>{})}})}syncChangeWithEngine(e,t,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){warn(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,t);return isDate2(r,o.type)&&(isDateValid(r,o.dateFormat)?r=getDateInHfFormat(r,o.dateFormat):isFormula(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}};function _onBeforeValidate(e,t,r){const i=this.hot.propToCol(r);if(this.isFormulaCellType(t,i)){const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},a=this.hot.getCellMeta(t,i);let c=this.engine.getCellValue(o);return a.type==="date"&&isNumeric(c)&&(c=getDateFromExcelDate(c,a.dateFormat)),typeof c=="object"&&c!==null?c.value:c}return e}function _onBeforeAutofill(e,t,r){const{row:i,col:o}=t.getTopStartCorner(),{row:a,col:c}=t.getBottomEndCorner(),{row:u,col:h}=r.getTopStartCorner(),{row:d,col:f}=r.getBottomEndCorner(),m={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}},g={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(d),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(f),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(g)===!1)return!1;const v=this.engine.getFillRangeData(m,g),{row:_,col:b}=m.start,{row:S,col:R}=m.end,A=S-_+1,I=R-b+1;for(let E=0;E<v.length;E+=1)for(let O=0;O<v[E].length;O+=1){const P=v[E][O],L=_+E%A,V=b+O%I,$=this.hot.getCellMeta(L,V);isDate2(P,$.type)&&(P.startsWith("'")?v[E][O]=P.slice(1):this.isFormulaCellType(L,V,this.sheetId)===!1&&(v[E][O]=getDateInHotFormat(P,$.dateFormat)))}return v}function _onBeforeLoadData(e,t){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(toUpperCaseFirst(PLUGIN_KEY17))||_classPrivateFieldSet33(_hotWasInitializedWithEmptyData,this,isUndefined(this.hot.getSettings().data))}function _onAfterCellMetaReset(){const e=this.hot.getSourceDataArray();let t=!1;e.forEach((r,i)=>{r.forEach((o,a)=>{const c=this.hot.getCellMeta(i,a),u=c.dateFormat;isDate2(o,c.type)&&(t=!0,isDateValid(o,u)?e[i][a]=getDateInHfFormat(o,u):this.isFormulaCellType(i,a)===!1&&(e[i][a]=`'${o}`))})}),t===!0&&(_classPrivateFieldSet33(_internalOperationPending,this,!0),this.engine.setSheetContent(this.sheetId,e),_classPrivateFieldSet33(_internalOperationPending,this,!1))}function _onAfterLoadData5(e,t){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(toUpperCaseFirst(PLUGIN_KEY17)))if(this.sheetName=setupSheet(this.engine,this.hot.getSettings()[PLUGIN_KEY17].sheetName),_classPrivateFieldGet36(_hotWasInitializedWithEmptyData,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){_classPrivateFieldSet33(_internalOperationPending,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),_classPrivateFieldSet33(_internalOperationPending,this,!1)}}}function _onModifyData(e,t,r,i){if(i!=="get"||_classPrivateFieldGet36(_internalOperationPending,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const o=this.hot.toVisualRow(e);if(o===null||t===null)return;if(!this.isFormulaCellType(o,t)&&this.getCellType(o,t)!=="ARRAY"){isEscapedFormulaExpression(r.value)&&(r.value=unescapeFormulaExpression(r.value));return}const c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};let u=this.engine.getCellValue(c),h=this.hot.getCellsMeta().find(f=>f.visualRow===o&&f.visualCol===t);h===void 0&&(h={}),h.type==="date"&&isNumeric(u)&&(u=getDateFromExcelDate(u,h.dateFormat));const d=typeof u=="object"&&u!==null?u.value:u;r.value=d}function _onModifySourceData(e,t,r,i){if(i!=="get"||_classPrivateFieldGet36(_internalOperationPending,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const o=this.hot.toVisualRow(e),a=this.hot.propToCol(t);if(o===null||a===null||!this.isFormulaCellType(o,a)&&this.getCellType(o,a)!=="ARRAY")return;const u=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(u.width===0&&u.height===0)return;const h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId};r.value=this.engine.getCellSerialized(h)}function _onAfterSetDataAtCell(e,t){if(isBlockedSource(t))return;const r=[],i=[],o=this.engine.batch(()=>{e.forEach(a=>{let[c,u,,h]=a;const d=this.hot.propToCol(u),f=this.hot.toPhysicalRow(c),m=this.hot.toPhysicalColumn(d),g={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(d),sheet:this.sheetId};f!==null&&m!==null?this.syncChangeWithEngine(c,d,h):r.push([c,d,h]),i.push({address:g})})});r.length&&this.hot.addHookOnce("afterChange",()=>{const a=this.engine.batch(()=>{r.forEach(c=>{let[u,h,d]=c;this.syncChangeWithEngine(u,h,d)})});this.renderDependentSheets(a,!0)}),this.renderDependentSheets(o),this.validateDependentCells(o,i)}function _onAfterSetSourceDataAtCell(e,t){if(isBlockedSource(t))return;const r=[],i=[];e.forEach(o=>{let[a,c,,u]=o;const h=this.hot.propToCol(c);if(!isNumeric(h))return;const d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(d)){warn(`Not possible to set source cell data at ${JSON.stringify(d)}`);return}i.push({address:d}),r.push(...this.engine.setCellContents(d,u))}),this.renderDependentSheets(r),this.validateDependentCells(r,i)}function _onBeforeCreateRow(e,t){let r=this.rowAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countRows()&&(r=e),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[r,t]))return!1}function _onBeforeCreateCol(e,t){let r=this.columnAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countCols()&&(r=e),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[r,t]))return!1}function _onBeforeRemoveRow(e,t,r){return this.rowAxisSyncer.setRemovedHfIndexes(r).every(a=>this.engine.isItPossibleToRemoveRows(this.sheetId,[a,1]))===!1?!1:void 0}function _onBeforeRemoveCol(e,t,r){return this.columnAxisSyncer.setRemovedHfIndexes(r).every(a=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[a,1]))===!1?!1:void 0}function _onAfterCreateRow(e,t,r){if(isBlockedSource(r))return;const i=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(i)}function _onAfterCreateCol(e,t,r){if(isBlockedSource(r))return;const i=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(i)}function _onAfterRemoveRow(e,t,r,i){if(isBlockedSource(i))return;const o=this.rowAxisSyncer.getRemovedHfIndexes().sort((c,u)=>u-c),a=this.engine.batch(()=>{o.forEach(c=>{this.engine.removeRows(this.sheetId,[c,1])})});this.renderDependentSheets(a)}function _onAfterRemoveCol(e,t,r,i){if(isBlockedSource(i))return;const o=this.columnAxisSyncer.getRemovedHfIndexes().sort((c,u)=>u-c),a=this.engine.batch(()=>{o.forEach(c=>{this.engine.removeColumns(this.sheetId,[c,1])})});this.renderDependentSheets(a)}function _onAfterDetachChild(e,t,r){var i;_classPrivateFieldSet33(_internalOperationPending,this,!0);const o=this.hot.getSourceDataArray(r,0,r+(((i=t.__children)===null||i===void 0?void 0:i.length)||0),this.hot.countSourceCols());_classPrivateFieldSet33(_internalOperationPending,this,!1),o.forEach((a,c)=>{a.forEach((u,h)=>{this.engine.setCellContents({col:h,row:r+c,sheet:this.sheetId},[[u]])})})}function _onEngineValuesUpdated(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}function _onEngineNamedExpressionsAdded(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}function _onEngineNamedExpressionsRemoved(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}function _onEngineSheetAdded(e){this.hot.runHooks("afterSheetAdded",e)}function _onEngineSheetRenamed(e,t){this.sheetName=t,this.hot.runHooks("afterSheetRenamed",e,t)}function _onEngineSheetRemoved(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}var import_es_error_cause140=__toESM(require_es_error_cause(),1),import_es_array_push81=__toESM(require_es_array_push(),1),import_es_set_difference_v220=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v220=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v220=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v220=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v220=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v220=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v220=__toESM(require_es_set_union_v2(),1),import_es_array_push79=__toESM(require_es_array_push(),1);function hideColumnItem(e){return{key:"hidden_columns_hide",name(){const t=this.getSelectedLast();let r=0;if(Array.isArray(t)){const[,i,,o]=t;i-o!==0&&(r=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_HIDE_COLUMN,r)},callback(){const{from:t,to:r}=this.getSelectedRangeLast(),i=Math.max(Math.min(t.col,r.col),0),o=Math.max(t.col,r.col),a=[];for(let h=i;h<=o;h+=1)a.push(h);e.hideColumns(a);const c=a[a.length-1],u=this.columnIndexMapper.getNearestNotHiddenIndex(c,1,!0);Number.isInteger(u)&&u>=0?this.selectColumns(u):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}var import_es_array_push80=__toESM(require_es_array_push(),1);function showColumnItem(e){const t=[];return{key:"hidden_columns_show",name(){const r=t.length>1?1:0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_SHOW_COLUMN,r)},callback(){var r,i;if(t.length===0)return;let o=t[0],a=t[t.length-1];o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&r!==void 0?r:0,a=(i=this.columnIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&i!==void 0?i:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(),a-o+1===this.countCols()||this.selectColumns(o,a)},disabled:!1,hidden(){const r=arrayMap(e.getHiddenColumns(),m=>this.toPhysicalColumn(m));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;t.length=0;const i=this.getSelectedRangeLast(),o=i.getTopStartCorner().col,a=i.getBottomEndCorner().col,c=this.columnIndexMapper,u=c.getRenderableFromVisualIndex(o),h=c.getRenderableFromVisualIndex(a),d=c.getNotTrimmedIndexes(),f=[];if(o!==a){const m=a-o+1,g=h-u+1;if(m>g){const v=d.slice(o,a+1);f.push(...v.filter(_=>r.includes(_)))}}else if(u===0&&u<o)f.push(...d.slice(0,o));else if(u===null)f.push(...d.slice(0,this.countCols()));else{const m=this.countCols()-1,g=c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(m,-1));h===g&&m>a&&f.push(...d.slice(a+1))}return arrayEach(f,m=>{t.push(this.toVisualColumn(m))}),t.length===0}}}function _classPrivateMethodInitSpec35(e,t){_checkPrivateRedeclaration52(e,t),t.add(e)}function _classPrivateFieldInitSpec37(e,t,r){_checkPrivateRedeclaration52(e,t),t.set(e,r)}function _checkPrivateRedeclaration52(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet37(e,t){return e.get(_assertClassBrand52(e,t))}function _classPrivateFieldSet34(e,t,r){return e.set(_assertClassBrand52(e,t),r),r}function _assertClassBrand52(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}pluginHooks_default.getSingleton().register("beforeHideColumns"),pluginHooks_default.getSingleton().register("afterHideColumns"),pluginHooks_default.getSingleton().register("beforeUnhideColumns"),pluginHooks_default.getSingleton().register("afterUnhideColumns");var PLUGIN_KEY18="hiddenColumns",PLUGIN_PRIORITY17=310,_settings=new WeakMap,_hiddenColumnsMap=new WeakMap,_HiddenColumns_brand=new WeakSet,HiddenColumns=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec35(this,_HiddenColumns_brand),_classPrivateFieldInitSpec37(this,_settings,{}),_classPrivateFieldInitSpec37(this,_hiddenColumnsMap,null)}static get PLUGIN_KEY(){return PLUGIN_KEY18}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY17}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY18]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[PLUGIN_KEY18];isObject2(t)&&(_classPrivateFieldSet34(_settings,this,t),isUndefined(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),_classPrivateFieldSet34(_hiddenColumnsMap,this,new HidingMap),_classPrivateFieldGet37(_hiddenColumnsMap,this).addLocalHook("init",()=>_assertClassBrand52(_HiddenColumns_brand,this,_onMapInit).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet37(_hiddenColumnsMap,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand52(_HiddenColumns_brand,e,_onAfterContextMenuDefaultOptions3).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>_assertClassBrand52(_HiddenColumns_brand,this,_onAfterGetCellMeta).call(this,r,i,o)),this.addHook("modifyColWidth",(r,i)=>_assertClassBrand52(_HiddenColumns_brand,this,_onModifyColWidth).call(this,r,i),2),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand52(_HiddenColumns_brand,e,_onAfterGetColHeader5).call(e,...i)}),this.addHook("modifyCopyableRange",r=>_assertClassBrand52(_HiddenColumns_brand,this,_onModifyCopyableRange).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),_classPrivateFieldSet34(_settings,this,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),r=this.isValidConfig(e);let i=t;const o=_classPrivateFieldGet37(_hiddenColumnsMap,this).getValues().slice(),a=e.length>0;if(r&&a){const u=e.map(h=>this.hot.toPhysicalColumn(h));arrayEach(u,h=>{o[h]=!1}),i=arrayReduce(o,(h,d,f)=>(d&&h.push(this.hot.toVisualColumn(f)),h),[])}this.hot.runHooks("beforeUnhideColumns",t,i,r&&a)!==!1&&(r&&a&&_classPrivateFieldGet37(_hiddenColumnsMap,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,i,r&&a,r&&i.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),r=this.isValidConfig(e);let i=t;r&&(i=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideColumns",t,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{arrayEach(e,a=>{_classPrivateFieldGet37(_hiddenColumnsMap,this).setValueAtIndex(this.hot.toPhysicalColumn(a),!0)})},!0),this.hot.runHooks("afterHideColumns",t,i,r,r&&i.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideColumns(t)}getHiddenColumns(){return arrayMap(_classPrivateFieldGet37(_hiddenColumnsMap,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return _classPrivateFieldGet37(_hiddenColumnsMap,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<t):!1}resetCellsMeta(){arrayEach(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){_classPrivateFieldSet34(_settings,this,null),_classPrivateFieldSet34(_hiddenColumnsMap,this,null),super.destroy()}};function _onModifyColWidth(e,t){if(this.isHidden(t))return 0;if(_classPrivateFieldGet37(_settings,this).indicators&&(this.isHidden(t+1)||this.isHidden(t-1))&&typeof e=="number"&&this.hot.hasColHeaders())return e+15}function _onAfterGetCellMeta(e,t,r){if(_classPrivateFieldGet37(_settings,this).copyPasteEnabled===!1&&this.isHidden(t)&&(r.skipColumnOnPaste=!0),this.isHidden(t-1))r.className=r.className||"",r.className.indexOf("afterHiddenColumn")===-1&&(r.className+=" afterHiddenColumn");else if(r.className){const i=r.className.split(" ");if(i.length>0){const o=i.indexOf("afterHiddenColumn");o>-1&&i.splice(o,1),r.className=i.join(" ")}}}function _onModifyCopyableRange(e){if(_classPrivateFieldGet37(_settings,this).copyPasteEnabled)return e;const t=[],r=(i,o,a,c)=>{t.push({startRow:i,endRow:o,startCol:a,endCol:c})};return arrayEach(e,i=>{let o=!0,a=0;rangeEach(i.startCol,i.endCol,c=>{this.isHidden(c)?(o||r(i.startRow,i.endRow,a,c-1),o=!0):(o&&(a=c),c===i.endCol&&r(i.startRow,i.endRow,a,c),o=!1)})}),t}function _onAfterGetColHeader5(e,t){if(!_classPrivateFieldGet37(_settings,this).indicators||e<0)return;const r=[];e>=1&&this.isHidden(e-1)&&r.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&r.push("beforeHiddenColumn"),addClass(t,r)}function _onAfterContextMenuDefaultOptions3(e){e.items.push({name:KEY},hideColumnItem(this),showColumnItem(this))}function _onMapInit(){Array.isArray(_classPrivateFieldGet37(_settings,this).columns)&&this.hideColumns(_classPrivateFieldGet37(_settings,this).columns)}var import_es_error_cause141=__toESM(require_es_error_cause(),1),import_es_array_push84=__toESM(require_es_array_push(),1),import_es_set_difference_v221=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v221=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v221=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v221=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v221=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v221=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v221=__toESM(require_es_set_union_v2(),1),import_es_array_push82=__toESM(require_es_array_push(),1);function hideRowItem(e){return{key:"hidden_rows_hide",name(){const t=this.getSelectedLast();let r=0;if(Array.isArray(t)){const[i,,o]=t;i-o!==0&&(r=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_HIDE_ROW,r)},callback(){const{from:t,to:r}=this.getSelectedRangeLast(),i=Math.max(Math.min(t.row,r.row),0),o=Math.max(t.row,r.row),a=[];for(let h=i;h<=o;h+=1)a.push(h);e.hideRows(a);const c=a[a.length-1],u=this.rowIndexMapper.getNearestNotHiddenIndex(c,1,!0);Number.isInteger(u)&&u>=0?this.selectRows(u):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}var import_es_array_push83=__toESM(require_es_array_push(),1);function showRowItem(e){const t=[];return{key:"hidden_rows_show",name(){const r=t.length>1?1:0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_SHOW_ROW,r)},callback(){var r,i;if(t.length===0)return;let o=t[0],a=t[t.length-1];o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&r!==void 0?r:0,a=(i=this.rowIndexMapper.getNearestNotHiddenIndex(a+1,1))!==null&&i!==void 0?i:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(),a-o+1===this.countRows()||this.selectRows(o,a)},disabled:!1,hidden(){const r=arrayMap(e.getHiddenRows(),m=>this.toPhysicalRow(m));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;t.length=0;const i=this.getSelectedRangeLast(),o=i.getTopStartCorner().row,a=i.getBottomEndCorner().row,c=this.rowIndexMapper,u=c.getRenderableFromVisualIndex(o),h=c.getRenderableFromVisualIndex(a),d=c.getNotTrimmedIndexes(),f=[];if(o!==a){const m=a-o+1,g=h-u+1;if(m>g){const v=d.slice(o,a+1);f.push(...v.filter(_=>r.includes(_)))}}else if(u===0&&u<o)f.push(...d.slice(0,o));else if(u===null)f.push(...d.slice(0,this.countRows()));else{const m=this.countRows()-1,g=c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(m,-1));h===g&&m>a&&f.push(...d.slice(a+1))}return arrayEach(f,m=>{t.push(this.toVisualRow(m))}),t.length===0}}}function _classPrivateMethodInitSpec36(e,t){_checkPrivateRedeclaration53(e,t),t.add(e)}function _classPrivateFieldInitSpec38(e,t,r){_checkPrivateRedeclaration53(e,t),t.set(e,r)}function _checkPrivateRedeclaration53(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet38(e,t){return e.get(_assertClassBrand53(e,t))}function _classPrivateFieldSet35(e,t,r){return e.set(_assertClassBrand53(e,t),r),r}function _assertClassBrand53(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}pluginHooks_default.getSingleton().register("beforeHideRows"),pluginHooks_default.getSingleton().register("afterHideRows"),pluginHooks_default.getSingleton().register("beforeUnhideRows"),pluginHooks_default.getSingleton().register("afterUnhideRows");var PLUGIN_KEY19="hiddenRows",PLUGIN_PRIORITY18=320,_settings2=new WeakMap,_hiddenRowsMap=new WeakMap,_HiddenRows_brand=new WeakSet,HiddenRows=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec36(this,_HiddenRows_brand),_classPrivateFieldInitSpec38(this,_settings2,{}),_classPrivateFieldInitSpec38(this,_hiddenRowsMap,null)}static get PLUGIN_KEY(){return PLUGIN_KEY19}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY18}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY19]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[PLUGIN_KEY19];isObject2(t)&&(_classPrivateFieldSet35(_settings2,this,t),isUndefined(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),_classPrivateFieldSet35(_hiddenRowsMap,this,new HidingMap),_classPrivateFieldGet38(_hiddenRowsMap,this).addLocalHook("init",()=>_assertClassBrand53(_HiddenRows_brand,this,_onMapInit2).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet38(_hiddenRowsMap,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand53(_HiddenRows_brand,e,_onAfterContextMenuDefaultOptions4).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>_assertClassBrand53(_HiddenRows_brand,this,_onAfterGetCellMeta2).call(this,r,i,o)),this.addHook("modifyRowHeight",(r,i)=>_assertClassBrand53(_HiddenRows_brand,this,_onModifyRowHeight).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand53(_HiddenRows_brand,e,_onAfterGetRowHeader).call(e,...i)}),this.addHook("modifyCopyableRange",r=>_assertClassBrand53(_HiddenRows_brand,this,_onModifyCopyableRange2).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),_classPrivateFieldSet35(_settings2,this,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),r=this.isValidConfig(e);let i=t;const o=_classPrivateFieldGet38(_hiddenRowsMap,this).getValues().slice(),a=e.length>0;if(r&&a){const u=e.map(h=>this.hot.toPhysicalRow(h));arrayEach(u,h=>{o[h]=!1}),i=arrayReduce(o,(h,d,f)=>(d&&h.push(this.hot.toVisualRow(f)),h),[])}this.hot.runHooks("beforeUnhideRows",t,i,r&&a)!==!1&&(r&&a&&_classPrivateFieldGet38(_hiddenRowsMap,this).setValues(o),this.hot.runHooks("afterUnhideRows",t,i,r&&a,r&&i.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),r=this.isValidConfig(e);let i=t;r&&(i=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideRows",t,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{arrayEach(e,a=>{_classPrivateFieldGet38(_hiddenRowsMap,this).setValueAtIndex(this.hot.toPhysicalRow(a),!0)})},!0),this.hot.runHooks("afterHideRows",t,i,r,r&&i.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideRows(t)}getHiddenRows(){return arrayMap(_classPrivateFieldGet38(_hiddenRowsMap,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return _classPrivateFieldGet38(_hiddenRowsMap,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<t):!1}resetCellsMeta(){arrayEach(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){_classPrivateFieldSet35(_settings2,this,null),_classPrivateFieldSet35(_hiddenRowsMap,this,null),super.destroy()}};function _onModifyRowHeight(e,t){return this.isHidden(t)?0:e}function _onAfterGetCellMeta2(e,t,r){if(_classPrivateFieldGet38(_settings2,this).copyPasteEnabled===!1&&this.isHidden(e)&&(r.skipRowOnPaste=!0),this.isHidden(e-1))r.className=r.className||"",r.className.indexOf("afterHiddenRow")===-1&&(r.className+=" afterHiddenRow");else if(r.className){const i=r.className.split(" ");if(i.length>0){const o=i.indexOf("afterHiddenRow");o>-1&&i.splice(o,1),r.className=i.join(" ")}}}function _onModifyCopyableRange2(e){if(_classPrivateFieldGet38(_settings2,this).copyPasteEnabled)return e;const t=[],r=(i,o,a,c)=>{t.push({startRow:i,endRow:o,startCol:a,endCol:c})};return arrayEach(e,i=>{let o=!0,a=0;rangeEach(i.startRow,i.endRow,c=>{this.isHidden(c)?(o||r(a,c-1,i.startCol,i.endCol),o=!0):(o&&(a=c),c===i.endRow&&r(a,c,i.startCol,i.endCol),o=!1)})}),t}function _onAfterGetRowHeader(e,t){if(!_classPrivateFieldGet38(_settings2,this).indicators||e<0)return;const r=[];e>=1&&this.isHidden(e-1)&&r.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&r.push("beforeHiddenRow"),addClass(t,r)}function _onAfterContextMenuDefaultOptions4(e){e.items.push({name:KEY},hideRowItem(this),showRowItem(this))}function _onMapInit2(){Array.isArray(_classPrivateFieldGet38(_settings2,this).rows)&&this.hideRows(_classPrivateFieldGet38(_settings2,this).rows)}var import_es_error_cause142=__toESM(require_es_error_cause(),1),import_es_array_push85=__toESM(require_es_array_push(),1);function freezeColumnItem(e){return{key:"freeze_column",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback(t,r){const[{start:{col:i}}]=r;e.freezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const t=this.getSelectedRange();let r=!1;return(t===void 0||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(r=!0),r}}}function unfreezeColumnItem(e){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback(t,r){const[{start:{col:i}}]=r;e.unfreezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const t=this.getSelectedRange();let r=!1;return(t===void 0||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsStart)&&(r=!0),r}}}function _classPrivateMethodInitSpec37(e,t){_checkPrivateRedeclaration54(e,t),t.add(e)}function _classPrivateFieldInitSpec39(e,t,r){_checkPrivateRedeclaration54(e,t),t.set(e,r)}function _checkPrivateRedeclaration54(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet39(e,t){return e.get(_assertClassBrand54(e,t))}function _classPrivateFieldSet36(e,t,r){return e.set(_assertClassBrand54(e,t),r),r}function _assertClassBrand54(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}pluginHooks_default.getSingleton().register("beforeColumnFreeze"),pluginHooks_default.getSingleton().register("afterColumnFreeze"),pluginHooks_default.getSingleton().register("beforeColumnUnfreeze"),pluginHooks_default.getSingleton().register("afterColumnUnfreeze");var PLUGIN_KEY20="manualColumnFreeze",PLUGIN_PRIORITY19=110,_afterFirstUse=new WeakMap,_ManualColumnFreeze_brand=new WeakSet,ManualColumnFreeze=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec37(this,_ManualColumnFreeze_brand),_classPrivateFieldInitSpec39(this,_afterFirstUse,!1)}static get PLUGIN_KEY(){return PLUGIN_KEY20}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY19}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY20]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>_assertClassBrand54(_ManualColumnFreeze_brand,this,_addContextMenuEntry).call(this,e)),this.addHook("beforeColumnMove",(e,t)=>_assertClassBrand54(_ManualColumnFreeze_brand,this,_onBeforeColumnMove).call(this,e,t)),super.enablePlugin())}disablePlugin(){_classPrivateFieldSet36(_afterFirstUse,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=this.hot.getSettings(),r=t.fixedColumnsStart<this.hot.countCols()&&e>t.fixedColumnsStart-1;_classPrivateFieldGet39(_afterFirstUse,this)||_classPrivateFieldSet36(_afterFirstUse,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart),t._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const t=this.hot.getSettings(),r=t.fixedColumnsStart>0&&e<=t.fixedColumnsStart-1;_classPrivateFieldGet39(_afterFirstUse,this)||_classPrivateFieldSet36(_afterFirstUse,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(t._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}};function _addContextMenuEntry(e){e.items.push({name:"---------"},freezeColumnItem(this),unfreezeColumnItem(this))}function _onBeforeColumnMove(e,t){if(_classPrivateFieldGet39(_afterFirstUse,this)){const r=this.hot.getSettings().fixedColumnsStart;if(t<r||e.some(i=>i<r))return!1}}var import_es_error_cause144=__toESM(require_es_error_cause(),1),import_es_array_push86=__toESM(require_es_array_push(),1),import_es_error_cause143=__toESM(require_es_error_cause(),1);function _defineProperty98(e,t,r){return(t=_toPropertyKey98(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey98(e){var t=_toPrimitive98(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive98(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var STATE_INITIALIZED=0,STATE_BUILT2=1,STATE_APPENDED=2,UNIT="px",BaseUI2=class{constructor(e){_defineProperty98(this,"hot",void 0),_defineProperty98(this,"_element",null),_defineProperty98(this,"state",STATE_INITIALIZED),_defineProperty98(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=STATE_APPENDED}build(){this.state===STATE_INITIALIZED&&(this._element=this.hot.rootDocument.createElement("div"),this.state=STATE_BUILT2)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=STATE_INITIALIZED}isAppended(){return this.state===STATE_APPENDED}isBuilt(){return this.state>=STATE_BUILT2}setPosition(e,t){isNumeric(e)&&(this._element.style.top=e+UNIT),isNumeric(t)&&(this._element.style[this.inlineProperty]=t+UNIT)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){isNumeric(e)&&(this._element.style.width=e+UNIT),isNumeric(t)&&(this._element.style.height=t+UNIT)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){isNumeric(e)&&(this._element.style.marginTop=e+UNIT),isNumeric(t)&&(this._element.style[`margin${toUpperCaseFirst(this.inlineProperty)}`]=t+UNIT)}getOffset(){const e=this._element.style,t=`margin${toUpperCaseFirst(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}},base_default3=BaseUI2,CSS_CLASSNAME="ht__manualColumnMove--backlight",BacklightUI=class extends base_default3{build(){super.build(),addClass(this._element,CSS_CLASSNAME)}},backlight_default=BacklightUI,CSS_CLASSNAME2="ht__manualColumnMove--guideline",GuidelineUI=class extends base_default3{build(){super.build(),addClass(this._element,CSS_CLASSNAME2)}},guideline_default=GuidelineUI;function _classPrivateMethodInitSpec38(e,t){_checkPrivateRedeclaration55(e,t),t.add(e)}function _classPrivateFieldInitSpec40(e,t,r){_checkPrivateRedeclaration55(e,t),t.set(e,r)}function _checkPrivateRedeclaration55(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet37(e,t,r){return e.set(_assertClassBrand55(e,t),r),r}function _classPrivateFieldGet40(e,t){return e.get(_assertClassBrand55(e,t))}function _assertClassBrand55(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}pluginHooks_default.getSingleton().register("beforeColumnMove"),pluginHooks_default.getSingleton().register("afterColumnMove");var PLUGIN_KEY21="manualColumnMove",PLUGIN_PRIORITY20=120,CSS_PLUGIN="ht__manualColumnMove",CSS_SHOW_UI="show-ui",CSS_ON_MOVING="on-moving--columns",CSS_AFTER_SELECTION="after-selection--columns",_backlight=new WeakMap,_guideline=new WeakMap,_columnsToMove=new WeakMap,_countCols=new WeakMap,_pressed=new WeakMap,_target=new WeakMap,_cachedDropIndex=new WeakMap,_hoveredColumn=new WeakMap,_rootElementOffset=new WeakMap,_hasRowHeaders=new WeakMap,_fixedColumnsStart=new WeakMap,_ManualColumnMove_brand=new WeakSet,ManualColumnMove=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec38(this,_ManualColumnMove_brand),_classPrivateFieldInitSpec40(this,_backlight,new backlight_default(this.hot)),_classPrivateFieldInitSpec40(this,_guideline,new guideline_default(this.hot)),_classPrivateFieldInitSpec40(this,_columnsToMove,[]),_classPrivateFieldInitSpec40(this,_countCols,0),_classPrivateFieldInitSpec40(this,_pressed,!1),_classPrivateFieldInitSpec40(this,_target,{}),_classPrivateFieldInitSpec40(this,_cachedDropIndex,void 0),_classPrivateFieldInitSpec40(this,_hoveredColumn,void 0),_classPrivateFieldInitSpec40(this,_rootElementOffset,void 0),_classPrivateFieldInitSpec40(this,_hasRowHeaders,void 0),_classPrivateFieldInitSpec40(this,_fixedColumnsStart,void 0)}static get PLUGIN_KEY(){return PLUGIN_KEY21}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY20}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY21]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand55(_ManualColumnMove_brand,e,_onBeforeOnCellMouseDown4).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand55(_ManualColumnMove_brand,e,_onBeforeOnCellMouseOver).call(e,...r)}),this.addHook("afterScrollVertically",()=>_assertClassBrand55(_ManualColumnMove_brand,this,_onAfterScrollVertically).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand55(_ManualColumnMove_brand,e,_onAfterLoadData6).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),addClass(this.hot.rootElement,CSS_PLUGIN),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){removeClass(this.hot.rootElement,CSS_PLUGIN),this.unregisterEvents(),_classPrivateFieldGet40(_backlight,this).destroy(),_classPrivateFieldGet40(_guideline,this).destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const r=_classPrivateFieldGet40(_cachedDropIndex,this),i=this.isMovePossible(e,t),o=this.hot.runHooks("beforeColumnMove",e,t,r,i);if(_classPrivateFieldSet37(_cachedDropIndex,this,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,t);const a=i&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,r,i,a),a}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const r=this.countFinalIndex(e,t);return _classPrivateFieldSet37(_cachedDropIndex,this,t),this.moveColumns(e,r)}isMovePossible(e,t){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+t>r,o=t<0,a=e.some(u=>u<0),c=e.some(u=>u>=r);return!(i||o||a||c)}isColumnOrderChanged(e,t){return e.some((r,i)=>r-i!==t)}countFinalIndex(e,t){const r=arrayReduce(e,(i,o)=>(o<t&&(i+=1),i),0);return t-r}getColumnsWidth(e,t){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=t;o+=1){const a=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:a!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(a)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[PLUGIN_KEY21];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const r=[];return rangeEach(e,t,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(_classPrivateFieldGet40(_hoveredColumn,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const t=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,_classPrivateFieldGet40(_hoveredColumn,this)-1);const a=t.hider.offsetWidth,c=t.TBODY.offsetLeft,u=_classPrivateFieldGet40(_backlight,this).getOffset().start,h=_classPrivateFieldGet40(_backlight,this).getSize().width;let d=0,f=0;if(this.hot.isRtl()){const v=this.hot.rootWindow,_=outerWidth(this.hot.rootElement),b=v.innerWidth-_classPrivateFieldGet40(_rootElementOffset,this)-_;f=v.innerWidth-_classPrivateFieldGet40(_target,this).eventPageX-b-(r.scrollX===void 0?i:0)}else f=_classPrivateFieldGet40(_target,this).eventPageX-(_classPrivateFieldGet40(_rootElementOffset,this)-(r.scrollX===void 0?i:0));if(_classPrivateFieldGet40(_hasRowHeaders,this)&&(d=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(_classPrivateFieldGet40(_hoveredColumn,this))&&(o+=i),o+=d,_classPrivateFieldGet40(_hoveredColumn,this)<0)_classPrivateFieldGet40(_fixedColumnsStart,this)>0?_classPrivateFieldGet40(_target,this).col=0:_classPrivateFieldGet40(_target,this).col=e>0?e-1:e;else if(_classPrivateFieldGet40(_target,this).TD.offsetWidth/2+o<=f){const v=_classPrivateFieldGet40(_hoveredColumn,this)>=_classPrivateFieldGet40(_countCols,this)?_classPrivateFieldGet40(_countCols,this)-1:_classPrivateFieldGet40(_hoveredColumn,this);_classPrivateFieldGet40(_target,this).col=v+1,o+=_classPrivateFieldGet40(_target,this).TD.offsetWidth}else _classPrivateFieldGet40(_target,this).col=_classPrivateFieldGet40(_hoveredColumn,this);let m=f,g=o;f+h+u>=a?m=a-h-u:f+u<c+d&&(m=c+d+Math.abs(u)),o>=a-1?g=a-1:g===0?g=1:r.scrollX!==void 0&&_classPrivateFieldGet40(_hoveredColumn,this)<_classPrivateFieldGet40(_fixedColumnsStart,this)&&(g-=_classPrivateFieldGet40(_rootElementOffset,this)<=r.scrollX?_classPrivateFieldGet40(_rootElementOffset,this):0),_classPrivateFieldGet40(_backlight,this).setPosition(null,m),_classPrivateFieldGet40(_guideline,this).setPosition(null,g)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>_assertClassBrand55(_ManualColumnMove_brand,this,_onMouseMove2).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand55(_ManualColumnMove_brand,this,_onMouseUp3).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){_classPrivateFieldGet40(_backlight,this).build(),_classPrivateFieldGet40(_guideline,this).build()}destroy(){_classPrivateFieldGet40(_backlight,this).destroy(),_classPrivateFieldGet40(_guideline,this).destroy(),super.destroy()}};function _onBeforeOnCellMouseDown4(e,t,r,i){const o=this.hot.view._wt.wtTable,a=this.hot.selection.isSelectedByColumnHeader(),c=this.hot.getSelectedRangeLast(),u=hasClass(e.target,"sortAction");if(!c||!a||_classPrivateFieldGet40(_pressed,this)||e.button!==0||u){_classPrivateFieldSet37(_pressed,this,!1),_classPrivateFieldGet40(_columnsToMove,this).length=0,removeClass(this.hot.rootElement,[CSS_ON_MOVING,CSS_SHOW_UI]);return}const h=_classPrivateFieldGet40(_guideline,this).isBuilt()&&!_classPrivateFieldGet40(_guideline,this).isAppended(),d=_classPrivateFieldGet40(_backlight,this).isBuilt()&&!_classPrivateFieldGet40(_backlight,this).isAppended();h&&d&&(_classPrivateFieldGet40(_guideline,this).appendTo(o.hider),_classPrivateFieldGet40(_backlight,this).appendTo(o.hider));const{from:f,to:m}=c,g=Math.min(f.col,m.col),v=Math.max(f.col,m.col);if(t.row<0&&t.col>=g&&t.col<=v){i.column=!0,_classPrivateFieldSet37(_pressed,this,!0);const _=r.firstChild?offsetRelativeTo(e,r.firstChild).x:e.offsetX;_classPrivateFieldGet40(_target,this).eventPageX=e.pageX,_classPrivateFieldSet37(_hoveredColumn,this,t.col),_classPrivateFieldGet40(_target,this).TD=r,_classPrivateFieldGet40(_target,this).col=t.col,_classPrivateFieldSet37(_columnsToMove,this,this.prepareColumnsToMoving(g,v)),_classPrivateFieldSet37(_hasRowHeaders,this,!!this.hot.getSettings().rowHeaders),_classPrivateFieldSet37(_countCols,this,this.hot.countCols()),_classPrivateFieldSet37(_fixedColumnsStart,this,this.hot.getSettings().fixedColumnsStart),_classPrivateFieldSet37(_rootElementOffset,this,offset(this.hot.rootElement).left);const b=_classPrivateFieldGet40(_hasRowHeaders,this)?-1:0,S=o.holder.scrollTop+o.getColumnHeaderHeight(0)+1,R=t.col<_classPrivateFieldGet40(_fixedColumnsStart,this),A=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),I=Math.abs(_-(this.hot.isRtl()?r.offsetWidth:0)),E=this.getColumnsWidth(g,t.col-1)+I,O=this.getColumnsWidth(b,g-1)+(R?A:0)+E;_classPrivateFieldGet40(_backlight,this).setPosition(S,O),_classPrivateFieldGet40(_backlight,this).setSize(this.getColumnsWidth(g,v),o.hider.offsetHeight-S),_classPrivateFieldGet40(_backlight,this).setOffset(null,-E),addClass(this.hot.rootElement,CSS_ON_MOVING)}else removeClass(this.hot.rootElement,CSS_AFTER_SELECTION),_classPrivateFieldSet37(_pressed,this,!1),_classPrivateFieldGet40(_columnsToMove,this).length=0}function _onMouseMove2(e){_classPrivateFieldGet40(_pressed,this)&&(_classPrivateFieldGet40(_target,this).eventPageX=e.pageX,this.refreshPositions())}function _onBeforeOnCellMouseOver(e,t,r,i){!this.hot.getSelectedRangeLast()||!_classPrivateFieldGet40(_pressed,this)||(_classPrivateFieldGet40(_columnsToMove,this).indexOf(t.col)>-1?removeClass(this.hot.rootElement,CSS_SHOW_UI):addClass(this.hot.rootElement,CSS_SHOW_UI),i.row=!0,i.column=!0,i.cell=!0,_classPrivateFieldSet37(_hoveredColumn,this,t.col),_classPrivateFieldGet40(_target,this).TD=r)}function _onMouseUp3(){const e=_classPrivateFieldGet40(_target,this).col,t=_classPrivateFieldGet40(_columnsToMove,this).length;if(_classPrivateFieldSet37(_hoveredColumn,this,void 0),_classPrivateFieldSet37(_pressed,this,!1),removeClass(this.hot.rootElement,[CSS_ON_MOVING,CSS_SHOW_UI,CSS_AFTER_SELECTION]),this.hot.selection.isSelectedByColumnHeader()&&addClass(this.hot.rootElement,CSS_AFTER_SELECTION),t<1||e===void 0)return;const r=_classPrivateFieldGet40(_columnsToMove,this)[0],i=this.hot.toPhysicalColumn(r),o=this.dragColumns(_classPrivateFieldGet40(_columnsToMove,this),e);if(_classPrivateFieldGet40(_columnsToMove,this).length=0,o===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const a=this.hot.toVisualColumn(i),c=a+t-1;this.hot.selectColumns(a,c)}}function _onAfterScrollVertically(){const e=this.hot.view._wt.wtTable,t=e.getColumnHeaderHeight(0)+1,r=e.holder.scrollTop,i=t+r;_classPrivateFieldGet40(_backlight,this).setPosition(i),_classPrivateFieldGet40(_backlight,this).setSize(null,e.hider.offsetHeight-i)}function _onAfterLoadData6(){this.moveBySettingsOrLoad()}var import_es_error_cause145=__toESM(require_es_error_cause(),1),import_es_array_push87=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec39(e,t){_checkPrivateRedeclaration56(e,t),t.add(e)}function _classPrivateFieldInitSpec41(e,t,r){_checkPrivateRedeclaration56(e,t),t.set(e,r)}function _checkPrivateRedeclaration56(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet38(e,t,r){return e.set(_assertClassBrand56(e,t),r),r}function _classPrivateFieldGet41(e,t){return e.get(_assertClassBrand56(e,t))}function _assertClassBrand56(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var PLUGIN_KEY22="manualColumnResize",PLUGIN_PRIORITY21=130,PERSISTENT_STATE_KEY="manualColumnWidths",_currentTH=new WeakMap,_currentCol=new WeakMap,_selectedCols=new WeakMap,_currentWidth=new WeakMap,_newSize=new WeakMap,_startY=new WeakMap,_startWidth=new WeakMap,_startOffset=new WeakMap,_handle=new WeakMap,_guide=new WeakMap,_pressed2=new WeakMap,_isTriggeredByRMB=new WeakMap,_dblclick=new WeakMap,_autoresizeTimeout=new WeakMap,_columnWidthsMap=new WeakMap,_config=new WeakMap,_ManualColumnResize_brand=new WeakSet,ManualColumnResize=class extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY22}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY21}constructor(e){super(e),_classPrivateMethodInitSpec39(this,_ManualColumnResize_brand),_classPrivateFieldInitSpec41(this,_currentTH,null),_classPrivateFieldInitSpec41(this,_currentCol,null),_classPrivateFieldInitSpec41(this,_selectedCols,[]),_classPrivateFieldInitSpec41(this,_currentWidth,null),_classPrivateFieldInitSpec41(this,_newSize,null),_classPrivateFieldInitSpec41(this,_startY,null),_classPrivateFieldInitSpec41(this,_startWidth,null),_classPrivateFieldInitSpec41(this,_startOffset,null),_classPrivateFieldInitSpec41(this,_handle,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec41(this,_guide,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec41(this,_pressed2,null),_classPrivateFieldInitSpec41(this,_isTriggeredByRMB,!1),_classPrivateFieldInitSpec41(this,_dblclick,0),_classPrivateFieldInitSpec41(this,_autoresizeTimeout,null),_classPrivateFieldInitSpec41(this,_columnWidthsMap,void 0),_classPrivateFieldInitSpec41(this,_config,void 0),addClass(_classPrivateFieldGet41(_handle,this),"manualColumnResizer"),addClass(_classPrivateFieldGet41(_guide,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY22]}enablePlugin(){this.enabled||(_classPrivateFieldSet38(_columnWidthsMap,this,new PhysicalIndexToValueMap),_classPrivateFieldGet41(_columnWidthsMap,this).addLocalHook("init",()=>_assertClassBrand56(_ManualColumnResize_brand,this,_onMapInit3).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet41(_columnWidthsMap,this)),this.addHook("modifyColWidth",(e,t)=>_assertClassBrand56(_ManualColumnResize_brand,this,_onModifyColWidth2).call(this,e,t),1),this.addHook("beforeStretchingColumnWidth",(e,t)=>_assertClassBrand56(_ManualColumnResize_brand,this,_onBeforeStretchingColumnWidth).call(this,e,t)),this.addHook("beforeColumnResize",(e,t,r)=>_assertClassBrand56(_ManualColumnResize_brand,this,_onBeforeColumnResize2).call(this,e,t,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){_classPrivateFieldSet38(_config,this,_classPrivateFieldGet41(_columnWidthsMap,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",PERSISTENT_STATE_KEY,_classPrivateFieldGet41(_columnWidthsMap,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",PERSISTENT_STATE_KEY,e),e.value}setManualSize(e,t){const r=Math.max(t,20),i=this.hot.toPhysicalColumn(e);return _classPrivateFieldGet41(_columnWidthsMap,this).setValueAtIndex(i,r),r}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);_classPrivateFieldGet41(_columnWidthsMap,this).setValueAtIndex(t,null)}setupHandlePosition(e){if(!e.parentNode)return;_classPrivateFieldSet38(_currentTH,this,e);const{_wt:t}=this.hot.view,r=t.wtTable.getCoords(_classPrivateFieldGet41(_currentTH,this)),i=r.col;if(i<0)return;const o=outerHeight(_classPrivateFieldGet41(_currentTH,this)),a=_classPrivateFieldGet41(_currentTH,this).getBoundingClientRect(),c=i<t.getSetting("fixedColumnsStart");let u;c&&(u=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(_classPrivateFieldGet41(_currentTH,this),r.row,r.col)),u||(u=t.wtOverlays.topOverlay.getRelativeCellPosition(_classPrivateFieldGet41(_currentTH,this),r.row,r.col)),_classPrivateFieldSet38(_currentCol,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),_classPrivateFieldSet38(_selectedCols,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();arrayEach(d,f=>{const m=f.getTopStartCorner().col,g=f.getBottomEndCorner().col;rangeEach(m,g,v=>{_classPrivateFieldGet41(_selectedCols,this).includes(v)||_classPrivateFieldGet41(_selectedCols,this).push(v)})})}_classPrivateFieldGet41(_selectedCols,this).includes(_classPrivateFieldGet41(_currentCol,this))||_classPrivateFieldSet38(_selectedCols,this,[_classPrivateFieldGet41(_currentCol,this)]),_classPrivateFieldSet38(_startOffset,this,u.start-6),_classPrivateFieldSet38(_startWidth,this,parseInt(a.width,10)),_classPrivateFieldGet41(_handle,this).style.top=`${u.top}px`,_classPrivateFieldGet41(_handle,this).style[this.inlineDir]=`${_classPrivateFieldGet41(_startOffset,this)+_classPrivateFieldGet41(_startWidth,this)}px`,_classPrivateFieldGet41(_handle,this).style.height=`${o}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet41(_handle,this))}refreshHandlePosition(){_classPrivateFieldGet41(_handle,this).style[this.inlineDir]=`${_classPrivateFieldGet41(_startOffset,this)+_classPrivateFieldGet41(_currentWidth,this)}px`}setupGuidePosition(){const e=parseInt(outerHeight(_classPrivateFieldGet41(_handle,this)),10),t=parseInt(_classPrivateFieldGet41(_handle,this).style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);addClass(_classPrivateFieldGet41(_handle,this),"active"),addClass(_classPrivateFieldGet41(_guide,this),"active"),_classPrivateFieldGet41(_guide,this).style.top=`${t}px`,this.refreshGuidePosition(),_classPrivateFieldGet41(_guide,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet41(_guide,this))}refreshGuidePosition(){_classPrivateFieldGet41(_guide,this).style[this.inlineDir]=_classPrivateFieldGet41(_handle,this).style[this.inlineDir]}hideHandleAndGuide(){removeClass(_classPrivateFieldGet41(_handle,this),"active"),removeClass(_classPrivateFieldGet41(_guide,this),"active")}checkIfColumnHeader(e){const t=closest(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",_classPrivateFieldGet41(_newSize,this),r,!0);o!==void 0&&_classPrivateFieldSet38(_newSize,this,o),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,_classPrivateFieldGet41(_newSize,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",_classPrivateFieldGet41(_newSize,this),r,!0),i&&e()};_classPrivateFieldGet41(_dblclick,this)>=2&&(_classPrivateFieldGet41(_selectedCols,this).length>1?(arrayEach(_classPrivateFieldGet41(_selectedCols,this),i=>{t(i)}),e()):arrayEach(_classPrivateFieldGet41(_selectedCols,this),i=>{t(i,!0)})),_classPrivateFieldSet38(_dblclick,this,0),_classPrivateFieldSet38(_autoresizeTimeout,this,null)}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",r=>_assertClassBrand56(_ManualColumnResize_brand,this,_onMouseOver2).call(this,r)),this.eventManager.addEventListener(t,"mousedown",r=>_assertClassBrand56(_ManualColumnResize_brand,this,_onMouseDown2).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>_assertClassBrand56(_ManualColumnResize_brand,this,_onMouseMove3).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand56(_ManualColumnResize_brand,this,_onMouseUp4).call(this)),this.eventManager.addEventListener(_classPrivateFieldGet41(_handle,this),"contextmenu",()=>_assertClassBrand56(_ManualColumnResize_brand,this,_onContextMenu).call(this))}destroy(){super.destroy()}};function _onMapInit3(){const e=this.hot.getSettings()[PLUGIN_KEY22],t=this.loadManualColumnWidths();typeof t<"u"?this.hot.batchExecution(()=>{t.forEach((r,i)=>{_classPrivateFieldGet41(_columnWidthsMap,this).setValueAtIndex(i,r)})},!0):Array.isArray(e)?(this.hot.batchExecution(()=>{e.forEach((r,i)=>{_classPrivateFieldGet41(_columnWidthsMap,this).setValueAtIndex(i,r)})},!0),_classPrivateFieldSet38(_config,this,e)):e===!0&&Array.isArray(_classPrivateFieldGet41(_config,this))&&this.hot.batchExecution(()=>{_classPrivateFieldGet41(_config,this).forEach((r,i)=>{_classPrivateFieldGet41(_columnWidthsMap,this).setValueAtIndex(i,r)})},!0)}function _onMouseOver2(e){if(!isDetached(e.target)&&_classPrivateFieldGet41(_isTriggeredByRMB,this)!==!0&&this.checkIfColumnHeader(e.target)){const t=this.getClosestTHParent(e.target);if(!t)return;const r=t.getAttribute("colspan");t&&(r===null||r==="1")&&(_classPrivateFieldGet41(_pressed2,this)||this.setupHandlePosition(t))}}function _onMouseDown2(e){e.target.parentNode===this.hot.rootElement&&hasClass(e.target,"manualColumnResizer")&&(this.setupHandlePosition(_classPrivateFieldGet41(_currentTH,this)),this.setupGuidePosition(),_classPrivateFieldSet38(_pressed2,this,!0),_classPrivateFieldGet41(_autoresizeTimeout,this)===null&&(_classPrivateFieldSet38(_autoresizeTimeout,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(_classPrivateFieldGet41(_autoresizeTimeout,this))),_classPrivateFieldSet38(_dblclick,this,_classPrivateFieldGet41(_dblclick,this)+1),this.startX=e.pageX,_classPrivateFieldSet38(_newSize,this,_classPrivateFieldGet41(_startWidth,this)))}function _onMouseMove3(e){if(_classPrivateFieldGet41(_pressed2,this)){const t=(e.pageX-this.startX)*this.hot.getDirectionFactor();_classPrivateFieldSet38(_currentWidth,this,_classPrivateFieldGet41(_startWidth,this)+t),arrayEach(_classPrivateFieldGet41(_selectedCols,this),r=>{_classPrivateFieldSet38(_newSize,this,this.setManualSize(r,_classPrivateFieldGet41(_currentWidth,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function _onMouseUp4(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(r,i)=>{this.hot.runHooks("beforeColumnResize",_classPrivateFieldGet41(_newSize,this),r,!1),i&&e(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",_classPrivateFieldGet41(_newSize,this),r,!1)};_classPrivateFieldGet41(_pressed2,this)&&(this.hideHandleAndGuide(),_classPrivateFieldSet38(_pressed2,this,!1),_classPrivateFieldGet41(_newSize,this)!==_classPrivateFieldGet41(_startWidth,this)&&(_classPrivateFieldGet41(_selectedCols,this).length>1?(arrayEach(_classPrivateFieldGet41(_selectedCols,this),i=>{t(i)}),e()):arrayEach(_classPrivateFieldGet41(_selectedCols,this),i=>{t(i,!0)})),this.setupHandlePosition(_classPrivateFieldGet41(_currentTH,this)))}function _onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(_classPrivateFieldGet41(_handle,this)),this.hot.rootElement.removeChild(_classPrivateFieldGet41(_guide,this)),_classPrivateFieldSet38(_pressed2,this,!1),_classPrivateFieldSet38(_isTriggeredByRMB,this,!0),this.hot._registerImmediate(()=>{_classPrivateFieldSet38(_isTriggeredByRMB,this,!1)})}function _onModifyColWidth2(e,t){let r=e;if(this.enabled){const i=this.hot.toPhysicalColumn(t),o=_classPrivateFieldGet41(_columnWidthsMap,this).getValueAtIndex(i);this.hot.getSettings()[PLUGIN_KEY22]&&o&&(r=o)}return r}function _onBeforeStretchingColumnWidth(e,t){let r=_classPrivateFieldGet41(_columnWidthsMap,this).getValueAtIndex(t);return r===null&&(r=e),r}function _onBeforeColumnResize2(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}var import_es_error_cause147=__toESM(require_es_error_cause(),1),import_es_array_push88=__toESM(require_es_array_push(),1),import_es_error_cause146=__toESM(require_es_error_cause(),1);function _defineProperty99(e,t,r){return(t=_toPropertyKey99(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey99(e){var t=_toPrimitive99(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive99(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var STATE_INITIALIZED2=0,STATE_BUILT3=1,STATE_APPENDED2=2,UNIT2="px",BaseUI3=class{constructor(e){_defineProperty99(this,"hot",void 0),_defineProperty99(this,"_element",null),_defineProperty99(this,"state",STATE_INITIALIZED2),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=STATE_APPENDED2}build(){this.state===STATE_INITIALIZED2&&(this._element=this.hot.rootDocument.createElement("div"),this.state=STATE_BUILT3)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=STATE_INITIALIZED2}isAppended(){return this.state===STATE_APPENDED2}isBuilt(){return this.state>=STATE_BUILT3}setPosition(e,t){e!==void 0&&(this._element.style.top=e+UNIT2),t!==void 0&&(this._element.style.left=t+UNIT2)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+UNIT2),t&&(this._element.style.height=t+UNIT2)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+UNIT2),t&&(this._element.style.marginLeft=t+UNIT2)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}},base_default4=BaseUI3,CSS_CLASSNAME3="ht__manualRowMove--backlight",BacklightUI2=class extends base_default4{build(){super.build(),addClass(this._element,CSS_CLASSNAME3)}},backlight_default2=BacklightUI2,CSS_CLASSNAME4="ht__manualRowMove--guideline",GuidelineUI2=class extends base_default4{build(){super.build(),addClass(this._element,CSS_CLASSNAME4)}},guideline_default2=GuidelineUI2;function _classPrivateMethodInitSpec40(e,t){_checkPrivateRedeclaration57(e,t),t.add(e)}function _classPrivateFieldInitSpec42(e,t,r){_checkPrivateRedeclaration57(e,t),t.set(e,r)}function _checkPrivateRedeclaration57(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet39(e,t,r){return e.set(_assertClassBrand57(e,t),r),r}function _classPrivateFieldGet42(e,t){return e.get(_assertClassBrand57(e,t))}function _assertClassBrand57(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}pluginHooks_default.getSingleton().register("beforeRowMove"),pluginHooks_default.getSingleton().register("afterRowMove");var PLUGIN_KEY23="manualRowMove",PLUGIN_PRIORITY22=140,CSS_PLUGIN2="ht__manualRowMove",CSS_SHOW_UI2="show-ui",CSS_ON_MOVING2="on-moving--rows",CSS_AFTER_SELECTION2="after-selection--rows",_backlight2=new WeakMap,_guideline2=new WeakMap,_rowsToMove=new WeakMap,_pressed3=new WeakMap,_target2=new WeakMap,_cachedDropIndex2=new WeakMap,_ManualRowMove_brand=new WeakSet,ManualRowMove=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec40(this,_ManualRowMove_brand),_classPrivateFieldInitSpec42(this,_backlight2,new backlight_default2(this.hot)),_classPrivateFieldInitSpec42(this,_guideline2,new guideline_default2(this.hot)),_classPrivateFieldInitSpec42(this,_rowsToMove,[]),_classPrivateFieldInitSpec42(this,_pressed3,void 0),_classPrivateFieldInitSpec42(this,_target2,{}),_classPrivateFieldInitSpec42(this,_cachedDropIndex2,void 0)}static get PLUGIN_KEY(){return PLUGIN_KEY23}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY22}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY23]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand57(_ManualRowMove_brand,e,_onBeforeOnCellMouseDown5).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand57(_ManualRowMove_brand,e,_onBeforeOnCellMouseOver2).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>_assertClassBrand57(_ManualRowMove_brand,this,_onAfterScrollHorizontally).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand57(_ManualRowMove_brand,e,_onAfterLoadData7).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),addClass(this.hot.rootElement,CSS_PLUGIN2),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){removeClass(this.hot.rootElement,CSS_PLUGIN2),this.unregisterEvents(),_classPrivateFieldGet42(_backlight2,this).destroy(),_classPrivateFieldGet42(_guideline2,this).destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const r=_classPrivateFieldGet42(_cachedDropIndex2,this),i=this.isMovePossible(e,t),o=this.hot.runHooks("beforeRowMove",e,t,r,i);if(_classPrivateFieldSet39(_cachedDropIndex2,this,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,t);const a=i&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,r,i,a),a}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const r=this.countFinalIndex(e,t);return _classPrivateFieldSet39(_cachedDropIndex2,this,t),this.moveRows(e,r)}isMovePossible(e,t){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+t>r,o=t<0,a=e.some(u=>u<0),c=e.some(u=>u>=r);return!(i||o||a||c)}isRowOrderChanged(e,t){return e.some((r,i)=>r-i!==t)}countFinalIndex(e,t){const r=arrayReduce(e,(i,o)=>(o<t&&(i+=1),i),0);return t-r}getRowsHeight(e,t){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=t;o++){const a=r.getRenderableFromVisualIndex(o);a!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(a)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[PLUGIN_KEY23];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:r,to:i}=e,o=Math.min(r.row,i.row),a=Math.max(r.row,i.row);return rangeEach(o,a,c=>{t.push(c)}),t}refreshPositions(){const e=_classPrivateFieldGet42(_target2,this).coords,t=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&t>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,a=_classPrivateFieldGet42(_target2,this).TD,c=this.hot.rootElement,u=offset(c),h=getTrimmingContainer(c),d=o.holder.scrollTop,f=this.hot.rootWindow!==h?h.scrollTop:0,m=u.top-f,g=_classPrivateFieldGet42(_target2,this).eventPageY-m+d,v=o.hider.offsetHeight,_=o.TBODY.offsetTop,b=_classPrivateFieldGet42(_backlight2,this).getOffset().top,S=_classPrivateFieldGet42(_backlight2,this).getSize().height,R=a.offsetHeight/2,A=a.offsetHeight;let I=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const E=g>=I+R;this.isFixedRowTop(e.row)&&(I+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?_classPrivateFieldGet42(_target2,this).row=t>0?t-1:t:E?(_classPrivateFieldGet42(_target2,this).row=e.row+1,I+=e.row===0?A-1:A):_classPrivateFieldGet42(_target2,this).row=e.row;let O=g,P=I;g+S+b>=v?O=v-S-b:g+b<_&&(O=_+Math.abs(b)),I>=v-1&&(P=v-1),_classPrivateFieldGet42(_backlight2,this).setPosition(O),_classPrivateFieldGet42(_guideline2,this).setPosition(P)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>_assertClassBrand57(_ManualRowMove_brand,this,_onMouseMove4).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>_assertClassBrand57(_ManualRowMove_brand,this,_onMouseUp5).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){_classPrivateFieldGet42(_backlight2,this).build(),_classPrivateFieldGet42(_guideline2,this).build()}destroy(){_classPrivateFieldGet42(_backlight2,this).destroy(),_classPrivateFieldGet42(_guideline2,this).destroy(),super.destroy()}};function _onBeforeOnCellMouseDown5(e,t,r,i){const{wtTable:o,wtViewport:a}=this.hot.view._wt,c=this.hot.selection.isSelectedByRowHeader(),u=this.hot.getSelectedRangeLast();if(!u||!c||_classPrivateFieldGet42(_pressed3,this)||e.button!==0){_classPrivateFieldSet39(_pressed3,this,!1),_classPrivateFieldGet42(_rowsToMove,this).length=0,removeClass(this.hot.rootElement,[CSS_ON_MOVING2,CSS_SHOW_UI2]);return}const h=_classPrivateFieldGet42(_guideline2,this).isBuilt()&&!_classPrivateFieldGet42(_guideline2,this).isAppended(),d=_classPrivateFieldGet42(_backlight2,this).isBuilt()&&!_classPrivateFieldGet42(_backlight2,this).isAppended();h&&d&&(_classPrivateFieldGet42(_guideline2,this).appendTo(o.hider),_classPrivateFieldGet42(_backlight2,this).appendTo(o.hider));const{from:f,to:m}=u,g=Math.min(f.row,m.row),v=Math.max(f.row,m.row);if(t.col<0&&t.row>=g&&t.row<=v){i.row=!0,_classPrivateFieldSet39(_pressed3,this,!0),_classPrivateFieldGet42(_target2,this).eventPageY=e.pageY,_classPrivateFieldGet42(_target2,this).coords=t,_classPrivateFieldGet42(_target2,this).TD=r,_classPrivateFieldSet39(_rowsToMove,this,this.prepareRowsToMoving());const _=o.holder.scrollLeft+a.getRowHeaderWidth(),b=this.getRowsHeight(g,t.row-1)+e.offsetY;_classPrivateFieldGet42(_backlight2,this).setPosition(null,_),_classPrivateFieldGet42(_backlight2,this).setSize(o.hider.offsetWidth-_,this.getRowsHeight(g,v)),_classPrivateFieldGet42(_backlight2,this).setOffset(-b,null),addClass(this.hot.rootElement,CSS_ON_MOVING2),this.refreshPositions()}else removeClass(this.hot.rootElement,CSS_AFTER_SELECTION2),_classPrivateFieldSet39(_pressed3,this,!1),_classPrivateFieldGet42(_rowsToMove,this).length=0}function _onMouseMove4(e){_classPrivateFieldGet42(_pressed3,this)&&(_classPrivateFieldGet42(_target2,this).eventPageY=e.pageY,this.refreshPositions())}function _onBeforeOnCellMouseOver2(e,t,r,i){!this.hot.getSelectedRangeLast()||!_classPrivateFieldGet42(_pressed3,this)||(_classPrivateFieldGet42(_rowsToMove,this).indexOf(t.row)>-1?removeClass(this.hot.rootElement,CSS_SHOW_UI2):addClass(this.hot.rootElement,CSS_SHOW_UI2),i.row=!0,i.column=!0,i.cell=!0,_classPrivateFieldGet42(_target2,this).coords=t,_classPrivateFieldGet42(_target2,this).TD=r)}function _onMouseUp5(){const e=_classPrivateFieldGet42(_target2,this).row,t=_classPrivateFieldGet42(_rowsToMove,this).length;if(_classPrivateFieldSet39(_pressed3,this,!1),removeClass(this.hot.rootElement,[CSS_ON_MOVING2,CSS_SHOW_UI2,CSS_AFTER_SELECTION2]),this.hot.selection.isSelectedByRowHeader()&&addClass(this.hot.rootElement,CSS_AFTER_SELECTION2),t<1||e===void 0)return;const r=_classPrivateFieldGet42(_rowsToMove,this)[0],i=this.hot.toPhysicalRow(r),o=this.dragRows(_classPrivateFieldGet42(_rowsToMove,this),e);if(_classPrivateFieldGet42(_rowsToMove,this).length=0,o===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const a=this.hot.toVisualRow(i),c=a+t-1;this.hot.selectRows(a,c)}}function _onAfterScrollHorizontally(){const e=this.hot.view._wt.wtTable,t=this.hot.view._wt.wtViewport.getRowHeaderWidth(),r=e.holder.scrollLeft,i=t+r;_classPrivateFieldGet42(_backlight2,this).setPosition(null,i),_classPrivateFieldGet42(_backlight2,this).setSize(e.hider.offsetWidth-i)}function _onAfterLoadData7(){this.moveBySettingsOrLoad()}var import_es_error_cause148=__toESM(require_es_error_cause(),1),import_es_array_push89=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec41(e,t){_checkPrivateRedeclaration58(e,t),t.add(e)}function _classPrivateFieldInitSpec43(e,t,r){_checkPrivateRedeclaration58(e,t),t.set(e,r)}function _checkPrivateRedeclaration58(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet40(e,t,r){return e.set(_assertClassBrand58(e,t),r),r}function _classPrivateFieldGet43(e,t){return e.get(_assertClassBrand58(e,t))}function _assertClassBrand58(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var PLUGIN_KEY24="manualRowResize",PLUGIN_PRIORITY23=30,PERSISTENT_STATE_KEY2="manualRowHeights",_currentTH2=new WeakMap,_currentRow=new WeakMap,_selectedRows=new WeakMap,_currentHeight=new WeakMap,_newSize2=new WeakMap,_startY2=new WeakMap,_startHeight=new WeakMap,_startOffset2=new WeakMap,_handle2=new WeakMap,_guide2=new WeakMap,_pressed4=new WeakMap,_isTriggeredByRMB2=new WeakMap,_dblclick2=new WeakMap,_autoresizeTimeout2=new WeakMap,_rowHeightsMap=new WeakMap,_config2=new WeakMap,_ManualRowResize_brand=new WeakSet,ManualRowResize=class extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY24}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY23}constructor(e){super(e),_classPrivateMethodInitSpec41(this,_ManualRowResize_brand),_classPrivateFieldInitSpec43(this,_currentTH2,null),_classPrivateFieldInitSpec43(this,_currentRow,null),_classPrivateFieldInitSpec43(this,_selectedRows,[]),_classPrivateFieldInitSpec43(this,_currentHeight,null),_classPrivateFieldInitSpec43(this,_newSize2,null),_classPrivateFieldInitSpec43(this,_startY2,null),_classPrivateFieldInitSpec43(this,_startHeight,null),_classPrivateFieldInitSpec43(this,_startOffset2,null),_classPrivateFieldInitSpec43(this,_handle2,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec43(this,_guide2,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec43(this,_pressed4,!1),_classPrivateFieldInitSpec43(this,_isTriggeredByRMB2,!1),_classPrivateFieldInitSpec43(this,_dblclick2,0),_classPrivateFieldInitSpec43(this,_autoresizeTimeout2,null),_classPrivateFieldInitSpec43(this,_rowHeightsMap,void 0),_classPrivateFieldInitSpec43(this,_config2,void 0),addClass(_classPrivateFieldGet43(_handle2,this),"manualRowResizer"),addClass(_classPrivateFieldGet43(_guide2,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY24]}enablePlugin(){this.enabled||(_classPrivateFieldSet40(_rowHeightsMap,this,new PhysicalIndexToValueMap),_classPrivateFieldGet43(_rowHeightsMap,this).addLocalHook("init",()=>_assertClassBrand58(_ManualRowResize_brand,this,_onMapInit4).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet43(_rowHeightsMap,this)),this.addHook("modifyRowHeight",(e,t)=>_assertClassBrand58(_ManualRowResize_brand,this,_onModifyRowHeight2).call(this,e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){_classPrivateFieldSet40(_config2,this,_classPrivateFieldGet43(_rowHeightsMap,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",PERSISTENT_STATE_KEY2,_classPrivateFieldGet43(_rowHeightsMap,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",PERSISTENT_STATE_KEY2,e),e.value}setManualSize(e,t){const r=this.hot.toPhysicalRow(e),i=Math.max(t,DEFAULT_HEIGHT);return _classPrivateFieldGet43(_rowHeightsMap,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return _classPrivateFieldGet43(_currentHeight,this)}setupHandlePosition(e){_classPrivateFieldSet40(_currentTH2,this,e);const{view:t}=this.hot,{_wt:r}=t,i=r.wtTable.getCoords(_classPrivateFieldGet43(_currentTH2,this)),o=i.row;if(o<0)return;const a=outerWidth(_classPrivateFieldGet43(_currentTH2,this)),c=_classPrivateFieldGet43(_currentTH2,this).getBoundingClientRect(),u=o<r.getSetting("fixedRowsTop"),h=o>=t.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let d;u?d=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(_classPrivateFieldGet43(_currentTH2,this),i.row,i.col):h&&(d=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(_classPrivateFieldGet43(_currentTH2,this),i.row,i.col)),d||(d=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(_classPrivateFieldGet43(_currentTH2,this),i.row,i.col)),_classPrivateFieldSet40(_currentRow,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),_classPrivateFieldSet40(_selectedRows,this,[]);const f=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&f){const m=this.hot.getSelectedRange();arrayEach(m,g=>{const v=g.getTopStartCorner().row,_=g.getBottomStartCorner().row;rangeEach(v,_,b=>{_classPrivateFieldGet43(_selectedRows,this).includes(b)||_classPrivateFieldGet43(_selectedRows,this).push(b)})})}_classPrivateFieldGet43(_selectedRows,this).includes(_classPrivateFieldGet43(_currentRow,this))||_classPrivateFieldSet40(_selectedRows,this,[_classPrivateFieldGet43(_currentRow,this)]),_classPrivateFieldSet40(_startOffset2,this,d.top-6),_classPrivateFieldSet40(_startHeight,this,parseInt(c.height,10)),_classPrivateFieldGet43(_handle2,this).style.top=`${_classPrivateFieldGet43(_startOffset2,this)+_classPrivateFieldGet43(_startHeight,this)}px`,_classPrivateFieldGet43(_handle2,this).style[this.inlineDir]=`${d.start}px`,_classPrivateFieldGet43(_handle2,this).style.width=`${a}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet43(_handle2,this))}refreshHandlePosition(){_classPrivateFieldGet43(_handle2,this).style.top=`${_classPrivateFieldGet43(_startOffset2,this)+_classPrivateFieldGet43(_currentHeight,this)}px`}setupGuidePosition(){const e=parseInt(outerWidth(_classPrivateFieldGet43(_handle2,this)),10),t=parseInt(_classPrivateFieldGet43(_handle2,this).style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);addClass(_classPrivateFieldGet43(_handle2,this),"active"),addClass(_classPrivateFieldGet43(_guide2,this),"active"),_classPrivateFieldGet43(_guide2,this).style.top=_classPrivateFieldGet43(_handle2,this).style.top,_classPrivateFieldGet43(_guide2,this).style[this.inlineDir]=`${t}px`,_classPrivateFieldGet43(_guide2,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet43(_guide2,this))}refreshGuidePosition(){_classPrivateFieldGet43(_guide2,this).style.top=_classPrivateFieldGet43(_handle2,this).style.top}hideHandleAndGuide(){removeClass(_classPrivateFieldGet43(_handle2,this),"active"),removeClass(_classPrivateFieldGet43(_guide2,this),"active")}checkIfRowHeader(e){const t=closest(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return t!==void 0&&_classPrivateFieldGet43(_newSize2,this)<t?t:_classPrivateFieldGet43(_newSize2,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&_classPrivateFieldSet40(_newSize2,this,o),this.setManualSize(r,_classPrivateFieldGet43(_newSize2,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};_classPrivateFieldGet43(_dblclick2,this)>=2&&(_classPrivateFieldGet43(_selectedRows,this).length>1?(arrayEach(_classPrivateFieldGet43(_selectedRows,this),i=>{t(i)}),e()):arrayEach(_classPrivateFieldGet43(_selectedRows,this),i=>{t(i,!0)})),_classPrivateFieldSet40(_dblclick2,this,0),_classPrivateFieldSet40(_autoresizeTimeout2,this,null)}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>_assertClassBrand58(_ManualRowResize_brand,this,_onMouseOver3).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>_assertClassBrand58(_ManualRowResize_brand,this,_onMouseDown3).call(this,r)),this.eventManager.addEventListener(t,"mousemove",r=>_assertClassBrand58(_ManualRowResize_brand,this,_onMouseMove5).call(this,r)),this.eventManager.addEventListener(t,"mouseup",()=>_assertClassBrand58(_ManualRowResize_brand,this,_onMouseUp6).call(this)),this.eventManager.addEventListener(_classPrivateFieldGet43(_handle2,this),"contextmenu",()=>_assertClassBrand58(_ManualRowResize_brand,this,_onContextMenu2).call(this))}destroy(){super.destroy()}};function _onMouseOver3(e){if(!isDetached(e.target)&&_classPrivateFieldGet43(_isTriggeredByRMB2,this)!==!0&&this.checkIfRowHeader(e.target)){const t=this.getClosestTHParent(e.target);t&&(_classPrivateFieldGet43(_pressed4,this)||this.setupHandlePosition(t))}}function _onMouseDown3(e){hasClass(e.target,"manualRowResizer")&&(this.setupHandlePosition(_classPrivateFieldGet43(_currentTH2,this)),this.setupGuidePosition(),_classPrivateFieldSet40(_pressed4,this,!0),_classPrivateFieldGet43(_autoresizeTimeout2,this)===null&&(_classPrivateFieldSet40(_autoresizeTimeout2,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(_classPrivateFieldGet43(_autoresizeTimeout2,this))),_classPrivateFieldSet40(_dblclick2,this,_classPrivateFieldGet43(_dblclick2,this)+1),_classPrivateFieldSet40(_startY2,this,e.pageY),_classPrivateFieldSet40(_newSize2,this,_classPrivateFieldGet43(_startHeight,this)))}function _onMouseMove5(e){_classPrivateFieldGet43(_pressed4,this)&&(_classPrivateFieldSet40(_currentHeight,this,_classPrivateFieldGet43(_startHeight,this)+(e.pageY-_classPrivateFieldGet43(_startY2,this))),arrayEach(_classPrivateFieldGet43(_selectedRows,this),t=>{_classPrivateFieldSet40(_newSize2,this,this.setManualSize(t,_classPrivateFieldGet43(_currentHeight,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function _onMouseUp6(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(r,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!1),i&&e(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!1)};_classPrivateFieldGet43(_pressed4,this)&&(this.hideHandleAndGuide(),_classPrivateFieldSet40(_pressed4,this,!1),_classPrivateFieldGet43(_newSize2,this)!==_classPrivateFieldGet43(_startHeight,this)&&(_classPrivateFieldGet43(_selectedRows,this).length>1?(arrayEach(_classPrivateFieldGet43(_selectedRows,this),i=>{t(i)}),e()):arrayEach(_classPrivateFieldGet43(_selectedRows,this),i=>{t(i,!0)})),this.setupHandlePosition(_classPrivateFieldGet43(_currentTH2,this)))}function _onContextMenu2(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(_classPrivateFieldGet43(_handle2,this)),this.hot.rootElement.removeChild(_classPrivateFieldGet43(_guide2,this)),_classPrivateFieldSet40(_pressed4,this,!1),_classPrivateFieldSet40(_isTriggeredByRMB2,this,!0),this.hot._registerImmediate(()=>{_classPrivateFieldSet40(_isTriggeredByRMB2,this,!1)})}function _onModifyRowHeight2(e,t){let r=e;if(this.enabled){const i=this.hot.toPhysicalRow(t),o=_classPrivateFieldGet43(_rowHeightsMap,this).getValueAtIndex(i);this.hot.getSettings()[PLUGIN_KEY24]&&o&&(r=o)}return r}function _onMapInit4(){const e=this.hot.getSettings()[PLUGIN_KEY24],t=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof t<"u"?t.forEach((r,i)=>{_classPrivateFieldGet43(_rowHeightsMap,this).setValueAtIndex(i,r)}):Array.isArray(e)?(e.forEach((r,i)=>{_classPrivateFieldGet43(_rowHeightsMap,this).setValueAtIndex(i,r)}),_classPrivateFieldSet40(_config2,this,e)):e===!0&&Array.isArray(_classPrivateFieldGet43(_config2,this))&&_classPrivateFieldGet43(_config2,this).forEach((r,i)=>{_classPrivateFieldGet43(_rowHeightsMap,this).setValueAtIndex(i,r)})},!0)}var import_es_error_cause155=__toESM(require_es_error_cause(),1),import_es_array_push93=__toESM(require_es_array_push(),1),import_es_set_difference_v223=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v223=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v223=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v223=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v223=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v223=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v223=__toESM(require_es_set_union_v2(),1),import_es_error_cause150=__toESM(require_es_error_cause(),1),import_es_array_push90=__toESM(require_es_array_push(),1),import_es_array_unscopables_flat_map2=__toESM(require_es_array_unscopables_flat_map(),1),import_es_set_difference_v222=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v222=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v222=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v222=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v222=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v222=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v222=__toESM(require_es_set_union_v2(),1),import_es_error_cause149=__toESM(require_es_error_cause(),1);function _classPrivateFieldInitSpec44(e,t,r){_checkPrivateRedeclaration59(e,t),t.set(e,r)}function _checkPrivateRedeclaration59(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty100(e,t,r){return(t=_toPropertyKey100(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey100(e){var t=_toPrimitive100(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive100(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet44(e,t){return e.get(_assertClassBrand59(e,t))}function _classPrivateFieldSet41(e,t,r){return e.set(_assertClassBrand59(e,t),r),r}function _assertClassBrand59(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _cellRange=new WeakMap,MergedCellCoords=class{constructor(e,t,r,i,o,a){_defineProperty100(this,"row",void 0),_defineProperty100(this,"col",void 0),_defineProperty100(this,"rowspan",void 0),_defineProperty100(this,"colspan",void 0),_defineProperty100(this,"removed",!1),_defineProperty100(this,"cellCoordsFactory",void 0),_defineProperty100(this,"cellRangeFactory",void 0),_classPrivateFieldInitSpec44(this,_cellRange,null),this.row=e,this.col=t,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=a}static NEGATIVE_VALUES_WARNING(e){let{row:t,col:r,rowspan:i,colspan:o}=e;return toSingleLine`The merged cell declared with {row: ${t}, col: ${r},\x20
      rowspan: ${i}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:t,col:r}=e;return toSingleLine`The merged cell declared at [${t}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:t,col:r}=e;return toSingleLine`The merged cell declared at [${t}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:t,col:r}=e;return toSingleLine`The merged cell declared at [${t}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:t,col:r,rowspan:i,colspan:o}=e;return t<0||r<0||i<0||o<0}static isSingleCell(e){let{rowspan:t,colspan:r}=e;return r===1&&t===1}static containsZeroSpan(e){let{rowspan:t,colspan:r}=e;return r===0||t===0}static isOutOfBounds(e,t,r){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const t=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),_classPrivateFieldSet41(_cellRange,this,null)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const r=e[0]||e[1],i=t+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",a=e[0]?"col":"row",c=Math.min(t,i),u=Math.max(t,i),h=this[a],d=this[a]+this[o]-1;if(h>=t&&(this[a]+=r),r>0)t<=d&&t>h&&(this[o]+=r);else if(r<0){if(c<=h&&u>=d)return this.removed=!0,_classPrivateFieldSet41(_cellRange,this,null),!1;if(h>=c&&h<=u){const f=u-h+1,m=Math.abs(r)-f;this[a]-=m+r,this[o]-=f}else if(h<=c&&d>=u)this[o]+=r;else if(h<=c&&d>=c&&d<u){const f=d-c+1;this[o]-=f}}return _classPrivateFieldSet41(_cellRange,this,null),!0}isFarther(e,t){return e?t==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:t==="up"?e.row>this.row:t==="right"?e.col+e.colspan-1<this.col+this.colspan-1:t==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return _classPrivateFieldGet44(_cellRange,this)||_classPrivateFieldSet41(_cellRange,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),_classPrivateFieldGet44(_cellRange,this)}},cellCoords_default=MergedCellCoords;function _classPrivateMethodInitSpec42(e,t){_checkPrivateRedeclaration60(e,t),t.add(e)}function _checkPrivateRedeclaration60(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty101(e,t,r){return(t=_toPropertyKey101(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey101(e){var t=_toPrimitive101(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive101(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand60(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _MergedCellsCollection_brand=new WeakSet,MergedCellsCollection=class li{constructor(t){_classPrivateMethodInitSpec42(this,_MergedCellsCollection_brand),_defineProperty101(this,"plugin",void 0),_defineProperty101(this,"mergedCells",[]),_defineProperty101(this,"mergedCellsMatrix",new Map),_defineProperty101(this,"hot",void 0),this.plugin=t,this.hot=t.hot}static IS_OVERLAPPING_WARNING(t){let{row:r,col:i}=t;return toSingleLine`The merged cell declared at [${r}, ${i}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(t,r){var i;return this.mergedCellsMatrix.has(t)&&(i=this.mergedCellsMatrix.get(t).get(r))!==null&&i!==void 0?i:!1}getByRange(t){let r=!1;return arrayEach(this.mergedCells,i=>i.row<=t.from.row&&i.row+i.rowspan-1>=t.to.row&&i.col<=t.from.col&&i.col+i.colspan-1>=t.to.col?(r=i,r):!0),r}filterOverlappingMergeCells(t){const r=new Set;return this.mergedCells.forEach(o=>{const{row:a,col:c,colspan:u,rowspan:h}=o;for(let d=a;d<a+h;d++)for(let f=c;f<c+u;f++)r.add(`r${d},c${f}`)}),t.filter(o=>{const{row:a,col:c,colspan:u,rowspan:h}=o,d=new Set;let f=!1;for(let m=a;m<a+h;m++){for(let g=c;g<c+u;g++){const v=`r${m},c${g}`;if(r.has(v)){warn(li.IS_OVERLAPPING_WARNING(o)),f=!0;break}d.add(v)}if(f)break}return f||r.add(...d),!f})}getWithinRange(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:i,col:o}=t.getTopStartCorner(),{row:a,col:c}=t.getBottomEndCorner(),u=[];for(let h=i;h<=a;h++)for(let d=o;d<=c;d++){const f=this.get(h,d);f&&(r||!r&&f.row===h&&f.col===d)&&u.push(f)}return u}add(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=t.row,o=t.col,a=t.rowspan,c=t.colspan,u=new cellCoords_default(i,o,a,c,this.hot._createCellCoords,this.hot._createCellRange),h=this.get(i,o),d=r?!1:this.isOverlapping(u);return!h&&!d?(this.hot&&u.normalize(this.hot),this.mergedCells.push(u),_assertClassBrand60(_MergedCellsCollection_brand,this,_addMergedCellToMatrix).call(this,u),u):(warn(li.IS_OVERLAPPING_WARNING(u)),!1)}remove(t,r){const i=this.get(t,r),o=i?this.mergedCells.indexOf(i):-1;return i&&o!==-1?(this.mergedCells.splice(o,1),_assertClassBrand60(_MergedCellsCollection_brand,this,_removeMergedCellFromMatrix).call(this,i),i):!1}clear(){arrayEach(this.mergedCells,t=>{let{row:r,col:i,rowspan:o,colspan:a}=t;rangeEach(r,r+o,c=>{rangeEach(i,i+a,u=>{const h=this.hot.getCell(c,u);h&&(h.removeAttribute("rowspan"),h.removeAttribute("colspan"),h.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(t){const r=t.getRange();for(let i=0;i<this.mergedCells.length;i++)if(this.mergedCells[i].getRange().overlaps(r))return!0;return!1}isFirstRenderableMergedCell(t,r){const i=this.get(t,r);return i&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1)===t&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)===r}getFirstRenderableCoords(t,r){const i=this.get(t,r);if(!i||this.isFirstRenderableMergedCell(t,r))return this.hot._createCellCoords(t,r);const o=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(o,a)}getStartMostColumnIndex(t,r){const i=_assertClassBrand60(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,t,"col",-1);let o=r;for(let a=0;a<i.length;a++)if(i[a]<=r){o=i[a];break}return o}getEndMostColumnIndex(t,r){const i=_assertClassBrand60(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,t,"col",1);let o=r;for(let a=0;a<i.length;a++)if(i[a]>=r){o=i[a];break}return o}getTopMostRowIndex(t,r){const i=_assertClassBrand60(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,t,"row",-1);let o=r;for(let a=0;a<i.length;a++)if(i[a]<=r){o=i[a];break}return o}getBottomMostRowIndex(t,r){const i=_assertClassBrand60(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,t,"row",1);let o=r;for(let a=0;a<i.length;a++)if(i[a]>=r){o=i[a];break}return o}shiftCollections(t,r,i){const o=[0,0];switch(t){case"right":o[0]+=i;break;case"left":o[0]-=i;break;case"down":o[1]+=i;break;case"up":o[1]-=i;break;default:}const a=[];this.mergedCells.forEach(c=>{c.shift(o,r),c.removed&&a.push(c)}),a.forEach(c=>{this.mergedCells.splice(this.mergedCells.indexOf(c),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(c=>{_assertClassBrand60(_MergedCellsCollection_brand,this,_addMergedCellToMatrix).call(this,c)})}};function _getNonIntersectingIndexes(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=new Map,o=r===1?e.getTopStartCorner():e.getBottomEndCorner(),a=r===1?e.getBottomEndCorner():e.getTopStartCorner();for(let c=o.row;r===1?c<=a.row:c>=a.row;c+=r)for(let u=o.col;r===1?u<=a.col:u>=a.col;u+=r){const h=t==="row"?c:u,d=this.get(c,u);let f=h;d&&(f=r===1?d[t]+d[`${t}span`]-1:d[t]),i.has(h)||i.set(h,new Set),i.get(h).add(f)}return Array.from(new Set(Array.from(i.entries()).filter(c=>{let[,u]=c;return u.size===1}).flatMap(c=>{let[,u]=c;return Array.from(u)})))}function _addMergedCellToMatrix(e){for(let t=e.row;t<e.row+e.rowspan;t++)for(let r=e.col;r<e.col+e.colspan;r++)this.mergedCellsMatrix.has(t)||this.mergedCellsMatrix.set(t,new Map),this.mergedCellsMatrix.get(t).set(r,e)}function _removeMergedCellFromMatrix(e){for(let t=e.row;t<e.row+e.rowspan;t++)for(let r=e.col;r<e.col+e.colspan;r++)this.mergedCellsMatrix.get(t).delete(r)}var cellsCollection_default=MergedCellsCollection,import_es_error_cause151=__toESM(require_es_error_cause(),1);function _defineProperty102(e,t,r){return(t=_toPropertyKey102(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey102(e){var t=_toPrimitive102(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive102(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AutofillCalculations=class{constructor(e){_defineProperty102(this,"plugin",void 0),_defineProperty102(this,"mergedCellsCollection",void 0),_defineProperty102(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}getDirection(e,t){let r=null;return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?r="down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?r="up":t[1]===e[1]&&t[2]===e[2]?r="right":r="left",r}snapDragArea(e,t,r,i){const o=t.slice(0),a=this.getAutofillSize(e,t,r),[c,u,h,d]=e,m=["up","down"].indexOf(r)>-1?h-c+1:d-u+1,g=Math.floor(a/m)*m,v=a-g,_=this.getFarthestCollection(e,t,r,i);if(_){if(r==="down"){const b=_.row+_.rowspan-c-v;o[2]+b>=this.plugin.hot.countRows()?o[2]-=v:o[2]+=v?b:0}else if(r==="right"){const b=_.col+_.colspan-u-v;o[3]+b>=this.plugin.hot.countCols()?o[3]-=v:o[3]+=v?b:0}else if(r==="up"){const b=h-v-_.row+1;o[0]+b<0?o[0]+=v:o[0]-=v?b:0}else if(r==="left"){const b=d-v-_.col+1;o[1]+b<0?o[1]+=v:o[1]-=v?b:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:a,dragArea:o,cycleLength:m}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),extend2(this.currentFillData,e)}getAutofillSize(e,t,r){const[i,o,a,c]=e,[u,h,d,f]=t;switch(r){case"up":return i-u;case"down":return d-a;case"left":return o-h;case"right":return f-c;default:return null}}getDragArea(e,t,r){const[i,o,a,c]=e,[u,h,d,f]=t;switch(r){case"up":return[u,h,i-1,c];case"down":return[a+1,o,d,c];case"left":return[u,h,a,o-1];case"right":return[i,c+1,d,f];default:return null}}getFarthestCollection(e,t,r,i){const[o,a,c,u]=e,h=["up","down"].indexOf(r)>-1,d=h?c:u,f=h?o:a,m=this.getAutofillSize(e,t,r),g=h?c-o+1:u-a+1,v=Math.floor(m/g)*g,_=m-v;let b=null,S=null,R=null;switch(r){case"up":b="includesVertically",R=d-_+1;break;case"left":b="includesHorizontally",R=d-_+1;break;case"down":b="includesVertically",R=f+_-1;break;case"right":b="includesHorizontally",R=f+_-1;break;default:}return arrayEach(i,A=>{A[b](R)&&A.isFarther(S,r)&&(S=A)}),S}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(h,d)=>{switch(i){case"up":return h.row-d>=t.from.row;case"down":return h.row+h.rowspan-1+d<=t.to.row;case"left":return h.col-d>=t.from.column;case"right":return h.col+h.colspan-1+d<=t.to.column;default:return null}};let a=0,c=null,u=1;do for(let h=0;h<r.length;h+=1){if(c=r[h],a=u*this.currentFillData.cycleLength,o(c,a))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:c.row-a,rowspan:c.rowspan,col:c.col,colspan:c.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:c.row+a,rowspan:c.rowspan,col:c.col,colspan:c.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:c.row,rowspan:c.rowspan,col:c.col-a,colspan:c.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:c.row,rowspan:c.rowspan,col:c.col+a,colspan:c.colspan});break;default:}h===r.length-1&&(u+=1)}while(o(c,a));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},r={min:null,max:null};return arrayEach(e,i=>{const o=i[0],a=this.plugin.hot.propToCol(i[1]);(t.min===null||o<t.min)&&(t.min=o),(t.max===null||o>t.max)&&(t.max=o),(r.min===null||a<r.min)&&(r.min=a),(r.max===null||a>r.max)&&(r.max=a)}),{from:{row:t.min,column:r.min},to:{row:t.max,column:r.max}}}dragAreaOverlapsCollections(e,t,r){const i=this.getDragArea(e,t,r),[o,a,c,u]=i,h=this.plugin.hot._createCellCoords(o,a),d=this.plugin.hot._createCellCoords(c,u),f=this.plugin.hot._createCellRange(h,h,d);return this.mergedCellsCollection.getWithinRange(f,!0).length>0}},autofill_default=AutofillCalculations,import_es_error_cause152=__toESM(require_es_error_cause(),1),import_es_array_push91=__toESM(require_es_array_push(),1);function _defineProperty103(e,t,r){return(t=_toPropertyKey103(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey103(e){var t=_toPrimitive103(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive103(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SelectionCalculations=class{constructor(e){_defineProperty103(this,"plugin",void 0),_defineProperty103(this,"hot",void 0),_defineProperty103(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,t,r,i){const o=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),c=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const d=this.plugin.mergedCellsCollection.get(e,t);if(!d)return;const f=d.getLastRow(),m=d.getLastColumn();if(o<=d.row&&a<=d.col&&c>=f&&u>=m)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(d,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,t){const r=[];if(!t||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let a=0;a<t.length;a+=1)o[a]=t[a].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}},selection_default5=SelectionCalculations;function toggleMergeItem(e){return{key:"mergeCells",name(){const t=this.getSelectedLast();if(t){const r=e.mergedCellsCollection.get(t[0],t[1]);if(r.row===t[0]&&r.col===t[1]&&r.row+r.rowspan-1===t[2]&&r.col+r.colspan-1===t[3])return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_MERGE_CELLS)},callback(){const t=this.getSelectedRangeLast();if(!t)return;t.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:r,to:i}=t;e.toggleMerge(t),this.selectCell(r.row,r.col,i.row,i.col,!1)},disabled(){const t=this.getSelectedLast();return t?cellCoords_default.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}var import_es_error_cause154=__toESM(require_es_error_cause(),1),import_es_array_push92=__toESM(require_es_array_push(),1),import_es_error_cause153=__toESM(require_es_error_cause(),1);function _defineProperty104(e,t,r){return(t=_toPropertyKey104(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey104(e){var t=_toPrimitive104(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive104(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NodeStructure=class{constructor(e){_defineProperty104(this,"data",void 0),_defineProperty104(this,"next",null),_defineProperty104(this,"prev",null),this.data=e}},LinkedList=class{constructor(){_defineProperty104(this,"first",null),_defineProperty104(this,"last",null)}push(e){const t=new NodeStructure(e);if(this.first===null)this.first=t,this.last=t;else{const r=this.last;this.last=t,t.prev=r,r.next=t}return t}unshift(e){const t=new NodeStructure(e);if(this.first===null)this.first=t,this.last=t;else{const r=this.first;this.first=t,t.next=r,r.prev=t}}inorder(e){let t=this.first;for(;t;){const r=e(t);if(t===this.last||r===!0)break;t=t.next}}remove(e){if(this.first===null)return!1;let t=this.first,r,i;for(;t;){if(t.data===e)return r=t.next,i=t.prev,r&&(r.prev=i),i&&(i.next=r),t===this.first&&(this.first=r),t===this.last&&(this.last=i),!0;t=t.next}return!1}hasCycle(){let e=this.first,t=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,t=t.next,e===t)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const t=this.first;this.first=this.last,this.last=t}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,t=this.first,r;for(;e;)r=e.next,e.next=t,t.prev=e,t=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=t,this.last=r}},linkedList_default=LinkedList;function _classPrivateMethodInitSpec43(e,t){_checkPrivateRedeclaration61(e,t),t.add(e)}function _classPrivateFieldInitSpec45(e,t,r){_checkPrivateRedeclaration61(e,t),t.set(e,r)}function _checkPrivateRedeclaration61(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet45(e,t){return e.get(_assertClassBrand61(e,t))}function _classPrivateFieldSet42(e,t,r){return e.set(_assertClassBrand61(e,t),r),r}function _assertClassBrand61(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _cellsHorizontalOrder=new WeakMap,_cellsVerticalOrder=new WeakMap,_currentHorizontalLinkedNode=new WeakMap,_currentVerticalLinkedNode=new WeakMap,_mergedCellsGetter=new WeakMap,_rowIndexMapper=new WeakMap,_columnIndexMapper=new WeakMap,_FocusOrder_brand=new WeakSet,FocusOrder=class{constructor(e){let{mergedCellsGetter:t,rowIndexMapper:r,columnIndexMapper:i}=e;_classPrivateMethodInitSpec43(this,_FocusOrder_brand),_classPrivateFieldInitSpec45(this,_cellsHorizontalOrder,new linkedList_default),_classPrivateFieldInitSpec45(this,_cellsVerticalOrder,new linkedList_default),_classPrivateFieldInitSpec45(this,_currentHorizontalLinkedNode,null),_classPrivateFieldInitSpec45(this,_currentVerticalLinkedNode,null),_classPrivateFieldInitSpec45(this,_mergedCellsGetter,null),_classPrivateFieldInitSpec45(this,_rowIndexMapper,null),_classPrivateFieldInitSpec45(this,_columnIndexMapper,null),_classPrivateFieldSet42(_mergedCellsGetter,this,t),_classPrivateFieldSet42(_rowIndexMapper,this,r),_classPrivateFieldSet42(_columnIndexMapper,this,i)}getCurrentVerticalNode(){return _classPrivateFieldGet45(_currentVerticalLinkedNode,this).data}getFirstVerticalNode(){return _classPrivateFieldGet45(_cellsVerticalOrder,this).first.data}getNextVerticalNode(){return _classPrivateFieldGet45(_currentVerticalLinkedNode,this).next.data}getPrevVerticalNode(){return _classPrivateFieldGet45(_currentVerticalLinkedNode,this).prev.data}getCurrentHorizontalNode(){return _classPrivateFieldGet45(_currentHorizontalLinkedNode,this).data}getFirstHorizontalNode(){return _classPrivateFieldGet45(_cellsHorizontalOrder,this).first.data}getNextHorizontalNode(){return _classPrivateFieldGet45(_currentHorizontalLinkedNode,this).next.data}getPrevHorizontalNode(){return _classPrivateFieldGet45(_currentHorizontalLinkedNode,this).prev.data}setPrevNodeAsActive(){_classPrivateFieldSet42(_currentVerticalLinkedNode,this,_classPrivateFieldGet45(_currentVerticalLinkedNode,this).prev),_classPrivateFieldSet42(_currentHorizontalLinkedNode,this,_classPrivateFieldGet45(_currentHorizontalLinkedNode,this).prev)}setNextNodeAsActive(){_classPrivateFieldSet42(_currentVerticalLinkedNode,this,_classPrivateFieldGet45(_currentVerticalLinkedNode,this).next),_classPrivateFieldSet42(_currentHorizontalLinkedNode,this,_classPrivateFieldGet45(_currentHorizontalLinkedNode,this).next)}buildFocusOrder(e){const t=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;_classPrivateFieldSet42(_cellsHorizontalOrder,this,new linkedList_default);for(let a=t.row;a<=r.row;a++)if(!_classPrivateFieldGet45(_rowIndexMapper,this).isHidden(a))for(let c=t.col;c<=r.col;c++){if(_classPrivateFieldGet45(_columnIndexMapper,this).isHidden(c))continue;const u=_assertClassBrand61(_FocusOrder_brand,this,_pushOrderNode).call(this,e,_classPrivateFieldGet45(_cellsHorizontalOrder,this),i,a,c);u&&_classPrivateFieldSet42(_currentHorizontalLinkedNode,this,u)}_classPrivateFieldGet45(_cellsHorizontalOrder,this).first&&(_classPrivateFieldGet45(_cellsHorizontalOrder,this).first.prev=_classPrivateFieldGet45(_cellsHorizontalOrder,this).last,_classPrivateFieldGet45(_cellsHorizontalOrder,this).last.next=_classPrivateFieldGet45(_cellsHorizontalOrder,this).first);const o=new WeakSet;_classPrivateFieldSet42(_cellsVerticalOrder,this,new linkedList_default);for(let a=t.col;a<=r.col;a++)if(!_classPrivateFieldGet45(_columnIndexMapper,this).isHidden(a))for(let c=t.row;c<=r.row;c++){if(_classPrivateFieldGet45(_rowIndexMapper,this).isHidden(c))continue;const u=_assertClassBrand61(_FocusOrder_brand,this,_pushOrderNode).call(this,e,_classPrivateFieldGet45(_cellsVerticalOrder,this),o,c,a);u&&_classPrivateFieldSet42(_currentVerticalLinkedNode,this,u)}_classPrivateFieldGet45(_cellsVerticalOrder,this).first&&(_classPrivateFieldGet45(_cellsVerticalOrder,this).first.prev=_classPrivateFieldGet45(_cellsVerticalOrder,this).last,_classPrivateFieldGet45(_cellsVerticalOrder,this).last.next=_classPrivateFieldGet45(_cellsVerticalOrder,this).first)}setActiveNode(e,t){return _classPrivateFieldGet45(_cellsHorizontalOrder,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:a,colEnd:c}=r.data;if(e>=i&&e<=o&&t>=a&&t<=c)return _classPrivateFieldSet42(_currentHorizontalLinkedNode,this,r),!1}),_classPrivateFieldGet45(_cellsVerticalOrder,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:a,colEnd:c}=r.data;if(e>=i&&e<=o&&t>=a&&t<=c)return _classPrivateFieldSet42(_currentVerticalLinkedNode,this,r),!1}),this}};function _pushOrderNode(e,t,r,i,o){const a=e.getTopStartCorner(),c=e.getBottomEndCorner(),u=e.highlight.clone().normalize(),h=_classPrivateFieldGet45(_mergedCellsGetter,this).call(this,i,o);if(h&&r.has(h))return null;const d={colStart:o,colEnd:o,rowStart:i,rowEnd:i};if(h){if(r.add(h),h.row<a.row||h.row+h.rowspan-1>c.row||h.col<a.col||h.col+h.colspan-1>c.col)return null;d.colStart=h.col,d.colEnd=h.col+h.colspan-1,d.rowStart=h.row,d.rowEnd=h.row+h.rowspan-1}const f=t.push(d);return i===u.row&&o===u.col||h&&u.row>=h.row&&u.row<=h.row+h.rowspan-1&&u.col>=h.col&&u.col<=h.col+h.colspan-1?f:null}function createMergeCellRenderer(e){const{hot:t}=e,{rowIndexMapper:r,columnIndexMapper:i}=t;function o(){}function a(c,u,h){const d=e.mergedCellsCollection.get(u,h);if(!isObject2(d)){c.removeAttribute("rowspan"),c.removeAttribute("colspan"),c.style.display="";return}const{row:f,col:m,colspan:g,rowspan:v}=d,[_,b]=e.translateMergedCellToRenderable(f,v,m,g),S=r.getRenderableFromVisualIndex(u),R=i.getRenderableFromVisualIndex(h),A=_-S+1,I=b-R+1,E=r.getNearestNotHiddenIndex(f,1),O=i.getNearestNotHiddenIndex(m,1),P=Math.min(v,A),L=Math.min(g,I);E===u&&O===h?(c.setAttribute("rowspan",P),c.setAttribute("colspan",L)):(c.removeAttribute("rowspan"),c.removeAttribute("colspan"),c.style.display="none")}return{before:o,after:a}}function _classPrivateMethodInitSpec44(e,t){_checkPrivateRedeclaration62(e,t),t.add(e)}function _classPrivateFieldInitSpec46(e,t,r){_checkPrivateRedeclaration62(e,t),t.set(e,r)}function _checkPrivateRedeclaration62(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty105(e,t,r){return(t=_toPropertyKey105(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey105(e){var t=_toPrimitive105(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive105(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldSet43(e,t,r){return e.set(_assertClassBrand62(e,t),r),r}function _classPrivateFieldGet46(e,t){return e.get(_assertClassBrand62(e,t))}function _assertClassBrand62(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}pluginHooks_default.getSingleton().register("beforeMergeCells"),pluginHooks_default.getSingleton().register("afterMergeCells"),pluginHooks_default.getSingleton().register("beforeUnmergeCells"),pluginHooks_default.getSingleton().register("afterUnmergeCells");var PLUGIN_KEY25="mergeCells",PLUGIN_PRIORITY24=150,SHORTCUTS_GROUP13=PLUGIN_KEY25,_lastSelectedFocus=new WeakMap,_lastFocusDelta=new WeakMap,_focusOrder=new WeakMap,_cellRenderer=new WeakMap,_MergeCells_brand=new WeakSet,MergeCells=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec44(this,_MergeCells_brand),_defineProperty105(this,"mergedCellsCollection",null),_defineProperty105(this,"autofillCalculations",null),_defineProperty105(this,"selectionCalculations",null),_classPrivateFieldInitSpec46(this,_lastSelectedFocus,null),_classPrivateFieldInitSpec46(this,_lastFocusDelta,{row:0,col:0}),_classPrivateFieldInitSpec46(this,_focusOrder,new FocusOrder({mergedCellsGetter:(e,t)=>this.mergedCellsCollection.get(e,t),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),_classPrivateFieldInitSpec46(this,_cellRenderer,createMergeCellRenderer(this))}static get PLUGIN_KEY(){return PLUGIN_KEY25}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY24}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY25]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new cellsCollection_default(this),this.autofillCalculations=new autofill_default(this),this.selectionCalculations=new selection_default5(this),this.addHook("afterInit",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onAfterInit3).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onModifyTransformFocus).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onModifyTransformStart).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onModifyTransformEnd).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onBeforeSelectionHighlightSet).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onBeforeSetRangeStart).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onBeforeSetRangeStart).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onBeforeSelectionFocusSet).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onAfterSelectionFocusSet).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onAfterSelectionEnd2).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onModifyGetCellCoords).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onAfterIsMultipleSelection).call(e,...r)}),this.addHook("afterRenderer",function(){return _classPrivateFieldGet46(_cellRenderer,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_addMergeActionsToContextMenu).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onAfterGetCellMeta3).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onAfterViewportRowCalculatorOverride).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onAfterViewportColumnCalculatorOverride).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onModifyAutofillRange).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onAfterCreateCol2).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onAfterRemoveCol2).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onAfterCreateRow2).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onAfterRemoveRow2).call(e,...r)}),this.addHook("afterChange",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onAfterChange3).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onBeforeDrawAreaBorders).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onAfterDrawSelection).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onBeforeRemoveCellClassNames).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onBeforeBeginEditing).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand62(_MergeCells_brand,e,_onModifyRowHeightByOverlayName).call(e,...r)}),this.addHook("beforeUndoStackChange",(t,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[PLUGIN_KEY25];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!isChrome())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let a=i+1;a<i+o;a++)t.push(a)}),t=[...new Set(t)],t.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>o?.name==="master"?o:o.clone.wtTable).forEach(o=>{const a=o.getRow(i);a&&(a.style.background=getStyle2(a,"backgroundColor").replace(")",", 0.99)"),e.push(a))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=getStyle2(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){return e?cellCoords_default.containsNegativeValues(e)?(warn(cellCoords_default.NEGATIVE_VALUES_WARNING(e)),!1):cellCoords_default.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(warn(cellCoords_default.IS_OUT_OF_BOUNDS_WARNING(e)),!1):cellCoords_default.isSingleCell(e)?(warn(cellCoords_default.IS_SINGLE_CELL(e)),!1):cellCoords_default.containsZeroSpan(e)?(warn(cellCoords_default.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(e){if(!Array.isArray(e))return;const t=e.filter(o=>this.validateSetting(o)),r=this.mergedCellsCollection.filterOverlappingMergeCells(t),i=[];r.forEach(o=>{const{row:a,col:c,rowspan:u,colspan:h}=o,d=this.hot._createCellCoords(a,c),f=this.hot._createCellCoords(a+u-1,c+h-1),m=this.hot._createCellRange(d,d,f);this.mergeRange(m,!0,!0);for(let g=a;g<a+u;g++)for(let v=c;v<c+h;v++)(g!==a||v!==c)&&i.push([g,v,null])}),i.length!==0&&this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}mergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),a={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},c=[];let u=null;return this.canMergeRange(a,t)?(this.hot.runHooks("beforeMergeCells",e,t),rangeEach(0,a.rowspan-1,d=>{rangeEach(0,a.colspan-1,f=>{let m=null;c[d]||(c[d]=[]),d===0&&f===0?m=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(a.row),this.hot.toPhysicalColumn(a.col)):this.hot.setCellMeta(a.row+d,a.col+f,"hidden",!0),c[d][f]=m})}),this.hot.setCellMeta(a.row,a.col,"spanned",!0),this.mergedCellsCollection.add(a,t)?(r?u=[a.row,a.col,c]:this.hot.populateFromArray(a.row,a.col,c,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,a,t),u):!0):!1}unmergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,t),arrayEach(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),rangeEach(0,i.rowspan-1,o=>{rangeEach(0,i.colspan-1,a=>{this.hot.removeCellMeta(i.row+o,i.col+a,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+a,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,r,i){const o=this.hot._createCellCoords(e,t),a=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,a))}unmerge(e,t,r,i){const o=this.hot._createCellCoords(e,t),a=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,a))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:SHORTCUTS_GROUP13})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP13)}modifyViewportRowStart(e,t){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<t;o+=1){const a=this.mergedCellsCollection.get(i,o);if(isObject2(a)){const c=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a.row,1));if(c<e.startRow){e.startRow=c,this.modifyViewportRowStart(e,t);return}}}}modifyViewportRowEnd(e,t){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<t;o+=1){const a=this.mergedCellsCollection.get(i,o);if(isObject2(a)){const c=a.row+a.rowspan-1,u=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(c,-1));if(u>e.endRow){e.endRow=u,this.modifyViewportRowEnd(e,t);return}}}}modifyViewportColumnStart(e,t){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<t;o+=1){const a=this.mergedCellsCollection.get(o,i);if(isObject2(a)){const c=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a.col,1));if(c<e.startColumn){e.startColumn=c,this.modifyViewportColumnStart(e,t);return}}}}modifyViewportColumnEnd(e,t){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<t;o+=1){const a=this.mergedCellsCollection.get(o,i);if(isObject2(a)){const c=a.col+a.colspan-1,u=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(c,-1));if(u>e.endColumn){e.endColumn=u,this.modifyViewportColumnEnd(e,t);return}}}}translateMergedCellToRenderable(e,t,r,i){const{rowIndexMapper:o,columnIndexMapper:a}=this.hot;let c,u;t===0?c=o.getNearestNotHiddenIndex(e,1):c=o.getNearestNotHiddenIndex(e+t-1,-1),i===0?u=a.getNearestNotHiddenIndex(r,1):u=a.getNearestNotHiddenIndex(r+i-1,-1);const h=e>=0?o.getRenderableFromVisualIndex(c):e,d=r>=0?a.getRenderableFromVisualIndex(u):r;return[h,d]}};function _onAfterInit3(){this.generateFromSettings(this.hot.getSettings()[PLUGIN_KEY25]),this.hot.render()}function _onAfterIsMultipleSelection(e){if(e){const t=this.mergedCellsCollection.mergedCells,r=this.hot.getSelectedRangeLast(),i=r.getTopStartCorner(),o=r.getBottomEndCorner();for(let a=0;a<t.length;a+=1)if(i.row===t[a].row&&i.col===t[a].col&&o.row===t[a].row+t[a].rowspan-1&&o.col===t[a].col+t[a].colspan-1)return!1}return e}function _onModifyTransformFocus(e){_classPrivateFieldGet46(_lastFocusDelta,this).row=e.row,_classPrivateFieldGet46(_lastFocusDelta,this).col=e.col}function _onModifyTransformStart(e){const t=this.hot.getSelectedRangeLast(),{highlight:r}=t,{columnIndexMapper:i,rowIndexMapper:o}=this.hot;_classPrivateFieldGet46(_lastSelectedFocus,this)&&(o.getRenderableFromVisualIndex(_classPrivateFieldGet46(_lastSelectedFocus,this).row)!==null&&(r.row=_classPrivateFieldGet46(_lastSelectedFocus,this).row),i.getRenderableFromVisualIndex(_classPrivateFieldGet46(_lastSelectedFocus,this).col)!==null&&(r.col=_classPrivateFieldGet46(_lastSelectedFocus,this).col),_classPrivateFieldSet43(_lastSelectedFocus,this,null));const a=this.mergedCellsCollection.get(r.row,r.col);if(!a)return;const c=a.col,u=a.col+a.colspan-1;if(e.col<0){const f=r.col>=c&&r.col<=u?c-1:u,m=i.getNearestNotHiddenIndex(f,-1);m===null?e.col=-this.hot.view.countRenderableColumnsInRange(0,r.col):e.col=-Math.max(this.hot.view.countRenderableColumnsInRange(m,r.col)-1,1)}else if(e.col>0){const f=r.col>=c&&r.col<=u?u+1:c,m=i.getNearestNotHiddenIndex(f,1);m===null?e.col=this.hot.view.countRenderableColumnsInRange(r.col,this.hot.countCols()):e.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,m)-1,1)}const h=a.row,d=a.row+a.rowspan-1;if(e.row<0){const f=r.row>=h&&r.row<=d?h-1:d,m=o.getNearestNotHiddenIndex(f,-1);m===null?e.row=-this.hot.view.countRenderableRowsInRange(0,r.row):e.row=-Math.max(this.hot.view.countRenderableRowsInRange(m,r.row)-1,1)}else if(e.row>0){const f=r.row>=h&&r.row<=d?d+1:h,m=o.getNearestNotHiddenIndex(f,1);m===null?e.row=this.hot.view.countRenderableRowsInRange(r.row,this.hot.countRows()):e.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,m)-1,1)}}function _onModifyTransformEnd(e){const t=this.hot.getSelectedRangeLast(),r=t.clone(),{to:i}=t,{columnIndexMapper:o,rowIndexMapper:a}=this.hot,c=(u,h)=>{r.expand(this.hot._createCellCoords(u,h));for(let d=0;d<this.mergedCellsCollection.mergedCells.length;d+=1)r.expandByRange(this.mergedCellsCollection.mergedCells[d].getRange())};if(e.col<0){let u=this.mergedCellsCollection.getStartMostColumnIndex(t,i.col)+e.col;c(i.row,u),t.getHorizontalDirection()==="E-W"&&r.getHorizontalDirection()==="E-W"&&(u=r.getTopStartCorner().col);const h=o.getNearestNotHiddenIndex(u,1);h!==null&&(e.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,i.col)-1,1))}else if(e.col>0){let u=this.mergedCellsCollection.getEndMostColumnIndex(t,i.col)+e.col;c(i.row,u),t.getHorizontalDirection()==="W-E"&&r.getHorizontalDirection()==="W-E"&&(u=r.getBottomEndCorner().col);const h=o.getNearestNotHiddenIndex(u,-1);h!==null&&(e.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,h)-1,1))}if(e.row<0){let u=this.mergedCellsCollection.getTopMostRowIndex(t,i.row)+e.row;c(u,i.col),t.getVerticalDirection()==="S-N"&&r.getVerticalDirection()==="S-N"&&(u=r.getTopStartCorner().row);const h=a.getNearestNotHiddenIndex(u,1);h!==null&&(e.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,i.row)-1,1))}else if(e.row>0){let u=this.mergedCellsCollection.getBottomMostRowIndex(t,i.row)+e.row;c(u,i.col),t.getVerticalDirection()==="N-S"&&r.getVerticalDirection()==="N-S"&&(u=r.getBottomStartCorner().row);const h=a.getNearestNotHiddenIndex(u,-1);h!==null&&(e.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,h)-1,1))}}function _onBeforeSelectionHighlightSet(){const e=this.hot.getSelectedRangeLast(),{highlight:t}=e;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){_classPrivateFieldSet43(_lastSelectedFocus,this,t.clone());return}for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)e.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)e.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);const r=this.mergedCellsCollection.get(t.row,t.col);_classPrivateFieldSet43(_lastSelectedFocus,this,t.clone()),r&&t.assign(r)}function _onModifyGetCellCoords(e,t){if(e<0||t<0)return;const r=this.mergedCellsCollection.get(e,t);if(!r)return;const{row:i,col:o,colspan:a,rowspan:c}=r;return[i,o,i+c-1,o+a-1]}function _addMergeActionsToContextMenu(e){e.items.push({name:"---------"},toggleMergeItem(this))}function _onBeforeSetRangeStart(){_classPrivateFieldSet43(_lastSelectedFocus,this,null)}function _onBeforeSelectionFocusSet(){if(_classPrivateFieldGet46(_lastSelectedFocus,this).isCell())return;const e=this.hot.getSelectedRangeLast(),t=e.getVerticalDirection(),r=e.getHorizontalDirection(),i=_classPrivateFieldGet46(_lastSelectedFocus,this).clone().normalize();_classPrivateFieldGet46(_focusOrder,this).setActiveNode(i.row,i.col),_classPrivateFieldGet46(_lastFocusDelta,this).row>0||_classPrivateFieldGet46(_lastFocusDelta,this).col>0?_classPrivateFieldGet46(_focusOrder,this).setPrevNodeAsActive():(r==="E-W"&&_classPrivateFieldGet46(_lastFocusDelta,this).col<0||t==="S-N"&&_classPrivateFieldGet46(_lastFocusDelta,this).row<0)&&_classPrivateFieldGet46(_focusOrder,this).setNextNodeAsActive()}function _onAfterSelectionFocusSet(e,t){const r=this.hot.getSelectedRangeLast(),{columnIndexMapper:i,rowIndexMapper:o}=this.hot;let a=null,c=null;if(_classPrivateFieldGet46(_lastFocusDelta,this).col<0){const{rowEnd:u,colEnd:h}=_classPrivateFieldGet46(_focusOrder,this).getPrevHorizontalNode();c=i.getNearestNotHiddenIndex(h,-1),a=o.getNearestNotHiddenIndex(u,-1)}else if(_classPrivateFieldGet46(_lastFocusDelta,this).col>0){const{rowStart:u,colStart:h}=_classPrivateFieldGet46(_focusOrder,this).getNextHorizontalNode();c=i.getNearestNotHiddenIndex(h,1),a=o.getNearestNotHiddenIndex(u,1)}else if(_classPrivateFieldGet46(_lastFocusDelta,this).row<0){const{rowEnd:u,colEnd:h}=_classPrivateFieldGet46(_focusOrder,this).getPrevVerticalNode();c=i.getNearestNotHiddenIndex(h,-1),a=o.getNearestNotHiddenIndex(u,-1)}else if(_classPrivateFieldGet46(_lastFocusDelta,this).row>0){const{rowStart:u,colStart:h}=_classPrivateFieldGet46(_focusOrder,this).getNextVerticalNode();c=i.getNearestNotHiddenIndex(h,1),a=o.getNearestNotHiddenIndex(u,1)}if(a!==null||c!==null){const u=this.hot._createCellCoords(a,c),h=this.mergedCellsCollection.get(u.row,u.col),d=this.hot.selection.highlight.getFocus();e=u.row,t=u.col,h?r.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(h.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(h.col,1)}):r.highlight.assign(u),d.clear(),d.add(u).commit()}_classPrivateFieldGet46(_focusOrder,this).setActiveNode(e,t),_classPrivateFieldSet43(_lastFocusDelta,this,{row:0,col:0})}function _onAfterSelectionEnd2(){this.hot.getSelectedRangeLast().isHeader()||_classPrivateFieldGet46(_focusOrder,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function _onAfterGetCellMeta3(e,t,r){const i=this.mergedCellsCollection.get(e,t);i&&(i.row!==e||i.col!==t?r.copyable=!1:(r.rowspan=i.rowspan,r.colspan=i.colspan))}function _onAfterViewportRowCalculatorOverride(e){const t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}function _onAfterViewportColumnCalculatorOverride(e){const t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}function _onModifyAutofillRange(e,t){this.autofillCalculations.correctSelectionAreaSize(t);const r=this.autofillCalculations.getDirection(t,e);let i=e;if(this.autofillCalculations.dragAreaOverlapsCollections(t,i,r))return i=t,i;const o=this.hot._createCellCoords(t[0],t[1]),a=this.hot._createCellCoords(t[2],t[3]),c=this.hot._createCellRange(o,o,a),u=this.mergedCellsCollection.getWithinRange(c);return u.length===0||(i=this.autofillCalculations.snapDragArea(t,i,r,u)),i}function _onAfterCreateCol2(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}function _onAfterRemoveCol2(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}function _onAfterCreateRow2(e,t,r){r!=="auto"&&this.mergedCellsCollection.shiftCollections("down",e,t)}function _onAfterRemoveRow2(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}function _onAfterChange3(e,t){t==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(e)}function _onBeforeDrawAreaBorders(e,t){if(t&&t==="area"){const r=this.hot.getSelectedRangeLast(),i=this.mergedCellsCollection.getWithinRange(r);arrayEach(i,o=>{r.getBottomEndCorner().row===o.getLastRow()&&r.getBottomEndCorner().col===o.getLastColumn()&&(e[2]=o.row,e[3]=o.col)})}}function _onAfterDrawSelection(e,t,r,i){if(r)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,r,i)}function _onBeforeRemoveCellClassNames(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function _onBeforeBeginEditing(e,t,r,i){if(!(i instanceof MouseEvent))return;const o=this.hot.getSelectedRangeLast(),a=this.mergedCellsCollection.getByRange(o);if(!a)return;const c=this.hot._createCellCoords(a.row,a.col),u=this.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1);return this.hot.selection.getLayerLevel()===0&&o.isEqual(this.hot._createCellRange(c,c,u))}function _onModifyRowHeightByOverlayName(e,t,r){if(this.hot.getSettings().rowHeaders||r==="bottom"||r==="bottom_inline_start_corner")return e;let i,o;if(r==="master")i=this.hot.view.getFirstRenderedVisibleColumn(),o=this.hot.view.getLastRenderedVisibleColumn();else{const g=this.hot.view.getOverlayByName(r);i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(g.clone.wtTable.getFirstRenderedColumn()),o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(g.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(t,i))return e;const c=this.hot._createCellCoords(t,i),u=this.hot._createCellCoords(t,o),h=this.hot._createCellRange(c,c,u),d=this.mergedCellsCollection.getWithinRange(h),f=d.reduce((g,v)=>{let{rowspan:_}=v;return Math.max(g,_)},1);let m=0;return d.length>1&&d[0].rowspan<f&&(m=f-d[0].rowspan),d.forEach(g=>{var v;let{rowspan:_}=g,b=0;r==="top"||r==="top_inline_start_corner"?b=Math.min(f,this.hot.view.countNotHiddenFixedRowsTop()-t):b=_-m,e=Math.max((v=e)!==null&&v!==void 0?v:0,_assertClassBrand62(_MergeCells_brand,this,_sumCellsHeights).call(this,t,b))}),e}function _sumCellsHeights(e,t){const r=this.hot.view._wt.wtSettings.getSettingPure("defaultRowHeight"),i=this.hot.getPlugin("autoRowSize");let o=0;for(let c=e;c<e+t;c++)if(!this.hot.rowIndexMapper.isHidden(c)){var a;o+=(a=i?.getRowHeight(c))!==null&&a!==void 0?a:r}return o}var import_es_error_cause156=__toESM(require_es_error_cause(),1);function rootComparator2(e,t){return function(r,i){const[,...o]=r,[,...a]=i;return function c(u){const h=e[u],d=t[u],f=o[u],m=a[u],g=d.multiColumnSorting,_=(g.compareFunctionFactory?g.compareFunctionFactory:getCompareFunctionFactory(d.type))(h,d,g)(f,m);if(_===DO_NOT_SWAP){const b=u+1;if(typeof t[b]<"u")return c(b)}return _}(0)}}function warnAboutPluginsConflict(){warn(toSingleLine`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}var import_es_array_push94=__toESM(require_es_array_push(),1),COLUMN_ORDER_PREFIX="sort";function getClassesToAdd2(e,t,r){const i=[];return r===!1||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&i.push(`${COLUMN_ORDER_PREFIX}-${e.getIndexOfColumnInSortQueue(t)+1}`),i}function getClassesToRemove2(e){const t=e.className.split(" "),r=new RegExp(`^${COLUMN_ORDER_PREFIX}-[0-9]{1,2}$`);return t.filter(i=>r.test(i))}function _defineProperty106(e,t,r){return(t=_toPropertyKey106(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey106(e){var t=_toPrimitive106(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive106(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PLUGIN_KEY26="multiColumnSorting",PLUGIN_PRIORITY25=170,CONFLICTED_PLUGIN_KEY="columnSorting",SHORTCUTS_GROUP14=PLUGIN_KEY26;registerRootComparator(PLUGIN_KEY26,rootComparator2);var MultiColumnSorting=class extends ColumnSorting{constructor(){super(...arguments),_defineProperty106(this,"pluginKey",PLUGIN_KEY26)}static get PLUGIN_KEY(){return PLUGIN_KEY26}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY25}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[CONFLICTED_PLUGIN_KEY]&&(warnAboutPluginsConflict(),this.hot.getPlugin(CONFLICTED_PLUGIN_KEY).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,APPEND_COLUMN_CONFIG_STRATEGY)),!1},runOnlyIf:()=>{var e,t;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:EDITOR_EDIT_GROUP,position:"before",group:SHORTCUTS_GROUP14})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP14)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),removeClass(e,getClassesToRemove2(e)),this.enabled!==!1&&addClass(e,getClassesToAdd2(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[CONFLICTED_PLUGIN_KEY]&&warnAboutPluginsConflict(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,t){wasHeaderClickedProperly(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,APPEND_COLUMN_CONFIG_STRATEGY))):this.sort(this.getColumnNextConfig(t.col)))}},import_es_error_cause157=__toESM(require_es_error_cause(),1),import_es_array_push95=__toESM(require_es_array_push(),1);function _defineProperty107(e,t,r){return(t=_toPropertyKey107(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey107(e){var t=_toPrimitive107(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive107(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PLUGIN_KEY27="multipleSelectionHandles",PLUGIN_PRIORITY26=160,MultipleSelectionHandles=class extends BasePlugin{constructor(){super(...arguments),_defineProperty107(this,"dragged",[]),_defineProperty107(this,"lastSetCell",null)}static get PLUGIN_KEY(){return PLUGIN_KEY27}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY26}isEnabled(){return isMobileBrowser()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",i=>{let o;if(hasClass(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(hasClass(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchend",i=>{if(hasClass(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(hasClass(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchmove",i=>{const{rootDocument:o}=this.hot;let a,c,u,h,d,f;if(e.dragged.length===0)return;const m=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!m||m===e.lastSetCell||((m.nodeName==="TD"||m.nodeName==="TH")&&(a=e.hot.getCoords(m),a.col===-1&&(a.col=0),c=e.hot.getSelectedRangeLast(),u=c.getWidth(),h=c.getHeight(),d=c.getDirection(),u===1&&h===1&&e.hot.selection.setRangeEnd(a),f=e.getCurrentRangeCoords(c,a,e.touchStartRange.direction,d,e.dragged[0]),f.start!==null&&e.hot.selection.setRangeStart(f.start),e.hot.selection.setRangeEnd(f.end),e.lastSetCell=m),i.preventDefault())})}getCurrentRangeCoords(e,t,r,i,o){const a=e.getTopStartCorner(),c=e.getBottomEndCorner(),u=e.getBottomStartCorner(),h=e.getTopEndCorner();let d={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?d={start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(u.row,t.col)}:d={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,a.col)};break;case"SE-NW":o==="bottom"&&(d={start:this.hot._createCellCoords(c.row,t.col),end:this.hot._createCellCoords(t.row,a.col)});break;default:break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?d={start:t,end:u}:d.end=t;break;case"NW-SE":o==="top"?d={start:t,end:c}:d.end=t;break;case"SE-NW":o==="top"?d={start:t,end:a}:d.end=t;break;case"SW-NE":o==="top"?d={start:t,end:h}:d.end=t;break;default:break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?d={start:this.hot._createCellCoords(t.row,a.col),end:this.hot._createCellCoords(u.row,t.col)}:d={start:this.hot._createCellCoords(a.row,t.col),end:this.hot._createCellCoords(t.row,c.col)};break;case"SW-NE":o==="top"?d={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,c.col)}:d={start:this.hot._createCellCoords(t.row,a.col),end:this.hot._createCellCoords(a.row,t.col)};break;case"SE-NW":o==="bottom"?d={start:this.hot._createCellCoords(t.row,h.col),end:this.hot._createCellCoords(a.row,t.col)}:o==="top"&&(d={start:u,end:t});break;default:break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(d.end=t);break;case"SE-NW":o==="top"?d.end=t:d={start:t,end:a};break;default:break}break;default:break}return d}isDragged(){return this.dragged.length>0}},import_es_error_cause166=__toESM(require_es_error_cause(),1),import_es_array_push102=__toESM(require_es_array_push(),1),import_es_error_cause164=__toESM(require_es_error_cause(),1),import_es_array_push101=__toESM(require_es_array_push(),1),import_es_error_cause158=__toESM(require_es_error_cause(),1),import_es_array_push97=__toESM(require_es_array_push(),1),import_es_array_push96=__toESM(require_es_array_push(),1);function createDefaultHeaderSettings(){let{label:e="",colspan:t=1,origColspan:r=1,collapsible:i=!1,crossHiddenColumns:o=[],isCollapsed:a=!1,isHidden:c=!1,isRoot:u=!1,isPlaceholder:h=!1,headerClassNames:d=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:e,colspan:t,origColspan:r,collapsible:i,isCollapsed:a,crossHiddenColumns:o,isHidden:c,isRoot:u,isPlaceholder:h,headerClassNames:d}}function createPlaceholderHeaderSettings(){return{label:"",isPlaceholder:!0}}function normalizeSettings(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const r=[];if(t===0)return r;arrayEach(e,o=>{const a=[];let c=0;r.push(a),arrayEach(o,u=>{const h=createDefaultHeaderSettings();if(isObject2(u)){const{label:f,colspan:m,headerClassName:g}=u;h.label=stringify(f),typeof m=="number"&&m>1&&(h.colspan=m,h.origColspan=m),typeof g=="string"&&(h.headerClassNames=[...g.split(" ")])}else h.label=stringify(u);c+=h.origColspan;let d=!1;if(c>=t&&(h.colspan=h.origColspan-(c-t),h.origColspan=h.colspan,d=!0),a.push(h),h.colspan>1)for(let f=0;f<h.colspan-1;f++)a.push(createPlaceholderHeaderSettings());return!d})});const i=Math.max(...arrayMap(r,o=>o.length));return arrayEach(r,o=>{if(o.length<i){const a=arrayMap(new Array(i-o.length),()=>createDefaultHeaderSettings());o.splice(o.length,0,...a)}}),r}function _classPrivateFieldInitSpec47(e,t,r){_checkPrivateRedeclaration63(e,t),t.set(e,r)}function _checkPrivateRedeclaration63(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet47(e,t){return e.get(_assertClassBrand63(e,t))}function _classPrivateFieldSet44(e,t,r){return e.set(_assertClassBrand63(e,t),r),r}function _assertClassBrand63(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var HEADER_CONFIGURABLE_PROPS=["label","collapsible"],_data=new WeakMap,_dataLength=new WeakMap,_columnsLimit2=new WeakMap,SourceSettings=class{constructor(){_classPrivateFieldInitSpec47(this,_data,[]),_classPrivateFieldInitSpec47(this,_dataLength,0),_classPrivateFieldInitSpec47(this,_columnsLimit2,1/0)}setColumnsLimit(e){_classPrivateFieldSet44(_columnsLimit2,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];_classPrivateFieldSet44(_data,this,normalizeSettings(e,_classPrivateFieldGet47(_columnsLimit2,this))),_classPrivateFieldSet44(_dataLength,this,_classPrivateFieldGet47(_data,this).length)}getData(){return _classPrivateFieldGet47(_data,this)}mergeWith(e){arrayEach(e,t=>{let{row:r,col:i,...o}=t;const a=this.getHeaderSettings(r,i);a!==null&&extend2(a,o,HEADER_CONFIGURABLE_PROPS)})}map(e){arrayEach(_classPrivateFieldGet47(_data,this),t=>{arrayEach(t,r=>{const i=e({...r});isObject2(i)&&extend2(r,i,HEADER_CONFIGURABLE_PROPS)})})}getHeaderSettings(e,t){var r;if(e>=_classPrivateFieldGet47(_dataLength,this)||e<0)return null;const i=_classPrivateFieldGet47(_data,this)[e];return Array.isArray(i)===!1||t>=i.length?null:(r=i[t])!==null&&r!==void 0?r:null}getHeadersSettings(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=_classPrivateFieldGet47(_dataLength,this)||e<0)return i;const o=_classPrivateFieldGet47(_data,this)[e];let a=0;for(let c=t;c<o.length;c++){const u=o[c];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(a+=u.colspan,i.push(u),u.colspan>1&&(c+=u.colspan-1),a===r)break;if(a>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return _classPrivateFieldGet47(_dataLength,this)}getColumnsCount(){return _classPrivateFieldGet47(_dataLength,this)>0?_classPrivateFieldGet47(_data,this)[0].length:0}clear(){_classPrivateFieldSet44(_data,this,[]),_classPrivateFieldSet44(_dataLength,this,0)}},import_es_error_cause160=__toESM(require_es_error_cause(),1),import_es_error_cause159=__toESM(require_es_error_cause(),1),import_es_array_push98=__toESM(require_es_array_push(),1);function _defineProperty108(e,t,r){return(t=_toPropertyKey108(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey108(e){var t=_toPrimitive108(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive108(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TRAVERSAL_DF_PRE="DF-pre-order";function depthFirstPreOrder(e,t){let r=e.call(t,this);for(let i=0;i<this.childs.length;i++){if(r===!1)return!1;r=depthFirstPreOrder.call(this.childs[i],e,t)}return r}var TRAVERSAL_DF_POST="DF-post-order";function depthFirstPostOrder(e,t){for(let r=0;r<this.childs.length;r++)if(depthFirstPostOrder.call(this.childs[r],e,t)===!1)return!1;return e.call(t,this)}var TRAVERSAL_BF="BF";function breadthFirst(e,t){const r=[this];function i(){if(r.length===0)return;const o=r.shift();r.push(...o.childs),e.call(t,o)!==!1&&i()}i()}var DEFAULT_TRAVERSAL_STRATEGY=TRAVERSAL_BF,TRAVERSAL_STRATEGIES=new Map([[TRAVERSAL_DF_PRE,depthFirstPreOrder],[TRAVERSAL_DF_POST,depthFirstPostOrder],[TRAVERSAL_BF,breadthFirst]]),TreeNode=class fs{constructor(t){_defineProperty108(this,"data",{}),_defineProperty108(this,"parent",null),_defineProperty108(this,"childs",[]),this.data=t}addChild(t){t.parent=this,this.childs.push(t)}cloneTree(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const r=new fs({...t.data});for(let i=0;i<t.childs.length;i++)r.addChild(this.cloneTree(t.childs[i]));return r}replaceTreeWith(t){this.data={...t.data},this.childs=[];for(let r=0;r<t.childs.length;r++)this.addChild(t.childs[r])}walkDown(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DEFAULT_TRAVERSAL_STRATEGY;if(!TRAVERSAL_STRATEGIES.has(r))throw new Error(`Traversal strategy "${r}" does not exist`);TRAVERSAL_STRATEGIES.get(r).call(this,t,this)}walkUp(t){const r=this,i=o=>{t.call(r,o)!==!1&&o.parent!==null&&i(o.parent)};i(this)}};function _classPrivateFieldInitSpec48(e,t,r){_checkPrivateRedeclaration64(e,t),t.set(e,r)}function _checkPrivateRedeclaration64(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet48(e,t){return e.get(_assertClassBrand64(e,t))}function _classPrivateFieldSet45(e,t,r){return e.set(_assertClassBrand64(e,t),r),r}function _assertClassBrand64(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _rootNodes=new WeakMap,_rootsIndex=new WeakMap,_sourceSettings=new WeakMap,HeadersTree=class{constructor(e){_classPrivateFieldInitSpec48(this,_rootNodes,new Map),_classPrivateFieldInitSpec48(this,_rootsIndex,new Map),_classPrivateFieldInitSpec48(this,_sourceSettings,null),_classPrivateFieldSet45(_sourceSettings,this,e)}getRoots(){return Array.from(_classPrivateFieldGet48(_rootNodes,this).values())}getRootByColumn(e){let t;return _classPrivateFieldGet48(_rootsIndex,this).has(e)&&(t=_classPrivateFieldGet48(_rootNodes,this).get(_classPrivateFieldGet48(_rootsIndex,this).get(e))),t}getNode(e,t){const r=this.getRootByColumn(t);if(!r)return;const i=t-_classPrivateFieldGet48(_rootsIndex,this).get(t);let o=0,a;return r.walkDown(c=>{const{data:{origColspan:u,headerLevel:h}}=c;if(e===h){if(i>=o&&i<=o+u-1)return a=c,a.data.isRoot=t===a.data.columnIndex,!1;o+=u}}),a}rebuildTreeIndex(){let e=0;_classPrivateFieldGet48(_rootsIndex,this).clear(),arrayEach(_classPrivateFieldGet48(_rootNodes,this),t=>{let[,{data:{colspan:r}}]=t;for(let i=e;i<e+r;i++)_classPrivateFieldGet48(_rootsIndex,this).set(i,e);e+=r})}buildTree(){this.clear();const e=_classPrivateFieldGet48(_sourceSettings,this).getColumnsCount();let t=0;for(;t<e;){const r=_classPrivateFieldGet48(_sourceSettings,this).getHeaderSettings(0,t),i=new TreeNode;_classPrivateFieldGet48(_rootNodes,this).set(t,i),this.buildLeaves(i,t,0,r.origColspan),t+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=_classPrivateFieldGet48(_sourceSettings,this).getHeadersSettings(r,t,i);r+=1,arrayEach(o,a=>{const c={...a,headerLevel:r-1,columnIndex:t};let u;r===1?(e.data=c,u=e):(u=new TreeNode(c),e.addChild(u)),r<_classPrivateFieldGet48(_sourceSettings,this).getLayersCount()&&this.buildLeaves(u,t,r,a.origColspan),t+=a.origColspan})}clear(){_classPrivateFieldGet48(_rootNodes,this).clear(),_classPrivateFieldGet48(_rootsIndex,this).clear()}},import_es_error_cause163=__toESM(require_es_error_cause(),1),import_es_set_difference_v225=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v225=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v225=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v225=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v225=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v225=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v225=__toESM(require_es_set_union_v2(),1),import_es_set_difference_v224=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v224=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v224=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v224=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v224=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v224=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v224=__toESM(require_es_set_union_v2(),1);function traverseHiddenNodeColumnIndexes(e,t){e.walkDown(r=>{let{data:i,childs:o}=r;if(!i.isHidden&&(t(i.columnIndex),o.length===0))for(let a=1;a<i.colspan;a++)t(i.columnIndex+a)})}function getFirstChildProperty(e,t){let{childs:r}=e;if(r.length!==0)return r[0].data[t]}function isNodeReflectsFirstChildColspan(e){return getFirstChildProperty(e,"origColspan")===e.data.origColspan}function expandNode(e){const{data:t,childs:r}=e;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(isNodeReflectsFirstChildColspan(e))return expandNode(r[0]);t.isCollapsed=!1;const o=r.slice(1),a=new Set;let c=0;if(o.length>0)arrayEach(o,u=>{u.replaceTreeWith(u.data.clonedTree),u.data.clonedTree=null;const h=u.data;c+=h.colspan,traverseHiddenNodeColumnIndexes(u,d=>{a.add(d)})});else{const{colspan:u,origColspan:h,columnIndex:d}=t;c=h-u;for(let f=1;f<h;f++)a.add(d+f)}return e.walkUp(u=>{const{data:h}=u;h.colspan+=c,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):isNodeReflectsFirstChildColspan(u)&&(h.isCollapsed=getFirstChildProperty(u,"isCollapsed"))}),{rollbackModification:()=>collapseNode(e),affectedColumns:Array.from(a),colspanCompensation:c}}function collapseNode(e){var t;const{data:r,childs:i}=e;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(isNodeReflectsFirstChildColspan(e))return collapseNode(i[0]);r.isCollapsed=!0;const a=i.slice(1),c=new Set;if(a.length>0)arrayEach(a,h=>{traverseHiddenNodeColumnIndexes(h,d=>{c.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(d=>{let{data:f}=d;f.isHidden=!0})});else{const{origColspan:h,columnIndex:d}=r;for(let f=1;f<h;f++){const m=d+f;c.add(m)}}const u=r.colspan-((t=getFirstChildProperty(e,"colspan"))!==null&&t!==void 0?t:1);return e.walkUp(h=>{const{data:d}=h;d.colspan-=u,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):isNodeReflectsFirstChildColspan(h)&&(d.isCollapsed=getFirstChildProperty(h,"isCollapsed"))}),{rollbackModification:()=>expandNode(e),affectedColumns:Array.from(c),colspanCompensation:u}}var import_es_error_cause161=__toESM(require_es_error_cause(),1),import_es_array_push99=__toESM(require_es_array_push(),1);function hideColumn(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(toSingleLine`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:r}=e.data;if(r.includes(t))return;let i=!1;e.walkUp(o=>{const{data:{collapsible:a}}=o;if(a)return i=!0,!1}),!i&&e.walkUp(o=>{const{data:a}=o;a.crossHiddenColumns.push(t),a.colspan>1?a.colspan-=1:a.isHidden=!0})}var import_es_error_cause162=__toESM(require_es_error_cause(),1);function showColumn(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(toSingleLine`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:r}=e.data;if(!r.includes(t))return;let i=!1;e.walkUp(o=>{const{data:{collapsible:a}}=o;if(a)return i=!0,!1}),!i&&e.walkUp(o=>{const{data:a}=o;a.crossHiddenColumns.splice(a.crossHiddenColumns.indexOf(t),1),!a.isHidden&&a.colspan<a.origColspan&&(a.colspan+=1),a.isHidden=!1})}var availableModifiers=new Map([["collapse",collapseNode],["expand",expandNode],["hide-column",hideColumn],["show-column",showColumn]]);function triggerNodeModification(e,t,r){if(!availableModifiers.has(e))throw new Error(`The node modifier action ("${e}") does not exist.`);return availableModifiers.get(e)(t,r)}var import_es_array_push100=__toESM(require_es_array_push(),1);function generateMatrix(e){const t=[];return arrayEach(e,r=>{r.walkDown(i=>{const o=i.data,{origColspan:a,columnIndex:c,headerLevel:u,crossHiddenColumns:h}=o,d=createNestedArrayIfNecessary(t,u);let f=!1;for(let m=c;m<c+a;m++)if(h.includes(m)||f)d.push(createPlaceholderHeaderSettings(o));else{const v=createHeaderSettings(o);v.isRoot=!0,d.push(v),f=!0}})}),t}function createHeaderSettings(e){const{crossHiddenColumns:t,...r}=createDefaultHeaderSettings(e);return r}function createNestedArrayIfNecessary(e,t){let r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}function _classPrivateFieldInitSpec49(e,t,r){_checkPrivateRedeclaration65(e,t),t.set(e,r)}function _checkPrivateRedeclaration65(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet46(e,t,r){return e.set(_assertClassBrand65(e,t),r),r}function _classPrivateFieldGet49(e,t){return e.get(_assertClassBrand65(e,t))}function _assertClassBrand65(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _sourceSettings2=new WeakMap,_headersTree=new WeakMap,_stateMatrix=new WeakMap,StateManager=class{constructor(){_classPrivateFieldInitSpec49(this,_sourceSettings2,new SourceSettings),_classPrivateFieldInitSpec49(this,_headersTree,new HeadersTree(_classPrivateFieldGet49(_sourceSettings2,this))),_classPrivateFieldInitSpec49(this,_stateMatrix,[[]])}setState(e){_classPrivateFieldGet49(_sourceSettings2,this).setData(e);let t=!1;try{_classPrivateFieldGet49(_headersTree,this).buildTree()}catch{_classPrivateFieldGet49(_headersTree,this).clear(),_classPrivateFieldGet49(_sourceSettings2,this).clear(),t=!0}return _classPrivateFieldSet46(_stateMatrix,this,generateMatrix(_classPrivateFieldGet49(_headersTree,this).getRoots())),t}setColumnsLimit(e){_classPrivateFieldGet49(_sourceSettings2,this).setColumnsLimit(e)}mergeStateWith(e){const t=arrayMap(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});_classPrivateFieldGet49(_sourceSettings2,this).mergeWith(t),_classPrivateFieldGet49(_headersTree,this).buildTree(),_classPrivateFieldSet46(_stateMatrix,this,generateMatrix(_classPrivateFieldGet49(_headersTree,this).getRoots()))}mapState(e){_classPrivateFieldGet49(_sourceSettings2,this).map(e),_classPrivateFieldGet49(_headersTree,this).buildTree(),_classPrivateFieldSet46(_stateMatrix,this,generateMatrix(_classPrivateFieldGet49(_headersTree,this).getRoots()))}mapNodes(e){return arrayReduce(_classPrivateFieldGet49(_headersTree,this).getRoots(),(t,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&t.push(o)}),t),[])}triggerNodeModification(e,t,r){t<0&&(t=this.rowCoordsToLevel(t));const i=_classPrivateFieldGet49(_headersTree,this).getNode(t,r);let o;return i&&(o=triggerNodeModification(e,i,r),_classPrivateFieldSet46(_stateMatrix,this,generateMatrix(_classPrivateFieldGet49(_headersTree,this).getRoots()))),o}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=_classPrivateFieldGet49(_stateMatrix,this)[e])===null||i===void 0?void 0:i[t])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,t){const r=this.getHeaderTreeNode(e,t);return r?{...r.data}:null}getHeaderTreeNode(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=_classPrivateFieldGet49(_headersTree,this).getNode(e,t);return r||null}findTopMostEntireHeaderLevel(e){var t;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=r-e+1;let o=!1,a=null;for(let c=e;c<=r;c++){const u=_classPrivateFieldGet49(_headersTree,this).getRootByColumn(c);if(!u)break;o=!0,u.walkDown(h=>{const{columnIndex:d,headerLevel:f,origColspan:m,isHidden:g}=h.data;g||m<=i&&d>=e&&d+m-1<=r&&(a===null||f<a)&&(a=f)},TRAVERSAL_DF_PRE)}return o&&a===null?-1:this.levelToRowCoords((t=a)!==null&&t!==void 0?t:0)}findLeftMostColumnIndex(e,t){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,t))!==null&&r!==void 0?r:{isRoot:!0};if(i)return t;let o=t-1;for(;o>=0;){var a;const{isRoot:c}=(a=this.getHeaderSettings(e,o))!==null&&a!==void 0?a:{isRoot:!0};if(c)break;o-=1}return o}findRightMostColumnIndex(e,t){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,t))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return t+o-1;let a=t+1;for(;a<this.getColumnsCount();){var c;const{isRoot:u}=(c=this.getHeaderSettings(e,a))!==null&&c!==void 0?c:{isRoot:!0};if(u)break;a+=1}return a-1}getLayersCount(){return _classPrivateFieldGet49(_sourceSettings2,this).getLayersCount()}getColumnsCount(){return _classPrivateFieldGet49(_sourceSettings2,this).getColumnsCount()}clear(){_classPrivateFieldSet46(_stateMatrix,this,[]),_classPrivateFieldGet49(_sourceSettings2,this).clear(),_classPrivateFieldGet49(_headersTree,this).clear()}},import_es_error_cause165=__toESM(require_es_error_cause(),1);function _defineProperty109(e,t,r){return(t=_toPropertyKey109(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey109(e){var t=_toPrimitive109(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive109(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GhostTable2=class{constructor(e,t){_defineProperty109(this,"hot",void 0),_defineProperty109(this,"nestedHeaderSettingsGetter",void 0),_defineProperty109(this,"layersCount",0),_defineProperty109(this,"container",void 0),_defineProperty109(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsMap.clear();for(let r=0;r<t;r++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),o=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(o,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:r}=this.hot,i=t.createDocumentFragment(),o=t.createElement("table"),a=!!this.hot.getSettings().dropdownMenu,c=r.getRenderableIndexesLength();for(let u=0;u<this.layersCount;u++){const h=t.createElement("tr");for(let d=0;d<c;d++){let f=r.getVisualFromRenderableIndex(d);f===null&&(f=d);const m=t.createElement("th"),g=this.nestedHeaderSettingsGetter(u,f);if(g&&(!g.isPlaceholder||g.isHidden)){let v=g.label;a&&(v+='<button class="changeType"></button>'),fastInnerHTML(m,v),m.colSpan=g.colspan,h.appendChild(m)}}o.appendChild(h)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}},ghostTable_default2=GhostTable2;function _classPrivateMethodInitSpec45(e,t){_checkPrivateRedeclaration66(e,t),t.add(e)}function _defineProperty110(e,t,r){return(t=_toPropertyKey110(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey110(e){var t=_toPrimitive110(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive110(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldInitSpec50(e,t,r){_checkPrivateRedeclaration66(e,t),t.set(e,r)}function _checkPrivateRedeclaration66(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet47(e,t,r){return e.set(_assertClassBrand66(e,t),r),r}function _classPrivateFieldGet50(e,t){return e.get(_assertClassBrand66(e,t))}function _assertClassBrand66(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var PLUGIN_KEY28="nestedHeaders",PLUGIN_PRIORITY27=280,_stateManager=new WeakMap,_hidingIndexMapObserver=new WeakMap,_focusInitialCoords=new WeakMap,_isColumnsSelectionInProgress=new WeakMap,_NestedHeaders_brand=new WeakSet,NestedHeaders=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec45(this,_NestedHeaders_brand),_classPrivateFieldInitSpec50(this,_stateManager,new StateManager),_classPrivateFieldInitSpec50(this,_hidingIndexMapObserver,null),_classPrivateFieldInitSpec50(this,_focusInitialCoords,null),_classPrivateFieldInitSpec50(this,_isColumnsSelectionInProgress,!1),_defineProperty110(this,"ghostTable",new ghostTable_default2(this.hot,(e,t)=>this.getHeaderSettings(e,t))),_defineProperty110(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY28}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY27}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY28]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();(!Array.isArray(t)||!Array.isArray(t[0]))&&warn(toSingleLine`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>_assertClassBrand66(_NestedHeaders_brand,this,_onInit4).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand66(_NestedHeaders_brand,e,_onAfterLoadData8).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand66(_NestedHeaders_brand,e,_onBeforeOnCellMouseDown6).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand66(_NestedHeaders_brand,e,_onAfterOnCellMouseDown).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand66(_NestedHeaders_brand,e,_onBeforeOnCellMouseOver3).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand66(_NestedHeaders_brand,e,_onBeforeOnCellMouseUp).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand66(_NestedHeaders_brand,e,_onBeforeSelectionHighlightSet2).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand66(_NestedHeaders_brand,e,_onModifyTransformStart2).call(e,...i)}),this.addHook("afterSelection",()=>_assertClassBrand66(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this)),this.addHook("afterSelectionFocusSet",()=>_assertClassBrand66(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand66(_NestedHeaders_brand,e,_onBeforeViewportScrollHorizontally2).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>_assertClassBrand66(_NestedHeaders_brand,this,_onAfterGetColumnHeaderRenderers).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand66(_NestedHeaders_brand,e,_onModifyColWidth3).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand66(_NestedHeaders_brand,e,_onModifyColumnHeaderValue).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand66(_NestedHeaders_brand,e,_onBeforeHighlightingColumnHeader).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand66(_NestedHeaders_brand,e,_onBeforeCopy).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand66(_NestedHeaders_brand,e,_onBeforeSelectColumns).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand66(_NestedHeaders_brand,e,_onAfterViewportColumnCalculatorOverride2).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand66(_NestedHeaders_brand,e,_onModifyFocusedElement).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>_assertClassBrand66(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>_assertClassBrand66(_NestedHeaders_brand,this,_updateFocusHighlightPosition).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();_classPrivateFieldGet50(_stateManager,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=_classPrivateFieldGet50(_stateManager,this).setState(e)),this.detectedOverlappedHeaders&&warn(toSingleLine`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,r)=>{const i=t===!0?"hide-column":"show-column";_classPrivateFieldGet50(_stateManager,this).triggerColumnModification(i,r)}),!_classPrivateFieldGet50(_hidingIndexMapObserver,this)&&this.enabled&&_classPrivateFieldSet47(_hidingIndexMapObserver,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(r=>{let{op:i,index:o,newValue:a}=r;if(i==="replace"){const c=a===!0?"hide-column":"show-column";_classPrivateFieldGet50(_stateManager,this).triggerColumnModification(c,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),_classPrivateFieldGet50(_stateManager,this).clear(),_classPrivateFieldGet50(_hidingIndexMapObserver,this).unsubscribe(),_classPrivateFieldSet47(_hidingIndexMapObserver,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return _classPrivateFieldGet50(_stateManager,this)}getLayersCount(){return _classPrivateFieldGet50(_stateManager,this).getLayersCount()}getHeaderSettings(e,t){return _classPrivateFieldGet50(_stateManager,this).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let a=0;a<t;a++){const c=r.childNodes[a];if(!c)break;const u=i.childNodes[a],h=o?o.childNodes[a]:null;for(let d=0,f=c.childNodes.length;d<f;d++)c.childNodes[d].removeAttribute("colspan"),removeClass(c.childNodes[d],"hiddenHeader"),u&&u.childNodes[d]&&(u.childNodes[d].removeAttribute("colspan"),removeClass(u.childNodes[d],"hiddenHeader")),o&&h&&h.childNodes[d]&&(h.childNodes[d].removeAttribute("colspan"),removeClass(h.childNodes[d],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var a;const{columnIndexMapper:c,view:u}=this.hot;let h=c.getVisualFromRenderableIndex(i);h===null&&(h=i),o.removeAttribute("colspan"),removeClass(o,"hiddenHeader");const{colspan:d,isHidden:f,isPlaceholder:m,headerClassNames:g}=(a=_classPrivateFieldGet50(_stateManager,this).getHeaderSettings(e,h))!==null&&a!==void 0?a:{label:""};if(m||f)addClass(o,"hiddenHeader");else if(d>1){var v,_;const{wtOverlays:b}=u._wt,S=(v=b.topInlineStartCornerOverlay)===null||v===void 0?void 0:v.clone.wtTable.THEAD.contains(o),R=(_=b.inlineStartOverlay)===null||_===void 0?void 0:_.clone.wtTable.THEAD.contains(o),A=S||R?Math.min(d,r-i):d;A>1&&o.setAttribute("colspan",A)}if(this.hot.view.appendColHeader(h,o,function(){return t.getColumnHeaderValue(...arguments)},e),!m&&!f){const b=o.querySelector("div.relative");b&&g&&g.length>0&&(removeClass(b,this.hot.getColumnMeta(h).headerClassName),addClass(b,g))}}}getColumnHeaderValue(e,t){var r;const{isHidden:i,isPlaceholder:o}=(r=_classPrivateFieldGet50(_stateManager,this).getHeaderSettings(t,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,t)}destroy(){_classPrivateFieldSet47(_stateManager,this,null),_classPrivateFieldGet50(_hidingIndexMapObserver,this)!==null&&(_classPrivateFieldGet50(_hidingIndexMapObserver,this).unsubscribe(),_classPrivateFieldSet47(_hidingIndexMapObserver,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return _classPrivateFieldGet50(_stateManager,this).getHeaderTreeNodeData(e.row,e.col)}};function _updateFocusHighlightPosition(){var e;const t=(e=this.hot)===null||e===void 0?void 0:e.getSelectedRangeLast();if(!t)return;const{highlight:r}=t;if(r.isHeader()&&r.col>=0){const o=_classPrivateFieldGet50(_stateManager,this).findLeftMostColumnIndex(r.row,r.col),a=this.hot.selection.highlight.getFocus();a.visualCellRange.highlight.col=o,a.visualCellRange.from.col=o,a.visualCellRange.to.col=o,a.commit()}}function _onBeforeViewportScrollHorizontally2(e){const t=this.hot.getSelectedRangeLast();if(!t)return e;const{highlight:r}=t;if(!(r.isHeader()&&r.col>=0))return e;const o=this.hot.view.getFirstFullyVisibleColumn(),a=this.hot.view.getLastFullyVisibleColumn(),c=_classPrivateFieldGet50(_stateManager,this).findLeftMostColumnIndex(r.row,r.col),u=_classPrivateFieldGet50(_stateManager,this).findRightMostColumnIndex(r.row,r.col);return c<o&&u>a?e:c<o?c:u}function _onBeforeHighlightingColumnHeader(e,t,r){const i=_classPrivateFieldGet50(_stateManager,this).getHeaderTreeNodeData(t,e);if(!i)return e;const{columnCursor:o,selectionType:a,selectionWidth:c}=r,{isRoot:u,colspan:h}=_classPrivateFieldGet50(_stateManager,this).getHeaderSettings(t,e);if(a===HEADER_TYPE){if(!u)return i.columnIndex}else if(a===ACTIVE_HEADER_TYPE&&(h>c-o||!u))return null;return e}function _onBeforeCopy(e,t,r){let{columnHeadersCount:i}=r;if(i!==0)for(let a=0;a<t.length;a++){const{startRow:c,startCol:u,endRow:h,endCol:d}=t[a],f=h-c+1,m=u-d+1;if(c>=0||m===1)break;for(let g=u;g<=d;g++)for(let v=c;v<=h;v++){var o;const _=f+v,b=g-u;if(b===0)continue;((o=_classPrivateFieldGet50(_stateManager,this).getHeaderTreeNodeData(v,g))===null||o===void 0?void 0:o.isRoot)===!1&&(e[_][b]="")}}}function _onBeforeOnCellMouseDown6(e,t,r,i){this._getHeaderTreeNodeDataByCoords(t)&&(i.column=!0)}function _onAfterOnCellMouseDown(e,t){const r=this._getHeaderTreeNodeDataByCoords(t);if(!r)return;_classPrivateFieldSet47(_focusInitialCoords,this,t.clone()),_classPrivateFieldSet47(_isColumnsSelectionInProgress,this,!0);const{selection:i}=this.hot,o=i.isSelected()?i.getSelectedRange().current():null,a=[],{columnIndex:c,origColspan:u}=r,h=!i.inInSelection(t);e.shiftKey&&o?t.col<o.from.col?a.push(o.getTopEndCorner().col,c,t.row):t.col>o.from.col?a.push(o.getTopStartCorner().col,c+u-1,t.row):a.push(c,c+u-1,t.row):(isLeftClick(e)||isRightClick(e)&&h||isTouchEvent(e))&&a.push(c,c+u-1,t.row),i.selectColumns(...a)}function _onBeforeOnCellMouseOver3(e,t,r,i){if(!this.hot.view.isMouseDown())return;const o=this._getHeaderTreeNodeDataByCoords(t);if(!o)return;const{columnIndex:a,origColspan:c}=o,u=this.hot.getSelectedRangeLast(),h=u.getTopStartCorner(),d=u.getBottomEndCorner(),{from:f}=u;i.column=!0,i.cell=!0;const m=[],g=clamp(t.row,-1/0,-1);t.col<f.col?m.push(d.col,a,g):t.col>f.col?m.push(h.col,a+c-1,g):m.push(a,a+c-1,g),this.hot.selection.selectColumns(...m)}function _onBeforeOnCellMouseUp(){_classPrivateFieldSet47(_isColumnsSelectionInProgress,this,!1)}function _onBeforeSelectionHighlightSet2(){const{navigableHeaders:e}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!_classPrivateFieldGet50(_isColumnsSelectionInProgress,this)||!e)return;const t=this.hot.getSelectedRangeLast(),r=t.getTopStartCorner().col,i=t.getBottomEndCorner().col,{columnIndex:o,origColspan:a}=_classPrivateFieldGet50(_stateManager,this).getHeaderTreeNodeData(_classPrivateFieldGet50(_focusInitialCoords,this).row,_classPrivateFieldGet50(_focusInitialCoords,this).col);if(t.setHighlight(_classPrivateFieldGet50(_focusInitialCoords,this)),a>t.getWidth()||o<r||o+a-1>i){const c=_classPrivateFieldGet50(_stateManager,this).findTopMostEntireHeaderLevel(clamp(r,o,o+a-1),clamp(i,o,o+a-1));t.highlight.row=c,t.highlight.col=t.from.col}}function _onModifyTransformStart2(e){const{highlight:t}=this.hot.getSelectedRangeLast(),r=this.hot._createCellCoords(t.row+e.row,t.col+e.col);if(!(r.isHeader()&&r.col>=0))return;const o=_classPrivateFieldGet50(_stateManager,this).findLeftMostColumnIndex(r.row,r.col),a=_classPrivateFieldGet50(_stateManager,this).findRightMostColumnIndex(r.row,r.col);if(e.col<0){const c=t.col>=o&&t.col<=a?o-1:a,u=this.hot.columnIndexMapper.getNearestNotHiddenIndex(c,-1);u===null?e.col=-this.hot.view.countRenderableColumnsInRange(0,t.col):e.col=-Math.max(this.hot.view.countRenderableColumnsInRange(u,t.col)-1,1)}else if(e.col>0){const c=t.col>=o&&t.col<=a?a+1:o,u=this.hot.columnIndexMapper.getNearestNotHiddenIndex(c,1);u===null?e.col=this.hot.view.countRenderableColumnsInRange(t.col,this.hot.countCols()):e.col=Math.max(this.hot.view.countRenderableColumnsInRange(t.col,u)-1,1)}}function _onBeforeSelectColumns(e,t){const r=e.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col});t.col<e.col?(i&&(e.col=i.columnIndex+i.origColspan-1),o&&(t.col=o.columnIndex)):t.col>=e.col&&(i&&(e.col=i.columnIndex),o&&(t.col=o.columnIndex+o.origColspan-1))}function _onAfterGetColumnHeaderRenderers(e){e.length=0;for(let t=0;t<_classPrivateFieldGet50(_stateManager,this).getLayersCount();t++)e.push(this.headerRendererFactory(t))}function _onAfterViewportColumnCalculatorOverride2(e){const t=_classPrivateFieldGet50(_stateManager,this).getLayersCount();let r=e.startColumn,i=!!t;for(let o=0;o<t;o++){const a=_classPrivateFieldGet50(_stateManager,this).findLeftMostColumnIndex(o,e.startColumn),c=this.hot.columnIndexMapper.getRenderableFromVisualIndex(a);if(a>=0&&(i=!1),isNumeric(c)&&c<e.startColumn){r=c;break}}e.startColumn=i?_classPrivateFieldGet50(_stateManager,this).getHeaderTreeNodeData(0,r).columnIndex:r}function _onModifyColWidth3(e,t){const r=this.ghostTable.getWidth(t);return e>r?e:r}function _onModifyColumnHeaderValue(e,t,r){var i;const{label:o}=(i=_classPrivateFieldGet50(_stateManager,this).getHeaderTreeNodeData(r,t))!==null&&i!==void 0?i:{label:""};return o}function _onModifyFocusedElement(e,t){if(e<0)return this.hot.getCell(e,_classPrivateFieldGet50(_stateManager,this).findLeftMostColumnIndex(e,t),!0)}function _onInit4(){this.updatePlugin()}function _onAfterLoadData8(e,t){t||this.updatePlugin()}var import_es_error_cause171=__toESM(require_es_error_cause(),1),import_es_array_push106=__toESM(require_es_array_push(),1),import_es_set_difference_v226=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v226=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v226=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v226=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v226=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v226=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v226=__toESM(require_es_set_union_v2(),1),import_es_error_cause167=__toESM(require_es_error_cause(),1),import_es_array_push103=__toESM(require_es_array_push(),1);function _defineProperty111(e,t,r){return(t=_toPropertyKey111(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey111(e){var t=_toPrimitive111(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive111(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DataManager=class{constructor(e,t){_defineProperty111(this,"hot",void 0),_defineProperty111(this,"data",null),_defineProperty111(this,"plugin",void 0),_defineProperty111(this,"parentReference",new WeakMap),_defineProperty111(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=t,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},rangeEach(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,r){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&arrayEach(e.__children,i=>{this.cacheNode(i,t+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,t,r,i){let o=!1,a=t;if(isNaN(a)&&a.end)return a;let c=e;return c||(c={__children:this.data},o=!0,a-=1),r!=null&&a===r?{result:c,end:!0}:i!=null&&c===i?{result:a,end:!0}:(a+=1,c.__children&&arrayEach(c.__children,u=>{if(this.parentReference.set(u,o?null:c),a=this.readTreeNodes(u,a,r,i),isNaN(a)&&a.end)return!1}),a)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return objectEach(this.data[0],(t,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;isNaN(e)?t=e:t=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(t):r.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(arrayEach(r.__children,i=>{t+=1,i.__children&&(t+=this.countChildren(i))}),t)}getRowParent(e){let t;return isNaN(e)?t=e:t=this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let t=null;return isNaN(e)?t=e:t=this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!!(t.__children&&t.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,t){var r;return((r=e.__children)===null||r===void 0?void 0:r[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((t=r.__children)===null||t===void 0?void 0:t.length)!==0}addChild(e,t){let r=t;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const a=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(a,1),this.hot.runHooks("afterCreateRow",a,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,t,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,t),e){const c=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",c,1),e.__children.splice(t,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(c,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",c,1),o=c}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[t]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,t)}addSibling(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(t){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break;default:break}}detachFromParent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(rangeEach(e[0],e[2],m=>{const g=this.translateTrimmedRow(m);i.push(this.getDataObject(g))}),rangeEach(0,i.length-2,m=>{this.detachFromParent(i[m],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),a=this.countChildren(r),c=this.getRowIndexWithinParent(r),u=this.getRowParent(r),h=this.getRowParent(u),d=this.getRowIndex(h);let f=null;if(this.hot.runHooks("beforeDetachChild",u,r),c!=null){const m=Array.from(new Array(o+a+1).keys()).splice(-1*(a+1));if(this.hot.runHooks("beforeRemoveRow",o,a+1,m,this.plugin.pluginName),u.__children.splice(c,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,a+1,m,this.plugin.pluginName),h){f=d+this.countChildren(h);const g=this.getChild(h,this.countChildren(h)-1),v=this.getRowIndex(g);this.hot.runHooks("beforeCreateRow",v+1,a+1,this.plugin.pluginName),h.__children.push(r)}else f=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",f-2,a+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",f-2,a+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",u,r,this.getRowIndex(r)),t&&this.hot.render()}filterData(e,t,r){const i=[];arrayEach(r,o=>{i.push(this.getDataObject(o))}),arrayEach(i,o=>{const a=this.getRowIndexWithinParent(o),c=this.getRowParent(o);c===null?this.data.splice(a,1):c.__children.splice(a,1)}),this.rewriteCache()}spliceData(e,t,r){const i=this.getDataObject(e-1);let o=null,a=e;i&&i.__children&&i.__children.length===0?(o=i,a=0):e<this.countAllRows()&&(o=this.getRowParent(e),a=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(a,t,...r):o.__children.splice(a,t):r?this.data.splice(a,t,...r):this.data.splice(a,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,r=null;do r=this.getRowParent(r),r!==null&&(t=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,r,i){const o=t===this.hot.countRows(),a=this.getRowParent(e),c=this.getRowIndexWithinParent(e),u=a.__children.slice(c,c+1),h=e>t;let d=o?this.getRowParent(t-1):this.getRowParent(t);d==null&&(d=this.getRowParent(t-1)),d==null&&(d=this.getDataObject(t-1)),d?d.__children||(d.__children=[]):(d=this.getDataObject(t),d.__children=[]);const f=o||r||i?d.__children.length:this.getRowIndexWithinParent(t),m=a===d;d.__children.splice(f,0,u[0]),a.__children.splice(c+(h&&m?1:0),1),this.syncRowWithRawSource(a),m||this.syncRowWithRawSource(d)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}},dataManager_default=DataManager,import_es_array_push104=__toESM(require_es_array_push(),1),import_es_error_cause168=__toESM(require_es_error_cause(),1);function _defineProperty112(e,t,r){return(t=_toPropertyKey112(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey112(e){var t=_toPrimitive112(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive112(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BaseUI4=class{constructor(e,t){_defineProperty112(this,"hot",void 0),_defineProperty112(this,"plugin",void 0),this.hot=t,this.plugin=e}},base_default5=BaseUI4,HeadersUI=class lr extends base_default5{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(t,r){super(t,r),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(t,r){const i=this.hot.toPhysicalRow(t),o=this.dataManager.getRowLevel(i),a=this.dataManager.getDataObject(i),c=r.getElementsByTagName("DIV")[0],u=c.querySelector("span.rowHeader"),h=c.querySelectorAll('[class^="ht_nesting"]'),d=this.hot.getSettings().ariaTags;if(arrayEach(h,f=>{f&&c.removeChild(f)}),addClass(r,lr.CSS_CLASSES.indicatorContainer),o){const{rootDocument:f}=this.hot,m=u.cloneNode(!0);c.innerHTML="",rangeEach(0,o-1,()=>{const g=f.createElement("SPAN");addClass(g,lr.CSS_CLASSES.emptyIndicator),c.appendChild(g)}),c.appendChild(m)}if(this.dataManager.hasChildren(a)){const f=this.hot.rootDocument.createElement("DIV");d&&setAttribute(f,[A11Y_HIDDEN()]),addClass(r,lr.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?(addClass(f,`${lr.CSS_CLASSES.button} ${lr.CSS_CLASSES.expandButton}`),d&&setAttribute(r,[A11Y_EXPANDED(!1)])):(addClass(f,`${lr.CSS_CLASSES.button} ${lr.CSS_CLASSES.collapseButton}`),d&&setAttribute(r,[A11Y_EXPANDED(!0)])),c.appendChild(f)}}updateRowHeaderWidth(t){let r=t;r||(r=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*r+25),this.hot.render()}},headers_default=HeadersUI,CollapsingUI=class extends base_default5{constructor(e,t){var r;super(e,t),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),arrayEach(r.lastCollapsedRows,(c,u)=>{c>=i&&c<o&&(r.lastCollapsedRows[u]=c+a)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{rangeEach(i,i+o-1,a=>{const c=this.lastCollapsedRows.indexOf(a);c>-1&&this.lastCollapsedRows.splice(c,1)})}}}collapseChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,a=null,c=null;return isNaN(e)?(o=e,a=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),a=e),this.dataManager.hasChildren(o)&&arrayEach(o.__children,u=>{i.push(this.dataManager.getRowIndex(u))}),c=this.collapseRows(i,!0,!1),r&&this.trimRows(c),t&&this.renderAndAdjust(),this.collapsedRows.indexOf(a)===-1&&this.collapsedRows.push(a),c}collapseMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];arrayEach(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),t&&this.renderAndAdjust()}collapseRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],t)}collapseRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return arrayEach(e,o=>{i.push(o),t&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const o=this.dataManager.getDataObject(e);arrayEach(o.__children,a=>{const c=this.dataManager.getRowIndex(a);t.push(c),this.collapseChildRows(c,t)})}i&&this.trimRows(t)}expandRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],t)}expandRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return arrayEach(e,o=>{i.push(o),t&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const o=this.dataManager.getDataObject(e);arrayEach(o.__children,a=>{if(!this.isAnyParentCollapsed(a)){const c=this.dataManager.getRowIndex(a);t.push(c),this.expandChildRows(c,t)}})}i&&this.untrimRows(t)}expandChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,a=null,c=null;return isNaN(e)?(o=e,a=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),a=e),this.collapsedRows.splice(this.collapsedRows.indexOf(a),1),this.dataManager.hasChildren(o)&&arrayEach(o.__children,u=>{const h=this.dataManager.getRowIndex(u);i.push(h)}),c=this.expandRows(i,!0,!1),r&&this.untrimRows(c),t&&this.renderAndAdjust(),c}expandMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];arrayEach(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];arrayEach(e,r=>{this.dataManager.hasChildren(r)&&t.push(r)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];arrayEach(e,r=>{this.dataManager.hasChildren(r)&&t.push(r)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{arrayEach(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{arrayEach(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return t===null&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&arrayEach(t.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let t=e;for(;t!==null;){t=this.dataManager.getRowParent(t);const r=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const r=this.translateTrimmedRow(t.row);hasClass(e.target,headers_default.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),stopImmediatePropagation(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}},collapsing_default=CollapsingUI,import_es_error_cause169=__toESM(require_es_error_cause(),1);function _classPrivateFieldInitSpec51(e,t,r){_checkPrivateRedeclaration67(e,t),t.set(e,r)}function _checkPrivateRedeclaration67(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty113(e,t,r){return(t=_toPropertyKey113(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey113(e){var t=_toPrimitive113(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive113(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet51(e,t){return e.get(_assertClassBrand67(e,t))}function _assertClassBrand67(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var _menuEntries=new WeakMap,ContextMenuUI=class extends base_default5{constructor(){super(...arguments),_defineProperty113(this,"dataManager",this.plugin.dataManager),_classPrivateFieldInitSpec51(this,_menuEntries,{row_above:(e,t)=>{const r=t[t.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,t)=>{const r=t[t.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return rangeEach(0,e.items.length-1,r=>{if(r===0)return arrayEach(t,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return rangeEach(0,e.items.length-1,t=>{const r=_classPrivateFieldGet51(_menuEntries,this)[e.items[t].key];r!=null&&(e.items[t].callback=r)}),e}},contextMenu_default=ContextMenuUI,import_es_error_cause170=__toESM(require_es_error_cause(),1),import_es_array_push105=__toESM(require_es_array_push(),1);function _defineProperty114(e,t,r){return(t=_toPropertyKey114(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey114(e){var t=_toPrimitive114(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive114(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RowMoveController=class{constructor(e){_defineProperty114(this,"plugin",void 0),_defineProperty114(this,"hot",void 0),_defineProperty114(this,"dataManager",void 0),_defineProperty114(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const a=r===this.hot.countRows(),c=a?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let u=!0;const h=e.map(v=>{if(!u)return!1;const _=this.dataManager.translateTrimmedRow(v);return u=this.shouldAllowMoving(_,c),_}),d=h.indexOf(c)===-1;if(!u||!d)return!1;const f=this.getBaseParent(h),m=this.getTargetParent(a,c),g=f===m;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(m),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(h,c,g),this.moveRows(h,c,m),this.dataManager.rewriteCache(),this.moveCellsMeta(h,c),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,r,i,i&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:r,dropIndex:i,movePossible:o}=e;let a=!1;return isUndefined(i)&&(warn(toSingleLine`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,r,i,o,!1),a=!0),a}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||t===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let r=this.dataManager.getRowParent(e?t-1:t);return r==null&&(r=this.dataManager.getRowParent(t-1)),r}shiftCollapsibleParentsLocations(e,t,r){r||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,r){const i=t===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,t,this.movedToCollapsed,i)})})}moveCellsMeta(e,t){const r=[],i=Math.max(...e)<t;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(i?r.length:0),0,...r)}selectCells(e,t){const r=e.length;let i=0,o=0,a=null,c=null;if(this.movedToCollapsed){let u=null;e[r-1]<t?u=this.dataManager.translateTrimmedRow(t-r):u=this.dataManager.translateTrimmedRow(t);const h=this.dataManager.getRowParent(u===null?this.hot.countSourceRows()-1:u-1),d=this.dataManager.getRowIndex(h);i=this.dataManager.untranslateTrimmedRow(d),o=i}else e[r-1]<t?(o=t-1,i=o-r+1):(i=t,o=i+r-1);a=this.hot.selection,c=this.hot.countCols()-1,a.setRangeStart(this.hot._createCellCoords(i,0)),a.setRangeEnd(this.hot._createCellCoords(o,c),!0)}isRowOrderChanged(e,t){return e.some((r,i)=>r-i!==t)}};function _classPrivateMethodInitSpec46(e,t){_checkPrivateRedeclaration68(e,t),t.add(e)}function _classPrivateFieldInitSpec52(e,t,r){_checkPrivateRedeclaration68(e,t),t.set(e,r)}function _checkPrivateRedeclaration68(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty115(e,t,r){return(t=_toPropertyKey115(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey115(e){var t=_toPrimitive115(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive115(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _classPrivateFieldGet52(e,t){return e.get(_assertClassBrand68(e,t))}function _classPrivateFieldSet48(e,t,r){return e.set(_assertClassBrand68(e,t),r),r}function _assertClassBrand68(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var PLUGIN_KEY29="nestedRows",PLUGIN_PRIORITY28=300,SHORTCUTS_GROUP15=PLUGIN_KEY29,WRONG_DATA_TYPE_ERROR="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",_skipRender=new WeakMap,_skipCoreAPIModifiers=new WeakMap,_NestedRows_brand=new WeakSet,NestedRows=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec46(this,_NestedRows_brand),_defineProperty115(this,"dataManager",null),_defineProperty115(this,"headersUI",null),_defineProperty115(this,"collapsedRowsMap",null),_classPrivateFieldInitSpec52(this,_skipRender,!1),_classPrivateFieldInitSpec52(this,_skipCoreAPIModifiers,!1)}static get PLUGIN_KEY(){return PLUGIN_KEY29}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY28}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY29]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new TrimmingMap),this.dataManager=new dataManager_default(this,this.hot),this.collapsingUI=new collapsing_default(this,this.hot),this.headersUI=new headers_default(this,this.hot),this.contextMenuUI=new contextMenu_default(this,this.hot),this.rowMoveController=new RowMoveController(this),this.addHook("afterInit",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand68(_NestedRows_brand,e,_onAfterInit4).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand68(_NestedRows_brand,e,_onBeforeViewRender).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand68(_NestedRows_brand,e,_onFilterData).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand68(_NestedRows_brand,e,_onAfterContextMenuDefaultOptions5).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand68(_NestedRows_brand,e,_onAfterGetRowHeader2).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand68(_NestedRows_brand,e,_onBeforeOnCellMouseDown7).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand68(_NestedRows_brand,e,_onBeforeRemoveRow2).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand68(_NestedRows_brand,e,_onAfterRemoveRow3).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand68(_NestedRows_brand,e,_onBeforeAddChild).call(e,...r)}),this.addHook("afterAddChild",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand68(_NestedRows_brand,e,_onAfterAddChild).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand68(_NestedRows_brand,e,_onBeforeDetachChild).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand68(_NestedRows_brand,e,_onAfterDetachChild2).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand68(_NestedRows_brand,e,_onModifyRowHeaderWidth).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand68(_NestedRows_brand,e,_onAfterCreateRow3).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return _assertClassBrand68(_NestedRows_brand,e,_onBeforeRowMove).call(e,...r)}),this.addHook("beforeLoadData",t=>_assertClassBrand68(_NestedRows_brand,this,_onBeforeLoadData2).call(this,t)),this.addHook("beforeUpdateData",t=>_assertClassBrand68(_NestedRows_brand,this,_onBeforeLoadData2).call(this,t)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(t)?this.collapsingUI.expandChildren(t):this.collapsingUI.collapseChildren(t),!1},runOnlyIf:()=>{var e,t;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:SHORTCUTS_GROUP15,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP15)}disableCoreAPIModifiers(){_classPrivateFieldSet48(_skipCoreAPIModifiers,this,!0)}enableCoreAPIModifiers(){_classPrivateFieldSet48(_skipCoreAPIModifiers,this,!1)}onModifyRowData(e){if(!_classPrivateFieldGet52(_skipCoreAPIModifiers,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!_classPrivateFieldGet52(_skipCoreAPIModifiers,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,r){return _classPrivateFieldGet52(_skipCoreAPIModifiers,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,t,r),!1)}destroy(){super.destroy()}};function _onBeforeRowMove(e,t,r,i){return this.rowMoveController.onBeforeRowMove(e,t,r,i)}function _onBeforeOnCellMouseDown7(e,t,r){this.collapsingUI.toggleState(e,t,r)}function _onFilterData(e,t,r){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(r[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(r[0],null,-1*t),this.dataManager.filterData(e,t,r),_classPrivateFieldSet48(_skipRender,this,!0),this.dataManager.getData().slice()}function _onAfterContextMenuDefaultOptions5(e){return this.contextMenuUI.appendOptions(e)}function _onAfterGetRowHeader2(e,t){this.headersUI.appendLevelIndicators(e,t)}function _onModifyRowHeaderWidth(e){return Math.max(this.headersUI.rowHeaderWidthCache,e)}function _onAfterRemoveRow3(e,t,r,i){i!==this.pluginName&&this.hot._registerTimeout(()=>{_classPrivateFieldSet48(_skipRender,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function _onBeforeRemoveRow2(e,t,r){const i=Array.from(r.reduce((o,a)=>{if(this.dataManager.isParent(a)){const c=this.dataManager.getDataObject(a).__children;return o.add(a),Array.isArray(c)&&c.forEach(u=>o.add(this.dataManager.getRowIndex(u))),o}return o.add(a)},new Set));r.length=0,r.push(...i)}function _onBeforeAddChild(){this.collapsingUI.collapsedRowsStash.stash()}function _onAfterAddChild(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function _onBeforeDetachChild(){this.collapsingUI.collapsedRowsStash.stash()}function _onAfterDetachChild2(e,t,r){this.collapsingUI.collapsedRowsStash.shiftStash(r,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function _onAfterCreateRow3(){this.dataManager.rewriteCache()}function _onAfterInit4(){this.headersUI.updateRowHeaderWidth()}function _onBeforeViewRender(e,t){_classPrivateFieldGet52(_skipRender,this)&&(t.skipRender=!0)}function _onBeforeLoadData2(e){if(!isArrayOfObjects(e)){error(WRONG_DATA_TYPE_ERROR),this.hot.getSettings()[PLUGIN_KEY29]=!1,this.disablePlugin();return}this.dataManager.setData(e),this.dataManager.rewriteCache()}var import_es_error_cause173=__toESM(require_es_error_cause(),1),import_es_error_cause172=__toESM(require_es_error_cause(),1),import_es_array_push107=__toESM(require_es_array_push(),1),import_es_json_stringify3=__toESM(require_es_json_stringify(),1);function _defineProperty116(e,t,r){return(t=_toPropertyKey116(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey116(e){var t=_toPrimitive116(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive116(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Storage=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;_defineProperty116(this,"rootWindow",void 0),_defineProperty116(this,"prefix",void 0),_defineProperty116(this,"savedKeys",[]),this.rootWindow=t,this.prefix=e,this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const r=typeof e>"u"?t:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){arrayEach(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}},storage_default=Storage;function _defineProperty117(e,t,r){return(t=_toPropertyKey117(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey117(e){var t=_toPrimitive117(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive117(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}pluginHooks_default.getSingleton().register("persistentStateSave"),pluginHooks_default.getSingleton().register("persistentStateLoad"),pluginHooks_default.getSingleton().register("persistentStateReset");var PLUGIN_KEY30="persistentState",PLUGIN_PRIORITY29=0,PersistentState=class extends BasePlugin{constructor(){super(...arguments),_defineProperty117(this,"storage",void 0)}static get PLUGIN_KEY(){return PLUGIN_KEY30}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY29}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY30]}enablePlugin(){this.enabled||(this.storage||(this.storage=new storage_default(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}},import_es_error_cause174=__toESM(require_es_error_cause(),1),import_es_array_push108=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec47(e,t){_checkPrivateRedeclaration69(e,t),t.add(e)}function _checkPrivateRedeclaration69(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty118(e,t,r){return(t=_toPropertyKey118(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey118(e){var t=_toPrimitive118(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive118(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand69(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var PLUGIN_KEY31="search",PLUGIN_PRIORITY30=190,DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",DEFAULT_CALLBACK=function(e,t,r,i,o){e.getCellMeta(t,r).isSearchResult=o},DEFAULT_QUERY_METHOD=function(e,t,r){return isUndefined(e)||e===null||!e.toLocaleLowerCase||e.length===0||isUndefined(t)||t===null?!1:t.toString().toLocaleLowerCase(r.locale).indexOf(e.toLocaleLowerCase(r.locale))!==-1},_Search_brand=new WeakSet,Search=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec47(this,_Search_brand),_defineProperty118(this,"callback",DEFAULT_CALLBACK),_defineProperty118(this,"queryMethod",DEFAULT_QUERY_METHOD),_defineProperty118(this,"searchResultClass",DEFAULT_SEARCH_RESULT_CLASS)}static get PLUGIN_KEY(){return PLUGIN_KEY31}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY30}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY31]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[PLUGIN_KEY31];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand69(_Search_brand,e,_onBeforeRenderer).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _assertClassBrand69(_Search_brand,e,_onBeforeRenderer).call(e,...i)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),a=[],c=this.hot;return rangeEach(0,i-1,u=>{rangeEach(0,o-1,h=>{const d=this.hot.getDataAtCell(u,h),f=this.hot.getCellMeta(u,h),m=f.search.callback||t,v=(f.search.queryMethod||r)(e,d,f);if(v){const _={row:u,col:h,data:d};a.push(_)}m&&m(c,u,h,d,v)})}),a}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){isObject2(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}};function _onBeforeRenderer(e,t,r,i,o,a){const c=a.className||[];let u=[];typeof c=="string"?u=c.split(" "):u.push(...c),this.isEnabled()&&a.isSearchResult?u.includes(this.searchResultClass)||u.push(`${this.searchResultClass}`):u.includes(this.searchResultClass)&&u.splice(u.indexOf(this.searchResultClass),1),a.className=u.join(" ")}var import_es_error_cause175=__toESM(require_es_error_cause(),1),import_es_array_push109=__toESM(require_es_array_push(),1);function _classPrivateMethodInitSpec48(e,t){_checkPrivateRedeclaration70(e,t),t.add(e)}function _checkPrivateRedeclaration70(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty119(e,t,r){return(t=_toPropertyKey119(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey119(e){var t=_toPrimitive119(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive119(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand70(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var PLUGIN_KEY32="touchScroll",PLUGIN_PRIORITY31=200,_TouchScroll_brand=new WeakSet,TouchScroll=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec48(this,_TouchScroll_brand),_defineProperty119(this,"scrollbars",[]),_defineProperty119(this,"clones",[]),_defineProperty119(this,"lockedCollection",!1),_defineProperty119(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY32}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY31}static get SETTING_KEYS(){return!0}isEnabled(){return isTouchSupported()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>_assertClassBrand70(_TouchScroll_brand,this,_onAfterViewRender).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>_assertClassBrand70(_TouchScroll_brand,this,_onBeforeTouchScroll).call(this)),this.addHook("afterMomentumScroll",()=>_assertClassBrand70(_TouchScroll_brand,this,_onAfterMomentumScroll).call(this))}};function _onAfterViewRender(){if(this.lockedCollection)return;const{topOverlay:e,bottomOverlay:t,inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),t.clone&&this.scrollbars.push(t),this.scrollbars.push(r),i&&this.scrollbars.push(i),o&&o.clone&&this.scrollbars.push(o),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),o&&o.clone&&this.clones.push(o.clone.wtTable.holder.parentNode)}function _onBeforeTouchScroll(){this.freezeOverlays=!0,arrayEach(this.clones,e=>{addClass(e,"hide-tween")})}function _onAfterMomentumScroll(){this.freezeOverlays=!1,arrayEach(this.clones,e=>{removeClass(e,"hide-tween"),addClass(e,"show-tween")}),this.hot._registerTimeout(()=>{arrayEach(this.clones,e=>{removeClass(e,"show-tween")})},400),arrayEach(this.scrollbars,e=>{e.refresh(),e.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}var import_es_error_cause176=__toESM(require_es_error_cause(),1),import_es_array_push110=__toESM(require_es_array_push(),1),import_es_set_difference_v227=__toESM(require_es_set_difference_v2(),1),import_es_set_intersection_v227=__toESM(require_es_set_intersection_v2(),1),import_es_set_is_disjoint_from_v227=__toESM(require_es_set_is_disjoint_from_v2(),1),import_es_set_is_subset_of_v227=__toESM(require_es_set_is_subset_of_v2(),1),import_es_set_is_superset_of_v227=__toESM(require_es_set_is_superset_of_v2(),1),import_es_set_symmetric_difference_v227=__toESM(require_es_set_symmetric_difference_v2(),1),import_es_set_union_v227=__toESM(require_es_set_union_v2(),1);function _classPrivateMethodInitSpec49(e,t){_checkPrivateRedeclaration71(e,t),t.add(e)}function _checkPrivateRedeclaration71(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty120(e,t,r){return(t=_toPropertyKey120(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey120(e){var t=_toPrimitive120(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive120(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _assertClassBrand71(e,t,r){if(typeof e=="function"?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var PLUGIN_KEY33="trimRows",PLUGIN_PRIORITY32=330,_TrimRows_brand=new WeakSet,TrimRows=class extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec49(this,_TrimRows_brand),_defineProperty120(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return PLUGIN_KEY33}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY32}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY33]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new TrimmingMap),this.trimmedRowsMap.addLocalHook("init",()=>_assertClassBrand71(_TrimRows_brand,this,_onMapInit5).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[PLUGIN_KEY33];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),arrayEach(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),r=this.isValidConfig(e);let i=t;r&&(i=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeTrimRow",t,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{arrayEach(e,a=>{this.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),this.hot.runHooks("afterTrimRow",t,i,r,r&&i.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),r=this.isValidConfig(e);let i=t;const o=this.trimmedRowsMap.getValues().slice(),a=e.length>0;r&&a&&(arrayEach(e,u=>{o[u]=!1}),i=arrayReduce(o,(u,h,d)=>(h&&u.push(d),u),[])),this.hot.runHooks("beforeUntrimRow",t,i,r&&a)!==!1&&(r&&a&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",t,i,r&&a,r&&i.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<t)}destroy(){super.destroy()}};function _onMapInit5(){const e=this.hot.getSettings()[PLUGIN_KEY33];Array.isArray(e)&&this.hot.batchExecution(()=>{arrayEach(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0)}var import_es_array_push111=__toESM(require_es_array_push(),1),import_es_object_from_entries=__toESM(require_es_object_from_entries(),1),SHORTCUTS_GROUP16="undoRedo",PLUGIN_KEY34="undoRedo";function UndoRedo(e){const t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",function(i,o){const a=i&&i.length;if(!a||!i.find(h=>{const[,,d,f]=h;return d!==f}))return;const u=()=>{const h=i.reduce((f,m)=>(f.push([...m]),f),[]);arrayEach(h,f=>{f[1]=e.propToCol(f[1])});const d=a>1?this.getSelected():[[h[0][0],h[0][1]]];return new UndoRedo.ChangeAction(h,d)};t.done(u,o)}),e.addHook("afterCreateRow",(i,o,a)=>{t.done(()=>new UndoRedo.CreateRowAction(i,o),a)});const r=(i,o,a,c)=>{const u=["visualRow","visualCol","row","col","prop"],h=u.length,d=[];return rangeEach(a,c,f=>{rangeEach(i,o,m=>{const g=e.getCellMeta(m,f);if(Object.keys(g).length!==h){const v=Object.fromEntries(Object.entries(g).filter(_=>{let[b]=_;return u.includes(b)===!1}));d.push([g.visualRow,g.visualCol,v])}})}),d};e.addHook("beforeRemoveRow",(i,o,a,c)=>{const u=()=>{const h=e.toPhysicalRow(i),d=h+o-1,f=deepClone(t.instance.getSourceData(h,0,h+o-1,t.instance.countSourceCols()-1));return new UndoRedo.RemoveRowAction(h,f,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence(),r(h,d,0,e.countCols()-1))};t.done(u,c)}),e.addHook("afterCreateCol",(i,o,a)=>{t.done(()=>new UndoRedo.CreateColumnAction(i,o),a)}),e.addHook("beforeRemoveCol",(i,o,a,c)=>{const u=()=>{const h=t.instance.getSourceDataArray(),d=(t.instance.countCols()+i)%t.instance.countCols(),f=d+o-1,m=[],g=[],v=[];rangeEach(h.length-1,S=>{const R=[],A=h[S];rangeEach(d,f,I=>{R.push(A[e.toPhysicalColumn(I)])}),m.push(R)}),rangeEach(o-1,S=>{v.push(e.toPhysicalColumn(d+S))}),Array.isArray(e.getSettings().colHeaders)&&rangeEach(o-1,S=>{g.push(e.getSettings().colHeaders[e.toPhysicalColumn(d+S)]||null)});const _=e.columnIndexMapper.getIndexesSequence(),b=e.rowIndexMapper.getIndexesSequence();return new UndoRedo.RemoveColumnAction(d,v,m,g,_,b,e.getSettings().fixedColumnsStart,r(0,e.countRows(),d,f))};t.done(u,c)}),e.addHook("beforeCellAlignment",(i,o,a,c)=>{t.done(()=>new UndoRedo.CellAlignmentAction(i,o,a,c))}),e.addHook("beforeFilter",(i,o)=>{t.done(()=>new UndoRedo.FiltersAction(i,o))}),e.addHook("beforeRowMove",(i,o)=>{i!==!1&&t.done(()=>new UndoRedo.RowMoveAction(i,o))}),e.addHook("beforeColumnMove",(i,o)=>{i!==!1&&t.done(()=>new UndoRedo.ColumnMoveAction(i,o))}),e.addHook("beforeMergeCells",(i,o)=>{o||t.done(()=>new UndoRedo.MergeCellsAction(e,i))}),e.addHook("afterUnmergeCells",(i,o)=>{o||t.done(()=>new UndoRedo.UnmergeCellsAction(e,i))}),e.addHook("beforeColumnSort",(i,o,a)=>{a&&t.done(()=>new UndoRedo.ColumnSortAction(i,o))}),e.addHook("afterInit",()=>{t.init()})}UndoRedo.prototype.done=function(e,t){if(this.ignoreNewActions||t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto")return;const i=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",i,t)===!1)return;const a=e(),c=this.undoneActions.slice();this.doneActions.push(a),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",c),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",c,this.undoneActions.slice())},UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){const e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);const t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=deepClone(t);if(this.instance.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const o=this,a=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",a),t.undo(this.instance,()=>{o.ignoreNewActions=!1,o.undoneActions.push(t)}),this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}},UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){const e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);const t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=deepClone(t);if(this.instance.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const o=this,a=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",a),t.redo(this.instance,()=>{o.ignoreNewActions=!1,o.doneActions.push(t)}),this.instance.runHooks("afterUndoStackChange",a,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}},UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0},UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},UndoRedo.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},UndoRedo.prototype.isEnabled=function(){return this.enabled},UndoRedo.prototype.enable=function(){if(this.isEnabled())return;const e=this.instance;this.enabled=!0,exposeUndoRedoMethods(e),this.registerShortcuts(),e.addHook("afterChange",onAfterChange)},UndoRedo.prototype.disable=function(){if(!this.isEnabled())return;const e=this.instance;this.enabled=!1,removeExposedUndoRedoMethods(e),this.unregisterShortcuts(),e.removeHook("afterChange",onAfterChange)},UndoRedo.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},UndoRedo.Action=function(){},UndoRedo.Action.prototype.undo=function(){},UndoRedo.Action.prototype.redo=function(){},UndoRedo.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"},inherit2(UndoRedo.ChangeAction,UndoRedo.Action),UndoRedo.ChangeAction.prototype.undo=function(e,t){const r=deepClone(this.changes),i=e.countEmptyRows(!0),o=e.countEmptyCols(!0);for(let c=0,u=r.length;c<u;c++)r[c].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(let c=0,u=r.length;c<u;c++){const[h,d]=r[c];e.getSettings().minSpareRows&&h+1+e.getSettings().minSpareRows===e.countRows()&&i===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(h+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&d+1+e.getSettings().minSpareCols===e.countCols()&&o===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(d+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}const a=e.getSelectedLast();if(a!==void 0){const[c,u]=r[0],[h,d]=a,f=e.view.getFirstFullyVisibleRow(),m=e.view.getFirstFullyVisibleColumn(),g=c>=f,v=u>=m;if((g&&v)===!1&&(h!==c||d!==u)===!0){const S={row:c,col:u};g===!1&&(S.verticalSnap="top"),v===!1&&(S.horizontalSnap="start"),e.scrollViewportTo(S)}}e.selectCells(this.selected,!1,!1)},UndoRedo.ChangeAction.prototype.redo=function(e,t){const r=deepClone(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)},UndoRedo.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"},inherit2(UndoRedo.CreateRowAction,UndoRedo.Action),UndoRedo.CreateRowAction.prototype.undo=function(e,t){const r=e.countRows(),i=e.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},UndoRedo.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},UndoRedo.RemoveRowAction=function(e,t,r,i,o,a){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=i,this.rowIndexesSequence=o,this.removedCellMetas=a},inherit2(UndoRedo.RemoveRowAction,UndoRedo.Action),UndoRedo.RemoveRowAction.prototype.undo=function(e,t){const r=e.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,a)=>{Object.keys(o).forEach(c=>{const u=parseInt(c,10);i.push([this.index+a,isNaN(u)?c:u,o[c]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(o=>{let[a,c,u]=o;e.setCellMetaObject(a,c,u)}),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},UndoRedo.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},UndoRedo.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"},inherit2(UndoRedo.CreateColumnAction,UndoRedo.Action),UndoRedo.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},UndoRedo.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},UndoRedo.RemoveColumnAction=function(e,t,r,i,o,a,c,u){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=i,this.columnPositions=o.slice(0),this.rowPositions=a.slice(0),this.actionType="remove_col",this.fixedColumnsStart=c,this.removedCellMetas=u},inherit2(UndoRedo.RemoveColumnAction,UndoRedo.Action),UndoRedo.RemoveColumnAction.prototype.undo=function(e,t){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(d,f,m)=>m[this.indexes.indexOf(i[f])],a=this.data.length,c=[];for(let d=0;d<a;d++)c.push(arrayMap(this.data[d],o));const u=arrayMap(this.headers,o),h=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),arrayEach(e.getSourceDataArray(),(d,f)=>{arrayEach(i,(m,g)=>{d[m]=c[f][g],h.push([f,m,d[m]])})}),e.setSourceDataAtCell(h,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&arrayEach(u,(d,f)=>{e.getSettings().colHeaders[i[f]]=d}),this.removedCellMetas.forEach(d=>{let[f,m,g]=d;e.setCellMetaObject(f,m,g)}),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),e.addHookOnce("afterViewRender",t),e.render()},UndoRedo.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},UndoRedo.CellAlignmentAction=function(e,t,r,i){this.stateBefore=e,this.range=t,this.type=r,this.alignment=i},UndoRedo.CellAlignmentAction.prototype.undo=function(e,t){arrayEach(this.range,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()},UndoRedo.CellAlignmentAction.prototype.redo=function(e,t){align(this.range,this.type,this.alignment,(r,i)=>e.getCellMeta(r,i),(r,i,o,a)=>e.setCellMeta(r,i,o,a)),e.addHookOnce("afterViewRender",t),e.render()},UndoRedo.FiltersAction=function(e,t){this.previousConditionsStack=t,this.conditionsStack=e,this.actionType="filter"},inherit2(UndoRedo.FiltersAction,UndoRedo.Action),UndoRedo.FiltersAction.prototype.undo=function(e,t){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),this.previousConditionsStack&&r.conditionCollection.importAllConditions(this.previousConditionsStack),r.filter()},UndoRedo.FiltersAction.prototype.redo=function(e,t){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var MergeCellsAction=class extends UndoRedo.Action{constructor(e,t){super(),this.cellRange=t;const r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.mergeRange(this.cellRange)}};UndoRedo.MergeCellsAction=MergeCellsAction;var UnmergeCellsAction=class extends UndoRedo.Action{constructor(e,t){super(),this.cellRange=t}undo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.mergeRange(this.cellRange,!0)}redo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.unmergeRange(this.cellRange,!0),e.render()}};UndoRedo.UnmergeCellsAction=UnmergeCellsAction,UndoRedo.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalRowIndex=t,this.actionType="row_move"},inherit2(UndoRedo.RowMoveAction,UndoRedo.Action),UndoRedo.RowMoveAction.prototype.undo=function(e,t){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),getMoves(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:a,to:c}=o;a<c&&(c-=1),r.moveRow(c,a)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},UndoRedo.RowMoveAction.prototype.redo=function(e,t){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)},UndoRedo.ColumnMoveAction=function(e,t){this.columns=e.slice(),this.finalColumnIndex=t,this.actionType="col_move"},inherit2(UndoRedo.ColumnMoveAction,UndoRedo.Action),UndoRedo.ColumnMoveAction.prototype.undo=function(e,t){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t),getMoves(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:a,to:c}=o;a<c&&(c-=1),r.moveColumn(c,a)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)},UndoRedo.ColumnMoveAction.prototype.redo=function(e,t){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)},UndoRedo.ColumnSortAction=function(e,t){this.previousSortState=e,this.nextSortState=t},inherit2(UndoRedo.ColumnSortAction,UndoRedo.Action),UndoRedo.ColumnSortAction.prototype.undo=function(e,t){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:r;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),t()},UndoRedo.ColumnSortAction.prototype.redo=function(e,t){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),t()},UndoRedo.prototype.init=function(){const e=this.instance.getSettings().undo,t=typeof e>"u"||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},UndoRedo.prototype.registerShortcuts=function(){const t=this.instance.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:SHORTCUTS_GROUP16};t.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)},UndoRedo.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP16)};function onAfterChange(e,t){const r=this;if(t==="loadData")return r.undoRedo.clear()}function exposeUndoRedoMethods(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function removeExposedUndoRedoMethods(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var hook=pluginHooks_default.getSingleton();hook.add("afterUpdateSettings",function(){var e;(e=this.getPlugin("undoRedo"))===null||e===void 0||e.init()}),hook.register("beforeUndo"),hook.register("afterUndo"),hook.register("beforeRedo"),hook.register("afterRedo"),UndoRedo.PLUGIN_KEY=PLUGIN_KEY34,UndoRedo.SETTING_KEYS=!0;var undoRedo_default=UndoRedo;function registerAllPlugins(){registerPlugin(AutoColumnSize),registerPlugin(Autofill),registerPlugin(AutoRowSize),registerPlugin(BindRowsWithHeaders),registerPlugin(CollapsibleColumns),registerPlugin(ColumnSorting),registerPlugin(ColumnSummary),registerPlugin(Comments),registerPlugin(ContextMenu),registerPlugin(CopyPaste),registerPlugin(CustomBorders),registerPlugin(DragToScroll),registerPlugin(DropdownMenu),registerPlugin(ExportFile),registerPlugin(Filters),registerPlugin(Formulas),registerPlugin(HiddenColumns),registerPlugin(HiddenRows),registerPlugin(ManualColumnFreeze),registerPlugin(ManualColumnMove),registerPlugin(ManualColumnResize),registerPlugin(ManualRowMove),registerPlugin(ManualRowResize),registerPlugin(MergeCells),registerPlugin(MultiColumnSorting),registerPlugin(MultipleSelectionHandles),registerPlugin(NestedHeaders),registerPlugin(NestedRows),registerPlugin(PersistentState),registerPlugin(Search),registerPlugin(TouchScroll),registerPlugin(TrimRows),registerPlugin(undoRedo_default)}function registerAllModules(){registerAllEditors(),registerAllRenderers(),registerAllValidators(),registerAllCellTypes(),registerAllPlugins()}var import_es_error_cause177=__toESM(require_es_error_cause(),1);function jQueryWrapper(e){const t=typeof window>"u"?!1:window.jQuery;t&&(t.fn.handsontable=function(r){const i=this.first();let o=i.data("handsontable");if(typeof r!="string"){const d=r||{};return o?o.updateSettings(d):(o=new e.Core(i[0],d),i.data("handsontable",o),o.init()),i}let a;if(o)if(typeof o[r]<"u"){for(var c=arguments.length,u=new Array(c>1?c-1:0),h=1;h<c;h++)u[h-1]=arguments[h];a=o[r].call(o,...u),r==="destroy"&&i.removeData()}else throw new Error(`Handsontable do not provide action: ${r}`);return a})}var _Handsontable$cellTyp,_Handsontable$editors,_Handsontable$rendere,_Handsontable$validat,_Handsontable$plugins;registerAllModules(),jQueryWrapper(base_default),base_default.__GhostTable=ghostTable_default,base_default._getListenersCounter=getListenersCounter,base_default._getRegisteredMapsCounter=getRegisteredMapsCounter,base_default.EventManager=eventManager_default;var HELPERS=[array_exports,browser_exports,data_exports,date_exports,feature_exports,function_exports,mixed_exports,number_exports,object_exports,string_exports,unicode_exports,parseTable_exports],DOM=[element_exports,event_exports];base_default.helper={},base_default.dom={},arrayEach(HELPERS,e=>{arrayEach(Object.getOwnPropertyNames(e),t=>{t.charAt(0)!=="_"&&(base_default.helper[t]=e[t])})}),arrayEach(DOM,e=>{arrayEach(Object.getOwnPropertyNames(e),t=>{t.charAt(0)!=="_"&&(base_default.dom[t]=e[t])})}),base_default.cellTypes=(_Handsontable$cellTyp=base_default.cellTypes)!==null&&_Handsontable$cellTyp!==void 0?_Handsontable$cellTyp:{},arrayEach(getNames4(),e=>{base_default.cellTypes[e]=_getItem4(e)}),base_default.cellTypes.registerCellType=_register4,base_default.cellTypes.getCellType=_getItem4,base_default.editors=(_Handsontable$editors=base_default.editors)!==null&&_Handsontable$editors!==void 0?_Handsontable$editors:{},arrayEach(getNames(),e=>{base_default.editors[`${toUpperCaseFirst(e)}Editor`]=_getItem(e)}),base_default.editors.registerEditor=_register,base_default.editors.getEditor=_getItem,base_default.renderers=(_Handsontable$rendere=base_default.renderers)!==null&&_Handsontable$rendere!==void 0?_Handsontable$rendere:{},arrayEach(getNames2(),e=>{const t=_getItem2(e);e==="base"&&(base_default.renderers.cellDecorator=t),base_default.renderers[`${toUpperCaseFirst(e)}Renderer`]=t}),base_default.renderers.registerRenderer=_register2,base_default.renderers.getRenderer=_getItem2,base_default.validators=(_Handsontable$validat=base_default.validators)!==null&&_Handsontable$validat!==void 0?_Handsontable$validat:{},arrayEach(getNames3(),e=>{base_default.validators[`${toUpperCaseFirst(e)}Validator`]=_getItem3(e)}),base_default.validators.registerValidator=_register3,base_default.validators.getValidator=_getItem3,base_default.plugins=(_Handsontable$plugins=base_default.plugins)!==null&&_Handsontable$plugins!==void 0?_Handsontable$plugins:{},arrayEach(getPluginsNames(),e=>{base_default.plugins[e]=getPlugin(e)}),base_default.plugins[`${toUpperCaseFirst(BasePlugin.PLUGIN_KEY)}Plugin`]=BasePlugin,base_default.plugins.registerPlugin=registerPlugin,base_default.plugins.getPlugin=getPlugin;var handsontable_default=base_default,LuxonError=class extends Error{},InvalidDateTimeError=class extends LuxonError{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}},InvalidIntervalError=class extends LuxonError{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}},InvalidDurationError=class extends LuxonError{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}},ConflictingSpecificationError=class extends LuxonError{},InvalidUnitError=class extends LuxonError{constructor(e){super(`Invalid unit ${e}`)}},InvalidArgumentError=class extends LuxonError{},ZoneIsAbstractError=class extends LuxonError{constructor(){super("Zone is an abstract class")}},n="numeric",s="short",l="long",DATE_SHORT={year:n,month:n,day:n},DATE_MED={year:n,month:s,day:n},DATE_MED_WITH_WEEKDAY={year:n,month:s,day:n,weekday:s},DATE_FULL={year:n,month:l,day:n},DATE_HUGE={year:n,month:l,day:n,weekday:l},TIME_SIMPLE={hour:n,minute:n},TIME_WITH_SECONDS={hour:n,minute:n,second:n},TIME_WITH_SHORT_OFFSET={hour:n,minute:n,second:n,timeZoneName:s},TIME_WITH_LONG_OFFSET={hour:n,minute:n,second:n,timeZoneName:l},TIME_24_SIMPLE={hour:n,minute:n,hourCycle:"h23"},TIME_24_WITH_SECONDS={hour:n,minute:n,second:n,hourCycle:"h23"},TIME_24_WITH_SHORT_OFFSET={hour:n,minute:n,second:n,hourCycle:"h23",timeZoneName:s},TIME_24_WITH_LONG_OFFSET={hour:n,minute:n,second:n,hourCycle:"h23",timeZoneName:l},DATETIME_SHORT={year:n,month:n,day:n,hour:n,minute:n},DATETIME_SHORT_WITH_SECONDS={year:n,month:n,day:n,hour:n,minute:n,second:n},DATETIME_MED={year:n,month:s,day:n,hour:n,minute:n},DATETIME_MED_WITH_SECONDS={year:n,month:s,day:n,hour:n,minute:n,second:n},DATETIME_MED_WITH_WEEKDAY={year:n,month:s,day:n,weekday:s,hour:n,minute:n},DATETIME_FULL={year:n,month:l,day:n,hour:n,minute:n,timeZoneName:s},DATETIME_FULL_WITH_SECONDS={year:n,month:l,day:n,hour:n,minute:n,second:n,timeZoneName:s},DATETIME_HUGE={year:n,month:l,day:n,weekday:l,hour:n,minute:n,timeZoneName:l},DATETIME_HUGE_WITH_SECONDS={year:n,month:l,day:n,weekday:l,hour:n,minute:n,second:n,timeZoneName:l},Zone=class{get type(){throw new ZoneIsAbstractError}get name(){throw new ZoneIsAbstractError}get ianaName(){return this.name}get isUniversal(){throw new ZoneIsAbstractError}offsetName(e,t){throw new ZoneIsAbstractError}formatOffset(e,t){throw new ZoneIsAbstractError}offset(e){throw new ZoneIsAbstractError}equals(e){throw new ZoneIsAbstractError}get isValid(){throw new ZoneIsAbstractError}},singleton=null,SystemZone=class ms extends Zone{static get instance(){return singleton===null&&(singleton=new ms),singleton}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(t,{format:r,locale:i}){return parseZoneInfo(t,r,i)}formatOffset(t,r){return formatOffset(this.offset(t),r)}offset(t){return-new Date(t).getTimezoneOffset()}equals(t){return t.type==="system"}get isValid(){return!0}},dtfCache={};function makeDTF(e){return dtfCache[e]||(dtfCache[e]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),dtfCache[e]}var typeToPos={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function hackyOffset(e,t){const r=e.format(t).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(r),[,o,a,c,u,h,d,f]=i;return[c,o,a,u,h,d,f]}function partsOffset(e,t){const r=e.formatToParts(t),i=[];for(let o=0;o<r.length;o++){const{type:a,value:c}=r[o],u=typeToPos[a];a==="era"?i[u]=c:isUndefined2(u)||(i[u]=parseInt(c,10))}return i}var ianaZoneCache={},IANAZone=class ci extends Zone{static create(t){return ianaZoneCache[t]||(ianaZoneCache[t]=new ci(t)),ianaZoneCache[t]}static resetCache(){ianaZoneCache={},dtfCache={}}static isValidSpecifier(t){return this.isValidZone(t)}static isValidZone(t){if(!t)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:t}).format(),!0}catch{return!1}}constructor(t){super(),this.zoneName=t,this.valid=ci.isValidZone(t)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(t,{format:r,locale:i}){return parseZoneInfo(t,r,i,this.name)}formatOffset(t,r){return formatOffset(this.offset(t),r)}offset(t){const r=new Date(t);if(isNaN(r))return NaN;const i=makeDTF(this.name);let[o,a,c,u,h,d,f]=i.formatToParts?partsOffset(i,r):hackyOffset(i,r);u==="BC"&&(o=-Math.abs(o)+1);const g=objToLocalTS({year:o,month:a,day:c,hour:h===24?0:h,minute:d,second:f,millisecond:0});let v=+r;const _=v%1e3;return v-=_>=0?_:1e3+_,(g-v)/(60*1e3)}equals(t){return t.type==="iana"&&t.name===this.name}get isValid(){return this.valid}},intlLFCache={};function getCachedLF(e,t={}){const r=JSON.stringify([e,t]);let i=intlLFCache[r];return i||(i=new Intl.ListFormat(e,t),intlLFCache[r]=i),i}var intlDTCache={};function getCachedDTF(e,t={}){const r=JSON.stringify([e,t]);let i=intlDTCache[r];return i||(i=new Intl.DateTimeFormat(e,t),intlDTCache[r]=i),i}var intlNumCache={};function getCachedINF(e,t={}){const r=JSON.stringify([e,t]);let i=intlNumCache[r];return i||(i=new Intl.NumberFormat(e,t),intlNumCache[r]=i),i}var intlRelCache={};function getCachedRTF(e,t={}){const{base:r,...i}=t,o=JSON.stringify([e,i]);let a=intlRelCache[o];return a||(a=new Intl.RelativeTimeFormat(e,t),intlRelCache[o]=a),a}var sysLocaleCache=null;function systemLocale(){return sysLocaleCache||(sysLocaleCache=new Intl.DateTimeFormat().resolvedOptions().locale,sysLocaleCache)}var weekInfoCache={};function getCachedWeekInfo(e){let t=weekInfoCache[e];if(!t){const r=new Intl.Locale(e);t="getWeekInfo"in r?r.getWeekInfo():r.weekInfo,weekInfoCache[e]=t}return t}function parseLocaleString(e){const t=e.indexOf("-x-");t!==-1&&(e=e.substring(0,t));const r=e.indexOf("-u-");if(r===-1)return[e];{let i,o;try{i=getCachedDTF(e).resolvedOptions(),o=e}catch{const h=e.substring(0,r);i=getCachedDTF(h).resolvedOptions(),o=h}const{numberingSystem:a,calendar:c}=i;return[o,a,c]}}function intlConfigString(e,t,r){return(r||t)&&(e.includes("-u-")||(e+="-u"),r&&(e+=`-ca-${r}`),t&&(e+=`-nu-${t}`)),e}function mapMonths(e){const t=[];for(let r=1;r<=12;r++){const i=DateTime.utc(2009,r,1);t.push(e(i))}return t}function mapWeekdays(e){const t=[];for(let r=1;r<=7;r++){const i=DateTime.utc(2016,11,13+r);t.push(e(i))}return t}function listStuff(e,t,r,i){const o=e.listingMode();return o==="error"?null:o==="en"?r(t):i(t)}function supportsFastNumbers(e){return e.numberingSystem&&e.numberingSystem!=="latn"?!1:e.numberingSystem==="latn"||!e.locale||e.locale.startsWith("en")||new Intl.DateTimeFormat(e.intl).resolvedOptions().numberingSystem==="latn"}var PolyNumberFormatter=class{constructor(e,t,r){this.padTo=r.padTo||0,this.floor=r.floor||!1;const{padTo:i,floor:o,...a}=r;if(!t||Object.keys(a).length>0){const c={useGrouping:!1,...r};r.padTo>0&&(c.minimumIntegerDigits=r.padTo),this.inf=getCachedINF(e,c)}}format(e){if(this.inf){const t=this.floor?Math.floor(e):e;return this.inf.format(t)}else{const t=this.floor?Math.floor(e):roundTo(e,3);return padStart(t,this.padTo)}}},PolyDateFormatter=class{constructor(e,t,r){this.opts=r,this.originalZone=void 0;let i;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const a=-1*(e.offset/60),c=a>=0?`Etc/GMT+${a}`:`Etc/GMT${a}`;e.offset!==0&&IANAZone.create(c).valid?(i=c,this.dt=e):(i="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,i=e.zone.name):(i="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const o={...this.opts};o.timeZone=o.timeZone||i,this.dtf=getCachedDTF(t,o)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(t=>{if(t.type==="timeZoneName"){const r=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...t,value:r}}else return t}):e}resolvedOptions(){return this.dtf.resolvedOptions()}},PolyRelFormatter=class{constructor(e,t,r){this.opts={style:"long",...r},!t&&hasRelative()&&(this.rtf=getCachedRTF(e,r))}format(e,t){return this.rtf?this.rtf.format(e,t):formatRelativeTime(t,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]}},fallbackWeekSettings={firstDay:1,minimalDays:4,weekend:[6,7]},Locale=class Qr{static fromOpts(t){return Qr.create(t.locale,t.numberingSystem,t.outputCalendar,t.weekSettings,t.defaultToEN)}static create(t,r,i,o,a=!1){const c=t||Settings2.defaultLocale,u=c||(a?"en-US":systemLocale()),h=r||Settings2.defaultNumberingSystem,d=i||Settings2.defaultOutputCalendar,f=validateWeekSettings(o)||Settings2.defaultWeekSettings;return new Qr(u,h,d,f,c)}static resetCache(){sysLocaleCache=null,intlDTCache={},intlNumCache={},intlRelCache={}}static fromObject({locale:t,numberingSystem:r,outputCalendar:i,weekSettings:o}={}){return Qr.create(t,r,i,o)}constructor(t,r,i,o,a){const[c,u,h]=parseLocaleString(t);this.locale=c,this.numberingSystem=r||u||null,this.outputCalendar=i||h||null,this.weekSettings=o,this.intl=intlConfigString(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=a,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=supportsFastNumbers(this)),this.fastNumbersCached}listingMode(){const t=this.isEnglish(),r=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return t&&r?"en":"intl"}clone(t){return!t||Object.getOwnPropertyNames(t).length===0?this:Qr.create(t.locale||this.specifiedLocale,t.numberingSystem||this.numberingSystem,t.outputCalendar||this.outputCalendar,validateWeekSettings(t.weekSettings)||this.weekSettings,t.defaultToEN||!1)}redefaultToEN(t={}){return this.clone({...t,defaultToEN:!0})}redefaultToSystem(t={}){return this.clone({...t,defaultToEN:!1})}months(t,r=!1){return listStuff(this,t,months,()=>{const i=r?{month:t,day:"numeric"}:{month:t},o=r?"format":"standalone";return this.monthsCache[o][t]||(this.monthsCache[o][t]=mapMonths(a=>this.extract(a,i,"month"))),this.monthsCache[o][t]})}weekdays(t,r=!1){return listStuff(this,t,weekdays,()=>{const i=r?{weekday:t,year:"numeric",month:"long",day:"numeric"}:{weekday:t},o=r?"format":"standalone";return this.weekdaysCache[o][t]||(this.weekdaysCache[o][t]=mapWeekdays(a=>this.extract(a,i,"weekday"))),this.weekdaysCache[o][t]})}meridiems(){return listStuff(this,void 0,()=>meridiems,()=>{if(!this.meridiemCache){const t={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[DateTime.utc(2016,11,13,9),DateTime.utc(2016,11,13,19)].map(r=>this.extract(r,t,"dayperiod"))}return this.meridiemCache})}eras(t){return listStuff(this,t,eras,()=>{const r={era:t};return this.eraCache[t]||(this.eraCache[t]=[DateTime.utc(-40,1,1),DateTime.utc(2017,1,1)].map(i=>this.extract(i,r,"era"))),this.eraCache[t]})}extract(t,r,i){const o=this.dtFormatter(t,r),a=o.formatToParts(),c=a.find(u=>u.type.toLowerCase()===i);return c?c.value:null}numberFormatter(t={}){return new PolyNumberFormatter(this.intl,t.forceSimple||this.fastNumbers,t)}dtFormatter(t,r={}){return new PolyDateFormatter(t,this.intl,r)}relFormatter(t={}){return new PolyRelFormatter(this.intl,this.isEnglish(),t)}listFormatter(t={}){return getCachedLF(this.intl,t)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:hasLocaleWeekInfo()?getCachedWeekInfo(this.locale):fallbackWeekSettings}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(t){return this.locale===t.locale&&this.numberingSystem===t.numberingSystem&&this.outputCalendar===t.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}},singleton2=null,FixedOffsetZone=class en extends Zone{static get utcInstance(){return singleton2===null&&(singleton2=new en(0)),singleton2}static instance(t){return t===0?en.utcInstance:new en(t)}static parseSpecifier(t){if(t){const r=t.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(r)return new en(signedOffset(r[1],r[2]))}return null}constructor(t){super(),this.fixed=t}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${formatOffset(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${formatOffset(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(t,r){return formatOffset(this.fixed,r)}get isUniversal(){return!0}offset(){return this.fixed}equals(t){return t.type==="fixed"&&t.fixed===this.fixed}get isValid(){return!0}},InvalidZone=class extends Zone{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}};function normalizeZone(e,t){let r;if(isUndefined2(e)||e===null)return t;if(e instanceof Zone)return e;if(isString(e)){const i=e.toLowerCase();return i==="default"?t:i==="local"||i==="system"?SystemZone.instance:i==="utc"||i==="gmt"?FixedOffsetZone.utcInstance:FixedOffsetZone.parseSpecifier(i)||IANAZone.create(e)}else return isNumber2(e)?FixedOffsetZone.instance(e):typeof e=="object"&&"offset"in e&&typeof e.offset=="function"?e:new InvalidZone(e)}var numberingSystems={arab:"[\u0660-\u0669]",arabext:"[\u06F0-\u06F9]",bali:"[\u1B50-\u1B59]",beng:"[\u09E6-\u09EF]",deva:"[\u0966-\u096F]",fullwide:"[\uFF10-\uFF19]",gujr:"[\u0AE6-\u0AEF]",hanidec:"[\u3007|\u4E00|\u4E8C|\u4E09|\u56DB|\u4E94|\u516D|\u4E03|\u516B|\u4E5D]",khmr:"[\u17E0-\u17E9]",knda:"[\u0CE6-\u0CEF]",laoo:"[\u0ED0-\u0ED9]",limb:"[\u1946-\u194F]",mlym:"[\u0D66-\u0D6F]",mong:"[\u1810-\u1819]",mymr:"[\u1040-\u1049]",orya:"[\u0B66-\u0B6F]",tamldec:"[\u0BE6-\u0BEF]",telu:"[\u0C66-\u0C6F]",thai:"[\u0E50-\u0E59]",tibt:"[\u0F20-\u0F29]",latn:"\\d"},numberingSystemsUTF16={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},hanidecChars=numberingSystems.hanidec.replace(/[\[|\]]/g,"").split("");function parseDigits(e){let t=parseInt(e,10);if(isNaN(t)){t="";for(let r=0;r<e.length;r++){const i=e.charCodeAt(r);if(e[r].search(numberingSystems.hanidec)!==-1)t+=hanidecChars.indexOf(e[r]);else for(const o in numberingSystemsUTF16){const[a,c]=numberingSystemsUTF16[o];i>=a&&i<=c&&(t+=i-a)}}return parseInt(t,10)}else return t}var digitRegexCache={};function resetDigitRegexCache(){digitRegexCache={}}function digitRegex({numberingSystem:e},t=""){const r=e||"latn";return digitRegexCache[r]||(digitRegexCache[r]={}),digitRegexCache[r][t]||(digitRegexCache[r][t]=new RegExp(`${numberingSystems[r]}${t}`)),digitRegexCache[r][t]}var now2=()=>Date.now(),defaultZone="system",defaultLocale3=null,defaultNumberingSystem=null,defaultOutputCalendar=null,twoDigitCutoffYear=60,throwOnInvalid,defaultWeekSettings=null,Settings2=class{static get now(){return now2}static set now(e){now2=e}static set defaultZone(e){defaultZone=e}static get defaultZone(){return normalizeZone(defaultZone,SystemZone.instance)}static get defaultLocale(){return defaultLocale3}static set defaultLocale(e){defaultLocale3=e}static get defaultNumberingSystem(){return defaultNumberingSystem}static set defaultNumberingSystem(e){defaultNumberingSystem=e}static get defaultOutputCalendar(){return defaultOutputCalendar}static set defaultOutputCalendar(e){defaultOutputCalendar=e}static get defaultWeekSettings(){return defaultWeekSettings}static set defaultWeekSettings(e){defaultWeekSettings=validateWeekSettings(e)}static get twoDigitCutoffYear(){return twoDigitCutoffYear}static set twoDigitCutoffYear(e){twoDigitCutoffYear=e%100}static get throwOnInvalid(){return throwOnInvalid}static set throwOnInvalid(e){throwOnInvalid=e}static resetCaches(){Locale.resetCache(),IANAZone.resetCache(),DateTime.resetCache(),resetDigitRegexCache()}},Invalid=class{constructor(e,t){this.reason=e,this.explanation=t}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}},nonLeapLadder=[0,31,59,90,120,151,181,212,243,273,304,334],leapLadder=[0,31,60,91,121,152,182,213,244,274,305,335];function unitOutOfRange(e,t){return new Invalid("unit out of range",`you specified ${t} (of type ${typeof t}) as a ${e}, which is invalid`)}function dayOfWeek(e,t,r){const i=new Date(Date.UTC(e,t-1,r));e<100&&e>=0&&i.setUTCFullYear(i.getUTCFullYear()-1900);const o=i.getUTCDay();return o===0?7:o}function computeOrdinal(e,t,r){return r+(isLeapYear2(e)?leapLadder:nonLeapLadder)[t-1]}function uncomputeOrdinal(e,t){const r=isLeapYear2(e)?leapLadder:nonLeapLadder,i=r.findIndex(a=>a<t),o=t-r[i];return{month:i+1,day:o}}function isoWeekdayToLocal(e,t){return(e-t+7)%7+1}function gregorianToWeek(e,t=4,r=1){const{year:i,month:o,day:a}=e,c=computeOrdinal(i,o,a),u=isoWeekdayToLocal(dayOfWeek(i,o,a),r);let h=Math.floor((c-u+14-t)/7),d;return h<1?(d=i-1,h=weeksInWeekYear(d,t,r)):h>weeksInWeekYear(i,t,r)?(d=i+1,h=1):d=i,{weekYear:d,weekNumber:h,weekday:u,...timeObject(e)}}function weekToGregorian(e,t=4,r=1){const{weekYear:i,weekNumber:o,weekday:a}=e,c=isoWeekdayToLocal(dayOfWeek(i,1,t),r),u=daysInYear(i);let h=o*7+a-c-7+t,d;h<1?(d=i-1,h+=daysInYear(d)):h>u?(d=i+1,h-=daysInYear(i)):d=i;const{month:f,day:m}=uncomputeOrdinal(d,h);return{year:d,month:f,day:m,...timeObject(e)}}function gregorianToOrdinal(e){const{year:t,month:r,day:i}=e,o=computeOrdinal(t,r,i);return{year:t,ordinal:o,...timeObject(e)}}function ordinalToGregorian(e){const{year:t,ordinal:r}=e,{month:i,day:o}=uncomputeOrdinal(t,r);return{year:t,month:i,day:o,...timeObject(e)}}function usesLocalWeekValues(e,t){if(!isUndefined2(e.localWeekday)||!isUndefined2(e.localWeekNumber)||!isUndefined2(e.localWeekYear)){if(!isUndefined2(e.weekday)||!isUndefined2(e.weekNumber)||!isUndefined2(e.weekYear))throw new ConflictingSpecificationError("Cannot mix locale-based week fields with ISO-based week fields");return isUndefined2(e.localWeekday)||(e.weekday=e.localWeekday),isUndefined2(e.localWeekNumber)||(e.weekNumber=e.localWeekNumber),isUndefined2(e.localWeekYear)||(e.weekYear=e.localWeekYear),delete e.localWeekday,delete e.localWeekNumber,delete e.localWeekYear,{minDaysInFirstWeek:t.getMinDaysInFirstWeek(),startOfWeek:t.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function hasInvalidWeekData(e,t=4,r=1){const i=isInteger(e.weekYear),o=integerBetween(e.weekNumber,1,weeksInWeekYear(e.weekYear,t,r)),a=integerBetween(e.weekday,1,7);return i?o?a?!1:unitOutOfRange("weekday",e.weekday):unitOutOfRange("week",e.weekNumber):unitOutOfRange("weekYear",e.weekYear)}function hasInvalidOrdinalData(e){const t=isInteger(e.year),r=integerBetween(e.ordinal,1,daysInYear(e.year));return t?r?!1:unitOutOfRange("ordinal",e.ordinal):unitOutOfRange("year",e.year)}function hasInvalidGregorianData(e){const t=isInteger(e.year),r=integerBetween(e.month,1,12),i=integerBetween(e.day,1,daysInMonth(e.year,e.month));return t?r?i?!1:unitOutOfRange("day",e.day):unitOutOfRange("month",e.month):unitOutOfRange("year",e.year)}function hasInvalidTimeData(e){const{hour:t,minute:r,second:i,millisecond:o}=e,a=integerBetween(t,0,23)||t===24&&r===0&&i===0&&o===0,c=integerBetween(r,0,59),u=integerBetween(i,0,59),h=integerBetween(o,0,999);return a?c?u?h?!1:unitOutOfRange("millisecond",o):unitOutOfRange("second",i):unitOutOfRange("minute",r):unitOutOfRange("hour",t)}function isUndefined2(e){return typeof e>"u"}function isNumber2(e){return typeof e=="number"}function isInteger(e){return typeof e=="number"&&e%1===0}function isString(e){return typeof e=="string"}function isDate3(e){return Object.prototype.toString.call(e)==="[object Date]"}function hasRelative(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function hasLocaleWeekInfo(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function maybeArray(e){return Array.isArray(e)?e:[e]}function bestBy(e,t,r){if(e.length!==0)return e.reduce((i,o)=>{const a=[t(o),o];return i&&r(i[0],a[0])===i[0]?i:a},null)[1]}function pick(e,t){return t.reduce((r,i)=>(r[i]=e[i],r),{})}function hasOwnProperty2(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function validateWeekSettings(e){if(e==null)return null;if(typeof e!="object")throw new InvalidArgumentError("Week settings must be an object");if(!integerBetween(e.firstDay,1,7)||!integerBetween(e.minimalDays,1,7)||!Array.isArray(e.weekend)||e.weekend.some(t=>!integerBetween(t,1,7)))throw new InvalidArgumentError("Invalid week settings");return{firstDay:e.firstDay,minimalDays:e.minimalDays,weekend:Array.from(e.weekend)}}function integerBetween(e,t,r){return isInteger(e)&&e>=t&&e<=r}function floorMod(e,t){return e-t*Math.floor(e/t)}function padStart(e,t=2){const r=e<0;let i;return r?i="-"+(""+-e).padStart(t,"0"):i=(""+e).padStart(t,"0"),i}function parseInteger(e){if(!(isUndefined2(e)||e===null||e===""))return parseInt(e,10)}function parseFloating(e){if(!(isUndefined2(e)||e===null||e===""))return parseFloat(e)}function parseMillis(e){if(!(isUndefined2(e)||e===null||e==="")){const t=parseFloat("0."+e)*1e3;return Math.floor(t)}}function roundTo(e,t,r=!1){const i=10**t;return(r?Math.trunc:Math.round)(e*i)/i}function isLeapYear2(e){return e%4===0&&(e%100!==0||e%400===0)}function daysInYear(e){return isLeapYear2(e)?366:365}function daysInMonth(e,t){const r=floorMod(t-1,12)+1,i=e+(t-r)/12;return r===2?isLeapYear2(i)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][r-1]}function objToLocalTS(e){let t=Date.UTC(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond);return e.year<100&&e.year>=0&&(t=new Date(t),t.setUTCFullYear(e.year,e.month-1,e.day)),+t}function firstWeekOffset(e,t,r){return-isoWeekdayToLocal(dayOfWeek(e,1,t),r)+t-1}function weeksInWeekYear(e,t=4,r=1){const i=firstWeekOffset(e,t,r),o=firstWeekOffset(e+1,t,r);return(daysInYear(e)-i+o)/7}function untruncateYear(e){return e>99?e:e>Settings2.twoDigitCutoffYear?1900+e:2e3+e}function parseZoneInfo(e,t,r,i=null){const o=new Date(e),a={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};i&&(a.timeZone=i);const c={timeZoneName:t,...a},u=new Intl.DateTimeFormat(r,c).formatToParts(o).find(h=>h.type.toLowerCase()==="timezonename");return u?u.value:null}function signedOffset(e,t){let r=parseInt(e,10);Number.isNaN(r)&&(r=0);const i=parseInt(t,10)||0,o=r<0||Object.is(r,-0)?-i:i;return r*60+o}function asNumber(e){const t=Number(e);if(typeof e=="boolean"||e===""||Number.isNaN(t))throw new InvalidArgumentError(`Invalid unit value ${e}`);return t}function normalizeObject(e,t){const r={};for(const i in e)if(hasOwnProperty2(e,i)){const o=e[i];if(o==null)continue;r[t(i)]=asNumber(o)}return r}function formatOffset(e,t){const r=Math.trunc(Math.abs(e/60)),i=Math.trunc(Math.abs(e%60)),o=e>=0?"+":"-";switch(t){case"short":return`${o}${padStart(r,2)}:${padStart(i,2)}`;case"narrow":return`${o}${r}${i>0?`:${i}`:""}`;case"techie":return`${o}${padStart(r,2)}${padStart(i,2)}`;default:throw new RangeError(`Value format ${t} is out of range for property format`)}}function timeObject(e){return pick(e,["hour","minute","second","millisecond"])}var monthsLong=["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],monthsNarrow=["J","F","M","A","M","J","J","A","S","O","N","D"];function months(e){switch(e){case"narrow":return[...monthsNarrow];case"short":return[...monthsShort];case"long":return[...monthsLong];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}var weekdaysLong=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],weekdaysShort=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],weekdaysNarrow=["M","T","W","T","F","S","S"];function weekdays(e){switch(e){case"narrow":return[...weekdaysNarrow];case"short":return[...weekdaysShort];case"long":return[...weekdaysLong];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}var meridiems=["AM","PM"],erasLong=["Before Christ","Anno Domini"],erasShort=["BC","AD"],erasNarrow=["B","A"];function eras(e){switch(e){case"narrow":return[...erasNarrow];case"short":return[...erasShort];case"long":return[...erasLong];default:return null}}function meridiemForDateTime(e){return meridiems[e.hour<12?0:1]}function weekdayForDateTime(e,t){return weekdays(t)[e.weekday-1]}function monthForDateTime(e,t){return months(t)[e.month-1]}function eraForDateTime(e,t){return eras(t)[e.year<0?0:1]}function formatRelativeTime(e,t,r="always",i=!1){const o={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},a=["hours","minutes","seconds"].indexOf(e)===-1;if(r==="auto"&&a){const m=e==="days";switch(t){case 1:return m?"tomorrow":`next ${o[e][0]}`;case-1:return m?"yesterday":`last ${o[e][0]}`;case 0:return m?"today":`this ${o[e][0]}`;default:}}const c=Object.is(t,-0)||t<0,u=Math.abs(t),h=u===1,d=o[e],f=i?h?d[1]:d[2]||d[1]:h?o[e][0]:e;return c?`${u} ${f} ago`:`in ${u} ${f}`}function stringifyTokens(e,t){let r="";for(const i of e)i.literal?r+=i.val:r+=t(i.val);return r}var macroTokenToFormatOpts={D:DATE_SHORT,DD:DATE_MED,DDD:DATE_FULL,DDDD:DATE_HUGE,t:TIME_SIMPLE,tt:TIME_WITH_SECONDS,ttt:TIME_WITH_SHORT_OFFSET,tttt:TIME_WITH_LONG_OFFSET,T:TIME_24_SIMPLE,TT:TIME_24_WITH_SECONDS,TTT:TIME_24_WITH_SHORT_OFFSET,TTTT:TIME_24_WITH_LONG_OFFSET,f:DATETIME_SHORT,ff:DATETIME_MED,fff:DATETIME_FULL,ffff:DATETIME_HUGE,F:DATETIME_SHORT_WITH_SECONDS,FF:DATETIME_MED_WITH_SECONDS,FFF:DATETIME_FULL_WITH_SECONDS,FFFF:DATETIME_HUGE_WITH_SECONDS},Formatter=class tn{static create(t,r={}){return new tn(t,r)}static parseFormat(t){let r=null,i="",o=!1;const a=[];for(let c=0;c<t.length;c++){const u=t.charAt(c);u==="'"?(i.length>0&&a.push({literal:o||/^\s+$/.test(i),val:i}),r=null,i="",o=!o):o||u===r?i+=u:(i.length>0&&a.push({literal:/^\s+$/.test(i),val:i}),i=u,r=u)}return i.length>0&&a.push({literal:o||/^\s+$/.test(i),val:i}),a}static macroTokenToFormatOpts(t){return macroTokenToFormatOpts[t]}constructor(t,r){this.opts=r,this.loc=t,this.systemLoc=null}formatWithSystemDefault(t,r){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(t,{...this.opts,...r}).format()}dtFormatter(t,r={}){return this.loc.dtFormatter(t,{...this.opts,...r})}formatDateTime(t,r){return this.dtFormatter(t,r).format()}formatDateTimeParts(t,r){return this.dtFormatter(t,r).formatToParts()}formatInterval(t,r){return this.dtFormatter(t.start,r).dtf.formatRange(t.start.toJSDate(),t.end.toJSDate())}resolvedOptions(t,r){return this.dtFormatter(t,r).resolvedOptions()}num(t,r=0){if(this.opts.forceSimple)return padStart(t,r);const i={...this.opts};return r>0&&(i.padTo=r),this.loc.numberFormatter(i).format(t)}formatDateTimeFromString(t,r){const i=this.loc.listingMode()==="en",o=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",a=(v,_)=>this.loc.extract(t,v,_),c=v=>t.isOffsetFixed&&t.offset===0&&v.allowZ?"Z":t.isValid?t.zone.formatOffset(t.ts,v.format):"",u=()=>i?meridiemForDateTime(t):a({hour:"numeric",hourCycle:"h12"},"dayperiod"),h=(v,_)=>i?monthForDateTime(t,v):a(_?{month:v}:{month:v,day:"numeric"},"month"),d=(v,_)=>i?weekdayForDateTime(t,v):a(_?{weekday:v}:{weekday:v,month:"long",day:"numeric"},"weekday"),f=v=>{const _=tn.macroTokenToFormatOpts(v);return _?this.formatWithSystemDefault(t,_):v},m=v=>i?eraForDateTime(t,v):a({era:v},"era"),g=v=>{switch(v){case"S":return this.num(t.millisecond);case"u":case"SSS":return this.num(t.millisecond,3);case"s":return this.num(t.second);case"ss":return this.num(t.second,2);case"uu":return this.num(Math.floor(t.millisecond/10),2);case"uuu":return this.num(Math.floor(t.millisecond/100));case"m":return this.num(t.minute);case"mm":return this.num(t.minute,2);case"h":return this.num(t.hour%12===0?12:t.hour%12);case"hh":return this.num(t.hour%12===0?12:t.hour%12,2);case"H":return this.num(t.hour);case"HH":return this.num(t.hour,2);case"Z":return c({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return c({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return c({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return t.zone.offsetName(t.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return t.zone.offsetName(t.ts,{format:"long",locale:this.loc.locale});case"z":return t.zoneName;case"a":return u();case"d":return o?a({day:"numeric"},"day"):this.num(t.day);case"dd":return o?a({day:"2-digit"},"day"):this.num(t.day,2);case"c":return this.num(t.weekday);case"ccc":return d("short",!0);case"cccc":return d("long",!0);case"ccccc":return d("narrow",!0);case"E":return this.num(t.weekday);case"EEE":return d("short",!1);case"EEEE":return d("long",!1);case"EEEEE":return d("narrow",!1);case"L":return o?a({month:"numeric",day:"numeric"},"month"):this.num(t.month);case"LL":return o?a({month:"2-digit",day:"numeric"},"month"):this.num(t.month,2);case"LLL":return h("short",!0);case"LLLL":return h("long",!0);case"LLLLL":return h("narrow",!0);case"M":return o?a({month:"numeric"},"month"):this.num(t.month);case"MM":return o?a({month:"2-digit"},"month"):this.num(t.month,2);case"MMM":return h("short",!1);case"MMMM":return h("long",!1);case"MMMMM":return h("narrow",!1);case"y":return o?a({year:"numeric"},"year"):this.num(t.year);case"yy":return o?a({year:"2-digit"},"year"):this.num(t.year.toString().slice(-2),2);case"yyyy":return o?a({year:"numeric"},"year"):this.num(t.year,4);case"yyyyyy":return o?a({year:"numeric"},"year"):this.num(t.year,6);case"G":return m("short");case"GG":return m("long");case"GGGGG":return m("narrow");case"kk":return this.num(t.weekYear.toString().slice(-2),2);case"kkkk":return this.num(t.weekYear,4);case"W":return this.num(t.weekNumber);case"WW":return this.num(t.weekNumber,2);case"n":return this.num(t.localWeekNumber);case"nn":return this.num(t.localWeekNumber,2);case"ii":return this.num(t.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(t.localWeekYear,4);case"o":return this.num(t.ordinal);case"ooo":return this.num(t.ordinal,3);case"q":return this.num(t.quarter);case"qq":return this.num(t.quarter,2);case"X":return this.num(Math.floor(t.ts/1e3));case"x":return this.num(t.ts);default:return f(v)}};return stringifyTokens(tn.parseFormat(r),g)}formatDurationFromString(t,r){const i=h=>{switch(h[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},o=h=>d=>{const f=i(d);return f?this.num(h.get(f),d.length):d},a=tn.parseFormat(r),c=a.reduce((h,{literal:d,val:f})=>d?h:h.concat(f),[]),u=t.shiftTo(...c.map(i).filter(h=>h));return stringifyTokens(a,o(u))}},ianaRegex=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function combineRegexes(...e){const t=e.reduce((r,i)=>r+i.source,"");return RegExp(`^${t}$`)}function combineExtractors(...e){return t=>e.reduce(([r,i,o],a)=>{const[c,u,h]=a(t,o);return[{...r,...c},u||i,h]},[{},null,1]).slice(0,2)}function parse3(e,...t){if(e==null)return[null,null];for(const[r,i]of t){const o=r.exec(e);if(o)return i(o)}return[null,null]}function simpleParse(...e){return(t,r)=>{const i={};let o;for(o=0;o<e.length;o++)i[e[o]]=parseInteger(t[r+o]);return[i,null,r+o]}}var offsetRegex=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,isoExtendedZone=`(?:${offsetRegex.source}?(?:\\[(${ianaRegex.source})\\])?)?`,isoTimeBaseRegex=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,isoTimeRegex=RegExp(`${isoTimeBaseRegex.source}${isoExtendedZone}`),isoTimeExtensionRegex=RegExp(`(?:T${isoTimeRegex.source})?`),isoYmdRegex=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,isoWeekRegex=/(\d{4})-?W(\d\d)(?:-?(\d))?/,isoOrdinalRegex=/(\d{4})-?(\d{3})/,extractISOWeekData=simpleParse("weekYear","weekNumber","weekDay"),extractISOOrdinalData=simpleParse("year","ordinal"),sqlYmdRegex=/(\d{4})-(\d\d)-(\d\d)/,sqlTimeRegex=RegExp(`${isoTimeBaseRegex.source} ?(?:${offsetRegex.source}|(${ianaRegex.source}))?`),sqlTimeExtensionRegex=RegExp(`(?: ${sqlTimeRegex.source})?`);function int(e,t,r){const i=e[t];return isUndefined2(i)?r:parseInteger(i)}function extractISOYmd(e,t){return[{year:int(e,t),month:int(e,t+1,1),day:int(e,t+2,1)},null,t+3]}function extractISOTime(e,t){return[{hours:int(e,t,0),minutes:int(e,t+1,0),seconds:int(e,t+2,0),milliseconds:parseMillis(e[t+3])},null,t+4]}function extractISOOffset(e,t){const r=!e[t]&&!e[t+1],i=signedOffset(e[t+1],e[t+2]),o=r?null:FixedOffsetZone.instance(i);return[{},o,t+3]}function extractIANAZone(e,t){const r=e[t]?IANAZone.create(e[t]):null;return[{},r,t+1]}var isoTimeOnly=RegExp(`^T?${isoTimeBaseRegex.source}$`),isoDuration=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function extractISODuration(e){const[t,r,i,o,a,c,u,h,d]=e,f=t[0]==="-",m=h&&h[0]==="-",g=(v,_=!1)=>v!==void 0&&(_||v&&f)?-v:v;return[{years:g(parseFloating(r)),months:g(parseFloating(i)),weeks:g(parseFloating(o)),days:g(parseFloating(a)),hours:g(parseFloating(c)),minutes:g(parseFloating(u)),seconds:g(parseFloating(h),h==="-0"),milliseconds:g(parseMillis(d),m)}]}var obsOffsets={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function fromStrings(e,t,r,i,o,a,c){const u={year:t.length===2?untruncateYear(parseInteger(t)):parseInteger(t),month:monthsShort.indexOf(r)+1,day:parseInteger(i),hour:parseInteger(o),minute:parseInteger(a)};return c&&(u.second=parseInteger(c)),e&&(u.weekday=e.length>3?weekdaysLong.indexOf(e)+1:weekdaysShort.indexOf(e)+1),u}var rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function extractRFC2822(e){const[,t,r,i,o,a,c,u,h,d,f,m]=e,g=fromStrings(t,o,i,r,a,c,u);let v;return h?v=obsOffsets[h]:d?v=0:v=signedOffset(f,m),[g,new FixedOffsetZone(v)]}function preprocessRFC2822(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}var rfc1123=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,rfc850=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,ascii=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function extractRFC1123Or850(e){const[,t,r,i,o,a,c,u]=e;return[fromStrings(t,o,i,r,a,c,u),FixedOffsetZone.utcInstance]}function extractASCII(e){const[,t,r,i,o,a,c,u]=e;return[fromStrings(t,u,r,i,o,a,c),FixedOffsetZone.utcInstance]}var isoYmdWithTimeExtensionRegex=combineRegexes(isoYmdRegex,isoTimeExtensionRegex),isoWeekWithTimeExtensionRegex=combineRegexes(isoWeekRegex,isoTimeExtensionRegex),isoOrdinalWithTimeExtensionRegex=combineRegexes(isoOrdinalRegex,isoTimeExtensionRegex),isoTimeCombinedRegex=combineRegexes(isoTimeRegex),extractISOYmdTimeAndOffset=combineExtractors(extractISOYmd,extractISOTime,extractISOOffset,extractIANAZone),extractISOWeekTimeAndOffset=combineExtractors(extractISOWeekData,extractISOTime,extractISOOffset,extractIANAZone),extractISOOrdinalDateAndTime=combineExtractors(extractISOOrdinalData,extractISOTime,extractISOOffset,extractIANAZone),extractISOTimeAndOffset=combineExtractors(extractISOTime,extractISOOffset,extractIANAZone);function parseISODate(e){return parse3(e,[isoYmdWithTimeExtensionRegex,extractISOYmdTimeAndOffset],[isoWeekWithTimeExtensionRegex,extractISOWeekTimeAndOffset],[isoOrdinalWithTimeExtensionRegex,extractISOOrdinalDateAndTime],[isoTimeCombinedRegex,extractISOTimeAndOffset])}function parseRFC2822Date(e){return parse3(preprocessRFC2822(e),[rfc2822,extractRFC2822])}function parseHTTPDate(e){return parse3(e,[rfc1123,extractRFC1123Or850],[rfc850,extractRFC1123Or850],[ascii,extractASCII])}function parseISODuration(e){return parse3(e,[isoDuration,extractISODuration])}var extractISOTimeOnly=combineExtractors(extractISOTime);function parseISOTimeOnly(e){return parse3(e,[isoTimeOnly,extractISOTimeOnly])}var sqlYmdWithTimeExtensionRegex=combineRegexes(sqlYmdRegex,sqlTimeExtensionRegex),sqlTimeCombinedRegex=combineRegexes(sqlTimeRegex),extractISOTimeOffsetAndIANAZone=combineExtractors(extractISOTime,extractISOOffset,extractIANAZone);function parseSQL(e){return parse3(e,[sqlYmdWithTimeExtensionRegex,extractISOYmdTimeAndOffset],[sqlTimeCombinedRegex,extractISOTimeOffsetAndIANAZone])}var INVALID="Invalid Duration",lowOrderMatrix={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},casualMatrix={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...lowOrderMatrix},daysInYearAccurate=146097/400,daysInMonthAccurate=146097/4800,accurateMatrix={years:{quarters:4,months:12,weeks:daysInYearAccurate/7,days:daysInYearAccurate,hours:daysInYearAccurate*24,minutes:daysInYearAccurate*24*60,seconds:daysInYearAccurate*24*60*60,milliseconds:daysInYearAccurate*24*60*60*1e3},quarters:{months:3,weeks:daysInYearAccurate/28,days:daysInYearAccurate/4,hours:daysInYearAccurate*24/4,minutes:daysInYearAccurate*24*60/4,seconds:daysInYearAccurate*24*60*60/4,milliseconds:daysInYearAccurate*24*60*60*1e3/4},months:{weeks:daysInMonthAccurate/7,days:daysInMonthAccurate,hours:daysInMonthAccurate*24,minutes:daysInMonthAccurate*24*60,seconds:daysInMonthAccurate*24*60*60,milliseconds:daysInMonthAccurate*24*60*60*1e3},...lowOrderMatrix},orderedUnits=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],reverseUnits=orderedUnits.slice(0).reverse();function clone4(e,t,r=!1){const i={values:r?t.values:{...e.values,...t.values||{}},loc:e.loc.clone(t.loc),conversionAccuracy:t.conversionAccuracy||e.conversionAccuracy,matrix:t.matrix||e.matrix};return new Duration(i)}function durationToMillis(e,t){let r=t.milliseconds??0;for(const i of reverseUnits.slice(1))t[i]&&(r+=t[i]*e[i].milliseconds);return r}function normalizeValues(e,t){const r=durationToMillis(e,t)<0?-1:1;orderedUnits.reduceRight((i,o)=>{if(isUndefined2(t[o]))return i;if(i){const a=t[i]*r,c=e[o][i],u=Math.floor(a/c);t[o]+=u*r,t[i]-=u*c*r}return o},null),orderedUnits.reduce((i,o)=>{if(isUndefined2(t[o]))return i;if(i){const a=t[i]%1;t[i]-=a,t[o]+=a*e[i][o]}return o},null)}function removeZeroes(e){const t={};for(const[r,i]of Object.entries(e))i!==0&&(t[r]=i);return t}var Duration=class Ct{constructor(t){const r=t.conversionAccuracy==="longterm"||!1;let i=r?accurateMatrix:casualMatrix;t.matrix&&(i=t.matrix),this.values=t.values,this.loc=t.loc||Locale.create(),this.conversionAccuracy=r?"longterm":"casual",this.invalid=t.invalid||null,this.matrix=i,this.isLuxonDuration=!0}static fromMillis(t,r){return Ct.fromObject({milliseconds:t},r)}static fromObject(t,r={}){if(t==null||typeof t!="object")throw new InvalidArgumentError(`Duration.fromObject: argument expected to be an object, got ${t===null?"null":typeof t}`);return new Ct({values:normalizeObject(t,Ct.normalizeUnit),loc:Locale.fromObject(r),conversionAccuracy:r.conversionAccuracy,matrix:r.matrix})}static fromDurationLike(t){if(isNumber2(t))return Ct.fromMillis(t);if(Ct.isDuration(t))return t;if(typeof t=="object")return Ct.fromObject(t);throw new InvalidArgumentError(`Unknown duration argument ${t} of type ${typeof t}`)}static fromISO(t,r){const[i]=parseISODuration(t);return i?Ct.fromObject(i,r):Ct.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static fromISOTime(t,r){const[i]=parseISOTimeOnly(t);return i?Ct.fromObject(i,r):Ct.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static invalid(t,r=null){if(!t)throw new InvalidArgumentError("need to specify a reason the Duration is invalid");const i=t instanceof Invalid?t:new Invalid(t,r);if(Settings2.throwOnInvalid)throw new InvalidDurationError(i);return new Ct({invalid:i})}static normalizeUnit(t){const r={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[t&&t.toLowerCase()];if(!r)throw new InvalidUnitError(t);return r}static isDuration(t){return t&&t.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(t,r={}){const i={...r,floor:r.round!==!1&&r.floor!==!1};return this.isValid?Formatter.create(this.loc,i).formatDurationFromString(this,t):INVALID}toHuman(t={}){if(!this.isValid)return INVALID;const r=orderedUnits.map(i=>{const o=this.values[i];return isUndefined2(o)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...t,unit:i.slice(0,-1)}).format(o)}).filter(i=>i);return this.loc.listFormatter({type:"conjunction",style:t.listStyle||"narrow",...t}).format(r)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let t="P";return this.years!==0&&(t+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(t+=this.months+this.quarters*3+"M"),this.weeks!==0&&(t+=this.weeks+"W"),this.days!==0&&(t+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(t+="T"),this.hours!==0&&(t+=this.hours+"H"),this.minutes!==0&&(t+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(t+=roundTo(this.seconds+this.milliseconds/1e3,3)+"S"),t==="P"&&(t+="T0S"),t}toISOTime(t={}){if(!this.isValid)return null;const r=this.toMillis();return r<0||r>=864e5?null:(t={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...t,includeOffset:!1},DateTime.fromMillis(r,{zone:"UTC"}).toISOTime(t))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?durationToMillis(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(t){if(!this.isValid)return this;const r=Ct.fromDurationLike(t),i={};for(const o of orderedUnits)(hasOwnProperty2(r.values,o)||hasOwnProperty2(this.values,o))&&(i[o]=r.get(o)+this.get(o));return clone4(this,{values:i},!0)}minus(t){if(!this.isValid)return this;const r=Ct.fromDurationLike(t);return this.plus(r.negate())}mapUnits(t){if(!this.isValid)return this;const r={};for(const i of Object.keys(this.values))r[i]=asNumber(t(this.values[i],i));return clone4(this,{values:r},!0)}get(t){return this[Ct.normalizeUnit(t)]}set(t){if(!this.isValid)return this;const r={...this.values,...normalizeObject(t,Ct.normalizeUnit)};return clone4(this,{values:r})}reconfigure({locale:t,numberingSystem:r,conversionAccuracy:i,matrix:o}={}){const c={loc:this.loc.clone({locale:t,numberingSystem:r}),matrix:o,conversionAccuracy:i};return clone4(this,c)}as(t){return this.isValid?this.shiftTo(t).get(t):NaN}normalize(){if(!this.isValid)return this;const t=this.toObject();return normalizeValues(this.matrix,t),clone4(this,{values:t},!0)}rescale(){if(!this.isValid)return this;const t=removeZeroes(this.normalize().shiftToAll().toObject());return clone4(this,{values:t},!0)}shiftTo(...t){if(!this.isValid)return this;if(t.length===0)return this;t=t.map(c=>Ct.normalizeUnit(c));const r={},i={},o=this.toObject();let a;for(const c of orderedUnits)if(t.indexOf(c)>=0){a=c;let u=0;for(const d in i)u+=this.matrix[d][c]*i[d],i[d]=0;isNumber2(o[c])&&(u+=o[c]);const h=Math.trunc(u);r[c]=h,i[c]=(u*1e3-h*1e3)/1e3}else isNumber2(o[c])&&(i[c]=o[c]);for(const c in i)i[c]!==0&&(r[a]+=c===a?i[c]:i[c]/this.matrix[a][c]);return normalizeValues(this.matrix,r),clone4(this,{values:r},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const t={};for(const r of Object.keys(this.values))t[r]=this.values[r]===0?0:-this.values[r];return clone4(this,{values:t},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(t){if(!this.isValid||!t.isValid||!this.loc.equals(t.loc))return!1;function r(i,o){return i===void 0||i===0?o===void 0||o===0:i===o}for(const i of orderedUnits)if(!r(this.values[i],t.values[i]))return!1;return!0}},INVALID2="Invalid Interval";function validateStartEnd(e,t){return!e||!e.isValid?Interval.invalid("missing or invalid start"):!t||!t.isValid?Interval.invalid("missing or invalid end"):t<e?Interval.invalid("end before start",`The end of an interval must be after its start, but you had start=${e.toISO()} and end=${t.toISO()}`):null}var Interval=class bt{constructor(t){this.s=t.start,this.e=t.end,this.invalid=t.invalid||null,this.isLuxonInterval=!0}static invalid(t,r=null){if(!t)throw new InvalidArgumentError("need to specify a reason the Interval is invalid");const i=t instanceof Invalid?t:new Invalid(t,r);if(Settings2.throwOnInvalid)throw new InvalidIntervalError(i);return new bt({invalid:i})}static fromDateTimes(t,r){const i=friendlyDateTime(t),o=friendlyDateTime(r),a=validateStartEnd(i,o);return a??new bt({start:i,end:o})}static after(t,r){const i=Duration.fromDurationLike(r),o=friendlyDateTime(t);return bt.fromDateTimes(o,o.plus(i))}static before(t,r){const i=Duration.fromDurationLike(r),o=friendlyDateTime(t);return bt.fromDateTimes(o.minus(i),o)}static fromISO(t,r){const[i,o]=(t||"").split("/",2);if(i&&o){let a,c;try{a=DateTime.fromISO(i,r),c=a.isValid}catch{c=!1}let u,h;try{u=DateTime.fromISO(o,r),h=u.isValid}catch{h=!1}if(c&&h)return bt.fromDateTimes(a,u);if(c){const d=Duration.fromISO(o,r);if(d.isValid)return bt.after(a,d)}else if(h){const d=Duration.fromISO(i,r);if(d.isValid)return bt.before(u,d)}}return bt.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static isInterval(t){return t&&t.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(t="milliseconds"){return this.isValid?this.toDuration(t).get(t):NaN}count(t="milliseconds",r){if(!this.isValid)return NaN;const i=this.start.startOf(t,r);let o;return r?.useLocaleWeeks?o=this.end.reconfigure({locale:i.locale}):o=this.end,o=o.startOf(t,r),Math.floor(o.diff(i,t).get(t))+(o.valueOf()!==this.end.valueOf())}hasSame(t){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,t):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(t){return this.isValid?this.s>t:!1}isBefore(t){return this.isValid?this.e<=t:!1}contains(t){return this.isValid?this.s<=t&&this.e>t:!1}set({start:t,end:r}={}){return this.isValid?bt.fromDateTimes(t||this.s,r||this.e):this}splitAt(...t){if(!this.isValid)return[];const r=t.map(friendlyDateTime).filter(c=>this.contains(c)).sort((c,u)=>c.toMillis()-u.toMillis()),i=[];let{s:o}=this,a=0;for(;o<this.e;){const c=r[a]||this.e,u=+c>+this.e?this.e:c;i.push(bt.fromDateTimes(o,u)),o=u,a+=1}return i}splitBy(t){const r=Duration.fromDurationLike(t);if(!this.isValid||!r.isValid||r.as("milliseconds")===0)return[];let{s:i}=this,o=1,a;const c=[];for(;i<this.e;){const u=this.start.plus(r.mapUnits(h=>h*o));a=+u>+this.e?this.e:u,c.push(bt.fromDateTimes(i,a)),i=a,o+=1}return c}divideEqually(t){return this.isValid?this.splitBy(this.length()/t).slice(0,t):[]}overlaps(t){return this.e>t.s&&this.s<t.e}abutsStart(t){return this.isValid?+this.e==+t.s:!1}abutsEnd(t){return this.isValid?+t.e==+this.s:!1}engulfs(t){return this.isValid?this.s<=t.s&&this.e>=t.e:!1}equals(t){return!this.isValid||!t.isValid?!1:this.s.equals(t.s)&&this.e.equals(t.e)}intersection(t){if(!this.isValid)return this;const r=this.s>t.s?this.s:t.s,i=this.e<t.e?this.e:t.e;return r>=i?null:bt.fromDateTimes(r,i)}union(t){if(!this.isValid)return this;const r=this.s<t.s?this.s:t.s,i=this.e>t.e?this.e:t.e;return bt.fromDateTimes(r,i)}static merge(t){const[r,i]=t.sort((o,a)=>o.s-a.s).reduce(([o,a],c)=>a?a.overlaps(c)||a.abutsStart(c)?[o,a.union(c)]:[o.concat([a]),c]:[o,c],[[],null]);return i&&r.push(i),r}static xor(t){let r=null,i=0;const o=[],a=t.map(h=>[{time:h.s,type:"s"},{time:h.e,type:"e"}]),c=Array.prototype.concat(...a),u=c.sort((h,d)=>h.time-d.time);for(const h of u)i+=h.type==="s"?1:-1,i===1?r=h.time:(r&&+r!=+h.time&&o.push(bt.fromDateTimes(r,h.time)),r=null);return bt.merge(o)}difference(...t){return bt.xor([this].concat(t)).map(r=>this.intersection(r)).filter(r=>r&&!r.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} \u2013 ${this.e.toISO()})`:INVALID2}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(t=DATE_SHORT,r={}){return this.isValid?Formatter.create(this.s.loc.clone(r),t).formatInterval(this):INVALID2}toISO(t){return this.isValid?`${this.s.toISO(t)}/${this.e.toISO(t)}`:INVALID2}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:INVALID2}toISOTime(t){return this.isValid?`${this.s.toISOTime(t)}/${this.e.toISOTime(t)}`:INVALID2}toFormat(t,{separator:r=" \u2013 "}={}){return this.isValid?`${this.s.toFormat(t)}${r}${this.e.toFormat(t)}`:INVALID2}toDuration(t,r){return this.isValid?this.e.diff(this.s,t,r):Duration.invalid(this.invalidReason)}mapEndpoints(t){return bt.fromDateTimes(t(this.s),t(this.e))}},Info=class{static hasDST(e=Settings2.defaultZone){const t=DateTime.now().setZone(e).set({month:12});return!e.isUniversal&&t.offset!==t.set({month:6}).offset}static isValidIANAZone(e){return IANAZone.isValidZone(e)}static normalizeZone(e){return normalizeZone(e,Settings2.defaultZone)}static getStartOfWeek({locale:e=null,locObj:t=null}={}){return(t||Locale.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:t=null}={}){return(t||Locale.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:t=null}={}){return(t||Locale.create(e)).getWeekendDays().slice()}static months(e="long",{locale:t=null,numberingSystem:r=null,locObj:i=null,outputCalendar:o="gregory"}={}){return(i||Locale.create(t,r,o)).months(e)}static monthsFormat(e="long",{locale:t=null,numberingSystem:r=null,locObj:i=null,outputCalendar:o="gregory"}={}){return(i||Locale.create(t,r,o)).months(e,!0)}static weekdays(e="long",{locale:t=null,numberingSystem:r=null,locObj:i=null}={}){return(i||Locale.create(t,r,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:t=null,numberingSystem:r=null,locObj:i=null}={}){return(i||Locale.create(t,r,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return Locale.create(e).meridiems()}static eras(e="short",{locale:t=null}={}){return Locale.create(t,null,"gregory").eras(e)}static features(){return{relative:hasRelative(),localeWeek:hasLocaleWeekInfo()}}};function dayDiff(e,t){const r=o=>o.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),i=r(t)-r(e);return Math.floor(Duration.fromMillis(i).as("days"))}function highOrderDiffs(e,t,r){const i=[["years",(h,d)=>d.year-h.year],["quarters",(h,d)=>d.quarter-h.quarter+(d.year-h.year)*4],["months",(h,d)=>d.month-h.month+(d.year-h.year)*12],["weeks",(h,d)=>{const f=dayDiff(h,d);return(f-f%7)/7}],["days",dayDiff]],o={},a=e;let c,u;for(const[h,d]of i)r.indexOf(h)>=0&&(c=h,o[h]=d(e,t),u=a.plus(o),u>t?(o[h]--,e=a.plus(o),e>t&&(u=e,o[h]--,e=a.plus(o))):e=u);return[e,o,u,c]}function diff_default(e,t,r,i){let[o,a,c,u]=highOrderDiffs(e,t,r);const h=t-o,d=r.filter(m=>["hours","minutes","seconds","milliseconds"].indexOf(m)>=0);d.length===0&&(c<t&&(c=o.plus({[u]:1})),c!==o&&(a[u]=(a[u]||0)+h/(c-o)));const f=Duration.fromObject(a,i);return d.length>0?Duration.fromMillis(h,i).shiftTo(...d).plus(f):f}var MISSING_FTP="missing Intl.DateTimeFormat.formatToParts support";function intUnit(e,t=r=>r){return{regex:e,deser:([r])=>t(parseDigits(r))}}var NBSP="\xA0",spaceOrNBSP=`[ ${NBSP}]`,spaceOrNBSPRegExp=new RegExp(spaceOrNBSP,"g");function fixListRegex(e){return e.replace(/\./g,"\\.?").replace(spaceOrNBSPRegExp,spaceOrNBSP)}function stripInsensitivities(e){return e.replace(/\./g,"").replace(spaceOrNBSPRegExp," ").toLowerCase()}function oneOf(e,t){return e===null?null:{regex:RegExp(e.map(fixListRegex).join("|")),deser:([r])=>e.findIndex(i=>stripInsensitivities(r)===stripInsensitivities(i))+t}}function offset2(e,t){return{regex:e,deser:([,r,i])=>signedOffset(r,i),groups:t}}function simple(e){return{regex:e,deser:([t])=>t}}function escapeToken(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function unitForToken(e,t){const r=digitRegex(t),i=digitRegex(t,"{2}"),o=digitRegex(t,"{3}"),a=digitRegex(t,"{4}"),c=digitRegex(t,"{6}"),u=digitRegex(t,"{1,2}"),h=digitRegex(t,"{1,3}"),d=digitRegex(t,"{1,6}"),f=digitRegex(t,"{1,9}"),m=digitRegex(t,"{2,4}"),g=digitRegex(t,"{4,6}"),v=S=>({regex:RegExp(escapeToken(S.val)),deser:([R])=>R,literal:!0}),b=(S=>{if(e.literal)return v(S);switch(S.val){case"G":return oneOf(t.eras("short"),0);case"GG":return oneOf(t.eras("long"),0);case"y":return intUnit(d);case"yy":return intUnit(m,untruncateYear);case"yyyy":return intUnit(a);case"yyyyy":return intUnit(g);case"yyyyyy":return intUnit(c);case"M":return intUnit(u);case"MM":return intUnit(i);case"MMM":return oneOf(t.months("short",!0),1);case"MMMM":return oneOf(t.months("long",!0),1);case"L":return intUnit(u);case"LL":return intUnit(i);case"LLL":return oneOf(t.months("short",!1),1);case"LLLL":return oneOf(t.months("long",!1),1);case"d":return intUnit(u);case"dd":return intUnit(i);case"o":return intUnit(h);case"ooo":return intUnit(o);case"HH":return intUnit(i);case"H":return intUnit(u);case"hh":return intUnit(i);case"h":return intUnit(u);case"mm":return intUnit(i);case"m":return intUnit(u);case"q":return intUnit(u);case"qq":return intUnit(i);case"s":return intUnit(u);case"ss":return intUnit(i);case"S":return intUnit(h);case"SSS":return intUnit(o);case"u":return simple(f);case"uu":return simple(u);case"uuu":return intUnit(r);case"a":return oneOf(t.meridiems(),0);case"kkkk":return intUnit(a);case"kk":return intUnit(m,untruncateYear);case"W":return intUnit(u);case"WW":return intUnit(i);case"E":case"c":return intUnit(r);case"EEE":return oneOf(t.weekdays("short",!1),1);case"EEEE":return oneOf(t.weekdays("long",!1),1);case"ccc":return oneOf(t.weekdays("short",!0),1);case"cccc":return oneOf(t.weekdays("long",!0),1);case"Z":case"ZZ":return offset2(new RegExp(`([+-]${u.source})(?::(${i.source}))?`),2);case"ZZZ":return offset2(new RegExp(`([+-]${u.source})(${i.source})?`),2);case"z":return simple(/[a-z_+-/]{1,256}?/i);case" ":return simple(/[^\S\n\r]/);default:return v(S)}})(e)||{invalidReason:MISSING_FTP};return b.token=e,b}var partTypeStyleToTokenVal={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function tokenForPart(e,t,r){const{type:i,value:o}=e;if(i==="literal"){const h=/^\s+$/.test(o);return{literal:!h,val:h?" ":o}}const a=t[i];let c=i;i==="hour"&&(t.hour12!=null?c=t.hour12?"hour12":"hour24":t.hourCycle!=null?t.hourCycle==="h11"||t.hourCycle==="h12"?c="hour12":c="hour24":c=r.hour12?"hour12":"hour24");let u=partTypeStyleToTokenVal[c];if(typeof u=="object"&&(u=u[a]),u)return{literal:!1,val:u}}function buildRegex(e){return[`^${e.map(r=>r.regex).reduce((r,i)=>`${r}(${i.source})`,"")}$`,e]}function match(e,t,r){const i=e.match(t);if(i){const o={};let a=1;for(const c in r)if(hasOwnProperty2(r,c)){const u=r[c],h=u.groups?u.groups+1:1;!u.literal&&u.token&&(o[u.token.val[0]]=u.deser(i.slice(a,a+h))),a+=h}return[i,o]}else return[i,{}]}function dateTimeFromMatches(e){const t=a=>{switch(a){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let r=null,i;return isUndefined2(e.z)||(r=IANAZone.create(e.z)),isUndefined2(e.Z)||(r||(r=new FixedOffsetZone(e.Z)),i=e.Z),isUndefined2(e.q)||(e.M=(e.q-1)*3+1),isUndefined2(e.h)||(e.h<12&&e.a===1?e.h+=12:e.h===12&&e.a===0&&(e.h=0)),e.G===0&&e.y&&(e.y=-e.y),isUndefined2(e.u)||(e.S=parseMillis(e.u)),[Object.keys(e).reduce((a,c)=>{const u=t(c);return u&&(a[u]=e[c]),a},{}),r,i]}var dummyDateTimeCache=null;function getDummyDateTime(){return dummyDateTimeCache||(dummyDateTimeCache=DateTime.fromMillis(1555555555555)),dummyDateTimeCache}function maybeExpandMacroToken(e,t){if(e.literal)return e;const r=Formatter.macroTokenToFormatOpts(e.val),i=formatOptsToTokens(r,t);return i==null||i.includes(void 0)?e:i}function expandMacroTokens(e,t){return Array.prototype.concat(...e.map(r=>maybeExpandMacroToken(r,t)))}var TokenParser=class{constructor(e,t){if(this.locale=e,this.format=t,this.tokens=expandMacroTokens(Formatter.parseFormat(t),e),this.units=this.tokens.map(r=>unitForToken(r,e)),this.disqualifyingUnit=this.units.find(r=>r.invalidReason),!this.disqualifyingUnit){const[r,i]=buildRegex(this.units);this.regex=RegExp(r,"i"),this.handlers=i}}explainFromTokens(e){if(this.isValid){const[t,r]=match(e,this.regex,this.handlers),[i,o,a]=r?dateTimeFromMatches(r):[null,null,void 0];if(hasOwnProperty2(r,"a")&&hasOwnProperty2(r,"H"))throw new ConflictingSpecificationError("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:this.tokens,regex:this.regex,rawMatches:t,matches:r,result:i,zone:o,specificOffset:a}}else return{input:e,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}};function explainFromTokens(e,t,r){return new TokenParser(e,r).explainFromTokens(t)}function parseFromTokens(e,t,r){const{result:i,zone:o,specificOffset:a,invalidReason:c}=explainFromTokens(e,t,r);return[i,o,a,c]}function formatOptsToTokens(e,t){if(!e)return null;const i=Formatter.create(t,e).dtFormatter(getDummyDateTime()),o=i.formatToParts(),a=i.resolvedOptions();return o.map(c=>tokenForPart(c,e,a))}var INVALID3="Invalid DateTime",MAX_DATE=864e13;function unsupportedZone(e){return new Invalid("unsupported zone",`the zone "${e.name}" is not supported`)}function possiblyCachedWeekData(e){return e.weekData===null&&(e.weekData=gregorianToWeek(e.c)),e.weekData}function possiblyCachedLocalWeekData(e){return e.localWeekData===null&&(e.localWeekData=gregorianToWeek(e.c,e.loc.getMinDaysInFirstWeek(),e.loc.getStartOfWeek())),e.localWeekData}function clone5(e,t){const r={ts:e.ts,zone:e.zone,c:e.c,o:e.o,loc:e.loc,invalid:e.invalid};return new DateTime({...r,...t,old:r})}function fixOffset(e,t,r){let i=e-t*60*1e3;const o=r.offset(i);if(t===o)return[i,t];i-=(o-t)*60*1e3;const a=r.offset(i);return o===a?[i,o]:[e-Math.min(o,a)*60*1e3,Math.max(o,a)]}function tsToObj(e,t){e+=t*60*1e3;const r=new Date(e);return{year:r.getUTCFullYear(),month:r.getUTCMonth()+1,day:r.getUTCDate(),hour:r.getUTCHours(),minute:r.getUTCMinutes(),second:r.getUTCSeconds(),millisecond:r.getUTCMilliseconds()}}function objToTS(e,t,r){return fixOffset(objToLocalTS(e),t,r)}function adjustTime(e,t){const r=e.o,i=e.c.year+Math.trunc(t.years),o=e.c.month+Math.trunc(t.months)+Math.trunc(t.quarters)*3,a={...e.c,year:i,month:o,day:Math.min(e.c.day,daysInMonth(i,o))+Math.trunc(t.days)+Math.trunc(t.weeks)*7},c=Duration.fromObject({years:t.years-Math.trunc(t.years),quarters:t.quarters-Math.trunc(t.quarters),months:t.months-Math.trunc(t.months),weeks:t.weeks-Math.trunc(t.weeks),days:t.days-Math.trunc(t.days),hours:t.hours,minutes:t.minutes,seconds:t.seconds,milliseconds:t.milliseconds}).as("milliseconds"),u=objToLocalTS(a);let[h,d]=fixOffset(u,r,e.zone);return c!==0&&(h+=c,d=e.zone.offset(h)),{ts:h,o:d}}function parseDataToDateTime(e,t,r,i,o,a){const{setZone:c,zone:u}=r;if(e&&Object.keys(e).length!==0||t){const h=t||u,d=DateTime.fromObject(e,{...r,zone:h,specificOffset:a});return c?d:d.setZone(u)}else return DateTime.invalid(new Invalid("unparsable",`the input "${o}" can't be parsed as ${i}`))}function toTechFormat(e,t,r=!0){return e.isValid?Formatter.create(Locale.create("en-US"),{allowZ:r,forceSimple:!0}).formatDateTimeFromString(e,t):null}function toISODate(e,t){const r=e.c.year>9999||e.c.year<0;let i="";return r&&e.c.year>=0&&(i+="+"),i+=padStart(e.c.year,r?6:4),t?(i+="-",i+=padStart(e.c.month),i+="-",i+=padStart(e.c.day)):(i+=padStart(e.c.month),i+=padStart(e.c.day)),i}function toISOTime(e,t,r,i,o,a){let c=padStart(e.c.hour);return t?(c+=":",c+=padStart(e.c.minute),(e.c.millisecond!==0||e.c.second!==0||!r)&&(c+=":")):c+=padStart(e.c.minute),(e.c.millisecond!==0||e.c.second!==0||!r)&&(c+=padStart(e.c.second),(e.c.millisecond!==0||!i)&&(c+=".",c+=padStart(e.c.millisecond,3))),o&&(e.isOffsetFixed&&e.offset===0&&!a?c+="Z":e.o<0?(c+="-",c+=padStart(Math.trunc(-e.o/60)),c+=":",c+=padStart(Math.trunc(-e.o%60))):(c+="+",c+=padStart(Math.trunc(e.o/60)),c+=":",c+=padStart(Math.trunc(e.o%60)))),a&&(c+="["+e.zone.ianaName+"]"),c}var defaultUnitValues={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},defaultWeekUnitValues={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},defaultOrdinalUnitValues={ordinal:1,hour:0,minute:0,second:0,millisecond:0},orderedUnits2=["year","month","day","hour","minute","second","millisecond"],orderedWeekUnits=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],orderedOrdinalUnits=["year","ordinal","hour","minute","second","millisecond"];function normalizeUnit(e){const t={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[e.toLowerCase()];if(!t)throw new InvalidUnitError(e);return t}function normalizeUnitWithLocalWeeks(e){switch(e.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return normalizeUnit(e)}}function guessOffsetForZone(e){return zoneOffsetGuessCache[e]||(zoneOffsetTs===void 0&&(zoneOffsetTs=Settings2.now()),zoneOffsetGuessCache[e]=e.offset(zoneOffsetTs)),zoneOffsetGuessCache[e]}function quickDT(e,t){const r=normalizeZone(t.zone,Settings2.defaultZone);if(!r.isValid)return DateTime.invalid(unsupportedZone(r));const i=Locale.fromObject(t);let o,a;if(isUndefined2(e.year))o=Settings2.now();else{for(const h of orderedUnits2)isUndefined2(e[h])&&(e[h]=defaultUnitValues[h]);const c=hasInvalidGregorianData(e)||hasInvalidTimeData(e);if(c)return DateTime.invalid(c);const u=guessOffsetForZone(r);[o,a]=objToTS(e,u,r)}return new DateTime({ts:o,zone:r,loc:i,o:a})}function diffRelative(e,t,r){const i=isUndefined2(r.round)?!0:r.round,o=(c,u)=>(c=roundTo(c,i||r.calendary?0:2,!0),t.loc.clone(r).relFormatter(r).format(c,u)),a=c=>r.calendary?t.hasSame(e,c)?0:t.startOf(c).diff(e.startOf(c),c).get(c):t.diff(e,c).get(c);if(r.unit)return o(a(r.unit),r.unit);for(const c of r.units){const u=a(c);if(Math.abs(u)>=1)return o(u,c)}return o(e>t?-0:0,r.units[r.units.length-1])}function lastOpts(e){let t={},r;return e.length>0&&typeof e[e.length-1]=="object"?(t=e[e.length-1],r=Array.from(e).slice(0,e.length-1)):r=Array.from(e),[t,r]}var zoneOffsetTs,zoneOffsetGuessCache={},DateTime=class ot{constructor(t){const r=t.zone||Settings2.defaultZone;let i=t.invalid||(Number.isNaN(t.ts)?new Invalid("invalid input"):null)||(r.isValid?null:unsupportedZone(r));this.ts=isUndefined2(t.ts)?Settings2.now():t.ts;let o=null,a=null;if(!i)if(t.old&&t.old.ts===this.ts&&t.old.zone.equals(r))[o,a]=[t.old.c,t.old.o];else{const u=isNumber2(t.o)&&!t.old?t.o:r.offset(this.ts);o=tsToObj(this.ts,u),i=Number.isNaN(o.year)?new Invalid("invalid input"):null,o=i?null:o,a=i?null:u}this._zone=r,this.loc=t.loc||Locale.create(),this.invalid=i,this.weekData=null,this.localWeekData=null,this.c=o,this.o=a,this.isLuxonDateTime=!0}static now(){return new ot({})}static local(){const[t,r]=lastOpts(arguments),[i,o,a,c,u,h,d]=r;return quickDT({year:i,month:o,day:a,hour:c,minute:u,second:h,millisecond:d},t)}static utc(){const[t,r]=lastOpts(arguments),[i,o,a,c,u,h,d]=r;return t.zone=FixedOffsetZone.utcInstance,quickDT({year:i,month:o,day:a,hour:c,minute:u,second:h,millisecond:d},t)}static fromJSDate(t,r={}){const i=isDate3(t)?t.valueOf():NaN;if(Number.isNaN(i))return ot.invalid("invalid input");const o=normalizeZone(r.zone,Settings2.defaultZone);return o.isValid?new ot({ts:i,zone:o,loc:Locale.fromObject(r)}):ot.invalid(unsupportedZone(o))}static fromMillis(t,r={}){if(isNumber2(t))return t<-MAX_DATE||t>MAX_DATE?ot.invalid("Timestamp out of range"):new ot({ts:t,zone:normalizeZone(r.zone,Settings2.defaultZone),loc:Locale.fromObject(r)});throw new InvalidArgumentError(`fromMillis requires a numerical input, but received a ${typeof t} with value ${t}`)}static fromSeconds(t,r={}){if(isNumber2(t))return new ot({ts:t*1e3,zone:normalizeZone(r.zone,Settings2.defaultZone),loc:Locale.fromObject(r)});throw new InvalidArgumentError("fromSeconds requires a numerical input")}static fromObject(t,r={}){t=t||{};const i=normalizeZone(r.zone,Settings2.defaultZone);if(!i.isValid)return ot.invalid(unsupportedZone(i));const o=Locale.fromObject(r),a=normalizeObject(t,normalizeUnitWithLocalWeeks),{minDaysInFirstWeek:c,startOfWeek:u}=usesLocalWeekValues(a,o),h=Settings2.now(),d=isUndefined2(r.specificOffset)?i.offset(h):r.specificOffset,f=!isUndefined2(a.ordinal),m=!isUndefined2(a.year),g=!isUndefined2(a.month)||!isUndefined2(a.day),v=m||g,_=a.weekYear||a.weekNumber;if((v||f)&&_)throw new ConflictingSpecificationError("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(g&&f)throw new ConflictingSpecificationError("Can't mix ordinal dates with month/day");const b=_||a.weekday&&!v;let S,R,A=tsToObj(h,d);b?(S=orderedWeekUnits,R=defaultWeekUnitValues,A=gregorianToWeek(A,c,u)):f?(S=orderedOrdinalUnits,R=defaultOrdinalUnitValues,A=gregorianToOrdinal(A)):(S=orderedUnits2,R=defaultUnitValues);let I=!1;for(const W of S){const Z=a[W];isUndefined2(Z)?I?a[W]=R[W]:a[W]=A[W]:I=!0}const E=b?hasInvalidWeekData(a,c,u):f?hasInvalidOrdinalData(a):hasInvalidGregorianData(a),O=E||hasInvalidTimeData(a);if(O)return ot.invalid(O);const P=b?weekToGregorian(a,c,u):f?ordinalToGregorian(a):a,[L,V]=objToTS(P,d,i),$=new ot({ts:L,zone:i,o:V,loc:o});return a.weekday&&v&&t.weekday!==$.weekday?ot.invalid("mismatched weekday",`you can't specify both a weekday of ${a.weekday} and a date of ${$.toISO()}`):$.isValid?$:ot.invalid($.invalid)}static fromISO(t,r={}){const[i,o]=parseISODate(t);return parseDataToDateTime(i,o,r,"ISO 8601",t)}static fromRFC2822(t,r={}){const[i,o]=parseRFC2822Date(t);return parseDataToDateTime(i,o,r,"RFC 2822",t)}static fromHTTP(t,r={}){const[i,o]=parseHTTPDate(t);return parseDataToDateTime(i,o,r,"HTTP",r)}static fromFormat(t,r,i={}){if(isUndefined2(t)||isUndefined2(r))throw new InvalidArgumentError("fromFormat requires an input string and a format");const{locale:o=null,numberingSystem:a=null}=i,c=Locale.fromOpts({locale:o,numberingSystem:a,defaultToEN:!0}),[u,h,d,f]=parseFromTokens(c,t,r);return f?ot.invalid(f):parseDataToDateTime(u,h,i,`format ${r}`,t,d)}static fromString(t,r,i={}){return ot.fromFormat(t,r,i)}static fromSQL(t,r={}){const[i,o]=parseSQL(t);return parseDataToDateTime(i,o,r,"SQL",t)}static invalid(t,r=null){if(!t)throw new InvalidArgumentError("need to specify a reason the DateTime is invalid");const i=t instanceof Invalid?t:new Invalid(t,r);if(Settings2.throwOnInvalid)throw new InvalidDateTimeError(i);return new ot({invalid:i})}static isDateTime(t){return t&&t.isLuxonDateTime||!1}static parseFormatForOpts(t,r={}){const i=formatOptsToTokens(t,Locale.fromObject(r));return i?i.map(o=>o?o.val:null).join(""):null}static expandFormat(t,r={}){return expandMacroTokens(Formatter.parseFormat(t),Locale.fromObject(r)).map(o=>o.val).join("")}static resetCache(){zoneOffsetTs=void 0,zoneOffsetGuessCache={}}get(t){return this[t]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?possiblyCachedWeekData(this).weekYear:NaN}get weekNumber(){return this.isValid?possiblyCachedWeekData(this).weekNumber:NaN}get weekday(){return this.isValid?possiblyCachedWeekData(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?possiblyCachedLocalWeekData(this).weekday:NaN}get localWeekNumber(){return this.isValid?possiblyCachedLocalWeekData(this).weekNumber:NaN}get localWeekYear(){return this.isValid?possiblyCachedLocalWeekData(this).weekYear:NaN}get ordinal(){return this.isValid?gregorianToOrdinal(this.c).ordinal:NaN}get monthShort(){return this.isValid?Info.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Info.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Info.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Info.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const t=864e5,r=6e4,i=objToLocalTS(this.c),o=this.zone.offset(i-t),a=this.zone.offset(i+t),c=this.zone.offset(i-o*r),u=this.zone.offset(i-a*r);if(c===u)return[this];const h=i-c*r,d=i-u*r,f=tsToObj(h,c),m=tsToObj(d,u);return f.hour===m.hour&&f.minute===m.minute&&f.second===m.second&&f.millisecond===m.millisecond?[clone5(this,{ts:h}),clone5(this,{ts:d})]:[this]}get isInLeapYear(){return isLeapYear2(this.year)}get daysInMonth(){return daysInMonth(this.year,this.month)}get daysInYear(){return this.isValid?daysInYear(this.year):NaN}get weeksInWeekYear(){return this.isValid?weeksInWeekYear(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?weeksInWeekYear(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(t={}){const{locale:r,numberingSystem:i,calendar:o}=Formatter.create(this.loc.clone(t),t).resolvedOptions(this);return{locale:r,numberingSystem:i,outputCalendar:o}}toUTC(t=0,r={}){return this.setZone(FixedOffsetZone.instance(t),r)}toLocal(){return this.setZone(Settings2.defaultZone)}setZone(t,{keepLocalTime:r=!1,keepCalendarTime:i=!1}={}){if(t=normalizeZone(t,Settings2.defaultZone),t.equals(this.zone))return this;if(t.isValid){let o=this.ts;if(r||i){const a=t.offset(this.ts),c=this.toObject();[o]=objToTS(c,a,t)}return clone5(this,{ts:o,zone:t})}else return ot.invalid(unsupportedZone(t))}reconfigure({locale:t,numberingSystem:r,outputCalendar:i}={}){const o=this.loc.clone({locale:t,numberingSystem:r,outputCalendar:i});return clone5(this,{loc:o})}setLocale(t){return this.reconfigure({locale:t})}set(t){if(!this.isValid)return this;const r=normalizeObject(t,normalizeUnitWithLocalWeeks),{minDaysInFirstWeek:i,startOfWeek:o}=usesLocalWeekValues(r,this.loc),a=!isUndefined2(r.weekYear)||!isUndefined2(r.weekNumber)||!isUndefined2(r.weekday),c=!isUndefined2(r.ordinal),u=!isUndefined2(r.year),h=!isUndefined2(r.month)||!isUndefined2(r.day),d=u||h,f=r.weekYear||r.weekNumber;if((d||c)&&f)throw new ConflictingSpecificationError("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(h&&c)throw new ConflictingSpecificationError("Can't mix ordinal dates with month/day");let m;a?m=weekToGregorian({...gregorianToWeek(this.c,i,o),...r},i,o):isUndefined2(r.ordinal)?(m={...this.toObject(),...r},isUndefined2(r.day)&&(m.day=Math.min(daysInMonth(m.year,m.month),m.day))):m=ordinalToGregorian({...gregorianToOrdinal(this.c),...r});const[g,v]=objToTS(m,this.o,this.zone);return clone5(this,{ts:g,o:v})}plus(t){if(!this.isValid)return this;const r=Duration.fromDurationLike(t);return clone5(this,adjustTime(this,r))}minus(t){if(!this.isValid)return this;const r=Duration.fromDurationLike(t).negate();return clone5(this,adjustTime(this,r))}startOf(t,{useLocaleWeeks:r=!1}={}){if(!this.isValid)return this;const i={},o=Duration.normalizeUnit(t);switch(o){case"years":i.month=1;case"quarters":case"months":i.day=1;case"weeks":case"days":i.hour=0;case"hours":i.minute=0;case"minutes":i.second=0;case"seconds":i.millisecond=0;break;case"milliseconds":break}if(o==="weeks")if(r){const a=this.loc.getStartOfWeek(),{weekday:c}=this;c<a&&(i.weekNumber=this.weekNumber-1),i.weekday=a}else i.weekday=1;if(o==="quarters"){const a=Math.ceil(this.month/3);i.month=(a-1)*3+1}return this.set(i)}endOf(t,r){return this.isValid?this.plus({[t]:1}).startOf(t,r).minus(1):this}toFormat(t,r={}){return this.isValid?Formatter.create(this.loc.redefaultToEN(r)).formatDateTimeFromString(this,t):INVALID3}toLocaleString(t=DATE_SHORT,r={}){return this.isValid?Formatter.create(this.loc.clone(r),t).formatDateTime(this):INVALID3}toLocaleParts(t={}){return this.isValid?Formatter.create(this.loc.clone(t),t).formatDateTimeParts(this):[]}toISO({format:t="extended",suppressSeconds:r=!1,suppressMilliseconds:i=!1,includeOffset:o=!0,extendedZone:a=!1}={}){if(!this.isValid)return null;const c=t==="extended";let u=toISODate(this,c);return u+="T",u+=toISOTime(this,c,r,i,o,a),u}toISODate({format:t="extended"}={}){return this.isValid?toISODate(this,t==="extended"):null}toISOWeekDate(){return toTechFormat(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:t=!1,suppressSeconds:r=!1,includeOffset:i=!0,includePrefix:o=!1,extendedZone:a=!1,format:c="extended"}={}){return this.isValid?(o?"T":"")+toISOTime(this,c==="extended",r,t,i,a):null}toRFC2822(){return toTechFormat(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return toTechFormat(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?toISODate(this,!0):null}toSQLTime({includeOffset:t=!0,includeZone:r=!1,includeOffsetSpace:i=!0}={}){let o="HH:mm:ss.SSS";return(r||t)&&(i&&(o+=" "),r?o+="z":t&&(o+="ZZ")),toTechFormat(this,o,!0)}toSQL(t={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(t)}`:null}toString(){return this.isValid?this.toISO():INVALID3}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(t={}){if(!this.isValid)return{};const r={...this.c};return t.includeConfig&&(r.outputCalendar=this.outputCalendar,r.numberingSystem=this.loc.numberingSystem,r.locale=this.loc.locale),r}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(t,r="milliseconds",i={}){if(!this.isValid||!t.isValid)return Duration.invalid("created by diffing an invalid DateTime");const o={locale:this.locale,numberingSystem:this.numberingSystem,...i},a=maybeArray(r).map(Duration.normalizeUnit),c=t.valueOf()>this.valueOf(),u=c?this:t,h=c?t:this,d=diff_default(u,h,a,o);return c?d.negate():d}diffNow(t="milliseconds",r={}){return this.diff(ot.now(),t,r)}until(t){return this.isValid?Interval.fromDateTimes(this,t):this}hasSame(t,r,i){if(!this.isValid)return!1;const o=t.valueOf(),a=this.setZone(t.zone,{keepLocalTime:!0});return a.startOf(r,i)<=o&&o<=a.endOf(r,i)}equals(t){return this.isValid&&t.isValid&&this.valueOf()===t.valueOf()&&this.zone.equals(t.zone)&&this.loc.equals(t.loc)}toRelative(t={}){if(!this.isValid)return null;const r=t.base||ot.fromObject({},{zone:this.zone}),i=t.padding?this<r?-t.padding:t.padding:0;let o=["years","months","days","hours","minutes","seconds"],a=t.unit;return Array.isArray(t.unit)&&(o=t.unit,a=void 0),diffRelative(r,this.plus(i),{...t,numeric:"always",units:o,unit:a})}toRelativeCalendar(t={}){return this.isValid?diffRelative(t.base||ot.fromObject({},{zone:this.zone}),this,{...t,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...t){if(!t.every(ot.isDateTime))throw new InvalidArgumentError("min requires all arguments be DateTimes");return bestBy(t,r=>r.valueOf(),Math.min)}static max(...t){if(!t.every(ot.isDateTime))throw new InvalidArgumentError("max requires all arguments be DateTimes");return bestBy(t,r=>r.valueOf(),Math.max)}static fromFormatExplain(t,r,i={}){const{locale:o=null,numberingSystem:a=null}=i,c=Locale.fromOpts({locale:o,numberingSystem:a,defaultToEN:!0});return explainFromTokens(c,t,r)}static fromStringExplain(t,r,i={}){return ot.fromFormatExplain(t,r,i)}static buildFormatParser(t,r={}){const{locale:i=null,numberingSystem:o=null}=r,a=Locale.fromOpts({locale:i,numberingSystem:o,defaultToEN:!0});return new TokenParser(a,t)}static fromFormatParser(t,r,i={}){if(isUndefined2(t)||isUndefined2(r))throw new InvalidArgumentError("fromFormatParser requires an input string and a format parser");const{locale:o=null,numberingSystem:a=null}=i,c=Locale.fromOpts({locale:o,numberingSystem:a,defaultToEN:!0});if(!c.equals(r.locale))throw new InvalidArgumentError(`fromFormatParser called with a locale of ${c}, but the format parser was created for ${r.locale}`);const{result:u,zone:h,specificOffset:d,invalidReason:f}=r.explainFromTokens(t);return f?ot.invalid(f):parseDataToDateTime(u,h,i,`format ${r.format}`,t,d)}static get DATE_SHORT(){return DATE_SHORT}static get DATE_MED(){return DATE_MED}static get DATE_MED_WITH_WEEKDAY(){return DATE_MED_WITH_WEEKDAY}static get DATE_FULL(){return DATE_FULL}static get DATE_HUGE(){return DATE_HUGE}static get TIME_SIMPLE(){return TIME_SIMPLE}static get TIME_WITH_SECONDS(){return TIME_WITH_SECONDS}static get TIME_WITH_SHORT_OFFSET(){return TIME_WITH_SHORT_OFFSET}static get TIME_WITH_LONG_OFFSET(){return TIME_WITH_LONG_OFFSET}static get TIME_24_SIMPLE(){return TIME_24_SIMPLE}static get TIME_24_WITH_SECONDS(){return TIME_24_WITH_SECONDS}static get TIME_24_WITH_SHORT_OFFSET(){return TIME_24_WITH_SHORT_OFFSET}static get TIME_24_WITH_LONG_OFFSET(){return TIME_24_WITH_LONG_OFFSET}static get DATETIME_SHORT(){return DATETIME_SHORT}static get DATETIME_SHORT_WITH_SECONDS(){return DATETIME_SHORT_WITH_SECONDS}static get DATETIME_MED(){return DATETIME_MED}static get DATETIME_MED_WITH_SECONDS(){return DATETIME_MED_WITH_SECONDS}static get DATETIME_MED_WITH_WEEKDAY(){return DATETIME_MED_WITH_WEEKDAY}static get DATETIME_FULL(){return DATETIME_FULL}static get DATETIME_FULL_WITH_SECONDS(){return DATETIME_FULL_WITH_SECONDS}static get DATETIME_HUGE(){return DATETIME_HUGE}static get DATETIME_HUGE_WITH_SECONDS(){return DATETIME_HUGE_WITH_SECONDS}};function friendlyDateTime(e){if(DateTime.isDateTime(e))return e;if(e&&e.valueOf&&isNumber2(e.valueOf()))return DateTime.fromJSDate(e);if(e&&typeof e=="object")return DateTime.fromObject(e);throw new InvalidArgumentError(`Unknown datetime argument: ${e}, of type ${typeof e}`)}var freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global,freeGlobal_default=freeGlobal,freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root2=freeGlobal_default||freeSelf||Function("return this")(),root_default=root2,Symbol2=root_default.Symbol,Symbol_default=Symbol2,objectProto=Object.prototype,hasOwnProperty3=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=Symbol_default?Symbol_default.toStringTag:void 0;function getRawTag(e){var t=hasOwnProperty3.call(e,symToStringTag),r=e[symToStringTag];try{e[symToStringTag]=void 0;var i=!0}catch{}var o=nativeObjectToString.call(e);return i&&(t?e[symToStringTag]=r:delete e[symToStringTag]),o}var getRawTag_default=getRawTag,objectProto2=Object.prototype,nativeObjectToString2=objectProto2.toString;function objectToString(e){return nativeObjectToString2.call(e)}var objectToString_default=objectToString,nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag2=Symbol_default?Symbol_default.toStringTag:void 0;function baseGetTag(e){return e==null?e===void 0?undefinedTag:nullTag:symToStringTag2&&symToStringTag2 in Object(e)?getRawTag_default(e):objectToString_default(e)}var baseGetTag_default=baseGetTag;function isObjectLike(e){return e!=null&&typeof e=="object"}var isObjectLike_default=isObjectLike,symbolTag="[object Symbol]";function isSymbol(e){return typeof e=="symbol"||isObjectLike_default(e)&&baseGetTag_default(e)==symbolTag}var isSymbol_default=isSymbol;function arrayMap2(e,t){for(var r=-1,i=e==null?0:e.length,o=Array(i);++r<i;)o[r]=t(e[r],r,e);return o}var arrayMap_default=arrayMap2,isArray3=Array.isArray,isArray_default=isArray3,INFINITY2=1/0,symbolProto=Symbol_default?Symbol_default.prototype:void 0,symbolToString=symbolProto?symbolProto.toString:void 0;function baseToString(e){if(typeof e=="string")return e;if(isArray_default(e))return arrayMap_default(e,baseToString)+"";if(isSymbol_default(e))return symbolToString?symbolToString.call(e):"";var t=e+"";return t=="0"&&1/e==-INFINITY2?"-0":t}var baseToString_default=baseToString,reWhitespace=/\s/;function trimmedEndIndex(e){for(var t=e.length;t--&&reWhitespace.test(e.charAt(t)););return t}var trimmedEndIndex_default=trimmedEndIndex,reTrimStart=/^\s+/;function baseTrim(e){return e&&e.slice(0,trimmedEndIndex_default(e)+1).replace(reTrimStart,"")}var baseTrim_default=baseTrim;function isObject3(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var isObject_default=isObject3,NAN=NaN,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(e){if(typeof e=="number")return e;if(isSymbol_default(e))return NAN;if(isObject_default(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=isObject_default(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=baseTrim_default(e);var r=reIsBinary.test(e);return r||reIsOctal.test(e)?freeParseInt(e.slice(2),r?2:8):reIsBadHex.test(e)?NAN:+e}var toNumber_default=toNumber;function identity4(e){return e}var identity_default3=identity4,asyncTag="[object AsyncFunction]",funcTag="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction3(e){if(!isObject_default(e))return!1;var t=baseGetTag_default(e);return t==funcTag||t==genTag||t==asyncTag||t==proxyTag}var isFunction_default=isFunction3,coreJsData=root_default["__core-js_shared__"],coreJsData_default=coreJsData,maskSrcKey=function(){var e=/[^.]+$/.exec(coreJsData_default&&coreJsData_default.keys&&coreJsData_default.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function isMasked(e){return!!maskSrcKey&&maskSrcKey in e}var isMasked_default=isMasked,funcProto=Function.prototype,funcToString=funcProto.toString;function toSource(e){if(e!=null){try{return funcToString.call(e)}catch{}try{return e+""}catch{}}return""}var toSource_default=toSource,reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto2=Function.prototype,objectProto3=Object.prototype,funcToString2=funcProto2.toString,hasOwnProperty4=objectProto3.hasOwnProperty,reIsNative=RegExp("^"+funcToString2.call(hasOwnProperty4).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){if(!isObject_default(e)||isMasked_default(e))return!1;var t=isFunction_default(e)?reIsNative:reIsHostCtor;return t.test(toSource_default(e))}var baseIsNative_default=baseIsNative;function getValue(e,t){return e?.[t]}var getValue_default=getValue;function getNative(e,t){var r=getValue_default(e,t);return baseIsNative_default(r)?r:void 0}var getNative_default=getNative,WeakMap2=getNative_default(root_default,"WeakMap"),WeakMap_default=WeakMap2,objectCreate=Object.create,baseCreate=function(){function e(){}return function(t){if(!isObject_default(t))return{};if(objectCreate)return objectCreate(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),baseCreate_default=baseCreate;function apply(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var apply_default=apply;function copyArray(e,t){var r=-1,i=e.length;for(t||(t=Array(i));++r<i;)t[r]=e[r];return t}var copyArray_default=copyArray,HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(e){var t=0,r=0;return function(){var i=nativeNow(),o=HOT_SPAN-(i-r);if(r=i,o>0){if(++t>=HOT_COUNT)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var shortOut_default=shortOut;function constant(e){return function(){return e}}var constant_default5=constant,defineProperty=function(){try{var e=getNative_default(Object,"defineProperty");return e({},"",{}),e}catch{}}(),defineProperty_default=defineProperty,baseSetToString=defineProperty_default?function(e,t){return defineProperty_default(e,"toString",{configurable:!0,enumerable:!1,value:constant_default5(t),writable:!0})}:identity_default3,baseSetToString_default=baseSetToString,setToString=shortOut_default(baseSetToString_default),setToString_default=setToString;function arrayEach2(e,t){for(var r=-1,i=e==null?0:e.length;++r<i&&t(e[r],r,e)!==!1;);return e}var arrayEach_default=arrayEach2,MAX_SAFE_INTEGER=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(e,t){var r=typeof e;return t=t??MAX_SAFE_INTEGER,!!t&&(r=="number"||r!="symbol"&&reIsUint.test(e))&&e>-1&&e%1==0&&e<t}var isIndex_default=isIndex;function baseAssignValue(e,t,r){t=="__proto__"&&defineProperty_default?defineProperty_default(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var baseAssignValue_default=baseAssignValue;function eq2(e,t){return e===t||e!==e&&t!==t}var eq_default=eq2,objectProto4=Object.prototype,hasOwnProperty5=objectProto4.hasOwnProperty;function assignValue(e,t,r){var i=e[t];(!(hasOwnProperty5.call(e,t)&&eq_default(i,r))||r===void 0&&!(t in e))&&baseAssignValue_default(e,t,r)}var assignValue_default=assignValue;function copyObject(e,t,r,i){var o=!r;r||(r={});for(var a=-1,c=t.length;++a<c;){var u=t[a],h=i?i(r[u],e[u],u,r,e):void 0;h===void 0&&(h=e[u]),o?baseAssignValue_default(r,u,h):assignValue_default(r,u,h)}return r}var copyObject_default=copyObject,nativeMax=Math.max;function overRest(e,t,r){return t=nativeMax(t===void 0?e.length-1:t,0),function(){for(var i=arguments,o=-1,a=nativeMax(i.length-t,0),c=Array(a);++o<a;)c[o]=i[t+o];o=-1;for(var u=Array(t+1);++o<t;)u[o]=i[o];return u[t]=r(c),apply_default(e,this,u)}}var overRest_default=overRest;function baseRest(e,t){return setToString_default(overRest_default(e,t,identity_default3),e+"")}var baseRest_default=baseRest,MAX_SAFE_INTEGER2=9007199254740991;function isLength(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=MAX_SAFE_INTEGER2}var isLength_default=isLength;function isArrayLike(e){return e!=null&&isLength_default(e.length)&&!isFunction_default(e)}var isArrayLike_default=isArrayLike;function isIterateeCall(e,t,r){if(!isObject_default(r))return!1;var i=typeof t;return(i=="number"?isArrayLike_default(r)&&isIndex_default(t,r.length):i=="string"&&t in r)?eq_default(r[t],e):!1}var isIterateeCall_default=isIterateeCall;function createAssigner(e){return baseRest_default(function(t,r){var i=-1,o=r.length,a=o>1?r[o-1]:void 0,c=o>2?r[2]:void 0;for(a=e.length>3&&typeof a=="function"?(o--,a):void 0,c&&isIterateeCall_default(r[0],r[1],c)&&(a=o<3?void 0:a,o=1),t=Object(t);++i<o;){var u=r[i];u&&e(t,u,i,a)}return t})}var createAssigner_default=createAssigner,objectProto5=Object.prototype;function isPrototype(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||objectProto5;return e===r}var isPrototype_default=isPrototype;function baseTimes(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var baseTimes_default=baseTimes,argsTag="[object Arguments]";function baseIsArguments(e){return isObjectLike_default(e)&&baseGetTag_default(e)==argsTag}var baseIsArguments_default=baseIsArguments,objectProto6=Object.prototype,hasOwnProperty6=objectProto6.hasOwnProperty,propertyIsEnumerable=objectProto6.propertyIsEnumerable,isArguments=baseIsArguments_default(function(){return arguments}())?baseIsArguments_default:function(e){return isObjectLike_default(e)&&hasOwnProperty6.call(e,"callee")&&!propertyIsEnumerable.call(e,"callee")},isArguments_default=isArguments;function stubFalse(){return!1}var stubFalse_default=stubFalse,freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer2=moduleExports?root_default.Buffer:void 0,nativeIsBuffer=Buffer2?Buffer2.isBuffer:void 0,isBuffer=nativeIsBuffer||stubFalse_default,isBuffer_default=isBuffer,argsTag2="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag2="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag2]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag2]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;function baseIsTypedArray(e){return isObjectLike_default(e)&&isLength_default(e.length)&&!!typedArrayTags[baseGetTag_default(e)]}var baseIsTypedArray_default=baseIsTypedArray;function baseUnary(e){return function(t){return e(t)}}var baseUnary_default=baseUnary,freeExports2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule2=freeExports2&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports2=freeModule2&&freeModule2.exports===freeExports2,freeProcess=moduleExports2&&freeGlobal_default.process,nodeUtil=function(){try{var e=freeModule2&&freeModule2.require&&freeModule2.require("util").types;return e||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch{}}(),nodeUtil_default=nodeUtil,nodeIsTypedArray=nodeUtil_default&&nodeUtil_default.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary_default(nodeIsTypedArray):baseIsTypedArray_default,isTypedArray_default=isTypedArray,objectProto7=Object.prototype,hasOwnProperty7=objectProto7.hasOwnProperty;function arrayLikeKeys(e,t){var r=isArray_default(e),i=!r&&isArguments_default(e),o=!r&&!i&&isBuffer_default(e),a=!r&&!i&&!o&&isTypedArray_default(e),c=r||i||o||a,u=c?baseTimes_default(e.length,String):[],h=u.length;for(var d in e)(t||hasOwnProperty7.call(e,d))&&!(c&&(d=="length"||o&&(d=="offset"||d=="parent")||a&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||isIndex_default(d,h)))&&u.push(d);return u}var arrayLikeKeys_default=arrayLikeKeys;function overArg(e,t){return function(r){return e(t(r))}}var overArg_default=overArg,nativeKeys=overArg_default(Object.keys,Object),nativeKeys_default=nativeKeys,objectProto8=Object.prototype,hasOwnProperty8=objectProto8.hasOwnProperty;function baseKeys(e){if(!isPrototype_default(e))return nativeKeys_default(e);var t=[];for(var r in Object(e))hasOwnProperty8.call(e,r)&&r!="constructor"&&t.push(r);return t}var baseKeys_default=baseKeys;function keys(e){return isArrayLike_default(e)?arrayLikeKeys_default(e):baseKeys_default(e)}var keys_default=keys;function nativeKeysIn(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var nativeKeysIn_default=nativeKeysIn,objectProto9=Object.prototype,hasOwnProperty9=objectProto9.hasOwnProperty;function baseKeysIn(e){if(!isObject_default(e))return nativeKeysIn_default(e);var t=isPrototype_default(e),r=[];for(var i in e)i=="constructor"&&(t||!hasOwnProperty9.call(e,i))||r.push(i);return r}var baseKeysIn_default=baseKeysIn;function keysIn(e){return isArrayLike_default(e)?arrayLikeKeys_default(e,!0):baseKeysIn_default(e)}var keysIn_default=keysIn,assignIn=createAssigner_default(function(e,t){copyObject_default(t,keysIn_default(t),e)}),assignIn_default=assignIn,reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey2(e,t){if(isArray_default(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||isSymbol_default(e)?!0:reIsPlainProp.test(e)||!reIsDeepProp.test(e)||t!=null&&e in Object(t)}var isKey_default=isKey2,nativeCreate=getNative_default(Object,"create"),nativeCreate_default=nativeCreate;function hashClear(){this.__data__=nativeCreate_default?nativeCreate_default(null):{},this.size=0}var hashClear_default=hashClear;function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var hashDelete_default=hashDelete,HASH_UNDEFINED="__lodash_hash_undefined__",objectProto10=Object.prototype,hasOwnProperty10=objectProto10.hasOwnProperty;function hashGet(e){var t=this.__data__;if(nativeCreate_default){var r=t[e];return r===HASH_UNDEFINED?void 0:r}return hasOwnProperty10.call(t,e)?t[e]:void 0}var hashGet_default=hashGet,objectProto11=Object.prototype,hasOwnProperty11=objectProto11.hasOwnProperty;function hashHas(e){var t=this.__data__;return nativeCreate_default?t[e]!==void 0:hasOwnProperty11.call(t,e)}var hashHas_default=hashHas,HASH_UNDEFINED2="__lodash_hash_undefined__";function hashSet(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=nativeCreate_default&&t===void 0?HASH_UNDEFINED2:t,this}var hashSet_default=hashSet;function Hash(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Hash.prototype.clear=hashClear_default,Hash.prototype.delete=hashDelete_default,Hash.prototype.get=hashGet_default,Hash.prototype.has=hashHas_default,Hash.prototype.set=hashSet_default;var Hash_default=Hash;function listCacheClear(){this.__data__=[],this.size=0}var listCacheClear_default=listCacheClear;function assocIndexOf(e,t){for(var r=e.length;r--;)if(eq_default(e[r][0],t))return r;return-1}var assocIndexOf_default=assocIndexOf,arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(e){var t=this.__data__,r=assocIndexOf_default(t,e);if(r<0)return!1;var i=t.length-1;return r==i?t.pop():splice.call(t,r,1),--this.size,!0}var listCacheDelete_default=listCacheDelete;function listCacheGet(e){var t=this.__data__,r=assocIndexOf_default(t,e);return r<0?void 0:t[r][1]}var listCacheGet_default=listCacheGet;function listCacheHas(e){return assocIndexOf_default(this.__data__,e)>-1}var listCacheHas_default=listCacheHas;function listCacheSet(e,t){var r=this.__data__,i=assocIndexOf_default(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}var listCacheSet_default=listCacheSet;function ListCache(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}ListCache.prototype.clear=listCacheClear_default,ListCache.prototype.delete=listCacheDelete_default,ListCache.prototype.get=listCacheGet_default,ListCache.prototype.has=listCacheHas_default,ListCache.prototype.set=listCacheSet_default;var ListCache_default=ListCache,Map2=getNative_default(root_default,"Map"),Map_default=Map2;function mapCacheClear(){this.size=0,this.__data__={hash:new Hash_default,map:new(Map_default||ListCache_default),string:new Hash_default}}var mapCacheClear_default=mapCacheClear;function isKeyable(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var isKeyable_default=isKeyable;function getMapData(e,t){var r=e.__data__;return isKeyable_default(t)?r[typeof t=="string"?"string":"hash"]:r.map}var getMapData_default=getMapData;function mapCacheDelete(e){var t=getMapData_default(this,e).delete(e);return this.size-=t?1:0,t}var mapCacheDelete_default=mapCacheDelete;function mapCacheGet(e){return getMapData_default(this,e).get(e)}var mapCacheGet_default=mapCacheGet;function mapCacheHas(e){return getMapData_default(this,e).has(e)}var mapCacheHas_default=mapCacheHas;function mapCacheSet(e,t){var r=getMapData_default(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}var mapCacheSet_default=mapCacheSet;function MapCache(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}MapCache.prototype.clear=mapCacheClear_default,MapCache.prototype.delete=mapCacheDelete_default,MapCache.prototype.get=mapCacheGet_default,MapCache.prototype.has=mapCacheHas_default,MapCache.prototype.set=mapCacheSet_default;var MapCache_default=MapCache,FUNC_ERROR_TEXT="Expected a function";function memoize(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(FUNC_ERROR_TEXT);var r=function(){var i=arguments,o=t?t.apply(this,i):i[0],a=r.cache;if(a.has(o))return a.get(o);var c=e.apply(this,i);return r.cache=a.set(o,c)||a,c};return r.cache=new(memoize.Cache||MapCache_default),r}memoize.Cache=MapCache_default;var memoize_default=memoize,MAX_MEMOIZE_SIZE=500;function memoizeCapped(e){var t=memoize_default(e,function(i){return r.size===MAX_MEMOIZE_SIZE&&r.clear(),i}),r=t.cache;return t}var memoizeCapped_default=memoizeCapped,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped_default(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(rePropName,function(r,i,o,a){t.push(o?a.replace(reEscapeChar,"$1"):i||r)}),t}),stringToPath_default=stringToPath;function toString(e){return e==null?"":baseToString_default(e)}var toString_default=toString;function castPath(e,t){return isArray_default(e)?e:isKey_default(e,t)?[e]:stringToPath_default(toString_default(e))}var castPath_default=castPath,INFINITY3=1/0;function toKey(e){if(typeof e=="string"||isSymbol_default(e))return e;var t=e+"";return t=="0"&&1/e==-INFINITY3?"-0":t}var toKey_default=toKey;function baseGet(e,t){t=castPath_default(t,e);for(var r=0,i=t.length;e!=null&&r<i;)e=e[toKey_default(t[r++])];return r&&r==i?e:void 0}var baseGet_default=baseGet;function get3(e,t,r){var i=e==null?void 0:baseGet_default(e,t);return i===void 0?r:i}var get_default=get3;function arrayPush(e,t){for(var r=-1,i=t.length,o=e.length;++r<i;)e[o+r]=t[r];return e}var arrayPush_default=arrayPush,getPrototype=overArg_default(Object.getPrototypeOf,Object),getPrototype_default=getPrototype,objectTag2="[object Object]",funcProto3=Function.prototype,objectProto12=Object.prototype,funcToString3=funcProto3.toString,hasOwnProperty12=objectProto12.hasOwnProperty,objectCtorString=funcToString3.call(Object);function isPlainObject(e){if(!isObjectLike_default(e)||baseGetTag_default(e)!=objectTag2)return!1;var t=getPrototype_default(e);if(t===null)return!0;var r=hasOwnProperty12.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&funcToString3.call(r)==objectCtorString}var isPlainObject_default=isPlainObject;function baseSlice(e,t,r){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),r=r>o?o:r,r<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(o);++i<o;)a[i]=e[i+t];return a}var baseSlice_default=baseSlice;function stackClear(){this.__data__=new ListCache_default,this.size=0}var stackClear_default=stackClear;function stackDelete(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var stackDelete_default=stackDelete;function stackGet(e){return this.__data__.get(e)}var stackGet_default=stackGet;function stackHas(e){return this.__data__.has(e)}var stackHas_default=stackHas,LARGE_ARRAY_SIZE=200;function stackSet(e,t){var r=this.__data__;if(r instanceof ListCache_default){var i=r.__data__;if(!Map_default||i.length<LARGE_ARRAY_SIZE-1)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new MapCache_default(i)}return r.set(e,t),this.size=r.size,this}var stackSet_default=stackSet;function Stack(e){var t=this.__data__=new ListCache_default(e);this.size=t.size}Stack.prototype.clear=stackClear_default,Stack.prototype.delete=stackDelete_default,Stack.prototype.get=stackGet_default,Stack.prototype.has=stackHas_default,Stack.prototype.set=stackSet_default;var Stack_default=Stack;function baseAssign(e,t){return e&&copyObject_default(t,keys_default(t),e)}var baseAssign_default=baseAssign;function baseAssignIn(e,t){return e&&copyObject_default(t,keysIn_default(t),e)}var baseAssignIn_default=baseAssignIn,freeExports3=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule3=freeExports3&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports3=freeModule3&&freeModule3.exports===freeExports3,Buffer3=moduleExports3?root_default.Buffer:void 0,allocUnsafe=Buffer3?Buffer3.allocUnsafe:void 0;function cloneBuffer(e,t){if(t)return e.slice();var r=e.length,i=allocUnsafe?allocUnsafe(r):new e.constructor(r);return e.copy(i),i}var cloneBuffer_default=cloneBuffer;function arrayFilter2(e,t){for(var r=-1,i=e==null?0:e.length,o=0,a=[];++r<i;){var c=e[r];t(c,r,e)&&(a[o++]=c)}return a}var arrayFilter_default=arrayFilter2;function stubArray(){return[]}var stubArray_default=stubArray,objectProto13=Object.prototype,propertyIsEnumerable2=objectProto13.propertyIsEnumerable,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols?function(e){return e==null?[]:(e=Object(e),arrayFilter_default(nativeGetSymbols(e),function(t){return propertyIsEnumerable2.call(e,t)}))}:stubArray_default,getSymbols_default=getSymbols;function copySymbols(e,t){return copyObject_default(e,getSymbols_default(e),t)}var copySymbols_default=copySymbols,nativeGetSymbols2=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols2?function(e){for(var t=[];e;)arrayPush_default(t,getSymbols_default(e)),e=getPrototype_default(e);return t}:stubArray_default,getSymbolsIn_default=getSymbolsIn;function copySymbolsIn(e,t){return copyObject_default(e,getSymbolsIn_default(e),t)}var copySymbolsIn_default=copySymbolsIn;function baseGetAllKeys(e,t,r){var i=t(e);return isArray_default(e)?i:arrayPush_default(i,r(e))}var baseGetAllKeys_default=baseGetAllKeys;function getAllKeys(e){return baseGetAllKeys_default(e,keys_default,getSymbols_default)}var getAllKeys_default=getAllKeys;function getAllKeysIn(e){return baseGetAllKeys_default(e,keysIn_default,getSymbolsIn_default)}var getAllKeysIn_default=getAllKeysIn,DataView2=getNative_default(root_default,"DataView"),DataView_default=DataView2,Promise2=getNative_default(root_default,"Promise"),Promise_default=Promise2,Set2=getNative_default(root_default,"Set"),Set_default=Set2,mapTag2="[object Map]",objectTag3="[object Object]",promiseTag="[object Promise]",setTag2="[object Set]",weakMapTag2="[object WeakMap]",dataViewTag2="[object DataView]",dataViewCtorString=toSource_default(DataView_default),mapCtorString=toSource_default(Map_default),promiseCtorString=toSource_default(Promise_default),setCtorString=toSource_default(Set_default),weakMapCtorString=toSource_default(WeakMap_default),getTag=baseGetTag_default;(DataView_default&&getTag(new DataView_default(new ArrayBuffer(1)))!=dataViewTag2||Map_default&&getTag(new Map_default)!=mapTag2||Promise_default&&getTag(Promise_default.resolve())!=promiseTag||Set_default&&getTag(new Set_default)!=setTag2||WeakMap_default&&getTag(new WeakMap_default)!=weakMapTag2)&&(getTag=function(e){var t=baseGetTag_default(e),r=t==objectTag3?e.constructor:void 0,i=r?toSource_default(r):"";if(i)switch(i){case dataViewCtorString:return dataViewTag2;case mapCtorString:return mapTag2;case promiseCtorString:return promiseTag;case setCtorString:return setTag2;case weakMapCtorString:return weakMapTag2}return t});var getTag_default=getTag,objectProto14=Object.prototype,hasOwnProperty13=objectProto14.hasOwnProperty;function initCloneArray(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&hasOwnProperty13.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var initCloneArray_default=initCloneArray,Uint8Array2=root_default.Uint8Array,Uint8Array_default=Uint8Array2;function cloneArrayBuffer(e){var t=new e.constructor(e.byteLength);return new Uint8Array_default(t).set(new Uint8Array_default(e)),t}var cloneArrayBuffer_default=cloneArrayBuffer;function cloneDataView(e,t){var r=t?cloneArrayBuffer_default(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var cloneDataView_default=cloneDataView,reFlags=/\w*$/;function cloneRegExp(e){var t=new e.constructor(e.source,reFlags.exec(e));return t.lastIndex=e.lastIndex,t}var cloneRegExp_default=cloneRegExp,symbolProto2=Symbol_default?Symbol_default.prototype:void 0,symbolValueOf=symbolProto2?symbolProto2.valueOf:void 0;function cloneSymbol(e){return symbolValueOf?Object(symbolValueOf.call(e)):{}}var cloneSymbol_default=cloneSymbol;function cloneTypedArray(e,t){var r=t?cloneArrayBuffer_default(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var cloneTypedArray_default=cloneTypedArray,boolTag2="[object Boolean]",dateTag2="[object Date]",mapTag3="[object Map]",numberTag2="[object Number]",regexpTag2="[object RegExp]",setTag3="[object Set]",stringTag2="[object String]",symbolTag2="[object Symbol]",arrayBufferTag2="[object ArrayBuffer]",dataViewTag3="[object DataView]",float32Tag2="[object Float32Array]",float64Tag2="[object Float64Array]",int8Tag2="[object Int8Array]",int16Tag2="[object Int16Array]",int32Tag2="[object Int32Array]",uint8Tag2="[object Uint8Array]",uint8ClampedTag2="[object Uint8ClampedArray]",uint16Tag2="[object Uint16Array]",uint32Tag2="[object Uint32Array]";function initCloneByTag(e,t,r){var i=e.constructor;switch(t){case arrayBufferTag2:return cloneArrayBuffer_default(e);case boolTag2:case dateTag2:return new i(+e);case dataViewTag3:return cloneDataView_default(e,r);case float32Tag2:case float64Tag2:case int8Tag2:case int16Tag2:case int32Tag2:case uint8Tag2:case uint8ClampedTag2:case uint16Tag2:case uint32Tag2:return cloneTypedArray_default(e,r);case mapTag3:return new i;case numberTag2:case stringTag2:return new i(e);case regexpTag2:return cloneRegExp_default(e);case setTag3:return new i;case symbolTag2:return cloneSymbol_default(e)}}var initCloneByTag_default=initCloneByTag;function initCloneObject(e){return typeof e.constructor=="function"&&!isPrototype_default(e)?baseCreate_default(getPrototype_default(e)):{}}var initCloneObject_default=initCloneObject,mapTag4="[object Map]";function baseIsMap(e){return isObjectLike_default(e)&&getTag_default(e)==mapTag4}var baseIsMap_default=baseIsMap,nodeIsMap=nodeUtil_default&&nodeUtil_default.isMap,isMap=nodeIsMap?baseUnary_default(nodeIsMap):baseIsMap_default,isMap_default=isMap,setTag4="[object Set]";function baseIsSet(e){return isObjectLike_default(e)&&getTag_default(e)==setTag4}var baseIsSet_default=baseIsSet,nodeIsSet=nodeUtil_default&&nodeUtil_default.isSet,isSet=nodeIsSet?baseUnary_default(nodeIsSet):baseIsSet_default,isSet_default=isSet,CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG=4,argsTag3="[object Arguments]",arrayTag2="[object Array]",boolTag3="[object Boolean]",dateTag3="[object Date]",errorTag2="[object Error]",funcTag3="[object Function]",genTag2="[object GeneratorFunction]",mapTag5="[object Map]",numberTag3="[object Number]",objectTag4="[object Object]",regexpTag3="[object RegExp]",setTag5="[object Set]",stringTag3="[object String]",symbolTag3="[object Symbol]",weakMapTag3="[object WeakMap]",arrayBufferTag3="[object ArrayBuffer]",dataViewTag4="[object DataView]",float32Tag3="[object Float32Array]",float64Tag3="[object Float64Array]",int8Tag3="[object Int8Array]",int16Tag3="[object Int16Array]",int32Tag3="[object Int32Array]",uint8Tag3="[object Uint8Array]",uint8ClampedTag3="[object Uint8ClampedArray]",uint16Tag3="[object Uint16Array]",uint32Tag3="[object Uint32Array]",cloneableTags={};cloneableTags[argsTag3]=cloneableTags[arrayTag2]=cloneableTags[arrayBufferTag3]=cloneableTags[dataViewTag4]=cloneableTags[boolTag3]=cloneableTags[dateTag3]=cloneableTags[float32Tag3]=cloneableTags[float64Tag3]=cloneableTags[int8Tag3]=cloneableTags[int16Tag3]=cloneableTags[int32Tag3]=cloneableTags[mapTag5]=cloneableTags[numberTag3]=cloneableTags[objectTag4]=cloneableTags[regexpTag3]=cloneableTags[setTag5]=cloneableTags[stringTag3]=cloneableTags[symbolTag3]=cloneableTags[uint8Tag3]=cloneableTags[uint8ClampedTag3]=cloneableTags[uint16Tag3]=cloneableTags[uint32Tag3]=!0,cloneableTags[errorTag2]=cloneableTags[funcTag3]=cloneableTags[weakMapTag3]=!1;function baseClone(e,t,r,i,o,a){var c,u=t&CLONE_DEEP_FLAG,h=t&CLONE_FLAT_FLAG,d=t&CLONE_SYMBOLS_FLAG;if(r&&(c=o?r(e,i,o,a):r(e)),c!==void 0)return c;if(!isObject_default(e))return e;var f=isArray_default(e);if(f){if(c=initCloneArray_default(e),!u)return copyArray_default(e,c)}else{var m=getTag_default(e),g=m==funcTag3||m==genTag2;if(isBuffer_default(e))return cloneBuffer_default(e,u);if(m==objectTag4||m==argsTag3||g&&!o){if(c=h||g?{}:initCloneObject_default(e),!u)return h?copySymbolsIn_default(e,baseAssignIn_default(c,e)):copySymbols_default(e,baseAssign_default(c,e))}else{if(!cloneableTags[m])return o?e:{};c=initCloneByTag_default(e,m,u)}}a||(a=new Stack_default);var v=a.get(e);if(v)return v;a.set(e,c),isSet_default(e)?e.forEach(function(S){c.add(baseClone(S,t,r,S,e,a))}):isMap_default(e)&&e.forEach(function(S,R){c.set(R,baseClone(S,t,r,R,e,a))});var _=d?h?getAllKeysIn_default:getAllKeys_default:h?keysIn_default:keys_default,b=f?void 0:_(e);return arrayEach_default(b||e,function(S,R){b&&(R=S,S=e[R]),assignValue_default(c,R,baseClone(S,t,r,R,e,a))}),c}var baseClone_default=baseClone,CLONE_SYMBOLS_FLAG2=4;function clone6(e){return baseClone_default(e,CLONE_SYMBOLS_FLAG2)}var clone_default2=clone6,CLONE_DEEP_FLAG2=1,CLONE_SYMBOLS_FLAG3=4;function cloneDeep(e){return baseClone_default(e,CLONE_DEEP_FLAG2|CLONE_SYMBOLS_FLAG3)}var cloneDeep_default=cloneDeep,CLONE_DEEP_FLAG3=1,CLONE_SYMBOLS_FLAG4=4;function cloneDeepWith(e,t){return t=typeof t=="function"?t:void 0,baseClone_default(e,CLONE_DEEP_FLAG3|CLONE_SYMBOLS_FLAG4,t)}var cloneDeepWith_default=cloneDeepWith,HASH_UNDEFINED3="__lodash_hash_undefined__";function setCacheAdd(e){return this.__data__.set(e,HASH_UNDEFINED3),this}var setCacheAdd_default=setCacheAdd;function setCacheHas(e){return this.__data__.has(e)}var setCacheHas_default=setCacheHas;function SetCache(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new MapCache_default;++t<r;)this.add(e[t])}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd_default,SetCache.prototype.has=setCacheHas_default;var SetCache_default=SetCache;function arraySome(e,t){for(var r=-1,i=e==null?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}var arraySome_default=arraySome;function cacheHas(e,t){return e.has(t)}var cacheHas_default=cacheHas,COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function equalArrays(e,t,r,i,o,a){var c=r&COMPARE_PARTIAL_FLAG,u=e.length,h=t.length;if(u!=h&&!(c&&h>u))return!1;var d=a.get(e),f=a.get(t);if(d&&f)return d==t&&f==e;var m=-1,g=!0,v=r&COMPARE_UNORDERED_FLAG?new SetCache_default:void 0;for(a.set(e,t),a.set(t,e);++m<u;){var _=e[m],b=t[m];if(i)var S=c?i(b,_,m,t,e,a):i(_,b,m,e,t,a);if(S!==void 0){if(S)continue;g=!1;break}if(v){if(!arraySome_default(t,function(R,A){if(!cacheHas_default(v,A)&&(_===R||o(_,R,r,i,a)))return v.push(A)})){g=!1;break}}else if(!(_===b||o(_,b,r,i,a))){g=!1;break}}return a.delete(e),a.delete(t),g}var equalArrays_default=equalArrays;function mapToArray(e){var t=-1,r=Array(e.size);return e.forEach(function(i,o){r[++t]=[o,i]}),r}var mapToArray_default=mapToArray;function setToArray(e){var t=-1,r=Array(e.size);return e.forEach(function(i){r[++t]=i}),r}var setToArray_default=setToArray,COMPARE_PARTIAL_FLAG2=1,COMPARE_UNORDERED_FLAG2=2,boolTag4="[object Boolean]",dateTag4="[object Date]",errorTag3="[object Error]",mapTag6="[object Map]",numberTag4="[object Number]",regexpTag4="[object RegExp]",setTag6="[object Set]",stringTag4="[object String]",symbolTag4="[object Symbol]",arrayBufferTag4="[object ArrayBuffer]",dataViewTag5="[object DataView]",symbolProto3=Symbol_default?Symbol_default.prototype:void 0,symbolValueOf2=symbolProto3?symbolProto3.valueOf:void 0;function equalByTag(e,t,r,i,o,a,c){switch(r){case dataViewTag5:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case arrayBufferTag4:return!(e.byteLength!=t.byteLength||!a(new Uint8Array_default(e),new Uint8Array_default(t)));case boolTag4:case dateTag4:case numberTag4:return eq_default(+e,+t);case errorTag3:return e.name==t.name&&e.message==t.message;case regexpTag4:case stringTag4:return e==t+"";case mapTag6:var u=mapToArray_default;case setTag6:var h=i&COMPARE_PARTIAL_FLAG2;if(u||(u=setToArray_default),e.size!=t.size&&!h)return!1;var d=c.get(e);if(d)return d==t;i|=COMPARE_UNORDERED_FLAG2,c.set(e,t);var f=equalArrays_default(u(e),u(t),i,o,a,c);return c.delete(e),f;case symbolTag4:if(symbolValueOf2)return symbolValueOf2.call(e)==symbolValueOf2.call(t)}return!1}var equalByTag_default=equalByTag,COMPARE_PARTIAL_FLAG3=1,objectProto15=Object.prototype,hasOwnProperty14=objectProto15.hasOwnProperty;function equalObjects(e,t,r,i,o,a){var c=r&COMPARE_PARTIAL_FLAG3,u=getAllKeys_default(e),h=u.length,d=getAllKeys_default(t),f=d.length;if(h!=f&&!c)return!1;for(var m=h;m--;){var g=u[m];if(!(c?g in t:hasOwnProperty14.call(t,g)))return!1}var v=a.get(e),_=a.get(t);if(v&&_)return v==t&&_==e;var b=!0;a.set(e,t),a.set(t,e);for(var S=c;++m<h;){g=u[m];var R=e[g],A=t[g];if(i)var I=c?i(A,R,g,t,e,a):i(R,A,g,e,t,a);if(!(I===void 0?R===A||o(R,A,r,i,a):I)){b=!1;break}S||(S=g=="constructor")}if(b&&!S){var E=e.constructor,O=t.constructor;E!=O&&"constructor"in e&&"constructor"in t&&!(typeof E=="function"&&E instanceof E&&typeof O=="function"&&O instanceof O)&&(b=!1)}return a.delete(e),a.delete(t),b}var equalObjects_default=equalObjects,COMPARE_PARTIAL_FLAG4=1,argsTag4="[object Arguments]",arrayTag3="[object Array]",objectTag5="[object Object]",objectProto16=Object.prototype,hasOwnProperty15=objectProto16.hasOwnProperty;function baseIsEqualDeep(e,t,r,i,o,a){var c=isArray_default(e),u=isArray_default(t),h=c?arrayTag3:getTag_default(e),d=u?arrayTag3:getTag_default(t);h=h==argsTag4?objectTag5:h,d=d==argsTag4?objectTag5:d;var f=h==objectTag5,m=d==objectTag5,g=h==d;if(g&&isBuffer_default(e)){if(!isBuffer_default(t))return!1;c=!0,f=!1}if(g&&!f)return a||(a=new Stack_default),c||isTypedArray_default(e)?equalArrays_default(e,t,r,i,o,a):equalByTag_default(e,t,h,r,i,o,a);if(!(r&COMPARE_PARTIAL_FLAG4)){var v=f&&hasOwnProperty15.call(e,"__wrapped__"),_=m&&hasOwnProperty15.call(t,"__wrapped__");if(v||_){var b=v?e.value():e,S=_?t.value():t;return a||(a=new Stack_default),o(b,S,r,i,a)}}return g?(a||(a=new Stack_default),equalObjects_default(e,t,r,i,o,a)):!1}var baseIsEqualDeep_default=baseIsEqualDeep;function baseIsEqual(e,t,r,i,o){return e===t?!0:e==null||t==null||!isObjectLike_default(e)&&!isObjectLike_default(t)?e!==e&&t!==t:baseIsEqualDeep_default(e,t,r,i,baseIsEqual,o)}var baseIsEqual_default=baseIsEqual,COMPARE_PARTIAL_FLAG5=1,COMPARE_UNORDERED_FLAG3=2;function baseIsMatch(e,t,r,i){var o=r.length,a=o,c=!i;if(e==null)return!a;for(e=Object(e);o--;){var u=r[o];if(c&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++o<a;){u=r[o];var h=u[0],d=e[h],f=u[1];if(c&&u[2]){if(d===void 0&&!(h in e))return!1}else{var m=new Stack_default;if(i)var g=i(d,f,h,e,t,m);if(!(g===void 0?baseIsEqual_default(f,d,COMPARE_PARTIAL_FLAG5|COMPARE_UNORDERED_FLAG3,i,m):g))return!1}}return!0}var baseIsMatch_default=baseIsMatch;function isStrictComparable(e){return e===e&&!isObject_default(e)}var isStrictComparable_default=isStrictComparable;function getMatchData(e){for(var t=keys_default(e),r=t.length;r--;){var i=t[r],o=e[i];t[r]=[i,o,isStrictComparable_default(o)]}return t}var getMatchData_default=getMatchData;function matchesStrictComparable(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var matchesStrictComparable_default=matchesStrictComparable;function baseMatches(e){var t=getMatchData_default(e);return t.length==1&&t[0][2]?matchesStrictComparable_default(t[0][0],t[0][1]):function(r){return r===e||baseIsMatch_default(r,e,t)}}var baseMatches_default=baseMatches;function baseHasIn(e,t){return e!=null&&t in Object(e)}var baseHasIn_default=baseHasIn;function hasPath(e,t,r){t=castPath_default(t,e);for(var i=-1,o=t.length,a=!1;++i<o;){var c=toKey_default(t[i]);if(!(a=e!=null&&r(e,c)))break;e=e[c]}return a||++i!=o?a:(o=e==null?0:e.length,!!o&&isLength_default(o)&&isIndex_default(c,o)&&(isArray_default(e)||isArguments_default(e)))}var hasPath_default=hasPath;function hasIn(e,t){return e!=null&&hasPath_default(e,t,baseHasIn_default)}var hasIn_default=hasIn,COMPARE_PARTIAL_FLAG6=1,COMPARE_UNORDERED_FLAG4=2;function baseMatchesProperty(e,t){return isKey_default(e)&&isStrictComparable_default(t)?matchesStrictComparable_default(toKey_default(e),t):function(r){var i=get_default(r,e);return i===void 0&&i===t?hasIn_default(r,e):baseIsEqual_default(t,i,COMPARE_PARTIAL_FLAG6|COMPARE_UNORDERED_FLAG4)}}var baseMatchesProperty_default=baseMatchesProperty;function baseProperty(e){return function(t){return t?.[e]}}var baseProperty_default=baseProperty;function basePropertyDeep(e){return function(t){return baseGet_default(t,e)}}var basePropertyDeep_default=basePropertyDeep;function property(e){return isKey_default(e)?baseProperty_default(toKey_default(e)):basePropertyDeep_default(e)}var property_default2=property;function baseIteratee(e){return typeof e=="function"?e:e==null?identity_default3:typeof e=="object"?isArray_default(e)?baseMatchesProperty_default(e[0],e[1]):baseMatches_default(e):property_default2(e)}var baseIteratee_default=baseIteratee;function createBaseFor(e){return function(t,r,i){for(var o=-1,a=Object(t),c=i(t),u=c.length;u--;){var h=c[e?u:++o];if(r(a[h],h,a)===!1)break}return t}}var createBaseFor_default=createBaseFor,baseFor=createBaseFor_default(),baseFor_default=baseFor;function baseForOwn(e,t){return e&&baseFor_default(e,t,keys_default)}var baseForOwn_default=baseForOwn,now3=function(){return root_default.Date.now()},now_default=now3,FUNC_ERROR_TEXT2="Expected a function",nativeMax2=Math.max,nativeMin=Math.min;function debounce3(e,t,r){var i,o,a,c,u,h,d=0,f=!1,m=!1,g=!0;if(typeof e!="function")throw new TypeError(FUNC_ERROR_TEXT2);t=toNumber_default(t)||0,isObject_default(r)&&(f=!!r.leading,m="maxWait"in r,a=m?nativeMax2(toNumber_default(r.maxWait)||0,t):a,g="trailing"in r?!!r.trailing:g);function v(P){var L=i,V=o;return i=o=void 0,d=P,c=e.apply(V,L),c}function _(P){return d=P,u=setTimeout(R,t),f?v(P):c}function b(P){var L=P-h,V=P-d,$=t-L;return m?nativeMin($,a-V):$}function S(P){var L=P-h,V=P-d;return h===void 0||L>=t||L<0||m&&V>=a}function R(){var P=now_default();if(S(P))return A(P);u=setTimeout(R,b(P))}function A(P){return u=void 0,g&&i?v(P):(i=o=void 0,c)}function I(){u!==void 0&&clearTimeout(u),d=0,i=h=o=u=void 0}function E(){return u===void 0?c:A(now_default())}function O(){var P=now_default(),L=S(P);if(i=arguments,o=this,h=P,L){if(u===void 0)return _(h);if(m)return clearTimeout(u),u=setTimeout(R,t),v(h)}return u===void 0&&(u=setTimeout(R,t)),c}return O.cancel=I,O.flush=E,O}var debounce_default=debounce3;function assignMergeValue(e,t,r){(r!==void 0&&!eq_default(e[t],r)||r===void 0&&!(t in e))&&baseAssignValue_default(e,t,r)}var assignMergeValue_default=assignMergeValue;function isArrayLikeObject(e){return isObjectLike_default(e)&&isArrayLike_default(e)}var isArrayLikeObject_default=isArrayLikeObject;function safeGet(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var safeGet_default=safeGet;function toPlainObject(e){return copyObject_default(e,keysIn_default(e))}var toPlainObject_default=toPlainObject;function baseMergeDeep(e,t,r,i,o,a,c){var u=safeGet_default(e,r),h=safeGet_default(t,r),d=c.get(h);if(d){assignMergeValue_default(e,r,d);return}var f=a?a(u,h,r+"",e,t,c):void 0,m=f===void 0;if(m){var g=isArray_default(h),v=!g&&isBuffer_default(h),_=!g&&!v&&isTypedArray_default(h);f=h,g||v||_?isArray_default(u)?f=u:isArrayLikeObject_default(u)?f=copyArray_default(u):v?(m=!1,f=cloneBuffer_default(h,!0)):_?(m=!1,f=cloneTypedArray_default(h,!0)):f=[]:isPlainObject_default(h)||isArguments_default(h)?(f=u,isArguments_default(u)?f=toPlainObject_default(u):(!isObject_default(u)||isFunction_default(u))&&(f=initCloneObject_default(h))):m=!1}m&&(c.set(h,f),o(f,h,i,a,c),c.delete(h)),assignMergeValue_default(e,r,f)}var baseMergeDeep_default=baseMergeDeep;function baseMerge(e,t,r,i,o){e!==t&&baseFor_default(t,function(a,c){if(o||(o=new Stack_default),isObject_default(a))baseMergeDeep_default(e,t,c,r,baseMerge,i,o);else{var u=i?i(safeGet_default(e,c),a,c+"",e,t,o):void 0;u===void 0&&(u=a),assignMergeValue_default(e,c,u)}},keysIn_default)}var baseMerge_default=baseMerge;function last(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var last_default=last,stringTag5="[object String]";function isString2(e){return typeof e=="string"||!isArray_default(e)&&isObjectLike_default(e)&&baseGetTag_default(e)==stringTag5}var isString_default=isString2;function parent(e,t){return t.length<2?e:baseGet_default(e,baseSlice_default(t,0,-1))}var parent_default=parent;function isElement(e){return isObjectLike_default(e)&&e.nodeType===1&&!isPlainObject_default(e)}var isElement_default=isElement;function isEqual(e,t){return baseIsEqual_default(e,t)}var isEqual_default=isEqual;function isEqualWith(e,t,r){r=typeof r=="function"?r:void 0;var i=r?r(e,t):void 0;return i===void 0?baseIsEqual_default(e,t,void 0,r):!!i}var isEqualWith_default=isEqualWith;function mapValues(e,t){var r={};return t=baseIteratee_default(t,3),baseForOwn_default(e,function(i,o,a){baseAssignValue_default(r,o,t(i,o,a))}),r}var mapValues_default=mapValues,merge2=createAssigner_default(function(e,t,r){baseMerge_default(e,t,r)}),merge_default3=merge2;function baseUnset(e,t){return t=castPath_default(t,e),e=parent_default(e,t),e==null||delete e[toKey_default(last_default(t))]}var baseUnset_default=baseUnset;function baseSet(e,t,r,i){if(!isObject_default(e))return e;t=castPath_default(t,e);for(var o=-1,a=t.length,c=a-1,u=e;u!=null&&++o<a;){var h=toKey_default(t[o]),d=r;if(h==="__proto__"||h==="constructor"||h==="prototype")return e;if(o!=c){var f=u[h];d=i?i(f,h,u):void 0,d===void 0&&(d=isObject_default(f)?f:isIndex_default(t[o+1])?[]:{})}assignValue_default(u,h,d),u=u[h]}return e}var baseSet_default=baseSet;function set4(e,t,r){return e==null?e:baseSet_default(e,t,r)}var set_default=set4,FUNC_ERROR_TEXT3="Expected a function";function throttle2(e,t,r){var i=!0,o=!0;if(typeof e!="function")throw new TypeError(FUNC_ERROR_TEXT3);return isObject_default(r)&&(i="leading"in r?!!r.leading:i,o="trailing"in r?!!r.trailing:o),debounce_default(e,t,{leading:i,maxWait:t,trailing:o})}var throttle_default=throttle2;function unset(e,t){return e==null?!0:baseUnset_default(e,t)}var unset_default=unset,globalVar;try{globalVar={window,document}}catch{globalVar={window:{},document:{}}}var global2=globalVar;function getUserAgent(){try{return navigator.userAgent.toLowerCase()}catch{return""}}var userAgent=getUserAgent(),env={isMac:isMac(userAgent),isWindows:isWindows(userAgent),isGecko:isGecko(userAgent),isSafari:isSafari2(userAgent),isiOS:isiOS(userAgent),isAndroid:isAndroid(userAgent),isBlink:isBlink(userAgent),get isMediaForcedColors(){return isMediaForcedColors()},get isMotionReduced(){return isMotionReduced()},features:{isRegExpUnicodePropertySupported:isRegExpUnicodePropertySupported()}};function isMac(e){return e.indexOf("macintosh")>-1}function isWindows(e){return e.indexOf("windows")>-1}function isGecko(e){return!!e.match(/gecko\/\d+/)}function isSafari2(e){return e.indexOf(" applewebkit/")>-1&&e.indexOf("chrome")===-1}function isiOS(e){return!!e.match(/iphone|ipad/i)||isMac(e)&&navigator.maxTouchPoints>0}function isAndroid(e){return e.indexOf("android")>-1}function isBlink(e){return e.indexOf("chrome/")>-1&&e.indexOf("edge/")<0}function isRegExpUnicodePropertySupported(){let e=!1;try{e="\u0107".search(new RegExp("[\\p{L}]","u"))===0}catch{}return e}function isMediaForcedColors(){return global2.window.matchMedia?global2.window.matchMedia("(forced-colors: active)").matches:!1}function isMotionReduced(){return global2.window.matchMedia?global2.window.matchMedia("(prefers-reduced-motion)").matches:!1}function fastDiff(e,t,r,i){r=r||function(h,d){return h===d};const o=Array.isArray(e)?e:Array.prototype.slice.call(e),a=Array.isArray(t)?t:Array.prototype.slice.call(t),c=findChangeBoundaryIndexes(o,a,r);return i?changeIndexesToAtomicChanges(c,a.length):changeIndexesToChanges(a,c)}function findChangeBoundaryIndexes(e,t,r){const i=findFirstDifferenceIndex(e,t,r);if(i===-1)return{firstIndex:-1,lastIndexOld:-1,lastIndexNew:-1};const o=cutAndReverse(e,i),a=cutAndReverse(t,i),c=findFirstDifferenceIndex(o,a,r),u=e.length-c,h=t.length-c;return{firstIndex:i,lastIndexOld:u,lastIndexNew:h}}function findFirstDifferenceIndex(e,t,r){for(let i=0;i<Math.max(e.length,t.length);i++)if(e[i]===void 0||t[i]===void 0||!r(e[i],t[i]))return i;return-1}function cutAndReverse(e,t){return e.slice(t).reverse()}function changeIndexesToChanges(e,t){const r=[],{firstIndex:i,lastIndexOld:o,lastIndexNew:a}=t;return a-i>0&&r.push({index:i,type:"insert",values:e.slice(i,a)}),o-i>0&&r.push({index:i+(a-i),type:"delete",howMany:o-i}),r}function changeIndexesToAtomicChanges(e,t){const{firstIndex:r,lastIndexOld:i,lastIndexNew:o}=e;if(r===-1)return Array(t).fill("equal");let a=[];return r>0&&(a=a.concat(Array(r).fill("equal"))),o-r>0&&(a=a.concat(Array(o-r).fill("insert"))),i-r>0&&(a=a.concat(Array(i-r).fill("delete"))),o<t&&(a=a.concat(Array(t-o).fill("equal"))),a}function diff(e,t,r){r=r||function(b,S){return b===S};const i=e.length,o=t.length;if(i>200||o>200||i+o>300)return diff.fastDiff(e,t,r,!0);let a,c;if(o<i){const b=e;e=t,t=b,a="delete",c="insert"}else a="insert",c="delete";const u=e.length,h=t.length,d=h-u,f={},m={};function g(b){const S=(m[b-1]!==void 0?m[b-1]:-1)+1,R=m[b+1]!==void 0?m[b+1]:-1,A=S>R?-1:1;f[b+A]&&(f[b]=f[b+A].slice(0)),f[b]||(f[b]=[]),f[b].push(S>R?a:c);let I=Math.max(S,R),E=I-b;for(;E<u&&I<h&&r(e[E],t[I]);)E++,I++,f[b].push("equal");return I}let v=0,_;do{for(_=-v;_<d;_++)m[_]=g(_);for(_=d+v;_>d;_--)m[_]=g(_);m[d]=g(d),v++}while(m[d]!==h);return f[d].slice(1)}diff.fastDiff=fastDiff;function spy(){return function e(){e.called=!0}}var EventInfo=class{source;name;path;stop;off;return;constructor(e,t){this.source=e,this.name=t,this.path=[],this.stop=spy(),this.off=spy()}},HEX_NUMBERS=new Array(256).fill("").map((e,t)=>("0"+t.toString(16)).slice(-2));function uid2(){const[e,t,r,i]=crypto.getRandomValues(new Uint32Array(4));return"e"+HEX_NUMBERS[e>>0&255]+HEX_NUMBERS[e>>8&255]+HEX_NUMBERS[e>>16&255]+HEX_NUMBERS[e>>24&255]+HEX_NUMBERS[t>>0&255]+HEX_NUMBERS[t>>8&255]+HEX_NUMBERS[t>>16&255]+HEX_NUMBERS[t>>24&255]+HEX_NUMBERS[r>>0&255]+HEX_NUMBERS[r>>8&255]+HEX_NUMBERS[r>>16&255]+HEX_NUMBERS[r>>24&255]+HEX_NUMBERS[i>>0&255]+HEX_NUMBERS[i>>8&255]+HEX_NUMBERS[i>>16&255]+HEX_NUMBERS[i>>24&255]}var priorities={get(e="normal"){return typeof e!="number"?this[e]||this.normal:e},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};function insertToPriorityArray(e,t){const r=priorities.get(t.priority);let i=0,o=e.length;for(;i<o;){const a=i+o>>1;priorities.get(e[a].priority)<r?o=a:i=a+1}e.splice(i,0,t)}var DOCUMENTATION_URL="https://ckeditor.com/docs/ckeditor5/latest/support/error-codes.html",CKEditorError=class gs extends Error{context;data;constructor(t,r,i){super(getErrorMessage(t,i)),this.name="CKEditorError",this.context=r,this.data=i}is(t){return t==="CKEditorError"}static rethrowUnexpectedError(t,r){if(t.is&&t.is("CKEditorError"))throw t;const i=new gs(t.message,r);throw i.stack=t.stack,i}};function logWarning(e,t){console.warn(...formatConsoleArguments(e,t))}function logError(e,t){console.error(...formatConsoleArguments(e,t))}function getLinkToDocumentationMessage(e){return`
Read more: ${DOCUMENTATION_URL}#error-${e}`}function getErrorMessage(e,t){const r=new WeakSet,o=t?` ${JSON.stringify(t,(c,u)=>{if(typeof u=="object"&&u!==null){if(r.has(u))return`[object ${u.constructor.name}]`;r.add(u)}return u})}`:"",a=getLinkToDocumentationMessage(e);return e+o+a}function formatConsoleArguments(e,t){const r=getLinkToDocumentationMessage(e);return t?[e,t,r]:[e,r]}var version2="44.1.0",releaseDate=new Date(2024,11,16);if(globalThis.CKEDITOR_VERSION)throw new CKEditorError("ckeditor-duplicated-modules",null);globalThis.CKEDITOR_VERSION=version2;var _listeningTo=Symbol("listeningTo"),_emitterId=Symbol("emitterId"),_delegations=Symbol("delegations"),defaultEmitterClass$1=EmitterMixin(Object);function EmitterMixin(e){if(!e)return defaultEmitterClass$1;class t extends e{on(i,o,a){this.listenTo(this,i,o,a)}once(i,o,a){let c=!1;const u=(h,...d)=>{c||(c=!0,h.off(),o.call(this,h,...d))};this.listenTo(this,i,u,a)}off(i,o){this.stopListening(this,i,o)}listenTo(i,o,a,c={}){let u,h;this[_listeningTo]||(this[_listeningTo]={});const d=this[_listeningTo];_getEmitterId(i)||_setEmitterId(i);const f=_getEmitterId(i);(u=d[f])||(u=d[f]={emitter:i,callbacks:{}}),(h=u.callbacks[o])||(h=u.callbacks[o]=[]),h.push(a),addEventListener(this,i,o,a,c)}stopListening(i,o,a){const c=this[_listeningTo];let u=i&&_getEmitterId(i);const h=c&&u?c[u]:void 0,d=h&&o?h.callbacks[o]:void 0;if(!(!c||i&&!h||o&&!d))if(a)removeEventListener(this,i,o,a),d.indexOf(a)!==-1&&(d.length===1?delete h.callbacks[o]:removeEventListener(this,i,o,a));else if(d){for(;a=d.pop();)removeEventListener(this,i,o,a);delete h.callbacks[o]}else if(h){for(o in h.callbacks)this.stopListening(i,o);delete c[u]}else{for(u in c)this.stopListening(c[u].emitter);delete this[_listeningTo]}}fire(i,...o){try{const a=i instanceof EventInfo?i:new EventInfo(this,i),c=a.name;let u=getCallbacksForEvent(this,c);if(a.path.push(this),u){u=u.slice();for(let d=0;d<u.length;d++){const f=u[d].callback;if(f.call(this,a,...o),a.off.called&&(delete a.off.called,this._removeEventListener(c,f)),a.stop.called)break}}const h=this[_delegations];if(h){const d=h.get(c),f=h.get("*");d&&fireDelegatedEvents(d,a,o),f&&fireDelegatedEvents(f,a,o)}return a.return}catch(a){CKEditorError.rethrowUnexpectedError(a,this)}}delegate(...i){return{to:(o,a)=>{this[_delegations]||(this[_delegations]=new Map),i.forEach(c=>{const u=this[_delegations].get(c);u?u.set(o,a):this[_delegations].set(c,new Map([[o,a]]))})}}}stopDelegating(i,o){if(this[_delegations])if(!i)this[_delegations].clear();else if(!o)this[_delegations].delete(i);else{const a=this[_delegations].get(i);a&&a.delete(o)}}_addEventListener(i,o,a){createEventNamespace(this,i);const c=getCallbacksListsForNamespace(this,i),u=priorities.get(a.priority),h={callback:o,priority:u};for(const d of c)insertToPriorityArray(d,h)}_removeEventListener(i,o){const a=getCallbacksListsForNamespace(this,i);for(const c of a)for(let u=0;u<c.length;u++)c[u].callback==o&&(c.splice(u,1),u--)}}return t}["on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(e=>{EmitterMixin[e]=defaultEmitterClass$1.prototype[e]});function _getEmitterListenedTo(e,t){const r=e[_listeningTo];return r&&r[t]?r[t].emitter:null}function _setEmitterId(e,t){e[_emitterId]||(e[_emitterId]=t||uid2())}function _getEmitterId(e){return e[_emitterId]}function getEvents(e){return e._events||Object.defineProperty(e,"_events",{value:{}}),e._events}function makeEventNode(){return{callbacks:[],childEvents:[]}}function createEventNamespace(e,t){const r=getEvents(e);if(r[t])return;let i=t,o=null;const a=[];for(;i!==""&&!r[i];)r[i]=makeEventNode(),a.push(r[i]),o&&r[i].childEvents.push(o),o=i,i=i.substr(0,i.lastIndexOf(":"));if(i!==""){for(const c of a)c.callbacks=r[i].callbacks.slice();r[i].childEvents.push(o)}}function getCallbacksListsForNamespace(e,t){const r=getEvents(e)[t];if(!r)return[];let i=[r.callbacks];for(let o=0;o<r.childEvents.length;o++){const a=getCallbacksListsForNamespace(e,r.childEvents[o]);i=i.concat(a)}return i}function getCallbacksForEvent(e,t){if(!e._events)return null;let r=t;do{const i=e._events[r];if(i&&i.callbacks&&i.callbacks.length)return i.callbacks;const o=r.lastIndexOf(":");r=o>-1?r.substring(0,o):""}while(r);return null}function fireDelegatedEvents(e,t,r){for(let[i,o]of e){o?typeof o=="function"&&(o=o(t.name)):o=t.name;const a=new EventInfo(t.source,o);a.path=[...t.path],i.fire(a,...r)}}function addEventListener(e,t,r,i,o){t._addEventListener?t._addEventListener(r,i,o):e._addEventListener.call(t,r,i,o)}function removeEventListener(e,t,r,i){t._removeEventListener?t._removeEventListener(r,i):e._removeEventListener.call(t,r,i)}var observablePropertiesSymbol=Symbol("observableProperties"),boundObservablesSymbol=Symbol("boundObservables"),boundPropertiesSymbol=Symbol("boundProperties"),decoratedMethods=Symbol("decoratedMethods"),decoratedOriginal=Symbol("decoratedOriginal"),defaultObservableClass=ObservableMixin(EmitterMixin());function ObservableMixin(e){if(!e)return defaultObservableClass;class t extends e{set(i,o){if(isObject_default(i)){Object.keys(i).forEach(c=>{this.set(c,i[c])},this);return}initObservable(this);const a=this[observablePropertiesSymbol];if(i in this&&!a.has(i))throw new CKEditorError("observable-set-cannot-override",this);Object.defineProperty(this,i,{enumerable:!0,configurable:!0,get(){return a.get(i)},set(c){const u=a.get(i);let h=this.fire(`set:${i}`,i,c,u);h===void 0&&(h=c),(u!==h||!a.has(i))&&(a.set(i,h),this.fire(`change:${i}`,i,h,u))}}),this[i]=o}bind(...i){if(!i.length||!isStringArray(i))throw new CKEditorError("observable-bind-wrong-properties",this);if(new Set(i).size!==i.length)throw new CKEditorError("observable-bind-duplicate-properties",this);initObservable(this);const o=this[boundPropertiesSymbol];i.forEach(c=>{if(o.has(c))throw new CKEditorError("observable-bind-rebind",this)});const a=new Map;return i.forEach(c=>{const u={property:c,to:[]};o.set(c,u),a.set(c,u)}),{to:bindTo,toMany:bindToMany,_observable:this,_bindProperties:i,_to:[],_bindings:a}}unbind(...i){if(!this[observablePropertiesSymbol])return;const o=this[boundPropertiesSymbol],a=this[boundObservablesSymbol];if(i.length){if(!isStringArray(i))throw new CKEditorError("observable-unbind-wrong-properties",this);i.forEach(c=>{const u=o.get(c);u&&(u.to.forEach(([h,d])=>{const f=a.get(h),m=f[d];m.delete(u),m.size||delete f[d],Object.keys(f).length||(a.delete(h),this.stopListening(h,"change"))}),o.delete(c))})}else a.forEach((c,u)=>{this.stopListening(u,"change")}),a.clear(),o.clear()}decorate(i){initObservable(this);const o=this[i];if(!o)throw new CKEditorError("observablemixin-cannot-decorate-undefined",this,{object:this,methodName:i});this.on(i,(a,c)=>{a.return=o.apply(this,c)}),this[i]=function(...a){return this.fire(i,a)},this[i][decoratedOriginal]=o,this[decoratedMethods]||(this[decoratedMethods]=[]),this[decoratedMethods].push(i)}stopListening(i,o,a){if(!i&&this[decoratedMethods]){for(const c of this[decoratedMethods])this[c]=this[c][decoratedOriginal];delete this[decoratedMethods]}super.stopListening(i,o,a)}[observablePropertiesSymbol];[decoratedMethods];[boundPropertiesSymbol];[boundObservablesSymbol]}return t}["set","bind","unbind","decorate","on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(e=>{ObservableMixin[e]=defaultObservableClass.prototype[e]});function initObservable(e){e[observablePropertiesSymbol]||(Object.defineProperty(e,observablePropertiesSymbol,{value:new Map}),Object.defineProperty(e,boundObservablesSymbol,{value:new Map}),Object.defineProperty(e,boundPropertiesSymbol,{value:new Map}))}function bindTo(...e){const t=parseBindToArgs(...e),r=Array.from(this._bindings.keys()),i=r.length;if(!t.callback&&t.to.length>1)throw new CKEditorError("observable-bind-to-no-callback",this);if(i>1&&t.callback)throw new CKEditorError("observable-bind-to-extra-callback",this);t.to.forEach(o=>{if(o.properties.length&&o.properties.length!==i)throw new CKEditorError("observable-bind-to-properties-length",this);o.properties.length||(o.properties=this._bindProperties)}),this._to=t.to,t.callback&&(this._bindings.get(r[0]).callback=t.callback),attachBindToListeners(this._observable,this._to),updateBindToBound(this),this._bindProperties.forEach(o=>{updateBoundObservableProperty(this._observable,o)})}function bindToMany(e,t,r){if(this._bindings.size>1)throw new CKEditorError("observable-bind-to-many-not-one-binding",this);this.to(...getBindingTargets(e,t),r)}function getBindingTargets(e,t){const r=e.map(i=>[i,t]);return Array.prototype.concat.apply([],r)}function isStringArray(e){return e.every(t=>typeof t=="string")}function parseBindToArgs(...e){if(!e.length)throw new CKEditorError("observable-bind-to-parse-error",null);const t={to:[]};let r;return typeof e[e.length-1]=="function"&&(t.callback=e.pop()),e.forEach(i=>{if(typeof i=="string")r.properties.push(i);else if(typeof i=="object")r={observable:i,properties:[]},t.to.push(r);else throw new CKEditorError("observable-bind-to-parse-error",null)}),t}function updateBoundObservables(e,t,r,i){const o=e[boundObservablesSymbol],a=o.get(r),c=a||{};c[i]||(c[i]=new Set),c[i].add(t),a||o.set(r,c)}function updateBindToBound(e){let t;e._bindings.forEach((r,i)=>{e._to.forEach(o=>{t=o.properties[r.callback?0:e._bindProperties.indexOf(i)],r.to.push([o.observable,t]),updateBoundObservables(e._observable,r,o.observable,t)})})}function updateBoundObservableProperty(e,t){const i=e[boundPropertiesSymbol].get(t);let o;i.callback?o=i.callback.apply(e,i.to.map(a=>a[0][a[1]])):(o=i.to[0],o=o[0][o[1]]),Object.prototype.hasOwnProperty.call(e,t)?e[t]=o:e.set(t,o)}function attachBindToListeners(e,t){t.forEach(r=>{const i=e[boundObservablesSymbol];let o;i.get(r.observable)||e.listenTo(r.observable,"change",(a,c)=>{o=i.get(r.observable)[c],o&&o.forEach(u=>{updateBoundObservableProperty(e,u.property)})})})}var ElementReplacer=class{_replacedElements;constructor(){this._replacedElements=[]}replace(e,t){this._replacedElements.push({element:e,newElement:t}),e.style.display="none",t&&e.parentNode.insertBefore(t,e.nextSibling)}restore(){this._replacedElements.forEach(({element:e,newElement:t})=>{e.style.display="",t&&t.remove()}),this._replacedElements=[]}};function count(e){let t=0;for(const r of e)t++;return t}function compareArrays(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++)if(e[i]!=t[i])return i;return e.length==t.length?"same":e.length<t.length?"prefix":"extension"}function isIterable(e){return!!(e&&e[Symbol.iterator])}function createElement(e,t,r={},i=[]){const o=r&&r.xmlns,a=o?e.createElementNS(o,t):e.createElement(t);for(const c in r)a.setAttribute(c,r[c]);(isString_default(i)||!isIterable(i))&&(i=[i]);for(let c of i)isString_default(c)&&(c=e.createTextNode(c)),a.appendChild(c);return a}var Config2=class{_config;constructor(e,t){this._config=Object.create(null),t&&this.define(cloneConfig(t)),e&&this._setObjectToTarget(this._config,e)}set(e,t){this._setToTarget(this._config,e,t)}define(e,t){this._setToTarget(this._config,e,t,!0)}get(e){return this._getFromSource(this._config,e)}*names(){for(const e of Object.keys(this._config))yield e}_setToTarget(e,t,r,i=!1){if(isPlainObject_default(t)){this._setObjectToTarget(e,t,i);return}const o=t.split(".");t=o.pop();for(const a of o)isPlainObject_default(e[a])||(e[a]=Object.create(null)),e=e[a];if(isPlainObject_default(r)){isPlainObject_default(e[t])||(e[t]=Object.create(null)),e=e[t],this._setObjectToTarget(e,r,i);return}i&&typeof e[t]<"u"||(e[t]=r)}_getFromSource(e,t){const r=t.split(".");t=r.pop();for(const i of r){if(!isPlainObject_default(e[i])){e=null;break}e=e[i]}return e?cloneConfig(e[t]):void 0}_setObjectToTarget(e,t,r){Object.keys(t).forEach(i=>{this._setToTarget(e,i,t[i],r)})}};function cloneConfig(e){return cloneDeepWith_default(e,leaveItemReferences)}function leaveItemReferences(e){return isElement_default(e)||typeof e=="function"?e:void 0}function isNode(e){if(e){if(e.defaultView)return e instanceof e.defaultView.Document;if(e.ownerDocument&&e.ownerDocument.defaultView)return e instanceof e.ownerDocument.defaultView.Node}return!1}function isWindow(e){const t=Object.prototype.toString.apply(e);return t=="[object Window]"||t=="[object global]"}var defaultEmitterClass=DomEmitterMixin(EmitterMixin());function DomEmitterMixin(e){if(!e)return defaultEmitterClass;class t extends e{listenTo(i,o,a,c={}){if(isNode(i)||isWindow(i)){const u={capture:!!c.useCapture,passive:!!c.usePassive},h=this._getProxyEmitter(i,u)||new ProxyEmitter(i,u);this.listenTo(h,o,a,c)}else super.listenTo(i,o,a,c)}stopListening(i,o,a){if(isNode(i)||isWindow(i)){const c=this._getAllProxyEmitters(i);for(const u of c)this.stopListening(u,o,a)}else super.stopListening(i,o,a)}_getProxyEmitter(i,o){return _getEmitterListenedTo(this,getProxyEmitterId(i,o))}_getAllProxyEmitters(i){return[{capture:!1,passive:!1},{capture:!1,passive:!0},{capture:!0,passive:!1},{capture:!0,passive:!0}].map(o=>this._getProxyEmitter(i,o)).filter(o=>!!o)}}return t}["_getProxyEmitter","_getAllProxyEmitters","on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(e=>{DomEmitterMixin[e]=defaultEmitterClass.prototype[e]});var ProxyEmitter=class extends EmitterMixin(){_domNode;_options;constructor(e,t){super(),_setEmitterId(this,getProxyEmitterId(e,t)),this._domNode=e,this._options=t}_domListeners;attach(e){if(this._domListeners&&this._domListeners[e])return;const t=this._createDomListener(e);this._domNode.addEventListener(e,t,this._options),this._domListeners||(this._domListeners={}),this._domListeners[e]=t}detach(e){let t;this._domListeners[e]&&(!(t=this._events[e])||!t.callbacks.length)&&this._domListeners[e].removeListener()}_addEventListener(e,t,r){this.attach(e),EmitterMixin().prototype._addEventListener.call(this,e,t,r)}_removeEventListener(e,t){EmitterMixin().prototype._removeEventListener.call(this,e,t),this.detach(e)}_createDomListener(e){const t=r=>{this.fire(e,r)};return t.removeListener=()=>{this._domNode.removeEventListener(e,t,this._options),delete this._domListeners[e]},t}};function getNodeUID(e){return e["data-ck-expando"]||(e["data-ck-expando"]=uid2())}function getProxyEmitterId(e,t){let r=getNodeUID(e);for(const i of Object.keys(t).sort())t[i]&&(r+="-"+i);return r}function getAncestors(e){const t=[];let r=e;for(;r&&r.nodeType!=Node.DOCUMENT_NODE;)t.unshift(r),r=r.parentNode;return t}function getDataFromElement(e){return e instanceof HTMLTextAreaElement?e.value:e.innerHTML}function getBorderWidths(e){const t=e.ownerDocument.defaultView.getComputedStyle(e);return{top:parseInt(t.borderTopWidth,10),right:parseInt(t.borderRightWidth,10),bottom:parseInt(t.borderBottomWidth,10),left:parseInt(t.borderLeftWidth,10)}}function getRangeFromMouseEvent(e){if(!e.target)return null;const t=e.target.ownerDocument,r=e.clientX,i=e.clientY;let o=null;return t.caretRangeFromPoint&&t.caretRangeFromPoint(r,i)?o=t.caretRangeFromPoint(r,i):e.rangeParent&&(o=t.createRange(),o.setStart(e.rangeParent,e.rangeOffset),o.collapse(!0)),o}function isText(e){return Object.prototype.toString.call(e)=="[object Text]"}function isRange(e){return Object.prototype.toString.apply(e)=="[object Range]"}function getPositionedAncestor(e){return!e||!e.parentNode||e.offsetParent===global2.document.body?null:e.offsetParent}var rectProperties=["top","right","bottom","left","width","height"],Rect=class Jt{top;right;bottom;left;width;height;_source;constructor(t){const r=isRange(t);if(Object.defineProperty(this,"_source",{value:t._source||t,writable:!0,enumerable:!1}),isDomElement(t)||r)if(r){const i=Jt.getDomRangeRects(t);copyRectProperties(this,Jt.getBoundingRect(i))}else copyRectProperties(this,t.getBoundingClientRect());else if(isWindow(t)){const{innerWidth:i,innerHeight:o}=t;copyRectProperties(this,{top:0,right:i,bottom:o,left:0,width:i,height:o})}else copyRectProperties(this,t)}clone(){return new Jt(this)}moveTo(t,r){return this.top=r,this.right=t+this.width,this.bottom=r+this.height,this.left=t,this}moveBy(t,r){return this.top+=r,this.right+=t,this.left+=t,this.bottom+=r,this}getIntersection(t){const r={top:Math.max(this.top,t.top),right:Math.min(this.right,t.right),bottom:Math.min(this.bottom,t.bottom),left:Math.max(this.left,t.left),width:0,height:0};if(r.width=r.right-r.left,r.height=r.bottom-r.top,r.width<0||r.height<0)return null;{const i=new Jt(r);return i._source=this._source,i}}getIntersectionArea(t){const r=this.getIntersection(t);return r?r.getArea():0}getArea(){return this.width*this.height}getVisible(){const t=this._source;let r=this.clone();if(isBody(t))return r;let i=t,o=t.parentNode||t.commonAncestorContainer,a;for(;o&&!isBody(o);){const c=getElementOverflow(o)==="visible";i instanceof HTMLElement&&getElementPosition(i)==="absolute"&&(a=i);const u=getElementPosition(o);if(c||a&&(u==="relative"&&c||u!=="relative")){i=o,o=o.parentNode;continue}const h=new Jt(o),d=r.getIntersection(h);if(d)d.getArea()<r.getArea()&&(r=d);else return null;i=o,o=o.parentNode}return r}isEqual(t){for(const r of rectProperties)if(this[r]!==t[r])return!1;return!0}contains(t){const r=this.getIntersection(t);return!!(r&&r.isEqual(t))}toAbsoluteRect(){const{scrollX:t,scrollY:r}=global2.window,i=this.clone().moveBy(t,r);if(isDomElement(i._source)){const o=getPositionedAncestor(i._source);o&&shiftRectToCompensatePositionedAncestor(i,o)}return i}excludeScrollbarsAndBorders(){const t=this._source;let r,i,o;if(isWindow(t))r=t.innerWidth-t.document.documentElement.clientWidth,i=t.innerHeight-t.document.documentElement.clientHeight,o=t.getComputedStyle(t.document.documentElement).direction;else{const a=getBorderWidths(t);r=t.offsetWidth-t.clientWidth-a.left-a.right,i=t.offsetHeight-t.clientHeight-a.top-a.bottom,o=t.ownerDocument.defaultView.getComputedStyle(t).direction,this.left+=a.left,this.top+=a.top,this.right-=a.right,this.bottom-=a.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top}return this.width-=r,o==="ltr"?this.right-=r:this.left+=r,this.height-=i,this.bottom-=i,this}static getDomRangeRects(t){const r=[],i=Array.from(t.getClientRects());if(i.length)for(const o of i)r.push(new Jt(o));else{let o=t.startContainer;isText(o)&&(o=o.parentNode);const a=new Jt(o.getBoundingClientRect());a.right=a.left,a.width=0,r.push(a)}return r}static getBoundingRect(t){const r={left:Number.POSITIVE_INFINITY,top:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY,bottom:Number.NEGATIVE_INFINITY,width:0,height:0};let i=0;for(const o of t)i++,r.left=Math.min(r.left,o.left),r.top=Math.min(r.top,o.top),r.right=Math.max(r.right,o.right),r.bottom=Math.max(r.bottom,o.bottom);return i==0?null:(r.width=r.right-r.left,r.height=r.bottom-r.top,new Jt(r))}};function copyRectProperties(e,t){for(const r of rectProperties)e[r]=t[r]}function isBody(e){return isDomElement(e)?e===e.ownerDocument.body:!1}function isDomElement(e){return e!==null&&typeof e=="object"&&e.nodeType===1&&typeof e.getBoundingClientRect=="function"}function getElementPosition(e){return e instanceof HTMLElement?e.ownerDocument.defaultView.getComputedStyle(e).position:"static"}function getElementOverflow(e){return e instanceof HTMLElement?e.ownerDocument.defaultView.getComputedStyle(e).overflow:"visible"}function shiftRectToCompensatePositionedAncestor(e,t){const r=new Rect(t),i=getBorderWidths(t);let o=0,a=0;o-=r.left,a-=r.top,o+=t.scrollLeft,a+=t.scrollTop,o-=i.left,a-=i.top,e.moveBy(o,a)}var ResizeObserver2=class ft{_element;_callback;static _observerInstance=null;static _elementCallbacks=null;constructor(t,r){ft._observerInstance||ft._createObserver(),this._element=t,this._callback=r,ft._addElementCallback(t,r),ft._observerInstance.observe(t)}get element(){return this._element}destroy(){ft._deleteElementCallback(this._element,this._callback)}static _addElementCallback(t,r){ft._elementCallbacks||(ft._elementCallbacks=new Map);let i=ft._elementCallbacks.get(t);i||(i=new Set,ft._elementCallbacks.set(t,i)),i.add(r)}static _deleteElementCallback(t,r){const i=ft._getElementCallbacks(t);i&&(i.delete(r),i.size||(ft._elementCallbacks.delete(t),ft._observerInstance.unobserve(t))),ft._elementCallbacks&&!ft._elementCallbacks.size&&(ft._observerInstance=null,ft._elementCallbacks=null)}static _getElementCallbacks(t){return ft._elementCallbacks?ft._elementCallbacks.get(t):null}static _createObserver(){ft._observerInstance=new global2.window.ResizeObserver(t=>{for(const r of t){const i=ft._getElementCallbacks(r.target);if(i)for(const o of i)o(r)}})}};function setDataInElement(e,t){e instanceof HTMLTextAreaElement&&(e.value=t),e.innerHTML=t}function toUnit(e){return t=>t+e}function indexOf(e){let t=0;for(;e.previousSibling;)e=e.previousSibling,t++;return t}function insertAt(e,t,r){e.insertBefore(r,e.childNodes[t]||null)}function isComment(e){return e&&e.nodeType===Node.COMMENT_NODE}function isValidAttributeName(e){try{global2.document.createAttribute(e)}catch{return!1}return!0}function isVisible2(e){return e?isText(e)?isVisible2(e.parentElement):e.getClientRects?!!e.getClientRects().length:!1:!1}function getOptimalPosition({element:e,target:t,positions:r,limiter:i,fitInViewport:o,viewportOffsetConfig:a}){isFunction_default(t)&&(t=t()),isFunction_default(i)&&(i=i());const c=getPositionedAncestor(e),u=getConstrainedViewportRect(a),h=new Rect(e),d=getVisibleViewportIntersectionRect(t,u);let f;if(!d||!u.getIntersection(d))return null;const m={targetRect:d,elementRect:h,positionedElementAncestor:c,viewportRect:u};if(!i&&!o)f=new PositionObject(r[0],m);else{if(i){const g=getVisibleViewportIntersectionRect(i,u);g&&(m.limiterRect=g)}f=getBestPosition(r,m)}return f}function getVisibleViewportIntersectionRect(e,t){const r=new Rect(e).getVisible();return r?r.getIntersection(t):null}function getConstrainedViewportRect(e){e=Object.assign({top:0,bottom:0,left:0,right:0},e);const t=new Rect(global2.window);return t.top+=e.top,t.height-=e.top,t.bottom-=e.bottom,t.height-=e.bottom,t}function getBestPosition(e,t){const{elementRect:r}=t,i=r.getArea(),o=e.map(u=>new PositionObject(u,t)).filter(u=>!!u.name);let a=0,c=null;for(const u of o){const{limiterIntersectionArea:h,viewportIntersectionArea:d}=u;if(h===i)return u;const f=d**2+h**2;f>a&&(a=f,c=u)}return c}var PositionObject=class{name;config;_positioningFunctionCoordinates;_options;_cachedRect;_cachedAbsoluteRect;constructor(e,t){const r=e(t.targetRect,t.elementRect,t.viewportRect,t.limiterRect);if(!r)return;const{left:i,top:o,name:a,config:c}=r;this.name=a,this.config=c,this._positioningFunctionCoordinates={left:i,top:o},this._options=t}get left(){return this._absoluteRect.left}get top(){return this._absoluteRect.top}get limiterIntersectionArea(){const e=this._options.limiterRect;return e?e.getIntersectionArea(this._rect):0}get viewportIntersectionArea(){return this._options.viewportRect.getIntersectionArea(this._rect)}get _rect(){return this._cachedRect?this._cachedRect:(this._cachedRect=this._options.elementRect.clone().moveTo(this._positioningFunctionCoordinates.left,this._positioningFunctionCoordinates.top),this._cachedRect)}get _absoluteRect(){return this._cachedAbsoluteRect?this._cachedAbsoluteRect:(this._cachedAbsoluteRect=this._rect.toAbsoluteRect(),this._cachedAbsoluteRect)}};function remove2(e){const t=e.parentNode;t&&t.removeChild(e)}function scrollViewportToShowTarget({target:e,viewportOffset:t=0,ancestorOffset:r=0,alignToTop:i,forceScroll:o}){const a=getWindow2(e);let c=a,u=null;for(t=normalizeViewportOffset(t);c;){let h;c==a?h=getParentElement(e):h=getParentElement(u),scrollAncestorsToShowRect({parent:h,getRect:()=>getRectRelativeToWindow(e,c),alignToTop:i,ancestorOffset:r,forceScroll:o});let d=getRectRelativeToWindow(e,c);const f=getRectRelativeToWindow(h,c);if(d.height>f.height){const m=d.getIntersection(f);m&&(d=m)}if(scrollWindowToShowRect({window:c,rect:d,viewportOffset:t,alignToTop:i,forceScroll:o}),c.parent!=c){if(u=c.frameElement,c=c.parent,!u)return}else c=null}}function scrollWindowToShowRect({window:e,rect:t,alignToTop:r,forceScroll:i,viewportOffset:o}){const a=t.clone().moveBy(0,o.bottom),c=t.clone().moveBy(0,-o.top),u=new Rect(e).excludeScrollbarsAndBorders(),h=[c,a],d=r&&i,f=h.every(b=>u.contains(b));let{scrollX:m,scrollY:g}=e;const v=m,_=g;d?g-=u.top-t.top+o.top:f||(isAbove(c,u)?g-=u.top-t.top+o.top:isBelow(a,u)&&(r?g+=t.top-u.top-o.top:g+=t.bottom-u.bottom+o.bottom)),f||(isLeftOf(t,u)?m-=u.left-t.left+o.left:isRightOf(t,u)&&(m+=t.right-u.right+o.right)),(m!=v||g!==_)&&e.scrollTo(m,g)}function scrollAncestorsToShowRect({parent:e,getRect:t,alignToTop:r,forceScroll:i,ancestorOffset:o=0,limiterElement:a}){const c=getWindow2(e),u=r&&i;let h,d,f;const m=a||c.document.body;for(;e!=m;)d=t(),h=new Rect(e).excludeScrollbarsAndBorders(),f=h.contains(d),u?e.scrollTop-=h.top-d.top+o:f||(isAbove(d,h)?e.scrollTop-=h.top-d.top+o:isBelow(d,h)&&(r?e.scrollTop+=d.top-h.top-o:e.scrollTop+=d.bottom-h.bottom+o)),f||(isLeftOf(d,h)?e.scrollLeft-=h.left-d.left+o:isRightOf(d,h)&&(e.scrollLeft+=d.right-h.right+o)),e=e.parentNode}function isBelow(e,t){return e.bottom>t.bottom}function isAbove(e,t){return e.top<t.top}function isLeftOf(e,t){return e.left<t.left}function isRightOf(e,t){return e.right>t.right}function getWindow2(e){return isRange(e)?e.startContainer.ownerDocument.defaultView:e.ownerDocument.defaultView}function getParentElement(e){if(isRange(e)){let t=e.commonAncestorContainer;return isText(t)&&(t=t.parentNode),t}else return e.parentNode}function getRectRelativeToWindow(e,t){const r=getWindow2(e),i=new Rect(e);if(r===t)return i;{let o=r;for(;o!=t;){const a=o.frameElement,c=new Rect(a).excludeScrollbarsAndBorders();i.moveBy(c.left,c.top),o=o.parent}}return i}function normalizeViewportOffset(e){return typeof e=="number"?{top:e,bottom:e,left:e,right:e}:e}var modifiersToGlyphsMac={ctrl:"\u2303",cmd:"\u2318",alt:"\u2325",shift:"\u21E7"},modifiersToGlyphsNonMac={ctrl:"Ctrl+",alt:"Alt+",shift:"Shift+"},keyCodesToGlyphs={37:"\u2190",38:"\u2191",39:"\u2192",40:"\u2193",9:"\u21E5",33:"Page Up",34:"Page Down"},keyCodes=generateKnownKeyCodes(),keyCodeNames=Object.fromEntries(Object.entries(keyCodes).map(([e,t])=>{let r;return t in keyCodesToGlyphs?r=keyCodesToGlyphs[t]:r=e.charAt(0).toUpperCase()+e.slice(1),[t,r]}));function getCode(e){let t;if(typeof e=="string"){if(t=keyCodes[e.toLowerCase()],!t)throw new CKEditorError("keyboard-unknown-key",null,{key:e})}else t=e.keyCode+(e.altKey?keyCodes.alt:0)+(e.ctrlKey?keyCodes.ctrl:0)+(e.shiftKey?keyCodes.shift:0)+(e.metaKey?keyCodes.cmd:0);return t}function parseKeystroke(e){return typeof e=="string"&&(e=splitKeystrokeText(e)),e.map(t=>typeof t=="string"?getEnvKeyCode(t):t).reduce((t,r)=>r+t,0)}function getEnvKeystrokeText(e){let t=parseKeystroke(e);return Object.entries(env.isMac||env.isiOS?modifiersToGlyphsMac:modifiersToGlyphsNonMac).reduce((o,[a,c])=>(t&keyCodes[a]&&(t&=~keyCodes[a],o+=c),o),"")+(t?keyCodeNames[t]:"")}function isArrowKeyCode(e){return e==keyCodes.arrowright||e==keyCodes.arrowleft||e==keyCodes.arrowup||e==keyCodes.arrowdown}function getLocalizedArrowKeyCodeDirection(e,t){const r=t==="ltr";switch(e){case keyCodes.arrowleft:return r?"left":"right";case keyCodes.arrowright:return r?"right":"left";case keyCodes.arrowup:return"up";case keyCodes.arrowdown:return"down"}}function getEnvKeyCode(e){if(e.endsWith("!"))return getCode(e.slice(0,-1));const t=getCode(e);return(env.isMac||env.isiOS)&&t==keyCodes.ctrl?keyCodes.cmd:t}function isForwardArrowKeyCode(e,t){const r=getLocalizedArrowKeyCodeDirection(e,t);return r==="down"||r==="right"}function generateKnownKeyCodes(){const e={pageup:33,pagedown:34,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,shift:2228224,alt:4456448,cmd:8912896};for(let t=65;t<=90;t++){const r=String.fromCharCode(t);e[r.toLowerCase()]=t}for(let t=48;t<=57;t++)e[t-48]=t;for(let t=112;t<=123;t++)e["f"+(t-111)]=t;return Object.assign(e,{"'":222,",":108,"-":109,".":110,"/":111,";":186,"=":187,"[":219,"\\":220,"]":221,"`":223}),e}function splitKeystrokeText(e){return e.split("+").map(t=>t.trim())}var RTL_LANGUAGE_CODES=["ar","ara","dv","div","fa","per","fas","he","heb","ku","kur","ug","uig"];function getLanguageDirection(e){return RTL_LANGUAGE_CODES.includes(e)?"rtl":"ltr"}function toArray(e){return Array.isArray(e)?e:[e]}global2.window.CKEDITOR_TRANSLATIONS||(global2.window.CKEDITOR_TRANSLATIONS={});function _translate(e,t,r=1,i){if(typeof r!="number")throw new CKEditorError("translation-service-quantity-not-a-number",null,{quantity:r});const o=i||global2.window.CKEDITOR_TRANSLATIONS,a=getNumberOfLanguages(o);a===1&&(e=Object.keys(o)[0]);const c=t.id||t.string;if(a===0||!hasTranslation(e,c,o))return r!==1?t.plural:t.string;const u=o[e].dictionary,h=o[e].getPluralForm||(m=>m===1?0:1),d=u[c];if(typeof d=="string")return d;const f=Number(h(r));return d[f]}function _unifyTranslations(e){return Array.isArray(e)?e.reduce((t,r)=>merge_default3(t,r)):e}function hasTranslation(e,t,r){return!!r[e]&&!!r[e].dictionary[t]}function getNumberOfLanguages(e){return Object.keys(e).length}var Locale2=class{uiLanguage;uiLanguageDirection;contentLanguage;contentLanguageDirection;t;translations;constructor({uiLanguage:e="en",contentLanguage:t,translations:r}={}){this.uiLanguage=e,this.contentLanguage=t||this.uiLanguage,this.uiLanguageDirection=getLanguageDirection(this.uiLanguage),this.contentLanguageDirection=getLanguageDirection(this.contentLanguage),this.translations=_unifyTranslations(r),this.t=(i,o)=>this._t(i,o)}get language(){return console.warn("locale-deprecated-language-property: The Locale#language property has been deprecated and will be removed in the near future. Please use #uiLanguage and #contentLanguage properties instead."),this.uiLanguage}_t(e,t=[]){t=toArray(t),typeof e=="string"&&(e={string:e});const i=!!e.plural?t[0]:1,o=_translate(this.uiLanguage,e,i,this.translations);return interpolateString(o,t)}};function interpolateString(e,t){return e.replace(/%(\d+)/g,(r,i)=>i<t.length?t[i]:r)}var Collection=class extends EmitterMixin(){_items;_itemMap;_idProperty;_bindToCollection;_bindToExternalToInternalMap;_bindToInternalToExternalMap;_skippedIndexesFromExternal;constructor(e={},t={}){super();const r=isIterable(e);if(r||(t=e),this._items=[],this._itemMap=new Map,this._idProperty=t.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[],r)for(const i of e)this._items.push(i),this._itemMap.set(this._getItemIdBeforeAdding(i),i)}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(e,t){return this.addMany([e],t)}addMany(e,t){if(t===void 0)t=this._items.length;else if(t>this._items.length||t<0)throw new CKEditorError("collection-add-item-invalid-index",this);let r=0;for(const i of e){const o=this._getItemIdBeforeAdding(i),a=t+r;this._items.splice(a,0,i),this._itemMap.set(o,i),this.fire("add",i,a),r++}return this.fire("change",{added:e,removed:[],index:t}),this}get(e){let t;if(typeof e=="string")t=this._itemMap.get(e);else if(typeof e=="number")t=this._items[e];else throw new CKEditorError("collection-get-invalid-arg",this);return t||null}has(e){if(typeof e=="string")return this._itemMap.has(e);{const t=this._idProperty,r=e[t];return r&&this._itemMap.has(r)}}getIndex(e){let t;return typeof e=="string"?t=this._itemMap.get(e):t=e,t?this._items.indexOf(t):-1}remove(e){const[t,r]=this._remove(e);return this.fire("change",{added:[],removed:[t],index:r}),t}map(e,t){return this._items.map(e,t)}forEach(e,t){this._items.forEach(e,t)}find(e,t){return this._items.find(e,t)}filter(e,t){return this._items.filter(e,t)}clear(){this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);const e=Array.from(this._items);for(;this.length;)this._remove(0);this.fire("change",{added:[],removed:e,index:0})}bindTo(e){if(this._bindToCollection)throw new CKEditorError("collection-bind-to-rebind",this);return this._bindToCollection=e,{as:t=>{this._setUpBindToBinding(r=>new t(r))},using:t=>{typeof t=="function"?this._setUpBindToBinding(t):this._setUpBindToBinding(r=>r[t])}}}_setUpBindToBinding(e){const t=this._bindToCollection,r=(i,o,a)=>{const c=t._bindToCollection==this,u=t._bindToInternalToExternalMap.get(o);if(c&&u)this._bindToExternalToInternalMap.set(o,u),this._bindToInternalToExternalMap.set(u,o);else{const h=e(o);if(!h){this._skippedIndexesFromExternal.push(a);return}let d=a;for(const f of this._skippedIndexesFromExternal)a>f&&d--;for(const f of t._skippedIndexesFromExternal)d>=f&&d++;this._bindToExternalToInternalMap.set(o,h),this._bindToInternalToExternalMap.set(h,o),this.add(h,d);for(let f=0;f<t._skippedIndexesFromExternal.length;f++)d<=t._skippedIndexesFromExternal[f]&&t._skippedIndexesFromExternal[f]++}};for(const i of t)r(null,i,t.getIndex(i));this.listenTo(t,"add",r),this.listenTo(t,"remove",(i,o,a)=>{const c=this._bindToExternalToInternalMap.get(o);c&&this.remove(c),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce((u,h)=>(a<h&&u.push(h-1),a>h&&u.push(h),u),[])})}_getItemIdBeforeAdding(e){const t=this._idProperty;let r;if(t in e){if(r=e[t],typeof r!="string")throw new CKEditorError("collection-add-invalid-id",this);if(this.get(r))throw new CKEditorError("collection-add-item-already-exists",this)}else e[t]=r=uid2();return r}_remove(e){let t,r,i,o=!1;const a=this._idProperty;if(typeof e=="string"?(r=e,i=this._itemMap.get(r),o=!i,i&&(t=this._items.indexOf(i))):typeof e=="number"?(t=e,i=this._items[t],o=!i,i&&(r=i[a])):(i=e,r=i[a],t=this._items.indexOf(i),o=t==-1||!this._itemMap.get(r)),o)throw new CKEditorError("collection-remove-404",this);this._items.splice(t,1),this._itemMap.delete(r);const c=this._bindToInternalToExternalMap.get(i);return this._bindToInternalToExternalMap.delete(i),this._bindToExternalToInternalMap.delete(c),this.fire("remove",i,t),[i,t]}[Symbol.iterator](){return this._items[Symbol.iterator]()}};function first(e){const t=e.next();return t.done?null:t.value}var FocusTracker=class extends DomEmitterMixin(ObservableMixin()){_elements=new Set;_externalViews=new Set;_blurTimeout=null;constructor(){super(),this.set("isFocused",!1),this.set("focusedElement",null)}get elements(){return Array.from(this._elements.values())}get externalViews(){return Array.from(this._externalViews.values())}add(e){if(isElement2(e))this._addElement(e);else if(isViewWithFocusTracker(e))this._addView(e);else{if(!e.element)throw new CKEditorError("focustracker-add-view-missing-element",{focusTracker:this,view:e});this._addElement(e.element)}}remove(e){isElement2(e)?this._removeElement(e):isViewWithFocusTracker(e)?this._removeView(e):this._removeElement(e.element)}_addElement(e){if(this._elements.has(e))throw new CKEditorError("focustracker-add-element-already-exist",this);this.listenTo(e,"focus",()=>{const t=this.externalViews.find(r=>isExternalViewSubtreeFocused(e,r));t?this._focus(t.element):this._focus(e)},{useCapture:!0}),this.listenTo(e,"blur",()=>{this._blur()},{useCapture:!0}),this._elements.add(e)}_removeElement(e){this._elements.has(e)&&(this.stopListening(e),this._elements.delete(e)),e===this.focusedElement&&this._blur()}_addView(e){e.element&&this._addElement(e.element),this.listenTo(e.focusTracker,"change:focusedElement",()=>{e.focusTracker.focusedElement?e.element&&this._focus(e.element):this._blur()}),this._externalViews.add(e)}_removeView(e){e.element&&this._removeElement(e.element),this.stopListening(e.focusTracker),this._externalViews.delete(e)}destroy(){this.stopListening(),this._elements.clear(),this._externalViews.clear(),this.isFocused=!1,this.focusedElement=null}_focus(e){this._clearBlurTimeout(),this.focusedElement=e,this.isFocused=!0}_blur(){this.elements.find(r=>r.contains(document.activeElement))||this.externalViews.find(r=>r.focusTracker.isFocused&&!r.focusTracker._blurTimeout)||(this._clearBlurTimeout(),this._blurTimeout=setTimeout(()=>{this.focusedElement=null,this.isFocused=!1},0))}_clearBlurTimeout(){clearTimeout(this._blurTimeout),this._blurTimeout=null}};function isViewWithFocusTracker(e){return"focusTracker"in e&&e.focusTracker instanceof FocusTracker}function isElement2(e){return isElement_default(e)}function isExternalViewSubtreeFocused(e,t){return isFocusedView(e,t)?!0:!!t.focusTracker.externalViews.find(r=>isFocusedView(e,r))}function isFocusedView(e,t){return!!t.element&&t.element.contains(document.activeElement)&&e.contains(t.element)}var KeystrokeHandler=class{_listener;constructor(){this._listener=new(DomEmitterMixin())}listenTo(e){this._listener.listenTo(e,"keydown",(t,r)=>{this._listener.fire("_keydown:"+getCode(r),r)})}set(e,t,r={}){const i=parseKeystroke(e),o=r.priority;this._listener.listenTo(this._listener,"_keydown:"+i,(a,c)=>{r.filter&&!r.filter(c)||(t(c,()=>{c.preventDefault(),c.stopPropagation(),a.stop()}),a.return=!0)},{priority:o})}press(e){return!!this._listener.fire("_keydown:"+getCode(e),e)}stopListening(e){this._listener.stopListening(e)}destroy(){this.stopListening()}};function objectToMap(e){const t=new Map;for(const r in e)t.set(r,e[r]);return t}function toMap(e){return isIterable(e)?new Map(e):objectToMap(e)}function spliceArray(e,t,r){const i=e.length,o=t.length;for(let a=i-1;a>=r;a--)e[a+o]=e[a];for(let a=0;a<o;a++)e[r+a]=t[a]}function delay(e,t){let r;function i(...o){i.cancel(),r=setTimeout(()=>e(...o),t)}return i.cancel=()=>{clearTimeout(r)},i}function parseBase64EncodedObject(e){try{if(!e.startsWith("ey"))return null;const t=atob(e.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(t)}catch{return null}}function makeCrcTable(){const e=[];for(let t=0;t<256;t++){let r=t;for(let i=0;i<8;i++)r&1?r=3988292384^r>>>1:r=r>>>1;e[t]=r}return e}function crc32(e){const t=Array.isArray(e)?e:[e],r=makeCrcTable();let i=-1;const o=t.map(a=>Array.isArray(a)?a.join(""):String(a)).join("");for(let a=0;a<o.length;a++){const c=o.charCodeAt(a);i=i>>>8^r[(i^c)&255]}return i=(i^-1)>>>0,i.toString(16).padStart(8,"0")}function isCombiningMark(e){return!!e&&e.length==1&&/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(e)}function isHighSurrogateHalf(e){return!!e&&e.length==1&&/[\ud800-\udbff]/.test(e)}function isLowSurrogateHalf(e){return!!e&&e.length==1&&/[\udc00-\udfff]/.test(e)}function isInsideSurrogatePair(e,t){return isHighSurrogateHalf(e.charAt(t-1))&&isLowSurrogateHalf(e.charAt(t))}function isInsideCombinedSymbol(e,t){return isCombiningMark(e.charAt(t))}var EMOJI_PATTERN=buildEmojiRegexp();function isInsideEmojiSequence(e,t){const r=String(e).matchAll(EMOJI_PATTERN);return Array.from(r).some(i=>i.index<t&&t<i.index+i[0].length)}function buildEmojiRegexp(){const e=[/\p{Emoji}[\u{E0020}-\u{E007E}]+\u{E007F}/u,/\p{Emoji}\u{FE0F}?\u{20E3}/u,/\p{Emoji}\u{FE0F}/u,/(?=\p{General_Category=Other_Symbol})\p{Emoji}\p{Emoji_Modifier}*/u],t=/\p{Regional_Indicator}{2}/u.source,r="(?:"+e.map(o=>o.source).join("|")+")",i=`${t}|${r}(?:\u200D${r})*`;return new RegExp(i,"ug")}var documentPlaceholders=new WeakMap,hasDisplayedPlaceholderDeprecationWarning=!1;function enablePlaceholder({view:e,element:t,text:r,isDirectHost:i=!0,keepOnFocus:o=!1}){const a=e.document;documentPlaceholders.has(a)||(documentPlaceholders.set(a,new Map),a.registerPostFixer(u=>updateDocumentPlaceholders(a,u)),a.on("change:isComposing",()=>{e.change(u=>updateDocumentPlaceholders(a,u))},{priority:"high"})),t.is("editableElement")&&t.on("change:placeholder",(u,h,d)=>{c(d)}),t.placeholder?c(t.placeholder):r&&c(r),r&&showPlaceholderTextDeprecationWarning();function c(u){documentPlaceholders.get(a).set(t,{text:u,isDirectHost:i,keepOnFocus:o,hostElement:i?t:null}),e.change(h=>updateDocumentPlaceholders(a,h))}}function showPlaceholder(e,t){return t.hasClass("ck-placeholder")?!1:(e.addClass("ck-placeholder",t),!0)}function hidePlaceholder(e,t){return t.hasClass("ck-placeholder")?(e.removeClass("ck-placeholder",t),!0):!1}function needsPlaceholder(e,t){if(!e.isAttached()||Array.from(e.getChildren()).some(c=>!c.is("uiElement")))return!1;const i=e.document,a=i.selection.anchor;return i.isComposing&&a&&a.parent===e?!1:t||!i.isFocused?!0:!!a&&a.parent!==e}function updateDocumentPlaceholders(e,t){const r=documentPlaceholders.get(e),i=[];let o=!1;for(const[a,c]of r)c.isDirectHost&&(i.push(a),updatePlaceholder(t,a,c)&&(o=!0));for(const[a,c]of r){if(c.isDirectHost)continue;const u=getChildPlaceholderHostSubstitute(a);u&&(i.includes(u)||(c.hostElement=u,updatePlaceholder(t,a,c)&&(o=!0)))}return o}function updatePlaceholder(e,t,r){const{text:i,isDirectHost:o,hostElement:a}=r;let c=!1;return a.getAttribute("data-placeholder")!==i&&(e.setAttribute("data-placeholder",i,a),c=!0),(o||t.childCount==1)&&needsPlaceholder(a,r.keepOnFocus)?showPlaceholder(e,a)&&(c=!0):hidePlaceholder(e,a)&&(c=!0),c}function getChildPlaceholderHostSubstitute(e){if(e.childCount){const t=e.getChild(0);if(t.is("element")&&!t.is("uiElement")&&!t.is("attributeElement"))return t}return null}function showPlaceholderTextDeprecationWarning(){hasDisplayedPlaceholderDeprecationWarning||logWarning("enableplaceholder-deprecated-text-option"),hasDisplayedPlaceholderDeprecationWarning=!0}var TypeCheckable$1=class{is(){throw new Error("is() method is abstract")}},Node$2=class extends EmitterMixin(TypeCheckable$1){document;parent;constructor(t){super(),this.document=t,this.parent=null}get index(){let t;if(!this.parent)return null;if((t=this.parent.getChildIndex(this))==-1)throw new CKEditorError("view-node-not-found-in-parent",this);return t}get nextSibling(){const t=this.index;return t!==null&&this.parent.getChild(t+1)||null}get previousSibling(){const t=this.index;return t!==null&&this.parent.getChild(t-1)||null}get root(){let t=this;for(;t.parent;)t=t.parent;return t}isAttached(){return this.root.is("rootElement")}getPath(){const t=[];let r=this;for(;r.parent;)t.unshift(r.index),r=r.parent;return t}getAncestors(t={}){const r=[];let i=t.includeSelf?this:this.parent;for(;i;)r[t.parentFirst?"push":"unshift"](i),i=i.parent;return r}getCommonAncestor(t,r={}){const i=this.getAncestors(r),o=t.getAncestors(r);let a=0;for(;i[a]==o[a]&&i[a];)a++;return a===0?null:i[a-1]}isBefore(t){if(this==t||this.root!==t.root)return!1;const r=this.getPath(),i=t.getPath(),o=compareArrays(r,i);switch(o){case"prefix":return!0;case"extension":return!1;default:return r[o]<i[o]}}isAfter(t){return this==t||this.root!==t.root?!1:!this.isBefore(t)}_remove(){this.parent._removeChildren(this.index)}_fireChange(t,r){this.fire(`change:${t}`,r),this.parent&&this.parent._fireChange(t,r)}toJSON(){const t=clone_default2(this);return delete t.parent,t}};Node$2.prototype.is=function(e){return e==="node"||e==="view:node"};var Text$1=class ui extends Node$2{_textData;constructor(t,r){super(t),this._textData=r}get data(){return this._textData}get _data(){return this.data}set _data(t){this._fireChange("text",this),this._textData=t}isSimilar(t){return t instanceof ui?this===t||this.data===t.data:!1}_clone(){return new ui(this.document,this.data)}};Text$1.prototype.is=function(e){return e==="$text"||e==="view:$text"||e==="text"||e==="view:text"||e==="node"||e==="view:node"};var TextProxy$1=class extends TypeCheckable$1{textNode;data;offsetInText;constructor(t,r,i){if(super(),this.textNode=t,r<0||r>t.data.length)throw new CKEditorError("view-textproxy-wrong-offsetintext",this);if(i<0||r+i>t.data.length)throw new CKEditorError("view-textproxy-wrong-length",this);this.data=t.data.substring(r,r+i),this.offsetInText=r}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}getAncestors(t={}){const r=[];let i=t.includeSelf?this.textNode:this.parent;for(;i!==null;)r[t.parentFirst?"push":"unshift"](i),i=i.parent;return r}};TextProxy$1.prototype.is=function(e){return e==="$textProxy"||e==="view:$textProxy"||e==="textProxy"||e==="view:textProxy"};var Matcher=class{_patterns=[];constructor(...e){this.add(...e)}add(...e){for(let t of e)(typeof t=="string"||t instanceof RegExp)&&(t={name:t}),this._patterns.push(t)}match(...e){for(const t of e)for(const r of this._patterns){const i=isElementMatching(t,r);if(i)return{element:t,pattern:r,match:i}}return null}matchAll(...e){const t=[];for(const r of e)for(const i of this._patterns){const o=isElementMatching(r,i);o&&t.push({element:r,pattern:i,match:o})}return t.length>0?t:null}getElementName(){if(this._patterns.length!==1)return null;const e=this._patterns[0],t=e.name;return typeof e!="function"&&t&&!(t instanceof RegExp)?t:null}};function isElementMatching(e,t){if(typeof t=="function")return t(e);const r={};return t.name&&(r.name=matchName(t.name,e.name),!r.name)||t.attributes&&(r.attributes=matchAttributes(t.attributes,e),!r.attributes)||t.classes&&(r.classes=matchClasses(t.classes,e),!r.classes)||t.styles&&(r.styles=matchStyles(t.styles,e),!r.styles)?null:r}function matchName(e,t){return e instanceof RegExp?!!t.match(e):e===t}function matchPatterns(e,t,r){const i=normalizePatterns(e),o=Array.from(t),a=[];if(i.forEach(([c,u])=>{o.forEach(h=>{isKeyMatched(c,h)&&isValueMatched(u,h,r)&&a.push(h)})}),!(!i.length||a.length<i.length))return a}function normalizePatterns(e){if(Array.isArray(e))return e.map(r=>typeof r!="object"||r instanceof RegExp?[r,!0]:((r.key===void 0||r.value===void 0)&&logWarning("matcher-pattern-missing-key-or-value",r),[r.key,r.value]));if(typeof e!="object"||e instanceof RegExp)return[[e,!0]];const t=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push([r,e[r]]);return t}function isKeyMatched(e,t){return e===!0||e===t||e instanceof RegExp&&t.match(e)}function isValueMatched(e,t,r){if(e===!0)return!0;const i=r(t);return e===i||e instanceof RegExp&&!!String(i).match(e)}function matchAttributes(e,t){const r=new Set(t.getAttributeKeys());return typeof e=="object"&&!(e instanceof RegExp)&&!Array.isArray(e)?(e.style!==void 0&&logWarning("matcher-pattern-deprecated-attributes-style-key",e),e.class!==void 0&&logWarning("matcher-pattern-deprecated-attributes-class-key",e)):(r.delete("style"),r.delete("class")),matchPatterns(e,r,i=>t.getAttribute(i))}function matchClasses(e,t){return matchPatterns(e,t.getClassNames(),()=>{})}function matchStyles(e,t){return matchPatterns(e,t.getStyleNames(!0),r=>t.getStyle(r))}var StylesMap=class{_styles;_cachedStyleNames=null;_cachedExpandedStyleNames=null;_styleProcessor;constructor(e){this._styles={},this._styleProcessor=e}get isEmpty(){return!Object.entries(this._styles).length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(e){this.clear();const t=parseInlineStyles(e);for(const[r,i]of t)this._styleProcessor.toNormalizedForm(r,i,this._styles)}has(e){if(this.isEmpty)return!1;const r=this._styleProcessor.getReducedForm(e,this._styles).find(([i])=>i===e);return Array.isArray(r)}set(e,t){if(this._cachedStyleNames=null,this._cachedExpandedStyleNames=null,isObject_default(e))for(const[r,i]of Object.entries(e))this._styleProcessor.toNormalizedForm(r,i,this._styles);else this._styleProcessor.toNormalizedForm(e,t,this._styles)}remove(e){this._cachedStyleNames=null,this._cachedExpandedStyleNames=null;const t=toPath(e);unset_default(this._styles,t),delete this._styles[e],this._cleanEmptyObjectsOnPath(t)}getNormalized(e){return this._styleProcessor.getNormalized(e,this._styles)}toString(){return this.isEmpty?"":this.getStylesEntries().map(e=>e.join(":")).sort().join(";")+";"}getAsString(e){if(this.isEmpty)return;if(this._styles[e]&&!isObject_default(this._styles[e]))return this._styles[e];const r=this._styleProcessor.getReducedForm(e,this._styles).find(([i])=>i===e);if(Array.isArray(r))return r[1]}getStyleNames(e=!1){return this.isEmpty?[]:e?(this._cachedExpandedStyleNames=this._cachedExpandedStyleNames||this._styleProcessor.getStyleNames(this._styles),this._cachedExpandedStyleNames):(this._cachedStyleNames=this._cachedStyleNames||this.getStylesEntries().map(([t])=>t),this._cachedStyleNames)}clear(){this._styles={},this._cachedStyleNames=null,this._cachedExpandedStyleNames=null}getStylesEntries(){const e=[],t=Object.keys(this._styles);for(const r of t)e.push(...this._styleProcessor.getReducedForm(r,this._styles));return e}_cleanEmptyObjectsOnPath(e){const t=e.split(".");if(!(t.length>1))return;const i=t.splice(0,t.length-1).join("."),o=get_default(this._styles,i);if(!o)return;!Object.keys(o).length&&this.remove(i)}},StylesProcessor=class{_normalizers;_extractors;_reducers;_consumables;constructor(){this._normalizers=new Map,this._extractors=new Map,this._reducers=new Map,this._consumables=new Map}toNormalizedForm(e,t,r){if(isObject_default(t)){appendStyleValue(r,toPath(e),t);return}if(this._normalizers.has(e)){const i=this._normalizers.get(e),{path:o,value:a}=i(t);appendStyleValue(r,o,a)}else appendStyleValue(r,e,t)}getNormalized(e,t){if(!e)return merge_default3({},t);if(t[e]!==void 0)return t[e];if(this._extractors.has(e)){const r=this._extractors.get(e);if(typeof r=="string")return get_default(t,r);const i=r(e,t);if(i)return i}return get_default(t,toPath(e))}getReducedForm(e,t){const r=this.getNormalized(e,t);return r===void 0?[]:this._reducers.has(e)?this._reducers.get(e)(r):[[e,r]]}getStyleNames(e){const t=new Set;for(const r of this._consumables.keys()){const i=this.getNormalized(r,e);i&&(typeof i!="object"||Object.keys(i).length)&&t.add(r)}for(const r of Object.keys(e))t.add(r);return Array.from(t)}getRelatedStyles(e){return this._consumables.get(e)||[]}setNormalizer(e,t){this._normalizers.set(e,t)}setExtractor(e,t){this._extractors.set(e,t)}setReducer(e,t){this._reducers.set(e,t)}setStyleRelation(e,t){this._mapStyleNames(e,t);for(const r of t)this._mapStyleNames(r,[e])}_mapStyleNames(e,t){this._consumables.has(e)||this._consumables.set(e,[]),this._consumables.get(e).push(...t)}};function parseInlineStyles(e){let t=null,r=0,i=0,o=null;const a=new Map;if(e==="")return a;e.charAt(e.length-1)!=";"&&(e=e+";");for(let c=0;c<e.length;c++){const u=e.charAt(c);if(t===null)switch(u){case":":o||(o=e.substr(r,c-r),i=c+1);break;case'"':case"'":t=u;break;case";":{const h=e.substr(i,c-i);o&&a.set(o.trim(),h.trim()),o=null,r=c+1;break}}else u===t&&(t=null)}return a}function toPath(e){return e.replace("-",".")}function appendStyleValue(e,t,r){let i=r;isObject_default(r)&&(i=merge_default3({},get_default(e,t),r)),set_default(e,t,i)}var Element$1=class ps extends Node$2{name;_unsafeAttributesToRender=[];_attrs;_children;_classes;_styles;_customProperties=new Map;constructor(t,r,i,o){if(super(t),this.name=r,this._attrs=parseAttributes(i),this._children=[],o&&this._insertChild(0,o),this._classes=new Set,this._attrs.has("class")){const a=this._attrs.get("class");parseClasses(this._classes,a),this._attrs.delete("class")}this._styles=new StylesMap(this.document.stylesProcessor),this._attrs.has("style")&&(this._styles.setTo(this._attrs.get("style")),this._attrs.delete("style"))}get childCount(){return this._children.length}get isEmpty(){return this._children.length===0}getChild(t){return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes.size>0&&(yield"class"),this._styles.isEmpty||(yield"style"),yield*this._attrs.keys()}*getAttributes(){yield*this._attrs.entries(),this._classes.size>0&&(yield["class",this.getAttribute("class")]),this._styles.isEmpty||(yield["style",this.getAttribute("style")])}getAttribute(t){if(t=="class")return this._classes.size>0?[...this._classes].join(" "):void 0;if(t=="style"){const r=this._styles.toString();return r==""?void 0:r}return this._attrs.get(t)}hasAttribute(t){return t=="class"?this._classes.size>0:t=="style"?!this._styles.isEmpty:this._attrs.has(t)}isSimilar(t){if(!(t instanceof ps))return!1;if(this===t)return!0;if(this.name!=t.name||this._attrs.size!==t._attrs.size||this._classes.size!==t._classes.size||this._styles.size!==t._styles.size)return!1;for(const[r,i]of this._attrs)if(!t._attrs.has(r)||t._attrs.get(r)!==i)return!1;for(const r of this._classes)if(!t._classes.has(r))return!1;for(const r of this._styles.getStyleNames())if(!t._styles.has(r)||t._styles.getAsString(r)!==this._styles.getAsString(r))return!1;return!0}hasClass(...t){for(const r of t)if(!this._classes.has(r))return!1;return!0}getClassNames(){return this._classes.keys()}getStyle(t){return this._styles.getAsString(t)}getNormalizedStyle(t){return this._styles.getNormalized(t)}getStyleNames(t){return this._styles.getStyleNames(t)}hasStyle(...t){for(const r of t)if(!this._styles.has(r))return!1;return!0}findAncestor(...t){const r=new Matcher(...t);let i=this.parent;for(;i&&!i.is("documentFragment");){if(r.match(i))return i;i=i.parent}return null}getCustomProperty(t){return this._customProperties.get(t)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const t=Array.from(this._classes).sort().join(","),r=this._styles.toString(),i=Array.from(this._attrs).map(o=>`${o[0]}="${o[1]}"`).sort().join(" ");return this.name+(t==""?"":` class="${t}"`)+(r?` style="${r}"`:"")+(i==""?"":` ${i}`)}shouldRenderUnsafeAttribute(t){return this._unsafeAttributesToRender.includes(t)}_clone(t=!1){const r=[];if(t)for(const o of this.getChildren())r.push(o._clone(t));const i=new this.constructor(this.document,this.name,this._attrs,r);return i._classes=new Set(this._classes),i._styles.set(this._styles.getNormalized()),i._customProperties=new Map(this._customProperties),i.getFillerOffset=this.getFillerOffset,i._unsafeAttributesToRender=this._unsafeAttributesToRender,i}_appendChild(t){return this._insertChild(this.childCount,t)}_insertChild(t,r){this._fireChange("children",this);let i=0;const o=normalize$3(this.document,r);for(const a of o)a.parent!==null&&a._remove(),a.parent=this,a.document=this.document,this._children.splice(t,0,a),t++,i++;return i}_removeChildren(t,r=1){this._fireChange("children",this);for(let i=t;i<t+r;i++)this._children[i].parent=null;return this._children.splice(t,r)}_setAttribute(t,r){const i=String(r);this._fireChange("attributes",this),t=="class"?parseClasses(this._classes,i):t=="style"?this._styles.setTo(i):this._attrs.set(t,i)}_removeAttribute(t){return this._fireChange("attributes",this),t=="class"?this._classes.size>0?(this._classes.clear(),!0):!1:t=="style"?this._styles.isEmpty?!1:(this._styles.clear(),!0):this._attrs.delete(t)}_addClass(t){this._fireChange("attributes",this);for(const r of toArray(t))this._classes.add(r)}_removeClass(t){this._fireChange("attributes",this);for(const r of toArray(t))this._classes.delete(r)}_setStyle(t,r){this._fireChange("attributes",this),typeof t!="string"?this._styles.set(t):this._styles.set(t,r)}_removeStyle(t){this._fireChange("attributes",this);for(const r of toArray(t))this._styles.remove(r)}_setCustomProperty(t,r){this._customProperties.set(t,r)}_removeCustomProperty(t){return this._customProperties.delete(t)}};Element$1.prototype.is=function(e,t){return t?t===this.name&&(e==="element"||e==="view:element"):e==="element"||e==="view:element"||e==="node"||e==="view:node"};function parseAttributes(e){const t=toMap(e);for(const[r,i]of t)i===null?t.delete(r):typeof i!="string"&&t.set(r,String(i));return t}function parseClasses(e,t){const r=t.split(/\s+/);e.clear(),r.forEach(i=>e.add(i))}function normalize$3(e,t){if(typeof t=="string")return[new Text$1(e,t)];isIterable(t)||(t=[t]);const r=[];for(const i of t)typeof i=="string"?r.push(new Text$1(e,i)):i instanceof TextProxy$1?r.push(new Text$1(e,i.data)):r.push(i);return r}var ContainerElement=class extends Element$1{constructor(e,t,r,i){super(e,t,r,i),this.getFillerOffset=getFillerOffset$4}};ContainerElement.prototype.is=function(e,t){return t?t===this.name&&(e==="containerElement"||e==="view:containerElement"||e==="element"||e==="view:element"):e==="containerElement"||e==="view:containerElement"||e==="element"||e==="view:element"||e==="node"||e==="view:node"};function getFillerOffset$4(){const e=[...this.getChildren()],t=e[this.childCount-1];if(t&&t.is("element","br"))return this.childCount;for(const r of e)if(!r.is("uiElement"))return null;return this.childCount}var EditableElement=class extends ObservableMixin(ContainerElement){constructor(e,t,r,i){super(e,t,r,i),this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("placeholder",void 0),this.bind("isReadOnly").to(e),this.bind("isFocused").to(e,"isFocused",o=>o&&e.selection.editableElement==this),this.listenTo(e.selection,"change",()=>{this.isFocused=e.isFocused&&e.selection.editableElement==this})}destroy(){this.stopListening()}};EditableElement.prototype.is=function(e,t){return t?t===this.name&&(e==="editableElement"||e==="view:editableElement"||e==="containerElement"||e==="view:containerElement"||e==="element"||e==="view:element"):e==="editableElement"||e==="view:editableElement"||e==="containerElement"||e==="view:containerElement"||e==="element"||e==="view:element"||e==="node"||e==="view:node"};var rootNameSymbol=Symbol("rootName"),RootEditableElement=class extends EditableElement{constructor(e,t){super(e,t),this.rootName="main"}get rootName(){return this.getCustomProperty(rootNameSymbol)}set rootName(e){this._setCustomProperty(rootNameSymbol,e)}set _name(e){this.name=e}};RootEditableElement.prototype.is=function(e,t){return t?t===this.name&&(e==="rootElement"||e==="view:rootElement"||e==="editableElement"||e==="view:editableElement"||e==="containerElement"||e==="view:containerElement"||e==="element"||e==="view:element"):e==="rootElement"||e==="view:rootElement"||e==="editableElement"||e==="view:editableElement"||e==="containerElement"||e==="view:containerElement"||e==="element"||e==="view:element"||e==="node"||e==="view:node"};var TreeWalker$1=class{direction;boundaries;singleCharacters;shallow;ignoreElementEnd;_position;_boundaryStartParent;_boundaryEndParent;constructor(t={}){if(!t.boundaries&&!t.startPosition)throw new CKEditorError("view-tree-walker-no-start-position",null);if(t.direction&&t.direction!="forward"&&t.direction!="backward")throw new CKEditorError("view-tree-walker-unknown-direction",t.startPosition,{direction:t.direction});this.boundaries=t.boundaries||null,t.startPosition?this._position=Position$1._createAt(t.startPosition):this._position=Position$1._createAt(t.boundaries[t.direction=="backward"?"end":"start"]),this.direction=t.direction||"forward",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}get position(){return this._position}skip(t){let r,i;do i=this.position,r=this.next();while(!r.done&&t(r.value));r.done||(this._position=i)}next(){return this.direction=="forward"?this._next():this._previous()}_next(){let t=this.position.clone();const r=this.position,i=t.parent;if(i.parent===null&&t.offset===i.childCount)return{done:!0,value:void 0};if(i===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0,value:void 0};let o;if(i&&i.is("view:$text")){if(t.isAtEnd)return this._position=Position$1._createAfter(i),this._next();o=i.data[t.offset]}else o=i.getChild(t.offset);if(typeof o=="string"){let a;this.singleCharacters?a=1:a=(i===this._boundaryEndParent?this.boundaries.end.offset:i.data.length)-t.offset;const c=new TextProxy$1(i,t.offset,a);return t.offset+=a,this._position=t,this._formatReturnValue("text",c,r,t,a)}if(o&&o.is("view:element")){if(!this.shallow)t=new Position$1(o,0);else{if(this.boundaries&&this.boundaries.end.isBefore(t))return{done:!0,value:void 0};t.offset++}return this._position=t,this._formatReturnValue("elementStart",o,r,t,1)}if(o&&o.is("view:$text")){if(this.singleCharacters)return t=new Position$1(o,0),this._position=t,this._next();let a=o.data.length,c;return o==this._boundaryEndParent?(a=this.boundaries.end.offset,c=new TextProxy$1(o,0,a),t=Position$1._createAfter(c)):(c=new TextProxy$1(o,0,o.data.length),t.offset++),this._position=t,this._formatReturnValue("text",c,r,t,a)}return t=Position$1._createAfter(i),this._position=t,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",i,r,t)}_previous(){let t=this.position.clone();const r=this.position,i=t.parent;if(i.parent===null&&t.offset===0)return{done:!0,value:void 0};if(i==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0,value:void 0};let o;if(i.is("view:$text")){if(t.isAtStart)return this._position=Position$1._createBefore(i),this._previous();o=i.data[t.offset-1]}else o=i.getChild(t.offset-1);if(typeof o=="string"){let a;if(this.singleCharacters)a=1;else{const u=i===this._boundaryStartParent?this.boundaries.start.offset:0;a=t.offset-u}t.offset-=a;const c=new TextProxy$1(i,t.offset,a);return this._position=t,this._formatReturnValue("text",c,r,t,a)}if(o&&o.is("view:element"))return this.shallow?(t.offset--,this._position=t,this._formatReturnValue("elementStart",o,r,t,1)):(t=new Position$1(o,o.childCount),this._position=t,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",o,r,t));if(o&&o.is("view:$text")){if(this.singleCharacters)return t=new Position$1(o,o.data.length),this._position=t,this._previous();let a=o.data.length,c;if(o==this._boundaryStartParent){const u=this.boundaries.start.offset;c=new TextProxy$1(o,u,o.data.length-u),a=c.data.length,t=Position$1._createBefore(c)}else c=new TextProxy$1(o,0,o.data.length),t.offset--;return this._position=t,this._formatReturnValue("text",c,r,t,a)}return t=Position$1._createBefore(i),this._position=t,this._formatReturnValue("elementStart",i,r,t,1)}_formatReturnValue(t,r,i,o,a){return r.is("view:$textProxy")&&(r.offsetInText+r.data.length==r.textNode.data.length&&(this.direction=="forward"&&!(this.boundaries&&this.boundaries.end.isEqual(this.position))?(o=Position$1._createAfter(r.textNode),this._position=o):i=Position$1._createAfter(r.textNode)),r.offsetInText===0&&(this.direction=="backward"&&!(this.boundaries&&this.boundaries.start.isEqual(this.position))?(o=Position$1._createBefore(r.textNode),this._position=o):i=Position$1._createBefore(r.textNode))),{done:!1,value:{type:t,item:r,previousPosition:i,nextPosition:o,length:a}}}},Position$1=class Qt extends TypeCheckable$1{parent;offset;constructor(t,r){super(),this.parent=t,this.offset=r}get nodeAfter(){return this.parent.is("$text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("$text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return this.offset===0}get isAtEnd(){const t=this.parent.is("$text")?this.parent.data.length:this.parent.childCount;return this.offset===t}get root(){return this.parent.root}get editableElement(){let t=this.parent;for(;!(t instanceof EditableElement);)if(t.parent)t=t.parent;else return null;return t}getShiftedBy(t){const r=Qt._createAt(this),i=r.offset+t;return r.offset=i<0?0:i,r}getLastMatchingPosition(t,r={}){r.startPosition=this;const i=new TreeWalker$1(r);return i.skip(t),i.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(t){const r=this.getAncestors(),i=t.getAncestors();let o=0;for(;r[o]==i[o]&&r[o];)o++;return o===0?null:r[o-1]}isEqual(t){return this.parent==t.parent&&this.offset==t.offset}isBefore(t){return this.compareWith(t)=="before"}isAfter(t){return this.compareWith(t)=="after"}compareWith(t){if(this.root!==t.root)return"different";if(this.isEqual(t))return"same";const r=this.parent.is("node")?this.parent.getPath():[],i=t.parent.is("node")?t.parent.getPath():[];r.push(this.offset),i.push(t.offset);const o=compareArrays(r,i);switch(o){case"prefix":return"before";case"extension":return"after";default:return r[o]<i[o]?"before":"after"}}getWalker(t={}){return t.startPosition=this,new TreeWalker$1(t)}clone(){return new Qt(this.parent,this.offset)}static _createAt(t,r){if(t instanceof Qt)return new this(t.parent,t.offset);{const i=t;if(r=="end")r=i.is("$text")?i.data.length:i.childCount;else{if(r=="before")return this._createBefore(i);if(r=="after")return this._createAfter(i);if(r!==0&&!r)throw new CKEditorError("view-createpositionat-offset-required",i)}return new Qt(i,r)}}static _createAfter(t){if(t.is("$textProxy"))return new Qt(t.textNode,t.offsetInText+t.data.length);if(!t.parent)throw new CKEditorError("view-position-after-root",t,{root:t});return new Qt(t.parent,t.index+1)}static _createBefore(t){if(t.is("$textProxy"))return new Qt(t.textNode,t.offsetInText);if(!t.parent)throw new CKEditorError("view-position-before-root",t,{root:t});return new Qt(t.parent,t.index)}};Position$1.prototype.is=function(e){return e==="position"||e==="view:position"};var Range$1=class cr extends TypeCheckable$1{start;end;constructor(t,r=null){super(),this.start=t.clone(),this.end=r?r.clone():t.clone()}*[Symbol.iterator](){yield*new TreeWalker$1({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let t=this.start.getLastMatchingPosition(enlargeTrimSkip,{direction:"backward"}),r=this.end.getLastMatchingPosition(enlargeTrimSkip);return t.parent.is("$text")&&t.isAtStart&&(t=Position$1._createBefore(t.parent)),r.parent.is("$text")&&r.isAtEnd&&(r=Position$1._createAfter(r.parent)),new cr(t,r)}getTrimmed(){let t=this.start.getLastMatchingPosition(enlargeTrimSkip);if(t.isAfter(this.end)||t.isEqual(this.end))return new cr(t,t);let r=this.end.getLastMatchingPosition(enlargeTrimSkip,{direction:"backward"});const i=t.nodeAfter,o=r.nodeBefore;return i&&i.is("$text")&&(t=new Position$1(i,0)),o&&o.is("$text")&&(r=new Position$1(o,o.data.length)),new cr(t,r)}isEqual(t){return this==t||this.start.isEqual(t.start)&&this.end.isEqual(t.end)}containsPosition(t){return t.isAfter(this.start)&&t.isBefore(this.end)}containsRange(t,r=!1){t.isCollapsed&&(r=!1);const i=this.containsPosition(t.start)||r&&this.start.isEqual(t.start),o=this.containsPosition(t.end)||r&&this.end.isEqual(t.end);return i&&o}getDifference(t){const r=[];return this.isIntersecting(t)?(this.containsPosition(t.start)&&r.push(new cr(this.start,t.start)),this.containsPosition(t.end)&&r.push(new cr(t.end,this.end))):r.push(this.clone()),r}getIntersection(t){if(this.isIntersecting(t)){let r=this.start,i=this.end;return this.containsPosition(t.start)&&(r=t.start),this.containsPosition(t.end)&&(i=t.end),new cr(r,i)}return null}getWalker(t={}){return t.boundaries=this,new TreeWalker$1(t)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let t=this.start.nodeAfter,r=this.end.nodeBefore;return this.start.parent.is("$text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(t=this.start.parent.nextSibling),this.end.parent.is("$text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(r=this.end.parent.previousSibling),t&&t.is("element")&&t===r?t:null}clone(){return new cr(this.start,this.end)}*getItems(t={}){t.boundaries=this,t.ignoreElementEnd=!0;const r=new TreeWalker$1(t);for(const i of r)yield i.item}*getPositions(t={}){t.boundaries=this;const r=new TreeWalker$1(t);yield r.position;for(const i of r)yield i.nextPosition}isIntersecting(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}static _createFromParentsAndOffsets(t,r,i,o){return new this(new Position$1(t,r),new Position$1(i,o))}static _createFromPositionAndShift(t,r){const i=t,o=t.getShiftedBy(r);return r>0?new this(i,o):new this(o,i)}static _createIn(t){return this._createFromParentsAndOffsets(t,0,t,t.childCount)}static _createOn(t){const r=t.is("$textProxy")?t.offsetSize:1;return this._createFromPositionAndShift(Position$1._createBefore(t),r)}};Range$1.prototype.is=function(e){return e==="range"||e==="view:range"};function enlargeTrimSkip(e){return!!(e.item.is("attributeElement")||e.item.is("uiElement"))}var Selection$1=class vs extends EmitterMixin(TypeCheckable$1){_ranges;_lastRangeBackward;_isFake;_fakeSelectionLabel;constructor(...t){super(),this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",t.length&&this.setTo(...t)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const t=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?t.end:t.start).clone()}get focus(){if(!this._ranges.length)return null;const t=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?t.start:t.end).clone()}get isCollapsed(){return this.rangeCount===1&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const t of this._ranges)yield t.clone()}getFirstRange(){let t=null;for(const r of this._ranges)(!t||r.start.isBefore(t.start))&&(t=r);return t?t.clone():null}getLastRange(){let t=null;for(const r of this._ranges)(!t||r.end.isAfter(t.end))&&(t=r);return t?t.clone():null}getFirstPosition(){const t=this.getFirstRange();return t?t.start.clone():null}getLastPosition(){const t=this.getLastRange();return t?t.end.clone():null}isEqual(t){if(this.isFake!=t.isFake||this.isFake&&this.fakeSelectionLabel!=t.fakeSelectionLabel||this.rangeCount!=t.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(t.anchor)||!this.focus.isEqual(t.focus))return!1;for(const r of this._ranges){let i=!1;for(const o of t._ranges)if(r.isEqual(o)){i=!0;break}if(!i)return!1}return!0}isSimilar(t){if(this.isBackward!=t.isBackward)return!1;const r=count(this.getRanges()),i=count(t.getRanges());if(r!=i)return!1;if(r==0)return!0;for(let o of this.getRanges()){o=o.getTrimmed();let a=!1;for(let c of t.getRanges())if(c=c.getTrimmed(),o.start.isEqual(c.start)&&o.end.isEqual(c.end)){a=!0;break}if(!a)return!1}return!0}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}setTo(...t){let[r,i,o]=t;if(typeof i=="object"&&(o=i,i=void 0),r===null)this._setRanges([]),this._setFakeOptions(o);else if(r instanceof vs||r instanceof DocumentSelection$1)this._setRanges(r.getRanges(),r.isBackward),this._setFakeOptions({fake:r.isFake,label:r.fakeSelectionLabel});else if(r instanceof Range$1)this._setRanges([r],o&&o.backward),this._setFakeOptions(o);else if(r instanceof Position$1)this._setRanges([new Range$1(r)]),this._setFakeOptions(o);else if(r instanceof Node$2){const a=!!o&&!!o.backward;let c;if(i===void 0)throw new CKEditorError("view-selection-setto-required-second-parameter",this);i=="in"?c=Range$1._createIn(r):i=="on"?c=Range$1._createOn(r):c=new Range$1(Position$1._createAt(r,i)),this._setRanges([c],a),this._setFakeOptions(o)}else if(isIterable(r))this._setRanges(r,o&&o.backward),this._setFakeOptions(o);else throw new CKEditorError("view-selection-setto-not-selectable",this);this.fire("change")}setFocus(t,r){if(this.anchor===null)throw new CKEditorError("view-selection-setfocus-no-ranges",this);const i=Position$1._createAt(t,r);if(i.compareWith(this.focus)=="same")return;const o=this.anchor;this._ranges.pop(),i.compareWith(o)=="before"?this._addRange(new Range$1(i,o),!0):this._addRange(new Range$1(o,i)),this.fire("change")}_setRanges(t,r=!1){t=Array.from(t),this._ranges=[];for(const i of t)this._addRange(i);this._lastRangeBackward=!!r}_setFakeOptions(t={}){this._isFake=!!t.fake,this._fakeSelectionLabel=t.fake&&t.label||""}_addRange(t,r=!1){if(!(t instanceof Range$1))throw new CKEditorError("view-selection-add-range-not-range",this);this._pushRange(t),this._lastRangeBackward=!!r}_pushRange(t){for(const r of this._ranges)if(t.isIntersecting(r))throw new CKEditorError("view-selection-range-intersects",this,{addedRange:t,intersectingRange:r});this._ranges.push(new Range$1(t.start,t.end))}};Selection$1.prototype.is=function(e){return e==="selection"||e==="view:selection"};var DocumentSelection$1=class extends EmitterMixin(TypeCheckable$1){_selection;constructor(...t){super(),this._selection=new Selection$1,this._selection.delegate("change").to(this),t.length&&this._selection.setTo(...t)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(t){return this._selection.isEqual(t)}isSimilar(t){return this._selection.isSimilar(t)}_setTo(...t){this._selection.setTo(...t)}_setFocus(t,r){this._selection.setFocus(t,r)}};DocumentSelection$1.prototype.is=function(e){return e==="selection"||e=="documentSelection"||e=="view:selection"||e=="view:documentSelection"};var BubblingEventInfo=class extends EventInfo{startRange;_eventPhase;_currentTarget;constructor(e,t,r){super(e,t),this.startRange=r,this._eventPhase="none",this._currentTarget=null}get eventPhase(){return this._eventPhase}get currentTarget(){return this._currentTarget}},contextsSymbol=Symbol("bubbling contexts");function BubblingEmitterMixin(e){class t extends e{fire(i,...o){try{const a=i instanceof EventInfo?i:new EventInfo(this,i),c=getBubblingContexts(this);if(!c.size)return;if(updateEventInfo(a,"capturing",this),fireListenerFor(c,"$capture",a,...o))return a.return;const u=a.startRange||this.selection.getFirstRange(),h=u?u.getContainedElement():null,d=h?!!getCustomContext(c,h):!1;let f=h||getDeeperRangeParent(u);if(updateEventInfo(a,"atTarget",f),!d){if(fireListenerFor(c,"$text",a,...o))return a.return;updateEventInfo(a,"bubbling",f)}for(;f;){if(f.is("rootElement")){if(fireListenerFor(c,"$root",a,...o))return a.return}else if(f.is("element")&&fireListenerFor(c,f.name,a,...o))return a.return;if(fireListenerFor(c,f,a,...o))return a.return;f=f.parent,updateEventInfo(a,"bubbling",f)}return updateEventInfo(a,"bubbling",this),fireListenerFor(c,"$document",a,...o),a.return}catch(a){CKEditorError.rethrowUnexpectedError(a,this)}}_addEventListener(i,o,a){const c=toArray(a.context||"$document"),u=getBubblingContexts(this);for(const h of c){let d=u.get(h);d||(d=new(EmitterMixin()),u.set(h,d)),this.listenTo(d,i,o,a)}}_removeEventListener(i,o){const a=getBubblingContexts(this);for(const c of a.values())this.stopListening(c,i,o)}}return t}{const e=BubblingEmitterMixin(Object);["fire","_addEventListener","_removeEventListener"].forEach(t=>{BubblingEmitterMixin[t]=e.prototype[t]})}function updateEventInfo(e,t,r){e instanceof BubblingEventInfo&&(e._eventPhase=t,e._currentTarget=r)}function fireListenerFor(e,t,r,...i){const o=typeof t=="string"?e.get(t):getCustomContext(e,t);return o?(o.fire(r,...i),r.stop.called):!1}function getCustomContext(e,t){for(const[r,i]of e)if(typeof r=="function"&&r(t))return i;return null}function getBubblingContexts(e){return e[contextsSymbol]||(e[contextsSymbol]=new Map),e[contextsSymbol]}function getDeeperRangeParent(e){if(!e)return null;const t=e.start.parent,r=e.end.parent,i=t.getPath(),o=r.getPath();return i.length>o.length?t:r}var Document$1=class extends BubblingEmitterMixin(ObservableMixin()){selection;roots;stylesProcessor;_postFixers=new Set;constructor(t){super(),this.selection=new DocumentSelection$1,this.roots=new Collection({idProperty:"rootName"}),this.stylesProcessor=t,this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isSelecting",!1),this.set("isComposing",!1)}getRoot(t="main"){return this.roots.get(t)}registerPostFixer(t){this._postFixers.add(t)}destroy(){this.roots.forEach(t=>t.destroy()),this.stopListening()}_callPostFixers(t){let r=!1;do for(const i of this._postFixers)if(r=i(t),r)break;while(r)}},DEFAULT_PRIORITY=10,AttributeElement=class extends Element$1{static DEFAULT_PRIORITY=DEFAULT_PRIORITY;_priority=DEFAULT_PRIORITY;_id=null;_clonesGroup=null;constructor(e,t,r,i){super(e,t,r,i),this.getFillerOffset=getFillerOffset$3}get priority(){return this._priority}get id(){return this._id}getElementsWithSameId(){if(this.id===null)throw new CKEditorError("attribute-element-get-elements-with-same-id-no-id",this);return new Set(this._clonesGroup)}isSimilar(e){return this.id!==null||e.id!==null?this.id===e.id:super.isSimilar(e)&&this.priority==e.priority}_clone(e=!1){const t=super._clone(e);return t._priority=this._priority,t._id=this._id,t}};AttributeElement.prototype.is=function(e,t){return t?t===this.name&&(e==="attributeElement"||e==="view:attributeElement"||e==="element"||e==="view:element"):e==="attributeElement"||e==="view:attributeElement"||e==="element"||e==="view:element"||e==="node"||e==="view:node"};function getFillerOffset$3(){if(nonUiChildrenCount(this))return null;let e=this.parent;for(;e&&e.is("attributeElement");){if(nonUiChildrenCount(e)>1)return null;e=e.parent}return!e||nonUiChildrenCount(e)>1?null:this.childCount}function nonUiChildrenCount(e){return Array.from(e.getChildren()).filter(t=>!t.is("uiElement")).length}var EmptyElement=class extends Element$1{constructor(e,t,r,i){super(e,t,r,i),this.getFillerOffset=getFillerOffset$2}_insertChild(e,t){if(t&&(t instanceof Node$2||Array.from(t).length>0))throw new CKEditorError("view-emptyelement-cannot-add",[this,t]);return 0}};EmptyElement.prototype.is=function(e,t){return t?t===this.name&&(e==="emptyElement"||e==="view:emptyElement"||e==="element"||e==="view:element"):e==="emptyElement"||e==="view:emptyElement"||e==="element"||e==="view:element"||e==="node"||e==="view:node"};function getFillerOffset$2(){return null}var UIElement=class extends Element$1{constructor(e,t,r,i){super(e,t,r,i),this.getFillerOffset=getFillerOffset$1}_insertChild(e,t){if(t&&(t instanceof Node$2||Array.from(t).length>0))throw new CKEditorError("view-uielement-cannot-add",[this,t]);return 0}render(e,t){return this.toDomElement(e)}toDomElement(e){const t=e.createElement(this.name);for(const r of this.getAttributeKeys())t.setAttribute(r,this.getAttribute(r));return t}};UIElement.prototype.is=function(e,t){return t?t===this.name&&(e==="uiElement"||e==="view:uiElement"||e==="element"||e==="view:element"):e==="uiElement"||e==="view:uiElement"||e==="element"||e==="view:element"||e==="node"||e==="view:node"};function injectUiElementHandling(e){e.document.on("arrowKey",(t,r)=>jumpOverUiElement(t,r,e.domConverter),{priority:"low"})}function getFillerOffset$1(){return null}function jumpOverUiElement(e,t,r){if(t.keyCode==keyCodes.arrowright){const i=t.domTarget.ownerDocument.defaultView.getSelection(),o=i.rangeCount==1&&i.getRangeAt(0).collapsed;if(o||t.shiftKey){const a=i.focusNode,c=i.focusOffset,u=r.domPositionToView(a,c);if(u===null)return;let h=!1;const d=u.getLastMatchingPosition(f=>(f.item.is("uiElement")&&(h=!0),!!(f.item.is("uiElement")||f.item.is("attributeElement"))));if(h){const f=r.viewPositionToDom(d);o?i.collapse(f.parent,f.offset):i.extend(f.parent,f.offset)}}}}var RawElement=class extends Element$1{constructor(e,t,r,i){super(e,t,r,i),this.getFillerOffset=getFillerOffset}_insertChild(e,t){if(t&&(t instanceof Node$2||Array.from(t).length>0))throw new CKEditorError("view-rawelement-cannot-add",[this,t]);return 0}render(e,t){}};RawElement.prototype.is=function(e,t){return t?t===this.name&&(e==="rawElement"||e==="view:rawElement"||e==="element"||e==="view:element"):e==="rawElement"||e==="view:rawElement"||e===this.name||e==="view:"+this.name||e==="element"||e==="view:element"||e==="node"||e==="view:node"};function getFillerOffset(){return null}var DocumentFragment$1=class extends EmitterMixin(TypeCheckable$1){document;_children=[];_customProperties=new Map;constructor(t,r){super(),this.document=t,r&&this._insertChild(0,r)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return this.childCount===0}get root(){return this}get parent(){return null}get name(){}get getFillerOffset(){}getCustomProperty(t){return this._customProperties.get(t)}*getCustomProperties(){yield*this._customProperties.entries()}_appendChild(t){return this._insertChild(this.childCount,t)}getChild(t){return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(t,r){this._fireChange("children",this);let i=0;const o=normalize$2(this.document,r);for(const a of o)a.parent!==null&&a._remove(),a.parent=this,this._children.splice(t,0,a),t++,i++;return i}_removeChildren(t,r=1){this._fireChange("children",this);for(let i=t;i<t+r;i++)this._children[i].parent=null;return this._children.splice(t,r)}_fireChange(t,r){this.fire("change:"+t,r)}_setCustomProperty(t,r){this._customProperties.set(t,r)}_removeCustomProperty(t){return this._customProperties.delete(t)}};DocumentFragment$1.prototype.is=function(e){return e==="documentFragment"||e==="view:documentFragment"};function normalize$2(e,t){return typeof t=="string"?[new Text$1(e,t)]:(isIterable(t)||(t=[t]),Array.from(t).map(r=>typeof r=="string"?new Text$1(e,r):r instanceof TextProxy$1?new Text$1(e,r.data):r))}var DowncastWriter=class{document;_cloneGroups=new Map;_slotFactory=null;constructor(e){this.document=e}setSelection(...e){this.document.selection._setTo(...e)}setSelectionFocus(e,t){this.document.selection._setFocus(e,t)}createDocumentFragment(e){return new DocumentFragment$1(this.document,e)}createText(e){return new Text$1(this.document,e)}createAttributeElement(e,t,r={}){const i=new AttributeElement(this.document,e,t);return typeof r.priority=="number"&&(i._priority=r.priority),r.id&&(i._id=r.id),r.renderUnsafeAttributes&&i._unsafeAttributesToRender.push(...r.renderUnsafeAttributes),i}createContainerElement(e,t,r={},i={}){let o=null;isPlainObject_default(r)?i=r:o=r;const a=new ContainerElement(this.document,e,t,o);return i.renderUnsafeAttributes&&a._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),a}createEditableElement(e,t,r={}){const i=new EditableElement(this.document,e,t);return r.renderUnsafeAttributes&&i._unsafeAttributesToRender.push(...r.renderUnsafeAttributes),i}createEmptyElement(e,t,r={}){const i=new EmptyElement(this.document,e,t);return r.renderUnsafeAttributes&&i._unsafeAttributesToRender.push(...r.renderUnsafeAttributes),i}createUIElement(e,t,r){const i=new UIElement(this.document,e,t);return r&&(i.render=r),i}createRawElement(e,t,r,i={}){const o=new RawElement(this.document,e,t);return r&&(o.render=r),i.renderUnsafeAttributes&&o._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),o}setAttribute(e,t,r){r._setAttribute(e,t)}removeAttribute(e,t){t._removeAttribute(e)}addClass(e,t){t._addClass(e)}removeClass(e,t){t._removeClass(e)}setStyle(e,t,r){isPlainObject_default(e)&&r===void 0?t._setStyle(e):r._setStyle(e,t)}removeStyle(e,t){t._removeStyle(e)}setCustomProperty(e,t,r){r._setCustomProperty(e,t)}removeCustomProperty(e,t){return t._removeCustomProperty(e)}breakAttributes(e){return e instanceof Position$1?this._breakAttributes(e):this._breakAttributesRange(e)}breakContainer(e){const t=e.parent;if(!t.is("containerElement"))throw new CKEditorError("view-writer-break-non-container-element",this.document);if(!t.parent)throw new CKEditorError("view-writer-break-root",this.document);if(e.isAtStart)return Position$1._createBefore(t);if(!e.isAtEnd){const r=t._clone(!1);this.insert(Position$1._createAfter(t),r);const i=new Range$1(e,Position$1._createAt(t,"end")),o=new Position$1(r,0);this.move(i,o)}return Position$1._createAfter(t)}mergeAttributes(e){const t=e.offset,r=e.parent;if(r.is("$text"))return e;if(r.is("attributeElement")&&r.childCount===0){const a=r.parent,c=r.index;return r._remove(),this._removeFromClonedElementsGroup(r),this.mergeAttributes(new Position$1(a,c))}const i=r.getChild(t-1),o=r.getChild(t);if(!i||!o)return e;if(i.is("$text")&&o.is("$text"))return mergeTextNodes(i,o);if(i.is("attributeElement")&&o.is("attributeElement")&&i.isSimilar(o)){const a=i.childCount;return i._appendChild(o.getChildren()),o._remove(),this._removeFromClonedElementsGroup(o),this.mergeAttributes(new Position$1(i,a))}return e}mergeContainers(e){const t=e.nodeBefore,r=e.nodeAfter;if(!t||!r||!t.is("containerElement")||!r.is("containerElement"))throw new CKEditorError("view-writer-merge-containers-invalid-position",this.document);const i=t.getChild(t.childCount-1),o=i instanceof Text$1?Position$1._createAt(i,"end"):Position$1._createAt(t,"end");return this.move(Range$1._createIn(r),Position$1._createAt(t,"end")),this.remove(Range$1._createOn(r)),o}insert(e,t){t=isIterable(t)?[...t]:[t],validateNodesToInsert(t,this.document);const r=t.reduce((a,c)=>{const u=a[a.length-1],h=!c.is("uiElement");return!u||u.breakAttributes!=h?a.push({breakAttributes:h,nodes:[c]}):u.nodes.push(c),a},[]);let i=null,o=e;for(const{nodes:a,breakAttributes:c}of r){const u=this._insertNodes(o,a,c);i||(i=u.start),o=u.end}return i?new Range$1(i,o):new Range$1(e)}remove(e){const t=e instanceof Range$1?e:Range$1._createOn(e);if(validateRangeContainer(t,this.document),t.isCollapsed)return new DocumentFragment$1(this.document);const{start:r,end:i}=this._breakAttributesRange(t,!0),o=r.parent,a=i.offset-r.offset,c=o._removeChildren(r.offset,a);for(const h of c)this._removeFromClonedElementsGroup(h);const u=this.mergeAttributes(r);return t.start=u,t.end=u.clone(),new DocumentFragment$1(this.document,c)}clear(e,t){validateRangeContainer(e,this.document);const r=e.getWalker({direction:"backward",ignoreElementEnd:!0});for(const i of r){const o=i.item;let a;if(o.is("element")&&t.isSimilar(o))a=Range$1._createOn(o);else if(!i.nextPosition.isAfter(e.start)&&o.is("$textProxy")){const c=o.getAncestors().find(u=>u.is("element")&&t.isSimilar(u));c&&(a=Range$1._createIn(c))}a&&(a.end.isAfter(e.end)&&(a.end=e.end),a.start.isBefore(e.start)&&(a.start=e.start),this.remove(a))}}move(e,t){let r;if(t.isAfter(e.end)){t=this._breakAttributes(t,!0);const i=t.parent,o=i.childCount;e=this._breakAttributesRange(e,!0),r=this.remove(e),t.offset+=i.childCount-o}else r=this.remove(e);return this.insert(t,r)}wrap(e,t){if(!(t instanceof AttributeElement))throw new CKEditorError("view-writer-wrap-invalid-attribute",this.document);if(validateRangeContainer(e,this.document),e.isCollapsed){let r=e.start;r.parent.is("element")&&!_hasNonUiChildren(r.parent)&&(r=r.getLastMatchingPosition(o=>o.item.is("uiElement"))),r=this._wrapPosition(r,t);const i=this.document.selection;return i.isCollapsed&&i.getFirstPosition().isEqual(e.start)&&this.setSelection(r),new Range$1(r)}else return this._wrapRange(e,t)}unwrap(e,t){if(!(t instanceof AttributeElement))throw new CKEditorError("view-writer-unwrap-invalid-attribute",this.document);if(validateRangeContainer(e,this.document),e.isCollapsed)return e;const{start:r,end:i}=this._breakAttributesRange(e,!0),o=r.parent,a=this._unwrapChildren(o,r.offset,i.offset,t),c=this.mergeAttributes(a.start);c.isEqual(a.start)||a.end.offset--;const u=this.mergeAttributes(a.end);return new Range$1(c,u)}rename(e,t){const r=new ContainerElement(this.document,e,t.getAttributes());return this.insert(Position$1._createAfter(t),r),this.move(Range$1._createIn(t),Position$1._createAt(r,0)),this.remove(Range$1._createOn(t)),r}clearClonedElementsGroup(e){this._cloneGroups.delete(e)}createPositionAt(e,t){return Position$1._createAt(e,t)}createPositionAfter(e){return Position$1._createAfter(e)}createPositionBefore(e){return Position$1._createBefore(e)}createRange(e,t){return new Range$1(e,t)}createRangeOn(e){return Range$1._createOn(e)}createRangeIn(e){return Range$1._createIn(e)}createSelection(...e){return new Selection$1(...e)}createSlot(e="children"){if(!this._slotFactory)throw new CKEditorError("view-writer-invalid-create-slot-context",this.document);return this._slotFactory(this,e)}_registerSlotFactory(e){this._slotFactory=e}_clearSlotFactory(){this._slotFactory=null}_insertNodes(e,t,r){let i;if(r?i=getParentContainer(e):i=e.parent.is("$text")?e.parent.parent:e.parent,!i)throw new CKEditorError("view-writer-invalid-position-container",this.document);let o;r?o=this._breakAttributes(e,!0):o=e.parent.is("$text")?breakTextNode(e):e;const a=i._insertChild(o.offset,t);for(const d of t)this._addToClonedElementsGroup(d);const c=o.getShiftedBy(a),u=this.mergeAttributes(o);u.isEqual(o)||c.offset--;const h=this.mergeAttributes(c);return new Range$1(u,h)}_wrapChildren(e,t,r,i){let o=t;const a=[];for(;o<r;){const u=e.getChild(o),h=u.is("$text"),d=u.is("attributeElement");if(d&&this._wrapAttributeElement(i,u))a.push(new Position$1(e,o));else if(h||!d||shouldABeOutsideB(i,u)){const f=i._clone();u._remove(),f._appendChild(u),e._insertChild(o,f),this._addToClonedElementsGroup(f),a.push(new Position$1(e,o))}else this._wrapChildren(u,0,u.childCount,i);o++}let c=0;for(const u of a){if(u.offset-=c,u.offset==t)continue;this.mergeAttributes(u).isEqual(u)||(c++,r--)}return Range$1._createFromParentsAndOffsets(e,t,e,r)}_unwrapChildren(e,t,r,i){let o=t;const a=[];for(;o<r;){const u=e.getChild(o);if(!u.is("attributeElement")){o++;continue}if(u.isSimilar(i)){const h=u.getChildren(),d=u.childCount;u._remove(),e._insertChild(o,h),this._removeFromClonedElementsGroup(u),a.push(new Position$1(e,o),new Position$1(e,o+d)),o+=d,r+=d-1;continue}if(this._unwrapAttributeElement(i,u)){a.push(new Position$1(e,o),new Position$1(e,o+1)),o++;continue}this._unwrapChildren(u,0,u.childCount,i),o++}let c=0;for(const u of a){if(u.offset-=c,u.offset==t||u.offset==r)continue;this.mergeAttributes(u).isEqual(u)||(c++,r--)}return Range$1._createFromParentsAndOffsets(e,t,e,r)}_wrapRange(e,t){const{start:r,end:i}=this._breakAttributesRange(e,!0),o=r.parent,a=this._wrapChildren(o,r.offset,i.offset,t),c=this.mergeAttributes(a.start);c.isEqual(a.start)||a.end.offset--;const u=this.mergeAttributes(a.end);return new Range$1(c,u)}_wrapPosition(e,t){if(t.isSimilar(e.parent))return movePositionToTextNode(e.clone());e.parent.is("$text")&&(e=breakTextNode(e));const r=this.createAttributeElement("_wrapPosition-fake-element");r._priority=Number.POSITIVE_INFINITY,r.isSimilar=()=>!1,e.parent._insertChild(e.offset,r);const i=new Range$1(e,e.getShiftedBy(1));this.wrap(i,t);const o=new Position$1(r.parent,r.index);r._remove();const a=o.nodeBefore,c=o.nodeAfter;return a&&a.is("view:$text")&&c&&c.is("view:$text")?mergeTextNodes(a,c):movePositionToTextNode(o)}_wrapAttributeElement(e,t){if(!canBeJoined(e,t)||e.name!==t.name||e.priority!==t.priority)return!1;for(const r of e.getAttributeKeys())if(!(r==="class"||r==="style")&&t.hasAttribute(r)&&t.getAttribute(r)!==e.getAttribute(r))return!1;for(const r of e.getStyleNames())if(t.hasStyle(r)&&t.getStyle(r)!==e.getStyle(r))return!1;for(const r of e.getAttributeKeys())r==="class"||r==="style"||t.hasAttribute(r)||this.setAttribute(r,e.getAttribute(r),t);for(const r of e.getStyleNames())t.hasStyle(r)||this.setStyle(r,e.getStyle(r),t);for(const r of e.getClassNames())t.hasClass(r)||this.addClass(r,t);return!0}_unwrapAttributeElement(e,t){if(!canBeJoined(e,t)||e.name!==t.name||e.priority!==t.priority)return!1;for(const r of e.getAttributeKeys())if(!(r==="class"||r==="style")&&(!t.hasAttribute(r)||t.getAttribute(r)!==e.getAttribute(r)))return!1;if(!t.hasClass(...e.getClassNames()))return!1;for(const r of e.getStyleNames())if(!t.hasStyle(r)||t.getStyle(r)!==e.getStyle(r))return!1;for(const r of e.getAttributeKeys())r==="class"||r==="style"||this.removeAttribute(r,t);return this.removeClass(Array.from(e.getClassNames()),t),this.removeStyle(Array.from(e.getStyleNames()),t),!0}_breakAttributesRange(e,t=!1){const r=e.start,i=e.end;if(validateRangeContainer(e,this.document),e.isCollapsed){const u=this._breakAttributes(e.start,t);return new Range$1(u,u)}const o=this._breakAttributes(i,t),a=o.parent.childCount,c=this._breakAttributes(r,t);return o.offset+=o.parent.childCount-a,new Range$1(c,o)}_breakAttributes(e,t=!1){const r=e.offset,i=e.parent;if(e.parent.is("emptyElement"))throw new CKEditorError("view-writer-cannot-break-empty-element",this.document);if(e.parent.is("uiElement"))throw new CKEditorError("view-writer-cannot-break-ui-element",this.document);if(e.parent.is("rawElement"))throw new CKEditorError("view-writer-cannot-break-raw-element",this.document);if(!t&&i.is("$text")&&isContainerOrFragment(i.parent)||isContainerOrFragment(i))return e.clone();if(i.is("$text"))return this._breakAttributes(breakTextNode(e),t);const o=i.childCount;if(r==o){const a=new Position$1(i.parent,i.index+1);return this._breakAttributes(a,t)}else if(r===0){const a=new Position$1(i.parent,i.index);return this._breakAttributes(a,t)}else{const a=i.index+1,c=i._clone();i.parent._insertChild(a,c),this._addToClonedElementsGroup(c);const u=i.childCount-r,h=i._removeChildren(r,u);c._appendChild(h);const d=new Position$1(i.parent,a);return this._breakAttributes(d,t)}}_addToClonedElementsGroup(e){if(!e.root.is("rootElement"))return;if(e.is("element"))for(const i of e.getChildren())this._addToClonedElementsGroup(i);const t=e.id;if(!t)return;let r=this._cloneGroups.get(t);r||(r=new Set,this._cloneGroups.set(t,r)),r.add(e),e._clonesGroup=r}_removeFromClonedElementsGroup(e){if(e.is("element"))for(const i of e.getChildren())this._removeFromClonedElementsGroup(i);const t=e.id;if(!t)return;const r=this._cloneGroups.get(t);r&&r.delete(e)}};function _hasNonUiChildren(e){return Array.from(e.getChildren()).some(t=>!t.is("uiElement"))}function getParentContainer(e){let t=e.parent;for(;!isContainerOrFragment(t);){if(!t)return;t=t.parent}return t}function shouldABeOutsideB(e,t){return e.priority<t.priority?!0:e.priority>t.priority?!1:e.getIdentity()<t.getIdentity()}function movePositionToTextNode(e){const t=e.nodeBefore;if(t&&t.is("$text"))return new Position$1(t,t.data.length);const r=e.nodeAfter;return r&&r.is("$text")?new Position$1(r,0):e}function breakTextNode(e){if(e.offset==e.parent.data.length)return new Position$1(e.parent.parent,e.parent.index+1);if(e.offset===0)return new Position$1(e.parent.parent,e.parent.index);const t=e.parent.data.slice(e.offset);return e.parent._data=e.parent.data.slice(0,e.offset),e.parent.parent._insertChild(e.parent.index+1,new Text$1(e.root.document,t)),new Position$1(e.parent.parent,e.parent.index+1)}function mergeTextNodes(e,t){const r=e.data.length;return e._data+=t.data,t._remove(),new Position$1(e,r)}var validNodesToInsert=[Text$1,AttributeElement,ContainerElement,EmptyElement,RawElement,UIElement];function validateNodesToInsert(e,t){for(const r of e){if(!validNodesToInsert.some(i=>r instanceof i))throw new CKEditorError("view-writer-insert-invalid-node-type",t);r.is("$text")||validateNodesToInsert(r.getChildren(),t)}}function isContainerOrFragment(e){return e&&(e.is("containerElement")||e.is("documentFragment"))}function validateRangeContainer(e,t){const r=getParentContainer(e.start),i=getParentContainer(e.end);if(!r||!i||r!==i)throw new CKEditorError("view-writer-invalid-range-container",t)}function canBeJoined(e,t){return e.id===null&&t.id===null}var NBSP_FILLER=e=>e.createTextNode("\xA0"),MARKED_NBSP_FILLER=e=>{const t=e.createElement("span");return t.dataset.ckeFiller="true",t.innerText="\xA0",t},BR_FILLER=e=>{const t=e.createElement("br");return t.dataset.ckeFiller="true",t},INLINE_FILLER_LENGTH=7,INLINE_FILLER="\u2060".repeat(INLINE_FILLER_LENGTH);function startsWithFiller(e){return typeof e=="string"?e.substr(0,INLINE_FILLER_LENGTH)===INLINE_FILLER:isText(e)&&e.data.substr(0,INLINE_FILLER_LENGTH)===INLINE_FILLER}function isInlineFiller(e){return e.data.length==INLINE_FILLER_LENGTH&&startsWithFiller(e)}function getDataWithoutFiller(e){const t=typeof e=="string"?e:e.data;return startsWithFiller(e)?t.slice(INLINE_FILLER_LENGTH):t}function injectQuirksHandling(e){e.document.on("arrowKey",jumpOverInlineFiller,{priority:"low"})}function jumpOverInlineFiller(e,t){if(t.keyCode==keyCodes.arrowleft){const r=t.domTarget.ownerDocument.defaultView.getSelection();if(r.rangeCount==1&&r.getRangeAt(0).collapsed){const i=r.getRangeAt(0).startContainer,o=r.getRangeAt(0).startOffset;startsWithFiller(i)&&o<=INLINE_FILLER_LENGTH&&r.collapse(i,0)}}}var Renderer2=class extends ObservableMixin(){domDocuments=new Set;domConverter;markedAttributes=new Set;markedChildren=new Set;markedTexts=new Set;selection;_inlineFiller=null;_fakeSelectionContainer=null;constructor(e,t){super(),this.domConverter=e,this.selection=t,this.set("isFocused",!1),this.set("isSelecting",!1),this.set("isComposing",!1),env.isBlink&&!env.isAndroid&&this.on("change:isSelecting",()=>{this.isSelecting||this.render()})}markToSync(e,t){if(e==="text")this.domConverter.mapViewToDom(t.parent)&&this.markedTexts.add(t);else{if(!this.domConverter.mapViewToDom(t))return;if(e==="attributes")this.markedAttributes.add(t);else if(e==="children")this.markedChildren.add(t);else throw new CKEditorError("view-renderer-unknown-type",this)}}render(){if(this.isComposing&&!env.isAndroid)return;let e=null;const t=env.isBlink&&!env.isAndroid?!this.isSelecting:!0;for(const r of this.markedChildren)this._updateChildrenMappings(r);t?(this._inlineFiller&&!this._isSelectionInInlineFiller()&&this._removeInlineFiller(),this._inlineFiller?e=this._getInlineFillerPosition():this._needsInlineFillerAtSelection()&&(e=this.selection.getFirstPosition(),this.markedChildren.add(e.parent))):this._inlineFiller&&this._inlineFiller.parentNode&&(e=this.domConverter.domPositionToView(this._inlineFiller),e&&e.parent.is("$text")&&(e=Position$1._createBefore(e.parent)));for(const r of this.markedAttributes)this._updateAttrs(r);for(const r of this.markedChildren)this._updateChildren(r,{inlineFillerPosition:e});for(const r of this.markedTexts)!this.markedChildren.has(r.parent)&&this.domConverter.mapViewToDom(r.parent)&&this._updateText(r,{inlineFillerPosition:e});if(t)if(e){const r=this.domConverter.viewPositionToDom(e),i=r.parent.ownerDocument;startsWithFiller(r.parent)?this._inlineFiller=r.parent:this._inlineFiller=addInlineFiller(i,r.parent,r.offset)}else this._inlineFiller=null;this._updateFocus(),this._updateSelection(),this.domConverter._clearTemporaryCustomProperties(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear()}_updateChildrenMappings(e){const t=this.domConverter.mapViewToDom(e);if(!t)return;const r=Array.from(t.childNodes),i=Array.from(this.domConverter.viewChildrenToDom(e,{withChildren:!1})),o=this._diffNodeLists(r,i),a=this._findUpdateActions(o,r,i,areSimilarElements);if(a.indexOf("update")!==-1){const c={equal:0,insert:0,delete:0};for(const u of a)if(u==="update"){const h=c.equal+c.insert,d=c.equal+c.delete,f=e.getChild(h);f&&!f.is("uiElement")&&!f.is("rawElement")&&this._updateElementMappings(f,r[d]),remove2(i[h]),c.equal++}else c[u]++}}_updateElementMappings(e,t){this.domConverter.unbindDomElement(t),this.domConverter.bindElements(t,e),this.markedChildren.add(e),this.markedAttributes.add(e)}_getInlineFillerPosition(){const e=this.selection.getFirstPosition();return e.parent.is("$text")?Position$1._createBefore(e.parent):e}_isSelectionInInlineFiller(){if(this.selection.rangeCount!=1||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=this.domConverter.viewPositionToDom(e);return!!(t&&isText(t.parent)&&startsWithFiller(t.parent))}_removeInlineFiller(){const e=this._inlineFiller;if(!startsWithFiller(e))throw new CKEditorError("view-renderer-filler-was-lost",this);isInlineFiller(e)?e.remove():e.data=e.data.substr(INLINE_FILLER_LENGTH),this._inlineFiller=null}_needsInlineFillerAtSelection(){if(this.selection.rangeCount!=1||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=e.parent,r=e.offset;if(!this.domConverter.mapViewToDom(t.root)||!t.is("element")||!isEditable(t))return!1;const i=e.nodeBefore,o=e.nodeAfter;return!(i instanceof Text$1||o instanceof Text$1||r===t.getFillerOffset()&&(!i||!i.is("element","br"))||env.isAndroid&&(i||o))}_updateText(e,t){const r=this.domConverter.findCorrespondingDomText(e);let o=this.domConverter.viewToDom(e).data;const a=t.inlineFillerPosition;a&&a.parent==e.parent&&a.offset==e.index&&(o=INLINE_FILLER+o),this._updateTextNode(r,o)}_updateAttrs(e){const t=this.domConverter.mapViewToDom(e);if(t){for(const r of Array.from(t.attributes)){const i=r.name;e.hasAttribute(i)||this.domConverter.removeDomElementAttribute(t,i)}for(const r of e.getAttributeKeys())this.domConverter.setDomElementAttribute(t,r,e.getAttribute(r),e)}}_updateChildren(e,t){const r=this.domConverter.mapViewToDom(e);if(!r)return;if(env.isAndroid){let f=null;for(const m of Array.from(r.childNodes)){if(f&&isText(f)&&isText(m)){r.normalize();break}f=m}}const i=t.inlineFillerPosition,o=r.childNodes,a=Array.from(this.domConverter.viewChildrenToDom(e,{bind:!0}));i&&i.parent===e&&addInlineFiller(r.ownerDocument,a,i.offset);const c=this._diffNodeLists(o,a),u=this._findUpdateActions(c,o,a,areTextNodes);let h=0;const d=new Set;for(const f of u)f==="delete"?(d.add(o[h]),remove2(o[h])):(f==="equal"||f==="update")&&h++;h=0;for(const f of u)f==="insert"?(insertAt(r,h,a[h]),h++):f==="update"?(this._updateTextNode(o[h],a[h].data),h++):f==="equal"&&(this._markDescendantTextToSync(this.domConverter.domToView(a[h])),h++);for(const f of d)f.parentNode||this.domConverter.unbindDomElement(f)}_diffNodeLists(e,t){return e=filterOutFakeSelectionContainer(e,this._fakeSelectionContainer),diff(e,t,sameNodes$1.bind(null,this.domConverter))}_findUpdateActions(e,t,r,i){if(e.indexOf("insert")===-1||e.indexOf("delete")===-1)return e;let o=[],a=[],c=[];const u={equal:0,insert:0,delete:0};for(const h of e)h==="insert"?c.push(r[u.equal+u.insert]):h==="delete"?a.push(t[u.equal+u.delete]):(o=o.concat(diff(a,c,i).map(d=>d==="equal"?"update":d)),o.push("equal"),a=[],c=[]),u[h]++;return o.concat(diff(a,c,i).map(h=>h==="equal"?"update":h))}_updateTextNode(e,t){const r=e.data;r!=t&&(env.isAndroid&&this.isComposing&&r.replace(/\u00A0/g," ")==t.replace(/\u00A0/g," ")||this._updateTextNodeInternal(e,t))}_updateTextNodeInternal(e,t){const r=fastDiff(e.data,t);for(const i of r)i.type==="insert"?e.insertData(i.index,i.values.join("")):e.deleteData(i.index,i.howMany)}_markDescendantTextToSync(e){if(e){if(e.is("$text"))this.markedTexts.add(e);else if(e.is("element"))for(const t of e.getChildren())this._markDescendantTextToSync(t)}}_updateSelection(){if(env.isBlink&&!env.isAndroid&&this.isSelecting&&!this.markedChildren.size)return;if(this.selection.rangeCount===0){this._removeDomSelection(),this._removeFakeSelection();return}const e=this.domConverter.mapViewToDom(this.selection.editableElement);!this.isFocused||!e||(this.selection.isFake?this._updateFakeSelection(e):this._fakeSelectionContainer&&this._fakeSelectionContainer.isConnected?(this._removeFakeSelection(),this._updateDomSelection(e)):this.isComposing&&env.isAndroid||this._updateDomSelection(e))}_updateFakeSelection(e){const t=e.ownerDocument;this._fakeSelectionContainer||(this._fakeSelectionContainer=createFakeSelectionContainer(t));const r=this._fakeSelectionContainer;if(this.domConverter.bindFakeSelection(r,this.selection),!this._fakeSelectionNeedsUpdate(e))return;(!r.parentElement||r.parentElement!=e)&&e.appendChild(r),r.textContent=this.selection.fakeSelectionLabel||"\xA0";const i=t.getSelection(),o=t.createRange();i.removeAllRanges(),o.selectNodeContents(r),i.addRange(o)}_updateDomSelection(e){const t=e.ownerDocument.defaultView.getSelection();if(!this._domSelectionNeedsUpdate(t))return;const r=this.domConverter.viewPositionToDom(this.selection.anchor),i=this.domConverter.viewPositionToDom(this.selection.focus);t.setBaseAndExtent(r.parent,r.offset,i.parent,i.offset),env.isGecko&&fixGeckoSelectionAfterBr(i,t)}_domSelectionNeedsUpdate(e){if(!this.domConverter.isDomSelectionCorrect(e))return!0;const t=e&&this.domConverter.domSelectionToView(e);return!(t&&this.selection.isEqual(t)||!this.selection.isCollapsed&&this.selection.isSimilar(t))}_fakeSelectionNeedsUpdate(e){const t=this._fakeSelectionContainer,r=e.ownerDocument.getSelection();return!t||t.parentElement!==e||r.anchorNode!==t&&!t.contains(r.anchorNode)?!0:t.textContent!==this.selection.fakeSelectionLabel}_removeDomSelection(){for(const e of this.domDocuments){const t=e.getSelection();if(t.rangeCount){const r=e.activeElement,i=this.domConverter.mapDomToView(r);r&&i&&t.removeAllRanges()}}}_removeFakeSelection(){const e=this._fakeSelectionContainer;e&&e.remove()}_updateFocus(){if(this.isFocused){const e=this.selection.editableElement;e&&this.domConverter.focus(e)}}};function isEditable(e){if(e.getAttribute("contenteditable")=="false")return!1;const t=e.findAncestor(r=>r.hasAttribute("contenteditable"));return!t||t.getAttribute("contenteditable")=="true"}function addInlineFiller(e,t,r){const i=t instanceof Array?t:t.childNodes,o=i[r];if(isText(o))return o.data=INLINE_FILLER+o.data,o;{const a=e.createTextNode(INLINE_FILLER);return Array.isArray(t)?i.splice(r,0,a):insertAt(t,r,a),a}}function areSimilarElements(e,t){return isNode(e)&&isNode(t)&&!isText(e)&&!isText(t)&&!isComment(e)&&!isComment(t)&&e.tagName.toLowerCase()===t.tagName.toLowerCase()}function areTextNodes(e,t){return isNode(e)&&isNode(t)&&isText(e)&&isText(t)}function sameNodes$1(e,t,r){return t===r?!0:isText(t)&&isText(r)?t.data===r.data:!!(e.isBlockFiller(t)&&e.isBlockFiller(r))}function fixGeckoSelectionAfterBr(e,t){let r=e.parent,i=e.offset;if(isText(r)&&isInlineFiller(r)&&(i=indexOf(r)+1,r=r.parentNode),r.nodeType!=Node.ELEMENT_NODE||i!=r.childNodes.length-1)return;const o=r.childNodes[i];o&&o.tagName=="BR"&&t.addRange(t.getRangeAt(0))}function filterOutFakeSelectionContainer(e,t){const r=Array.from(e);return r.length==0||!t||r[r.length-1]==t&&r.pop(),r}function createFakeSelectionContainer(e){const t=e.createElement("div");return t.className="ck-fake-selection-container",Object.assign(t.style,{position:"fixed",top:0,left:"-9999px",width:"42px"}),t.textContent="\xA0",t}var BR_FILLER_REF=BR_FILLER(global2.document),NBSP_FILLER_REF=NBSP_FILLER(global2.document),MARKED_NBSP_FILLER_REF=MARKED_NBSP_FILLER(global2.document),UNSAFE_ATTRIBUTE_NAME_PREFIX="data-ck-unsafe-attribute-",UNSAFE_ELEMENT_REPLACEMENT_ATTRIBUTE="data-ck-unsafe-element",DomConverter=class{document;renderingMode;blockFillerMode;preElements;blockElements;inlineObjectElements;unsafeElements;_domDocument;_domToViewMapping=new WeakMap;_viewToDomMapping=new WeakMap;_fakeSelectionMapping=new WeakMap;_rawContentElementMatcher=new Matcher;_inlineObjectElementMatcher=new Matcher;_elementsWithTemporaryCustomProperties=new Set;constructor(e,{blockFillerMode:t,renderingMode:r="editing"}={}){this.document=e,this.renderingMode=r,this.blockFillerMode=t||(r==="editing"?"br":"nbsp"),this.preElements=["pre","textarea"],this.blockElements=["address","article","aside","blockquote","caption","center","dd","details","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","legend","li","main","menu","nav","ol","p","pre","section","summary","table","tbody","td","tfoot","th","thead","tr","ul"],this.inlineObjectElements=["object","iframe","input","button","textarea","select","option","video","embed","audio","img","canvas"],this.unsafeElements=["script","style"],this._domDocument=this.renderingMode==="editing"?global2.document:global2.document.implementation.createHTMLDocument("")}bindFakeSelection(e,t){this._fakeSelectionMapping.set(e,new Selection$1(t))}fakeSelectionToView(e){return this._fakeSelectionMapping.get(e)}bindElements(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}unbindDomElement(e){const t=this._domToViewMapping.get(e);if(t){this._domToViewMapping.delete(e),this._viewToDomMapping.delete(t);for(const r of e.children)this.unbindDomElement(r)}}bindDocumentFragments(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}shouldRenderAttribute(e,t,r){return this.renderingMode==="data"?!0:(e=e.toLowerCase(),e.startsWith("on")||e==="srcdoc"&&t.match(/\bon\S+\s*=|javascript:|<\s*\/*script/i)?!1:r==="img"&&(e==="src"||e==="srcset")||r==="source"&&e==="srcset"?!0:!t.match(/^\s*(javascript:|data:(image\/svg|text\/x?html))/i))}setContentOf(e,t){if(this.renderingMode==="data"){e.innerHTML=t;return}const r=new DOMParser().parseFromString(t,"text/html"),i=r.createDocumentFragment(),o=r.body.childNodes;for(;o.length>0;)i.appendChild(o[0]);const a=r.createTreeWalker(i,NodeFilter.SHOW_ELEMENT),c=[];let u;for(;u=a.nextNode();)c.push(u);for(const h of c){for(const f of h.getAttributeNames())this.setDomElementAttribute(h,f,h.getAttribute(f));const d=h.tagName.toLowerCase();this._shouldRenameElement(d)&&(_logUnsafeElement(d),h.replaceWith(this._createReplacementDomElement(d,h)))}for(;e.firstChild;)e.firstChild.remove();e.append(i)}viewToDom(e,t={}){if(e.is("$text")){const r=this._processDataFromViewText(e);return this._domDocument.createTextNode(r)}else{const r=e;if(this.mapViewToDom(r))if(r.getCustomProperty("editingPipeline:doNotReuseOnce"))this._elementsWithTemporaryCustomProperties.add(r);else return this.mapViewToDom(r);let i;if(r.is("documentFragment"))i=this._domDocument.createDocumentFragment(),t.bind&&this.bindDocumentFragments(i,r);else{if(r.is("uiElement"))return r.name==="$comment"?i=this._domDocument.createComment(r.getCustomProperty("$rawContent")):i=r.render(this._domDocument,this),t.bind&&this.bindElements(i,r),i;this._shouldRenameElement(r.name)?(_logUnsafeElement(r.name),i=this._createReplacementDomElement(r.name)):r.hasAttribute("xmlns")?i=this._domDocument.createElementNS(r.getAttribute("xmlns"),r.name):i=this._domDocument.createElement(r.name),r.is("rawElement")&&r.render(i,this),t.bind&&this.bindElements(i,r);for(const o of r.getAttributeKeys())this.setDomElementAttribute(i,o,r.getAttribute(o),r)}if(t.withChildren!==!1)for(const o of this.viewChildrenToDom(r,t))i instanceof HTMLTemplateElement?i.content.appendChild(o):i.appendChild(o);return i}}setDomElementAttribute(e,t,r,i){const o=this.shouldRenderAttribute(t,r,e.tagName.toLowerCase())||i&&i.shouldRenderUnsafeAttribute(t);if(o||logWarning("domconverter-unsafe-attribute-detected",{domElement:e,key:t,value:r}),!isValidAttributeName(t)){logWarning("domconverter-invalid-attribute-detected",{domElement:e,key:t,value:r});return}e.hasAttribute(t)&&!o?e.removeAttribute(t):e.hasAttribute(UNSAFE_ATTRIBUTE_NAME_PREFIX+t)&&o&&e.removeAttribute(UNSAFE_ATTRIBUTE_NAME_PREFIX+t),e.setAttribute(o?t:UNSAFE_ATTRIBUTE_NAME_PREFIX+t,r)}removeDomElementAttribute(e,t){t!=UNSAFE_ELEMENT_REPLACEMENT_ATTRIBUTE&&(e.removeAttribute(t),e.removeAttribute(UNSAFE_ATTRIBUTE_NAME_PREFIX+t))}*viewChildrenToDom(e,t={}){const r=e.getFillerOffset&&e.getFillerOffset();let i=0;for(const o of e.getChildren()){r===i&&(yield this._getBlockFiller());const a=o.is("element")&&!!o.getCustomProperty("dataPipeline:transparentRendering")&&!first(o.getAttributes());if(a&&this.renderingMode=="data")if(o.is("rawElement")){const c=this._domDocument.createElement(o.name);o.render(c,this),yield*[...c.childNodes]}else yield*this.viewChildrenToDom(o,t);else a&&logWarning("domconverter-transparent-rendering-unsupported-in-editing-pipeline",{viewElement:o}),yield this.viewToDom(o,t);i++}r===i&&(yield this._getBlockFiller())}viewRangeToDom(e){const t=this.viewPositionToDom(e.start),r=this.viewPositionToDom(e.end),i=this._domDocument.createRange();return i.setStart(t.parent,t.offset),i.setEnd(r.parent,r.offset),i}viewPositionToDom(e){const t=e.parent;if(t.is("$text")){const r=this.findCorrespondingDomText(t);if(!r)return null;let i=e.offset;return startsWithFiller(r)&&(i+=INLINE_FILLER_LENGTH),{parent:r,offset:i}}else{let r,i,o;if(e.offset===0){if(r=this.mapViewToDom(t),!r)return null;o=r.childNodes[0]}else{const c=e.nodeBefore;if(i=c.is("$text")?this.findCorrespondingDomText(c):this.mapViewToDom(c),!i)return null;r=i.parentNode,o=i.nextSibling}if(isText(o)&&startsWithFiller(o))return{parent:o,offset:INLINE_FILLER_LENGTH};const a=i?indexOf(i)+1:0;return{parent:r,offset:a}}}domToView(e,t={}){const r=[],i=this._domToView(e,t,r),o=i.next().value;return!o||(i.next(),this._processDomInlineNodes(null,r,t),o.is("$text")&&o.data.length==0)?null:o}*domChildrenToView(e,t={},r=[]){let i=[];e instanceof HTMLTemplateElement?i=[...e.content.childNodes]:i=[...e.childNodes];for(let o=0;o<i.length;o++){const a=i[o],c=this._domToView(a,t,r),u=c.next().value;u!==null&&(this._isBlockViewElement(u)&&this._processDomInlineNodes(e,r,t),yield u,c.next())}this._processDomInlineNodes(e,r,t)}domSelectionToView(e){if(isGeckoRestrictedDomSelection(e))return new Selection$1([]);if(e.rangeCount===1){let i=e.getRangeAt(0).startContainer;isText(i)&&(i=i.parentNode);const o=this.fakeSelectionToView(i);if(o)return o}const t=this.isDomSelectionBackward(e),r=[];for(let i=0;i<e.rangeCount;i++){const o=e.getRangeAt(i),a=this.domRangeToView(o);a&&r.push(a)}return new Selection$1(r,{backward:t})}domRangeToView(e){const t=this.domPositionToView(e.startContainer,e.startOffset),r=this.domPositionToView(e.endContainer,e.endOffset);return t&&r?new Range$1(t,r):null}domPositionToView(e,t=0){if(this.isBlockFiller(e))return this.domPositionToView(e.parentNode,indexOf(e));const r=this.mapDomToView(e);if(r&&(r.is("uiElement")||r.is("rawElement")))return Position$1._createBefore(r);if(isText(e)){if(isInlineFiller(e))return this.domPositionToView(e.parentNode,indexOf(e));const i=this.findCorrespondingViewText(e);let o=t;return i?(startsWithFiller(e)&&(o-=INLINE_FILLER_LENGTH,o=o<0?0:o),new Position$1(i,o)):null}else{if(t===0){const i=this.mapDomToView(e);if(i)return new Position$1(i,0)}else{const i=e.childNodes[t-1];if(isText(i)&&isInlineFiller(i)||i&&this.isBlockFiller(i))return this.domPositionToView(i.parentNode,indexOf(i));const o=isText(i)?this.findCorrespondingViewText(i):this.mapDomToView(i);if(o&&o.parent)return new Position$1(o.parent,o.index+1)}return null}}mapDomToView(e){return this.getHostViewElement(e)||this._domToViewMapping.get(e)}findCorrespondingViewText(e){if(isInlineFiller(e))return null;const t=this.getHostViewElement(e);if(t)return t;const r=e.previousSibling;if(r){if(!this.isElement(r))return null;const i=this.mapDomToView(r);if(i){const o=i.nextSibling;return o instanceof Text$1?o:null}}else{const i=this.mapDomToView(e.parentNode);if(i){const o=i.getChild(0);return o instanceof Text$1?o:null}}return null}mapViewToDom(e){return this._viewToDomMapping.get(e)}findCorrespondingDomText(e){const t=e.previousSibling;return t&&this.mapViewToDom(t)?this.mapViewToDom(t).nextSibling:!t&&e.parent&&this.mapViewToDom(e.parent)?this.mapViewToDom(e.parent).childNodes[0]:null}focus(e){const t=this.mapViewToDom(e);if(t&&t.ownerDocument.activeElement!==t){const{scrollX:r,scrollY:i}=global2.window,o=[];forEachDomElementAncestor(t,a=>{const{scrollLeft:c,scrollTop:u}=a;o.push([c,u])}),t.focus(),forEachDomElementAncestor(t,a=>{const[c,u]=o.shift();a.scrollLeft=c,a.scrollTop=u}),global2.window.scrollTo(r,i)}}_clearDomSelection(){const e=this.mapViewToDom(this.document.selection.editableElement);if(!e)return;const t=e.ownerDocument.defaultView.getSelection(),r=this.domSelectionToView(t);r&&r.rangeCount>0&&t.removeAllRanges()}isElement(e){return e&&e.nodeType==Node.ELEMENT_NODE}isDocumentFragment(e){return e&&e.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isBlockFiller(e){return this.blockFillerMode=="br"?e.isEqualNode(BR_FILLER_REF):e.tagName==="BR"&&hasBlockParent(e,this.blockElements)&&e.parentNode.childNodes.length===1?!0:e.isEqualNode(MARKED_NBSP_FILLER_REF)||isNbspBlockFiller(e,this.blockElements)}isDomSelectionBackward(e){if(e.isCollapsed)return!1;const t=this._domDocument.createRange();try{t.setStart(e.anchorNode,e.anchorOffset),t.setEnd(e.focusNode,e.focusOffset)}catch{return!1}const r=t.collapsed;return t.detach(),r}getHostViewElement(e){const t=getAncestors(e);for(t.pop();t.length;){const r=t.pop(),i=this._domToViewMapping.get(r);if(i&&(i.is("uiElement")||i.is("rawElement")))return i}return null}isDomSelectionCorrect(e){return this._isDomSelectionPositionCorrect(e.anchorNode,e.anchorOffset)&&this._isDomSelectionPositionCorrect(e.focusNode,e.focusOffset)}registerRawContentMatcher(e){this._rawContentElementMatcher.add(e)}registerInlineObjectMatcher(e){this._inlineObjectElementMatcher.add(e)}_clearTemporaryCustomProperties(){for(const e of this._elementsWithTemporaryCustomProperties)e._removeCustomProperty("editingPipeline:doNotReuseOnce");this._elementsWithTemporaryCustomProperties.clear()}_getBlockFiller(){switch(this.blockFillerMode){case"nbsp":return NBSP_FILLER(this._domDocument);case"markedNbsp":return MARKED_NBSP_FILLER(this._domDocument);case"br":return BR_FILLER(this._domDocument)}}_isDomSelectionPositionCorrect(e,t){if(isText(e)&&startsWithFiller(e)&&t<INLINE_FILLER_LENGTH||this.isElement(e)&&startsWithFiller(e.childNodes[t]))return!1;const r=this.mapDomToView(e);return!(r&&(r.is("uiElement")||r.is("rawElement")))}*_domToView(e,t,r){if(this.isBlockFiller(e))return null;const i=this.getHostViewElement(e);if(i)return i;if(isComment(e)&&t.skipComments)return null;if(isText(e)){if(isInlineFiller(e))return null;{const o=e.data;if(o==="")return null;const a=new Text$1(this.document,o);return r.push(a),a}}else{let o=this.mapDomToView(e);if(o)return this._isInlineObjectElement(o)&&r.push(o),o;if(this.isDocumentFragment(e))o=new DocumentFragment$1(this.document),t.bind&&this.bindDocumentFragments(e,o);else{o=this._createViewElement(e,t),t.bind&&this.bindElements(e,o);const c=e.attributes;if(c)for(let u=c.length,h=0;h<u;h++)o._setAttribute(c[h].name,c[h].value);if(this._isViewElementWithRawContent(o,t))return o._setCustomProperty("$rawContent",e.innerHTML),this._isBlockViewElement(o)||r.push(o),o;if(isComment(e))return o._setCustomProperty("$rawContent",e.data),o}yield o;const a=[];if(t.withChildren!==!1)for(const c of this.domChildrenToView(e,t,a))o._appendChild(c);if(this._isInlineObjectElement(o))r.push(o),this._processDomInlineNodes(null,a,t);else for(const c of a)r.push(c)}}_processDomInlineNodes(e,t,r){if(!t.length||e&&!this.isDocumentFragment(e)&&!this._isBlockDomElement(e))return;let i=!1;for(let o=0;o<t.length;o++){const a=t[o];if(!a.is("$text")){i=!1;continue}let c,u=!1;if(this._isPreFormatted(a))c=getDataWithoutFiller(a.data);else{c=a.data.replace(/[ \n\t\r]{1,}/g," "),u=/[^\S\u00A0]/.test(c.charAt(c.length-1));const h=o>0?t[o-1]:null,d=o+1<t.length?t[o+1]:null,f=!h||h.is("element")&&h.name=="br"||i,m=d?!1:!startsWithFiller(a.data);r.withChildren!==!1&&(f&&(c=c.replace(/^ /,"")),m&&(c=c.replace(/ $/,""))),c=getDataWithoutFiller(c),c=c.replace(/ \u00A0/g,"  ");const g=d&&d.is("element")&&d.name!="br",v=d&&d.is("$text")&&d.data.charAt(0)==" ";(/[ \u00A0]\u00A0$/.test(c)||!d||g||v)&&(c=c.replace(/\u00A0$/," ")),(f||h&&h.is("element")&&h.name!="br")&&(c=c.replace(/^\u00A0/," "))}c.length==0&&a.parent?(a._remove(),t.splice(o,1),o--):(a._data=c,i=u)}t.length=0}_processDataFromViewText(e){let t=e.data;if(this._isPreFormatted(e))return t;if(t.charAt(0)==" "){const r=this._getTouchingInlineViewNode(e,!1);(r&&r.is("$textProxy")&&this._nodeEndsWithSpace(r)||!r)&&(t="\xA0"+t.substr(1))}if(t.charAt(t.length-1)==" "){const r=this._getTouchingInlineViewNode(e,!0),i=r&&r.is("$textProxy")&&r.data.charAt(0)==" ";(t.charAt(t.length-2)==" "||!r||i)&&(t=t.substr(0,t.length-1)+"\xA0")}return t.replace(/ {2}/g," \xA0")}_nodeEndsWithSpace(e){if(this._isPreFormatted(e))return!1;const t=this._processDataFromViewText(e);return t.charAt(t.length-1)==" "}_isPreFormatted(e){if(_hasViewParentOfType(e,this.preElements))return!0;for(const t of e.getAncestors({parentFirst:!0}))if(!(!t.is("element")||!t.hasStyle("white-space")||t.getStyle("white-space")==="inherit"))return["pre","pre-wrap","break-spaces"].includes(t.getStyle("white-space"));return!1}_getTouchingInlineViewNode(e,t){const r=new TreeWalker$1({startPosition:t?Position$1._createAfter(e):Position$1._createBefore(e),direction:t?"forward":"backward"});for(const{item:i}of r){if(i.is("$textProxy"))return i;if(i.is("element")&&i.getCustomProperty("dataPipeline:transparentRendering"))continue;if(i.is("element","br"))return null;if(this._isInlineObjectElement(i))return i;if(i.is("containerElement"))return null}return null}_isBlockDomElement(e){return this.isElement(e)&&this.blockElements.includes(e.tagName.toLowerCase())}_isBlockViewElement(e){return e.is("element")&&this.blockElements.includes(e.name)}_isInlineObjectElement(e){return e.is("element")?e.name=="br"||this.inlineObjectElements.includes(e.name)||!!this._inlineObjectElementMatcher.match(e):!1}_createViewElement(e,t){if(isComment(e))return new UIElement(this.document,"$comment");const r=t.keepOriginalCase?e.tagName:e.tagName.toLowerCase();return new Element$1(this.document,r)}_isViewElementWithRawContent(e,t){return t.withChildren!==!1&&e.is("element")&&!!this._rawContentElementMatcher.match(e)}_shouldRenameElement(e){const t=e.toLowerCase();return this.renderingMode==="editing"&&this.unsafeElements.includes(t)}_createReplacementDomElement(e,t){const r=this._domDocument.createElement("span");if(r.setAttribute(UNSAFE_ELEMENT_REPLACEMENT_ATTRIBUTE,e),t){for(;t.firstChild;)r.appendChild(t.firstChild);for(const i of t.getAttributeNames())r.setAttribute(i,t.getAttribute(i))}return r}};function _hasViewParentOfType(e,t){return e.getAncestors().some(r=>r.is("element")&&t.includes(r.name))}function forEachDomElementAncestor(e,t){let r=e;for(;r;)t(r),r=r.parentElement}function isNbspBlockFiller(e,t){return e.isEqualNode(NBSP_FILLER_REF)&&hasBlockParent(e,t)&&e.parentNode.childNodes.length===1}function hasBlockParent(e,t){const r=e.parentNode;return!!r&&!!r.tagName&&t.includes(r.tagName.toLowerCase())}function _logUnsafeElement(e){e==="script"&&logWarning("domconverter-unsafe-script-element-detected"),e==="style"&&logWarning("domconverter-unsafe-style-element-detected")}function isGeckoRestrictedDomSelection(e){if(!env.isGecko||!e.rangeCount)return!1;const t=e.getRangeAt(0).startContainer;try{Object.prototype.toString.call(t)}catch{return!0}return!1}var Observer=class extends DomEmitterMixin(){view;document;_isEnabled=!1;constructor(e){super(),this.view=e,this.document=e.document}get isEnabled(){return this._isEnabled}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}destroy(){this.disable(),this.stopListening()}checkShouldIgnoreEventFromTarget(e){return e&&e.nodeType===3&&(e=e.parentNode),!e||e.nodeType!==1?!1:e.matches("[data-cke-ignore-events], [data-cke-ignore-events] *")}},DomEventData=class{view;document;domEvent;domTarget;constructor(e,t,r){this.view=e,this.document=e.document,this.domEvent=t,this.domTarget=t.target,assignIn_default(this,r)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}},DomEventObserver=class extends Observer{useCapture=!1;usePassive=!1;observe(e){(typeof this.domEventType=="string"?[this.domEventType]:this.domEventType).forEach(r=>{this.listenTo(e,r,(i,o)=>{this.isEnabled&&!this.checkShouldIgnoreEventFromTarget(o.target)&&this.onDomEvent(o)},{useCapture:this.useCapture,usePassive:this.usePassive})})}stopObserving(e){this.stopListening(e)}fire(e,t,r){this.isEnabled&&this.document.fire(e,new DomEventData(this.view,t,r))}},KeyObserver=class extends DomEventObserver{domEventType=["keydown","keyup"];onDomEvent(e){const t={keyCode:e.keyCode,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,get keystroke(){return getCode(this)}};this.fire(e.type,e,t)}},FakeSelectionObserver=class extends Observer{_fireSelectionChangeDoneDebounced;constructor(e){super(e),this._fireSelectionChangeDoneDebounced=debounce_default(t=>{this.document.fire("selectionChangeDone",t)},200)}observe(){const e=this.document;e.on("arrowKey",(t,r)=>{e.selection.isFake&&this.isEnabled&&r.preventDefault()},{context:"$capture"}),e.on("arrowKey",(t,r)=>{e.selection.isFake&&this.isEnabled&&this._handleSelectionMove(r.keyCode)},{priority:"lowest"})}stopObserving(){}destroy(){super.destroy(),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionMove(e){const t=this.document.selection,r=new Selection$1(t.getRanges(),{backward:t.isBackward,fake:!1});(e==keyCodes.arrowleft||e==keyCodes.arrowup)&&r.setTo(r.getFirstPosition()),(e==keyCodes.arrowright||e==keyCodes.arrowdown)&&r.setTo(r.getLastPosition());const i={oldSelection:t,newSelection:r,domSelection:null};this.document.fire("selectionChange",i),this._fireSelectionChangeDoneDebounced(i)}},MutationObserver2=class extends Observer{domConverter;_config;_domElements;_mutationObserver;constructor(e){super(e),this._config={childList:!0,characterData:!0,subtree:!0},this.domConverter=e.domConverter,this._domElements=new Set,this._mutationObserver=new window.MutationObserver(this._onMutations.bind(this))}flush(){this._onMutations(this._mutationObserver.takeRecords())}observe(e){this._domElements.add(e),this.isEnabled&&this._mutationObserver.observe(e,this._config)}stopObserving(e){if(this._domElements.delete(e),this.isEnabled){this._mutationObserver.disconnect();for(const t of this._domElements)this._mutationObserver.observe(t,this._config)}}enable(){super.enable();for(const e of this._domElements)this._mutationObserver.observe(e,this._config)}disable(){super.disable(),this._mutationObserver.disconnect()}destroy(){super.destroy(),this._mutationObserver.disconnect()}_onMutations(e){if(e.length===0)return;const t=this.domConverter,r=new Set,i=new Set;for(const a of e){const c=t.mapDomToView(a.target);c&&(c.is("uiElement")||c.is("rawElement")||a.type==="childList"&&!this._isBogusBrMutation(a)&&i.add(c))}for(const a of e){const c=t.mapDomToView(a.target);if(!(c&&(c.is("uiElement")||c.is("rawElement")))&&a.type==="characterData"){const u=t.findCorrespondingViewText(a.target);u&&!i.has(u.parent)?r.add(u):!u&&startsWithFiller(a.target)&&i.add(t.mapDomToView(a.target.parentNode))}}const o=[];for(const a of r)o.push({type:"text",node:a});for(const a of i){const c=t.mapViewToDom(a),u=Array.from(a.getChildren()),h=Array.from(t.domChildrenToView(c,{withChildren:!1}));isEqualWith_default(u,h,sameNodes)||o.push({type:"children",node:a})}o.length&&this.document.fire("mutations",{mutations:o})}_isBogusBrMutation(e){let t=null;return e.nextSibling===null&&e.removedNodes.length===0&&e.addedNodes.length==1&&(t=this.domConverter.domToView(e.addedNodes[0],{withChildren:!1})),t&&t.is("element","br")}};function sameNodes(e,t){if(!Array.isArray(e))return e===t?!0:e.is("$text")&&t.is("$text")?e.data===t.data:!1}var FocusObserver=class extends DomEventObserver{_renderTimeoutId=null;_isFocusChanging=!1;domEventType=["focus","blur"];constructor(e){super(e),this.useCapture=!0;const t=this.document;t.on("focus",()=>this._handleFocus()),t.on("blur",(r,i)=>this._handleBlur(i)),t.on("beforeinput",()=>{t.isFocused||this._handleFocus()},{priority:"highest"})}flush(){this._isFocusChanging&&(this._isFocusChanging=!1,this.document.isFocused=!0)}onDomEvent(e){this.fire(e.type,e)}destroy(){this._clearTimeout(),super.destroy()}_handleFocus(){this._clearTimeout(),this._isFocusChanging=!0,this._renderTimeoutId=setTimeout(()=>{this._renderTimeoutId=null,this.flush(),this.view.change(()=>{})},50)}_handleBlur(e){const t=this.document.selection.editableElement;(t===null||t===e.target)&&(this.document.isFocused=!1,this._isFocusChanging=!1,this.view.change(()=>{}))}_clearTimeout(){this._renderTimeoutId&&(clearTimeout(this._renderTimeoutId),this._renderTimeoutId=null)}},SelectionObserver=class extends Observer{mutationObserver;focusObserver;selection;domConverter;_documents;_fireSelectionChangeDoneDebounced;_clearInfiniteLoopInterval;_documentIsSelectingInactivityTimeoutDebounced;_loopbackCounter;constructor(e){super(e),this.mutationObserver=e.getObserver(MutationObserver2),this.focusObserver=e.getObserver(FocusObserver),this.selection=this.document.selection,this.domConverter=e.domConverter,this._documents=new WeakSet,this._fireSelectionChangeDoneDebounced=debounce_default(t=>{this.document.fire("selectionChangeDone",t)},200),this._clearInfiniteLoopInterval=setInterval(()=>this._clearInfiniteLoop(),1e3),this._documentIsSelectingInactivityTimeoutDebounced=debounce_default(()=>this.document.isSelecting=!1,5e3),this._loopbackCounter=0}observe(e){const t=e.ownerDocument,r=()=>{this.document.isSelecting=!0,this._documentIsSelectingInactivityTimeoutDebounced()},i=()=>{this.document.isSelecting&&(this._handleSelectionChange(t),this.document.isSelecting=!1,this._documentIsSelectingInactivityTimeoutDebounced.cancel())};this.listenTo(e,"selectstart",r,{priority:"highest"}),this.listenTo(e,"keydown",i,{priority:"highest",useCapture:!0}),this.listenTo(e,"keyup",i,{priority:"highest",useCapture:!0}),!this._documents.has(t)&&(this.listenTo(t,"mouseup",i,{priority:"highest",useCapture:!0}),this.listenTo(t,"selectionchange",()=>{this.document.isComposing&&!env.isAndroid||(this._handleSelectionChange(t),this._documentIsSelectingInactivityTimeoutDebounced())}),this.listenTo(this.view.document,"compositionstart",()=>{this._handleSelectionChange(t)},{priority:"lowest"}),this._documents.add(t))}stopObserving(e){this.stopListening(e)}destroy(){super.destroy(),clearInterval(this._clearInfiniteLoopInterval),this._fireSelectionChangeDoneDebounced.cancel(),this._documentIsSelectingInactivityTimeoutDebounced.cancel()}_reportInfiniteLoop(){}_handleSelectionChange(e){if(!this.isEnabled)return;const t=e.defaultView.getSelection();if(this.checkShouldIgnoreEventFromTarget(t.anchorNode))return;this.mutationObserver.flush();const r=this.domConverter.domSelectionToView(t);if(r.rangeCount==0){this.view.hasDomSelection=!1;return}if(this.view.hasDomSelection=!0,this.focusObserver.flush(),!(this.selection.isEqual(r)&&this.domConverter.isDomSelectionCorrect(t))){if(++this._loopbackCounter>60){this._reportInfiniteLoop();return}if(this.selection.isSimilar(r))this.view.forceRender();else{const i={oldSelection:this.selection,newSelection:r,domSelection:t};this.document.fire("selectionChange",i),this._fireSelectionChangeDoneDebounced(i)}}}_clearInfiniteLoop(){this._loopbackCounter=0}},CompositionObserver=class extends DomEventObserver{domEventType=["compositionstart","compositionupdate","compositionend"];constructor(e){super(e);const t=this.document;t.on("compositionstart",()=>{t.isComposing=!0},{priority:"low"}),t.on("compositionend",()=>{t.isComposing=!1},{priority:"low"})}onDomEvent(e){this.fire(e.type,e,{data:e.data})}},DataTransfer=class{_files;_native;constructor(e,t={}){this._files=t.cacheFiles?getFiles(e):null,this._native=e}get files(){return this._files||(this._files=getFiles(this._native)),this._files}get types(){return this._native.types}getData(e){return this._native.getData(e)}setData(e,t){this._native.setData(e,t)}set effectAllowed(e){this._native.effectAllowed=e}get effectAllowed(){return this._native.effectAllowed}set dropEffect(e){this._native.dropEffect=e}get dropEffect(){return this._native.dropEffect}setDragImage(e,t,r){this._native.setDragImage(e,t,r)}get isCanceled(){return this._native.dropEffect=="none"||!!this._native.mozUserCancelled}};function getFiles(e){const t=Array.from(e.files||[]),r=Array.from(e.items||[]);return t.length?t:r.filter(i=>i.kind==="file").map(i=>i.getAsFile())}var InputObserver=class extends DomEventObserver{domEventType="beforeinput";onDomEvent(e){const t=e.getTargetRanges(),r=this.view,i=r.document;let o=null,a=null,c=[];if(e.dataTransfer&&(o=new DataTransfer(e.dataTransfer)),e.data!==null?a=e.data:o&&(a=o.getData("text/plain")),i.selection.isFake)c=Array.from(i.selection.getRanges());else if(t.length)c=t.map(u=>{const h=r.domConverter.domPositionToView(u.startContainer,u.startOffset),d=r.domConverter.domPositionToView(u.endContainer,u.endOffset);if(h)return r.createRange(h,d);if(d)return r.createRange(d)}).filter(u=>!!u);else if(env.isAndroid){const u=e.target.ownerDocument.defaultView.getSelection();c=Array.from(r.domConverter.domSelectionToView(u).getRanges())}if(env.isAndroid&&e.inputType=="insertCompositionText"&&a&&a.endsWith(`
`)){this.fire(e.type,e,{inputType:"insertParagraph",targetRanges:[r.createRange(c[0].end)]});return}if(e.inputType=="insertText"&&a&&a.includes(`
`)){const u=a.split(/\n{1,2}/g);let h=c;for(let d=0;d<u.length;d++){const f=u[d];f!=""&&(this.fire(e.type,e,{data:f,dataTransfer:o,targetRanges:h,inputType:e.inputType,isComposing:e.isComposing}),h=[i.selection.getFirstRange()]),d+1<u.length&&(this.fire(e.type,e,{inputType:"insertParagraph",targetRanges:h}),h=[i.selection.getFirstRange()])}return}this.fire(e.type,e,{data:a,dataTransfer:o,targetRanges:c,inputType:e.inputType,isComposing:e.isComposing})}},ArrowKeysObserver=class extends Observer{constructor(e){super(e),this.document.on("keydown",(t,r)=>{if(this.isEnabled&&isArrowKeyCode(r.keyCode)){const i=new BubblingEventInfo(this.document,"arrowKey",this.document.selection.getFirstRange());this.document.fire(i,r),i.stop.called&&t.stop()}})}observe(){}stopObserving(){}},TabObserver=class extends Observer{constructor(e){super(e);const t=this.document;t.on("keydown",(r,i)=>{if(!this.isEnabled||i.keyCode!=keyCodes.tab||i.ctrlKey)return;const o=new BubblingEventInfo(t,"tab",t.selection.getFirstRange());t.fire(o,i),o.stop.called&&r.stop()})}observe(){}stopObserving(){}},View=class extends ObservableMixin(){document;domConverter;domRoots=new Map;_renderer;_initialDomRootAttributes=new WeakMap;_observers=new Map;_writer;_ongoingChange=!1;_postFixersInProgress=!1;_renderingDisabled=!1;_hasChangedSinceTheLastRendering=!1;constructor(e){super(),this.document=new Document$1(e),this.domConverter=new DomConverter(this.document),this.set("isRenderingInProgress",!1),this.set("hasDomSelection",!1),this._renderer=new Renderer2(this.domConverter,this.document.selection),this._renderer.bind("isFocused","isSelecting","isComposing").to(this.document,"isFocused","isSelecting","isComposing"),this._writer=new DowncastWriter(this.document),this.addObserver(MutationObserver2),this.addObserver(FocusObserver),this.addObserver(SelectionObserver),this.addObserver(KeyObserver),this.addObserver(FakeSelectionObserver),this.addObserver(CompositionObserver),this.addObserver(ArrowKeysObserver),this.addObserver(InputObserver),this.addObserver(TabObserver),injectQuirksHandling(this),injectUiElementHandling(this),this.on("render",()=>{this._render(),this.document.fire("layoutChanged"),this._hasChangedSinceTheLastRendering=!1}),this.listenTo(this.document.selection,"change",()=>{this._hasChangedSinceTheLastRendering=!0}),this.listenTo(this.document,"change:isFocused",()=>{this._hasChangedSinceTheLastRendering=!0}),env.isiOS&&this.listenTo(this.document,"blur",(t,r)=>{this.domConverter.mapDomToView(r.domEvent.relatedTarget)||this.domConverter._clearDomSelection()}),this.listenTo(this.document,"mutations",(t,{mutations:r})=>{r.forEach(i=>this._renderer.markToSync(i.type,i.node))},{priority:"low"}),this.listenTo(this.document,"mutations",()=>{this.forceRender()},{priority:"lowest"})}attachDomRoot(e,t="main"){const r=this.document.getRoot(t);r._name=e.tagName.toLowerCase();const i={};for(const{name:a,value:c}of Array.from(e.attributes))i[a]=c,a==="class"?this._writer.addClass(c.split(" "),r):r.hasAttribute(a)||this._writer.setAttribute(a,c,r);this._initialDomRootAttributes.set(e,i);const o=()=>{this._writer.setAttribute("contenteditable",(!r.isReadOnly).toString(),r),r.isReadOnly?this._writer.addClass("ck-read-only",r):this._writer.removeClass("ck-read-only",r)};o(),this.domRoots.set(t,e),this.domConverter.bindElements(e,r),this._renderer.markToSync("children",r),this._renderer.markToSync("attributes",r),this._renderer.domDocuments.add(e.ownerDocument),r.on("change:children",(a,c)=>this._renderer.markToSync("children",c)),r.on("change:attributes",(a,c)=>this._renderer.markToSync("attributes",c)),r.on("change:text",(a,c)=>this._renderer.markToSync("text",c)),r.on("change:isReadOnly",()=>this.change(o)),r.on("change",()=>{this._hasChangedSinceTheLastRendering=!0});for(const a of this._observers.values())a.observe(e,t)}detachDomRoot(e){const t=this.domRoots.get(e);Array.from(t.attributes).forEach(({name:i})=>t.removeAttribute(i));const r=this._initialDomRootAttributes.get(t);for(const i in r)t.setAttribute(i,r[i]);this.domRoots.delete(e),this.domConverter.unbindDomElement(t);for(const i of this._observers.values())i.stopObserving(t)}getDomRoot(e="main"){return this.domRoots.get(e)}addObserver(e){let t=this._observers.get(e);if(t)return t;t=new e(this),this._observers.set(e,t);for(const[r,i]of this.domRoots)t.observe(i,r);return t.enable(),t}getObserver(e){return this._observers.get(e)}disableObservers(){for(const e of this._observers.values())e.disable()}enableObservers(){for(const e of this._observers.values())e.enable()}scrollToTheSelection({alignToTop:e,forceScroll:t,viewportOffset:r=20,ancestorOffset:i=20}={}){const o=this.document.selection.getFirstRange();if(!o)return;const a=cloneDeep_default({alignToTop:e,forceScroll:t,viewportOffset:r,ancestorOffset:i});typeof r=="number"&&(r={top:r,bottom:r,left:r,right:r});const c={target:this.domConverter.viewRangeToDom(o),viewportOffset:r,ancestorOffset:i,alignToTop:e,forceScroll:t};this.fire("scrollToTheSelection",c,a),scrollViewportToShowTarget(c)}focus(){if(!this.document.isFocused){const e=this.document.selection.editableElement;e&&(this.domConverter.focus(e),this.forceRender())}}change(e){if(this.isRenderingInProgress||this._postFixersInProgress)throw new CKEditorError("cannot-change-view-tree",this);try{if(this._ongoingChange)return e(this._writer);this._ongoingChange=!0;const t=e(this._writer);return this._ongoingChange=!1,!this._renderingDisabled&&this._hasChangedSinceTheLastRendering&&(this._postFixersInProgress=!0,this.document._callPostFixers(this._writer),this._postFixersInProgress=!1,this.fire("render")),t}catch(t){CKEditorError.rethrowUnexpectedError(t,this)}}forceRender(){this._hasChangedSinceTheLastRendering=!0,this.getObserver(FocusObserver).flush(),this.change(()=>{})}destroy(){for(const e of this._observers.values())e.destroy();this.document.destroy(),this.stopListening()}createPositionAt(e,t){return Position$1._createAt(e,t)}createPositionAfter(e){return Position$1._createAfter(e)}createPositionBefore(e){return Position$1._createBefore(e)}createRange(e,t){return new Range$1(e,t)}createRangeOn(e){return Range$1._createOn(e)}createRangeIn(e){return Range$1._createIn(e)}createSelection(...e){return new Selection$1(...e)}_disableRendering(e){this._renderingDisabled=e,e==!1&&this.change(()=>{})}_render(){this.isRenderingInProgress=!0,this.disableObservers(),this._renderer.render(),this.enableObservers(),this.isRenderingInProgress=!1}},TypeCheckable2=class{is(){throw new Error("is() method is abstract")}},TextProxy2=class extends TypeCheckable2{textNode;data;offsetInText;constructor(e,t,r){if(super(),this.textNode=e,t<0||t>e.offsetSize)throw new CKEditorError("model-textproxy-wrong-offsetintext",this);if(r<0||t+r>e.offsetSize)throw new CKEditorError("model-textproxy-wrong-length",this);this.data=e.data.substring(t,t+r),this.offsetInText=t}get startOffset(){return this.textNode.startOffset!==null?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return this.startOffset!==null?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}getPath(){const e=this.textNode.getPath();return e.length>0&&(e[e.length-1]+=this.offsetInText),e}getAncestors(e={}){const t=[];let r=e.includeSelf?this:this.parent;for(;r;)t[e.parentFirst?"push":"unshift"](r),r=r.parent;return t}hasAttribute(e){return this.textNode.hasAttribute(e)}getAttribute(e){return this.textNode.getAttribute(e)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}};TextProxy2.prototype.is=function(e){return e==="$textProxy"||e==="model:$textProxy"||e==="textProxy"||e==="model:textProxy"};var TreeWalker2=class{direction;boundaries;singleCharacters;shallow;ignoreElementEnd;_position;_boundaryStartParent;_boundaryEndParent;_visitedParent;constructor(e){if(!e||!e.boundaries&&!e.startPosition)throw new CKEditorError("model-tree-walker-no-start-position",null);const t=e.direction||"forward";if(t!="forward"&&t!="backward")throw new CKEditorError("model-tree-walker-unknown-direction",e,{direction:t});this.direction=t,this.boundaries=e.boundaries||null,e.startPosition?this._position=e.startPosition.clone():this._position=Position2._createAt(this.boundaries[this.direction=="backward"?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}get position(){return this._position}skip(e){let t,r,i,o;do i=this.position,o=this._visitedParent,{done:t,value:r}=this.next();while(!t&&e(r));t||(this._position=i,this._visitedParent=o)}next(){return this.direction=="forward"?this._next():this._previous()}_next(){const e=this.position,t=this.position.clone(),r=this._visitedParent;if(r.parent===null&&t.offset===r.maxOffset)return{done:!0,value:void 0};if(r===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0,value:void 0};const i=getTextNodeAtPosition(t,r),o=i||getNodeAfterPosition(t,r,i);if(o&&o.is("model:element")){if(!this.shallow)t.path.push(0),this._visitedParent=o;else{if(this.boundaries&&this.boundaries.end.isBefore(t))return{done:!0,value:void 0};t.offset++}return this._position=t,formatReturnValue("elementStart",o,e,t,1)}if(o&&o.is("model:$text")){let a;if(this.singleCharacters)a=1;else{let h=o.endOffset;this._boundaryEndParent==r&&this.boundaries.end.offset<h&&(h=this.boundaries.end.offset),a=h-t.offset}const c=t.offset-o.startOffset,u=new TextProxy2(o,c,a);return t.offset+=a,this._position=t,formatReturnValue("text",u,e,t,a)}return t.path.pop(),t.offset++,this._position=t,this._visitedParent=r.parent,this.ignoreElementEnd?this._next():formatReturnValue("elementEnd",r,e,t)}_previous(){const e=this.position,t=this.position.clone(),r=this._visitedParent;if(r.parent===null&&t.offset===0)return{done:!0,value:void 0};if(r==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0,value:void 0};const i=t.parent,o=getTextNodeAtPosition(t,i),a=o||getNodeBeforePosition(t,i,o);if(a&&a.is("model:element"))return t.offset--,this.shallow?(this._position=t,formatReturnValue("elementStart",a,e,t,1)):(t.path.push(a.maxOffset),this._position=t,this._visitedParent=a,this.ignoreElementEnd?this._previous():formatReturnValue("elementEnd",a,e,t));if(a&&a.is("model:$text")){let c;if(this.singleCharacters)c=1;else{let d=a.startOffset;this._boundaryStartParent==r&&this.boundaries.start.offset>d&&(d=this.boundaries.start.offset),c=t.offset-d}const u=t.offset-a.startOffset,h=new TextProxy2(a,u-c,c);return t.offset-=c,this._position=t,formatReturnValue("text",h,e,t,c)}return t.path.pop(),this._position=t,this._visitedParent=r.parent,formatReturnValue("elementStart",r,e,t,1)}};function formatReturnValue(e,t,r,i,o){return{done:!1,value:{type:e,item:t,previousPosition:r,nextPosition:i,length:o}}}var Position2=class Vt extends TypeCheckable2{root;path;stickiness;constructor(t,r,i="toNone"){if(super(),!t.is("element")&&!t.is("documentFragment"))throw new CKEditorError("model-position-root-invalid",t);if(!Array.isArray(r)||r.length===0)throw new CKEditorError("model-position-path-incorrect-format",t,{path:r});t.is("rootElement")?r=r.slice():(r=[...t.getPath(),...r],t=t.root),this.root=t,this.path=r,this.stickiness=i}get offset(){return this.path[this.path.length-1]}set offset(t){this.path[this.path.length-1]=t}get parent(){let t=this.root;for(let r=0;r<this.path.length-1;r++)if(t=t.getChildAtOffset(this.path[r]),!t)throw new CKEditorError("model-position-path-incorrect",this,{position:this});if(t.is("$text"))throw new CKEditorError("model-position-path-incorrect",this,{position:this});return t}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){return getTextNodeAtPosition(this,this.parent)}get nodeAfter(){const t=this.parent;return getNodeAfterPosition(this,t,getTextNodeAtPosition(this,t))}get nodeBefore(){const t=this.parent;return getNodeBeforePosition(this,t,getTextNodeAtPosition(this,t))}get isAtStart(){return this.offset===0}get isAtEnd(){return this.offset==this.parent.maxOffset}isValid(){if(this.offset<0)return!1;let t=this.root;for(let r=0;r<this.path.length-1;r++)if(t=t.getChildAtOffset(this.path[r]),!t)return!1;return this.offset<=t.maxOffset}compareWith(t){if(this.root!=t.root)return"different";const r=compareArrays(this.path,t.path);switch(r){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[r]<t.path[r]?"before":"after"}}getLastMatchingPosition(t,r={}){r.startPosition=this;const i=new TreeWalker2(r);return i.skip(t),i.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){const t=this.parent;return t.is("documentFragment")?[t]:t.getAncestors({includeSelf:!0})}findAncestor(t){const r=this.parent;return r.is("element")?r.findAncestor(t,{includeSelf:!0}):null}getCommonPath(t){if(this.root!=t.root)return[];const r=compareArrays(this.path,t.path),i=typeof r=="string"?Math.min(this.path.length,t.path.length):r;return this.path.slice(0,i)}getCommonAncestor(t){const r=this.getAncestors(),i=t.getAncestors();let o=0;for(;r[o]==i[o]&&r[o];)o++;return o===0?null:r[o-1]}getShiftedBy(t){const r=this.clone(),i=r.offset+t;return r.offset=i<0?0:i,r}isAfter(t){return this.compareWith(t)=="after"}isBefore(t){return this.compareWith(t)=="before"}isEqual(t){return this.compareWith(t)=="same"}isTouching(t){if(this.root!==t.root)return!1;const r=Math.min(this.path.length,t.path.length);for(let i=0;i<r;i++){const o=this.path[i]-t.path[i];if(o<-1||o>1)return!1;if(o===1)return checkTouchingBranch(t,this,i);if(o===-1)return checkTouchingBranch(this,t,i)}return this.path.length===t.path.length?!0:this.path.length>t.path.length?checkOnlyZeroes(this.path,r):checkOnlyZeroes(t.path,r)}hasSameParentAs(t){if(this.root!==t.root)return!1;const r=this.getParentPath(),i=t.getParentPath();return compareArrays(r,i)=="same"}getTransformedByOperation(t){let r;switch(t.type){case"insert":r=this._getTransformedByInsertOperation(t);break;case"move":case"remove":case"reinsert":r=this._getTransformedByMoveOperation(t);break;case"split":r=this._getTransformedBySplitOperation(t);break;case"merge":r=this._getTransformedByMergeOperation(t);break;default:r=Vt._createAt(this);break}return r}_getTransformedByInsertOperation(t){return this._getTransformedByInsertion(t.position,t.howMany)}_getTransformedByMoveOperation(t){return this._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany)}_getTransformedBySplitOperation(t){const r=t.movedRange;return r.containsPosition(this)||r.start.isEqual(this)&&this.stickiness=="toNext"?this._getCombined(t.splitPosition,t.moveTargetPosition):t.graveyardPosition?this._getTransformedByMove(t.graveyardPosition,t.insertionPosition,1):this._getTransformedByInsertion(t.insertionPosition,1)}_getTransformedByMergeOperation(t){const r=t.movedRange,i=r.containsPosition(this)||r.start.isEqual(this);let o;return i?(o=this._getCombined(t.sourcePosition,t.targetPosition),t.sourcePosition.isBefore(t.targetPosition)&&(o=o._getTransformedByDeletion(t.deletionPosition,1))):this.isEqual(t.deletionPosition)?o=Vt._createAt(t.deletionPosition):o=this._getTransformedByMove(t.deletionPosition,t.graveyardPosition,1),o}_getTransformedByDeletion(t,r){const i=Vt._createAt(this);if(this.root!=t.root)return i;if(compareArrays(t.getParentPath(),this.getParentPath())=="same"){if(t.offset<this.offset){if(t.offset+r>this.offset)return null;i.offset-=r}}else if(compareArrays(t.getParentPath(),this.getParentPath())=="prefix"){const o=t.path.length-1;if(t.offset<=this.path[o]){if(t.offset+r>this.path[o])return null;i.path[o]-=r}}return i}_getTransformedByInsertion(t,r){const i=Vt._createAt(this);if(this.root!=t.root)return i;if(compareArrays(t.getParentPath(),this.getParentPath())=="same")(t.offset<this.offset||t.offset==this.offset&&this.stickiness!="toPrevious")&&(i.offset+=r);else if(compareArrays(t.getParentPath(),this.getParentPath())=="prefix"){const o=t.path.length-1;t.offset<=this.path[o]&&(i.path[o]+=r)}return i}_getTransformedByMove(t,r,i){if(r=r._getTransformedByDeletion(t,i),t.isEqual(r))return Vt._createAt(this);const o=this._getTransformedByDeletion(t,i);return o===null||t.isEqual(this)&&this.stickiness=="toNext"||t.getShiftedBy(i).isEqual(this)&&this.stickiness=="toPrevious"?this._getCombined(t,r):o._getTransformedByInsertion(r,i)}_getCombined(t,r){const i=t.path.length-1,o=Vt._createAt(r);return o.stickiness=this.stickiness,o.offset=o.offset+this.path[i]-t.offset,o.path=[...o.path,...this.path.slice(i+1)],o}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(t,r,i="toNone"){if(t.is("model:position"))return new Vt(t.root,t.path,t.stickiness);{const o=t;if(r=="end")r=o.maxOffset;else{if(r=="before")return this._createBefore(o,i);if(r=="after")return this._createAfter(o,i);if(r!==0&&!r)throw new CKEditorError("model-createpositionat-offset-required",[this,t])}if(!o.is("element")&&!o.is("documentFragment"))throw new CKEditorError("model-position-parent-incorrect",[this,t]);const a=o.getPath();return a.push(r),new this(o.root,a,i)}}static _createAfter(t,r){if(!t.parent)throw new CKEditorError("model-position-after-root",[this,t],{root:t});return this._createAt(t.parent,t.endOffset,r)}static _createBefore(t,r){if(!t.parent)throw new CKEditorError("model-position-before-root",t,{root:t});return this._createAt(t.parent,t.startOffset,r)}static fromJSON(t,r){if(t.root==="$graveyard"){const i=new Vt(r.graveyard,t.path);return i.stickiness=t.stickiness,i}if(!r.getRoot(t.root))throw new CKEditorError("model-position-fromjson-no-root",r,{rootName:t.root});return new Vt(r.getRoot(t.root),t.path,t.stickiness)}};Position2.prototype.is=function(e){return e==="position"||e==="model:position"};function getTextNodeAtPosition(e,t){const r=t.getChildAtOffset(e.offset);return r&&r.is("$text")&&r.startOffset<e.offset?r:null}function getNodeAfterPosition(e,t,r){return r!==null?null:t.getChildAtOffset(e.offset)}function getNodeBeforePosition(e,t,r){return r!==null?null:t.getChild(t.offsetToIndex(e.offset)-1)}function checkTouchingBranch(e,t,r){return!(r+1===e.path.length||!checkOnlyZeroes(t.path,r+1)||!checkOnlyMaxOffset(e,r+1))}function checkOnlyZeroes(e,t){for(;t<e.length;){if(e[t]!==0)return!1;t++}return!0}function checkOnlyMaxOffset(e,t){let r=e.parent,i=e.path.length-1,o=0;for(;i>=t;){if(e.path[i]+o!==r.maxOffset)return!1;o=1,i--,r=r.parent}return!0}var Range2=class at extends TypeCheckable2{start;end;constructor(t,r){super(),this.start=Position2._createAt(t),this.end=r?Position2._createAt(r):Position2._createAt(t),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new TreeWalker2({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){const t=this.start.getParentPath(),r=this.end.getParentPath();return compareArrays(t,r)=="same"}get root(){return this.start.root}containsPosition(t){return t.isAfter(this.start)&&t.isBefore(this.end)}containsRange(t,r=!1){t.isCollapsed&&(r=!1);const i=this.containsPosition(t.start)||r&&this.start.isEqual(t.start),o=this.containsPosition(t.end)||r&&this.end.isEqual(t.end);return i&&o}containsItem(t){const r=Position2._createBefore(t);return this.containsPosition(r)||this.start.isEqual(r)}isEqual(t){return this.start.isEqual(t.start)&&this.end.isEqual(t.end)}isIntersecting(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}getDifference(t){const r=[];return this.isIntersecting(t)?(this.containsPosition(t.start)&&r.push(new at(this.start,t.start)),this.containsPosition(t.end)&&r.push(new at(t.end,this.end))):r.push(new at(this.start,this.end)),r}getIntersection(t){if(this.isIntersecting(t)){let r=this.start,i=this.end;return this.containsPosition(t.start)&&(r=t.start),this.containsPosition(t.end)&&(i=t.end),new at(r,i)}return null}getJoined(t,r=!1){let i=this.isIntersecting(t);if(i||(this.start.isBefore(t.start)?i=r?this.end.isTouching(t.start):this.end.isEqual(t.start):i=r?t.end.isTouching(this.start):t.end.isEqual(this.start)),!i)return null;let o=this.start,a=this.end;return t.start.isBefore(o)&&(o=t.start),t.end.isAfter(a)&&(a=t.end),new at(o,a)}getMinimalFlatRanges(){const t=[],r=this.start.getCommonPath(this.end).length,i=Position2._createAt(this.start);let o=i.parent;for(;i.path.length>r+1;){const a=o.maxOffset-i.offset;a!==0&&t.push(new at(i,i.getShiftedBy(a))),i.path=i.path.slice(0,-1),i.offset++,o=o.parent}for(;i.path.length<=this.end.path.length;){const a=this.end.path[i.path.length-1],c=a-i.offset;c!==0&&t.push(new at(i,i.getShiftedBy(c))),i.offset=a,i.path.push(0)}return t}getWalker(t={}){return t.boundaries=this,new TreeWalker2(t)}*getItems(t={}){t.boundaries=this,t.ignoreElementEnd=!0;const r=new TreeWalker2(t);for(const i of r)yield i.item}*getPositions(t={}){t.boundaries=this;const r=new TreeWalker2(t);yield r.position;for(const i of r)yield i.nextPosition}getTransformedByOperation(t){switch(t.type){case"insert":return this._getTransformedByInsertOperation(t);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(t);case"split":return[this._getTransformedBySplitOperation(t)];case"merge":return[this._getTransformedByMergeOperation(t)]}return[new at(this.start,this.end)]}getTransformedByOperations(t){const r=[new at(this.start,this.end)];for(const i of t)for(let o=0;o<r.length;o++){const a=r[o].getTransformedByOperation(i);r.splice(o,1,...a),o+=a.length-1}for(let i=0;i<r.length;i++){const o=r[i];for(let a=i+1;a<r.length;a++){const c=r[a];(o.containsRange(c)||c.containsRange(o)||o.isEqual(c))&&r.splice(a,1)}}return r}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;const t=this.start.nodeAfter,r=this.end.nodeBefore;return t&&t.is("element")&&t===r?t:null}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(t,r=!1){return this._getTransformedByInsertion(t.position,t.howMany,r)}_getTransformedByMoveOperation(t,r=!1){const i=t.sourcePosition,o=t.howMany,a=t.targetPosition;return this._getTransformedByMove(i,a,o,r)}_getTransformedBySplitOperation(t){const r=this.start._getTransformedBySplitOperation(t);let i=this.end._getTransformedBySplitOperation(t);return this.end.isEqual(t.insertionPosition)&&(i=this.end.getShiftedBy(1)),r.root!=i.root&&(i=this.end.getShiftedBy(-1)),new at(r,i)}_getTransformedByMergeOperation(t){if(this.start.isEqual(t.targetPosition)&&this.end.isEqual(t.deletionPosition))return new at(this.start);let r=this.start._getTransformedByMergeOperation(t),i=this.end._getTransformedByMergeOperation(t);return r.root!=i.root&&(i=this.end.getShiftedBy(-1)),r.isAfter(i)?(t.sourcePosition.isBefore(t.targetPosition)?(r=Position2._createAt(i),r.offset=0):(t.deletionPosition.isEqual(r)||(i=t.deletionPosition),r=t.targetPosition),new at(r,i)):new at(r,i)}_getTransformedByInsertion(t,r,i=!1){if(i&&this.containsPosition(t))return[new at(this.start,t),new at(t.getShiftedBy(r),this.end._getTransformedByInsertion(t,r))];{const o=new at(this.start,this.end);return o.start=o.start._getTransformedByInsertion(t,r),o.end=o.end._getTransformedByInsertion(t,r),[o]}}_getTransformedByMove(t,r,i,o=!1){if(this.isCollapsed){const m=this.start._getTransformedByMove(t,r,i);return[new at(m)]}const a=at._createFromPositionAndShift(t,i),c=r._getTransformedByDeletion(t,i);if(this.containsPosition(r)&&!o&&(a.containsPosition(this.start)||a.containsPosition(this.end))){const m=this.start._getTransformedByMove(t,r,i),g=this.end._getTransformedByMove(t,r,i);return[new at(m,g)]}let u;const h=this.getDifference(a);let d=null;const f=this.getIntersection(a);if(h.length==1?d=new at(h[0].start._getTransformedByDeletion(t,i),h[0].end._getTransformedByDeletion(t,i)):h.length==2&&(d=new at(this.start,this.end._getTransformedByDeletion(t,i))),d?u=d._getTransformedByInsertion(c,i,f!==null||o):u=[],f){const m=new at(f.start._getCombined(a.start,c),f.end._getCombined(a.start,c));u.length==2?u.splice(1,0,m):u.push(m)}return u}_getTransformedByDeletion(t,r){let i=this.start._getTransformedByDeletion(t,r),o=this.end._getTransformedByDeletion(t,r);return i==null&&o==null?null:(i==null&&(i=t),o==null&&(o=t),new at(i,o))}static _createFromPositionAndShift(t,r){const i=t,o=t.getShiftedBy(r);return r>0?new this(i,o):new this(o,i)}static _createIn(t){return new this(Position2._createAt(t,0),Position2._createAt(t,t.maxOffset))}static _createOn(t){return this._createFromPositionAndShift(Position2._createBefore(t),t.offsetSize)}static _createFromRanges(t){if(t.length===0)throw new CKEditorError("range-create-from-ranges-empty-array",null);if(t.length==1)return t[0].clone();const r=t[0];t.sort((a,c)=>a.start.isAfter(c.start)?1:-1);const i=t.indexOf(r),o=new this(r.start,r.end);for(let a=i-1;a>=0&&t[a].end.isEqual(o.start);a--)o.start=Position2._createAt(t[a].start);for(let a=i+1;a<t.length&&t[a].start.isEqual(o.end);a++)o.end=Position2._createAt(t[a].end);return o}static fromJSON(t,r){return new this(Position2.fromJSON(t.start,r),Position2.fromJSON(t.end,r))}};Range2.prototype.is=function(e){return e==="range"||e==="model:range"};var Mapper=class extends EmitterMixin(){_modelToViewMapping=new WeakMap;_viewToModelMapping=new WeakMap;_viewToModelLengthCallbacks=new Map;_markerNameToElements=new Map;_elementToMarkerNames=new Map;_deferredBindingRemovals=new Map;_unboundMarkerNames=new Set;constructor(){super(),this.on("modelToViewPosition",(e,t)=>{if(t.viewPosition)return;const r=this._modelToViewMapping.get(t.modelPosition.parent);if(!r)throw new CKEditorError("mapping-model-position-view-parent-not-found",this,{modelPosition:t.modelPosition});t.viewPosition=this.findPositionIn(r,t.modelPosition.offset)},{priority:"low"}),this.on("viewToModelPosition",(e,t)=>{if(t.modelPosition)return;const r=this.findMappedViewAncestor(t.viewPosition),i=this._viewToModelMapping.get(r),o=this._toModelOffset(t.viewPosition.parent,t.viewPosition.offset,r);t.modelPosition=Position2._createAt(i,o)},{priority:"low"})}bindElements(e,t){this._modelToViewMapping.set(e,t),this._viewToModelMapping.set(t,e)}unbindViewElement(e,t={}){const r=this.toModelElement(e);if(this._elementToMarkerNames.has(e))for(const i of this._elementToMarkerNames.get(e))this._unboundMarkerNames.add(i);t.defer?this._deferredBindingRemovals.set(e,e.root):(this._viewToModelMapping.delete(e),this._modelToViewMapping.get(r)==e&&this._modelToViewMapping.delete(r))}unbindModelElement(e){const t=this.toViewElement(e);this._modelToViewMapping.delete(e),this._viewToModelMapping.get(t)==e&&this._viewToModelMapping.delete(t)}bindElementToMarker(e,t){const r=this._markerNameToElements.get(t)||new Set;r.add(e);const i=this._elementToMarkerNames.get(e)||new Set;i.add(t),this._markerNameToElements.set(t,r),this._elementToMarkerNames.set(e,i)}unbindElementFromMarkerName(e,t){const r=this._markerNameToElements.get(t);r&&(r.delete(e),r.size==0&&this._markerNameToElements.delete(t));const i=this._elementToMarkerNames.get(e);i&&(i.delete(t),i.size==0&&this._elementToMarkerNames.delete(e))}flushUnboundMarkerNames(){const e=Array.from(this._unboundMarkerNames);return this._unboundMarkerNames.clear(),e}flushDeferredBindings(){for(const[e,t]of this._deferredBindingRemovals)e.root==t&&this.unbindViewElement(e);this._deferredBindingRemovals=new Map}clearBindings(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set,this._deferredBindingRemovals=new Map}toModelElement(e){return this._viewToModelMapping.get(e)}toViewElement(e){return this._modelToViewMapping.get(e)}toModelRange(e){return new Range2(this.toModelPosition(e.start),this.toModelPosition(e.end))}toViewRange(e){return new Range$1(this.toViewPosition(e.start),this.toViewPosition(e.end))}toModelPosition(e){const t={viewPosition:e,mapper:this};return this.fire("viewToModelPosition",t),t.modelPosition}toViewPosition(e,t={}){const r={modelPosition:e,mapper:this,isPhantom:t.isPhantom};return this.fire("modelToViewPosition",r),r.viewPosition}markerNameToElements(e){const t=this._markerNameToElements.get(e);if(!t)return null;const r=new Set;for(const i of t)if(i.is("attributeElement"))for(const o of i.getElementsWithSameId())r.add(o);else r.add(i);return r}registerViewToModelLength(e,t){this._viewToModelLengthCallbacks.set(e,t)}findMappedViewAncestor(e){let t=e.parent;for(;!this._viewToModelMapping.has(t);)t=t.parent;return t}_toModelOffset(e,t,r){if(r!=e){const o=this._toModelOffset(e.parent,e.index,r),a=this._toModelOffset(e,t,e);return o+a}if(e.is("$text"))return t;let i=0;for(let o=0;o<t;o++)i+=this.getModelLength(e.getChild(o));return i}getModelLength(e){const t=[e];let r=0;for(;t.length>0;){const i=t.pop(),o=i.name&&this._viewToModelLengthCallbacks.size>0&&this._viewToModelLengthCallbacks.get(i.name);if(o)r+=o(i);else if(this._viewToModelMapping.has(i))r+=1;else if(i.is("$text"))r+=i.data.length;else{if(i.is("uiElement"))continue;for(const a of i.getChildren())t.push(a)}}return r}findPositionIn(e,t){let r,i=0,o=0,a=0;if(e.is("$text"))return new Position$1(e,t);for(;o<t;)r=e.getChild(a),i=this.getModelLength(r),o+=i,a++;return o==t?this._moveViewPositionToTextNode(new Position$1(e,a)):this.findPositionIn(r,t-(o-i))}_moveViewPositionToTextNode(e){const t=e.nodeBefore,r=e.nodeAfter;return t&&t.is("view:$text")?new Position$1(t,t.data.length):r&&r.is("view:$text")?new Position$1(r,0):e}},ModelConsumable=class{_consumable=new Map;_textProxyRegistry=new Map;add(e,t){t=_normalizeConsumableType(t),e instanceof TextProxy2&&(e=this._getSymbolForTextProxy(e)),this._consumable.has(e)||this._consumable.set(e,new Map),this._consumable.get(e).set(t,!0)}consume(e,t){return t=_normalizeConsumableType(t),e instanceof TextProxy2&&(e=this._getSymbolForTextProxy(e)),this.test(e,t)?(this._consumable.get(e).set(t,!1),!0):!1}test(e,t){t=_normalizeConsumableType(t),e instanceof TextProxy2&&(e=this._getSymbolForTextProxy(e));const r=this._consumable.get(e);if(r===void 0)return null;const i=r.get(t);return i===void 0?null:i}revert(e,t){t=_normalizeConsumableType(t),e instanceof TextProxy2&&(e=this._getSymbolForTextProxy(e));const r=this.test(e,t);return r===!1?(this._consumable.get(e).set(t,!0),!0):r===!0?!1:null}verifyAllConsumed(e){const t=[];for(const[r,i]of this._consumable)for(const[o,a]of i){const c=o.split(":")[0];a&&e==c&&t.push({event:o,item:r.name||r.description})}if(t.length)throw new CKEditorError("conversion-model-consumable-not-consumed",null,{items:t})}_getSymbolForTextProxy(e){let t=null;const r=this._textProxyRegistry.get(e.startOffset);if(r){const i=r.get(e.endOffset);i&&(t=i.get(e.parent))}return t||(t=this._addSymbolForTextProxy(e)),t}_addSymbolForTextProxy(e){const t=e.startOffset,r=e.endOffset,i=e.parent,o=Symbol("$textProxy:"+e.data);let a,c;return a=this._textProxyRegistry.get(t),a||(a=new Map,this._textProxyRegistry.set(t,a)),c=a.get(r),c||(c=new Map,a.set(r,c)),c.set(i,o),o}};function _normalizeConsumableType(e){const t=e.split(":");return t[0]=="insert"?t[0]:t[0]=="addMarker"||t[0]=="removeMarker"?e:t.length>1?t[0]+":"+t[1]:t[0]}var DowncastDispatcher=class extends EmitterMixin(){_conversionApi;_firedEventsMap;constructor(e){super(),this._conversionApi={dispatcher:this,...e},this._firedEventsMap=new WeakMap}convertChanges(e,t,r){const i=this._createConversionApi(r,e.getRefreshedItems());for(const a of e.getMarkersToRemove())this._convertMarkerRemove(a.name,a.range,i);const o=this._reduceChanges(e.getChanges());for(const a of o)a.type==="insert"?this._convertInsert(Range2._createFromPositionAndShift(a.position,a.length),i):a.type==="reinsert"?this._convertReinsert(Range2._createFromPositionAndShift(a.position,a.length),i):a.type==="remove"?this._convertRemove(a.position,a.length,a.name,i):this._convertAttribute(a.range,a.attributeKey,a.attributeOldValue,a.attributeNewValue,i);i.mapper.flushDeferredBindings();for(const a of i.mapper.flushUnboundMarkerNames()){const c=t.get(a).getRange();this._convertMarkerRemove(a,c,i),this._convertMarkerAdd(a,c,i)}for(const a of e.getMarkersToAdd())this._convertMarkerAdd(a.name,a.range,i);i.consumable.verifyAllConsumed("insert")}convert(e,t,r,i={}){const o=this._createConversionApi(r,void 0,i);this._convertInsert(e,o);for(const[a,c]of t)this._convertMarkerAdd(a,c,o);o.consumable.verifyAllConsumed("insert")}convertSelection(e,t,r){const i=this._createConversionApi(r);this.fire("cleanSelection",{selection:e},i);const o=e.getFirstPosition().root;if(!i.mapper.toViewElement(o))return;const a=Array.from(t.getMarkersAtPosition(e.getFirstPosition()));if(this._addConsumablesForSelection(i.consumable,e,a),this.fire("selection",{selection:e},i),!!e.isCollapsed){for(const c of a)if(i.consumable.test(e,"addMarker:"+c.name)){const u=c.getRange();if(!shouldMarkerChangeBeConverted(e.getFirstPosition(),c,i.mapper))continue;const h={item:e,markerName:c.name,markerRange:u};this.fire(`addMarker:${c.name}`,h,i)}for(const c of e.getAttributeKeys())if(i.consumable.test(e,"attribute:"+c)){const u={item:e,range:e.getFirstRange(),attributeKey:c,attributeOldValue:null,attributeNewValue:e.getAttribute(c)};this.fire(`attribute:${c}:$text`,u,i)}}}_convertInsert(e,t,r={}){r.doNotAddConsumables||this._addConsumablesForInsert(t.consumable,e);for(const i of e.getWalker({shallow:!0}))this._testAndFire("insert",walkerValueToEventData(i),t)}_convertRemove(e,t,r,i){this.fire(`remove:${r}`,{position:e,length:t},i)}_convertAttribute(e,t,r,i,o){this._addConsumablesForRange(o.consumable,e,`attribute:${t}`);for(const a of e){const c={item:a.item,range:Range2._createFromPositionAndShift(a.previousPosition,a.length),attributeKey:t,attributeOldValue:r,attributeNewValue:i};this._testAndFire(`attribute:${t}`,c,o)}}_convertReinsert(e,t){const r=Array.from(e.getWalker({shallow:!0}));this._addConsumablesForInsert(t.consumable,r);for(const i of r.map(walkerValueToEventData))this._testAndFire("insert",{...i,reconversion:!0},t)}_convertMarkerAdd(e,t,r){if(t.root.rootName=="$graveyard")return;const i=`addMarker:${e}`;if(r.consumable.add(t,i),this.fire(i,{markerName:e,markerRange:t},r),!!r.consumable.consume(t,i)){this._addConsumablesForRange(r.consumable,t,i);for(const o of t.getItems()){if(!r.consumable.test(o,i))continue;const a={item:o,range:Range2._createOn(o),markerName:e,markerRange:t};this.fire(i,a,r)}}}_convertMarkerRemove(e,t,r){t.root.rootName!="$graveyard"&&this.fire(`removeMarker:${e}`,{markerName:e,markerRange:t},r)}_reduceChanges(e){const t={changes:e};return this.fire("reduceChanges",t),t.changes}_addConsumablesForInsert(e,t){for(const r of t){const i=r.item;if(e.test(i,"insert")===null){e.add(i,"insert");for(const o of i.getAttributeKeys())e.add(i,"attribute:"+o)}}return e}_addConsumablesForRange(e,t,r){for(const i of t.getItems())e.add(i,r);return e}_addConsumablesForSelection(e,t,r){e.add(t,"selection");for(const i of r)e.add(t,"addMarker:"+i.name);for(const i of t.getAttributeKeys())e.add(t,"attribute:"+i);return e}_testAndFire(e,t,r){const i=getEventName(e,t),o=t.item.is("$textProxy")?r.consumable._getSymbolForTextProxy(t.item):t.item,a=this._firedEventsMap.get(r),c=a.get(o);if(!c)a.set(o,new Set([i]));else if(!c.has(i))c.add(i);else return;this.fire(i,t,r)}_testAndFireAddAttributes(e,t){const r={item:e,range:Range2._createOn(e)};for(const i of r.item.getAttributeKeys())r.attributeKey=i,r.attributeOldValue=null,r.attributeNewValue=r.item.getAttribute(i),this._testAndFire(`attribute:${i}`,r,t)}_createConversionApi(e,t=new Set,r={}){const i={...this._conversionApi,consumable:new ModelConsumable,writer:e,options:r,convertItem:o=>this._convertInsert(Range2._createOn(o),i),convertChildren:o=>this._convertInsert(Range2._createIn(o),i,{doNotAddConsumables:!0}),convertAttributes:o=>this._testAndFireAddAttributes(o,i),canReuseView:o=>!t.has(i.mapper.toModelElement(o))};return this._firedEventsMap.set(i,new Map),i}};function shouldMarkerChangeBeConverted(e,t,r){const i=t.getRange(),o=Array.from(e.getAncestors());return o.shift(),o.reverse(),!o.some(c=>{if(i.containsItem(c))return!!r.toViewElement(c).getCustomProperty("addHighlight")})}function getEventName(e,t){const r=t.item.is("element")?t.item.name:"$text";return`${e}:${r}`}function walkerValueToEventData(e){return{item:e.item,range:Range2._createFromPositionAndShift(e.previousPosition,e.length)}}var Node$1=class extends TypeCheckable2{parent=null;_attrs;_index=null;_startOffset=null;constructor(t){super(),this._attrs=toMap(t)}get document(){return null}get index(){return this._index}get startOffset(){return this._startOffset}get offsetSize(){return 1}get endOffset(){return this.startOffset===null?null:this.startOffset+this.offsetSize}get nextSibling(){const t=this.index;return t!==null&&this.parent.getChild(t+1)||null}get previousSibling(){const t=this.index;return t!==null&&this.parent.getChild(t-1)||null}get root(){let t=this;for(;t.parent;)t=t.parent;return t}isAttached(){return this.parent===null?!1:this.root.isAttached()}getPath(){const t=[];let r=this;for(;r.parent;)t.unshift(r.startOffset),r=r.parent;return t}getAncestors(t={}){const r=[];let i=t.includeSelf?this:this.parent;for(;i;)r[t.parentFirst?"push":"unshift"](i),i=i.parent;return r}getCommonAncestor(t,r={}){const i=this.getAncestors(r),o=t.getAncestors(r);let a=0;for(;i[a]==o[a]&&i[a];)a++;return a===0?null:i[a-1]}isBefore(t){if(this==t||this.root!==t.root)return!1;const r=this.getPath(),i=t.getPath(),o=compareArrays(r,i);switch(o){case"prefix":return!0;case"extension":return!1;default:return r[o]<i[o]}}isAfter(t){return this==t||this.root!==t.root?!1:!this.isBefore(t)}hasAttribute(t){return this._attrs.has(t)}getAttribute(t){return this._attrs.get(t)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const t={};return this._attrs.size&&(t.attributes=Array.from(this._attrs).reduce((r,i)=>(r[i[0]]=i[1],r),{})),t}_clone(t){return new this.constructor(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(t,r){this._attrs.set(t,r)}_setAttributesTo(t){this._attrs=toMap(t)}_removeAttribute(t){return this._attrs.delete(t)}_clearAttributes(){this._attrs.clear()}};Node$1.prototype.is=function(e){return e==="node"||e==="model:node"};var Selection6=class ws extends EmitterMixin(TypeCheckable2){_lastRangeBackward=!1;_attrs=new Map;_ranges=[];constructor(...t){super(),t.length&&this.setTo(...t)}get anchor(){if(this._ranges.length>0){const t=this._ranges[this._ranges.length-1];return this._lastRangeBackward?t.end:t.start}return null}get focus(){if(this._ranges.length>0){const t=this._ranges[this._ranges.length-1];return this._lastRangeBackward?t.start:t.end}return null}get isCollapsed(){return this._ranges.length===1?this._ranges[0].isCollapsed:!1}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}isEqual(t){if(this.rangeCount!=t.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(t.anchor)||!this.focus.isEqual(t.focus))return!1;for(const r of this._ranges){let i=!1;for(const o of t._ranges)if(r.isEqual(o)){i=!0;break}if(!i)return!1}return!0}*getRanges(){for(const t of this._ranges)yield new Range2(t.start,t.end)}getFirstRange(){let t=null;for(const r of this._ranges)(!t||r.start.isBefore(t.start))&&(t=r);return t?new Range2(t.start,t.end):null}getLastRange(){let t=null;for(const r of this._ranges)(!t||r.end.isAfter(t.end))&&(t=r);return t?new Range2(t.start,t.end):null}getFirstPosition(){const t=this.getFirstRange();return t?t.start.clone():null}getLastPosition(){const t=this.getLastRange();return t?t.end.clone():null}setTo(...t){let[r,i,o]=t;if(typeof i=="object"&&(o=i,i=void 0),r===null)this._setRanges([]);else if(r instanceof ws)this._setRanges(r.getRanges(),r.isBackward);else if(r&&typeof r.getRanges=="function")this._setRanges(r.getRanges(),r.isBackward);else if(r instanceof Range2)this._setRanges([r],!!o&&!!o.backward);else if(r instanceof Position2)this._setRanges([new Range2(r)]);else if(r instanceof Node$1){const a=!!o&&!!o.backward;let c;if(i=="in")c=Range2._createIn(r);else if(i=="on")c=Range2._createOn(r);else if(i!==void 0)c=new Range2(Position2._createAt(r,i));else throw new CKEditorError("model-selection-setto-required-second-parameter",[this,r]);this._setRanges([c],a)}else if(isIterable(r))this._setRanges(r,o&&!!o.backward);else throw new CKEditorError("model-selection-setto-not-selectable",[this,r])}_setRanges(t,r=!1){const i=Array.from(t),o=i.some(a=>{if(!(a instanceof Range2))throw new CKEditorError("model-selection-set-ranges-not-range",[this,t]);return this._ranges.every(c=>!c.isEqual(a))});i.length===this._ranges.length&&!o||(this._replaceAllRanges(i),this._lastRangeBackward=!!r,this.fire("change:range",{directChange:!0}))}setFocus(t,r){if(this.anchor===null)throw new CKEditorError("model-selection-setfocus-no-ranges",[this,t]);const i=Position2._createAt(t,r);if(i.compareWith(this.focus)=="same")return;const o=this.anchor;this._ranges.length&&this._popRange(),i.compareWith(o)=="before"?(this._pushRange(new Range2(i,o)),this._lastRangeBackward=!0):(this._pushRange(new Range2(o,i)),this._lastRangeBackward=!1),this.fire("change:range",{directChange:!0})}getAttribute(t){return this._attrs.get(t)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}hasAttribute(t){return this._attrs.has(t)}removeAttribute(t){this.hasAttribute(t)&&(this._attrs.delete(t),this.fire("change:attribute",{attributeKeys:[t],directChange:!0}))}setAttribute(t,r){this.getAttribute(t)!==r&&(this._attrs.set(t,r),this.fire("change:attribute",{attributeKeys:[t],directChange:!0}))}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}*getSelectedBlocks(){const t=new WeakSet;for(const r of this.getRanges()){const i=getParentBlock$1(r.start,t);isStartBlockSelected(i,r)&&(yield i);for(const a of r.getWalker()){const c=a.item;a.type=="elementEnd"&&isUnvisitedTopBlock(c,t,r)&&(yield c)}const o=getParentBlock$1(r.end,t);isEndBlockSelected(o,r)&&(yield o)}}containsEntireContent(t=this.anchor.root){const r=Position2._createAt(t,0),i=Position2._createAt(t,"end");return r.isTouching(this.getFirstPosition())&&i.isTouching(this.getLastPosition())}_pushRange(t){this._checkRange(t),this._ranges.push(new Range2(t.start,t.end))}_checkRange(t){for(let r=0;r<this._ranges.length;r++)if(t.isIntersecting(this._ranges[r]))throw new CKEditorError("model-selection-range-intersects",[this,t],{addedRange:t,intersectingRange:this._ranges[r]})}_replaceAllRanges(t){this._removeAllRanges();for(const r of t)this._pushRange(r)}_removeAllRanges(){for(;this._ranges.length>0;)this._popRange()}_popRange(){this._ranges.pop()}};Selection6.prototype.is=function(e){return e==="selection"||e==="model:selection"};function isUnvisitedBlock(e,t){return t.has(e)?!1:(t.add(e),e.root.document.model.schema.isBlock(e)&&!!e.parent)}function isUnvisitedTopBlock(e,t,r){return isUnvisitedBlock(e,t)&&isTopBlockInRange(e,r)}function getParentBlock$1(e,t){const i=e.parent.root.document.model.schema,o=e.parent.getAncestors({parentFirst:!0,includeSelf:!0});let a=!1;const c=o.find(u=>a?!1:(a=i.isLimit(u),!a&&isUnvisitedBlock(u,t)));return o.forEach(u=>t.add(u)),c}function isTopBlockInRange(e,t){const r=findAncestorBlock(e);return r?!t.containsRange(Range2._createOn(r),!0):!0}function isStartBlockSelected(e,t){return e?t.isCollapsed||e.isEmpty?!0:t.start.isTouching(Position2._createAt(e,e.maxOffset))?!1:isTopBlockInRange(e,t):!1}function isEndBlockSelected(e,t){return e?t.isCollapsed||e.isEmpty?!0:t.end.isTouching(Position2._createAt(e,0))?!1:isTopBlockInRange(e,t):!1}function findAncestorBlock(e){const t=e.root.document.model.schema;let r=e.parent;for(;r;){if(t.isBlock(r))return r;r=r.parent}}var LiveRange=class _s extends EmitterMixin(Range2){constructor(t,r){super(t,r),bindWithDocument$1.call(this)}detach(){this.stopListening()}toRange(){return new Range2(this.start,this.end)}static fromRange(t){return new _s(t.start,t.end)}};LiveRange.prototype.is=function(e){return e==="liveRange"||e==="model:liveRange"||e=="range"||e==="model:range"};function bindWithDocument$1(){this.listenTo(this.root.document.model,"applyOperation",(e,t)=>{const r=t[0];r.isDocumentOperation&&transform$2.call(this,r)},{priority:"low"})}function transform$2(e){const t=this.getTransformedByOperation(e),r=Range2._createFromRanges(t),i=!r.isEqual(this),o=doesOperationChangeRangeContent(this,e);let a=null;if(i){r.root.rootName=="$graveyard"&&(e.type=="remove"?a=e.sourcePosition:a=e.deletionPosition);const c=this.toRange();this.start=r.start,this.end=r.end,this.fire("change:range",c,{deletionPosition:a})}else o&&this.fire("change:content",this.toRange(),{deletionPosition:a})}function doesOperationChangeRangeContent(e,t){switch(t.type){case"insert":return e.containsPosition(t.position);case"move":case"remove":case"reinsert":case"merge":return e.containsPosition(t.sourcePosition)||e.start.isEqual(t.sourcePosition)||e.containsPosition(t.targetPosition);case"split":return e.containsPosition(t.splitPosition)||e.containsPosition(t.insertionPosition)}return!1}var Text2=class hi extends Node$1{_data;constructor(t,r){super(r),this._data=t||""}get offsetSize(){return this.data.length}get data(){return this._data}toJSON(){const t=super.toJSON();return t.data=this.data,t}_clone(){return new hi(this.data,this.getAttributes())}static fromJSON(t){return new hi(t.data,t.attributes)}};Text2.prototype.is=function(e){return e==="$text"||e==="model:$text"||e==="text"||e==="model:text"||e==="node"||e==="model:node"};var storePrefix="selection:",DocumentSelection2=class extends EmitterMixin(TypeCheckable2){_selection;constructor(e){super(),this._selection=new LiveSelection(e),this._selection.delegate("change:range").to(this),this._selection.delegate("change:attribute").to(this),this._selection.delegate("change:marker").to(this)}get isCollapsed(){return this._selection.isCollapsed}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get rangeCount(){return this._selection.rangeCount}get hasOwnRange(){return this._selection.hasOwnRange}get isBackward(){return this._selection.isBackward}get isGravityOverridden(){return this._selection.isGravityOverridden}get markers(){return this._selection.markers}get _ranges(){return this._selection._ranges}getRanges(){return this._selection.getRanges()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getSelectedBlocks(){return this._selection.getSelectedBlocks()}getSelectedElement(){return this._selection.getSelectedElement()}containsEntireContent(e){return this._selection.containsEntireContent(e)}destroy(){this._selection.destroy()}getAttributeKeys(){return this._selection.getAttributeKeys()}getAttributes(){return this._selection.getAttributes()}getAttribute(e){return this._selection.getAttribute(e)}hasAttribute(e){return this._selection.hasAttribute(e)}refresh(){this._selection.updateMarkers(),this._selection._updateAttributes(!1)}observeMarkers(e){this._selection.observeMarkers(e)}_setFocus(e,t){this._selection.setFocus(e,t)}_setTo(...e){this._selection.setTo(...e)}_setAttribute(e,t){this._selection.setAttribute(e,t)}_removeAttribute(e){this._selection.removeAttribute(e)}_getStoredAttributes(){return this._selection.getStoredAttributes()}_overrideGravity(){return this._selection.overrideGravity()}_restoreGravity(e){this._selection.restoreGravity(e)}static _getStoreAttributeKey(e){return storePrefix+e}static _isStoreAttributeKey(e){return e.startsWith(storePrefix)}};DocumentSelection2.prototype.is=function(e){return e==="selection"||e=="model:selection"||e=="documentSelection"||e=="model:documentSelection"};var LiveSelection=class extends Selection6{markers=new Collection({idProperty:"name"});_model;_document;_attributePriority=new Map;_selectionRestorePosition=null;_hasChangedRange=!1;_overriddenGravityRegister=new Set;_observedMarkers=new Set;constructor(e){super(),this._model=e.model,this._document=e,this.listenTo(this._model,"applyOperation",(t,r)=>{const i=r[0];!i.isDocumentOperation||i.type=="marker"||i.type=="rename"||i.type=="noop"||(this._ranges.length==0&&this._selectionRestorePosition&&this._fixGraveyardSelection(this._selectionRestorePosition),this._selectionRestorePosition=null,this._hasChangedRange&&(this._hasChangedRange=!1,this.fire("change:range",{directChange:!1})))},{priority:"lowest"}),this.on("change:range",()=>{this._validateSelectionRanges(this.getRanges())}),this.listenTo(this._model.markers,"update",(t,r,i,o)=>{this._updateMarker(r,o)}),this.listenTo(this._document,"change",(t,r)=>{clearAttributesStoredInElement(this._model,r)})}get isCollapsed(){return this._ranges.length===0?this._document._getDefaultRange().isCollapsed:super.isCollapsed}get anchor(){return super.anchor||this._document._getDefaultRange().start}get focus(){return super.focus||this._document._getDefaultRange().end}get rangeCount(){return this._ranges.length?this._ranges.length:1}get hasOwnRange(){return this._ranges.length>0}get isGravityOverridden(){return!!this._overriddenGravityRegister.size}destroy(){for(let e=0;e<this._ranges.length;e++)this._ranges[e].detach();this.stopListening()}*getRanges(){this._ranges.length?yield*super.getRanges():yield this._document._getDefaultRange()}getFirstRange(){return super.getFirstRange()||this._document._getDefaultRange()}getLastRange(){return super.getLastRange()||this._document._getDefaultRange()}setTo(...e){super.setTo(...e),this._updateAttributes(!0),this.updateMarkers()}setFocus(e,t){super.setFocus(e,t),this._updateAttributes(!0),this.updateMarkers()}setAttribute(e,t){if(this._setAttribute(e,t)){const r=[e];this.fire("change:attribute",{attributeKeys:r,directChange:!0})}}removeAttribute(e){if(this._removeAttribute(e)){const t=[e];this.fire("change:attribute",{attributeKeys:t,directChange:!0})}}overrideGravity(){const e=uid2();return this._overriddenGravityRegister.add(e),this._overriddenGravityRegister.size===1&&this._updateAttributes(!0),e}restoreGravity(e){if(!this._overriddenGravityRegister.has(e))throw new CKEditorError("document-selection-gravity-wrong-restore",this,{uid:e});this._overriddenGravityRegister.delete(e),this.isGravityOverridden||this._updateAttributes(!0)}observeMarkers(e){this._observedMarkers.add(e),this.updateMarkers()}_replaceAllRanges(e){this._validateSelectionRanges(e),super._replaceAllRanges(e)}_popRange(){this._ranges.pop().detach()}_pushRange(e){const t=this._prepareRange(e);t&&this._ranges.push(t)}_validateSelectionRanges(e){for(const t of e)if(!this._document._validateSelectionRange(t))throw new CKEditorError("document-selection-wrong-position",this,{range:t})}_prepareRange(e){if(this._checkRange(e),e.root==this._document.graveyard)return;const t=LiveRange.fromRange(e);return t.on("change:range",(r,i,o)=>{if(this._hasChangedRange=!0,t.root==this._document.graveyard){this._selectionRestorePosition=o.deletionPosition;const a=this._ranges.indexOf(t);this._ranges.splice(a,1),t.detach()}}),t}updateMarkers(){if(!this._observedMarkers.size)return;const e=[];let t=!1;for(const i of this._model.markers){const o=i.name.split(":",1)[0];if(!this._observedMarkers.has(o))continue;const a=i.getRange();for(const c of this.getRanges())a.containsRange(c,!c.isCollapsed)&&e.push(i)}const r=Array.from(this.markers);for(const i of e)this.markers.has(i)||(this.markers.add(i),t=!0);for(const i of Array.from(this.markers))e.includes(i)||(this.markers.remove(i),t=!0);t&&this.fire("change:marker",{oldMarkers:r,directChange:!1})}_updateMarker(e,t){const r=e.name.split(":",1)[0];if(!this._observedMarkers.has(r))return;let i=!1;const o=Array.from(this.markers),a=this.markers.has(e);if(!t)a&&(this.markers.remove(e),i=!0);else{let c=!1;for(const u of this.getRanges())if(t.containsRange(u,!u.isCollapsed)){c=!0;break}c&&!a?(this.markers.add(e),i=!0):!c&&a&&(this.markers.remove(e),i=!0)}i&&this.fire("change:marker",{oldMarkers:o,directChange:!1})}_updateAttributes(e){const t=toMap(this._getSurroundingAttributes()),r=toMap(this.getAttributes());if(e)this._attributePriority=new Map,this._attrs=new Map;else for(const[o,a]of this._attributePriority)a=="low"&&(this._attrs.delete(o),this._attributePriority.delete(o));this._setAttributesTo(t);const i=[];for(const[o,a]of this.getAttributes())(!r.has(o)||r.get(o)!==a)&&i.push(o);for(const[o]of r)this.hasAttribute(o)||i.push(o);i.length>0&&this.fire("change:attribute",{attributeKeys:i,directChange:!1})}_setAttribute(e,t,r=!0){const i=r?"normal":"low";return i=="low"&&this._attributePriority.get(e)=="normal"||super.getAttribute(e)===t?!1:(this._attrs.set(e,t),this._attributePriority.set(e,i),!0)}_removeAttribute(e,t=!0){const r=t?"normal":"low";return r=="low"&&this._attributePriority.get(e)=="normal"||(this._attributePriority.set(e,r),!super.hasAttribute(e))?!1:(this._attrs.delete(e),!0)}_setAttributesTo(e){const t=new Set;for(const[r,i]of this.getAttributes())e.get(r)!==i&&this._removeAttribute(r,!1);for(const[r,i]of e)this._setAttribute(r,i,!1)&&t.add(r);return t}*getStoredAttributes(){const e=this.getFirstPosition().parent;if(this.isCollapsed&&e.isEmpty)for(const t of e.getAttributeKeys())t.startsWith(storePrefix)&&(yield[t.substr(storePrefix.length),e.getAttribute(t)])}_getSurroundingAttributes(){const e=this.getFirstPosition(),t=this._model.schema;if(e.root.rootName=="$graveyard")return null;let r=null;if(this.isCollapsed){const i=e.textNode?e.textNode:e.nodeBefore,o=e.textNode?e.textNode:e.nodeAfter;if(this.isGravityOverridden||(r=getTextAttributes(i,t)),r||(r=getTextAttributes(o,t)),!this.isGravityOverridden&&!r){let a=i;for(;a&&!r;)a=a.previousSibling,r=getTextAttributes(a,t)}if(!r){let a=o;for(;a&&!r;)a=a.nextSibling,r=getTextAttributes(a,t)}r||(r=this.getStoredAttributes())}else{const i=this.getFirstRange();for(const o of i){if(o.item.is("element")&&t.isObject(o.item)){r=getTextAttributes(o.item,t);break}if(o.type=="text"){r=o.item.getAttributes();break}}}return r}_fixGraveyardSelection(e){const t=this._model.schema.getNearestSelectionRange(e);t&&this._pushRange(t)}};function getTextAttributes(e,t){if(!e)return null;if(e instanceof TextProxy2||e instanceof Text2)return e.getAttributes();if(!t.isInline(e))return null;if(!t.isObject(e))return[];const r=[];for(const[i,o]of e.getAttributes())t.checkAttribute("$text",i)&&t.getAttributeProperties(i).copyFromObject!==!1&&r.push([i,o]);return r}function clearAttributesStoredInElement(e,t){const r=e.document.differ;for(const i of r.getChanges()){if(i.type!="insert")continue;const o=i.position.parent;i.length===o.maxOffset&&e.enqueueChange(t,c=>{const u=Array.from(o.getAttributeKeys()).filter(h=>h.startsWith(storePrefix));for(const h of u)c.removeAttribute(h,o)})}}var NodeList=class{_nodes=[];_offsetToNode=[];constructor(e){e&&this._insertNodes(0,e)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._offsetToNode.length}getNode(e){return this._nodes[e]||null}getNodeAtOffset(e){return this._offsetToNode[e]||null}getNodeIndex(e){return e.index}getNodeStartOffset(e){return e.startOffset}indexToOffset(e){if(e==this._nodes.length)return this.maxOffset;const t=this._nodes[e];if(!t)throw new CKEditorError("model-nodelist-index-out-of-bounds",this);return this.getNodeStartOffset(t)}offsetToIndex(e){if(e==this._offsetToNode.length)return this._nodes.length;const t=this._offsetToNode[e];if(!t)throw new CKEditorError("model-nodelist-offset-out-of-bounds",this,{offset:e,nodeList:this});return this.getNodeIndex(t)}_insertNodes(e,t){const r=[];for(const o of t){if(!(o instanceof Node$1))throw new CKEditorError("model-nodelist-insertnodes-not-node",this);r.push(o)}let i=this.indexToOffset(e);spliceArray(this._nodes,r,e),spliceArray(this._offsetToNode,makeOffsetsArray(r),i);for(let o=e;o<this._nodes.length;o++)this._nodes[o]._index=o,this._nodes[o]._startOffset=i,i+=this._nodes[o].offsetSize}_removeNodes(e,t=1){if(t==0)return[];let r=this.indexToOffset(e);const i=this._nodes.splice(e,t),o=i[i.length-1],a=o.startOffset+o.offsetSize-r;this._offsetToNode.splice(r,a);for(const c of i)c._index=null,c._startOffset=null;for(let c=e;c<this._nodes.length;c++)this._nodes[c]._index=c,this._nodes[c]._startOffset=r,r+=this._nodes[c].offsetSize;return i}_removeNodesArray(e){if(e.length==0)return;for(const r of e)r._index=null,r._startOffset=null;this._nodes=this._nodes.filter(r=>r.index!==null),this._offsetToNode=this._offsetToNode.filter(r=>r.index!==null);let t=0;for(let r=0;r<this._nodes.length;r++)this._nodes[r]._index=r,this._nodes[r]._startOffset=t,t+=this._nodes[r].offsetSize}toJSON(){return this._nodes.map(e=>e.toJSON())}};function makeOffsetsArray(e){const t=[];let r=0;for(const i of e)for(let o=0;o<i.offsetSize;o++)t[r++]=i;return t}var Element4=class Rn extends Node$1{name;_children=new NodeList;constructor(t,r,i){super(r),this.name=t,i&&this._insertChild(0,i)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}getChild(t){return this._children.getNode(t)}getChildAtOffset(t){return this._children.getNodeAtOffset(t)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(t){return this._children.getNodeIndex(t)}getChildStartOffset(t){return this._children.getNodeStartOffset(t)}offsetToIndex(t){return this._children.offsetToIndex(t)}getNodeByPath(t){let r=this;for(const i of t)r=r.getChildAtOffset(i);return r}findAncestor(t,r={}){let i=r.includeSelf?this:this.parent;for(;i;){if(i.name===t)return i;i=i.parent}return null}toJSON(){const t=super.toJSON();if(t.name=this.name,this._children.length>0){t.children=[];for(const r of this._children)t.children.push(r.toJSON())}return t}_clone(t=!1){const r=t?cloneNodes(this._children):void 0;return new Rn(this.name,this.getAttributes(),r)}_appendChild(t){this._insertChild(this.childCount,t)}_insertChild(t,r){const i=normalize$1(r);for(const o of i)o.parent!==null&&o._remove(),o.parent=this;this._children._insertNodes(t,i)}_removeChildren(t,r=1){const i=this._children._removeNodes(t,r);for(const o of i)o.parent=null;return i}_removeChildrenArray(t){this._children._removeNodesArray(t);for(const r of t)r.parent=null}static fromJSON(t){let r;if(t.children){r=[];for(const i of t.children)i.name?r.push(Rn.fromJSON(i)):r.push(Text2.fromJSON(i))}return new Rn(t.name,t.attributes,r)}};Element4.prototype.is=function(e,t){return t?t===this.name&&(e==="element"||e==="model:element"):e==="element"||e==="model:element"||e==="node"||e==="model:node"};function normalize$1(e){if(typeof e=="string")return[new Text2(e)];isIterable(e)||(e=[e]);const t=[];for(const r of e)typeof r=="string"?t.push(new Text2(r)):r instanceof TextProxy2?t.push(new Text2(r.data,r.getAttributes())):t.push(r);return t}function cloneNodes(e){const t=[];for(const r of e)t.push(r._clone(!0));return t}var ConversionHelpers=class{_dispatchers;constructor(e){this._dispatchers=e}add(e){for(const t of this._dispatchers)e(t);return this}},DowncastHelpers=class extends ConversionHelpers{elementToElement(e){return this.add(downcastElementToElement(e))}elementToStructure(e){return this.add(downcastElementToStructure(e))}attributeToElement(e){return this.add(downcastAttributeToElement(e))}attributeToAttribute(e){return this.add(downcastAttributeToAttribute(e))}markerToElement(e){return this.add(downcastMarkerToElement(e))}markerToHighlight(e){return this.add(downcastMarkerToHighlight(e))}markerToData(e){return this.add(downcastMarkerToData(e))}};function insertText(){return(e,t,r)=>{if(!r.consumable.consume(t.item,e.name))return;const i=r.writer,o=r.mapper.toViewPosition(t.range.start),a=i.createText(t.item.data);i.insert(o,a)}}function insertAttributesAndChildren(){return(e,t,r)=>{r.convertAttributes(t.item),!t.reconversion&&t.item.is("element")&&!t.item.isEmpty&&r.convertChildren(t.item)}}function remove3(){return(e,t,r)=>{const i=r.mapper.toViewPosition(t.position),o=t.position.getShiftedBy(t.length),a=r.mapper.toViewPosition(o,{isPhantom:!0}),c=r.writer.createRange(i,a),u=r.writer.remove(c.getTrimmed());for(const h of r.writer.createRangeIn(u).getItems())r.mapper.unbindViewElement(h,{defer:!0})}}function createViewElementFromHighlightDescriptor(e,t){const r=e.createAttributeElement("span",t.attributes);return t.classes&&r._addClass(t.classes),typeof t.priority=="number"&&(r._priority=t.priority),r._id=t.id,r}function convertRangeSelection(){return(e,t,r)=>{const i=t.selection;if(i.isCollapsed||!r.consumable.consume(i,"selection"))return;const o=[];for(const a of i.getRanges())o.push(r.mapper.toViewRange(a));r.writer.setSelection(o,{backward:i.isBackward})}}function convertCollapsedSelection(){return(e,t,r)=>{const i=t.selection;if(!i.isCollapsed||!r.consumable.consume(i,"selection"))return;const o=r.writer,a=i.getFirstPosition(),c=r.mapper.toViewPosition(a),u=o.breakAttributes(c);o.setSelection(u)}}function cleanSelection(){return(e,t,r)=>{const i=r.writer,o=i.document.selection;for(const a of o.getRanges())a.isCollapsed&&a.end.parent.isAttached()&&r.writer.mergeAttributes(a.start);i.setSelection(null)}}function wrap(e){return(t,r,i)=>{if(!i.consumable.test(r.item,t.name))return;const o=e(r.attributeOldValue,i,r),a=e(r.attributeNewValue,i,r);if(!o&&!a)return;i.consumable.consume(r.item,t.name);const c=i.writer,u=c.document.selection;if(r.item instanceof Selection6||r.item instanceof DocumentSelection2)c.wrap(u.getFirstRange(),a);else{let h=i.mapper.toViewRange(r.range);r.attributeOldValue!==null&&o&&(h=c.unwrap(h,o)),r.attributeNewValue!==null&&a&&c.wrap(h,a)}}}function insertElement(e,t=defaultConsumer){return(r,i,o)=>{if(!t(i.item,o.consumable,{preflight:!0}))return;const a=e(i.item,o,i);if(!a)return;t(i.item,o.consumable);const c=o.mapper.toViewPosition(i.range.start);o.mapper.bindElements(i.item,a),o.writer.insert(c,a),o.convertAttributes(i.item),reinsertOrConvertNodes(a,i.item.getChildren(),o,{reconversion:i.reconversion})}}function insertStructure(e,t){return(r,i,o)=>{if(!t(i.item,o.consumable,{preflight:!0}))return;const a=new Map;o.writer._registerSlotFactory(createSlotFactory(i.item,a,o));const c=e(i.item,o,i);if(o.writer._clearSlotFactory(),!c)return;validateSlotsChildren(i.item,a,o),t(i.item,o.consumable);const u=o.mapper.toViewPosition(i.range.start);o.mapper.bindElements(i.item,c),o.writer.insert(u,c),o.convertAttributes(i.item),fillSlots(c,a,o,{reconversion:i.reconversion})}}function insertUIElement(e){return(t,r,i)=>{r.isOpening=!0;const o=e(r,i);r.isOpening=!1;const a=e(r,i);if(!o||!a)return;const c=r.markerRange;if(c.isCollapsed&&!i.consumable.consume(c,t.name))return;for(const d of c)if(!i.consumable.consume(d.item,t.name))return;const u=i.mapper,h=i.writer;h.insert(u.toViewPosition(c.start),o),i.mapper.bindElementToMarker(o,r.markerName),c.isCollapsed||(h.insert(u.toViewPosition(c.end),a),i.mapper.bindElementToMarker(a,r.markerName)),t.stop()}}function removeUIElement(){return(e,t,r)=>{const i=r.mapper.markerNameToElements(t.markerName);if(i){for(const o of i)r.mapper.unbindElementFromMarkerName(o,t.markerName),r.writer.clear(r.writer.createRangeOn(o),o);r.writer.clearClonedElementsGroup(t.markerName),e.stop()}}}function insertMarkerData(e){return(t,r,i)=>{const o=e(r.markerName,i);if(!o)return;const a=r.markerRange;i.consumable.consume(a,t.name)&&(handleMarkerBoundary(a,!1,i,r,o),handleMarkerBoundary(a,!0,i,r,o),t.stop())}}function handleMarkerBoundary(e,t,r,i,o){const a=t?e.start:e.end,c=a.nodeAfter&&a.nodeAfter.is("element")?a.nodeAfter:null,u=a.nodeBefore&&a.nodeBefore.is("element")?a.nodeBefore:null;if(c||u){let d,f;t&&c||!t&&!u?(d=c,f=!0):(d=u,f=!1);const m=r.mapper.toViewElement(d);if(m){insertMarkerAsAttribute(m,t,f,r,i,o);return}}const h=r.mapper.toViewPosition(a);insertMarkerAsElement(h,t,r,i,o)}function insertMarkerAsAttribute(e,t,r,i,o,a){const c=`data-${a.group}-${t?"start":"end"}-${r?"before":"after"}`,u=e.hasAttribute(c)?e.getAttribute(c).split(","):[];u.unshift(a.name),i.writer.setAttribute(c,u.join(","),e),i.mapper.bindElementToMarker(e,o.markerName)}function insertMarkerAsElement(e,t,r,i,o){const a=`${o.group}-${t?"start":"end"}`,c=o.name?{name:o.name}:null,u=r.writer.createUIElement(a,c);r.writer.insert(e,u),r.mapper.bindElementToMarker(u,i.markerName)}function removeMarkerData(e){return(t,r,i)=>{const o=e(r.markerName,i);if(!o)return;const a=i.mapper.markerNameToElements(r.markerName);if(!a)return;for(const u of a)i.mapper.unbindElementFromMarkerName(u,r.markerName),u.is("containerElement")?(c(`data-${o.group}-start-before`,u),c(`data-${o.group}-start-after`,u),c(`data-${o.group}-end-before`,u),c(`data-${o.group}-end-after`,u)):i.writer.clear(i.writer.createRangeOn(u),u);i.writer.clearClonedElementsGroup(r.markerName),t.stop();function c(u,h){if(h.hasAttribute(u)){const d=new Set(h.getAttribute(u).split(","));d.delete(o.name),d.size==0?i.writer.removeAttribute(u,h):i.writer.setAttribute(u,Array.from(d).join(","),h)}}}}function changeAttribute(e){return(t,r,i)=>{if(!i.consumable.test(r.item,t.name))return;const o=e(r.attributeOldValue,i,r),a=e(r.attributeNewValue,i,r);if(!o&&!a)return;i.consumable.consume(r.item,t.name);const c=i.mapper.toViewElement(r.item),u=i.writer;if(!c)throw new CKEditorError("conversion-attribute-to-attribute-on-text",i.dispatcher,r);if(r.attributeOldValue!==null&&o)if(o.key=="class"){const h=typeof o.value=="string"?o.value.split(/\s+/):o.value;for(const d of h)u.removeClass(d,c)}else if(o.key=="style")if(typeof o.value=="string"){const h=new StylesMap(u.document.stylesProcessor);h.setTo(o.value);for(const[d]of h.getStylesEntries())u.removeStyle(d,c)}else{const h=Object.keys(o.value);for(const d of h)u.removeStyle(d,c)}else u.removeAttribute(o.key,c);if(r.attributeNewValue!==null&&a)if(a.key=="class"){const h=typeof a.value=="string"?a.value.split(/\s+/):a.value;for(const d of h)u.addClass(d,c)}else if(a.key=="style")if(typeof a.value=="string"){const h=new StylesMap(u.document.stylesProcessor);h.setTo(a.value);for(const[d,f]of h.getStylesEntries())u.setStyle(d,f,c)}else{const h=Object.keys(a.value);for(const d of h)u.setStyle(d,a.value[d],c)}else u.setAttribute(a.key,a.value,c)}}function highlightText(e){return(t,r,i)=>{if(!r.item||!(r.item instanceof Selection6||r.item instanceof DocumentSelection2)&&!r.item.is("$textProxy"))return;const o=prepareDescriptor(e,r,i);if(!o||!i.consumable.consume(r.item,t.name))return;const a=i.writer,c=createViewElementFromHighlightDescriptor(a,o),u=a.document.selection;if(r.item instanceof Selection6||r.item instanceof DocumentSelection2)a.wrap(u.getFirstRange(),c);else{const h=i.mapper.toViewRange(r.range),d=a.wrap(h,c);for(const f of d.getItems())if(f.is("attributeElement")&&f.isSimilar(c)){i.mapper.bindElementToMarker(f,r.markerName);break}}}}function highlightElement(e){return(t,r,i)=>{if(!r.item||!(r.item instanceof Element4))return;const o=prepareDescriptor(e,r,i);if(!o||!i.consumable.test(r.item,t.name))return;const a=i.mapper.toViewElement(r.item);if(a&&a.getCustomProperty("addHighlight")){i.consumable.consume(r.item,t.name);for(const u of Range2._createIn(r.item))i.consumable.consume(u.item,t.name);a.getCustomProperty("addHighlight")(a,o,i.writer),i.mapper.bindElementToMarker(a,r.markerName)}}}function removeHighlight(e){return(t,r,i)=>{if(r.markerRange.isCollapsed)return;const o=prepareDescriptor(e,r,i);if(!o)return;const a=createViewElementFromHighlightDescriptor(i.writer,o),c=i.mapper.markerNameToElements(r.markerName);if(c){for(const u of c)i.mapper.unbindElementFromMarkerName(u,r.markerName),u.is("attributeElement")?i.writer.unwrap(i.writer.createRangeOn(u),a):u.getCustomProperty("removeHighlight")(u,o.id,i.writer);i.writer.clearClonedElementsGroup(r.markerName),t.stop()}}}function downcastElementToElement(e){const t=normalizeModelElementConfig(e.model),r=normalizeToElementConfig(e.view,"container");return t.attributes.length&&(t.children=!0),i=>{i.on(`insert:${t.name}`,insertElement(r,createConsumer(t)),{priority:e.converterPriority||"normal"}),(t.children||t.attributes.length)&&i.on("reduceChanges",createChangeReducer(t),{priority:"low"})}}function downcastElementToStructure(e){const t=normalizeModelElementConfig(e.model),r=normalizeToElementConfig(e.view,"container");return t.children=!0,i=>{if(i._conversionApi.schema.checkChild(t.name,"$text"))throw new CKEditorError("conversion-element-to-structure-disallowed-text",i,{elementName:t.name});i.on(`insert:${t.name}`,insertStructure(r,createConsumer(t)),{priority:e.converterPriority||"normal"}),i.on("reduceChanges",createChangeReducer(t),{priority:"low"})}}function downcastAttributeToElement(e){e=cloneDeep_default(e);let t=e.model;typeof t=="string"&&(t={key:t});let r=`attribute:${t.key}`;if(t.name&&(r+=":"+t.name),t.values)for(const o of t.values)e.view[o]=normalizeToElementConfig(e.view[o],"attribute");else e.view=normalizeToElementConfig(e.view,"attribute");const i=getFromAttributeCreator(e);return o=>{o.on(r,wrap(i),{priority:e.converterPriority||"normal"})}}function downcastAttributeToAttribute(e){e=cloneDeep_default(e);let t=e.model;typeof t=="string"&&(t={key:t});let r=`attribute:${t.key}`;if(t.name&&(r+=":"+t.name),t.values)for(const o of t.values)e.view[o]=normalizeToAttributeConfig(e.view[o]);else e.view=normalizeToAttributeConfig(e.view);const i=getFromAttributeCreator(e);return o=>{o.on(r,changeAttribute(i),{priority:e.converterPriority||"normal"})}}function downcastMarkerToElement(e){const t=normalizeToElementConfig(e.view,"ui");return r=>{r.on(`addMarker:${e.model}`,insertUIElement(t),{priority:e.converterPriority||"normal"}),r.on(`removeMarker:${e.model}`,removeUIElement(),{priority:e.converterPriority||"normal"})}}function downcastMarkerToData(e){e=cloneDeep_default(e);const t=e.model;let r=e.view;return r||(r=i=>({group:t,name:i.substr(e.model.length+1)})),i=>{i.on(`addMarker:${t}`,insertMarkerData(r),{priority:e.converterPriority||"normal"}),i.on(`removeMarker:${t}`,removeMarkerData(r),{priority:e.converterPriority||"normal"})}}function downcastMarkerToHighlight(e){return t=>{t.on(`addMarker:${e.model}`,highlightText(e.view),{priority:e.converterPriority||"normal"}),t.on(`addMarker:${e.model}`,highlightElement(e.view),{priority:e.converterPriority||"normal"}),t.on(`removeMarker:${e.model}`,removeHighlight(e.view),{priority:e.converterPriority||"normal"})}}function normalizeModelElementConfig(e){return typeof e=="string"&&(e={name:e}),{name:e.name,attributes:e.attributes?toArray(e.attributes):[],children:!!e.children}}function normalizeToElementConfig(e,t){return typeof e=="function"?e:(r,i)=>createViewElementFromDefinition(e,i,t)}function createViewElementFromDefinition(e,t,r){typeof e=="string"&&(e={name:e});let i;const o=t.writer,a=Object.assign({},e.attributes);if(r=="container")i=o.createContainerElement(e.name,a);else if(r=="attribute"){const c={priority:e.priority||AttributeElement.DEFAULT_PRIORITY};i=o.createAttributeElement(e.name,a,c)}else i=o.createUIElement(e.name,a);if(e.styles){const c=Object.keys(e.styles);for(const u of c)o.setStyle(u,e.styles[u],i)}if(e.classes){const c=e.classes;if(typeof c=="string")o.addClass(c,i);else for(const u of c)o.addClass(u,i)}return i}function getFromAttributeCreator(e){return e.model.values?(t,r,i)=>{const o=e.view[t];return o?o(t,r,i):null}:e.view}function normalizeToAttributeConfig(e){return typeof e=="string"?t=>({key:e,value:t}):typeof e=="object"?e.value?()=>e:t=>({key:e.key,value:t}):e}function prepareDescriptor(e,t,r){const i=typeof e=="function"?e(t,r):e;return i?(i.priority||(i.priority=10),i.id||(i.id=t.markerName),i):null}function createChangeReducerCallback(e){return(t,r)=>{if(!t.is("element",e.name))return!1;if(r.type=="attribute"){if(e.attributes.includes(r.attributeKey))return!0}else if(e.children)return!0;return!1}}function createChangeReducer(e){const t=createChangeReducerCallback(e);return(r,i)=>{const o=[];i.reconvertedElements||(i.reconvertedElements=new Set);for(const a of i.changes){const c=a.type=="attribute"?a.range.start.nodeAfter:a.position.parent;if(!c||!t(c,a)){o.push(a);continue}if(!i.reconvertedElements.has(c)){i.reconvertedElements.add(c);const u=Position2._createBefore(c);let h=o.length;for(let d=o.length-1;d>=0;d--){const f=o[d],g=(f.type=="attribute"?f.range.start:f.position).compareWith(u);if(g=="before"||f.type=="remove"&&g=="same")break;h=d}o.splice(h,0,{type:"remove",name:c.name,position:u,length:1},{type:"reinsert",name:c.name,position:u,length:1})}}i.changes=o}}function createConsumer(e){return(t,r,i={})=>{const o=["insert"];for(const a of e.attributes)t.hasAttribute(a)&&o.push(`attribute:${a}`);return o.every(a=>r.test(t,a))?(i.preflight||o.forEach(a=>r.consume(t,a)),!0):!1}}function createSlotFactory(e,t,r){return(i,o)=>{const a=i.createContainerElement("$slot");let c=null;if(o==="children")c=Array.from(e.getChildren());else if(typeof o=="function")c=Array.from(e.getChildren()).filter(u=>o(u));else throw new CKEditorError("conversion-slot-mode-unknown",r.dispatcher,{modeOrFilter:o});return t.set(a,c),a}}function validateSlotsChildren(e,t,r){const i=Array.from(t.values()).flat(),o=new Set(i);if(o.size!=i.length)throw new CKEditorError("conversion-slot-filter-overlap",r.dispatcher,{element:e});if(o.size!=e.childCount)throw new CKEditorError("conversion-slot-filter-incomplete",r.dispatcher,{element:e})}function fillSlots(e,t,r,i){r.mapper.on("modelToViewPosition",c,{priority:"highest"});let o=null,a=null;for([o,a]of t)reinsertOrConvertNodes(e,a,r,i),r.writer.move(r.writer.createRangeIn(o),r.writer.createPositionBefore(o)),r.writer.remove(o);r.mapper.off("modelToViewPosition",c);function c(u,h){const d=h.modelPosition.nodeAfter,f=a.indexOf(d);f<0||(h.viewPosition=h.mapper.findPositionIn(o,f))}}function reinsertOrConvertNodes(e,t,r,i){for(const o of t)reinsertNode(e.root,o,r,i)||r.convertItem(o)}function reinsertNode(e,t,r,i){const{writer:o,mapper:a}=r;if(!i.reconversion)return!1;const c=a.toViewElement(t);return!c||c.root==e||!r.canReuseView(c)?!1:(o.move(o.createRangeOn(c),a.toViewPosition(Position2._createBefore(t))),!0)}function defaultConsumer(e,t,{preflight:r}={}){return r?t.test(e,"insert"):t.consume(e,"insert")}function autoParagraphEmptyRoots(e){const{schema:t,document:r}=e.model;for(const i of r.getRoots())if(i.isEmpty&&!t.checkChild(i,"$text")&&t.checkChild(i,"paragraph"))return e.insertElement("paragraph",i),!0;return!1}function isParagraphable(e,t,r){const i=r.createContext(e);return!(!r.checkChild(i,"paragraph")||!r.checkChild(i.push("paragraph"),t))}function wrapInParagraph(e,t){const r=t.createElement("paragraph");return t.insert(r,e),t.createPositionAt(r,0)}var UpcastHelpers=class extends ConversionHelpers{elementToElement(e){return this.add(upcastElementToElement(e))}elementToAttribute(e){return this.add(upcastElementToAttribute(e))}attributeToAttribute(e){return this.add(upcastAttributeToAttribute(e))}elementToMarker(e){return this.add(upcastElementToMarker(e))}dataToMarker(e){return this.add(upcastDataToMarker(e))}};function convertToModelFragment$1(){return(e,t,r)=>{if(!t.modelRange&&r.consumable.consume(t.viewItem,{name:!0})){const{modelRange:i,modelCursor:o}=r.convertChildren(t.viewItem,t.modelCursor);t.modelRange=i,t.modelCursor=o}}}function convertText(){return(e,t,{schema:r,consumable:i,writer:o})=>{let a=t.modelCursor;if(!i.test(t.viewItem))return;if(!r.checkChild(a,"$text")){if(!isParagraphable(a,"$text",r)||t.viewItem.data.trim().length==0)return;a=wrapInParagraph(a,o)}i.consume(t.viewItem);const c=o.createText(t.viewItem.data);o.insert(c,a),t.modelRange=o.createRange(a,a.getShiftedBy(c.offsetSize)),t.modelCursor=t.modelRange.end}}function convertSelectionChange(e,t){return(r,i)=>{const o=i.newSelection,a=[];for(const u of o.getRanges())a.push(t.toModelRange(u));const c=e.createSelection(a,{backward:o.isBackward});c.isEqual(e.document.selection)||e.change(u=>{u.setSelection(c)})}}function upcastElementToElement(e){e=cloneDeep_default(e);const t=prepareToElementConverter(e),r=getViewElementNameFromConfig(e.view),i=r?`element:${r}`:"element";return o=>{o.on(i,t,{priority:e.converterPriority||"normal"})}}function upcastElementToAttribute(e){e=cloneDeep_default(e),normalizeModelAttributeConfig(e);const t=prepareToAttributeConverter(e,!1),r=getViewElementNameFromConfig(e.view),i=r?`element:${r}`:"element";return o=>{o.on(i,t,{priority:e.converterPriority||"low"})}}function upcastAttributeToAttribute(e){e=cloneDeep_default(e);let t=null;(typeof e.view=="string"||e.view.key)&&(t=normalizeViewAttributeKeyValueConfig(e)),normalizeModelAttributeConfig(e,t);const r=prepareToAttributeConverter(e,!0);return i=>{i.on("element",r,{priority:e.converterPriority||"low"})}}function upcastElementToMarker(e){const t=normalizeElementToMarkerModelConfig(e.model);return upcastElementToElement({...e,model:t})}function upcastDataToMarker(e){e=cloneDeep_default(e),e.model||(e.model=o=>o?e.view+":"+o:e.view);const t={view:e.view,model:e.model},r=prepareToElementConverter(normalizeDataToMarkerConfig(t,"start")),i=prepareToElementConverter(normalizeDataToMarkerConfig(t,"end"));return o=>{o.on(`element:${e.view}-start`,r,{priority:e.converterPriority||"normal"}),o.on(`element:${e.view}-end`,i,{priority:e.converterPriority||"normal"});const a=priorities.low,c=priorities.highest,u=priorities.get(e.converterPriority)/c;o.on("element",upcastAttributeToMarker(t),{priority:a+u})}}function upcastAttributeToMarker(e){return(t,r,i)=>{const o=`data-${e.view}`;if(!i.consumable.test(r.viewItem,{attributes:o+"-end-after"})&&!i.consumable.test(r.viewItem,{attributes:o+"-start-after"})&&!i.consumable.test(r.viewItem,{attributes:o+"-end-before"})&&!i.consumable.test(r.viewItem,{attributes:o+"-start-before"}))return;r.modelRange||Object.assign(r,i.convertChildren(r.viewItem,r.modelCursor)),i.consumable.consume(r.viewItem,{attributes:o+"-end-after"})&&a(r.modelRange.end,r.viewItem.getAttribute(o+"-end-after").split(",")),i.consumable.consume(r.viewItem,{attributes:o+"-start-after"})&&a(r.modelRange.end,r.viewItem.getAttribute(o+"-start-after").split(",")),i.consumable.consume(r.viewItem,{attributes:o+"-end-before"})&&a(r.modelRange.start,r.viewItem.getAttribute(o+"-end-before").split(",")),i.consumable.consume(r.viewItem,{attributes:o+"-start-before"})&&a(r.modelRange.start,r.viewItem.getAttribute(o+"-start-before").split(","));function a(c,u){for(const h of u){const d=e.model(h,i),f=i.writer.createElement("$marker",{"data-name":d});i.writer.insert(f,c),r.modelCursor.isEqual(c)?r.modelCursor=r.modelCursor.getShiftedBy(1):r.modelCursor=r.modelCursor._getTransformedByInsertion(c,1),r.modelRange=r.modelRange._getTransformedByInsertion(c,1)[0]}}}}function getViewElementNameFromConfig(e){return typeof e=="string"?e:typeof e=="object"&&typeof e.name=="string"?e.name:null}function prepareToElementConverter(e){const t=new Matcher(e.view);return(r,i,o)=>{const a=t.match(i.viewItem);if(!a)return;const c=a.match;if(c.name=!0,!o.consumable.test(i.viewItem,c))return;const u=getModelElement(e.model,i.viewItem,o);u&&o.safeInsert(u,i.modelCursor)&&(o.consumable.consume(i.viewItem,c),o.convertChildren(i.viewItem,u),o.updateConversionResult(u,i))}}function getModelElement(e,t,r){return e instanceof Function?e(t,r):r.writer.createElement(e)}function normalizeViewAttributeKeyValueConfig(e){typeof e.view=="string"&&(e.view={key:e.view});const t=e.view.key,r=typeof e.view.value>"u"?/[\s\S]*/:e.view.value;let i;return t=="class"||t=="style"?i={[t=="class"?"classes":"styles"]:r}:i={attributes:{[t]:r}},e.view.name&&(i.name=e.view.name),e.view=i,t}function normalizeModelAttributeConfig(e,t=null){const r=t===null?!0:a=>a.getAttribute(t),i=typeof e.model!="object"?e.model:e.model.key,o=typeof e.model!="object"||typeof e.model.value>"u"?r:e.model.value;e.model={key:i,value:o}}function prepareToAttributeConverter(e,t){const r=new Matcher(e.view);return(i,o,a)=>{if(!o.modelRange&&t)return;const c=r.match(o.viewItem);if(!c||(onlyViewNameIsDefined(e.view,o.viewItem)?c.match.name=!0:delete c.match.name,!a.consumable.test(o.viewItem,c.match)))return;const u=e.model.key,h=typeof e.model.value=="function"?e.model.value(o.viewItem,a):e.model.value;if(h===null)return;o.modelRange||Object.assign(o,a.convertChildren(o.viewItem,o.modelCursor)),setAttributeOn(o.modelRange,{key:u,value:h},t,a)&&(a.consumable.test(o.viewItem,{name:!0})&&(c.match.name=!0),a.consumable.consume(o.viewItem,c.match))}}function onlyViewNameIsDefined(e,t){const r=typeof e=="function"?e(t):e;return typeof r=="object"&&!getViewElementNameFromConfig(r)?!1:!r.classes&&!r.attributes&&!r.styles}function setAttributeOn(e,t,r,i){let o=!1;for(const a of Array.from(e.getItems({shallow:r})))i.schema.checkAttribute(a,t.key)&&(o=!0,!a.hasAttribute(t.key)&&i.writer.setAttribute(t.key,t.value,a));return o}function normalizeElementToMarkerModelConfig(e){return(t,r)=>{const i=typeof e=="string"?e:e(t,r);return r.writer.createElement("$marker",{"data-name":i})}}function normalizeDataToMarkerConfig(e,t){const r=(i,o)=>{const a=i.getAttribute("name"),c=e.model(a,o);return o.writer.createElement("$marker",{"data-name":c})};return{view:`${e.view}-${t}`,model:r}}function injectSelectionPostFixer(e){e.document.registerPostFixer(t=>selectionPostFixer(t,e))}function selectionPostFixer(e,t){const r=t.document.selection,i=t.schema,o=[];let a=!1;for(const c of r.getRanges()){const u=tryFixingRange(c,i);u&&!u.isEqual(c)?(o.push(u),a=!0):o.push(c)}return a&&e.setSelection(mergeIntersectingRanges(o),{backward:r.isBackward}),!1}function tryFixingRange(e,t){return e.isCollapsed?tryFixingCollapsedRange(e,t):tryFixingNonCollapsedRage(e,t)}function tryFixingCollapsedRange(e,t){const r=e.start,i=t.getNearestSelectionRange(r);if(!i){const a=r.getAncestors().reverse().find(c=>t.isObject(c));return a?Range2._createOn(a):null}if(!i.isCollapsed)return i;const o=i.start;return r.isEqual(o)?null:new Range2(o)}function tryFixingNonCollapsedRage(e,t){const{start:r,end:i}=e,o=t.checkChild(r,"$text"),a=t.checkChild(i,"$text"),c=t.getLimitElement(r),u=t.getLimitElement(i);if(c===u){if(o&&a)return null;if(checkSelectionOnNonLimitElements(r,i,t)){const m=r.nodeAfter&&t.isSelectable(r.nodeAfter)?null:t.getNearestSelectionRange(r,"forward"),v=i.nodeBefore&&t.isSelectable(i.nodeBefore)?null:t.getNearestSelectionRange(i,"backward"),_=m?m.start:r,b=v?v.end:i;return new Range2(_,b)}}const h=c&&!c.is("rootElement"),d=u&&!u.is("rootElement");if(h||d){const f=r.nodeAfter&&i.nodeBefore&&r.nodeAfter.parent===i.nodeBefore.parent,m=h&&(!f||!isSelectable(r.nodeAfter,t)),g=d&&(!f||!isSelectable(i.nodeBefore,t));let v=r,_=i;return m&&(v=Position2._createBefore(findOutermostLimitAncestor(c,t))),g&&(_=Position2._createAfter(findOutermostLimitAncestor(u,t))),new Range2(v,_)}return null}function findOutermostLimitAncestor(e,t){let r=e,i=r;for(;t.isLimit(i)&&i.parent;)r=i,i=i.parent;return r}function checkSelectionOnNonLimitElements(e,t,r){const i=e.nodeAfter&&!r.isLimit(e.nodeAfter)||r.checkChild(e,"$text"),o=t.nodeBefore&&!r.isLimit(t.nodeBefore)||r.checkChild(t,"$text");return i||o}function mergeIntersectingRanges(e){const t=[...e],r=new Set;let i=1;for(;i<t.length;){const a=t[i],c=t.slice(0,i);for(const[u,h]of c.entries())if(!r.has(u)){if(a.isEqual(h))r.add(u);else if(a.isIntersecting(h)){r.add(u),r.add(i);const d=a.getJoined(h);t.push(d)}}i++}return t.filter((a,c)=>!r.has(c))}function isSelectable(e,t){return e&&t.isSelectable(e)}var EditingController=class extends ObservableMixin(){model;view;mapper;downcastDispatcher;constructor(e,t){super(),this.model=e,this.view=new View(t),this.mapper=new Mapper,this.downcastDispatcher=new DowncastDispatcher({mapper:this.mapper,schema:e.schema});const r=this.model.document,i=r.selection,o=this.model.markers;this.listenTo(this.model,"_beforeChanges",()=>{this.view._disableRendering(!0)},{priority:"highest"}),this.listenTo(this.model,"_afterChanges",()=>{this.view._disableRendering(!1)},{priority:"lowest"}),this.listenTo(r,"change",()=>{this.view.change(a=>{this.downcastDispatcher.convertChanges(r.differ,o,a),this.downcastDispatcher.convertSelection(i,o,a)})},{priority:"low"}),this.listenTo(this.view.document,"selectionChange",convertSelectionChange(this.model,this.mapper)),this.listenTo(this.view.document,"beforeinput",fixTargetRanges(this.mapper,this.model.schema,this.view),{priority:"high"}),this.downcastDispatcher.on("insert:$text",insertText(),{priority:"lowest"}),this.downcastDispatcher.on("insert",insertAttributesAndChildren(),{priority:"lowest"}),this.downcastDispatcher.on("remove",remove3(),{priority:"low"}),this.downcastDispatcher.on("cleanSelection",cleanSelection()),this.downcastDispatcher.on("selection",convertRangeSelection(),{priority:"low"}),this.downcastDispatcher.on("selection",convertCollapsedSelection(),{priority:"low"}),this.view.document.roots.bindTo(this.model.document.roots).using(a=>{if(a.rootName=="$graveyard")return null;const c=new RootEditableElement(this.view.document,a.name);return c.rootName=a.rootName,this.mapper.bindElements(a,c),c})}destroy(){this.view.destroy(),this.stopListening()}reconvertMarker(e){const t=typeof e=="string"?e:e.name,r=this.model.markers.get(t);if(!r)throw new CKEditorError("editingcontroller-reconvertmarker-marker-not-exist",this,{markerName:t});this.model.change(()=>{this.model.markers._refresh(r)})}reconvertItem(e){this.model.change(()=>{this.model.document.differ._refreshItem(e)})}};function fixTargetRanges(e,t,r){return(i,o)=>{if(!(r.document.isComposing&&!env.isAndroid))for(let a=0;a<o.targetRanges.length;a++){const c=o.targetRanges[a],u=e.toModelRange(c),h=tryFixingRange(u,t);!h||h.isEqual(u)||(o.targetRanges[a]=e.toViewRange(h))}}}var ViewConsumable=class Mn{_consumables=new Map;add(t,r){let i;if(t.is("$text")||t.is("documentFragment")){this._consumables.set(t,!0);return}this._consumables.has(t)?i=this._consumables.get(t):(i=new ViewElementConsumables(t),this._consumables.set(t,i)),i.add(r)}test(t,r){const i=this._consumables.get(t);return i===void 0?null:t.is("$text")||t.is("documentFragment")?i:i.test(r)}consume(t,r){return this.test(t,r)?(t.is("$text")||t.is("documentFragment")?this._consumables.set(t,!1):this._consumables.get(t).consume(r),!0):!1}revert(t,r){const i=this._consumables.get(t);i!==void 0&&(t.is("$text")||t.is("documentFragment")?this._consumables.set(t,!0):i.revert(r))}static consumablesFromElement(t){const r={element:t,name:!0,attributes:[],classes:[],styles:[]},i=t.getAttributeKeys();for(const c of i)c=="style"||c=="class"||r.attributes.push(c);const o=t.getClassNames();for(const c of o)r.classes.push(c);const a=t.getStyleNames();for(const c of a)r.styles.push(c);return r}static createFrom(t,r){if(r||(r=new Mn),t.is("$text"))return r.add(t),r;t.is("element")&&r.add(t,Mn.consumablesFromElement(t)),t.is("documentFragment")&&r.add(t);for(const i of t.getChildren())r=Mn.createFrom(i,r);return r}},CONSUMABLE_TYPES=["attributes","classes","styles"],ViewElementConsumables=class{element;_canConsumeName;_consumables;constructor(e){this.element=e,this._canConsumeName=null,this._consumables={attributes:new Map,styles:new Map,classes:new Map}}add(e){e.name&&(this._canConsumeName=!0);for(const t of CONSUMABLE_TYPES)t in e&&this._add(t,e[t])}test(e){if(e.name&&!this._canConsumeName)return this._canConsumeName;for(const t of CONSUMABLE_TYPES)if(t in e){const r=this._test(t,e[t]);if(r!==!0)return r}return!0}consume(e){e.name&&(this._canConsumeName=!1);for(const t of CONSUMABLE_TYPES)t in e&&this._consume(t,e[t])}revert(e){e.name&&(this._canConsumeName=!0);for(const t of CONSUMABLE_TYPES)t in e&&this._revert(t,e[t])}_add(e,t){const r=toArray(t),i=this._consumables[e];for(const o of r){if(e==="attributes"&&(o==="class"||o==="style"))throw new CKEditorError("viewconsumable-invalid-attribute",this);if(i.set(o,!0),e==="styles")for(const a of this.element.document.stylesProcessor.getRelatedStyles(o))i.set(a,!0)}}_test(e,t){const r=toArray(t),i=this._consumables[e];for(const o of r)if(e==="attributes"&&(o==="class"||o==="style")){const a=o=="class"?"classes":"styles",c=this._test(a,[...this._consumables[a].keys()]);if(c!==!0)return c}else{const a=i.get(o);if(a===void 0)return null;if(!a)return!1}return!0}_consume(e,t){const r=toArray(t),i=this._consumables[e];for(const o of r)if(e==="attributes"&&(o==="class"||o==="style")){const a=o=="class"?"classes":"styles";this._consume(a,[...this._consumables[a].keys()])}else if(i.set(o,!1),e=="styles")for(const a of this.element.document.stylesProcessor.getRelatedStyles(o))i.set(a,!1)}_revert(e,t){const r=toArray(t),i=this._consumables[e];for(const o of r)if(e==="attributes"&&(o==="class"||o==="style")){const a=o=="class"?"classes":"styles";this._revert(a,[...this._consumables[a].keys()])}else i.get(o)===!1&&i.set(o,!0)}},Schema=class extends ObservableMixin(){_sourceDefinitions={};_attributeProperties=Object.create(null);_customChildChecks=new Map;_customAttributeChecks=new Map;_genericCheckSymbol=Symbol("$generic");_compiledDefinitions;constructor(){super(),this.decorate("checkChild"),this.decorate("checkAttribute"),this.on("checkAttribute",(e,t)=>{t[0]=new SchemaContext(t[0])},{priority:"highest"}),this.on("checkChild",(e,t)=>{t[0]=new SchemaContext(t[0]),t[1]=this.getDefinition(t[1])},{priority:"highest"})}register(e,t){if(this._sourceDefinitions[e])throw new CKEditorError("schema-cannot-register-item-twice",this,{itemName:e});this._sourceDefinitions[e]=[Object.assign({},t)],this._clearCache()}extend(e,t){if(!this._sourceDefinitions[e])throw new CKEditorError("schema-cannot-extend-missing-item",this,{itemName:e});this._sourceDefinitions[e].push(Object.assign({},t)),this._clearCache()}getDefinitions(){return this._compiledDefinitions||this._compile(),this._compiledDefinitions}getDefinition(e){let t;return typeof e=="string"?t=e:"is"in e&&(e.is("$text")||e.is("$textProxy"))?t="$text":t=e.name,this.getDefinitions()[t]}isRegistered(e){return!!this.getDefinition(e)}isBlock(e){const t=this.getDefinition(e);return!!(t&&t.isBlock)}isLimit(e){const t=this.getDefinition(e);return t?!!(t.isLimit||t.isObject):!1}isObject(e){const t=this.getDefinition(e);return t?!!(t.isObject||t.isLimit&&t.isSelectable&&t.isContent):!1}isInline(e){const t=this.getDefinition(e);return!!(t&&t.isInline)}isSelectable(e){const t=this.getDefinition(e);return t?!!(t.isSelectable||t.isObject):!1}isContent(e){const t=this.getDefinition(e);return t?!!(t.isContent||t.isObject):!1}checkChild(e,t){return t?this._checkContextMatch(e,t):!1}checkAttribute(e,t){const r=this.getDefinition(e.last);if(!r)return!1;const i=this._evaluateAttributeChecks(e,t);return i!==void 0?i:r.allowAttributes.includes(t)}checkMerge(e,t){if(e instanceof Position2){const r=e.nodeBefore,i=e.nodeAfter;if(!(r instanceof Element4))throw new CKEditorError("schema-check-merge-no-element-before",this);if(!(i instanceof Element4))throw new CKEditorError("schema-check-merge-no-element-after",this);return this.checkMerge(r,i)}if(this.isLimit(e)||this.isLimit(t))return!1;for(const r of t.getChildren())if(!this.checkChild(e,r))return!1;return!0}addChildCheck(e,t){const r=t!==void 0?t:this._genericCheckSymbol,i=this._customChildChecks.get(r)||[];i.push(e),this._customChildChecks.set(r,i)}addAttributeCheck(e,t){const r=t!==void 0?t:this._genericCheckSymbol,i=this._customAttributeChecks.get(r)||[];i.push(e),this._customAttributeChecks.set(r,i)}setAttributeProperties(e,t){this._attributeProperties[e]=Object.assign(this.getAttributeProperties(e),t)}getAttributeProperties(e){return this._attributeProperties[e]||Object.create(null)}getLimitElement(e){let t;for(e instanceof Position2?t=e.parent:t=(e instanceof Range2?[e]:Array.from(e.getRanges())).reduce((i,o)=>{const a=o.getCommonAncestor();return i?i.getCommonAncestor(a,{includeSelf:!0}):a},null);!this.isLimit(t)&&t.parent;)t=t.parent;return t}checkAttributeInSelection(e,t){if(e.isCollapsed){const i=[...e.getFirstPosition().getAncestors(),new Text2("",e.getAttributes())];return this.checkAttribute(i,t)}else{const r=e.getRanges();for(const i of r)for(const o of i)if(this.checkAttribute(o.item,t))return!0}return!1}*getValidRanges(e,t){e=convertToMinimalFlatRanges(e);for(const r of e)yield*this._getValidRangesForRange(r,t)}getNearestSelectionRange(e,t="both"){if(e.root.rootName=="$graveyard")return null;if(this.checkChild(e,"$text"))return new Range2(e);let r,i;const o=e.getAncestors().reverse().find(a=>this.isLimit(a))||e.root;(t=="both"||t=="backward")&&(r=new TreeWalker2({boundaries:Range2._createIn(o),startPosition:e,direction:"backward"})),(t=="both"||t=="forward")&&(i=new TreeWalker2({boundaries:Range2._createIn(o),startPosition:e}));for(const a of combineWalkers(r,i)){const c=a.walker==r?"elementEnd":"elementStart",u=a.value;if(u.type==c&&this.isObject(u.item))return Range2._createOn(u.item);if(this.checkChild(u.nextPosition,"$text"))return new Range2(u.nextPosition)}return null}findAllowedParent(e,t){let r=e.parent;for(;r;){if(this.checkChild(r,t))return r;if(this.isLimit(r))return null;r=r.parent}return null}setAllowedAttributes(e,t,r){const i=r.model;for(const[o,a]of Object.entries(t))i.schema.checkAttribute(e,o)&&r.setAttribute(o,a,e)}removeDisallowedAttributes(e,t){for(const r of e)if(r.is("$text"))removeDisallowedAttributeFromNode(this,r,t);else{const o=Range2._createIn(r).getPositions();for(const a of o){const c=a.nodeBefore||a.parent;removeDisallowedAttributeFromNode(this,c,t)}}}getAttributesWithProperty(e,t,r){const i={};for(const[o,a]of e.getAttributes()){const c=this.getAttributeProperties(o);c[t]!==void 0&&(r===void 0||r===c[t])&&(i[o]=a)}return i}createContext(e){return new SchemaContext(e)}_clearCache(){this._compiledDefinitions=null}_compile(){const e={},t=this._sourceDefinitions,r=Object.keys(t);for(const o of r)e[o]=compileBaseItemRule(t[o],o);const i=Object.values(e);for(const o of i)propagateAllowIn(e,o),propagateAllowChildren(e,o),propagateDisallowIn(e,o),propagateDisallowChildren(e,o);for(const o of i)resolveDisallows(e,o);for(const o of i)compileAllowContentOf(e,o);for(const o of i)compileAllowWhere(e,o);for(const o of i)compileAllowAttributesOf(e,o);for(const o of i)compileInheritPropertiesFrom(e,o);this._compiledDefinitions=compileDefinitions(e)}_checkContextMatch(e,t){const r=e.last;let i=this._evaluateChildChecks(e,t);if(i=i!==void 0?i:t.allowIn.includes(r.name),!i)return!1;const o=this.getDefinition(r),a=e.trimLast();return o?a.length==0?!0:this._checkContextMatch(a,o):!1}_evaluateChildChecks(e,t){const r=this._customChildChecks.get(this._genericCheckSymbol)||[],i=this._customChildChecks.get(t.name)||[];for(const o of[...r,...i]){const a=o(e,t);if(a!==void 0)return a}}_evaluateAttributeChecks(e,t){const r=this._customAttributeChecks.get(this._genericCheckSymbol)||[],i=this._customAttributeChecks.get(t)||[];for(const o of[...r,...i]){const a=o(e,t);if(a!==void 0)return a}}*_getValidRangesForRange(e,t){let r=e.start,i=e.start;for(const o of e.getItems({shallow:!0}))o.is("element")&&(yield*this._getValidRangesForRange(Range2._createIn(o),t)),this.checkAttribute(o,t)||(r.isEqual(i)||(yield new Range2(r,i)),r=Position2._createAfter(o)),i=Position2._createAfter(o);r.isEqual(i)||(yield new Range2(r,i))}findOptimalInsertionRange(e,t){const r=e.getSelectedElement();if(r&&this.isObject(r)&&!this.isInline(r))return t=="before"||t=="after"?new Range2(Position2._createAt(r,t)):Range2._createOn(r);const i=first(e.getSelectedBlocks());if(!i)return new Range2(e.focus);if(i.isEmpty)return new Range2(Position2._createAt(i,0));const o=Position2._createAfter(i);return e.focus.isTouching(o)?new Range2(o):new Range2(Position2._createBefore(i))}},SchemaContext=class kn{_items;constructor(t){if(t instanceof kn)return t;let r;typeof t=="string"?r=[t]:Array.isArray(t)?r=t:r=t.getAncestors({includeSelf:!0}),this._items=r.map(mapContextItem)}get length(){return this._items.length}get last(){return this._items[this._items.length-1]}[Symbol.iterator](){return this._items[Symbol.iterator]()}push(t){const r=new kn([t]);return r._items=[...this._items,...r._items],r}trimLast(){const t=new kn([]);return t._items=this._items.slice(0,-1),t}getItem(t){return this._items[t]}*getNames(){yield*this._items.map(t=>t.name)}endsWith(t){return Array.from(this.getNames()).join(" ").endsWith(t)}startsWith(t){return Array.from(this.getNames()).join(" ").startsWith(t)}};function compileBaseItemRule(e,t){const r={name:t,allowIn:new Set,allowChildren:new Set,disallowIn:new Set,disallowChildren:new Set,allowContentOf:new Set,allowWhere:new Set,allowAttributes:new Set,disallowAttributes:new Set,allowAttributesOf:new Set,inheritTypesFrom:new Set};return copyTypes(e,r),copyProperty(e,r,"allowIn"),copyProperty(e,r,"allowChildren"),copyProperty(e,r,"disallowIn"),copyProperty(e,r,"disallowChildren"),copyProperty(e,r,"allowContentOf"),copyProperty(e,r,"allowWhere"),copyProperty(e,r,"allowAttributes"),copyProperty(e,r,"disallowAttributes"),copyProperty(e,r,"allowAttributesOf"),copyProperty(e,r,"inheritTypesFrom"),resolveInheritAll(e,r),r}function propagateAllowIn(e,t){for(const r of t.allowIn){const i=e[r];i?i.allowChildren.add(t.name):t.allowIn.delete(r)}}function propagateAllowChildren(e,t){for(const r of t.allowChildren){const i=e[r];i?i.allowIn.add(t.name):t.allowChildren.delete(r)}}function propagateDisallowIn(e,t){for(const r of t.disallowIn){const i=e[r];i?i.disallowChildren.add(t.name):t.disallowIn.delete(r)}}function propagateDisallowChildren(e,t){for(const r of t.disallowChildren){const i=e[r];i?i.disallowIn.add(t.name):t.disallowChildren.delete(r)}}function resolveDisallows(e,t){for(const r of t.disallowChildren)t.allowChildren.delete(r);for(const r of t.disallowIn)t.allowIn.delete(r);for(const r of t.disallowAttributes)t.allowAttributes.delete(r)}function compileAllowContentOf(e,t){for(const r of t.allowContentOf){const i=e[r];i&&(i.disallowChildren.forEach(o=>{t.allowChildren.has(o)||(t.disallowChildren.add(o),e[o].disallowIn.add(t.name))}),i.allowChildren.forEach(o=>{t.disallowChildren.has(o)||(t.allowChildren.add(o),e[o].allowIn.add(t.name))}))}}function compileAllowWhere(e,t){for(const r of t.allowWhere){const i=e[r];i&&(i.disallowIn.forEach(o=>{t.allowIn.has(o)||(t.disallowIn.add(o),e[o].disallowChildren.add(t.name))}),i.allowIn.forEach(o=>{t.disallowIn.has(o)||(t.allowIn.add(o),e[o].allowChildren.add(t.name))}))}}function compileDefinitions(e){const t={};for(const r of Object.values(e))t[r.name]={name:r.name,isBlock:!!r.isBlock,isContent:!!r.isContent,isInline:!!r.isInline,isLimit:!!r.isLimit,isObject:!!r.isObject,isSelectable:!!r.isSelectable,allowIn:Array.from(r.allowIn).filter(i=>!!e[i]),allowChildren:Array.from(r.allowChildren).filter(i=>!!e[i]),allowAttributes:Array.from(r.allowAttributes)};return t}function compileAllowAttributesOf(e,t){for(const r of t.allowAttributesOf){const i=e[r];if(!i)return;i.allowAttributes.forEach(o=>{t.disallowAttributes.has(o)||t.allowAttributes.add(o)})}}function compileInheritPropertiesFrom(e,t){for(const r of t.inheritTypesFrom){const i=e[r];if(i){const o=Object.keys(i).filter(a=>a.startsWith("is"));for(const a of o)a in t||(t[a]=i[a])}}}function copyTypes(e,t){for(const r of e){const i=Object.keys(r).filter(o=>o.startsWith("is"));for(const o of i)t[o]=!!r[o]}}function copyProperty(e,t,r){for(const i of e){let o=i[r];typeof o=="string"&&(o=[o]),Array.isArray(o)&&o.forEach(a=>t[r].add(a))}}function resolveInheritAll(e,t){for(const r of e){const i=r.inheritAllFrom;i&&(t.allowContentOf.add(i),t.allowWhere.add(i),t.allowAttributesOf.add(i),t.inheritTypesFrom.add(i))}}function mapContextItem(e){return typeof e=="string"||e.is("documentFragment")?{name:typeof e=="string"?e:"$documentFragment",*getAttributeKeys(){},getAttribute(){}}:{name:e.is("element")?e.name:"$text",*getAttributeKeys(){yield*e.getAttributeKeys()},getAttribute(t){return e.getAttribute(t)}}}function*combineWalkers(e,t){let r=!1;for(;!r;){if(r=!0,e){const i=e.next();i.done||(r=!1,yield{walker:e,value:i.value})}if(t){const i=t.next();i.done||(r=!1,yield{walker:t,value:i.value})}}}function*convertToMinimalFlatRanges(e){for(const t of e)yield*t.getMinimalFlatRanges()}function removeDisallowedAttributeFromNode(e,t,r){for(const i of t.getAttributeKeys())e.checkAttribute(t,i)||r.removeAttribute(i,t)}var UpcastDispatcher=class extends EmitterMixin(){conversionApi;_splitParts=new Map;_cursorParents=new Map;_modelCursor=null;_emptyElementsToKeep=new Set;constructor(e){super(),this.conversionApi={...e,consumable:null,writer:null,store:null,convertItem:(t,r)=>this._convertItem(t,r),convertChildren:(t,r)=>this._convertChildren(t,r),safeInsert:(t,r)=>this._safeInsert(t,r),updateConversionResult:(t,r)=>this._updateConversionResult(t,r),splitToAllowedParent:(t,r)=>this._splitToAllowedParent(t,r),getSplitParts:t=>this._getSplitParts(t),keepEmptyElement:t=>this._keepEmptyElement(t)}}convert(e,t,r=["$root"]){this.fire("viewCleanup",e),this._modelCursor=createContextTree(r,t),this.conversionApi.writer=t,this.conversionApi.consumable=ViewConsumable.createFrom(e),this.conversionApi.store={};const{modelRange:i}=this._convertItem(e,this._modelCursor),o=t.createDocumentFragment();if(i){this._removeEmptyElements();const a=this._modelCursor.parent,c=a._removeChildren(0,a.childCount);o._insertChild(0,c),o.markers=extractMarkersFromModelFragment(o,t)}return this._modelCursor=null,this._splitParts.clear(),this._cursorParents.clear(),this._emptyElementsToKeep.clear(),this.conversionApi.writer=null,this.conversionApi.store=null,o}_convertItem(e,t){const r={viewItem:e,modelCursor:t,modelRange:null};if(e.is("element")?this.fire(`element:${e.name}`,r,this.conversionApi):e.is("$text")?this.fire("text",r,this.conversionApi):this.fire("documentFragment",r,this.conversionApi),r.modelRange&&!(r.modelRange instanceof Range2))throw new CKEditorError("view-conversion-dispatcher-incorrect-result",this);return{modelRange:r.modelRange,modelCursor:r.modelCursor}}_convertChildren(e,t){let r=t.is("position")?t:Position2._createAt(t,0);const i=new Range2(r);for(const o of Array.from(e.getChildren())){const a=this._convertItem(o,r);a.modelRange instanceof Range2&&(i.end=a.modelRange.end,r=a.modelCursor)}return{modelRange:i,modelCursor:r}}_safeInsert(e,t){const r=this._splitToAllowedParent(e,t);return r?(this.conversionApi.writer.insert(e,r.position),!0):!1}_updateConversionResult(e,t){const r=this._getSplitParts(e),i=this.conversionApi.writer;t.modelRange||(t.modelRange=i.createRange(i.createPositionBefore(e),i.createPositionAfter(r[r.length-1])));const o=this._cursorParents.get(e);o?t.modelCursor=i.createPositionAt(o,0):t.modelCursor=t.modelRange.end}_splitToAllowedParent(e,t){const{schema:r,writer:i}=this.conversionApi;let o=r.findAllowedParent(t,e);if(o){if(o===t.parent)return{position:t};this._modelCursor.parent.getAncestors().includes(o)&&(o=null)}if(!o)return isParagraphable(t,e,r)?{position:wrapInParagraph(t,i)}:null;const a=this.conversionApi.writer.split(t,o),c=[];for(const h of a.range.getWalker())if(h.type=="elementEnd")c.push(h.item);else{const d=c.pop(),f=h.item;this._registerSplitPair(d,f)}const u=a.range.end.parent;return this._cursorParents.set(e,u),{position:a.position,cursorParent:u}}_registerSplitPair(e,t){this._splitParts.has(e)||this._splitParts.set(e,[e]);const r=this._splitParts.get(e);this._splitParts.set(t,r),r.push(t)}_getSplitParts(e){let t;return this._splitParts.has(e)?t=this._splitParts.get(e):t=[e],t}_keepEmptyElement(e){this._emptyElementsToKeep.add(e)}_removeEmptyElements(){const e=new Map;for(const t of this._splitParts.keys())if(t.isEmpty&&!this._emptyElementsToKeep.has(t)){const r=e.get(t.parent)||[];r.push(t),this._splitParts.delete(t),e.set(t.parent,r)}for(const[t,r]of e)t._removeChildrenArray(r);e.size&&this._removeEmptyElements()}};function extractMarkersFromModelFragment(e,t){const r=new Set,i=new Map,o=Range2._createIn(e).getItems();for(const a of o)a.is("element","$marker")&&r.add(a);for(const a of r){const c=a.getAttribute("data-name"),u=t.createPositionBefore(a);i.has(c)?i.get(c).end=u.clone():i.set(c,new Range2(u.clone())),t.remove(a)}return i}function createContextTree(e,t){let r;for(const i of new SchemaContext(e)){const o={};for(const c of i.getAttributeKeys())o[c]=i.getAttribute(c);const a=t.createElement(i.name,o);r&&t.insert(a,r),r=Position2._createAt(a,0)}return r}var BasicHtmlWriter=class{getHtml(e){const r=global2.document.implementation.createHTMLDocument("").createElement("div");return r.appendChild(e),r.innerHTML}},HtmlDataProcessor=class{domParser;domConverter;htmlWriter;skipComments=!0;constructor(e){this.domParser=new DOMParser,this.domConverter=new DomConverter(e,{renderingMode:"data"}),this.htmlWriter=new BasicHtmlWriter}toData(e){const t=this.domConverter.viewToDom(e);return this.htmlWriter.getHtml(t)}toView(e){const t=this._toDom(e);return this.domConverter.domToView(t,{skipComments:this.skipComments})}registerRawContentMatcher(e){this.domConverter.registerRawContentMatcher(e)}useFillerType(e){this.domConverter.blockFillerMode=e=="marked"?"markedNbsp":"nbsp"}_toDom(e){/<(?:html|body|head|meta)(?:\s[^>]*)?>/i.test(e.trim().slice(0,1e4))||(e=`<body>${e}</body>`);const t=this.domParser.parseFromString(e,"text/html"),r=t.createDocumentFragment(),i=t.body.childNodes;for(;i.length>0;)r.appendChild(i[0]);return r}},DataController=class extends EmitterMixin(){model;mapper;downcastDispatcher;upcastDispatcher;viewDocument;stylesProcessor;htmlProcessor;processor;_viewWriter;constructor(e,t){super(),this.model=e,this.mapper=new Mapper,this.downcastDispatcher=new DowncastDispatcher({mapper:this.mapper,schema:e.schema}),this.downcastDispatcher.on("insert:$text",insertText(),{priority:"lowest"}),this.downcastDispatcher.on("insert",insertAttributesAndChildren(),{priority:"lowest"}),this.upcastDispatcher=new UpcastDispatcher({schema:e.schema}),this.viewDocument=new Document$1(t),this.stylesProcessor=t,this.htmlProcessor=new HtmlDataProcessor(this.viewDocument),this.processor=this.htmlProcessor,this._viewWriter=new DowncastWriter(this.viewDocument),this.upcastDispatcher.on("text",convertText(),{priority:"lowest"}),this.upcastDispatcher.on("element",convertToModelFragment$1(),{priority:"lowest"}),this.upcastDispatcher.on("documentFragment",convertToModelFragment$1(),{priority:"lowest"}),ObservableMixin().prototype.decorate.call(this,"init"),ObservableMixin().prototype.decorate.call(this,"set"),ObservableMixin().prototype.decorate.call(this,"get"),ObservableMixin().prototype.decorate.call(this,"toView"),ObservableMixin().prototype.decorate.call(this,"toModel"),this.on("init",()=>{this.fire("ready")},{priority:"lowest"}),this.on("ready",()=>{this.model.enqueueChange({isUndoable:!1},autoParagraphEmptyRoots)},{priority:"lowest"})}get(e={}){const{rootName:t="main",trim:r="empty"}=e;if(!this._checkIfRootsExists([t]))throw new CKEditorError("datacontroller-get-non-existent-root",this);const i=this.model.document.getRoot(t);return i.isAttached()||logWarning("datacontroller-get-detached-root",this),r==="empty"&&!this.model.hasContent(i,{ignoreWhitespaces:!0})?"":this.stringify(i,e)}stringify(e,t={}){const r=this.toView(e,t);return this.processor.toData(r)}toView(e,t={}){const r=this.viewDocument,i=this._viewWriter;this.mapper.clearBindings();const o=Range2._createIn(e),a=new DocumentFragment$1(r);this.mapper.bindElements(e,a);const c=e.is("documentFragment")?e.markers:_getMarkersRelativeToElement(e);return this.downcastDispatcher.convert(o,c,i,t),a}init(e){if(this.model.document.version)throw new CKEditorError("datacontroller-init-document-not-empty",this);let t={};if(typeof e=="string"?t.main=e:t=e,!this._checkIfRootsExists(Object.keys(t)))throw new CKEditorError("datacontroller-init-non-existent-root",this);return this.model.enqueueChange({isUndoable:!1},r=>{for(const i of Object.keys(t)){const o=this.model.document.getRoot(i);r.insert(this.parse(t[i],o),o,0)}}),Promise.resolve()}set(e,t={}){let r={};if(typeof e=="string"?r.main=e:r=e,!this._checkIfRootsExists(Object.keys(r)))throw new CKEditorError("datacontroller-set-non-existent-root",this);this.model.enqueueChange(t.batchType||{},i=>{i.setSelection(null),i.removeSelectionAttribute(this.model.document.selection.getAttributeKeys());for(const o of Object.keys(r)){const a=this.model.document.getRoot(o);i.remove(i.createRangeIn(a)),i.insert(this.parse(r[o],a),a,0)}})}parse(e,t="$root"){const r=this.processor.toView(e);return this.toModel(r,t)}toModel(e,t="$root"){return this.model.change(r=>this.upcastDispatcher.convert(e,r,t))}addStyleProcessorRules(e){e(this.stylesProcessor)}registerRawContentMatcher(e){this.processor&&this.processor!==this.htmlProcessor&&this.processor.registerRawContentMatcher(e),this.htmlProcessor.registerRawContentMatcher(e)}destroy(){this.stopListening()}_checkIfRootsExists(e){for(const t of e)if(!this.model.document.getRoot(t))return!1;return!0}};function _getMarkersRelativeToElement(e){const t=[],r=e.root.document;if(!r)return new Map;const i=Range2._createIn(e);for(const o of r.model.markers){const a=o.getRange(),c=a.isCollapsed,u=a.start.isEqual(i.start)||a.end.isEqual(i.end);if(c&&u)t.push([o.name,a]);else{const h=i.getIntersection(a);h&&t.push([o.name,h])}}return t.sort(([o,a],[c,u])=>{if(a.end.compareWith(u.start)!=="after")return 1;if(a.start.compareWith(u.end)!=="before")return-1;switch(a.start.compareWith(u.start)){case"before":return 1;case"after":return-1;default:switch(a.end.compareWith(u.end)){case"before":return 1;case"after":return-1;default:return c.localeCompare(o)}}}),new Map(t)}var Conversion=class{_helpers=new Map;_downcast;_upcast;constructor(e,t){this._downcast=toArray(e),this._createConversionHelpers({name:"downcast",dispatchers:this._downcast,isDowncast:!0}),this._upcast=toArray(t),this._createConversionHelpers({name:"upcast",dispatchers:this._upcast,isDowncast:!1})}addAlias(e,t){const r=this._downcast.includes(t);if(!this._upcast.includes(t)&&!r)throw new CKEditorError("conversion-add-alias-dispatcher-not-registered",this);this._createConversionHelpers({name:e,dispatchers:[t],isDowncast:r})}for(e){if(!this._helpers.has(e))throw new CKEditorError("conversion-for-unknown-group",this);return this._helpers.get(e)}elementToElement(e){this.for("downcast").elementToElement(e);for(const{model:t,view:r}of _getAllUpcastDefinitions(e))this.for("upcast").elementToElement({model:t,view:r,converterPriority:e.converterPriority})}attributeToElement(e){this.for("downcast").attributeToElement(e);for(const{model:t,view:r}of _getAllUpcastDefinitions(e))this.for("upcast").elementToAttribute({view:r,model:t,converterPriority:e.converterPriority})}attributeToAttribute(e){this.for("downcast").attributeToAttribute(e);for(const{model:t,view:r}of _getAllUpcastDefinitions(e))this.for("upcast").attributeToAttribute({view:r,model:t})}_createConversionHelpers({name:e,dispatchers:t,isDowncast:r}){if(this._helpers.has(e))throw new CKEditorError("conversion-group-exists",this);const i=r?new DowncastHelpers(t):new UpcastHelpers(t);this._helpers.set(e,i)}};function*_getAllUpcastDefinitions(e){if(e.model.values)for(const t of e.model.values){const r={key:e.model.key,value:t},i=e.view[t],o=e.upcastAlso?e.upcastAlso[t]:void 0;yield*_getUpcastDefinition(r,i,o)}else yield*_getUpcastDefinition(e.model,e.view,e.upcastAlso)}function*_getUpcastDefinition(e,t,r){if(yield{model:e,view:t},r)for(const i of toArray(r))yield{model:e,view:i}}var XmlDataProcessor=class{namespaces;domParser;domConverter;htmlWriter;skipComments=!0;constructor(e,t={}){this.namespaces=t.namespaces||[],this.domParser=new DOMParser,this.domConverter=new DomConverter(e,{renderingMode:"data"}),this.htmlWriter=new BasicHtmlWriter}toData(e){const t=this.domConverter.viewToDom(e);return this.htmlWriter.getHtml(t)}toView(e){const t=this._toDom(e);return this.domConverter.domToView(t,{keepOriginalCase:!0,skipComments:this.skipComments})}registerRawContentMatcher(e){this.domConverter.registerRawContentMatcher(e)}useFillerType(e){this.domConverter.blockFillerMode=e=="marked"?"markedNbsp":"nbsp"}_toDom(e){e=`<xml ${this.namespaces.map(c=>`xmlns:${c}="nsp"`).join(" ")}>${e}</xml>`;const r=this.domParser.parseFromString(e,"text/xml"),i=r.querySelector("parsererror");if(i)throw new Error("Parse error - "+i.textContent);const o=r.createDocumentFragment(),a=r.documentElement.childNodes;for(;a.length>0;)o.appendChild(a[0]);return o}},Operation=class{baseVersion;isDocumentOperation;batch;constructor(e){this.baseVersion=e,this.isDocumentOperation=this.baseVersion!==null,this.batch=null}_validate(){}toJSON(){const e=Object.assign({},this);return e.__className=this.constructor.className,delete e.batch,delete e.isDocumentOperation,e}static get className(){return"Operation"}static fromJSON(e,t){return new this(e.baseVersion)}};function _insert(e,t){const r=_normalizeNodes(t),i=r.reduce((c,u)=>c+u.offsetSize,0),o=e.parent;_splitNodeAtPosition(e);const a=e.index;return o._insertChild(a,r),_mergeNodesAtIndex(o,a+r.length),_mergeNodesAtIndex(o,a),new Range2(e,e.getShiftedBy(i))}function _remove(e){if(!e.isFlat)throw new CKEditorError("operation-utils-remove-range-not-flat",this);const t=e.start.parent;_splitNodeAtPosition(e.start),_splitNodeAtPosition(e.end);const r=t._removeChildren(e.start.index,e.end.index-e.start.index);return _mergeNodesAtIndex(t,e.start.index),r}function _move(e,t){if(!e.isFlat)throw new CKEditorError("operation-utils-move-range-not-flat",this);const r=_remove(e);return t=t._getTransformedByDeletion(e.start,e.end.offset-e.start.offset),_insert(t,r)}function _setAttribute(e,t,r){_splitNodeAtPosition(e.start),_splitNodeAtPosition(e.end);for(const i of e.getItems({shallow:!0})){const o=i.is("$textProxy")?i.textNode:i;r!==null?o._setAttribute(t,r):o._removeAttribute(t),_mergeNodesAtIndex(o.parent,o.index)}_mergeNodesAtIndex(e.end.parent,e.end.index)}function _normalizeNodes(e){const t=[];function r(i){if(typeof i=="string")t.push(new Text2(i));else if(i instanceof TextProxy2)t.push(new Text2(i.data,i.getAttributes()));else if(i instanceof Node$1)t.push(i);else if(isIterable(i))for(const o of i)r(o)}r(e);for(let i=1;i<t.length;i++){const o=t[i],a=t[i-1];o instanceof Text2&&a instanceof Text2&&_haveSameAttributes(o,a)&&(t.splice(i-1,2,new Text2(a.data+o.data,a.getAttributes())),i--)}return t}function _mergeNodesAtIndex(e,t){const r=e.getChild(t-1),i=e.getChild(t);if(r&&i&&r.is("$text")&&i.is("$text")&&_haveSameAttributes(r,i)){const o=new Text2(r.data+i.data,r.getAttributes());e._removeChildren(t-1,2),e._insertChild(t-1,o)}}function _splitNodeAtPosition(e){const t=e.textNode,r=e.parent;if(t){const i=e.offset-t.startOffset,o=t.index;r._removeChildren(o,1);const a=new Text2(t.data.substr(0,i),t.getAttributes()),c=new Text2(t.data.substr(i),t.getAttributes());r._insertChild(o,[a,c])}}function _haveSameAttributes(e,t){const r=e.getAttributes(),i=t.getAttributes();for(const o of r){if(o[1]!==t.getAttribute(o[0]))return!1;i.next()}return i.next().done}var MoveOperation=class di extends Operation{sourcePosition;howMany;targetPosition;constructor(t,r,i,o){super(o),this.sourcePosition=t.clone(),this.sourcePosition.stickiness="toNext",this.howMany=r,this.targetPosition=i.clone(),this.targetPosition.stickiness="toNone"}get type(){return this.targetPosition.root.rootName=="$graveyard"?"remove":this.sourcePosition.root.rootName=="$graveyard"?"reinsert":"move"}get affectedSelectable(){return[Range2._createFromPositionAndShift(this.sourcePosition,this.howMany),Range2._createFromPositionAndShift(this.targetPosition,0)]}clone(){return new di(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion)}getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}getReversed(){const t=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new di(this.getMovedRangeStart(),this.howMany,t,this.baseVersion+1)}_validate(){const t=this.sourcePosition.parent,r=this.targetPosition.parent,i=this.sourcePosition.offset,o=this.targetPosition.offset;if(i+this.howMany>t.maxOffset)throw new CKEditorError("move-operation-nodes-do-not-exist",this);if(t===r&&i<o&&o<i+this.howMany)throw new CKEditorError("move-operation-range-into-itself",this);if(this.sourcePosition.root==this.targetPosition.root&&compareArrays(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())=="prefix"){const a=this.sourcePosition.path.length-1;if(this.targetPosition.path[a]>=i&&this.targetPosition.path[a]<i+this.howMany)throw new CKEditorError("move-operation-node-into-itself",this)}}_execute(){_move(Range2._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition)}toJSON(){const t=super.toJSON();return t.sourcePosition=this.sourcePosition.toJSON(),t.targetPosition=this.targetPosition.toJSON(),t}static get className(){return"MoveOperation"}static fromJSON(t,r){const i=Position2.fromJSON(t.sourcePosition,r),o=Position2.fromJSON(t.targetPosition,r);return new this(i,t.howMany,o,t.baseVersion)}},InsertOperation=class fi extends Operation{position;nodes;shouldReceiveAttributes;constructor(t,r,i){super(i),this.position=t.clone(),this.position.stickiness="toNone",this.nodes=new NodeList(_normalizeNodes(r)),this.shouldReceiveAttributes=!1}get type(){return"insert"}get howMany(){return this.nodes.maxOffset}get affectedSelectable(){return this.position.clone()}clone(){const t=new NodeList([...this.nodes].map(i=>i._clone(!0))),r=new fi(this.position,t,this.baseVersion);return r.shouldReceiveAttributes=this.shouldReceiveAttributes,r}getReversed(){const t=this.position.root.document.graveyard,r=new Position2(t,[0]);return new MoveOperation(this.position,this.nodes.maxOffset,r,this.baseVersion+1)}_validate(){const t=this.position.parent;if(!t||t.maxOffset<this.position.offset)throw new CKEditorError("insert-operation-position-invalid",this)}_execute(){const t=this.nodes;this.nodes=new NodeList([...t].map(r=>r._clone(!0))),_insert(this.position,t)}toJSON(){const t=super.toJSON();return t.position=this.position.toJSON(),t.nodes=this.nodes.toJSON(),t}static get className(){return"InsertOperation"}static fromJSON(t,r){const i=[];for(const a of t.nodes)a.name?i.push(Element4.fromJSON(a)):i.push(Text2.fromJSON(a));const o=new fi(Position2.fromJSON(t.position,r),i,t.baseVersion);return o.shouldReceiveAttributes=t.shouldReceiveAttributes,o}},SplitOperation=class ys extends Operation{splitPosition;howMany;insertionPosition;graveyardPosition;constructor(t,r,i,o,a){super(a),this.splitPosition=t.clone(),this.splitPosition.stickiness="toNext",this.howMany=r,this.insertionPosition=i,this.graveyardPosition=o?o.clone():null,this.graveyardPosition&&(this.graveyardPosition.stickiness="toNext")}get type(){return"split"}get moveTargetPosition(){const t=this.insertionPosition.path.slice();return t.push(0),new Position2(this.insertionPosition.root,t)}get movedRange(){const t=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new Range2(this.splitPosition,t)}get affectedSelectable(){const t=[Range2._createFromPositionAndShift(this.splitPosition,0),Range2._createFromPositionAndShift(this.insertionPosition,0)];return this.graveyardPosition&&t.push(Range2._createFromPositionAndShift(this.graveyardPosition,0)),t}clone(){return new ys(this.splitPosition,this.howMany,this.insertionPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const t=this.splitPosition.root.document.graveyard,r=new Position2(t,[0]);return new MergeOperation(this.moveTargetPosition,this.howMany,this.splitPosition,r,this.baseVersion+1)}_validate(){const t=this.splitPosition.parent,r=this.splitPosition.offset;if(!t||t.maxOffset<r)throw new CKEditorError("split-operation-position-invalid",this);if(t.parent){if(this.howMany!=t.maxOffset-this.splitPosition.offset)throw new CKEditorError("split-operation-how-many-invalid",this);if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new CKEditorError("split-operation-graveyard-position-invalid",this)}else throw new CKEditorError("split-operation-split-in-root",this)}_execute(){const t=this.splitPosition.parent;if(this.graveyardPosition)_move(Range2._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{const i=t._clone();_insert(this.insertionPosition,i)}const r=new Range2(Position2._createAt(t,this.splitPosition.offset),Position2._createAt(t,t.maxOffset));_move(r,this.moveTargetPosition)}toJSON(){const t=super.toJSON();return t.splitPosition=this.splitPosition.toJSON(),t.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(t.graveyardPosition=this.graveyardPosition.toJSON()),t}static get className(){return"SplitOperation"}static getInsertionPosition(t){const r=t.path.slice(0,-1);return r[r.length-1]++,new Position2(t.root,r,"toPrevious")}static fromJSON(t,r){const i=Position2.fromJSON(t.splitPosition,r),o=Position2.fromJSON(t.insertionPosition,r),a=t.graveyardPosition?Position2.fromJSON(t.graveyardPosition,r):null;return new this(i,t.howMany,o,a,t.baseVersion)}},MergeOperation=class bs extends Operation{sourcePosition;howMany;targetPosition;graveyardPosition;constructor(t,r,i,o,a){super(a),this.sourcePosition=t.clone(),this.sourcePosition.stickiness="toPrevious",this.howMany=r,this.targetPosition=i.clone(),this.targetPosition.stickiness="toNext",this.graveyardPosition=o.clone()}get type(){return"merge"}get deletionPosition(){return new Position2(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1))}get movedRange(){const t=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new Range2(this.sourcePosition,t)}get affectedSelectable(){const t=this.sourcePosition.parent;return[Range2._createOn(t),Range2._createFromPositionAndShift(this.targetPosition,0),Range2._createFromPositionAndShift(this.graveyardPosition,0)]}clone(){return new bs(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const t=this.targetPosition._getTransformedByMergeOperation(this),r=this.sourcePosition.path.slice(0,-1),i=new Position2(this.sourcePosition.root,r)._getTransformedByMergeOperation(this);return new SplitOperation(t,this.howMany,i,this.graveyardPosition,this.baseVersion+1)}_validate(){const t=this.sourcePosition.parent,r=this.targetPosition.parent;if(t.parent)if(r.parent){if(this.howMany!=t.maxOffset)throw new CKEditorError("merge-operation-how-many-invalid",this)}else throw new CKEditorError("merge-operation-target-position-invalid",this);else throw new CKEditorError("merge-operation-source-position-invalid",this)}_execute(){const t=this.sourcePosition.parent,r=Range2._createIn(t);_move(r,this.targetPosition),_move(Range2._createOn(t),this.graveyardPosition)}toJSON(){const t=super.toJSON();return t.sourcePosition=t.sourcePosition.toJSON(),t.targetPosition=t.targetPosition.toJSON(),t.graveyardPosition=t.graveyardPosition.toJSON(),t}static get className(){return"MergeOperation"}static fromJSON(t,r){const i=Position2.fromJSON(t.sourcePosition,r),o=Position2.fromJSON(t.targetPosition,r),a=Position2.fromJSON(t.graveyardPosition,r);return new this(i,t.howMany,o,a,t.baseVersion)}},MarkerOperation=class On extends Operation{name;oldRange;newRange;affectsData;_markers;constructor(t,r,i,o,a,c){super(c),this.name=t,this.oldRange=r?r.clone():null,this.newRange=i?i.clone():null,this.affectsData=a,this._markers=o}get type(){return"marker"}get affectedSelectable(){const t=[];return this.oldRange&&t.push(this.oldRange.clone()),this.newRange&&(this.oldRange?t.push(...this.newRange.getDifference(this.oldRange)):t.push(this.newRange.clone())),t}clone(){return new On(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion)}getReversed(){return new On(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1)}_execute(){this.newRange?this._markers._set(this.name,this.newRange,!0,this.affectsData):this._markers._remove(this.name)}toJSON(){const t=super.toJSON();return this.oldRange&&(t.oldRange=this.oldRange.toJSON()),this.newRange&&(t.newRange=this.newRange.toJSON()),delete t._markers,t}static get className(){return"MarkerOperation"}static fromJSON(t,r){return new On(t.name,t.oldRange?Range2.fromJSON(t.oldRange,r):null,t.newRange?Range2.fromJSON(t.newRange,r):null,r.model.markers,t.affectsData,t.baseVersion)}},AttributeOperation=class Pn extends Operation{range;key;oldValue;newValue;constructor(t,r,i,o,a){super(a),this.range=t.clone(),this.key=r,this.oldValue=i===void 0?null:i,this.newValue=o===void 0?null:o}get type(){return this.oldValue===null?"addAttribute":this.newValue===null?"removeAttribute":"changeAttribute"}get affectedSelectable(){return this.range.clone()}clone(){return new Pn(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new Pn(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}toJSON(){const t=super.toJSON();return t.range=this.range.toJSON(),t}_validate(){if(!this.range.isFlat)throw new CKEditorError("attribute-operation-range-not-flat",this);for(const t of this.range.getItems({shallow:!0})){if(this.oldValue!==null&&!isEqual_default(t.getAttribute(this.key),this.oldValue))throw new CKEditorError("attribute-operation-wrong-old-value",this,{item:t,key:this.key,value:this.oldValue});if(this.oldValue===null&&this.newValue!==null&&t.hasAttribute(this.key))throw new CKEditorError("attribute-operation-attribute-exists",this,{node:t,key:this.key})}}_execute(){isEqual_default(this.oldValue,this.newValue)||_setAttribute(this.range,this.key,this.newValue)}static get className(){return"AttributeOperation"}static fromJSON(t,r){return new Pn(Range2.fromJSON(t.range,r),t.key,t.oldValue,t.newValue,t.baseVersion)}},NoOperation=class mi extends Operation{get type(){return"noop"}get affectedSelectable(){return null}clone(){return new mi(this.baseVersion)}getReversed(){return new mi(this.baseVersion+1)}_execute(){}static get className(){return"NoOperation"}},RenameOperation=class An extends Operation{position;oldName;newName;constructor(t,r,i,o){super(o),this.position=t,this.position.stickiness="toNext",this.oldName=r,this.newName=i}get type(){return"rename"}get affectedSelectable(){return this.position.nodeAfter}clone(){return new An(this.position.clone(),this.oldName,this.newName,this.baseVersion)}getReversed(){return new An(this.position.clone(),this.newName,this.oldName,this.baseVersion+1)}_validate(){const t=this.position.nodeAfter;if(t instanceof Element4){if(t.name!==this.oldName)throw new CKEditorError("rename-operation-wrong-name",this)}else throw new CKEditorError("rename-operation-wrong-position",this)}_execute(){const t=this.position.nodeAfter;t.name=this.newName}toJSON(){const t=super.toJSON();return t.position=this.position.toJSON(),t}static get className(){return"RenameOperation"}static fromJSON(t,r){return new An(Position2.fromJSON(t.position,r),t.oldName,t.newName,t.baseVersion)}},RootAttributeOperation=class In extends Operation{root;key;oldValue;newValue;constructor(t,r,i,o,a){super(a),this.root=t,this.key=r,this.oldValue=i===void 0?null:i,this.newValue=o===void 0?null:o}get type(){return this.oldValue===null?"addRootAttribute":this.newValue===null?"removeRootAttribute":"changeRootAttribute"}get affectedSelectable(){return this.root}clone(){return new In(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new In(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_validate(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new CKEditorError("rootattribute-operation-not-a-root",this,{root:this.root,key:this.key});if(this.oldValue!==null&&this.root.getAttribute(this.key)!==this.oldValue)throw new CKEditorError("rootattribute-operation-wrong-old-value",this,{root:this.root,key:this.key});if(this.oldValue===null&&this.newValue!==null&&this.root.hasAttribute(this.key))throw new CKEditorError("rootattribute-operation-attribute-exists",this,{root:this.root,key:this.key})}_execute(){this.newValue!==null?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key)}toJSON(){const t=super.toJSON();return t.root=this.root.toJSON(),t}static get className(){return"RootAttributeOperation"}static fromJSON(t,r){if(!r.getRoot(t.root))throw new CKEditorError("rootattribute-operation-fromjson-no-root",this,{rootName:t.root});return new In(r.getRoot(t.root),t.key,t.oldValue,t.newValue,t.baseVersion)}},RootOperation=class Nn extends Operation{rootName;elementName;isAdd;_document;constructor(t,r,i,o,a){if(super(a),this.rootName=t,this.elementName=r,this.isAdd=i,this._document=o,!this._document.getRoot(this.rootName)){const c=this._document.createRoot(this.elementName,this.rootName);c._isAttached=!1}}get type(){return this.isAdd?"addRoot":"detachRoot"}get affectedSelectable(){return this._document.getRoot(this.rootName)}clone(){return new Nn(this.rootName,this.elementName,this.isAdd,this._document,this.baseVersion)}getReversed(){return new Nn(this.rootName,this.elementName,!this.isAdd,this._document,this.baseVersion+1)}_execute(){this._document.getRoot(this.rootName)._isAttached=this.isAdd}toJSON(){const t=super.toJSON();return delete t._document,t}static get className(){return"RootOperation"}static fromJSON(t,r){return new Nn(t.rootName,t.elementName,t.isAdd,r,t.baseVersion)}},operations2={};operations2[AttributeOperation.className]=AttributeOperation,operations2[InsertOperation.className]=InsertOperation,operations2[MarkerOperation.className]=MarkerOperation,operations2[MoveOperation.className]=MoveOperation,operations2[NoOperation.className]=NoOperation,operations2[Operation.className]=Operation,operations2[RenameOperation.className]=RenameOperation,operations2[RootAttributeOperation.className]=RootAttributeOperation,operations2[RootOperation.className]=RootOperation,operations2[SplitOperation.className]=SplitOperation,operations2[MergeOperation.className]=MergeOperation;var OperationFactory=class{static fromJSON(e,t){return operations2[e.__className].fromJSON(e,t)}},transformations=new Map;function setTransformation(e,t,r){let i=transformations.get(e);i||(i=new Map,transformations.set(e,i)),i.set(t,r)}function getTransformation(e,t){const r=transformations.get(e);return r&&r.has(t)?r.get(t):noUpdateTransformation}function noUpdateTransformation(e){return[e]}function transform$1(e,t,r={}){const i=getTransformation(e.constructor,t.constructor);try{return e=e.clone(),i(e,t,r)}catch(o){throw o}}function transformSets(e,t,r){e=e.slice(),t=t.slice();const i=new ContextFactory(r.document,r.useRelations,r.forceWeakRemove);i.setOriginalOperations(e),i.setOriginalOperations(t);const o=i.originalOperations;if(e.length==0||t.length==0)return{operationsA:e,operationsB:t,originalOperations:o};const a=new WeakMap;for(const h of e)a.set(h,0);const c={nextBaseVersionA:e[e.length-1].baseVersion+1,nextBaseVersionB:t[t.length-1].baseVersion+1,originalOperationsACount:e.length,originalOperationsBCount:t.length};let u=0;for(;u<e.length;){const h=e[u],d=a.get(h);if(d==t.length){u++;continue}const f=t[d],m=transform$1(h,f,i.getContext(h,f,!0)),g=transform$1(f,h,i.getContext(f,h,!1));i.updateRelation(h,f),i.setOriginalOperations(m,h),i.setOriginalOperations(g,f);for(const v of m)a.set(v,d+g.length);e.splice(u,1,...m),t.splice(d,1,...g)}if(handlePartialMarkerOperations(e),handlePartialMarkerOperations(t),r.padWithNoOps){const h=e.length-c.originalOperationsACount,d=t.length-c.originalOperationsBCount;padWithNoOps(e,d-h),padWithNoOps(t,h-d)}return updateBaseVersions(e,c.nextBaseVersionB),updateBaseVersions(t,c.nextBaseVersionA),{operationsA:e,operationsB:t,originalOperations:o}}var ContextFactory=class{originalOperations;_history;_useRelations;_forceWeakRemove;_relations;constructor(e,t,r=!1){this.originalOperations=new Map,this._history=e.history,this._useRelations=t,this._forceWeakRemove=!!r,this._relations=new Map}setOriginalOperations(e,t=null){const r=t?this.originalOperations.get(t):null;for(const i of e)this.originalOperations.set(i,r||i)}updateRelation(e,t){if(e instanceof MoveOperation)t instanceof MergeOperation?e.targetPosition.isEqual(t.sourcePosition)||t.movedRange.containsPosition(e.targetPosition)?this._setRelation(e,t,"insertAtSource"):e.targetPosition.isEqual(t.deletionPosition)?this._setRelation(e,t,"insertBetween"):e.targetPosition.isAfter(t.sourcePosition)&&this._setRelation(e,t,"moveTargetAfter"):t instanceof MoveOperation&&(e.targetPosition.isEqual(t.sourcePosition)||e.targetPosition.isBefore(t.sourcePosition)?this._setRelation(e,t,"insertBefore"):this._setRelation(e,t,"insertAfter"));else if(e instanceof SplitOperation){if(t instanceof MergeOperation)e.splitPosition.isBefore(t.sourcePosition)&&this._setRelation(e,t,"splitBefore");else if(t instanceof MoveOperation)if(e.splitPosition.isEqual(t.sourcePosition)||e.splitPosition.isBefore(t.sourcePosition))this._setRelation(e,t,"splitBefore");else{const r=Range2._createFromPositionAndShift(t.sourcePosition,t.howMany);if(e.splitPosition.hasSameParentAs(t.sourcePosition)&&r.containsPosition(e.splitPosition)){const i=r.end.offset-e.splitPosition.offset,o=e.splitPosition.offset-r.start.offset;this._setRelation(e,t,{howMany:i,offset:o})}}}else if(e instanceof MergeOperation)t instanceof MergeOperation?(e.targetPosition.isEqual(t.sourcePosition)||this._setRelation(e,t,"mergeTargetNotMoved"),e.sourcePosition.isEqual(t.targetPosition)&&this._setRelation(e,t,"mergeSourceNotMoved"),e.sourcePosition.isEqual(t.sourcePosition)&&this._setRelation(e,t,"mergeSameElement")):t instanceof SplitOperation?e.sourcePosition.isEqual(t.splitPosition)&&this._setRelation(e,t,"splitAtSource"):t instanceof MoveOperation&&t.howMany>0&&(e.sourcePosition.isEqual(t.sourcePosition.getShiftedBy(t.howMany))&&this._setRelation(e,t,"mergeSourceAffected"),e.targetPosition.isEqual(t.sourcePosition)&&this._setRelation(e,t,"mergeTargetWasBefore"));else if(e instanceof MarkerOperation){const r=e.newRange;if(!r)return;if(t instanceof MergeOperation){const i=r.start.isEqual(t.targetPosition),o=r.start.isEqual(t.deletionPosition),a=r.end.isEqual(t.deletionPosition),c=r.end.isEqual(t.sourcePosition);(i||o||a||c)&&this._setRelation(e,t,{wasInLeftElement:i,wasStartBeforeMergedElement:o,wasEndBeforeMergedElement:a,wasInRightElement:c})}}}getContext(e,t,r){return{aIsStrong:r,aWasUndone:this._wasUndone(e),bWasUndone:this._wasUndone(t),abRelation:this._useRelations?this._getRelation(e,t):null,baRelation:this._useRelations?this._getRelation(t,e):null,forceWeakRemove:this._forceWeakRemove}}_wasUndone(e){const t=this.originalOperations.get(e);return t.wasUndone||this._history.isUndoneOperation(t)}_getRelation(e,t){const r=this.originalOperations.get(t),i=this._history.getUndoneOperation(r);if(!i)return null;const o=this.originalOperations.get(e),a=this._relations.get(o);return a&&a.get(i)||null}_setRelation(e,t,r){const i=this.originalOperations.get(e),o=this.originalOperations.get(t);let a=this._relations.get(i);a||(a=new Map,this._relations.set(i,a)),a.set(o,r)}};function updateBaseVersions(e,t){for(const r of e)r.baseVersion=t++}function padWithNoOps(e,t){for(let r=0;r<t;r++)e.push(new NoOperation(0))}function handlePartialMarkerOperations(e){const t=new Map;for(let r=0;r<e.length;r++){const i=e[r];i instanceof MarkerOperation&&(i.baseVersion!==-1?t.set(i.name,{op:i,ranges:i.newRange?[i.newRange]:[]}):(i.newRange&&t.get(i.name).ranges.push(i.newRange),e.splice(r,1),r--))}for(const{op:r,ranges:i}of t.values())i.length?r.newRange=Range2._createFromRanges(i):r.newRange=null}setTransformation(AttributeOperation,AttributeOperation,(e,t,r)=>{if(e.key===t.key&&e.range.start.hasSameParentAs(t.range.start)){const i=e.range.getDifference(t.range).map(a=>new AttributeOperation(a,e.key,e.oldValue,e.newValue,0)),o=e.range.getIntersection(t.range);return o&&r.aIsStrong&&i.push(new AttributeOperation(o,t.key,t.newValue,e.newValue,0)),i.length==0?[new NoOperation(0)]:i}else return[e]}),setTransformation(AttributeOperation,InsertOperation,(e,t)=>{if(e.range.start.hasSameParentAs(t.position)&&e.range.containsPosition(t.position)){const i=e.range._getTransformedByInsertion(t.position,t.howMany,!t.shouldReceiveAttributes).map(o=>new AttributeOperation(o,e.key,e.oldValue,e.newValue,e.baseVersion));if(t.shouldReceiveAttributes){const o=_getComplementaryAttributeOperations(t,e.key,e.oldValue);o&&i.unshift(o)}return i}return e.range=e.range._getTransformedByInsertion(t.position,t.howMany,!1)[0],[e]});function _getComplementaryAttributeOperations(e,t,r){const o=e.nodes.getNode(0).getAttribute(t);if(o==r)return null;const a=new Range2(e.position,e.position.getShiftedBy(e.howMany));return new AttributeOperation(a,t,o,r,0)}setTransformation(AttributeOperation,MergeOperation,(e,t)=>{const r=[];e.range.start.hasSameParentAs(t.deletionPosition)&&(e.range.containsPosition(t.deletionPosition)||e.range.start.isEqual(t.deletionPosition))&&r.push(Range2._createFromPositionAndShift(t.graveyardPosition,1));const i=e.range._getTransformedByMergeOperation(t);return i.isCollapsed||r.push(i),r.map(o=>new AttributeOperation(o,e.key,e.oldValue,e.newValue,e.baseVersion))}),setTransformation(AttributeOperation,MoveOperation,(e,t)=>_breakRangeByMoveOperation(e.range,t).map(i=>new AttributeOperation(i,e.key,e.oldValue,e.newValue,e.baseVersion)));function _breakRangeByMoveOperation(e,t){const r=Range2._createFromPositionAndShift(t.sourcePosition,t.howMany);let i=null,o=[];r.containsRange(e,!0)?i=e:e.start.hasSameParentAs(r.start)?(o=e.getDifference(r),i=e.getIntersection(r)):o=[e];const a=[];for(let c of o){c=c._getTransformedByDeletion(t.sourcePosition,t.howMany);const u=t.getMovedRangeStart(),h=c.start.hasSameParentAs(u),d=c._getTransformedByInsertion(u,t.howMany,h);a.push(...d)}return i&&a.push(i._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany,!1)[0]),a}setTransformation(AttributeOperation,SplitOperation,(e,t)=>{if(e.range.end.isEqual(t.insertionPosition))return t.graveyardPosition||e.range.end.offset++,[e];if(e.range.start.hasSameParentAs(t.splitPosition)&&e.range.containsPosition(t.splitPosition)){const r=e.clone();return r.range=new Range2(t.moveTargetPosition.clone(),e.range.end._getCombined(t.splitPosition,t.moveTargetPosition)),e.range.end=t.splitPosition.clone(),e.range.end.stickiness="toPrevious",[e,r]}return e.range=e.range._getTransformedBySplitOperation(t),[e]}),setTransformation(InsertOperation,AttributeOperation,(e,t)=>{const r=[e];if(e.shouldReceiveAttributes&&e.position.hasSameParentAs(t.range.start)&&t.range.containsPosition(e.position)){const i=_getComplementaryAttributeOperations(e,t.key,t.newValue);i&&r.push(i)}return r}),setTransformation(InsertOperation,InsertOperation,(e,t,r)=>e.position.isEqual(t.position)&&r.aIsStrong?[e]:(e.position=e.position._getTransformedByInsertOperation(t),[e])),setTransformation(InsertOperation,MoveOperation,(e,t)=>(e.position=e.position._getTransformedByMoveOperation(t),[e])),setTransformation(InsertOperation,SplitOperation,(e,t)=>(e.position=e.position._getTransformedBySplitOperation(t),[e])),setTransformation(InsertOperation,MergeOperation,(e,t)=>(e.position=e.position._getTransformedByMergeOperation(t),[e])),setTransformation(MarkerOperation,InsertOperation,(e,t)=>(e.oldRange&&(e.oldRange=e.oldRange._getTransformedByInsertOperation(t)[0]),e.newRange&&(e.newRange=e.newRange._getTransformedByInsertOperation(t)[0]),[e])),setTransformation(MarkerOperation,MarkerOperation,(e,t,r)=>{if(e.name==t.name)if(r.aIsStrong)e.oldRange=t.newRange?t.newRange.clone():null;else return[new NoOperation(0)];return[e]}),setTransformation(MarkerOperation,MergeOperation,(e,t)=>(e.oldRange&&(e.oldRange=e.oldRange._getTransformedByMergeOperation(t)),e.newRange&&(e.newRange=e.newRange._getTransformedByMergeOperation(t)),[e])),setTransformation(MarkerOperation,MoveOperation,(e,t)=>{const r=[e];if(e.oldRange&&(e.oldRange=Range2._createFromRanges(e.oldRange._getTransformedByMoveOperation(t))),e.newRange){const i=e.newRange._getTransformedByMoveOperation(t);e.newRange=i[0];for(let o=1;o<i.length;o++){const a=e.clone();a.oldRange=null,a.newRange=i[o],a.baseVersion=-1,r.push(a)}}return r}),setTransformation(MarkerOperation,SplitOperation,(e,t,r)=>{if(e.oldRange&&(e.oldRange=e.oldRange._getTransformedBySplitOperation(t)),e.newRange){if(r.abRelation){const i=e.newRange._getTransformedBySplitOperation(t);return e.newRange.start.isEqual(t.splitPosition)&&r.abRelation.wasStartBeforeMergedElement?e.newRange.start=Position2._createAt(t.insertionPosition):e.newRange.start.isEqual(t.splitPosition)&&!r.abRelation.wasInLeftElement?e.newRange.start=Position2._createAt(t.moveTargetPosition):e.newRange.start=i.start,e.newRange.end.isEqual(t.splitPosition)&&r.abRelation.wasInRightElement?e.newRange.end=Position2._createAt(t.moveTargetPosition):e.newRange.end.isEqual(t.splitPosition)&&r.abRelation.wasEndBeforeMergedElement?e.newRange.end=Position2._createAt(t.insertionPosition):e.newRange.end=i.end,[e]}e.newRange=e.newRange._getTransformedBySplitOperation(t)}return[e]}),setTransformation(MergeOperation,InsertOperation,(e,t)=>(e.sourcePosition.hasSameParentAs(t.position)&&(e.howMany+=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByInsertOperation(t),e.targetPosition=e.targetPosition._getTransformedByInsertOperation(t),[e])),setTransformation(MergeOperation,MergeOperation,(e,t,r)=>{if(e.sourcePosition.isEqual(t.sourcePosition)&&e.targetPosition.isEqual(t.targetPosition))if(r.bWasUndone){const i=t.graveyardPosition.path.slice();return i.push(0),e.sourcePosition=new Position2(t.graveyardPosition.root,i),e.howMany=0,[e]}else return[new NoOperation(0)];if(e.sourcePosition.isEqual(t.sourcePosition)&&!e.targetPosition.isEqual(t.targetPosition)&&!r.bWasUndone&&r.abRelation!="splitAtSource"){const i=e.targetPosition.root.rootName=="$graveyard",o=t.targetPosition.root.rootName=="$graveyard";if(o&&!i||!(i&&!o)&&r.aIsStrong){const h=t.targetPosition._getTransformedByMergeOperation(t),d=e.targetPosition._getTransformedByMergeOperation(t);return[new MoveOperation(h,e.howMany,d,0)]}else return[new NoOperation(0)]}return e.sourcePosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByMergeOperation(t),e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),(!e.graveyardPosition.isEqual(t.graveyardPosition)||!r.aIsStrong)&&(e.graveyardPosition=e.graveyardPosition._getTransformedByMergeOperation(t)),[e]}),setTransformation(MergeOperation,MoveOperation,(e,t,r)=>{const i=Range2._createFromPositionAndShift(t.sourcePosition,t.howMany);return t.type=="remove"&&!r.bWasUndone&&e.deletionPosition.hasSameParentAs(t.sourcePosition)&&i.containsPosition(e.sourcePosition)?[new NoOperation(0)]:(t.sourcePosition.getShiftedBy(t.howMany).isEqual(e.sourcePosition)?e.sourcePosition.stickiness="toNone":t.targetPosition.isEqual(e.sourcePosition)&&r.abRelation=="mergeSourceAffected"?e.sourcePosition.stickiness="toNext":t.sourcePosition.isEqual(e.targetPosition)?(e.targetPosition.stickiness="toNone",e.howMany-=t.howMany):t.targetPosition.isEqual(e.targetPosition)&&r.abRelation=="mergeTargetWasBefore"?(e.targetPosition.stickiness="toPrevious",e.howMany+=t.howMany):(e.sourcePosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.sourcePosition.hasSameParentAs(t.sourcePosition)&&(e.howMany-=t.howMany)),e.sourcePosition=e.sourcePosition._getTransformedByMoveOperation(t),e.targetPosition=e.targetPosition._getTransformedByMoveOperation(t),e.sourcePosition.stickiness="toPrevious",e.targetPosition.stickiness="toNext",e.graveyardPosition.isEqual(t.targetPosition)||(e.graveyardPosition=e.graveyardPosition._getTransformedByMoveOperation(t)),[e])}),setTransformation(MergeOperation,SplitOperation,(e,t,r)=>{if(t.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedByDeletion(t.graveyardPosition,1),e.deletionPosition.isEqual(t.graveyardPosition)&&(e.howMany=t.howMany)),e.targetPosition.isEqual(t.splitPosition)&&(t.graveyardPosition&&e.deletionPosition.isEqual(t.graveyardPosition)||r.abRelation=="mergeTargetNotMoved"))return e.sourcePosition=e.sourcePosition._getTransformedBySplitOperation(t),[e];if(e.sourcePosition.isEqual(t.splitPosition)){if(r.abRelation=="mergeSourceNotMoved")return e.howMany=0,e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e];if(r.abRelation=="mergeSameElement"||e.sourcePosition.offset>0)return e.sourcePosition=t.moveTargetPosition.clone(),e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e]}return e.sourcePosition.hasSameParentAs(t.splitPosition)&&(e.howMany=t.splitPosition.offset),e.sourcePosition=e.sourcePosition._getTransformedBySplitOperation(t),e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e]}),setTransformation(MoveOperation,InsertOperation,(e,t)=>{const i=Range2._createFromPositionAndShift(e.sourcePosition,e.howMany)._getTransformedByInsertOperation(t,!1)[0];return e.sourcePosition=i.start,e.howMany=i.end.offset-i.start.offset,e.targetPosition.isEqual(t.position)||(e.targetPosition=e.targetPosition._getTransformedByInsertOperation(t)),[e]}),setTransformation(MoveOperation,MoveOperation,(e,t,r)=>{const i=Range2._createFromPositionAndShift(e.sourcePosition,e.howMany),o=Range2._createFromPositionAndShift(t.sourcePosition,t.howMany);let a=r.aIsStrong,c=!r.aIsStrong;r.abRelation=="insertBefore"||r.baRelation=="insertAfter"?c=!0:(r.abRelation=="insertAfter"||r.baRelation=="insertBefore")&&(c=!1);let u;if(e.targetPosition.isEqual(t.targetPosition)&&c?u=e.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany):u=e.targetPosition._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),_moveTargetIntoMovedRange(e,t)&&_moveTargetIntoMovedRange(t,e))return[t.getReversed()];if(i.containsPosition(t.targetPosition)&&i.containsRange(o,!0))return i.start=i.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),i.end=i.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),_makeMoveOperationsFromRanges([i],u);if(o.containsPosition(e.targetPosition)&&o.containsRange(i,!0))return i.start=i.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),i.end=i.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),_makeMoveOperationsFromRanges([i],u);const f=compareArrays(e.sourcePosition.getParentPath(),t.sourcePosition.getParentPath());if(f=="prefix"||f=="extension")return i.start=i.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),i.end=i.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),_makeMoveOperationsFromRanges([i],u);e.type=="remove"&&t.type!="remove"&&!r.aWasUndone&&!r.forceWeakRemove?a=!0:e.type!="remove"&&t.type=="remove"&&!r.bWasUndone&&!r.forceWeakRemove&&(a=!1);const m=[],g=i.getDifference(o);for(const _ of g){_.start=_.start._getTransformedByDeletion(t.sourcePosition,t.howMany),_.end=_.end._getTransformedByDeletion(t.sourcePosition,t.howMany);const b=compareArrays(_.start.getParentPath(),t.getMovedRangeStart().getParentPath())=="same",S=_._getTransformedByInsertion(t.getMovedRangeStart(),t.howMany,b);m.push(...S)}const v=i.getIntersection(o);return v!==null&&a&&(v.start=v.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),v.end=v.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),m.length===0?m.push(v):m.length==1?o.start.isBefore(i.start)||o.start.isEqual(i.start)?m.unshift(v):m.push(v):m.splice(1,0,v)),m.length===0?[new NoOperation(e.baseVersion)]:_makeMoveOperationsFromRanges(m,u)}),setTransformation(MoveOperation,SplitOperation,(e,t,r)=>{let i=e.targetPosition.clone();(!e.targetPosition.isEqual(t.insertionPosition)||!t.graveyardPosition||r.abRelation=="moveTargetAfter")&&(i=e.targetPosition._getTransformedBySplitOperation(t));const o=Range2._createFromPositionAndShift(e.sourcePosition,e.howMany);if(o.end.isEqual(t.insertionPosition))return t.graveyardPosition||e.howMany++,e.targetPosition=i,[e];if(o.start.hasSameParentAs(t.splitPosition)&&o.containsPosition(t.splitPosition)){let u=new Range2(t.splitPosition,o.end);u=u._getTransformedBySplitOperation(t);const h=[new Range2(o.start,t.splitPosition),u];return _makeMoveOperationsFromRanges(h,i)}e.targetPosition.isEqual(t.splitPosition)&&r.abRelation=="insertAtSource"&&(i=t.moveTargetPosition),e.targetPosition.isEqual(t.insertionPosition)&&r.abRelation=="insertBetween"&&(i=e.targetPosition);const c=[o._getTransformedBySplitOperation(t)];if(t.graveyardPosition){const u=o.start.isEqual(t.graveyardPosition)||o.containsPosition(t.graveyardPosition);e.howMany>1&&u&&!r.aWasUndone&&c.push(Range2._createFromPositionAndShift(t.insertionPosition,1))}return _makeMoveOperationsFromRanges(c,i)}),setTransformation(MoveOperation,MergeOperation,(e,t,r)=>{const i=Range2._createFromPositionAndShift(e.sourcePosition,e.howMany);if(t.deletionPosition.hasSameParentAs(e.sourcePosition)&&i.containsPosition(t.sourcePosition)){if(e.type=="remove"&&!r.forceWeakRemove){if(!r.aWasUndone){const c=[];let u=t.graveyardPosition.clone(),h=t.targetPosition._getTransformedByMergeOperation(t);const d=e.targetPosition.getTransformedByOperation(t);e.howMany>1&&(c.push(new MoveOperation(e.sourcePosition,e.howMany-1,d,0)),u=u._getTransformedByMove(e.sourcePosition,d,e.howMany-1),h=h._getTransformedByMove(e.sourcePosition,d,e.howMany-1));const f=t.deletionPosition._getCombined(e.sourcePosition,d),m=new MoveOperation(u,1,f,0),g=m.getMovedRangeStart().path.slice();g.push(0);const v=new Position2(m.targetPosition.root,g);h=h._getTransformedByMove(u,f,1);const _=new MoveOperation(h,t.howMany,v,0);return c.push(m),c.push(_),c}}else if(e.howMany==1)return r.bWasUndone?(e.sourcePosition=t.graveyardPosition.clone(),e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),[e]):[new NoOperation(0)]}const a=Range2._createFromPositionAndShift(e.sourcePosition,e.howMany)._getTransformedByMergeOperation(t);return e.sourcePosition=a.start,e.howMany=a.end.offset-a.start.offset,e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),[e]}),setTransformation(RenameOperation,InsertOperation,(e,t)=>(e.position=e.position._getTransformedByInsertOperation(t),[e])),setTransformation(RenameOperation,MergeOperation,(e,t)=>e.position.isEqual(t.deletionPosition)?(e.position=t.graveyardPosition.clone(),e.position.stickiness="toNext",[e]):(e.position=e.position._getTransformedByMergeOperation(t),[e])),setTransformation(RenameOperation,MoveOperation,(e,t)=>(e.position=e.position._getTransformedByMoveOperation(t),[e])),setTransformation(RenameOperation,RenameOperation,(e,t,r)=>{if(e.position.isEqual(t.position))if(r.aIsStrong)e.oldName=t.newName;else return[new NoOperation(0)];return[e]}),setTransformation(RenameOperation,SplitOperation,(e,t)=>{const r=e.position.path,i=t.splitPosition.getParentPath();if(compareArrays(r,i)=="same"&&!t.graveyardPosition){const o=new RenameOperation(e.position.getShiftedBy(1),e.oldName,e.newName,0);return[e,o]}return e.position=e.position._getTransformedBySplitOperation(t),[e]}),setTransformation(RootAttributeOperation,RootAttributeOperation,(e,t,r)=>{if(e.root===t.root&&e.key===t.key){if(!r.aIsStrong||e.newValue===t.newValue)return[new NoOperation(0)];e.oldValue=t.newValue}return[e]}),setTransformation(RootOperation,RootOperation,(e,t)=>e.rootName===t.rootName&&e.isAdd===t.isAdd?[new NoOperation(0)]:[e]),setTransformation(SplitOperation,InsertOperation,(e,t)=>(e.splitPosition.hasSameParentAs(t.position)&&e.splitPosition.offset<t.position.offset&&(e.howMany+=t.howMany),e.splitPosition=e.splitPosition._getTransformedByInsertOperation(t),e.insertionPosition=e.insertionPosition._getTransformedByInsertOperation(t),[e])),setTransformation(SplitOperation,MergeOperation,(e,t,r)=>{if(!e.graveyardPosition&&!r.bWasUndone&&e.splitPosition.hasSameParentAs(t.sourcePosition)){const i=t.graveyardPosition.path.slice();i.push(0);const o=new Position2(t.graveyardPosition.root,i),a=SplitOperation.getInsertionPosition(new Position2(t.graveyardPosition.root,i)),c=new SplitOperation(o,0,a,null,0);return e.splitPosition=e.splitPosition._getTransformedByMergeOperation(t),e.insertionPosition=SplitOperation.getInsertionPosition(e.splitPosition),e.graveyardPosition=c.insertionPosition.clone(),e.graveyardPosition.stickiness="toNext",[c,e]}return e.splitPosition.hasSameParentAs(t.deletionPosition)&&!e.splitPosition.isAfter(t.deletionPosition)&&e.howMany--,e.splitPosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.splitPosition=e.splitPosition._getTransformedByMergeOperation(t),e.insertionPosition=SplitOperation.getInsertionPosition(e.splitPosition),e.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedByMergeOperation(t)),[e]}),setTransformation(SplitOperation,MoveOperation,(e,t,r)=>{const i=Range2._createFromPositionAndShift(t.sourcePosition,t.howMany);if(e.graveyardPosition){const a=i.start.isEqual(e.graveyardPosition)||i.containsPosition(e.graveyardPosition);if(!r.bWasUndone&&a){const c=e.splitPosition._getTransformedByMoveOperation(t),u=e.graveyardPosition._getTransformedByMoveOperation(t),h=u.path.slice();h.push(0);const d=new Position2(u.root,h);return[new MoveOperation(c,e.howMany,d,0)]}e.graveyardPosition=e.graveyardPosition._getTransformedByMoveOperation(t)}const o=e.splitPosition.isEqual(t.targetPosition);if(o&&(r.baRelation=="insertAtSource"||r.abRelation=="splitBefore"))return e.howMany+=t.howMany,e.splitPosition=e.splitPosition._getTransformedByDeletion(t.sourcePosition,t.howMany),e.insertionPosition=SplitOperation.getInsertionPosition(e.splitPosition),[e];if(o&&r.abRelation&&r.abRelation.howMany){const{howMany:a,offset:c}=r.abRelation;return e.howMany+=a,e.splitPosition=e.splitPosition.getShiftedBy(c),[e]}if(e.splitPosition.hasSameParentAs(t.sourcePosition)&&i.containsPosition(e.splitPosition)){const a=t.howMany-(e.splitPosition.offset-t.sourcePosition.offset);return e.howMany-=a,e.splitPosition.hasSameParentAs(t.targetPosition)&&e.splitPosition.offset<t.targetPosition.offset&&(e.howMany+=t.howMany),e.splitPosition=t.sourcePosition.clone(),e.insertionPosition=SplitOperation.getInsertionPosition(e.splitPosition),[e]}return t.sourcePosition.isEqual(t.targetPosition)||(e.splitPosition.hasSameParentAs(t.sourcePosition)&&e.splitPosition.offset<=t.sourcePosition.offset&&(e.howMany-=t.howMany),e.splitPosition.hasSameParentAs(t.targetPosition)&&e.splitPosition.offset<t.targetPosition.offset&&(e.howMany+=t.howMany)),e.splitPosition.stickiness="toNone",e.splitPosition=e.splitPosition._getTransformedByMoveOperation(t),e.splitPosition.stickiness="toNext",e.graveyardPosition?e.insertionPosition=e.insertionPosition._getTransformedByMoveOperation(t):e.insertionPosition=SplitOperation.getInsertionPosition(e.splitPosition),[e]}),setTransformation(SplitOperation,SplitOperation,(e,t,r)=>{if(e.splitPosition.isEqual(t.splitPosition)){if(!e.graveyardPosition&&!t.graveyardPosition)return[new NoOperation(0)];if(e.graveyardPosition&&t.graveyardPosition&&e.graveyardPosition.isEqual(t.graveyardPosition))return[new NoOperation(0)];if(r.abRelation=="splitBefore")return e.howMany=0,e.graveyardPosition=e.graveyardPosition._getTransformedBySplitOperation(t),[e]}if(e.graveyardPosition&&t.graveyardPosition&&e.graveyardPosition.isEqual(t.graveyardPosition)){const i=e.splitPosition.root.rootName=="$graveyard",o=t.splitPosition.root.rootName=="$graveyard";if(o&&!i||!(i&&!o)&&r.aIsStrong){const h=[];return t.howMany&&h.push(new MoveOperation(t.moveTargetPosition,t.howMany,t.splitPosition,0)),e.howMany&&h.push(new MoveOperation(e.splitPosition,e.howMany,e.moveTargetPosition,0)),h}else return[new NoOperation(0)]}if(e.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedBySplitOperation(t)),e.splitPosition.isEqual(t.insertionPosition)&&r.abRelation=="splitBefore")return e.howMany++,[e];if(t.splitPosition.isEqual(e.insertionPosition)&&r.baRelation=="splitBefore"){const i=t.insertionPosition.path.slice();i.push(0);const o=new Position2(t.insertionPosition.root,i),a=new MoveOperation(e.insertionPosition,1,o,0);return[e,a]}return e.splitPosition.hasSameParentAs(t.splitPosition)&&e.splitPosition.offset<t.splitPosition.offset&&(e.howMany-=t.howMany),e.splitPosition=e.splitPosition._getTransformedBySplitOperation(t),e.insertionPosition=SplitOperation.getInsertionPosition(e.splitPosition),[e]});function _moveTargetIntoMovedRange(e,t){return e.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany)===null}function _makeMoveOperationsFromRanges(e,t){const r=[];for(let i=0;i<e.length;i++){const o=e[i],a=new MoveOperation(o.start,o.end.offset-o.start.offset,t,0);r.push(a);for(let c=i+1;c<e.length;c++)e[c]=e[c]._getTransformedByMove(a.sourcePosition,a.targetPosition,a.howMany)[0];t=t._getTransformedByMove(a.sourcePosition,a.targetPosition,a.howMany)}return r}var LivePosition=class extends EmitterMixin(Position2){constructor(e,t,r="toNone"){if(super(e,t,r),!this.root.is("rootElement"))throw new CKEditorError("model-liveposition-root-not-rootelement",e);bindWithDocument.call(this)}detach(){this.stopListening()}toPosition(){return new Position2(this.root,this.path.slice(),this.stickiness)}static fromPosition(e,t){return new this(e.root,e.path.slice(),t||e.stickiness)}};LivePosition.prototype.is=function(e){return e==="livePosition"||e==="model:livePosition"||e=="position"||e==="model:position"};function bindWithDocument(){this.listenTo(this.root.document.model,"applyOperation",(e,t)=>{const r=t[0];r.isDocumentOperation&&transform2.call(this,r)},{priority:"low"})}function transform2(e){const t=this.getTransformedByOperation(e);if(!this.isEqual(t)){const r=this.toPosition();this.path=t.path,this.root=t.root,this.fire("change",r)}}var Batch=class{operations;isUndoable;isLocal;isUndo;isTyping;constructor(e={}){typeof e=="string"&&(e=e==="transparent"?{isUndoable:!1}:{},logWarning("batch-constructor-deprecated-string-type"));const{isUndoable:t=!0,isLocal:r=!0,isUndo:i=!1,isTyping:o=!1}=e;this.operations=[],this.isUndoable=t,this.isLocal=r,this.isUndo=i,this.isTyping=o}get type(){return logWarning("batch-type-deprecated"),"default"}get baseVersion(){for(const e of this.operations)if(e.baseVersion!==null)return e.baseVersion;return null}addOperation(e){return e.batch=this,this.operations.push(e),e}},Differ=class gi{static _statesPriority=[void 0,"refresh","rename","move"];_markerCollection;_changesInElement=new Map;_elementsSnapshots=new Map;_elementChildrenSnapshots=new Map;_elementState=new Map;_changedMarkers=new Map;_changedRoots=new Map;_changeCount=0;_cachedChanges=null;_cachedChangesWithGraveyard=null;_refreshedItems=new Set;constructor(t){this._markerCollection=t}get isEmpty(){return this._changesInElement.size==0&&this._changedMarkers.size==0&&this._changedRoots.size==0}bufferOperation(t){const r=t;switch(r.type){case"insert":{if(this._isInInsertedElement(r.position.parent))return;this._markInsert(r.position.parent,r.position.offset,r.nodes.maxOffset);break}case"addAttribute":case"removeAttribute":case"changeAttribute":{for(const i of r.range.getItems({shallow:!0}))this._isInInsertedElement(i.parent)||this._markAttribute(i);break}case"remove":case"move":case"reinsert":{if(r.sourcePosition.isEqual(r.targetPosition)||r.sourcePosition.getShiftedBy(r.howMany).isEqual(r.targetPosition))return;const i=this._isInInsertedElement(r.sourcePosition.parent),o=this._isInInsertedElement(r.targetPosition.parent);i||this._markRemove(r.sourcePosition.parent,r.sourcePosition.offset,r.howMany),o||this._markInsert(r.targetPosition.parent,r.getMovedRangeStart().offset,r.howMany);const a=Range2._createFromPositionAndShift(r.sourcePosition,r.howMany);for(const c of a.getItems({shallow:!0}))this._setElementState(c,"move");break}case"rename":{if(this._isInInsertedElement(r.position.parent))return;this._markRemove(r.position.parent,r.position.offset,1),this._markInsert(r.position.parent,r.position.offset,1);const i=Range2._createFromPositionAndShift(r.position,1);for(const o of this._markerCollection.getMarkersIntersectingRange(i)){const a=o.getData();this.bufferMarkerChange(o.name,a,a)}this._setElementState(r.position.nodeAfter,"rename");break}case"split":{const i=r.splitPosition.parent;if(!this._isInInsertedElement(i)){this._markRemove(i,r.splitPosition.offset,r.howMany);const o=Range2._createFromPositionAndShift(r.splitPosition,r.howMany);for(const a of o.getItems({shallow:!0}))this._setElementState(a,"move")}this._isInInsertedElement(r.insertionPosition.parent)||this._markInsert(r.insertionPosition.parent,r.insertionPosition.offset,1),r.graveyardPosition&&(this._markRemove(r.graveyardPosition.parent,r.graveyardPosition.offset,1),this._setElementState(r.graveyardPosition.nodeAfter,"move"));break}case"merge":{const i=r.sourcePosition.parent;this._isInInsertedElement(i.parent)||this._markRemove(i.parent,i.startOffset,1);const o=r.graveyardPosition.parent;this._markInsert(o,r.graveyardPosition.offset,1),this._setElementState(i,"move");const a=r.targetPosition.parent;if(!this._isInInsertedElement(a)){this._markInsert(a,r.targetPosition.offset,i.maxOffset);const c=Range2._createFromPositionAndShift(r.sourcePosition,r.howMany);for(const u of c.getItems({shallow:!0}))this._setElementState(u,"move")}break}case"detachRoot":case"addRoot":{const i=r.affectedSelectable;if(!i._isLoaded||i.isAttached()==r.isAdd)return;this._bufferRootStateChange(r.rootName,r.isAdd);break}case"addRootAttribute":case"removeRootAttribute":case"changeRootAttribute":{if(!r.root._isLoaded)return;const i=r.root.rootName;this._bufferRootAttributeChange(i,r.key,r.oldValue,r.newValue);break}}this._cachedChanges=null}bufferMarkerChange(t,r,i){r.range&&r.range.root.is("rootElement")&&!r.range.root._isLoaded&&(r.range=null),i.range&&i.range.root.is("rootElement")&&!i.range.root._isLoaded&&(i.range=null);let o=this._changedMarkers.get(t);o?o.newMarkerData=i:(o={newMarkerData:i,oldMarkerData:r},this._changedMarkers.set(t,o)),o.oldMarkerData.range==null&&i.range==null&&this._changedMarkers.delete(t)}getMarkersToRemove(){const t=[];for(const[r,i]of this._changedMarkers)i.oldMarkerData.range!=null&&t.push({name:r,range:i.oldMarkerData.range});return t}getMarkersToAdd(){const t=[];for(const[r,i]of this._changedMarkers)i.newMarkerData.range!=null&&t.push({name:r,range:i.newMarkerData.range});return t}getChangedMarkers(){return Array.from(this._changedMarkers).map(([t,r])=>({name:t,data:{oldRange:r.oldMarkerData.range,newRange:r.newMarkerData.range}}))}hasDataChanges(){if(this.getChanges().length||this._changedRoots.size>0)return!0;for(const{newMarkerData:t,oldMarkerData:r}of this._changedMarkers.values()){if(t.affectsData!==r.affectsData)return!0;if(t.affectsData){const i=t.range&&!r.range,o=!t.range&&r.range,a=t.range&&r.range&&!t.range.isEqual(r.range);if(i||o||a)return!0}}return!1}getChanges(t={}){if(this._cachedChanges)return t.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();let r=[];for(const i of this._changesInElement.keys()){const o=this._changesInElement.get(i).sort((f,m)=>f.offset===m.offset?f.type!=m.type?f.type=="remove"?-1:1:0:f.offset<m.offset?-1:1),a=this._elementChildrenSnapshots.get(i),c=_getChildrenSnapshots(i.getChildren()),u=_generateDiffInstructionsFromChanges(a.length,o);let h=0,d=0;for(const f of u)if(f==="i"){const m=this._getDiffActionForNode(c[h].node,"insert"),g=this._elementsSnapshots.get(c[h].node),v=this._getInsertDiff(i,h,m,c[h],g);r.push(v),h++}else if(f==="r"){const m=this._getDiffActionForNode(a[d].node,"remove"),g=this._getRemoveDiff(i,h,m,a[d]);r.push(g),d++}else if(f==="a"){const m=a[d].attributes,g=c[h].attributes;let v;if(c[h].name=="$text")v=new Range2(Position2._createAt(i,h),Position2._createAt(i,h+1));else{const b=i.offsetToIndex(h);v=new Range2(Position2._createAt(i,h),Position2._createAt(i.getChild(b),0))}const _=this._getAttributesDiff(v,m,g);r.push(..._),h++,d++}else h++,d++}r.sort((i,o)=>i.position.root!=o.position.root?i.position.root.rootName<o.position.root.rootName?-1:1:i.position.isEqual(o.position)?i.changeCount-o.changeCount:i.position.isBefore(o.position)?-1:1);for(let i=1,o=0;i<r.length;i++){const a=r[o],c=r[i],u=a.type=="remove"&&c.type=="remove"&&a.name=="$text"&&c.name=="$text"&&a.position.isEqual(c.position),h=a.type=="insert"&&c.type=="insert"&&a.name=="$text"&&c.name=="$text"&&a.position.parent==c.position.parent&&a.position.offset+a.length==c.position.offset,d=a.type=="attribute"&&c.type=="attribute"&&a.position.parent==c.position.parent&&a.range.isFlat&&c.range.isFlat&&a.position.offset+a.length==c.position.offset&&a.attributeKey==c.attributeKey&&a.attributeOldValue==c.attributeOldValue&&a.attributeNewValue==c.attributeNewValue;u||h||d?(a.length++,d&&(a.range.end=a.range.end.getShiftedBy(1)),r[i]=null):o=i}r=r.filter(i=>i);for(const i of r)delete i.changeCount,i.type=="attribute"&&(delete i.position,delete i.length);return this._changeCount=0,this._cachedChangesWithGraveyard=r,this._cachedChanges=r.filter(_changesInGraveyardFilter),t.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice()}getChangedRoots(){return Array.from(this._changedRoots.values()).map(t=>{const r={...t};return r.state!==void 0&&delete r.attributes,r})}getRefreshedItems(){return new Set(this._refreshedItems)}reset(){this._changesInElement.clear(),this._elementChildrenSnapshots.clear(),this._elementsSnapshots.clear(),this._elementState.clear(),this._changedMarkers.clear(),this._changedRoots.clear(),this._refreshedItems.clear(),this._cachedChanges=null}_refreshItem(t){if(this._isInInsertedElement(t.parent))return;this._markRemove(t.parent,t.startOffset,t.offsetSize),this._markInsert(t.parent,t.startOffset,t.offsetSize),this._refreshedItems.add(t),this._setElementState(t,"refresh");const r=Range2._createOn(t);for(const i of this._markerCollection.getMarkersIntersectingRange(r)){const o=i.getData();this.bufferMarkerChange(i.name,o,o)}this._cachedChanges=null}_bufferRootLoad(t){if(t.isAttached()){this._bufferRootStateChange(t.rootName,!0),this._markInsert(t,0,t.maxOffset);for(const r of t.getAttributeKeys())this._bufferRootAttributeChange(t.rootName,r,null,t.getAttribute(r));for(const r of this._markerCollection)if(r.getRange().root==t){const i=r.getData();this.bufferMarkerChange(r.name,{...i,range:null},i)}}}_bufferRootStateChange(t,r){if(!this._changedRoots.has(t)){this._changedRoots.set(t,{name:t,state:r?"attached":"detached"});return}const i=this._changedRoots.get(t);i.state!==void 0?(delete i.state,i.attributes===void 0&&this._changedRoots.delete(t)):i.state=r?"attached":"detached"}_bufferRootAttributeChange(t,r,i,o){const a=this._changedRoots.get(t)||{name:t},c=a.attributes||{};if(c[r]){const u=c[r];o===u.oldValue?delete c[r]:u.newValue=o}else c[r]={oldValue:i,newValue:o};Object.entries(c).length===0?(delete a.attributes,a.state===void 0&&this._changedRoots.delete(t)):(a.attributes=c,this._changedRoots.set(t,a))}_markInsert(t,r,i){if(t.root.is("rootElement")&&!t.root._isLoaded)return;const o={type:"insert",offset:r,howMany:i,count:this._changeCount++};this._markChange(t,o)}_markRemove(t,r,i){if(t.root.is("rootElement")&&!t.root._isLoaded)return;const o={type:"remove",offset:r,howMany:i,count:this._changeCount++};this._markChange(t,o),this._removeAllNestedChanges(t,r,i)}_markAttribute(t){if(t.root.is("rootElement")&&!t.root._isLoaded)return;const r={type:"attribute",offset:t.startOffset,howMany:t.offsetSize,count:this._changeCount++};this._markChange(t.parent,r)}_markChange(t,r){this._makeSnapshots(t);const i=this._getChangesForElement(t);this._handleChange(r,i),i.push(r);for(let o=0;o<i.length;o++)i[o].howMany<1&&(i.splice(o,1),o--)}_setElementState(t,r){if(!t.is("element"))return;const i=gi._statesPriority.indexOf(this._elementState.get(t));gi._statesPriority.indexOf(r)>i&&this._elementState.set(t,r)}_getDiffActionForNode(t,r){if(!t.is("element")||!this._elementsSnapshots.has(t))return r;const i=this._elementState.get(t);return!i||i=="move"?r:i}_getChangesForElement(t){let r;return this._changesInElement.has(t)?r=this._changesInElement.get(t):(r=[],this._changesInElement.set(t,r)),r}_makeSnapshots(t){if(this._elementChildrenSnapshots.has(t))return;const r=_getChildrenSnapshots(t.getChildren());this._elementChildrenSnapshots.set(t,r);for(const i of r)this._elementsSnapshots.set(i.node,i)}_handleChange(t,r){t.nodesToHandle=t.howMany;for(const i of r){const o=t.offset+t.howMany,a=i.offset+i.howMany;if(t.type=="insert"&&(i.type=="insert"&&(t.offset<=i.offset?i.offset+=t.howMany:t.offset<a&&(i.howMany+=t.nodesToHandle,t.nodesToHandle=0)),i.type=="remove"&&t.offset<i.offset&&(i.offset+=t.howMany),i.type=="attribute")){if(t.offset<=i.offset)i.offset+=t.howMany;else if(t.offset<a){const c=i.howMany;i.howMany=t.offset-i.offset,r.unshift({type:"attribute",offset:o,howMany:c-i.howMany,count:this._changeCount++})}}if(t.type=="remove"){if(i.type=="insert"){if(o<=i.offset)i.offset-=t.howMany;else if(o<=a)if(t.offset<i.offset){const c=o-i.offset;i.offset=t.offset,i.howMany-=c,t.nodesToHandle-=c}else i.howMany-=t.nodesToHandle,t.nodesToHandle=0;else if(t.offset<=i.offset)t.nodesToHandle-=i.howMany,i.howMany=0;else if(t.offset<a){const c=a-t.offset;i.howMany-=c,t.nodesToHandle-=c}}if(i.type=="remove"&&(o<=i.offset?i.offset-=t.howMany:t.offset<i.offset&&(t.nodesToHandle+=i.howMany,i.howMany=0)),i.type=="attribute"){if(o<=i.offset)i.offset-=t.howMany;else if(t.offset<i.offset){const c=o-i.offset;i.offset=t.offset,i.howMany-=c}else if(t.offset<a)if(o<=a){const c=i.howMany;i.howMany=t.offset-i.offset;const u=c-i.howMany-t.nodesToHandle;r.unshift({type:"attribute",offset:t.offset,howMany:u,count:this._changeCount++})}else i.howMany-=a-t.offset}}if(t.type=="attribute"){if(i.type=="insert")if(t.offset<i.offset&&o>i.offset){if(o>a){const c={type:"attribute",offset:a,howMany:o-a,count:this._changeCount++};this._handleChange(c,r),r.push(c)}t.nodesToHandle=i.offset-t.offset,t.howMany=t.nodesToHandle}else t.offset>=i.offset&&t.offset<a&&(o>a?(t.nodesToHandle=o-a,t.offset=a):t.nodesToHandle=0);if(i.type=="remove"&&t.offset<i.offset&&o>i.offset){const c={type:"attribute",offset:i.offset,howMany:o-i.offset,count:this._changeCount++};this._handleChange(c,r),r.push(c),t.nodesToHandle=i.offset-t.offset,t.howMany=t.nodesToHandle}i.type=="attribute"&&(t.offset>=i.offset&&o<=a?(t.nodesToHandle=0,t.howMany=0,t.offset=0):t.offset<=i.offset&&o>=a&&(i.howMany=0))}}t.howMany=t.nodesToHandle,delete t.nodesToHandle}_getInsertDiff(t,r,i,o,a){const c={type:"insert",position:Position2._createAt(t,r),name:o.name,attributes:new Map(o.attributes),length:1,changeCount:this._changeCount++,action:i};return i!="insert"&&a&&(c.before={name:a.name,attributes:new Map(a.attributes)}),c}_getRemoveDiff(t,r,i,o){return{type:"remove",action:i,position:Position2._createAt(t,r),name:o.name,attributes:new Map(o.attributes),length:1,changeCount:this._changeCount++}}_getAttributesDiff(t,r,i){const o=[];i=new Map(i);for(const[a,c]of r){const u=i.has(a)?i.get(a):null;u!==c&&o.push({type:"attribute",position:t.start,range:t.clone(),length:1,attributeKey:a,attributeOldValue:c,attributeNewValue:u,changeCount:this._changeCount++}),i.delete(a)}for(const[a,c]of i)o.push({type:"attribute",position:t.start,range:t.clone(),length:1,attributeKey:a,attributeOldValue:null,attributeNewValue:c,changeCount:this._changeCount++});return o}_isInInsertedElement(t){const r=t.parent;if(!r)return!1;const i=this._changesInElement.get(r),o=t.startOffset;if(i){for(const a of i)if(a.type=="insert"&&o>=a.offset&&o<a.offset+a.howMany)return!0}return this._isInInsertedElement(r)}_removeAllNestedChanges(t,r,i){const o=new Range2(Position2._createAt(t,r),Position2._createAt(t,r+i));for(const a of o.getItems({shallow:!0}))a.is("element")&&(this._changesInElement.delete(a),this._removeAllNestedChanges(a,0,a.maxOffset))}};function _getSingleNodeSnapshot(e){return{node:e,name:e.is("$text")?"$text":e.name,attributes:new Map(e.getAttributes())}}function _getChildrenSnapshots(e){const t=[];for(const r of e)if(r.is("$text"))for(let i=0;i<r.data.length;++i)t.push(_getSingleNodeSnapshot(r));else t.push(_getSingleNodeSnapshot(r));return t}function _generateDiffInstructionsFromChanges(e,t){const r=[];let i=0,o=0;for(const a of t){if(a.offset>i){for(let c=0;c<a.offset-i;c++)r.push("e");o+=a.offset-i}if(a.type=="insert"){for(let c=0;c<a.howMany;c++)r.push("i");i=a.offset+a.howMany}else if(a.type=="remove"){for(let c=0;c<a.howMany;c++)r.push("r");i=a.offset,o+=a.howMany}else{if(a.howMany>1500)for(let c=0;c<a.howMany;c++)r.push("a");else r.push(..."a".repeat(a.howMany).split(""));i=a.offset+a.howMany,o+=a.howMany}}if(o<e)for(let a=0;a<e-o-i;a++)r.push("e");return r}function _changesInGraveyardFilter(e){const t="position"in e&&e.position.root.rootName=="$graveyard",r="range"in e&&e.range.root.rootName=="$graveyard";return!t&&!r}var History=class{_operations=[];_undoPairs=new Map;_undoneOperations=new Set;_baseVersionToOperationIndex=new Map;_version=0;_gaps=new Map;get version(){return this._version}set version(e){this._operations.length&&e>this._version+1&&this._gaps.set(this._version,e),this._version=e}get lastOperation(){return this._operations[this._operations.length-1]}addOperation(e){if(e.baseVersion!==this.version)throw new CKEditorError("model-document-history-addoperation-incorrect-version",this,{operation:e,historyVersion:this.version});this._operations.push(e),this._version++,this._baseVersionToOperationIndex.set(e.baseVersion,this._operations.length-1)}getOperations(e,t=this.version){if(!this._operations.length)return[];const r=this._operations[0];e===void 0&&(e=r.baseVersion);let i=t-1;for(const[c,u]of this._gaps)e>c&&e<u&&(e=u),i>c&&i<u&&(i=c-1);if(i<r.baseVersion||e>this.lastOperation.baseVersion)return[];let o=this._baseVersionToOperationIndex.get(e);o===void 0&&(o=0);let a=this._baseVersionToOperationIndex.get(i);return a===void 0&&(a=this._operations.length-1),this._operations.slice(o,a+1)}getOperation(e){const t=this._baseVersionToOperationIndex.get(e);if(t!==void 0)return this._operations[t]}setOperationAsUndone(e,t){this._undoPairs.set(t,e),this._undoneOperations.add(e)}isUndoingOperation(e){return this._undoPairs.has(e)}isUndoneOperation(e){return this._undoneOperations.has(e)}getUndoneOperation(e){return this._undoPairs.get(e)}reset(){this._version=0,this._undoPairs=new Map,this._operations=[],this._undoneOperations=new Set,this._gaps=new Map,this._baseVersionToOperationIndex=new Map}},RootElement=class extends Element4{rootName;_document;_isAttached=!0;_isLoaded=!0;constructor(e,t,r="main"){super(t),this._document=e,this.rootName=r}get document(){return this._document}isAttached(){return this._isAttached}toJSON(){return this.rootName}};RootElement.prototype.is=function(e,t){return t?t===this.name&&(e==="rootElement"||e==="model:rootElement"||e==="element"||e==="model:element"):e==="rootElement"||e==="model:rootElement"||e==="element"||e==="model:element"||e==="node"||e==="model:node"};var graveyardName="$graveyard",Document2=class extends EmitterMixin(){model;history;selection;roots;differ;isReadOnly;_postFixers;_hasSelectionChangedFromTheLastChangeBlock;constructor(e){super(),this.model=e,this.history=new History,this.selection=new DocumentSelection2(this),this.roots=new Collection({idProperty:"rootName"}),this.differ=new Differ(e.markers),this.isReadOnly=!1,this._postFixers=new Set,this._hasSelectionChangedFromTheLastChangeBlock=!1,this.createRoot("$root",graveyardName),this.listenTo(e,"applyOperation",(t,r)=>{const i=r[0];i.isDocumentOperation&&this.differ.bufferOperation(i)},{priority:"high"}),this.listenTo(e,"applyOperation",(t,r)=>{const i=r[0];i.isDocumentOperation&&this.history.addOperation(i)},{priority:"low"}),this.listenTo(this.selection,"change",()=>{this._hasSelectionChangedFromTheLastChangeBlock=!0}),this.listenTo(e.markers,"update",(t,r,i,o,a)=>{const c={...r.getData(),range:o};this.differ.bufferMarkerChange(r.name,a,c),i===null&&r.on("change",(u,h)=>{const d=r.getData();this.differ.bufferMarkerChange(r.name,{...d,range:h},d)})}),this.registerPostFixer(t=>{let r=!1;for(const i of this.roots)!i.isAttached()&&!i.isEmpty&&(t.remove(t.createRangeIn(i)),r=!0);for(const i of this.model.markers)i.getRange().root.isAttached()||(t.removeMarker(i),r=!0);return r})}get version(){return this.history.version}set version(e){this.history.version=e}get graveyard(){return this.getRoot(graveyardName)}createRoot(e="$root",t="main"){if(this.roots.get(t))throw new CKEditorError("model-document-createroot-name-exists",this,{name:t});const r=new RootElement(this,e,t);return this.roots.add(r),r}destroy(){this.selection.destroy(),this.stopListening()}getRoot(e="main"){return this.roots.get(e)}getRootNames(e=!1){return this.getRoots(e).map(t=>t.rootName)}getRoots(e=!1){return this.roots.filter(t=>t!=this.graveyard&&(e||t.isAttached())&&t._isLoaded)}registerPostFixer(e){this._postFixers.add(e)}toJSON(){const e=clone_default2(this);return e.selection="[engine.model.DocumentSelection]",e.model="[engine.model.Model]",e}_handleChangeBlock(e){this._hasDocumentChangedFromTheLastChangeBlock()&&(this._callPostFixers(e),this.selection.refresh(),this.differ.hasDataChanges()?this.fire("change:data",e.batch):this.fire("change",e.batch),this.selection.refresh(),this.differ.reset()),this._hasSelectionChangedFromTheLastChangeBlock=!1}_hasDocumentChangedFromTheLastChangeBlock(){return!this.differ.isEmpty||this._hasSelectionChangedFromTheLastChangeBlock}_getDefaultRoot(){const e=this.getRoots();return e.length?e[0]:this.graveyard}_getDefaultRange(){const e=this._getDefaultRoot(),t=this.model,r=t.schema,i=t.createPositionFromPath(e,[0]);return r.getNearestSelectionRange(i)||t.createRange(i)}_validateSelectionRange(e){return e.start.isValid()&&e.end.isValid()&&validateTextNodePosition(e.start)&&validateTextNodePosition(e.end)}_callPostFixers(e){let t=!1;do for(const r of this._postFixers)if(this.selection.refresh(),t=r(e),t)break;while(t)}};function validateTextNodePosition(e){const t=e.textNode;if(t){const r=t.data,i=e.offset-t.startOffset;return!isInsideSurrogatePair(r,i)&&!isInsideCombinedSymbol(r,i)}return!0}var MarkerCollection=class extends EmitterMixin(){_markers=new Map;[Symbol.iterator](){return this._markers.values()}has(e){const t=e instanceof Marker?e.name:e;return this._markers.has(t)}get(e){return this._markers.get(e)||null}_set(e,t,r=!1,i=!1){const o=e instanceof Marker?e.name:e;if(o.includes(","))throw new CKEditorError("markercollection-incorrect-marker-name",this);const a=this._markers.get(o);if(a){const h=a.getData(),d=a.getRange();let f=!1;return d.isEqual(t)||(a._attachLiveRange(LiveRange.fromRange(t)),f=!0),r!=a.managedUsingOperations&&(a._managedUsingOperations=r,f=!0),typeof i=="boolean"&&i!=a.affectsData&&(a._affectsData=i,f=!0),f&&this.fire(`update:${o}`,a,d,t,h),a}const c=LiveRange.fromRange(t),u=new Marker(o,c,r,i);return this._markers.set(o,u),this.fire(`update:${o}`,u,null,t,{...u.getData(),range:null}),u}_remove(e){const t=e instanceof Marker?e.name:e,r=this._markers.get(t);return r?(this._markers.delete(t),this.fire(`update:${t}`,r,r.getRange(),null,r.getData()),this._destroyMarker(r),!0):!1}_refresh(e){const t=e instanceof Marker?e.name:e,r=this._markers.get(t);if(!r)throw new CKEditorError("markercollection-refresh-marker-not-exists",this);const i=r.getRange();this.fire(`update:${t}`,r,i,i,r.getData())}*getMarkersAtPosition(e){for(const t of this)t.getRange().containsPosition(e)&&(yield t)}*getMarkersIntersectingRange(e){for(const t of this)t.getRange().getIntersection(e)!==null&&(yield t)}destroy(){for(const e of this._markers.values())this._destroyMarker(e);this._markers=null,this.stopListening()}*getMarkersGroup(e){for(const t of this._markers.values())t.name.startsWith(e+":")&&(yield t)}_destroyMarker(e){e.stopListening(),e._detachLiveRange()}},Marker=class extends EmitterMixin(TypeCheckable2){name;_managedUsingOperations;_affectsData;_liveRange;constructor(e,t,r,i){super(),this.name=e,this._liveRange=this._attachLiveRange(t),this._managedUsingOperations=r,this._affectsData=i}get managedUsingOperations(){if(!this._liveRange)throw new CKEditorError("marker-destroyed",this);return this._managedUsingOperations}get affectsData(){if(!this._liveRange)throw new CKEditorError("marker-destroyed",this);return this._affectsData}getData(){return{range:this.getRange(),affectsData:this.affectsData,managedUsingOperations:this.managedUsingOperations}}getStart(){if(!this._liveRange)throw new CKEditorError("marker-destroyed",this);return this._liveRange.start.clone()}getEnd(){if(!this._liveRange)throw new CKEditorError("marker-destroyed",this);return this._liveRange.end.clone()}getRange(){if(!this._liveRange)throw new CKEditorError("marker-destroyed",this);return this._liveRange.toRange()}_attachLiveRange(e){return this._liveRange&&this._detachLiveRange(),e.delegate("change:range").to(this),e.delegate("change:content").to(this),this._liveRange=e,e}_detachLiveRange(){this._liveRange.stopDelegating("change:range",this),this._liveRange.stopDelegating("change:content",this),this._liveRange.detach(),this._liveRange=null}};Marker.prototype.is=function(e){return e==="marker"||e==="model:marker"};var DetachOperation=class extends Operation{sourcePosition;howMany;constructor(e,t){super(null),this.sourcePosition=e.clone(),this.howMany=t}get type(){return"detach"}get affectedSelectable(){return null}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e}_validate(){if(this.sourcePosition.root.document)throw new CKEditorError("detach-operation-on-document-node",this)}_execute(){_remove(Range2._createFromPositionAndShift(this.sourcePosition,this.howMany))}static get className(){return"DetachOperation"}},DocumentFragment2=class Cs extends TypeCheckable2{markers=new Map;_children=new NodeList;constructor(t){super(),t&&this._insertChild(0,t)}[Symbol.iterator](){return this.getChildren()}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}get nextSibling(){return null}get previousSibling(){return null}get root(){return this}get parent(){return null}get document(){return null}isAttached(){return!1}getAncestors(){return[]}getChild(t){return this._children.getNode(t)}getChildAtOffset(t){return this._children.getNodeAtOffset(t)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(t){return this._children.getNodeIndex(t)}getChildStartOffset(t){return this._children.getNodeStartOffset(t)}getPath(){return[]}getNodeByPath(t){let r=this;for(const i of t)r=r.getChildAtOffset(i);return r}offsetToIndex(t){return this._children.offsetToIndex(t)}toJSON(){const t=[];for(const r of this._children)t.push(r.toJSON());return t}static fromJSON(t){const r=[];for(const i of t)i.name?r.push(Element4.fromJSON(i)):r.push(Text2.fromJSON(i));return new Cs(r)}_appendChild(t){this._insertChild(this.childCount,t)}_insertChild(t,r){const i=normalize2(r);for(const o of i)o.parent!==null&&o._remove(),o.parent=this;this._children._insertNodes(t,i)}_removeChildren(t,r=1){const i=this._children._removeNodes(t,r);for(const o of i)o.parent=null;return i}_removeChildrenArray(t){this._children._removeNodesArray(t);for(const r of t)r.parent=null}};DocumentFragment2.prototype.is=function(e){return e==="documentFragment"||e==="model:documentFragment"};function normalize2(e){return typeof e=="string"?[new Text2(e)]:(isIterable(e)||(e=[e]),Array.from(e).map(t=>typeof t=="string"?new Text2(t):t instanceof TextProxy2?new Text2(t.data,t.getAttributes()):t))}var Writer=class{model;batch;constructor(e,t){this.model=e,this.batch=t}createText(e,t){return new Text2(e,t)}createElement(e,t){return new Element4(e,t)}createDocumentFragment(){return new DocumentFragment2}cloneElement(e,t=!0){return e._clone(t)}insert(e,t,r=0){if(this._assertWriterUsedCorrectly(),e instanceof Text2&&e.data=="")return;const i=Position2._createAt(t,r);if(e.parent)if(isSameTree(e.root,i.root)){this.move(Range2._createOn(e),i);return}else{if(e.root.document)throw new CKEditorError("model-writer-insert-forbidden-move",this);this.remove(e)}const o=i.root.document?i.root.document.version:null,a=e instanceof DocumentFragment2?e._removeChildren(0,e.childCount):e,c=new InsertOperation(i,a,o);if(e instanceof Text2&&(c.shouldReceiveAttributes=!0),this.batch.addOperation(c),this.model.applyOperation(c),e instanceof DocumentFragment2)for(const[u,h]of e.markers){const d=Position2._createAt(h.root,0),m={range:new Range2(h.start._getCombined(d,i),h.end._getCombined(d,i)),usingOperation:!0,affectsData:!0};this.model.markers.has(u)?this.updateMarker(u,m):this.addMarker(u,m)}}insertText(e,t,r,i){t instanceof DocumentFragment2||t instanceof Element4||t instanceof Position2?this.insert(this.createText(e),t,r):this.insert(this.createText(e,t),r,i)}insertElement(e,t,r,i){t instanceof DocumentFragment2||t instanceof Element4||t instanceof Position2?this.insert(this.createElement(e),t,r):this.insert(this.createElement(e,t),r,i)}append(e,t){this.insert(e,t,"end")}appendText(e,t,r){t instanceof DocumentFragment2||t instanceof Element4?this.insert(this.createText(e),t,"end"):this.insert(this.createText(e,t),r,"end")}appendElement(e,t,r){t instanceof DocumentFragment2||t instanceof Element4?this.insert(this.createElement(e),t,"end"):this.insert(this.createElement(e,t),r,"end")}setAttribute(e,t,r){if(this._assertWriterUsedCorrectly(),r instanceof Range2){const i=r.getMinimalFlatRanges();for(const o of i)setAttributeOnRange(this,e,t,o)}else setAttributeOnItem(this,e,t,r)}setAttributes(e,t){for(const[r,i]of toMap(e))this.setAttribute(r,i,t)}removeAttribute(e,t){if(this._assertWriterUsedCorrectly(),t instanceof Range2){const r=t.getMinimalFlatRanges();for(const i of r)setAttributeOnRange(this,e,null,i)}else setAttributeOnItem(this,e,null,t)}clearAttributes(e){this._assertWriterUsedCorrectly();const t=r=>{for(const i of r.getAttributeKeys())this.removeAttribute(i,r)};if(!(e instanceof Range2))t(e);else for(const r of e.getItems())t(r)}move(e,t,r){if(this._assertWriterUsedCorrectly(),!(e instanceof Range2))throw new CKEditorError("writer-move-invalid-range",this);if(!e.isFlat)throw new CKEditorError("writer-move-range-not-flat",this);const i=Position2._createAt(t,r);if(i.isEqual(e.start))return;if(this._addOperationForAffectedMarkers("move",e),!isSameTree(e.root,i.root))throw new CKEditorError("writer-move-different-document",this);const o=e.root.document?e.root.document.version:null,a=new MoveOperation(e.start,e.end.offset-e.start.offset,i,o);this.batch.addOperation(a),this.model.applyOperation(a)}remove(e){this._assertWriterUsedCorrectly();const r=(e instanceof Range2?e:Range2._createOn(e)).getMinimalFlatRanges().reverse();for(const i of r)this._addOperationForAffectedMarkers("move",i),applyRemoveOperation(i.start,i.end.offset-i.start.offset,this.batch,this.model)}merge(e){this._assertWriterUsedCorrectly();const t=e.nodeBefore,r=e.nodeAfter;if(this._addOperationForAffectedMarkers("merge",e),!(t instanceof Element4))throw new CKEditorError("writer-merge-no-element-before",this);if(!(r instanceof Element4))throw new CKEditorError("writer-merge-no-element-after",this);e.root.document?this._merge(e):this._mergeDetached(e)}createPositionFromPath(e,t,r){return this.model.createPositionFromPath(e,t,r)}createPositionAt(e,t){return this.model.createPositionAt(e,t)}createPositionAfter(e){return this.model.createPositionAfter(e)}createPositionBefore(e){return this.model.createPositionBefore(e)}createRange(e,t){return this.model.createRange(e,t)}createRangeIn(e){return this.model.createRangeIn(e)}createRangeOn(e){return this.model.createRangeOn(e)}createSelection(...e){return this.model.createSelection(...e)}_mergeDetached(e){const t=e.nodeBefore,r=e.nodeAfter;this.move(Range2._createIn(r),Position2._createAt(t,"end")),this.remove(r)}_merge(e){const t=Position2._createAt(e.nodeBefore,"end"),r=Position2._createAt(e.nodeAfter,0),i=e.root.document.graveyard,o=new Position2(i,[0]),a=e.root.document.version,c=new MergeOperation(r,e.nodeAfter.maxOffset,t,o,a);this.batch.addOperation(c),this.model.applyOperation(c)}rename(e,t){if(this._assertWriterUsedCorrectly(),!(e instanceof Element4))throw new CKEditorError("writer-rename-not-element-instance",this);const r=e.root.document?e.root.document.version:null,i=new RenameOperation(Position2._createBefore(e),e.name,t,r);this.batch.addOperation(i),this.model.applyOperation(i)}split(e,t){this._assertWriterUsedCorrectly();let r=e.parent;if(!r.parent)throw new CKEditorError("writer-split-element-no-parent",this);if(t||(t=r.parent),!e.parent.getAncestors({includeSelf:!0}).includes(t))throw new CKEditorError("writer-split-invalid-limit-element",this);let i,o;do{const a=r.root.document?r.root.document.version:null,c=r.maxOffset-e.offset,u=SplitOperation.getInsertionPosition(e),h=new SplitOperation(e,c,u,null,a);this.batch.addOperation(h),this.model.applyOperation(h),!i&&!o&&(i=r,o=e.parent.nextSibling),e=this.createPositionAfter(e.parent),r=e.parent}while(r!==t);return{position:e,range:new Range2(Position2._createAt(i,"end"),Position2._createAt(o,0))}}wrap(e,t){if(this._assertWriterUsedCorrectly(),!e.isFlat)throw new CKEditorError("writer-wrap-range-not-flat",this);const r=t instanceof Element4?t:new Element4(t);if(r.childCount>0)throw new CKEditorError("writer-wrap-element-not-empty",this);if(r.parent!==null)throw new CKEditorError("writer-wrap-element-attached",this);this.insert(r,e.start);const i=new Range2(e.start.getShiftedBy(1),e.end.getShiftedBy(1));this.move(i,Position2._createAt(r,0))}unwrap(e){if(this._assertWriterUsedCorrectly(),e.parent===null)throw new CKEditorError("writer-unwrap-element-no-parent",this);this.move(Range2._createIn(e),this.createPositionAfter(e)),this.remove(e)}addMarker(e,t){if(this._assertWriterUsedCorrectly(),!t||typeof t.usingOperation!="boolean")throw new CKEditorError("writer-addmarker-no-usingoperation",this);const r=t.usingOperation,i=t.range,o=t.affectsData===void 0?!1:t.affectsData;if(this.model.markers.has(e))throw new CKEditorError("writer-addmarker-marker-exists",this);if(!i)throw new CKEditorError("writer-addmarker-no-range",this);return r?(applyMarkerOperation(this,e,null,i,o),this.model.markers.get(e)):this.model.markers._set(e,i,r,o)}updateMarker(e,t){this._assertWriterUsedCorrectly();const r=typeof e=="string"?e:e.name,i=this.model.markers.get(r);if(!i)throw new CKEditorError("writer-updatemarker-marker-not-exists",this);if(!t){logWarning("writer-updatemarker-reconvert-using-editingcontroller",{markerName:r}),this.model.markers._refresh(i);return}const o=typeof t.usingOperation=="boolean",a=typeof t.affectsData=="boolean",c=a?t.affectsData:i.affectsData;if(!o&&!t.range&&!a)throw new CKEditorError("writer-updatemarker-wrong-options",this);const u=i.getRange(),h=t.range?t.range:u;if(o&&t.usingOperation!==i.managedUsingOperations){t.usingOperation?applyMarkerOperation(this,r,null,h,c):(applyMarkerOperation(this,r,u,null,c),this.model.markers._set(r,h,void 0,c));return}i.managedUsingOperations?applyMarkerOperation(this,r,u,h,c):this.model.markers._set(r,h,void 0,c)}removeMarker(e){this._assertWriterUsedCorrectly();const t=typeof e=="string"?e:e.name;if(!this.model.markers.has(t))throw new CKEditorError("writer-removemarker-no-marker",this);const r=this.model.markers.get(t);if(!r.managedUsingOperations){this.model.markers._remove(t);return}const i=r.getRange();applyMarkerOperation(this,t,i,null,r.affectsData)}addRoot(e,t="$root"){this._assertWriterUsedCorrectly();const r=this.model.document.getRoot(e);if(r&&r.isAttached())throw new CKEditorError("writer-addroot-root-exists",this);const i=this.model.document,o=new RootOperation(e,t,!0,i,i.version);return this.batch.addOperation(o),this.model.applyOperation(o),this.model.document.getRoot(e)}detachRoot(e){this._assertWriterUsedCorrectly();const t=typeof e=="string"?this.model.document.getRoot(e):e;if(!t||!t.isAttached())throw new CKEditorError("writer-detachroot-no-root",this);for(const o of this.model.markers)o.getRange().root===t&&this.removeMarker(o);for(const o of t.getAttributeKeys())this.removeAttribute(o,t);this.remove(this.createRangeIn(t));const r=this.model.document,i=new RootOperation(t.rootName,t.name,!1,r,r.version);this.batch.addOperation(i),this.model.applyOperation(i)}setSelection(...e){this._assertWriterUsedCorrectly(),this.model.document.selection._setTo(...e)}setSelectionFocus(e,t){this._assertWriterUsedCorrectly(),this.model.document.selection._setFocus(e,t)}setSelectionAttribute(e,t){if(this._assertWriterUsedCorrectly(),typeof e=="string")this._setSelectionAttribute(e,t);else for(const[r,i]of toMap(e))this._setSelectionAttribute(r,i)}removeSelectionAttribute(e){if(this._assertWriterUsedCorrectly(),typeof e=="string")this._removeSelectionAttribute(e);else for(const t of e)this._removeSelectionAttribute(t)}overrideSelectionGravity(){return this.model.document.selection._overrideGravity()}restoreSelectionGravity(e){this.model.document.selection._restoreGravity(e)}_setSelectionAttribute(e,t){const r=this.model.document.selection;if(r.isCollapsed&&r.anchor.parent.isEmpty){const i=DocumentSelection2._getStoreAttributeKey(e);this.setAttribute(i,t,r.anchor.parent)}r._setAttribute(e,t)}_removeSelectionAttribute(e){const t=this.model.document.selection;if(t.isCollapsed&&t.anchor.parent.isEmpty){const r=DocumentSelection2._getStoreAttributeKey(e);this.removeAttribute(r,t.anchor.parent)}t._removeAttribute(e)}_assertWriterUsedCorrectly(){if(this.model._currentWriter!==this)throw new CKEditorError("writer-incorrect-use",this)}_addOperationForAffectedMarkers(e,t){for(const r of this.model.markers){if(!r.managedUsingOperations)continue;const i=r.getRange();let o=!1;if(e==="move"){const a=t;o=a.containsPosition(i.start)||a.start.isEqual(i.start)||a.containsPosition(i.end)||a.end.isEqual(i.end)}else{const a=t,c=a.nodeBefore,u=a.nodeAfter,h=i.start.parent==c&&i.start.isAtEnd,d=i.end.parent==u&&i.end.offset==0,f=i.end.nodeAfter==u,m=i.start.nodeAfter==u;o=h||d||f||m}o&&this.updateMarker(r.name,{range:i})}}};function setAttributeOnRange(e,t,r,i){const o=e.model,a=o.document;let c=i.start,u,h,d;for(const m of i.getWalker({shallow:!0}))d=m.item.getAttribute(t),u&&h!=d&&(h!=r&&f(),c=u),u=m.nextPosition,h=d;u instanceof Position2&&u!=c&&h!=r&&f();function f(){const m=new Range2(c,u),g=m.root.document?a.version:null,v=new AttributeOperation(m,t,h,r,g);e.batch.addOperation(v),o.applyOperation(v)}}function setAttributeOnItem(e,t,r,i){const o=e.model,a=o.document,c=i.getAttribute(t);let u,h;if(c!=r){if(i.root===i){const f=i.document?a.version:null;h=new RootAttributeOperation(i,t,c,r,f)}else{u=new Range2(Position2._createBefore(i),e.createPositionAfter(i));const f=u.root.document?a.version:null;h=new AttributeOperation(u,t,c,r,f)}e.batch.addOperation(h),o.applyOperation(h)}}function applyMarkerOperation(e,t,r,i,o){const a=e.model,c=a.document,u=new MarkerOperation(t,r,i,a.markers,!!o,c.version);e.batch.addOperation(u),a.applyOperation(u)}function applyRemoveOperation(e,t,r,i){let o;if(e.root.document){const a=i.document,c=new Position2(a.graveyard,[0]);o=new MoveOperation(e,t,c,a.version)}else o=new DetachOperation(e,t);r.addOperation(o),i.applyOperation(o)}function isSameTree(e,t){return e===t||e instanceof RootElement&&t instanceof RootElement}function deleteContent(e,t,r={}){if(t.isCollapsed)return;const i=t.getFirstRange();if(i.root.rootName=="$graveyard")return;const o=e.schema;e.change(a=>{if(!r.doNotResetEntireContent&&shouldEntireContentBeReplacedWithParagraph(o,t)){replaceEntireContentWithParagraph(a,t);return}const c={};if(!r.doNotAutoparagraph){const d=t.getSelectedElement();d&&Object.assign(c,o.getAttributesWithProperty(d,"copyOnReplace",!0))}const[u,h]=getLivePositionsForSelectedBlocks(i);u.isTouching(h)||a.remove(a.createRange(u,h)),r.leaveUnmerged||(mergeBranches(a,u,h),o.removeDisallowedAttributes(u.parent.getChildren(),a)),collapseSelectionAt(a,t,u),!r.doNotAutoparagraph&&shouldAutoparagraph(o,u)&&insertParagraph(a,u,t,c),u.detach(),h.detach()})}function getLivePositionsForSelectedBlocks(e){const t=e.root.document.model,r=e.start;let i=e.end;if(t.hasContent(e,{ignoreMarkers:!0})){const o=getParentBlock(i);if(o&&i.isTouching(t.createPositionAt(o,0))){const a=t.createSelection(e);t.modifySelection(a,{direction:"backward"});const c=a.getLastPosition(),u=t.createRange(c,i);t.hasContent(u,{ignoreMarkers:!0})||(i=c)}}return[LivePosition.fromPosition(r,"toPrevious"),LivePosition.fromPosition(i,"toNext")]}function getParentBlock(e){const t=e.parent,r=t.root.document.model.schema,i=t.getAncestors({parentFirst:!0,includeSelf:!0});for(const o of i){if(r.isLimit(o))return null;if(r.isBlock(o))return o}}function mergeBranches(e,t,r){const i=e.model;if(!checkShouldMerge(e.model.schema,t,r))return;const[o,a]=getAncestorsJustBelowCommonAncestor(t,r);!o||!a||(!i.hasContent(o,{ignoreMarkers:!0})&&i.hasContent(a,{ignoreMarkers:!0})?mergeBranchesRight(e,t,r,o.parent):mergeBranchesLeft(e,t,r,o.parent))}function mergeBranchesLeft(e,t,r,i){const o=t.parent,a=r.parent;if(!(o==i||a==i)){for(t=e.createPositionAfter(o),r=e.createPositionBefore(a),r.isEqual(t)||e.insert(a,t),e.merge(t);r.parent.isEmpty;){const c=r.parent;r=e.createPositionBefore(c),e.remove(c)}checkShouldMerge(e.model.schema,t,r)&&mergeBranchesLeft(e,t,r,i)}}function mergeBranchesRight(e,t,r,i){const o=t.parent,a=r.parent;if(!(o==i||a==i)){for(t=e.createPositionAfter(o),r=e.createPositionBefore(a),r.isEqual(t)||e.insert(o,r);t.parent.isEmpty;){const c=t.parent;t=e.createPositionBefore(c),e.remove(c)}r=e.createPositionBefore(a),mergeRight(e,r),checkShouldMerge(e.model.schema,t,r)&&mergeBranchesRight(e,t,r,i)}}function mergeRight(e,t){const r=t.nodeBefore,i=t.nodeAfter;r.name!=i.name&&e.rename(r,i.name),e.clearAttributes(r),e.setAttributes(Object.fromEntries(i.getAttributes()),r),e.merge(t)}function checkShouldMerge(e,t,r){const i=t.parent,o=r.parent;return i==o||e.isLimit(i)||e.isLimit(o)?!1:isCrossingLimitElement(t,r,e)}function getAncestorsJustBelowCommonAncestor(e,t){const r=e.getAncestors(),i=t.getAncestors();let o=0;for(;r[o]&&r[o]==i[o];)o++;return[r[o],i[o]]}function shouldAutoparagraph(e,t){const r=e.checkChild(t,"$text"),i=e.checkChild(t,"paragraph");return!r&&i}function isCrossingLimitElement(e,t,r){const i=new Range2(e,t);for(const o of i.getWalker())if(r.isLimit(o.item))return!1;return!0}function insertParagraph(e,t,r,i={}){const o=e.createElement("paragraph");e.model.schema.setAllowedAttributes(o,i,e),e.insert(o,t),collapseSelectionAt(e,r,e.createPositionAt(o,0))}function replaceEntireContentWithParagraph(e,t){const r=e.model.schema.getLimitElement(t);e.remove(e.createRangeIn(r)),insertParagraph(e,e.createPositionAt(r,0),t)}function shouldEntireContentBeReplacedWithParagraph(e,t){const r=e.getLimitElement(t);if(!t.containsEntireContent(r))return!1;const i=t.getFirstRange();return i.start.parent==i.end.parent?!1:e.checkChild(r,"paragraph")}function collapseSelectionAt(e,t,r){t instanceof DocumentSelection2?e.setSelection(r):t.setTo(r)}function getSelectedContent(e,t){return e.change(r=>{const i=r.createDocumentFragment(),o=t.getFirstRange();if(!o||o.isCollapsed)return i;const a=o.start.root,c=o.start.getCommonPath(o.end),u=a.getNodeByPath(c);let h;o.start.parent==o.end.parent?h=o:h=r.createRange(r.createPositionAt(u,o.start.path[c.length]),r.createPositionAt(u,o.end.path[c.length]+1));const d=h.end.offset-h.start.offset;for(const f of h.getItems({shallow:!0}))f.is("$textProxy")?r.appendText(f.data,f.getAttributes(),i):r.append(r.cloneElement(f,!0),i);if(h!=o){const f=o._getTransformedByMove(h.start,r.createPositionAt(i,0),d)[0],m=r.createRange(r.createPositionAt(i,0),f.start),g=r.createRange(f.end,r.createPositionAt(i,"end"));removeRangeContent(g,r),removeRangeContent(m,r)}return i})}function removeRangeContent(e,t){const r=[];Array.from(e.getItems({direction:"backward"})).map(i=>t.createRangeOn(i)).filter(i=>(i.start.isAfter(e.start)||i.start.isEqual(e.start))&&(i.end.isBefore(e.end)||i.end.isEqual(e.end))).forEach(i=>{r.push(i.start.parent),t.remove(i)}),r.forEach(i=>{let o=i;for(;o.parent&&o.isEmpty;){const a=t.createRangeOn(o);o=o.parent,t.remove(a)}})}function insertContent(e,t,r){return e.change(i=>{const o=r||e.document.selection;o.isCollapsed||e.deleteContent(o,{doNotAutoparagraph:!0});const a=new Insertion(e,i,o.anchor),c=[];let u;if(t.is("documentFragment")){if(t.markers.size){const f=[];for(const[m,g]of t.markers){const{start:v,end:_}=g,b=v.isEqual(_);f.push({position:v,name:m,isCollapsed:b},{position:_,name:m,isCollapsed:b})}f.sort(({position:m},{position:g})=>m.isBefore(g)?1:-1);for(const{position:m,name:g,isCollapsed:v}of f){let _=null,b=null;const S=m.parent===t&&m.isAtStart,R=m.parent===t&&m.isAtEnd;!S&&!R?(_=i.createElement("$marker"),i.insert(_,m)):v&&(b=S?"start":"end"),c.push({name:g,element:_,collapsed:b})}}u=t.getChildren()}else u=[t];a.handleNodes(u);let h=a.getSelectionRange();if(t.is("documentFragment")&&c.length){const f=h?LiveRange.fromRange(h):null,m={};for(let g=c.length-1;g>=0;g--){const{name:v,element:_,collapsed:b}=c[g],S=!m[v];if(S&&(m[v]=[]),_){const R=i.createPositionAt(_,"before");m[v].push(R),i.remove(_)}else{const R=a.getAffectedRange();if(!R){b&&m[v].push(a.position);continue}b?m[v].push(R[b]):m[v].push(S?R.start:R.end)}}for(const[g,[v,_]]of Object.entries(m))v&&_&&v.root===_.root&&v.root.document&&!i.model.markers.has(g)&&i.addMarker(g,{usingOperation:!0,affectsData:!0,range:new Range2(v,_)});f&&(h=f.toRange(),f.detach())}h&&(o instanceof DocumentSelection2?i.setSelection(h):o.setTo(h));const d=a.getAffectedRange()||e.createRange(o.anchor);return a.destroy(),d})}var Insertion=class{model;writer;position;canMergeWith;schema;_documentFragment;_documentFragmentPosition;_firstNode=null;_lastNode=null;_lastAutoParagraph=null;_filterAttributesOf=[];_affectedStart=null;_affectedEnd=null;_nodeToSelect=null;constructor(e,t,r){this.model=e,this.writer=t,this.position=r,this.canMergeWith=new Set([this.position.parent]),this.schema=e.schema,this._documentFragment=t.createDocumentFragment(),this._documentFragmentPosition=t.createPositionAt(this._documentFragment,0)}handleNodes(e){for(const t of Array.from(e))this._handleNode(t);this._insertPartialFragment(),this._lastAutoParagraph&&this._updateLastNodeFromAutoParagraph(this._lastAutoParagraph),this._mergeOnRight(),this.schema.removeDisallowedAttributes(this._filterAttributesOf,this.writer),this._filterAttributesOf=[]}_updateLastNodeFromAutoParagraph(e){const t=this.writer.createPositionAfter(this._lastNode),r=this.writer.createPositionAfter(e);if(r.isAfter(t)){if(this._lastNode=e,this.position.parent!=e||!this.position.isAtEnd)throw new CKEditorError("insertcontent-invalid-insertion-position",this);this.position=r,this._setAffectedBoundaries(this.position)}}getSelectionRange(){return this._nodeToSelect?Range2._createOn(this._nodeToSelect):this.model.schema.getNearestSelectionRange(this.position)}getAffectedRange(){return this._affectedStart?new Range2(this._affectedStart,this._affectedEnd):null}destroy(){this._affectedStart&&this._affectedStart.detach(),this._affectedEnd&&this._affectedEnd.detach()}_handleNode(e){if(!this._checkAndSplitToAllowedPosition(e)){this.schema.isObject(e)||this._handleDisallowedNode(e);return}this._appendToFragment(e),this._firstNode||(this._firstNode=e),this._lastNode=e}_insertPartialFragment(){if(this._documentFragment.isEmpty)return;const e=LivePosition.fromPosition(this.position,"toNext");this._setAffectedBoundaries(this.position),this._documentFragment.getChild(0)==this._firstNode&&(this.writer.insert(this._firstNode,this.position),this._mergeOnLeft(),this.position=e.toPosition()),this._documentFragment.isEmpty||this.writer.insert(this._documentFragment,this.position),this._documentFragmentPosition=this.writer.createPositionAt(this._documentFragment,0),this.position=e.toPosition(),e.detach()}_handleDisallowedNode(e){e.is("element")&&this.handleNodes(e.getChildren())}_appendToFragment(e){if(!this.schema.checkChild(this.position,e))throw new CKEditorError("insertcontent-wrong-position",this,{node:e,position:this.position});this.writer.insert(e,this._documentFragmentPosition),this._documentFragmentPosition=this._documentFragmentPosition.getShiftedBy(e.offsetSize),this.schema.isObject(e)&&!this.schema.checkChild(this.position,"$text")?this._nodeToSelect=e:this._nodeToSelect=null,this._filterAttributesOf.push(e)}_setAffectedBoundaries(e){this._affectedStart||(this._affectedStart=LivePosition.fromPosition(e,"toPrevious")),(!this._affectedEnd||this._affectedEnd.isBefore(e))&&(this._affectedEnd&&this._affectedEnd.detach(),this._affectedEnd=LivePosition.fromPosition(e,"toNext"))}_mergeOnLeft(){const e=this._firstNode;if(!(e instanceof Element4)||!this._canMergeLeft(e))return;const t=LivePosition._createBefore(e);t.stickiness="toNext";const r=LivePosition.fromPosition(this.position,"toNext");this._affectedStart.isEqual(t)&&(this._affectedStart.detach(),this._affectedStart=LivePosition._createAt(t.nodeBefore,"end","toPrevious")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.isEqual(this._affectedEnd)&&this._firstNode===this._lastNode&&(this._affectedEnd.detach(),this._affectedEnd=LivePosition._createAt(t.nodeBefore,"end","toNext")),this.position=r.toPosition(),r.detach(),this._filterAttributesOf.push(this.position.parent),t.detach()}_mergeOnRight(){const e=this._lastNode;if(!(e instanceof Element4)||!this._canMergeRight(e))return;const t=LivePosition._createAfter(e);if(t.stickiness="toNext",!this.position.isEqual(t))throw new CKEditorError("insertcontent-invalid-insertion-position",this);this.position=Position2._createAt(t.nodeBefore,"end");const r=LivePosition.fromPosition(this.position,"toPrevious");this._affectedEnd.isEqual(t)&&(this._affectedEnd.detach(),this._affectedEnd=LivePosition._createAt(t.nodeBefore,"end","toNext")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.getShiftedBy(-1).isEqual(this._affectedStart)&&this._firstNode===this._lastNode&&(this._affectedStart.detach(),this._affectedStart=LivePosition._createAt(t.nodeBefore,0,"toPrevious")),this.position=r.toPosition(),r.detach(),this._filterAttributesOf.push(this.position.parent),t.detach()}_canMergeLeft(e){const t=e.previousSibling;return t instanceof Element4&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(t,e)}_canMergeRight(e){const t=e.nextSibling;return t instanceof Element4&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(e,t)}_insertAutoParagraph(){this._insertPartialFragment();const e=this.writer.createElement("paragraph");this.writer.insert(e,this.position),this._setAffectedBoundaries(this.position),this._lastAutoParagraph=e,this.position=this.writer.createPositionAt(e,0)}_checkAndSplitToAllowedPosition(e){const t=this._getAllowedIn(this.position.parent,e);if(!t)return!1;for(t!=this.position.parent&&this._insertPartialFragment();t!=this.position.parent;)if(this.position.isAtStart){const r=this.position.parent;this.position=this.writer.createPositionBefore(r),r.isEmpty&&r.parent===t&&this.writer.remove(r)}else if(this.position.isAtEnd)this.position=this.writer.createPositionAfter(this.position.parent);else{const r=this.writer.createPositionAfter(this.position.parent);this._setAffectedBoundaries(this.position),this.writer.split(this.position),this.position=r,this.canMergeWith.add(this.position.nodeAfter)}return this.schema.checkChild(this.position.parent,e)||this._insertAutoParagraph(),!0}_getAllowedIn(e,t){return this.schema.checkChild(e,t)||this.schema.checkChild(e,"paragraph")&&this.schema.checkChild("paragraph",t)?e:this.schema.isLimit(e)?null:this._getAllowedIn(e.parent,t)}};function insertObject(e,t,r,i={}){if(!e.schema.isObject(t))throw new CKEditorError("insertobject-element-not-an-object",e,{object:t});const o=r||e.document.selection;let a=o;i.findOptimalPosition&&e.schema.isBlock(t)&&(a=e.createSelection(e.schema.findOptimalInsertionRange(o,i.findOptimalPosition)));const c=first(o.getSelectedBlocks()),u={};return c&&Object.assign(u,e.schema.getAttributesWithProperty(c,"copyOnReplace",!0)),e.change(h=>{a.isCollapsed||e.deleteContent(a,{doNotAutoparagraph:!0});let d=t;const f=a.anchor.parent;!e.schema.checkChild(f,t)&&e.schema.checkChild(f,"paragraph")&&e.schema.checkChild("paragraph",t)&&(d=h.createElement("paragraph"),h.insert(t,d)),e.schema.setAllowedAttributes(d,u,h);const m=e.insertContent(d,a);return m.isCollapsed||i.setSelection&&updateSelection(h,t,i.setSelection,u),m})}function updateSelection(e,t,r,i){const o=e.model;if(r=="on"){e.setSelection(t,"on");return}if(r!="after")throw new CKEditorError("insertobject-invalid-place-parameter-value",o);let a=t.nextSibling;if(o.schema.isInline(t)){e.setSelection(t,"after");return}!(a&&o.schema.checkChild(a,"$text"))&&o.schema.checkChild(t.parent,"paragraph")&&(a=e.createElement("paragraph"),o.schema.setAllowedAttributes(a,i,e),o.insertContent(a,e.createPositionAfter(t))),a&&e.setSelection(a,0)}var wordBoundaryCharacters=' ,.?!:;"-()';function modifySelection(e,t,r={}){const i=e.schema,o=r.direction!="backward",a=r.unit?r.unit:"character",c=!!r.treatEmojiAsSingleUnit,u=t.focus,h=new TreeWalker2({boundaries:getSearchRange(u,o),singleCharacters:!0,direction:o?"forward":"backward"}),d={walker:h,schema:i,isForward:o,unit:a,treatEmojiAsSingleUnit:c};let f;for(;f=h.next();){if(f.done)return;const m=tryExtendingTo(d,f.value);if(m){t instanceof DocumentSelection2?e.change(g=>{g.setSelectionFocus(m)}):t.setFocus(m);return}}}function tryExtendingTo(e,t){const{isForward:r,walker:i,unit:o,schema:a,treatEmojiAsSingleUnit:c}=e,{type:u,item:h,nextPosition:d}=t;if(u=="text")return e.unit==="word"?getCorrectWordBreakPosition(i,r):getCorrectPosition(i,o,c);if(u==(r?"elementStart":"elementEnd")){if(a.isSelectable(h))return Position2._createAt(h,r?"after":"before");if(a.checkChild(d,"$text"))return d}else{if(a.isLimit(h)){i.skip(()=>!0);return}if(a.checkChild(d,"$text"))return d}}function getCorrectPosition(e,t,r){const i=e.position.textNode;if(i){const o=i.data;let a=e.position.offset-i.startOffset;for(;isInsideSurrogatePair(o,a)||t=="character"&&isInsideCombinedSymbol(o,a)||r&&isInsideEmojiSequence(o,a);)e.next(),a=e.position.offset-i.startOffset}return e.position}function getCorrectWordBreakPosition(e,t){let r=e.position.textNode;for(r||(r=t?e.position.nodeAfter:e.position.nodeBefore);r&&r.is("$text");){const i=e.position.offset-r.startOffset;if(isAtNodeBoundary(r,i,t))r=t?e.position.nodeAfter:e.position.nodeBefore;else{if(isAtWordBoundary(r.data,i,t))break;e.next()}}return e.position}function getSearchRange(e,t){const r=e.root,i=Position2._createAt(r,t?"end":0);return t?new Range2(e,i):new Range2(i,e)}function isAtWordBoundary(e,t,r){const i=t+(r?0:-1);return wordBoundaryCharacters.includes(e.charAt(i))}function isAtNodeBoundary(e,t,r){return t===(r?e.offsetSize:0)}var Model=class extends ObservableMixin(){markers;document;schema;_pendingChanges;_currentWriter;constructor(){super(),this.markers=new MarkerCollection,this.document=new Document2(this),this.schema=new Schema,this._pendingChanges=[],this._currentWriter=null,["deleteContent","modifySelection","getSelectedContent","applyOperation"].forEach(e=>this.decorate(e)),this.on("applyOperation",(e,t)=>{t[0]._validate()},{priority:"highest"}),this.schema.register("$root",{isLimit:!0}),this.schema.register("$container",{allowIn:["$root","$container"]}),this.schema.register("$block",{allowIn:["$root","$container"],isBlock:!0}),this.schema.register("$blockObject",{allowWhere:"$block",isBlock:!0,isObject:!0}),this.schema.register("$inlineObject",{allowWhere:"$text",allowAttributesOf:"$text",isInline:!0,isObject:!0}),this.schema.register("$text",{allowIn:"$block",isInline:!0,isContent:!0}),this.schema.register("$clipboardHolder",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$documentFragment",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$marker"),this.schema.addChildCheck(()=>!0,"$marker"),injectSelectionPostFixer(this),this.document.registerPostFixer(autoParagraphEmptyRoots),this.on("insertContent",(e,[t,r])=>{e.return=insertContent(this,t,r)}),this.on("insertObject",(e,[t,r,i])=>{e.return=insertObject(this,t,r,i)}),this.on("canEditAt",e=>{const t=!this.document.isReadOnly;e.return=t,t||e.stop()})}change(e){try{return this._pendingChanges.length===0?(this._pendingChanges.push({batch:new Batch,callback:e}),this._runPendingChanges()[0]):e(this._currentWriter)}catch(t){CKEditorError.rethrowUnexpectedError(t,this)}}enqueueChange(e,t){try{e?typeof e=="function"?(t=e,e=new Batch):e instanceof Batch||(e=new Batch(e)):e=new Batch,this._pendingChanges.push({batch:e,callback:t}),this._pendingChanges.length==1&&this._runPendingChanges()}catch(r){CKEditorError.rethrowUnexpectedError(r,this)}}applyOperation(e){e._execute()}insertContent(e,t,r,...i){const o=normalizeSelectable(t,r);return this.fire("insertContent",[e,o,r,...i])}insertObject(e,t,r,i,...o){const a=normalizeSelectable(t,r);return this.fire("insertObject",[e,a,i,i,...o])}deleteContent(e,t){deleteContent(this,e,t)}modifySelection(e,t){modifySelection(this,e,t)}getSelectedContent(e){return getSelectedContent(this,e)}hasContent(e,t={}){const r=e instanceof Range2?e:Range2._createIn(e);if(r.isCollapsed)return!1;const{ignoreWhitespaces:i=!1,ignoreMarkers:o=!1}=t;if(!o){for(const a of this.markers.getMarkersIntersectingRange(r))if(a.affectsData)return!0}for(const a of r.getItems())if(this.schema.isContent(a))if(a.is("$textProxy"))if(i){if(a.data.search(/\S/)!==-1)return!0}else return!0;else return!0;return!1}canEditAt(e){const t=normalizeSelectable(e);return this.fire("canEditAt",[t])}createPositionFromPath(e,t,r){return new Position2(e,t,r)}createPositionAt(e,t){return Position2._createAt(e,t)}createPositionAfter(e){return Position2._createAfter(e)}createPositionBefore(e){return Position2._createBefore(e)}createRange(e,t){return new Range2(e,t)}createRangeIn(e){return Range2._createIn(e)}createRangeOn(e){return Range2._createOn(e)}createSelection(...e){return new Selection6(...e)}createBatch(e){return new Batch(e)}createOperationFromJSON(e){return OperationFactory.fromJSON(e,this.document)}destroy(){this.document.destroy(),this.stopListening()}_runPendingChanges(){const e=[];this.fire("_beforeChanges");try{for(;this._pendingChanges.length;){const t=this._pendingChanges[0].batch;this._currentWriter=new Writer(this,t);const r=this._pendingChanges[0].callback(this._currentWriter);e.push(r),this.document._handleChangeBlock(this._currentWriter),this._pendingChanges.shift(),this._currentWriter=null}}finally{this._pendingChanges.length=0,this._currentWriter=null,this.fire("_afterChanges")}return e}};function normalizeSelectable(e,t){if(e)return e instanceof Selection6||e instanceof DocumentSelection2?e:e instanceof Node$1?t||t===0?new Selection6(e,t):e.is("rootElement")?new Selection6(e,"in"):new Selection6(e,"on"):new Selection6(e)}var MouseObserver=class extends DomEventObserver{domEventType=["mousedown","mouseup","mouseover","mouseout"];onDomEvent(e){this.fire(e.type,e)}},HEX_COLOR_REGEXP=/^#([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/i,RGB_COLOR_REGEXP=/^rgb\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}[0-9]{1,3}[ %]?\)$/i,RGBA_COLOR_REGEXP=/^rgba\([ ]?([0-9]{1,3}[ %]?,[ ]?){3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,HSL_COLOR_REGEXP=/^hsl\([ ]?([0-9]{1,3}[ %]?[,]?[ ]*){3}(1|[0-9]+%|[0]?\.?[0-9]+)?\)$/i,HSLA_COLOR_REGEXP=/^hsla\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,CSS_SHORTHAND_VALUE_REGEXP=/\w+\((?:[^()]|\([^()]*\))*\)|\S+/gi,COLOR_NAMES=new Set(["black","silver","gray","white","maroon","red","purple","fuchsia","green","lime","olive","yellow","navy","blue","teal","aqua","orange","aliceblue","antiquewhite","aquamarine","azure","beige","bisque","blanchedalmond","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","gainsboro","ghostwhite","gold","goldenrod","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","limegreen","linen","magenta","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","oldlace","olivedrab","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","thistle","tomato","turquoise","violet","wheat","whitesmoke","yellowgreen","activeborder","activecaption","appworkspace","background","buttonface","buttonhighlight","buttonshadow","buttontext","captiontext","graytext","highlight","highlighttext","inactiveborder","inactivecaption","inactivecaptiontext","infobackground","infotext","menu","menutext","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","window","windowframe","windowtext","rebeccapurple","currentcolor","transparent"]);function isColor(e){return e.startsWith("#")?HEX_COLOR_REGEXP.test(e):e.startsWith("rgb")?RGB_COLOR_REGEXP.test(e)||RGBA_COLOR_REGEXP.test(e):e.startsWith("hsl")?HSL_COLOR_REGEXP.test(e)||HSLA_COLOR_REGEXP.test(e):COLOR_NAMES.has(e.toLowerCase())}var lengthRegExp=/^([+-]?[0-9]*([.][0-9]+)?(px|cm|mm|in|pc|pt|ch|em|ex|rem|vh|vw|vmin|vmax)|0)$/;function isLength2(e){return lengthRegExp.test(e)}var PERCENTAGE_VALUE_REGEXP=/^[+-]?[0-9]*([.][0-9]+)?%$/;function isPercentage(e){return PERCENTAGE_VALUE_REGEXP.test(e)}var repeatValues=["repeat-x","repeat-y","repeat","space","round","no-repeat"];function isRepeat(e){return repeatValues.includes(e)}var positionValues=["center","top","bottom","left","right"];function isPosition(e){return positionValues.includes(e)}var attachmentValues=["fixed","scroll","local"];function isAttachment(e){return attachmentValues.includes(e)}var urlRegExp=/^url\(/;function isURL(e){return urlRegExp.test(e)}function getShorthandValues(e){const t=e.trim().slice(0,1500).matchAll(CSS_SHORTHAND_VALUE_REGEXP);return Array.from(t).map(r=>r[0])}function addBackgroundRules(e){e.setNormalizer("background",getBackgroundNormalizer()),e.setNormalizer("background-color",getBackgroundColorNormalizer()),e.setReducer("background",getBackgroundReducer()),e.setStyleRelation("background",["background-color"])}function getBackgroundNormalizer(){return e=>{const t={},r=getShorthandValues(e);for(const i of r)isRepeat(i)?(t.repeat=t.repeat||[],t.repeat.push(i)):isPosition(i)?(t.position=t.position||[],t.position.push(i)):isAttachment(i)?t.attachment=i:isColor(i)?t.color=i:isURL(i)&&(t.image=i);return{path:"background",value:t}}}function getBackgroundColorNormalizer(){return e=>({path:"background.color",value:e})}function getBackgroundReducer(){return e=>{const t=[];return t.push(["background-color",e.color]),t}}var ELEMENT_RANGE_START_TOKEN="[",ELEMENT_RANGE_END_TOKEN="]",TEXT_RANGE_START_TOKEN="{",TEXT_RANGE_END_TOKEN="}",allowedTypes={container:ContainerElement,attribute:AttributeElement,empty:EmptyElement,ui:UIElement,raw:RawElement},domConverterStub={setContentOf:(e,t)=>{e.innerHTML=t}};function getData$1(e,t={}){if(!(e instanceof View))throw new TypeError("View needs to be an instance of module:engine/view/view~View.");const r=e.document,i=!!t.withoutSelection,o=t.rootName||"main",a=r.getRoot(o),c={showType:t.showType,showPriority:t.showPriority,renderUIElements:t.renderUIElements,renderRawElements:t.renderRawElements,ignoreRoot:!0,domConverter:t.domConverter};return i?getData$1._stringify(a,null,c):getData$1._stringify(a,r.selection,c)}getData$1._stringify=stringify$1;function setData$1(e,t,r={}){if(!(e instanceof View))throw new TypeError("View needs to be an instance of module:engine/view/view~View.");const i=e.document,o=r.rootName||"main",a=i.getRoot(o);e.change(c=>{const u=setData$1._parse(t,{rootElement:a});u.view&&u.selection&&c.setSelection(u.selection)})}setData$1._parse=parse$1;function stringify$1(e,t=null,r={}){let i;return t instanceof Position$1||t instanceof Range$1?i=new DocumentSelection$1(t):i=t,new ViewStringify(e,i,r).stringify()}function parse$1(e,t={}){const r=new Document$1(new StylesProcessor);t.order=t.order||[];const i=new RangeParser({sameSelectionCharacters:t.sameSelectionCharacters}),o=new XmlDataProcessor(r,{namespaces:Object.keys(allowedTypes)});t.inlineObjectElements&&o.domConverter.inlineObjectElements.push(...t.inlineObjectElements);let a=o.toView(e);if(a=_convertViewElements(a),t.rootElement){const u=t.rootElement,h=a._removeChildren(0,a.childCount);u._removeChildren(0,u.childCount),u._appendChild(h),a=u}const c=i.parse(a,t.order);if(a.is("documentFragment")&&a.childCount===1&&(a=a.getChild(0)),c.length){const u=new DocumentSelection$1(c,{backward:!!t.lastRangeBackward});return{view:a,selection:u}}return a.parent&&a._remove(),a}var RangeParser=class{sameSelectionCharacters;_positions;constructor(e){this.sameSelectionCharacters=!!e.sameSelectionCharacters}parse(e,t){this._positions=[],this._getPositions(e);let r=this._createRanges();if(t.length){if(t.length!=r.length)throw new Error(`Parse error - there are ${r.length} ranges found, but ranges order array contains ${t.length} elements.`);r=this._sortRanges(r,t)}return r}_getPositions(e){if(e.is("documentFragment")||e.is("element")){const t=[...e.getChildren()];for(const r of t)this._getPositions(r)}if(e.is("$text")){const t=new RegExp(`[${TEXT_RANGE_START_TOKEN}${TEXT_RANGE_END_TOKEN}\\${ELEMENT_RANGE_END_TOKEN}\\${ELEMENT_RANGE_START_TOKEN}]`,"g");let r=e.data,i,o=0;const a=[];for(;i=t.exec(r);){const h=i.index,d=i[0];a.push({bracket:d,textOffset:h-o}),o++}r=r.replace(t,""),e._data=r;const c=e.index,u=e.parent;r||e._remove();for(const h of a)if(r)if(this.sameSelectionCharacters||!this.sameSelectionCharacters&&(h.bracket==TEXT_RANGE_START_TOKEN||h.bracket==TEXT_RANGE_END_TOKEN))this._positions.push({bracket:h.bracket,position:new Position$1(e,h.textOffset)});else{if(!this.sameSelectionCharacters&&h.textOffset!==0&&h.textOffset!==r.length)throw new Error(`Parse error - range delimiter '${h.bracket}' is placed inside text node.`);const d=h.textOffset===0?c:c+1;this._positions.push({bracket:h.bracket,position:new Position$1(u,d)})}else{if(!this.sameSelectionCharacters&&h.bracket==TEXT_RANGE_START_TOKEN||h.bracket==TEXT_RANGE_END_TOKEN)throw new Error(`Parse error - text range delimiter '${h.bracket}' is placed inside empty text node. `);this._positions.push({bracket:h.bracket,position:new Position$1(u,c)})}}}_sortRanges(e,t){const r=[];let i=0;for(const o of t){if(e[o-1]===void 0)throw new Error("Parse error - provided ranges order is invalid.");r[o-1]=e[i],i++}return r}_createRanges(){const e=[];let t=null;for(const r of this._positions){if(!t&&(r.bracket==ELEMENT_RANGE_END_TOKEN||r.bracket==TEXT_RANGE_END_TOKEN))throw new Error(`Parse error - end of range was found '${r.bracket}' but range was not started before.`);if(t&&(r.bracket==ELEMENT_RANGE_START_TOKEN||r.bracket==TEXT_RANGE_START_TOKEN))throw new Error(`Parse error - start of range was found '${r.bracket}' but one range is already started.`);r.bracket==ELEMENT_RANGE_START_TOKEN||r.bracket==TEXT_RANGE_START_TOKEN?t=new Range$1(r.position,r.position):(t.end=r.position,e.push(t),t=null)}if(t!==null)throw new Error("Parse error - range was started but no end delimiter was found.");return e}},ViewStringify=class{root;selection;ranges;showType;showPriority;showAttributeElementId;ignoreRoot;sameSelectionCharacters;renderUIElements;renderRawElements;domConverter;constructor(e,t,r){this.root=e,this.selection=t,this.ranges=[],t&&(this.ranges=[...t.getRanges()]),this.showType=!!r.showType,this.showPriority=!!r.showPriority,this.showAttributeElementId=!!r.showAttributeElementId,this.ignoreRoot=!!r.ignoreRoot,this.sameSelectionCharacters=!!r.sameSelectionCharacters,this.renderUIElements=!!r.renderUIElements,this.renderRawElements=!!r.renderRawElements,this.domConverter=r.domConverter||domConverterStub}stringify(){let e="";return this._walkView(this.root,t=>{e+=t}),e}_walkView(e,t){const r=this.ignoreRoot&&this.root===e;if(e.is("element")||e.is("documentFragment")){if(e.is("element")&&!r&&t(this._stringifyElementOpen(e)),this.renderUIElements&&e.is("uiElement"))t(e.render(document,this.domConverter).innerHTML);else if(this.renderRawElements&&e.is("rawElement")){const i=document.createElement("div");e.render(i,this.domConverter),t(i.innerHTML)}else{let i=0;t(this._stringifyElementRanges(e,i));for(const o of e.getChildren())this._walkView(o,t),i++,t(this._stringifyElementRanges(e,i))}e.is("element")&&!r&&t(this._stringifyElementClose(e))}e.is("$text")&&t(this._stringifyTextRanges(e))}_stringifyElementRanges(e,t){let r="",i="",o="";for(const a of this.ranges)a.start.parent==e&&a.start.offset===t&&(a.isCollapsed?o+=ELEMENT_RANGE_START_TOKEN+ELEMENT_RANGE_END_TOKEN:r+=ELEMENT_RANGE_START_TOKEN),a.end.parent===e&&a.end.offset===t&&!a.isCollapsed&&(i+=ELEMENT_RANGE_END_TOKEN);return i+o+r}_stringifyTextRanges(e){const t=e.data.length,r=e.data.split("");let i,o;this.sameSelectionCharacters?(i=ELEMENT_RANGE_START_TOKEN,o=ELEMENT_RANGE_END_TOKEN):(i=TEXT_RANGE_START_TOKEN,o=TEXT_RANGE_END_TOKEN),r[t]="";const a=r.map(c=>({letter:c,start:"",end:"",collapsed:""}));for(const c of this.ranges){const u=c.start,h=c.end;u.parent==e&&u.offset>=0&&u.offset<=t&&(c.isCollapsed?a[h.offset].collapsed+=i+o:a[u.offset].start+=i),h.parent==e&&h.offset>=0&&h.offset<=t&&!c.isCollapsed&&(a[h.offset].end+=o)}return a.map(c=>c.end+c.collapsed+c.start+c.letter).join("")}_stringifyElementOpen(e){const t=this._stringifyElementPriority(e),r=this._stringifyElementId(e),o=[this._stringifyElementType(e),e.name].filter(u=>u!=="").join(":"),a=this._stringifyElementAttributes(e);return`<${[o,t,r,a].filter(u=>u!=="").join(" ")}>`}_stringifyElementClose(e){return`</${[this._stringifyElementType(e),e.name].filter(i=>i!=="").join(":")}>`}_stringifyElementType(e){if(this.showType){for(const t in allowedTypes)if(e instanceof allowedTypes[t])return t}return""}_stringifyElementPriority(e){return this.showPriority&&e.is("attributeElement")?`view-priority="${e.priority}"`:""}_stringifyElementId(e){return this.showAttributeElementId&&e.is("attributeElement")&&e.id?`view-id="${e.id}"`:""}_stringifyElementAttributes(e){const t=[],r=[...e.getAttributeKeys()].sort();for(const i of r){let o;i==="class"?o=[...e.getClassNames()].sort().join(" "):i==="style"?o=[...e.getStyleNames()].sort().map(a=>`${a}:${e.getStyle(a).replace(/"/g,"&quot;")}`).join(";"):o=e.getAttribute(i),t.push(`${i}="${o}"`)}return t.join(" ")}};function _convertViewElements(e){if(e.is("element")||e.is("documentFragment")){const t=e.is("documentFragment")?new DocumentFragment$1(e.document):_convertElement(e.document,e);for(const r of[...e.getChildren()]){if(t.is("emptyElement"))throw new Error("Parse error - cannot parse inside EmptyElement.");if(t.is("uiElement"))throw new Error("Parse error - cannot parse inside UIElement.");if(t.is("rawElement"))throw new Error("Parse error - cannot parse inside RawElement.");t._appendChild(_convertViewElements(r))}return t}return e}function _convertElement(e,t){const r=_convertElementNameAndInfo(t),i=allowedTypes[r.type],o=i?new i(e,r.name):new Element$1(e,r.name);o.is("attributeElement")&&(r.priority!==null&&(o._priority=r.priority),r.id!==null&&(o._id=r.id));for(const a of t.getAttributeKeys())o._setAttribute(a,t.getAttribute(a));return o}function _convertElementNameAndInfo(e){const t=e.name.split(":"),r=_convertPriority(e.getAttribute("view-priority")),i=e.hasAttribute("view-id")?e.getAttribute("view-id"):null;if(e._removeAttribute("view-priority"),e._removeAttribute("view-id"),t.length==1)return{name:t[0],type:r!==null?"attribute":null,priority:r,id:i};const o=_convertType(t[0]);if(o)return{name:t[1],type:o,priority:r,id:i};throw new Error(`Parse error - cannot parse element's name: ${e.name}.`)}function _convertType(e){return e in allowedTypes?e:null}function _convertPriority(e){const t=parseInt(e,10);return isNaN(t)?null:t}function getData(e,t={}){if(!(e instanceof Model))throw new TypeError("Model needs to be an instance of module:engine/model/model~Model.");const r=t.rootName||"main",i=e.document.getRoot(r);return getData._stringify(i,t.withoutSelection?null:e.document.selection,t.convertMarkers?e.markers:null)}getData._stringify=stringify3;function setData(e,t,r={}){if(!(e instanceof Model))throw new TypeError("Model needs to be an instance of module:engine/model/model~Model.");let i,o=null;const a=e.document.getRoot(r.rootName||"main"),c=setData._parse(t,e.schema,{lastRangeBackward:r.lastRangeBackward,selectionAttributes:r.selectionAttributes,context:[a.name],inlineObjectElements:r.inlineObjectElements});"model"in c?(i=c.model,o=c.selection):i=c,r.batchType!==void 0?e.enqueueChange(r.batchType,u):e.change(u);function u(h){if(h.remove(h.createRangeIn(a)),h.insert(i,a),h.setSelection(null),h.removeSelectionAttribute(e.document.selection.getAttributeKeys()),o){const d=[];for(const f of o.getRanges()){const m=new Position2(a,f.start.path),g=new Position2(a,f.end.path);d.push(new Range2(m,g))}h.setSelection(d,{backward:o.isBackward}),r.selectionAttributes&&h.setSelectionAttribute(o.getAttributes())}}}setData._parse=parse4;function stringify3(e,t=null,r=null){const i=new Model,o=new Mapper;let a=null,c;if(e instanceof RootElement||e instanceof DocumentFragment2)c=i.createRangeIn(e);else if(e.parent)c=new Range2(i.createPositionBefore(e),i.createPositionAfter(e));else{const b=new DocumentFragment2(e);c=i.createRangeIn(b)}t instanceof Selection6||t instanceof DocumentSelection2?a=t:t instanceof Range2?a=new Selection6(t):t instanceof Position2&&(a=new Selection6(t));const u=new StylesProcessor,h=new View(u),d=h.document,f=new RootEditableElement(d,"div");f.rootName="main",d.roots.add(f);const m=new DowncastDispatcher({mapper:o,schema:i.schema});o.bindElements(e.root,f),m.on("insert:$text",insertText()),m.on("insert",insertAttributesAndChildren(),{priority:"lowest"}),m.on("attribute",(b,S,R)=>{(S.item instanceof Selection6||S.item instanceof DocumentSelection2||S.item.is("$textProxy"))&&wrap((I,{writer:E})=>E.createAttributeElement("model-text-with-attributes",{[S.attributeKey]:stringifyAttributeValue(I)}))(b,S,R)}),m.on("insert",insertElement(b=>{const S=convertAttributes(b.getAttributes(),stringifyAttributeValue);return new ContainerElement(d,b.name,S)})),m.on("selection",convertRangeSelection()),m.on("selection",convertCollapsedSelection()),m.on("addMarker",insertUIElement((b,{writer:S})=>{const R=b.markerName+":"+(b.isOpening?"start":"end");return S.createUIElement(R)}));const g=new Map;if(r)for(const b of Array.from(r).sort((S,R)=>S.name<R.name?1:-1))g.set(b.name,b.getRange());const v=h._writer;m.convert(c,g,v),a&&m.convertSelection(a,r||i.markers,v);let _=stringify$1(f,d.selection,{sameSelectionCharacters:!0});return _=_.substr(5,_.length-11),h.destroy(),_.replace(new RegExp("model-text-with-attributes","g"),"$text")}function parse4(e,t,r={}){const i=new Mapper;e=e.replace(new RegExp("\\$text","g"),"model-text-with-attributes");const o=parse$1(e,{sameSelectionCharacters:!0,lastRangeBackward:!!r.lastRangeBackward,inlineObjectElements:r.inlineObjectElements});let a,c=null,u=null;"view"in o&&"selection"in o?(a=o.view,c=o.selection):a=o;const h=new Model,d=new UpcastDispatcher({schema:t});d.on("documentFragment",convertToModelFragment(i)),d.on("element:model-text-with-attributes",convertToModelText()),d.on("element",convertToModelElement(i)),d.on("text",convertToModelText());let f=h.change(m=>d.convert(a.root,m,r.context||"$root"));if(i.bindElements(f,a.root),f.childCount==1&&(f=f.getChild(0)),c){const m=[];for(const g of c.getRanges())m.push(i.toModelRange(g));u=new Selection6(m,{backward:c.isBackward});for(const[g,v]of toMap(r.selectionAttributes||[]))u.setAttribute(g,v)}return u?{model:f,selection:u}:f}function convertToModelFragment(e){return(t,r,i)=>{const o=i.convertChildren(r.viewItem,r.modelCursor);e.bindElements(r.modelCursor.parent,r.viewItem),r=Object.assign(r,o),t.stop()}}function convertToModelElement(e){return(t,r,i)=>{const o=r.viewItem.name;if(!i.schema.checkChild(r.modelCursor,o))throw new Error(`Element '${o}' was not allowed in given position.`);const a=convertAttributes(r.viewItem.getAttributes(),parseAttributeValue),c=i.writer.createElement(r.viewItem.name,a);i.writer.insert(c,r.modelCursor),e.bindElements(c,r.viewItem),i.convertChildren(r.viewItem,c),r.modelRange=Range2._createOn(c),r.modelCursor=r.modelRange.end,t.stop()}}function convertToModelText(){return(e,t,r)=>{if(!r.schema.checkChild(t.modelCursor,"$text"))throw new Error("Text was not allowed in given position.");let i;if(t.viewItem.is("element")){const o=convertAttributes(t.viewItem.getAttributes(),parseAttributeValue),a=t.viewItem.getChild(0);i=r.writer.createText(a.data,o)}else i=r.writer.createText(t.viewItem.data);r.writer.insert(i,t.modelCursor),t.modelRange=Range2._createFromPositionAndShift(t.modelCursor,i.offsetSize),t.modelCursor=t.modelRange.end,e.stop()}}function parseAttributeValue(e){try{return JSON.parse(e)}catch{return e}}function stringifyAttributeValue(e){return isPlainObject_default(e)?JSON.stringify(e):e}function*convertAttributes(e,t){for(const[r,i]of e)yield[r,t(i)]}var Watchdog=class{crashes=[];state="initializing";_crashNumberLimit;_now=Date.now;_minimumNonErrorTimePeriod;_boundErrorHandler;_listeners;constructor(e){if(this.crashes=[],this._crashNumberLimit=typeof e.crashNumberLimit=="number"?e.crashNumberLimit:3,this._minimumNonErrorTimePeriod=typeof e.minimumNonErrorTimePeriod=="number"?e.minimumNonErrorTimePeriod:5e3,this._boundErrorHandler=t=>{const r="error"in t?t.error:t.reason;r instanceof Error&&this._handleError(r,t)},this._listeners={},!this._restart)throw new Error("The Watchdog class was split into the abstract `Watchdog` class and the `EditorWatchdog` class. Please, use `EditorWatchdog` if you have used the `Watchdog` class previously.")}destroy(){this._stopErrorHandling(),this._listeners={}}on(e,t){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t)}off(e,t){this._listeners[e]=this._listeners[e].filter(r=>r!==t)}_fire(e,...t){const r=this._listeners[e]||[];for(const i of r)i.apply(this,[null,...t])}_startErrorHandling(){window.addEventListener("error",this._boundErrorHandler),window.addEventListener("unhandledrejection",this._boundErrorHandler)}_stopErrorHandling(){window.removeEventListener("error",this._boundErrorHandler),window.removeEventListener("unhandledrejection",this._boundErrorHandler)}_handleError(e,t){if(this._shouldReactToError(e)){this.crashes.push({message:e.message,stack:e.stack,filename:t instanceof ErrorEvent?t.filename:void 0,lineno:t instanceof ErrorEvent?t.lineno:void 0,colno:t instanceof ErrorEvent?t.colno:void 0,date:this._now()});const r=this._shouldRestart();this.state="crashed",this._fire("stateChange"),this._fire("error",{error:e,causesRestart:r}),r?this._restart():(this.state="crashedPermanently",this._fire("stateChange"))}}_shouldReactToError(e){return e.is&&e.is("CKEditorError")&&e.context!==void 0&&e.context!==null&&this.state==="ready"&&this._isErrorComingFromThisItem(e)}_shouldRestart(){if(this.crashes.length<=this._crashNumberLimit)return!0;const e=this.crashes[this.crashes.length-1].date,t=this.crashes[this.crashes.length-1-this._crashNumberLimit].date;return(e-t)/this._crashNumberLimit>this._minimumNonErrorTimePeriod}};function getSubNodes(e,t=new Set){const r=[e],i=new Set;let o=0;for(;r.length>o;){const a=r[o++];if(!(i.has(a)||!shouldNodeBeIncluded(a)||t.has(a)))if(i.add(a),Symbol.iterator in a)try{for(const c of a)r.push(c)}catch{}else for(const c in a)c!=="defaultValue"&&r.push(a[c])}return i}function shouldNodeBeIncluded(e){const t=Object.prototype.toString.call(e),r=typeof e;return!(r==="number"||r==="boolean"||r==="string"||r==="symbol"||r==="function"||t==="[object Date]"||t==="[object RegExp]"||t==="[object Module]"||e===void 0||e===null||e._watchdogExcluded||e instanceof EventTarget||e instanceof Event)}function areConnectedThroughProperties(e,t,r=new Set){if(e===t&&isObject4(e))return!0;const i=getSubNodes(e,r),o=getSubNodes(t,r);for(const a of i)if(o.has(a))return!0;return!1}function isObject4(e){return typeof e=="object"&&e!==null}var EditorWatchdog=class extends Watchdog{_editor=null;_lifecyclePromise=null;_throttledSave;_data;_lastDocumentVersion;_elementOrData;_initUsingData=!0;_editables={};_config;_excludedProps;constructor(e,t={}){super(t),this._throttledSave=throttle_default(this._save.bind(this),typeof t.saveInterval=="number"?t.saveInterval:5e3),e&&(this._creator=(r,i)=>e.create(r,i)),this._destructor=r=>r.destroy()}get editor(){return this._editor}get _item(){return this._editor}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}_restart(){return Promise.resolve().then(()=>(this.state="initializing",this._fire("stateChange"),this._destroy())).catch(e=>{console.error("An error happened during the editor destroying.",e)}).then(()=>{const e={},t=[],r=this._config.rootsAttributes||{},i={};for(const[a,c]of Object.entries(this._data.roots))c.isLoaded?(e[a]="",i[a]=r[a]||{}):t.push(a);const o={...this._config,extraPlugins:this._config.extraPlugins||[],lazyRoots:t,rootsAttributes:i,_watchdogInitialData:this._data};return delete o.initialData,o.extraPlugins.push(EditorWatchdogInitPlugin),this._initUsingData?this.create(e,o,o.context):isElement_default(this._elementOrData)?this.create(this._elementOrData,o,o.context):this.create(this._editables,o,o.context)}).then(()=>{this._fire("restart")})}create(e=this._elementOrData,t=this._config,r){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(super._startErrorHandling(),this._elementOrData=e,this._initUsingData=typeof e=="string"||Object.keys(e).length>0&&typeof Object.values(e)[0]=="string",this._config=this._cloneEditorConfiguration(t)||{},this._config.context=r,this._creator(e,this._config))).then(i=>{this._editor=i,i.model.document.on("change:data",this._throttledSave),this._lastDocumentVersion=i.model.document.version,this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this.state="ready",this._fire("stateChange")}).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}destroy(){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy())).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling(),this._throttledSave.cancel();const e=this._editor;return this._editor=null,e.model.document.off("change:data",this._throttledSave),this._destructor(e)})}_save(){const e=this._editor.model.document.version;try{this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this._lastDocumentVersion=e}catch(t){console.error(t,"An error happened during restoring editor data. Editor will be restored from the previously saved data.")}}_setExcludedProperties(e){this._excludedProps=e}_getData(){const e=this._editor,t=e.model.document.roots.filter(c=>c.isAttached()&&c.rootName!="$graveyard"),{plugins:r}=e,i=r.has("CommentsRepository")&&r.get("CommentsRepository"),o=r.has("TrackChanges")&&r.get("TrackChanges"),a={roots:{},markers:{},commentThreads:JSON.stringify([]),suggestions:JSON.stringify([])};t.forEach(c=>{a.roots[c.rootName]={content:JSON.stringify(Array.from(c.getChildren())),attributes:JSON.stringify(Array.from(c.getAttributes())),isLoaded:c._isLoaded}});for(const c of e.model.markers)c._affectsData&&(a.markers[c.name]={rangeJSON:c.getRange().toJSON(),usingOperation:c._managedUsingOperations,affectsData:c._affectsData});return i&&(a.commentThreads=JSON.stringify(i.getCommentThreads({toJSON:!0,skipNotAttached:!0}))),o&&(a.suggestions=JSON.stringify(o.getSuggestions({toJSON:!0,skipNotAttached:!0}))),a}_getEditables(){const e={};for(const t of this.editor.model.document.getRootNames()){const r=this.editor.ui.getEditableElement(t);r&&(e[t]=r)}return e}_isErrorComingFromThisItem(e){return areConnectedThroughProperties(this._editor,e.context,this._excludedProps)}_cloneEditorConfiguration(e){return cloneDeepWith_default(e,(t,r)=>{if(isElement_default(t)||r==="context")return t})}},EditorWatchdogInitPlugin=class{editor;_data;constructor(e){this.editor=e,this._data=e.config.get("_watchdogInitialData")}init(){this.editor.data.on("init",e=>{e.stop(),this.editor.model.enqueueChange({isUndoable:!1},t=>{this._restoreCollaborationData(),this._restoreEditorData(t)}),this.editor.data.fire("ready")},{priority:999})}_createNode(e,t){if("name"in t){const r=e.createElement(t.name,t.attributes);if(t.children)for(const i of t.children)r._appendChild(this._createNode(e,i));return r}else return e.createText(t.data,t.attributes)}_restoreEditorData(e){const t=this.editor;Object.entries(this._data.roots).forEach(([r,{content:i,attributes:o}])=>{const a=JSON.parse(i),c=JSON.parse(o),u=t.model.document.getRoot(r);for(const[h,d]of c)e.setAttribute(h,d,u);for(const h of a){const d=this._createNode(e,h);e.insert(d,u,"end")}}),Object.entries(this._data.markers).forEach(([r,i])=>{const{document:o}=t.model,{rangeJSON:{start:a,end:c},...u}=i,h=o.getRoot(a.root),d=e.createPositionFromPath(h,a.path,a.stickiness),f=e.createPositionFromPath(h,c.path,c.stickiness),m=e.createRange(d,f);e.addMarker(r,{range:m,...u})})}_restoreCollaborationData(){const e=JSON.parse(this._data.commentThreads),t=JSON.parse(this._data.suggestions);e.forEach(r=>{const i=this.editor.config.get("collaboration.channelId"),o=this.editor.plugins.get("CommentsRepository");o.hasCommentThread(r.threadId)&&o.getCommentThread(r.threadId).remove(),o.addCommentThread({channelId:i,...r})}),t.forEach(r=>{const i=this.editor.plugins.get("TrackChangesEditing");if(i.hasSuggestion(r.id)){const o=i.getSuggestion(r.id);o.attributes=r.attributes}else i.addSuggestionData(r)})}},mainQueueId=Symbol("MainQueueId"),ContextWatchdog=class extends Watchdog{_watchdogs=new Map;_watchdogConfig;_context=null;_contextProps=new Set;_actionQueues=new ActionQueues;_contextConfig;_item;constructor(e,t={}){super(t),this._watchdogConfig=t,this._creator=r=>e.create(r),this._destructor=r=>r.destroy(),this._actionQueues.onEmpty(()=>{this.state==="initializing"&&(this.state="ready",this._fire("stateChange"))})}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}get context(){return this._context}create(e={}){return this._actionQueues.enqueue(mainQueueId,()=>(this._contextConfig=e,this._create()))}getItem(e){return this._getWatchdog(e)._item}getItemState(e){return this._getWatchdog(e).state}add(e){const t=toArray2(e);return Promise.all(t.map(r=>this._actionQueues.enqueue(r.id,()=>{if(this.state==="destroyed")throw new Error("Cannot add items to destroyed watchdog.");if(!this._context)throw new Error("Context was not created yet. You should call the `ContextWatchdog#create()` method first.");let i;if(this._watchdogs.has(r.id))throw new Error(`Item with the given id is already added: '${r.id}'.`);if(r.type==="editor")return i=new EditorWatchdog(null,this._watchdogConfig),i.setCreator(r.creator),i._setExcludedProperties(this._contextProps),r.destructor&&i.setDestructor(r.destructor),this._watchdogs.set(r.id,i),i.on("error",(o,{error:a,causesRestart:c})=>{this._fire("itemError",{itemId:r.id,error:a}),c&&this._actionQueues.enqueue(r.id,()=>new Promise(u=>{const h=()=>{i.off("restart",h),this._fire("itemRestart",{itemId:r.id}),u()};i.on("restart",h)}))}),i.create(r.sourceElementOrData,r.config,this._context);throw new Error(`Not supported item type: '${r.type}'.`)})))}remove(e){const t=toArray2(e);return Promise.all(t.map(r=>this._actionQueues.enqueue(r,()=>{const i=this._getWatchdog(r);return this._watchdogs.delete(r),i.destroy()})))}destroy(){return this._actionQueues.enqueue(mainQueueId,()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy()))}_restart(){return this._actionQueues.enqueue(mainQueueId,()=>(this.state="initializing",this._fire("stateChange"),this._destroy().catch(e=>{console.error("An error happened during destroying the context or items.",e)}).then(()=>this._create()).then(()=>this._fire("restart"))))}_create(){return Promise.resolve().then(()=>(this._startErrorHandling(),this._creator(this._contextConfig))).then(e=>(this._context=e,this._contextProps=getSubNodes(this._context),Promise.all(Array.from(this._watchdogs.values()).map(t=>(t._setExcludedProperties(this._contextProps),t.create(void 0,void 0,this._context))))))}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling();const e=this._context;return this._context=null,this._contextProps=new Set,Promise.all(Array.from(this._watchdogs.values()).map(t=>t.destroy())).then(()=>this._destructor(e))})}_getWatchdog(e){const t=this._watchdogs.get(e);if(!t)throw new Error(`Item with the given id was not registered: ${e}.`);return t}_isErrorComingFromThisItem(e){for(const t of this._watchdogs.values())if(t._isErrorComingFromThisItem(e))return!1;return areConnectedThroughProperties(this._context,e.context)}},ActionQueues=class{_onEmptyCallbacks=[];_queues=new Map;_activeActions=0;onEmpty(e){this._onEmptyCallbacks.push(e)}enqueue(e,t){const r=e===mainQueueId;this._activeActions++,this._queues.get(e)||this._queues.set(e,Promise.resolve());const o=(r?Promise.all(this._queues.values()):Promise.all([this._queues.get(mainQueueId),this._queues.get(e)])).then(t),a=o.catch(()=>{});return this._queues.set(e,a),o.finally(()=>{this._activeActions--,this._queues.get(e)===a&&this._activeActions===0&&this._onEmptyCallbacks.forEach(c=>c())})}};function toArray2(e){return Array.isArray(e)?e:[e]}var Plugin=class extends ObservableMixin(){editor;_disableStack=new Set;constructor(e){super(),this.editor=e,this.set("isEnabled",!0)}forceDisabled(e){this._disableStack.add(e),this._disableStack.size==1&&(this.on("set:isEnabled",forceDisable$1,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),this._disableStack.size==0&&(this.off("set:isEnabled",forceDisable$1),this.isEnabled=!0)}destroy(){this.stopListening()}static get isContextPlugin(){return!1}static get isOfficialPlugin(){return!1}static get isPremiumPlugin(){return!1}};function forceDisable$1(e){e.return=!1,e.stop()}var Command=class extends ObservableMixin(){editor;_isEnabledBasedOnSelection;_affectsData;_disableStack;constructor(e){super(),this.editor=e,this.set("value",void 0),this.set("isEnabled",!1),this._affectsData=!0,this._isEnabledBasedOnSelection=!0,this._disableStack=new Set,this.decorate("execute"),this.listenTo(this.editor.model.document,"change",()=>{this.refresh()}),this.listenTo(e,"change:isReadOnly",()=>{this.refresh()}),this.on("set:isEnabled",t=>{if(!this.affectsData)return;const r=e.model.document.selection,o=!(r.getFirstPosition().root.rootName=="$graveyard")&&e.model.canEditAt(r);(e.isReadOnly||this._isEnabledBasedOnSelection&&!o)&&(t.return=!1,t.stop())},{priority:"highest"}),this.on("execute",t=>{this.isEnabled||t.stop()},{priority:"high"})}get affectsData(){return this._affectsData}set affectsData(e){this._affectsData=e}refresh(){this.isEnabled=!0}forceDisabled(e){this._disableStack.add(e),this._disableStack.size==1&&(this.on("set:isEnabled",forceDisable,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),this._disableStack.size==0&&(this.off("set:isEnabled",forceDisable),this.refresh())}execute(...e){}destroy(){this.stopListening()}};function forceDisable(e){e.return=!1,e.stop()}var PluginCollection=class extends EmitterMixin(){_context;_plugins=new Map;_availablePlugins;_contextPlugins;constructor(e,t=[],r=[]){super(),this._context=e,this._availablePlugins=new Map;for(const i of t)i.pluginName&&this._availablePlugins.set(i.pluginName,i);this._contextPlugins=new Map;for(const[i,o]of r)this._contextPlugins.set(i,o),this._contextPlugins.set(o,i),i.pluginName&&this._availablePlugins.set(i.pluginName,i)}*[Symbol.iterator](){for(const e of this._plugins)typeof e[0]=="function"&&(yield e)}get(e){const t=this._plugins.get(e);if(!t){let r=e;throw typeof e=="function"&&(r=e.pluginName||e.name),new CKEditorError("plugincollection-plugin-not-loaded",this._context,{plugin:r})}return t}has(e){return this._plugins.has(e)}init(e,t=[],r=[]){const i=this,o=this._context;g(e),_(e);const a=e.filter(O=>!f(O,t)),c=[...v(a)];E(c,r);const u=A(c);return I(u,"init").then(()=>I(u,"afterInit")).then(()=>u);function h(O){return typeof O=="function"}function d(O){return h(O)&&!!O.isContextPlugin}function f(O,P){return P.some(L=>L===O||m(O)===L||m(L)===O)}function m(O){return h(O)?O.pluginName||O.name:O}function g(O,P=new Set){O.forEach(L=>{h(L)&&(P.has(L)||(P.add(L),L.pluginName&&!i._availablePlugins.has(L.pluginName)&&i._availablePlugins.set(L.pluginName,L),L.requires&&g(L.requires,P)))})}function v(O,P=new Set){return O.map(L=>h(L)?L:i._availablePlugins.get(L)).reduce((L,V)=>P.has(V)?L:(P.add(V),V.requires&&(_(V.requires,V),v(V.requires,P).forEach($=>L.add($))),L.add(V)),new Set)}function _(O,P=null){O.map(L=>h(L)?L:i._availablePlugins.get(L)||L).forEach(L=>{b(L,P),S(L,P),R(L,P)})}function b(O,P){if(!h(O))throw P?new CKEditorError("plugincollection-soft-required",o,{missingPlugin:O,requiredBy:m(P)}):new CKEditorError("plugincollection-plugin-not-found",o,{plugin:O})}function S(O,P){if(d(P)&&!d(O))throw new CKEditorError("plugincollection-context-required",o,{plugin:m(O),requiredBy:m(P)})}function R(O,P){if(P&&f(O,t))throw new CKEditorError("plugincollection-required",o,{plugin:m(O),requiredBy:m(P)})}function A(O){return O.map(P=>{let L=i._contextPlugins.get(P);return L=L||new P(o),i._add(P,L),L})}function I(O,P){return O.reduce((L,V)=>!V[P]||i._contextPlugins.has(V)?L:L.then(V[P].bind(V)),Promise.resolve())}function E(O,P){for(const L of P){if(typeof L!="function")throw new CKEditorError("plugincollection-replace-plugin-invalid-type",null,{pluginItem:L});const V=L.pluginName;if(!V)throw new CKEditorError("plugincollection-replace-plugin-missing-name",null,{pluginItem:L});if(L.requires&&L.requires.length)throw new CKEditorError("plugincollection-plugin-for-replacing-cannot-have-dependencies",null,{pluginName:V});const $=i._availablePlugins.get(V);if(!$)throw new CKEditorError("plugincollection-plugin-for-replacing-not-exist",null,{pluginName:V});const W=O.indexOf($);if(W===-1){if(i._contextPlugins.has($))return;throw new CKEditorError("plugincollection-plugin-for-replacing-not-loaded",null,{pluginName:V})}if($.requires&&$.requires.length)throw new CKEditorError("plugincollection-replaced-plugin-cannot-have-dependencies",null,{pluginName:V});O.splice(W,1,L),i._availablePlugins.set(V,L)}}}destroy(){const e=[];for(const[,t]of this)typeof t.destroy=="function"&&!this._contextPlugins.has(t)&&e.push(t.destroy());return Promise.all(e)}_add(e,t){this._plugins.set(e,t);const r=e.pluginName;if(r){if(this._plugins.has(r))throw new CKEditorError("plugincollection-plugin-name-conflict",null,{pluginName:r,plugin1:this._plugins.get(r).constructor,plugin2:e});this._plugins.set(r,t)}}},Context=class{config;plugins;locale;t;editors;static defaultConfig;static builtinPlugins;_contextOwner=null;constructor(e){const{translations:t,...r}=e||{};this.config=new Config2(r,this.constructor.defaultConfig);const i=this.constructor.builtinPlugins;this.config.define("plugins",i),this.plugins=new PluginCollection(this,i);const o=this.config.get("language")||{};this.locale=new Locale2({uiLanguage:typeof o=="string"?o:o.ui,contentLanguage:this.config.get("language.content"),translations:t}),this.t=this.locale.t,this.editors=new Collection}initPlugins(){const e=this.config.get("plugins")||[],t=this.config.get("substitutePlugins")||[];for(const r of e.concat(t)){if(typeof r!="function")throw new CKEditorError("context-initplugins-constructor-only",null,{Plugin:r});if(r.isContextPlugin!==!0)throw new CKEditorError("context-initplugins-invalid-plugin",null,{Plugin:r})}return this.plugins.init(e,[],t)}destroy(){return Promise.all(Array.from(this.editors,e=>e.destroy())).then(()=>this.plugins.destroy())}_addEditor(e,t){if(this._contextOwner)throw new CKEditorError("context-addeditor-private-context");this.editors.add(e),t&&(this._contextOwner=e)}_removeEditor(e){return this.editors.has(e)&&this.editors.remove(e),this._contextOwner===e?this.destroy():Promise.resolve()}_getEditorConfig(){const e={};for(const t of this.config.names())["plugins","removePlugins","extraPlugins"].includes(t)||(e[t]=this.config.get(t));return e}static create(e){return new Promise(t=>{const r=new this(e);t(r.initPlugins().then(()=>r))})}},CommandCollection=class{_commands;constructor(){this._commands=new Map}add(e,t){this._commands.set(e,t)}get(e){return this._commands.get(e)}execute(e,...t){const r=this.get(e);if(!r)throw new CKEditorError("commandcollection-command-not-found",this,{commandName:e});return r.execute(...t)}*names(){yield*this._commands.keys()}*commands(){yield*this._commands.values()}[Symbol.iterator](){return this._commands[Symbol.iterator]()}destroy(){for(const e of this.commands())e.destroy()}},EditingKeystrokeHandler=class extends KeystrokeHandler{editor;constructor(e){super(),this.editor=e}set(e,t,r={}){if(typeof t=="string"){const i=t;t=(o,a)=>{this.editor.execute(i),a()}}super.set(e,t,r)}},DEFAULT_CATEGORY_ID="contentEditing",DEFAULT_GROUP_ID="common",Accessibility=class{keystrokeInfos=new Map;_editor;constructor(e){this._editor=e;const t=e.config.get("menuBar.isVisible"),r=e.locale.t;this.addKeystrokeInfoCategory({id:DEFAULT_CATEGORY_ID,label:r("Content editing keystrokes"),description:r("These keyboard shortcuts allow for quick access to content editing features.")});const i=[{label:r("Close contextual balloons, dropdowns, and dialogs"),keystroke:"Esc"},{label:r("Open the accessibility help dialog"),keystroke:"Alt+0"},{label:r("Move focus between form fields (inputs, buttons, etc.)"),keystroke:[["Tab"],["Shift+Tab"]]},{label:r("Move focus to the toolbar, navigate between toolbars"),keystroke:"Alt+F10",mayRequireFn:!0},{label:r("Navigate through the toolbar or menu bar"),keystroke:[["arrowup"],["arrowright"],["arrowdown"],["arrowleft"]]},{label:r("Execute the currently focused button. Executing buttons that interact with the editor content moves the focus back to the content."),keystroke:[["Enter"],["Space"]]}];t&&i.push({label:r("Move focus to the menu bar, navigate between menu bars"),keystroke:"Alt+F9",mayRequireFn:!0}),this.addKeystrokeInfoCategory({id:"navigation",label:r("User interface and content navigation keystrokes"),description:r("Use the following keystrokes for more efficient navigation in the CKEditor 5 user interface."),groups:[{id:"common",keystrokes:i}]})}addKeystrokeInfoCategory({id:e,label:t,description:r,groups:i}){this.keystrokeInfos.set(e,{id:e,label:t,description:r,groups:new Map}),this.addKeystrokeInfoGroup({categoryId:e,id:DEFAULT_GROUP_ID}),i&&i.forEach(o=>{this.addKeystrokeInfoGroup({categoryId:e,...o})})}addKeystrokeInfoGroup({categoryId:e=DEFAULT_CATEGORY_ID,id:t,label:r,keystrokes:i}){const o=this.keystrokeInfos.get(e);if(!o)throw new CKEditorError("accessibility-unknown-keystroke-info-category",this._editor,{groupId:t,categoryId:e});o.groups.set(t,{id:t,label:r,keystrokes:i||[]})}addKeystrokeInfos({categoryId:e=DEFAULT_CATEGORY_ID,groupId:t=DEFAULT_GROUP_ID,keystrokes:r}){if(!this.keystrokeInfos.has(e))throw new CKEditorError("accessibility-unknown-keystroke-info-category",this._editor,{categoryId:e,keystrokes:r});const i=this.keystrokeInfos.get(e);if(!i.groups.has(t))throw new CKEditorError("accessibility-unknown-keystroke-info-group",this._editor,{groupId:t,categoryId:e,keystrokes:r});i.groups.get(t).keystrokes.push(...r)}};function getEditorUsageData(e){return{sessionId:getSessionId(),pageSessionId:getPageSessionID(),hostname:window.location.hostname,version:globalThis.CKEDITOR_VERSION,type:getEditorType(e),plugins:getPluginsUsageData(e.plugins),distribution:getDistributionUsageData(),env:getEnvUsageData(),integration:Object.create(null),menuBar:{isVisible:!!e.config.get("menuBar.isVisible")},language:{ui:e.locale.uiLanguage,content:e.locale.contentLanguage},toolbar:{main:getToolbarUsageData(e.config.get("toolbar")),block:getToolbarUsageData(e.config.get("blockToolbar")),balloon:getToolbarUsageData(e.config.get("balloonToolbar"))}}}function getEditorType(e){return Object.getPrototypeOf(e).constructor.editorName}function getPluginsUsageData(e){return Array.from(e).filter(([t])=>!!t.pluginName).map(([t])=>{const{pluginName:r,isContextPlugin:i,isOfficialPlugin:o,isPremiumPlugin:a}=t;return{isContext:!!i,isOfficial:!!o,isPremium:!!a,name:r}})}function getToolbarUsageData(e){if(!e)return;const t=Array.isArray(e)?{items:e}:e,r=a(t.items||[]);return{isMultiline:r.includes("-"),shouldNotGroupWhenFull:!!t.shouldNotGroupWhenFull,items:o(r)};function o(c){return c.filter(u=>u!=="|"&&u!=="-")}function a(c){return c.flatMap(u=>typeof u=="string"?[u]:a(u.items))}}function getDistributionUsageData(){return{channel:window[Symbol.for("cke distribution")]||"sh"}}function getEnvUsageData(){let e="unknown",t="unknown";return env.isMac?e="mac":env.isWindows?e="windows":env.isiOS?e="ios":env.isAndroid&&(e="android"),env.isGecko?t="gecko":env.isBlink?t="blink":env.isSafari&&(t="safari"),{os:e,browser:t}}function getSessionId(){return localStorage.getItem("__ckeditor-session-id")||localStorage.setItem("__ckeditor-session-id",uid2()),localStorage.getItem("__ckeditor-session-id")}function getPageSessionID(){return global2.window.CKEDITOR_PAGE_SESSION_ID=global2.window.CKEDITOR_PAGE_SESSION_ID||uid2(),global2.window.CKEDITOR_PAGE_SESSION_ID}var Editor=class extends ObservableMixin(){static get editorName(){return"Editor"}accessibility;commands;config;conversion;data;editing;locale;model;plugins;keystrokes;t;static defaultConfig;static builtinPlugins;_context;_readOnlyLocks;constructor(e={}){if(super(),"sanitizeHtml"in e)throw new CKEditorError("editor-config-sanitizehtml-not-supported");const t=this.constructor,{translations:r,...i}=t.defaultConfig||{},{translations:o=r,...a}=e,c=e.language||i.language;this._context=e.context||new Context({language:c,translations:o}),this._context._addEditor(this,!e.context);const u=Array.from(t.builtinPlugins||[]);this.config=new Config2(a,i),this.config.define("plugins",u),this.config.define(this._context._getEditorConfig()),d(this.config),this.plugins=new PluginCollection(this,u,this._context.plugins),this.locale=this._context.locale,this.t=this.locale.t,this._readOnlyLocks=new Set,this.commands=new CommandCollection,this.set("state","initializing"),this.once("ready",()=>this.state="ready",{priority:"high"}),this.once("destroy",()=>this.state="destroyed",{priority:"high"}),this.model=new Model,this.on("change:isReadOnly",()=>{this.model.document.isReadOnly=this.isReadOnly});const h=new StylesProcessor;this.data=new DataController(this.model,h),this.editing=new EditingController(this.model,h),this.editing.view.document.bind("isReadOnly").to(this),this.conversion=new Conversion([this.editing.downcastDispatcher,this.data.downcastDispatcher],this.data.upcastDispatcher),this.conversion.addAlias("dataDowncast",this.data.downcastDispatcher),this.conversion.addAlias("editingDowncast",this.editing.downcastDispatcher),this.keystrokes=new EditingKeystrokeHandler(this),this.keystrokes.listenTo(this.editing.view.document),this.accessibility=new Accessibility(this),f(this);function d(m){let g=m.get("licenseKey");if(!g&&window.CKEDITOR_GLOBAL_LICENSE_KEY&&(g=window.CKEDITOR_GLOBAL_LICENSE_KEY,m.set("licenseKey",g)),!g)throw new CKEditorError("license-key-missing")}function f(m){const g=m.config.get("licenseKey"),v=window[Symbol.for("cke distribution")]||"sh";function _(L){m.enableReadOnlyMode(Symbol("invalidLicense")),m._showLicenseError(L)}function b(L){const V=L.split(".");return V.length!=3?null:V[1]}function S(L){return["exp","jti","vc"].every($=>$ in L)}function R(L){return Object.getOwnPropertyNames(L).sort().filter(W=>W!="vc"&&L[W]!=null).map(W=>L[W])}function A(L){const{hostname:V}=new URL(window.location.href);if(L.includes(V))return!0;const $=V.split(".");return L.filter(W=>W.includes("*")).map(W=>W.split(".")).filter(W=>W.length<=$.length).map(W=>Array($.length-W.length).fill(W[0]==="*"?"*":"").concat(W)).some(W=>$.every((Z,ie)=>W[ie]===Z||W[ie]==="*"))}if(g=="GPL"){v=="cloud"&&_("distributionChannel");return}const I=b(g);if(!I){_("invalid");return}const E=parseBase64EncodedObject(I);if(!E){_("invalid");return}if(!S(E)){_("invalid");return}if(E.distributionChannel&&!toArray(E.distributionChannel).includes(v)){_("distributionChannel");return}if(crc32(R(E))!=E.vc.toLowerCase()){_("invalid");return}if(new Date(E.exp*1e3)<releaseDate){_("expired");return}const P=E.licensedHosts;if(P&&P.length>0&&!A(P)){_("domainLimit");return}if(["evaluation","trial"].includes(E.licenseType)&&E.exp*1e3<Date.now()){_("expired");return}if(["evaluation","trial","development"].includes(E.licenseType)){const L=E.licenseType;console.info(`You are using the ${L} version of CKEditor 5 with limited usage. Make sure you will not use it in the production environment.`);const V=setTimeout(()=>{_(`${L}Limit`)},6e5);m.on("destroy",()=>{clearTimeout(V)})}E.usageEndpoint&&m.once("ready",()=>{const L={requestId:uid2(),requestTime:Math.round(Date.now()/1e3),license:g,editor:collectUsageData(m)};m._sendUsageRequest(E.usageEndpoint,L).then(V=>{const{status:$,message:W}=V;W&&console.warn(W),$!="ok"&&_("usageLimit")},()=>{logError("license-key-validation-endpoint-not-reachable",{url:E.usageEndpoint})})},{priority:"high"})}}get isReadOnly(){return this._readOnlyLocks.size>0}set isReadOnly(e){throw new CKEditorError("editor-isreadonly-has-no-setter")}enableReadOnlyMode(e){if(typeof e!="string"&&typeof e!="symbol")throw new CKEditorError("editor-read-only-lock-id-invalid",null,{lockId:e});this._readOnlyLocks.has(e)||(this._readOnlyLocks.add(e),this._readOnlyLocks.size===1&&this.fire("change:isReadOnly","isReadOnly",!0,!1))}disableReadOnlyMode(e){if(typeof e!="string"&&typeof e!="symbol")throw new CKEditorError("editor-read-only-lock-id-invalid",null,{lockId:e});this._readOnlyLocks.has(e)&&(this._readOnlyLocks.delete(e),this._readOnlyLocks.size===0&&this.fire("change:isReadOnly","isReadOnly",!1,!0))}setData(e){this.data.set(e)}getData(e){return this.data.get(e)}initPlugins(){const e=this.config,t=e.get("plugins"),r=e.get("removePlugins")||[],i=e.get("extraPlugins")||[],o=e.get("substitutePlugins")||[];return this.plugins.init(t.concat(i),r,o)}destroy(){let e=Promise.resolve();return this.state=="initializing"&&(e=new Promise(t=>this.once("ready",t))),e.then(()=>{this.fire("destroy"),this.stopListening(),this.commands.destroy()}).then(()=>this.plugins.destroy()).then(()=>{this.model.destroy(),this.data.destroy(),this.editing.destroy(),this.keystrokes.destroy()}).then(()=>this._context._removeEditor(this))}execute(e,...t){try{return this.commands.execute(e,...t)}catch(r){CKEditorError.rethrowUnexpectedError(r,this)}}focus(){this.editing.view.focus()}static create(...e){throw new Error("This is an abstract method.")}static Context=Context;static EditorWatchdog=EditorWatchdog;static ContextWatchdog=ContextWatchdog;_showLicenseError(e,t){setTimeout(()=>{if(e=="invalid")throw new CKEditorError("invalid-license-key");if(e=="expired")throw new CKEditorError("license-key-expired");if(e=="domainLimit")throw new CKEditorError("license-key-domain-limit");if(e=="featureNotAllowed")throw new CKEditorError("license-key-plugin-not-allowed",null,{pluginName:t});if(e=="evaluationLimit")throw new CKEditorError("license-key-evaluation-limit");if(e=="trialLimit")throw new CKEditorError("license-key-trial-limit");if(e=="developmentLimit")throw new CKEditorError("license-key-development-limit");if(e=="usageLimit")throw new CKEditorError("license-key-usage-limit");if(e=="distributionChannel")throw new CKEditorError("license-key-invalid-distribution-channel")},0),this._showLicenseError=()=>{}}async _sendUsageRequest(e,t){const r=new Headers({"Content-Type":"application/json"}),i=await fetch(new URL(e),{method:"POST",headers:r,body:JSON.stringify(t)});if(!i.ok)throw new Error(`HTTP Response: ${i.status}`);return i.json()}};function collectUsageData(e){const t=getEditorUsageData(e);function r(i,o){if(get_default(t,i)!==void 0)throw new CKEditorError("editor-usage-data-path-already-set",{path:i});set_default(t,i,o)}return e.fire("collectUsageData",{setUsageData:r}),t}function attachToForm(e){if(!isFunction_default(e.updateSourceElement))throw new CKEditorError("attachtoform-missing-elementapi-interface",e);const t=e.sourceElement;if(isTextArea(t)&&t.form){let r;const i=t.form,o=()=>e.updateSourceElement();isFunction_default(i.submit)&&(r=i.submit,i.submit=()=>{o(),r.apply(i)}),i.addEventListener("submit",o),e.on("destroy",()=>{i.removeEventListener("submit",o),r&&(i.submit=r)})}}function isTextArea(e){return!!e&&e.tagName.toLowerCase()==="textarea"}function ElementApiMixin(e){class t extends e{sourceElement;updateSourceElement(i){if(!this.sourceElement)throw new CKEditorError("editor-missing-sourceelement",this);const o=this.config.get("updateSourceElementOnDestroy"),a=this.sourceElement instanceof HTMLTextAreaElement;if(!o&&!a){setDataInElement(this.sourceElement,"");return}const c=typeof i=="string"?i:this.data.get();setDataInElement(this.sourceElement,c)}}return t}ElementApiMixin.updateSourceElement=ElementApiMixin(Object).prototype.updateSourceElement;var cancel='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.591 10.177 4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414l-4.243 4.243z"/></svg>',caption='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 16h9a1 1 0 0 1 0 2H2a1 1 0 0 1 0-2z"/><path d="M17 1a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14zm0 1.5H3a.5.5 0 0 0-.492.41L2.5 3v9a.5.5 0 0 0 .41.492L3 12.5h14a.5.5 0 0 0 .492-.41L17.5 12V3a.5.5 0 0 0-.41-.492L17 2.5z" fill-opacity=".6"/></svg>',check='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.972 16.615a.997.997 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a.997.997 0 0 1-.745.292z"/></svg>',cog='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.333 2 .19 2.263a5.899 5.899 0 0 1 1.458.604L14.714 3.4 16.6 5.286l-1.467 1.733c.263.452.468.942.605 1.46L18 8.666v2.666l-2.263.19a5.899 5.899 0 0 1-.604 1.458l1.467 1.733-1.886 1.886-1.733-1.467a5.899 5.899 0 0 1-1.46.605L11.334 18H8.667l-.19-2.263a5.899 5.899 0 0 1-1.458-.604L5.286 16.6 3.4 14.714l1.467-1.733a5.899 5.899 0 0 1-.604-1.458L2 11.333V8.667l2.262-.189a5.899 5.899 0 0 1 .605-1.459L3.4 5.286 5.286 3.4l1.733 1.467a5.899 5.899 0 0 1 1.46-.605L8.666 2h2.666zM10 6.267a3.733 3.733 0 1 0 0 7.466 3.733 3.733 0 0 0 0-7.466z"/></svg>',colorPalette='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.209 18.717A8.5 8.5 0 1 1 18.686 9.6h-.008l.002.12a3 3 0 0 1-2.866 2.997h-.268l-.046-.002v.002h-4.791a2 2 0 1 0 0 4 1 1 0 1 1-.128 1.992 8.665 8.665 0 0 1-.372.008Zm-3.918-7.01a1.25 1.25 0 1 0-2.415-.648 1.25 1.25 0 0 0 2.415.647ZM5.723 8.18a1.25 1.25 0 1 0 .647-2.414 1.25 1.25 0 0 0-.647 2.414ZM9.76 6.155a1.25 1.25 0 1 0 .647-2.415 1.25 1.25 0 0 0-.647 2.415Zm4.028 1.759a1.25 1.25 0 1 0 .647-2.415 1.25 1.25 0 0 0-.647 2.415Z"/></svg>',eraser='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m8.636 9.531-2.758 3.94a.5.5 0 0 0 .122.696l3.224 2.284h1.314l2.636-3.736L8.636 9.53zm.288 8.451L5.14 15.396a2 2 0 0 1-.491-2.786l6.673-9.53a2 2 0 0 1 2.785-.49l3.742 2.62a2 2 0 0 1 .491 2.785l-7.269 10.053-2.147-.066z"/><path d="M4 18h5.523v-1H4zm-2 0h1v-1H2z"/></svg>',history='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11 1a9 9 0 1 1-8.027 13.075l1.128-1.129A7.502 7.502 0 0 0 18.5 10a7.5 7.5 0 1 0-14.962.759l-.745-.746-.76.76A9 9 0 0 1 11 1z"/><path d="M.475 8.17a.75.75 0 0 1 .978.047l.075.082 1.284 1.643 1.681-1.284a.75.75 0 0 1 .978.057l.073.083a.75.75 0 0 1-.057.978l-.083.073-2.27 1.737a.75.75 0 0 1-.973-.052l-.074-.082-1.741-2.23a.75.75 0 0 1 .13-1.052z"/><path d="M11.5 5v4.999l3.196 3.196-1.06 1.06L10.1 10.72l-.1-.113V5z"/></svg>',lowVision='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.085 6.22 2.943 4.078a.75.75 0 1 1 1.06-1.06l2.592 2.59A11.094 11.094 0 0 1 10 5.068c4.738 0 8.578 3.101 8.578 5.083 0 1.197-1.401 2.803-3.555 3.887l1.714 1.713a.75.75 0 0 1-.09 1.138.488.488 0 0 1-.15.084.75.75 0 0 1-.821-.16L6.17 7.304c-.258.11-.51.233-.757.365l6.239 6.24-.006.005.78.78c-.388.094-.78.166-1.174.215l-1.11-1.11h.011L4.55 8.197a7.2 7.2 0 0 0-.665.514l-.112.098 4.897 4.897-.005.006 1.276 1.276a10.164 10.164 0 0 1-1.477-.117l-.479-.479-.009.009-4.863-4.863-.022.031a2.563 2.563 0 0 0-.124.2c-.043.077-.08.158-.108.241a.534.534 0 0 0-.028.133.29.29 0 0 0 .008.072.927.927 0 0 0 .082.226c.067.133.145.26.234.379l3.242 3.365.025.01.59.623c-3.265-.918-5.59-3.155-5.59-4.668 0-1.194 1.448-2.838 3.663-3.93zm7.07.531a4.632 4.632 0 0 1 1.108 5.992l.345.344.046-.018a9.313 9.313 0 0 0 2-1.112c.256-.187.5-.392.727-.613.137-.134.27-.277.392-.431.072-.091.141-.185.203-.286.057-.093.107-.19.148-.292a.72.72 0 0 0 .036-.12.29.29 0 0 0 .008-.072.492.492 0 0 0-.028-.133.999.999 0 0 0-.036-.096 2.165 2.165 0 0 0-.071-.145 2.917 2.917 0 0 0-.125-.2 3.592 3.592 0 0 0-.263-.335 5.444 5.444 0 0 0-.53-.523 7.955 7.955 0 0 0-1.054-.768 9.766 9.766 0 0 0-1.879-.891c-.337-.118-.68-.219-1.027-.301zm-2.85.21-.069.002a.508.508 0 0 0-.254.097.496.496 0 0 0-.104.679.498.498 0 0 0 .326.199l.045.005c.091.003.181.003.272.012a2.45 2.45 0 0 1 2.017 1.513c.024.061.043.125.069.185a.494.494 0 0 0 .45.287h.008a.496.496 0 0 0 .35-.158.482.482 0 0 0 .13-.335.638.638 0 0 0-.048-.219 3.379 3.379 0 0 0-.36-.723 3.438 3.438 0 0 0-2.791-1.543l-.028-.001h-.013z"/></svg>',textAlternative='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.035 1C2.446 1 2 1.54 2 2.098V10.5h1.5v-8h13v8H18V2.098C18 1.539 17.48 1 16.9 1H3.035Zm10.453 2.61a1.885 1.885 0 0 0-1.442.736 1.89 1.89 0 0 0 1.011 2.976 1.903 1.903 0 0 0 2.253-1.114 1.887 1.887 0 0 0-1.822-2.598ZM7.463 8.163a.611.611 0 0 0-.432.154L5.071 10.5h5.119L7.88 8.348a.628.628 0 0 0-.417-.185Zm6.236 1.059a.62.62 0 0 0-.42.164L12.07 10.5h2.969l-.92-1.113a.618.618 0 0 0-.42-.165ZM.91 11.5a.91.91 0 0 0-.91.912v6.877c0 .505.405.91.91.91h18.178a.91.91 0 0 0 .912-.91v-6.877a.908.908 0 0 0-.912-.912H.91ZM3.668 13h1.947l2.135 5.7H5.898l-.28-.946H3.601l-.278.945H1.516L3.668 13Zm4.947 0h1.801v4.3h2.7v1.4h-4.5V13h-.001Zm4.5 0h5.4v1.4h-1.798v4.3h-1.701v-4.3h-1.9V13h-.001Zm-8.517 1.457-.614 2.059h1.262l-.648-2.059Z"/></svg>',loupe='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.68 13.74h-.001l4.209 4.208a1 1 0 1 0 1.414-1.414l-4.267-4.268a6 6 0 1 0-1.355 1.474ZM13 9a4 4 0 1 1-8 0 4 4 0 0 1 8 0Z"/></svg>',previousArrow='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.463 5.187a.888.888 0 1 1 1.254 1.255L9.16 10l3.557 3.557a.888.888 0 1 1-1.254 1.255L7.26 10.61a.888.888 0 0 1 .16-1.382l4.043-4.042z"/></svg>',nextArrow='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.537 14.813a.888.888 0 1 1-1.254-1.255L10.84 10 7.283 6.442a.888.888 0 1 1 1.254-1.255L12.74 9.39a.888.888 0 0 1-.16 1.382l-4.043 4.042z"/></svg>',image='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.66 9.118a.693.693 0 0 1 .956.032l3.65 3.411 2.422-2.238a.695.695 0 0 1 .945 0L17.5 13.6V2.5h-15v11.1l4.16-4.482ZM17.8 1c.652 0 1.2.47 1.2 1.1v14.362c0 .64-.532 1.038-1.184 1.038H2.184C1.532 17.5 1 17.103 1 16.462V2.1C1 1.47 1.537 1 2.2 1h15.6Zm-5.655 6a2.128 2.128 0 0 1 .157-2.364A2.133 2.133 0 1 1 12.145 7Z"/></svg>',imageUpload='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.201 1C.538 1 0 1.47 0 2.1v14.363c0 .64.534 1.037 1.186 1.037h9.494a2.97 2.97 0 0 1-.414-.287 2.998 2.998 0 0 1-1.055-2.03 3.003 3.003 0 0 1 .693-2.185l.383-.455-.02.018-3.65-3.41a.695.695 0 0 0-.957-.034L1.5 13.6V2.5h15v5.535a2.97 2.97 0 0 1 1.412.932l.088.105V2.1c0-.63-.547-1.1-1.2-1.1H1.202Zm11.713 2.803a2.146 2.146 0 0 0-2.049 1.992 2.14 2.14 0 0 0 1.28 2.096 2.13 2.13 0 0 0 2.644-3.11 2.134 2.134 0 0 0-1.875-.978Z"/><path d="M15.522 19.1a.79.79 0 0 0 .79-.79v-5.373l2.059 2.455a.79.79 0 1 0 1.211-1.015l-3.352-3.995a.79.79 0 0 0-.995-.179.784.784 0 0 0-.299.221l-3.35 3.99a.79.79 0 1 0 1.21 1.017l1.936-2.306v5.185c0 .436.353.79.79.79Z"/><path d="M15.522 19.1a.79.79 0 0 0 .79-.79v-5.373l2.059 2.455a.79.79 0 1 0 1.211-1.015l-3.352-3.995a.79.79 0 0 0-.995-.179.784.784 0 0 0-.299.221l-3.35 3.99a.79.79 0 1 0 1.21 1.017l1.936-2.306v5.185c0 .436.353.79.79.79Z"/></svg>',imageAssetManager='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.201 1c-.662 0-1.2.47-1.2 1.1v14.248c0 .64.533 1.152 1.185 1.152h6.623v-7.236L6.617 9.15a.694.694 0 0 0-.957-.033L1.602 13.55V2.553l14.798.003V9.7H18V2.1c0-.63-.547-1.1-1.2-1.1H1.202Zm11.723 2.805a2.094 2.094 0 0 0-1.621.832 2.127 2.127 0 0 0 1.136 3.357 2.13 2.13 0 0 0 2.611-1.506 2.133 2.133 0 0 0-.76-2.244 2.13 2.13 0 0 0-1.366-.44Z"/><path clip-rule="evenodd" d="M19.898 12.369v6.187a.844.844 0 0 1-.844.844h-8.719a.844.844 0 0 1-.843-.844v-7.312a.844.844 0 0 1 .843-.844h2.531a.843.843 0 0 1 .597.248l.838.852h4.75c.223 0 .441.114.6.272a.844.844 0 0 1 .247.597Zm-1.52.654-4.377.02-1.1-1.143H11v6h7.4l-.023-4.877Z"/></svg>',imageUrl='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.201 1C.538 1 0 1.47 0 2.1v14.363c0 .64.534 1.037 1.186 1.037h7.029a5.401 5.401 0 0 1 .615-4.338l.762-1.232-2.975-2.78a.696.696 0 0 0-.957-.033L1.5 13.6V2.5h15v6.023c.449.131.887.32 1.307.573l.058.033c.046.028.09.057.135.086V2.1c0-.63-.547-1.1-1.2-1.1H1.202Zm11.713 2.803a2.15 2.15 0 0 0-1.611.834 2.118 2.118 0 0 0-.438 1.158 2.14 2.14 0 0 0 1.277 2.096 2.132 2.132 0 0 0 2.645-3.11 2.13 2.13 0 0 0-1.873-.978Z"/><path d="M16.63 10.294a3.003 3.003 0 0 0-4.142.887l-.117.177a.647.647 0 0 0-.096.492.664.664 0 0 0 .278.418.7.7 0 0 0 .944-.234 1.741 1.741 0 0 1 2.478-.463 1.869 1.869 0 0 1 .476 2.55.637.637 0 0 0-.071.5.646.646 0 0 0 .309.396.627.627 0 0 0 .869-.19l.027-.041a3.226 3.226 0 0 0-.956-4.492Zm-6.061 3.78-.044.066a3.228 3.228 0 0 0 .82 4.403 3.005 3.005 0 0 0 4.275-.798l.13-.197a.626.626 0 0 0 .092-.475.638.638 0 0 0-.268-.402.713.713 0 0 0-.99.26l-.018.029a1.741 1.741 0 0 1-2.477.461 1.87 1.87 0 0 1-.475-2.55l.029-.047a.647.647 0 0 0 .086-.485.66.66 0 0 0-.275-.408l-.04-.027a.609.609 0 0 0-.845.17Z"/><path d="M15.312 13.925c.24-.36.154-.838-.19-1.067-.346-.23-.82-.124-1.059.236l-1.268 1.907c-.239.36-.153.838.192 1.067.345.23.818.123 1.057-.236l1.268-1.907Z"/></svg>',alignBottom='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.239 13.938-2.88-1.663a.75.75 0 0 1 .75-1.3L9 12.067V4.75a.75.75 0 1 1 1.5 0v7.318l1.89-1.093a.75.75 0 0 1 .75 1.3l-2.879 1.663a.752.752 0 0 1-.511.187.752.752 0 0 1-.511-.187zM4.25 17a.75.75 0 1 1 0-1.5h10.5a.75.75 0 0 1 0 1.5H4.25z"/></svg>',alignMiddle='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.75 11.875a.752.752 0 0 1 .508.184l2.883 1.666a.75.75 0 0 1-.659 1.344l-.091-.044-1.892-1.093.001 4.318a.75.75 0 1 1-1.5 0v-4.317l-1.89 1.092a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .51-.187zM15.25 9a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM9.75.375a.75.75 0 0 1 .75.75v4.318l1.89-1.093.092-.045a.75.75 0 0 1 .659 1.344l-2.883 1.667a.752.752 0 0 1-.508.184.752.752 0 0 1-.511-.187L6.359 5.65a.75.75 0 0 1 .75-1.299L9 5.442V1.125a.75.75 0 0 1 .75-.75z"/></svg>',alignTop='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m10.261 7.062 2.88 1.663a.75.75 0 0 1-.75 1.3L10.5 8.933v7.317a.75.75 0 1 1-1.5 0V8.932l-1.89 1.093a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .511-.187.752.752 0 0 1 .511.187zM15.25 4a.75.75 0 1 1 0 1.5H4.75a.75.75 0 0 1 0-1.5h10.5z"/></svg>',alignLeft='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',alignCenter='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm2.286 4c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75z"/></svg>',alignRight='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M18 3.75a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 8a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 4a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75zm0-8a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75z"/></svg>',alignJustify='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',objectBlockLeft='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',objectCenter='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M15.003 7v5.5a1 1 0 0 1-1 1H5.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H6.5V12h6.997V7.5z"/></svg>',objectBlockRight='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',objectFullWidth='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18 7v5.5a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1zm-1.505.5H3.504V12h12.991V7.5z"/></svg>',objectInline='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',objectLeft='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zm0-3H18v1.5h-4.5zm0-3H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',objectRight='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2zm0-9h5v1.5H2zm0 3h5v1.5H2zm0 3h5v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',objectSizeFull='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M18.095 2H1.905C.853 2 0 2.895 0 4v12c0 1.105.853 2 1.905 2h16.19C19.147 18 20 17.105 20 16V4c0-1.105-.853-2-1.905-2zm0 1.5c.263 0 .476.224.476.5v12c0 .276-.213.5-.476.5H1.905a.489.489 0 0 1-.476-.5V4c0-.276.213-.5.476-.5h16.19z"/></svg>',objectSizeCustom='<svg xmlns="http://www.w3.org/2000/svg" xmlns:v="https://vecta.io/nano" viewBox="0 0 20 20"><path d="M.95 1.43a.95.95 0 0 0-.95.95v3.1a.95.95 0 0 0 .95.95h.75v6.3H.95a.95.95 0 0 0-.95.95v3.1a.95.95 0 0 0 .95.95h3.1a.95.95 0 0 0 .95-.95v-.65h1.932l1.539-1.5H5v-.95a.95.95 0 0 0-.95-.95H3.2v-6.3h.85A.95.95 0 0 0 5 5.48v-.55h10v.55a.95.95 0 0 0 .95.95h3.1a.95.95 0 0 0 .95-.95v-3.1a.95.95 0 0 0-.95-.95h-3.1a.95.95 0 0 0-.95.95v1.05H5V2.38a.95.95 0 0 0-.95-.95H.95zm.55 3.5v-2h2v2h-2zm0 9.3v2h2v-2h-2zm15-11.3v2h2v-2h-2z"/><path d="M8.139 20.004v-2.388l7.045-7.048 2.391 2.391-7.046 7.046h-2.39zm11.421-9.101a.64.64 0 0 1-.138.206l-1.165 1.168-2.391-2.391 1.167-1.163a.63.63 0 0 1 .206-.138.635.635 0 0 1 .243-.049.63.63 0 0 1 .449.187l1.491 1.488c.059.059.108.129.138.206s.049.16.049.243a.6.6 0 0 1-.049.243z"/></svg>',objectSizeLarge='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 16.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1ZM1 15v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 13v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 11v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 9v1H0V9h1Zm19 0v1h-1V9h1ZM1 7v1H0V7h1Zm19 0v1h-1V7h1ZM1 5v1H0V5h1Zm19 0v1h-1V5h1Zm0-2v1h-1V3h1ZM1 3v1H0V3h1Zm13.5-1.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm-8 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm8 0v1h-1v-1h1Zm-10 0v1h-1v-1h1Z"/><path d="M13 5.5H2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2v-8a2 2 0 0 0-2-2ZM13 7a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-8A.5.5 0 0 1 2 7h11Z"/></svg>',objectSizeSmall='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 16.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1ZM1 15v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 13v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 11v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 9v1H0V9h1Zm19 0v1h-1V9h1ZM1 7v1H0V7h1Zm19 0v1h-1V7h1ZM1 5v1H0V5h1Zm19 0v1h-1V5h1Zm0-2v1h-1V3h1ZM1 3v1H0V3h1Zm13.5-1.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm-8 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm8 0v1h-1v-1h1Zm-10 0v1h-1v-1h1Z"/><path d="M7 9.5H2a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h5a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2ZM7 11a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-4A.5.5 0 0 1 2 11h5Z"/></svg>',objectSizeMedium='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 16.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1ZM1 15v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 13v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 11v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 9v1H0V9h1Zm19 0v1h-1V9h1ZM1 7v1H0V7h1Zm19 0v1h-1V7h1ZM1 5v1H0V5h1Zm19 0v1h-1V5h1Zm0-2v1h-1V3h1ZM1 3v1H0V3h1Zm13.5-1.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm-8 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm8 0v1h-1v-1h1Zm-10 0v1h-1v-1h1Z"/><path d="M10 7.5H2a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-6a2 2 0 0 0-2-2ZM10 9a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-6A.5.5 0 0 1 2 9h8Z"/></svg>',pencil='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m7.3 17.37-.061.088a1.518 1.518 0 0 1-.934.535l-4.178.663-.806-4.153a1.495 1.495 0 0 1 .187-1.058l.056-.086L8.77 2.639c.958-1.351 2.803-1.076 4.296-.03 1.497 1.047 2.387 2.693 1.433 4.055L7.3 17.37zM9.14 4.728l-5.545 8.346 3.277 2.294 5.544-8.346L9.14 4.728zM6.07 16.512l-3.276-2.295.53 2.73 2.746-.435zM9.994 3.506 13.271 5.8c.316-.452-.16-1.333-1.065-1.966-.905-.634-1.895-.78-2.212-.328zM8 18.5 9.375 17H19v1.5H8z"/></svg>',pilcrow='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.999 2H15a1 1 0 0 1 0 2h-1.004v13a1 1 0 1 1-2 0V4H8.999v13a1 1 0 1 1-2 0v-7A4 4 0 0 1 3 6a4 4 0 0 1 3.999-4z"/></svg>',quote='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 10.423a6.5 6.5 0 0 1 6.056-6.408l.038.67C6.448 5.423 5.354 7.663 5.22 10H9c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574zm8 0a6.5 6.5 0 0 1 6.056-6.408l.038.67c-2.646.739-3.74 2.979-3.873 5.315H17c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574z"/></svg>',threeVerticalDots='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="9.5" cy="4.5" r="1.5"/><circle cx="9.5" cy="10.5" r="1.5"/><circle cx="9.5" cy="16.5" r="1.5"/></svg>',dragIndicator='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5 3.25a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M12 3.25a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M5 10a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M12 10a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M5 16.75a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M12 16.75a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/></svg>',bold='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.187 17H5.773c-.637 0-1.092-.138-1.364-.415-.273-.277-.409-.718-.409-1.323V4.738c0-.617.14-1.062.419-1.332.279-.27.73-.406 1.354-.406h4.68c.69 0 1.288.041 1.793.124.506.083.96.242 1.36.478.341.197.644.447.906.75a3.262 3.262 0 0 1 .808 2.162c0 1.401-.722 2.426-2.167 3.075C15.05 10.175 16 11.315 16 13.01a3.756 3.756 0 0 1-2.296 3.504 6.1 6.1 0 0 1-1.517.377c-.571.073-1.238.11-2 .11zm-.217-6.217H7v4.087h3.069c1.977 0 2.965-.69 2.965-2.072 0-.707-.256-1.22-.768-1.537-.512-.319-1.277-.478-2.296-.478zM7 5.13v3.619h2.606c.729 0 1.292-.067 1.69-.2a1.6 1.6 0 0 0 .91-.765c.165-.267.247-.566.247-.897 0-.707-.26-1.176-.778-1.409-.519-.232-1.31-.348-2.375-.348H7z"/></svg>',paragraph='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.5 5.5H7v5h3.5a2.5 2.5 0 1 0 0-5zM5 3h6.5v.025a5 5 0 0 1 0 9.95V13H7v4a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1z"/></svg>',plus='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 0 0-1 1v6H3a1 1 0 1 0 0 2h6v6a1 1 0 1 0 2 0v-6h6a1 1 0 1 0 0-2h-6V3a1 1 0 0 0-1-1Z"/></svg>',text='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.816 11.5 7.038 4.785 4.261 11.5h5.555Zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663L10.436 13Z"/><path d="m12.09 17-.534-1.292.848-1.971.545 1.319L12.113 17h-.023Zm1.142-5.187.545 1.319L15.5 9.13l1.858 4.316h-3.45l.398.965h3.467L18.887 17H20l-3.873-9h-1.254l-1.641 3.813Z"/></svg>',importExport='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M19 4.5 14 0H3v12.673l.868-1.041c.185-.222.4-.402.632-.54V1.5h8v5h5v7.626a2.24 2.24 0 0 1 1.5.822V4.5ZM14 5V2l3.3 3H14Zm-3.692 12.5c.062.105.133.206.213.303L11.52 19H8v-.876a2.243 2.243 0 0 0 1.82-.624h.488Zm7.518-.657a.75.75 0 0 0-1.152-.96L15.5 17.29V12H14v5.29l-1.174-1.408a.75.75 0 0 0-1.152.96l2.346 2.816a.95.95 0 0 0 1.46 0l2.346-2.815Zm-15.056-.38a.75.75 0 0 1-.096-1.056l2.346-2.815a.95.95 0 0 1 1.46 0l2.346 2.815a.75.75 0 1 1-1.152.96L6.5 14.96V20H5v-5.04l-1.174 1.408a.75.75 0 0 1-1.056.096Z"/></svg>',redo='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m14.958 9.367-2.189 1.837a.75.75 0 0 0 .965 1.149l3.788-3.18a.747.747 0 0 0 .21-.284.75.75 0 0 0-.17-.945L13.77 4.762a.75.75 0 1 0-.964 1.15l2.331 1.955H6.22A.75.75 0 0 0 6 7.9a4 4 0 1 0 1.477 7.718l-.344-1.489A2.5 2.5 0 1 1 6.039 9.4l-.008-.032h8.927z"/></svg>',undo='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m5.042 9.367 2.189 1.837a.75.75 0 0 1-.965 1.149l-3.788-3.18a.747.747 0 0 1-.21-.284.75.75 0 0 1 .17-.945L6.23 4.762a.75.75 0 1 1 .964 1.15L4.863 7.866h8.917A.75.75 0 0 1 14 7.9a4 4 0 1 1-1.477 7.718l.344-1.489a2.5 2.5 0 1 0 1.094-4.73l.008-.032H5.042z"/></svg>',bulletedList='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0C1 4.784 1.777 4 2.75 4c.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75C1.784 7.5 1 6.723 1 5.75zm6 9c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0c0-.966.777-1.75 1.75-1.75.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75-.966 0-1.75-.777-1.75-1.75z"/></svg>',numberedList='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM3.5 3v5H2V3.7H1v-1h2.5V3zM.343 17.857l2.59-3.257H2.92a.6.6 0 1 0-1.04 0H.302a2 2 0 1 1 3.995 0h-.001c-.048.405-.16.734-.333.988-.175.254-.59.692-1.244 1.312H4.3v1h-4l.043-.043zM7 14.75a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>',todoList='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m2.315 14.705 2.224-2.24a.689.689 0 0 1 .963 0 .664.664 0 0 1 0 .949L2.865 16.07a.682.682 0 0 1-.112.089.647.647 0 0 1-.852-.051L.688 14.886a.635.635 0 0 1 0-.903.647.647 0 0 1 .91 0l.717.722zm5.185.045a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75zM2.329 5.745l2.21-2.226a.689.689 0 0 1 .963 0 .664.664 0 0 1 0 .95L2.865 7.125a.685.685 0 0 1-.496.196.644.644 0 0 1-.468-.187L.688 5.912a.635.635 0 0 1 0-.903.647.647 0 0 1 .91 0l.73.736zM7.5 5.75A.75.75 0 0 1 8.25 5h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>',codeBlock='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.87 12.61a.75.75 0 0 1-.089.976l-.085.07-3.154 2.254 3.412 2.414a.75.75 0 0 1 .237.95l-.057.095a.75.75 0 0 1-.95.237l-.096-.058-4.272-3.022-.003-1.223 4.01-2.867a.75.75 0 0 1 1.047.174zm2.795-.231.095.057 4.011 2.867-.003 1.223-4.272 3.022-.095.058a.75.75 0 0 1-.88-.151l-.07-.086-.058-.095a.75.75 0 0 1 .15-.88l.087-.07 3.412-2.414-3.154-2.253-.085-.071a.75.75 0 0 1 .862-1.207zM16 0a2 2 0 0 1 2 2v9.354l-.663-.492-.837-.001V2a.5.5 0 0 0-.5-.5H2a.5.5 0 0 0-.5.5v15a.5.5 0 0 0 .5.5h3.118L7.156 19H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h14zM5.009 15l.003 1H3v-1h2.009zm2.188-2-1.471 1H5v-1h2.197zM10 11v.095L8.668 12H7v-1h3zm4-2v1H7V9h7zm0-2v1H7V7h7zm-4-2v1H5V5h5zM6 3v1H3V3h3z"/></svg>',browseFiles='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.627 16.5zm5.873-.196zm0-7.001V8h-13v8.5h4.341c.191.54.457 1.044.785 1.5H2a1.5 1.5 0 0 1-1.5-1.5v-13A1.5 1.5 0 0 1 2 2h4.5a1.5 1.5 0 0 1 1.06.44L9.122 4H16a1.5 1.5 0 0 1 1.5 1.5v1A1.5 1.5 0 0 1 19 8v2.531a6.027 6.027 0 0 0-1.5-1.228zM16 6.5v-1H8.5l-2-2H2v13h1V8a1.5 1.5 0 0 1 1.5-1.5H16z"/><path d="M14.5 19.5a5 5 0 1 1 0-10 5 5 0 0 1 0 10zM15 14v-2h-1v2h-2v1h2v2h1v-2h2v-1h-2z"/></svg>',heading1='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M19 9v10h-2v-8h-2V9h4zM4 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1H10a1 1 0 0 1-1-1V11H4v4.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1H3a1 1 0 0 1 1 1v4.5z"/></svg>',heading2='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1V11H3v4.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1H2a1 1 0 0 1 1 1v4.5zm16.076 8.343V18.5h-6.252c.067-.626.27-1.22.61-1.78.338-.561 1.006-1.305 2.005-2.232.804-.749 1.297-1.257 1.479-1.523.245-.368.368-.732.368-1.092 0-.398-.107-.703-.32-.917-.214-.214-.51-.32-.886-.32-.372 0-.669.111-.889.336-.22.224-.347.596-.38 1.117l-1.778-.178c.106-.982.438-1.686.997-2.114.558-.427 1.257-.64 2.095-.64.918 0 1.64.247 2.164.742.525.495.787 1.11.787 1.847 0 .419-.075.818-.225 1.197-.15.378-.388.775-.714 1.19-.216.275-.605.67-1.168 1.187-.563.516-.92.859-1.07 1.028a3.11 3.11 0 0 0-.365.495h3.542z"/></svg>',heading3='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1V11H3v4.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1H2a1 1 0 0 1 1 1v4.5zm9.989 7.53 1.726-.209c.055.44.203.777.445 1.01.24.232.533.349.876.349.368 0 .678-.14.93-.42.251-.279.377-.655.377-1.13 0-.448-.12-.803-.362-1.066a1.153 1.153 0 0 0-.882-.393c-.228 0-.501.044-.819.133l.197-1.453c.482.012.85-.092 1.105-.315.253-.222.38-.517.38-.885 0-.313-.093-.563-.279-.75-.186-.185-.434-.278-.743-.278a1.07 1.07 0 0 0-.78.317c-.216.212-.347.52-.394.927l-1.644-.28c.114-.562.287-1.012.517-1.348.231-.337.553-.601.965-.794a3.24 3.24 0 0 1 1.387-.289c.876 0 1.579.28 2.108.838.436.457.653.973.653 1.549 0 .817-.446 1.468-1.339 1.955.533.114.96.37 1.28.768.319.398.478.878.478 1.441 0 .817-.298 1.513-.895 2.088-.596.576-1.339.864-2.228.864-.842 0-1.54-.243-2.094-.727-.555-.485-.876-1.118-.965-1.901z"/></svg>',heading4='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V11h-5v4.5a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v4.5zm13.55 10v-1.873h-3.81v-1.561l4.037-5.91h1.498v5.904h1.156v1.567h-1.156V18.5H17.05zm0-3.44v-3.18l-2.14 3.18h2.14z"/></svg>',heading5='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V11h-5v4.5a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v4.5zm9.578 7.607 1.777-.184c.05.402.201.72.45.955a1.223 1.223 0 0 0 1.81-.101c.258-.303.387-.759.387-1.368 0-.572-.128-1-.384-1.286-.256-.285-.59-.428-1-.428-.512 0-.971.226-1.377.679l-1.448-.21.915-4.843h4.716v1.67H15.56l-.28 1.58a2.697 2.697 0 0 1 1.219-.298 2.68 2.68 0 0 1 2.012.863c.55.576.825 1.323.825 2.241a3.36 3.36 0 0 1-.666 2.05c-.605.821-1.445 1.232-2.52 1.232-.86 0-1.56-.23-2.101-.692-.542-.461-.866-1.081-.971-1.86z"/></svg>',heading6='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V11h-5v4.5a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v4.5zm15.595 2.973-1.726.19c-.043-.355-.153-.617-.33-.787-.178-.169-.409-.253-.692-.253-.377 0-.695.169-.956.507-.26.339-.424 1.043-.492 2.114.445-.525.997-.787 1.657-.787.745 0 1.383.284 1.914.85.531.568.797 1.3.797 2.197 0 .952-.28 1.716-.838 2.291-.559.576-1.276.864-2.152.864-.94 0-1.712-.365-2.317-1.095-.605-.73-.908-1.927-.908-3.59 0-1.705.316-2.935.946-3.688.63-.753 1.45-1.13 2.457-1.13.706 0 1.291.198 1.755.594.463.395.758.97.885 1.723zm-4.043 3.891c0 .58.133 1.028.4 1.343.266.315.57.473.914.473.33 0 .605-.13.825-.388.22-.258.33-.68.33-1.27 0-.604-.118-1.047-.355-1.329a1.115 1.115 0 0 0-.89-.422c-.342 0-.632.134-.869.403s-.355.666-.355 1.19z"/></svg>',horizontalLine='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 9h16v2H2z"/></svg>',html='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17 0a2 2 0 0 1 2 2v7a1 1 0 0 1 1 1v5a1 1 0 0 1-.883.993l-.118.006L19 17a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2l-.001-1.001-.116-.006A1 1 0 0 1 0 15v-5a1 1 0 0 1 .999-1L1 2a2 2 0 0 1 2-2h14zm.499 15.999h-15L2.5 17a.5.5 0 0 0 .5.5h14a.5.5 0 0 0 .5-.5l-.001-1.001zm-3.478-6.013-.014.014H14v.007l-1.525 1.525-1.46-1.46-.015.013V10h-1v5h1v-3.53l1.428 1.43.048.043.131-.129L14 11.421V15h1v-5h-.965l-.014-.014zM2 10H1v5h1v-2h2v2h1v-5H4v2H2v-2zm7 0H6v1h1v4h1v-4h1v-1zm8 0h-1v5h3v-1h-2v-4zm0-8.5H3a.5.5 0 0 0-.5.5l-.001 6.999h15L17.5 2a.5.5 0 0 0-.5-.5zM10 7v1H4V7h6zm3-2v1H4V5h9zm-3-2v1H4V3h6z"/></svg>',indent='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zM1.632 6.95 5.02 9.358a.4.4 0 0 1-.013.661l-3.39 2.207A.4.4 0 0 1 1 11.892V7.275a.4.4 0 0 1 .632-.326z"/></svg>',outdent='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zm1.618-9.55L.98 9.358a.4.4 0 0 0 .013.661l3.39 2.207A.4.4 0 0 0 5 11.892V7.275a.4.4 0 0 0-.632-.326z"/></svg>',table='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 5.5v3h4v-3H3Zm0 4v3h4v-3H3Zm0 4v3h4v-3H3Zm5 3h4v-3H8v3Zm5 0h4v-3h-4v3Zm4-4v-3h-4v3h4Zm0-4v-3h-4v3h4Zm1.5 8A1.5 1.5 0 0 1 17 18H3a1.5 1.5 0 0 1-1.5-1.5V3c.222-.863 1.068-1.5 2-1.5h13c.932 0 1.778.637 2 1.5v13.5Zm-6.5-4v-3H8v3h4Zm0-4v-3H8v3h4Z"/></svg>',remove4='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.2 7h9.2c.6 0 1 .4 1 1v9.9c0 .5-.4 1-1 1H5.2a1 1 0 0 1-1-1V8c0-.6.4-1 1-1Zm1 1.5c-.3 0-.5.2-.5.5v8c0 .3.2.5.5.5h.5c.2 0 .5-.2.5-.5V9c0-.3-.3-.5-.5-.5h-.5Zm3.2 0c-.2 0-.5.2-.5.5v8c0 .3.3.5.5.5h.5c.3 0 .5-.2.5-.5V9c0-.3-.2-.5-.5-.5h-.5Zm3.5 0c-.2 0-.5.2-.5.5v8c0 .3.3.5.5.5h.5c.3 0 .5-.2.5-.5V9c0-.3-.2-.5-.5-.5h-.5Zm-1.4-7.1H8.3L6.5 3.6H3.8c-.5 0-.7.3-.7.8s.2.7.7.7h12c.6 0 .9-.2.9-.7 0-.5-.3-.8-1-.8h-2.4l-1.8-2.2Z"/></svg>',bookmark='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M5.68 3.417a.238.238 0 0 0-.24.236v12.66l3.793-3.102a1.215 1.215 0 0 1 1.534 0l3.793 3.103V3.654a.238.238 0 0 0-.24-.237H5.68ZM4 3.653C4 2.74 4.752 2 5.68 2h8.64c.928 0 1.68.74 1.68 1.653v13.164c0 1-1.185 1.547-1.967.908L10 14.426l-4.033 3.299c-.782.64-1.967.092-1.967-.908V3.653Z"/></svg>',bookmarkInline='<svg viewBox="0 0 14 16" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M2 14.436V2a1 1 0 0 1 1-1h8a1 1 0 0 1 1 1v12.436a.5.5 0 0 1-.819.385l-3.862-3.2a.5.5 0 0 0-.638 0l-3.862 3.2A.5.5 0 0 1 2 14.436Z"/></svg>',icons={bold,cancel,caption,check,cog,colorPalette,eraser,history,image,imageUpload,imageAssetManager,imageUrl,lowVision,textAlternative,loupe,previousArrow,nextArrow,importExport,paragraph,plus,text,alignBottom,alignMiddle,alignTop,alignLeft,alignCenter,alignRight,alignJustify,objectLeft,objectCenter,objectRight,objectFullWidth,objectInline,objectBlockLeft,objectBlockRight,objectSizeCustom,objectSizeFull,objectSizeLarge,objectSizeSmall,objectSizeMedium,pencil,pilcrow,quote,threeVerticalDots,dragIndicator,redo,undo,bulletedList,numberedList,todoList,codeBlock,browseFiles,heading1,heading2,heading3,heading4,heading5,heading6,horizontalLine,html,indent,outdent,table,remove:remove4,bookmark,bookmarkInline},import_color_name=__toESM(require_color_name(),1),color_parse_default=parse5,baseHues={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function parse5(e){var t,r=[],i=1,o;if(typeof e=="string")if(import_color_name.default[e])r=import_color_name.default[e].slice(),o="rgb";else if(e==="transparent")i=0,o="rgb",r=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(e)){var a=e.slice(1),c=a.length,u=c<=4;i=1,u?(r=[parseInt(a[0]+a[0],16),parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16)],c===4&&(i=parseInt(a[3]+a[3],16)/255)):(r=[parseInt(a[0]+a[1],16),parseInt(a[2]+a[3],16),parseInt(a[4]+a[5],16)],c===8&&(i=parseInt(a[6]+a[7],16)/255)),r[0]||(r[0]=0),r[1]||(r[1]=0),r[2]||(r[2]=0),o="rgb"}else if(t=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(e)){var h=t[1],d=h==="rgb",a=h.replace(/a$/,"");o=a;var c=a==="cmyk"?4:a==="gray"?1:3;r=t[2].trim().split(/\s*[,\/]\s*|\s+/).map(function(g,v){if(/%$/.test(g))return v===c?parseFloat(g)/100:a==="rgb"?parseFloat(g)*255/100:parseFloat(g);if(a[v]==="h"){if(/deg$/.test(g))return parseFloat(g);if(baseHues[g]!==void 0)return baseHues[g]}return parseFloat(g)}),h===a&&r.push(1),i=d||r[c]===void 0?1:r[c],r=r.slice(0,c)}else e.length>10&&/[0-9](?:\s|\/)/.test(e)&&(r=e.match(/([0-9]+)/g).map(function(f){return parseFloat(f)}),o=e.match(/([a-z])/ig).join("").toLowerCase());else isNaN(e)?Array.isArray(e)||e.length?(r=[e[0],e[1],e[2]],o="rgb",i=e.length===4?e[3]:1):e instanceof Object&&(e.r!=null||e.red!=null||e.R!=null?(o="rgb",r=[e.r||e.red||e.R||0,e.g||e.green||e.G||0,e.b||e.blue||e.B||0]):(o="hsl",r=[e.h||e.hue||e.H||0,e.s||e.saturation||e.S||0,e.l||e.lightness||e.L||e.b||e.brightness]),i=e.a||e.alpha||e.opacity||1,e.opacity!=null&&(i/=100)):(o="rgb",r=[e>>>16,(e&65280)>>>8,e&255]);return{space:o,values:r,alpha:i}}var convert=__toESM(require_color_convert(),1),clamp2=(e,t=0,r=1)=>e>r?r:e<t?t:e,round2=(e,t=0,r=Math.pow(10,t))=>Math.round(r*e)/r,angleUnits={grad:360/400,turn:360,rad:360/(Math.PI*2)},hexToHsva=e=>rgbaToHsva(hexToRgba(e)),hexToRgba=e=>(e[0]==="#"&&(e=e.substring(1)),e.length<6?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:e.length===4?round2(parseInt(e[3]+e[3],16)/255,2):1}:{r:parseInt(e.substring(0,2),16),g:parseInt(e.substring(2,4),16),b:parseInt(e.substring(4,6),16),a:e.length===8?round2(parseInt(e.substring(6,8),16)/255,2):1}),hsvaToHex=e=>rgbaToHex(hsvaToRgba(e)),hsvaToHsla=({h:e,s:t,v:r,a:i})=>{const o=(200-t)*r/100;return{h:round2(e),s:round2(o>0&&o<200?t*r/100/(o<=100?o:200-o)*100:0),l:round2(o/2),a:round2(i,2)}},hsvaToHslString=e=>{const{h:t,s:r,l:i}=hsvaToHsla(e);return`hsl(${t}, ${r}%, ${i}%)`},hsvaToRgba=({h:e,s:t,v:r,a:i})=>{e=e/360*6,t=t/100,r=r/100;const o=Math.floor(e),a=r*(1-t),c=r*(1-(e-o)*t),u=r*(1-(1-e+o)*t),h=o%6;return{r:round2([r,c,a,a,u,r][h]*255),g:round2([u,r,r,c,a,a][h]*255),b:round2([a,a,u,r,r,c][h]*255),a:round2(i,2)}},format2=e=>{const t=e.toString(16);return t.length<2?"0"+t:t},rgbaToHex=({r:e,g:t,b:r,a:i})=>{const o=i<1?format2(round2(i*255)):"";return"#"+format2(e)+format2(t)+format2(r)+o},rgbaToHsva=({r:e,g:t,b:r,a:i})=>{const o=Math.max(e,t,r),a=o-Math.min(e,t,r),c=a?o===e?(t-r)/a:o===t?2+(r-e)/a:4+(e-t)/a:0;return{h:round2(60*(c<0?c+6:c)),s:round2(o?a/o*100:0),v:round2(o/255*100),a:i}},equalColorObjects=(e,t)=>{if(e===t)return!0;for(const r in e)if(e[r]!==t[r])return!1;return!0},equalHex=(e,t)=>e.toLowerCase()===t.toLowerCase()?!0:equalColorObjects(hexToRgba(e),hexToRgba(t)),cache={},tpl=e=>{let t=cache[e];return t||(t=document.createElement("template"),t.innerHTML=e,cache[e]=t),t},fire=(e,t,r)=>{e.dispatchEvent(new CustomEvent(t,{bubbles:!0,detail:r}))},hasTouched=!1,isTouch=e=>"touches"in e,isValid=e=>hasTouched&&!isTouch(e)?!1:(hasTouched||(hasTouched=isTouch(e)),!0),pointerMove=(e,t)=>{const r=isTouch(t)?t.touches[0]:t,i=e.el.getBoundingClientRect();fire(e.el,"move",e.getMove({x:clamp2((r.pageX-(i.left+window.pageXOffset))/i.width),y:clamp2((r.pageY-(i.top+window.pageYOffset))/i.height)}))},keyMove=(e,t)=>{const r=t.keyCode;r>40||e.xy&&r<37||r<33||(t.preventDefault(),fire(e.el,"move",e.getMove({x:r===39?.01:r===37?-.01:r===34?.05:r===33?-.05:r===35?1:r===36?-1:0,y:r===40?.01:r===38?-.01:0},!0)))},Slider=class{constructor(e,t,r,i){const o=tpl(`<div role="slider" tabindex="0" part="${t}" ${r}><div part="${t}-pointer"></div></div>`);e.appendChild(o.content.cloneNode(!0));const a=e.querySelector(`[part=${t}]`);a.addEventListener("mousedown",this),a.addEventListener("touchstart",this),a.addEventListener("keydown",this),this.el=a,this.xy=i,this.nodes=[a.firstChild,a]}set dragging(e){const t=e?document.addEventListener:document.removeEventListener;t(hasTouched?"touchmove":"mousemove",this),t(hasTouched?"touchend":"mouseup",this)}handleEvent(e){switch(e.type){case"mousedown":case"touchstart":if(e.preventDefault(),!isValid(e)||!hasTouched&&e.button!=0)return;this.el.focus(),pointerMove(this,e),this.dragging=!0;break;case"mousemove":case"touchmove":e.preventDefault(),pointerMove(this,e);break;case"mouseup":case"touchend":this.dragging=!1;break;case"keydown":keyMove(this,e);break}}style(e){e.forEach((t,r)=>{for(const i in t)this.nodes[r].style.setProperty(i,t[i])})}},Hue=class extends Slider{constructor(e){super(e,"hue",'aria-label="Hue" aria-valuemin="0" aria-valuemax="360"',!1)}update({h:e}){this.h=e,this.style([{left:`${e/360*100}%`,color:hsvaToHslString({h:e,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuenow",`${round2(e)}`)}getMove(e,t){return{h:t?clamp2(this.h+e.x*360,0,360):360*e.x}}},Saturation=class extends Slider{constructor(e){super(e,"saturation",'aria-label="Color"',!0)}update(e){this.hsva=e,this.style([{top:`${100-e.v}%`,left:`${e.s}%`,color:hsvaToHslString(e)},{"background-color":hsvaToHslString({h:e.h,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuetext",`Saturation ${round2(e.s)}%, Brightness ${round2(e.v)}%`)}getMove(e,t){return{s:t?clamp2(this.hsva.s+e.x*100,0,100):e.x*100,v:t?clamp2(this.hsva.v-e.y*100,0,100):Math.round(100-e.y*100)}}},color_picker_default=':host{display:flex;flex-direction:column;position:relative;width:200px;height:200px;user-select:none;-webkit-user-select:none;cursor:default}:host([hidden]){display:none!important}[role=slider]{position:relative;touch-action:none;user-select:none;-webkit-user-select:none;outline:0}[role=slider]:last-child{border-radius:0 0 8px 8px}[part$=pointer]{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;display:flex;place-content:center center;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}[part$=pointer]::after{content:"";width:100%;height:100%;border-radius:inherit;background-color:currentColor}[role=slider]:focus [part$=pointer]{transform:translate(-50%,-50%) scale(1.1)}',hue_default="[part=hue]{flex:0 0 24px;background:linear-gradient(to right,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red 100%)}[part=hue-pointer]{top:50%;z-index:2}",saturation_default="[part=saturation]{flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(to top,#000,transparent),linear-gradient(to right,#fff,rgba(255,255,255,0));box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part=saturation-pointer]{z-index:3}",$isSame=Symbol("same"),$color=Symbol("color"),$hsva=Symbol("hsva"),$update=Symbol("update"),$parts=Symbol("parts"),$css=Symbol("css"),$sliders=Symbol("sliders"),ColorPicker=class extends HTMLElement{static get observedAttributes(){return["color"]}get[$css](){return[color_picker_default,hue_default,saturation_default]}get[$sliders](){return[Saturation,Hue]}get color(){return this[$color]}set color(e){if(!this[$isSame](e)){const t=this.colorModel.toHsva(e);this[$update](t),this[$color]=e}}constructor(){super();const e=tpl(`<style>${this[$css].join("")}</style>`),t=this.attachShadow({mode:"open"});t.appendChild(e.content.cloneNode(!0)),t.addEventListener("move",this),this[$parts]=this[$sliders].map(r=>new r(t))}connectedCallback(){if(this.hasOwnProperty("color")){const e=this.color;delete this.color,this.color=e}else this.color||(this.color=this.colorModel.defaultColor)}attributeChangedCallback(e,t,r){const i=this.colorModel.fromAttr(r);this[$isSame](i)||(this.color=i)}handleEvent(e){const t=this[$hsva],r={...t,...e.detail};this[$update](r);let i;!equalColorObjects(r,t)&&!this[$isSame](i=this.colorModel.fromHsva(r))&&(this[$color]=i,fire(this,"color-changed",{value:i}))}[$isSame](e){return this.color&&this.colorModel.equal(e,this.color)}[$update](e){this[$hsva]=e,this[$parts].forEach(t=>t.update(e))}},colorModel={defaultColor:"#000",toHsva:hexToHsva,fromHsva:({h:e,s:t,v:r})=>hsvaToHex({h:e,s:t,v:r,a:1}),equal:equalHex,fromAttr:e=>e},HexBase=class extends ColorPicker{get colorModel(){return colorModel}},ViewCollection=class extends Collection{_parentElement;constructor(e=[]){super(e,{idProperty:"viewUid"}),this.on("add",(t,r,i)=>{this._renderViewIntoCollectionParent(r,i)}),this.on("remove",(t,r)=>{r.element&&this._parentElement&&r.element.remove()}),this._parentElement=null}destroy(){this.map(e=>e.destroy())}setParent(e){this._parentElement=e;for(const t of this)this._renderViewIntoCollectionParent(t)}delegate(...e){if(!e.length||!isStringArray2(e))throw new CKEditorError("ui-viewcollection-delegate-wrong-events",this);return{to:t=>{for(const r of this)for(const i of e)r.delegate(i).to(t);this.on("add",(r,i)=>{for(const o of e)i.delegate(o).to(t)}),this.on("remove",(r,i)=>{for(const o of e)i.stopDelegating(o,t)})}}}_renderViewIntoCollectionParent(e,t){e.isRendered||e.render(),e.element&&this._parentElement&&this._parentElement.insertBefore(e.element,this._parentElement.children[t])}remove(e){return super.remove(e)}};function isStringArray2(e){return e.every(t=>typeof t=="string")}var xhtmlNs="http://www.w3.org/1999/xhtml",Template=class extends EmitterMixin(){ns;tag;text;attributes;children;eventListeners;_isRendered;_revertData;constructor(e){super(),Object.assign(this,normalize3(clone7(e))),this._isRendered=!1,this._revertData=null}render(){const e=this._renderNode({intoFragment:!0});return this._isRendered=!0,e}apply(e){return this._revertData=getEmptyRevertData(),this._renderNode({node:e,intoFragment:!1,isApplying:!0,revertData:this._revertData}),e}revert(e){if(!this._revertData)throw new CKEditorError("ui-template-revert-not-applied",[this,e]);this._revertTemplateFromNode(e,this._revertData)}*getViews(){function*e(t){if(t.children)for(const r of t.children)isView(r)?yield r:isTemplate(r)&&(yield*e(r))}yield*e(this)}static bind(e,t){return{to(r,i){return new TemplateToBinding({eventNameOrFunction:r,attribute:r,observable:e,emitter:t,callback:i})},if(r,i,o){return new TemplateIfBinding({observable:e,emitter:t,attribute:r,valueIfTrue:i,callback:o})}}}static extend(e,t){if(e._isRendered)throw new CKEditorError("template-extend-render",[this,e]);extendTemplate(e,normalize3(clone7(t)))}_renderNode(e){let t;if(e.node?t=this.tag&&this.text:t=this.tag?this.text:!this.text,t)throw new CKEditorError("ui-template-wrong-syntax",this);return this.text?this._renderText(e):this._renderElement(e)}_renderElement(e){let t=e.node;return t||(t=e.node=document.createElementNS(this.ns||xhtmlNs,this.tag)),this._renderAttributes(e),this._renderElementChildren(e),this._setUpListeners(e),t}_renderText(e){let t=e.node;return t?e.revertData.text=t.textContent:t=e.node=document.createTextNode(""),hasTemplateBinding(this.text)?this._bindToObservable({schema:this.text,updater:getTextUpdater(t),data:e}):t.textContent=this.text.join(""),t}_renderAttributes(e){if(!this.attributes)return;const t=e.node,r=e.revertData;for(const i in this.attributes){const o=t.getAttribute(i),a=this.attributes[i];r&&(r.attributes[i]=o);const c=isNamespaced(a)?a[0].ns:null;if(hasTemplateBinding(a)){const u=isNamespaced(a)?a[0].value:a;r&&shouldExtend(i)&&u.unshift(o),this._bindToObservable({schema:u,updater:getAttributeUpdater(t,i,c),data:e})}else if(i=="style"&&typeof a[0]!="string")this._renderStyleAttribute(a[0],e);else{r&&o&&shouldExtend(i)&&a.unshift(o);const u=a.map(h=>h&&(h.value||h)).reduce((h,d)=>h.concat(d),[]).reduce(arrayValueReducer,"");isFalsy(u)||t.setAttributeNS(c,i,u)}}}_renderStyleAttribute(e,t){const r=t.node;for(const i in e){const o=e[i];hasTemplateBinding(o)?this._bindToObservable({schema:[o],updater:getStyleUpdater(r,i),data:t}):r.style[i]=o}}_renderElementChildren(e){const t=e.node,r=e.intoFragment?document.createDocumentFragment():t,i=e.isApplying;let o=0;for(const a of this.children)if(isViewCollection(a)){if(!i){a.setParent(t);for(const c of a)r.appendChild(c.element)}}else if(isView(a))i||(a.isRendered||a.render(),r.appendChild(a.element));else if(isNode(a))r.appendChild(a);else if(i){const c=e.revertData,u=getEmptyRevertData();c.children.push(u),a._renderNode({intoFragment:!1,node:r.childNodes[o++],isApplying:!0,revertData:u})}else r.appendChild(a.render());e.intoFragment&&t.appendChild(r)}_setUpListeners(e){if(this.eventListeners)for(const t in this.eventListeners){const r=this.eventListeners[t].map(i=>{const[o,a]=t.split("@");return i.activateDomEventListener(o,a,e)});e.revertData&&e.revertData.bindings.push(r)}}_bindToObservable({schema:e,updater:t,data:r}){const i=r.revertData;syncValueSchemaValue(e,t,r);const o=e.filter(a=>!isFalsy(a)).filter(a=>a.observable).map(a=>a.activateAttributeListener(e,t,r));i&&i.bindings.push(o)}_revertTemplateFromNode(e,t){for(const i of t.bindings)for(const o of i)o();if(t.text){e.textContent=t.text;return}const r=e;for(const i in t.attributes){const o=t.attributes[i];o===null?r.removeAttribute(i):r.setAttribute(i,o)}for(let i=0;i<t.children.length;++i)this._revertTemplateFromNode(r.childNodes[i],t.children[i])}},TemplateBinding=class{attribute;observable;emitter;callback;constructor(e){this.attribute=e.attribute,this.observable=e.observable,this.emitter=e.emitter,this.callback=e.callback}getValue(e){const t=this.observable[this.attribute];return this.callback?this.callback(t,e):t}activateAttributeListener(e,t,r){const i=()=>syncValueSchemaValue(e,t,r);return this.emitter.listenTo(this.observable,`change:${this.attribute}`,i),()=>{this.emitter.stopListening(this.observable,`change:${this.attribute}`,i)}}},TemplateToBinding=class extends TemplateBinding{eventNameOrFunction;constructor(e){super(e),this.eventNameOrFunction=e.eventNameOrFunction}activateDomEventListener(e,t,r){const i=(o,a)=>{(!t||a.target.matches(t))&&(typeof this.eventNameOrFunction=="function"?this.eventNameOrFunction(a):this.observable.fire(this.eventNameOrFunction,a))};return this.emitter.listenTo(r.node,e,i),()=>{this.emitter.stopListening(r.node,e,i)}}},TemplateIfBinding=class extends TemplateBinding{valueIfTrue;constructor(e){super(e),this.valueIfTrue=e.valueIfTrue}getValue(e){const t=super.getValue(e);return isFalsy(t)?!1:this.valueIfTrue||!0}};function hasTemplateBinding(e){return e?(e.value&&(e=e.value),Array.isArray(e)?e.some(hasTemplateBinding):e instanceof TemplateBinding):!1}function getValueSchemaValue(e,t){return e.map(r=>r instanceof TemplateBinding?r.getValue(t):r)}function syncValueSchemaValue(e,t,{node:r}){const i=getValueSchemaValue(e,r);let o;e.length==1&&e[0]instanceof TemplateIfBinding?o=i[0]:o=i.reduce(arrayValueReducer,""),isFalsy(o)?t.remove():t.set(o)}function getTextUpdater(e){return{set(t){e.textContent=t},remove(){e.textContent=""}}}function getAttributeUpdater(e,t,r){return{set(i){e.setAttributeNS(r,t,i)},remove(){e.removeAttributeNS(r,t)}}}function getStyleUpdater(e,t){return{set(r){e.style[t]=r},remove(){e.style[t]=null}}}function clone7(e){return cloneDeepWith_default(e,r=>{if(r&&(r instanceof TemplateBinding||isTemplate(r)||isView(r)||isViewCollection(r)))return r})}function normalize3(e){if(typeof e=="string"?e=normalizePlainTextDefinition(e):e.text&&normalizeTextDefinition(e),e.on&&(e.eventListeners=normalizeListeners(e.on),delete e.on),!e.text){e.attributes&&normalizeAttributes(e.attributes);const t=[];if(e.children)if(isViewCollection(e.children))t.push(e.children);else for(const r of e.children)isTemplate(r)||isView(r)||isNode(r)?t.push(r):t.push(new Template(r));e.children=t}return e}function normalizeAttributes(e){for(const t in e)e[t].value&&(e[t].value=toArray(e[t].value)),arrayify(e,t)}function normalizeListeners(e){for(const t in e)arrayify(e,t);return e}function normalizePlainTextDefinition(e){return{text:[e]}}function normalizeTextDefinition(e){e.text=toArray(e.text)}function arrayify(e,t){e[t]=toArray(e[t])}function arrayValueReducer(e,t){return isFalsy(t)?e:isFalsy(e)?t:`${e} ${t}`}function extendObjectValueArray(e,t){for(const r in t)e[r]?e[r].push(...t[r]):e[r]=t[r]}function extendTemplate(e,t){if(t.attributes&&(e.attributes||(e.attributes={}),extendObjectValueArray(e.attributes,t.attributes)),t.eventListeners&&(e.eventListeners||(e.eventListeners={}),extendObjectValueArray(e.eventListeners,t.eventListeners)),t.text&&e.text.push(...t.text),t.children&&t.children.length){if(e.children.length!=t.children.length)throw new CKEditorError("ui-template-extend-children-mismatch",e);let r=0;for(const i of t.children)extendTemplate(e.children[r++],i)}}function isFalsy(e){return!e&&e!==0}function isView(e){return e instanceof View2}function isTemplate(e){return e instanceof Template}function isViewCollection(e){return e instanceof ViewCollection}function isNamespaced(e){return isObject_default(e[0])&&e[0].ns}function getEmptyRevertData(){return{children:[],bindings:[],attributes:{}}}function shouldExtend(e){return e=="class"||e=="style"}var View2=class extends DomEmitterMixin(ObservableMixin()){element;isRendered;locale;t;template;_viewCollections;_unboundChildren;_bindTemplate;constructor(e){super(),this.element=null,this.isRendered=!1,this.locale=e,this.t=e&&e.t,this._viewCollections=new Collection,this._unboundChildren=this.createCollection(),this._viewCollections.on("add",(t,r)=>{r.locale=e,r.t=e&&e.t}),this.decorate("render")}get bindTemplate(){return this._bindTemplate?this._bindTemplate:this._bindTemplate=Template.bind(this,this)}createCollection(e){const t=new ViewCollection(e);return this._viewCollections.add(t),t}registerChild(e){isIterable(e)||(e=[e]);for(const t of e)this._unboundChildren.add(t)}deregisterChild(e){isIterable(e)||(e=[e]);for(const t of e)this._unboundChildren.remove(t)}setTemplate(e){this.template=new Template(e)}extendTemplate(e){Template.extend(this.template,e)}render(){if(this.isRendered)throw new CKEditorError("ui-view-render-already-rendered",this);this.template&&(this.element=this.template.render(),this.registerChild(this.template.getViews())),this.isRendered=!0}destroy(){this.stopListening(),this._viewCollections.map(e=>e.destroy()),this.template&&this.template._revertData&&this.template.revert(this.element)}};function clickOutsideHandler({emitter:e,activator:t,callback:r,contextElements:i,listenerOptions:o}){e.listenTo(document,"mousedown",(a,c)=>{if(!t())return;const u=typeof c.composedPath=="function"?c.composedPath():[],h=typeof i=="function"?i():i;for(const d of h)if(d.contains(c.target)||u.includes(d))return;r()},o)}function addKeyboardHandlingForGrid({keystrokeHandler:e,focusTracker:t,gridItems:r,numberOfColumns:i,uiLanguageDirection:o}){const a=typeof i=="number"?()=>i:i;e.set("arrowright",c((d,f)=>o==="rtl"?h(d,f.length):u(d,f.length))),e.set("arrowleft",c((d,f)=>o==="rtl"?u(d,f.length):h(d,f.length))),e.set("arrowup",c((d,f)=>{let m=d-a();return m<0&&(m=d+a()*Math.floor(f.length/a()),m>f.length-1&&(m-=a())),m})),e.set("arrowdown",c((d,f)=>{let m=d+a();return m>f.length-1&&(m=d%a()),m}));function c(d){return f=>{const m=r.find(_=>_.element===t.focusedElement),g=r.getIndex(m),v=d(g,r);r.get(v).focus(),f.stopPropagation(),f.preventDefault()}}function u(d,f){return d===f-1?0:d+1}function h(d,f){return d===0?f-1:d-1}}var IconView=class Ss extends View2{static presentationalAttributeNames=["alignment-baseline","baseline-shift","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-rendering","cursor","direction","display","dominant-baseline","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","image-rendering","letter-spacing","lighting-color","marker-end","marker-mid","marker-start","mask","opacity","overflow","paint-order","pointer-events","shape-rendering","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-anchor","text-decoration","text-overflow","text-rendering","transform","unicode-bidi","vector-effect","visibility","white-space","word-spacing","writing-mode"];constructor(){super();const t=this.bindTemplate;this.set("content",""),this.set("viewBox","0 0 20 20"),this.set("fillColor",""),this.set("isColorInherited",!0),this.set("isVisible",!0),this.setTemplate({tag:"svg",ns:"http://www.w3.org/2000/svg",attributes:{class:["ck","ck-icon",t.if("isVisible","ck-hidden",r=>!r),"ck-reset_all-excluded",t.if("isColorInherited","ck-icon_inherit-color")],viewBox:t.to("viewBox"),"aria-hidden":!0}})}render(){super.render(),this._updateXMLContent(),this._colorFillPaths(),this.on("change:content",()=>{this._updateXMLContent(),this._colorFillPaths()}),this.on("change:fillColor",()=>{this._colorFillPaths()})}_updateXMLContent(){if(this.content){const r=new DOMParser().parseFromString(this.content.trim(),"image/svg+xml").querySelector("svg"),i=r.getAttribute("viewBox");i&&(this.viewBox=i);for(const{name:o,value:a}of Array.from(r.attributes))Ss.presentationalAttributeNames.includes(o)&&this.element.setAttribute(o,a);for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(;r.childNodes.length>0;)this.element.appendChild(r.childNodes[0])}}_colorFillPaths(){this.fillColor&&this.element.querySelectorAll(".ck-icon__fill").forEach(t=>{t.style.fill=this.fillColor})}},ButtonLabelView=class extends View2{constructor(){super(),this.set({style:void 0,text:void 0,id:void 0});const e=this.bindTemplate;this.setTemplate({tag:"span",attributes:{class:["ck","ck-button__label"],style:e.to("style"),id:e.to("id")},children:[{text:e.to("text")}]})}},ButtonView=class extends View2{children;labelView;iconView;keystrokeView;_focusDelayed=null;constructor(e,t=new ButtonLabelView){super(e);const r=this.bindTemplate,i=uid2();this.set("_ariaPressed",!1),this.set("_ariaChecked",!1),this.set("ariaLabel",void 0),this.set("ariaLabelledBy",`ck-editor__aria-label_${i}`),this.set("class",void 0),this.set("labelStyle",void 0),this.set("icon",void 0),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isVisible",!0),this.set("isToggleable",!1),this.set("keystroke",void 0),this.set("label",void 0),this.set("role",void 0),this.set("tabindex",-1),this.set("tooltip",!1),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.set("withKeystroke",!1),this.children=this.createCollection(),this.labelView=this._setupLabelView(t),this.iconView=new IconView,this.iconView.extendTemplate({attributes:{class:"ck-button__icon"}}),this.keystrokeView=this._createKeystrokeView(),this.bind("_tooltipString").to(this,"tooltip",this,"label",this,"keystroke",this._getTooltipString.bind(this));const o={tag:"button",attributes:{class:["ck","ck-button",r.to("class"),r.if("isEnabled","ck-disabled",a=>!a),r.if("isVisible","ck-hidden",a=>!a),r.to("isOn",a=>a?"ck-on":"ck-off"),r.if("withText","ck-button_with-text"),r.if("withKeystroke","ck-button_with-keystroke")],role:r.to("role"),type:r.to("type",a=>a||"button"),tabindex:r.to("tabindex"),"aria-checked":r.to("_ariaChecked"),"aria-pressed":r.to("_ariaPressed"),"aria-label":r.to("ariaLabel"),"aria-labelledby":r.to("ariaLabelledBy"),"aria-disabled":r.if("isEnabled",!0,a=>!a),"data-cke-tooltip-text":r.to("_tooltipString"),"data-cke-tooltip-position":r.to("tooltipPosition")},children:this.children,on:{click:r.to(a=>{this.isEnabled?this.fire("execute"):a.preventDefault()})}};this.bind("_ariaPressed").to(this,"isOn",this,"isToggleable",this,"role",(a,c,u)=>!c||isCheckableRole(u)?!1:String(!!a)),this.bind("_ariaChecked").to(this,"isOn",this,"isToggleable",this,"role",(a,c,u)=>!c||!isCheckableRole(u)?!1:String(!!a)),env.isSafari&&(this._focusDelayed||(this._focusDelayed=delay(()=>this.focus(),0)),o.on.mousedown=r.to(()=>{this._focusDelayed()}),o.on.mouseup=r.to(()=>{this._focusDelayed.cancel()})),this.setTemplate(o)}render(){super.render(),this.icon&&(this.iconView.bind("content").to(this,"icon"),this.children.add(this.iconView)),this.children.add(this.labelView),this.withKeystroke&&this.keystroke&&this.children.add(this.keystrokeView)}focus(){this.element.focus()}destroy(){this._focusDelayed&&this._focusDelayed.cancel(),super.destroy()}_setupLabelView(e){return e.bind("text","style","id").to(this,"label","labelStyle","ariaLabelledBy"),e}_createKeystrokeView(){const e=new View2;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__keystroke"]},children:[{text:this.bindTemplate.to("keystroke",t=>getEnvKeystrokeText(t))}]}),e}_getTooltipString(e,t,r){return e?typeof e=="string"?e:(r&&(r=getEnvKeystrokeText(r)),e instanceof Function?e(t,r):`${t}${r?` (${r})`:""}`):""}};function isCheckableRole(e){switch(e){case"radio":case"checkbox":case"option":case"switch":case"menuitemcheckbox":case"menuitemradio":return!0;default:return!1}}var FormHeaderView=class extends View2{children;iconView;constructor(e,t={}){super(e);const r=this.bindTemplate;this.set("label",t.label||""),this.set("class",t.class||null),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form__header",r.to("class")]},children:this.children}),t.icon&&(this.iconView=new IconView,this.iconView.content=t.icon,this.children.add(this.iconView));const i=new View2(e);i.setTemplate({tag:"h2",attributes:{class:["ck","ck-form__header__label"],role:"presentation"},children:[{text:r.to("label")}]}),this.children.add(i)}},FocusCycler=class extends EmitterMixin(){focusables;focusTracker;keystrokeHandler;actions;constructor(e){if(super(),this.focusables=e.focusables,this.focusTracker=e.focusTracker,this.keystrokeHandler=e.keystrokeHandler,this.actions=e.actions,e.actions&&e.keystrokeHandler)for(const t in e.actions){let r=e.actions[t];typeof r=="string"&&(r=[r]);for(const i of r)e.keystrokeHandler.set(i,(o,a)=>{this[t](),a()},e.keystrokeHandlerOptions)}this.on("forwardCycle",()=>this.focusFirst(),{priority:"low"}),this.on("backwardCycle",()=>this.focusLast(),{priority:"low"})}get first(){return this.focusables.find(isDomFocusable)||null}get last(){return this.focusables.filter(isDomFocusable).slice(-1)[0]||null}get next(){return this._getDomFocusableItem(1)}get previous(){return this._getDomFocusableItem(-1)}get current(){let e=null;return this.focusTracker.focusedElement===null?null:(this.focusables.find((t,r)=>{const i=t.element===this.focusTracker.focusedElement;return i&&(e=r),i}),e)}focusFirst(){this._focus(this.first,1)}focusLast(){this._focus(this.last,-1)}focusNext(){const e=this.next;if(e&&this.focusables.getIndex(e)===this.current){this.fire("forwardCycle");return}e===this.first?this.fire("forwardCycle"):this._focus(e,1)}focusPrevious(){const e=this.previous;if(e&&this.focusables.getIndex(e)===this.current){this.fire("backwardCycle");return}e===this.last?this.fire("backwardCycle"):this._focus(e,-1)}chain(e){const t=()=>this.current===null?null:this.focusables.get(this.current);this.listenTo(e,"forwardCycle",r=>{const i=t();this.focusNext(),i!==t()&&r.stop()},{priority:"low"}),this.listenTo(e,"backwardCycle",r=>{const i=t();this.focusPrevious(),i!==t()&&r.stop()},{priority:"low"})}unchain(e){this.stopListening(e)}_focus(e,t){e&&this.focusTracker.focusedElement!==e.element&&e.focus(t)}_getDomFocusableItem(e){const t=this.focusables.length;if(!t)return null;const r=this.current;if(r===null)return this[e===1?"first":"last"];let i=this.focusables.get(r),o=(r+t+e)%t;do{const a=this.focusables.get(o);if(isDomFocusable(a)){i=a;break}o=(o+t+e)%t}while(o!==r);return i}};function isDomFocusable(e){return isFocusable(e)&&isVisible2(e.element)}function isFocusable(e){return"focus"in e&&typeof e.focus=="function"}function isViewWithFocusCycler(e){return isFocusable(e)&&"focusCycler"in e&&e.focusCycler instanceof FocusCycler}function DraggableViewMixin(e){class t extends e{_onDragBound=this._onDrag.bind(this);_onDragEndBound=this._onDragEnd.bind(this);_lastDraggingCoordinates={x:0,y:0};constructor(...i){super(...i),this.on("render",()=>{this._attachListeners()}),this.set("isDragging",!1)}_attachListeners(){this.listenTo(this.element,"mousedown",this._onDragStart.bind(this)),this.listenTo(this.element,"touchstart",this._onDragStart.bind(this))}_attachDragListeners(){this.listenTo(global2.document,"mouseup",this._onDragEndBound),this.listenTo(global2.document,"touchend",this._onDragEndBound),this.listenTo(global2.document,"mousemove",this._onDragBound),this.listenTo(global2.document,"touchmove",this._onDragBound)}_detachDragListeners(){this.stopListening(global2.document,"mouseup",this._onDragEndBound),this.stopListening(global2.document,"touchend",this._onDragEndBound),this.stopListening(global2.document,"mousemove",this._onDragBound),this.stopListening(global2.document,"touchmove",this._onDragBound)}_onDragStart(i,o){if(!this._isHandleElementPressed(o))return;this._attachDragListeners();let a=0,c=0;o instanceof MouseEvent?(a=o.clientX,c=o.clientY):(a=o.touches[0].clientX,c=o.touches[0].clientY),this._lastDraggingCoordinates={x:a,y:c},this.isDragging=!0}_onDrag(i,o){if(!this.isDragging){this._detachDragListeners();return}let a=0,c=0;o instanceof MouseEvent?(a=o.clientX,c=o.clientY):(a=o.touches[0].clientX,c=o.touches[0].clientY),o.preventDefault(),this.fire("drag",{deltaX:Math.round(a-this._lastDraggingCoordinates.x),deltaY:Math.round(c-this._lastDraggingCoordinates.y)}),this._lastDraggingCoordinates={x:a,y:c}}_onDragEnd(){this._detachDragListeners(),this.isDragging=!1}_isHandleElementPressed(i){return this.dragHandleElement?this.dragHandleElement===i.target||i.target instanceof HTMLElement&&this.dragHandleElement.contains(i.target):!1}}return t}var DialogActionsView=class extends View2{children;keystrokes;focusCycler;_focusTracker;_focusables;constructor(e){super(e),this.children=this.createCollection(),this.keystrokes=new KeystrokeHandler,this._focusTracker=new FocusTracker,this._focusables=new ViewCollection,this.focusCycler=new FocusCycler({focusables:this._focusables,focusTracker:this._focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog__actions"]},children:this.children})}render(){super.render(),this.keystrokes.listenTo(this.element)}setButtons(e){for(const t of e){const r=new ButtonView(this.locale);let i;r.on("execute",()=>t.onExecute()),t.onCreate&&t.onCreate(r);for(i in t)i!="onExecute"&&i!="onCreate"&&r.set(i,t[i]);this.children.add(r)}this._updateFocusCyclableItems()}focus(e){e===-1?this.focusCycler.focusLast():this.focusCycler.focusFirst()}_updateFocusCyclableItems(){Array.from(this.children).forEach(e=>{this._focusables.add(e),this._focusTracker.add(e.element)})}},DialogContentView=class extends View2{children;constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog__content"]},children:this.children})}reset(){for(;this.children.length;)this.children.remove(0)}},DialogViewPosition={SCREEN_CENTER:"screen-center",EDITOR_CENTER:"editor-center",EDITOR_TOP_SIDE:"editor-top-side",EDITOR_TOP_CENTER:"editor-top-center",EDITOR_BOTTOM_CENTER:"editor-bottom-center",EDITOR_ABOVE_CENTER:"editor-above-center",EDITOR_BELOW_CENTER:"editor-below-center"},toPx$6=toUnit("px"),DialogView=class Ts extends DraggableViewMixin(View2){parts;headerView;closeButtonView;actionsView;static defaultOffset=15;contentView;keystrokes;focusTracker;wasMoved=!1;_getCurrentDomRoot;_getViewportOffset;_focusables;_focusCycler;constructor(t,{getCurrentDomRoot:r,getViewportOffset:i}){super(t);const o=this.bindTemplate,a=t.t;this.set("className",""),this.set("ariaLabel",a("Editor dialog")),this.set("isModal",!1),this.set("position",DialogViewPosition.SCREEN_CENTER),this.set("_isVisible",!1),this.set("_isTransparent",!1),this.set("_top",0),this.set("_left",0),this._getCurrentDomRoot=r,this._getViewportOffset=i,this.decorate("moveTo"),this.parts=this.createCollection(),this.keystrokes=new KeystrokeHandler,this.focusTracker=new FocusTracker,this._focusables=new ViewCollection,this._focusCycler=new FocusCycler({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog-overlay",o.if("isModal","ck-dialog-overlay__transparent",c=>!c),o.if("_isVisible","ck-hidden",c=>!c)],tabindex:"-1"},children:[{tag:"div",attributes:{tabindex:"-1",class:["ck","ck-dialog",o.if("isModal","ck-dialog_modal"),o.to("className")],role:"dialog","aria-label":o.to("ariaLabel"),style:{top:o.to("_top",c=>toPx$6(c)),left:o.to("_left",c=>toPx$6(c)),visibility:o.if("_isTransparent","hidden")}},children:this.parts}]})}render(){super.render(),this.keystrokes.set("Esc",(t,r)=>{t.defaultPrevented||(this.fire("close",{source:"escKeyPress"}),r())}),this.on("drag",(t,{deltaX:r,deltaY:i})=>{this.wasMoved=!0,this.moveBy(r,i)}),this.listenTo(global2.window,"resize",()=>{this._isVisible&&!this.wasMoved&&this.updatePosition()}),this.listenTo(global2.document,"scroll",()=>{this._isVisible&&!this.wasMoved&&this.updatePosition()}),this.on("change:_isVisible",(t,r,i)=>{i&&(this._isTransparent=!0,setTimeout(()=>{this.updatePosition(),this._isTransparent=!1,this.focus()},10))}),this.keystrokes.listenTo(this.element)}get dragHandleElement(){return this.headerView&&!this.isModal?this.headerView.element:null}setupParts({icon:t,title:r,hasCloseButton:i=!0,content:o,actionButtons:a}){r&&(this.headerView=new FormHeaderView(this.locale,{icon:t}),i&&(this.closeButtonView=this._createCloseButton(),this.headerView.children.add(this.closeButtonView)),this.headerView.label=r,this.ariaLabel=r,this.parts.add(this.headerView,0)),o&&(o instanceof View2&&(o=[o]),this.contentView=new DialogContentView(this.locale),this.contentView.children.addMany(o),this.parts.add(this.contentView)),a&&(this.actionsView=new DialogActionsView(this.locale),this.actionsView.setButtons(a),this.parts.add(this.actionsView)),this._updateFocusCyclableItems()}focus(){this._focusCycler.focusFirst()}moveTo(t,r){const i=this._getViewportRect(),o=this._getDialogRect();t+o.width>i.right&&(t=i.right-o.width),t<i.left&&(t=i.left),r<i.top&&(r=i.top),this._moveTo(t,r)}_moveTo(t,r){this._left=t,this._top=r}moveBy(t,r){this.moveTo(this._left+t,this._top+r)}_moveOffScreen(){this._moveTo(-9999,-9999)}updatePosition(){if(!this.element||!this.element.parentNode)return;const t=this._getViewportRect();let r=this.position,i;this._getCurrentDomRoot()?i=this._getVisibleDomRootRect(t):r=DialogViewPosition.SCREEN_CENTER;const o=Ts.defaultOffset,a=this._getDialogRect();switch(r){case DialogViewPosition.EDITOR_TOP_SIDE:{if(i){const c=this.locale.contentLanguageDirection==="ltr"?i.right-a.width-o:i.left+o;this.moveTo(c,i.top+o)}else this._moveOffScreen();break}case DialogViewPosition.EDITOR_CENTER:{i?this.moveTo(Math.round(i.left+i.width/2-a.width/2),Math.round(i.top+i.height/2-a.height/2)):this._moveOffScreen();break}case DialogViewPosition.SCREEN_CENTER:{this.moveTo(Math.round((t.width-a.width)/2),Math.round((t.height-a.height)/2));break}case DialogViewPosition.EDITOR_TOP_CENTER:{i?this.moveTo(Math.round(i.left+i.width/2-a.width/2),i.top+o):this._moveOffScreen();break}case DialogViewPosition.EDITOR_BOTTOM_CENTER:{i?this.moveTo(Math.round(i.left+i.width/2-a.width/2),i.bottom-a.height-o):this._moveOffScreen();break}case DialogViewPosition.EDITOR_ABOVE_CENTER:{i?this.moveTo(Math.round(i.left+i.width/2-a.width/2),i.top-a.height-o):this._moveOffScreen();break}case DialogViewPosition.EDITOR_BELOW_CENTER:{i?this.moveTo(Math.round(i.left+i.width/2-a.width/2),i.bottom+o):this._moveOffScreen();break}}}_getVisibleDomRootRect(t){let r=new Rect(this._getCurrentDomRoot()).getVisible();if(r){if(r=t.getIntersection(r),!r)return null}else return null;return r}_getDialogRect(){return new Rect(this.element.firstElementChild)}_getViewportRect(){const t=new Rect(global2.window);if(this.isModal)return t;const r={top:0,bottom:0,left:0,right:0,...this._getViewportOffset()};return t.top+=r.top,t.height-=r.top,t.bottom-=r.bottom,t.height-=r.bottom,t.left+=r.left,t.right-=r.right,t.width-=r.left+r.right,t}_updateFocusCyclableItems(){const t=[];if(this.contentView)for(const r of this.contentView.children)isFocusable(r)&&t.push(r);this.actionsView&&t.push(this.actionsView),this.closeButtonView&&t.push(this.closeButtonView),t.forEach(r=>{this._focusables.add(r),this.focusTracker.add(r.element),isViewWithFocusCycler(r)&&this._focusCycler.chain(r.focusCycler)})}_createCloseButton(){const t=new ButtonView(this.locale),r=this.locale.t;return t.set({label:r("Close"),tooltip:!0,icon:icons.cancel}),t.on("execute",()=>this.fire("close",{source:"closeButton"})),t}},Dialog=class ur extends Plugin{view;static _visibleDialogPlugin;_onHide;static get pluginName(){return"Dialog"}static get isOfficialPlugin(){return!0}constructor(t){super(t);const r=t.t;this._initShowHideListeners(),this._initFocusToggler(),this._initMultiRootIntegration(),this.set({id:null,isOpen:!1}),t.accessibility.addKeystrokeInfos({categoryId:"navigation",keystrokes:[{label:r("Move focus in and out of an active dialog window"),keystroke:"Ctrl+F6",mayRequireFn:!0}]})}destroy(){super.destroy(),this._unlockBodyScroll()}_initShowHideListeners(){this.on("show",(t,r)=>{this._show(r)}),this.on("show",(t,r)=>{r.onShow&&r.onShow(this)},{priority:"low"}),this.on("hide",()=>{ur._visibleDialogPlugin&&ur._visibleDialogPlugin._hide()}),this.on("hide",()=>{this._onHide&&(this._onHide(this),this._onHide=void 0)},{priority:"low"})}_initFocusToggler(){const t=this.editor;t.keystrokes.set("Ctrl+F6",(r,i)=>{!this.isOpen||this.view.isModal||(this.view.focusTracker.isFocused?t.editing.view.focus():this.view.focus(),i())})}_initMultiRootIntegration(){const t=this.editor.model;t.document.on("change:data",()=>{if(!this.view)return;const r=t.document.differ.getChangedRoots();for(const i of r)i.state&&this.view.updatePosition()})}show(t){this.hide(),this.fire(`show:${t.id}`,t)}_show({id:t,icon:r,title:i,hasCloseButton:o=!0,content:a,actionButtons:c,className:u,isModal:h,position:d,onHide:f}){const m=this.editor;this.view=new DialogView(m.locale,{getCurrentDomRoot:()=>m.editing.view.getDomRoot(m.model.document.selection.anchor.root.rootName),getViewportOffset:()=>m.ui.viewportOffset});const g=this.view;g.on("close",()=>{this.hide()}),m.ui.view.body.add(g),m.keystrokes.listenTo(g.element),d||(d=h?DialogViewPosition.SCREEN_CENTER:DialogViewPosition.EDITOR_CENTER),h&&this._lockBodyScroll(),g.set({position:d,_isVisible:!0,className:u,isModal:h}),g.setupParts({icon:r,title:i,hasCloseButton:o,content:a,actionButtons:c}),this.id=t,f&&(this._onHide=f),this.isOpen=!0,ur._visibleDialogPlugin=this}hide(){ur._visibleDialogPlugin&&ur._visibleDialogPlugin.fire(`hide:${ur._visibleDialogPlugin.id}`)}_hide(){if(!this.view)return;const t=this.editor,r=this.view;r.isModal&&this._unlockBodyScroll(),r.contentView&&r.contentView.reset(),t.ui.view.body.remove(r),t.ui.focusTracker.remove(r.element),t.keystrokes.stopListening(r.element),r.destroy(),t.editing.view.focus(),this.id=null,this.isOpen=!1,ur._visibleDialogPlugin=null}_lockBodyScroll(){document.documentElement.classList.add("ck-dialog-scroll-locked")}_unlockBodyScroll(){document.documentElement.classList.remove("ck-dialog-scroll-locked")}},ListItemButtonView=class extends ButtonView{_checkIconHolderView=new CheckIconHolderView;constructor(e,t=new ButtonLabelView){super(e,t),this.set({hasCheckSpace:!1,_hasCheck:this.isToggleable});const r=this.bindTemplate;this.extendTemplate({attributes:{class:["ck-list-item-button",r.if("isToggleable","ck-list-item-button_toggleable")]}}),this.bind("_hasCheck").to(this,"hasCheckSpace",this,"isToggleable",(i,o)=>i||o)}render(){super.render(),this._hasCheck&&this.children.add(this._checkIconHolderView,0),this._watchCheckIconHolderMount()}_watchCheckIconHolderMount(){this._checkIconHolderView.bind("isOn").to(this,"isOn",e=>this.isToggleable&&e),this.on("change:_hasCheck",(e,t,r)=>{const{children:i,_checkIconHolderView:o}=this;r?i.add(o,0):i.remove(o)})}},CheckIconHolderView=class extends View2{children;_checkIconView=this._createCheckIconView();constructor(){super();const e=this.bindTemplate;this.children=this.createCollection(),this.set("isOn",!1),this.setTemplate({tag:"span",children:this.children,attributes:{class:["ck","ck-list-item-button__check-holder",e.to("isOn",t=>t?"ck-on":"ck-off")]}})}render(){super.render(),this.isOn&&this.children.add(this._checkIconView,0),this._watchCheckIconMount()}_watchCheckIconMount(){this.on("change:isOn",(e,t,r)=>{const{children:i,_checkIconView:o}=this;r&&!i.has(o)?i.add(o):!r&&i.has(o)&&i.remove(o)})}_createCheckIconView(){const e=new IconView;return e.content=icons.check,e.extendTemplate({attributes:{class:"ck-list-item-button__check-icon"}}),e}},MenuBarMenuListItemButtonView=class extends ListItemButtonView{constructor(e){super(e),this.set({withText:!0,withKeystroke:!0,tooltip:!1,role:"menuitem"}),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item__button"]}})}},LabelView=class extends View2{id;constructor(e){super(e),this.set("text",void 0),this.set("for",void 0),this.id=`ck-editor__label_${uid2()}`;const t=this.bindTemplate;this.setTemplate({tag:"label",attributes:{class:["ck","ck-label"],id:this.id,for:t.to("for")},children:[{text:t.to("text")}]})}},AccessibilityHelpContentView=class extends View2{constructor(e,t){super(e);const r=e.t,i=new LabelView;i.text=r("Help Contents. To close this dialog press ESC."),this.setTemplate({tag:"div",attributes:{class:["ck","ck-accessibility-help-dialog__content"],"aria-labelledby":i.id,role:"document",tabindex:-1},children:[createElement(document,"p",{},r("Below, you can find a list of keyboard shortcuts that can be used in the editor.")),...this._createCategories(Array.from(t.values())),i]})}focus(){this.element.focus()}_createCategories(e){return e.map(t=>{const r=[createElement(document,"h3",{},t.label),...Array.from(t.groups.values()).map(i=>this._createGroup(i)).flat()];return t.description&&r.splice(1,0,createElement(document,"p",{},t.description)),createElement(document,"section",{},r)})}_createGroup(e){const t=e.keystrokes.sort((i,o)=>i.label.localeCompare(o.label)).map(i=>this._createGroupRow(i)).flat(),r=[createElement(document,"dl",{},t)];return e.label&&r.unshift(createElement(document,"h4",{},e.label)),r}_createGroupRow(e){const t=this.locale.t,r=createElement(document,"dt"),i=createElement(document,"dd"),o=normalizeKeystrokeDefinition(e.keystroke),a=[];for(const c of o)a.push(c.map(keystrokeToEnvKbd).join(""));return r.innerHTML=e.label,i.innerHTML=a.join(", ")+(e.mayRequireFn&&env.isMac?` ${t("(may require <kbd>Fn</kbd>)")}`:""),[r,i]}};function keystrokeToEnvKbd(e){return getEnvKeystrokeText(e).split("+").map(t=>`<kbd>${t}</kbd>`).join("+")}function normalizeKeystrokeDefinition(e){return typeof e=="string"?[[e]]:typeof e[0]=="string"?[e]:e}var accessibilityIcon='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 6.628a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"/><path d="M8.5 9.125a.3.3 0 0 0-.253-.296L5.11 8.327a.75.75 0 1 1 .388-1.449l4.04.716c.267.072.624.08.893.009l4.066-.724a.75.75 0 1 1 .388 1.45l-3.132.5a.3.3 0 0 0-.253.296v1.357a.3.3 0 0 0 .018.102l1.615 4.438a.75.75 0 0 1-1.41.513l-1.35-3.71a.3.3 0 0 0-.281-.197h-.209a.3.3 0 0 0-.282.198l-1.35 3.711a.75.75 0 0 1-1.41-.513l1.64-4.509a.3.3 0 0 0 .019-.103V9.125Z"/><path clip-rule="evenodd" d="M10 18.5a8.5 8.5 0 1 1 0-17 8.5 8.5 0 0 1 0 17Zm0 1.5c5.523 0 10-4.477 10-10S15.523 0 10 0 0 4.477 0 10s4.477 10 10 10Z"/></svg>',AccessibilityHelp=class extends Plugin{contentView=null;static get requires(){return[Dialog]}static get pluginName(){return"AccessibilityHelp"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.locale.t;e.ui.componentFactory.add("accessibilityHelp",()=>{const r=this._createButton(ButtonView);return r.set({tooltip:!0,withText:!1,label:t("Accessibility help")}),r}),e.ui.componentFactory.add("menuBar:accessibilityHelp",()=>{const r=this._createButton(MenuBarMenuListItemButtonView);return r.label=t("Accessibility"),r}),e.keystrokes.set("Alt+0",(r,i)=>{this._toggleDialog(),i()}),this._setupRootLabels()}_createButton(e){const t=this.editor,r=t.plugins.get("Dialog"),i=t.locale,o=new e(i);return o.set({keystroke:"Alt+0",icon:accessibilityIcon,isToggleable:!0}),o.on("execute",()=>this._toggleDialog()),o.bind("isOn").to(r,"id",a=>a==="accessibilityHelp"),o}_setupRootLabels(){const e=this.editor,t=e.editing.view,r=e.t;e.ui.on("ready",()=>{t.change(o=>{for(const a of t.document.roots)i(o,a)}),e.on("addRoot",(o,a)=>{const c=e.editing.view.document.getRoot(a.rootName);t.change(u=>i(u,c))},{priority:"low"})});function i(o,a){const u=[a.getAttribute("aria-label"),r("Press %0 for help.",[getEnvKeystrokeText("Alt+0")])].filter(h=>h).join(". ");o.setAttribute("aria-label",u,a)}}_toggleDialog(){const e=this.editor,t=e.plugins.get("Dialog"),r=e.locale.t;this.contentView||(this.contentView=new AccessibilityHelpContentView(e.locale,e.accessibility.keystrokeInfos)),t.id==="accessibilityHelp"?t.hide():t.show({id:"accessibilityHelp",className:"ck-accessibility-help-dialog",title:r("Accessibility help"),icon:accessibilityIcon,hasCloseButton:!0,content:this.contentView})}},BodyCollection=class Bt extends ViewCollection{locale;_bodyCollectionContainer;static _bodyWrapper;constructor(t,r=[]){super(r),this.locale=t}get bodyCollectionContainer(){return this._bodyCollectionContainer}attachToDom(){this._bodyCollectionContainer=new Template({tag:"div",attributes:{class:["ck","ck-reset_all","ck-body","ck-rounded-corners"],dir:this.locale.uiLanguageDirection,role:"application"},children:this}).render(),(!Bt._bodyWrapper||!Bt._bodyWrapper.isConnected)&&(Bt._bodyWrapper=createElement(document,"div",{class:"ck-body-wrapper"}),document.body.appendChild(Bt._bodyWrapper)),Bt._bodyWrapper.appendChild(this._bodyCollectionContainer)}detachFromDom(){super.destroy(),this._bodyCollectionContainer&&this._bodyCollectionContainer.remove(),Bt._bodyWrapper&&!Bt._bodyWrapper.childElementCount&&(Bt._bodyWrapper.remove(),delete Bt._bodyWrapper)}},SwitchButtonView=class extends ButtonView{toggleSwitchView;constructor(e){super(e),this.isToggleable=!0,this.toggleSwitchView=this._createToggleView(),this.extendTemplate({attributes:{class:"ck-switchbutton"}})}render(){super.render(),this.children.add(this.toggleSwitchView)}_createToggleView(){const e=new View2;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__toggle"]},children:[{tag:"span",attributes:{class:["ck","ck-button__toggle__inner"]}}]}),e}},FileDialogListItemButtonView=class extends FileDialogViewMixin(ListItemButtonView){};function FileDialogViewMixin(e){class t extends e{buttonView;_fileInputView;constructor(...i){super(...i),this.buttonView=this,this._fileInputView=new FileInputView(this.locale),this._fileInputView.bind("acceptedType").to(this),this._fileInputView.bind("allowMultipleFiles").to(this),this._fileInputView.delegate("done").to(this),this.on("execute",()=>{this._fileInputView.open()}),this.extendTemplate({attributes:{class:"ck-file-dialog-button"}})}render(){super.render(),this.children.add(this._fileInputView)}}return t}var FileInputView=class extends View2{constructor(e){super(e),this.set("acceptedType",void 0),this.set("allowMultipleFiles",!1);const t=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck-hidden"],type:"file",tabindex:"-1",accept:t.to("acceptedType"),multiple:t.to("allowMultipleFiles")},on:{change:t.to(()=>{this.element&&this.element.files&&this.element.files.length&&this.fire("done",this.element.files),this.element.value=""})}})}open(){this.element.click()}},dropdownArrowIcon='<svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path d="M.941 4.523a.75.75 0 1 1 1.06-1.06l3.006 3.005 3.005-3.005a.75.75 0 1 1 1.06 1.06l-3.549 3.55a.75.75 0 0 1-1.168-.136L.941 4.523z"/></svg>';function getLocalizedColorOptions(e,t){const r=e.t,i={Black:r("Black"),"Dim grey":r("Dim grey"),Grey:r("Grey"),"Light grey":r("Light grey"),White:r("White"),Red:r("Red"),Orange:r("Orange"),Yellow:r("Yellow"),"Light green":r("Light green"),Green:r("Green"),Aquamarine:r("Aquamarine"),Turquoise:r("Turquoise"),"Light blue":r("Light blue"),Blue:r("Blue"),Purple:r("Purple")};return t.map(o=>{const a=i[o.label];return a&&a!=o.label&&(o.label=a),o})}function normalizeColorOptions(e){return e.map(normalizeSingleColorDefinition).filter(t=>!!t)}function normalizeSingleColorDefinition(e){return typeof e=="string"?{model:e,label:e,hasBorder:!1,view:{name:"span",styles:{color:e}}}:{model:e.color,label:e.label||e.color,hasBorder:e.hasBorder===void 0?!1:e.hasBorder,view:{name:"span",styles:{color:`${e.color}`}}}}var checkIcon='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M16.935 5.328a2 2 0 0 1 0 2.829l-7.778 7.778a2 2 0 0 1-2.829 0L3.5 13.107a1.999 1.999 0 1 1 2.828-2.829l.707.707a1 1 0 0 0 1.414 0l5.658-5.657a2 2 0 0 1 2.828 0z"/><path d="M14.814 6.035 8.448 12.4a1 1 0 0 1-1.414 0l-1.413-1.415A1 1 0 1 0 4.207 12.4l2.829 2.829a1 1 0 0 0 1.414 0l7.778-7.778a1 1 0 1 0-1.414-1.415z"/></svg>',ColorTileView=class extends ButtonView{constructor(e){super(e);const t=this.bindTemplate;this.set("color",void 0),this.set("hasBorder",!1),this.icon=checkIcon,this.extendTemplate({attributes:{style:{backgroundColor:t.to("color",r=>env.isMediaForcedColors?null:r)},class:["ck","ck-color-grid__tile",t.if("hasBorder","ck-color-selector__color-tile_bordered")]}})}render(){super.render(),this.iconView.fillColor="hsl(0, 0%, 100%)"}},ColorGridView=class extends View2{columns;items;focusTracker;keystrokes;constructor(e,t){super(e);const r=t&&t.colorDefinitions?t.colorDefinitions:[];this.columns=t&&t.columns?t.columns:5;const i={gridTemplateColumns:`repeat( ${this.columns}, 1fr)`};this.set("selectedColor",void 0),this.items=this.createCollection(),this.focusTracker=new FocusTracker,this.keystrokes=new KeystrokeHandler,this.items.on("add",(o,a)=>{a.isOn=a.color===this.selectedColor}),r.forEach(o=>{const a=new ColorTileView;a.set({color:o.color,label:o.label,tooltip:!0,hasBorder:o.options.hasBorder}),a.on("execute",()=>{this.fire("execute",{value:o.color,hasBorder:o.options.hasBorder,label:o.label})}),this.items.add(a)}),this.setTemplate({tag:"div",children:this.items,attributes:{class:["ck","ck-color-grid"],style:i}}),this.on("change:selectedColor",(o,a,c)=>{for(const u of this.items)u.isOn=u.color===c})}focus(){this.items.length&&this.items.first.focus()}focusLast(){this.items.length&&this.items.last.focus()}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",(e,t)=>{this.focusTracker.add(t.element)}),this.items.on("remove",(e,t)=>{this.focusTracker.remove(t.element)}),this.keystrokes.listenTo(this.element),addKeyboardHandlingForGrid({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.items,numberOfColumns:this.columns,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}};function convertColor(e,t){if(!e)return"";const r=parseColorString(e);if(!r)return"";if(r.space===t)return e;if(!canConvertParsedColor(r))return"";const o=convert[r.space][t];if(!o)return"";const a=o(r.space==="hex"?r.hexValue:r.values);return formatColorOutput(a,t)}function convertToHex(e){if(!e)return"";const t=parseColorString(e);return t?t.space==="hex"?t.hexValue:convertColor(e,"hex"):"#000"}function registerCustomElement(e,t){customElements.get(e)===void 0&&customElements.define(e,t)}function formatColorOutput(e,t){switch(t){case"hex":return`#${e}`;case"rgb":return`rgb(${e[0]}, ${e[1]}, ${e[2]})`;case"hsl":return`hsl(${e[0]}, ${e[1]}%, ${e[2]}%)`;case"hwb":return`hwb(${e[0]}, ${e[1]}, ${e[2]})`;case"lab":return`lab(${e[0]}% ${e[1]} ${e[2]})`;case"lch":return`lch(${e[0]}% ${e[1]} ${e[2]})`;default:return""}}function parseColorString(e){if(e.startsWith("#")){const r=color_parse_default(e);return{space:"hex",values:r.values,hexValue:e,alpha:r.alpha}}const t=color_parse_default(e);return t.space?t:null}function canConvertParsedColor(e){return Object.keys(convert).includes(e.space)}var LabeledFieldView=class extends View2{fieldView;labelView;statusView;fieldWrapperChildren;constructor(e,t){super(e);const r=`ck-labeled-field-view-${uid2()}`,i=`ck-labeled-field-view-status-${uid2()}`;this.fieldView=t(this,r,i),this.set("label",void 0),this.set("isEnabled",!0),this.set("isEmpty",!0),this.set("isFocused",!1),this.set("errorText",null),this.set("infoText",null),this.set("class",void 0),this.set("placeholder",void 0),this.labelView=this._createLabelView(r),this.statusView=this._createStatusView(i),this.fieldWrapperChildren=this.createCollection([this.fieldView,this.labelView]),this.bind("_statusText").to(this,"errorText",this,"infoText",(a,c)=>a||c);const o=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view",o.to("class"),o.if("isEnabled","ck-disabled",a=>!a),o.if("isEmpty","ck-labeled-field-view_empty"),o.if("isFocused","ck-labeled-field-view_focused"),o.if("placeholder","ck-labeled-field-view_placeholder"),o.if("errorText","ck-error")]},children:[{tag:"div",attributes:{class:["ck","ck-labeled-field-view__input-wrapper"]},children:this.fieldWrapperChildren},this.statusView]})}_createLabelView(e){const t=new LabelView(this.locale);return t.for=e,t.bind("text").to(this,"label"),t}_createStatusView(e){const t=new View2(this.locale),r=this.bindTemplate;return t.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view__status",r.if("errorText","ck-labeled-field-view__status_error"),r.if("_statusText","ck-hidden",i=>!i)],id:e,role:r.if("errorText","alert")},children:[{text:r.to("_statusText")}]}),t}focus(e){this.fieldView.focus(e)}},InputBase=class extends View2{focusTracker;constructor(e){super(e),this.set("value",void 0),this.set("id",void 0),this.set("placeholder",void 0),this.set("tabIndex",void 0),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("ariaDescribedById",void 0),this.set("ariaLabel",void 0),this.focusTracker=new FocusTracker,this.bind("isFocused").to(this.focusTracker),this.set("isEmpty",!0);const t=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck","ck-input",t.if("isFocused","ck-input_focused"),t.if("isEmpty","ck-input-text_empty"),t.if("hasError","ck-error")],id:t.to("id"),placeholder:t.to("placeholder"),tabindex:t.to("tabIndex"),readonly:t.to("isReadOnly"),"aria-invalid":t.if("hasError",!0),"aria-describedby":t.to("ariaDescribedById"),"aria-label":t.to("ariaLabel")},on:{input:t.to((...r)=>{this.fire("input",...r),this._updateIsEmpty()}),change:t.to(this._updateIsEmpty.bind(this))}})}render(){super.render(),this.focusTracker.add(this.element),this._setDomElementValue(this.value),this._updateIsEmpty(),this.on("change:value",(e,t,r)=>{this._setDomElementValue(r),this._updateIsEmpty()})}destroy(){super.destroy(),this.focusTracker.destroy()}select(){this.element.select()}focus(){this.element.focus()}reset(){this.value=this.element.value="",this._updateIsEmpty()}_updateIsEmpty(){this.isEmpty=isInputElementEmpty(this.element)}_setDomElementValue(e){this.element.value=!e&&e!==0?"":e}};function isInputElementEmpty(e){return!e.value}var InputView=class extends InputBase{constructor(e){super(e),this.set("inputMode","text");const t=this.bindTemplate;this.extendTemplate({attributes:{inputmode:t.to("inputMode")}})}},InputTextView=class extends InputView{constructor(e){super(e),this.extendTemplate({attributes:{type:"text",class:["ck-input-text"]}})}},DropdownPanelView=class extends View2{children;constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-dropdown__panel",t.to("position",r=>`ck-dropdown__panel_${r}`),t.if("isVisible","ck-dropdown__panel-visible")],tabindex:"-1"},children:this.children,on:{selectstart:t.to(r=>{r.target.tagName.toLocaleLowerCase()!=="input"&&r.preventDefault()})}})}focus(){if(this.children.length){const e=this.children.first;typeof e.focus=="function"?e.focus():logWarning("ui-dropdown-panel-focus-child-missing-focus",{childView:this.children.first,dropdownPanel:this})}}focusLast(){if(this.children.length){const e=this.children.last;typeof e.focusLast=="function"?e.focusLast():e.focus()}}},DropdownView=class pi extends View2{buttonView;panelView;focusTracker;keystrokes;listView;toolbarView;menuView;constructor(t,r,i){super(t);const o=this.bindTemplate;this.buttonView=r,this.panelView=i,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("class",void 0),this.set("id",void 0),this.set("panelPosition","auto"),this.panelView.bind("isVisible").to(this,"isOpen"),this.keystrokes=new KeystrokeHandler,this.focusTracker=new FocusTracker,this.setTemplate({tag:"div",attributes:{class:["ck","ck-dropdown",o.to("class"),o.if("isEnabled","ck-disabled",a=>!a)],id:o.to("id"),"aria-describedby":o.to("ariaDescribedById")},children:[r,i]}),r.extendTemplate({attributes:{class:["ck-dropdown__button"],"data-cke-tooltip-disabled":o.to("isOpen")}})}render(){super.render(),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.listenTo(this.buttonView,"open",()=>{this.isOpen=!this.isOpen}),this.on("change:isOpen",(r,i,o)=>{if(o)if(this.panelPosition==="auto"){const a=pi._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions});this.panelView.position=a?a.name:this._defaultPanelPositionName}else this.panelView.position=this.panelPosition}),this.keystrokes.listenTo(this.element);const t=(r,i)=>{this.isOpen&&(this.isOpen=!1,i())};this.keystrokes.set("arrowdown",(r,i)=>{this.buttonView.isEnabled&&!this.isOpen&&(this.isOpen=!0,i())}),this.keystrokes.set("arrowright",(r,i)=>{this.isOpen&&i()}),this.keystrokes.set("arrowleft",t),this.keystrokes.set("esc",t)}focus(){this.buttonView.focus()}get _panelPositions(){const{south:t,north:r,southEast:i,southWest:o,northEast:a,northWest:c,southMiddleEast:u,southMiddleWest:h,northMiddleEast:d,northMiddleWest:f}=pi.defaultPanelPositions;return this.locale.uiLanguageDirection!=="rtl"?[i,o,u,h,t,a,c,d,f,r]:[o,i,h,u,t,c,a,f,d,r]}get _defaultPanelPositionName(){return this.locale.uiLanguageDirection==="rtl"?"sw":"se"}static defaultPanelPositions={south:(t,r)=>({top:t.bottom,left:t.left-(r.width-t.width)/2,name:"s"}),southEast:t=>({top:t.bottom,left:t.left,name:"se"}),southWest:(t,r)=>({top:t.bottom,left:t.left-r.width+t.width,name:"sw"}),southMiddleEast:(t,r)=>({top:t.bottom,left:t.left-(r.width-t.width)/4,name:"sme"}),southMiddleWest:(t,r)=>({top:t.bottom,left:t.left-(r.width-t.width)*3/4,name:"smw"}),north:(t,r)=>({top:t.top-r.height,left:t.left-(r.width-t.width)/2,name:"n"}),northEast:(t,r)=>({top:t.top-r.height,left:t.left,name:"ne"}),northWest:(t,r)=>({top:t.top-r.height,left:t.left-r.width+t.width,name:"nw"}),northMiddleEast:(t,r)=>({top:t.top-r.height,left:t.left-(r.width-t.width)/4,name:"nme"}),northMiddleWest:(t,r)=>({top:t.top-r.height,left:t.left-(r.width-t.width)*3/4,name:"nmw"})};static _getOptimalPosition=getOptimalPosition},DropdownButtonView=class extends ButtonView{arrowView;constructor(e){super(e),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{"aria-haspopup":!0,"aria-expanded":this.bindTemplate.to("isOn",t=>String(t))}}),this.delegate("execute").to(this,"open")}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new IconView;return e.content=dropdownArrowIcon,e.extendTemplate({attributes:{class:"ck-dropdown__arrow"}}),e}},ListItemView=class extends View2{children;constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!0),this.children=this.createCollection(),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__item",t.if("isVisible","ck-hidden",r=>!r)],role:"presentation"},children:this.children})}focus(){this.children.first&&this.children.first.focus()}},ListSeparatorView=class extends View2{constructor(e){super(e),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__separator"]}})}},ListItemGroupView=class extends View2{labelView;items;children;constructor(e,t=new LabelView){super(e);const r=this.bindTemplate,i=new ListView(e);this.set({label:"",isVisible:!0}),this.labelView=t,this.labelView.bind("text").to(this,"label"),this.children=this.createCollection(),this.children.addMany([this.labelView,i]),i.set({role:"group",ariaLabelledBy:t.id}),i.focusTracker.destroy(),i.keystrokes.destroy(),this.items=i.items,this.setTemplate({tag:"li",attributes:{role:"presentation",class:["ck","ck-list__group",r.if("isVisible","ck-hidden",o=>!o)]},children:this.children})}focus(){if(this.items){const e=this.items.find(t=>!(t instanceof ListSeparatorView));e&&e.focus()}}},ListView=class extends View2{focusables;items;focusTracker;keystrokes;_focusCycler;_listItemGroupToChangeListeners=new WeakMap;constructor(e){super(e);const t=this.bindTemplate;this.focusables=new ViewCollection,this.items=this.createCollection(),this.focusTracker=new FocusTracker,this.keystrokes=new KeystrokeHandler,this._focusCycler=new FocusCycler({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this.set("ariaLabel",void 0),this.set("ariaLabelledBy",void 0),this.set("role",void 0),this.setTemplate({tag:"ul",attributes:{class:["ck","ck-reset","ck-list"],role:t.to("role"),"aria-label":t.to("ariaLabel"),"aria-labelledby":t.to("ariaLabelledBy")},children:this.items})}render(){super.render();for(const e of this.items)e instanceof ListItemGroupView?this._registerFocusableItemsGroup(e):e instanceof ListItemView&&this._registerFocusableListItem(e);this.items.on("change",(e,t)=>{for(const r of t.removed)r instanceof ListItemGroupView?this._deregisterFocusableItemsGroup(r):r instanceof ListItemView&&this._deregisterFocusableListItem(r);for(const r of Array.from(t.added).reverse())r instanceof ListItemGroupView?this._registerFocusableItemsGroup(r,t.index):this._registerFocusableListItem(r,t.index)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}focusFirst(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}_registerFocusableListItem(e,t){this.focusTracker.add(e.element),this.focusables.add(e,t)}_deregisterFocusableListItem(e){this.focusTracker.remove(e.element),this.focusables.remove(e)}_getOnGroupItemsChangeCallback(e){return(t,r)=>{for(const i of r.removed)this._deregisterFocusableListItem(i);for(const i of Array.from(r.added).reverse())this._registerFocusableListItem(i,this.items.getIndex(e)+r.index)}}_registerFocusableItemsGroup(e,t){Array.from(e.items).forEach((i,o)=>{const a=typeof t<"u"?t+o:void 0;this._registerFocusableListItem(i,a)});const r=this._getOnGroupItemsChangeCallback(e);this._listItemGroupToChangeListeners.set(e,r),e.items.on("change",r)}_deregisterFocusableItemsGroup(e){for(const t of e.items)this._deregisterFocusableListItem(t);e.items.off("change",this._listItemGroupToChangeListeners.get(e)),this._listItemGroupToChangeListeners.delete(e)}},toPx$5=toUnit("px"),POSITION_OFF_SCREEN={top:-99999,left:-99999,name:"arrowless",config:{withArrow:!1}},BalloonPanelView=class br extends View2{content;_pinWhenIsVisibleCallback;_resizeObserver;constructor(t){super(t);const r=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("position","arrow_nw"),this.set("isVisible",!1),this.set("withArrow",!0),this.set("class",void 0),this._pinWhenIsVisibleCallback=null,this._resizeObserver=null,this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-panel",r.to("position",i=>`ck-balloon-panel_${i}`),r.if("isVisible","ck-balloon-panel_visible"),r.if("withArrow","ck-balloon-panel_with-arrow"),r.to("class")],style:{top:r.to("top",toPx$5),left:r.to("left",toPx$5)}},children:this.content})}destroy(){this.hide(),super.destroy()}show(){this.isVisible=!0}hide(){this.isVisible=!1}attachTo(t){const r=getDomElement(t.target);if(r&&!isVisible2(r))return!1;this.show();const i=br.defaultPositions,o=Object.assign({},{element:this.element,positions:[i.southArrowNorth,i.southArrowNorthMiddleWest,i.southArrowNorthMiddleEast,i.southArrowNorthWest,i.southArrowNorthEast,i.northArrowSouth,i.northArrowSouthMiddleWest,i.northArrowSouthMiddleEast,i.northArrowSouthWest,i.northArrowSouthEast,i.viewportStickyNorth],limiter:global2.document.body,fitInViewport:!0},t),a=br._getOptimalPosition(o)||POSITION_OFF_SCREEN,c=parseInt(a.left),u=parseInt(a.top),h=a.name,d=a.config||{},{withArrow:f=!0}=d;return this.top=u,this.left=c,this.position=h,this.withArrow=f,!0}pin(t){this.unpin(),this._startPinning(t)&&(this._pinWhenIsVisibleCallback=()=>{this.isVisible?this._startPinning(t):this._stopPinning()},this.listenTo(this,"change:isVisible",this._pinWhenIsVisibleCallback))}unpin(){this._pinWhenIsVisibleCallback&&(this._stopPinning(),this.stopListening(this,"change:isVisible",this._pinWhenIsVisibleCallback),this._pinWhenIsVisibleCallback=null,this.hide())}_startPinning(t){if(!this.attachTo(t))return!1;let r=getDomElement(t.target);const i=t.limiter?getDomElement(t.limiter):global2.document.body;if(this.listenTo(global2.document,"scroll",(o,a)=>{const c=a.target,u=r&&c.contains(r),h=i&&c.contains(i);(u||h||!r||!i)&&this.attachTo(t)},{useCapture:!0}),this.listenTo(global2.window,"resize",()=>{this.attachTo(t)}),!this._resizeObserver&&(r&&isText(r)&&(r=r.parentElement),r)){const o=()=>{isVisible2(r)||this.unpin()};this._resizeObserver=new ResizeObserver2(r,o)}return!0}_stopPinning(){this.stopListening(global2.document,"scroll"),this.stopListening(global2.window,"resize"),this._resizeObserver&&(this._resizeObserver.destroy(),this._resizeObserver=null)}static generatePositions(t={}){const{sideOffset:r=br.arrowSideOffset,heightOffset:i=br.arrowHeightOffset,stickyVerticalOffset:o=br.stickyVerticalOffset,config:a}=t;return{northWestArrowSouthWest:(h,d)=>({top:c(h,d),left:h.left-r,name:"arrow_sw",...a&&{config:a}}),northWestArrowSouthMiddleWest:(h,d)=>({top:c(h,d),left:h.left-d.width*.25-r,name:"arrow_smw",...a&&{config:a}}),northWestArrowSouth:(h,d)=>({top:c(h,d),left:h.left-d.width/2,name:"arrow_s",...a&&{config:a}}),northWestArrowSouthMiddleEast:(h,d)=>({top:c(h,d),left:h.left-d.width*.75+r,name:"arrow_sme",...a&&{config:a}}),northWestArrowSouthEast:(h,d)=>({top:c(h,d),left:h.left-d.width+r,name:"arrow_se",...a&&{config:a}}),northArrowSouthWest:(h,d)=>({top:c(h,d),left:h.left+h.width/2-r,name:"arrow_sw",...a&&{config:a}}),northArrowSouthMiddleWest:(h,d)=>({top:c(h,d),left:h.left+h.width/2-d.width*.25-r,name:"arrow_smw",...a&&{config:a}}),northArrowSouth:(h,d)=>({top:c(h,d),left:h.left+h.width/2-d.width/2,name:"arrow_s",...a&&{config:a}}),northArrowSouthMiddleEast:(h,d)=>({top:c(h,d),left:h.left+h.width/2-d.width*.75+r,name:"arrow_sme",...a&&{config:a}}),northArrowSouthEast:(h,d)=>({top:c(h,d),left:h.left+h.width/2-d.width+r,name:"arrow_se",...a&&{config:a}}),northEastArrowSouthWest:(h,d)=>({top:c(h,d),left:h.right-r,name:"arrow_sw",...a&&{config:a}}),northEastArrowSouthMiddleWest:(h,d)=>({top:c(h,d),left:h.right-d.width*.25-r,name:"arrow_smw",...a&&{config:a}}),northEastArrowSouth:(h,d)=>({top:c(h,d),left:h.right-d.width/2,name:"arrow_s",...a&&{config:a}}),northEastArrowSouthMiddleEast:(h,d)=>({top:c(h,d),left:h.right-d.width*.75+r,name:"arrow_sme",...a&&{config:a}}),northEastArrowSouthEast:(h,d)=>({top:c(h,d),left:h.right-d.width+r,name:"arrow_se",...a&&{config:a}}),southWestArrowNorthWest:h=>({top:u(h),left:h.left-r,name:"arrow_nw",...a&&{config:a}}),southWestArrowNorthMiddleWest:(h,d)=>({top:u(h),left:h.left-d.width*.25-r,name:"arrow_nmw",...a&&{config:a}}),southWestArrowNorth:(h,d)=>({top:u(h),left:h.left-d.width/2,name:"arrow_n",...a&&{config:a}}),southWestArrowNorthMiddleEast:(h,d)=>({top:u(h),left:h.left-d.width*.75+r,name:"arrow_nme",...a&&{config:a}}),southWestArrowNorthEast:(h,d)=>({top:u(h),left:h.left-d.width+r,name:"arrow_ne",...a&&{config:a}}),southArrowNorthWest:h=>({top:u(h),left:h.left+h.width/2-r,name:"arrow_nw",...a&&{config:a}}),southArrowNorthMiddleWest:(h,d)=>({top:u(h),left:h.left+h.width/2-d.width*.25-r,name:"arrow_nmw",...a&&{config:a}}),southArrowNorth:(h,d)=>({top:u(h),left:h.left+h.width/2-d.width/2,name:"arrow_n",...a&&{config:a}}),southArrowNorthMiddleEast:(h,d)=>({top:u(h),left:h.left+h.width/2-d.width*.75+r,name:"arrow_nme",...a&&{config:a}}),southArrowNorthEast:(h,d)=>({top:u(h),left:h.left+h.width/2-d.width+r,name:"arrow_ne",...a&&{config:a}}),southEastArrowNorthWest:h=>({top:u(h),left:h.right-r,name:"arrow_nw",...a&&{config:a}}),southEastArrowNorthMiddleWest:(h,d)=>({top:u(h),left:h.right-d.width*.25-r,name:"arrow_nmw",...a&&{config:a}}),southEastArrowNorth:(h,d)=>({top:u(h),left:h.right-d.width/2,name:"arrow_n",...a&&{config:a}}),southEastArrowNorthMiddleEast:(h,d)=>({top:u(h),left:h.right-d.width*.75+r,name:"arrow_nme",...a&&{config:a}}),southEastArrowNorthEast:(h,d)=>({top:u(h),left:h.right-d.width+r,name:"arrow_ne",...a&&{config:a}}),westArrowEast:(h,d)=>({top:h.top+h.height/2-d.height/2,left:h.left-d.width-i,name:"arrow_e",...a&&{config:a}}),eastArrowWest:(h,d)=>({top:h.top+h.height/2-d.height/2,left:h.right+i,name:"arrow_w",...a&&{config:a}}),viewportStickyNorth:(h,d,f,m)=>{const g=m||f;return!h.getIntersection(g)||g.height-h.height>o?null:{top:g.top+o,left:h.left+h.width/2-d.width/2,name:"arrowless",config:{withArrow:!1,...a}}}};function c(h,d){return h.top-d.height-i}function u(h){return h.bottom+i}}static arrowSideOffset=25;static arrowHeightOffset=10;static stickyVerticalOffset=20;static _getOptimalPosition=getOptimalPosition;static defaultPositions=br.generatePositions()};function getDomElement(e){return isElement_default(e)?e:isRange(e)?e.commonAncestorContainer:typeof e=="function"?getDomElement(e()):null}var ToolbarSeparatorView=class extends View2{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__separator"]}})}},ToolbarLineBreakView=class extends View2{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__line-break"]}})}};function preventDefault(e){return e.bindTemplate.to(t=>{t.target===e.element&&t.preventDefault()})}function normalizeToolbarConfig(e){if(Array.isArray(e))return{items:e,removeItems:[]};const t={items:[],removeItems:[]};return e?{...t,...e}:t}var NESTED_TOOLBAR_ICONS={alignLeft:icons.alignLeft,bold:icons.bold,importExport:icons.importExport,paragraph:icons.paragraph,plus:icons.plus,text:icons.text,threeVerticalDots:icons.threeVerticalDots,pilcrow:icons.pilcrow,dragIndicator:icons.dragIndicator},ToolbarView=class extends View2{options;items;focusTracker;keystrokes;itemsView;children;focusables;_focusCycler;_behavior;constructor(e,t){super(e);const r=this.bindTemplate,i=this.t;this.options=t||{},this.set("ariaLabel",i("Editor toolbar")),this.set("maxWidth","auto"),this.items=this.createCollection(),this.focusTracker=new FocusTracker,this.keystrokes=new KeystrokeHandler,this.set("class",void 0),this.set("isCompact",!1),this.itemsView=new ItemsView(e),this.children=this.createCollection(),this.children.add(this.itemsView),this.focusables=this.createCollection();const o=e.uiLanguageDirection==="rtl";this._focusCycler=new FocusCycler({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:[o?"arrowright":"arrowleft","arrowup"],focusNext:[o?"arrowleft":"arrowright","arrowdown"]}});const a=["ck","ck-toolbar",r.to("class"),r.if("isCompact","ck-toolbar_compact")];this.options.shouldGroupWhenFull&&this.options.isFloating&&a.push("ck-toolbar_floating"),this.setTemplate({tag:"div",attributes:{class:a,role:"toolbar","aria-label":r.to("ariaLabel"),style:{maxWidth:r.to("maxWidth")},tabindex:-1},children:this.children,on:{mousedown:preventDefault(this)}}),this._behavior=this.options.shouldGroupWhenFull?new DynamicGrouping(this):new StaticLayout(this)}render(){super.render(),this.focusTracker.add(this.element);for(const e of this.items)this.focusTracker.add(e);this.items.on("add",(e,t)=>{this.focusTracker.add(t)}),this.items.on("remove",(e,t)=>{this.focusTracker.remove(t)}),this.keystrokes.listenTo(this.element),this._behavior.render(this)}destroy(){return this._behavior.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy(),super.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}fillFromConfig(e,t,r){this.items.addMany(this._buildItemsFromConfig(e,t,r))}_buildItemsFromConfig(e,t,r){const i=normalizeToolbarConfig(e),o=r||i.removeItems;return this._cleanItemsConfiguration(i.items,t,o).map(c=>isObject_default(c)?this._createNestedToolbarDropdown(c,t,o):c==="|"?new ToolbarSeparatorView:c==="-"?new ToolbarLineBreakView:t.create(c)).filter(c=>!!c)}_cleanItemsConfiguration(e,t,r){const i=e.filter((o,a,c)=>o==="|"?!0:r.indexOf(o)!==-1?!1:o==="-"?this.options.shouldGroupWhenFull?(logWarning("toolbarview-line-break-ignored-when-grouping-items",c),!1):!0:!isObject_default(o)&&!t.has(o)?(logWarning("toolbarview-item-unavailable",{item:o}),!1):!0);return this._cleanSeparatorsAndLineBreaks(i)}_cleanSeparatorsAndLineBreaks(e){const t=a=>a!=="-"&&a!=="|",r=e.length,i=e.findIndex(t);if(i===-1)return[];const o=r-e.slice().reverse().findIndex(t);return e.slice(i,o).filter((a,c,u)=>t(a)?!0:!(c>0&&u[c-1]===a))}_createNestedToolbarDropdown(e,t,r){let{label:i,icon:o,items:a,tooltip:c=!0,withText:u=!1}=e;if(a=this._cleanItemsConfiguration(a,t,r),!a.length)return null;const h=this.locale,d=createDropdown(h);return i||logWarning("toolbarview-nested-toolbar-dropdown-missing-label",e),d.class="ck-toolbar__nested-toolbar-dropdown",d.buttonView.set({label:i,tooltip:c,withText:!!u}),o!==!1?d.buttonView.icon=NESTED_TOOLBAR_ICONS[o]||o||icons.threeVerticalDots:d.buttonView.withText=!0,addToolbarToDropdown(d,()=>d.toolbarView._buildItemsFromConfig(a,t,r)),d}},ItemsView=class extends View2{children;constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar__items"]},children:this.children})}},StaticLayout=class{constructor(e){const t=e.bindTemplate;e.set("isVertical",!1),e.itemsView.children.bindTo(e.items).using(r=>r),e.focusables.bindTo(e.items).using(r=>isFocusable(r)?r:null),e.extendTemplate({attributes:{class:[t.if("isVertical","ck-toolbar_vertical")]}})}render(){}destroy(){}},DynamicGrouping=class{view;viewChildren;viewFocusables;viewItemsView;viewFocusTracker;viewLocale;ungroupedItems;groupedItems;groupedItemsDropdown;resizeObserver=null;cachedPadding=null;shouldUpdateGroupingOnNextResize=!1;viewElement;constructor(e){this.view=e,this.viewChildren=e.children,this.viewFocusables=e.focusables,this.viewItemsView=e.itemsView,this.viewFocusTracker=e.focusTracker,this.viewLocale=e.locale,this.ungroupedItems=e.createCollection(),this.groupedItems=e.createCollection(),this.groupedItemsDropdown=this._createGroupedItemsDropdown(),e.itemsView.children.bindTo(this.ungroupedItems).using(t=>t),this.ungroupedItems.on("change",this._updateFocusCyclableItems.bind(this)),e.children.on("change",this._updateFocusCyclableItems.bind(this)),e.items.on("change",(t,r)=>{const i=r.index,o=Array.from(r.added);for(const a of r.removed)i>=this.ungroupedItems.length?this.groupedItems.remove(a):this.ungroupedItems.remove(a);for(let a=i;a<i+o.length;a++){const c=o[a-i];a>this.ungroupedItems.length?this.groupedItems.add(c,a-this.ungroupedItems.length):this.ungroupedItems.add(c,a)}this._updateGrouping()}),e.extendTemplate({attributes:{class:["ck-toolbar_grouping"]}})}render(e){this.viewElement=e.element,this._enableGroupingOnResize(),this._enableGroupingOnMaxWidthChange(e)}destroy(){this.groupedItemsDropdown.destroy(),this.resizeObserver.destroy()}_updateGrouping(){if(!this.viewElement.ownerDocument.body.contains(this.viewElement))return;if(!isVisible2(this.viewElement)){this.shouldUpdateGroupingOnNextResize=!0;return}const e=this.groupedItems.length;let t;for(;this._areItemsOverflowing;)this._groupLastItem(),t=!0;if(!t&&this.groupedItems.length){for(;this.groupedItems.length&&!this._areItemsOverflowing;)this._ungroupFirstItem();this._areItemsOverflowing&&this._groupLastItem()}this.groupedItems.length!==e&&this.view.fire("groupedItemsUpdate")}get _areItemsOverflowing(){if(!this.ungroupedItems.length)return!1;const e=this.viewElement,t=this.viewLocale.uiLanguageDirection,r=new Rect(e.lastChild),i=new Rect(e);if(!this.cachedPadding){const o=global2.window.getComputedStyle(e),a=t==="ltr"?"paddingRight":"paddingLeft";this.cachedPadding=Number.parseInt(o[a])}return t==="ltr"?r.right>i.right-this.cachedPadding:r.left<i.left+this.cachedPadding}_enableGroupingOnResize(){let e;this.resizeObserver=new ResizeObserver2(this.viewElement,t=>{(!e||e!==t.contentRect.width||this.shouldUpdateGroupingOnNextResize)&&(this.shouldUpdateGroupingOnNextResize=!1,this._updateGrouping(),e=t.contentRect.width)}),this._updateGrouping()}_enableGroupingOnMaxWidthChange(e){e.on("change:maxWidth",()=>{this._updateGrouping()})}_groupLastItem(){this.groupedItems.length||(this.viewChildren.add(new ToolbarSeparatorView),this.viewChildren.add(this.groupedItemsDropdown),this.viewFocusTracker.add(this.groupedItemsDropdown.element)),this.groupedItems.add(this.ungroupedItems.remove(this.ungroupedItems.last),0)}_ungroupFirstItem(){this.ungroupedItems.add(this.groupedItems.remove(this.groupedItems.first)),this.groupedItems.length||(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last),this.viewFocusTracker.remove(this.groupedItemsDropdown.element))}_createGroupedItemsDropdown(){const e=this.viewLocale,t=e.t,r=createDropdown(e);return r.class="ck-toolbar__grouped-dropdown",r.panelPosition=e.uiLanguageDirection==="ltr"?"sw":"se",addToolbarToDropdown(r,this.groupedItems),r.buttonView.set({label:t("Show more items"),tooltip:!0,tooltipPosition:e.uiLanguageDirection==="rtl"?"se":"sw",icon:icons.threeVerticalDots}),r}_updateFocusCyclableItems(){this.viewFocusables.clear(),this.ungroupedItems.map(e=>{isFocusable(e)&&this.viewFocusables.add(e)}),this.groupedItems.length&&this.viewFocusables.add(this.groupedItemsDropdown)}},SplitButtonView=class extends View2{children;actionView;arrowView;keystrokes;focusTracker;constructor(e,t){super(e);const r=this.bindTemplate;this.set("class",void 0),this.set("labelStyle",void 0),this.set("icon",void 0),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isToggleable",!1),this.set("isVisible",!0),this.set("keystroke",void 0),this.set("withKeystroke",!1),this.set("label",void 0),this.set("tabindex",-1),this.set("tooltip",!1),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.children=this.createCollection(),this.actionView=this._createActionView(t),this.arrowView=this._createArrowView(),this.keystrokes=new KeystrokeHandler,this.focusTracker=new FocusTracker,this.setTemplate({tag:"div",attributes:{class:["ck","ck-splitbutton",r.to("class"),r.if("isVisible","ck-hidden",i=>!i),this.arrowView.bindTemplate.if("isOn","ck-splitbutton_open")]},children:this.children})}render(){super.render(),this.children.add(this.actionView),this.children.add(this.arrowView),this.focusTracker.add(this.actionView.element),this.focusTracker.add(this.arrowView.element),this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",(e,t)=>{this.focusTracker.focusedElement===this.actionView.element&&(this.arrowView.focus(),t())}),this.keystrokes.set("arrowleft",(e,t)=>{this.focusTracker.focusedElement===this.arrowView.element&&(this.actionView.focus(),t())})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this.actionView.focus()}_createActionView(e){const t=e||new ButtonView;return e||t.bind("icon","isEnabled","isOn","isToggleable","keystroke","label","tabindex","tooltip","tooltipPosition","type","withText").to(this),t.extendTemplate({attributes:{class:"ck-splitbutton__action"}}),t.delegate("execute").to(this),t}_createArrowView(){const e=new ButtonView,t=e.bindTemplate;return e.icon=dropdownArrowIcon,e.extendTemplate({attributes:{class:["ck-splitbutton__arrow"],"data-cke-tooltip-disabled":t.to("isOn"),"aria-haspopup":!0,"aria-expanded":t.to("isOn",r=>String(r))}}),e.bind("isEnabled").to(this),e.bind("label").to(this),e.bind("tooltip").to(this),e.delegate("execute").to(this,"open"),e}};function createDropdown(e,t=DropdownButtonView){const r=typeof t=="function"?new t(e):t,i=new DropdownPanelView(e),o=new DropdownView(e,r,i);return r.bind("isEnabled").to(o),r instanceof SplitButtonView?r.arrowView.bind("isOn").to(o,"isOpen"):r.bind("isOn").to(o,"isOpen"),addDefaultBehaviors(o),o}function addToolbarToDropdown(e,t,r={}){e.extendTemplate({attributes:{class:["ck-toolbar-dropdown"]}}),e.isOpen?addToolbarToOpenDropdown(e,t,r):e.once("change:isOpen",()=>addToolbarToOpenDropdown(e,t,r),{priority:"highest"}),r.enableActiveItemFocusOnDropdownOpen&&focusChildOnDropdownOpen(e,()=>e.toolbarView.items.find(i=>i.isOn))}function addToolbarToOpenDropdown(e,t,r){const i=e.locale,o=i.t,a=e.toolbarView=new ToolbarView(i),c=typeof t=="function"?t():t;a.ariaLabel=r.ariaLabel||o("Dropdown toolbar"),r.maxWidth&&(a.maxWidth=r.maxWidth),r.class&&(a.class=r.class),r.isCompact&&(a.isCompact=r.isCompact),r.isVertical&&(a.isVertical=!0),c instanceof ViewCollection?a.items.bindTo(c).using(u=>u):a.items.addMany(c),e.panelView.children.add(a),e.focusTracker.add(a),a.items.delegate("execute").to(e)}function addListToDropdown(e,t,r={}){e.isOpen?addListToOpenDropdown(e,t,r):e.once("change:isOpen",()=>addListToOpenDropdown(e,t,r),{priority:"highest"}),focusChildOnDropdownOpen(e,()=>e.listView.items.find(i=>i instanceof ListItemView?i.children.first.isOn:!1))}function addListToOpenDropdown(e,t,r){const i=e.locale,o=e.listView=new ListView(i),a=typeof t=="function"?t():t;o.ariaLabel=r.ariaLabel,o.role=r.role,bindViewCollectionItemsToDefinitions(e,o.items,a,i),e.panelView.children.add(o),o.items.delegate("execute").to(e)}function focusChildOnDropdownOpen(e,t){e.on("change:isOpen",()=>{if(!e.isOpen)return;const r=t();r&&(typeof r.focus=="function"?r.focus():logWarning("ui-dropdown-focus-child-on-open-child-missing-focus",{view:r}))},{priority:priorities.low-10})}function addDefaultBehaviors(e){closeDropdownOnClickOutside(e),closeDropdownOnExecute(e),closeDropdownOnBlur(e),focusDropdownContentsOnArrows(e),focusDropdownButtonOnClose(e),focusDropdownPanelOnOpen(e)}function closeDropdownOnClickOutside(e){clickOutsideHandler({emitter:e,activator:()=>e.isRendered&&e.isOpen,callback:()=>{e.isOpen=!1},contextElements:()=>[e.element,...getFocusTrackerTreeElements(e.focusTracker).filter(t=>!e.element.contains(t))]})}function getFocusTrackerTreeElements(e){return[...e.elements,...e.externalViews.flatMap(t=>getFocusTrackerTreeElements(t.focusTracker))]}function closeDropdownOnExecute(e){e.on("execute",t=>{t.source instanceof SwitchButtonView||(e.isOpen=!1)})}function closeDropdownOnBlur(e){e.focusTracker.on("change:isFocused",(t,r,i)=>{i||!e.isOpen||(e.isOpen=!1)})}function focusDropdownContentsOnArrows(e){e.keystrokes.set("arrowdown",(t,r)=>{e.isOpen&&(e.panelView.focus(),r())}),e.keystrokes.set("arrowup",(t,r)=>{e.isOpen&&(e.panelView.focusLast(),r())})}function focusDropdownButtonOnClose(e){e.on("change:isOpen",(t,r,i)=>{if(i)return;e.focusTracker.elements.some(a=>a.contains(global2.document.activeElement))&&e.buttonView.focus()})}function focusDropdownPanelOnOpen(e){e.on("change:isOpen",(t,r,i)=>{i&&e.panelView.focus()},{priority:"low"})}function bindViewCollectionItemsToDefinitions(e,t,r,i){t.on("change",()=>{const o=[...t].reduce((c,u)=>(u instanceof ListItemView&&u.children.first instanceof ListItemButtonView&&c.push(u.children.first),c),[]),a=o.some(c=>c.isToggleable);o.forEach(c=>{c.hasCheckSpace=a})}),t.bindTo(r).using(o=>{if(o.type==="separator")return new ListSeparatorView(i);if(o.type==="group"){const a=new ListItemGroupView(i);return a.set({label:o.label}),bindViewCollectionItemsToDefinitions(e,a.items,o.items,i),a.items.delegate("execute").to(e),a}else if(o.type==="button"||o.type==="switchbutton"){const a=o.model.role==="menuitemcheckbox"||o.model.role==="menuitemradio",c=new ListItemView(i);let u;return o.type==="button"?(u=new ListItemButtonView(i),u.set({isToggleable:a})):u=new SwitchButtonView(i),u.bind(...Object.keys(o.model)).to(o.model),u.delegate("execute").to(c),c.children.add(u),c}return null})}var createLabeledInputText=(e,t,r)=>{const i=new InputTextView(e.locale);return i.set({id:t,ariaDescribedById:r}),i.bind("isReadOnly").to(e,"isEnabled",o=>!o),i.bind("hasError").to(e,"errorText",o=>!!o),i.on("input",()=>{e.errorText=null}),e.bind("isEmpty","isFocused","placeholder").to(i),i},waitingTime=150,ColorPickerView=class extends View2{hexInputRow;_debounceColorPickerEvent;_config;constructor(e,t={}){super(e),this.set({color:"",_hexColor:""}),this.hexInputRow=this._createInputRow();const r=this.createCollection();t.hideInput||r.add(this.hexInputRow),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker"],tabindex:-1},children:r}),this._config=t,this._debounceColorPickerEvent=debounce_default(i=>{this.set("color",i),this.fire("colorSelected",{color:this.color})},waitingTime,{leading:!0}),this.on("set:color",(i,o,a)=>{i.return=convertColor(a,this._config.format||"hsl")}),this.on("change:color",()=>{this._hexColor=convertColorToCommonHexFormat(this.color)}),this.on("change:_hexColor",()=>{document.activeElement!==this.picker&&this.picker.setAttribute("color",this._hexColor),convertColorToCommonHexFormat(this.color)!=convertColorToCommonHexFormat(this._hexColor)&&(this.color=this._hexColor)})}render(){if(super.render(),registerCustomElement("hex-color-picker",HexBase),this.picker=global2.document.createElement("hex-color-picker"),this.picker.setAttribute("class","hex-color-picker"),this.picker.setAttribute("tabindex","-1"),this._createSlidersView(),this.element){this.hexInputRow.element?this.element.insertBefore(this.picker,this.hexInputRow.element):this.element.appendChild(this.picker);const e=document.createElement("style");e.textContent='[role="slider"]:focus [part$="pointer"] {border: 1px solid #fff;outline: 1px solid var(--ck-color-focus-border);box-shadow: 0 0 0 2px #fff;}',this.picker.shadowRoot.appendChild(e)}this.picker.addEventListener("color-changed",e=>{const t=e.detail.value;this._debounceColorPickerEvent(t)})}focus(){!this._config.hideInput&&(env.isGecko||env.isiOS||env.isSafari)&&this.hexInputRow.children.get(1).focus(),this.slidersView.first.focus()}_createSlidersView(){const r=[...this.picker.shadowRoot.children].filter(i=>i.getAttribute("role")==="slider").map(i=>new SliderView(i));this.slidersView=this.createCollection(),r.forEach(i=>{this.slidersView.add(i)})}_createInputRow(){const e=this._createColorInput();return new ColorPickerInputRowView(this.locale,e)}_createColorInput(){const e=new LabeledFieldView(this.locale,createLabeledInputText),{t}=this.locale;return e.set({label:t("HEX"),class:"color-picker-hex-input"}),e.fieldView.bind("value").to(this,"_hexColor",r=>e.isFocused?e.fieldView.value:r.startsWith("#")?r.substring(1):r),e.fieldView.on("input",()=>{const r=e.fieldView.element.value;if(r){const i=tryParseHexColor(r);i&&this._debounceColorPickerEvent(i)}}),e}isValid(){const{t:e}=this.locale;return this._config.hideInput?!0:(this.resetValidationStatus(),this.hexInputRow.getParsedColor()?!0:(this.hexInputRow.inputView.errorText=e('Please enter a valid color (e.g. "ff0000").'),!1))}resetValidationStatus(){this.hexInputRow.inputView.errorText=null}};function convertColorToCommonHexFormat(e){let t=convertToHex(e);return t||(t="#000"),t.length===4&&(t="#"+[t[1],t[1],t[2],t[2],t[3],t[3]].join("")),t.toLowerCase()}var SliderView=class extends View2{constructor(e){super(),this.element=e}focus(){this.element.focus()}},HashView=class extends View2{constructor(e){super(e),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker__hash-view"]},children:"#"})}},ColorPickerInputRowView=class extends View2{children;inputView;constructor(e,t){super(e),this.inputView=t,this.children=this.createCollection([new HashView,this.inputView]),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker__row"]},children:this.children})}getParsedColor(){return tryParseHexColor(this.inputView.fieldView.element.value)}};function tryParseHexColor(e){if(!e)return null;const t=e.trim().replace(/^#/,"");return![3,4,6,8].includes(t.length)||!/^(([0-9a-fA-F]{2}){3,4}|([0-9a-fA-F]){3,4})$/.test(t)?null:`#${t}`}var DocumentColorCollection=class extends ObservableMixin(Collection){constructor(e){super(e),this.set("isEmpty",!0),this.on("change",()=>{this.set("isEmpty",this.length===0)})}add(e,t){return this.find(r=>r.color===e.color)?this:super.add(e,t)}hasColor(e){return!!this.find(t=>t.color===e)}},ColorGridsFragmentView=class extends View2{items;colorDefinitions;focusTracker;columns;documentColors;documentColorsCount;staticColorsGrid;documentColorsGrid;colorPickerButtonView;removeColorButtonView;_focusables;_documentColorsLabel;_removeButtonLabel;_colorPickerLabel;constructor(e,{colors:t,columns:r,removeButtonLabel:i,documentColorsLabel:o,documentColorsCount:a,colorPickerLabel:c,focusTracker:u,focusables:h}){super(e);const d=this.bindTemplate;this.set("isVisible",!0),this.focusTracker=u,this.items=this.createCollection(),this.colorDefinitions=t,this.columns=r,this.documentColors=new DocumentColorCollection,this.documentColorsCount=a,this._focusables=h,this._removeButtonLabel=i,this._colorPickerLabel=c,this._documentColorsLabel=o,this.setTemplate({tag:"div",attributes:{class:["ck-color-grids-fragment",d.if("isVisible","ck-hidden",f=>!f)]},children:this.items}),this.removeColorButtonView=this._createRemoveColorButton(),this.items.add(this.removeColorButtonView)}updateDocumentColors(e,t){const r=e.document,i=this.documentColorsCount;this.documentColors.clear();for(const o of r.getRoots()){const a=e.createRangeIn(o);for(const c of a.getItems())if(c.is("$textProxy")&&c.hasAttribute(t)&&(this._addColorToDocumentColors(c.getAttribute(t)),this.documentColors.length>=i))return}}updateSelectedColors(){const e=this.documentColorsGrid,t=this.staticColorsGrid,r=this.selectedColor;t.selectedColor=r,e&&(e.selectedColor=r)}render(){if(super.render(),this.staticColorsGrid=this._createStaticColorsGrid(),this.items.add(this.staticColorsGrid),this.documentColorsCount){const e=Template.bind(this.documentColors,this.documentColors),t=new View2(this.locale);t.setTemplate({tag:"span",attributes:{class:["ck","ck-color-grid__label",e.if("isEmpty","ck-hidden")]},children:[{text:this._documentColorsLabel}]}),this.items.add(t),this.documentColorsGrid=this._createDocumentColorsGrid(),this.items.add(this.documentColorsGrid)}this._createColorPickerButton(),this._addColorSelectorElementsToFocusTracker()}focus(){this.removeColorButtonView.focus()}destroy(){super.destroy()}addColorPickerButton(){this.colorPickerButtonView&&(this.items.add(this.colorPickerButtonView),this.focusTracker.add(this.colorPickerButtonView.element),this._focusables.add(this.colorPickerButtonView))}_addColorSelectorElementsToFocusTracker(){this.focusTracker.add(this.removeColorButtonView.element),this._focusables.add(this.removeColorButtonView),this.staticColorsGrid&&(this.focusTracker.add(this.staticColorsGrid.element),this._focusables.add(this.staticColorsGrid)),this.documentColorsGrid&&(this.focusTracker.add(this.documentColorsGrid.element),this._focusables.add(this.documentColorsGrid))}_createColorPickerButton(){this.colorPickerButtonView=new ButtonView,this.colorPickerButtonView.set({label:this._colorPickerLabel,withText:!0,icon:icons.colorPalette,class:"ck-color-selector__color-picker"}),this.colorPickerButtonView.on("execute",()=>{this.fire("colorPicker:show")})}_createRemoveColorButton(){const e=new ButtonView;return e.set({withText:!0,icon:icons.eraser,label:this._removeButtonLabel}),e.class="ck-color-selector__remove-color",e.on("execute",()=>{this.fire("execute",{value:null,source:"removeColorButton"})}),e.render(),e}_createStaticColorsGrid(){const e=new ColorGridView(this.locale,{colorDefinitions:this.colorDefinitions,columns:this.columns});return e.on("execute",(t,r)=>{this.fire("execute",{value:r.value,source:"staticColorsGrid"})}),e}_createDocumentColorsGrid(){const e=Template.bind(this.documentColors,this.documentColors),t=new ColorGridView(this.locale,{columns:this.columns});return t.extendTemplate({attributes:{class:e.if("isEmpty","ck-hidden")}}),t.items.bindTo(this.documentColors).using(r=>{const i=new ColorTileView;return i.set({color:r.color,hasBorder:r.options&&r.options.hasBorder}),r.label&&i.set({label:r.label,tooltip:!0}),i.on("execute",()=>{this.fire("execute",{value:r.color,source:"documentColorsGrid"})}),i}),this.documentColors.on("change:isEmpty",(r,i,o)=>{o&&(t.selectedColor=null)}),t}_addColorToDocumentColors(e){const t=this.colorDefinitions.find(r=>r.color===e);t?this.documentColors.add(Object.assign({},t)):this.documentColors.add({color:e,label:e,options:{hasBorder:!1}})}},ColorPickerFragmentView=class extends View2{items;colorPickerView;saveButtonView;cancelButtonView;actionBarView;focusTracker;keystrokes;_focusables;_colorPickerViewConfig;constructor(e,{focusTracker:t,focusables:r,keystrokes:i,colorPickerViewConfig:o}){super(e),this.items=this.createCollection(),this.focusTracker=t,this.keystrokes=i,this.set("isVisible",!1),this.set("selectedColor",void 0),this._focusables=r,this._colorPickerViewConfig=o;const a=this.bindTemplate,{saveButtonView:c,cancelButtonView:u}=this._createActionButtons();this.saveButtonView=c,this.cancelButtonView=u,this.actionBarView=this._createActionBarView({saveButtonView:c,cancelButtonView:u}),this.setTemplate({tag:"div",attributes:{class:["ck-color-picker-fragment",a.if("isVisible","ck-hidden",h=>!h)]},children:this.items})}render(){super.render();const e=new ColorPickerView(this.locale,{...this._colorPickerViewConfig});this.colorPickerView=e,this.colorPickerView.render(),this.selectedColor&&(e.color=this.selectedColor),this.listenTo(this,"change:selectedColor",(t,r,i)=>{e.color=i}),this.items.add(this.colorPickerView),this.items.add(this.actionBarView),this._addColorPickersElementsToFocusTracker(),this._stopPropagationOnArrowsKeys(),this._executeOnEnterPress(),this._executeUponColorChange()}destroy(){super.destroy()}focus(){this.colorPickerView.focus()}resetValidationStatus(){this.colorPickerView.resetValidationStatus()}_executeOnEnterPress(){this.keystrokes.set("enter",e=>{this.isVisible&&this.focusTracker.focusedElement!==this.cancelButtonView.element&&this.colorPickerView.isValid()&&(this.fire("execute",{value:this.selectedColor}),e.stopPropagation(),e.preventDefault())})}_stopPropagationOnArrowsKeys(){const e=t=>t.stopPropagation();this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e)}_addColorPickersElementsToFocusTracker(){for(const t of this.colorPickerView.slidersView)this.focusTracker.add(t.element),this._focusables.add(t);const e=this.colorPickerView.hexInputRow.children.get(1);e.element&&(this.focusTracker.add(e.element),this._focusables.add(e)),this.focusTracker.add(this.saveButtonView.element),this._focusables.add(this.saveButtonView),this.focusTracker.add(this.cancelButtonView.element),this._focusables.add(this.cancelButtonView)}_createActionBarView({saveButtonView:e,cancelButtonView:t}){const r=new View2,i=this.createCollection();return i.add(e),i.add(t),r.setTemplate({tag:"div",attributes:{class:["ck","ck-color-selector_action-bar"]},children:i}),r}_createActionButtons(){const e=this.locale,t=e.t,r=new ButtonView(e),i=new ButtonView(e);return r.set({icon:icons.check,class:"ck-button-save",type:"button",withText:!1,label:t("Accept")}),i.set({icon:icons.cancel,class:"ck-button-cancel",type:"button",withText:!1,label:t("Cancel")}),r.on("execute",()=>{this.colorPickerView.isValid()&&this.fire("execute",{source:"colorPickerSaveButton",value:this.selectedColor})}),i.on("execute",()=>{this.fire("colorPicker:cancel")}),{saveButtonView:r,cancelButtonView:i}}_executeUponColorChange(){this.colorPickerView.on("colorSelected",(e,t)=>{this.fire("execute",{value:t.color,source:"colorPicker"}),this.set("selectedColor",t.color)})}},ColorSelectorView=class extends View2{focusTracker;keystrokes;items;colorGridsFragmentView;colorPickerFragmentView;_focusCycler;_focusables;_colorPickerViewConfig;constructor(e,{colors:t,columns:r,removeButtonLabel:i,documentColorsLabel:o,documentColorsCount:a,colorPickerLabel:c,colorPickerViewConfig:u}){super(e),this.items=this.createCollection(),this.focusTracker=new FocusTracker,this.keystrokes=new KeystrokeHandler,this._focusables=new ViewCollection,this._colorPickerViewConfig=u,this._focusCycler=new FocusCycler({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.colorGridsFragmentView=new ColorGridsFragmentView(e,{colors:t,columns:r,removeButtonLabel:i,documentColorsLabel:o,documentColorsCount:a,colorPickerLabel:c,focusTracker:this.focusTracker,focusables:this._focusables}),this.colorPickerFragmentView=new ColorPickerFragmentView(e,{focusables:this._focusables,focusTracker:this.focusTracker,keystrokes:this.keystrokes,colorPickerViewConfig:u}),this.set("_isColorGridsFragmentVisible",!0),this.set("_isColorPickerFragmentVisible",!1),this.set("selectedColor",void 0),this.colorGridsFragmentView.bind("isVisible").to(this,"_isColorGridsFragmentVisible"),this.colorPickerFragmentView.bind("isVisible").to(this,"_isColorPickerFragmentVisible"),this.on("change:selectedColor",(h,d,f)=>{this.colorGridsFragmentView.set("selectedColor",f),this.colorPickerFragmentView.set("selectedColor",f)}),this.colorGridsFragmentView.on("change:selectedColor",(h,d,f)=>{this.set("selectedColor",f)}),this.colorPickerFragmentView.on("change:selectedColor",(h,d,f)=>{this.set("selectedColor",f)}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-selector"]},children:this.items})}render(){super.render(),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}appendUI(){this._appendColorGridsFragment(),this._colorPickerViewConfig&&this._appendColorPickerFragment()}showColorPickerFragment(){!this.colorPickerFragmentView.colorPickerView||this._isColorPickerFragmentVisible||(this._isColorPickerFragmentVisible=!0,this.colorPickerFragmentView.focus(),this.colorPickerFragmentView.resetValidationStatus(),this._isColorGridsFragmentVisible=!1)}showColorGridsFragment(){this._isColorGridsFragmentVisible||(this._isColorGridsFragmentVisible=!0,this.colorGridsFragmentView.focus(),this._isColorPickerFragmentVisible=!1)}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}updateDocumentColors(e,t){this.colorGridsFragmentView.updateDocumentColors(e,t)}updateSelectedColors(){this.colorGridsFragmentView.updateSelectedColors()}_appendColorGridsFragment(){this.items.length||(this.items.add(this.colorGridsFragmentView),this.colorGridsFragmentView.delegate("execute").to(this),this.colorGridsFragmentView.delegate("colorPicker:show").to(this))}_appendColorPickerFragment(){this.items.length!==2&&(this.items.add(this.colorPickerFragmentView),this.colorGridsFragmentView.colorPickerButtonView&&this.colorGridsFragmentView.colorPickerButtonView.on("execute",()=>{this.showColorPickerFragment()}),this.colorGridsFragmentView.addColorPickerButton(),this.colorPickerFragmentView.delegate("execute").to(this),this.colorPickerFragmentView.delegate("colorPicker:cancel").to(this))}},ComponentFactory=class{editor;_components=new Map;constructor(e){this.editor=e}*names(){for(const e of this._components.values())yield e.originalName}add(e,t){this._components.set(getNormalized(e),{callback:t,originalName:e})}create(e){if(!this.has(e))throw new CKEditorError("componentfactory-item-missing",this,{name:e});return this._components.get(getNormalized(e)).callback(this.editor.locale)}has(e){return this._components.has(getNormalized(e))}};function getNormalized(e){return String(e).toLowerCase()}var BALLOON_CLASS="ck-tooltip",TooltipManager=class kt extends DomEmitterMixin(){tooltipTextView;balloonPanelView;static defaultBalloonPositions=BalloonPanelView.generatePositions({heightOffset:5,sideOffset:13});_currentElementWithTooltip=null;_currentTooltipPosition=null;_mutationObserver=null;_pinTooltipDebounced;_unpinTooltipDebounced;_watchdogExcluded;static _editors=new Set;static _instance=null;constructor(t){if(super(),kt._editors.add(t),kt._instance)return kt._instance;kt._instance=this,this.tooltipTextView=new View2(t.locale),this.tooltipTextView.set("text",""),this.tooltipTextView.setTemplate({tag:"span",attributes:{class:["ck","ck-tooltip__text"]},children:[{text:this.tooltipTextView.bindTemplate.to("text")}]}),this.balloonPanelView=new BalloonPanelView(t.locale),this.balloonPanelView.class=BALLOON_CLASS,this.balloonPanelView.content.add(this.tooltipTextView),this._mutationObserver=createMutationObserver(()=>{this._updateTooltipPosition()}),this._pinTooltipDebounced=debounce_default(this._pinTooltip,600),this._unpinTooltipDebounced=debounce_default(this._unpinTooltip,400),this.listenTo(global2.document,"keydown",this._onKeyDown.bind(this),{useCapture:!0}),this.listenTo(global2.document,"mouseenter",this._onEnterOrFocus.bind(this),{useCapture:!0}),this.listenTo(global2.document,"mouseleave",this._onLeaveOrBlur.bind(this),{useCapture:!0}),this.listenTo(global2.document,"focus",this._onEnterOrFocus.bind(this),{useCapture:!0}),this.listenTo(global2.document,"blur",this._onLeaveOrBlur.bind(this),{useCapture:!0}),this.listenTo(global2.document,"scroll",this._onScroll.bind(this),{useCapture:!0}),this._watchdogExcluded=!0}destroy(t){const r=t.ui.view&&t.ui.view.body;kt._editors.delete(t),this.stopListening(t.ui),r&&r.has(this.balloonPanelView)&&r.remove(this.balloonPanelView),kt._editors.size||(this._unpinTooltip(),this.balloonPanelView.destroy(),this.stopListening(),kt._instance=null)}static getPositioningFunctions(t){const r=kt.defaultBalloonPositions;return{s:[r.southArrowNorth,r.southArrowNorthEast,r.southArrowNorthWest],n:[r.northArrowSouth],e:[r.eastArrowWest],w:[r.westArrowEast],sw:[r.southArrowNorthEast],se:[r.southArrowNorthWest]}[t]}_onKeyDown(t,r){r.key==="Escape"&&this._currentElementWithTooltip&&(this._unpinTooltip(),r.stopPropagation())}_onEnterOrFocus(t,{target:r}){const i=getDescendantWithTooltip(r);if(!i){t.name==="focus"&&this._unpinTooltip();return}i!==this._currentElementWithTooltip&&(this._unpinTooltip(),t.name==="focus"&&!i.matches(":hover")?this._pinTooltip(i,getTooltipData(i)):this._pinTooltipDebounced(i,getTooltipData(i)))}_onLeaveOrBlur(t,{target:r,relatedTarget:i}){if(t.name==="mouseleave"){if(!isElement_default(r))return;const o=this.balloonPanelView.element,a=o&&(o===i||o.contains(i)),c=!a&&r===o;if(a){this._unpinTooltipDebounced.cancel();return}if(!c&&this._currentElementWithTooltip&&r!==this._currentElementWithTooltip)return;const u=getDescendantWithTooltip(r),h=getDescendantWithTooltip(i);(c||u&&u!==h)&&this._unpinTooltipDebounced()}else{if(this._currentElementWithTooltip&&r!==this._currentElementWithTooltip)return;this._unpinTooltipDebounced()}}_onScroll(t,{target:r}){this._currentElementWithTooltip&&(r.contains(this.balloonPanelView.element)&&r.contains(this._currentElementWithTooltip)||this._unpinTooltip())}_pinTooltip(t,{text:r,position:i,cssClass:o}){this._unpinTooltip();const a=first(kt._editors.values()).ui.view.body;a.has(this.balloonPanelView)||a.add(this.balloonPanelView),this.tooltipTextView.text=r,this.balloonPanelView.class=[BALLOON_CLASS,o].filter(c=>c).join(" "),this.balloonPanelView.pin({target:t,positions:kt.getPositioningFunctions(i)}),this._mutationObserver.attach(t);for(const c of kt._editors)this.listenTo(c.ui,"update",this._updateTooltipPosition.bind(this),{priority:"low"});this._currentElementWithTooltip=t,this._currentTooltipPosition=i}_unpinTooltip(){this._unpinTooltipDebounced.cancel(),this._pinTooltipDebounced.cancel(),this.balloonPanelView.unpin();for(const t of kt._editors)this.stopListening(t.ui,"update");this._currentElementWithTooltip=null,this._currentTooltipPosition=null,this.tooltipTextView.text="",this._mutationObserver.detach()}_updateTooltipPosition(){if(!this._currentElementWithTooltip)return;const t=getTooltipData(this._currentElementWithTooltip);if(!isVisible2(this._currentElementWithTooltip)||!t.text){this._unpinTooltip();return}this.balloonPanelView.pin({target:this._currentElementWithTooltip,positions:kt.getPositioningFunctions(t.position)})}};function getDescendantWithTooltip(e){return isElement_default(e)?e.closest("[data-cke-tooltip-text]:not([data-cke-tooltip-disabled])"):null}function getTooltipData(e){return{text:e.dataset.ckeTooltipText,position:e.dataset.ckeTooltipPosition||"s",cssClass:e.dataset.ckeTooltipClass||""}}function createMutationObserver(e){const t=new MutationObserver(()=>{e()});return{attach(r){t.observe(r,{attributes:!0,attributeFilter:["data-cke-tooltip-text","data-cke-tooltip-position"]})},detach(){t.disconnect()}}}var NARROW_ROOT_HEIGHT_THRESHOLD=50,NARROW_ROOT_WIDTH_THRESHOLD=350,Badge=class extends DomEmitterMixin(){editor;_balloonView=null;_showBalloonThrottled=throttle_default(()=>this._showBalloon(),50,{leading:!0});_lastFocusedEditableElement=null;_balloonClass;constructor(e,t={}){super(),this.editor=e,this._balloonClass=t.balloonClass,e.on("ready",()=>this._handleEditorReady())}destroy(){const e=this._balloonView;e&&(e.unpin(),this._balloonView=null),this._showBalloonThrottled.cancel(),this.stopListening()}_handleEditorReady(){const e=this.editor;this._isEnabled()&&e.ui.view&&(e.ui.focusTracker.on("change:isFocused",(t,r,i)=>{this._updateLastFocusedEditableElement(),i?this._showBalloon():this._hideBalloon()}),e.ui.focusTracker.on("change:focusedElement",(t,r,i)=>{this._updateLastFocusedEditableElement(),i&&this._showBalloon()}),e.ui.on("update",()=>{this._showBalloonThrottled()}))}_getNormalizedConfig(){return{side:this.editor.locale.contentLanguageDirection==="ltr"?"right":"left",position:"border",verticalOffset:0,horizontalOffset:5}}_showBalloon(){const e=this._getBalloonAttachOptions();e&&(this._balloonView||(this._balloonView=this._createBalloonView()),this._balloonView.pin(e))}_hideBalloon(){this._balloonView&&this._balloonView.unpin()}_createBalloonView(){const e=this.editor,t=new BalloonPanelView,r=this._createBadgeContent();return t.content.add(r),this._balloonClass&&(t.class=this._balloonClass),e.ui.view.body.add(t),t}_getBalloonAttachOptions(){if(!this._lastFocusedEditableElement)return null;const e=this._getNormalizedConfig(),t=e.side==="right"?getLowerRightCornerPosition(this._lastFocusedEditableElement,e):getLowerLeftCornerPosition(this._lastFocusedEditableElement,e);return{target:this._lastFocusedEditableElement,positions:[t]}}_updateLastFocusedEditableElement(){const e=this.editor,t=e.ui.focusTracker.isFocused,r=e.ui.focusTracker.focusedElement;if(!t||!r){this._lastFocusedEditableElement=null;return}const i=Array.from(e.ui.getEditableElementsNames()).map(o=>e.ui.getEditableElement(o));i.includes(r)?this._lastFocusedEditableElement=r:this._lastFocusedEditableElement=i[0]}};function getLowerRightCornerPosition(e,t){return getLowerCornerPosition(e,t,(r,i)=>r.left+r.width-i.width-t.horizontalOffset)}function getLowerLeftCornerPosition(e,t){return getLowerCornerPosition(e,t,r=>r.left+t.horizontalOffset)}function getLowerCornerPosition(e,t,r){return(i,o)=>{const a=new Rect(e);if(a.width<NARROW_ROOT_WIDTH_THRESHOLD||a.height<NARROW_ROOT_HEIGHT_THRESHOLD)return null;let c;t.position==="inside"?c=a.bottom-o.height:c=a.bottom-o.height/2,c-=t.verticalOffset;const u=r(a,o),d=i.clone().moveTo(u,c).getIntersection(o.clone().moveTo(u,c)).getVisible();return!d||d.getArea()<o.getArea()?null:{top:c,left:u,name:`position_${t.position}-side_${t.side}`,config:{withArrow:!1}}}}var poweredByIcon=`<svg xmlns="http://www.w3.org/2000/svg" width="53" height="10" viewBox="0 0 53 10"><path fill="#1C2331" d="M31.724 1.492a15.139 15.139 0 0 0 .045 1.16 2.434 2.434 0 0 0-.687-.34 3.68 3.68 0 0 0-1.103-.166 2.332 2.332 0 0 0-1.14.255 1.549 1.549 0 0 0-.686.87c-.15.41-.225.98-.225 1.712 0 .939.148 1.659.444 2.161.297.503.792.754 1.487.754.452.015.9-.094 1.294-.316.296-.174.557-.4.771-.669l.14.852h1.282V.007h-1.623v1.485ZM31 6.496a1.77 1.77 0 0 1-.494.061.964.964 0 0 1-.521-.127.758.758 0 0 1-.296-.466 3.984 3.984 0 0 1-.093-.992 4.208 4.208 0 0 1 .098-1.052.753.753 0 0 1 .307-.477 1.08 1.08 0 0 1 .55-.122c.233-.004.466.026.69.089l.483.144v2.553c-.11.076-.213.143-.307.2a1.73 1.73 0 0 1-.417.189ZM35.68 0l-.702.004c-.322.002-.482.168-.48.497l.004.581c.002.33.164.493.486.49l.702-.004c.322-.002.481-.167.48-.496L36.165.49c-.002-.33-.164-.493-.486-.491ZM36.145 2.313l-1.612.01.034 5.482 1.613-.01-.035-5.482ZM39.623.79 37.989.8 38 2.306l-.946.056.006 1.009.949-.006.024 2.983c.003.476.143.844.419 1.106.275.26.658.39 1.148.387.132 0 .293-.01.483-.03.19-.02.38-.046.57-.08.163-.028.324-.068.482-.119l-.183-1.095-.702.004a.664.664 0 0 1-.456-.123.553.553 0 0 1-.14-.422l-.016-2.621 1.513-.01-.006-1.064-1.514.01-.01-1.503ZM46.226 2.388c-.41-.184-.956-.274-1.636-.27-.673.004-1.215.101-1.627.29-.402.179-.72.505-.888.91-.18.419-.268.979-.264 1.68.004.688.1 1.24.285 1.655.172.404.495.724.9.894.414.18.957.268 1.63.264.68-.004 1.224-.099 1.632-.284.4-.176.714-.501.878-.905.176-.418.263-.971.258-1.658-.004-.702-.097-1.261-.28-1.677a1.696 1.696 0 0 0-.888-.9Zm-.613 3.607a.77.77 0 0 1-.337.501 1.649 1.649 0 0 1-1.317.009.776.776 0 0 1-.343-.497 4.066 4.066 0 0 1-.105-1.02 4.136 4.136 0 0 1 .092-1.03.786.786 0 0 1 .337-.507 1.59 1.59 0 0 1 1.316-.008.79.79 0 0 1 .344.502c.078.337.113.683.105 1.03.012.343-.019.685-.092 1.02ZM52.114 2.07a2.67 2.67 0 0 0-1.128.278c-.39.191-.752.437-1.072.73l-.157-.846-1.273.008.036 5.572 1.623-.01-.024-3.78c.35-.124.646-.22.887-.286.26-.075.53-.114.8-.118l.45-.003.144-1.546-.286.001ZM22.083 7.426l-1.576-2.532a2.137 2.137 0 0 0-.172-.253 1.95 1.95 0 0 0-.304-.29.138.138 0 0 1 .042-.04 1.7 1.7 0 0 0 .328-.374l1.75-2.71c.01-.015.025-.028.024-.048-.01-.01-.021-.007-.031-.007L20.49 1.17a.078.078 0 0 0-.075.045l-.868 1.384c-.23.366-.46.732-.688 1.099a.108.108 0 0 1-.112.06c-.098-.005-.196-.001-.294-.002-.018 0-.038.006-.055-.007.002-.02.002-.039.005-.058a4.6 4.6 0 0 0 .046-.701V1.203c0-.02-.009-.032-.03-.03h-.033L16.93 1.17c-.084 0-.073-.01-.073.076v6.491c-.001.018.006.028.025.027h1.494c.083 0 .072.007.072-.071v-2.19c0-.055-.003-.11-.004-.166a3.366 3.366 0 0 0-.05-.417h.06c.104 0 .209.002.313-.002a.082.082 0 0 1 .084.05c.535.913 1.07 1.824 1.607 2.736a.104.104 0 0 0 .103.062c.554-.003 1.107-.002 1.66-.002l.069-.003-.019-.032-.188-.304ZM27.112 6.555c-.005-.08-.004-.08-.082-.08h-2.414c-.053 0-.106-.003-.159-.011a.279.279 0 0 1-.246-.209.558.558 0 0 1-.022-.15c0-.382 0-.762-.002-1.143 0-.032.007-.049.042-.044h2.504c.029.003.037-.012.034-.038V3.814c0-.089.013-.078-.076-.078h-2.44c-.07 0-.062.003-.062-.06v-.837c0-.047.004-.093.013-.14a.283.283 0 0 1 .241-.246.717.717 0 0 1 .146-.011h2.484c.024.002.035-.009.036-.033l.003-.038.03-.496c.01-.183.024-.365.034-.548.005-.085.003-.087-.082-.094-.218-.018-.437-.038-.655-.05a17.845 17.845 0 0 0-.657-.026 72.994 72.994 0 0 0-1.756-.016 1.7 1.7 0 0 0-.471.064 1.286 1.286 0 0 0-.817.655c-.099.196-.149.413-.145.633v3.875c0 .072.003.144.011.216a1.27 1.27 0 0 0 .711 1.029c.228.113.48.167.734.158.757-.005 1.515.002 2.272-.042.274-.016.548-.034.82-.053.03-.002.043-.008.04-.041-.008-.104-.012-.208-.019-.312a69.964 69.964 0 0 1-.05-.768ZM16.14 7.415l-.127-1.075c-.004-.03-.014-.04-.044-.037a13.125 13.125 0 0 1-.998.073c-.336.01-.672.02-1.008.016-.116-.001-.233-.014-.347-.039a.746.746 0 0 1-.45-.262c-.075-.1-.132-.211-.167-.33a3.324 3.324 0 0 1-.126-.773 9.113 9.113 0 0 1-.015-.749c0-.285.022-.57.065-.852.023-.158.066-.312.127-.46a.728.728 0 0 1 .518-.443 1.64 1.64 0 0 1 .397-.048c.628-.001 1.255.003 1.882.05.022.001.033-.006.036-.026l.003-.031.06-.55c.019-.177.036-.355.057-.532.004-.034-.005-.046-.04-.056a5.595 5.595 0 0 0-1.213-.21 10.783 10.783 0 0 0-.708-.02c-.24-.003-.48.01-.719.041a3.477 3.477 0 0 0-.625.14 1.912 1.912 0 0 0-.807.497c-.185.2-.33.433-.424.688a4.311 4.311 0 0 0-.24 1.096c-.031.286-.045.572-.042.86-.006.43.024.86.091 1.286.04.25.104.497.193.734.098.279.26.53.473.734.214.205.473.358.756.446.344.11.702.17 1.063.177a8.505 8.505 0 0 0 1.578-.083 6.11 6.11 0 0 0 .766-.18c.03-.008.047-.023.037-.057a.157.157 0 0 1-.003-.025Z"/><path fill="#AFE229" d="M6.016 6.69a1.592 1.592 0 0 0-.614.21c-.23.132-.422.32-.56.546-.044.072-.287.539-.287.539l-.836 1.528.009.006c.038.025.08.046.123.063.127.046.26.07.395.073.505.023 1.011-.007 1.517-.003.29.009.58.002.869-.022a.886.886 0 0 0 .395-.116.962.962 0 0 0 .312-.286c.056-.083.114-.163.164-.249.24-.408.48-.816.718-1.226.075-.128.148-.257.222-.386l.112-.192a1.07 1.07 0 0 0 .153-.518l-1.304.023s-1.258-.005-1.388.01Z"/><path fill="#771BFF" d="m2.848 9.044.76-1.39.184-.352c-.124-.067-.245-.14-.367-.21-.346-.204-.706-.384-1.045-.6a.984.984 0 0 1-.244-.207c-.108-.134-.136-.294-.144-.46-.021-.409-.002-.818-.009-1.227-.003-.195 0-.39.003-.585.004-.322.153-.553.427-.713l.833-.488c.22-.13.44-.257.662-.385.05-.029.105-.052.158-.077.272-.128.519-.047.76.085l.044.028c.123.06.242.125.358.196.318.178.635.357.952.537.095.056.187.117.275.184.194.144.254.35.266.578.016.284.007.569.006.853-.001.28.004.558 0 .838.592-.003 1.259 0 1.259 0l.723-.013c-.003-.292-.007-.584-.007-.876 0-.524.015-1.048-.016-1.571-.024-.42-.135-.8-.492-1.067a5.02 5.02 0 0 0-.506-.339A400.52 400.52 0 0 0 5.94.787C5.722.664 5.513.524 5.282.423 5.255.406 5.228.388 5.2.373 4.758.126 4.305-.026 3.807.21c-.097.046-.197.087-.29.14A699.896 699.896 0 0 0 .783 1.948c-.501.294-.773.717-.778 1.31-.004.36-.009.718-.001 1.077.016.754-.017 1.508.024 2.261.016.304.07.6.269.848.127.15.279.28.448.382.622.4 1.283.734 1.92 1.11l.183.109Z"/></svg>
`,DEFAULT_LABEL="Powered by",PoweredBy=class extends Badge{constructor(e){super(e,{balloonClass:"ck-powered-by-balloon"})}_isEnabled(){const e=this.editor;if(e.config.get("ui.poweredBy.forceVisible"))return!0;const r=e.config.get("licenseKey");if(r=="GPL")return!0;const i=parseBase64EncodedObject(r.split(".")[1]);return i?!i.whiteLabel:!0}_createBadgeContent(){return new PoweredByView(this.editor.locale,this._getNormalizedConfig().label)}_getNormalizedConfig(){const e=super._getNormalizedConfig(),t=this.editor.config.get("ui.poweredBy")||{},r=t.position||e.position,i=r==="inside"?5:e.verticalOffset;return{position:r,side:t.side||e.side,label:t.label===void 0?DEFAULT_LABEL:t.label,verticalOffset:t.verticalOffset!==void 0?t.verticalOffset:i,horizontalOffset:t.horizontalOffset!==void 0?t.horizontalOffset:e.horizontalOffset,forceVisible:!!t.forceVisible}}},PoweredByView=class extends View2{constructor(e,t){super(e);const r=new IconView,i=this.bindTemplate;r.set({content:poweredByIcon,isColorInherited:!1}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-powered-by"],"aria-hidden":!0},children:[{tag:"a",attributes:{href:"https://ckeditor.com/powered-by-ckeditor/?utm_source=ckeditor&utm_medium=referral&utm_campaign=701Dn000000hVgmIAE_powered_by_ckeditor_logo",target:"_blank",tabindex:"-1"},children:[...t?[{tag:"span",attributes:{class:["ck","ck-powered-by__label"]},children:[t]}]:[],r],on:{dragstart:i.to(o=>o.preventDefault())}}]})}},EvaluationBadge=class extends Badge{licenseTypeMessage={evaluation:"For evaluation purposes only",trial:"For evaluation purposes only",development:"For development purposes only"};constructor(e){super(e,{balloonClass:"ck-evaluation-badge-balloon"})}_isEnabled(){const t=this.editor.config.get("licenseKey"),r=getLicenseTypeFromLicenseKey(t);return!!(r&&this.licenseTypeMessage[r])}_createBadgeContent(){const e=this.editor.config.get("licenseKey"),t=getLicenseTypeFromLicenseKey(e);return new EvaluationBadgeView(this.editor.locale,this.licenseTypeMessage[t])}_getNormalizedConfig(){const e=super._getNormalizedConfig(),t=this.editor.config.get("ui.poweredBy")||{},r=t.position||e.position,i=t.side||e.side;return{position:r,side:i==="left"?"right":"left",verticalOffset:e.verticalOffset,horizontalOffset:e.horizontalOffset}}},EvaluationBadgeView=class extends View2{constructor(e,t){super(e),this.setTemplate({tag:"div",attributes:{class:["ck","ck-evaluation-badge"],"aria-hidden":!0},children:[{tag:"span",attributes:{class:["ck","ck-evaluation-badge__label"]},children:[t]}]})}};function getLicenseTypeFromLicenseKey(e){if(e=="GPL")return"GPL";const t=parseBase64EncodedObject(e.split(".")[1]);return t?t.licenseType||"production":null}var AriaLiveAnnouncerPoliteness={POLITE:"polite",ASSERTIVE:"assertive"},AriaLiveAnnouncer=class{editor;view;constructor(e){this.editor=e,e.once("ready",()=>{for(const t of Object.values(AriaLiveAnnouncerPoliteness))this.announce("",t)})}announce(e,t=AriaLiveAnnouncerPoliteness.POLITE){const r=this.editor;if(!r.ui.view)return;this.view||(this.view=new AriaLiveAnnouncerView(r.locale),r.ui.view.body.add(this.view));const{politeness:i,isUnsafeHTML:o}=typeof t=="string"?{politeness:t}:t;let a=this.view.regionViews.find(c=>c.politeness===i);a||(a=new AriaLiveAnnouncerRegionView(r,i),this.view.regionViews.add(a)),a.announce({announcement:e,isUnsafeHTML:o})}},AriaLiveAnnouncerView=class extends View2{regionViews;constructor(e){super(e),this.regionViews=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-aria-live-announcer"]},children:this.regionViews})}},AriaLiveAnnouncerRegionView=class extends View2{politeness;_domConverter;_pruneAnnouncementsInterval;constructor(e,t){super(e.locale),this.setTemplate({tag:"div",attributes:{"aria-live":t,"aria-relevant":"additions"},children:[{tag:"ul",attributes:{class:["ck","ck-aria-live-region-list"]}}]}),e.on("destroy",()=>{this._pruneAnnouncementsInterval!==null&&(clearInterval(this._pruneAnnouncementsInterval),this._pruneAnnouncementsInterval=null)}),this.politeness=t,this._domConverter=e.data.htmlProcessor.domConverter,this._pruneAnnouncementsInterval=setInterval(()=>{this.element&&this._listElement.firstChild&&this._listElement.firstChild.remove()},5e3)}announce({announcement:e,isUnsafeHTML:t}){if(!e.trim().length)return;const r=document.createElement("li");t?this._domConverter.setContentOf(r,e):r.innerText=e,this._listElement.appendChild(r)}get _listElement(){return this.element.querySelector("ul")}},MenuBarMenuListItemView=class extends ListItemView{constructor(e,t){super(e);const r=this.bindTemplate;this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item"]},on:{mouseenter:r.to("mouseenter")}}),this.delegate("mouseenter").to(t)}},NESTED_PANEL_HORIZONTAL_OFFSET=5,MenuBarBehaviors={toggleMenusAndFocusItemsOnHover(e){e.on("menu:mouseenter",t=>{if(!(!e.isFocusBorderEnabled&&!e.isOpen)){if(e.isOpen)for(const r of e.menus){const i=t.path[0],o=i instanceof MenuBarMenuListItemView&&i.children.first===r;r.isOpen=(t.path.includes(r)||o)&&r.isEnabled}t.source.focus()}})},focusCycleMenusOnArrows(e){const t=e.locale.uiLanguageDirection==="rtl";e.on("menu:arrowright",i=>{r(i.source,t?-1:1)}),e.on("menu:arrowleft",i=>{r(i.source,t?1:-1)});function r(i,o){const a=e.children.getIndex(i),c=i.isOpen,u=e.children.length,h=e.children.get((a+u+o)%u);i.isOpen=!1,c&&(h.isOpen=!0),h.buttonView.focus()}},closeMenusWhenTheBarCloses(e){e.on("change:isOpen",()=>{e.isOpen||e.menus.forEach(t=>{t.isOpen=!1})})},closeMenuWhenAnotherOnTheSameLevelOpens(e){e.on("menu:change:isOpen",(t,r,i)=>{i&&e.menus.filter(o=>t.source.parentMenuView===o.parentMenuView&&t.source!==o&&o.isOpen).forEach(o=>{o.isOpen=!1})})},closeOnClickOutside(e){clickOutsideHandler({emitter:e,activator:()=>e.isOpen,callback:()=>e.close(),contextElements:()=>e.children.map(t=>t.element)})},enableFocusHighlightOnInteraction(e){let t=!1;e.on("change:isOpen",(r,i,o)=>{o||(t||(e.isFocusBorderEnabled=!1),t=!1)}),e.listenTo(e.element,"keydown",()=>{t=!0},{useCapture:!0}),e.listenTo(e.element,"keyup",()=>{t=!1},{useCapture:!0}),e.listenTo(e.element,"focus",()=>{t&&(e.isFocusBorderEnabled=!0)},{useCapture:!0})}},MenuBarMenuBehaviors={openAndFocusPanelOnArrowDownKey(e){e.keystrokes.set("arrowdown",(t,r)=>{e.focusTracker.focusedElement===e.buttonView.element&&(e.isOpen||(e.isOpen=!0),e.panelView.focus(),r())})},openOnArrowRightKey(e){const t=e.locale.uiLanguageDirection==="rtl"?"arrowleft":"arrowright";e.keystrokes.set(t,(r,i)=>{e.focusTracker.focusedElement!==e.buttonView.element||!e.isEnabled||(e.isOpen||(e.isOpen=!0),e.panelView.focus(),i())})},openOnButtonClick(e){e.buttonView.on("execute",()=>{e.isOpen=!0})},toggleOnButtonClick(e){e.buttonView.on("execute",()=>{e.isOpen=!e.isOpen})},openAndFocusOnEnterKeyPress(e){e.keystrokes.set("enter",(t,r)=>{e.focusTracker.focusedElement===e.buttonView.element&&(e.isOpen=!0,e.panelView.focus(),r())})},closeOnArrowLeftKey(e){const t=e.locale.uiLanguageDirection==="rtl"?"arrowright":"arrowleft";e.keystrokes.set(t,(r,i)=>{e.isOpen&&(e.isOpen=!1,e.focus(),i())})},closeOnEscKey(e){e.keystrokes.set("esc",(t,r)=>{e.isOpen&&(e.isOpen=!1,e.focus(),r())})},closeOnParentClose(e){e.parentMenuView.on("change:isOpen",(t,r,i)=>{!i&&t.source===e.parentMenuView&&(e.isOpen=!1)})}},MenuBarMenuViewPanelPositioningFunctions={southEast:e=>({top:e.bottom,left:e.left,name:"se"}),southWest:(e,t)=>({top:e.bottom,left:e.left-t.width+e.width,name:"sw"}),northEast:(e,t)=>({top:e.top-t.height,left:e.left,name:"ne"}),northWest:(e,t)=>({top:e.top-t.height,left:e.left-t.width+e.width,name:"nw"}),eastSouth:e=>({top:e.top,left:e.right-NESTED_PANEL_HORIZONTAL_OFFSET,name:"es"}),eastNorth:(e,t)=>({top:e.top-t.height,left:e.right-NESTED_PANEL_HORIZONTAL_OFFSET,name:"en"}),westSouth:(e,t)=>({top:e.top,left:e.left-t.width+NESTED_PANEL_HORIZONTAL_OFFSET,name:"ws"}),westNorth:(e,t)=>({top:e.top-t.height,left:e.left-t.width+NESTED_PANEL_HORIZONTAL_OFFSET,name:"wn"})},DefaultMenuBarItems=[{menuId:"file",label:"File",groups:[{groupId:"export",items:["menuBar:exportPdf","menuBar:exportWord"]},{groupId:"import",items:["menuBar:importWord"]},{groupId:"revisionHistory",items:["menuBar:revisionHistory"]}]},{menuId:"edit",label:"Edit",groups:[{groupId:"undo",items:["menuBar:undo","menuBar:redo"]},{groupId:"selectAll",items:["menuBar:selectAll"]},{groupId:"findAndReplace",items:["menuBar:findAndReplace"]}]},{menuId:"view",label:"View",groups:[{groupId:"sourceEditing",items:["menuBar:sourceEditing"]},{groupId:"showBlocks",items:["menuBar:showBlocks"]},{groupId:"previewMergeFields",items:["menuBar:previewMergeFields"]},{groupId:"restrictedEditing",items:["menuBar:restrictedEditing"]}]},{menuId:"insert",label:"Insert",groups:[{groupId:"insertMainWidgets",items:["menuBar:insertImage","menuBar:ckbox","menuBar:ckfinder","menuBar:insertTable"]},{groupId:"insertInline",items:["menuBar:link","menuBar:bookmark","menuBar:comment","menuBar:insertMergeField"]},{groupId:"insertMinorWidgets",items:["menuBar:mediaEmbed","menuBar:insertTemplate","menuBar:specialCharacters","menuBar:blockQuote","menuBar:codeBlock","menuBar:htmlEmbed"]},{groupId:"insertStructureWidgets",items:["menuBar:horizontalLine","menuBar:pageBreak","menuBar:tableOfContents"]},{groupId:"restrictedEditingException",items:["menuBar:restrictedEditingException"]}]},{menuId:"format",label:"Format",groups:[{groupId:"textAndFont",items:[{menuId:"text",label:"Text",groups:[{groupId:"basicStyles",items:["menuBar:bold","menuBar:italic","menuBar:underline","menuBar:strikethrough","menuBar:superscript","menuBar:subscript","menuBar:code"]},{groupId:"textPartLanguage",items:["menuBar:textPartLanguage"]}]},{menuId:"font",label:"Font",groups:[{groupId:"fontProperties",items:["menuBar:fontSize","menuBar:fontFamily"]},{groupId:"fontColors",items:["menuBar:fontColor","menuBar:fontBackgroundColor"]},{groupId:"highlight",items:["menuBar:highlight"]}]},"menuBar:heading"]},{groupId:"list",items:["menuBar:bulletedList","menuBar:numberedList","menuBar:multiLevelList","menuBar:todoList"]},{groupId:"indent",items:["menuBar:alignment","menuBar:indent","menuBar:outdent"]},{groupId:"caseChange",items:["menuBar:caseChange"]},{groupId:"removeFormat",items:["menuBar:removeFormat"]}]},{menuId:"tools",label:"Tools",groups:[{groupId:"aiTools",items:["menuBar:aiAssistant","menuBar:aiCommands"]},{groupId:"tools",items:["menuBar:trackChanges","menuBar:commentsArchive"]}]},{menuId:"help",label:"Help",groups:[{groupId:"help",items:["menuBar:accessibilityHelp"]}]}];function normalizeMenuBarConfig(e){let t;return!("items"in e)||!e.items?t={items:cloneDeep_default(DefaultMenuBarItems),addItems:[],removeItems:[],isVisible:!0,isUsingDefaultConfig:!0,...e}:t={items:e.items,removeItems:[],addItems:[],isVisible:!0,isUsingDefaultConfig:!1,...e},t}function processMenuBarConfig({normalizedConfig:e,locale:t,componentFactory:r,extraItems:i}){const o=cloneDeep_default(e);return handleAdditions(e,o,i),handleRemovals(e,o),handleAdditions(e,o,o.addItems),purgeUnavailableComponents(e,o,r),purgeEmptyMenus(e,o),localizeMenuLabels(o,t),o}function handleRemovals(e,t){const r=t.removeItems,i=[];t.items=t.items.filter(({menuId:o})=>r.includes(o)?(i.push(o),!1):!0),walkConfigMenus(t.items,o=>{o.groups=o.groups.filter(({groupId:a})=>r.includes(a)?(i.push(a),!1):!0);for(const a of o.groups)a.items=a.items.filter(c=>{const u=getIdFromGroupItem(c);return r.includes(u)?(i.push(u),!1):!0})});for(const o of r)i.includes(o)||logWarning("menu-bar-item-could-not-be-removed",{menuBarConfig:e,itemName:o})}function handleAdditions(e,t,r){const i=[];if(r.length!=0){for(const o of r){const a=getRelationFromPosition(o.position),c=getRelativeIdFromPosition(o.position);if(isMenuBarMenuAddition(o))if(!c)a==="start"?(t.items.unshift(o.menu),i.push(o)):a==="end"&&(t.items.push(o.menu),i.push(o));else{const u=t.items.findIndex(h=>h.menuId===c);u!=-1?a==="before"?(t.items.splice(u,0,o.menu),i.push(o)):a==="after"&&(t.items.splice(u+1,0,o.menu),i.push(o)):addMenuOrItemToGroup(t,o.menu,c,a)&&i.push(o)}else isMenuBarMenuGroupAddition(o)?walkConfigMenus(t.items,u=>{if(u.menuId===c)a==="start"?(u.groups.unshift(o.group),i.push(o)):a==="end"&&(u.groups.push(o.group),i.push(o));else{const h=u.groups.findIndex(d=>d.groupId===c);h!==-1&&(a==="before"?(u.groups.splice(h,0,o.group),i.push(o)):a==="after"&&(u.groups.splice(h+1,0,o.group),i.push(o)))}}):addMenuOrItemToGroup(t,o.item,c,a)&&i.push(o)}for(const o of r)i.includes(o)||logWarning("menu-bar-item-could-not-be-added",{menuBarConfig:e,addedItemConfig:o})}}function addMenuOrItemToGroup(e,t,r,i){let o=!1;return walkConfigMenus(e.items,a=>{for(const{groupId:c,items:u}of a.groups){if(o)return;if(c===r)i==="start"?(u.unshift(t),o=!0):i==="end"&&(u.push(t),o=!0);else{const h=u.findIndex(d=>getIdFromGroupItem(d)===r);h!==-1&&(i==="before"?(u.splice(h,0,t),o=!0):i==="after"&&(u.splice(h+1,0,t),o=!0))}}}),o}function purgeUnavailableComponents(e,t,r){walkConfigMenus(t.items,i=>{for(const o of i.groups)o.items=o.items.filter(a=>{const c=typeof a=="string"&&!r.has(a);return c&&!t.isUsingDefaultConfig&&logWarning("menu-bar-item-unavailable",{menuBarConfig:e,parentMenuConfig:cloneDeep_default(i),componentName:a}),!c})})}function purgeEmptyMenus(e,t){const r=t.isUsingDefaultConfig;let i=!1;if(t.items=t.items.filter(o=>o.groups.length?!0:(warnAboutEmptyMenu(e,o,r),!1)),!t.items.length){warnAboutEmptyMenu(e,e,r);return}walkConfigMenus(t.items,o=>{o.groups=o.groups.filter(a=>a.items.length?!0:(i=!0,!1));for(const a of o.groups)a.items=a.items.filter(c=>isMenuDefinition(c)&&!c.groups.length?(warnAboutEmptyMenu(e,c,r),i=!0,!1):!0)}),i&&purgeEmptyMenus(e,t)}function warnAboutEmptyMenu(e,t,r){r||logWarning("menu-bar-menu-empty",{menuBarConfig:e,emptyMenuConfig:t})}function localizeMenuLabels(e,t){const r=t.t,i={File:r({string:"File",id:"MENU_BAR_MENU_FILE"}),Edit:r({string:"Edit",id:"MENU_BAR_MENU_EDIT"}),View:r({string:"View",id:"MENU_BAR_MENU_VIEW"}),Insert:r({string:"Insert",id:"MENU_BAR_MENU_INSERT"}),Format:r({string:"Format",id:"MENU_BAR_MENU_FORMAT"}),Tools:r({string:"Tools",id:"MENU_BAR_MENU_TOOLS"}),Help:r({string:"Help",id:"MENU_BAR_MENU_HELP"}),Text:r({string:"Text",id:"MENU_BAR_MENU_TEXT"}),Font:r({string:"Font",id:"MENU_BAR_MENU_FONT"})};walkConfigMenus(e.items,o=>{o.label in i&&(o.label=i[o.label])})}function walkConfigMenus(e,t){if(Array.isArray(e))for(const i of e)r(i);function r(i){t(i);for(const o of i.groups)for(const a of o.items)isMenuDefinition(a)&&r(a)}}function isMenuBarMenuAddition(e){return typeof e=="object"&&"menu"in e}function isMenuBarMenuGroupAddition(e){return typeof e=="object"&&"group"in e}function getRelationFromPosition(e){return e.startsWith("start")?"start":e.startsWith("end")?"end":e.startsWith("after")?"after":"before"}function getRelativeIdFromPosition(e){const t=e.match(/^[^:]+:(.+)/);return t?t[1]:null}function getIdFromGroupItem(e){return typeof e=="string"?e:e.menuId}function isMenuDefinition(e){return typeof e=="object"&&"menuId"in e}var EditorUI=class extends ObservableMixin(){editor;componentFactory;focusTracker;tooltipManager;poweredBy;evaluationBadge;ariaLiveAnnouncer;isReady=!1;_editableElementsMap=new Map;_focusableToolbarDefinitions=[];_extraMenuBarElements=[];_lastFocusedForeignElement=null;constructor(e){super();const t=e.editing.view;this.editor=e,this.componentFactory=new ComponentFactory(e),this.focusTracker=new FocusTracker,this.tooltipManager=new TooltipManager(e),this.poweredBy=new PoweredBy(e),this.evaluationBadge=new EvaluationBadge(e),this.ariaLiveAnnouncer=new AriaLiveAnnouncer(e),this.set("viewportOffset",this._readViewportOffsetFromConfig()),this.once("ready",()=>{this._bindBodyCollectionWithFocusTracker(),this.isReady=!0}),this.listenTo(t.document,"layoutChanged",this.update.bind(this)),this.listenTo(t,"scrollToTheSelection",this._handleScrollToTheSelection.bind(this)),this._initFocusTracking()}get element(){return null}update(){this.fire("update")}destroy(){this.stopListening(),this.focusTracker.destroy(),this.tooltipManager.destroy(this.editor),this.poweredBy.destroy(),this.evaluationBadge.destroy();for(const e of this._editableElementsMap.values())e.ckeditorInstance=null,this.editor.keystrokes.stopListening(e);this._editableElementsMap=new Map,this._focusableToolbarDefinitions=[]}setEditableElement(e,t){this._editableElementsMap.set(e,t),t.ckeditorInstance||(t.ckeditorInstance=this.editor),this.focusTracker.add(t);const r=()=>{this.editor.editing.view.getDomRoot(e)||this.editor.keystrokes.listenTo(t)};this.isReady?r():this.once("ready",r)}removeEditableElement(e){const t=this._editableElementsMap.get(e);t&&(this._editableElementsMap.delete(e),this.editor.keystrokes.stopListening(t),this.focusTracker.remove(t),t.ckeditorInstance=null)}getEditableElement(e="main"){return this._editableElementsMap.get(e)}getEditableElementsNames(){return this._editableElementsMap.keys()}addToolbar(e,t={}){e.isRendered?(this.focusTracker.add(e),this.editor.keystrokes.listenTo(e.element)):e.once("render",()=>{this.focusTracker.add(e),this.editor.keystrokes.listenTo(e.element)}),this._focusableToolbarDefinitions.push({toolbarView:e,options:t})}extendMenuBar(e){this._extraMenuBarElements.push(e)}get _editableElements(){return console.warn("editor-ui-deprecated-editable-elements: The EditorUI#_editableElements property has been deprecated and will be removed in the near future.",{editorUI:this}),this._editableElementsMap}_initMenuBar(e){const t=e.element;this.focusTracker.add(t),this.editor.keystrokes.listenTo(t);const r=normalizeMenuBarConfig(this.editor.config.get("menuBar")||{});e.fillFromConfig(r,this.componentFactory,this._extraMenuBarElements),this.editor.keystrokes.set("Esc",(i,o)=>{t.contains(this.editor.ui.focusTracker.focusedElement)&&(this._lastFocusedForeignElement?(this._lastFocusedForeignElement.focus(),this._lastFocusedForeignElement=null):this.editor.editing.view.focus(),o())}),this.editor.keystrokes.set("Alt+F9",(i,o)=>{t.contains(this.editor.ui.focusTracker.focusedElement)||(this._saveLastFocusedForeignElement(),e.isFocusBorderEnabled=!0,e.focus(),o())})}_readViewportOffsetFromConfig(){const e=this.editor,t=e.config.get("ui.viewportOffset");if(t)return t;const r=e.config.get("toolbar.viewportTopOffset");return r?(console.warn("editor-ui-deprecated-viewport-offset-config: The `toolbar.vieportTopOffset` configuration option is deprecated. It will be removed from future CKEditor versions. Use `ui.viewportOffset.top` instead."),{top:r}):{top:0}}_initFocusTracking(){const e=this.editor;let t;e.keystrokes.set("Alt+F10",(r,i)=>{this._saveLastFocusedForeignElement();const o=this._getCurrentFocusedToolbarDefinition();(!o||!t)&&(t=this._getFocusableCandidateToolbarDefinitions());for(let a=0;a<t.length;a++){const c=t.shift();if(t.push(c),c!==o&&this._focusFocusableCandidateToolbar(c)){o&&o.options.afterBlur&&o.options.afterBlur();break}}i()}),e.keystrokes.set("Esc",(r,i)=>{const o=this._getCurrentFocusedToolbarDefinition();o&&(this._lastFocusedForeignElement?(this._lastFocusedForeignElement.focus(),this._lastFocusedForeignElement=null):e.editing.view.focus(),o.options.afterBlur&&o.options.afterBlur(),i())})}_saveLastFocusedForeignElement(){const e=this.focusTracker.focusedElement;Array.from(this._editableElementsMap.values()).includes(e)&&!Array.from(this.editor.editing.view.domRoots.values()).includes(e)&&(this._lastFocusedForeignElement=e)}_getFocusableCandidateToolbarDefinitions(){const e=[];for(const t of this._focusableToolbarDefinitions){const{toolbarView:r,options:i}=t;(isVisible2(r.element)||i.beforeFocus)&&e.push(t)}return e.sort((t,r)=>getToolbarDefinitionWeight(t)-getToolbarDefinitionWeight(r)),e}_getCurrentFocusedToolbarDefinition(){for(const e of this._focusableToolbarDefinitions)if(e.toolbarView.element&&e.toolbarView.element.contains(this.focusTracker.focusedElement))return e;return null}_focusFocusableCandidateToolbar(e){const{toolbarView:t,options:{beforeFocus:r}}=e;return r&&r(),isVisible2(t.element)?(t.focus(),!0):!1}_handleScrollToTheSelection(e,t){const r={top:0,bottom:0,left:0,right:0,...this.viewportOffset};t.viewportOffset.top+=r.top,t.viewportOffset.bottom+=r.bottom,t.viewportOffset.left+=r.left,t.viewportOffset.right+=r.right}_bindBodyCollectionWithFocusTracker(){const e=this.view.body;for(const t of e)this.focusTracker.add(t.element);e.on("add",(t,r)=>{this.focusTracker.add(r.element)}),e.on("remove",(t,r)=>{this.focusTracker.remove(r.element)})}};function getToolbarDefinitionWeight(e){const{toolbarView:t,options:r}=e;let i=10;return isVisible2(t.element)&&i--,r.isContextual&&i--,i}var EditorUIView=class extends View2{body;menuBarView;constructor(e){super(e),this.body=new BodyCollection(e)}render(){super.render(),this.body.attachToDom()}destroy(){return this.body.detachFromDom(),super.destroy()}},BoxedEditorUIView=class extends EditorUIView{top;main;_voiceLabelView;constructor(e){super(e),this.top=this.createCollection(),this.main=this.createCollection(),this._voiceLabelView=this._createVoiceLabel(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-editor","ck-rounded-corners"],role:"application",dir:e.uiLanguageDirection,lang:e.uiLanguage,"aria-labelledby":this._voiceLabelView.id},children:[this._voiceLabelView,{tag:"div",attributes:{class:["ck","ck-editor__top","ck-reset_all"],role:"presentation"},children:this.top},{tag:"div",attributes:{class:["ck","ck-editor__main"],role:"presentation"},children:this.main}]})}_createVoiceLabel(){const e=this.t,t=new LabelView;return t.text=e("Rich Text Editor"),t.extendTemplate({attributes:{class:"ck-voice-label"}}),t}},EditableUIView=class extends View2{name=null;_editingView;_editableElement;_hasExternalElement;constructor(e,t,r){super(e),this.setTemplate({tag:"div",attributes:{class:["ck","ck-content","ck-editor__editable","ck-rounded-corners"],lang:e.contentLanguage,dir:e.contentLanguageDirection}}),this.set("isFocused",!1),this._editableElement=r,this._hasExternalElement=!!this._editableElement,this._editingView=t}render(){super.render(),this._hasExternalElement?this.template.apply(this.element=this._editableElement):this._editableElement=this.element,this.on("change:isFocused",()=>this._updateIsFocusedClasses()),this._updateIsFocusedClasses()}destroy(){this._hasExternalElement&&this.template.revert(this._editableElement),super.destroy()}get hasExternalElement(){return this._hasExternalElement}_updateIsFocusedClasses(){const e=this._editingView;e.isRenderingInProgress?r(this):t(this);function t(i){e.change(o=>{const a=e.document.getRoot(i.name);o.addClass(i.isFocused?"ck-focused":"ck-blurred",a),o.removeClass(i.isFocused?"ck-blurred":"ck-focused",a)})}function r(i){e.once("change:isRenderingInProgress",(o,a,c)=>{c?r(i):t(i)})}}},InlineEditableUIView=class extends EditableUIView{_options;constructor(e,t,r,i={}){super(e,t,r),this._options=i,this.extendTemplate({attributes:{role:"textbox",class:"ck-editor__editable_inline"}})}render(){super.render();const e=this._editingView;e.change(t=>{const r=e.document.getRoot(this.name);t.setAttribute("aria-label",this.getEditableAriaLabel(),r)})}getEditableAriaLabel(){const e=this.locale.t,t=this._options.label,r=this._editableElement,i=this.name;if(typeof t=="string")return t;if(typeof t=="object")return t[i];if(typeof t=="function")return t(this);if(r){const o=r.getAttribute("aria-label");if(o)return o}return e("Rich Text Editor. Editing area: %0",i)}},Model2=class extends ObservableMixin(){constructor(e,t){super(),t&&assignIn_default(this,t),e&&this.set(e)}},toPx$3=toUnit("px"),StickyPanelView=class extends View2{content;contentPanelElement;_contentPanelPlaceholder;constructor(e){super(e);const t=this.bindTemplate;this.set("isActive",!1),this.set("isSticky",!1),this.set("limiterElement",null),this.set("limiterBottomOffset",50),this.set("viewportTopOffset",0),this.set("_marginLeft",null),this.set("_isStickyToTheBottomOfLimiter",!1),this.set("_stickyTopOffset",null),this.set("_stickyBottomOffset",null),this.content=this.createCollection(),this._contentPanelPlaceholder=new Template({tag:"div",attributes:{class:["ck","ck-sticky-panel__placeholder"],style:{display:t.to("isSticky",r=>r?"block":"none"),height:t.to("isSticky",r=>r?toPx$3(this._contentPanelRect.height):null)}}}).render(),this.contentPanelElement=new Template({tag:"div",attributes:{class:["ck","ck-sticky-panel__content",t.if("isSticky","ck-sticky-panel__content_sticky"),t.if("_isStickyToTheBottomOfLimiter","ck-sticky-panel__content_sticky_bottom-limit")],style:{width:t.to("isSticky",r=>r?toPx$3(this._contentPanelPlaceholder.getBoundingClientRect().width):null),top:t.to("_stickyTopOffset",r=>r&&toPx$3(r)),bottom:t.to("_stickyBottomOffset",r=>r&&toPx$3(r)),marginLeft:t.to("_marginLeft")}},children:this.content}).render(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-sticky-panel"]},children:[this._contentPanelPlaceholder,this.contentPanelElement]})}render(){super.render(),this.checkIfShouldBeSticky(),this.listenTo(global2.document,"scroll",()=>{this.checkIfShouldBeSticky()},{useCapture:!0}),this.listenTo(this,"change:isActive",()=>{this.checkIfShouldBeSticky()})}checkIfShouldBeSticky(){if(!this.limiterElement||!this.isActive){this._unstick();return}const e=new Rect(this.limiterElement);let t=e.getVisible();if(t){const r=new Rect(global2.window);r.top+=this.viewportTopOffset,r.height-=this.viewportTopOffset,t=t.getIntersection(r)}if(t&&e.top<t.top){const r=t.top;if(r+this._contentPanelRect.height+this.limiterBottomOffset>t.bottom){const i=Math.max(e.bottom-t.bottom,0)+this.limiterBottomOffset;e.bottom-i>e.top+this._contentPanelRect.height?this._stickToBottomOfLimiter(i):this._unstick()}else this._contentPanelRect.height+this.limiterBottomOffset<e.height?this._stickToTopOfAncestors(r):this._unstick()}else this._unstick()}_stickToTopOfAncestors(e){this.isSticky=!0,this._isStickyToTheBottomOfLimiter=!1,this._stickyTopOffset=e,this._stickyBottomOffset=null,this._marginLeft=toPx$3(-global2.window.scrollX)}_stickToBottomOfLimiter(e){this.isSticky=!0,this._isStickyToTheBottomOfLimiter=!0,this._stickyTopOffset=null,this._stickyBottomOffset=e,this._marginLeft=toPx$3(-global2.window.scrollX)}_unstick(){this.isSticky=!1,this._isStickyToTheBottomOfLimiter=!1,this._stickyTopOffset=null,this._stickyBottomOffset=null,this._marginLeft=null}get _contentPanelRect(){return new Rect(this.contentPanelElement)}},MenuBarMenuButtonView=class extends ListItemButtonView{arrowView;constructor(e){super(e);const t=this.bindTemplate;this.set({withText:!0,role:"menuitem"}),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__button"],"aria-haspopup":!0,"aria-expanded":this.bindTemplate.to("isOn",r=>String(r)),"data-cke-tooltip-disabled":t.to("isOn")},on:{mouseenter:t.to("mouseenter")}})}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new IconView;return e.content=dropdownArrowIcon,e.extendTemplate({attributes:{class:"ck-menu-bar__menu__button__arrow"}}),e}},MenuBarMenuPanelView=class extends View2{children;constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-menu-bar__menu__panel",t.to("position",r=>`ck-menu-bar__menu__panel_position_${r}`),t.if("isVisible","ck-hidden",r=>!r)],tabindex:"-1"},children:this.children,on:{selectstart:t.to(r=>{r.target.tagName.toLocaleLowerCase()!=="input"&&r.preventDefault()})}})}focus(e=1){this.children.length&&(e===1?this.children.first.focus():this.children.last.focus())}},MenuBarMenuView=class Es extends View2{buttonView;panelView;focusTracker;keystrokes;constructor(t){super(t);const r=this.bindTemplate;this.buttonView=new MenuBarMenuButtonView(t),this.buttonView.delegate("mouseenter").to(this),this.buttonView.bind("isOn","isEnabled").to(this,"isOpen","isEnabled"),this.panelView=new MenuBarMenuPanelView(t),this.panelView.bind("isVisible").to(this,"isOpen"),this.keystrokes=new KeystrokeHandler,this.focusTracker=new FocusTracker,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("panelPosition","w"),this.set("class",void 0),this.set("parentMenuView",null),this.setTemplate({tag:"div",attributes:{class:["ck","ck-menu-bar__menu",r.to("class"),r.if("isEnabled","ck-disabled",i=>!i),r.if("parentMenuView","ck-menu-bar__menu_top-level",i=>!i)]},children:[this.buttonView,this.panelView]})}render(){super.render(),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.keystrokes.listenTo(this.element),MenuBarMenuBehaviors.closeOnEscKey(this),this._repositionPanelOnOpen()}_attachBehaviors(){this.parentMenuView?(MenuBarMenuBehaviors.openOnButtonClick(this),MenuBarMenuBehaviors.openOnArrowRightKey(this),MenuBarMenuBehaviors.closeOnArrowLeftKey(this),MenuBarMenuBehaviors.openAndFocusOnEnterKeyPress(this),MenuBarMenuBehaviors.closeOnParentClose(this)):(this._propagateArrowKeystrokeEvents(),MenuBarMenuBehaviors.openAndFocusPanelOnArrowDownKey(this),MenuBarMenuBehaviors.toggleOnButtonClick(this))}_propagateArrowKeystrokeEvents(){this.keystrokes.set("arrowright",(t,r)=>{this.fire("arrowright"),r()}),this.keystrokes.set("arrowleft",(t,r)=>{this.fire("arrowleft"),r()})}_repositionPanelOnOpen(){this.on("change:isOpen",(t,r,i)=>{if(!i)return;const o=Es._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions});this.panelView.position=o?o.name:this._defaultMenuPositionName})}focus(){this.buttonView.focus()}get _panelPositions(){const{southEast:t,southWest:r,northEast:i,northWest:o,westSouth:a,eastSouth:c,westNorth:u,eastNorth:h}=MenuBarMenuViewPanelPositioningFunctions;return this.locale.uiLanguageDirection==="ltr"?this.parentMenuView?[c,h,a,u]:[t,r,i,o]:this.parentMenuView?[a,u,c,h]:[r,t,o,i]}get _defaultMenuPositionName(){return this.locale.uiLanguageDirection==="ltr"?this.parentMenuView?"es":"se":this.parentMenuView?"ws":"sw"}static _getOptimalPosition=getOptimalPosition},MenuBarMenuListView=class extends ListView{constructor(e){super(e),this.role="menu",this.items.on("change",this._setItemsCheckSpace.bind(this))}_setItemsCheckSpace(){const e=Array.from(this.items).some(t=>{const r=pickListButtonMenuViewIfPresent(t);return r&&r.isToggleable});this.items.forEach(t=>{const r=pickListButtonMenuViewIfPresent(t);r&&(r.hasCheckSpace=e)})}};function pickListButtonMenuViewIfPresent(e){return e instanceof ListItemView?e.children.map(t=>isNestedMenuLikeView(t)?t.buttonView:t).find(t=>t instanceof ListItemButtonView):null}function isNestedMenuLikeView(e){return typeof e=="object"&&"buttonView"in e&&e.buttonView instanceof ButtonView}var MenuBarMenuListItemFileDialogButtonView=class extends FileDialogListItemButtonView{constructor(e){super(e),this.set({withText:!0,withKeystroke:!0,tooltip:!1,role:"menuitem"}),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item__button"]}})}},EVENT_NAME_DELEGATES=["mouseenter","arrowleft","arrowright","change:isOpen"],MenuBarView=class extends View2{children;menus=[];constructor(e){super(e);const t=e.t,r=this.bindTemplate;this.set({isOpen:!1,isFocusBorderEnabled:!1}),this._setupIsOpenUpdater(),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-menu-bar",r.if("isFocusBorderEnabled","ck-menu-bar_focus-border-enabled")],"aria-label":t("Editor menu bar"),role:"menubar"},children:this.children})}fillFromConfig(e,t,r=[]){const i=this.locale,a=processMenuBarConfig({normalizedConfig:e,locale:i,componentFactory:t,extraItems:r}).items.map(c=>this._createMenu({componentFactory:t,menuDefinition:c}));this.children.addMany(a)}render(){super.render(),MenuBarBehaviors.toggleMenusAndFocusItemsOnHover(this),MenuBarBehaviors.closeMenusWhenTheBarCloses(this),MenuBarBehaviors.closeMenuWhenAnotherOnTheSameLevelOpens(this),MenuBarBehaviors.focusCycleMenusOnArrows(this),MenuBarBehaviors.closeOnClickOutside(this),MenuBarBehaviors.enableFocusHighlightOnInteraction(this)}focus(){this.children.first&&this.children.first.focus()}close(){for(const e of this.children)e.isOpen=!1}registerMenu(e,t=null){t?(e.delegate(...EVENT_NAME_DELEGATES).to(t),e.parentMenuView=t):e.delegate(...EVENT_NAME_DELEGATES).to(this,r=>"menu:"+r),e._attachBehaviors(),this.menus.push(e)}_createMenu({componentFactory:e,menuDefinition:t,parentMenuView:r}){const i=this.locale,o=new MenuBarMenuView(i);return this.registerMenu(o,r),o.buttonView.set({label:t.label}),o.once("change:isOpen",()=>{const a=new MenuBarMenuListView(i);a.ariaLabel=t.label,o.panelView.children.add(a),a.items.addMany(this._createMenuItems({menuDefinition:t,parentMenuView:o,componentFactory:e}))}),o}_createMenuItems({menuDefinition:e,parentMenuView:t,componentFactory:r}){const i=this.locale,o=[];for(const a of e.groups){for(const c of a.items){const u=new MenuBarMenuListItemView(i,t);if(isObject_default(c))u.children.add(this._createMenu({componentFactory:r,menuDefinition:c,parentMenuView:t}));else{const h=this._createMenuItemContentFromFactory({componentName:c,componentFactory:r,parentMenuView:t});if(!h)continue;u.children.add(h)}o.push(u)}a!==e.groups[e.groups.length-1]&&o.push(new ListSeparatorView(i))}return o}_createMenuItemContentFromFactory({componentName:e,parentMenuView:t,componentFactory:r}){const i=r.create(e);return i instanceof MenuBarMenuView||i instanceof MenuBarMenuListItemButtonView||i instanceof MenuBarMenuListItemFileDialogButtonView?(this._registerMenuTree(i,t),i.on("execute",()=>{this.close()}),i):(logWarning("menu-bar-component-unsupported",{componentName:e,componentView:i}),null)}_registerMenuTree(e,t){if(!(e instanceof MenuBarMenuView)){e.delegate("mouseenter").to(t);return}this.registerMenu(e,t);const r=e.panelView.children.filter(o=>o instanceof MenuBarMenuListView)[0];if(!r){e.delegate("mouseenter").to(t);return}const i=r.items.filter(o=>o instanceof ListItemView);for(const o of i)this._registerMenuTree(o.children.get(0),e)}_setupIsOpenUpdater(){let e;this.on("menu:change:isOpen",(t,r,i)=>{clearTimeout(e),i?this.isOpen=!0:e=setTimeout(()=>{this.isOpen=Array.from(this.children).some(o=>o.isOpen)},0)})}},ChangeBuffer=class{model;limit;_isLocked;_size;_batch=null;_changeCallback;_selectionChangeCallback;constructor(e,t=20){this.model=e,this._size=0,this.limit=t,this._isLocked=!1,this._changeCallback=(r,i)=>{i.isLocal&&i.isUndoable&&i!==this._batch&&this._reset(!0)},this._selectionChangeCallback=()=>{this._reset()},this.model.document.on("change",this._changeCallback),this.model.document.selection.on("change:range",this._selectionChangeCallback),this.model.document.selection.on("change:attribute",this._selectionChangeCallback)}get batch(){return this._batch||(this._batch=this.model.createBatch({isTyping:!0})),this._batch}get size(){return this._size}input(e){this._size+=e,this._size>=this.limit&&this._reset(!0)}get isLocked(){return this._isLocked}lock(){this._isLocked=!0}unlock(){this._isLocked=!1}destroy(){this.model.document.off("change",this._changeCallback),this.model.document.selection.off("change:range",this._selectionChangeCallback),this.model.document.selection.off("change:attribute",this._selectionChangeCallback)}_reset(e=!1){(!this.isLocked||e)&&(this._batch=null,this._size=0)}},InsertTextCommand=class extends Command{_buffer;constructor(e,t){super(e),this._buffer=new ChangeBuffer(e.model,t),this._isEnabledBasedOnSelection=!1}get buffer(){return this._buffer}destroy(){super.destroy(),this._buffer.destroy()}execute(e={}){const t=this.editor.model,r=t.document,i=e.text||"",o=i.length;let a=r.selection;if(e.selection?a=e.selection:e.range&&(a=t.createSelection(e.range)),!t.canEditAt(a))return;const c=e.resultRange;t.enqueueChange(this._buffer.batch,u=>{this._buffer.lock();const h=Array.from(r.selection.getAttributes());t.deleteContent(a),i&&t.insertContent(u.createText(i,h),a),c?u.setSelection(c):a.is("documentSelection")||u.setSelection(a),this._buffer.unlock(),this._buffer.input(o)})}},TYPING_INPUT_TYPES=["insertText","insertReplacementText"],TYPING_INPUT_TYPES_ANDROID=[...TYPING_INPUT_TYPES,"insertCompositionText"],InsertTextObserver=class extends Observer{focusObserver;constructor(e){super(e),this.focusObserver=e.getObserver(FocusObserver);const t=env.isAndroid?TYPING_INPUT_TYPES_ANDROID:TYPING_INPUT_TYPES,r=e.document;r.on("beforeinput",(i,o)=>{if(!this.isEnabled)return;const{data:a,targetRanges:c,inputType:u,domEvent:h}=o;if(!t.includes(u))return;this.focusObserver.flush();const d=new EventInfo(r,"insertText");r.fire(d,new DomEventData(e,h,{text:a,selection:e.createSelection(c)})),d.stop.called&&i.stop()}),env.isAndroid||r.on("compositionend",(i,{data:o,domEvent:a})=>{this.isEnabled&&o&&r.fire("insertText",new DomEventData(e,a,{text:o}))},{priority:"lowest"})}observe(){}stopObserving(){}},Input=class extends Plugin{_compositionQueue;static get pluginName(){return"Input"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.model,r=e.editing.view,i=e.editing.mapper,o=t.document.selection;this._compositionQueue=new CompositionQueue(e),r.addObserver(InsertTextObserver);const a=new InsertTextCommand(e,e.config.get("typing.undoStep")||20);e.commands.add("insertText",a),e.commands.add("input",a),this.listenTo(r.document,"insertText",(c,u)=>{r.document.isComposing||u.preventDefault(),env.isAndroid&&r.document.isComposing&&this._compositionQueue.flush("next beforeinput");const{text:h,selection:d}=u;let f;d?f=Array.from(d.getRanges()).map(v=>i.toModelRange(v)):f=Array.from(o.getRanges());let m=h;if(env.isAndroid){const v=Array.from(f[0].getItems()).reduce((_,b)=>_+(b.is("$textProxy")?b.data:""),"");if(v&&(v.length<=m.length?m.startsWith(v)&&(m=m.substring(v.length),f[0].start=f[0].start.getShiftedBy(v.length)):v.startsWith(m)&&(f[0].start=f[0].start.getShiftedBy(m.length),m="")),m.length==0&&f[0].isCollapsed)return}const g={text:m,selection:t.createSelection(f)};env.isAndroid&&r.document.isComposing?this._compositionQueue.push(g):(e.execute("insertText",g),r.scrollToTheSelection())}),env.isAndroid?this.listenTo(r.document,"keydown",(c,u)=>{o.isCollapsed||u.keyCode!=229||!r.document.isComposing||deleteSelectionContent(t,a)}):this.listenTo(r.document,"compositionstart",()=>{o.isCollapsed||deleteSelectionContent(t,a)}),env.isAndroid?(this.listenTo(r.document,"mutations",(c,{mutations:u})=>{if(r.document.isComposing)for(const{node:h}of u){const d=findMappedViewAncestor(h,i),f=i.toModelElement(d);if(this._compositionQueue.isComposedElement(f)){this._compositionQueue.flush("mutations");return}}}),this.listenTo(r.document,"compositionend",()=>{this._compositionQueue.flush("composition end")}),this.listenTo(r.document,"compositionend",()=>{const c=[];for(const u of this._compositionQueue.flushComposedElements()){const h=i.toViewElement(u);h&&c.push({type:"children",node:h})}c.length&&r.document.fire("mutations",{mutations:c})},{priority:"lowest"})):this.listenTo(r.document,"compositionend",()=>{r.document.fire("mutations",{mutations:[]})},{priority:"lowest"})}destroy(){super.destroy(),this._compositionQueue.destroy()}},CompositionQueue=class{editor;flushDebounced=debounce_default(()=>this.flush("timeout"),50);_queue=[];_compositionElements=new Set;constructor(e){this.editor=e}destroy(){for(this.flushDebounced.cancel(),this._compositionElements.clear();this._queue.length;)this.shift()}get length(){return this._queue.length}push(e){const t={text:e.text};if(e.selection){t.selectionRanges=[];for(const r of e.selection.getRanges())t.selectionRanges.push(LiveRange.fromRange(r)),this._compositionElements.add(r.start.parent)}this._queue.push(t),this.flushDebounced()}shift(){const e=this._queue.shift(),t={text:e.text};if(e.selectionRanges){const r=e.selectionRanges.map(i=>detachLiveRange(i)).filter(i=>!!i);r.length&&(t.selection=this.editor.model.createSelection(r))}return t}flush(e){const t=this.editor,r=t.model,i=t.editing.view;if(this.flushDebounced.cancel(),!this._queue.length)return;const a=t.commands.get("insertText").buffer;r.enqueueChange(a.batch,()=>{for(a.lock();this._queue.length;){const c=this.shift();t.execute("insertText",c)}a.unlock()}),i.scrollToTheSelection()}isComposedElement(e){return this._compositionElements.has(e)}flushComposedElements(){const e=Array.from(this._compositionElements);return this._compositionElements.clear(),e}};function deleteSelectionContent(e,t){if(!t.isEnabled)return;const r=t.buffer;r.lock(),e.enqueueChange(r.batch,()=>{e.deleteContent(e.document.selection)}),r.unlock()}function detachLiveRange(e){const t=e.toRange();return e.detach(),t.root.rootName=="$graveyard"?null:t}function findMappedViewAncestor(e,t){let r=e.is("$text")?e.parent:e;for(;!t.toModelElement(r);)r=r.parent;return r}var DeleteCommand=class extends Command{direction;_buffer;constructor(e,t){super(e),this.direction=t,this._buffer=new ChangeBuffer(e.model,e.config.get("typing.undoStep")),this._isEnabledBasedOnSelection=!1}get buffer(){return this._buffer}execute(e={}){const t=this.editor.model,r=t.document;t.enqueueChange(this._buffer.batch,i=>{this._buffer.lock();const o=i.createSelection(e.selection||r.selection);if(!t.canEditAt(o))return;const a=e.sequence||1,c=o.isCollapsed;if(o.isCollapsed&&t.modifySelection(o,{direction:this.direction,unit:e.unit,treatEmojiAsSingleUnit:!0}),this._shouldEntireContentBeReplacedWithParagraph(a)){this._replaceEntireContentWithParagraph(i);return}if(this._shouldReplaceFirstBlockWithParagraph(o,a)){this.editor.execute("paragraph",{selection:o});return}if(o.isCollapsed)return;let u=0;o.getFirstRange().getMinimalFlatRanges().forEach(h=>{u+=count(h.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))}),t.deleteContent(o,{doNotResetEntireContent:c,direction:this.direction}),this._buffer.input(u),i.setSelection(o),this._buffer.unlock()})}_shouldEntireContentBeReplacedWithParagraph(e){if(e>1)return!1;const t=this.editor.model,i=t.document.selection,o=t.schema.getLimitElement(i);if(!(i.isCollapsed&&i.containsEntireContent(o))||!t.schema.checkChild(o,"paragraph"))return!1;const c=o.getChild(0);return!(c&&c.is("element","paragraph"))}_replaceEntireContentWithParagraph(e){const t=this.editor.model,i=t.document.selection,o=t.schema.getLimitElement(i),a=e.createElement("paragraph");e.remove(e.createRangeIn(o)),e.insert(a,o),e.setSelection(a,0)}_shouldReplaceFirstBlockWithParagraph(e,t){const r=this.editor.model;if(t>1||this.direction!="backward"||!e.isCollapsed)return!1;const i=e.getFirstPosition(),o=r.schema.getLimitElement(i),a=o.getChild(0);return!(i.parent!=a||!e.containsEntireContent(a)||!r.schema.checkChild(o,"paragraph")||a.name=="paragraph")}},DELETE_CHARACTER="character",DELETE_WORD="word",DELETE_CODE_POINT="codePoint",DELETE_SELECTION="selection",DELETE_BACKWARD="backward",DELETE_FORWARD="forward",DELETE_EVENT_TYPES={deleteContent:{unit:DELETE_SELECTION,direction:DELETE_BACKWARD},deleteContentBackward:{unit:DELETE_CODE_POINT,direction:DELETE_BACKWARD},deleteWordBackward:{unit:DELETE_WORD,direction:DELETE_BACKWARD},deleteHardLineBackward:{unit:DELETE_SELECTION,direction:DELETE_BACKWARD},deleteSoftLineBackward:{unit:DELETE_SELECTION,direction:DELETE_BACKWARD},deleteContentForward:{unit:DELETE_CHARACTER,direction:DELETE_FORWARD},deleteWordForward:{unit:DELETE_WORD,direction:DELETE_FORWARD},deleteHardLineForward:{unit:DELETE_SELECTION,direction:DELETE_FORWARD},deleteSoftLineForward:{unit:DELETE_SELECTION,direction:DELETE_FORWARD}},DeleteObserver=class extends Observer{constructor(e){super(e);const t=e.document;let r=0;t.on("keydown",()=>{r++}),t.on("keyup",()=>{r=0}),t.on("beforeinput",(i,o)=>{if(!this.isEnabled)return;const{targetRanges:a,domEvent:c,inputType:u}=o,h=DELETE_EVENT_TYPES[u];if(!h)return;const d={direction:h.direction,unit:h.unit,sequence:r};d.unit==DELETE_SELECTION&&(d.selectionToRemove=e.createSelection(a[0])),u==="deleteContentBackward"&&(env.isAndroid&&(d.sequence=1),shouldUseTargetRanges(a)&&(d.unit=DELETE_SELECTION,d.selectionToRemove=e.createSelection(a)));const f=new BubblingEventInfo(t,"delete",a[0]);t.fire(f,new DomEventData(e,c,d)),f.stop.called&&i.stop()}),env.isBlink&&enableChromeWorkaround(this)}observe(){}stopObserving(){}};function enableChromeWorkaround(e){const t=e.view,r=t.document;let i=null,o=!1;r.on("keydown",(u,{keyCode:h})=>{i=h,o=!1}),r.on("keyup",(u,{keyCode:h,domEvent:d})=>{const f=r.selection,m=e.isEnabled&&h==i&&a(h)&&!f.isCollapsed&&!o;if(i=null,m){const g=f.getFirstRange(),v=new BubblingEventInfo(r,"delete",g),_={unit:DELETE_SELECTION,direction:c(h),selectionToRemove:f};r.fire(v,new DomEventData(t,d,_))}}),r.on("beforeinput",(u,{inputType:h})=>{const d=DELETE_EVENT_TYPES[h];a(i)&&d&&d.direction==c(i)&&(o=!0)},{priority:"high"}),r.on("beforeinput",(u,{inputType:h,data:d})=>{i==keyCodes.delete&&h=="insertText"&&d=="\x7F"&&u.stop()},{priority:"high"});function a(u){return u==keyCodes.backspace||u==keyCodes.delete}function c(u){return u==keyCodes.backspace?DELETE_BACKWARD:DELETE_FORWARD}}function shouldUseTargetRanges(e){if(e.length!=1||e[0].isCollapsed)return!1;const t=e[0].getWalker({direction:"backward",singleCharacters:!0,ignoreElementEnd:!0});let r=0;for(const{nextPosition:i,item:o}of t){if(i.parent.is("$text")){const a=i.parent.data,c=i.offset;if(isInsideSurrogatePair(a,c)||isInsideCombinedSymbol(a,c)||isInsideEmojiSequence(a,c))continue;r++}else(o.is("containerElement")||o.is("emptyElement"))&&r++;if(r>1)return!0}return!1}var Delete=class extends Plugin{_undoOnBackspace;static get pluginName(){return"Delete"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.editing.view,r=t.document,i=e.model.document;t.addObserver(DeleteObserver),this._undoOnBackspace=!1;const o=new DeleteCommand(e,"forward");e.commands.add("deleteForward",o),e.commands.add("forwardDelete",o),e.commands.add("delete",new DeleteCommand(e,"backward")),this.listenTo(r,"delete",(a,c)=>{r.isComposing||c.preventDefault();const{direction:u,sequence:h,selectionToRemove:d,unit:f}=c,m=u==="forward"?"deleteForward":"delete",g={sequence:h};if(f=="selection"){const v=Array.from(d.getRanges()).map(_=>e.editing.mapper.toModelRange(_));g.selection=e.model.createSelection(v)}else g.unit=f;e.execute(m,g),t.scrollToTheSelection()},{priority:"low"}),this.editor.plugins.has("UndoEditing")&&(this.listenTo(r,"delete",(a,c)=>{this._undoOnBackspace&&c.direction=="backward"&&c.sequence==1&&c.unit=="codePoint"&&(this._undoOnBackspace=!1,e.execute("undo"),c.preventDefault(),a.stop())},{context:"$capture"}),this.listenTo(i,"change",()=>{this._undoOnBackspace=!1}))}requestUndoOnBackspace(){this.editor.plugins.has("UndoEditing")&&(this._undoOnBackspace=!0)}},Typing=class extends Plugin{static get requires(){return[Input,Delete]}static get pluginName(){return"Typing"}static get isOfficialPlugin(){return!0}},TRANSFORMATIONS={copyright:{from:"(c)",to:"\xA9"},registeredTrademark:{from:"(r)",to:"\xAE"},trademark:{from:"(tm)",to:"\u2122"},oneHalf:{from:/(^|[^/a-z0-9])(1\/2)([^/a-z0-9])$/i,to:[null,"\xBD",null]},oneThird:{from:/(^|[^/a-z0-9])(1\/3)([^/a-z0-9])$/i,to:[null,"\u2153",null]},twoThirds:{from:/(^|[^/a-z0-9])(2\/3)([^/a-z0-9])$/i,to:[null,"\u2154",null]},oneForth:{from:/(^|[^/a-z0-9])(1\/4)([^/a-z0-9])$/i,to:[null,"\xBC",null]},threeQuarters:{from:/(^|[^/a-z0-9])(3\/4)([^/a-z0-9])$/i,to:[null,"\xBE",null]},lessThanOrEqual:{from:"<=",to:"\u2264"},greaterThanOrEqual:{from:">=",to:"\u2265"},notEqual:{from:"!=",to:"\u2260"},arrowLeft:{from:"<-",to:"\u2190"},arrowRight:{from:"->",to:"\u2192"},horizontalEllipsis:{from:"...",to:"\u2026"},enDash:{from:/(^| )(--)( )$/,to:[null,"\u2013",null]},emDash:{from:/(^| )(---)( )$/,to:[null,"\u2014",null]},quotesPrimary:{from:buildQuotesRegExp('"'),to:[null,"\u201C",null,"\u201D"]},quotesSecondary:{from:buildQuotesRegExp("'"),to:[null,"\u2018",null,"\u2019"]},quotesPrimaryEnGb:{from:buildQuotesRegExp("'"),to:[null,"\u2018",null,"\u2019"]},quotesSecondaryEnGb:{from:buildQuotesRegExp('"'),to:[null,"\u201C",null,"\u201D"]},quotesPrimaryPl:{from:buildQuotesRegExp('"'),to:[null,"\u201E",null,"\u201D"]},quotesSecondaryPl:{from:buildQuotesRegExp("'"),to:[null,"\u201A",null,"\u2019"]}};function buildQuotesRegExp(e){return new RegExp(`(^|\\s)(${e})([^${e}]*)(${e})$`)}var AttributeCommand=class extends Command{attributeKey;constructor(e,t){super(e),this.attributeKey=t}refresh(){const e=this.editor.model,t=e.document;this.value=this._getValueFromFirstAllowedNode(),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,this.attributeKey)}execute(e={}){const t=this.editor.model,i=t.document.selection,o=e.forceValue===void 0?!this.value:e.forceValue;t.change(a=>{if(i.isCollapsed)o?a.setSelectionAttribute(this.attributeKey,!0):a.removeSelectionAttribute(this.attributeKey);else{const c=t.schema.getValidRanges(i.getRanges(),this.attributeKey);for(const u of c)o?a.setAttribute(this.attributeKey,o,u):a.removeAttribute(this.attributeKey,u)}})}_getValueFromFirstAllowedNode(){const e=this.editor.model,t=e.schema,r=e.document.selection;if(r.isCollapsed)return r.hasAttribute(this.attributeKey);for(const i of r.getRanges())for(const o of i.getItems())if(t.checkAttribute(o,this.attributeKey))return o.hasAttribute(this.attributeKey);return!1}},BOLD$1="bold",BoldEditing=class extends Plugin{static get pluginName(){return"BoldEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=this.editor.t;e.model.schema.extend("$text",{allowAttributes:BOLD$1}),e.model.schema.setAttributeProperties(BOLD$1,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:BOLD$1,view:"strong",upcastAlso:["b",r=>{const i=r.getStyle("font-weight");return i&&(i=="bold"||Number(i)>=600)?{name:!0,styles:["font-weight"]}:null}]}),e.commands.add(BOLD$1,new AttributeCommand(e,BOLD$1)),e.keystrokes.set("CTRL+B",BOLD$1),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Bold text"),keystroke:"CTRL+B"}]})}};function getButtonCreator({editor:e,commandName:t,plugin:r,icon:i,label:o,keystroke:a}){return c=>{const u=e.commands.get(t),h=new c(e.locale);return h.set({label:o,icon:i,keystroke:a,isToggleable:!0}),h.bind("isEnabled").to(u,"isEnabled"),h.bind("isOn").to(u,"value"),h instanceof MenuBarMenuListItemButtonView?h.set({role:"menuitemcheckbox"}):h.set({tooltip:!0}),r.listenTo(h,"execute",()=>{e.execute(t),e.editing.view.focus()}),h}}var BOLD="bold",BoldUI=class extends Plugin{static get pluginName(){return"BoldUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.locale.t,r=getButtonCreator({editor:e,commandName:BOLD,plugin:this,icon:icons.bold,label:t("Bold"),keystroke:"CTRL+B"});e.ui.componentFactory.add(BOLD,()=>r(ButtonView)),e.ui.componentFactory.add("menuBar:"+BOLD,()=>r(MenuBarMenuListItemButtonView))}},Bold=class extends Plugin{static get requires(){return[BoldEditing,BoldUI]}static get pluginName(){return"Bold"}static get isOfficialPlugin(){return!0}},ITALIC$1="italic",ItalicEditing=class extends Plugin{static get pluginName(){return"ItalicEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=this.editor.t;e.model.schema.extend("$text",{allowAttributes:ITALIC$1}),e.model.schema.setAttributeProperties(ITALIC$1,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:ITALIC$1,view:"i",upcastAlso:["em",{styles:{"font-style":"italic"}}]}),e.commands.add(ITALIC$1,new AttributeCommand(e,ITALIC$1)),e.keystrokes.set("CTRL+I",ITALIC$1),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Italic text"),keystroke:"CTRL+I"}]})}},italicIcon='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.586 14.633.021.004c-.036.335.095.655.393.962.082.083.173.15.274.201h1.474a.6.6 0 1 1 0 1.2H5.304a.6.6 0 0 1 0-1.2h1.15c.474-.07.809-.182 1.005-.334.157-.122.291-.32.404-.597l2.416-9.55a1.053 1.053 0 0 0-.281-.823 1.12 1.12 0 0 0-.442-.296H8.15a.6.6 0 0 1 0-1.2h6.443a.6.6 0 1 1 0 1.2h-1.195c-.376.056-.65.155-.823.296-.215.175-.423.439-.623.79l-2.366 9.347z"/></svg>',ITALIC="italic",ItalicUI=class extends Plugin{static get pluginName(){return"ItalicUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.locale.t,r=getButtonCreator({editor:e,commandName:ITALIC,plugin:this,icon:italicIcon,keystroke:"CTRL+I",label:t("Italic")});e.ui.componentFactory.add(ITALIC,()=>r(ButtonView)),e.ui.componentFactory.add("menuBar:"+ITALIC,()=>r(MenuBarMenuListItemButtonView))}},Italic=class extends Plugin{static get requires(){return[ItalicEditing,ItalicUI]}static get pluginName(){return"Italic"}static get isOfficialPlugin(){return!0}};function*getCopyOnEnterAttributes(e,t){for(const r of t)r&&e.getAttributeProperties(r[0]).copyOnEnter&&(yield r)}var EnterCommand=class extends Command{execute(){this.editor.model.change(e=>{this.enterBlock(e),this.fire("afterExecute",{writer:e})})}enterBlock(e){const t=this.editor.model,r=t.document.selection,i=t.schema,o=r.isCollapsed,a=r.getFirstRange(),c=a.start.parent,u=a.end.parent;if(i.isLimit(c)||i.isLimit(u))return!o&&c==u&&t.deleteContent(r),!1;if(o){const h=getCopyOnEnterAttributes(e.model.schema,r.getAttributes());return splitBlock(e,a.start),e.setSelectionAttribute(h),!0}else{const h=!(a.start.isAtStart&&a.end.isAtEnd),d=c==u;if(t.deleteContent(r,{leaveUnmerged:h}),h){if(d)return splitBlock(e,r.focus),!0;e.setSelection(u,0)}}return!1}};function splitBlock(e,t){e.split(t),e.setSelection(t.parent.nextSibling,0)}var ENTER_EVENT_TYPES={insertParagraph:{isSoft:!1},insertLineBreak:{isSoft:!0}},EnterObserver=class extends Observer{constructor(e){super(e);const t=this.document;let r=!1;t.on("keydown",(i,o)=>{r=o.shiftKey}),t.on("beforeinput",(i,o)=>{if(!this.isEnabled)return;let a=o.inputType;env.isSafari&&r&&a=="insertParagraph"&&(a="insertLineBreak");const c=o.domEvent,u=ENTER_EVENT_TYPES[a];if(!u)return;const h=new BubblingEventInfo(t,"enter",o.targetRanges[0]);t.fire(h,new DomEventData(e,c,{isSoft:u.isSoft})),h.stop.called&&i.stop()})}observe(){}stopObserving(){}},Enter=class extends Plugin{static get pluginName(){return"Enter"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.editing.view,r=t.document,i=this.editor.t;t.addObserver(EnterObserver),e.commands.add("enter",new EnterCommand(e)),this.listenTo(r,"enter",(o,a)=>{r.isComposing||a.preventDefault(),!a.isSoft&&(e.execute("enter"),t.scrollToTheSelection())},{priority:"low"}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:i("Insert a hard break (a new paragraph)"),keystroke:"Enter"}]})}},ShiftEnterCommand=class extends Command{execute(){const e=this.editor.model,t=e.document;e.change(r=>{softBreakAction(e,r,t.selection),this.fire("afterExecute",{writer:r})})}refresh(){const e=this.editor.model,t=e.document;this.isEnabled=isEnabled(e.schema,t.selection)}};function isEnabled(e,t){if(t.rangeCount>1)return!1;const r=t.anchor;if(!r||!e.checkChild(r,"softBreak"))return!1;const i=t.getFirstRange(),o=i.start.parent,a=i.end.parent;return!((isInsideLimitElement(o,e)||isInsideLimitElement(a,e))&&o!==a)}function softBreakAction(e,t,r){const i=r.isCollapsed,o=r.getFirstRange(),a=o.start.parent,c=o.end.parent,u=a==c;if(i){const h=getCopyOnEnterAttributes(e.schema,r.getAttributes());insertBreak(e,t,o.end),t.removeSelectionAttribute(r.getAttributeKeys()),t.setSelectionAttribute(h)}else{const h=!(o.start.isAtStart&&o.end.isAtEnd);e.deleteContent(r,{leaveUnmerged:h}),u?insertBreak(e,t,r.focus):h&&t.setSelection(c,0)}}function insertBreak(e,t,r){const i=t.createElement("softBreak");e.insertContent(i,r),t.setSelection(i,"after")}function isInsideLimitElement(e,t){return e.is("rootElement")?!1:t.isLimit(e)||isInsideLimitElement(e.parent,t)}var ShiftEnter=class extends Plugin{static get pluginName(){return"ShiftEnter"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.model.schema,r=e.conversion,i=e.editing.view,o=i.document,a=this.editor.t;t.register("softBreak",{allowWhere:"$text",isInline:!0}),r.for("upcast").elementToElement({model:"softBreak",view:"br"}),r.for("downcast").elementToElement({model:"softBreak",view:(c,{writer:u})=>u.createEmptyElement("br")}),i.addObserver(EnterObserver),e.commands.add("shiftEnter",new ShiftEnterCommand(e)),this.listenTo(o,"enter",(c,u)=>{o.isComposing||u.preventDefault(),u.isSoft&&(e.execute("shiftEnter"),i.scrollToTheSelection())},{priority:"low"}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:a("Insert a soft break (a <code>&lt;br&gt;</code> element)"),keystroke:"Shift+Enter"}]})}},WIDGET_SELECTED_CLASS_NAME="ck-widget_selected";function isWidget(e){return e.is("element")?!!e.getCustomProperty("widget"):!1}function getLabel(e){return e.getCustomProperty("widgetLabel").reduce((r,i)=>typeof i=="function"?r?r+". "+i():i():r?r+". "+i:i,"")}var TYPE_AROUND_SELECTION_ATTRIBUTE="widget-type-around";function isTypeAroundWidget(e,t,r){return!!e&&isWidget(e)&&!r.isInline(t)}function getClosestTypeAroundDomButton(e){return e.closest(".ck-widget__type-around__button")}function getTypeAroundButtonPosition(e){return e.classList.contains("ck-widget__type-around__button_before")?"before":"after"}function getClosestWidgetViewElement(e,t){const r=e.closest(".ck-widget");return t.mapDomToView(r)}function getTypeAroundFakeCaretPosition(e){return e.getAttribute(TYPE_AROUND_SELECTION_ATTRIBUTE)}var returnIcon='<svg viewBox="0 0 10 8" xmlns="http://www.w3.org/2000/svg"><path d="M9.055.263v3.972h-6.77M1 4.216l2-2.038m-2 2 2 2.038"/></svg>',POSSIBLE_INSERTION_POSITIONS=["before","after"],RETURN_ARROW_ICON_ELEMENT=new DOMParser().parseFromString(returnIcon,"image/svg+xml").firstChild,PLUGIN_DISABLED_EDITING_ROOT_CLASS="ck-widget__type-around_disabled",WidgetTypeAround=class extends Plugin{_currentFakeCaretModelElement=null;static get pluginName(){return"WidgetTypeAround"}static get isOfficialPlugin(){return!0}static get requires(){return[Enter,Delete]}init(){const e=this.editor,t=e.editing.view;this.on("change:isEnabled",(r,i,o)=>{t.change(a=>{for(const c of t.document.roots)o?a.removeClass(PLUGIN_DISABLED_EDITING_ROOT_CLASS,c):a.addClass(PLUGIN_DISABLED_EDITING_ROOT_CLASS,c)}),o||e.model.change(a=>{a.removeSelectionAttribute(TYPE_AROUND_SELECTION_ATTRIBUTE)})}),this._enableTypeAroundUIInjection(),this._enableInsertingParagraphsOnButtonClick(),this._enableInsertingParagraphsOnEnterKeypress(),this._enableInsertingParagraphsOnTypingKeystroke(),this._enableTypeAroundFakeCaretActivationUsingKeyboardArrows(),this._enableDeleteIntegration(),this._enableInsertContentIntegration(),this._enableInsertObjectIntegration(),this._enableDeleteContentIntegration()}destroy(){super.destroy(),this._currentFakeCaretModelElement=null}_insertParagraph(e,t){const r=this.editor,i=r.editing.view,o=r.model.schema.getAttributesWithProperty(e,"copyOnReplace",!0);r.execute("insertParagraph",{position:r.model.createPositionAt(e,t),attributes:o}),i.focus(),i.scrollToTheSelection()}_listenToIfEnabled(e,t,r,i){this.listenTo(e,t,(...o)=>{this.isEnabled&&r(...o)},i)}_insertParagraphAccordingToFakeCaretPosition(){const r=this.editor.model.document.selection,i=getTypeAroundFakeCaretPosition(r);if(!i)return!1;const o=r.getSelectedElement();return this._insertParagraph(o,i),!0}_enableTypeAroundUIInjection(){const e=this.editor,t=e.model.schema,r=e.locale.t,i={before:r("Insert paragraph before block"),after:r("Insert paragraph after block")};e.editing.downcastDispatcher.on("insert",(o,a,c)=>{const u=c.mapper.toViewElement(a.item);u&&isTypeAroundWidget(u,a.item,t)&&(injectUIIntoWidget(c.writer,i,u),u.getCustomProperty("widgetLabel").push(()=>this.isEnabled?r("Press Enter to type after or press Shift + Enter to type before the widget"):""))},{priority:"low"})}_enableTypeAroundFakeCaretActivationUsingKeyboardArrows(){const e=this.editor,t=e.model,r=t.document.selection,i=t.schema,o=e.editing.view;this._listenToIfEnabled(o.document,"arrowKey",(c,u)=>{this._handleArrowKeyPress(c,u)},{context:[isWidget,"$text"],priority:"high"}),this._listenToIfEnabled(r,"change:range",(c,u)=>{u.directChange&&e.model.change(h=>{h.removeSelectionAttribute(TYPE_AROUND_SELECTION_ATTRIBUTE)})}),this._listenToIfEnabled(t.document,"change:data",()=>{const c=r.getSelectedElement();if(c){const u=e.editing.mapper.toViewElement(c);if(isTypeAroundWidget(u,c,i))return}e.model.change(u=>{u.removeSelectionAttribute(TYPE_AROUND_SELECTION_ATTRIBUTE)})}),this._listenToIfEnabled(e.editing.downcastDispatcher,"selection",(c,u,h)=>{const d=h.writer;if(this._currentFakeCaretModelElement){const v=h.mapper.toViewElement(this._currentFakeCaretModelElement);v&&(d.removeClass(POSSIBLE_INSERTION_POSITIONS.map(a),v),this._currentFakeCaretModelElement=null)}const f=u.selection.getSelectedElement();if(!f)return;const m=h.mapper.toViewElement(f);if(!isTypeAroundWidget(m,f,i))return;const g=getTypeAroundFakeCaretPosition(u.selection);g&&(d.addClass(a(g),m),this._currentFakeCaretModelElement=f)}),this._listenToIfEnabled(e.ui.focusTracker,"change:isFocused",(c,u,h)=>{h||e.model.change(d=>{d.removeSelectionAttribute(TYPE_AROUND_SELECTION_ATTRIBUTE)})});function a(c){return`ck-widget_type-around_show-fake-caret_${c}`}}_handleArrowKeyPress(e,t){const r=this.editor,i=r.model,o=i.document.selection,a=i.schema,c=r.editing.view,u=t.keyCode,h=isForwardArrowKeyCode(u,r.locale.contentLanguageDirection),d=c.document.selection.getSelectedElement(),f=r.editing.mapper.toModelElement(d);let m;isTypeAroundWidget(d,f,a)?m=this._handleArrowKeyPressOnSelectedWidget(h):o.isCollapsed?m=this._handleArrowKeyPressWhenSelectionNextToAWidget(h):t.shiftKey||(m=this._handleArrowKeyPressWhenNonCollapsedSelection(h)),m&&(t.preventDefault(),e.stop())}_handleArrowKeyPressOnSelectedWidget(e){const r=this.editor.model,i=r.document.selection,o=getTypeAroundFakeCaretPosition(i);return r.change(a=>{if(o){if(!(o===(e?"after":"before")))return a.removeSelectionAttribute(TYPE_AROUND_SELECTION_ATTRIBUTE),!0}else return a.setSelectionAttribute(TYPE_AROUND_SELECTION_ATTRIBUTE,e?"after":"before"),!0;return!1})}_handleArrowKeyPressWhenSelectionNextToAWidget(e){const t=this.editor,r=t.model,i=r.schema,o=t.plugins.get("Widget"),a=o._getObjectElementNextToSelection(e),c=t.editing.mapper.toViewElement(a);return isTypeAroundWidget(c,a,i)?(r.change(u=>{o._setSelectionOverElement(a),u.setSelectionAttribute(TYPE_AROUND_SELECTION_ATTRIBUTE,e?"before":"after")}),!0):!1}_handleArrowKeyPressWhenNonCollapsedSelection(e){const t=this.editor,r=t.model,i=r.schema,o=t.editing.mapper,a=r.document.selection,c=e?a.getLastPosition().nodeBefore:a.getFirstPosition().nodeAfter,u=o.toViewElement(c);return isTypeAroundWidget(u,c,i)?(r.change(h=>{h.setSelection(c,"on"),h.setSelectionAttribute(TYPE_AROUND_SELECTION_ATTRIBUTE,e?"after":"before")}),!0):!1}_enableInsertingParagraphsOnButtonClick(){const e=this.editor,t=e.editing.view;this._listenToIfEnabled(t.document,"mousedown",(r,i)=>{const o=getClosestTypeAroundDomButton(i.domTarget);if(!o)return;const a=getTypeAroundButtonPosition(o),c=getClosestWidgetViewElement(o,t.domConverter),u=e.editing.mapper.toModelElement(c);this._insertParagraph(u,a),i.preventDefault(),r.stop()})}_enableInsertingParagraphsOnEnterKeypress(){const e=this.editor,t=e.model.document.selection,r=e.editing.view;this._listenToIfEnabled(r.document,"enter",(i,o)=>{if(i.eventPhase!="atTarget")return;const a=t.getSelectedElement(),c=e.editing.mapper.toViewElement(a),u=e.model.schema;let h;this._insertParagraphAccordingToFakeCaretPosition()?h=!0:isTypeAroundWidget(c,a,u)&&(this._insertParagraph(a,o.isSoft?"before":"after"),h=!0),h&&(o.preventDefault(),i.stop())},{context:isWidget})}_enableInsertingParagraphsOnTypingKeystroke(){const t=this.editor.editing.view.document;this._listenToIfEnabled(t,"insertText",(r,i)=>{this._insertParagraphAccordingToFakeCaretPosition()&&(i.selection=t.selection)},{priority:"high"}),env.isAndroid?this._listenToIfEnabled(t,"keydown",(r,i)=>{i.keyCode==229&&this._insertParagraphAccordingToFakeCaretPosition()}):this._listenToIfEnabled(t,"compositionstart",()=>{this._insertParagraphAccordingToFakeCaretPosition()},{priority:"high"})}_enableDeleteIntegration(){const e=this.editor,t=e.editing.view,r=e.model,i=r.schema;this._listenToIfEnabled(t.document,"delete",(o,a)=>{if(o.eventPhase!="atTarget")return;const c=getTypeAroundFakeCaretPosition(r.document.selection);if(!c)return;const u=a.direction,h=r.document.selection.getSelectedElement(),d=c==="before",f=u=="forward";if(d===f)e.execute("delete",{selection:r.createSelection(h,"on")});else{const g=i.getNearestSelectionRange(r.createPositionAt(h,c),u);if(g)if(!g.isCollapsed)r.change(v=>{v.setSelection(g),e.execute(f?"deleteForward":"delete")});else{const v=r.createSelection(g.start);if(r.modifySelection(v,{direction:u}),!v.focus.isEqual(g.start))r.change(_=>{_.setSelection(g),e.execute(f?"deleteForward":"delete")});else{const _=getDeepestEmptyElementAncestor(i,g.start.parent);r.deleteContent(r.createSelection(_,"on"),{doNotAutoparagraph:!0})}}}a.preventDefault(),o.stop()},{context:isWidget})}_enableInsertContentIntegration(){const e=this.editor,t=this.editor.model,r=t.document.selection;this._listenToIfEnabled(e.model,"insertContent",(i,[o,a])=>{if(a&&!a.is("documentSelection"))return;const c=getTypeAroundFakeCaretPosition(r);if(c)return i.stop(),t.change(u=>{const h=r.getSelectedElement(),d=t.createPositionAt(h,c),f=u.createSelection(d),m=t.insertContent(o,f);return u.setSelection(f),m})},{priority:"high"})}_enableInsertObjectIntegration(){const e=this.editor,r=this.editor.model.document.selection;this._listenToIfEnabled(e.model,"insertObject",(i,o)=>{const[,a,c={}]=o;if(a&&!a.is("documentSelection"))return;const u=getTypeAroundFakeCaretPosition(r);u&&(c.findOptimalPosition=u,o[3]=c)},{priority:"high"})}_enableDeleteContentIntegration(){const e=this.editor,r=this.editor.model.document.selection;this._listenToIfEnabled(e.model,"deleteContent",(i,[o])=>{if(o&&!o.is("documentSelection"))return;getTypeAroundFakeCaretPosition(r)&&i.stop()},{priority:"high"})}};function injectUIIntoWidget(e,t,r){const i=e.createUIElement("div",{class:"ck ck-reset_all ck-widget__type-around"},function(o){const a=this.toDomElement(o);return injectButtons(a,t),injectFakeCaret(a),a});e.insert(e.createPositionAt(r,"end"),i)}function injectButtons(e,t){for(const r of POSSIBLE_INSERTION_POSITIONS){const i=new Template({tag:"div",attributes:{class:["ck","ck-widget__type-around__button",`ck-widget__type-around__button_${r}`],title:t[r],"aria-hidden":"true"},children:[e.ownerDocument.importNode(RETURN_ARROW_ICON_ELEMENT,!0)]});e.appendChild(i.render())}}function injectFakeCaret(e){const t=new Template({tag:"div",attributes:{class:["ck","ck-widget__type-around__fake-caret"]}});e.appendChild(t.render())}function getDeepestEmptyElementAncestor(e,t){let r=t;for(const i of t.getAncestors({parentFirst:!0})){if(i.childCount>1||e.isLimit(i))break;r=i}return r}function verticalNavigationHandler(e){const t=e.model;return(r,i)=>{const o=i.keyCode==keyCodes.arrowup,a=i.keyCode==keyCodes.arrowdown,c=i.shiftKey,u=t.document.selection;if(!o&&!a)return;const h=a;if(c&&selectionWillShrink(u,h))return;const d=findTextRangeFromSelection(e,u,h);if(d){if(d.isCollapsed){if(u.isCollapsed)return;if(c)return}(d.isCollapsed||isSingleLineRange(e,d,h))&&(t.change(f=>{const m=h?d.end:d.start;if(c){const g=t.createSelection(u.anchor);g.setFocus(m),f.setSelection(g)}else f.setSelection(m)}),r.stop(),i.preventDefault(),i.stopPropagation())}}}function findTextRangeFromSelection(e,t,r){const i=e.model;if(r){const o=t.isCollapsed?t.focus:t.getLastPosition(),a=getNearestNonInlineLimit(i,o,"forward");if(!a)return null;const c=i.createRange(o,a),u=getNearestTextPosition(i.schema,c,"backward");return u?i.createRange(o,u):null}else{const o=t.isCollapsed?t.focus:t.getFirstPosition(),a=getNearestNonInlineLimit(i,o,"backward");if(!a)return null;const c=i.createRange(a,o),u=getNearestTextPosition(i.schema,c,"forward");return u?i.createRange(u,o):null}}function getNearestNonInlineLimit(e,t,r){const i=e.schema,o=e.createRangeIn(t.root),a=r=="forward"?"elementStart":"elementEnd";for(const{previousPosition:c,item:u,type:h}of o.getWalker({startPosition:t,direction:r})){if(i.isLimit(u)&&!i.isInline(u))return c;if(h==a&&i.isBlock(u))return null}return null}function getNearestTextPosition(e,t,r){const i=r=="backward"?t.end:t.start;if(e.checkChild(i,"$text"))return i;for(const{nextPosition:o}of t.getWalker({direction:r}))if(e.checkChild(o,"$text"))return o;return null}function isSingleLineRange(e,t,r){const i=e.model,o=e.view.domConverter;if(r){const d=i.createSelection(t.start);i.modifySelection(d),!d.focus.isAtEnd&&!t.start.isEqual(d.focus)&&(t=i.createRange(d.focus,t.end))}const a=e.mapper.toViewRange(t),c=o.viewRangeToDom(a),u=Rect.getDomRangeRects(c);let h;for(const d of u){if(h===void 0){h=Math.round(d.bottom);continue}if(Math.round(d.top)>=h)return!1;h=Math.max(h,Math.round(d.bottom))}return!0}function selectionWillShrink(e,t){return!e.isCollapsed&&e.isBackward==t}var Widget=class extends Plugin{_previouslySelected=new Set;static get pluginName(){return"Widget"}static get isOfficialPlugin(){return!0}static get requires(){return[WidgetTypeAround,Delete]}init(){const e=this.editor,t=e.editing.view,r=t.document,i=e.t;this.editor.editing.downcastDispatcher.on("selection",(o,a,c)=>{const u=c.writer,h=a.selection;if(h.isCollapsed)return;const d=h.getSelectedElement();if(!d)return;const f=e.editing.mapper.toViewElement(d);isWidget(f)&&c.consumable.consume(h,"selection")&&u.setSelection(u.createRangeOn(f),{fake:!0,label:getLabel(f)})}),this.editor.editing.downcastDispatcher.on("selection",(o,a,c)=>{this._clearPreviouslySelectedWidgets(c.writer);const u=c.writer,h=u.document.selection;let d=null;for(const f of h.getRanges())for(const m of f){const g=m.item;isWidget(g)&&!isChild(g,d)&&(u.addClass(WIDGET_SELECTED_CLASS_NAME,g),this._previouslySelected.add(g),d=g)}},{priority:"low"}),t.addObserver(MouseObserver),this.listenTo(r,"mousedown",(...o)=>this._onMousedown(...o)),this.listenTo(r,"arrowKey",(...o)=>{this._handleSelectionChangeOnArrowKeyPress(...o)},{context:[isWidget,"$text"]}),this.listenTo(r,"arrowKey",(...o)=>{this._preventDefaultOnArrowKeyPress(...o)},{context:"$root"}),this.listenTo(r,"arrowKey",verticalNavigationHandler(this.editor.editing),{context:"$text"}),this.listenTo(r,"delete",(o,a)=>{this._handleDelete(a.direction=="forward")&&(a.preventDefault(),o.stop())},{context:"$root"}),this.listenTo(r,"tab",(o,a)=>{o.eventPhase=="atTarget"&&(a.shiftKey||this._selectFirstNestedEditable()&&(a.preventDefault(),o.stop()))},{context:isWidget,priority:"low"}),this.listenTo(r,"tab",(o,a)=>{a.shiftKey&&this._selectAncestorWidget()&&(a.preventDefault(),o.stop())},{priority:"low"}),this.listenTo(r,"keydown",(o,a)=>{a.keystroke==keyCodes.esc&&this._selectAncestorWidget()&&(a.preventDefault(),o.stop())},{priority:"low"}),e.accessibility.addKeystrokeInfoGroup({id:"widget",label:i("Keystrokes that can be used when a widget is selected (for example: image, table, etc.)"),keystrokes:[{label:i("Move focus from an editable area back to the parent widget"),keystroke:"Esc"},{label:i("Insert a new paragraph directly after a widget"),keystroke:"Enter"},{label:i("Insert a new paragraph directly before a widget"),keystroke:"Shift+Enter"},{label:i("Move the caret to allow typing directly before a widget"),keystroke:[["arrowup"],["arrowleft"]]},{label:i("Move the caret to allow typing directly after a widget"),keystroke:[["arrowdown"],["arrowright"]]}]})}_onMousedown(e,t){const r=this.editor,i=r.editing.view,o=i.document;let a=t.target;if(!a)return;if(t.domEvent.detail>=3){this._selectBlockContent(a)&&t.preventDefault();return}if(!isWidget(a)){const u=findClosestEditableOrWidgetAncestor(a);if(!u)return;if(isWidget(u))a=u;else{const h=getElementFromMouseEvent(i,t);if(h&&isWidget(h))a=h;else return}}env.isAndroid&&t.preventDefault(),o.isFocused||i.focus();const c=r.editing.mapper.toModelElement(a);this._setSelectionOverElement(c)}_selectBlockContent(e){const t=this.editor,r=t.model,i=t.editing.mapper,o=r.schema,a=i.findMappedViewAncestor(this.editor.editing.view.createPositionAt(e,0)),c=findTextBlockAncestor(i.toModelElement(a),r.schema);return c?(r.change(u=>{const h=o.isLimit(c)?null:findNextTextBlock(u.createPositionAfter(c),o),d=u.createPositionAt(c,0),f=h?u.createPositionAt(h,0):u.createPositionAt(c,"end");u.setSelection(u.createRange(d,f))}),!0):!1}_handleSelectionChangeOnArrowKeyPress(e,t){const r=t.keyCode,i=this.editor.model,o=i.schema,a=i.document.selection,c=a.getSelectedElement(),u=getLocalizedArrowKeyCodeDirection(r,this.editor.locale.contentLanguageDirection),h=u=="down"||u=="right",d=u=="up"||u=="down";if(c&&o.isObject(c)){const m=h?a.getLastPosition():a.getFirstPosition(),g=o.getNearestSelectionRange(m,h?"forward":"backward");g&&(i.change(v=>{v.setSelection(g)}),t.preventDefault(),e.stop());return}if(!a.isCollapsed&&!t.shiftKey){const m=a.getFirstPosition(),g=a.getLastPosition(),v=m.nodeAfter,_=g.nodeBefore;(v&&o.isObject(v)||_&&o.isObject(_))&&(i.change(b=>{b.setSelection(h?g:m)}),t.preventDefault(),e.stop());return}if(!a.isCollapsed)return;const f=this._getObjectElementNextToSelection(h);if(f&&o.isObject(f)){if(o.isInline(f)&&d)return;this._setSelectionOverElement(f),t.preventDefault(),e.stop()}}_preventDefaultOnArrowKeyPress(e,t){const r=this.editor.model,i=r.schema,o=r.document.selection.getSelectedElement();o&&i.isObject(o)&&(t.preventDefault(),e.stop())}_handleDelete(e){const r=this.editor.model.document.selection;if(!this.editor.model.canEditAt(r)||!r.isCollapsed)return;const i=this._getObjectElementNextToSelection(e);if(i)return this.editor.model.change(o=>{let a=r.anchor.parent;for(;a.isEmpty;){const c=a;a=c.parent,o.remove(c)}this._setSelectionOverElement(i)}),!0}_setSelectionOverElement(e){this.editor.model.change(t=>{t.setSelection(t.createRangeOn(e))})}_getObjectElementNextToSelection(e){const t=this.editor.model,r=t.schema,i=t.document.selection,o=t.createSelection(i);if(t.modifySelection(o,{direction:e?"forward":"backward"}),o.isEqual(i))return null;const a=e?o.focus.nodeBefore:o.focus.nodeAfter;return a&&r.isObject(a)?a:null}_clearPreviouslySelectedWidgets(e){for(const t of this._previouslySelected)e.removeClass(WIDGET_SELECTED_CLASS_NAME,t);this._previouslySelected.clear()}_selectFirstNestedEditable(){const e=this.editor,r=this.editor.editing.view.document;for(const i of r.selection.getFirstRange().getItems())if(i.is("editableElement")){const o=e.editing.mapper.toModelElement(i);if(!o)continue;const a=e.model.createPositionAt(o,0),c=e.model.schema.getNearestSelectionRange(a,"forward");return e.model.change(u=>{u.setSelection(c)}),!0}return!1}_selectAncestorWidget(){const e=this.editor,t=e.editing.mapper,i=e.editing.view.document.selection.getFirstPosition().parent,a=(i.is("$text")?i.parent:i).findAncestor(isWidget);if(!a)return!1;const c=t.toModelElement(a);return c?(e.model.change(u=>{u.setSelection(c,"on")}),!0):!1}};function findClosestEditableOrWidgetAncestor(e){let t=e;for(;t;){if(t.is("editableElement")||isWidget(t))return t;t=t.parent}return null}function getElementFromMouseEvent(e,t){const r=getRangeFromMouseEvent(t.domEvent);let i=null;if(r?i=e.domConverter.domRangeToView(r):i=e.createRange(e.createPositionAt(t.target,0)),!i)return null;const o=i.start;if(!o.parent)return null;let a=o.parent;return o.parent.is("editableElement")&&(o.isAtEnd&&o.nodeBefore?a=o.nodeBefore:o.isAtStart&&o.nodeAfter&&(a=o.nodeAfter)),a.is("$text")?a.parent:a}function isChild(e,t){return t?Array.from(e.getAncestors()).includes(t):!1}function findTextBlockAncestor(e,t){for(const r of e.getAncestors({includeSelf:!0,parentFirst:!0})){if(t.checkChild(r,"$text"))return r;if(t.isLimit(r)&&!t.isObject(r))break}return null}function findNextTextBlock(e,t){const r=new TreeWalker2({startPosition:e});for(const{item:i}of r){if(t.isLimit(i)||!i.is("element"))return null;if(t.checkChild(i,"$text"))return i}return null}var ClipboardObserver=class extends DomEventObserver{domEventType=["paste","copy","cut","drop","dragover","dragstart","dragend","dragenter","dragleave"];constructor(e){super(e);const t=this.document;this.listenTo(t,"paste",r("clipboardInput"),{priority:"low"}),this.listenTo(t,"drop",r("clipboardInput"),{priority:"low"}),this.listenTo(t,"dragover",r("dragging"),{priority:"low"});function r(i){return(o,a)=>{a.preventDefault();const c=a.dropRange?[a.dropRange]:null,u=new EventInfo(t,i);t.fire(u,{dataTransfer:a.dataTransfer,method:o.name,targetRanges:c,target:a.target,domEvent:a.domEvent}),u.stop.called&&a.stopPropagation()}}}onDomEvent(e){const t="clipboardData"in e?e.clipboardData:e.dataTransfer,r=e.type=="drop"||e.type=="paste",i={dataTransfer:new DataTransfer(t,{cacheFiles:r})};if(e.type=="drop"||e.type=="dragover"){const o=getRangeFromMouseEvent(e);i.dropRange=o&&this.view.domConverter.domRangeToView(o)}this.fire(e.type,e,i)}};function plainTextToHtml(e){return e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/^\s/,"&nbsp;").replace(/\s$/,"&nbsp;").replace(/\s\s/g," &nbsp;"),(e.includes("</p><p>")||e.includes("<br>"))&&(e=`<p>${e}</p>`),e}function normalizeClipboardData(e){return e.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(t,r)=>r.length==1?" ":r).replace(/<!--[\s\S]*?-->/g,"")}var smallPaddingElements=["figcaption","li"],listElements=["ol","ul"];function viewToPlainText(e){if(e.is("$text")||e.is("$textProxy"))return e.data;if(e.is("element","img")&&e.hasAttribute("alt"))return e.getAttribute("alt");if(e.is("element","br"))return`
`;let t="",r=null;for(const i of e.getChildren())t+=newLinePadding(i,r)+viewToPlainText(i),r=i;return t}function newLinePadding(e,t){return t?e.is("element","li")&&!e.isEmpty&&e.getChild(0).is("containerElement")||listElements.includes(e.name)&&listElements.includes(t.name)?`

`:!e.is("containerElement")&&!t.is("containerElement")?"":smallPaddingElements.includes(e.name)||smallPaddingElements.includes(t.name)?`
`:e.is("element")&&e.getCustomProperty("dataPipeline:transparentRendering")||t.is("element")&&t.getCustomProperty("dataPipeline:transparentRendering")?"":`

`:""}var ClipboardMarkersUtils=class extends Plugin{_markersToCopy=new Map;static get pluginName(){return"ClipboardMarkersUtils"}static get isOfficialPlugin(){return!0}_registerMarkerToCopy(e,t){this._markersToCopy.set(e,t)}_copySelectedFragmentWithMarkers(e,t,r=i=>i.model.getSelectedContent(i.model.document.selection)){return this.editor.model.change(i=>{const o=i.model.document.selection;i.setSelection(t);const a=this._insertFakeMarkersIntoSelection(i,i.model.document.selection,e),c=r(i),u=this._removeFakeMarkersInsideElement(i,c);for(const[h,d]of Object.entries(a)){u[h]||=i.createRangeIn(c);for(const f of d)i.remove(f)}c.markers.clear();for(const[h,d]of Object.entries(u))c.markers.set(h,d);return i.setSelection(o),c})}_pasteMarkersIntoTransformedElement(e,t){const r=this._getPasteMarkersFromRangeMap(e);return this.editor.model.change(i=>{const o=this._insertFakeMarkersElements(i,r),a=t(i),c=this._removeFakeMarkersInsideElement(i,a);for(const u of Object.values(o).flat())i.remove(u);for(const[u,h]of Object.entries(c))i.model.markers.has(u)||i.addMarker(u,{usingOperation:!0,affectsData:!0,range:h});return a})}_pasteFragmentWithMarkers(e){const t=this._getPasteMarkersFromRangeMap(e.markers);e.markers.clear();for(const r of t)e.markers.set(r.name,r.range);return this.editor.model.insertContent(e)}_forceMarkersCopy(e,t,r={allowedActions:"all",copyPartiallySelected:!0,duplicateOnPaste:!0}){const i=this._markersToCopy.get(e);this._markersToCopy.set(e,r),t(),i?this._markersToCopy.set(e,i):this._markersToCopy.delete(e)}_isMarkerCopyable(e,t){const r=this._getMarkerClipboardConfig(e);if(!r)return!1;if(!t)return!0;const{allowedActions:i}=r;return i==="all"||i.includes(t)}_hasMarkerConfiguration(e){return!!this._getMarkerClipboardConfig(e)}_getMarkerClipboardConfig(e){const[t]=e.split(":");return this._markersToCopy.get(t)||null}_insertFakeMarkersIntoSelection(e,t,r){const i=this._getCopyableMarkersFromSelection(e,t,r);return this._insertFakeMarkersElements(e,i)}_getCopyableMarkersFromSelection(e,t,r){const i=Array.from(t.getRanges()),o=new Set(i.flatMap(c=>Array.from(e.model.markers.getMarkersIntersectingRange(c)))),a=c=>{if(!this._isMarkerCopyable(c.name,r))return!1;const{copyPartiallySelected:h}=this._getMarkerClipboardConfig(c.name);if(!h){const d=c.getRange();return i.some(f=>f.containsRange(d,!0))}return!0};return Array.from(o).filter(a).map(c=>({name:r==="dragstart"?this._getUniqueMarkerName(c.name):c.name,range:c.getRange()}))}_getPasteMarkersFromRangeMap(e,t=null){const{model:r}=this.editor;return(e instanceof Map?Array.from(e.entries()):Object.entries(e)).flatMap(([o,a])=>{if(!this._hasMarkerConfiguration(o))return[{name:o,range:a}];if(this._isMarkerCopyable(o,t)){const c=this._getMarkerClipboardConfig(o),u=r.markers.has(o)&&r.markers.get(o).getRange().root.rootName==="$graveyard";return(c.duplicateOnPaste||u)&&(o=this._getUniqueMarkerName(o)),[{name:o,range:a}]}return[]})}_insertFakeMarkersElements(e,t){const r={},i=t.flatMap(o=>{const{start:a,end:c}=o.range;return[{position:a,marker:o,type:"start"},{position:c,marker:o,type:"end"}]}).sort(({position:o},{position:a})=>o.isBefore(a)?1:-1);for(const{position:o,marker:a,type:c}of i){const u=e.createElement("$marker",{"data-name":a.name,"data-type":c});r[a.name]||(r[a.name]=[]),r[a.name].push(u),e.insert(u,o)}return r}_removeFakeMarkersInsideElement(e,t){const i=this._getAllFakeMarkersFromElement(e,t).reduce((o,a)=>{const c=a.markerElement&&e.createPositionBefore(a.markerElement);let u=o[a.name],h=!1;return u&&u.start&&u.end&&(this._getMarkerClipboardConfig(a.name).duplicateOnPaste?o[this._getUniqueMarkerName(a.name)]=o[a.name]:h=!0,u=null),h||(o[a.name]={...u,[a.type]:c}),a.markerElement&&e.remove(a.markerElement),o},{});return mapValues_default(i,o=>new Range2(o.start||e.createPositionFromPath(t,[0]),o.end||e.createPositionAt(t,"end")))}_getAllFakeMarkersFromElement(e,t){const r=Array.from(e.createRangeIn(t)).flatMap(({item:a})=>{if(!a.is("element","$marker"))return[];const c=a.getAttribute("data-name"),u=a.getAttribute("data-type");return[{markerElement:a,name:c,type:u}]}),i=[],o=[];for(const a of r)a.type==="end"&&(r.some(u=>u.name===a.name&&u.type==="start")||i.push({markerElement:null,name:a.name,type:"start"})),a.type==="start"&&(r.some(u=>u.name===a.name&&u.type==="end")||o.unshift({markerElement:null,name:a.name,type:"end"}));return[...i,...r,...o]}_getUniqueMarkerName(e){const t=e.split(":"),r=uid2().substring(1,6);return t.length===3?`${t.slice(0,2).join(":")}:${r}`:`${t.join(":")}:${r}`}},ClipboardPipeline=class extends Plugin{static get pluginName(){return"ClipboardPipeline"}static get isOfficialPlugin(){return!0}static get requires(){return[ClipboardMarkersUtils]}init(){this.editor.editing.view.addObserver(ClipboardObserver),this._setupPasteDrop(),this._setupCopyCut()}_fireOutputTransformationEvent(e,t,r){const i=this.editor.plugins.get("ClipboardMarkersUtils");this.editor.model.enqueueChange({isUndoable:r==="cut"},()=>{const o=i._copySelectedFragmentWithMarkers(r,t);this.fire("outputTransformation",{dataTransfer:e,content:o,method:r})})}_setupPasteDrop(){const e=this.editor,t=e.model,r=e.editing.view,i=r.document,o=this.editor.plugins.get("ClipboardMarkersUtils");this.listenTo(i,"clipboardInput",(a,c)=>{c.method=="paste"&&!e.model.canEditAt(e.model.document.selection)&&a.stop()},{priority:"highest"}),this.listenTo(i,"clipboardInput",(a,c)=>{const u=c.dataTransfer;let h;if(c.content)h=c.content;else{let f="";u.getData("text/html")?f=normalizeClipboardData(u.getData("text/html")):u.getData("text/plain")&&(f=plainTextToHtml(u.getData("text/plain"))),h=this.editor.data.htmlProcessor.toView(f)}const d=new EventInfo(this,"inputTransformation");this.fire(d,{content:h,dataTransfer:u,targetRanges:c.targetRanges,method:c.method}),d.stop.called&&a.stop(),r.scrollToTheSelection()},{priority:"low"}),this.listenTo(this,"inputTransformation",(a,c)=>{if(c.content.isEmpty)return;const h=this.editor.data.toModel(c.content,"$clipboardHolder");h.childCount!=0&&(a.stop(),t.change(()=>{this.fire("contentInsertion",{content:h,method:c.method,dataTransfer:c.dataTransfer,targetRanges:c.targetRanges})}))},{priority:"low"}),this.listenTo(this,"contentInsertion",(a,c)=>{c.resultRange=o._pasteFragmentWithMarkers(c.content)},{priority:"low"})}_setupCopyCut(){const e=this.editor,t=e.model.document,i=e.editing.view.document,o=(a,c)=>{const u=c.dataTransfer;c.preventDefault(),this._fireOutputTransformationEvent(u,t.selection,a.name)};this.listenTo(i,"copy",o,{priority:"low"}),this.listenTo(i,"cut",(a,c)=>{e.model.canEditAt(e.model.document.selection)?o(a,c):c.preventDefault()},{priority:"low"}),this.listenTo(this,"outputTransformation",(a,c)=>{const u=e.data.toView(c.content);i.fire("clipboardOutput",{dataTransfer:c.dataTransfer,content:u,method:c.method})},{priority:"low"}),this.listenTo(i,"clipboardOutput",(a,c)=>{c.content.isEmpty||(c.dataTransfer.setData("text/html",this.editor.data.htmlProcessor.toData(c.content)),c.dataTransfer.setData("text/plain",viewToPlainText(c.content))),c.method=="cut"&&e.model.deleteContent(t.selection)},{priority:"low"})}},toPx=toUnit("px"),LineView=class extends View2{constructor(){super();const e=this.bindTemplate;this.set({isVisible:!1,left:null,top:null,width:null}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-clipboard-drop-target-line",e.if("isVisible","ck-hidden",t=>!t)],style:{left:e.to("left",t=>toPx(t)),top:e.to("top",t=>toPx(t)),width:e.to("width",t=>toPx(t))}}})}},DragDropTarget=class extends Plugin{removeDropMarkerDelayed=delay(()=>this.removeDropMarker(),40);_updateDropMarkerThrottled=throttle_default(e=>this._updateDropMarker(e),40);_reconvertMarkerThrottled=throttle_default(()=>{this.editor.model.markers.has("drop-target")&&this.editor.editing.reconvertMarker("drop-target")},0);_dropTargetLineView=new LineView;_domEmitter=new(DomEmitterMixin());_scrollables=new Map;static get pluginName(){return"DragDropTarget"}static get isOfficialPlugin(){return!0}init(){this._setupDropMarker()}destroy(){this._domEmitter.stopListening();for(const{resizeObserver:e}of this._scrollables.values())e.destroy();return this._updateDropMarkerThrottled.cancel(),this.removeDropMarkerDelayed.cancel(),this._reconvertMarkerThrottled.cancel(),super.destroy()}updateDropMarker(e,t,r,i,o,a){this.removeDropMarkerDelayed.cancel();const c=findDropTargetRange(this.editor,e,t,r,i,o,a);if(c){if(a&&a.containsRange(c))return this.removeDropMarker();this._updateDropMarkerThrottled(c)}}getFinalDropRange(e,t,r,i,o,a){const c=findDropTargetRange(this.editor,e,t,r,i,o,a);return this.removeDropMarker(),c}removeDropMarker(){const e=this.editor.model;this.removeDropMarkerDelayed.cancel(),this._updateDropMarkerThrottled.cancel(),this._dropTargetLineView.isVisible=!1,e.markers.has("drop-target")&&e.change(t=>{t.removeMarker("drop-target")})}_setupDropMarker(){const e=this.editor;e.ui.view.body.add(this._dropTargetLineView),e.conversion.for("editingDowncast").markerToHighlight({model:"drop-target",view:{classes:["ck-clipboard-drop-target-range"]}}),e.conversion.for("editingDowncast").markerToElement({model:"drop-target",view:(t,{writer:r})=>{if(e.model.schema.checkChild(t.markerRange.start,"$text"))return this._dropTargetLineView.isVisible=!1,this._createDropTargetPosition(r);t.markerRange.isCollapsed?this._updateDropTargetLine(t.markerRange):this._dropTargetLineView.isVisible=!1}})}_updateDropMarker(e){const t=this.editor,r=t.model.markers;t.model.change(i=>{r.has("drop-target")?r.get("drop-target").getRange().isEqual(e)||i.updateMarker("drop-target",{range:e}):i.addMarker("drop-target",{range:e,usingOperation:!1,affectsData:!1})})}_createDropTargetPosition(e){return e.createUIElement("span",{class:"ck ck-clipboard-drop-target-position"},function(t){const r=this.toDomElement(t);return r.append("\u2060",t.createElement("span"),"\u2060"),r})}_updateDropTargetLine(e){const t=this.editor.editing,r=e.start.nodeBefore,i=e.start.nodeAfter,o=e.start.parent,a=r?t.mapper.toViewElement(r):null,c=a?t.view.domConverter.mapViewToDom(a):null,u=i?t.mapper.toViewElement(i):null,h=u?t.view.domConverter.mapViewToDom(u):null,d=t.mapper.toViewElement(o);if(!d)return;const f=t.view.domConverter.mapViewToDom(d),m=this._getScrollableRect(d),{scrollX:g,scrollY:v}=global2.window,_=c?new Rect(c):null,b=h?new Rect(h):null,S=new Rect(f).excludeScrollbarsAndBorders(),R=_?_.bottom:S.top,A=b?b.top:S.bottom,I=global2.window.getComputedStyle(f),E=R<=A?(R+A)/2:A;if(m.top<E&&E<m.bottom){const O=S.left+parseFloat(I.paddingLeft),P=S.right-parseFloat(I.paddingRight),L=Math.max(O+g,m.left),V=Math.min(P+g,m.right);this._dropTargetLineView.set({isVisible:!0,left:L,top:E+v,width:V-L})}else this._dropTargetLineView.isVisible=!1}_getScrollableRect(e){const t=e.root.rootName;let r;if(this._scrollables.has(t))r=this._scrollables.get(t).domElement;else{const i=this.editor.editing.view.domConverter.mapViewToDom(e);r=findScrollableElement(i),this._domEmitter.listenTo(r,"scroll",this._reconvertMarkerThrottled,{usePassive:!0});const o=new ResizeObserver2(r,this._reconvertMarkerThrottled);this._scrollables.set(t,{domElement:r,resizeObserver:o})}return new Rect(r).excludeScrollbarsAndBorders()}};function findDropTargetRange(e,t,r,i,o,a,c){const u=e.model,h=e.editing.mapper;let f=getClosestMappedModelElement(e,t);for(;f;){if(!a){if(u.schema.checkChild(f,"$text")){if(r){const m=r[0].start,g=h.toModelPosition(m);if(!c||Array.from(c.getItems({shallow:!0})).every(_=>u.schema.checkChild(g,_))){if(u.schema.checkChild(g,"$text"))return u.createRange(g);if(m)return findDropTargetRangeForElement(e,getClosestMappedModelElement(e,m.parent),i,o)}}}else if(u.schema.isInline(f))return findDropTargetRangeForElement(e,f,i,o)}if(u.schema.isBlock(f))return findDropTargetRangeForElement(e,f,i,o);if(u.schema.checkChild(f,"$block")){const m=Array.from(f.getChildren()).filter(_=>_.is("element")&&!shouldIgnoreElement(e,_));let g=0,v=m.length;if(v==0)return u.createRange(u.createPositionAt(f,"end"));for(;g<v-1;){const _=Math.floor((g+v)/2);findElementSide(e,m[_],i,o)=="before"?v=_:g=_}return findDropTargetRangeForElement(e,m[g],i,o)}f=f.parent}return null}function shouldIgnoreElement(e,t){const r=e.editing.mapper,i=e.editing.view.domConverter,o=r.toViewElement(t);if(!o)return!0;const a=i.mapViewToDom(o);return global2.window.getComputedStyle(a).float!="none"}function findDropTargetRangeForElement(e,t,r,i){const o=e.model;return o.createRange(o.createPositionAt(t,findElementSide(e,t,r,i)))}function findElementSide(e,t,r,i){const o=e.editing.mapper,a=e.editing.view.domConverter,c=o.toViewElement(t),u=a.mapViewToDom(c),h=new Rect(u);return e.model.schema.isInline(t)?r<(h.left+h.right)/2?"before":"after":i<(h.top+h.bottom)/2?"before":"after"}function getClosestMappedModelElement(e,t){const r=e.editing.mapper,i=e.editing.view,o=r.toModelElement(t);if(o)return o;const a=i.createPositionBefore(t),c=r.findMappedViewAncestor(a);return r.toModelElement(c)}function findScrollableElement(e){let t=e;do{t=t.parentElement;const r=global2.window.getComputedStyle(t).overflowY;if(r=="auto"||r=="scroll")break}while(t.tagName!="BODY");return t}var DragDropBlockToolbar=class extends Plugin{_isBlockDragging=!1;_domEmitter=new(DomEmitterMixin());static get pluginName(){return"DragDropBlockToolbar"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;if(this.listenTo(e,"change:isReadOnly",(t,r,i)=>{i?(this.forceDisabled("readOnlyMode"),this._isBlockDragging=!1):this.clearForceDisabled("readOnlyMode")}),env.isAndroid&&this.forceDisabled("noAndroidSupport"),e.plugins.has("BlockToolbar")){const r=e.plugins.get("BlockToolbar").buttonView.element;this._domEmitter.listenTo(r,"dragstart",(i,o)=>this._handleBlockDragStart(o)),this._domEmitter.listenTo(global2.document,"dragover",(i,o)=>this._handleBlockDragging(o)),this._domEmitter.listenTo(global2.document,"drop",(i,o)=>this._handleBlockDragging(o)),this._domEmitter.listenTo(global2.document,"dragend",()=>this._handleBlockDragEnd(),{useCapture:!0}),this.isEnabled&&r.setAttribute("draggable","true"),this.on("change:isEnabled",(i,o,a)=>{r.setAttribute("draggable",a?"true":"false")})}}destroy(){return this._domEmitter.stopListening(),super.destroy()}_handleBlockDragStart(e){if(!this.isEnabled)return;const t=this.editor.model,r=t.document.selection,i=this.editor.editing.view,o=Array.from(r.getSelectedBlocks()),a=t.createRange(t.createPositionBefore(o[0]),t.createPositionAfter(o[o.length-1]));t.change(c=>c.setSelection(a)),this._isBlockDragging=!0,i.focus(),i.getObserver(ClipboardObserver).onDomEvent(e)}_handleBlockDragging(e){if(!this.isEnabled||!this._isBlockDragging)return;const t=e.clientX+(this.editor.locale.contentLanguageDirection=="ltr"?100:-100),r=e.clientY,i=document.elementFromPoint(t,r),o=this.editor.editing.view;!i||!i.closest(".ck-editor__editable")||o.getObserver(ClipboardObserver).onDomEvent({...e,type:e.type,dataTransfer:e.dataTransfer,target:i,clientX:t,clientY:r,preventDefault:()=>e.preventDefault(),stopPropagation:()=>e.stopPropagation()})}_handleBlockDragEnd(){this._isBlockDragging=!1}},DragDrop=class extends Plugin{_draggedRange;_draggingUid;_draggableElement;_clearDraggableAttributesDelayed=delay(()=>this._clearDraggableAttributes(),40);_blockMode=!1;_domEmitter=new(DomEmitterMixin());_previewContainer;static get pluginName(){return"DragDrop"}static get isOfficialPlugin(){return!0}static get requires(){return[ClipboardPipeline,Widget,DragDropTarget,DragDropBlockToolbar]}init(){const e=this.editor,t=e.editing.view;this._draggedRange=null,this._draggingUid="",this._draggableElement=null,t.addObserver(ClipboardObserver),t.addObserver(MouseObserver),this._setupDragging(),this._setupContentInsertionIntegration(),this._setupClipboardInputIntegration(),this._setupDraggableAttributeHandling(),this.listenTo(e,"change:isReadOnly",(r,i,o)=>{o?this.forceDisabled("readOnlyMode"):this.clearForceDisabled("readOnlyMode")}),this.on("change:isEnabled",(r,i,o)=>{o||this._finalizeDragging(!1)}),env.isAndroid&&this.forceDisabled("noAndroidSupport")}destroy(){return this._draggedRange&&(this._draggedRange.detach(),this._draggedRange=null),this._previewContainer&&this._previewContainer.remove(),this._domEmitter.stopListening(),this._clearDraggableAttributesDelayed.cancel(),super.destroy()}_setupDragging(){const e=this.editor,t=e.model,r=e.editing.view,i=r.document,o=e.plugins.get(DragDropTarget);this.listenTo(i,"dragstart",(a,c)=>{if(c.target&&c.target.is("editableElement")){c.preventDefault();return}if(this._prepareDraggedRange(c.target),!this._draggedRange){c.preventDefault();return}this._draggingUid=uid2(),c.dataTransfer.effectAllowed=this.isEnabled?"copyMove":"copy",c.dataTransfer.setData("application/ckeditor5-dragging-uid",this._draggingUid);const u=t.createSelection(this._draggedRange.toRange());this.editor.plugins.get("ClipboardPipeline")._fireOutputTransformationEvent(c.dataTransfer,u,"dragstart");const{dataTransfer:d,domTarget:f,domEvent:m}=c,{clientX:g}=m;this._updatePreview({dataTransfer:d,domTarget:f,clientX:g}),c.stopPropagation(),this.isEnabled||(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid="")},{priority:"low"}),this.listenTo(i,"dragend",(a,c)=>{this._finalizeDragging(!c.dataTransfer.isCanceled&&c.dataTransfer.dropEffect=="move")},{priority:"low"}),this._domEmitter.listenTo(global2.document,"dragend",()=>{this._blockMode=!1},{useCapture:!0}),this.listenTo(i,"dragenter",()=>{this.isEnabled&&r.focus()}),this.listenTo(i,"dragleave",()=>{o.removeDropMarkerDelayed()}),this.listenTo(i,"dragging",(a,c)=>{if(!this.isEnabled){c.dataTransfer.dropEffect="none";return}const{clientX:u,clientY:h}=c.domEvent;o.updateDropMarker(c.target,c.targetRanges,u,h,this._blockMode,this._draggedRange),this._draggedRange||(c.dataTransfer.dropEffect="copy"),env.isGecko||(c.dataTransfer.effectAllowed=="copy"?c.dataTransfer.dropEffect="copy":["all","copyMove"].includes(c.dataTransfer.effectAllowed)&&(c.dataTransfer.dropEffect="move")),a.stop()},{priority:"low"})}_setupClipboardInputIntegration(){const e=this.editor,r=e.editing.view.document,i=e.plugins.get(DragDropTarget);this.listenTo(r,"clipboardInput",(o,a)=>{if(a.method!="drop")return;const{clientX:c,clientY:u}=a.domEvent,h=i.getFinalDropRange(a.target,a.targetRanges,c,u,this._blockMode,this._draggedRange);if(!h){this._finalizeDragging(!1),o.stop();return}if(this._draggedRange&&this._draggingUid!=a.dataTransfer.getData("application/ckeditor5-dragging-uid")&&(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid=""),getFinalDropEffect(a.dataTransfer)=="move"&&this._draggedRange&&this._draggedRange.containsRange(h,!0)){this._finalizeDragging(!1),o.stop();return}a.targetRanges=[e.editing.mapper.toViewRange(h)]},{priority:"high"})}_setupContentInsertionIntegration(){const e=this.editor.plugins.get(ClipboardPipeline);e.on("contentInsertion",(t,r)=>{if(!this.isEnabled||r.method!=="drop")return;const i=r.targetRanges.map(o=>this.editor.editing.mapper.toModelRange(o));this.editor.model.change(o=>o.setSelection(i))},{priority:"high"}),e.on("contentInsertion",(t,r)=>{if(!this.isEnabled||r.method!=="drop")return;const i=getFinalDropEffect(r.dataTransfer)=="move",o=!r.resultRange||!r.resultRange.isCollapsed;this._finalizeDragging(o&&i)},{priority:"lowest"})}_setupDraggableAttributeHandling(){const e=this.editor,t=e.editing.view,r=t.document;this.listenTo(r,"mousedown",(i,o)=>{if(env.isAndroid||!o)return;this._clearDraggableAttributesDelayed.cancel();let a=findDraggableWidget(o.target);if(env.isBlink&&!e.isReadOnly&&!a&&!r.selection.isCollapsed){const c=r.selection.getSelectedElement();(!c||!isWidget(c))&&(a=r.selection.editableElement)}a&&(t.change(c=>{c.setAttribute("draggable","true",a)}),this._draggableElement=e.editing.mapper.toModelElement(a))}),this.listenTo(r,"mouseup",()=>{env.isAndroid||this._clearDraggableAttributesDelayed()})}_clearDraggableAttributes(){const e=this.editor.editing;e.view.change(t=>{this._draggableElement&&this._draggableElement.root.rootName!="$graveyard"&&t.removeAttribute("draggable",e.mapper.toViewElement(this._draggableElement)),this._draggableElement=null})}_finalizeDragging(e){const t=this.editor,r=t.model;t.plugins.get(DragDropTarget).removeDropMarker(),this._clearDraggableAttributes(),t.plugins.has("WidgetToolbarRepository")&&t.plugins.get("WidgetToolbarRepository").clearForceDisabled("dragDrop"),this._draggingUid="",this._previewContainer&&(this._previewContainer.remove(),this._previewContainer=void 0),this._draggedRange&&(e&&this.isEnabled&&r.change(o=>{const a=r.createSelection(this._draggedRange);r.deleteContent(a,{doNotAutoparagraph:!0});const c=a.getFirstPosition().parent;c.isEmpty&&!r.schema.checkChild(c,"$text")&&r.schema.checkChild(c,"paragraph")&&o.insertElement("paragraph",c,0)}),this._draggedRange.detach(),this._draggedRange=null)}_prepareDraggedRange(e){const t=this.editor,r=t.model,i=r.document.selection,o=e?findDraggableWidget(e):null;if(o){const h=t.editing.mapper.toModelElement(o);this._draggedRange=LiveRange.fromRange(r.createRangeOn(h)),this._blockMode=r.schema.isBlock(h),t.plugins.has("WidgetToolbarRepository")&&t.plugins.get("WidgetToolbarRepository").forceDisabled("dragDrop");return}if(i.isCollapsed&&!i.getFirstPosition().parent.isEmpty)return;const a=Array.from(i.getSelectedBlocks()),c=i.getFirstRange();if(a.length==0){this._draggedRange=LiveRange.fromRange(c);return}const u=getRangeIncludingFullySelectedParents(r,a);if(a.length>1)this._draggedRange=LiveRange.fromRange(u),this._blockMode=!0;else if(a.length==1){const h=c.start.isTouching(u.start)&&c.end.isTouching(u.end);this._draggedRange=LiveRange.fromRange(h?u:c),this._blockMode=h}r.change(h=>h.setSelection(this._draggedRange.toRange()))}_updatePreview({dataTransfer:e,domTarget:t,clientX:r}){const i=this.editor.editing.view,o=i.document.selection.editableElement,a=i.domConverter.mapViewToDom(o),c=global2.window.getComputedStyle(a);this._previewContainer?this._previewContainer.firstElementChild&&this._previewContainer.removeChild(this._previewContainer.firstElementChild):(this._previewContainer=createElement(global2.document,"div",{style:"position: fixed; left: -999999px;"}),global2.document.body.appendChild(this._previewContainer));const u=new Rect(a);if(a.contains(t))return;const h=parseFloat(c.paddingLeft),d=createElement(global2.document,"div");d.className="ck ck-content",d.style.width=c.width,d.style.paddingLeft=`${u.left-r+h}px`,env.isiOS&&(d.style.backgroundColor="white"),i.domConverter.setContentOf(d,e.getData("text/html")),e.setDragImage(d,0,0),this._previewContainer.appendChild(d)}};function getFinalDropEffect(e){return env.isGecko?e.dropEffect:["all","copyMove"].includes(e.effectAllowed)?"move":"copy"}function findDraggableWidget(e){if(e.is("editableElement"))return null;if(e.hasClass("ck-widget__selection-handle"))return e.findAncestor(isWidget);if(isWidget(e))return e;const t=e.findAncestor(r=>isWidget(r)||r.is("editableElement"));return isWidget(t)?t:null}function getRangeIncludingFullySelectedParents(e,t){const r=t[0],i=t[t.length-1],o=r.getCommonAncestor(i),a=e.createPositionBefore(r),c=e.createPositionAfter(i);if(o&&o.is("element")&&!e.schema.isLimit(o)){const u=e.createRangeOn(o),h=a.isTouching(u.start),d=c.isTouching(u.end);if(h&&d)return getRangeIncludingFullySelectedParents(e,[o])}return e.createRange(a,c)}var PastePlainText=class extends Plugin{static get pluginName(){return"PastePlainText"}static get isOfficialPlugin(){return!0}static get requires(){return[ClipboardPipeline]}init(){const e=this.editor,t=e.model,r=e.editing.view,i=t.document.selection;r.addObserver(ClipboardObserver),e.plugins.get(ClipboardPipeline).on("contentInsertion",(o,a)=>{isUnformattedInlineContent(a.content,t)&&t.change(c=>{const u=Array.from(i.getAttributes()).filter(([d])=>t.schema.getAttributeProperties(d).isFormatting);i.isCollapsed||t.deleteContent(i,{doNotAutoparagraph:!0}),u.push(...i.getAttributes());const h=c.createRangeIn(a.content);for(const d of h.getItems())for(const f of u)t.schema.checkAttribute(d,f[0])&&c.setAttribute(f[0],f[1],d)})})}};function isUnformattedInlineContent(e,t){let r=t.createRangeIn(e);if(e.childCount==1){const i=e.getChild(0);i.is("element")&&t.schema.isBlock(i)&&!t.schema.isObject(i)&&!t.schema.isLimit(i)&&(r=t.createRangeIn(i))}for(const i of r.getItems())if(!t.schema.isInline(i)||Array.from(i.getAttributeKeys()).find(a=>t.schema.getAttributeProperties(a).isFormatting))return!1;return!0}var Clipboard=class extends Plugin{static get pluginName(){return"Clipboard"}static get isOfficialPlugin(){return!0}static get requires(){return[ClipboardMarkersUtils,ClipboardPipeline,DragDrop,PastePlainText]}init(){const e=this.editor,t=this.editor.t;e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Copy selected content"),keystroke:"CTRL+C"},{label:t("Paste content"),keystroke:"CTRL+V"},{label:t("Paste content as plain text"),keystroke:"CTRL+SHIFT+V"}]})}},ClassicEditorUI=class extends EditorUI{view;_toolbarConfig;_elementReplacer;constructor(e,t){super(e),this.view=t,this._toolbarConfig=normalizeToolbarConfig(e.config.get("toolbar")),this._elementReplacer=new ElementReplacer,this.listenTo(e.editing.view,"scrollToTheSelection",this._handleScrollToTheSelectionWithStickyPanel.bind(this))}get element(){return this.view.element}init(e){const t=this.editor,r=this.view,i=t.editing.view,o=r.editable,a=i.document.getRoot();o.name=a.rootName,r.render();const c=o.element;this.setEditableElement(o.name,c),r.editable.bind("isFocused").to(this.focusTracker),i.attachDomRoot(c),e&&this._elementReplacer.replace(e,this.element),this._initPlaceholder(),this._initToolbar(),r.menuBarView&&this._initMenuBar(r.menuBarView),this._initDialogPluginIntegration(),this._initContextualBalloonIntegration(),this.fire("ready")}destroy(){super.destroy();const e=this.view,t=this.editor.editing.view;this._elementReplacer.restore(),t.getDomRoot(e.editable.name)&&t.detachDomRoot(e.editable.name),e.destroy()}_initToolbar(){const e=this.view;e.stickyPanel.bind("isActive").to(this.focusTracker,"isFocused"),e.stickyPanel.limiterElement=e.element,e.stickyPanel.bind("viewportTopOffset").to(this,"viewportOffset",({top:t})=>t||0),e.toolbar.fillFromConfig(this._toolbarConfig,this.componentFactory),this.addToolbar(e.toolbar)}_initPlaceholder(){const e=this.editor,t=e.editing.view,r=t.document.getRoot(),i=e.sourceElement;let o;const a=e.config.get("placeholder");a&&(o=typeof a=="string"?a:a[this.view.editable.name]),!o&&i&&i.tagName.toLowerCase()==="textarea"&&(o=i.getAttribute("placeholder")),o&&(r.placeholder=o),enablePlaceholder({view:t,element:r,isDirectHost:!1,keepOnFocus:!0})}_initContextualBalloonIntegration(){if(!this.editor.plugins.has("ContextualBalloon"))return;const{stickyPanel:e}=this.view,t=this.editor.plugins.get("ContextualBalloon");t.on("getPositionOptions",i=>{const o=i.return;if(!o||!e.isSticky||!e.element)return;const a=new Rect(e.element).height,c=typeof o.target=="function"?o.target():o.target,u=typeof o.limiter=="function"?o.limiter():o.limiter;if(c&&u&&new Rect(c).height>=new Rect(u).height-a)return;const h={...o.viewportOffsetConfig},d=(h.top||0)+a;i.return={...o,viewportOffsetConfig:{...h,top:d}}},{priority:"low"});const r=()=>{t.visibleView&&t.updatePosition()};this.listenTo(e,"change:isSticky",r),this.listenTo(this.editor.ui,"change:viewportOffset",r)}_handleScrollToTheSelectionWithStickyPanel(e,t,r){const i=this.view.stickyPanel;if(i.isSticky){const o=new Rect(i.element).height;t.viewportOffset.top+=o}else{const o=()=>{this.editor.editing.view.scrollToTheSelection(r)};this.listenTo(i,"change:isSticky",o),setTimeout(()=>{this.stopListening(i,"change:isSticky",o)},20)}}_initDialogPluginIntegration(){if(!this.editor.plugins.has("Dialog"))return;const e=this.view.stickyPanel,t=this.editor.plugins.get("Dialog");t.on("show",()=>{const r=t.view;r.on("moveTo",(i,o)=>{if(!e.isSticky||r.wasMoved||r.isModal)return;const a=new Rect(e.contentPanelElement);o[1]<a.bottom+DialogView.defaultOffset&&(o[1]=a.bottom+DialogView.defaultOffset)},{priority:"high"})},{priority:"low"})}},ClassicEditorUIView=class extends BoxedEditorUIView{stickyPanel;toolbar;editable;constructor(e,t,r={}){super(e),this.stickyPanel=new StickyPanelView(e),this.toolbar=new ToolbarView(e,{shouldGroupWhenFull:r.shouldToolbarGroupWhenFull}),r.useMenuBar&&(this.menuBarView=new MenuBarView(e)),this.editable=new InlineEditableUIView(e,t,void 0,{label:r.label})}render(){super.render(),this.menuBarView?this.stickyPanel.content.addMany([this.menuBarView,this.toolbar]):this.stickyPanel.content.add(this.toolbar),this.top.add(this.stickyPanel),this.main.add(this.editable)}},ClassicEditor=class extends ElementApiMixin(Editor){static get editorName(){return"ClassicEditor"}ui;constructor(e,t={}){if(!isElement3(e)&&t.initialData!==void 0)throw new CKEditorError("editor-create-initial-data",null);super(t),this.config.define("menuBar.isVisible",!1),this.config.get("initialData")===void 0&&this.config.set("initialData",getInitialData(e)),isElement3(e)&&(this.sourceElement=e),this.model.document.createRoot();const r=!this.config.get("toolbar.shouldNotGroupWhenFull"),i=this.config.get("menuBar"),o=new ClassicEditorUIView(this.locale,this.editing.view,{shouldToolbarGroupWhenFull:r,useMenuBar:i.isVisible,label:this.config.get("label")});this.ui=new ClassicEditorUI(this,o),attachToForm(this)}destroy(){return this.sourceElement&&this.updateSourceElement(),this.ui.destroy(),super.destroy()}static create(e,t={}){return new Promise(r=>{const i=new this(e,t);r(i.initPlugins().then(()=>i.ui.init(isElement3(e)?e:null)).then(()=>i.data.init(i.config.get("initialData"))).then(()=>i.fire("ready")).then(()=>i))})}};function getInitialData(e){return isElement3(e)?getDataFromElement(e):e}function isElement3(e){return isElement_default(e)}var SelectAllCommand=class extends Command{constructor(e){super(e),this.affectsData=!1}execute(){const e=this.editor.model,t=e.document.selection;let r=e.schema.getLimitElement(t);if(t.containsEntireContent(r)||!isSelectAllScope(e.schema,r))do if(r=r.parent,!r)return;while(!isSelectAllScope(e.schema,r));e.change(i=>{i.setSelection(r,"in")})}};function isSelectAllScope(e,t){return e.isLimit(t)&&(e.checkChild(t,"$text")||e.checkChild(t,"paragraph"))}var SELECT_ALL_KEYSTROKE=parseKeystroke("Ctrl+A"),SelectAllEditing=class extends Plugin{static get pluginName(){return"SelectAllEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.t,i=e.editing.view.document;e.commands.add("selectAll",new SelectAllCommand(e)),this.listenTo(i,"keydown",(o,a)=>{getCode(a)===SELECT_ALL_KEYSTROKE&&(e.execute("selectAll"),a.preventDefault())}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Select all"),keystroke:"CTRL+A"}]})}},selectAllIcon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M.75 15.5a.75.75 0 0 1 .75.75V18l.008.09A.5.5 0 0 0 2 18.5h1.75a.75.75 0 1 1 0 1.5H1.5l-.144-.007a1.5 1.5 0 0 1-1.35-1.349L0 18.5v-2.25a.75.75 0 0 1 .75-.75zm18.5 0a.75.75 0 0 1 .75.75v2.25l-.007.144a1.5 1.5 0 0 1-1.349 1.35L18.5 20h-2.25a.75.75 0 1 1 0-1.5H18a.5.5 0 0 0 .492-.41L18.5 18v-1.75a.75.75 0 0 1 .75-.75zm-10.45 3c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm.45-5.5a.75.75 0 1 1 0 1.5h-8.5a.75.75 0 1 1 0-1.5h8.5zM1.3 11c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM1.3 7c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5h-2.5a.75.75 0 1 1 0-1.5h2.5zm-5 0a.75.75 0 1 1 0 1.5h-5.5a.75.75 0 0 1 0-1.5h5.5zm-6.5-5a.75.75 0 0 1 0 1.5H2a.5.5 0 0 0-.492.41L1.5 2v1.75a.75.75 0 0 1-1.5 0V1.5l.007-.144A1.5 1.5 0 0 1 1.356.006L1.5 0h2.25zM18.5 0l.144.007a1.5 1.5 0 0 1 1.35 1.349L20 1.5v2.25a.75.75 0 1 1-1.5 0V2l-.008-.09A.5.5 0 0 0 18 1.5h-1.75a.75.75 0 1 1 0-1.5h2.25zM8.8 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6z"/></svg>',SelectAllUI=class extends Plugin{static get pluginName(){return"SelectAllUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor;e.ui.componentFactory.add("selectAll",()=>{const t=this._createButton(ButtonView);return t.set({tooltip:!0}),t}),e.ui.componentFactory.add("menuBar:selectAll",()=>this._createButton(MenuBarMenuListItemButtonView))}_createButton(e){const t=this.editor,r=t.locale,i=t.commands.get("selectAll"),o=new e(t.locale),a=r.t;return o.set({label:a("Select all"),icon:selectAllIcon,keystroke:"Ctrl+A"}),o.bind("isEnabled").to(i,"isEnabled"),this.listenTo(o,"execute",()=>{t.execute("selectAll"),t.editing.view.focus()}),o}},SelectAll=class extends Plugin{static get requires(){return[SelectAllEditing,SelectAllUI]}static get pluginName(){return"SelectAll"}static get isOfficialPlugin(){return!0}},BaseCommand=class extends Command{_stack=[];_createdBatches=new WeakSet;constructor(e){super(e),this.refresh(),this._isEnabledBasedOnSelection=!1,this.listenTo(e.data,"set",(t,r)=>{r[1]={...r[1]};const i=r[1];i.batchType||(i.batchType={isUndoable:!1})},{priority:"high"}),this.listenTo(e.data,"set",(t,r)=>{r[1].batchType.isUndoable||this.clearStack()})}refresh(){this.isEnabled=this._stack.length>0}get createdBatches(){return this._createdBatches}addBatch(e){const t=this.editor.model.document.selection,r={ranges:t.hasOwnRange?Array.from(t.getRanges()):[],isBackward:t.isBackward};this._stack.push({batch:e,selection:r}),this.refresh()}clearStack(){this._stack=[],this.refresh()}_restoreSelection(e,t,r){const i=this.editor.model,o=i.document,a=[],c=e.map(h=>h.getTransformedByOperations(r)),u=c.flat();for(const h of c){const d=h.filter(f=>f.root!=o.graveyard).filter(f=>!isRangeContainedByAnyOtherRange(f,u));d.length&&(normalizeRanges2(d),a.push(d[0]))}a.length&&i.change(h=>{h.setSelection(a,{backward:t})})}_undo(e,t){const r=this.editor.model,i=r.document;this._createdBatches.add(t);const o=e.operations.slice().filter(a=>a.isDocumentOperation);o.reverse();for(const a of o){const c=a.baseVersion+1,u=Array.from(i.history.getOperations(c)),d=transformSets([a.getReversed()],u,{useRelations:!0,document:this.editor.model.document,padWithNoOps:!1,forceWeakRemove:!0}).operationsA;for(let f of d){const m=f.affectedSelectable;m&&!r.canEditAt(m)&&(f=new NoOperation(f.baseVersion)),t.addOperation(f),r.applyOperation(f),i.history.setOperationAsUndone(a,f)}}}};function normalizeRanges2(e){e.sort((t,r)=>t.start.isBefore(r.start)?-1:1);for(let t=1;t<e.length;t++){const i=e[t-1].getJoined(e[t],!0);i&&(t--,e.splice(t,2,i))}}function isRangeContainedByAnyOtherRange(e,t){return t.some(r=>r!==e&&r.containsRange(e,!0))}var UndoCommand=class extends BaseCommand{execute(e=null){const t=e?this._stack.findIndex(o=>o.batch==e):this._stack.length-1,r=this._stack.splice(t,1)[0],i=this.editor.model.createBatch({isUndo:!0});this.editor.model.enqueueChange(i,()=>{this._undo(r.batch,i);const o=this.editor.model.document.history.getOperations(r.batch.baseVersion);this._restoreSelection(r.selection.ranges,r.selection.isBackward,o)}),this.fire("revert",r.batch,i),this.refresh()}},RedoCommand=class extends BaseCommand{execute(){const e=this._stack.pop(),t=this.editor.model.createBatch({isUndo:!0});this.editor.model.enqueueChange(t,()=>{const i=e.batch.operations[e.batch.operations.length-1].baseVersion+1,o=this.editor.model.document.history.getOperations(i);this._restoreSelection(e.selection.ranges,e.selection.isBackward,o),this._undo(e.batch,t)}),this.refresh()}},UndoEditing=class extends Plugin{_undoCommand;_redoCommand;_batchRegistry=new WeakSet;static get pluginName(){return"UndoEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.t;this._undoCommand=new UndoCommand(e),this._redoCommand=new RedoCommand(e),e.commands.add("undo",this._undoCommand),e.commands.add("redo",this._redoCommand),this.listenTo(e.model,"applyOperation",(r,i)=>{const o=i[0];if(!o.isDocumentOperation)return;const a=o.batch,c=this._redoCommand.createdBatches.has(a),u=this._undoCommand.createdBatches.has(a);this._batchRegistry.has(a)||(this._batchRegistry.add(a),a.isUndoable&&(c?this._undoCommand.addBatch(a):u||(this._undoCommand.addBatch(a),this._redoCommand.clearStack())))},{priority:"highest"}),this.listenTo(this._undoCommand,"revert",(r,i,o)=>{this._redoCommand.addBatch(o)}),e.keystrokes.set("CTRL+Z","undo"),e.keystrokes.set("CTRL+Y","redo"),e.keystrokes.set("CTRL+SHIFT+Z","redo"),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Undo"),keystroke:"CTRL+Z"},{label:t("Redo"),keystroke:[["CTRL+Y"],["CTRL+SHIFT+Z"]]}]})}},UndoUI=class extends Plugin{static get pluginName(){return"UndoUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.locale,r=e.t,i=t.uiLanguageDirection=="ltr"?icons.undo:icons.redo,o=t.uiLanguageDirection=="ltr"?icons.redo:icons.undo;this._addButtonsToFactory("undo",r("Undo"),"CTRL+Z",i),this._addButtonsToFactory("redo",r("Redo"),"CTRL+Y",o)}_addButtonsToFactory(e,t,r,i){const o=this.editor;o.ui.componentFactory.add(e,()=>{const a=this._createButton(ButtonView,e,t,r,i);return a.set({tooltip:!0}),a}),o.ui.componentFactory.add("menuBar:"+e,()=>this._createButton(MenuBarMenuListItemButtonView,e,t,r,i))}_createButton(e,t,r,i,o){const a=this.editor,c=a.locale,u=a.commands.get(t),h=new e(c);return h.set({label:r,icon:o,keystroke:i}),h.bind("isEnabled").to(u,"isEnabled"),this.listenTo(h,"execute",()=>{a.execute(t),a.editing.view.focus()}),h}},Undo=class extends Plugin{static get requires(){return[UndoEditing,UndoUI]}static get pluginName(){return"Undo"}static get isOfficialPlugin(){return!0}},Essentials=class extends Plugin{static get requires(){return[AccessibilityHelp,Clipboard,Enter,SelectAll,ShiftEnter,Typing,Undo]}static get pluginName(){return"Essentials"}static get isOfficialPlugin(){return!0}},FontCommand=class extends Command{attributeKey;constructor(e,t){super(e),this.attributeKey=t}refresh(){const e=this.editor.model,t=e.document;this.value=t.selection.getAttribute(this.attributeKey),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,this.attributeKey)}execute(e={}){const t=this.editor.model,i=t.document.selection,o=e.value,a=e.batch,c=u=>{if(i.isCollapsed)o?u.setSelectionAttribute(this.attributeKey,o):u.removeSelectionAttribute(this.attributeKey);else{const h=t.schema.getValidRanges(i.getRanges(),this.attributeKey);for(const d of h)o?u.setAttribute(this.attributeKey,o,d):u.removeAttribute(this.attributeKey,d)}};a?t.enqueueChange(a,u=>{c(u)}):t.change(u=>{c(u)})}},FONT_SIZE="fontSize",FONT_FAMILY="fontFamily",FONT_COLOR="fontColor",FONT_BACKGROUND_COLOR="fontBackgroundColor";function buildDefinition(e,t){const r={model:{key:e,values:[]},view:{},upcastAlso:{}};for(const i of t)r.model.values.push(i.model),r.view[i.model]=i.view,i.upcastAlso&&(r.upcastAlso[i.model]=i.upcastAlso);return r}function renderUpcastAttribute(e){return t=>normalizeColorCode(t.getStyle(e))}function renderDowncastElement(e){return(t,{writer:r})=>r.createAttributeElement("span",{style:`${e}:${t}`},{priority:7})}function addColorSelectorToDropdown({dropdownView:e,colors:t,columns:r,removeButtonLabel:i,colorPickerLabel:o,documentColorsLabel:a,documentColorsCount:c,colorPickerViewConfig:u}){const h=e.locale,d=new ColorSelectorView(h,{colors:t,columns:r,removeButtonLabel:i,colorPickerLabel:o,documentColorsLabel:a,documentColorsCount:c,colorPickerViewConfig:u});return e.colorSelectorView=d,e.panelView.children.add(d),d}function normalizeColorCode(e){return e.replace(/\s/g,"")}var FontFamilyCommand=class extends FontCommand{constructor(e){super(e,FONT_FAMILY)}};function normalizeOptions$1(e){return e.map(getOptionDefinition$1).filter(t=>t!==void 0)}function getOptionDefinition$1(e){if(typeof e=="object")return e;if(e==="default")return{title:"Default",model:void 0};if(typeof e=="string")return generateFontPreset(e)}function generateFontPreset(e){const t=e.replace(/"|'/g,"").split(","),r=t[0],i=t.map(normalizeFontNameForCSS).join(", ");return{title:r,model:i,view:{name:"span",styles:{"font-family":i},priority:7}}}function normalizeFontNameForCSS(e){return e=e.trim(),e.indexOf(" ")>0&&(e=`'${e}'`),e}var FontFamilyEditing=class extends Plugin{static get pluginName(){return"FontFamilyEditing"}static get isOfficialPlugin(){return!0}constructor(e){super(e),e.config.define(FONT_FAMILY,{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!1})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:FONT_FAMILY}),e.model.schema.setAttributeProperties(FONT_FAMILY,{isFormatting:!0,copyOnEnter:!0});const t=normalizeOptions$1(e.config.get("fontFamily.options")).filter(i=>i.model),r=buildDefinition(FONT_FAMILY,t);e.config.get("fontFamily.supportAllValues")?(this._prepareAnyValueConverters(),this._prepareCompatibilityConverter()):e.conversion.attributeToElement(r),e.commands.add(FONT_FAMILY,new FontFamilyCommand(e))}_prepareAnyValueConverters(){const e=this.editor;e.conversion.for("downcast").attributeToElement({model:FONT_FAMILY,view:(t,{writer:r})=>r.createAttributeElement("span",{style:"font-family:"+t},{priority:7})}),e.conversion.for("upcast").elementToAttribute({model:{key:FONT_FAMILY,value:t=>t.getStyle("font-family")},view:{name:"span",styles:{"font-family":/.*/}}})}_prepareCompatibilityConverter(){this.editor.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{face:/.*/}},model:{key:FONT_FAMILY,value:t=>t.getAttribute("face")}})}},fontFamilyIcon='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.03 3h6.149a.75.75 0 1 1 0 1.5h-5.514L11.03 3zm1.27 3h4.879a.75.75 0 1 1 0 1.5h-4.244L12.3 6zm1.27 3h3.609a.75.75 0 1 1 0 1.5h-2.973L13.57 9zm-2.754 2.5L8.038 4.785 5.261 11.5h5.555zm.62 1.5H4.641l-1.666 4.028H1.312l5.789-14h1.875l5.789 14h-1.663L11.436 13z"/></svg>',FontFamilyUI=class extends Plugin{static get pluginName(){return"FontFamilyUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.t,r=this._getLocalizedOptions(),i=e.commands.get(FONT_FAMILY),o=t("Font Family"),a=_prepareListOptions$1(r,i);e.ui.componentFactory.add(FONT_FAMILY,c=>{const u=createDropdown(c);return addListToDropdown(u,a,{role:"menu",ariaLabel:o}),u.buttonView.set({label:o,icon:fontFamilyIcon,tooltip:!0}),u.extendTemplate({attributes:{class:"ck-font-family-dropdown"}}),u.bind("isEnabled").to(i),this.listenTo(u,"execute",h=>{e.execute(h.source.commandName,{value:h.source.commandParam}),e.editing.view.focus()}),u}),e.ui.componentFactory.add(`menuBar:${FONT_FAMILY}`,c=>{const u=new MenuBarMenuView(c);u.buttonView.set({label:o,icon:fontFamilyIcon}),u.bind("isEnabled").to(i);const h=new MenuBarMenuListView(c);for(const d of a){const f=new MenuBarMenuListItemView(c,u),m=new MenuBarMenuListItemButtonView(c);m.set({role:"menuitemradio",isToggleable:!0}),m.bind(...Object.keys(d.model)).to(d.model),m.delegate("execute").to(u),m.on("execute",()=>{e.execute(d.model.commandName,{value:d.model.commandParam}),e.editing.view.focus()}),f.children.add(m),h.items.add(f)}return u.panelView.children.add(h),u})}_getLocalizedOptions(){const e=this.editor,t=e.t;return normalizeOptions$1(e.config.get(FONT_FAMILY).options).map(i=>(i.title==="Default"&&(i.title=t("Default")),i))}};function _prepareListOptions$1(e,t){const r=new Collection;for(const i of e){const o={type:"button",model:new Model2({commandName:FONT_FAMILY,commandParam:i.model,label:i.title,role:"menuitemradio",withText:!0})};o.model.bind("isOn").to(t,"value",a=>a===i.model?!0:!a||!i.model?!1:a.split(",")[0].replace(/'/g,"").toLowerCase()===i.model.toLowerCase()),i.view&&typeof i.view!="string"&&i.view.styles&&o.model.set("labelStyle",`font-family: ${i.view.styles["font-family"]}`),r.add(o)}return r}var FontFamily=class extends Plugin{static get requires(){return[FontFamilyEditing,FontFamilyUI]}static get pluginName(){return"FontFamily"}static get isOfficialPlugin(){return!0}},FontSizeCommand=class extends FontCommand{constructor(e){super(e,FONT_SIZE)}};function normalizeOptions(e){return e.map(t=>getOptionDefinition(t)).filter(t=>t!==void 0)}var namedPresets={get tiny(){return{title:"Tiny",model:"tiny",view:{name:"span",classes:"text-tiny",priority:7}}},get small(){return{title:"Small",model:"small",view:{name:"span",classes:"text-small",priority:7}}},get big(){return{title:"Big",model:"big",view:{name:"span",classes:"text-big",priority:7}}},get huge(){return{title:"Huge",model:"huge",view:{name:"span",classes:"text-huge",priority:7}}}};function getOptionDefinition(e){if(typeof e=="number"&&(e=String(e)),typeof e=="object"&&isFullItemDefinition(e))return attachPriority(e);const t=findPreset(e);if(t)return attachPriority(t);if(e==="default")return{model:void 0,title:"Default"};if(!isNumericalDefinition(e))return generatePixelPreset(e)}function generatePixelPreset(e){return typeof e=="string"&&(e={title:e,model:`${parseFloat(e)}px`}),e.view={name:"span",styles:{"font-size":e.model}},attachPriority(e)}function attachPriority(e){return e.view&&typeof e.view!="string"&&!e.view.priority&&(e.view.priority=7),e}function findPreset(e){return typeof e=="string"?namedPresets[e]:namedPresets[e.model]}function isFullItemDefinition(e){return e.title&&e.model&&e.view}function isNumericalDefinition(e){let t;if(typeof e=="object")if(e.model)t=parseFloat(e.model);else throw new CKEditorError("font-size-invalid-definition",null,e);else t=parseFloat(e);return isNaN(t)}var styleFontSize=["x-small","x-small","small","medium","large","x-large","xx-large","xxx-large"],FontSizeEditing=class extends Plugin{static get pluginName(){return"FontSizeEditing"}static get isOfficialPlugin(){return!0}constructor(e){super(e),e.config.define(FONT_SIZE,{options:["tiny","small","default","big","huge"],supportAllValues:!1})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:FONT_SIZE}),e.model.schema.setAttributeProperties(FONT_SIZE,{isFormatting:!0,copyOnEnter:!0});const t=e.config.get("fontSize.supportAllValues"),r=normalizeOptions(this.editor.config.get("fontSize.options")).filter(o=>o.model),i=buildDefinition(FONT_SIZE,r);t?(this._prepareAnyValueConverters(i),this._prepareCompatibilityConverter()):e.conversion.attributeToElement(i),e.commands.add(FONT_SIZE,new FontSizeCommand(e))}_prepareAnyValueConverters(e){const t=this.editor,r=e.model.values.filter(i=>!isLength2(String(i))&&!isPercentage(String(i)));if(r.length)throw new CKEditorError("font-size-invalid-use-of-named-presets",null,{presets:r});t.conversion.for("downcast").attributeToElement({model:FONT_SIZE,view:(i,{writer:o})=>{if(i)return o.createAttributeElement("span",{style:"font-size:"+i},{priority:7})}}),t.conversion.for("upcast").elementToAttribute({model:{key:FONT_SIZE,value:i=>i.getStyle("font-size")},view:{name:"span",styles:{"font-size":/.*/}}})}_prepareCompatibilityConverter(){this.editor.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{size:/^[+-]?\d{1,3}$/}},model:{key:FONT_SIZE,value:t=>{const r=t.getAttribute("size"),i=r[0]==="-"||r[0]==="+";let o=parseInt(r,10);i&&(o=3+o);const a=styleFontSize.length-1,c=Math.min(Math.max(o,0),a);return styleFontSize[c]}}})}},fontSizeIcon='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.816 11.5 7.038 4.785 4.261 11.5h5.555zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663L10.436 13zm7.55 2.279.779-.779.707.707-2.265 2.265-2.193-2.265.707-.707.765.765V4.825c0-.042 0-.083.002-.123l-.77.77-.707-.707L17.207 2.5l2.265 2.265-.707.707-.782-.782c.002.043.003.089.003.135v10.454z"/></svg>',FontSizeUI=class extends Plugin{static get pluginName(){return"FontSizeUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.t,r=this._getLocalizedOptions(),i=e.commands.get(FONT_SIZE),o=t("Font Size"),a=_prepareListOptions(r,i);e.ui.componentFactory.add(FONT_SIZE,c=>{const u=createDropdown(c);return addListToDropdown(u,a,{role:"menu",ariaLabel:o}),u.buttonView.set({label:o,icon:fontSizeIcon,tooltip:!0}),u.extendTemplate({attributes:{class:["ck-font-size-dropdown"]}}),u.bind("isEnabled").to(i),this.listenTo(u,"execute",h=>{e.execute(h.source.commandName,{value:h.source.commandParam}),e.editing.view.focus()}),u}),e.ui.componentFactory.add(`menuBar:${FONT_SIZE}`,c=>{const u=new MenuBarMenuView(c);u.buttonView.set({label:o,icon:fontSizeIcon}),u.bind("isEnabled").to(i);const h=new MenuBarMenuListView(c);for(const d of a){const f=new MenuBarMenuListItemView(c,u),m=new MenuBarMenuListItemButtonView(c);m.set({role:"menuitemradio",isToggleable:!0}),m.bind(...Object.keys(d.model)).to(d.model),m.delegate("execute").to(u),m.on("execute",()=>{e.execute(d.model.commandName,{value:d.model.commandParam}),e.editing.view.focus()}),f.children.add(m),h.items.add(f)}return u.panelView.children.add(h),u})}_getLocalizedOptions(){const e=this.editor,t=e.t,r={Default:t("Default"),Tiny:t("Tiny"),Small:t("Small"),Big:t("Big"),Huge:t("Huge")};return normalizeOptions(e.config.get(FONT_SIZE).options).map(o=>{const a=r[o.title];return a&&a!=o.title&&(o=Object.assign({},o,{title:a})),o})}};function _prepareListOptions(e,t){const r=new Collection;for(const i of e){const o={type:"button",model:new Model2({commandName:FONT_SIZE,commandParam:i.model,label:i.title,class:"ck-fontsize-option",role:"menuitemradio",withText:!0})};i.view&&typeof i.view!="string"&&(i.view.styles&&o.model.set("labelStyle",`font-size:${i.view.styles["font-size"]}`),i.view.classes&&o.model.set("class",`${o.model.class} ${i.view.classes}`)),o.model.bind("isOn").to(t,"value",a=>a===i.model),r.add(o)}return r}var FontSize=class extends Plugin{static get requires(){return[FontSizeEditing,FontSizeUI]}static get pluginName(){return"FontSize"}static get isOfficialPlugin(){return!0}normalizeSizeOptions(e){return normalizeOptions(e)}},FontColorCommand=class extends FontCommand{constructor(e){super(e,FONT_COLOR)}},FontColorEditing=class extends Plugin{static get pluginName(){return"FontColorEditing"}static get isOfficialPlugin(){return!0}constructor(e){super(e),e.config.define(FONT_COLOR,{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),e.conversion.for("upcast").elementToAttribute({view:{name:"span",styles:{color:/[\s\S]+/}},model:{key:FONT_COLOR,value:renderUpcastAttribute("color")}}),e.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{color:/^#?\w+$/}},model:{key:FONT_COLOR,value:t=>t.getAttribute("color")}}),e.conversion.for("downcast").attributeToElement({model:FONT_COLOR,view:renderDowncastElement("color")}),e.commands.add(FONT_COLOR,new FontColorCommand(e)),e.model.schema.extend("$text",{allowAttributes:FONT_COLOR}),e.model.schema.setAttributeProperties(FONT_COLOR,{isFormatting:!0,copyOnEnter:!0})}},ColorUI=class extends Plugin{commandName;componentName;icon;dropdownLabel;columns;constructor(e,{commandName:t,componentName:r,icon:i,dropdownLabel:o}){super(e),this.commandName=t,this.componentName=r,this.icon=i,this.dropdownLabel=o,this.columns=e.config.get(`${this.componentName}.columns`)}init(){const e=this.editor,t=e.locale,r=t.t,i=e.commands.get(this.commandName),o=e.config.get(this.componentName),a=normalizeColorOptions(o.colors),c=getLocalizedColorOptions(t,a),u=o.documentColors,h=o.colorPicker!==!1;e.ui.componentFactory.add(this.componentName,d=>{const f=createDropdown(d);let m=!1;const g=addColorSelectorToDropdown({dropdownView:f,colors:c.map(v=>({label:v.label,color:v.model,options:{hasBorder:v.hasBorder}})),columns:this.columns,removeButtonLabel:r("Remove color"),colorPickerLabel:r("Color picker"),documentColorsLabel:u!==0?r("Document colors"):"",documentColorsCount:u===void 0?this.columns:u,colorPickerViewConfig:h?o.colorPicker||{}:!1});return g.bind("selectedColor").to(i,"value"),f.buttonView.set({label:this.dropdownLabel,icon:this.icon,tooltip:!0}),f.extendTemplate({attributes:{class:"ck-color-ui-dropdown"}}),f.bind("isEnabled").to(i),g.on("execute",(v,_)=>{f.isOpen&&e.execute(this.commandName,{value:_.value,batch:this._undoStepBatch}),_.source!=="colorPicker"&&e.editing.view.focus(),_.source==="colorPickerSaveButton"&&(f.isOpen=!1)}),g.on("colorPicker:show",()=>{this._undoStepBatch=e.model.createBatch()}),g.on("colorPicker:cancel",()=>{this._undoStepBatch.operations.length&&(f.isOpen=!1,e.execute("undo",this._undoStepBatch)),e.editing.view.focus()}),f.on("change:isOpen",(v,_,b)=>{m||(m=!0,f.colorSelectorView.appendUI()),b&&(u!==0&&g.updateDocumentColors(e.model,this.componentName),g.updateSelectedColors(),g.showColorGridsFragment())}),focusChildOnDropdownOpen(f,()=>f.colorSelectorView.colorGridsFragmentView.staticColorsGrid.items.find(v=>v.isOn)),f}),e.ui.componentFactory.add(`menuBar:${this.componentName}`,d=>{const f=new MenuBarMenuView(d);f.buttonView.set({label:this.dropdownLabel,icon:this.icon}),f.bind("isEnabled").to(i);let m=!1;const g=new ColorSelectorView(d,{colors:c.map(v=>({label:v.label,color:v.model,options:{hasBorder:v.hasBorder}})),columns:this.columns,removeButtonLabel:r("Remove color"),colorPickerLabel:r("Color picker"),documentColorsLabel:u!==0?r("Document colors"):"",documentColorsCount:u===void 0?this.columns:u,colorPickerViewConfig:!1});return g.bind("selectedColor").to(i,"value"),g.delegate("execute").to(f),g.on("execute",(v,_)=>{e.execute(this.commandName,{value:_.value,batch:this._undoStepBatch}),e.editing.view.focus()}),f.on("change:isOpen",(v,_,b)=>{m||(m=!0,g.appendUI()),b&&(u!==0&&g.updateDocumentColors(e.model,this.componentName),g.updateSelectedColors(),g.showColorGridsFragment())}),f.panelView.children.add(g),f})}},fontColorIcon='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.4 10.3 10 4.5l-2.4 5.8h4.8zm.5 1.2H7.1L5.7 15H4.2l5-12h1.6l5 12h-1.5L13 11.5zm3.1 7H4a1 1 0 0 1 0-2h12a1 1 0 0 1 0 2z"/></svg>',FontColorUI=class extends ColorUI{constructor(e){const t=e.locale.t;super(e,{commandName:FONT_COLOR,componentName:FONT_COLOR,icon:fontColorIcon,dropdownLabel:t("Font Color")})}static get pluginName(){return"FontColorUI"}},FontColor=class extends Plugin{static get requires(){return[FontColorEditing,FontColorUI]}static get pluginName(){return"FontColor"}static get isOfficialPlugin(){return!0}},FontBackgroundColorCommand=class extends FontCommand{constructor(e){super(e,FONT_BACKGROUND_COLOR)}},FontBackgroundColorEditing=class extends Plugin{static get pluginName(){return"FontBackgroundColorEditing"}static get isOfficialPlugin(){return!0}constructor(e){super(e),e.config.define(FONT_BACKGROUND_COLOR,{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),e.data.addStyleProcessorRules(addBackgroundRules),e.conversion.for("upcast").elementToAttribute({view:{name:"span",styles:{"background-color":/[\s\S]+/}},model:{key:FONT_BACKGROUND_COLOR,value:renderUpcastAttribute("background-color")}}),e.conversion.for("downcast").attributeToElement({model:FONT_BACKGROUND_COLOR,view:renderDowncastElement("background-color")}),e.commands.add(FONT_BACKGROUND_COLOR,new FontBackgroundColorCommand(e)),e.model.schema.extend("$text",{allowAttributes:FONT_BACKGROUND_COLOR}),e.model.schema.setAttributeProperties(FONT_BACKGROUND_COLOR,{isFormatting:!0,copyOnEnter:!0})}},fontBackgroundColorIcon='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M4 2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2zm8.38 9.262H7.62L10 5.506l2.38 5.756zm.532 1.285L14.34 16h1.426L10.804 4H9.196L4.234 16H5.66l1.428-3.453h5.824z"/></svg>',FontBackgroundColorUI=class extends ColorUI{constructor(e){const t=e.locale.t;super(e,{commandName:FONT_BACKGROUND_COLOR,componentName:FONT_BACKGROUND_COLOR,icon:fontBackgroundColorIcon,dropdownLabel:t("Font Background Color")})}static get pluginName(){return"FontBackgroundColorUI"}},FontBackgroundColor=class extends Plugin{static get requires(){return[FontBackgroundColorEditing,FontBackgroundColorUI]}static get pluginName(){return"FontBackgroundColor"}static get isOfficialPlugin(){return!0}},Font=class extends Plugin{static get requires(){return[FontFamily,FontSize,FontColor,FontBackgroundColor]}static get pluginName(){return"Font"}static get isOfficialPlugin(){return!0}},ParagraphCommand=class extends Command{constructor(e){super(e),this._isEnabledBasedOnSelection=!1}refresh(){const e=this.editor.model,t=e.document,r=first(t.selection.getSelectedBlocks());this.value=!!r&&r.is("element","paragraph"),this.isEnabled=!!r&&checkCanBecomeParagraph(r,e.schema)}execute(e={}){const t=this.editor.model,r=t.document,i=e.selection||r.selection;t.canEditAt(i)&&t.change(o=>{const a=i.getSelectedBlocks();for(const c of a)!c.is("element","paragraph")&&checkCanBecomeParagraph(c,t.schema)&&o.rename(c,"paragraph")})}};function checkCanBecomeParagraph(e,t){return t.checkChild(e.parent,"paragraph")&&!t.isObject(e)}var InsertParagraphCommand=class extends Command{constructor(e){super(e),this._isEnabledBasedOnSelection=!1}execute(e){const t=this.editor.model,r=e.attributes;let i=e.position;return t.canEditAt(i)?t.change(o=>{if(i=this._findPositionToInsertParagraph(i,o),!i)return null;const a=o.createElement("paragraph");return r&&t.schema.setAllowedAttributes(a,r,o),t.insertContent(a,i),o.setSelection(a,"in"),o.createPositionAt(a,0)}):null}_findPositionToInsertParagraph(e,t){const r=this.editor.model;if(r.schema.checkChild(e,"paragraph"))return e;const i=r.schema.findAllowedParent(e,"paragraph");if(!i)return null;const o=e.parent,a=r.schema.checkChild(o,"$text");return o.isEmpty||a&&e.isAtEnd?r.createPositionAfter(o):!o.isEmpty&&a&&e.isAtStart?r.createPositionBefore(o):t.split(e,i).position}},Paragraph=class xs extends Plugin{static get pluginName(){return"Paragraph"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,r=t.model;t.commands.add("paragraph",new ParagraphCommand(t)),t.commands.add("insertParagraph",new InsertParagraphCommand(t)),r.schema.register("paragraph",{inheritAllFrom:"$block"}),t.conversion.elementToElement({model:"paragraph",view:"p"}),t.conversion.for("upcast").elementToElement({model:(i,{writer:o})=>!xs.paragraphLikeElements.has(i.name)||i.isEmpty?null:o.createElement("paragraph"),view:/.+/,converterPriority:"low"})}static paragraphLikeElements=new Set(["blockquote","dd","div","dt","h1","h2","h3","h4","h5","h6","li","p","td","th"])},IMAGE_URL_REGEXP=new RegExp(String(/^(http(s)?:\/\/)?[\w-]+\.[\w.~:/[\]@!$&'()*+,;=%-]+/.source+/\.(jpg|jpeg|png|gif|ico|webp|JPG|JPEG|PNG|GIF|ICO|WEBP)/.source+/(\?[\w.~:/[\]@!$&'()*+,;=%-]*)?/.source+/(#[\w.~:/[\]@!$&'()*+,;=%-]*)?$/.source)),URL_REG_EXP=new RegExp("(^|\\s)(((?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(((?!www\\.)|(www\\.))(?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.)+(?:[a-z\\u00a1-\\uffff]{2,63})))(?::\\d{2,5})?(?:[/?#]\\S*)?)|((www.|(\\S+@))((?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.))+(?:[a-z\\u00a1-\\uffff]{2,63})))$","i"),LIST_STYLE_TO_LIST_TYPE={},LIST_STYLE_TO_TYPE_ATTRIBUTE={},TYPE_ATTRIBUTE_TO_LIST_STYLE={},LIST_STYLE_TYPES=[{listStyle:"disc",typeAttribute:"disc",listType:"bulleted"},{listStyle:"circle",typeAttribute:"circle",listType:"bulleted"},{listStyle:"square",typeAttribute:"square",listType:"bulleted"},{listStyle:"decimal",typeAttribute:"1",listType:"numbered"},{listStyle:"decimal-leading-zero",typeAttribute:null,listType:"numbered"},{listStyle:"lower-roman",typeAttribute:"i",listType:"numbered"},{listStyle:"upper-roman",typeAttribute:"I",listType:"numbered"},{listStyle:"lower-alpha",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-alpha",typeAttribute:"A",listType:"numbered"},{listStyle:"lower-latin",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-latin",typeAttribute:"A",listType:"numbered"}];for(const{listStyle:e,typeAttribute:t,listType:r}of LIST_STYLE_TYPES)LIST_STYLE_TO_LIST_TYPE[e]=r,LIST_STYLE_TO_TYPE_ATTRIBUTE[e]=t,t&&(TYPE_ATTRIBUTE_TO_LIST_STYLE[t]=e);function getDefaults(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}var defaults3=getDefaults();function changeDefaults(e){defaults3=e}var escapeTest=/[&<>"']/,escapeReplace=/[&<>"']/g,escapeTestNoEncode=/[<>"']|&(?!#?\w+;)/,escapeReplaceNoEncode=/[<>"']|&(?!#?\w+;)/g,escapeReplacements={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},getEscapeReplacement=e=>escapeReplacements[e];function escape(e,t){if(t){if(escapeTest.test(e))return e.replace(escapeReplace,getEscapeReplacement)}else if(escapeTestNoEncode.test(e))return e.replace(escapeReplaceNoEncode,getEscapeReplacement);return e}var unescapeTest=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function unescape(e){return e.replace(unescapeTest,(t,r)=>(r=r.toLowerCase(),r==="colon"?":":r.charAt(0)==="#"?r.charAt(1)==="x"?String.fromCharCode(parseInt(r.substring(2),16)):String.fromCharCode(+r.substring(1)):""))}var caret=/(^|[^\[])\^/g;function edit(e,t){e=e.source||e,t=t||"";const r={replace:(i,o)=>(o=o.source||o,o=o.replace(caret,"$1"),e=e.replace(i,o),r),getRegex:()=>new RegExp(e,t)};return r}var nonWordAndColonTest=/[^\w:]/g,originIndependentUrl=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function cleanUrl(e,t,r){if(e){let i;try{i=decodeURIComponent(unescape(r)).replace(nonWordAndColonTest,"").toLowerCase()}catch{return null}if(i.indexOf("javascript:")===0||i.indexOf("vbscript:")===0||i.indexOf("data:")===0)return null}t&&!originIndependentUrl.test(r)&&(r=resolveUrl(t,r));try{r=encodeURI(r).replace(/%25/g,"%")}catch{return null}return r}var baseUrls={},justDomain=/^[^:]+:\/*[^/]*$/,protocol=/^([^:]+:)[\s\S]*$/,domain=/^([^:]+:\/*[^/]*)[\s\S]*$/;function resolveUrl(e,t){baseUrls[" "+e]||(justDomain.test(e)?baseUrls[" "+e]=e+"/":baseUrls[" "+e]=rtrim(e,"/",!0)),e=baseUrls[" "+e];const r=e.indexOf(":")===-1;return t.substring(0,2)==="//"?r?t:e.replace(protocol,"$1")+t:t.charAt(0)==="/"?r?t:e.replace(domain,"$1")+t:e+t}var noopTest={exec:function(){}};function merge3(e){let t=1,r,i;for(;t<arguments.length;t++){r=arguments[t];for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}function splitCells(e,t){const r=e.replace(/\|/g,(a,c,u)=>{let h=!1,d=c;for(;--d>=0&&u[d]==="\\";)h=!h;return h?"|":" |"}),i=r.split(/ \|/);let o=0;if(i[0].trim()||i.shift(),i.length>0&&!i[i.length-1].trim()&&i.pop(),i.length>t)i.splice(t);else for(;i.length<t;)i.push("");for(;o<i.length;o++)i[o]=i[o].trim().replace(/\\\|/g,"|");return i}function rtrim(e,t,r){const i=e.length;if(i===0)return"";let o=0;for(;o<i;){const a=e.charAt(i-o-1);if(a===t&&!r)o++;else if(a!==t&&r)o++;else break}return e.substr(0,i-o)}function findClosingBracket(e,t){if(e.indexOf(t[1])===-1)return-1;const r=e.length;let i=0,o=0;for(;o<r;o++)if(e[o]==="\\")o++;else if(e[o]===t[0])i++;else if(e[o]===t[1]&&(i--,i<0))return o;return-1}function checkSanitizeDeprecation(e){e&&e.sanitize&&!e.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function repeatString(e,t){if(t<1)return"";let r="";for(;t>1;)t&1&&(r+=e),t>>=1,e+=e;return r+e}function outputLink(e,t,r,i){const o=t.href,a=t.title?escape(t.title):null,c=e[1].replace(/\\([\[\]])/g,"$1");if(e[0].charAt(0)!=="!"){i.state.inLink=!0;const u={type:"link",raw:r,href:o,title:a,text:c,tokens:i.inlineTokens(c,[])};return i.state.inLink=!1,u}else return{type:"image",raw:r,href:o,title:a,text:escape(c)}}function indentCodeCompensation(e,t){const r=e.match(/^(\s+)(?:```)/);if(r===null)return t;const i=r[1];return t.split(`
`).map(o=>{const a=o.match(/^\s+/);if(a===null)return o;const[c]=a;return c.length>=i.length?o.slice(i.length):o}).join(`
`)}var Tokenizer=class{constructor(e){this.options=e||defaults3}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const r=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?r:rtrim(r,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const r=t[0],i=indentCodeCompensation(r,t[3]||"");return{type:"code",raw:r,lang:t[2]?t[2].trim():t[2],text:i}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let r=t[2].trim();if(/#$/.test(r)){const o=rtrim(r,"#");(this.options.pedantic||!o||/ $/.test(o))&&(r=o.trim())}const i={type:"heading",raw:t[0],depth:t[1].length,text:r,tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const r=t[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:t[0],tokens:this.lexer.blockTokens(r,[]),text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let r,i,o,a,c,u,h,d,f,m,g,v,_=t[1].trim();const b=_.length>1,S={type:"list",raw:"",ordered:b,start:b?+_.slice(0,-1):"",loose:!1,items:[]};_=b?`\\d{1,9}\\${_.slice(-1)}`:`\\${_}`,this.options.pedantic&&(_=b?_:"[*+-]");const R=new RegExp(`^( {0,3}${_})((?: [^\\n]*)?(?:\\n|$))`);for(;e&&(v=!1,!(!(t=R.exec(e))||this.rules.block.hr.test(e)));){if(r=t[0],e=e.substring(r.length),d=t[2].split(`
`,1)[0],f=e.split(`
`,1)[0],this.options.pedantic?(a=2,g=d.trimLeft()):(a=t[2].search(/[^ ]/),a=a>4?1:a,g=d.slice(a),a+=t[1].length),u=!1,!d&&/^ *$/.test(f)&&(r+=f+`
`,e=e.substring(f.length+1),v=!0),!v){const I=new RegExp(`^ {0,${Math.min(3,a-1)}}(?:[*+-]|\\d{1,9}[.)])`);for(;e&&(m=e.split(`
`,1)[0],d=m,this.options.pedantic&&(d=d.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!I.test(d));){if(d.search(/[^ ]/)>=a||!d.trim())g+=`
`+d.slice(a);else if(!u)g+=`
`+d;else break;!u&&!d.trim()&&(u=!0),r+=m+`
`,e=e.substring(m.length+1)}}S.loose||(h?S.loose=!0:/\n *\n *$/.test(r)&&(h=!0)),this.options.gfm&&(i=/^\[[ xX]\] /.exec(g),i&&(o=i[0]!=="[ ] ",g=g.replace(/^\[[ xX]\] +/,""))),S.items.push({type:"list_item",raw:r,task:!!i,checked:o,loose:!1,text:g}),S.raw+=r}S.items[S.items.length-1].raw=r.trimRight(),S.items[S.items.length-1].text=g.trimRight(),S.raw=S.raw.trimRight();const A=S.items.length;for(c=0;c<A;c++){this.lexer.state.top=!1,S.items[c].tokens=this.lexer.blockTokens(S.items[c].text,[]);const I=S.items[c].tokens.filter(O=>O.type==="space"),E=I.every(O=>{const P=O.raw.split("");let L=0;for(const V of P)if(V===`
`&&(L+=1),L>1)return!0;return!1});!S.loose&&I.length&&E&&(S.loose=!0,S.items[c].loose=!0)}return S}}html(e){const t=this.rules.block.html.exec(e);if(t){const r={type:"html",raw:t[0],pre:!this.options.sanitizer&&(t[1]==="pre"||t[1]==="script"||t[1]==="style"),text:t[0]};return this.options.sanitize&&(r.type="paragraph",r.text=this.options.sanitizer?this.options.sanitizer(t[0]):escape(t[0]),r.tokens=[],this.lexer.inline(r.text,r.tokens)),r}}def(e){const t=this.rules.block.def.exec(e);if(t)return t[3]&&(t[3]=t[3].substring(1,t[3].length-1)),{type:"def",tag:t[1].toLowerCase().replace(/\s+/g," "),raw:t[0],href:t[2],title:t[3]}}table(e){const t=this.rules.block.table.exec(e);if(t){const r={type:"table",header:splitCells(t[1]).map(i=>({text:i})),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(r.header.length===r.align.length){r.raw=t[0];let i=r.align.length,o,a,c,u;for(o=0;o<i;o++)/^ *-+: *$/.test(r.align[o])?r.align[o]="right":/^ *:-+: *$/.test(r.align[o])?r.align[o]="center":/^ *:-+ *$/.test(r.align[o])?r.align[o]="left":r.align[o]=null;for(i=r.rows.length,o=0;o<i;o++)r.rows[o]=splitCells(r.rows[o],r.header.length).map(h=>({text:h}));for(i=r.header.length,a=0;a<i;a++)r.header[a].tokens=[],this.lexer.inlineTokens(r.header[a].text,r.header[a].tokens);for(i=r.rows.length,a=0;a<i;a++)for(u=r.rows[a],c=0;c<u.length;c++)u[c].tokens=[],this.lexer.inlineTokens(u[c].text,u[c].tokens);return r}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t){const r={type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:[]};return this.lexer.inline(r.text,r.tokens),r}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const r={type:"paragraph",raw:t[0],text:t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1],tokens:[]};return this.lexer.inline(r.text,r.tokens),r}}text(e){const t=this.rules.block.text.exec(e);if(t){const r={type:"text",raw:t[0],text:t[0],tokens:[]};return this.lexer.inline(r.text,r.tokens),r}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:escape(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):escape(t[0]):t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const r=t[2].trim();if(!this.options.pedantic&&/^</.test(r)){if(!/>$/.test(r))return;const a=rtrim(r.slice(0,-1),"\\");if((r.length-a.length)%2===0)return}else{const a=findClosingBracket(t[2],"()");if(a>-1){const u=(t[0].indexOf("!")===0?5:4)+t[1].length+a;t[2]=t[2].substring(0,a),t[0]=t[0].substring(0,u).trim(),t[3]=""}}let i=t[2],o="";if(this.options.pedantic){const a=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i);a&&(i=a[1],o=a[3])}else o=t[3]?t[3].slice(1,-1):"";return i=i.trim(),/^</.test(i)&&(this.options.pedantic&&!/>$/.test(r)?i=i.slice(1):i=i.slice(1,-1)),outputLink(t,{href:i&&i.replace(this.rules.inline._escapes,"$1"),title:o&&o.replace(this.rules.inline._escapes,"$1")},t[0],this.lexer)}}reflink(e,t){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){let i=(r[2]||r[1]).replace(/\s+/g," ");if(i=t[i.toLowerCase()],!i||!i.href){const o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return outputLink(r,i,r[0],this.lexer)}}emStrong(e,t,r=""){let i=this.rules.inline.emStrong.lDelim.exec(e);if(!i||i[3]&&r.match(/[\p{L}\p{N}]/u))return;const o=i[1]||i[2]||"";if(!o||o&&(r===""||this.rules.inline.punctuation.exec(r))){const a=i[0].length-1;let c,u,h=a,d=0;const f=i[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(f.lastIndex=0,t=t.slice(-1*e.length+a);(i=f.exec(t))!=null;){if(c=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!c)continue;if(u=c.length,i[3]||i[4]){h+=u;continue}else if((i[5]||i[6])&&a%3&&!((a+u)%3)){d+=u;continue}if(h-=u,h>0)continue;if(u=Math.min(u,u+h+d),Math.min(a,u)%2){const g=e.slice(1,a+i.index+u);return{type:"em",raw:e.slice(0,a+i.index+u+1),text:g,tokens:this.lexer.inlineTokens(g,[])}}const m=e.slice(2,a+i.index+u-1);return{type:"strong",raw:e.slice(0,a+i.index+u+1),text:m,tokens:this.lexer.inlineTokens(m,[])}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let r=t[2].replace(/\n/g," ");const i=/[^ ]/.test(r),o=/^ /.test(r)&&/ $/.test(r);return i&&o&&(r=r.substring(1,r.length-1)),r=escape(r,!0),{type:"codespan",raw:t[0],text:r}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2],[])}}autolink(e,t){const r=this.rules.inline.autolink.exec(e);if(r){let i,o;return r[2]==="@"?(i=escape(this.options.mangle?t(r[1]):r[1]),o="mailto:"+i):(i=escape(r[1]),o=i),{type:"link",raw:r[0],text:i,href:o,tokens:[{type:"text",raw:i,text:i}]}}}url(e,t){let r;if(r=this.rules.inline.url.exec(e)){let i,o;if(r[2]==="@")i=escape(this.options.mangle?t(r[0]):r[0]),o="mailto:"+i;else{let a;do a=r[0],r[0]=this.rules.inline._backpedal.exec(r[0])[0];while(a!==r[0]);i=escape(r[0]),r[1]==="www."?o="http://"+i:o=i}return{type:"link",raw:r[0],text:i,href:o,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e,t){const r=this.rules.inline.text.exec(e);if(r){let i;return this.lexer.state.inRawBlock?i=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):escape(r[0]):r[0]:i=escape(this.options.smartypants?t(r[0]):r[0]),{type:"text",raw:r[0],text:i}}}},block={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)( [^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:noopTest,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};block._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/,block._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,block.def=edit(block.def).replace("label",block._label).replace("title",block._title).getRegex(),block.bullet=/(?:[*+-]|\d{1,9}[.)])/,block.listItemStart=edit(/^( *)(bull) */).replace("bull",block.bullet).getRegex(),block.list=edit(block.list).replace(/bull/g,block.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+block.def.source+")").getRegex(),block._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",block._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,block.html=edit(block.html,"i").replace("comment",block._comment).replace("tag",block._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),block.paragraph=edit(block._paragraph).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex(),block.blockquote=edit(block.blockquote).replace("paragraph",block.paragraph).getRegex(),block.normal=merge3({},block),block.gfm=merge3({},block.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),block.gfm.table=edit(block.gfm.table).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex(),block.gfm.paragraph=edit(block._paragraph).replace("hr",block.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",block.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",block._tag).getRegex(),block.pedantic=merge3({},block.normal,{html:edit(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",block._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:noopTest,paragraph:edit(block.normal._paragraph).replace("hr",block.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",block.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var inline={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:noopTest,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:noopTest,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};inline._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",inline.punctuation=edit(inline.punctuation).replace(/punctuation/g,inline._punctuation).getRegex(),inline.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,inline.escapedEmSt=/\\\*|\\_/g,inline._comment=edit(block._comment).replace("(?:-->|$)","-->").getRegex(),inline.emStrong.lDelim=edit(inline.emStrong.lDelim).replace(/punct/g,inline._punctuation).getRegex(),inline.emStrong.rDelimAst=edit(inline.emStrong.rDelimAst,"g").replace(/punct/g,inline._punctuation).getRegex(),inline.emStrong.rDelimUnd=edit(inline.emStrong.rDelimUnd,"g").replace(/punct/g,inline._punctuation).getRegex(),inline._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,inline._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,inline._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,inline.autolink=edit(inline.autolink).replace("scheme",inline._scheme).replace("email",inline._email).getRegex(),inline._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,inline.tag=edit(inline.tag).replace("comment",inline._comment).replace("attribute",inline._attribute).getRegex(),inline._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,inline._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,inline._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,inline.link=edit(inline.link).replace("label",inline._label).replace("href",inline._href).replace("title",inline._title).getRegex(),inline.reflink=edit(inline.reflink).replace("label",inline._label).replace("ref",block._label).getRegex(),inline.nolink=edit(inline.nolink).replace("ref",block._label).getRegex(),inline.reflinkSearch=edit(inline.reflinkSearch,"g").replace("reflink",inline.reflink).replace("nolink",inline.nolink).getRegex(),inline.normal=merge3({},inline),inline.pedantic=merge3({},inline.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:edit(/^!?\[(label)\]\((.*?)\)/).replace("label",inline._label).getRegex(),reflink:edit(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",inline._label).getRegex()}),inline.gfm=merge3({},inline.normal,{escape:edit(inline.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),inline.gfm.url=edit(inline.gfm.url,"i").replace("email",inline.gfm._extended_email).getRegex(),inline.breaks=merge3({},inline.gfm,{br:edit(inline.br).replace("{2,}","*").getRegex(),text:edit(inline.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});function smartypants(e){return e.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201C").replace(/"/g,"\u201D").replace(/\.{3}/g,"\u2026")}function mangle(e){let t="",r,i;const o=e.length;for(r=0;r<o;r++)i=e.charCodeAt(r),Math.random()>.5&&(i="x"+i.toString(16)),t+="&#"+i+";";return t}var Lexer=class vi{constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||defaults3,this.options.tokenizer=this.options.tokenizer||new Tokenizer,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const r={block:block.normal,inline:inline.normal};this.options.pedantic?(r.block=block.pedantic,r.inline=inline.pedantic):this.options.gfm&&(r.block=block.gfm,this.options.breaks?r.inline=inline.breaks:r.inline=inline.gfm),this.tokenizer.rules=r}static get rules(){return{block,inline}}static lex(t,r){return new vi(r).lex(t)}static lexInline(t,r){return new vi(r).inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,`
`).replace(/\t/g,"    "),this.blockTokens(t,this.tokens);let r;for(;r=this.inlineQueue.shift();)this.inlineTokens(r.src,r.tokens);return this.tokens}blockTokens(t,r=[]){this.options.pedantic&&(t=t.replace(/^ +$/gm,""));let i,o,a,c;for(;t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(u=>(i=u.call({lexer:this},t,r))?(t=t.substring(i.raw.length),r.push(i),!0):!1))){if(i=this.tokenizer.space(t)){t=t.substring(i.raw.length),i.raw.length===1&&r.length>0?r[r.length-1].raw+=`
`:r.push(i);continue}if(i=this.tokenizer.code(t)){t=t.substring(i.raw.length),o=r[r.length-1],o&&(o.type==="paragraph"||o.type==="text")?(o.raw+=`
`+i.raw,o.text+=`
`+i.text,this.inlineQueue[this.inlineQueue.length-1].src=o.text):r.push(i);continue}if(i=this.tokenizer.fences(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.heading(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.hr(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.blockquote(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.list(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.html(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.def(t)){t=t.substring(i.raw.length),o=r[r.length-1],o&&(o.type==="paragraph"||o.type==="text")?(o.raw+=`
`+i.raw,o.text+=`
`+i.raw,this.inlineQueue[this.inlineQueue.length-1].src=o.text):this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title});continue}if(i=this.tokenizer.table(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.lheading(t)){t=t.substring(i.raw.length),r.push(i);continue}if(a=t,this.options.extensions&&this.options.extensions.startBlock){let u=1/0;const h=t.slice(1);let d;this.options.extensions.startBlock.forEach(function(f){d=f.call({lexer:this},h),typeof d=="number"&&d>=0&&(u=Math.min(u,d))}),u<1/0&&u>=0&&(a=t.substring(0,u+1))}if(this.state.top&&(i=this.tokenizer.paragraph(a))){o=r[r.length-1],c&&o.type==="paragraph"?(o.raw+=`
`+i.raw,o.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=o.text):r.push(i),c=a.length!==t.length,t=t.substring(i.raw.length);continue}if(i=this.tokenizer.text(t)){t=t.substring(i.raw.length),o=r[r.length-1],o&&o.type==="text"?(o.raw+=`
`+i.raw,o.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=o.text):r.push(i);continue}if(t){const u="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return this.state.top=!0,r}inline(t,r){this.inlineQueue.push({src:t,tokens:r})}inlineTokens(t,r=[]){let i,o,a,c=t,u,h,d;if(this.tokens.links){const f=Object.keys(this.tokens.links);if(f.length>0)for(;(u=this.tokenizer.rules.inline.reflinkSearch.exec(c))!=null;)f.includes(u[0].slice(u[0].lastIndexOf("[")+1,-1))&&(c=c.slice(0,u.index)+"["+repeatString("a",u[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(u=this.tokenizer.rules.inline.blockSkip.exec(c))!=null;)c=c.slice(0,u.index)+"["+repeatString("a",u[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(u=this.tokenizer.rules.inline.escapedEmSt.exec(c))!=null;)c=c.slice(0,u.index)+"++"+c.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;t;)if(h||(d=""),h=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(f=>(i=f.call({lexer:this},t,r))?(t=t.substring(i.raw.length),r.push(i),!0):!1))){if(i=this.tokenizer.escape(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.tag(t)){t=t.substring(i.raw.length),o=r[r.length-1],o&&i.type==="text"&&o.type==="text"?(o.raw+=i.raw,o.text+=i.text):r.push(i);continue}if(i=this.tokenizer.link(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(i.raw.length),o=r[r.length-1],o&&i.type==="text"&&o.type==="text"?(o.raw+=i.raw,o.text+=i.text):r.push(i);continue}if(i=this.tokenizer.emStrong(t,c,d)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.codespan(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.br(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.del(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.autolink(t,mangle)){t=t.substring(i.raw.length),r.push(i);continue}if(!this.state.inLink&&(i=this.tokenizer.url(t,mangle))){t=t.substring(i.raw.length),r.push(i);continue}if(a=t,this.options.extensions&&this.options.extensions.startInline){let f=1/0;const m=t.slice(1);let g;this.options.extensions.startInline.forEach(function(v){g=v.call({lexer:this},m),typeof g=="number"&&g>=0&&(f=Math.min(f,g))}),f<1/0&&f>=0&&(a=t.substring(0,f+1))}if(i=this.tokenizer.inlineText(a,smartypants)){t=t.substring(i.raw.length),i.raw.slice(-1)!=="_"&&(d=i.raw.slice(-1)),h=!0,o=r[r.length-1],o&&o.type==="text"?(o.raw+=i.raw,o.text+=i.text):r.push(i);continue}if(t){const f="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return r}},Renderer3=class{constructor(e){this.options=e||defaults3}code(e,t,r){const i=(t||"").match(/\S*/)[0];if(this.options.highlight){const o=this.options.highlight(e,i);o!=null&&o!==e&&(r=!0,e=o)}return e=e.replace(/\n$/,"")+`
`,i?'<pre><code class="'+this.options.langPrefix+escape(i,!0)+'">'+(r?e:escape(e,!0))+`</code></pre>
`:"<pre><code>"+(r?e:escape(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
`+e+`</blockquote>
`}html(e){return e}heading(e,t,r,i){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+i.slug(r)+'">'+e+"</h"+t+`>
`:"<h"+t+">"+e+"</h"+t+`>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(e,t,r){const i=t?"ol":"ul",o=t&&r!==1?' start="'+r+'"':"";return"<"+i+o+`>
`+e+"</"+i+`>
`}listitem(e){return"<li>"+e+`</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return"<p>"+e+`</p>
`}table(e,t){return t&&(t="<tbody>"+t+"</tbody>"),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
`+e+`</tr>
`}tablecell(e,t){const r=t.header?"th":"td";return(t.align?"<"+r+' align="'+t.align+'">':"<"+r+">")+e+"</"+r+`>
`}strong(e){return"<strong>"+e+"</strong>"}em(e){return"<em>"+e+"</em>"}codespan(e){return"<code>"+e+"</code>"}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return"<del>"+e+"</del>"}link(e,t,r){if(e=cleanUrl(this.options.sanitize,this.options.baseUrl,e),e===null)return r;let i='<a href="'+escape(e)+'"';return t&&(i+=' title="'+t+'"'),i+=">"+r+"</a>",i}image(e,t,r){if(e=cleanUrl(this.options.sanitize,this.options.baseUrl,e),e===null)return r;let i='<img src="'+e+'" alt="'+r+'"';return t&&(i+=' title="'+t+'"'),i+=this.options.xhtml?"/>":">",i}text(e){return e}},TextRenderer=class{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,r){return""+r}image(e,t,r){return""+r}br(){return""}},Slugger=class{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let r=e,i=0;if(this.seen.hasOwnProperty(r)){i=this.seen[e];do i++,r=e+"-"+i;while(this.seen.hasOwnProperty(r))}return t||(this.seen[e]=i,this.seen[r]=0),r}slug(e,t={}){const r=this.serialize(e);return this.getNextSafeSlug(r,t.dryrun)}},Parser=class wi{constructor(t){this.options=t||defaults3,this.options.renderer=this.options.renderer||new Renderer3,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new TextRenderer,this.slugger=new Slugger}static parse(t,r){return new wi(r).parse(t)}static parseInline(t,r){return new wi(r).parseInline(t)}parse(t,r=!0){let i="",o,a,c,u,h,d,f,m,g,v,_,b,S,R,A,I,E,O,P;const L=t.length;for(o=0;o<L;o++){if(v=t[o],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[v.type]&&(P=this.options.extensions.renderers[v.type].call({parser:this},v),P!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(v.type))){i+=P||"";continue}switch(v.type){case"space":continue;case"hr":{i+=this.renderer.hr();continue}case"heading":{i+=this.renderer.heading(this.parseInline(v.tokens),v.depth,unescape(this.parseInline(v.tokens,this.textRenderer)),this.slugger);continue}case"code":{i+=this.renderer.code(v.text,v.lang,v.escaped);continue}case"table":{for(m="",f="",u=v.header.length,a=0;a<u;a++)f+=this.renderer.tablecell(this.parseInline(v.header[a].tokens),{header:!0,align:v.align[a]});for(m+=this.renderer.tablerow(f),g="",u=v.rows.length,a=0;a<u;a++){for(d=v.rows[a],f="",h=d.length,c=0;c<h;c++)f+=this.renderer.tablecell(this.parseInline(d[c].tokens),{header:!1,align:v.align[c]});g+=this.renderer.tablerow(f)}i+=this.renderer.table(m,g);continue}case"blockquote":{g=this.parse(v.tokens),i+=this.renderer.blockquote(g);continue}case"list":{for(_=v.ordered,b=v.start,S=v.loose,u=v.items.length,g="",a=0;a<u;a++)A=v.items[a],I=A.checked,E=A.task,R="",A.task&&(O=this.renderer.checkbox(I),S?A.tokens.length>0&&A.tokens[0].type==="paragraph"?(A.tokens[0].text=O+" "+A.tokens[0].text,A.tokens[0].tokens&&A.tokens[0].tokens.length>0&&A.tokens[0].tokens[0].type==="text"&&(A.tokens[0].tokens[0].text=O+" "+A.tokens[0].tokens[0].text)):A.tokens.unshift({type:"text",text:O}):R+=O),R+=this.parse(A.tokens,S),g+=this.renderer.listitem(R,E,I);i+=this.renderer.list(g,_,b);continue}case"html":{i+=this.renderer.html(v.text);continue}case"paragraph":{i+=this.renderer.paragraph(this.parseInline(v.tokens));continue}case"text":{for(g=v.tokens?this.parseInline(v.tokens):v.text;o+1<L&&t[o+1].type==="text";)v=t[++o],g+=`
`+(v.tokens?this.parseInline(v.tokens):v.text);i+=r?this.renderer.paragraph(g):g;continue}default:{const V='Token with "'+v.type+'" type was not found.';if(this.options.silent){console.error(V);return}else throw new Error(V)}}}return i}parseInline(t,r){r=r||this.renderer;let i="",o,a,c;const u=t.length;for(o=0;o<u;o++){if(a=t[o],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]&&(c=this.options.extensions.renderers[a.type].call({parser:this},a),c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type))){i+=c||"";continue}switch(a.type){case"escape":{i+=r.text(a.text);break}case"html":{i+=r.html(a.text);break}case"link":{i+=r.link(a.href,a.title,this.parseInline(a.tokens,r));break}case"image":{i+=r.image(a.href,a.title,a.text);break}case"strong":{i+=r.strong(this.parseInline(a.tokens,r));break}case"em":{i+=r.em(this.parseInline(a.tokens,r));break}case"codespan":{i+=r.codespan(a.text);break}case"br":{i+=r.br();break}case"del":{i+=r.del(this.parseInline(a.tokens,r));break}case"text":{i+=r.text(a.text);break}default:{const h='Token with "'+a.type+'" type was not found.';if(this.options.silent){console.error(h);return}else throw new Error(h)}}}return i}};function marked(e,t,r){if(typeof e>"u"||e===null)throw new Error("marked(): input parameter is undefined or null");if(typeof e!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if(typeof t=="function"&&(r=t,t=null),t=merge3({},marked.defaults,t||{}),checkSanitizeDeprecation(t),r){const i=t.highlight;let o;try{o=Lexer.lex(e,t)}catch(u){return r(u)}const a=function(u){let h;if(!u)try{t.walkTokens&&marked.walkTokens(o,t.walkTokens),h=Parser.parse(o,t)}catch(d){u=d}return t.highlight=i,u?r(u):r(null,h)};if(!i||i.length<3||(delete t.highlight,!o.length))return a();let c=0;marked.walkTokens(o,function(u){u.type==="code"&&(c++,setTimeout(()=>{i(u.text,u.lang,function(h,d){if(h)return a(h);d!=null&&d!==u.text&&(u.text=d,u.escaped=!0),c--,c===0&&a()})},0))}),c===0&&a();return}try{const i=Lexer.lex(e,t);return t.walkTokens&&marked.walkTokens(i,t.walkTokens),Parser.parse(i,t)}catch(i){if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,t.silent)return"<p>An error occurred:</p><pre>"+escape(i.message+"",!0)+"</pre>";throw i}}marked.options=marked.setOptions=function(e){return merge3(marked.defaults,e),changeDefaults(marked.defaults),marked},marked.getDefaults=getDefaults,marked.defaults=defaults3,marked.use=function(...e){const t=merge3({},...e),r=marked.defaults.extensions||{renderers:{},childTokens:{}};let i;e.forEach(o=>{if(o.extensions&&(i=!0,o.extensions.forEach(a=>{if(!a.name)throw new Error("extension name required");if(a.renderer){const c=r.renderers?r.renderers[a.name]:null;c?r.renderers[a.name]=function(...u){let h=a.renderer.apply(this,u);return h===!1&&(h=c.apply(this,u)),h}:r.renderers[a.name]=a.renderer}if(a.tokenizer){if(!a.level||a.level!=="block"&&a.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");r[a.level]?r[a.level].unshift(a.tokenizer):r[a.level]=[a.tokenizer],a.start&&(a.level==="block"?r.startBlock?r.startBlock.push(a.start):r.startBlock=[a.start]:a.level==="inline"&&(r.startInline?r.startInline.push(a.start):r.startInline=[a.start]))}a.childTokens&&(r.childTokens[a.name]=a.childTokens)})),o.renderer){const a=marked.defaults.renderer||new Renderer3;for(const c in o.renderer){const u=a[c];a[c]=(...h)=>{let d=o.renderer[c].apply(a,h);return d===!1&&(d=u.apply(a,h)),d}}t.renderer=a}if(o.tokenizer){const a=marked.defaults.tokenizer||new Tokenizer;for(const c in o.tokenizer){const u=a[c];a[c]=(...h)=>{let d=o.tokenizer[c].apply(a,h);return d===!1&&(d=u.apply(a,h)),d}}t.tokenizer=a}if(o.walkTokens){const a=marked.defaults.walkTokens;t.walkTokens=function(c){o.walkTokens.call(this,c),a&&a.call(this,c)}}i&&(t.extensions=r),marked.setOptions(t)})},marked.walkTokens=function(e,t){for(const r of e)switch(t.call(marked,r),r.type){case"table":{for(const i of r.header)marked.walkTokens(i.tokens,t);for(const i of r.rows)for(const o of i)marked.walkTokens(o.tokens,t);break}case"list":{marked.walkTokens(r.items,t);break}default:marked.defaults.extensions&&marked.defaults.extensions.childTokens&&marked.defaults.extensions.childTokens[r.type]?marked.defaults.extensions.childTokens[r.type].forEach(function(i){marked.walkTokens(r[i],t)}):r.tokens&&marked.walkTokens(r.tokens,t)}},marked.parseInline=function(e,t){if(typeof e>"u"||e===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof e!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");t=merge3({},marked.defaults,t||{}),checkSanitizeDeprecation(t);try{const r=Lexer.lexInline(e,t);return t.walkTokens&&marked.walkTokens(r,t.walkTokens),Parser.parseInline(r,t)}catch(r){if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t.silent)return"<p>An error occurred:</p><pre>"+escape(r.message+"",!0)+"</pre>";throw r}},marked.Parser=Parser,marked.parser=Parser.parse,marked.Renderer=Renderer3,marked.TextRenderer=TextRenderer,marked.Lexer=Lexer,marked.lexer=Lexer.lex,marked.Tokenizer=Tokenizer,marked.Slugger=Slugger,marked.parse=marked;var options=marked.options,setOptions=marked.setOptions,use=marked.use,walkTokens=marked.walkTokens,parseInline=marked.parseInline,parser=Parser.parse,lexer=Lexer.lex;function extend4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e}function repeat(e,t){return Array(t+1).join(e)}function trimLeadingNewlines(e){return e.replace(/^\n*/,"")}function trimTrailingNewlines(e){for(var t=e.length;t>0&&e[t-1]===`
`;)t--;return e.substring(0,t)}var blockElements=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"];function isBlock(e){return is(e,blockElements)}var voidElements=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function isVoid(e){return is(e,voidElements)}function hasVoid(e){return has(e,voidElements)}var meaningfulWhenBlankElements=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function isMeaningfulWhenBlank(e){return is(e,meaningfulWhenBlankElements)}function hasMeaningfulWhenBlank(e){return has(e,meaningfulWhenBlankElements)}function is(e,t){return t.indexOf(e.nodeName)>=0}function has(e,t){return e.getElementsByTagName&&t.some(function(r){return e.getElementsByTagName(r).length})}var rules={};rules.paragraph={filter:"p",replacement:function(e){return`

`+e+`

`}},rules.lineBreak={filter:"br",replacement:function(e,t,r){return r.br+`
`}},rules.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(e,t,r){var i=Number(t.nodeName.charAt(1));if(r.headingStyle==="setext"&&i<3){var o=repeat(i===1?"=":"-",e.length);return`

`+e+`
`+o+`

`}else return`

`+repeat("#",i)+" "+e+`

`}},rules.blockquote={filter:"blockquote",replacement:function(e){return e=e.replace(/^\n+|\n+$/g,""),e=e.replace(/^/gm,"> "),`

`+e+`

`}},rules.list={filter:["ul","ol"],replacement:function(e,t){var r=t.parentNode;return r.nodeName==="LI"&&r.lastElementChild===t?`
`+e:`

`+e+`

`}},rules.listItem={filter:"li",replacement:function(e,t,r){e=e.replace(/^\n+/,"").replace(/\n+$/,`
`).replace(/\n/gm,`
    `);var i=r.bulletListMarker+"   ",o=t.parentNode;if(o.nodeName==="OL"){var a=o.getAttribute("start"),c=Array.prototype.indexOf.call(o.children,t);i=(a?Number(a)+c:c+1)+".  "}return i+e+(t.nextSibling&&!/\n$/.test(e)?`
`:"")}},rules.indentedCodeBlock={filter:function(e,t){return t.codeBlockStyle==="indented"&&e.nodeName==="PRE"&&e.firstChild&&e.firstChild.nodeName==="CODE"},replacement:function(e,t,r){return`

    `+t.firstChild.textContent.replace(/\n/g,`
    `)+`

`}},rules.fencedCodeBlock={filter:function(e,t){return t.codeBlockStyle==="fenced"&&e.nodeName==="PRE"&&e.firstChild&&e.firstChild.nodeName==="CODE"},replacement:function(e,t,r){for(var i=t.firstChild.getAttribute("class")||"",o=(i.match(/language-(\S+)/)||[null,""])[1],a=t.firstChild.textContent,c=r.fence.charAt(0),u=3,h=new RegExp("^"+c+"{3,}","gm"),d;d=h.exec(a);)d[0].length>=u&&(u=d[0].length+1);var f=repeat(c,u);return`

`+f+o+`
`+a.replace(/\n$/,"")+`
`+f+`

`}},rules.horizontalRule={filter:"hr",replacement:function(e,t,r){return`

`+r.hr+`

`}},rules.inlineLink={filter:function(e,t){return t.linkStyle==="inlined"&&e.nodeName==="A"&&e.getAttribute("href")},replacement:function(e,t){var r=t.getAttribute("href");r&&(r=r.replace(/([()])/g,"\\$1"));var i=cleanAttribute(t.getAttribute("title"));return i&&(i=' "'+i.replace(/"/g,'\\"')+'"'),"["+e+"]("+r+i+")"}},rules.referenceLink={filter:function(e,t){return t.linkStyle==="referenced"&&e.nodeName==="A"&&e.getAttribute("href")},replacement:function(e,t,r){var i=t.getAttribute("href"),o=cleanAttribute(t.getAttribute("title"));o&&(o=' "'+o+'"');var a,c;switch(r.linkReferenceStyle){case"collapsed":a="["+e+"][]",c="["+e+"]: "+i+o;break;case"shortcut":a="["+e+"]",c="["+e+"]: "+i+o;break;default:var u=this.references.length+1;a="["+e+"]["+u+"]",c="["+u+"]: "+i+o}return this.references.push(c),a},references:[],append:function(e){var t="";return this.references.length&&(t=`

`+this.references.join(`
`)+`

`,this.references=[]),t}},rules.emphasis={filter:["em","i"],replacement:function(e,t,r){return e.trim()?r.emDelimiter+e+r.emDelimiter:""}},rules.strong={filter:["strong","b"],replacement:function(e,t,r){return e.trim()?r.strongDelimiter+e+r.strongDelimiter:""}},rules.code={filter:function(e){var t=e.previousSibling||e.nextSibling,r=e.parentNode.nodeName==="PRE"&&!t;return e.nodeName==="CODE"&&!r},replacement:function(e){if(!e)return"";e=e.replace(/\r?\n|\r/g," ");for(var t=/^`|^ .*?[^ ].* $|`$/.test(e)?" ":"",r="`",i=e.match(/`+/gm)||[];i.indexOf(r)!==-1;)r=r+"`";return r+t+e+t+r}},rules.image={filter:"img",replacement:function(e,t){var r=cleanAttribute(t.getAttribute("alt")),i=t.getAttribute("src")||"",o=cleanAttribute(t.getAttribute("title")),a=o?' "'+o+'"':"";return i?"!["+r+"]("+i+a+")":""}};function cleanAttribute(e){return e?e.replace(/(\n+\s*)+/g,`
`):""}function Rules(e){this.options=e,this._keep=[],this._remove=[],this.blankRule={replacement:e.blankReplacement},this.keepReplacement=e.keepReplacement,this.defaultRule={replacement:e.defaultReplacement},this.array=[];for(var t in e.rules)this.array.push(e.rules[t])}Rules.prototype={add:function(e,t){this.array.unshift(t)},keep:function(e){this._keep.unshift({filter:e,replacement:this.keepReplacement})},remove:function(e){this._remove.unshift({filter:e,replacement:function(){return""}})},forNode:function(e){if(e.isBlank)return this.blankRule;var t;return(t=findRule(this.array,e,this.options))||(t=findRule(this._keep,e,this.options))||(t=findRule(this._remove,e,this.options))?t:this.defaultRule},forEach:function(e){for(var t=0;t<this.array.length;t++)e(this.array[t],t)}};function findRule(e,t,r){for(var i=0;i<e.length;i++){var o=e[i];if(filterValue(o,t,r))return o}}function filterValue(e,t,r){var i=e.filter;if(typeof i=="string"){if(i===t.nodeName.toLowerCase())return!0}else if(Array.isArray(i)){if(i.indexOf(t.nodeName.toLowerCase())>-1)return!0}else if(typeof i=="function"){if(i.call(e,t,r))return!0}else throw new TypeError("`filter` needs to be a string, array, or function")}function collapseWhitespace(e){var t=e.element,r=e.isBlock,i=e.isVoid,o=e.isPre||function(m){return m.nodeName==="PRE"};if(!(!t.firstChild||o(t))){for(var a=null,c=!1,u=null,h=next(u,t,o);h!==t;){if(h.nodeType===3||h.nodeType===4){var d=h.data.replace(/[ \r\n\t]+/g," ");if((!a||/ $/.test(a.data))&&!c&&d[0]===" "&&(d=d.substr(1)),!d){h=remove5(h);continue}h.data=d,a=h}else if(h.nodeType===1)r(h)||h.nodeName==="BR"?(a&&(a.data=a.data.replace(/ $/,"")),a=null,c=!1):i(h)||o(h)?(a=null,c=!0):a&&(c=!1);else{h=remove5(h);continue}var f=next(u,h,o);u=h,h=f}a&&(a.data=a.data.replace(/ $/,""),a.data||remove5(a))}}function remove5(e){var t=e.nextSibling||e.parentNode;return e.parentNode.removeChild(e),t}function next(e,t,r){return e&&e.parentNode===t||r(t)?t.nextSibling||t.parentNode:t.firstChild||t.nextSibling||t.parentNode}var root3=typeof window<"u"?window:{};function canParseHTMLNatively(){var e=root3.DOMParser,t=!1;try{new e().parseFromString("","text/html")&&(t=!0)}catch{}return t}function createHTMLParser(){var e=function(){};return shouldUseActiveX()?e.prototype.parseFromString=function(t){var r=new window.ActiveXObject("htmlfile");return r.designMode="on",r.open(),r.write(t),r.close(),r}:e.prototype.parseFromString=function(t){var r=document.implementation.createHTMLDocument("");return r.open(),r.write(t),r.close(),r},e}function shouldUseActiveX(){var e=!1;try{document.implementation.createHTMLDocument("").open()}catch{root3.ActiveXObject&&(e=!0)}return e}var HTMLParser=canParseHTMLNatively()?root3.DOMParser:createHTMLParser();function RootNode(e,t){var r;if(typeof e=="string"){var i=htmlParser().parseFromString('<x-turndown id="turndown-root">'+e+"</x-turndown>","text/html");r=i.getElementById("turndown-root")}else r=e.cloneNode(!0);return collapseWhitespace({element:r,isBlock,isVoid,isPre:t.preformattedCode?isPreOrCode:null}),r}var _htmlParser;function htmlParser(){return _htmlParser=_htmlParser||new HTMLParser,_htmlParser}function isPreOrCode(e){return e.nodeName==="PRE"||e.nodeName==="CODE"}function Node4(e,t){return e.isBlock=isBlock(e),e.isCode=e.nodeName==="CODE"||e.parentNode.isCode,e.isBlank=isBlank(e),e.flankingWhitespace=flankingWhitespace(e,t),e}function isBlank(e){return!isVoid(e)&&!isMeaningfulWhenBlank(e)&&/^\s*$/i.test(e.textContent)&&!hasVoid(e)&&!hasMeaningfulWhenBlank(e)}function flankingWhitespace(e,t){if(e.isBlock||t.preformattedCode&&e.isCode)return{leading:"",trailing:""};var r=edgeWhitespace(e.textContent);return r.leadingAscii&&isFlankedByWhitespace("left",e,t)&&(r.leading=r.leadingNonAscii),r.trailingAscii&&isFlankedByWhitespace("right",e,t)&&(r.trailing=r.trailingNonAscii),{leading:r.leading,trailing:r.trailing}}function edgeWhitespace(e){var t=e.match(/^(([ \t\r\n]*)(\s*))(?:(?=\S)[\s\S]*\S)?((\s*?)([ \t\r\n]*))$/);return{leading:t[1],leadingAscii:t[2],leadingNonAscii:t[3],trailing:t[4],trailingNonAscii:t[5],trailingAscii:t[6]}}function isFlankedByWhitespace(e,t,r){var i,o,a;return e==="left"?(i=t.previousSibling,o=/ $/):(i=t.nextSibling,o=/^ /),i&&(i.nodeType===3?a=o.test(i.nodeValue):r.preformattedCode&&i.nodeName==="CODE"?a=!1:i.nodeType===1&&!isBlock(i)&&(a=o.test(i.textContent))),a}var reduce=Array.prototype.reduce,escapes=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function TurndownService(e){if(!(this instanceof TurndownService))return new TurndownService(e);var t={rules,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function(r,i){return i.isBlock?`

`:""},keepReplacement:function(r,i){return i.isBlock?`

`+i.outerHTML+`

`:i.outerHTML},defaultReplacement:function(r,i){return i.isBlock?`

`+r+`

`:r}};this.options=extend4({},t,e),this.rules=new Rules(this.options)}TurndownService.prototype={turndown:function(e){if(!canConvert(e))throw new TypeError(e+" is not a string, or an element/document/fragment node.");if(e==="")return"";var t=process3.call(this,new RootNode(e,this.options));return postProcess.call(this,t)},use:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)this.use(e[t]);else if(typeof e=="function")e(this);else throw new TypeError("plugin must be a Function or an Array of Functions");return this},addRule:function(e,t){return this.rules.add(e,t),this},keep:function(e){return this.rules.keep(e),this},remove:function(e){return this.rules.remove(e),this},escape:function(e){return escapes.reduce(function(t,r){return t.replace(r[0],r[1])},e)}};function process3(e){var t=this;return reduce.call(e.childNodes,function(r,i){i=new Node4(i,t.options);var o="";return i.nodeType===3?o=i.isCode?i.nodeValue:t.escape(i.nodeValue):i.nodeType===1&&(o=replacementForNode.call(t,i)),join(r,o)},"")}function postProcess(e){var t=this;return this.rules.forEach(function(r){typeof r.append=="function"&&(e=join(e,r.append(t.options)))}),e.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function replacementForNode(e){var t=this.rules.forNode(e),r=process3.call(this,e),i=e.flankingWhitespace;return(i.leading||i.trailing)&&(r=r.trim()),i.leading+t.replacement(r,e,this.options)+i.trailing}function join(e,t){var r=trimTrailingNewlines(e),i=trimLeadingNewlines(t),o=Math.max(e.length-r.length,t.length-i.length),a=`

`.substring(0,o);return r+a+i}function canConvert(e){return e!=null&&(typeof e=="string"||e.nodeType&&(e.nodeType===1||e.nodeType===9||e.nodeType===11))}var indexOf2=Array.prototype.indexOf,every=Array.prototype.every,rules2={};rules2.tableCell={filter:["th","td"],replacement:function(e,t){return cell(e,t)}},rules2.tableRow={filter:"tr",replacement:function(e,t){var r="",i={left:":--",right:"--:",center:":-:"};if(isHeadingRow(t))for(var o=0;o<t.childNodes.length;o++){var a="---",c=(t.childNodes[o].getAttribute("align")||"").toLowerCase();c&&(a=i[c]||a),r+=cell(a,t.childNodes[o])}return`
`+e+(r?`
`+r:"")}},rules2.table={filter:function(e){return e.nodeName==="TABLE"&&isHeadingRow(e.rows[0])},replacement:function(e){return e=e.replace(`

`,`
`),`

`+e+`

`}},rules2.tableSection={filter:["thead","tbody","tfoot"],replacement:function(e){return e}};function isHeadingRow(e){var t=e.parentNode;return t.nodeName==="THEAD"||t.firstChild===e&&(t.nodeName==="TABLE"||isFirstTbody(t))&&every.call(e.childNodes,function(r){return r.nodeName==="TH"})}function isFirstTbody(e){var t=e.previousSibling;return e.nodeName==="TBODY"&&(!t||t.nodeName==="THEAD"&&/^\s*$/i.test(t.textContent))}function cell(e,t){var r=indexOf2.call(t.parentNode.childNodes,t),i=" ";return r===0&&(i="| "),i+e+" |"}var autolinkRegex=new RegExp(/\b(?:(?:https?|ftp):\/\/|www\.)/.source+/(?![-_])(?:[-_a-z0-9\u00a1-\uffff]{1,63}\.)+(?:[a-z\u00a1-\uffff]{2,63})/.source+/(?:[^\s<>]*)/.source,"gi"),defaultHandledKeyCodes=[keyCodes.arrowup,keyCodes.arrowdown,keyCodes.esc],defaultCommitKeyCodes=[keyCodes.enter,keyCodes.tab],niceErrors={0:"Invalid value for configuration 'enforceActions', expected 'never', 'always' or 'observed'",1:function(t,r){return"Cannot apply '"+t+"' to '"+r.toString()+"': Field not found."},5:"'keys()' can only be used on observable objects, arrays, sets and maps",6:"'values()' can only be used on observable objects, arrays, sets and maps",7:"'entries()' can only be used on observable objects, arrays and maps",8:"'set()' can only be used on observable objects, arrays and maps",9:"'remove()' can only be used on observable objects, arrays and maps",10:"'has()' can only be used on observable objects, arrays and maps",11:"'get()' can only be used on observable objects, arrays and maps",12:"Invalid annotation",13:"Dynamic observable objects cannot be frozen. If you're passing observables to 3rd party component/function that calls Object.freeze, pass copy instead: toJS(observable)",14:"Intercept handlers should return nothing or a change object",15:"Observable arrays cannot be frozen. If you're passing observables to 3rd party component/function that calls Object.freeze, pass copy instead: toJS(observable)",16:"Modification exception: the internal structure of an observable array was changed.",17:function(t,r){return"[mobx.array] Index out of bounds, "+t+" is larger than "+r},18:"mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js",19:function(t){return"Cannot initialize from classes that inherit from Map: "+t.constructor.name},20:function(t){return"Cannot initialize map from "+t},21:function(t){return"Cannot convert to map from '"+t+"'"},22:"mobx.set requires Set polyfill for the current browser. Check babel-polyfill or core-js/es6/set.js",23:"It is not possible to get index atoms from arrays",24:function(t){return"Cannot obtain administration from "+t},25:function(t,r){return"the entry '"+t+"' does not exist in the observable map '"+r+"'"},26:"please specify a property",27:function(t,r){return"no observable property '"+t.toString()+"' found on the observable object '"+r+"'"},28:function(t){return"Cannot obtain atom from "+t},29:"Expecting some object",30:"invalid action stack. did you forget to finish an action?",31:"missing option for computed: get",32:function(t,r){return"Cycle detected in computation "+t+": "+r},33:function(t){return"The setter of computed value '"+t+"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?"},34:function(t){return"[ComputedValue '"+t+"'] It is not possible to assign a new value to a computed value."},35:"There are multiple, different versions of MobX active. Make sure MobX is loaded only once or use `configure({ isolateGlobalState: true })`",36:"isolateGlobalState should be called before MobX is running any reactions",37:function(t){return"[mobx] `observableArray."+t+"()` mutates the array in-place, which is not allowed inside a derivation. Use `array.slice()."+t+"()` instead"},38:"'ownKeys()' can only be used on observable objects",39:"'defineProperty()' can only be used on observable objects"},errors=niceErrors;function die(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];var o=typeof e=="string"?e:errors[e];throw typeof o=="function"&&(o=o.apply(null,r)),new Error("[MobX] "+o)}var mockGlobal={};function getGlobal(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:mockGlobal}var assign=Object.assign,getDescriptor=Object.getOwnPropertyDescriptor,defineProperty2=Object.defineProperty,objectPrototype=Object.prototype,EMPTY_ARRAY=[];Object.freeze(EMPTY_ARRAY);var EMPTY_OBJECT={};Object.freeze(EMPTY_OBJECT);var hasProxy=typeof Proxy<"u",plainObjectString=Object.toString();function assertProxies(){hasProxy||die("`Proxy` objects are not available in the current environment. Please configure MobX to enable a fallback implementation.`")}function warnAboutProxyRequirement(e){globalState.verifyProxies&&die("MobX is currently configured to be able to run in ES5 mode, but in ES5 MobX won't be able to "+e)}function getNextId(){return++globalState.mobxGuid}function once(e){var t=!1;return function(){if(!t)return t=!0,e.apply(this,arguments)}}var noop3=function(){};function isFunction4(e){return typeof e=="function"}function isStringish(e){var t=typeof e;switch(t){case"string":case"symbol":case"number":return!0}return!1}function isObject5(e){return e!==null&&typeof e=="object"}function isPlainObject2(e){if(!isObject5(e))return!1;var t=Object.getPrototypeOf(e);if(t==null)return!0;var r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r.toString()===plainObjectString}function isGenerator(e){var t=e?.constructor;return t?t.name==="GeneratorFunction"||t.displayName==="GeneratorFunction":!1}function addHiddenProp(e,t,r){defineProperty2(e,t,{enumerable:!1,writable:!0,configurable:!0,value:r})}function addHiddenFinalProp(e,t,r){defineProperty2(e,t,{enumerable:!1,writable:!1,configurable:!0,value:r})}function createInstanceofPredicate(e,t){var r="isMobX"+e;return t.prototype[r]=!0,function(i){return isObject5(i)&&i[r]===!0}}function isES6Map(e){return e!=null&&Object.prototype.toString.call(e)==="[object Map]"}function isPlainES6Map(e){var t=Object.getPrototypeOf(e),r=Object.getPrototypeOf(t),i=Object.getPrototypeOf(r);return i===null}function isES6Set(e){return e!=null&&Object.prototype.toString.call(e)==="[object Set]"}var hasGetOwnPropertySymbols=typeof Object.getOwnPropertySymbols<"u";function getPlainObjectKeys(e){var t=Object.keys(e);if(!hasGetOwnPropertySymbols)return t;var r=Object.getOwnPropertySymbols(e);return r.length?[].concat(t,r.filter(function(i){return objectPrototype.propertyIsEnumerable.call(e,i)})):t}var ownKeys=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:hasGetOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames;function stringifyKey(e){return typeof e=="string"?e:typeof e=="symbol"?e.toString():new String(e).toString()}function toPrimitive(e){return e===null?null:typeof e=="object"?""+e:e}function hasProp(e,t){return objectPrototype.hasOwnProperty.call(e,t)}var getOwnPropertyDescriptors=Object.getOwnPropertyDescriptors||function(t){var r={};return ownKeys(t).forEach(function(i){r[i]=getDescriptor(t,i)}),r};function getFlag(e,t){return!!(e&t)}function setFlag(e,t,r){return r?e|=t:e&=~t,e}function _arrayLikeToArray(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey121(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _createForOfIteratorHelperLoose(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)({}).hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},_extends.apply(null,arguments)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},_setPrototypeOf(e,t)}function _toPrimitive121(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _toPropertyKey121(e){var t=_toPrimitive121(e,"string");return typeof t=="symbol"?t:t+""}function _unsupportedIterableToArray(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}var storedAnnotationsSymbol=Symbol("mobx-stored-annotations");function createDecoratorAnnotation(e){function t(r,i){if(is20223Decorator(i))return e.decorate_20223_(r,i);storeAnnotation(r,i,e)}return Object.assign(t,e)}function storeAnnotation(e,t,r){if(hasProp(e,storedAnnotationsSymbol)||addHiddenProp(e,storedAnnotationsSymbol,_extends({},e[storedAnnotationsSymbol])),isOverride(r)&&!hasProp(e[storedAnnotationsSymbol],t)){var i=e.constructor.name+".prototype."+t.toString();die("'"+i+"' is decorated with 'override', but no such decorated member was found on prototype.")}assertNotDecorated(e,r,t),isOverride(r)||(e[storedAnnotationsSymbol][t]=r)}function assertNotDecorated(e,t,r){if(!isOverride(t)&&hasProp(e[storedAnnotationsSymbol],r)){var i=e.constructor.name+".prototype."+r.toString(),o=e[storedAnnotationsSymbol][r].annotationType_,a=t.annotationType_;die("Cannot apply '@"+a+"' to '"+i+"':"+(`
The field is already decorated with '@`+o+"'.")+`
Re-decorating fields is not allowed.
Use '@override' decorator for methods overridden by subclass.`)}}function collectStoredAnnotations(e){return hasProp(e,storedAnnotationsSymbol)||addHiddenProp(e,storedAnnotationsSymbol,_extends({},e[storedAnnotationsSymbol])),e[storedAnnotationsSymbol]}function is20223Decorator(e){return typeof e=="object"&&typeof e.kind=="string"}function assert20223DecoratorType(e,t){t.includes(e.kind)||die("The decorator applied to '"+String(e.name)+"' cannot be used on a "+e.kind+" element")}var $mobx=Symbol("mobx administration"),Atom=function(){function e(r){r===void 0&&(r="Atom@"+getNextId()),this.name_=void 0,this.flags_=0,this.observers_=new Set,this.lastAccessedBy_=0,this.lowestObserverState_=IDerivationState_.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=r}var t=e.prototype;return t.onBO=function(){this.onBOL&&this.onBOL.forEach(function(i){return i()})},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(i){return i()})},t.reportObserved=function(){return reportObserved(this)},t.reportChanged=function(){startBatch(),propagateChanged(this),endBatch()},t.toString=function(){return this.name_},_createClass(e,[{key:"isBeingObserved",get:function(){return getFlag(this.flags_,e.isBeingObservedMask_)},set:function(i){this.flags_=setFlag(this.flags_,e.isBeingObservedMask_,i)}},{key:"isPendingUnobservation",get:function(){return getFlag(this.flags_,e.isPendingUnobservationMask_)},set:function(i){this.flags_=setFlag(this.flags_,e.isPendingUnobservationMask_,i)}},{key:"diffValue",get:function(){return getFlag(this.flags_,e.diffValueMask_)?1:0},set:function(i){this.flags_=setFlag(this.flags_,e.diffValueMask_,i===1)}}])}();Atom.isBeingObservedMask_=1,Atom.isPendingUnobservationMask_=2,Atom.diffValueMask_=4;var isAtom=createInstanceofPredicate("Atom",Atom);function createAtom(e,t,r){t===void 0&&(t=noop3),r===void 0&&(r=noop3);var i=new Atom(e);return t!==noop3&&onBecomeObserved(i,t),r!==noop3&&onBecomeUnobserved(i,r),i}function identityComparer(e,t){return e===t}function structuralComparer(e,t){return deepEqual(e,t)}function shallowComparer(e,t){return deepEqual(e,t,1)}function defaultComparer(e,t){return Object.is?Object.is(e,t):e===t?e!==0||1/e===1/t:e!==e&&t!==t}var comparer={identity:identityComparer,structural:structuralComparer,default:defaultComparer,shallow:shallowComparer};function deepEnhancer(e,t,r){return isObservable(e)?e:Array.isArray(e)?observable.array(e,{name:r}):isPlainObject2(e)?observable.object(e,void 0,{name:r}):isES6Map(e)?observable.map(e,{name:r}):isES6Set(e)?observable.set(e,{name:r}):typeof e=="function"&&!isAction(e)&&!isFlow(e)?isGenerator(e)?flow(e):autoAction(r,e):e}function shallowEnhancer(e,t,r){if(e==null||isObservableObject(e)||isObservableArray(e)||isObservableMap(e)||isObservableSet(e))return e;if(Array.isArray(e))return observable.array(e,{name:r,deep:!1});if(isPlainObject2(e))return observable.object(e,void 0,{name:r,deep:!1});if(isES6Map(e))return observable.map(e,{name:r,deep:!1});if(isES6Set(e))return observable.set(e,{name:r,deep:!1});die("The shallow modifier / decorator can only used in combination with arrays, objects, maps and sets")}function referenceEnhancer(e){return e}function refStructEnhancer(e,t){return isObservable(e)&&die("observable.struct should not be used with observable values"),deepEqual(e,t)?t:e}var OVERRIDE="override";function isOverride(e){return e.annotationType_===OVERRIDE}function createActionAnnotation(e,t){return{annotationType_:e,options_:t,make_:make_$1,extend_:extend_$1,decorate_20223_:decorate_20223_$1}}function make_$1(e,t,r,i){var o;if((o=this.options_)!=null&&o.bound)return this.extend_(e,t,r,!1)===null?0:1;if(i===e.target_)return this.extend_(e,t,r,!1)===null?0:2;if(isAction(r.value))return 1;var a=createActionDescriptor(e,this,t,r,!1);return defineProperty2(i,t,a),2}function extend_$1(e,t,r,i){var o=createActionDescriptor(e,this,t,r);return e.defineProperty_(t,o,i)}function decorate_20223_$1(e,t){assert20223DecoratorType(t,["method","field"]);var r=t.kind,i=t.name,o=t.addInitializer,a=this,c=function(d){var f,m,g,v;return createAction((f=(m=a.options_)==null?void 0:m.name)!=null?f:i.toString(),d,(g=(v=a.options_)==null?void 0:v.autoAction)!=null?g:!1)};if(r=="field")return function(h){var d,f=h;return isAction(f)||(f=c(f)),(d=a.options_)!=null&&d.bound&&(f=f.bind(this),f.isMobxAction=!0),f};if(r=="method"){var u;return isAction(e)||(e=c(e)),(u=this.options_)!=null&&u.bound&&o(function(){var h=this,d=h[i].bind(h);d.isMobxAction=!0,h[i]=d}),e}die("Cannot apply '"+a.annotationType_+"' to '"+String(i)+"' (kind: "+r+"):"+(`
'`+a.annotationType_+"' can only be used on properties with a function value."))}function assertActionDescriptor(e,t,r,i){var o=t.annotationType_,a=i.value;isFunction4(a)||die("Cannot apply '"+o+"' to '"+e.name_+"."+r.toString()+"':"+(`
'`+o+"' can only be used on properties with a function value."))}function createActionDescriptor(e,t,r,i,o){var a,c,u,h,d,f,m;o===void 0&&(o=globalState.safeDescriptors),assertActionDescriptor(e,t,r,i);var g=i.value;if((a=t.options_)!=null&&a.bound){var v;g=g.bind((v=e.proxy_)!=null?v:e.target_)}return{value:createAction((c=(u=t.options_)==null?void 0:u.name)!=null?c:r.toString(),g,(h=(d=t.options_)==null?void 0:d.autoAction)!=null?h:!1,(f=t.options_)!=null&&f.bound?(m=e.proxy_)!=null?m:e.target_:void 0),configurable:o?e.isPlainObject_:!0,enumerable:!1,writable:!o}}function createFlowAnnotation(e,t){return{annotationType_:e,options_:t,make_:make_$2,extend_:extend_$2,decorate_20223_:decorate_20223_$2}}function make_$2(e,t,r,i){var o;if(i===e.target_)return this.extend_(e,t,r,!1)===null?0:2;if((o=this.options_)!=null&&o.bound&&(!hasProp(e.target_,t)||!isFlow(e.target_[t]))&&this.extend_(e,t,r,!1)===null)return 0;if(isFlow(r.value))return 1;var a=createFlowDescriptor(e,this,t,r,!1,!1);return defineProperty2(i,t,a),2}function extend_$2(e,t,r,i){var o,a=createFlowDescriptor(e,this,t,r,(o=this.options_)==null?void 0:o.bound);return e.defineProperty_(t,a,i)}function decorate_20223_$2(e,t){var r;assert20223DecoratorType(t,["method"]);var i=t.name,o=t.addInitializer;return isFlow(e)||(e=flow(e)),(r=this.options_)!=null&&r.bound&&o(function(){var a=this,c=a[i].bind(a);c.isMobXFlow=!0,a[i]=c}),e}function assertFlowDescriptor(e,t,r,i){var o=t.annotationType_,a=i.value;isFunction4(a)||die("Cannot apply '"+o+"' to '"+e.name_+"."+r.toString()+"':"+(`
'`+o+"' can only be used on properties with a generator function value."))}function createFlowDescriptor(e,t,r,i,o,a){a===void 0&&(a=globalState.safeDescriptors),assertFlowDescriptor(e,t,r,i);var c=i.value;if(isFlow(c)||(c=flow(c)),o){var u;c=c.bind((u=e.proxy_)!=null?u:e.target_),c.isMobXFlow=!0}return{value:c,configurable:a?e.isPlainObject_:!0,enumerable:!1,writable:!a}}function createComputedAnnotation(e,t){return{annotationType_:e,options_:t,make_:make_$3,extend_:extend_$3,decorate_20223_:decorate_20223_$3}}function make_$3(e,t,r){return this.extend_(e,t,r,!1)===null?0:1}function extend_$3(e,t,r,i){return assertComputedDescriptor(e,this,t,r),e.defineComputedProperty_(t,_extends({},this.options_,{get:r.get,set:r.set}),i)}function decorate_20223_$3(e,t){assert20223DecoratorType(t,["getter"]);var r=this,i=t.name,o=t.addInitializer;return o(function(){var a=asObservableObject(this)[$mobx],c=_extends({},r.options_,{get:e,context:this});c.name||(c.name=a.name_+"."+i.toString()),a.values_.set(i,new ComputedValue(c))}),function(){return this[$mobx].getObservablePropValue_(i)}}function assertComputedDescriptor(e,t,r,i){var o=t.annotationType_,a=i.get;a||die("Cannot apply '"+o+"' to '"+e.name_+"."+r.toString()+"':"+(`
'`+o+"' can only be used on getter(+setter) properties."))}function createObservableAnnotation(e,t){return{annotationType_:e,options_:t,make_:make_$4,extend_:extend_$4,decorate_20223_:decorate_20223_$4}}function make_$4(e,t,r){return this.extend_(e,t,r,!1)===null?0:1}function extend_$4(e,t,r,i){var o,a;return assertObservableDescriptor(e,this,t,r),e.defineObservableProperty_(t,r.value,(o=(a=this.options_)==null?void 0:a.enhancer)!=null?o:deepEnhancer,i)}function decorate_20223_$4(e,t){if(t.kind==="field")throw die("Please use `@observable accessor "+String(t.name)+"` instead of `@observable "+String(t.name)+"`");assert20223DecoratorType(t,["accessor"]);var r=this,i=t.kind,o=t.name,a=new WeakSet;function c(u,h){var d,f,m=asObservableObject(u)[$mobx],g=new ObservableValue(h,(d=(f=r.options_)==null?void 0:f.enhancer)!=null?d:deepEnhancer,m.name_+"."+o.toString(),!1);m.values_.set(o,g),a.add(u)}if(i=="accessor")return{get:function(){return a.has(this)||c(this,e.get.call(this)),this[$mobx].getObservablePropValue_(o)},set:function(h){return a.has(this)||c(this,h),this[$mobx].setObservablePropValue_(o,h)},init:function(h){return a.has(this)||c(this,h),h}}}function assertObservableDescriptor(e,t,r,i){var o=t.annotationType_;"value"in i||die("Cannot apply '"+o+"' to '"+e.name_+"."+r.toString()+"':"+(`
'`+o+"' cannot be used on getter/setter properties"))}var AUTO="true",autoAnnotation=createAutoAnnotation();function createAutoAnnotation(e){return{annotationType_:AUTO,options_:e,make_:make_$5,extend_:extend_$5,decorate_20223_:decorate_20223_$5}}function make_$5(e,t,r,i){var o,a;if(r.get)return computed.make_(e,t,r,i);if(r.set){var c=createAction(t.toString(),r.set);return i===e.target_?e.defineProperty_(t,{configurable:globalState.safeDescriptors?e.isPlainObject_:!0,set:c})===null?0:2:(defineProperty2(i,t,{configurable:!0,set:c}),2)}if(i!==e.target_&&typeof r.value=="function"){var u;if(isGenerator(r.value)){var h,d=(h=this.options_)!=null&&h.autoBind?flow.bound:flow;return d.make_(e,t,r,i)}var f=(u=this.options_)!=null&&u.autoBind?autoAction.bound:autoAction;return f.make_(e,t,r,i)}var m=((o=this.options_)==null?void 0:o.deep)===!1?observable.ref:observable;if(typeof r.value=="function"&&(a=this.options_)!=null&&a.autoBind){var g;r.value=r.value.bind((g=e.proxy_)!=null?g:e.target_)}return m.make_(e,t,r,i)}function extend_$5(e,t,r,i){var o,a;if(r.get)return computed.extend_(e,t,r,i);if(r.set)return e.defineProperty_(t,{configurable:globalState.safeDescriptors?e.isPlainObject_:!0,set:createAction(t.toString(),r.set)},i);if(typeof r.value=="function"&&(o=this.options_)!=null&&o.autoBind){var c;r.value=r.value.bind((c=e.proxy_)!=null?c:e.target_)}var u=((a=this.options_)==null?void 0:a.deep)===!1?observable.ref:observable;return u.extend_(e,t,r,i)}function decorate_20223_$5(e,t){die("'"+this.annotationType_+"' cannot be used as a decorator")}var OBSERVABLE="observable",OBSERVABLE_REF="observable.ref",OBSERVABLE_SHALLOW="observable.shallow",OBSERVABLE_STRUCT="observable.struct",defaultCreateObservableOptions={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(defaultCreateObservableOptions);function asCreateObservableOptions(e){return e||defaultCreateObservableOptions}var observableAnnotation=createObservableAnnotation(OBSERVABLE),observableRefAnnotation=createObservableAnnotation(OBSERVABLE_REF,{enhancer:referenceEnhancer}),observableShallowAnnotation=createObservableAnnotation(OBSERVABLE_SHALLOW,{enhancer:shallowEnhancer}),observableStructAnnotation=createObservableAnnotation(OBSERVABLE_STRUCT,{enhancer:refStructEnhancer}),observableDecoratorAnnotation=createDecoratorAnnotation(observableAnnotation);function getEnhancerFromOptions(e){return e.deep===!0?deepEnhancer:e.deep===!1?referenceEnhancer:getEnhancerFromAnnotation(e.defaultDecorator)}function getAnnotationFromOptions(e){var t;return e?(t=e.defaultDecorator)!=null?t:createAutoAnnotation(e):void 0}function getEnhancerFromAnnotation(e){var t,r;return e&&(t=(r=e.options_)==null?void 0:r.enhancer)!=null?t:deepEnhancer}function createObservable(e,t,r){if(is20223Decorator(t))return observableAnnotation.decorate_20223_(e,t);if(isStringish(t)){storeAnnotation(e,t,observableAnnotation);return}return isObservable(e)?e:isPlainObject2(e)?observable.object(e,t,r):Array.isArray(e)?observable.array(e,t):isES6Map(e)?observable.map(e,t):isES6Set(e)?observable.set(e,t):typeof e=="object"&&e!==null?e:observable.box(e,t)}assign(createObservable,observableDecoratorAnnotation);var observableFactories={box:function(t,r){var i=asCreateObservableOptions(r);return new ObservableValue(t,getEnhancerFromOptions(i),i.name,!0,i.equals)},array:function(t,r){var i=asCreateObservableOptions(r);return(globalState.useProxies===!1||i.proxy===!1?createLegacyArray:createObservableArray)(t,getEnhancerFromOptions(i),i.name)},map:function(t,r){var i=asCreateObservableOptions(r);return new ObservableMap(t,getEnhancerFromOptions(i),i.name)},set:function(t,r){var i=asCreateObservableOptions(r);return new ObservableSet(t,getEnhancerFromOptions(i),i.name)},object:function(t,r,i){return initObservable2(function(){return extendObservable(globalState.useProxies===!1||i?.proxy===!1?asObservableObject({},i):asDynamicObservableObject({},i),t,r)})},ref:createDecoratorAnnotation(observableRefAnnotation),shallow:createDecoratorAnnotation(observableShallowAnnotation),deep:observableDecoratorAnnotation,struct:createDecoratorAnnotation(observableStructAnnotation)},observable=assign(createObservable,observableFactories),COMPUTED="computed",COMPUTED_STRUCT="computed.struct",computedAnnotation=createComputedAnnotation(COMPUTED),computedStructAnnotation=createComputedAnnotation(COMPUTED_STRUCT,{equals:comparer.structural}),computed=function(t,r){if(is20223Decorator(r))return computedAnnotation.decorate_20223_(t,r);if(isStringish(r))return storeAnnotation(t,r,computedAnnotation);if(isPlainObject2(t))return createDecoratorAnnotation(createComputedAnnotation(COMPUTED,t));isFunction4(t)||die("First argument to `computed` should be an expression."),isFunction4(r)&&die("A setter as second argument is no longer supported, use `{ set: fn }` option instead");var i=isPlainObject2(r)?r:{};return i.get=t,i.name||(i.name=t.name||""),new ComputedValue(i)};Object.assign(computed,computedAnnotation),computed.struct=createDecoratorAnnotation(computedStructAnnotation);var _getDescriptor$config,_getDescriptor,currentActionId=0,nextActionId=1,isFunctionNameConfigurable=(_getDescriptor$config=(_getDescriptor=getDescriptor(function(){},"name"))==null?void 0:_getDescriptor.configurable)!=null?_getDescriptor$config:!1,tmpNameDescriptor={value:"action",configurable:!0,writable:!1,enumerable:!1};function createAction(e,t,r,i){r===void 0&&(r=!1),isFunction4(t)||die("`action` can only be invoked on functions"),(typeof e!="string"||!e)&&die("actions should have valid names, got: '"+e+"'");function o(){return executeAction(e,r,t,i||this,arguments)}return o.isMobxAction=!0,o.toString=function(){return t.toString()},isFunctionNameConfigurable&&(tmpNameDescriptor.value=e,defineProperty2(o,"name",tmpNameDescriptor)),o}function executeAction(e,t,r,i,o){var a=_startAction(e,t,i,o);try{return r.apply(i,o)}catch(c){throw a.error_=c,c}finally{_endAction(a)}}function _startAction(e,t,r,i){var o=isSpyEnabled()&&!!e,a=0;if(o){a=Date.now();var c=i?Array.from(i):EMPTY_ARRAY;spyReportStart({type:ACTION,name:e,object:r,arguments:c})}var u=globalState.trackingDerivation,h=!t||!u;startBatch();var d=globalState.allowStateChanges;h&&(untrackedStart(),d=allowStateChangesStart(!0));var f=allowStateReadsStart(!0),m={runAsAction_:h,prevDerivation_:u,prevAllowStateChanges_:d,prevAllowStateReads_:f,notifySpy_:o,startTime_:a,actionId_:nextActionId++,parentActionId_:currentActionId};return currentActionId=m.actionId_,m}function _endAction(e){currentActionId!==e.actionId_&&die(30),currentActionId=e.parentActionId_,e.error_!==void 0&&(globalState.suppressReactionErrors=!0),allowStateChangesEnd(e.prevAllowStateChanges_),allowStateReadsEnd(e.prevAllowStateReads_),endBatch(),e.runAsAction_&&untrackedEnd(e.prevDerivation_),e.notifySpy_&&spyReportEnd({time:Date.now()-e.startTime_}),globalState.suppressReactionErrors=!1}function allowStateChangesStart(e){var t=globalState.allowStateChanges;return globalState.allowStateChanges=e,t}function allowStateChangesEnd(e){globalState.allowStateChanges=e}var CREATE="create",ObservableValue=function(e){function t(i,o,a,c,u){var h;return a===void 0&&(a="ObservableValue@"+getNextId()),c===void 0&&(c=!0),u===void 0&&(u=comparer.default),h=e.call(this,a)||this,h.enhancer=void 0,h.name_=void 0,h.equals=void 0,h.hasUnreportedChange_=!1,h.interceptors_=void 0,h.changeListeners_=void 0,h.value_=void 0,h.dehancer=void 0,h.enhancer=o,h.name_=a,h.equals=u,h.value_=o(i,void 0,a),c&&isSpyEnabled()&&spyReport({type:CREATE,object:h,observableKind:"value",debugObjectName:h.name_,newValue:""+h.value_}),h}_inheritsLoose(t,e);var r=t.prototype;return r.dehanceValue=function(o){return this.dehancer!==void 0?this.dehancer(o):o},r.set=function(o){var a=this.value_;if(o=this.prepareNewValue_(o),o!==globalState.UNCHANGED){var c=isSpyEnabled();c&&spyReportStart({type:UPDATE,object:this,observableKind:"value",debugObjectName:this.name_,newValue:o,oldValue:a}),this.setNewValue_(o),c&&spyReportEnd()}},r.prepareNewValue_=function(o){if(checkIfStateModificationsAreAllowed(this),hasInterceptors(this)){var a=interceptChange(this,{object:this,type:UPDATE,newValue:o});if(!a)return globalState.UNCHANGED;o=a.newValue}return o=this.enhancer(o,this.value_,this.name_),this.equals(this.value_,o)?globalState.UNCHANGED:o},r.setNewValue_=function(o){var a=this.value_;this.value_=o,this.reportChanged(),hasListeners(this)&&notifyListeners(this,{type:UPDATE,object:this,newValue:o,oldValue:a})},r.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},r.intercept_=function(o){return registerInterceptor(this,o)},r.observe_=function(o,a){return a&&o({observableKind:"value",debugObjectName:this.name_,object:this,type:UPDATE,newValue:this.value_,oldValue:void 0}),registerListener(this,o)},r.raw=function(){return this.value_},r.toJSON=function(){return this.get()},r.toString=function(){return this.name_+"["+this.value_+"]"},r.valueOf=function(){return toPrimitive(this.get())},r[Symbol.toPrimitive]=function(){return this.valueOf()},t}(Atom),ComputedValue=function(){function e(r){this.dependenciesState_=IDerivationState_.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.observers_=new Set,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=IDerivationState_.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new CaughtException(null),this.name_=void 0,this.triggeredBy_=void 0,this.flags_=0,this.derivation=void 0,this.setter_=void 0,this.isTracing_=TraceMode.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,r.get||die(31),this.derivation=r.get,this.name_=r.name||"ComputedValue@"+getNextId(),r.set&&(this.setter_=createAction(this.name_+"-setter",r.set)),this.equals_=r.equals||(r.compareStructural||r.struct?comparer.structural:comparer.default),this.scope_=r.context,this.requiresReaction_=r.requiresReaction,this.keepAlive_=!!r.keepAlive}var t=e.prototype;return t.onBecomeStale_=function(){propagateMaybeChanged(this)},t.onBO=function(){this.onBOL&&this.onBOL.forEach(function(i){return i()})},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(i){return i()})},t.get=function(){if(this.isComputing&&die(32,this.name_,this.derivation),globalState.inBatch===0&&this.observers_.size===0&&!this.keepAlive_)shouldCompute(this)&&(this.warnAboutUntrackedRead_(),startBatch(),this.value_=this.computeValue_(!1),endBatch());else if(reportObserved(this),shouldCompute(this)){var i=globalState.trackingContext;this.keepAlive_&&!i&&(globalState.trackingContext=this),this.trackAndCompute()&&propagateChangeConfirmed(this),globalState.trackingContext=i}var o=this.value_;if(isCaughtException(o))throw o.cause;return o},t.set=function(i){if(this.setter_){this.isRunningSetter&&die(33,this.name_),this.isRunningSetter=!0;try{this.setter_.call(this.scope_,i)}finally{this.isRunningSetter=!1}}else die(34,this.name_)},t.trackAndCompute=function(){var i=this.value_,o=this.dependenciesState_===IDerivationState_.NOT_TRACKING_,a=this.computeValue_(!0),c=o||isCaughtException(i)||isCaughtException(a)||!this.equals_(i,a);return c&&(this.value_=a,isSpyEnabled()&&spyReport({observableKind:"computed",debugObjectName:this.name_,object:this.scope_,type:"update",oldValue:i,newValue:a})),c},t.computeValue_=function(i){this.isComputing=!0;var o=allowStateChangesStart(!1),a;if(i)a=trackDerivedFunction(this,this.derivation,this.scope_);else if(globalState.disableErrorBoundaries===!0)a=this.derivation.call(this.scope_);else try{a=this.derivation.call(this.scope_)}catch(c){a=new CaughtException(c)}return allowStateChangesEnd(o),this.isComputing=!1,a},t.suspend_=function(){this.keepAlive_||(clearObserving(this),this.value_=void 0,this.isTracing_!==TraceMode.NONE&&console.log("[mobx.trace] Computed value '"+this.name_+"' was suspended and it will recompute on the next access."))},t.observe_=function(i,o){var a=this,c=!0,u=void 0;return autorun(function(){var h=a.get();if(!c||o){var d=untrackedStart();i({observableKind:"computed",debugObjectName:a.name_,type:UPDATE,object:a,newValue:h,oldValue:u}),untrackedEnd(d)}c=!1,u=h})},t.warnAboutUntrackedRead_=function(){this.isTracing_!==TraceMode.NONE&&console.log("[mobx.trace] Computed value '"+this.name_+"' is being read outside a reactive context. Doing a full recompute."),(typeof this.requiresReaction_=="boolean"?this.requiresReaction_:globalState.computedRequiresReaction)&&console.warn("[mobx] Computed value '"+this.name_+"' is being read outside a reactive context. Doing a full recompute.")},t.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},t.valueOf=function(){return toPrimitive(this.get())},t[Symbol.toPrimitive]=function(){return this.valueOf()},_createClass(e,[{key:"isComputing",get:function(){return getFlag(this.flags_,e.isComputingMask_)},set:function(i){this.flags_=setFlag(this.flags_,e.isComputingMask_,i)}},{key:"isRunningSetter",get:function(){return getFlag(this.flags_,e.isRunningSetterMask_)},set:function(i){this.flags_=setFlag(this.flags_,e.isRunningSetterMask_,i)}},{key:"isBeingObserved",get:function(){return getFlag(this.flags_,e.isBeingObservedMask_)},set:function(i){this.flags_=setFlag(this.flags_,e.isBeingObservedMask_,i)}},{key:"isPendingUnobservation",get:function(){return getFlag(this.flags_,e.isPendingUnobservationMask_)},set:function(i){this.flags_=setFlag(this.flags_,e.isPendingUnobservationMask_,i)}},{key:"diffValue",get:function(){return getFlag(this.flags_,e.diffValueMask_)?1:0},set:function(i){this.flags_=setFlag(this.flags_,e.diffValueMask_,i===1)}}])}();ComputedValue.isComputingMask_=1,ComputedValue.isRunningSetterMask_=2,ComputedValue.isBeingObservedMask_=4,ComputedValue.isPendingUnobservationMask_=8,ComputedValue.diffValueMask_=16;var isComputedValue=createInstanceofPredicate("ComputedValue",ComputedValue),IDerivationState_;(function(e){e[e.NOT_TRACKING_=-1]="NOT_TRACKING_",e[e.UP_TO_DATE_=0]="UP_TO_DATE_",e[e.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",e[e.STALE_=2]="STALE_"})(IDerivationState_||(IDerivationState_={}));var TraceMode;(function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.BREAK=2]="BREAK"})(TraceMode||(TraceMode={}));var CaughtException=function(t){this.cause=void 0,this.cause=t};function isCaughtException(e){return e instanceof CaughtException}function shouldCompute(e){switch(e.dependenciesState_){case IDerivationState_.UP_TO_DATE_:return!1;case IDerivationState_.NOT_TRACKING_:case IDerivationState_.STALE_:return!0;case IDerivationState_.POSSIBLY_STALE_:{for(var t=allowStateReadsStart(!0),r=untrackedStart(),i=e.observing_,o=i.length,a=0;a<o;a++){var c=i[a];if(isComputedValue(c)){if(globalState.disableErrorBoundaries)c.get();else try{c.get()}catch{return untrackedEnd(r),allowStateReadsEnd(t),!0}if(e.dependenciesState_===IDerivationState_.STALE_)return untrackedEnd(r),allowStateReadsEnd(t),!0}}return changeDependenciesStateTo0(e),untrackedEnd(r),allowStateReadsEnd(t),!1}}}function checkIfStateModificationsAreAllowed(e){var t=e.observers_.size>0;!globalState.allowStateChanges&&(t||globalState.enforceActions==="always")&&console.warn("[MobX] "+(globalState.enforceActions?"Since strict-mode is enabled, changing (observed) observable values without using an action is not allowed. Tried to modify: ":"Side effects like changing state are not allowed at this point. Are you trying to modify state from, for example, a computed value or the render function of a React component? You can wrap side effects in 'runInAction' (or decorate functions with 'action') if needed. Tried to modify: ")+e.name_)}function checkIfStateReadsAreAllowed(e){!globalState.allowStateReads&&globalState.observableRequiresReaction&&console.warn("[mobx] Observable '"+e.name_+"' being read outside a reactive context.")}function trackDerivedFunction(e,t,r){var i=allowStateReadsStart(!0);changeDependenciesStateTo0(e),e.newObserving_=new Array(e.runId_===0?100:e.observing_.length),e.unboundDepsCount_=0,e.runId_=++globalState.runId;var o=globalState.trackingDerivation;globalState.trackingDerivation=e,globalState.inBatch++;var a;if(globalState.disableErrorBoundaries===!0)a=t.call(r);else try{a=t.call(r)}catch(c){a=new CaughtException(c)}return globalState.inBatch--,globalState.trackingDerivation=o,bindDependencies(e),warnAboutDerivationWithoutDependencies(e),allowStateReadsEnd(i),a}function warnAboutDerivationWithoutDependencies(e){e.observing_.length===0&&(typeof e.requiresObservable_=="boolean"?e.requiresObservable_:globalState.reactionRequiresObservable)&&console.warn("[mobx] Derivation '"+e.name_+"' is created/updated without reading any observable value.")}function bindDependencies(e){for(var t=e.observing_,r=e.observing_=e.newObserving_,i=IDerivationState_.UP_TO_DATE_,o=0,a=e.unboundDepsCount_,c=0;c<a;c++){var u=r[c];u.diffValue===0&&(u.diffValue=1,o!==c&&(r[o]=u),o++),u.dependenciesState_>i&&(i=u.dependenciesState_)}for(r.length=o,e.newObserving_=null,a=t.length;a--;){var h=t[a];h.diffValue===0&&removeObserver(h,e),h.diffValue=0}for(;o--;){var d=r[o];d.diffValue===1&&(d.diffValue=0,addObserver(d,e))}i!==IDerivationState_.UP_TO_DATE_&&(e.dependenciesState_=i,e.onBecomeStale_())}function clearObserving(e){var t=e.observing_;e.observing_=[];for(var r=t.length;r--;)removeObserver(t[r],e);e.dependenciesState_=IDerivationState_.NOT_TRACKING_}function untracked(e){var t=untrackedStart();try{return e()}finally{untrackedEnd(t)}}function untrackedStart(){var e=globalState.trackingDerivation;return globalState.trackingDerivation=null,e}function untrackedEnd(e){globalState.trackingDerivation=e}function allowStateReadsStart(e){var t=globalState.allowStateReads;return globalState.allowStateReads=e,t}function allowStateReadsEnd(e){globalState.allowStateReads=e}function changeDependenciesStateTo0(e){if(e.dependenciesState_!==IDerivationState_.UP_TO_DATE_){e.dependenciesState_=IDerivationState_.UP_TO_DATE_;for(var t=e.observing_,r=t.length;r--;)t[r].lowestObserverState_=IDerivationState_.UP_TO_DATE_}}var MobXGlobals=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0},canMergeGlobalState=!0,isolateCalled=!1,globalState=function(){var e=getGlobal();return e.__mobxInstanceCount>0&&!e.__mobxGlobals&&(canMergeGlobalState=!1),e.__mobxGlobals&&e.__mobxGlobals.version!==new MobXGlobals().version&&(canMergeGlobalState=!1),canMergeGlobalState?e.__mobxGlobals?(e.__mobxInstanceCount+=1,e.__mobxGlobals.UNCHANGED||(e.__mobxGlobals.UNCHANGED={}),e.__mobxGlobals):(e.__mobxInstanceCount=1,e.__mobxGlobals=new MobXGlobals):(setTimeout(function(){isolateCalled||die(35)},1),new MobXGlobals)}();function addObserver(e,t){e.observers_.add(t),e.lowestObserverState_>t.dependenciesState_&&(e.lowestObserverState_=t.dependenciesState_)}function removeObserver(e,t){e.observers_.delete(t),e.observers_.size===0&&queueForUnobservation(e)}function queueForUnobservation(e){e.isPendingUnobservation===!1&&(e.isPendingUnobservation=!0,globalState.pendingUnobservations.push(e))}function startBatch(){globalState.inBatch++}function endBatch(){if(--globalState.inBatch===0){runReactions();for(var e=globalState.pendingUnobservations,t=0;t<e.length;t++){var r=e[t];r.isPendingUnobservation=!1,r.observers_.size===0&&(r.isBeingObserved&&(r.isBeingObserved=!1,r.onBUO()),r instanceof ComputedValue&&r.suspend_())}globalState.pendingUnobservations=[]}}function reportObserved(e){checkIfStateReadsAreAllowed(e);var t=globalState.trackingDerivation;return t!==null?(t.runId_!==e.lastAccessedBy_&&(e.lastAccessedBy_=t.runId_,t.newObserving_[t.unboundDepsCount_++]=e,!e.isBeingObserved&&globalState.trackingContext&&(e.isBeingObserved=!0,e.onBO())),e.isBeingObserved):(e.observers_.size===0&&globalState.inBatch>0&&queueForUnobservation(e),!1)}function propagateChanged(e){e.lowestObserverState_!==IDerivationState_.STALE_&&(e.lowestObserverState_=IDerivationState_.STALE_,e.observers_.forEach(function(t){t.dependenciesState_===IDerivationState_.UP_TO_DATE_&&(t.isTracing_!==TraceMode.NONE&&logTraceInfo(t,e),t.onBecomeStale_()),t.dependenciesState_=IDerivationState_.STALE_}))}function propagateChangeConfirmed(e){e.lowestObserverState_!==IDerivationState_.STALE_&&(e.lowestObserverState_=IDerivationState_.STALE_,e.observers_.forEach(function(t){t.dependenciesState_===IDerivationState_.POSSIBLY_STALE_?(t.dependenciesState_=IDerivationState_.STALE_,t.isTracing_!==TraceMode.NONE&&logTraceInfo(t,e)):t.dependenciesState_===IDerivationState_.UP_TO_DATE_&&(e.lowestObserverState_=IDerivationState_.UP_TO_DATE_)}))}function propagateMaybeChanged(e){e.lowestObserverState_===IDerivationState_.UP_TO_DATE_&&(e.lowestObserverState_=IDerivationState_.POSSIBLY_STALE_,e.observers_.forEach(function(t){t.dependenciesState_===IDerivationState_.UP_TO_DATE_&&(t.dependenciesState_=IDerivationState_.POSSIBLY_STALE_,t.onBecomeStale_())}))}function logTraceInfo(e,t){if(console.log("[mobx.trace] '"+e.name_+"' is invalidated due to a change in: '"+t.name_+"'"),e.isTracing_===TraceMode.BREAK){var r=[];printDepTree(getDependencyTree(e),r,1),new Function(`debugger;
/*
Tracing '`+e.name_+`'

You are entering this break point because derivation '`+e.name_+"' is being traced and '"+t.name_+`' is now forcing it to update.
Just follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update
The stackframe you are looking for is at least ~6-8 stack-frames up.

`+(e instanceof ComputedValue?e.derivation.toString().replace(/[*]\//g,"/"):"")+`

The dependencies for this derivation are:

`+r.join(`
`)+`
*/
    `)()}}function printDepTree(e,t,r){if(t.length>=1e3){t.push("(and many more)");return}t.push(""+"	".repeat(r-1)+e.name),e.dependencies&&e.dependencies.forEach(function(i){return printDepTree(i,t,r+1)})}var Reaction=function(){function e(r,i,o,a){r===void 0&&(r="Reaction@"+getNextId()),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=IDerivationState_.NOT_TRACKING_,this.runId_=0,this.unboundDepsCount_=0,this.flags_=0,this.isTracing_=TraceMode.NONE,this.name_=r,this.onInvalidate_=i,this.errorHandler_=o,this.requiresObservable_=a}var t=e.prototype;return t.onBecomeStale_=function(){this.schedule_()},t.schedule_=function(){this.isScheduled||(this.isScheduled=!0,globalState.pendingReactions.push(this),runReactions())},t.runReaction_=function(){if(!this.isDisposed){startBatch(),this.isScheduled=!1;var i=globalState.trackingContext;if(globalState.trackingContext=this,shouldCompute(this)){this.isTrackPending=!0;try{this.onInvalidate_(),this.isTrackPending&&isSpyEnabled()&&spyReport({name:this.name_,type:"scheduled-reaction"})}catch(o){this.reportExceptionInDerivation_(o)}}globalState.trackingContext=i,endBatch()}},t.track=function(i){if(!this.isDisposed){startBatch();var o=isSpyEnabled(),a;o&&(a=Date.now(),spyReportStart({name:this.name_,type:"reaction"})),this.isRunning=!0;var c=globalState.trackingContext;globalState.trackingContext=this;var u=trackDerivedFunction(this,i,void 0);globalState.trackingContext=c,this.isRunning=!1,this.isTrackPending=!1,this.isDisposed&&clearObserving(this),isCaughtException(u)&&this.reportExceptionInDerivation_(u.cause),o&&spyReportEnd({time:Date.now()-a}),endBatch()}},t.reportExceptionInDerivation_=function(i){var o=this;if(this.errorHandler_){this.errorHandler_(i,this);return}if(globalState.disableErrorBoundaries)throw i;var a="[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '"+this+"'";globalState.suppressReactionErrors?console.warn("[mobx] (error in reaction '"+this.name_+"' suppressed, fix error of causing action below)"):console.error(a,i),isSpyEnabled()&&spyReport({type:"error",name:this.name_,message:a,error:""+i}),globalState.globalReactionErrorHandlers.forEach(function(c){return c(i,o)})},t.dispose=function(){this.isDisposed||(this.isDisposed=!0,this.isRunning||(startBatch(),clearObserving(this),endBatch()))},t.getDisposer_=function(i){var o=this,a=function c(){o.dispose(),i==null||i.removeEventListener==null||i.removeEventListener("abort",c)};return i==null||i.addEventListener==null||i.addEventListener("abort",a),a[$mobx]=this,a},t.toString=function(){return"Reaction["+this.name_+"]"},t.trace=function(i){i===void 0&&(i=!1),trace(this,i)},_createClass(e,[{key:"isDisposed",get:function(){return getFlag(this.flags_,e.isDisposedMask_)},set:function(i){this.flags_=setFlag(this.flags_,e.isDisposedMask_,i)}},{key:"isScheduled",get:function(){return getFlag(this.flags_,e.isScheduledMask_)},set:function(i){this.flags_=setFlag(this.flags_,e.isScheduledMask_,i)}},{key:"isTrackPending",get:function(){return getFlag(this.flags_,e.isTrackPendingMask_)},set:function(i){this.flags_=setFlag(this.flags_,e.isTrackPendingMask_,i)}},{key:"isRunning",get:function(){return getFlag(this.flags_,e.isRunningMask_)},set:function(i){this.flags_=setFlag(this.flags_,e.isRunningMask_,i)}},{key:"diffValue",get:function(){return getFlag(this.flags_,e.diffValueMask_)?1:0},set:function(i){this.flags_=setFlag(this.flags_,e.diffValueMask_,i===1)}}])}();Reaction.isDisposedMask_=1,Reaction.isScheduledMask_=2,Reaction.isTrackPendingMask_=4,Reaction.isRunningMask_=8,Reaction.diffValueMask_=16;var MAX_REACTION_ITERATIONS=100,reactionScheduler=function(t){return t()};function runReactions(){globalState.inBatch>0||globalState.isRunningReactions||reactionScheduler(runReactionsHelper)}function runReactionsHelper(){globalState.isRunningReactions=!0;for(var e=globalState.pendingReactions,t=0;e.length>0;){++t===MAX_REACTION_ITERATIONS&&(console.error("Reaction doesn't converge to a stable state after "+MAX_REACTION_ITERATIONS+" iterations."+(" Probably there is a cycle in the reactive function: "+e[0])),e.splice(0));for(var r=e.splice(0),i=0,o=r.length;i<o;i++)r[i].runReaction_()}globalState.isRunningReactions=!1}var isReaction=createInstanceofPredicate("Reaction",Reaction);function isSpyEnabled(){return!!globalState.spyListeners.length}function spyReport(e){if(globalState.spyListeners.length)for(var t=globalState.spyListeners,r=0,i=t.length;r<i;r++)t[r](e)}function spyReportStart(e){var t=_extends({},e,{spyReportStart:!0});spyReport(t)}var END_EVENT={type:"report-end",spyReportEnd:!0};function spyReportEnd(e){spyReport(e?_extends({},e,{type:"report-end",spyReportEnd:!0}):END_EVENT)}function spy2(e){return globalState.spyListeners.push(e),once(function(){globalState.spyListeners=globalState.spyListeners.filter(function(t){return t!==e})})}var ACTION="action",ACTION_BOUND="action.bound",AUTOACTION="autoAction",AUTOACTION_BOUND="autoAction.bound",DEFAULT_ACTION_NAME="<unnamed action>",actionAnnotation=createActionAnnotation(ACTION),actionBoundAnnotation=createActionAnnotation(ACTION_BOUND,{bound:!0}),autoActionAnnotation=createActionAnnotation(AUTOACTION,{autoAction:!0}),autoActionBoundAnnotation=createActionAnnotation(AUTOACTION_BOUND,{autoAction:!0,bound:!0});function createActionFactory(e){var t=function(i,o){if(isFunction4(i))return createAction(i.name||DEFAULT_ACTION_NAME,i,e);if(isFunction4(o))return createAction(i,o,e);if(is20223Decorator(o))return(e?autoActionAnnotation:actionAnnotation).decorate_20223_(i,o);if(isStringish(o))return storeAnnotation(i,o,e?autoActionAnnotation:actionAnnotation);if(isStringish(i))return createDecoratorAnnotation(createActionAnnotation(e?AUTOACTION:ACTION,{name:i,autoAction:e}));die("Invalid arguments for `action`")};return t}var action=createActionFactory(!1);Object.assign(action,actionAnnotation);var autoAction=createActionFactory(!0);Object.assign(autoAction,autoActionAnnotation),action.bound=createDecoratorAnnotation(actionBoundAnnotation),autoAction.bound=createDecoratorAnnotation(autoActionBoundAnnotation);function isAction(e){return isFunction4(e)&&e.isMobxAction===!0}function autorun(e,t){var r,i,o,a;t===void 0&&(t=EMPTY_OBJECT),isFunction4(e)||die("Autorun expects a function as first argument"),isAction(e)&&die("Autorun does not accept actions since actions are untrackable");var c=(r=(i=t)==null?void 0:i.name)!=null?r:e.name||"Autorun@"+getNextId(),u=!t.scheduler&&!t.delay,h;if(u)h=new Reaction(c,function(){this.track(m)},t.onError,t.requiresObservable);else{var d=createSchedulerFromOptions(t),f=!1;h=new Reaction(c,function(){f||(f=!0,d(function(){f=!1,h.isDisposed||h.track(m)}))},t.onError,t.requiresObservable)}function m(){e(h)}return(o=t)!=null&&(o=o.signal)!=null&&o.aborted||h.schedule_(),h.getDisposer_((a=t)==null?void 0:a.signal)}var run=function(t){return t()};function createSchedulerFromOptions(e){return e.scheduler?e.scheduler:e.delay?function(t){return setTimeout(t,e.delay)}:run}var ON_BECOME_OBSERVED="onBO",ON_BECOME_UNOBSERVED="onBUO";function onBecomeObserved(e,t,r){return interceptHook(ON_BECOME_OBSERVED,e,t,r)}function onBecomeUnobserved(e,t,r){return interceptHook(ON_BECOME_UNOBSERVED,e,t,r)}function interceptHook(e,t,r,i){var o=typeof i=="function"?getAtom(t,r):getAtom(t),a=isFunction4(i)?i:r,c=e+"L";return o[c]?o[c].add(a):o[c]=new Set([a]),function(){var u=o[c];u&&(u.delete(a),u.size===0&&delete o[c])}}function extendObservable(e,t,r,i){arguments.length>4&&die("'extendObservable' expected 2-4 arguments"),typeof e!="object"&&die("'extendObservable' expects an object as first argument"),isObservableMap(e)&&die("'extendObservable' should not be used on maps, use map.merge instead"),isPlainObject2(t)||die("'extendObservable' only accepts plain objects as second argument"),(isObservable(t)||isObservable(r))&&die("Extending an object with another observable (object) is not supported");var o=getOwnPropertyDescriptors(t);return initObservable2(function(){var a=asObservableObject(e,i)[$mobx];ownKeys(o).forEach(function(c){a.extend_(c,o[c],r&&c in r?r[c]:!0)})}),e}function getDependencyTree(e,t){return nodeToDependencyTree(getAtom(e,t))}function nodeToDependencyTree(e){var t={name:e.name_};return e.observing_&&e.observing_.length>0&&(t.dependencies=unique(e.observing_).map(nodeToDependencyTree)),t}function unique(e){return Array.from(new Set(e))}var generatorId=0;function FlowCancellationError(){this.message="FLOW_CANCELLED"}FlowCancellationError.prototype=Object.create(Error.prototype);var flowAnnotation=createFlowAnnotation("flow"),flowBoundAnnotation=createFlowAnnotation("flow.bound",{bound:!0}),flow=Object.assign(function(t,r){if(is20223Decorator(r))return flowAnnotation.decorate_20223_(t,r);if(isStringish(r))return storeAnnotation(t,r,flowAnnotation);arguments.length!==1&&die("Flow expects single argument with generator function");var i=t,o=i.name||"<unnamed flow>",a=function(){var u=this,h=arguments,d=++generatorId,f=action(o+" - runid: "+d+" - init",i).apply(u,h),m,g=void 0,v=new Promise(function(_,b){var S=0;m=b;function R(E){g=void 0;var O;try{O=action(o+" - runid: "+d+" - yield "+S++,f.next).call(f,E)}catch(P){return b(P)}I(O)}function A(E){g=void 0;var O;try{O=action(o+" - runid: "+d+" - yield "+S++,f.throw).call(f,E)}catch(P){return b(P)}I(O)}function I(E){if(isFunction4(E?.then)){E.then(I,b);return}return E.done?_(E.value):(g=Promise.resolve(E.value),g.then(R,A))}R(void 0)});return v.cancel=action(o+" - runid: "+d+" - cancel",function(){try{g&&cancelPromise(g);var _=f.return(void 0),b=Promise.resolve(_.value);b.then(noop3,noop3),cancelPromise(b),m(new FlowCancellationError)}catch(S){m(S)}}),v};return a.isMobXFlow=!0,a},flowAnnotation);flow.bound=createDecoratorAnnotation(flowBoundAnnotation);function cancelPromise(e){isFunction4(e.cancel)&&e.cancel()}function isFlow(e){return e?.isMobXFlow===!0}function _isObservable(e,t){return e?t!==void 0?isObservableMap(e)||isObservableArray(e)?die("isObservable(object, propertyName) is not supported for arrays and maps. Use map.has or array.length instead."):isObservableObject(e)?e[$mobx].values_.has(t):!1:isObservableObject(e)||!!e[$mobx]||isAtom(e)||isReaction(e)||isComputedValue(e):!1}function isObservable(e){return arguments.length!==1&&die("isObservable expects only 1 argument. Use isObservableProp to inspect the observability of a property"),_isObservable(e)}function trace(){for(var e=!1,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];typeof r[r.length-1]=="boolean"&&(e=r.pop());var o=getAtomFromArgs(r);if(!o)return die("'trace(break?)' can only be used inside a tracked computed value or a Reaction. Consider passing in the computed value or reaction explicitly");o.isTracing_===TraceMode.NONE&&console.log("[mobx.trace] '"+o.name_+"' tracing enabled"),o.isTracing_=e?TraceMode.BREAK:TraceMode.LOG}function getAtomFromArgs(e){switch(e.length){case 0:return globalState.trackingDerivation;case 1:return getAtom(e[0]);case 2:return getAtom(e[0],e[1])}}function transaction(e,t){t===void 0&&(t=void 0),startBatch();try{return e.apply(t)}finally{endBatch()}}function getAdm(e){return e[$mobx]}var objectProxyTraps={has:function(t,r){return globalState.trackingDerivation&&warnAboutProxyRequirement("detect new properties using the 'in' operator. Use 'has' from 'mobx' instead."),getAdm(t).has_(r)},get:function(t,r){return getAdm(t).get_(r)},set:function(t,r,i){var o;return isStringish(r)?(getAdm(t).values_.has(r)||warnAboutProxyRequirement("add a new observable property through direct assignment. Use 'set' from 'mobx' instead."),(o=getAdm(t).set_(r,i,!0))!=null?o:!0):!1},deleteProperty:function(t,r){var i;return warnAboutProxyRequirement("delete properties from an observable object. Use 'remove' from 'mobx' instead."),isStringish(r)?(i=getAdm(t).delete_(r,!0))!=null?i:!0:!1},defineProperty:function(t,r,i){var o;return warnAboutProxyRequirement("define property on an observable object. Use 'defineProperty' from 'mobx' instead."),(o=getAdm(t).defineProperty_(r,i))!=null?o:!0},ownKeys:function(t){return globalState.trackingDerivation&&warnAboutProxyRequirement("iterate keys to detect added / removed properties. Use 'keys' from 'mobx' instead."),getAdm(t).ownKeys_()},preventExtensions:function(t){die(13)}};function asDynamicObservableObject(e,t){var r,i;return assertProxies(),e=asObservableObject(e,t),(i=(r=e[$mobx]).proxy_)!=null?i:r.proxy_=new Proxy(e,objectProxyTraps)}function hasInterceptors(e){return e.interceptors_!==void 0&&e.interceptors_.length>0}function registerInterceptor(e,t){var r=e.interceptors_||(e.interceptors_=[]);return r.push(t),once(function(){var i=r.indexOf(t);i!==-1&&r.splice(i,1)})}function interceptChange(e,t){var r=untrackedStart();try{for(var i=[].concat(e.interceptors_||[]),o=0,a=i.length;o<a&&(t=i[o](t),t&&!t.type&&die(14),!!t);o++);return t}finally{untrackedEnd(r)}}function hasListeners(e){return e.changeListeners_!==void 0&&e.changeListeners_.length>0}function registerListener(e,t){var r=e.changeListeners_||(e.changeListeners_=[]);return r.push(t),once(function(){var i=r.indexOf(t);i!==-1&&r.splice(i,1)})}function notifyListeners(e,t){var r=untrackedStart(),i=e.changeListeners_;if(i){i=i.slice();for(var o=0,a=i.length;o<a;o++)i[o](t);untrackedEnd(r)}}function makeObservable(e,t,r){return initObservable2(function(){var i,o=asObservableObject(e,r)[$mobx];t&&e[storedAnnotationsSymbol]&&die("makeObservable second arg must be nullish when using decorators. Mixing @decorator syntax with annotations is not supported."),(i=t)!=null||(t=collectStoredAnnotations(e)),ownKeys(t).forEach(function(a){return o.make_(a,t[a])})}),e}var SPLICE="splice",UPDATE="update",MAX_SPLICE_SIZE=1e4,arrayTraps={get:function(t,r){var i=t[$mobx];return r===$mobx?i:r==="length"?i.getArrayLength_():typeof r=="string"&&!isNaN(r)?i.get_(parseInt(r)):hasProp(arrayExtensions,r)?arrayExtensions[r]:t[r]},set:function(t,r,i){var o=t[$mobx];return r==="length"&&o.setArrayLength_(i),typeof r=="symbol"||isNaN(r)?t[r]=i:o.set_(parseInt(r),i),!0},preventExtensions:function(){die(15)}},ObservableArrayAdministration=function(){function e(r,i,o,a){r===void 0&&(r="ObservableArray@"+getNextId()),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=o,this.legacyMode_=a,this.atom_=new Atom(r),this.enhancer_=function(c,u){return i(c,u,r+"[..]")}}var t=e.prototype;return t.dehanceValue_=function(i){return this.dehancer!==void 0?this.dehancer(i):i},t.dehanceValues_=function(i){return this.dehancer!==void 0&&i.length>0?i.map(this.dehancer):i},t.intercept_=function(i){return registerInterceptor(this,i)},t.observe_=function(i,o){return o===void 0&&(o=!1),o&&i({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),registerListener(this,i)},t.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},t.setArrayLength_=function(i){(typeof i!="number"||isNaN(i)||i<0)&&die("Out of range: "+i);var o=this.values_.length;if(i!==o)if(i>o){for(var a=new Array(i-o),c=0;c<i-o;c++)a[c]=void 0;this.spliceWithArray_(o,0,a)}else this.spliceWithArray_(i,o-i)},t.updateArrayLength_=function(i,o){i!==this.lastKnownLength_&&die(16),this.lastKnownLength_+=o,this.legacyMode_&&o>0&&reserveArrayBuffer(i+o+1)},t.spliceWithArray_=function(i,o,a){var c=this;checkIfStateModificationsAreAllowed(this.atom_);var u=this.values_.length;if(i===void 0?i=0:i>u?i=u:i<0&&(i=Math.max(0,u+i)),arguments.length===1?o=u-i:o==null?o=0:o=Math.max(0,Math.min(o,u-i)),a===void 0&&(a=EMPTY_ARRAY),hasInterceptors(this)){var h=interceptChange(this,{object:this.proxy_,type:SPLICE,index:i,removedCount:o,added:a});if(!h)return EMPTY_ARRAY;o=h.removedCount,a=h.added}a=a.length===0?a:a.map(function(m){return c.enhancer_(m,void 0)}),this.legacyMode_;var d=a.length-o;this.updateArrayLength_(u,d);var f=this.spliceItemsIntoValues_(i,o,a);return(o!==0||a.length!==0)&&this.notifyArraySplice_(i,a,f),this.dehanceValues_(f)},t.spliceItemsIntoValues_=function(i,o,a){if(a.length<MAX_SPLICE_SIZE){var c;return(c=this.values_).splice.apply(c,[i,o].concat(a))}else{var u=this.values_.slice(i,i+o),h=this.values_.slice(i+o);this.values_.length+=a.length-o;for(var d=0;d<a.length;d++)this.values_[i+d]=a[d];for(var f=0;f<h.length;f++)this.values_[i+a.length+f]=h[f];return u}},t.notifyArrayChildUpdate_=function(i,o,a){var c=!this.owned_&&isSpyEnabled(),u=hasListeners(this),h=u||c?{observableKind:"array",object:this.proxy_,type:UPDATE,debugObjectName:this.atom_.name_,index:i,newValue:o,oldValue:a}:null;c&&spyReportStart(h),this.atom_.reportChanged(),u&&notifyListeners(this,h),c&&spyReportEnd()},t.notifyArraySplice_=function(i,o,a){var c=!this.owned_&&isSpyEnabled(),u=hasListeners(this),h=u||c?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:SPLICE,index:i,removed:a,added:o,removedCount:a.length,addedCount:o.length}:null;c&&spyReportStart(h),this.atom_.reportChanged(),u&&notifyListeners(this,h),c&&spyReportEnd()},t.get_=function(i){if(this.legacyMode_&&i>=this.values_.length){console.warn("[mobx.array] Attempt to read an array index ("+i+") that is out of bounds ("+this.values_.length+"). Please check length first. Out of bound indices will not be tracked by MobX");return}return this.atom_.reportObserved(),this.dehanceValue_(this.values_[i])},t.set_=function(i,o){var a=this.values_;if(this.legacyMode_&&i>a.length&&die(17,i,a.length),i<a.length){checkIfStateModificationsAreAllowed(this.atom_);var c=a[i];if(hasInterceptors(this)){var u=interceptChange(this,{type:UPDATE,object:this.proxy_,index:i,newValue:o});if(!u)return;o=u.newValue}o=this.enhancer_(o,c);var h=o!==c;h&&(a[i]=o,this.notifyArrayChildUpdate_(i,o,c))}else{for(var d=new Array(i+1-a.length),f=0;f<d.length-1;f++)d[f]=void 0;d[d.length-1]=o,this.spliceWithArray_(a.length,0,d)}},e}();function createObservableArray(e,t,r,i){return r===void 0&&(r="ObservableArray@"+getNextId()),i===void 0&&(i=!1),assertProxies(),initObservable2(function(){var o=new ObservableArrayAdministration(r,t,i,!1);addHiddenFinalProp(o.values_,$mobx,o);var a=new Proxy(o.values_,arrayTraps);return o.proxy_=a,e&&e.length&&o.spliceWithArray_(0,0,e),a})}var arrayExtensions={clear:function(){return this.splice(0)},replace:function(t){var r=this[$mobx];return r.spliceWithArray_(0,r.values_.length,t)},toJSON:function(){return this.slice()},splice:function(t,r){for(var i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];var c=this[$mobx];switch(arguments.length){case 0:return[];case 1:return c.spliceWithArray_(t);case 2:return c.spliceWithArray_(t,r)}return c.spliceWithArray_(t,r,o)},spliceWithArray:function(t,r,i){return this[$mobx].spliceWithArray_(t,r,i)},push:function(){for(var t=this[$mobx],r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t.spliceWithArray_(t.values_.length,0,i),t.values_.length},pop:function(){return this.splice(Math.max(this[$mobx].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var t=this[$mobx],r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t.spliceWithArray_(0,0,i),t.values_.length},reverse:function(){return globalState.trackingDerivation&&die(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){globalState.trackingDerivation&&die(37,"sort");var t=this.slice();return t.sort.apply(t,arguments),this.replace(t),this},remove:function(t){var r=this[$mobx],i=r.dehanceValues_(r.values_).indexOf(t);return i>-1?(this.splice(i,1),!0):!1}};addArrayExtension("at",simpleFunc),addArrayExtension("concat",simpleFunc),addArrayExtension("flat",simpleFunc),addArrayExtension("includes",simpleFunc),addArrayExtension("indexOf",simpleFunc),addArrayExtension("join",simpleFunc),addArrayExtension("lastIndexOf",simpleFunc),addArrayExtension("slice",simpleFunc),addArrayExtension("toString",simpleFunc),addArrayExtension("toLocaleString",simpleFunc),addArrayExtension("toSorted",simpleFunc),addArrayExtension("toSpliced",simpleFunc),addArrayExtension("with",simpleFunc),addArrayExtension("every",mapLikeFunc),addArrayExtension("filter",mapLikeFunc),addArrayExtension("find",mapLikeFunc),addArrayExtension("findIndex",mapLikeFunc),addArrayExtension("findLast",mapLikeFunc),addArrayExtension("findLastIndex",mapLikeFunc),addArrayExtension("flatMap",mapLikeFunc),addArrayExtension("forEach",mapLikeFunc),addArrayExtension("map",mapLikeFunc),addArrayExtension("some",mapLikeFunc),addArrayExtension("toReversed",mapLikeFunc),addArrayExtension("reduce",reduceLikeFunc),addArrayExtension("reduceRight",reduceLikeFunc);function addArrayExtension(e,t){typeof Array.prototype[e]=="function"&&(arrayExtensions[e]=t(e))}function simpleFunc(e){return function(){var t=this[$mobx];t.atom_.reportObserved();var r=t.dehanceValues_(t.values_);return r[e].apply(r,arguments)}}function mapLikeFunc(e){return function(t,r){var i=this,o=this[$mobx];o.atom_.reportObserved();var a=o.dehanceValues_(o.values_);return a[e](function(c,u){return t.call(r,c,u,i)})}}function reduceLikeFunc(e){return function(){var t=this,r=this[$mobx];r.atom_.reportObserved();var i=r.dehanceValues_(r.values_),o=arguments[0];return arguments[0]=function(a,c,u){return o(a,c,u,t)},i[e].apply(i,arguments)}}var isObservableArrayAdministration=createInstanceofPredicate("ObservableArrayAdministration",ObservableArrayAdministration);function isObservableArray(e){return isObject5(e)&&isObservableArrayAdministration(e[$mobx])}var ObservableMapMarker={},ADD="add",DELETE="delete",ObservableMap=function(){function e(r,i,o){var a=this;i===void 0&&(i=deepEnhancer),o===void 0&&(o="ObservableMap@"+getNextId()),this.enhancer_=void 0,this.name_=void 0,this[$mobx]=ObservableMapMarker,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=i,this.name_=o,isFunction4(Map)||die(18),initObservable2(function(){a.keysAtom_=createAtom(a.name_+".keys()"),a.data_=new Map,a.hasMap_=new Map,r&&a.merge(r)})}var t=e.prototype;return t.has_=function(i){return this.data_.has(i)},t.has=function(i){var o=this;if(!globalState.trackingDerivation)return this.has_(i);var a=this.hasMap_.get(i);if(!a){var c=a=new ObservableValue(this.has_(i),referenceEnhancer,this.name_+"."+stringifyKey(i)+"?",!1);this.hasMap_.set(i,c),onBecomeUnobserved(c,function(){return o.hasMap_.delete(i)})}return a.get()},t.set=function(i,o){var a=this.has_(i);if(hasInterceptors(this)){var c=interceptChange(this,{type:a?UPDATE:ADD,object:this,newValue:o,name:i});if(!c)return this;o=c.newValue}return a?this.updateValue_(i,o):this.addValue_(i,o),this},t.delete=function(i){var o=this;if(checkIfStateModificationsAreAllowed(this.keysAtom_),hasInterceptors(this)){var a=interceptChange(this,{type:DELETE,object:this,name:i});if(!a)return!1}if(this.has_(i)){var c=isSpyEnabled(),u=hasListeners(this),h=u||c?{observableKind:"map",debugObjectName:this.name_,type:DELETE,object:this,oldValue:this.data_.get(i).value_,name:i}:null;return c&&spyReportStart(h),transaction(function(){var d;o.keysAtom_.reportChanged(),(d=o.hasMap_.get(i))==null||d.setNewValue_(!1);var f=o.data_.get(i);f.setNewValue_(void 0),o.data_.delete(i)}),u&&notifyListeners(this,h),c&&spyReportEnd(),!0}return!1},t.updateValue_=function(i,o){var a=this.data_.get(i);if(o=a.prepareNewValue_(o),o!==globalState.UNCHANGED){var c=isSpyEnabled(),u=hasListeners(this),h=u||c?{observableKind:"map",debugObjectName:this.name_,type:UPDATE,object:this,oldValue:a.value_,name:i,newValue:o}:null;c&&spyReportStart(h),a.setNewValue_(o),u&&notifyListeners(this,h),c&&spyReportEnd()}},t.addValue_=function(i,o){var a=this;checkIfStateModificationsAreAllowed(this.keysAtom_),transaction(function(){var d,f=new ObservableValue(o,a.enhancer_,a.name_+"."+stringifyKey(i),!1);a.data_.set(i,f),o=f.value_,(d=a.hasMap_.get(i))==null||d.setNewValue_(!0),a.keysAtom_.reportChanged()});var c=isSpyEnabled(),u=hasListeners(this),h=u||c?{observableKind:"map",debugObjectName:this.name_,type:ADD,object:this,name:i,newValue:o}:null;c&&spyReportStart(h),u&&notifyListeners(this,h),c&&spyReportEnd()},t.get=function(i){return this.has(i)?this.dehanceValue_(this.data_.get(i).get()):this.dehanceValue_(void 0)},t.dehanceValue_=function(i){return this.dehancer!==void 0?this.dehancer(i):i},t.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},t.values=function(){var i=this,o=this.keys();return makeIterableForMap({next:function(){var c=o.next(),u=c.done,h=c.value;return{done:u,value:u?void 0:i.get(h)}}})},t.entries=function(){var i=this,o=this.keys();return makeIterableForMap({next:function(){var c=o.next(),u=c.done,h=c.value;return{done:u,value:u?void 0:[h,i.get(h)]}}})},t[Symbol.iterator]=function(){return this.entries()},t.forEach=function(i,o){for(var a=_createForOfIteratorHelperLoose(this),c;!(c=a()).done;){var u=c.value,h=u[0],d=u[1];i.call(o,d,h,this)}},t.merge=function(i){var o=this;return isObservableMap(i)&&(i=new Map(i)),transaction(function(){isPlainObject2(i)?getPlainObjectKeys(i).forEach(function(a){return o.set(a,i[a])}):Array.isArray(i)?i.forEach(function(a){var c=a[0],u=a[1];return o.set(c,u)}):isES6Map(i)?(isPlainES6Map(i)||die(19,i),i.forEach(function(a,c){return o.set(c,a)})):i!=null&&die(20,i)}),this},t.clear=function(){var i=this;transaction(function(){untracked(function(){for(var o=_createForOfIteratorHelperLoose(i.keys()),a;!(a=o()).done;){var c=a.value;i.delete(c)}})})},t.replace=function(i){var o=this;return transaction(function(){for(var a=convertToMap(i),c=new Map,u=!1,h=_createForOfIteratorHelperLoose(o.data_.keys()),d;!(d=h()).done;){var f=d.value;if(!a.has(f)){var m=o.delete(f);if(m)u=!0;else{var g=o.data_.get(f);c.set(f,g)}}}for(var v=_createForOfIteratorHelperLoose(a.entries()),_;!(_=v()).done;){var b=_.value,S=b[0],R=b[1],A=o.data_.has(S);if(o.set(S,R),o.data_.has(S)){var I=o.data_.get(S);c.set(S,I),A||(u=!0)}}if(!u)if(o.data_.size!==c.size)o.keysAtom_.reportChanged();else for(var E=o.data_.keys(),O=c.keys(),P=E.next(),L=O.next();!P.done;){if(P.value!==L.value){o.keysAtom_.reportChanged();break}P=E.next(),L=O.next()}o.data_=c}),this},t.toString=function(){return"[object ObservableMap]"},t.toJSON=function(){return Array.from(this)},t.observe_=function(i,o){return o===!0&&die("`observe` doesn't support fireImmediately=true in combination with maps."),registerListener(this,i)},t.intercept_=function(i){return registerInterceptor(this,i)},_createClass(e,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Map"}}])}(),isObservableMap=createInstanceofPredicate("ObservableMap",ObservableMap);function makeIterableForMap(e){return e[Symbol.toStringTag]="MapIterator",makeIterable(e)}function convertToMap(e){if(isES6Map(e)||isObservableMap(e))return e;if(Array.isArray(e))return new Map(e);if(isPlainObject2(e)){var t=new Map;for(var r in e)t.set(r,e[r]);return t}else return die(21,e)}var ObservableSetMarker={},ObservableSet=function(){function e(r,i,o){var a=this;i===void 0&&(i=deepEnhancer),o===void 0&&(o="ObservableSet@"+getNextId()),this.name_=void 0,this[$mobx]=ObservableSetMarker,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=o,isFunction4(Set)||die(22),this.enhancer_=function(c,u){return i(c,u,o)},initObservable2(function(){a.atom_=createAtom(a.name_),r&&a.replace(r)})}var t=e.prototype;return t.dehanceValue_=function(i){return this.dehancer!==void 0?this.dehancer(i):i},t.clear=function(){var i=this;transaction(function(){untracked(function(){for(var o=_createForOfIteratorHelperLoose(i.data_.values()),a;!(a=o()).done;){var c=a.value;i.delete(c)}})})},t.forEach=function(i,o){for(var a=_createForOfIteratorHelperLoose(this),c;!(c=a()).done;){var u=c.value;i.call(o,u,u,this)}},t.add=function(i){var o=this;if(checkIfStateModificationsAreAllowed(this.atom_),hasInterceptors(this)){var a=interceptChange(this,{type:ADD,object:this,newValue:i});if(!a)return this}if(!this.has(i)){transaction(function(){o.data_.add(o.enhancer_(i,void 0)),o.atom_.reportChanged()});var c=isSpyEnabled(),u=hasListeners(this),h=u||c?{observableKind:"set",debugObjectName:this.name_,type:ADD,object:this,newValue:i}:null;c&&spyReportStart(h),u&&notifyListeners(this,h),c&&spyReportEnd()}return this},t.delete=function(i){var o=this;if(hasInterceptors(this)){var a=interceptChange(this,{type:DELETE,object:this,oldValue:i});if(!a)return!1}if(this.has(i)){var c=isSpyEnabled(),u=hasListeners(this),h=u||c?{observableKind:"set",debugObjectName:this.name_,type:DELETE,object:this,oldValue:i}:null;return c&&spyReportStart(h),transaction(function(){o.atom_.reportChanged(),o.data_.delete(i)}),u&&notifyListeners(this,h),c&&spyReportEnd(),!0}return!1},t.has=function(i){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(i))},t.entries=function(){var i=0,o=Array.from(this.keys()),a=Array.from(this.values());return makeIterableForSet({next:function(){var u=i;return i+=1,u<a.length?{value:[o[u],a[u]],done:!1}:{value:void 0,done:!0}}})},t.keys=function(){return this.values()},t.values=function(){this.atom_.reportObserved();var i=this,o=0,a=Array.from(this.data_.values());return makeIterableForSet({next:function(){return o<a.length?{value:i.dehanceValue_(a[o++]),done:!1}:{value:void 0,done:!0}}})},t.intersection=function(i){if(isES6Set(i)&&!isObservableSet(i))return i.intersection(this);var o=new Set(this);return o.intersection(i)},t.union=function(i){if(isES6Set(i)&&!isObservableSet(i))return i.union(this);var o=new Set(this);return o.union(i)},t.difference=function(i){return new Set(this).difference(i)},t.symmetricDifference=function(i){if(isES6Set(i)&&!isObservableSet(i))return i.symmetricDifference(this);var o=new Set(this);return o.symmetricDifference(i)},t.isSubsetOf=function(i){return new Set(this).isSubsetOf(i)},t.isSupersetOf=function(i){return new Set(this).isSupersetOf(i)},t.isDisjointFrom=function(i){if(isES6Set(i)&&!isObservableSet(i))return i.isDisjointFrom(this);var o=new Set(this);return o.isDisjointFrom(i)},t.replace=function(i){var o=this;return isObservableSet(i)&&(i=new Set(i)),transaction(function(){Array.isArray(i)?(o.clear(),i.forEach(function(a){return o.add(a)})):isES6Set(i)?(o.clear(),i.forEach(function(a){return o.add(a)})):i!=null&&die("Cannot initialize set from "+i)}),this},t.observe_=function(i,o){return o===!0&&die("`observe` doesn't support fireImmediately=true in combination with sets."),registerListener(this,i)},t.intercept_=function(i){return registerInterceptor(this,i)},t.toJSON=function(){return Array.from(this)},t.toString=function(){return"[object ObservableSet]"},t[Symbol.iterator]=function(){return this.values()},_createClass(e,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Set"}}])}(),isObservableSet=createInstanceofPredicate("ObservableSet",ObservableSet);function makeIterableForSet(e){return e[Symbol.toStringTag]="SetIterator",makeIterable(e)}var descriptorCache=Object.create(null),REMOVE="remove",ObservableObjectAdministration=function(){function e(r,i,o,a){i===void 0&&(i=new Map),a===void 0&&(a=autoAnnotation),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=r,this.values_=i,this.name_=o,this.defaultAnnotation_=a,this.keysAtom_=new Atom(this.name_+".keys"),this.isPlainObject_=isPlainObject2(this.target_),isAnnotation(this.defaultAnnotation_)||die("defaultAnnotation must be valid annotation"),this.appliedAnnotations_={}}var t=e.prototype;return t.getObservablePropValue_=function(i){return this.values_.get(i).get()},t.setObservablePropValue_=function(i,o){var a=this.values_.get(i);if(a instanceof ComputedValue)return a.set(o),!0;if(hasInterceptors(this)){var c=interceptChange(this,{type:UPDATE,object:this.proxy_||this.target_,name:i,newValue:o});if(!c)return null;o=c.newValue}if(o=a.prepareNewValue_(o),o!==globalState.UNCHANGED){var u=hasListeners(this),h=isSpyEnabled(),d=u||h?{type:UPDATE,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:a.value_,name:i,newValue:o}:null;h&&spyReportStart(d),a.setNewValue_(o),u&&notifyListeners(this,d),h&&spyReportEnd()}return!0},t.get_=function(i){return globalState.trackingDerivation&&!hasProp(this.target_,i)&&this.has_(i),this.target_[i]},t.set_=function(i,o,a){return a===void 0&&(a=!1),hasProp(this.target_,i)?this.values_.has(i)?this.setObservablePropValue_(i,o):a?Reflect.set(this.target_,i,o):(this.target_[i]=o,!0):this.extend_(i,{value:o,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,a)},t.has_=function(i){if(!globalState.trackingDerivation)return i in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var o=this.pendingKeys_.get(i);return o||(o=new ObservableValue(i in this.target_,referenceEnhancer,this.name_+"."+stringifyKey(i)+"?",!1),this.pendingKeys_.set(i,o)),o.get()},t.make_=function(i,o){if(o===!0&&(o=this.defaultAnnotation_),o!==!1){if(assertAnnotable(this,o,i),!(i in this.target_)){var a;if((a=this.target_[storedAnnotationsSymbol])!=null&&a[i])return;die(1,o.annotationType_,this.name_+"."+i.toString())}for(var c=this.target_;c&&c!==objectPrototype;){var u=getDescriptor(c,i);if(u){var h=o.make_(this,i,u,c);if(h===0)return;if(h===1)break}c=Object.getPrototypeOf(c)}recordAnnotationApplied(this,o,i)}},t.extend_=function(i,o,a,c){if(c===void 0&&(c=!1),a===!0&&(a=this.defaultAnnotation_),a===!1)return this.defineProperty_(i,o,c);assertAnnotable(this,a,i);var u=a.extend_(this,i,o,c);return u&&recordAnnotationApplied(this,a,i),u},t.defineProperty_=function(i,o,a){a===void 0&&(a=!1),checkIfStateModificationsAreAllowed(this.keysAtom_);try{startBatch();var c=this.delete_(i);if(!c)return c;if(hasInterceptors(this)){var u=interceptChange(this,{object:this.proxy_||this.target_,name:i,type:ADD,newValue:o.value});if(!u)return null;var h=u.newValue;o.value!==h&&(o=_extends({},o,{value:h}))}if(a){if(!Reflect.defineProperty(this.target_,i,o))return!1}else defineProperty2(this.target_,i,o);this.notifyPropertyAddition_(i,o.value)}finally{endBatch()}return!0},t.defineObservableProperty_=function(i,o,a,c){c===void 0&&(c=!1),checkIfStateModificationsAreAllowed(this.keysAtom_);try{startBatch();var u=this.delete_(i);if(!u)return u;if(hasInterceptors(this)){var h=interceptChange(this,{object:this.proxy_||this.target_,name:i,type:ADD,newValue:o});if(!h)return null;o=h.newValue}var d=getCachedObservablePropDescriptor(i),f={configurable:globalState.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:d.get,set:d.set};if(c){if(!Reflect.defineProperty(this.target_,i,f))return!1}else defineProperty2(this.target_,i,f);var m=new ObservableValue(o,a,this.name_+"."+i.toString(),!1);this.values_.set(i,m),this.notifyPropertyAddition_(i,m.value_)}finally{endBatch()}return!0},t.defineComputedProperty_=function(i,o,a){a===void 0&&(a=!1),checkIfStateModificationsAreAllowed(this.keysAtom_);try{startBatch();var c=this.delete_(i);if(!c)return c;if(hasInterceptors(this)){var u=interceptChange(this,{object:this.proxy_||this.target_,name:i,type:ADD,newValue:void 0});if(!u)return null}o.name||(o.name=this.name_+"."+i.toString()),o.context=this.proxy_||this.target_;var h=getCachedObservablePropDescriptor(i),d={configurable:globalState.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:h.get,set:h.set};if(a){if(!Reflect.defineProperty(this.target_,i,d))return!1}else defineProperty2(this.target_,i,d);this.values_.set(i,new ComputedValue(o)),this.notifyPropertyAddition_(i,void 0)}finally{endBatch()}return!0},t.delete_=function(i,o){if(o===void 0&&(o=!1),checkIfStateModificationsAreAllowed(this.keysAtom_),!hasProp(this.target_,i))return!0;if(hasInterceptors(this)){var a=interceptChange(this,{object:this.proxy_||this.target_,name:i,type:REMOVE});if(!a)return null}try{var c;startBatch();var u=hasListeners(this),h=isSpyEnabled(),d=this.values_.get(i),f=void 0;if(!d&&(u||h)){var m;f=(m=getDescriptor(this.target_,i))==null?void 0:m.value}if(o){if(!Reflect.deleteProperty(this.target_,i))return!1}else delete this.target_[i];if(delete this.appliedAnnotations_[i],d&&(this.values_.delete(i),d instanceof ObservableValue&&(f=d.value_),propagateChanged(d)),this.keysAtom_.reportChanged(),(c=this.pendingKeys_)==null||(c=c.get(i))==null||c.set(i in this.target_),u||h){var g={type:REMOVE,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:f,name:i};h&&spyReportStart(g),u&&notifyListeners(this,g),h&&spyReportEnd()}}finally{endBatch()}return!0},t.observe_=function(i,o){return o===!0&&die("`observe` doesn't support the fire immediately property for observable objects."),registerListener(this,i)},t.intercept_=function(i){return registerInterceptor(this,i)},t.notifyPropertyAddition_=function(i,o){var a,c=hasListeners(this),u=isSpyEnabled();if(c||u){var h=c||u?{type:ADD,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:i,newValue:o}:null;u&&spyReportStart(h),c&&notifyListeners(this,h),u&&spyReportEnd()}(a=this.pendingKeys_)==null||(a=a.get(i))==null||a.set(!0),this.keysAtom_.reportChanged()},t.ownKeys_=function(){return this.keysAtom_.reportObserved(),ownKeys(this.target_)},t.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},e}();function asObservableObject(e,t){var r;if(t&&isObservableObject(e)&&die("Options can't be provided for already observable objects."),hasProp(e,$mobx))return getAdministration(e)instanceof ObservableObjectAdministration||die("Cannot convert '"+getDebugName(e)+`' into observable object:
The target is already observable of different type.
Extending builtins is not supported.`),e;Object.isExtensible(e)||die("Cannot make the designated object observable; it is not extensible");var i=(r=t?.name)!=null?r:(isPlainObject2(e)?"ObservableObject":e.constructor.name)+"@"+getNextId(),o=new ObservableObjectAdministration(e,new Map,String(i),getAnnotationFromOptions(t));return addHiddenProp(e,$mobx,o),e}var isObservableObjectAdministration=createInstanceofPredicate("ObservableObjectAdministration",ObservableObjectAdministration);function getCachedObservablePropDescriptor(e){return descriptorCache[e]||(descriptorCache[e]={get:function(){return this[$mobx].getObservablePropValue_(e)},set:function(r){return this[$mobx].setObservablePropValue_(e,r)}})}function isObservableObject(e){return isObject5(e)?isObservableObjectAdministration(e[$mobx]):!1}function recordAnnotationApplied(e,t,r){var i;e.appliedAnnotations_[r]=t,(i=e.target_[storedAnnotationsSymbol])==null||delete i[r]}function assertAnnotable(e,t,r){if(isAnnotation(t)||die("Cannot annotate '"+e.name_+"."+r.toString()+"': Invalid annotation."),!isOverride(t)&&hasProp(e.appliedAnnotations_,r)){var i=e.name_+"."+r.toString(),o=e.appliedAnnotations_[r].annotationType_,a=t.annotationType_;die("Cannot apply '"+a+"' to '"+i+"':"+(`
The field is already annotated with '`+o+"'.")+`
Re-annotating fields is not allowed.
Use 'override' annotation for methods overridden by subclass.`)}}var ENTRY_0=createArrayEntryDescriptor(0),safariPrototypeSetterInheritanceBug=function(){var e=!1,t={};return Object.defineProperty(t,"0",{set:function(){e=!0}}),Object.create(t)[0]=1,e===!1}(),OBSERVABLE_ARRAY_BUFFER_SIZE=0,StubArray=function(){};function inherit3(e,t){Object.setPrototypeOf?Object.setPrototypeOf(e.prototype,t):e.prototype.__proto__!==void 0?e.prototype.__proto__=t:e.prototype=t}inherit3(StubArray,Array.prototype);var LegacyObservableArray=function(e){function t(i,o,a,c){var u;return a===void 0&&(a="ObservableArray@"+getNextId()),c===void 0&&(c=!1),u=e.call(this)||this,initObservable2(function(){var h=new ObservableArrayAdministration(a,o,c,!0);h.proxy_=u,addHiddenFinalProp(u,$mobx,h),i&&i.length&&u.spliceWithArray(0,0,i),safariPrototypeSetterInheritanceBug&&Object.defineProperty(u,"0",ENTRY_0)}),u}_inheritsLoose(t,e);var r=t.prototype;return r.concat=function(){this[$mobx].atom_.reportObserved();for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return Array.prototype.concat.apply(this.slice(),a.map(function(u){return isObservableArray(u)?u.slice():u}))},r[Symbol.iterator]=function(){var i=this,o=0;return makeIterable({next:function(){return o<i.length?{value:i[o++],done:!1}:{done:!0,value:void 0}}})},_createClass(t,[{key:"length",get:function(){return this[$mobx].getArrayLength_()},set:function(o){this[$mobx].setArrayLength_(o)}},{key:Symbol.toStringTag,get:function(){return"Array"}}])}(StubArray);Object.entries(arrayExtensions).forEach(function(e){var t=e[0],r=e[1];t!=="concat"&&addHiddenProp(LegacyObservableArray.prototype,t,r)});function createArrayEntryDescriptor(e){return{enumerable:!1,configurable:!0,get:function(){return this[$mobx].get_(e)},set:function(r){this[$mobx].set_(e,r)}}}function createArrayBufferItem(e){defineProperty2(LegacyObservableArray.prototype,""+e,createArrayEntryDescriptor(e))}function reserveArrayBuffer(e){if(e>OBSERVABLE_ARRAY_BUFFER_SIZE){for(var t=OBSERVABLE_ARRAY_BUFFER_SIZE;t<e+100;t++)createArrayBufferItem(t);OBSERVABLE_ARRAY_BUFFER_SIZE=e}}reserveArrayBuffer(1e3);function createLegacyArray(e,t,r){return new LegacyObservableArray(e,t,r)}function getAtom(e,t){if(typeof e=="object"&&e!==null){if(isObservableArray(e))return t!==void 0&&die(23),e[$mobx].atom_;if(isObservableSet(e))return e.atom_;if(isObservableMap(e)){if(t===void 0)return e.keysAtom_;var r=e.data_.get(t)||e.hasMap_.get(t);return r||die(25,t,getDebugName(e)),r}if(isObservableObject(e)){if(!t)return die(26);var i=e[$mobx].values_.get(t);return i||die(27,t,getDebugName(e)),i}if(isAtom(e)||isComputedValue(e)||isReaction(e))return e}else if(isFunction4(e)&&isReaction(e[$mobx]))return e[$mobx];die(28)}function getAdministration(e,t){if(e||die(29),t!==void 0)return getAdministration(getAtom(e,t));if(isAtom(e)||isComputedValue(e)||isReaction(e)||isObservableMap(e)||isObservableSet(e))return e;if(e[$mobx])return e[$mobx];die(24,e)}function getDebugName(e,t){var r;if(t!==void 0)r=getAtom(e,t);else{if(isAction(e))return e.name;isObservableObject(e)||isObservableMap(e)||isObservableSet(e)?r=getAdministration(e):r=getAtom(e)}return r.name_}function initObservable2(e){var t=untrackedStart(),r=allowStateChangesStart(!0);startBatch();try{return e()}finally{endBatch(),allowStateChangesEnd(r),untrackedEnd(t)}}var toString2=objectPrototype.toString;function deepEqual(e,t,r){return r===void 0&&(r=-1),eq3(e,t,r)}function eq3(e,t,r,i,o){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var a=typeof e;if(a!=="function"&&a!=="object"&&typeof t!="object")return!1;var c=toString2.call(e);if(c!==toString2.call(t))return!1;switch(c){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return typeof Symbol<"u"&&Symbol.valueOf.call(e)===Symbol.valueOf.call(t);case"[object Map]":case"[object Set]":r>=0&&r++;break}e=unwrap(e),t=unwrap(t);var u=c==="[object Array]";if(!u){if(typeof e!="object"||typeof t!="object")return!1;var h=e.constructor,d=t.constructor;if(h!==d&&!(isFunction4(h)&&h instanceof h&&isFunction4(d)&&d instanceof d)&&"constructor"in e&&"constructor"in t)return!1}if(r===0)return!1;r<0&&(r=-1),i=i||[],o=o||[];for(var f=i.length;f--;)if(i[f]===e)return o[f]===t;if(i.push(e),o.push(t),u){if(f=e.length,f!==t.length)return!1;for(;f--;)if(!eq3(e[f],t[f],r-1,i,o))return!1}else{var m=Object.keys(e),g;if(f=m.length,Object.keys(t).length!==f)return!1;for(;f--;)if(g=m[f],!(hasProp(t,g)&&eq3(e[g],t[g],r-1,i,o)))return!1}return i.pop(),o.pop(),!0}function unwrap(e){return isObservableArray(e)?e.slice():isES6Map(e)||isObservableMap(e)||isES6Set(e)||isObservableSet(e)?Array.from(e.entries()):e}var _getGlobal$Iterator,maybeIteratorPrototype=((_getGlobal$Iterator=getGlobal().Iterator)==null?void 0:_getGlobal$Iterator.prototype)||{};function makeIterable(e){return e[Symbol.iterator]=getSelf,Object.assign(Object.create(maybeIteratorPrototype),e)}function getSelf(){return this}function isAnnotation(e){return e instanceof Object&&typeof e.annotationType_=="string"&&isFunction4(e.make_)&&isFunction4(e.extend_)}["Symbol","Map","Set"].forEach(function(e){var t=getGlobal();typeof t[e]>"u"&&die("MobX requires global '"+e+"' to be available or polyfilled")}),typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:spy2,extras:{getDebugName},$mobx});var top3="top",bottom3="bottom",right3="right",left3="left",auto="auto",basePlacements=[top3,bottom3,right3,left3],start2="start",end="end",clippingParents="clippingParents",viewport="viewport",popper="popper",reference="reference",variationPlacements=basePlacements.reduce(function(e,t){return e.concat([t+"-"+start2,t+"-"+end])},[]),placements=[].concat(basePlacements,[auto]).reduce(function(e,t){return e.concat([t,t+"-"+start2,t+"-"+end])},[]),beforeRead="beforeRead",read="read",afterRead="afterRead",beforeMain="beforeMain",main="main",afterMain="afterMain",beforeWrite="beforeWrite",write="write",afterWrite="afterWrite",modifierPhases=[beforeRead,read,afterRead,beforeMain,main,afterMain,beforeWrite,write,afterWrite];function getNodeName(e){return e?(e.nodeName||"").toLowerCase():null}function getWindow3(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function isElement4(e){var t=getWindow3(e).Element;return e instanceof t||e instanceof Element}function isHTMLElement(e){var t=getWindow3(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function isShadowRoot(e){if(typeof ShadowRoot>"u")return!1;var t=getWindow3(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function applyStyles(e){var t=e.state;Object.keys(t.elements).forEach(function(r){var i=t.styles[r]||{},o=t.attributes[r]||{},a=t.elements[r];!isHTMLElement(a)||!getNodeName(a)||(Object.assign(a.style,i),Object.keys(o).forEach(function(c){var u=o[c];u===!1?a.removeAttribute(c):a.setAttribute(c,u===!0?"":u)}))})}function effect(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow),function(){Object.keys(t.elements).forEach(function(i){var o=t.elements[i],a=t.attributes[i]||{},c=Object.keys(t.styles.hasOwnProperty(i)?t.styles[i]:r[i]),u=c.reduce(function(h,d){return h[d]="",h},{});!isHTMLElement(o)||!getNodeName(o)||(Object.assign(o.style,u),Object.keys(a).forEach(function(h){o.removeAttribute(h)}))})}}var applyStyles_default={name:"applyStyles",enabled:!0,phase:"write",fn:applyStyles,effect,requires:["computeStyles"]};function getBasePlacement(e){return e.split("-")[0]}var max2=Math.max,min2=Math.min,round3=Math.round;function getUAString(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function isLayoutViewport(){return!/^((?!chrome|android).)*safari/i.test(getUAString())}function getBoundingClientRect(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!1);var i=e.getBoundingClientRect(),o=1,a=1;t&&isHTMLElement(e)&&(o=e.offsetWidth>0&&round3(i.width)/e.offsetWidth||1,a=e.offsetHeight>0&&round3(i.height)/e.offsetHeight||1);var c=isElement4(e)?getWindow3(e):window,u=c.visualViewport,h=!isLayoutViewport()&&r,d=(i.left+(h&&u?u.offsetLeft:0))/o,f=(i.top+(h&&u?u.offsetTop:0))/a,m=i.width/o,g=i.height/a;return{width:m,height:g,top:f,right:d+m,bottom:f+g,left:d,x:d,y:f}}function getLayoutRect(e){var t=getBoundingClientRect(e),r=e.offsetWidth,i=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-i)<=1&&(i=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:i}}function contains(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&isShadowRoot(r)){var i=t;do{if(i&&e.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function getComputedStyle5(e){return getWindow3(e).getComputedStyle(e)}function isTableElement(e){return["table","td","th"].indexOf(getNodeName(e))>=0}function getDocumentElement(e){return((isElement4(e)?e.ownerDocument:e.document)||window.document).documentElement}function getParentNode(e){return getNodeName(e)==="html"?e:e.assignedSlot||e.parentNode||(isShadowRoot(e)?e.host:null)||getDocumentElement(e)}function getTrueOffsetParent(e){return!isHTMLElement(e)||getComputedStyle5(e).position==="fixed"?null:e.offsetParent}function getContainingBlock(e){var t=/firefox/i.test(getUAString()),r=/Trident/i.test(getUAString());if(r&&isHTMLElement(e)){var i=getComputedStyle5(e);if(i.position==="fixed")return null}var o=getParentNode(e);for(isShadowRoot(o)&&(o=o.host);isHTMLElement(o)&&["html","body"].indexOf(getNodeName(o))<0;){var a=getComputedStyle5(o);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||t&&a.willChange==="filter"||t&&a.filter&&a.filter!=="none")return o;o=o.parentNode}return null}function getOffsetParent(e){for(var t=getWindow3(e),r=getTrueOffsetParent(e);r&&isTableElement(r)&&getComputedStyle5(r).position==="static";)r=getTrueOffsetParent(r);return r&&(getNodeName(r)==="html"||getNodeName(r)==="body"&&getComputedStyle5(r).position==="static")?t:r||getContainingBlock(e)||t}function getMainAxisFromPlacement(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function within(e,t,r){return max2(e,min2(t,r))}function withinMaxClamp(e,t,r){var i=within(e,t,r);return i>r?r:i}function getFreshSideObject(){return{top:0,right:0,bottom:0,left:0}}function mergePaddingObject(e){return Object.assign({},getFreshSideObject(),e)}function expandToHashMap(e,t){return t.reduce(function(r,i){return r[i]=e,r},{})}var toPaddingObject=function(t,r){return t=typeof t=="function"?t(Object.assign({},r.rects,{placement:r.placement})):t,mergePaddingObject(typeof t!="number"?t:expandToHashMap(t,basePlacements))};function arrow(e){var t,r=e.state,i=e.name,o=e.options,a=r.elements.arrow,c=r.modifiersData.popperOffsets,u=getBasePlacement(r.placement),h=getMainAxisFromPlacement(u),d=[left3,right3].indexOf(u)>=0,f=d?"height":"width";if(!(!a||!c)){var m=toPaddingObject(o.padding,r),g=getLayoutRect(a),v=h==="y"?top3:left3,_=h==="y"?bottom3:right3,b=r.rects.reference[f]+r.rects.reference[h]-c[h]-r.rects.popper[f],S=c[h]-r.rects.reference[h],R=getOffsetParent(a),A=R?h==="y"?R.clientHeight||0:R.clientWidth||0:0,I=b/2-S/2,E=m[v],O=A-g[f]-m[_],P=A/2-g[f]/2+I,L=within(E,P,O),V=h;r.modifiersData[i]=(t={},t[V]=L,t.centerOffset=L-P,t)}}function effect2(e){var t=e.state,r=e.options,i=r.element,o=i===void 0?"[data-popper-arrow]":i;o!=null&&(typeof o=="string"&&(o=t.elements.popper.querySelector(o),!o)||contains(t.elements.popper,o)&&(t.elements.arrow=o))}var arrow_default={name:"arrow",enabled:!0,phase:"main",fn:arrow,effect:effect2,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function getVariation(e){return e.split("-")[1]}var unsetSides={top:"auto",right:"auto",bottom:"auto",left:"auto"};function roundOffsetsByDPR(e,t){var r=e.x,i=e.y,o=t.devicePixelRatio||1;return{x:round3(r*o)/o||0,y:round3(i*o)/o||0}}function mapToStyles(e){var t,r=e.popper,i=e.popperRect,o=e.placement,a=e.variation,c=e.offsets,u=e.position,h=e.gpuAcceleration,d=e.adaptive,f=e.roundOffsets,m=e.isFixed,g=c.x,v=g===void 0?0:g,_=c.y,b=_===void 0?0:_,S=typeof f=="function"?f({x:v,y:b}):{x:v,y:b};v=S.x,b=S.y;var R=c.hasOwnProperty("x"),A=c.hasOwnProperty("y"),I=left3,E=top3,O=window;if(d){var P=getOffsetParent(r),L="clientHeight",V="clientWidth";if(P===getWindow3(r)&&(P=getDocumentElement(r),getComputedStyle5(P).position!=="static"&&u==="absolute"&&(L="scrollHeight",V="scrollWidth")),P=P,o===top3||(o===left3||o===right3)&&a===end){E=bottom3;var $=m&&P===O&&O.visualViewport?O.visualViewport.height:P[L];b-=$-i.height,b*=h?1:-1}if(o===left3||(o===top3||o===bottom3)&&a===end){I=right3;var W=m&&P===O&&O.visualViewport?O.visualViewport.width:P[V];v-=W-i.width,v*=h?1:-1}}var Z=Object.assign({position:u},d&&unsetSides),ie=f===!0?roundOffsetsByDPR({x:v,y:b},getWindow3(r)):{x:v,y:b};if(v=ie.x,b=ie.y,h){var ue;return Object.assign({},Z,(ue={},ue[E]=A?"0":"",ue[I]=R?"0":"",ue.transform=(O.devicePixelRatio||1)<=1?"translate("+v+"px, "+b+"px)":"translate3d("+v+"px, "+b+"px, 0)",ue))}return Object.assign({},Z,(t={},t[E]=A?b+"px":"",t[I]=R?v+"px":"",t.transform="",t))}function computeStyles(e){var t=e.state,r=e.options,i=r.gpuAcceleration,o=i===void 0?!0:i,a=r.adaptive,c=a===void 0?!0:a,u=r.roundOffsets,h=u===void 0?!0:u,d={placement:getBasePlacement(t.placement),variation:getVariation(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,mapToStyles(Object.assign({},d,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:c,roundOffsets:h})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,mapToStyles(Object.assign({},d,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:h})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}var computeStyles_default={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:computeStyles,data:{}},passive={passive:!0};function effect3(e){var t=e.state,r=e.instance,i=e.options,o=i.scroll,a=o===void 0?!0:o,c=i.resize,u=c===void 0?!0:c,h=getWindow3(t.elements.popper),d=[].concat(t.scrollParents.reference,t.scrollParents.popper);return a&&d.forEach(function(f){f.addEventListener("scroll",r.update,passive)}),u&&h.addEventListener("resize",r.update,passive),function(){a&&d.forEach(function(f){f.removeEventListener("scroll",r.update,passive)}),u&&h.removeEventListener("resize",r.update,passive)}}var eventListeners_default={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:effect3,data:{}},hash={left:"right",right:"left",bottom:"top",top:"bottom"};function getOppositePlacement(e){return e.replace(/left|right|bottom|top/g,function(t){return hash[t]})}var hash2={start:"end",end:"start"};function getOppositeVariationPlacement(e){return e.replace(/start|end/g,function(t){return hash2[t]})}function getWindowScroll(e){var t=getWindow3(e),r=t.pageXOffset,i=t.pageYOffset;return{scrollLeft:r,scrollTop:i}}function getWindowScrollBarX(e){return getBoundingClientRect(getDocumentElement(e)).left+getWindowScroll(e).scrollLeft}function getViewportRect(e,t){var r=getWindow3(e),i=getDocumentElement(e),o=r.visualViewport,a=i.clientWidth,c=i.clientHeight,u=0,h=0;if(o){a=o.width,c=o.height;var d=isLayoutViewport();(d||!d&&t==="fixed")&&(u=o.offsetLeft,h=o.offsetTop)}return{width:a,height:c,x:u+getWindowScrollBarX(e),y:h}}function getDocumentRect(e){var t,r=getDocumentElement(e),i=getWindowScroll(e),o=(t=e.ownerDocument)==null?void 0:t.body,a=max2(r.scrollWidth,r.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),c=max2(r.scrollHeight,r.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),u=-i.scrollLeft+getWindowScrollBarX(e),h=-i.scrollTop;return getComputedStyle5(o||r).direction==="rtl"&&(u+=max2(r.clientWidth,o?o.clientWidth:0)-a),{width:a,height:c,x:u,y:h}}function isScrollParent(e){var t=getComputedStyle5(e),r=t.overflow,i=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+o+i)}function getScrollParent(e){return["html","body","#document"].indexOf(getNodeName(e))>=0?e.ownerDocument.body:isHTMLElement(e)&&isScrollParent(e)?e:getScrollParent(getParentNode(e))}function listScrollParents(e,t){var r;t===void 0&&(t=[]);var i=getScrollParent(e),o=i===((r=e.ownerDocument)==null?void 0:r.body),a=getWindow3(i),c=o?[a].concat(a.visualViewport||[],isScrollParent(i)?i:[]):i,u=t.concat(c);return o?u:u.concat(listScrollParents(getParentNode(c)))}function rectToClientRect(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function getInnerBoundingClientRect(e,t){var r=getBoundingClientRect(e,!1,t==="fixed");return r.top=r.top+e.clientTop,r.left=r.left+e.clientLeft,r.bottom=r.top+e.clientHeight,r.right=r.left+e.clientWidth,r.width=e.clientWidth,r.height=e.clientHeight,r.x=r.left,r.y=r.top,r}function getClientRectFromMixedType(e,t,r){return t===viewport?rectToClientRect(getViewportRect(e,r)):isElement4(t)?getInnerBoundingClientRect(t,r):rectToClientRect(getDocumentRect(getDocumentElement(e)))}function getClippingParents(e){var t=listScrollParents(getParentNode(e)),r=["absolute","fixed"].indexOf(getComputedStyle5(e).position)>=0,i=r&&isHTMLElement(e)?getOffsetParent(e):e;return isElement4(i)?t.filter(function(o){return isElement4(o)&&contains(o,i)&&getNodeName(o)!=="body"}):[]}function getClippingRect(e,t,r,i){var o=t==="clippingParents"?getClippingParents(e):[].concat(t),a=[].concat(o,[r]),c=a[0],u=a.reduce(function(h,d){var f=getClientRectFromMixedType(e,d,i);return h.top=max2(f.top,h.top),h.right=min2(f.right,h.right),h.bottom=min2(f.bottom,h.bottom),h.left=max2(f.left,h.left),h},getClientRectFromMixedType(e,c,i));return u.width=u.right-u.left,u.height=u.bottom-u.top,u.x=u.left,u.y=u.top,u}function computeOffsets(e){var t=e.reference,r=e.element,i=e.placement,o=i?getBasePlacement(i):null,a=i?getVariation(i):null,c=t.x+t.width/2-r.width/2,u=t.y+t.height/2-r.height/2,h;switch(o){case top3:h={x:c,y:t.y-r.height};break;case bottom3:h={x:c,y:t.y+t.height};break;case right3:h={x:t.x+t.width,y:u};break;case left3:h={x:t.x-r.width,y:u};break;default:h={x:t.x,y:t.y}}var d=o?getMainAxisFromPlacement(o):null;if(d!=null){var f=d==="y"?"height":"width";switch(a){case start2:h[d]=h[d]-(t[f]/2-r[f]/2);break;case end:h[d]=h[d]+(t[f]/2-r[f]/2);break;default:}}return h}function detectOverflow(e,t){t===void 0&&(t={});var r=t,i=r.placement,o=i===void 0?e.placement:i,a=r.strategy,c=a===void 0?e.strategy:a,u=r.boundary,h=u===void 0?clippingParents:u,d=r.rootBoundary,f=d===void 0?viewport:d,m=r.elementContext,g=m===void 0?popper:m,v=r.altBoundary,_=v===void 0?!1:v,b=r.padding,S=b===void 0?0:b,R=mergePaddingObject(typeof S!="number"?S:expandToHashMap(S,basePlacements)),A=g===popper?reference:popper,I=e.rects.popper,E=e.elements[_?A:g],O=getClippingRect(isElement4(E)?E:E.contextElement||getDocumentElement(e.elements.popper),h,f,c),P=getBoundingClientRect(e.elements.reference),L=computeOffsets({reference:P,element:I,strategy:"absolute",placement:o}),V=rectToClientRect(Object.assign({},I,L)),$=g===popper?V:P,W={top:O.top-$.top+R.top,bottom:$.bottom-O.bottom+R.bottom,left:O.left-$.left+R.left,right:$.right-O.right+R.right},Z=e.modifiersData.offset;if(g===popper&&Z){var ie=Z[o];Object.keys(W).forEach(function(ue){var _e=[right3,bottom3].indexOf(ue)>=0?1:-1,Te=[top3,bottom3].indexOf(ue)>=0?"y":"x";W[ue]+=ie[Te]*_e})}return W}function computeAutoPlacement(e,t){t===void 0&&(t={});var r=t,i=r.placement,o=r.boundary,a=r.rootBoundary,c=r.padding,u=r.flipVariations,h=r.allowedAutoPlacements,d=h===void 0?placements:h,f=getVariation(i),m=f?u?variationPlacements:variationPlacements.filter(function(_){return getVariation(_)===f}):basePlacements,g=m.filter(function(_){return d.indexOf(_)>=0});g.length===0&&(g=m);var v=g.reduce(function(_,b){return _[b]=detectOverflow(e,{placement:b,boundary:o,rootBoundary:a,padding:c})[getBasePlacement(b)],_},{});return Object.keys(v).sort(function(_,b){return v[_]-v[b]})}function getExpandedFallbackPlacements(e){if(getBasePlacement(e)===auto)return[];var t=getOppositePlacement(e);return[getOppositeVariationPlacement(e),t,getOppositeVariationPlacement(t)]}function flip(e){var t=e.state,r=e.options,i=e.name;if(!t.modifiersData[i]._skip){for(var o=r.mainAxis,a=o===void 0?!0:o,c=r.altAxis,u=c===void 0?!0:c,h=r.fallbackPlacements,d=r.padding,f=r.boundary,m=r.rootBoundary,g=r.altBoundary,v=r.flipVariations,_=v===void 0?!0:v,b=r.allowedAutoPlacements,S=t.options.placement,R=getBasePlacement(S),A=R===S,I=h||(A||!_?[getOppositePlacement(S)]:getExpandedFallbackPlacements(S)),E=[S].concat(I).reduce(function(q,B){return q.concat(getBasePlacement(B)===auto?computeAutoPlacement(t,{placement:B,boundary:f,rootBoundary:m,padding:d,flipVariations:_,allowedAutoPlacements:b}):B)},[]),O=t.rects.reference,P=t.rects.popper,L=new Map,V=!0,$=E[0],W=0;W<E.length;W++){var Z=E[W],ie=getBasePlacement(Z),ue=getVariation(Z)===start2,_e=[top3,bottom3].indexOf(ie)>=0,Te=_e?"width":"height",pe=detectOverflow(t,{placement:Z,boundary:f,rootBoundary:m,altBoundary:g,padding:d}),me=_e?ue?right3:left3:ue?bottom3:top3;O[Te]>P[Te]&&(me=getOppositePlacement(me));var Se=getOppositePlacement(me),Le=[];if(a&&Le.push(pe[ie]<=0),u&&Le.push(pe[me]<=0,pe[Se]<=0),Le.every(function(q){return q})){$=Z,V=!1;break}L.set(Z,Le)}if(V)for(var xe=_?3:1,T=function(B){var se=E.find(function(ye){var we=L.get(ye);if(we)return we.slice(0,B).every(function(de){return de})});if(se)return $=se,"break"},k=xe;k>0;k--){var D=T(k);if(D==="break")break}t.placement!==$&&(t.modifiersData[i]._skip=!0,t.placement=$,t.reset=!0)}}var flip_default={name:"flip",enabled:!0,phase:"main",fn:flip,requiresIfExists:["offset"],data:{_skip:!1}};function getSideOffsets(e,t,r){return r===void 0&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function isAnySideFullyClipped(e){return[top3,right3,bottom3,left3].some(function(t){return e[t]>=0})}function hide(e){var t=e.state,r=e.name,i=t.rects.reference,o=t.rects.popper,a=t.modifiersData.preventOverflow,c=detectOverflow(t,{elementContext:"reference"}),u=detectOverflow(t,{altBoundary:!0}),h=getSideOffsets(c,i),d=getSideOffsets(u,o,a),f=isAnySideFullyClipped(h),m=isAnySideFullyClipped(d);t.modifiersData[r]={referenceClippingOffsets:h,popperEscapeOffsets:d,isReferenceHidden:f,hasPopperEscaped:m},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":f,"data-popper-escaped":m})}var hide_default={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:hide};function distanceAndSkiddingToXY(e,t,r){var i=getBasePlacement(e),o=[left3,top3].indexOf(i)>=0?-1:1,a=typeof r=="function"?r(Object.assign({},t,{placement:e})):r,c=a[0],u=a[1];return c=c||0,u=(u||0)*o,[left3,right3].indexOf(i)>=0?{x:u,y:c}:{x:c,y:u}}function offset3(e){var t=e.state,r=e.options,i=e.name,o=r.offset,a=o===void 0?[0,0]:o,c=placements.reduce(function(f,m){return f[m]=distanceAndSkiddingToXY(m,t.rects,a),f},{}),u=c[t.placement],h=u.x,d=u.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=h,t.modifiersData.popperOffsets.y+=d),t.modifiersData[i]=c}var offset_default={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:offset3};function popperOffsets(e){var t=e.state,r=e.name;t.modifiersData[r]=computeOffsets({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}var popperOffsets_default={name:"popperOffsets",enabled:!0,phase:"read",fn:popperOffsets,data:{}};function getAltAxis(e){return e==="x"?"y":"x"}function preventOverflow(e){var t=e.state,r=e.options,i=e.name,o=r.mainAxis,a=o===void 0?!0:o,c=r.altAxis,u=c===void 0?!1:c,h=r.boundary,d=r.rootBoundary,f=r.altBoundary,m=r.padding,g=r.tether,v=g===void 0?!0:g,_=r.tetherOffset,b=_===void 0?0:_,S=detectOverflow(t,{boundary:h,rootBoundary:d,padding:m,altBoundary:f}),R=getBasePlacement(t.placement),A=getVariation(t.placement),I=!A,E=getMainAxisFromPlacement(R),O=getAltAxis(E),P=t.modifiersData.popperOffsets,L=t.rects.reference,V=t.rects.popper,$=typeof b=="function"?b(Object.assign({},t.rects,{placement:t.placement})):b,W=typeof $=="number"?{mainAxis:$,altAxis:$}:Object.assign({mainAxis:0,altAxis:0},$),Z=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,ie={x:0,y:0};if(P){if(a){var ue,_e=E==="y"?top3:left3,Te=E==="y"?bottom3:right3,pe=E==="y"?"height":"width",me=P[E],Se=me+S[_e],Le=me-S[Te],xe=v?-V[pe]/2:0,T=A===start2?L[pe]:V[pe],k=A===start2?-V[pe]:-L[pe],D=t.elements.arrow,q=v&&D?getLayoutRect(D):{width:0,height:0},B=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:getFreshSideObject(),se=B[_e],ye=B[Te],we=within(0,L[pe],q[pe]),de=I?L[pe]/2-xe-we-se-W.mainAxis:T-we-se-W.mainAxis,be=I?-L[pe]/2+xe+we+ye+W.mainAxis:k+we+ye+W.mainAxis,fe=t.elements.arrow&&getOffsetParent(t.elements.arrow),he=fe?E==="y"?fe.clientTop||0:fe.clientLeft||0:0,Ne=(ue=Z?.[E])!=null?ue:0,le=me+de-Ne-he,Ve=me+be-Ne,Be=within(v?min2(Se,le):Se,me,v?max2(Le,Ve):Le);P[E]=Be,ie[E]=Be-me}if(u){var Ue,je=E==="x"?top3:left3,We=E==="x"?bottom3:right3,H=P[O],F=O==="y"?"height":"width",G=H+S[je],oe=H-S[We],Q=[top3,left3].indexOf(R)!==-1,ce=(Ue=Z?.[O])!=null?Ue:0,ee=Q?G:H-L[F]-V[F]-ce+W.altAxis,te=Q?H+L[F]+V[F]-ce-W.altAxis:oe,j=v&&Q?withinMaxClamp(ee,H,te):within(v?ee:G,H,v?te:oe);P[O]=j,ie[O]=j-H}t.modifiersData[i]=ie}}var preventOverflow_default={name:"preventOverflow",enabled:!0,phase:"main",fn:preventOverflow,requiresIfExists:["offset"]};function getHTMLElementScroll(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function getNodeScroll(e){return e===getWindow3(e)||!isHTMLElement(e)?getWindowScroll(e):getHTMLElementScroll(e)}function isElementScaled(e){var t=e.getBoundingClientRect(),r=round3(t.width)/e.offsetWidth||1,i=round3(t.height)/e.offsetHeight||1;return r!==1||i!==1}function getCompositeRect(e,t,r){r===void 0&&(r=!1);var i=isHTMLElement(t),o=isHTMLElement(t)&&isElementScaled(t),a=getDocumentElement(t),c=getBoundingClientRect(e,o,r),u={scrollLeft:0,scrollTop:0},h={x:0,y:0};return(i||!i&&!r)&&((getNodeName(t)!=="body"||isScrollParent(a))&&(u=getNodeScroll(t)),isHTMLElement(t)?(h=getBoundingClientRect(t,!0),h.x+=t.clientLeft,h.y+=t.clientTop):a&&(h.x=getWindowScrollBarX(a))),{x:c.left+u.scrollLeft-h.x,y:c.top+u.scrollTop-h.y,width:c.width,height:c.height}}function order(e){var t=new Map,r=new Set,i=[];e.forEach(function(a){t.set(a.name,a)});function o(a){r.add(a.name);var c=[].concat(a.requires||[],a.requiresIfExists||[]);c.forEach(function(u){if(!r.has(u)){var h=t.get(u);h&&o(h)}}),i.push(a)}return e.forEach(function(a){r.has(a.name)||o(a)}),i}function orderModifiers(e){var t=order(e);return modifierPhases.reduce(function(r,i){return r.concat(t.filter(function(o){return o.phase===i}))},[])}function debounce4(e){var t;return function(){return t||(t=new Promise(function(r){Promise.resolve().then(function(){t=void 0,r(e())})})),t}}function mergeByName(e){var t=e.reduce(function(r,i){var o=r[i.name];return r[i.name]=o?Object.assign({},o,i,{options:Object.assign({},o.options,i.options),data:Object.assign({},o.data,i.data)}):i,r},{});return Object.keys(t).map(function(r){return t[r]})}var DEFAULT_OPTIONS={placement:"bottom",modifiers:[],strategy:"absolute"};function areValidElements(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some(function(i){return!(i&&typeof i.getBoundingClientRect=="function")})}function popperGenerator(e){e===void 0&&(e={});var t=e,r=t.defaultModifiers,i=r===void 0?[]:r,o=t.defaultOptions,a=o===void 0?DEFAULT_OPTIONS:o;return function(u,h,d){d===void 0&&(d=a);var f={placement:"bottom",orderedModifiers:[],options:Object.assign({},DEFAULT_OPTIONS,a),modifiersData:{},elements:{reference:u,popper:h},attributes:{},styles:{}},m=[],g=!1,v={state:f,setOptions:function(R){var A=typeof R=="function"?R(f.options):R;b(),f.options=Object.assign({},a,f.options,A),f.scrollParents={reference:isElement4(u)?listScrollParents(u):u.contextElement?listScrollParents(u.contextElement):[],popper:listScrollParents(h)};var I=orderModifiers(mergeByName([].concat(i,f.options.modifiers)));return f.orderedModifiers=I.filter(function(E){return E.enabled}),_(),v.update()},forceUpdate:function(){if(!g){var R=f.elements,A=R.reference,I=R.popper;if(areValidElements(A,I)){f.rects={reference:getCompositeRect(A,getOffsetParent(I),f.options.strategy==="fixed"),popper:getLayoutRect(I)},f.reset=!1,f.placement=f.options.placement,f.orderedModifiers.forEach(function(W){return f.modifiersData[W.name]=Object.assign({},W.data)});for(var E=0;E<f.orderedModifiers.length;E++){if(f.reset===!0){f.reset=!1,E=-1;continue}var O=f.orderedModifiers[E],P=O.fn,L=O.options,V=L===void 0?{}:L,$=O.name;typeof P=="function"&&(f=P({state:f,options:V,name:$,instance:v})||f)}}}},update:debounce4(function(){return new Promise(function(S){v.forceUpdate(),S(f)})}),destroy:function(){b(),g=!0}};if(!areValidElements(u,h))return v;v.setOptions(d).then(function(S){!g&&d.onFirstUpdate&&d.onFirstUpdate(S)});function _(){f.orderedModifiers.forEach(function(S){var R=S.name,A=S.options,I=A===void 0?{}:A,E=S.effect;if(typeof E=="function"){var O=E({state:f,name:R,instance:v,options:I}),P=function(){};m.push(O||P)}})}function b(){m.forEach(function(S){return S()}),m=[]}return v}}var defaultModifiers=[eventListeners_default,popperOffsets_default,computeStyles_default,applyStyles_default,offset_default,flip_default,preventOverflow_default,arrow_default,hide_default],createPopper=popperGenerator({defaultModifiers}),BOX_CLASS="tippy-box",CONTENT_CLASS="tippy-content",BACKDROP_CLASS="tippy-backdrop",ARROW_CLASS="tippy-arrow",SVG_ARROW_CLASS="tippy-svg-arrow",TOUCH_OPTIONS={passive:!0,capture:!0},TIPPY_DEFAULT_APPEND_TO=function(){return document.body};function hasOwnProperty16(e,t){return{}.hasOwnProperty.call(e,t)}function getValueAtIndexOrReturn(e,t,r){if(Array.isArray(e)){var i=e[t];return i??(Array.isArray(r)?r[t]:r)}return e}function isType(e,t){var r={}.toString.call(e);return r.indexOf("[object")===0&&r.indexOf(t+"]")>-1}function invokeWithArgsOrReturn(e,t){return typeof e=="function"?e.apply(void 0,t):e}function debounce5(e,t){if(t===0)return e;var r;return function(i){clearTimeout(r),r=setTimeout(function(){e(i)},t)}}function removeProperties(e,t){var r=Object.assign({},e);return t.forEach(function(i){delete r[i]}),r}function splitBySpaces(e){return e.split(/\s+/).filter(Boolean)}function normalizeToArray(e){return[].concat(e)}function pushIfUnique(e,t){e.indexOf(t)===-1&&e.push(t)}function unique2(e){return e.filter(function(t,r){return e.indexOf(t)===r})}function getBasePlacement2(e){return e.split("-")[0]}function arrayFrom(e){return[].slice.call(e)}function removeUndefinedProps(e){return Object.keys(e).reduce(function(t,r){return e[r]!==void 0&&(t[r]=e[r]),t},{})}function div(){return document.createElement("div")}function isElement5(e){return["Element","Fragment"].some(function(t){return isType(e,t)})}function isNodeList(e){return isType(e,"NodeList")}function isMouseEvent(e){return isType(e,"MouseEvent")}function isReferenceElement(e){return!!(e&&e._tippy&&e._tippy.reference===e)}function getArrayOfElements(e){return isElement5(e)?[e]:isNodeList(e)?arrayFrom(e):Array.isArray(e)?e:arrayFrom(document.querySelectorAll(e))}function setTransitionDuration(e,t){e.forEach(function(r){r&&(r.style.transitionDuration=t+"ms")})}function setVisibilityState(e,t){e.forEach(function(r){r&&r.setAttribute("data-state",t)})}function getOwnerDocument(e){var t,r=normalizeToArray(e),i=r[0];return i!=null&&(t=i.ownerDocument)!=null&&t.body?i.ownerDocument:document}function isCursorOutsideInteractiveBorder(e,t){var r=t.clientX,i=t.clientY;return e.every(function(o){var a=o.popperRect,c=o.popperState,u=o.props,h=u.interactiveBorder,d=getBasePlacement2(c.placement),f=c.modifiersData.offset;if(!f)return!0;var m=d==="bottom"?f.top.y:0,g=d==="top"?f.bottom.y:0,v=d==="right"?f.left.x:0,_=d==="left"?f.right.x:0,b=a.top-i+m>h,S=i-a.bottom-g>h,R=a.left-r+v>h,A=r-a.right-_>h;return b||S||R||A})}function updateTransitionEndListener(e,t,r){var i=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(o){e[i](o,r)})}function actualContains(e,t){for(var r=t;r;){var i;if(e.contains(r))return!0;r=r.getRootNode==null||(i=r.getRootNode())==null?void 0:i.host}return!1}var currentInput={isTouch:!1},lastMouseMoveTime=0;function onDocumentTouchStart(){currentInput.isTouch||(currentInput.isTouch=!0,window.performance&&document.addEventListener("mousemove",onDocumentMouseMove))}function onDocumentMouseMove(){var e=performance.now();e-lastMouseMoveTime<20&&(currentInput.isTouch=!1,document.removeEventListener("mousemove",onDocumentMouseMove)),lastMouseMoveTime=e}function onWindowBlur(){var e=document.activeElement;if(isReferenceElement(e)){var t=e._tippy;e.blur&&!t.state.isVisible&&e.blur()}}function bindGlobalEventListeners(){document.addEventListener("touchstart",onDocumentTouchStart,TOUCH_OPTIONS),window.addEventListener("blur",onWindowBlur)}var isBrowser=typeof window<"u"&&typeof document<"u",isIE11=isBrowser?!!window.msCrypto:!1;function createMemoryLeakWarning(e){var t=e==="destroy"?"n already-":" ";return[e+"() was called on a"+t+"destroyed instance. This is a no-op but","indicates a potential memory leak."].join(" ")}function clean(e){var t=/[ \t]{2,}/g,r=/^[ \t]*/gm;return e.replace(t," ").replace(r,"").trim()}function getDevMessage(e){return clean(`
  %ctippy.js

  %c`+clean(e)+`

  %c\u{1F477}\u200D This is a development-only message. It will be removed in production.
  `)}function getFormattedMessage(e){return[getDevMessage(e),"color: #00C584; font-size: 1.3em; font-weight: bold;","line-height: 1.5","color: #a6a095;"]}var visitedMessages;resetVisitedMessages();function resetVisitedMessages(){visitedMessages=new Set}function warnWhen(e,t){if(e&&!visitedMessages.has(t)){var r;visitedMessages.add(t),(r=console).warn.apply(r,getFormattedMessage(t))}}function errorWhen(e,t){if(e&&!visitedMessages.has(t)){var r;visitedMessages.add(t),(r=console).error.apply(r,getFormattedMessage(t))}}function validateTargets(e){var t=!e,r=Object.prototype.toString.call(e)==="[object Object]"&&!e.addEventListener;errorWhen(t,["tippy() was passed","`"+String(e)+"`","as its targets (first) argument. Valid types are: String, Element,","Element[], or NodeList."].join(" ")),errorWhen(r,["tippy() was passed a plain object which is not supported as an argument","for virtual positioning. Use props.getReferenceClientRect instead."].join(" "))}var pluginProps={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},renderProps={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},defaultProps=Object.assign({appendTo:TIPPY_DEFAULT_APPEND_TO,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},pluginProps,renderProps),defaultKeys=Object.keys(defaultProps),setDefaultProps=function(t){validateProps(t,[]);var r=Object.keys(t);r.forEach(function(i){defaultProps[i]=t[i]})};function getExtendedPassedProps(e){var t=e.plugins||[],r=t.reduce(function(i,o){var a=o.name,c=o.defaultValue;if(a){var u;i[a]=e[a]!==void 0?e[a]:(u=defaultProps[a])!=null?u:c}return i},{});return Object.assign({},e,r)}function getDataAttributeProps(e,t){var r=t?Object.keys(getExtendedPassedProps(Object.assign({},defaultProps,{plugins:t}))):defaultKeys,i=r.reduce(function(o,a){var c=(e.getAttribute("data-tippy-"+a)||"").trim();if(!c)return o;if(a==="content")o[a]=c;else try{o[a]=JSON.parse(c)}catch{o[a]=c}return o},{});return i}function evaluateProps(e,t){var r=Object.assign({},t,{content:invokeWithArgsOrReturn(t.content,[e])},t.ignoreAttributes?{}:getDataAttributeProps(e,t.plugins));return r.aria=Object.assign({},defaultProps.aria,r.aria),r.aria={expanded:r.aria.expanded==="auto"?t.interactive:r.aria.expanded,content:r.aria.content==="auto"?t.interactive?null:"describedby":r.aria.content},r}function validateProps(e,t){e===void 0&&(e={}),t===void 0&&(t=[]);var r=Object.keys(e);r.forEach(function(i){var o=removeProperties(defaultProps,Object.keys(pluginProps)),a=!hasOwnProperty16(o,i);a&&(a=t.filter(function(c){return c.name===i}).length===0),warnWhen(a,["`"+i+"`","is not a valid prop. You may have spelled it incorrectly, or if it's","a plugin, forgot to pass it in an array as props.plugins.",`

`,`All props: https://atomiks.github.io/tippyjs/v6/all-props/
`,"Plugins: https://atomiks.github.io/tippyjs/v6/plugins/"].join(" "))})}var innerHTML=function(){return"innerHTML"};function dangerouslySetInnerHTML(e,t){e[innerHTML()]=t}function createArrowElement(e){var t=div();return e===!0?t.className=ARROW_CLASS:(t.className=SVG_ARROW_CLASS,isElement5(e)?t.appendChild(e):dangerouslySetInnerHTML(t,e)),t}function setContent(e,t){isElement5(t.content)?(dangerouslySetInnerHTML(e,""),e.appendChild(t.content)):typeof t.content!="function"&&(t.allowHTML?dangerouslySetInnerHTML(e,t.content):e.textContent=t.content)}function getChildren(e){var t=e.firstElementChild,r=arrayFrom(t.children);return{box:t,content:r.find(function(i){return i.classList.contains(CONTENT_CLASS)}),arrow:r.find(function(i){return i.classList.contains(ARROW_CLASS)||i.classList.contains(SVG_ARROW_CLASS)}),backdrop:r.find(function(i){return i.classList.contains(BACKDROP_CLASS)})}}function render(e){var t=div(),r=div();r.className=BOX_CLASS,r.setAttribute("data-state","hidden"),r.setAttribute("tabindex","-1");var i=div();i.className=CONTENT_CLASS,i.setAttribute("data-state","hidden"),setContent(i,e.props),t.appendChild(r),r.appendChild(i),o(e.props,e.props);function o(a,c){var u=getChildren(t),h=u.box,d=u.content,f=u.arrow;c.theme?h.setAttribute("data-theme",c.theme):h.removeAttribute("data-theme"),typeof c.animation=="string"?h.setAttribute("data-animation",c.animation):h.removeAttribute("data-animation"),c.inertia?h.setAttribute("data-inertia",""):h.removeAttribute("data-inertia"),h.style.maxWidth=typeof c.maxWidth=="number"?c.maxWidth+"px":c.maxWidth,c.role?h.setAttribute("role",c.role):h.removeAttribute("role"),(a.content!==c.content||a.allowHTML!==c.allowHTML)&&setContent(d,e.props),c.arrow?f?a.arrow!==c.arrow&&(h.removeChild(f),h.appendChild(createArrowElement(c.arrow))):h.appendChild(createArrowElement(c.arrow)):f&&h.removeChild(f)}return{popper:t,onUpdate:o}}render.$$tippy=!0;var idCounter=1,mouseMoveListeners=[],mountedInstances=[];function createTippy(e,t){var r=evaluateProps(e,Object.assign({},defaultProps,getExtendedPassedProps(removeUndefinedProps(t)))),i,o,a,c=!1,u=!1,h=!1,d=!1,f,m,g,v=[],_=debounce5(le,r.interactiveDebounce),b,S=idCounter++,R=null,A=unique2(r.plugins),I={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},E={id:S,reference:e,popper:div(),popperInstance:R,props:r,state:I,plugins:A,clearDelayTimeouts:ee,setProps:te,setContent:j,show:U,hide:K,hideWithInteractivity:ve,enable:Q,disable:ce,unmount:Re,destroy:Ie};if(!r.render)return errorWhen(!0,"render() function has not been supplied."),E;var O=r.render(E),P=O.popper,L=O.onUpdate;P.setAttribute("data-tippy-root",""),P.id="tippy-"+E.id,E.popper=P,e._tippy=E,P._tippy=E;var V=A.map(function(ae){return ae.fn(E)}),$=e.hasAttribute("aria-expanded");return fe(),xe(),me(),Se("onCreate",[E]),r.showOnCreate&&G(),P.addEventListener("mouseenter",function(){E.props.interactive&&E.state.isVisible&&E.clearDelayTimeouts()}),P.addEventListener("mouseleave",function(){E.props.interactive&&E.props.trigger.indexOf("mouseenter")>=0&&_e().addEventListener("mousemove",_)}),E;function W(){var ae=E.props.touch;return Array.isArray(ae)?ae:[ae,0]}function Z(){return W()[0]==="hold"}function ie(){var ae;return!!((ae=E.props.render)!=null&&ae.$$tippy)}function ue(){return b||e}function _e(){var ae=ue().parentNode;return ae?getOwnerDocument(ae):document}function Te(){return getChildren(P)}function pe(ae){return E.state.isMounted&&!E.state.isVisible||currentInput.isTouch||f&&f.type==="focus"?0:getValueAtIndexOrReturn(E.props.delay,ae?0:1,defaultProps.delay)}function me(ae){ae===void 0&&(ae=!1),P.style.pointerEvents=E.props.interactive&&!ae?"":"none",P.style.zIndex=""+E.props.zIndex}function Se(ae,Ee,Me){if(Me===void 0&&(Me=!0),V.forEach(function(De){De[ae]&&De[ae].apply(De,Ee)}),Me){var Pe;(Pe=E.props)[ae].apply(Pe,Ee)}}function Le(){var ae=E.props.aria;if(ae.content){var Ee="aria-"+ae.content,Me=P.id,Pe=normalizeToArray(E.props.triggerTarget||e);Pe.forEach(function(De){var $e=De.getAttribute(Ee);if(E.state.isVisible)De.setAttribute(Ee,$e?$e+" "+Me:Me);else{var ut=$e&&$e.replace(Me,"").trim();ut?De.setAttribute(Ee,ut):De.removeAttribute(Ee)}})}}function xe(){if(!($||!E.props.aria.expanded)){var ae=normalizeToArray(E.props.triggerTarget||e);ae.forEach(function(Ee){E.props.interactive?Ee.setAttribute("aria-expanded",E.state.isVisible&&Ee===ue()?"true":"false"):Ee.removeAttribute("aria-expanded")})}}function T(){_e().removeEventListener("mousemove",_),mouseMoveListeners=mouseMoveListeners.filter(function(ae){return ae!==_})}function k(ae){if(!(currentInput.isTouch&&(h||ae.type==="mousedown"))){var Ee=ae.composedPath&&ae.composedPath()[0]||ae.target;if(!(E.props.interactive&&actualContains(P,Ee))){if(normalizeToArray(E.props.triggerTarget||e).some(function(Me){return actualContains(Me,Ee)})){if(currentInput.isTouch||E.state.isVisible&&E.props.trigger.indexOf("click")>=0)return}else Se("onClickOutside",[E,ae]);E.props.hideOnClick===!0&&(E.clearDelayTimeouts(),E.hide(),u=!0,setTimeout(function(){u=!1}),E.state.isMounted||se())}}}function D(){h=!0}function q(){h=!1}function B(){var ae=_e();ae.addEventListener("mousedown",k,!0),ae.addEventListener("touchend",k,TOUCH_OPTIONS),ae.addEventListener("touchstart",q,TOUCH_OPTIONS),ae.addEventListener("touchmove",D,TOUCH_OPTIONS)}function se(){var ae=_e();ae.removeEventListener("mousedown",k,!0),ae.removeEventListener("touchend",k,TOUCH_OPTIONS),ae.removeEventListener("touchstart",q,TOUCH_OPTIONS),ae.removeEventListener("touchmove",D,TOUCH_OPTIONS)}function ye(ae,Ee){de(ae,function(){!E.state.isVisible&&P.parentNode&&P.parentNode.contains(P)&&Ee()})}function we(ae,Ee){de(ae,Ee)}function de(ae,Ee){var Me=Te().box;function Pe(De){De.target===Me&&(updateTransitionEndListener(Me,"remove",Pe),Ee())}if(ae===0)return Ee();updateTransitionEndListener(Me,"remove",m),updateTransitionEndListener(Me,"add",Pe),m=Pe}function be(ae,Ee,Me){Me===void 0&&(Me=!1);var Pe=normalizeToArray(E.props.triggerTarget||e);Pe.forEach(function(De){De.addEventListener(ae,Ee,Me),v.push({node:De,eventType:ae,handler:Ee,options:Me})})}function fe(){Z()&&(be("touchstart",Ne,{passive:!0}),be("touchend",Ve,{passive:!0})),splitBySpaces(E.props.trigger).forEach(function(ae){if(ae!=="manual")switch(be(ae,Ne),ae){case"mouseenter":be("mouseleave",Ve);break;case"focus":be(isIE11?"focusout":"blur",Be);break;case"focusin":be("focusout",Be);break}})}function he(){v.forEach(function(ae){var Ee=ae.node,Me=ae.eventType,Pe=ae.handler,De=ae.options;Ee.removeEventListener(Me,Pe,De)}),v=[]}function Ne(ae){var Ee,Me=!1;if(!(!E.state.isEnabled||Ue(ae)||u)){var Pe=((Ee=f)==null?void 0:Ee.type)==="focus";f=ae,b=ae.currentTarget,xe(),!E.state.isVisible&&isMouseEvent(ae)&&mouseMoveListeners.forEach(function(De){return De(ae)}),ae.type==="click"&&(E.props.trigger.indexOf("mouseenter")<0||c)&&E.props.hideOnClick!==!1&&E.state.isVisible?Me=!0:G(ae),ae.type==="click"&&(c=!Me),Me&&!Pe&&oe(ae)}}function le(ae){var Ee=ae.target,Me=ue().contains(Ee)||P.contains(Ee);if(!(ae.type==="mousemove"&&Me)){var Pe=F().concat(P).map(function(De){var $e,ut=De._tippy,ht=($e=ut.popperInstance)==null?void 0:$e.state;return ht?{popperRect:De.getBoundingClientRect(),popperState:ht,props:r}:null}).filter(Boolean);isCursorOutsideInteractiveBorder(Pe,ae)&&(T(),oe(ae))}}function Ve(ae){var Ee=Ue(ae)||E.props.trigger.indexOf("click")>=0&&c;if(!Ee){if(E.props.interactive){E.hideWithInteractivity(ae);return}oe(ae)}}function Be(ae){E.props.trigger.indexOf("focusin")<0&&ae.target!==ue()||E.props.interactive&&ae.relatedTarget&&P.contains(ae.relatedTarget)||oe(ae)}function Ue(ae){return currentInput.isTouch?Z()!==ae.type.indexOf("touch")>=0:!1}function je(){We();var ae=E.props,Ee=ae.popperOptions,Me=ae.placement,Pe=ae.offset,De=ae.getReferenceClientRect,$e=ae.moveTransition,ut=ie()?getChildren(P).arrow:null,ht=De?{getBoundingClientRect:De,contextElement:De.contextElement||ue()}:e,yt={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(Oe){var Qe=Oe.state;if(ie()){var Xe=Te(),et=Xe.box;["placement","reference-hidden","escaped"].forEach(function(dt){dt==="placement"?et.setAttribute("data-placement",Qe.placement):Qe.attributes.popper["data-popper-"+dt]?et.setAttribute("data-"+dt,""):et.removeAttribute("data-"+dt)}),Qe.attributes.popper={}}}},rt=[{name:"offset",options:{offset:Pe}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!$e}},yt];ie()&&ut&&rt.push({name:"arrow",options:{element:ut,padding:3}}),rt.push.apply(rt,Ee?.modifiers||[]),E.popperInstance=createPopper(ht,P,Object.assign({},Ee,{placement:Me,onFirstUpdate:g,modifiers:rt}))}function We(){E.popperInstance&&(E.popperInstance.destroy(),E.popperInstance=null)}function H(){var ae=E.props.appendTo,Ee,Me=ue();E.props.interactive&&ae===TIPPY_DEFAULT_APPEND_TO||ae==="parent"?Ee=Me.parentNode:Ee=invokeWithArgsOrReturn(ae,[Me]),Ee.contains(P)||Ee.appendChild(P),E.state.isMounted=!0,je(),warnWhen(E.props.interactive&&ae===defaultProps.appendTo&&Me.nextElementSibling!==P,["Interactive tippy element may not be accessible via keyboard","navigation because it is not directly after the reference element","in the DOM source order.",`

`,"Using a wrapper <div> or <span> tag around the reference element","solves this by creating a new parentNode context.",`

`,"Specifying `appendTo: document.body` silences this warning, but it","assumes you are using a focus management solution to handle","keyboard navigation.",`

`,"See: https://atomiks.github.io/tippyjs/v6/accessibility/#interactivity"].join(" "))}function F(){return arrayFrom(P.querySelectorAll("[data-tippy-root]"))}function G(ae){E.clearDelayTimeouts(),ae&&Se("onTrigger",[E,ae]),B();var Ee=pe(!0),Me=W(),Pe=Me[0],De=Me[1];currentInput.isTouch&&Pe==="hold"&&De&&(Ee=De),Ee?i=setTimeout(function(){E.show()},Ee):E.show()}function oe(ae){if(E.clearDelayTimeouts(),Se("onUntrigger",[E,ae]),!E.state.isVisible){se();return}if(!(E.props.trigger.indexOf("mouseenter")>=0&&E.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(ae.type)>=0&&c)){var Ee=pe(!1);Ee?o=setTimeout(function(){E.state.isVisible&&E.hide()},Ee):a=requestAnimationFrame(function(){E.hide()})}}function Q(){E.state.isEnabled=!0}function ce(){E.hide(),E.state.isEnabled=!1}function ee(){clearTimeout(i),clearTimeout(o),cancelAnimationFrame(a)}function te(ae){if(warnWhen(E.state.isDestroyed,createMemoryLeakWarning("setProps")),!E.state.isDestroyed){Se("onBeforeUpdate",[E,ae]),he();var Ee=E.props,Me=evaluateProps(e,Object.assign({},Ee,removeUndefinedProps(ae),{ignoreAttributes:!0}));E.props=Me,fe(),Ee.interactiveDebounce!==Me.interactiveDebounce&&(T(),_=debounce5(le,Me.interactiveDebounce)),Ee.triggerTarget&&!Me.triggerTarget?normalizeToArray(Ee.triggerTarget).forEach(function(Pe){Pe.removeAttribute("aria-expanded")}):Me.triggerTarget&&e.removeAttribute("aria-expanded"),xe(),me(),L&&L(Ee,Me),E.popperInstance&&(je(),F().forEach(function(Pe){requestAnimationFrame(Pe._tippy.popperInstance.forceUpdate)})),Se("onAfterUpdate",[E,ae])}}function j(ae){E.setProps({content:ae})}function U(){warnWhen(E.state.isDestroyed,createMemoryLeakWarning("show"));var ae=E.state.isVisible,Ee=E.state.isDestroyed,Me=!E.state.isEnabled,Pe=currentInput.isTouch&&!E.props.touch,De=getValueAtIndexOrReturn(E.props.duration,0,defaultProps.duration);if(!(ae||Ee||Me||Pe)&&!ue().hasAttribute("disabled")&&(Se("onShow",[E],!1),E.props.onShow(E)!==!1)){if(E.state.isVisible=!0,ie()&&(P.style.visibility="visible"),me(),B(),E.state.isMounted||(P.style.transition="none"),ie()){var $e=Te(),ut=$e.box,ht=$e.content;setTransitionDuration([ut,ht],0)}g=function(){var rt;if(!(!E.state.isVisible||d)){if(d=!0,P.offsetHeight,P.style.transition=E.props.moveTransition,ie()&&E.props.animation){var St=Te(),Oe=St.box,Qe=St.content;setTransitionDuration([Oe,Qe],De),setVisibilityState([Oe,Qe],"visible")}Le(),xe(),pushIfUnique(mountedInstances,E),(rt=E.popperInstance)==null||rt.forceUpdate(),Se("onMount",[E]),E.props.animation&&ie()&&we(De,function(){E.state.isShown=!0,Se("onShown",[E])})}},H()}}function K(){warnWhen(E.state.isDestroyed,createMemoryLeakWarning("hide"));var ae=!E.state.isVisible,Ee=E.state.isDestroyed,Me=!E.state.isEnabled,Pe=getValueAtIndexOrReturn(E.props.duration,1,defaultProps.duration);if(!(ae||Ee||Me)&&(Se("onHide",[E],!1),E.props.onHide(E)!==!1)){if(E.state.isVisible=!1,E.state.isShown=!1,d=!1,c=!1,ie()&&(P.style.visibility="hidden"),T(),se(),me(!0),ie()){var De=Te(),$e=De.box,ut=De.content;E.props.animation&&(setTransitionDuration([$e,ut],Pe),setVisibilityState([$e,ut],"hidden"))}Le(),xe(),E.props.animation?ie()&&ye(Pe,E.unmount):E.unmount()}}function ve(ae){warnWhen(E.state.isDestroyed,createMemoryLeakWarning("hideWithInteractivity")),_e().addEventListener("mousemove",_),pushIfUnique(mouseMoveListeners,_),_(ae)}function Re(){warnWhen(E.state.isDestroyed,createMemoryLeakWarning("unmount")),E.state.isVisible&&E.hide(),E.state.isMounted&&(We(),F().forEach(function(ae){ae._tippy.unmount()}),P.parentNode&&P.parentNode.removeChild(P),mountedInstances=mountedInstances.filter(function(ae){return ae!==E}),E.state.isMounted=!1,Se("onHidden",[E]))}function Ie(){warnWhen(E.state.isDestroyed,createMemoryLeakWarning("destroy")),!E.state.isDestroyed&&(E.clearDelayTimeouts(),E.unmount(),he(),delete e._tippy,E.state.isDestroyed=!0,Se("onDestroy",[E]))}}function tippy(e,t){t===void 0&&(t={});var r=defaultProps.plugins.concat(t.plugins||[]);validateTargets(e),validateProps(t,r),bindGlobalEventListeners();var i=Object.assign({},t,{plugins:r}),o=getArrayOfElements(e),a=isElement5(i.content),c=o.length>1;warnWhen(a&&c,["tippy() was passed an Element as the `content` prop, but more than","one tippy instance was created by this invocation. This means the","content element will only be appended to the last tippy instance.",`

`,"Instead, pass the .innerHTML of the element, or use a function that","returns a cloned version of the element instead.",`

`,`1) content: element.innerHTML
`,"2) content: () => element.cloneNode(true)"].join(" "));var u=o.reduce(function(h,d){var f=d&&createTippy(d,i);return f&&h.push(f),h},[]);return isElement5(e)?u[0]:u}tippy.defaultProps=defaultProps,tippy.setDefaultProps=setDefaultProps,tippy.currentInput=currentInput;var applyStylesModifier=Object.assign({},applyStyles_default,{effect:function(t){var r=t.state,i={popper:{position:r.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(r.elements.popper.style,i.popper),r.styles=i,r.elements.arrow&&Object.assign(r.elements.arrow.style,i.arrow)}});tippy.setDefaultProps({render});var tippy_esm_default=tippy,util;(function(e){e.assertEqual=o=>o;function t(o){}e.assertIs=t;function r(o){throw new Error}e.assertNever=r,e.arrayToEnum=o=>{const a={};for(const c of o)a[c]=c;return a},e.getValidEnumValues=o=>{const a=e.objectKeys(o).filter(u=>typeof o[o[u]]!="number"),c={};for(const u of a)c[u]=o[u];return e.objectValues(c)},e.objectValues=o=>e.objectKeys(o).map(function(a){return o[a]}),e.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{const a=[];for(const c in o)Object.prototype.hasOwnProperty.call(o,c)&&a.push(c);return a},e.find=(o,a)=>{for(const c of o)if(a(c))return c},e.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&isFinite(o)&&Math.floor(o)===o;function i(o,a=" | "){return o.map(c=>typeof c=="string"?`'${c}'`:c).join(a)}e.joinValues=i,e.jsonStringifyReplacer=(o,a)=>typeof a=="bigint"?a.toString():a})(util||(util={}));var objectUtil;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(objectUtil||(objectUtil={}));var ZodParsedType=util.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),getParsedType=e=>{switch(typeof e){case"undefined":return ZodParsedType.undefined;case"string":return ZodParsedType.string;case"number":return isNaN(e)?ZodParsedType.nan:ZodParsedType.number;case"boolean":return ZodParsedType.boolean;case"function":return ZodParsedType.function;case"bigint":return ZodParsedType.bigint;case"symbol":return ZodParsedType.symbol;case"object":return Array.isArray(e)?ZodParsedType.array:e===null?ZodParsedType.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?ZodParsedType.promise:typeof Map<"u"&&e instanceof Map?ZodParsedType.map:typeof Set<"u"&&e instanceof Set?ZodParsedType.set:typeof Date<"u"&&e instanceof Date?ZodParsedType.date:ZodParsedType.object;default:return ZodParsedType.unknown}},ZodIssueCode=util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),quotelessJson=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError=class Rs extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(a){return a.message},i={_errors:[]},o=a=>{for(const c of a.issues)if(c.code==="invalid_union")c.unionErrors.map(o);else if(c.code==="invalid_return_type")o(c.returnTypeError);else if(c.code==="invalid_arguments")o(c.argumentsError);else if(c.path.length===0)i._errors.push(r(c));else{let u=i,h=0;for(;h<c.path.length;){const d=c.path[h];h===c.path.length-1?(u[d]=u[d]||{_errors:[]},u[d]._errors.push(r(c))):u[d]=u[d]||{_errors:[]},u=u[d],h++}}};return o(this),i}static assert(t){if(!(t instanceof Rs))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,util.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},i=[];for(const o of this.issues)o.path.length>0?(r[o.path[0]]=r[o.path[0]]||[],r[o.path[0]].push(t(o))):i.push(t(o));return{formErrors:i,fieldErrors:r}}get formErrors(){return this.flatten()}};ZodError.create=e=>new ZodError(e);var errorMap=(e,t)=>{let r;switch(e.code){case ZodIssueCode.invalid_type:e.received===ZodParsedType.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case ZodIssueCode.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,util.jsonStringifyReplacer)}`;break;case ZodIssueCode.unrecognized_keys:r=`Unrecognized key(s) in object: ${util.joinValues(e.keys,", ")}`;break;case ZodIssueCode.invalid_union:r="Invalid input";break;case ZodIssueCode.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${util.joinValues(e.options)}`;break;case ZodIssueCode.invalid_enum_value:r=`Invalid enum value. Expected ${util.joinValues(e.options)}, received '${e.received}'`;break;case ZodIssueCode.invalid_arguments:r="Invalid function arguments";break;case ZodIssueCode.invalid_return_type:r="Invalid function return type";break;case ZodIssueCode.invalid_date:r="Invalid date";break;case ZodIssueCode.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:util.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case ZodIssueCode.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case ZodIssueCode.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case ZodIssueCode.custom:r="Invalid input";break;case ZodIssueCode.invalid_intersection_types:r="Intersection results could not be merged";break;case ZodIssueCode.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case ZodIssueCode.not_finite:r="Number must be finite";break;default:r=t.defaultError,util.assertNever(e)}return{message:r}},overrideErrorMap=errorMap;function setErrorMap(e){overrideErrorMap=e}function getErrorMap(){return overrideErrorMap}var makeIssue=e=>{const{data:t,path:r,errorMaps:i,issueData:o}=e,a=[...r,...o.path||[]],c={...o,path:a};if(o.message!==void 0)return{...o,path:a,message:o.message};let u="";const h=i.filter(d=>!!d).slice().reverse();for(const d of h)u=d(c,{data:t,defaultError:u}).message;return{...o,path:a,message:u}},EMPTY_PATH=[];function addIssueToContext(e,t){const r=getErrorMap(),i=makeIssue({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===errorMap?void 0:errorMap].filter(o=>!!o)});e.common.issues.push(i)}var ParseStatus=class Ms{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const i=[];for(const o of r){if(o.status==="aborted")return INVALID4;o.status==="dirty"&&t.dirty(),i.push(o.value)}return{status:t.value,value:i}}static async mergeObjectAsync(t,r){const i=[];for(const o of r){const a=await o.key,c=await o.value;i.push({key:a,value:c})}return Ms.mergeObjectSync(t,i)}static mergeObjectSync(t,r){const i={};for(const o of r){const{key:a,value:c}=o;if(a.status==="aborted"||c.status==="aborted")return INVALID4;a.status==="dirty"&&t.dirty(),c.status==="dirty"&&t.dirty(),a.value!=="__proto__"&&(typeof c.value<"u"||o.alwaysSet)&&(i[a.value]=c.value)}return{status:t.value,value:i}}},INVALID4=Object.freeze({status:"aborted"}),DIRTY=e=>({status:"dirty",value:e}),OK=e=>({status:"valid",value:e}),isAborted=e=>e.status==="aborted",isDirty=e=>e.status==="dirty",isValid2=e=>e.status==="valid",isAsync=e=>typeof Promise<"u"&&e instanceof Promise;function __classPrivateFieldGet(e,t,r,i){if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?i:r==="a"?i.call(e):i?i.value:t.get(e)}function __classPrivateFieldSet(e,t,r,i,o){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?o.call(e,r):o?o.value=r:t.set(e,r),r}var errorUtil;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t?.message})(errorUtil||(errorUtil={}));var _ZodEnum_cache,_ZodNativeEnum_cache,ParseInputLazyPath=class{constructor(e,t,r,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},handleResult=(e,t)=>{if(isValid2(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new ZodError(e.common.issues);return this._error=r,this._error}}};function processCreateParams(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:i,description:o}=e;if(t&&(r||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:o}:{errorMap:(c,u)=>{var h,d;const{message:f}=e;return c.code==="invalid_enum_value"?{message:f??u.defaultError}:typeof u.data>"u"?{message:(h=f??i)!==null&&h!==void 0?h:u.defaultError}:c.code!=="invalid_type"?{message:u.defaultError}:{message:(d=f??r)!==null&&d!==void 0?d:u.defaultError}},description:o}}var ZodType=class{get description(){return this._def.description}_getType(e){return getParsedType(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:getParsedType(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ParseStatus,ctx:{common:e.parent.common,data:e.data,parsedType:getParsedType(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(isAsync(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const i={common:{issues:[],async:(r=t?.async)!==null&&r!==void 0?r:!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:getParsedType(e)},o=this._parseSync({data:e,path:i.path,parent:i});return handleResult(i,o)}"~validate"(e){var t,r;const i={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:getParsedType(e)};if(!this["~standard"].async)try{const o=this._parseSync({data:e,path:[],parent:i});return isValid2(o)?{value:o.value}:{issues:i.common.issues}}catch(o){!((r=(t=o?.message)===null||t===void 0?void 0:t.toLowerCase())===null||r===void 0)&&r.includes("encountered")&&(this["~standard"].async=!0),i.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:i}).then(o=>isValid2(o)?{value:o.value}:{issues:i.common.issues})}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:getParsedType(e)},i=this._parse({data:e,path:r.path,parent:r}),o=await(isAsync(i)?i:Promise.resolve(i));return handleResult(r,o)}refine(e,t){const r=i=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(i):t;return this._refinement((i,o)=>{const a=e(i),c=()=>o.addIssue({code:ZodIssueCode.custom,...r(i)});return typeof Promise<"u"&&a instanceof Promise?a.then(u=>u?!0:(c(),!1)):a?!0:(c(),!1)})}refinement(e,t){return this._refinement((r,i)=>e(r)?!0:(i.addIssue(typeof t=="function"?t(r,i):t),!1))}_refinement(e){return new ZodEffects({schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return ZodOptional.create(this,this._def)}nullable(){return ZodNullable.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ZodArray.create(this)}promise(){return ZodPromise.create(this,this._def)}or(e){return ZodUnion.create([this,e],this._def)}and(e){return ZodIntersection.create(this,e,this._def)}transform(e){return new ZodEffects({...processCreateParams(this._def),schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new ZodDefault({...processCreateParams(this._def),innerType:this,defaultValue:t,typeName:ZodFirstPartyTypeKind.ZodDefault})}brand(){return new ZodBranded({typeName:ZodFirstPartyTypeKind.ZodBranded,type:this,...processCreateParams(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new ZodCatch({...processCreateParams(this._def),innerType:this,catchValue:t,typeName:ZodFirstPartyTypeKind.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return ZodPipeline.create(this,e)}readonly(){return ZodReadonly.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},cuidRegex=/^c[^\s-]{8,}$/i,cuid2Regex=/^[0-9a-z]+$/,ulidRegex=/^[0-9A-HJKMNP-TV-Z]{26}$/i,uuidRegex=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,nanoidRegex=/^[a-z0-9_-]{21}$/i,jwtRegex=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,durationRegex=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,emailRegex=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,_emojiRegex="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",emojiRegex,ipv4Regex=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4CidrRegex=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6Regex=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,ipv6CidrRegex=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64Regex=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64urlRegex=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,dateRegexSource="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",dateRegex=new RegExp(`^${dateRegexSource}$`);function timeRegexSource(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function timeRegex(e){return new RegExp(`^${timeRegexSource(e)}$`)}function datetimeRegex(e){let t=`${dateRegexSource}T${timeRegexSource(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function isValidIP(e,t){return!!((t==="v4"||!t)&&ipv4Regex.test(e)||(t==="v6"||!t)&&ipv6Regex.test(e))}function isValidJWT(e,t){if(!jwtRegex.test(e))return!1;try{const[r]=e.split("."),i=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),o=JSON.parse(atob(i));return!(typeof o!="object"||o===null||!o.typ||!o.alg||t&&o.alg!==t)}catch{return!1}}function isValidCidr(e,t){return!!((t==="v4"||!t)&&ipv4CidrRegex.test(e)||(t==="v6"||!t)&&ipv6CidrRegex.test(e))}var ZodString=class rn extends ZodType{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==ZodParsedType.string){const a=this._getOrReturnCtx(t);return addIssueToContext(a,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.string,received:a.parsedType}),INVALID4}const i=new ParseStatus;let o;for(const a of this._def.checks)if(a.kind==="min")t.data.length<a.value&&(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{code:ZodIssueCode.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),i.dirty());else if(a.kind==="max")t.data.length>a.value&&(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{code:ZodIssueCode.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),i.dirty());else if(a.kind==="length"){const c=t.data.length>a.value,u=t.data.length<a.value;(c||u)&&(o=this._getOrReturnCtx(t,o),c?addIssueToContext(o,{code:ZodIssueCode.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):u&&addIssueToContext(o,{code:ZodIssueCode.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),i.dirty())}else if(a.kind==="email")emailRegex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"email",code:ZodIssueCode.invalid_string,message:a.message}),i.dirty());else if(a.kind==="emoji")emojiRegex||(emojiRegex=new RegExp(_emojiRegex,"u")),emojiRegex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"emoji",code:ZodIssueCode.invalid_string,message:a.message}),i.dirty());else if(a.kind==="uuid")uuidRegex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"uuid",code:ZodIssueCode.invalid_string,message:a.message}),i.dirty());else if(a.kind==="nanoid")nanoidRegex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"nanoid",code:ZodIssueCode.invalid_string,message:a.message}),i.dirty());else if(a.kind==="cuid")cuidRegex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"cuid",code:ZodIssueCode.invalid_string,message:a.message}),i.dirty());else if(a.kind==="cuid2")cuid2Regex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"cuid2",code:ZodIssueCode.invalid_string,message:a.message}),i.dirty());else if(a.kind==="ulid")ulidRegex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"ulid",code:ZodIssueCode.invalid_string,message:a.message}),i.dirty());else if(a.kind==="url")try{new URL(t.data)}catch{o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"url",code:ZodIssueCode.invalid_string,message:a.message}),i.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"regex",code:ZodIssueCode.invalid_string,message:a.message}),i.dirty())):a.kind==="trim"?t.data=t.data.trim():a.kind==="includes"?t.data.includes(a.value,a.position)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{code:ZodIssueCode.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),i.dirty()):a.kind==="toLowerCase"?t.data=t.data.toLowerCase():a.kind==="toUpperCase"?t.data=t.data.toUpperCase():a.kind==="startsWith"?t.data.startsWith(a.value)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{code:ZodIssueCode.invalid_string,validation:{startsWith:a.value},message:a.message}),i.dirty()):a.kind==="endsWith"?t.data.endsWith(a.value)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{code:ZodIssueCode.invalid_string,validation:{endsWith:a.value},message:a.message}),i.dirty()):a.kind==="datetime"?datetimeRegex(a).test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{code:ZodIssueCode.invalid_string,validation:"datetime",message:a.message}),i.dirty()):a.kind==="date"?dateRegex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{code:ZodIssueCode.invalid_string,validation:"date",message:a.message}),i.dirty()):a.kind==="time"?timeRegex(a).test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{code:ZodIssueCode.invalid_string,validation:"time",message:a.message}),i.dirty()):a.kind==="duration"?durationRegex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"duration",code:ZodIssueCode.invalid_string,message:a.message}),i.dirty()):a.kind==="ip"?isValidIP(t.data,a.version)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"ip",code:ZodIssueCode.invalid_string,message:a.message}),i.dirty()):a.kind==="jwt"?isValidJWT(t.data,a.alg)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"jwt",code:ZodIssueCode.invalid_string,message:a.message}),i.dirty()):a.kind==="cidr"?isValidCidr(t.data,a.version)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"cidr",code:ZodIssueCode.invalid_string,message:a.message}),i.dirty()):a.kind==="base64"?base64Regex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"base64",code:ZodIssueCode.invalid_string,message:a.message}),i.dirty()):a.kind==="base64url"?base64urlRegex.test(t.data)||(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{validation:"base64url",code:ZodIssueCode.invalid_string,message:a.message}),i.dirty()):util.assertNever(a);return{status:i.value,value:t.data}}_regex(t,r,i){return this.refinement(o=>t.test(o),{validation:r,code:ZodIssueCode.invalid_string,...errorUtil.errToObj(i)})}_addCheck(t){return new rn({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...errorUtil.errToObj(t)})}url(t){return this._addCheck({kind:"url",...errorUtil.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...errorUtil.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...errorUtil.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...errorUtil.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...errorUtil.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...errorUtil.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...errorUtil.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...errorUtil.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...errorUtil.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...errorUtil.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...errorUtil.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...errorUtil.errToObj(t)})}datetime(t){var r,i;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof t?.precision>"u"?null:t?.precision,offset:(r=t?.offset)!==null&&r!==void 0?r:!1,local:(i=t?.local)!==null&&i!==void 0?i:!1,...errorUtil.errToObj(t?.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof t?.precision>"u"?null:t?.precision,...errorUtil.errToObj(t?.message)})}duration(t){return this._addCheck({kind:"duration",...errorUtil.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...errorUtil.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r?.position,...errorUtil.errToObj(r?.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...errorUtil.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...errorUtil.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...errorUtil.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...errorUtil.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...errorUtil.errToObj(r)})}nonempty(t){return this.min(1,errorUtil.errToObj(t))}trim(){return new rn({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new rn({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new rn({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}};ZodString.create=e=>{var t;return new ZodString({checks:[],typeName:ZodFirstPartyTypeKind.ZodString,coerce:(t=e?.coerce)!==null&&t!==void 0?t:!1,...processCreateParams(e)})};function floatSafeRemainder(e,t){const r=(e.toString().split(".")[1]||"").length,i=(t.toString().split(".")[1]||"").length,o=r>i?r:i,a=parseInt(e.toFixed(o).replace(".","")),c=parseInt(t.toFixed(o).replace(".",""));return a%c/Math.pow(10,o)}var ZodNumber=class _i extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==ZodParsedType.number){const a=this._getOrReturnCtx(t);return addIssueToContext(a,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.number,received:a.parsedType}),INVALID4}let i;const o=new ParseStatus;for(const a of this._def.checks)a.kind==="int"?util.isInteger(t.data)||(i=this._getOrReturnCtx(t,i),addIssueToContext(i,{code:ZodIssueCode.invalid_type,expected:"integer",received:"float",message:a.message}),o.dirty()):a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(i=this._getOrReturnCtx(t,i),addIssueToContext(i,{code:ZodIssueCode.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),o.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(i=this._getOrReturnCtx(t,i),addIssueToContext(i,{code:ZodIssueCode.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),o.dirty()):a.kind==="multipleOf"?floatSafeRemainder(t.data,a.value)!==0&&(i=this._getOrReturnCtx(t,i),addIssueToContext(i,{code:ZodIssueCode.not_multiple_of,multipleOf:a.value,message:a.message}),o.dirty()):a.kind==="finite"?Number.isFinite(t.data)||(i=this._getOrReturnCtx(t,i),addIssueToContext(i,{code:ZodIssueCode.not_finite,message:a.message}),o.dirty()):util.assertNever(a);return{status:o.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,errorUtil.toString(r))}gt(t,r){return this.setLimit("min",t,!1,errorUtil.toString(r))}lte(t,r){return this.setLimit("max",t,!0,errorUtil.toString(r))}lt(t,r){return this.setLimit("max",t,!1,errorUtil.toString(r))}setLimit(t,r,i,o){return new _i({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:i,message:errorUtil.toString(o)}]})}_addCheck(t){return new _i({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:errorUtil.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:errorUtil.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:errorUtil.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:errorUtil.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:errorUtil.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:errorUtil.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:errorUtil.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:errorUtil.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:errorUtil.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&util.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(r===null||i.value>r)&&(r=i.value):i.kind==="max"&&(t===null||i.value<t)&&(t=i.value)}return Number.isFinite(r)&&Number.isFinite(t)}};ZodNumber.create=e=>new ZodNumber({checks:[],typeName:ZodFirstPartyTypeKind.ZodNumber,coerce:e?.coerce||!1,...processCreateParams(e)});var ZodBigInt=class yi extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==ZodParsedType.bigint)return this._getInvalidInput(t);let i;const o=new ParseStatus;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(i=this._getOrReturnCtx(t,i),addIssueToContext(i,{code:ZodIssueCode.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),o.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(i=this._getOrReturnCtx(t,i),addIssueToContext(i,{code:ZodIssueCode.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),o.dirty()):a.kind==="multipleOf"?t.data%a.value!==BigInt(0)&&(i=this._getOrReturnCtx(t,i),addIssueToContext(i,{code:ZodIssueCode.not_multiple_of,multipleOf:a.value,message:a.message}),o.dirty()):util.assertNever(a);return{status:o.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return addIssueToContext(r,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.bigint,received:r.parsedType}),INVALID4}gte(t,r){return this.setLimit("min",t,!0,errorUtil.toString(r))}gt(t,r){return this.setLimit("min",t,!1,errorUtil.toString(r))}lte(t,r){return this.setLimit("max",t,!0,errorUtil.toString(r))}lt(t,r){return this.setLimit("max",t,!1,errorUtil.toString(r))}setLimit(t,r,i,o){return new yi({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:i,message:errorUtil.toString(o)}]})}_addCheck(t){return new yi({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:errorUtil.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:errorUtil.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:errorUtil.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:errorUtil.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:errorUtil.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}};ZodBigInt.create=e=>{var t;return new ZodBigInt({checks:[],typeName:ZodFirstPartyTypeKind.ZodBigInt,coerce:(t=e?.coerce)!==null&&t!==void 0?t:!1,...processCreateParams(e)})};var ZodBoolean=class extends ZodType{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ZodParsedType.boolean){const r=this._getOrReturnCtx(e);return addIssueToContext(r,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.boolean,received:r.parsedType}),INVALID4}return OK(e.data)}};ZodBoolean.create=e=>new ZodBoolean({typeName:ZodFirstPartyTypeKind.ZodBoolean,coerce:e?.coerce||!1,...processCreateParams(e)});var ZodDate=class ks extends ZodType{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==ZodParsedType.date){const a=this._getOrReturnCtx(t);return addIssueToContext(a,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.date,received:a.parsedType}),INVALID4}if(isNaN(t.data.getTime())){const a=this._getOrReturnCtx(t);return addIssueToContext(a,{code:ZodIssueCode.invalid_date}),INVALID4}const i=new ParseStatus;let o;for(const a of this._def.checks)a.kind==="min"?t.data.getTime()<a.value&&(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{code:ZodIssueCode.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),i.dirty()):a.kind==="max"?t.data.getTime()>a.value&&(o=this._getOrReturnCtx(t,o),addIssueToContext(o,{code:ZodIssueCode.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),i.dirty()):util.assertNever(a);return{status:i.value,value:new Date(t.data.getTime())}}_addCheck(t){return new ks({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:errorUtil.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:errorUtil.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}};ZodDate.create=e=>new ZodDate({checks:[],coerce:e?.coerce||!1,typeName:ZodFirstPartyTypeKind.ZodDate,...processCreateParams(e)});var ZodSymbol=class extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.symbol){const r=this._getOrReturnCtx(e);return addIssueToContext(r,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.symbol,received:r.parsedType}),INVALID4}return OK(e.data)}};ZodSymbol.create=e=>new ZodSymbol({typeName:ZodFirstPartyTypeKind.ZodSymbol,...processCreateParams(e)});var ZodUndefined=class extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.undefined){const r=this._getOrReturnCtx(e);return addIssueToContext(r,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.undefined,received:r.parsedType}),INVALID4}return OK(e.data)}};ZodUndefined.create=e=>new ZodUndefined({typeName:ZodFirstPartyTypeKind.ZodUndefined,...processCreateParams(e)});var ZodNull=class extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.null){const r=this._getOrReturnCtx(e);return addIssueToContext(r,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.null,received:r.parsedType}),INVALID4}return OK(e.data)}};ZodNull.create=e=>new ZodNull({typeName:ZodFirstPartyTypeKind.ZodNull,...processCreateParams(e)});var ZodAny=class extends ZodType{constructor(){super(...arguments),this._any=!0}_parse(e){return OK(e.data)}};ZodAny.create=e=>new ZodAny({typeName:ZodFirstPartyTypeKind.ZodAny,...processCreateParams(e)});var ZodUnknown=class extends ZodType{constructor(){super(...arguments),this._unknown=!0}_parse(e){return OK(e.data)}};ZodUnknown.create=e=>new ZodUnknown({typeName:ZodFirstPartyTypeKind.ZodUnknown,...processCreateParams(e)});var ZodNever=class extends ZodType{_parse(e){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.never,received:t.parsedType}),INVALID4}};ZodNever.create=e=>new ZodNever({typeName:ZodFirstPartyTypeKind.ZodNever,...processCreateParams(e)});var ZodVoid=class extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.undefined){const r=this._getOrReturnCtx(e);return addIssueToContext(r,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.void,received:r.parsedType}),INVALID4}return OK(e.data)}};ZodVoid.create=e=>new ZodVoid({typeName:ZodFirstPartyTypeKind.ZodVoid,...processCreateParams(e)});var ZodArray=class Dn extends ZodType{_parse(t){const{ctx:r,status:i}=this._processInputParams(t),o=this._def;if(r.parsedType!==ZodParsedType.array)return addIssueToContext(r,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:r.parsedType}),INVALID4;if(o.exactLength!==null){const c=r.data.length>o.exactLength.value,u=r.data.length<o.exactLength.value;(c||u)&&(addIssueToContext(r,{code:c?ZodIssueCode.too_big:ZodIssueCode.too_small,minimum:u?o.exactLength.value:void 0,maximum:c?o.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:o.exactLength.message}),i.dirty())}if(o.minLength!==null&&r.data.length<o.minLength.value&&(addIssueToContext(r,{code:ZodIssueCode.too_small,minimum:o.minLength.value,type:"array",inclusive:!0,exact:!1,message:o.minLength.message}),i.dirty()),o.maxLength!==null&&r.data.length>o.maxLength.value&&(addIssueToContext(r,{code:ZodIssueCode.too_big,maximum:o.maxLength.value,type:"array",inclusive:!0,exact:!1,message:o.maxLength.message}),i.dirty()),r.common.async)return Promise.all([...r.data].map((c,u)=>o.type._parseAsync(new ParseInputLazyPath(r,c,r.path,u)))).then(c=>ParseStatus.mergeArray(i,c));const a=[...r.data].map((c,u)=>o.type._parseSync(new ParseInputLazyPath(r,c,r.path,u)));return ParseStatus.mergeArray(i,a)}get element(){return this._def.type}min(t,r){return new Dn({...this._def,minLength:{value:t,message:errorUtil.toString(r)}})}max(t,r){return new Dn({...this._def,maxLength:{value:t,message:errorUtil.toString(r)}})}length(t,r){return new Dn({...this._def,exactLength:{value:t,message:errorUtil.toString(r)}})}nonempty(t){return this.min(1,t)}};ZodArray.create=(e,t)=>new ZodArray({type:e,minLength:null,maxLength:null,exactLength:null,typeName:ZodFirstPartyTypeKind.ZodArray,...processCreateParams(t)});function deepPartialify(e){if(e instanceof ZodObject){const t={};for(const r in e.shape){const i=e.shape[r];t[r]=ZodOptional.create(deepPartialify(i))}return new ZodObject({...e._def,shape:()=>t})}else return e instanceof ZodArray?new ZodArray({...e._def,type:deepPartialify(e.element)}):e instanceof ZodOptional?ZodOptional.create(deepPartialify(e.unwrap())):e instanceof ZodNullable?ZodNullable.create(deepPartialify(e.unwrap())):e instanceof ZodTuple?ZodTuple.create(e.items.map(t=>deepPartialify(t))):e}var ZodObject=class Ft extends ZodType{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=util.objectKeys(t);return this._cached={shape:t,keys:r}}_parse(t){if(this._getType(t)!==ZodParsedType.object){const d=this._getOrReturnCtx(t);return addIssueToContext(d,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:d.parsedType}),INVALID4}const{status:i,ctx:o}=this._processInputParams(t),{shape:a,keys:c}=this._getCached(),u=[];if(!(this._def.catchall instanceof ZodNever&&this._def.unknownKeys==="strip"))for(const d in o.data)c.includes(d)||u.push(d);const h=[];for(const d of c){const f=a[d],m=o.data[d];h.push({key:{status:"valid",value:d},value:f._parse(new ParseInputLazyPath(o,m,o.path,d)),alwaysSet:d in o.data})}if(this._def.catchall instanceof ZodNever){const d=this._def.unknownKeys;if(d==="passthrough")for(const f of u)h.push({key:{status:"valid",value:f},value:{status:"valid",value:o.data[f]}});else if(d==="strict")u.length>0&&(addIssueToContext(o,{code:ZodIssueCode.unrecognized_keys,keys:u}),i.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const f of u){const m=o.data[f];h.push({key:{status:"valid",value:f},value:d._parse(new ParseInputLazyPath(o,m,o.path,f)),alwaysSet:f in o.data})}}return o.common.async?Promise.resolve().then(async()=>{const d=[];for(const f of h){const m=await f.key,g=await f.value;d.push({key:m,value:g,alwaysSet:f.alwaysSet})}return d}).then(d=>ParseStatus.mergeObjectSync(i,d)):ParseStatus.mergeObjectSync(i,h)}get shape(){return this._def.shape()}strict(t){return errorUtil.errToObj,new Ft({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,i)=>{var o,a,c,u;const h=(c=(a=(o=this._def).errorMap)===null||a===void 0?void 0:a.call(o,r,i).message)!==null&&c!==void 0?c:i.defaultError;return r.code==="unrecognized_keys"?{message:(u=errorUtil.errToObj(t).message)!==null&&u!==void 0?u:h}:{message:h}}}:{}})}strip(){return new Ft({...this._def,unknownKeys:"strip"})}passthrough(){return new Ft({...this._def,unknownKeys:"passthrough"})}extend(t){return new Ft({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Ft({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:ZodFirstPartyTypeKind.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new Ft({...this._def,catchall:t})}pick(t){const r={};return util.objectKeys(t).forEach(i=>{t[i]&&this.shape[i]&&(r[i]=this.shape[i])}),new Ft({...this._def,shape:()=>r})}omit(t){const r={};return util.objectKeys(this.shape).forEach(i=>{t[i]||(r[i]=this.shape[i])}),new Ft({...this._def,shape:()=>r})}deepPartial(){return deepPartialify(this)}partial(t){const r={};return util.objectKeys(this.shape).forEach(i=>{const o=this.shape[i];t&&!t[i]?r[i]=o:r[i]=o.optional()}),new Ft({...this._def,shape:()=>r})}required(t){const r={};return util.objectKeys(this.shape).forEach(i=>{if(t&&!t[i])r[i]=this.shape[i];else{let a=this.shape[i];for(;a instanceof ZodOptional;)a=a._def.innerType;r[i]=a}}),new Ft({...this._def,shape:()=>r})}keyof(){return createZodEnum(util.objectKeys(this.shape))}};ZodObject.create=(e,t)=>new ZodObject({shape:()=>e,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(t)}),ZodObject.strictCreate=(e,t)=>new ZodObject({shape:()=>e,unknownKeys:"strict",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(t)}),ZodObject.lazycreate=(e,t)=>new ZodObject({shape:e,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(t)});var ZodUnion=class extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function i(o){for(const c of o)if(c.result.status==="valid")return c.result;for(const c of o)if(c.result.status==="dirty")return t.common.issues.push(...c.ctx.common.issues),c.result;const a=o.map(c=>new ZodError(c.ctx.common.issues));return addIssueToContext(t,{code:ZodIssueCode.invalid_union,unionErrors:a}),INVALID4}if(t.common.async)return Promise.all(r.map(async o=>{const a={...t,common:{...t.common,issues:[]},parent:null};return{result:await o._parseAsync({data:t.data,path:t.path,parent:a}),ctx:a}})).then(i);{let o;const a=[];for(const u of r){const h={...t,common:{...t.common,issues:[]},parent:null},d=u._parseSync({data:t.data,path:t.path,parent:h});if(d.status==="valid")return d;d.status==="dirty"&&!o&&(o={result:d,ctx:h}),h.common.issues.length&&a.push(h.common.issues)}if(o)return t.common.issues.push(...o.ctx.common.issues),o.result;const c=a.map(u=>new ZodError(u));return addIssueToContext(t,{code:ZodIssueCode.invalid_union,unionErrors:c}),INVALID4}}get options(){return this._def.options}};ZodUnion.create=(e,t)=>new ZodUnion({options:e,typeName:ZodFirstPartyTypeKind.ZodUnion,...processCreateParams(t)});var getDiscriminator=e=>e instanceof ZodLazy?getDiscriminator(e.schema):e instanceof ZodEffects?getDiscriminator(e.innerType()):e instanceof ZodLiteral?[e.value]:e instanceof ZodEnum?e.options:e instanceof ZodNativeEnum?util.objectValues(e.enum):e instanceof ZodDefault?getDiscriminator(e._def.innerType):e instanceof ZodUndefined?[void 0]:e instanceof ZodNull?[null]:e instanceof ZodOptional?[void 0,...getDiscriminator(e.unwrap())]:e instanceof ZodNullable?[null,...getDiscriminator(e.unwrap())]:e instanceof ZodBranded||e instanceof ZodReadonly?getDiscriminator(e.unwrap()):e instanceof ZodCatch?getDiscriminator(e._def.innerType):[],ZodDiscriminatedUnion=class Os extends ZodType{_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==ZodParsedType.object)return addIssueToContext(r,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:r.parsedType}),INVALID4;const i=this.discriminator,o=r.data[i],a=this.optionsMap.get(o);return a?r.common.async?a._parseAsync({data:r.data,path:r.path,parent:r}):a._parseSync({data:r.data,path:r.path,parent:r}):(addIssueToContext(r,{code:ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[i]}),INVALID4)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,i){const o=new Map;for(const a of r){const c=getDiscriminator(a.shape[t]);if(!c.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const u of c){if(o.has(u))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(u)}`);o.set(u,a)}}return new Os({typeName:ZodFirstPartyTypeKind.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:o,...processCreateParams(i)})}};function mergeValues(e,t){const r=getParsedType(e),i=getParsedType(t);if(e===t)return{valid:!0,data:e};if(r===ZodParsedType.object&&i===ZodParsedType.object){const o=util.objectKeys(t),a=util.objectKeys(e).filter(u=>o.indexOf(u)!==-1),c={...e,...t};for(const u of a){const h=mergeValues(e[u],t[u]);if(!h.valid)return{valid:!1};c[u]=h.data}return{valid:!0,data:c}}else if(r===ZodParsedType.array&&i===ZodParsedType.array){if(e.length!==t.length)return{valid:!1};const o=[];for(let a=0;a<e.length;a++){const c=e[a],u=t[a],h=mergeValues(c,u);if(!h.valid)return{valid:!1};o.push(h.data)}return{valid:!0,data:o}}else return r===ZodParsedType.date&&i===ZodParsedType.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}var ZodIntersection=class extends ZodType{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),i=(o,a)=>{if(isAborted(o)||isAborted(a))return INVALID4;const c=mergeValues(o.value,a.value);return c.valid?((isDirty(o)||isDirty(a))&&t.dirty(),{status:t.value,value:c.data}):(addIssueToContext(r,{code:ZodIssueCode.invalid_intersection_types}),INVALID4)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([o,a])=>i(o,a)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}};ZodIntersection.create=(e,t,r)=>new ZodIntersection({left:e,right:t,typeName:ZodFirstPartyTypeKind.ZodIntersection,...processCreateParams(r)});var ZodTuple=class Ps extends ZodType{_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==ZodParsedType.array)return addIssueToContext(i,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:i.parsedType}),INVALID4;if(i.data.length<this._def.items.length)return addIssueToContext(i,{code:ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),INVALID4;!this._def.rest&&i.data.length>this._def.items.length&&(addIssueToContext(i,{code:ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const a=[...i.data].map((c,u)=>{const h=this._def.items[u]||this._def.rest;return h?h._parse(new ParseInputLazyPath(i,c,i.path,u)):null}).filter(c=>!!c);return i.common.async?Promise.all(a).then(c=>ParseStatus.mergeArray(r,c)):ParseStatus.mergeArray(r,a)}get items(){return this._def.items}rest(t){return new Ps({...this._def,rest:t})}};ZodTuple.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ZodTuple({items:e,typeName:ZodFirstPartyTypeKind.ZodTuple,rest:null,...processCreateParams(t)})};var ZodRecord=class bi extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==ZodParsedType.object)return addIssueToContext(i,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:i.parsedType}),INVALID4;const o=[],a=this._def.keyType,c=this._def.valueType;for(const u in i.data)o.push({key:a._parse(new ParseInputLazyPath(i,u,i.path,u)),value:c._parse(new ParseInputLazyPath(i,i.data[u],i.path,u)),alwaysSet:u in i.data});return i.common.async?ParseStatus.mergeObjectAsync(r,o):ParseStatus.mergeObjectSync(r,o)}get element(){return this._def.valueType}static create(t,r,i){return r instanceof ZodType?new bi({keyType:t,valueType:r,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(i)}):new bi({keyType:ZodString.create(),valueType:t,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(r)})}},ZodMap=class extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ZodParsedType.map)return addIssueToContext(r,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.map,received:r.parsedType}),INVALID4;const i=this._def.keyType,o=this._def.valueType,a=[...r.data.entries()].map(([c,u],h)=>({key:i._parse(new ParseInputLazyPath(r,c,r.path,[h,"key"])),value:o._parse(new ParseInputLazyPath(r,u,r.path,[h,"value"]))}));if(r.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const u of a){const h=await u.key,d=await u.value;if(h.status==="aborted"||d.status==="aborted")return INVALID4;(h.status==="dirty"||d.status==="dirty")&&t.dirty(),c.set(h.value,d.value)}return{status:t.value,value:c}})}else{const c=new Map;for(const u of a){const h=u.key,d=u.value;if(h.status==="aborted"||d.status==="aborted")return INVALID4;(h.status==="dirty"||d.status==="dirty")&&t.dirty(),c.set(h.value,d.value)}return{status:t.value,value:c}}}};ZodMap.create=(e,t,r)=>new ZodMap({valueType:t,keyType:e,typeName:ZodFirstPartyTypeKind.ZodMap,...processCreateParams(r)});var ZodSet=class Ci extends ZodType{_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==ZodParsedType.set)return addIssueToContext(i,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.set,received:i.parsedType}),INVALID4;const o=this._def;o.minSize!==null&&i.data.size<o.minSize.value&&(addIssueToContext(i,{code:ZodIssueCode.too_small,minimum:o.minSize.value,type:"set",inclusive:!0,exact:!1,message:o.minSize.message}),r.dirty()),o.maxSize!==null&&i.data.size>o.maxSize.value&&(addIssueToContext(i,{code:ZodIssueCode.too_big,maximum:o.maxSize.value,type:"set",inclusive:!0,exact:!1,message:o.maxSize.message}),r.dirty());const a=this._def.valueType;function c(h){const d=new Set;for(const f of h){if(f.status==="aborted")return INVALID4;f.status==="dirty"&&r.dirty(),d.add(f.value)}return{status:r.value,value:d}}const u=[...i.data.values()].map((h,d)=>a._parse(new ParseInputLazyPath(i,h,i.path,d)));return i.common.async?Promise.all(u).then(h=>c(h)):c(u)}min(t,r){return new Ci({...this._def,minSize:{value:t,message:errorUtil.toString(r)}})}max(t,r){return new Ci({...this._def,maxSize:{value:t,message:errorUtil.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}};ZodSet.create=(e,t)=>new ZodSet({valueType:e,minSize:null,maxSize:null,typeName:ZodFirstPartyTypeKind.ZodSet,...processCreateParams(t)});var ZodFunction=class Ln extends ZodType{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==ZodParsedType.function)return addIssueToContext(r,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.function,received:r.parsedType}),INVALID4;function i(u,h){return makeIssue({data:u,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,getErrorMap(),errorMap].filter(d=>!!d),issueData:{code:ZodIssueCode.invalid_arguments,argumentsError:h}})}function o(u,h){return makeIssue({data:u,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,getErrorMap(),errorMap].filter(d=>!!d),issueData:{code:ZodIssueCode.invalid_return_type,returnTypeError:h}})}const a={errorMap:r.common.contextualErrorMap},c=r.data;if(this._def.returns instanceof ZodPromise){const u=this;return OK(async function(...h){const d=new ZodError([]),f=await u._def.args.parseAsync(h,a).catch(v=>{throw d.addIssue(i(h,v)),d}),m=await Reflect.apply(c,this,f);return await u._def.returns._def.type.parseAsync(m,a).catch(v=>{throw d.addIssue(o(m,v)),d})})}else{const u=this;return OK(function(...h){const d=u._def.args.safeParse(h,a);if(!d.success)throw new ZodError([i(h,d.error)]);const f=Reflect.apply(c,this,d.data),m=u._def.returns.safeParse(f,a);if(!m.success)throw new ZodError([o(f,m.error)]);return m.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new Ln({...this._def,args:ZodTuple.create(t).rest(ZodUnknown.create())})}returns(t){return new Ln({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,r,i){return new Ln({args:t||ZodTuple.create([]).rest(ZodUnknown.create()),returns:r||ZodUnknown.create(),typeName:ZodFirstPartyTypeKind.ZodFunction,...processCreateParams(i)})}},ZodLazy=class extends ZodType{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};ZodLazy.create=(e,t)=>new ZodLazy({getter:e,typeName:ZodFirstPartyTypeKind.ZodLazy,...processCreateParams(t)});var ZodLiteral=class extends ZodType{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{received:t.data,code:ZodIssueCode.invalid_literal,expected:this._def.value}),INVALID4}return{status:"valid",value:e.data}}get value(){return this._def.value}};ZodLiteral.create=(e,t)=>new ZodLiteral({value:e,typeName:ZodFirstPartyTypeKind.ZodLiteral,...processCreateParams(t)});function createZodEnum(e,t){return new ZodEnum({values:e,typeName:ZodFirstPartyTypeKind.ZodEnum,...processCreateParams(t)})}var ZodEnum=class Si extends ZodType{constructor(){super(...arguments),_ZodEnum_cache.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),i=this._def.values;return addIssueToContext(r,{expected:util.joinValues(i),received:r.parsedType,code:ZodIssueCode.invalid_type}),INVALID4}if(__classPrivateFieldGet(this,_ZodEnum_cache,"f")||__classPrivateFieldSet(this,_ZodEnum_cache,new Set(this._def.values),"f"),!__classPrivateFieldGet(this,_ZodEnum_cache,"f").has(t.data)){const r=this._getOrReturnCtx(t),i=this._def.values;return addIssueToContext(r,{received:r.data,code:ZodIssueCode.invalid_enum_value,options:i}),INVALID4}return OK(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return Si.create(t,{...this._def,...r})}exclude(t,r=this._def){return Si.create(this.options.filter(i=>!t.includes(i)),{...this._def,...r})}};_ZodEnum_cache=new WeakMap,ZodEnum.create=createZodEnum;var ZodNativeEnum=class extends ZodType{constructor(){super(...arguments),_ZodNativeEnum_cache.set(this,void 0)}_parse(e){const t=util.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==ZodParsedType.string&&r.parsedType!==ZodParsedType.number){const i=util.objectValues(t);return addIssueToContext(r,{expected:util.joinValues(i),received:r.parsedType,code:ZodIssueCode.invalid_type}),INVALID4}if(__classPrivateFieldGet(this,_ZodNativeEnum_cache,"f")||__classPrivateFieldSet(this,_ZodNativeEnum_cache,new Set(util.getValidEnumValues(this._def.values)),"f"),!__classPrivateFieldGet(this,_ZodNativeEnum_cache,"f").has(e.data)){const i=util.objectValues(t);return addIssueToContext(r,{received:r.data,code:ZodIssueCode.invalid_enum_value,options:i}),INVALID4}return OK(e.data)}get enum(){return this._def.values}};_ZodNativeEnum_cache=new WeakMap,ZodNativeEnum.create=(e,t)=>new ZodNativeEnum({values:e,typeName:ZodFirstPartyTypeKind.ZodNativeEnum,...processCreateParams(t)});var ZodPromise=class extends ZodType{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ZodParsedType.promise&&t.common.async===!1)return addIssueToContext(t,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.promise,received:t.parsedType}),INVALID4;const r=t.parsedType===ZodParsedType.promise?t.data:Promise.resolve(t.data);return OK(r.then(i=>this._def.type.parseAsync(i,{path:t.path,errorMap:t.common.contextualErrorMap})))}};ZodPromise.create=(e,t)=>new ZodPromise({type:e,typeName:ZodFirstPartyTypeKind.ZodPromise,...processCreateParams(t)});var ZodEffects=class extends ZodType{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ZodFirstPartyTypeKind.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),i=this._def.effect||null,o={addIssue:a=>{addIssueToContext(r,a),a.fatal?t.abort():t.dirty()},get path(){return r.path}};if(o.addIssue=o.addIssue.bind(o),i.type==="preprocess"){const a=i.transform(r.data,o);if(r.common.async)return Promise.resolve(a).then(async c=>{if(t.value==="aborted")return INVALID4;const u=await this._def.schema._parseAsync({data:c,path:r.path,parent:r});return u.status==="aborted"?INVALID4:u.status==="dirty"||t.value==="dirty"?DIRTY(u.value):u});{if(t.value==="aborted")return INVALID4;const c=this._def.schema._parseSync({data:a,path:r.path,parent:r});return c.status==="aborted"?INVALID4:c.status==="dirty"||t.value==="dirty"?DIRTY(c.value):c}}if(i.type==="refinement"){const a=c=>{const u=i.refinement(c,o);if(r.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(r.common.async===!1){const c=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return c.status==="aborted"?INVALID4:(c.status==="dirty"&&t.dirty(),a(c.value),{status:t.value,value:c.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(c=>c.status==="aborted"?INVALID4:(c.status==="dirty"&&t.dirty(),a(c.value).then(()=>({status:t.value,value:c.value}))))}if(i.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!isValid2(a))return a;const c=i.transform(a.value,o);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:c}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>isValid2(a)?Promise.resolve(i.transform(a.value,o)).then(c=>({status:t.value,value:c})):a);util.assertNever(i)}};ZodEffects.create=(e,t,r)=>new ZodEffects({schema:e,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:t,...processCreateParams(r)}),ZodEffects.createWithPreprocess=(e,t,r)=>new ZodEffects({schema:t,effect:{type:"preprocess",transform:e},typeName:ZodFirstPartyTypeKind.ZodEffects,...processCreateParams(r)});var ZodOptional=class extends ZodType{_parse(e){return this._getType(e)===ZodParsedType.undefined?OK(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};ZodOptional.create=(e,t)=>new ZodOptional({innerType:e,typeName:ZodFirstPartyTypeKind.ZodOptional,...processCreateParams(t)});var ZodNullable=class extends ZodType{_parse(e){return this._getType(e)===ZodParsedType.null?OK(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};ZodNullable.create=(e,t)=>new ZodNullable({innerType:e,typeName:ZodFirstPartyTypeKind.ZodNullable,...processCreateParams(t)});var ZodDefault=class extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===ZodParsedType.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};ZodDefault.create=(e,t)=>new ZodDefault({innerType:e,typeName:ZodFirstPartyTypeKind.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...processCreateParams(t)});var ZodCatch=class extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return isAsync(i)?i.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new ZodError(r.common.issues)},input:r.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new ZodError(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}};ZodCatch.create=(e,t)=>new ZodCatch({innerType:e,typeName:ZodFirstPartyTypeKind.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...processCreateParams(t)});var ZodNaN=class extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.nan){const r=this._getOrReturnCtx(e);return addIssueToContext(r,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.nan,received:r.parsedType}),INVALID4}return{status:"valid",value:e.data}}};ZodNaN.create=e=>new ZodNaN({typeName:ZodFirstPartyTypeKind.ZodNaN,...processCreateParams(e)});var BRAND=Symbol("zod_brand"),ZodBranded=class extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}},ZodPipeline=class As extends ZodType{_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return a.status==="aborted"?INVALID4:a.status==="dirty"?(r.dirty(),DIRTY(a.value)):this._def.out._parseAsync({data:a.value,path:i.path,parent:i})})();{const o=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return o.status==="aborted"?INVALID4:o.status==="dirty"?(r.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:i.path,parent:i})}}static create(t,r){return new As({in:t,out:r,typeName:ZodFirstPartyTypeKind.ZodPipeline})}},ZodReadonly=class extends ZodType{_parse(e){const t=this._def.innerType._parse(e),r=i=>(isValid2(i)&&(i.value=Object.freeze(i.value)),i);return isAsync(t)?t.then(i=>r(i)):r(t)}unwrap(){return this._def.innerType}};ZodReadonly.create=(e,t)=>new ZodReadonly({innerType:e,typeName:ZodFirstPartyTypeKind.ZodReadonly,...processCreateParams(t)});function custom(e,t={},r){return e?ZodAny.create().superRefine((i,o)=>{var a,c;if(!e(i)){const u=typeof t=="function"?t(i):typeof t=="string"?{message:t}:t,h=(c=(a=u.fatal)!==null&&a!==void 0?a:r)!==null&&c!==void 0?c:!0,d=typeof u=="string"?{message:u}:u;o.addIssue({code:"custom",...d,fatal:h})}}):ZodAny.create()}var late={object:ZodObject.lazycreate},ZodFirstPartyTypeKind;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(ZodFirstPartyTypeKind||(ZodFirstPartyTypeKind={}));var instanceOfType=(e,t={message:`Input not instance of ${e.name}`})=>custom(r=>r instanceof e,t),stringType=ZodString.create,numberType=ZodNumber.create,nanType=ZodNaN.create,bigIntType=ZodBigInt.create,booleanType=ZodBoolean.create,dateType=ZodDate.create,symbolType=ZodSymbol.create,undefinedType=ZodUndefined.create,nullType=ZodNull.create,anyType=ZodAny.create,unknownType=ZodUnknown.create,neverType=ZodNever.create,voidType=ZodVoid.create,arrayType=ZodArray.create,objectType=ZodObject.create,strictObjectType=ZodObject.strictCreate,unionType=ZodUnion.create,discriminatedUnionType=ZodDiscriminatedUnion.create,intersectionType=ZodIntersection.create,tupleType=ZodTuple.create,recordType=ZodRecord.create,mapType=ZodMap.create,setType=ZodSet.create,functionType=ZodFunction.create,lazyType=ZodLazy.create,literalType=ZodLiteral.create,enumType=ZodEnum.create,nativeEnumType=ZodNativeEnum.create,promiseType=ZodPromise.create,effectsType=ZodEffects.create,optionalType=ZodOptional.create,nullableType=ZodNullable.create,preprocessType=ZodEffects.createWithPreprocess,pipelineType=ZodPipeline.create,ostring=()=>stringType().optional(),onumber=()=>numberType().optional(),oboolean=()=>booleanType().optional(),coerce={string:e=>ZodString.create({...e,coerce:!0}),number:e=>ZodNumber.create({...e,coerce:!0}),boolean:e=>ZodBoolean.create({...e,coerce:!0}),bigint:e=>ZodBigInt.create({...e,coerce:!0}),date:e=>ZodDate.create({...e,coerce:!0})},NEVER=INVALID4,z=Object.freeze({__proto__:null,defaultErrorMap:errorMap,setErrorMap,getErrorMap,makeIssue,EMPTY_PATH,addIssueToContext,ParseStatus,INVALID:INVALID4,DIRTY,OK,isAborted,isDirty,isValid:isValid2,isAsync,get util(){return util},get objectUtil(){return objectUtil},ZodParsedType,getParsedType,ZodType,datetimeRegex,ZodString,ZodNumber,ZodBigInt,ZodBoolean,ZodDate,ZodSymbol,ZodUndefined,ZodNull,ZodAny,ZodUnknown,ZodNever,ZodVoid,ZodArray,ZodObject,ZodUnion,ZodDiscriminatedUnion,ZodIntersection,ZodTuple,ZodRecord,ZodMap,ZodSet,ZodFunction,ZodLazy,ZodLiteral,ZodEnum,ZodNativeEnum,ZodPromise,ZodEffects,ZodTransformer:ZodEffects,ZodOptional,ZodNullable,ZodDefault,ZodCatch,ZodNaN,BRAND,ZodBranded,ZodPipeline,ZodReadonly,custom,Schema:ZodType,ZodSchema:ZodType,late,get ZodFirstPartyTypeKind(){return ZodFirstPartyTypeKind},coerce,any:anyType,array:arrayType,bigint:bigIntType,boolean:booleanType,date:dateType,discriminatedUnion:discriminatedUnionType,effect:effectsType,enum:enumType,function:functionType,instanceof:instanceOfType,intersection:intersectionType,lazy:lazyType,literal:literalType,map:mapType,nan:nanType,nativeEnum:nativeEnumType,never:neverType,null:nullType,nullable:nullableType,number:numberType,object:objectType,oboolean,onumber,optional:optionalType,ostring,pipeline:pipelineType,preprocess:preprocessType,promise:promiseType,record:recordType,set:setType,strictObject:strictObjectType,string:stringType,symbol:symbolType,transformer:effectsType,tuple:tupleType,undefined:undefinedType,union:unionType,unknown:unknownType,void:voidType,NEVER,ZodIssueCode,quotelessJson,ZodError});new Chart(ctx,{type:"bar",data:{labels:["Red","Blue","Yellow","Green","Purple","Orange"],datasets:[{label:"# of Votes",data:[12,19,3,5,2,3],borderWidth:1}]},options:{scales:{y:{beginAtZero:!0}}}});var width=640,height=400,marginTop=20,marginRight=20,marginBottom=30,marginLeft=40,x=utcTime().domain([new Date("2023-01-01"),new Date("2024-01-01")]).range([marginLeft,width-marginRight]),y=linear2().domain([0,100]).range([height-marginBottom,marginTop]),svg=create_default("svg").attr("width",width).attr("height",height);svg.append("g").attr("transform",`translate(0,${height-marginBottom})`).call(axisBottom(x)),svg.append("g").attr("transform",`translate(${marginLeft},0)`).call(axisLeft(y)),container.append(svg.node());var container=document.querySelector("#example");new handsontable_default(container,{data:[["","Tesla","Volvo","Toyota","Ford"],["2019",10,11,12,13],["2020",20,11,14,13],["2021",30,15,12,13]],rowHeaders:!0,colHeaders:!0,height:"auto",autoWrapRow:!0,autoWrapCol:!0,licenseKey:"non-commercial-and-evaluation"}),DateTime.now().toString(),ClassicEditor.create(document.querySelector("#editor"),{licenseKey:"GPL",plugins:[Essentials,Bold,Italic,Font,Paragraph],toolbar:["undo","redo","|","bold","italic","|","fontSize","fontFamily","fontColor","fontBackgroundColor"]});var Todo=class{id=Math.random();title="";finished=!1;constructor(e){makeObservable(this,{title:observable,finished:observable,toggle:action}),this.title=e}toggle(){this.finished=!this.finished}};new Todo("title"),tippy_esm_default("#myButton",{content:"My tooltip!"});var mySchema=z.string();mySchema.parse("tuna");
